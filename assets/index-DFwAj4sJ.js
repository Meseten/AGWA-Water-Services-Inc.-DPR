var A5=Object.defineProperty;var N5=(r,e,t)=>e in r?A5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var nt=(r,e,t)=>N5(r,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var Dp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function nb(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Rv={exports:{}},qh={},jv={exports:{}},Ut={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HE;function I5(){if(HE)return Ut;HE=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),p=Symbol.iterator;function g(z){return z===null||typeof z!="object"?null:(z=p&&z[p]||z["@@iterator"],typeof z=="function"?z:null)}var v={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,x={};function b(z,Z,J){this.props=z,this.context=Z,this.refs=x,this.updater=J||v}b.prototype.isReactComponent={},b.prototype.setState=function(z,Z){if(typeof z!="object"&&typeof z!="function"&&z!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,z,Z,"setState")},b.prototype.forceUpdate=function(z){this.updater.enqueueForceUpdate(this,z,"forceUpdate")};function S(){}S.prototype=b.prototype;function N(z,Z,J){this.props=z,this.context=Z,this.refs=x,this.updater=J||v}var R=N.prototype=new S;R.constructor=N,E(R,b.prototype),R.isPureReactComponent=!0;var I=Array.isArray,j=Object.prototype.hasOwnProperty,U={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function k(z,Z,J){var ae,le={},Q=null,ce=null;if(Z!=null)for(ae in Z.ref!==void 0&&(ce=Z.ref),Z.key!==void 0&&(Q=""+Z.key),Z)j.call(Z,ae)&&!P.hasOwnProperty(ae)&&(le[ae]=Z[ae]);var ue=arguments.length-2;if(ue===1)le.children=J;else if(1<ue){for(var fe=Array(ue),ve=0;ve<ue;ve++)fe[ve]=arguments[ve+2];le.children=fe}if(z&&z.defaultProps)for(ae in ue=z.defaultProps,ue)le[ae]===void 0&&(le[ae]=ue[ae]);return{$$typeof:r,type:z,key:Q,ref:ce,props:le,_owner:U.current}}function F(z,Z){return{$$typeof:r,type:z.type,key:Z,ref:z.ref,props:z.props,_owner:z._owner}}function O(z){return typeof z=="object"&&z!==null&&z.$$typeof===r}function C(z){var Z={"=":"=0",":":"=2"};return"$"+z.replace(/[=:]/g,function(J){return Z[J]})}var M=/\/+/g;function D(z,Z){return typeof z=="object"&&z!==null&&z.key!=null?C(""+z.key):Z.toString(36)}function $(z,Z,J,ae,le){var Q=typeof z;(Q==="undefined"||Q==="boolean")&&(z=null);var ce=!1;if(z===null)ce=!0;else switch(Q){case"string":case"number":ce=!0;break;case"object":switch(z.$$typeof){case r:case e:ce=!0}}if(ce)return ce=z,le=le(ce),z=ae===""?"."+D(ce,0):ae,I(le)?(J="",z!=null&&(J=z.replace(M,"$&/")+"/"),$(le,Z,J,"",function(ve){return ve})):le!=null&&(O(le)&&(le=F(le,J+(!le.key||ce&&ce.key===le.key?"":(""+le.key).replace(M,"$&/")+"/")+z)),Z.push(le)),1;if(ce=0,ae=ae===""?".":ae+":",I(z))for(var ue=0;ue<z.length;ue++){Q=z[ue];var fe=ae+D(Q,ue);ce+=$(Q,Z,J,fe,le)}else if(fe=g(z),typeof fe=="function")for(z=fe.call(z),ue=0;!(Q=z.next()).done;)Q=Q.value,fe=ae+D(Q,ue++),ce+=$(Q,Z,J,fe,le);else if(Q==="object")throw Z=String(z),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(z).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.");return ce}function K(z,Z,J){if(z==null)return z;var ae=[],le=0;return $(z,ae,"","",function(Q){return Z.call(J,Q,le++)}),ae}function ee(z){if(z._status===-1){var Z=z._result;Z=Z(),Z.then(function(J){(z._status===0||z._status===-1)&&(z._status=1,z._result=J)},function(J){(z._status===0||z._status===-1)&&(z._status=2,z._result=J)}),z._status===-1&&(z._status=0,z._result=Z)}if(z._status===1)return z._result.default;throw z._result}var se={current:null},ie={transition:null},re={ReactCurrentDispatcher:se,ReactCurrentBatchConfig:ie,ReactCurrentOwner:U};function G(){throw Error("act(...) is not supported in production builds of React.")}return Ut.Children={map:K,forEach:function(z,Z,J){K(z,function(){Z.apply(this,arguments)},J)},count:function(z){var Z=0;return K(z,function(){Z++}),Z},toArray:function(z){return K(z,function(Z){return Z})||[]},only:function(z){if(!O(z))throw Error("React.Children.only expected to receive a single React element child.");return z}},Ut.Component=b,Ut.Fragment=t,Ut.Profiler=i,Ut.PureComponent=N,Ut.StrictMode=n,Ut.Suspense=d,Ut.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=re,Ut.act=G,Ut.cloneElement=function(z,Z,J){if(z==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+z+".");var ae=E({},z.props),le=z.key,Q=z.ref,ce=z._owner;if(Z!=null){if(Z.ref!==void 0&&(Q=Z.ref,ce=U.current),Z.key!==void 0&&(le=""+Z.key),z.type&&z.type.defaultProps)var ue=z.type.defaultProps;for(fe in Z)j.call(Z,fe)&&!P.hasOwnProperty(fe)&&(ae[fe]=Z[fe]===void 0&&ue!==void 0?ue[fe]:Z[fe])}var fe=arguments.length-2;if(fe===1)ae.children=J;else if(1<fe){ue=Array(fe);for(var ve=0;ve<fe;ve++)ue[ve]=arguments[ve+2];ae.children=ue}return{$$typeof:r,type:z.type,key:le,ref:Q,props:ae,_owner:ce}},Ut.createContext=function(z){return z={$$typeof:o,_currentValue:z,_currentValue2:z,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},z.Provider={$$typeof:s,_context:z},z.Consumer=z},Ut.createElement=k,Ut.createFactory=function(z){var Z=k.bind(null,z);return Z.type=z,Z},Ut.createRef=function(){return{current:null}},Ut.forwardRef=function(z){return{$$typeof:l,render:z}},Ut.isValidElement=O,Ut.lazy=function(z){return{$$typeof:m,_payload:{_status:-1,_result:z},_init:ee}},Ut.memo=function(z,Z){return{$$typeof:f,type:z,compare:Z===void 0?null:Z}},Ut.startTransition=function(z){var Z=ie.transition;ie.transition={};try{z()}finally{ie.transition=Z}},Ut.unstable_act=G,Ut.useCallback=function(z,Z){return se.current.useCallback(z,Z)},Ut.useContext=function(z){return se.current.useContext(z)},Ut.useDebugValue=function(){},Ut.useDeferredValue=function(z){return se.current.useDeferredValue(z)},Ut.useEffect=function(z,Z){return se.current.useEffect(z,Z)},Ut.useId=function(){return se.current.useId()},Ut.useImperativeHandle=function(z,Z,J){return se.current.useImperativeHandle(z,Z,J)},Ut.useInsertionEffect=function(z,Z){return se.current.useInsertionEffect(z,Z)},Ut.useLayoutEffect=function(z,Z){return se.current.useLayoutEffect(z,Z)},Ut.useMemo=function(z,Z){return se.current.useMemo(z,Z)},Ut.useReducer=function(z,Z,J){return se.current.useReducer(z,Z,J)},Ut.useRef=function(z){return se.current.useRef(z)},Ut.useState=function(z){return se.current.useState(z)},Ut.useSyncExternalStore=function(z,Z,J){return se.current.useSyncExternalStore(z,Z,J)},Ut.useTransition=function(){return se.current.useTransition()},Ut.version="18.3.1",Ut}var $E;function wy(){return $E||($E=1,jv.exports=I5()),jv.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WE;function P5(){if(WE)return qh;WE=1;var r=wy(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,d,f){var m,p={},g=null,v=null;f!==void 0&&(g=""+f),d.key!==void 0&&(g=""+d.key),d.ref!==void 0&&(v=d.ref);for(m in d)n.call(d,m)&&!s.hasOwnProperty(m)&&(p[m]=d[m]);if(l&&l.defaultProps)for(m in d=l.defaultProps,d)p[m]===void 0&&(p[m]=d[m]);return{$$typeof:e,type:l,key:g,ref:v,props:p,_owner:i.current}}return qh.Fragment=t,qh.jsx=o,qh.jsxs=o,qh}var GE;function k5(){return GE||(GE=1,Rv.exports=P5()),Rv.exports}var c=k5(),X=wy();const ss=nb(X);var Mp={},Ov={exports:{}},Di={},Dv={exports:{}},Mv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var KE;function C5(){return KE||(KE=1,function(r){function e(ie,re){var G=ie.length;ie.push(re);e:for(;0<G;){var z=G-1>>>1,Z=ie[z];if(0<i(Z,re))ie[z]=re,ie[G]=Z,G=z;else break e}}function t(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var re=ie[0],G=ie.pop();if(G!==re){ie[0]=G;e:for(var z=0,Z=ie.length,J=Z>>>1;z<J;){var ae=2*(z+1)-1,le=ie[ae],Q=ae+1,ce=ie[Q];if(0>i(le,G))Q<Z&&0>i(ce,le)?(ie[z]=ce,ie[Q]=G,z=Q):(ie[z]=le,ie[ae]=G,z=ae);else if(Q<Z&&0>i(ce,G))ie[z]=ce,ie[Q]=G,z=Q;else break e}}return re}function i(ie,re){var G=ie.sortIndex-re.sortIndex;return G!==0?G:ie.id-re.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();r.unstable_now=function(){return o.now()-l}}var d=[],f=[],m=1,p=null,g=3,v=!1,E=!1,x=!1,b=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(ie){for(var re=t(f);re!==null;){if(re.callback===null)n(f);else if(re.startTime<=ie)n(f),re.sortIndex=re.expirationTime,e(d,re);else break;re=t(f)}}function I(ie){if(x=!1,R(ie),!E)if(t(d)!==null)E=!0,ee(j);else{var re=t(f);re!==null&&se(I,re.startTime-ie)}}function j(ie,re){E=!1,x&&(x=!1,S(k),k=-1),v=!0;var G=g;try{for(R(re),p=t(d);p!==null&&(!(p.expirationTime>re)||ie&&!C());){var z=p.callback;if(typeof z=="function"){p.callback=null,g=p.priorityLevel;var Z=z(p.expirationTime<=re);re=r.unstable_now(),typeof Z=="function"?p.callback=Z:p===t(d)&&n(d),R(re)}else n(d);p=t(d)}if(p!==null)var J=!0;else{var ae=t(f);ae!==null&&se(I,ae.startTime-re),J=!1}return J}finally{p=null,g=G,v=!1}}var U=!1,P=null,k=-1,F=5,O=-1;function C(){return!(r.unstable_now()-O<F)}function M(){if(P!==null){var ie=r.unstable_now();O=ie;var re=!0;try{re=P(!0,ie)}finally{re?D():(U=!1,P=null)}}else U=!1}var D;if(typeof N=="function")D=function(){N(M)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,K=$.port2;$.port1.onmessage=M,D=function(){K.postMessage(null)}}else D=function(){b(M,0)};function ee(ie){P=ie,U||(U=!0,D())}function se(ie,re){k=b(function(){ie(r.unstable_now())},re)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(ie){ie.callback=null},r.unstable_continueExecution=function(){E||v||(E=!0,ee(j))},r.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<ie?Math.floor(1e3/ie):5},r.unstable_getCurrentPriorityLevel=function(){return g},r.unstable_getFirstCallbackNode=function(){return t(d)},r.unstable_next=function(ie){switch(g){case 1:case 2:case 3:var re=3;break;default:re=g}var G=g;g=re;try{return ie()}finally{g=G}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(ie,re){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var G=g;g=ie;try{return re()}finally{g=G}},r.unstable_scheduleCallback=function(ie,re,G){var z=r.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?z+G:z):G=z,ie){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=G+Z,ie={id:m++,callback:re,priorityLevel:ie,startTime:G,expirationTime:Z,sortIndex:-1},G>z?(ie.sortIndex=G,e(f,ie),t(d)===null&&ie===t(f)&&(x?(S(k),k=-1):x=!0,se(I,G-z))):(ie.sortIndex=Z,e(d,ie),E||v||(E=!0,ee(j))),ie},r.unstable_shouldYield=C,r.unstable_wrapCallback=function(ie){var re=g;return function(){var G=g;g=re;try{return ie.apply(this,arguments)}finally{g=G}}}}(Mv)),Mv}var YE;function R5(){return YE||(YE=1,Dv.exports=C5()),Dv.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ZE;function j5(){if(ZE)return Di;ZE=1;var r=wy(),e=R5();function t(a){for(var h="https://reactjs.org/docs/error-decoder.html?invariant="+a,_=1;_<arguments.length;_++)h+="&args[]="+encodeURIComponent(arguments[_]);return"Minified React error #"+a+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function s(a,h){o(a,h),o(a+"Capture",h)}function o(a,h){for(i[a]=h,a=0;a<h.length;a++)n.add(h[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},p={};function g(a){return d.call(p,a)?!0:d.call(m,a)?!1:f.test(a)?p[a]=!0:(m[a]=!0,!1)}function v(a,h,_,A){if(_!==null&&_.type===0)return!1;switch(typeof h){case"function":case"symbol":return!0;case"boolean":return A?!1:_!==null?!_.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function E(a,h,_,A){if(h===null||typeof h>"u"||v(a,h,_,A))return!0;if(A)return!1;if(_!==null)switch(_.type){case 3:return!h;case 4:return h===!1;case 5:return isNaN(h);case 6:return isNaN(h)||1>h}return!1}function x(a,h,_,A,B,H,te){this.acceptsBooleans=h===2||h===3||h===4,this.attributeName=A,this.attributeNamespace=B,this.mustUseProperty=_,this.propertyName=a,this.type=h,this.sanitizeURL=H,this.removeEmptyString=te}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){b[a]=new x(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var h=a[0];b[h]=new x(h,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){b[a]=new x(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){b[a]=new x(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){b[a]=new x(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){b[a]=new x(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){b[a]=new x(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){b[a]=new x(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){b[a]=new x(a,5,!1,a.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function N(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var h=a.replace(S,N);b[h]=new x(h,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var h=a.replace(S,N);b[h]=new x(h,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var h=a.replace(S,N);b[h]=new x(h,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){b[a]=new x(a,1,!1,a.toLowerCase(),null,!1,!1)}),b.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){b[a]=new x(a,1,!1,a.toLowerCase(),null,!0,!0)});function R(a,h,_,A){var B=b.hasOwnProperty(h)?b[h]:null;(B!==null?B.type!==0:A||!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(E(h,_,B,A)&&(_=null),A||B===null?g(h)&&(_===null?a.removeAttribute(h):a.setAttribute(h,""+_)):B.mustUseProperty?a[B.propertyName]=_===null?B.type===3?!1:"":_:(h=B.attributeName,A=B.attributeNamespace,_===null?a.removeAttribute(h):(B=B.type,_=B===3||B===4&&_===!0?"":""+_,A?a.setAttributeNS(A,h,_):a.setAttribute(h,_))))}var I=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,j=Symbol.for("react.element"),U=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),C=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),$=Symbol.for("react.suspense_list"),K=Symbol.for("react.memo"),ee=Symbol.for("react.lazy"),se=Symbol.for("react.offscreen"),ie=Symbol.iterator;function re(a){return a===null||typeof a!="object"?null:(a=ie&&a[ie]||a["@@iterator"],typeof a=="function"?a:null)}var G=Object.assign,z;function Z(a){if(z===void 0)try{throw Error()}catch(_){var h=_.stack.trim().match(/\n( *(at )?)/);z=h&&h[1]||""}return`
`+z+a}var J=!1;function ae(a,h){if(!a||J)return"";J=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(h)if(h=function(){throw Error()},Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(Se){var A=Se}Reflect.construct(a,[],h)}else{try{h.call()}catch(Se){A=Se}a.call(h.prototype)}else{try{throw Error()}catch(Se){A=Se}a()}}catch(Se){if(Se&&A&&typeof Se.stack=="string"){for(var B=Se.stack.split(`
`),H=A.stack.split(`
`),te=B.length-1,de=H.length-1;1<=te&&0<=de&&B[te]!==H[de];)de--;for(;1<=te&&0<=de;te--,de--)if(B[te]!==H[de]){if(te!==1||de!==1)do if(te--,de--,0>de||B[te]!==H[de]){var me=`
`+B[te].replace(" at new "," at ");return a.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",a.displayName)),me}while(1<=te&&0<=de);break}}}finally{J=!1,Error.prepareStackTrace=_}return(a=a?a.displayName||a.name:"")?Z(a):""}function le(a){switch(a.tag){case 5:return Z(a.type);case 16:return Z("Lazy");case 13:return Z("Suspense");case 19:return Z("SuspenseList");case 0:case 2:case 15:return a=ae(a.type,!1),a;case 11:return a=ae(a.type.render,!1),a;case 1:return a=ae(a.type,!0),a;default:return""}}function Q(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case P:return"Fragment";case U:return"Portal";case F:return"Profiler";case k:return"StrictMode";case D:return"Suspense";case $:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case C:return(a.displayName||"Context")+".Consumer";case O:return(a._context.displayName||"Context")+".Provider";case M:var h=a.render;return a=a.displayName,a||(a=h.displayName||h.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case K:return h=a.displayName||null,h!==null?h:Q(a.type)||"Memo";case ee:h=a._payload,a=a._init;try{return Q(a(h))}catch{}}return null}function ce(a){var h=a.type;switch(a.tag){case 24:return"Cache";case 9:return(h.displayName||"Context")+".Consumer";case 10:return(h._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=h.render,a=a.displayName||a.name||"",h.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return h;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Q(h);case 8:return h===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h}return null}function ue(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function fe(a){var h=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function ve(a){var h=fe(a)?"checked":"value",_=Object.getOwnPropertyDescriptor(a.constructor.prototype,h),A=""+a[h];if(!a.hasOwnProperty(h)&&typeof _<"u"&&typeof _.get=="function"&&typeof _.set=="function"){var B=_.get,H=_.set;return Object.defineProperty(a,h,{configurable:!0,get:function(){return B.call(this)},set:function(te){A=""+te,H.call(this,te)}}),Object.defineProperty(a,h,{enumerable:_.enumerable}),{getValue:function(){return A},setValue:function(te){A=""+te},stopTracking:function(){a._valueTracker=null,delete a[h]}}}}function Me(a){a._valueTracker||(a._valueTracker=ve(a))}function Pe(a){if(!a)return!1;var h=a._valueTracker;if(!h)return!0;var _=h.getValue(),A="";return a&&(A=fe(a)?a.checked?"true":"false":a.value),a=A,a!==_?(h.setValue(a),!0):!1}function qe(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function Ge(a,h){var _=h.checked;return G({},h,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:_??a._wrapperState.initialChecked})}function lt(a,h){var _=h.defaultValue==null?"":h.defaultValue,A=h.checked!=null?h.checked:h.defaultChecked;_=ue(h.value!=null?h.value:_),a._wrapperState={initialChecked:A,initialValue:_,controlled:h.type==="checkbox"||h.type==="radio"?h.checked!=null:h.value!=null}}function Ct(a,h){h=h.checked,h!=null&&R(a,"checked",h,!1)}function bt(a,h){Ct(a,h);var _=ue(h.value),A=h.type;if(_!=null)A==="number"?(_===0&&a.value===""||a.value!=_)&&(a.value=""+_):a.value!==""+_&&(a.value=""+_);else if(A==="submit"||A==="reset"){a.removeAttribute("value");return}h.hasOwnProperty("value")?Ie(a,h.type,_):h.hasOwnProperty("defaultValue")&&Ie(a,h.type,ue(h.defaultValue)),h.checked==null&&h.defaultChecked!=null&&(a.defaultChecked=!!h.defaultChecked)}function Te(a,h,_){if(h.hasOwnProperty("value")||h.hasOwnProperty("defaultValue")){var A=h.type;if(!(A!=="submit"&&A!=="reset"||h.value!==void 0&&h.value!==null))return;h=""+a._wrapperState.initialValue,_||h===a.value||(a.value=h),a.defaultValue=h}_=a.name,_!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,_!==""&&(a.name=_)}function Ie(a,h,_){(h!=="number"||qe(a.ownerDocument)!==a)&&(_==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+_&&(a.defaultValue=""+_))}var Le=Array.isArray;function Be(a,h,_,A){if(a=a.options,h){h={};for(var B=0;B<_.length;B++)h["$"+_[B]]=!0;for(_=0;_<a.length;_++)B=h.hasOwnProperty("$"+a[_].value),a[_].selected!==B&&(a[_].selected=B),B&&A&&(a[_].defaultSelected=!0)}else{for(_=""+ue(_),h=null,B=0;B<a.length;B++){if(a[B].value===_){a[B].selected=!0,A&&(a[B].defaultSelected=!0);return}h!==null||a[B].disabled||(h=a[B])}h!==null&&(h.selected=!0)}}function ke(a,h){if(h.dangerouslySetInnerHTML!=null)throw Error(t(91));return G({},h,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function _t(a,h){var _=h.value;if(_==null){if(_=h.children,h=h.defaultValue,_!=null){if(h!=null)throw Error(t(92));if(Le(_)){if(1<_.length)throw Error(t(93));_=_[0]}h=_}h==null&&(h=""),_=h}a._wrapperState={initialValue:ue(_)}}function gt(a,h){var _=ue(h.value),A=ue(h.defaultValue);_!=null&&(_=""+_,_!==a.value&&(a.value=_),h.defaultValue==null&&a.defaultValue!==_&&(a.defaultValue=_)),A!=null&&(a.defaultValue=""+A)}function yt(a){var h=a.textContent;h===a._wrapperState.initialValue&&h!==""&&h!==null&&(a.value=h)}function kt(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ft(a,h){return a==null||a==="http://www.w3.org/1999/xhtml"?kt(h):a==="http://www.w3.org/2000/svg"&&h==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var Vt,cs=function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(h,_,A,B){MSApp.execUnsafeLocalFunction(function(){return a(h,_,A,B)})}:a}(function(a,h){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=h;else{for(Vt=Vt||document.createElement("div"),Vt.innerHTML="<svg>"+h.valueOf().toString()+"</svg>",h=Vt.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;h.firstChild;)a.appendChild(h.firstChild)}});function Gt(a,h){if(h){var _=a.firstChild;if(_&&_===a.lastChild&&_.nodeType===3){_.nodeValue=h;return}}a.textContent=h}var Fn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},us=["Webkit","ms","Moz","O"];Object.keys(Fn).forEach(function(a){us.forEach(function(h){h=h+a.charAt(0).toUpperCase()+a.substring(1),Fn[h]=Fn[a]})});function Ui(a,h,_){return h==null||typeof h=="boolean"||h===""?"":_||typeof h!="number"||h===0||Fn.hasOwnProperty(a)&&Fn[a]?(""+h).trim():h+"px"}function yi(a,h){a=a.style;for(var _ in h)if(h.hasOwnProperty(_)){var A=_.indexOf("--")===0,B=Ui(_,h[_],A);_==="float"&&(_="cssFloat"),A?a.setProperty(_,B):a[_]=B}}var yr=G({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vi(a,h){if(h){if(yr[a]&&(h.children!=null||h.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(h.dangerouslySetInnerHTML!=null){if(h.children!=null)throw Error(t(60));if(typeof h.dangerouslySetInnerHTML!="object"||!("__html"in h.dangerouslySetInnerHTML))throw Error(t(61))}if(h.style!=null&&typeof h.style!="object")throw Error(t(62))}}function ni(a,h){if(a.indexOf("-")===-1)return typeof h.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qi=null;function ho(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var _i=null,er=null,ri=null;function xi(a){if(a=oa(a)){if(typeof _i!="function")throw Error(t(280));var h=a.stateNode;h&&(h=Ku(h),_i(a.stateNode,a.type,h))}}function bi(a){er?ri?ri.push(a):ri=[a]:er=a}function qo(){if(er){var a=er,h=ri;if(ri=er=null,xi(a),h)for(a=0;a<h.length;a++)xi(h[a])}}function vn(a,h){return a(h)}function wi(){}var Hi=!1;function ds(a,h,_){if(Hi)return a(h,_);Hi=!0;try{return vn(a,h,_)}finally{Hi=!1,(er!==null||ri!==null)&&(wi(),qo())}}function bn(a,h){var _=a.stateNode;if(_===null)return null;var A=Ku(_);if(A===null)return null;_=A[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(A=!A.disabled)||(a=a.type,A=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!A;break e;default:a=!1}if(a)return null;if(_&&typeof _!="function")throw Error(t(231,h,typeof _));return _}var Vs=!1;if(l)try{var Br={};Object.defineProperty(Br,"passive",{get:function(){Vs=!0}}),window.addEventListener("test",Br,Br),window.removeEventListener("test",Br,Br)}catch{Vs=!1}function Bs(a,h,_,A,B,H,te,de,me){var Se=Array.prototype.slice.call(arguments,3);try{h.apply(_,Se)}catch(Oe){this.onError(Oe)}}var cn=!1,Ke=null,Ir=!1,zs=null,fo={onError:function(a){cn=!0,Ke=a}};function hs(a,h,_,A,B,H,te,de,me){cn=!1,Ke=null,Bs.apply(fo,arguments)}function vr(a,h,_,A,B,H,te,de,me){if(hs.apply(this,arguments),cn){if(cn){var Se=Ke;cn=!1,Ke=null}else throw Error(t(198));Ir||(Ir=!0,zs=Se)}}function Pr(a){var h=a,_=a;if(a.alternate)for(;h.return;)h=h.return;else{a=h;do h=a,(h.flags&4098)!==0&&(_=h.return),a=h.return;while(a)}return h.tag===3?_:null}function kr(a){if(a.tag===13){var h=a.memoizedState;if(h===null&&(a=a.alternate,a!==null&&(h=a.memoizedState)),h!==null)return h.dehydrated}return null}function Cr(a){if(Pr(a)!==a)throw Error(t(188))}function Ho(a){var h=a.alternate;if(!h){if(h=Pr(a),h===null)throw Error(t(188));return h!==a?null:a}for(var _=a,A=h;;){var B=_.return;if(B===null)break;var H=B.alternate;if(H===null){if(A=B.return,A!==null){_=A;continue}break}if(B.child===H.child){for(H=B.child;H;){if(H===_)return Cr(B),a;if(H===A)return Cr(B),h;H=H.sibling}throw Error(t(188))}if(_.return!==A.return)_=B,A=H;else{for(var te=!1,de=B.child;de;){if(de===_){te=!0,_=B,A=H;break}if(de===A){te=!0,A=B,_=H;break}de=de.sibling}if(!te){for(de=H.child;de;){if(de===_){te=!0,_=H,A=B;break}if(de===A){te=!0,A=H,_=B;break}de=de.sibling}if(!te)throw Error(t(189))}}if(_.alternate!==A)throw Error(t(190))}if(_.tag!==3)throw Error(t(188));return _.stateNode.current===_?a:h}function $o(a){return a=Ho(a),a!==null?et(a):null}function et(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var h=et(a);if(h!==null)return h;a=a.sibling}return null}var pe=e.unstable_scheduleCallback,De=e.unstable_cancelCallback,Qe=e.unstable_shouldYield,Qt=e.unstable_requestPaint,Pt=e.unstable_now,wn=e.unstable_getCurrentPriorityLevel,Rn=e.unstable_ImmediatePriority,tr=e.unstable_UserBlockingPriority,Kn=e.unstable_NormalPriority,$i=e.unstable_LowPriority,_n=e.unstable_IdlePriority,Wi=null,lr=null;function mo(a){if(lr&&typeof lr.onCommitFiberRoot=="function")try{lr.onCommitFiberRoot(Wi,a,void 0,(a.current.flags&128)===128)}catch{}}var At=Math.clz32?Math.clz32:Us,un=Math.log,Wo=Math.LN2;function Us(a){return a>>>=0,a===0?32:31-(un(a)/Wo|0)|0}var Gi=64,po=4194304;function wt(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function dn(a,h){var _=a.pendingLanes;if(_===0)return 0;var A=0,B=a.suspendedLanes,H=a.pingedLanes,te=_&268435455;if(te!==0){var de=te&~B;de!==0?A=wt(de):(H&=te,H!==0&&(A=wt(H)))}else te=_&~B,te!==0?A=wt(te):H!==0&&(A=wt(H));if(A===0)return 0;if(h!==0&&h!==A&&(h&B)===0&&(B=A&-A,H=h&-h,B>=H||B===16&&(H&4194240)!==0))return h;if((A&4)!==0&&(A|=_&16),h=a.entangledLanes,h!==0)for(a=a.entanglements,h&=A;0<h;)_=31-At(h),B=1<<_,A|=a[_],h&=~B;return A}function yc(a,h){switch(a){case 1:case 2:case 4:return h+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ei(a,h){for(var _=a.suspendedLanes,A=a.pingedLanes,B=a.expirationTimes,H=a.pendingLanes;0<H;){var te=31-At(H),de=1<<te,me=B[te];me===-1?((de&_)===0||(de&A)!==0)&&(B[te]=yc(de,h)):me<=h&&(a.expiredLanes|=de),H&=~de}}function Tn(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Go(){var a=Gi;return Gi<<=1,(Gi&4194240)===0&&(Gi=64),a}function Ki(a){for(var h=[],_=0;31>_;_++)h.push(a);return h}function zr(a,h,_){a.pendingLanes|=h,h!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,h=31-At(h),a[h]=_}function Nt(a,h){var _=a.pendingLanes&~h;a.pendingLanes=h,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=h,a.mutableReadLanes&=h,a.entangledLanes&=h,h=a.entanglements;var A=a.eventTimes;for(a=a.expirationTimes;0<_;){var B=31-At(_),H=1<<B;h[B]=0,A[B]=-1,a[B]=-1,_&=~H}}function Ur(a,h){var _=a.entangledLanes|=h;for(a=a.entanglements;_;){var A=31-At(_),B=1<<A;B&h|a[A]&h&&(a[A]|=h),_&=~B}}var jt=0;function Si(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var Ga,fs,Ka,Ya,Ko,Yo=!1,Ti=[],qn=null,Ai=null,ii=null,go=new Map,dt=new Map,Yn=[],rn="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function vc(a,h){switch(a){case"focusin":case"focusout":qn=null;break;case"dragenter":case"dragleave":Ai=null;break;case"mouseover":case"mouseout":ii=null;break;case"pointerover":case"pointerout":go.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":dt.delete(h.pointerId)}}function _r(a,h,_,A,B,H){return a===null||a.nativeEvent!==H?(a={blockedOn:h,domEventName:_,eventSystemFlags:A,nativeEvent:H,targetContainers:[B]},h!==null&&(h=oa(h),h!==null&&fs(h)),a):(a.eventSystemFlags|=A,h=a.targetContainers,B!==null&&h.indexOf(B)===-1&&h.push(B),a)}function _c(a,h,_,A,B){switch(h){case"focusin":return qn=_r(qn,a,h,_,A,B),!0;case"dragenter":return Ai=_r(Ai,a,h,_,A,B),!0;case"mouseover":return ii=_r(ii,a,h,_,A,B),!0;case"pointerover":var H=B.pointerId;return go.set(H,_r(go.get(H)||null,a,h,_,A,B)),!0;case"gotpointercapture":return H=B.pointerId,dt.set(H,_r(dt.get(H)||null,a,h,_,A,B)),!0}return!1}function Za(a){var h=sa(a.target);if(h!==null){var _=Pr(h);if(_!==null){if(h=_.tag,h===13){if(h=kr(_),h!==null){a.blockedOn=h,Ko(a.priority,function(){Ka(_)});return}}else if(h===3&&_.stateNode.current.memoizedState.isDehydrated){a.blockedOn=_.tag===3?_.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Rr(a){if(a.blockedOn!==null)return!1;for(var h=a.targetContainers;0<h.length;){var _=Xo(a.domEventName,a.eventSystemFlags,h[0],a.nativeEvent);if(_===null){_=a.nativeEvent;var A=new _.constructor(_.type,_);qi=A,_.target.dispatchEvent(A),qi=null}else return h=oa(_),h!==null&&fs(h),a.blockedOn=_,!1;h.shift()}return!0}function qs(a,h,_){Rr(a)&&_.delete(h)}function yo(){Yo=!1,qn!==null&&Rr(qn)&&(qn=null),Ai!==null&&Rr(Ai)&&(Ai=null),ii!==null&&Rr(ii)&&(ii=null),go.forEach(qs),dt.forEach(qs)}function hn(a,h){a.blockedOn===h&&(a.blockedOn=null,Yo||(Yo=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,yo)))}function cr(a){function h(B){return hn(B,a)}if(0<Ti.length){hn(Ti[0],a);for(var _=1;_<Ti.length;_++){var A=Ti[_];A.blockedOn===a&&(A.blockedOn=null)}}for(qn!==null&&hn(qn,a),Ai!==null&&hn(Ai,a),ii!==null&&hn(ii,a),go.forEach(h),dt.forEach(h),_=0;_<Yn.length;_++)A=Yn[_],A.blockedOn===a&&(A.blockedOn=null);for(;0<Yn.length&&(_=Yn[0],_.blockedOn===null);)Za(_),_.blockedOn===null&&Yn.shift()}var ms=I.ReactCurrentBatchConfig,Hs=!0;function An(a,h,_,A){var B=jt,H=ms.transition;ms.transition=null;try{jt=1,Zo(a,h,_,A)}finally{jt=B,ms.transition=H}}function Ou(a,h,_,A){var B=jt,H=ms.transition;ms.transition=null;try{jt=4,Zo(a,h,_,A)}finally{jt=B,ms.transition=H}}function Zo(a,h,_,A){if(Hs){var B=Xo(a,h,_,A);if(B===null)u(a,h,A,Qo,_),vc(a,A);else if(_c(B,a,h,_,A))A.stopPropagation();else if(vc(a,A),h&4&&-1<rn.indexOf(a)){for(;B!==null;){var H=oa(B);if(H!==null&&Ga(H),H=Xo(a,h,_,A),H===null&&u(a,h,A,Qo,_),H===B)break;B=H}B!==null&&A.stopPropagation()}else u(a,h,A,null,_)}}var Qo=null;function Xo(a,h,_,A){if(Qo=null,a=ho(A),a=sa(a),a!==null)if(h=Pr(a),h===null)a=null;else if(_=h.tag,_===13){if(a=kr(h),a!==null)return a;a=null}else if(_===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;a=null}else h!==a&&(a=null);return Qo=a,null}function Dt(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(wn()){case Rn:return 1;case tr:return 4;case Kn:case $i:return 16;case _n:return 536870912;default:return 16}default:return 16}}var si=null,xr=null,nr=null;function Qa(){if(nr)return nr;var a,h=xr,_=h.length,A,B="value"in si?si.value:si.textContent,H=B.length;for(a=0;a<_&&h[a]===B[a];a++);var te=_-a;for(A=1;A<=te&&h[_-A]===B[H-A];A++);return nr=B.slice(a,1<A?1-A:void 0)}function Xa(a){var h=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&h===13&&(a=13)):a=h,a===10&&(a=13),32<=a||a===13?a:0}function Ni(){return!0}function xc(){return!1}function rr(a){function h(_,A,B,H,te){this._reactName=_,this._targetInst=B,this.type=A,this.nativeEvent=H,this.target=te,this.currentTarget=null;for(var de in a)a.hasOwnProperty(de)&&(_=a[de],this[de]=_?_(H):H[de]);return this.isDefaultPrevented=(H.defaultPrevented!=null?H.defaultPrevented:H.returnValue===!1)?Ni:xc,this.isPropagationStopped=xc,this}return G(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var _=this.nativeEvent;_&&(_.preventDefault?_.preventDefault():typeof _.returnValue!="unknown"&&(_.returnValue=!1),this.isDefaultPrevented=Ni)},stopPropagation:function(){var _=this.nativeEvent;_&&(_.stopPropagation?_.stopPropagation():typeof _.cancelBubble!="unknown"&&(_.cancelBubble=!0),this.isPropagationStopped=Ni)},persist:function(){},isPersistent:Ni}),h}var Yi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Ja=rr(Yi),Ii=G({},Yi,{view:0,detail:0}),gh=rr(Ii),jr,$s,Ws,qr=G({},Ii,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hr,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Ws&&(Ws&&a.type==="mousemove"?(jr=a.screenX-Ws.screenX,$s=a.screenY-Ws.screenY):$s=jr=0,Ws=a),jr)},movementY:function(a){return"movementY"in a?a.movementY:$s}}),Jo=rr(qr),el=G({},qr,{dataTransfer:0}),tl=rr(el),nl=G({},Ii,{relatedTarget:0}),ea=rr(nl),bc=G({},Yi,{animationName:0,elapsedTime:0,pseudoElement:0}),Gs=rr(bc),Du=G({},Yi,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),rl=rr(Du),Mu=G({},Yi,{data:0}),il=rr(Mu),ta={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ir={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ps={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Lu(a){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(a):(a=ps[a])?!!h[a]:!1}function Hr(){return Lu}var w=G({},Ii,{key:function(a){if(a.key){var h=ta[a.key]||a.key;if(h!=="Unidentified")return h}return a.type==="keypress"?(a=Xa(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?ir[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hr,charCode:function(a){return a.type==="keypress"?Xa(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Xa(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),q=rr(w),Y=G({},qr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),oe=rr(Y),ye=G({},Ii,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hr}),Ae=rr(ye),He=G({},Yi,{propertyName:0,elapsedTime:0,pseudoElement:0}),nn=rr(He),Hn=G({},qr,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Ht=rr(Hn),sn=[9,13,27,32],En=l&&"CompositionEvent"in window,Pi=null;l&&"documentMode"in document&&(Pi=document.documentMode);var Vn=l&&"TextEvent"in window&&!Pi,na=l&&(!En||Pi&&8<Pi&&11>=Pi),Zi=" ",Vm=!1;function sl(a,h){switch(a){case"keyup":return sn.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function yh(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Ks=!1;function E0(a,h){switch(a){case"compositionend":return yh(h);case"keypress":return h.which!==32?null:(Vm=!0,Zi);case"textInput":return a=h.data,a===Zi&&Vm?null:a;default:return null}}function vo(a,h){if(Ks)return a==="compositionend"||!En&&sl(a,h)?(a=Qa(),nr=xr=si=null,Ks=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return na&&h.locale!=="ko"?null:h.data;default:return null}}var Fu={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Bm(a){var h=a&&a.nodeName&&a.nodeName.toLowerCase();return h==="input"?!!Fu[a.type]:h==="textarea"}function Vu(a,h,_,A){bi(A),h=T(h,"onChange"),0<h.length&&(_=new Ja("onChange","change",null,_,A),a.push({event:_,listeners:h}))}var wc=null,oi=null;function S0(a){Ah(a,0)}function Ys(a){var h=aa(a);if(Pe(h))return a}function T0(a,h){if(a==="change")return h}var gs=!1;if(l){var ol;if(l){var Bu="oninput"in document;if(!Bu){var zu=document.createElement("div");zu.setAttribute("oninput","return;"),Bu=typeof zu.oninput=="function"}ol=Bu}else ol=!1;gs=ol&&(!document.documentMode||9<document.documentMode)}function Ec(){wc&&(wc.detachEvent("onpropertychange",Uu),oi=wc=null)}function Uu(a){if(a.propertyName==="value"&&Ys(oi)){var h=[];Vu(h,oi,a,ho(a)),ds(S0,h)}}function qu(a,h,_){a==="focusin"?(Ec(),wc=h,oi=_,wc.attachEvent("onpropertychange",Uu)):a==="focusout"&&Ec()}function al(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Ys(oi)}function Hu(a,h){if(a==="click")return Ys(h)}function vh(a,h){if(a==="input"||a==="change")return Ys(h)}function zm(a,h){return a===h&&(a!==0||1/a===1/h)||a!==a&&h!==h}var Qi=typeof Object.is=="function"?Object.is:zm;function _o(a,h){if(Qi(a,h))return!0;if(typeof a!="object"||a===null||typeof h!="object"||h===null)return!1;var _=Object.keys(a),A=Object.keys(h);if(_.length!==A.length)return!1;for(A=0;A<_.length;A++){var B=_[A];if(!d.call(h,B)||!Qi(a[B],h[B]))return!1}return!0}function Um(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function _h(a,h){var _=Um(a);a=0;for(var A;_;){if(_.nodeType===3){if(A=a+_.textContent.length,a<=h&&A>=h)return{node:_,offset:h-a};a=A}e:{for(;_;){if(_.nextSibling){_=_.nextSibling;break e}_=_.parentNode}_=void 0}_=Um(_)}}function qm(a,h){return a&&h?a===h?!0:a&&a.nodeType===3?!1:h&&h.nodeType===3?qm(a,h.parentNode):"contains"in a?a.contains(h):a.compareDocumentPosition?!!(a.compareDocumentPosition(h)&16):!1:!1}function xh(){for(var a=window,h=qe();h instanceof a.HTMLIFrameElement;){try{var _=typeof h.contentWindow.location.href=="string"}catch{_=!1}if(_)a=h.contentWindow;else break;h=qe(a.document)}return h}function bh(a){var h=a&&a.nodeName&&a.nodeName.toLowerCase();return h&&(h==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||h==="textarea"||a.contentEditable==="true")}function ys(a){var h=xh(),_=a.focusedElem,A=a.selectionRange;if(h!==_&&_&&_.ownerDocument&&qm(_.ownerDocument.documentElement,_)){if(A!==null&&bh(_)){if(h=A.start,a=A.end,a===void 0&&(a=h),"selectionStart"in _)_.selectionStart=h,_.selectionEnd=Math.min(a,_.value.length);else if(a=(h=_.ownerDocument||document)&&h.defaultView||window,a.getSelection){a=a.getSelection();var B=_.textContent.length,H=Math.min(A.start,B);A=A.end===void 0?H:Math.min(A.end,B),!a.extend&&H>A&&(B=A,A=H,H=B),B=_h(_,H);var te=_h(_,A);B&&te&&(a.rangeCount!==1||a.anchorNode!==B.node||a.anchorOffset!==B.offset||a.focusNode!==te.node||a.focusOffset!==te.offset)&&(h=h.createRange(),h.setStart(B.node,B.offset),a.removeAllRanges(),H>A?(a.addRange(h),a.extend(te.node,te.offset)):(h.setEnd(te.node,te.offset),a.addRange(h)))}}for(h=[],a=_;a=a.parentNode;)a.nodeType===1&&h.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof _.focus=="function"&&_.focus(),_=0;_<h.length;_++)a=h[_],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var $u=l&&"documentMode"in document&&11>=document.documentMode,ll=null,cl=null,Sc=null,Wu=!1;function Hm(a,h,_){var A=_.window===_?_.document:_.nodeType===9?_:_.ownerDocument;Wu||ll==null||ll!==qe(A)||(A=ll,"selectionStart"in A&&bh(A)?A={start:A.selectionStart,end:A.selectionEnd}:(A=(A.ownerDocument&&A.ownerDocument.defaultView||window).getSelection(),A={anchorNode:A.anchorNode,anchorOffset:A.anchorOffset,focusNode:A.focusNode,focusOffset:A.focusOffset}),Sc&&_o(Sc,A)||(Sc=A,A=T(cl,"onSelect"),0<A.length&&(h=new Ja("onSelect","select",null,h,_),a.push({event:h,listeners:A}),h.target=ll)))}function xo(a,h){var _={};return _[a.toLowerCase()]=h.toLowerCase(),_["Webkit"+a]="webkit"+h,_["Moz"+a]="moz"+h,_}var ul={animationend:xo("Animation","AnimationEnd"),animationiteration:xo("Animation","AnimationIteration"),animationstart:xo("Animation","AnimationStart"),transitionend:xo("Transition","TransitionEnd")},bo={},wh={};l&&(wh=document.createElement("div").style,"AnimationEvent"in window||(delete ul.animationend.animation,delete ul.animationiteration.animation,delete ul.animationstart.animation),"TransitionEvent"in window||delete ul.transitionend.transition);function Tc(a){if(bo[a])return bo[a];if(!ul[a])return a;var h=ul[a],_;for(_ in h)if(h.hasOwnProperty(_)&&_ in wh)return bo[a]=h[_];return a}var $m=Tc("animationend"),vs=Tc("animationiteration"),Eh=Tc("animationstart"),Sh=Tc("transitionend"),dl=new Map,Wm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xi(a,h){dl.set(a,h),s(h,[a])}for(var ra=0;ra<Wm.length;ra++){var Gu=Wm[ra],Gm=Gu.toLowerCase(),A0=Gu[0].toUpperCase()+Gu.slice(1);Xi(Gm,"on"+A0)}Xi($m,"onAnimationEnd"),Xi(vs,"onAnimationIteration"),Xi(Eh,"onAnimationStart"),Xi("dblclick","onDoubleClick"),Xi("focusin","onFocus"),Xi("focusout","onBlur"),Xi(Sh,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var hl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Km=new Set("cancel close invalid load scroll toggle".split(" ").concat(hl));function Th(a,h,_){var A=a.type||"unknown-event";a.currentTarget=_,vr(A,h,void 0,a),a.currentTarget=null}function Ah(a,h){h=(h&4)!==0;for(var _=0;_<a.length;_++){var A=a[_],B=A.event;A=A.listeners;e:{var H=void 0;if(h)for(var te=A.length-1;0<=te;te--){var de=A[te],me=de.instance,Se=de.currentTarget;if(de=de.listener,me!==H&&B.isPropagationStopped())break e;Th(B,de,Se),H=me}else for(te=0;te<A.length;te++){if(de=A[te],me=de.instance,Se=de.currentTarget,de=de.listener,me!==H&&B.isPropagationStopped())break e;Th(B,de,Se),H=me}}}if(Ir)throw a=zs,Ir=!1,zs=null,a}function xn(a,h){var _=h[gl];_===void 0&&(_=h[gl]=new Set);var A=a+"__bubble";_.has(A)||(Ym(h,a,2,!1),_.add(A))}function Nh(a,h,_){var A=0;h&&(A|=4),Ym(_,a,A,h)}var Ac="_reactListening"+Math.random().toString(36).slice(2);function fl(a){if(!a[Ac]){a[Ac]=!0,n.forEach(function(_){_!=="selectionchange"&&(Km.has(_)||Nh(_,!1,a),Nh(_,!0,a))});var h=a.nodeType===9?a:a.ownerDocument;h===null||h[Ac]||(h[Ac]=!0,Nh("selectionchange",!1,h))}}function Ym(a,h,_,A){switch(Dt(h)){case 1:var B=An;break;case 4:B=Ou;break;default:B=Zo}_=B.bind(null,h,_,a),B=void 0,!Vs||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(B=!0),A?B!==void 0?a.addEventListener(h,_,{capture:!0,passive:B}):a.addEventListener(h,_,!0):B!==void 0?a.addEventListener(h,_,{passive:B}):a.addEventListener(h,_,!1)}function u(a,h,_,A,B){var H=A;if((h&1)===0&&(h&2)===0&&A!==null)e:for(;;){if(A===null)return;var te=A.tag;if(te===3||te===4){var de=A.stateNode.containerInfo;if(de===B||de.nodeType===8&&de.parentNode===B)break;if(te===4)for(te=A.return;te!==null;){var me=te.tag;if((me===3||me===4)&&(me=te.stateNode.containerInfo,me===B||me.nodeType===8&&me.parentNode===B))return;te=te.return}for(;de!==null;){if(te=sa(de),te===null)return;if(me=te.tag,me===5||me===6){A=H=te;continue e}de=de.parentNode}}A=A.return}ds(function(){var Se=H,Oe=ho(_),Fe=[];e:{var Re=dl.get(a);if(Re!==void 0){var Ye=Ja,tt=a;switch(a){case"keypress":if(Xa(_)===0)break e;case"keydown":case"keyup":Ye=q;break;case"focusin":tt="focus",Ye=ea;break;case"focusout":tt="blur",Ye=ea;break;case"beforeblur":case"afterblur":Ye=ea;break;case"click":if(_.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ye=Jo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ye=tl;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ye=Ae;break;case $m:case vs:case Eh:Ye=Gs;break;case Sh:Ye=nn;break;case"scroll":Ye=gh;break;case"wheel":Ye=Ht;break;case"copy":case"cut":case"paste":Ye=rl;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ye=oe}var it=(h&4)!==0,Zn=!it&&a==="scroll",be=it?Re!==null?Re+"Capture":null:Re;it=[];for(var ge=Se,we;ge!==null;){we=ge;var Ue=we.stateNode;if(we.tag===5&&Ue!==null&&(we=Ue,be!==null&&(Ue=bn(ge,be),Ue!=null&&it.push(y(ge,Ue,we)))),Zn)break;ge=ge.return}0<it.length&&(Re=new Ye(Re,tt,null,_,Oe),Fe.push({event:Re,listeners:it}))}}if((h&7)===0){e:{if(Re=a==="mouseover"||a==="pointerover",Ye=a==="mouseout"||a==="pointerout",Re&&_!==qi&&(tt=_.relatedTarget||_.fromElement)&&(sa(tt)||tt[on]))break e;if((Ye||Re)&&(Re=Oe.window===Oe?Oe:(Re=Oe.ownerDocument)?Re.defaultView||Re.parentWindow:window,Ye?(tt=_.relatedTarget||_.toElement,Ye=Se,tt=tt?sa(tt):null,tt!==null&&(Zn=Pr(tt),tt!==Zn||tt.tag!==5&&tt.tag!==6)&&(tt=null)):(Ye=null,tt=Se),Ye!==tt)){if(it=Jo,Ue="onMouseLeave",be="onMouseEnter",ge="mouse",(a==="pointerout"||a==="pointerover")&&(it=oe,Ue="onPointerLeave",be="onPointerEnter",ge="pointer"),Zn=Ye==null?Re:aa(Ye),we=tt==null?Re:aa(tt),Re=new it(Ue,ge+"leave",Ye,_,Oe),Re.target=Zn,Re.relatedTarget=we,Ue=null,sa(Oe)===Se&&(it=new it(be,ge+"enter",tt,_,Oe),it.target=we,it.relatedTarget=Zn,Ue=it),Zn=Ue,Ye&&tt)t:{for(it=Ye,be=tt,ge=0,we=it;we;we=V(we))ge++;for(we=0,Ue=be;Ue;Ue=V(Ue))we++;for(;0<ge-we;)it=V(it),ge--;for(;0<we-ge;)be=V(be),we--;for(;ge--;){if(it===be||be!==null&&it===be.alternate)break t;it=V(it),be=V(be)}it=null}else it=null;Ye!==null&&W(Fe,Re,Ye,it,!1),tt!==null&&Zn!==null&&W(Fe,Zn,tt,it,!0)}}e:{if(Re=Se?aa(Se):window,Ye=Re.nodeName&&Re.nodeName.toLowerCase(),Ye==="select"||Ye==="input"&&Re.type==="file")var st=T0;else if(Bm(Re))if(gs)st=vh;else{st=al;var ft=qu}else(Ye=Re.nodeName)&&Ye.toLowerCase()==="input"&&(Re.type==="checkbox"||Re.type==="radio")&&(st=Hu);if(st&&(st=st(a,Se))){Vu(Fe,st,_,Oe);break e}ft&&ft(a,Re,Se),a==="focusout"&&(ft=Re._wrapperState)&&ft.controlled&&Re.type==="number"&&Ie(Re,"number",Re.value)}switch(ft=Se?aa(Se):window,a){case"focusin":(Bm(ft)||ft.contentEditable==="true")&&(ll=ft,cl=Se,Sc=null);break;case"focusout":Sc=cl=ll=null;break;case"mousedown":Wu=!0;break;case"contextmenu":case"mouseup":case"dragend":Wu=!1,Hm(Fe,_,Oe);break;case"selectionchange":if($u)break;case"keydown":case"keyup":Hm(Fe,_,Oe)}var mt;if(En)e:{switch(a){case"compositionstart":var It="onCompositionStart";break e;case"compositionend":It="onCompositionEnd";break e;case"compositionupdate":It="onCompositionUpdate";break e}It=void 0}else Ks?sl(a,_)&&(It="onCompositionEnd"):a==="keydown"&&_.keyCode===229&&(It="onCompositionStart");It&&(na&&_.locale!=="ko"&&(Ks||It!=="onCompositionStart"?It==="onCompositionEnd"&&Ks&&(mt=Qa()):(si=Oe,xr="value"in si?si.value:si.textContent,Ks=!0)),ft=T(Se,It),0<ft.length&&(It=new il(It,a,null,_,Oe),Fe.push({event:It,listeners:ft}),mt?It.data=mt:(mt=yh(_),mt!==null&&(It.data=mt)))),(mt=Vn?E0(a,_):vo(a,_))&&(Se=T(Se,"onBeforeInput"),0<Se.length&&(Oe=new il("onBeforeInput","beforeinput",null,_,Oe),Fe.push({event:Oe,listeners:Se}),Oe.data=mt))}Ah(Fe,h)})}function y(a,h,_){return{instance:a,listener:h,currentTarget:_}}function T(a,h){for(var _=h+"Capture",A=[];a!==null;){var B=a,H=B.stateNode;B.tag===5&&H!==null&&(B=H,H=bn(a,_),H!=null&&A.unshift(y(a,H,B)),H=bn(a,h),H!=null&&A.push(y(a,H,B))),a=a.return}return A}function V(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function W(a,h,_,A,B){for(var H=h._reactName,te=[];_!==null&&_!==A;){var de=_,me=de.alternate,Se=de.stateNode;if(me!==null&&me===A)break;de.tag===5&&Se!==null&&(de=Se,B?(me=bn(_,H),me!=null&&te.unshift(y(_,me,de))):B||(me=bn(_,H),me!=null&&te.push(y(_,me,de)))),_=_.return}te.length!==0&&a.push({event:h,listeners:te})}var ne=/\r\n?/g,he=/\u0000|\uFFFD/g;function xe(a){return(typeof a=="string"?a:""+a).replace(ne,`
`).replace(he,"")}function Ee(a,h,_){if(h=xe(h),xe(a)!==h&&_)throw Error(t(425))}function Ce(){}var We=null,ht=null;function Rt(a,h){return a==="textarea"||a==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var ur=typeof setTimeout=="function"?setTimeout:void 0,sr=typeof clearTimeout=="function"?clearTimeout:void 0,ai=typeof Promise=="function"?Promise:void 0,$r=typeof queueMicrotask=="function"?queueMicrotask:typeof ai<"u"?function(a){return ai.resolve(null).then(a).catch(ml)}:ur;function ml(a){setTimeout(function(){throw a})}function Ih(a,h){var _=h,A=0;do{var B=_.nextSibling;if(a.removeChild(_),B&&B.nodeType===8)if(_=B.data,_==="/$"){if(A===0){a.removeChild(B),cr(h);return}A--}else _!=="$"&&_!=="$?"&&_!=="$!"||A++;_=B}while(_);cr(h)}function wo(a){for(;a!=null;a=a.nextSibling){var h=a.nodeType;if(h===1||h===3)break;if(h===8){if(h=a.data,h==="$"||h==="$!"||h==="$?")break;if(h==="/$")return null}}return a}function Zm(a){a=a.previousSibling;for(var h=0;a;){if(a.nodeType===8){var _=a.data;if(_==="$"||_==="$!"||_==="$?"){if(h===0)return a;h--}else _==="/$"&&h++}a=a.previousSibling}return null}var ia=Math.random().toString(36).slice(2),_s="__reactFiber$"+ia,pl="__reactProps$"+ia,on="__reactContainer$"+ia,gl="__reactEvents$"+ia,N0="__reactListeners$"+ia,I0="__reactHandles$"+ia;function sa(a){var h=a[_s];if(h)return h;for(var _=a.parentNode;_;){if(h=_[on]||_[_s]){if(_=h.alternate,h.child!==null||_!==null&&_.child!==null)for(a=Zm(a);a!==null;){if(_=a[_s])return _;a=Zm(a)}return h}a=_,_=a.parentNode}return null}function oa(a){return a=a[_s]||a[on],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function aa(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function Ku(a){return a[pl]||null}var P0=[],Yu=-1;function yl(a){return{current:a}}function kn(a){0>Yu||(a.current=P0[Yu],P0[Yu]=null,Yu--)}function Nn(a,h){Yu++,P0[Yu]=a.current,a.current=h}var vl={},Wr=yl(vl),ki=yl(!1),Nc=vl;function Zu(a,h){var _=a.type.contextTypes;if(!_)return vl;var A=a.stateNode;if(A&&A.__reactInternalMemoizedUnmaskedChildContext===h)return A.__reactInternalMemoizedMaskedChildContext;var B={},H;for(H in _)B[H]=h[H];return A&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=h,a.__reactInternalMemoizedMaskedChildContext=B),B}function Ci(a){return a=a.childContextTypes,a!=null}function Qm(){kn(ki),kn(Wr)}function hw(a,h,_){if(Wr.current!==vl)throw Error(t(168));Nn(Wr,h),Nn(ki,_)}function fw(a,h,_){var A=a.stateNode;if(h=h.childContextTypes,typeof A.getChildContext!="function")return _;A=A.getChildContext();for(var B in A)if(!(B in h))throw Error(t(108,ce(a)||"Unknown",B));return G({},_,A)}function Xm(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||vl,Nc=Wr.current,Nn(Wr,a),Nn(ki,ki.current),!0}function mw(a,h,_){var A=a.stateNode;if(!A)throw Error(t(169));_?(a=fw(a,h,Nc),A.__reactInternalMemoizedMergedChildContext=a,kn(ki),kn(Wr),Nn(Wr,a)):kn(ki),Nn(ki,_)}var la=null,Jm=!1,k0=!1;function pw(a){la===null?la=[a]:la.push(a)}function $R(a){Jm=!0,pw(a)}function _l(){if(!k0&&la!==null){k0=!0;var a=0,h=jt;try{var _=la;for(jt=1;a<_.length;a++){var A=_[a];do A=A(!0);while(A!==null)}la=null,Jm=!1}catch(B){throw la!==null&&(la=la.slice(a+1)),pe(Rn,_l),B}finally{jt=h,k0=!1}}return null}var Qu=[],Xu=0,ep=null,tp=0,xs=[],bs=0,Ic=null,ca=1,ua="";function Pc(a,h){Qu[Xu++]=tp,Qu[Xu++]=ep,ep=a,tp=h}function gw(a,h,_){xs[bs++]=ca,xs[bs++]=ua,xs[bs++]=Ic,Ic=a;var A=ca;a=ua;var B=32-At(A)-1;A&=~(1<<B),_+=1;var H=32-At(h)+B;if(30<H){var te=B-B%5;H=(A&(1<<te)-1).toString(32),A>>=te,B-=te,ca=1<<32-At(h)+B|_<<B|A,ua=H+a}else ca=1<<H|_<<B|A,ua=a}function C0(a){a.return!==null&&(Pc(a,1),gw(a,1,0))}function R0(a){for(;a===ep;)ep=Qu[--Xu],Qu[Xu]=null,tp=Qu[--Xu],Qu[Xu]=null;for(;a===Ic;)Ic=xs[--bs],xs[bs]=null,ua=xs[--bs],xs[bs]=null,ca=xs[--bs],xs[bs]=null}var Ji=null,es=null,jn=!1,Zs=null;function yw(a,h){var _=Ts(5,null,null,0);_.elementType="DELETED",_.stateNode=h,_.return=a,h=a.deletions,h===null?(a.deletions=[_],a.flags|=16):h.push(_)}function vw(a,h){switch(a.tag){case 5:var _=a.type;return h=h.nodeType!==1||_.toLowerCase()!==h.nodeName.toLowerCase()?null:h,h!==null?(a.stateNode=h,Ji=a,es=wo(h.firstChild),!0):!1;case 6:return h=a.pendingProps===""||h.nodeType!==3?null:h,h!==null?(a.stateNode=h,Ji=a,es=null,!0):!1;case 13:return h=h.nodeType!==8?null:h,h!==null?(_=Ic!==null?{id:ca,overflow:ua}:null,a.memoizedState={dehydrated:h,treeContext:_,retryLane:1073741824},_=Ts(18,null,null,0),_.stateNode=h,_.return=a,a.child=_,Ji=a,es=null,!0):!1;default:return!1}}function j0(a){return(a.mode&1)!==0&&(a.flags&128)===0}function O0(a){if(jn){var h=es;if(h){var _=h;if(!vw(a,h)){if(j0(a))throw Error(t(418));h=wo(_.nextSibling);var A=Ji;h&&vw(a,h)?yw(A,_):(a.flags=a.flags&-4097|2,jn=!1,Ji=a)}}else{if(j0(a))throw Error(t(418));a.flags=a.flags&-4097|2,jn=!1,Ji=a}}}function _w(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;Ji=a}function np(a){if(a!==Ji)return!1;if(!jn)return _w(a),jn=!0,!1;var h;if((h=a.tag!==3)&&!(h=a.tag!==5)&&(h=a.type,h=h!=="head"&&h!=="body"&&!Rt(a.type,a.memoizedProps)),h&&(h=es)){if(j0(a))throw xw(),Error(t(418));for(;h;)yw(a,h),h=wo(h.nextSibling)}if(_w(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,h=0;a;){if(a.nodeType===8){var _=a.data;if(_==="/$"){if(h===0){es=wo(a.nextSibling);break e}h--}else _!=="$"&&_!=="$!"&&_!=="$?"||h++}a=a.nextSibling}es=null}}else es=Ji?wo(a.stateNode.nextSibling):null;return!0}function xw(){for(var a=es;a;)a=wo(a.nextSibling)}function Ju(){es=Ji=null,jn=!1}function D0(a){Zs===null?Zs=[a]:Zs.push(a)}var WR=I.ReactCurrentBatchConfig;function Ph(a,h,_){if(a=_.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(_._owner){if(_=_._owner,_){if(_.tag!==1)throw Error(t(309));var A=_.stateNode}if(!A)throw Error(t(147,a));var B=A,H=""+a;return h!==null&&h.ref!==null&&typeof h.ref=="function"&&h.ref._stringRef===H?h.ref:(h=function(te){var de=B.refs;te===null?delete de[H]:de[H]=te},h._stringRef=H,h)}if(typeof a!="string")throw Error(t(284));if(!_._owner)throw Error(t(290,a))}return a}function rp(a,h){throw a=Object.prototype.toString.call(h),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":a))}function bw(a){var h=a._init;return h(a._payload)}function ww(a){function h(be,ge){if(a){var we=be.deletions;we===null?(be.deletions=[ge],be.flags|=16):we.push(ge)}}function _(be,ge){if(!a)return null;for(;ge!==null;)h(be,ge),ge=ge.sibling;return null}function A(be,ge){for(be=new Map;ge!==null;)ge.key!==null?be.set(ge.key,ge):be.set(ge.index,ge),ge=ge.sibling;return be}function B(be,ge){return be=Nl(be,ge),be.index=0,be.sibling=null,be}function H(be,ge,we){return be.index=we,a?(we=be.alternate,we!==null?(we=we.index,we<ge?(be.flags|=2,ge):we):(be.flags|=2,ge)):(be.flags|=1048576,ge)}function te(be){return a&&be.alternate===null&&(be.flags|=2),be}function de(be,ge,we,Ue){return ge===null||ge.tag!==6?(ge=Av(we,be.mode,Ue),ge.return=be,ge):(ge=B(ge,we),ge.return=be,ge)}function me(be,ge,we,Ue){var st=we.type;return st===P?Oe(be,ge,we.props.children,Ue,we.key):ge!==null&&(ge.elementType===st||typeof st=="object"&&st!==null&&st.$$typeof===ee&&bw(st)===ge.type)?(Ue=B(ge,we.props),Ue.ref=Ph(be,ge,we),Ue.return=be,Ue):(Ue=Np(we.type,we.key,we.props,null,be.mode,Ue),Ue.ref=Ph(be,ge,we),Ue.return=be,Ue)}function Se(be,ge,we,Ue){return ge===null||ge.tag!==4||ge.stateNode.containerInfo!==we.containerInfo||ge.stateNode.implementation!==we.implementation?(ge=Nv(we,be.mode,Ue),ge.return=be,ge):(ge=B(ge,we.children||[]),ge.return=be,ge)}function Oe(be,ge,we,Ue,st){return ge===null||ge.tag!==7?(ge=Lc(we,be.mode,Ue,st),ge.return=be,ge):(ge=B(ge,we),ge.return=be,ge)}function Fe(be,ge,we){if(typeof ge=="string"&&ge!==""||typeof ge=="number")return ge=Av(""+ge,be.mode,we),ge.return=be,ge;if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case j:return we=Np(ge.type,ge.key,ge.props,null,be.mode,we),we.ref=Ph(be,null,ge),we.return=be,we;case U:return ge=Nv(ge,be.mode,we),ge.return=be,ge;case ee:var Ue=ge._init;return Fe(be,Ue(ge._payload),we)}if(Le(ge)||re(ge))return ge=Lc(ge,be.mode,we,null),ge.return=be,ge;rp(be,ge)}return null}function Re(be,ge,we,Ue){var st=ge!==null?ge.key:null;if(typeof we=="string"&&we!==""||typeof we=="number")return st!==null?null:de(be,ge,""+we,Ue);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case j:return we.key===st?me(be,ge,we,Ue):null;case U:return we.key===st?Se(be,ge,we,Ue):null;case ee:return st=we._init,Re(be,ge,st(we._payload),Ue)}if(Le(we)||re(we))return st!==null?null:Oe(be,ge,we,Ue,null);rp(be,we)}return null}function Ye(be,ge,we,Ue,st){if(typeof Ue=="string"&&Ue!==""||typeof Ue=="number")return be=be.get(we)||null,de(ge,be,""+Ue,st);if(typeof Ue=="object"&&Ue!==null){switch(Ue.$$typeof){case j:return be=be.get(Ue.key===null?we:Ue.key)||null,me(ge,be,Ue,st);case U:return be=be.get(Ue.key===null?we:Ue.key)||null,Se(ge,be,Ue,st);case ee:var ft=Ue._init;return Ye(be,ge,we,ft(Ue._payload),st)}if(Le(Ue)||re(Ue))return be=be.get(we)||null,Oe(ge,be,Ue,st,null);rp(ge,Ue)}return null}function tt(be,ge,we,Ue){for(var st=null,ft=null,mt=ge,It=ge=0,Er=null;mt!==null&&It<we.length;It++){mt.index>It?(Er=mt,mt=null):Er=mt.sibling;var tn=Re(be,mt,we[It],Ue);if(tn===null){mt===null&&(mt=Er);break}a&&mt&&tn.alternate===null&&h(be,mt),ge=H(tn,ge,It),ft===null?st=tn:ft.sibling=tn,ft=tn,mt=Er}if(It===we.length)return _(be,mt),jn&&Pc(be,It),st;if(mt===null){for(;It<we.length;It++)mt=Fe(be,we[It],Ue),mt!==null&&(ge=H(mt,ge,It),ft===null?st=mt:ft.sibling=mt,ft=mt);return jn&&Pc(be,It),st}for(mt=A(be,mt);It<we.length;It++)Er=Ye(mt,be,It,we[It],Ue),Er!==null&&(a&&Er.alternate!==null&&mt.delete(Er.key===null?It:Er.key),ge=H(Er,ge,It),ft===null?st=Er:ft.sibling=Er,ft=Er);return a&&mt.forEach(function(Il){return h(be,Il)}),jn&&Pc(be,It),st}function it(be,ge,we,Ue){var st=re(we);if(typeof st!="function")throw Error(t(150));if(we=st.call(we),we==null)throw Error(t(151));for(var ft=st=null,mt=ge,It=ge=0,Er=null,tn=we.next();mt!==null&&!tn.done;It++,tn=we.next()){mt.index>It?(Er=mt,mt=null):Er=mt.sibling;var Il=Re(be,mt,tn.value,Ue);if(Il===null){mt===null&&(mt=Er);break}a&&mt&&Il.alternate===null&&h(be,mt),ge=H(Il,ge,It),ft===null?st=Il:ft.sibling=Il,ft=Il,mt=Er}if(tn.done)return _(be,mt),jn&&Pc(be,It),st;if(mt===null){for(;!tn.done;It++,tn=we.next())tn=Fe(be,tn.value,Ue),tn!==null&&(ge=H(tn,ge,It),ft===null?st=tn:ft.sibling=tn,ft=tn);return jn&&Pc(be,It),st}for(mt=A(be,mt);!tn.done;It++,tn=we.next())tn=Ye(mt,be,It,tn.value,Ue),tn!==null&&(a&&tn.alternate!==null&&mt.delete(tn.key===null?It:tn.key),ge=H(tn,ge,It),ft===null?st=tn:ft.sibling=tn,ft=tn);return a&&mt.forEach(function(T5){return h(be,T5)}),jn&&Pc(be,It),st}function Zn(be,ge,we,Ue){if(typeof we=="object"&&we!==null&&we.type===P&&we.key===null&&(we=we.props.children),typeof we=="object"&&we!==null){switch(we.$$typeof){case j:e:{for(var st=we.key,ft=ge;ft!==null;){if(ft.key===st){if(st=we.type,st===P){if(ft.tag===7){_(be,ft.sibling),ge=B(ft,we.props.children),ge.return=be,be=ge;break e}}else if(ft.elementType===st||typeof st=="object"&&st!==null&&st.$$typeof===ee&&bw(st)===ft.type){_(be,ft.sibling),ge=B(ft,we.props),ge.ref=Ph(be,ft,we),ge.return=be,be=ge;break e}_(be,ft);break}else h(be,ft);ft=ft.sibling}we.type===P?(ge=Lc(we.props.children,be.mode,Ue,we.key),ge.return=be,be=ge):(Ue=Np(we.type,we.key,we.props,null,be.mode,Ue),Ue.ref=Ph(be,ge,we),Ue.return=be,be=Ue)}return te(be);case U:e:{for(ft=we.key;ge!==null;){if(ge.key===ft)if(ge.tag===4&&ge.stateNode.containerInfo===we.containerInfo&&ge.stateNode.implementation===we.implementation){_(be,ge.sibling),ge=B(ge,we.children||[]),ge.return=be,be=ge;break e}else{_(be,ge);break}else h(be,ge);ge=ge.sibling}ge=Nv(we,be.mode,Ue),ge.return=be,be=ge}return te(be);case ee:return ft=we._init,Zn(be,ge,ft(we._payload),Ue)}if(Le(we))return tt(be,ge,we,Ue);if(re(we))return it(be,ge,we,Ue);rp(be,we)}return typeof we=="string"&&we!==""||typeof we=="number"?(we=""+we,ge!==null&&ge.tag===6?(_(be,ge.sibling),ge=B(ge,we),ge.return=be,be=ge):(_(be,ge),ge=Av(we,be.mode,Ue),ge.return=be,be=ge),te(be)):_(be,ge)}return Zn}var ed=ww(!0),Ew=ww(!1),ip=yl(null),sp=null,td=null,M0=null;function L0(){M0=td=sp=null}function F0(a){var h=ip.current;kn(ip),a._currentValue=h}function V0(a,h,_){for(;a!==null;){var A=a.alternate;if((a.childLanes&h)!==h?(a.childLanes|=h,A!==null&&(A.childLanes|=h)):A!==null&&(A.childLanes&h)!==h&&(A.childLanes|=h),a===_)break;a=a.return}}function nd(a,h){sp=a,M0=td=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&h)!==0&&(Ri=!0),a.firstContext=null)}function ws(a){var h=a._currentValue;if(M0!==a)if(a={context:a,memoizedValue:h,next:null},td===null){if(sp===null)throw Error(t(308));td=a,sp.dependencies={lanes:0,firstContext:a}}else td=td.next=a;return h}var kc=null;function B0(a){kc===null?kc=[a]:kc.push(a)}function Sw(a,h,_,A){var B=h.interleaved;return B===null?(_.next=_,B0(h)):(_.next=B.next,B.next=_),h.interleaved=_,da(a,A)}function da(a,h){a.lanes|=h;var _=a.alternate;for(_!==null&&(_.lanes|=h),_=a,a=a.return;a!==null;)a.childLanes|=h,_=a.alternate,_!==null&&(_.childLanes|=h),_=a,a=a.return;return _.tag===3?_.stateNode:null}var xl=!1;function z0(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Tw(a,h){a=a.updateQueue,h.updateQueue===a&&(h.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function ha(a,h){return{eventTime:a,lane:h,tag:0,payload:null,callback:null,next:null}}function bl(a,h,_){var A=a.updateQueue;if(A===null)return null;if(A=A.shared,(Xt&2)!==0){var B=A.pending;return B===null?h.next=h:(h.next=B.next,B.next=h),A.pending=h,da(a,_)}return B=A.interleaved,B===null?(h.next=h,B0(A)):(h.next=B.next,B.next=h),A.interleaved=h,da(a,_)}function op(a,h,_){if(h=h.updateQueue,h!==null&&(h=h.shared,(_&4194240)!==0)){var A=h.lanes;A&=a.pendingLanes,_|=A,h.lanes=_,Ur(a,_)}}function Aw(a,h){var _=a.updateQueue,A=a.alternate;if(A!==null&&(A=A.updateQueue,_===A)){var B=null,H=null;if(_=_.firstBaseUpdate,_!==null){do{var te={eventTime:_.eventTime,lane:_.lane,tag:_.tag,payload:_.payload,callback:_.callback,next:null};H===null?B=H=te:H=H.next=te,_=_.next}while(_!==null);H===null?B=H=h:H=H.next=h}else B=H=h;_={baseState:A.baseState,firstBaseUpdate:B,lastBaseUpdate:H,shared:A.shared,effects:A.effects},a.updateQueue=_;return}a=_.lastBaseUpdate,a===null?_.firstBaseUpdate=h:a.next=h,_.lastBaseUpdate=h}function ap(a,h,_,A){var B=a.updateQueue;xl=!1;var H=B.firstBaseUpdate,te=B.lastBaseUpdate,de=B.shared.pending;if(de!==null){B.shared.pending=null;var me=de,Se=me.next;me.next=null,te===null?H=Se:te.next=Se,te=me;var Oe=a.alternate;Oe!==null&&(Oe=Oe.updateQueue,de=Oe.lastBaseUpdate,de!==te&&(de===null?Oe.firstBaseUpdate=Se:de.next=Se,Oe.lastBaseUpdate=me))}if(H!==null){var Fe=B.baseState;te=0,Oe=Se=me=null,de=H;do{var Re=de.lane,Ye=de.eventTime;if((A&Re)===Re){Oe!==null&&(Oe=Oe.next={eventTime:Ye,lane:0,tag:de.tag,payload:de.payload,callback:de.callback,next:null});e:{var tt=a,it=de;switch(Re=h,Ye=_,it.tag){case 1:if(tt=it.payload,typeof tt=="function"){Fe=tt.call(Ye,Fe,Re);break e}Fe=tt;break e;case 3:tt.flags=tt.flags&-65537|128;case 0:if(tt=it.payload,Re=typeof tt=="function"?tt.call(Ye,Fe,Re):tt,Re==null)break e;Fe=G({},Fe,Re);break e;case 2:xl=!0}}de.callback!==null&&de.lane!==0&&(a.flags|=64,Re=B.effects,Re===null?B.effects=[de]:Re.push(de))}else Ye={eventTime:Ye,lane:Re,tag:de.tag,payload:de.payload,callback:de.callback,next:null},Oe===null?(Se=Oe=Ye,me=Fe):Oe=Oe.next=Ye,te|=Re;if(de=de.next,de===null){if(de=B.shared.pending,de===null)break;Re=de,de=Re.next,Re.next=null,B.lastBaseUpdate=Re,B.shared.pending=null}}while(!0);if(Oe===null&&(me=Fe),B.baseState=me,B.firstBaseUpdate=Se,B.lastBaseUpdate=Oe,h=B.shared.interleaved,h!==null){B=h;do te|=B.lane,B=B.next;while(B!==h)}else H===null&&(B.shared.lanes=0);jc|=te,a.lanes=te,a.memoizedState=Fe}}function Nw(a,h,_){if(a=h.effects,h.effects=null,a!==null)for(h=0;h<a.length;h++){var A=a[h],B=A.callback;if(B!==null){if(A.callback=null,A=_,typeof B!="function")throw Error(t(191,B));B.call(A)}}}var kh={},Eo=yl(kh),Ch=yl(kh),Rh=yl(kh);function Cc(a){if(a===kh)throw Error(t(174));return a}function U0(a,h){switch(Nn(Rh,h),Nn(Ch,a),Nn(Eo,kh),a=h.nodeType,a){case 9:case 11:h=(h=h.documentElement)?h.namespaceURI:Ft(null,"");break;default:a=a===8?h.parentNode:h,h=a.namespaceURI||null,a=a.tagName,h=Ft(h,a)}kn(Eo),Nn(Eo,h)}function rd(){kn(Eo),kn(Ch),kn(Rh)}function Iw(a){Cc(Rh.current);var h=Cc(Eo.current),_=Ft(h,a.type);h!==_&&(Nn(Ch,a),Nn(Eo,_))}function q0(a){Ch.current===a&&(kn(Eo),kn(Ch))}var Bn=yl(0);function lp(a){for(var h=a;h!==null;){if(h.tag===13){var _=h.memoizedState;if(_!==null&&(_=_.dehydrated,_===null||_.data==="$?"||_.data==="$!"))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var H0=[];function $0(){for(var a=0;a<H0.length;a++)H0[a]._workInProgressVersionPrimary=null;H0.length=0}var cp=I.ReactCurrentDispatcher,W0=I.ReactCurrentBatchConfig,Rc=0,zn=null,dr=null,br=null,up=!1,jh=!1,Oh=0,GR=0;function Gr(){throw Error(t(321))}function G0(a,h){if(h===null)return!1;for(var _=0;_<h.length&&_<a.length;_++)if(!Qi(a[_],h[_]))return!1;return!0}function K0(a,h,_,A,B,H){if(Rc=H,zn=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,cp.current=a===null||a.memoizedState===null?QR:XR,a=_(A,B),jh){H=0;do{if(jh=!1,Oh=0,25<=H)throw Error(t(301));H+=1,br=dr=null,h.updateQueue=null,cp.current=JR,a=_(A,B)}while(jh)}if(cp.current=fp,h=dr!==null&&dr.next!==null,Rc=0,br=dr=zn=null,up=!1,h)throw Error(t(300));return a}function Y0(){var a=Oh!==0;return Oh=0,a}function So(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return br===null?zn.memoizedState=br=a:br=br.next=a,br}function Es(){if(dr===null){var a=zn.alternate;a=a!==null?a.memoizedState:null}else a=dr.next;var h=br===null?zn.memoizedState:br.next;if(h!==null)br=h,dr=a;else{if(a===null)throw Error(t(310));dr=a,a={memoizedState:dr.memoizedState,baseState:dr.baseState,baseQueue:dr.baseQueue,queue:dr.queue,next:null},br===null?zn.memoizedState=br=a:br=br.next=a}return br}function Dh(a,h){return typeof h=="function"?h(a):h}function Z0(a){var h=Es(),_=h.queue;if(_===null)throw Error(t(311));_.lastRenderedReducer=a;var A=dr,B=A.baseQueue,H=_.pending;if(H!==null){if(B!==null){var te=B.next;B.next=H.next,H.next=te}A.baseQueue=B=H,_.pending=null}if(B!==null){H=B.next,A=A.baseState;var de=te=null,me=null,Se=H;do{var Oe=Se.lane;if((Rc&Oe)===Oe)me!==null&&(me=me.next={lane:0,action:Se.action,hasEagerState:Se.hasEagerState,eagerState:Se.eagerState,next:null}),A=Se.hasEagerState?Se.eagerState:a(A,Se.action);else{var Fe={lane:Oe,action:Se.action,hasEagerState:Se.hasEagerState,eagerState:Se.eagerState,next:null};me===null?(de=me=Fe,te=A):me=me.next=Fe,zn.lanes|=Oe,jc|=Oe}Se=Se.next}while(Se!==null&&Se!==H);me===null?te=A:me.next=de,Qi(A,h.memoizedState)||(Ri=!0),h.memoizedState=A,h.baseState=te,h.baseQueue=me,_.lastRenderedState=A}if(a=_.interleaved,a!==null){B=a;do H=B.lane,zn.lanes|=H,jc|=H,B=B.next;while(B!==a)}else B===null&&(_.lanes=0);return[h.memoizedState,_.dispatch]}function Q0(a){var h=Es(),_=h.queue;if(_===null)throw Error(t(311));_.lastRenderedReducer=a;var A=_.dispatch,B=_.pending,H=h.memoizedState;if(B!==null){_.pending=null;var te=B=B.next;do H=a(H,te.action),te=te.next;while(te!==B);Qi(H,h.memoizedState)||(Ri=!0),h.memoizedState=H,h.baseQueue===null&&(h.baseState=H),_.lastRenderedState=H}return[H,A]}function Pw(){}function kw(a,h){var _=zn,A=Es(),B=h(),H=!Qi(A.memoizedState,B);if(H&&(A.memoizedState=B,Ri=!0),A=A.queue,X0(jw.bind(null,_,A,a),[a]),A.getSnapshot!==h||H||br!==null&&br.memoizedState.tag&1){if(_.flags|=2048,Mh(9,Rw.bind(null,_,A,B,h),void 0,null),wr===null)throw Error(t(349));(Rc&30)!==0||Cw(_,h,B)}return B}function Cw(a,h,_){a.flags|=16384,a={getSnapshot:h,value:_},h=zn.updateQueue,h===null?(h={lastEffect:null,stores:null},zn.updateQueue=h,h.stores=[a]):(_=h.stores,_===null?h.stores=[a]:_.push(a))}function Rw(a,h,_,A){h.value=_,h.getSnapshot=A,Ow(h)&&Dw(a)}function jw(a,h,_){return _(function(){Ow(h)&&Dw(a)})}function Ow(a){var h=a.getSnapshot;a=a.value;try{var _=h();return!Qi(a,_)}catch{return!0}}function Dw(a){var h=da(a,1);h!==null&&eo(h,a,1,-1)}function Mw(a){var h=So();return typeof a=="function"&&(a=a()),h.memoizedState=h.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Dh,lastRenderedState:a},h.queue=a,a=a.dispatch=ZR.bind(null,zn,a),[h.memoizedState,a]}function Mh(a,h,_,A){return a={tag:a,create:h,destroy:_,deps:A,next:null},h=zn.updateQueue,h===null?(h={lastEffect:null,stores:null},zn.updateQueue=h,h.lastEffect=a.next=a):(_=h.lastEffect,_===null?h.lastEffect=a.next=a:(A=_.next,_.next=a,a.next=A,h.lastEffect=a)),a}function Lw(){return Es().memoizedState}function dp(a,h,_,A){var B=So();zn.flags|=a,B.memoizedState=Mh(1|h,_,void 0,A===void 0?null:A)}function hp(a,h,_,A){var B=Es();A=A===void 0?null:A;var H=void 0;if(dr!==null){var te=dr.memoizedState;if(H=te.destroy,A!==null&&G0(A,te.deps)){B.memoizedState=Mh(h,_,H,A);return}}zn.flags|=a,B.memoizedState=Mh(1|h,_,H,A)}function Fw(a,h){return dp(8390656,8,a,h)}function X0(a,h){return hp(2048,8,a,h)}function Vw(a,h){return hp(4,2,a,h)}function Bw(a,h){return hp(4,4,a,h)}function zw(a,h){if(typeof h=="function")return a=a(),h(a),function(){h(null)};if(h!=null)return a=a(),h.current=a,function(){h.current=null}}function Uw(a,h,_){return _=_!=null?_.concat([a]):null,hp(4,4,zw.bind(null,h,a),_)}function J0(){}function qw(a,h){var _=Es();h=h===void 0?null:h;var A=_.memoizedState;return A!==null&&h!==null&&G0(h,A[1])?A[0]:(_.memoizedState=[a,h],a)}function Hw(a,h){var _=Es();h=h===void 0?null:h;var A=_.memoizedState;return A!==null&&h!==null&&G0(h,A[1])?A[0]:(a=a(),_.memoizedState=[a,h],a)}function $w(a,h,_){return(Rc&21)===0?(a.baseState&&(a.baseState=!1,Ri=!0),a.memoizedState=_):(Qi(_,h)||(_=Go(),zn.lanes|=_,jc|=_,a.baseState=!0),h)}function KR(a,h){var _=jt;jt=_!==0&&4>_?_:4,a(!0);var A=W0.transition;W0.transition={};try{a(!1),h()}finally{jt=_,W0.transition=A}}function Ww(){return Es().memoizedState}function YR(a,h,_){var A=Tl(a);if(_={lane:A,action:_,hasEagerState:!1,eagerState:null,next:null},Gw(a))Kw(h,_);else if(_=Sw(a,h,_,A),_!==null){var B=ci();eo(_,a,A,B),Yw(_,h,A)}}function ZR(a,h,_){var A=Tl(a),B={lane:A,action:_,hasEagerState:!1,eagerState:null,next:null};if(Gw(a))Kw(h,B);else{var H=a.alternate;if(a.lanes===0&&(H===null||H.lanes===0)&&(H=h.lastRenderedReducer,H!==null))try{var te=h.lastRenderedState,de=H(te,_);if(B.hasEagerState=!0,B.eagerState=de,Qi(de,te)){var me=h.interleaved;me===null?(B.next=B,B0(h)):(B.next=me.next,me.next=B),h.interleaved=B;return}}catch{}finally{}_=Sw(a,h,B,A),_!==null&&(B=ci(),eo(_,a,A,B),Yw(_,h,A))}}function Gw(a){var h=a.alternate;return a===zn||h!==null&&h===zn}function Kw(a,h){jh=up=!0;var _=a.pending;_===null?h.next=h:(h.next=_.next,_.next=h),a.pending=h}function Yw(a,h,_){if((_&4194240)!==0){var A=h.lanes;A&=a.pendingLanes,_|=A,h.lanes=_,Ur(a,_)}}var fp={readContext:ws,useCallback:Gr,useContext:Gr,useEffect:Gr,useImperativeHandle:Gr,useInsertionEffect:Gr,useLayoutEffect:Gr,useMemo:Gr,useReducer:Gr,useRef:Gr,useState:Gr,useDebugValue:Gr,useDeferredValue:Gr,useTransition:Gr,useMutableSource:Gr,useSyncExternalStore:Gr,useId:Gr,unstable_isNewReconciler:!1},QR={readContext:ws,useCallback:function(a,h){return So().memoizedState=[a,h===void 0?null:h],a},useContext:ws,useEffect:Fw,useImperativeHandle:function(a,h,_){return _=_!=null?_.concat([a]):null,dp(4194308,4,zw.bind(null,h,a),_)},useLayoutEffect:function(a,h){return dp(4194308,4,a,h)},useInsertionEffect:function(a,h){return dp(4,2,a,h)},useMemo:function(a,h){var _=So();return h=h===void 0?null:h,a=a(),_.memoizedState=[a,h],a},useReducer:function(a,h,_){var A=So();return h=_!==void 0?_(h):h,A.memoizedState=A.baseState=h,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:h},A.queue=a,a=a.dispatch=YR.bind(null,zn,a),[A.memoizedState,a]},useRef:function(a){var h=So();return a={current:a},h.memoizedState=a},useState:Mw,useDebugValue:J0,useDeferredValue:function(a){return So().memoizedState=a},useTransition:function(){var a=Mw(!1),h=a[0];return a=KR.bind(null,a[1]),So().memoizedState=a,[h,a]},useMutableSource:function(){},useSyncExternalStore:function(a,h,_){var A=zn,B=So();if(jn){if(_===void 0)throw Error(t(407));_=_()}else{if(_=h(),wr===null)throw Error(t(349));(Rc&30)!==0||Cw(A,h,_)}B.memoizedState=_;var H={value:_,getSnapshot:h};return B.queue=H,Fw(jw.bind(null,A,H,a),[a]),A.flags|=2048,Mh(9,Rw.bind(null,A,H,_,h),void 0,null),_},useId:function(){var a=So(),h=wr.identifierPrefix;if(jn){var _=ua,A=ca;_=(A&~(1<<32-At(A)-1)).toString(32)+_,h=":"+h+"R"+_,_=Oh++,0<_&&(h+="H"+_.toString(32)),h+=":"}else _=GR++,h=":"+h+"r"+_.toString(32)+":";return a.memoizedState=h},unstable_isNewReconciler:!1},XR={readContext:ws,useCallback:qw,useContext:ws,useEffect:X0,useImperativeHandle:Uw,useInsertionEffect:Vw,useLayoutEffect:Bw,useMemo:Hw,useReducer:Z0,useRef:Lw,useState:function(){return Z0(Dh)},useDebugValue:J0,useDeferredValue:function(a){var h=Es();return $w(h,dr.memoizedState,a)},useTransition:function(){var a=Z0(Dh)[0],h=Es().memoizedState;return[a,h]},useMutableSource:Pw,useSyncExternalStore:kw,useId:Ww,unstable_isNewReconciler:!1},JR={readContext:ws,useCallback:qw,useContext:ws,useEffect:X0,useImperativeHandle:Uw,useInsertionEffect:Vw,useLayoutEffect:Bw,useMemo:Hw,useReducer:Q0,useRef:Lw,useState:function(){return Q0(Dh)},useDebugValue:J0,useDeferredValue:function(a){var h=Es();return dr===null?h.memoizedState=a:$w(h,dr.memoizedState,a)},useTransition:function(){var a=Q0(Dh)[0],h=Es().memoizedState;return[a,h]},useMutableSource:Pw,useSyncExternalStore:kw,useId:Ww,unstable_isNewReconciler:!1};function Qs(a,h){if(a&&a.defaultProps){h=G({},h),a=a.defaultProps;for(var _ in a)h[_]===void 0&&(h[_]=a[_]);return h}return h}function ev(a,h,_,A){h=a.memoizedState,_=_(A,h),_=_==null?h:G({},h,_),a.memoizedState=_,a.lanes===0&&(a.updateQueue.baseState=_)}var mp={isMounted:function(a){return(a=a._reactInternals)?Pr(a)===a:!1},enqueueSetState:function(a,h,_){a=a._reactInternals;var A=ci(),B=Tl(a),H=ha(A,B);H.payload=h,_!=null&&(H.callback=_),h=bl(a,H,B),h!==null&&(eo(h,a,B,A),op(h,a,B))},enqueueReplaceState:function(a,h,_){a=a._reactInternals;var A=ci(),B=Tl(a),H=ha(A,B);H.tag=1,H.payload=h,_!=null&&(H.callback=_),h=bl(a,H,B),h!==null&&(eo(h,a,B,A),op(h,a,B))},enqueueForceUpdate:function(a,h){a=a._reactInternals;var _=ci(),A=Tl(a),B=ha(_,A);B.tag=2,h!=null&&(B.callback=h),h=bl(a,B,A),h!==null&&(eo(h,a,A,_),op(h,a,A))}};function Zw(a,h,_,A,B,H,te){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(A,H,te):h.prototype&&h.prototype.isPureReactComponent?!_o(_,A)||!_o(B,H):!0}function Qw(a,h,_){var A=!1,B=vl,H=h.contextType;return typeof H=="object"&&H!==null?H=ws(H):(B=Ci(h)?Nc:Wr.current,A=h.contextTypes,H=(A=A!=null)?Zu(a,B):vl),h=new h(_,H),a.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=mp,a.stateNode=h,h._reactInternals=a,A&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=B,a.__reactInternalMemoizedMaskedChildContext=H),h}function Xw(a,h,_,A){a=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(_,A),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(_,A),h.state!==a&&mp.enqueueReplaceState(h,h.state,null)}function tv(a,h,_,A){var B=a.stateNode;B.props=_,B.state=a.memoizedState,B.refs={},z0(a);var H=h.contextType;typeof H=="object"&&H!==null?B.context=ws(H):(H=Ci(h)?Nc:Wr.current,B.context=Zu(a,H)),B.state=a.memoizedState,H=h.getDerivedStateFromProps,typeof H=="function"&&(ev(a,h,H,_),B.state=a.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof B.getSnapshotBeforeUpdate=="function"||typeof B.UNSAFE_componentWillMount!="function"&&typeof B.componentWillMount!="function"||(h=B.state,typeof B.componentWillMount=="function"&&B.componentWillMount(),typeof B.UNSAFE_componentWillMount=="function"&&B.UNSAFE_componentWillMount(),h!==B.state&&mp.enqueueReplaceState(B,B.state,null),ap(a,_,B,A),B.state=a.memoizedState),typeof B.componentDidMount=="function"&&(a.flags|=4194308)}function id(a,h){try{var _="",A=h;do _+=le(A),A=A.return;while(A);var B=_}catch(H){B=`
Error generating stack: `+H.message+`
`+H.stack}return{value:a,source:h,stack:B,digest:null}}function nv(a,h,_){return{value:a,source:null,stack:_??null,digest:h??null}}function rv(a,h){try{console.error(h.value)}catch(_){setTimeout(function(){throw _})}}var e5=typeof WeakMap=="function"?WeakMap:Map;function Jw(a,h,_){_=ha(-1,_),_.tag=3,_.payload={element:null};var A=h.value;return _.callback=function(){bp||(bp=!0,vv=A),rv(a,h)},_}function eE(a,h,_){_=ha(-1,_),_.tag=3;var A=a.type.getDerivedStateFromError;if(typeof A=="function"){var B=h.value;_.payload=function(){return A(B)},_.callback=function(){rv(a,h)}}var H=a.stateNode;return H!==null&&typeof H.componentDidCatch=="function"&&(_.callback=function(){rv(a,h),typeof A!="function"&&(El===null?El=new Set([this]):El.add(this));var te=h.stack;this.componentDidCatch(h.value,{componentStack:te!==null?te:""})}),_}function tE(a,h,_){var A=a.pingCache;if(A===null){A=a.pingCache=new e5;var B=new Set;A.set(h,B)}else B=A.get(h),B===void 0&&(B=new Set,A.set(h,B));B.has(_)||(B.add(_),a=m5.bind(null,a,h,_),h.then(a,a))}function nE(a){do{var h;if((h=a.tag===13)&&(h=a.memoizedState,h=h!==null?h.dehydrated!==null:!0),h)return a;a=a.return}while(a!==null);return null}function rE(a,h,_,A,B){return(a.mode&1)===0?(a===h?a.flags|=65536:(a.flags|=128,_.flags|=131072,_.flags&=-52805,_.tag===1&&(_.alternate===null?_.tag=17:(h=ha(-1,1),h.tag=2,bl(_,h,1))),_.lanes|=1),a):(a.flags|=65536,a.lanes=B,a)}var t5=I.ReactCurrentOwner,Ri=!1;function li(a,h,_,A){h.child=a===null?Ew(h,null,_,A):ed(h,a.child,_,A)}function iE(a,h,_,A,B){_=_.render;var H=h.ref;return nd(h,B),A=K0(a,h,_,A,H,B),_=Y0(),a!==null&&!Ri?(h.updateQueue=a.updateQueue,h.flags&=-2053,a.lanes&=~B,fa(a,h,B)):(jn&&_&&C0(h),h.flags|=1,li(a,h,A,B),h.child)}function sE(a,h,_,A,B){if(a===null){var H=_.type;return typeof H=="function"&&!Tv(H)&&H.defaultProps===void 0&&_.compare===null&&_.defaultProps===void 0?(h.tag=15,h.type=H,oE(a,h,H,A,B)):(a=Np(_.type,null,A,h,h.mode,B),a.ref=h.ref,a.return=h,h.child=a)}if(H=a.child,(a.lanes&B)===0){var te=H.memoizedProps;if(_=_.compare,_=_!==null?_:_o,_(te,A)&&a.ref===h.ref)return fa(a,h,B)}return h.flags|=1,a=Nl(H,A),a.ref=h.ref,a.return=h,h.child=a}function oE(a,h,_,A,B){if(a!==null){var H=a.memoizedProps;if(_o(H,A)&&a.ref===h.ref)if(Ri=!1,h.pendingProps=A=H,(a.lanes&B)!==0)(a.flags&131072)!==0&&(Ri=!0);else return h.lanes=a.lanes,fa(a,h,B)}return iv(a,h,_,A,B)}function aE(a,h,_){var A=h.pendingProps,B=A.children,H=a!==null?a.memoizedState:null;if(A.mode==="hidden")if((h.mode&1)===0)h.memoizedState={baseLanes:0,cachePool:null,transitions:null},Nn(od,ts),ts|=_;else{if((_&1073741824)===0)return a=H!==null?H.baseLanes|_:_,h.lanes=h.childLanes=1073741824,h.memoizedState={baseLanes:a,cachePool:null,transitions:null},h.updateQueue=null,Nn(od,ts),ts|=a,null;h.memoizedState={baseLanes:0,cachePool:null,transitions:null},A=H!==null?H.baseLanes:_,Nn(od,ts),ts|=A}else H!==null?(A=H.baseLanes|_,h.memoizedState=null):A=_,Nn(od,ts),ts|=A;return li(a,h,B,_),h.child}function lE(a,h){var _=h.ref;(a===null&&_!==null||a!==null&&a.ref!==_)&&(h.flags|=512,h.flags|=2097152)}function iv(a,h,_,A,B){var H=Ci(_)?Nc:Wr.current;return H=Zu(h,H),nd(h,B),_=K0(a,h,_,A,H,B),A=Y0(),a!==null&&!Ri?(h.updateQueue=a.updateQueue,h.flags&=-2053,a.lanes&=~B,fa(a,h,B)):(jn&&A&&C0(h),h.flags|=1,li(a,h,_,B),h.child)}function cE(a,h,_,A,B){if(Ci(_)){var H=!0;Xm(h)}else H=!1;if(nd(h,B),h.stateNode===null)gp(a,h),Qw(h,_,A),tv(h,_,A,B),A=!0;else if(a===null){var te=h.stateNode,de=h.memoizedProps;te.props=de;var me=te.context,Se=_.contextType;typeof Se=="object"&&Se!==null?Se=ws(Se):(Se=Ci(_)?Nc:Wr.current,Se=Zu(h,Se));var Oe=_.getDerivedStateFromProps,Fe=typeof Oe=="function"||typeof te.getSnapshotBeforeUpdate=="function";Fe||typeof te.UNSAFE_componentWillReceiveProps!="function"&&typeof te.componentWillReceiveProps!="function"||(de!==A||me!==Se)&&Xw(h,te,A,Se),xl=!1;var Re=h.memoizedState;te.state=Re,ap(h,A,te,B),me=h.memoizedState,de!==A||Re!==me||ki.current||xl?(typeof Oe=="function"&&(ev(h,_,Oe,A),me=h.memoizedState),(de=xl||Zw(h,_,de,A,Re,me,Se))?(Fe||typeof te.UNSAFE_componentWillMount!="function"&&typeof te.componentWillMount!="function"||(typeof te.componentWillMount=="function"&&te.componentWillMount(),typeof te.UNSAFE_componentWillMount=="function"&&te.UNSAFE_componentWillMount()),typeof te.componentDidMount=="function"&&(h.flags|=4194308)):(typeof te.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=A,h.memoizedState=me),te.props=A,te.state=me,te.context=Se,A=de):(typeof te.componentDidMount=="function"&&(h.flags|=4194308),A=!1)}else{te=h.stateNode,Tw(a,h),de=h.memoizedProps,Se=h.type===h.elementType?de:Qs(h.type,de),te.props=Se,Fe=h.pendingProps,Re=te.context,me=_.contextType,typeof me=="object"&&me!==null?me=ws(me):(me=Ci(_)?Nc:Wr.current,me=Zu(h,me));var Ye=_.getDerivedStateFromProps;(Oe=typeof Ye=="function"||typeof te.getSnapshotBeforeUpdate=="function")||typeof te.UNSAFE_componentWillReceiveProps!="function"&&typeof te.componentWillReceiveProps!="function"||(de!==Fe||Re!==me)&&Xw(h,te,A,me),xl=!1,Re=h.memoizedState,te.state=Re,ap(h,A,te,B);var tt=h.memoizedState;de!==Fe||Re!==tt||ki.current||xl?(typeof Ye=="function"&&(ev(h,_,Ye,A),tt=h.memoizedState),(Se=xl||Zw(h,_,Se,A,Re,tt,me)||!1)?(Oe||typeof te.UNSAFE_componentWillUpdate!="function"&&typeof te.componentWillUpdate!="function"||(typeof te.componentWillUpdate=="function"&&te.componentWillUpdate(A,tt,me),typeof te.UNSAFE_componentWillUpdate=="function"&&te.UNSAFE_componentWillUpdate(A,tt,me)),typeof te.componentDidUpdate=="function"&&(h.flags|=4),typeof te.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof te.componentDidUpdate!="function"||de===a.memoizedProps&&Re===a.memoizedState||(h.flags|=4),typeof te.getSnapshotBeforeUpdate!="function"||de===a.memoizedProps&&Re===a.memoizedState||(h.flags|=1024),h.memoizedProps=A,h.memoizedState=tt),te.props=A,te.state=tt,te.context=me,A=Se):(typeof te.componentDidUpdate!="function"||de===a.memoizedProps&&Re===a.memoizedState||(h.flags|=4),typeof te.getSnapshotBeforeUpdate!="function"||de===a.memoizedProps&&Re===a.memoizedState||(h.flags|=1024),A=!1)}return sv(a,h,_,A,H,B)}function sv(a,h,_,A,B,H){lE(a,h);var te=(h.flags&128)!==0;if(!A&&!te)return B&&mw(h,_,!1),fa(a,h,H);A=h.stateNode,t5.current=h;var de=te&&typeof _.getDerivedStateFromError!="function"?null:A.render();return h.flags|=1,a!==null&&te?(h.child=ed(h,a.child,null,H),h.child=ed(h,null,de,H)):li(a,h,de,H),h.memoizedState=A.state,B&&mw(h,_,!0),h.child}function uE(a){var h=a.stateNode;h.pendingContext?hw(a,h.pendingContext,h.pendingContext!==h.context):h.context&&hw(a,h.context,!1),U0(a,h.containerInfo)}function dE(a,h,_,A,B){return Ju(),D0(B),h.flags|=256,li(a,h,_,A),h.child}var ov={dehydrated:null,treeContext:null,retryLane:0};function av(a){return{baseLanes:a,cachePool:null,transitions:null}}function hE(a,h,_){var A=h.pendingProps,B=Bn.current,H=!1,te=(h.flags&128)!==0,de;if((de=te)||(de=a!==null&&a.memoizedState===null?!1:(B&2)!==0),de?(H=!0,h.flags&=-129):(a===null||a.memoizedState!==null)&&(B|=1),Nn(Bn,B&1),a===null)return O0(h),a=h.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((h.mode&1)===0?h.lanes=1:a.data==="$!"?h.lanes=8:h.lanes=1073741824,null):(te=A.children,a=A.fallback,H?(A=h.mode,H=h.child,te={mode:"hidden",children:te},(A&1)===0&&H!==null?(H.childLanes=0,H.pendingProps=te):H=Ip(te,A,0,null),a=Lc(a,A,_,null),H.return=h,a.return=h,H.sibling=a,h.child=H,h.child.memoizedState=av(_),h.memoizedState=ov,a):lv(h,te));if(B=a.memoizedState,B!==null&&(de=B.dehydrated,de!==null))return n5(a,h,te,A,de,B,_);if(H){H=A.fallback,te=h.mode,B=a.child,de=B.sibling;var me={mode:"hidden",children:A.children};return(te&1)===0&&h.child!==B?(A=h.child,A.childLanes=0,A.pendingProps=me,h.deletions=null):(A=Nl(B,me),A.subtreeFlags=B.subtreeFlags&14680064),de!==null?H=Nl(de,H):(H=Lc(H,te,_,null),H.flags|=2),H.return=h,A.return=h,A.sibling=H,h.child=A,A=H,H=h.child,te=a.child.memoizedState,te=te===null?av(_):{baseLanes:te.baseLanes|_,cachePool:null,transitions:te.transitions},H.memoizedState=te,H.childLanes=a.childLanes&~_,h.memoizedState=ov,A}return H=a.child,a=H.sibling,A=Nl(H,{mode:"visible",children:A.children}),(h.mode&1)===0&&(A.lanes=_),A.return=h,A.sibling=null,a!==null&&(_=h.deletions,_===null?(h.deletions=[a],h.flags|=16):_.push(a)),h.child=A,h.memoizedState=null,A}function lv(a,h){return h=Ip({mode:"visible",children:h},a.mode,0,null),h.return=a,a.child=h}function pp(a,h,_,A){return A!==null&&D0(A),ed(h,a.child,null,_),a=lv(h,h.pendingProps.children),a.flags|=2,h.memoizedState=null,a}function n5(a,h,_,A,B,H,te){if(_)return h.flags&256?(h.flags&=-257,A=nv(Error(t(422))),pp(a,h,te,A)):h.memoizedState!==null?(h.child=a.child,h.flags|=128,null):(H=A.fallback,B=h.mode,A=Ip({mode:"visible",children:A.children},B,0,null),H=Lc(H,B,te,null),H.flags|=2,A.return=h,H.return=h,A.sibling=H,h.child=A,(h.mode&1)!==0&&ed(h,a.child,null,te),h.child.memoizedState=av(te),h.memoizedState=ov,H);if((h.mode&1)===0)return pp(a,h,te,null);if(B.data==="$!"){if(A=B.nextSibling&&B.nextSibling.dataset,A)var de=A.dgst;return A=de,H=Error(t(419)),A=nv(H,A,void 0),pp(a,h,te,A)}if(de=(te&a.childLanes)!==0,Ri||de){if(A=wr,A!==null){switch(te&-te){case 4:B=2;break;case 16:B=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:B=32;break;case 536870912:B=268435456;break;default:B=0}B=(B&(A.suspendedLanes|te))!==0?0:B,B!==0&&B!==H.retryLane&&(H.retryLane=B,da(a,B),eo(A,a,B,-1))}return Sv(),A=nv(Error(t(421))),pp(a,h,te,A)}return B.data==="$?"?(h.flags|=128,h.child=a.child,h=p5.bind(null,a),B._reactRetry=h,null):(a=H.treeContext,es=wo(B.nextSibling),Ji=h,jn=!0,Zs=null,a!==null&&(xs[bs++]=ca,xs[bs++]=ua,xs[bs++]=Ic,ca=a.id,ua=a.overflow,Ic=h),h=lv(h,A.children),h.flags|=4096,h)}function fE(a,h,_){a.lanes|=h;var A=a.alternate;A!==null&&(A.lanes|=h),V0(a.return,h,_)}function cv(a,h,_,A,B){var H=a.memoizedState;H===null?a.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:A,tail:_,tailMode:B}:(H.isBackwards=h,H.rendering=null,H.renderingStartTime=0,H.last=A,H.tail=_,H.tailMode=B)}function mE(a,h,_){var A=h.pendingProps,B=A.revealOrder,H=A.tail;if(li(a,h,A.children,_),A=Bn.current,(A&2)!==0)A=A&1|2,h.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=h.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&fE(a,_,h);else if(a.tag===19)fE(a,_,h);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===h)break e;for(;a.sibling===null;){if(a.return===null||a.return===h)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}A&=1}if(Nn(Bn,A),(h.mode&1)===0)h.memoizedState=null;else switch(B){case"forwards":for(_=h.child,B=null;_!==null;)a=_.alternate,a!==null&&lp(a)===null&&(B=_),_=_.sibling;_=B,_===null?(B=h.child,h.child=null):(B=_.sibling,_.sibling=null),cv(h,!1,B,_,H);break;case"backwards":for(_=null,B=h.child,h.child=null;B!==null;){if(a=B.alternate,a!==null&&lp(a)===null){h.child=B;break}a=B.sibling,B.sibling=_,_=B,B=a}cv(h,!0,_,null,H);break;case"together":cv(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function gp(a,h){(h.mode&1)===0&&a!==null&&(a.alternate=null,h.alternate=null,h.flags|=2)}function fa(a,h,_){if(a!==null&&(h.dependencies=a.dependencies),jc|=h.lanes,(_&h.childLanes)===0)return null;if(a!==null&&h.child!==a.child)throw Error(t(153));if(h.child!==null){for(a=h.child,_=Nl(a,a.pendingProps),h.child=_,_.return=h;a.sibling!==null;)a=a.sibling,_=_.sibling=Nl(a,a.pendingProps),_.return=h;_.sibling=null}return h.child}function r5(a,h,_){switch(h.tag){case 3:uE(h),Ju();break;case 5:Iw(h);break;case 1:Ci(h.type)&&Xm(h);break;case 4:U0(h,h.stateNode.containerInfo);break;case 10:var A=h.type._context,B=h.memoizedProps.value;Nn(ip,A._currentValue),A._currentValue=B;break;case 13:if(A=h.memoizedState,A!==null)return A.dehydrated!==null?(Nn(Bn,Bn.current&1),h.flags|=128,null):(_&h.child.childLanes)!==0?hE(a,h,_):(Nn(Bn,Bn.current&1),a=fa(a,h,_),a!==null?a.sibling:null);Nn(Bn,Bn.current&1);break;case 19:if(A=(_&h.childLanes)!==0,(a.flags&128)!==0){if(A)return mE(a,h,_);h.flags|=128}if(B=h.memoizedState,B!==null&&(B.rendering=null,B.tail=null,B.lastEffect=null),Nn(Bn,Bn.current),A)break;return null;case 22:case 23:return h.lanes=0,aE(a,h,_)}return fa(a,h,_)}var pE,uv,gE,yE;pE=function(a,h){for(var _=h.child;_!==null;){if(_.tag===5||_.tag===6)a.appendChild(_.stateNode);else if(_.tag!==4&&_.child!==null){_.child.return=_,_=_.child;continue}if(_===h)break;for(;_.sibling===null;){if(_.return===null||_.return===h)return;_=_.return}_.sibling.return=_.return,_=_.sibling}},uv=function(){},gE=function(a,h,_,A){var B=a.memoizedProps;if(B!==A){a=h.stateNode,Cc(Eo.current);var H=null;switch(_){case"input":B=Ge(a,B),A=Ge(a,A),H=[];break;case"select":B=G({},B,{value:void 0}),A=G({},A,{value:void 0}),H=[];break;case"textarea":B=ke(a,B),A=ke(a,A),H=[];break;default:typeof B.onClick!="function"&&typeof A.onClick=="function"&&(a.onclick=Ce)}vi(_,A);var te;_=null;for(Se in B)if(!A.hasOwnProperty(Se)&&B.hasOwnProperty(Se)&&B[Se]!=null)if(Se==="style"){var de=B[Se];for(te in de)de.hasOwnProperty(te)&&(_||(_={}),_[te]="")}else Se!=="dangerouslySetInnerHTML"&&Se!=="children"&&Se!=="suppressContentEditableWarning"&&Se!=="suppressHydrationWarning"&&Se!=="autoFocus"&&(i.hasOwnProperty(Se)?H||(H=[]):(H=H||[]).push(Se,null));for(Se in A){var me=A[Se];if(de=B!=null?B[Se]:void 0,A.hasOwnProperty(Se)&&me!==de&&(me!=null||de!=null))if(Se==="style")if(de){for(te in de)!de.hasOwnProperty(te)||me&&me.hasOwnProperty(te)||(_||(_={}),_[te]="");for(te in me)me.hasOwnProperty(te)&&de[te]!==me[te]&&(_||(_={}),_[te]=me[te])}else _||(H||(H=[]),H.push(Se,_)),_=me;else Se==="dangerouslySetInnerHTML"?(me=me?me.__html:void 0,de=de?de.__html:void 0,me!=null&&de!==me&&(H=H||[]).push(Se,me)):Se==="children"?typeof me!="string"&&typeof me!="number"||(H=H||[]).push(Se,""+me):Se!=="suppressContentEditableWarning"&&Se!=="suppressHydrationWarning"&&(i.hasOwnProperty(Se)?(me!=null&&Se==="onScroll"&&xn("scroll",a),H||de===me||(H=[])):(H=H||[]).push(Se,me))}_&&(H=H||[]).push("style",_);var Se=H;(h.updateQueue=Se)&&(h.flags|=4)}},yE=function(a,h,_,A){_!==A&&(h.flags|=4)};function Lh(a,h){if(!jn)switch(a.tailMode){case"hidden":h=a.tail;for(var _=null;h!==null;)h.alternate!==null&&(_=h),h=h.sibling;_===null?a.tail=null:_.sibling=null;break;case"collapsed":_=a.tail;for(var A=null;_!==null;)_.alternate!==null&&(A=_),_=_.sibling;A===null?h||a.tail===null?a.tail=null:a.tail.sibling=null:A.sibling=null}}function Kr(a){var h=a.alternate!==null&&a.alternate.child===a.child,_=0,A=0;if(h)for(var B=a.child;B!==null;)_|=B.lanes|B.childLanes,A|=B.subtreeFlags&14680064,A|=B.flags&14680064,B.return=a,B=B.sibling;else for(B=a.child;B!==null;)_|=B.lanes|B.childLanes,A|=B.subtreeFlags,A|=B.flags,B.return=a,B=B.sibling;return a.subtreeFlags|=A,a.childLanes=_,h}function i5(a,h,_){var A=h.pendingProps;switch(R0(h),h.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kr(h),null;case 1:return Ci(h.type)&&Qm(),Kr(h),null;case 3:return A=h.stateNode,rd(),kn(ki),kn(Wr),$0(),A.pendingContext&&(A.context=A.pendingContext,A.pendingContext=null),(a===null||a.child===null)&&(np(h)?h.flags|=4:a===null||a.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,Zs!==null&&(bv(Zs),Zs=null))),uv(a,h),Kr(h),null;case 5:q0(h);var B=Cc(Rh.current);if(_=h.type,a!==null&&h.stateNode!=null)gE(a,h,_,A,B),a.ref!==h.ref&&(h.flags|=512,h.flags|=2097152);else{if(!A){if(h.stateNode===null)throw Error(t(166));return Kr(h),null}if(a=Cc(Eo.current),np(h)){A=h.stateNode,_=h.type;var H=h.memoizedProps;switch(A[_s]=h,A[pl]=H,a=(h.mode&1)!==0,_){case"dialog":xn("cancel",A),xn("close",A);break;case"iframe":case"object":case"embed":xn("load",A);break;case"video":case"audio":for(B=0;B<hl.length;B++)xn(hl[B],A);break;case"source":xn("error",A);break;case"img":case"image":case"link":xn("error",A),xn("load",A);break;case"details":xn("toggle",A);break;case"input":lt(A,H),xn("invalid",A);break;case"select":A._wrapperState={wasMultiple:!!H.multiple},xn("invalid",A);break;case"textarea":_t(A,H),xn("invalid",A)}vi(_,H),B=null;for(var te in H)if(H.hasOwnProperty(te)){var de=H[te];te==="children"?typeof de=="string"?A.textContent!==de&&(H.suppressHydrationWarning!==!0&&Ee(A.textContent,de,a),B=["children",de]):typeof de=="number"&&A.textContent!==""+de&&(H.suppressHydrationWarning!==!0&&Ee(A.textContent,de,a),B=["children",""+de]):i.hasOwnProperty(te)&&de!=null&&te==="onScroll"&&xn("scroll",A)}switch(_){case"input":Me(A),Te(A,H,!0);break;case"textarea":Me(A),yt(A);break;case"select":case"option":break;default:typeof H.onClick=="function"&&(A.onclick=Ce)}A=B,h.updateQueue=A,A!==null&&(h.flags|=4)}else{te=B.nodeType===9?B:B.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=kt(_)),a==="http://www.w3.org/1999/xhtml"?_==="script"?(a=te.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof A.is=="string"?a=te.createElement(_,{is:A.is}):(a=te.createElement(_),_==="select"&&(te=a,A.multiple?te.multiple=!0:A.size&&(te.size=A.size))):a=te.createElementNS(a,_),a[_s]=h,a[pl]=A,pE(a,h,!1,!1),h.stateNode=a;e:{switch(te=ni(_,A),_){case"dialog":xn("cancel",a),xn("close",a),B=A;break;case"iframe":case"object":case"embed":xn("load",a),B=A;break;case"video":case"audio":for(B=0;B<hl.length;B++)xn(hl[B],a);B=A;break;case"source":xn("error",a),B=A;break;case"img":case"image":case"link":xn("error",a),xn("load",a),B=A;break;case"details":xn("toggle",a),B=A;break;case"input":lt(a,A),B=Ge(a,A),xn("invalid",a);break;case"option":B=A;break;case"select":a._wrapperState={wasMultiple:!!A.multiple},B=G({},A,{value:void 0}),xn("invalid",a);break;case"textarea":_t(a,A),B=ke(a,A),xn("invalid",a);break;default:B=A}vi(_,B),de=B;for(H in de)if(de.hasOwnProperty(H)){var me=de[H];H==="style"?yi(a,me):H==="dangerouslySetInnerHTML"?(me=me?me.__html:void 0,me!=null&&cs(a,me)):H==="children"?typeof me=="string"?(_!=="textarea"||me!=="")&&Gt(a,me):typeof me=="number"&&Gt(a,""+me):H!=="suppressContentEditableWarning"&&H!=="suppressHydrationWarning"&&H!=="autoFocus"&&(i.hasOwnProperty(H)?me!=null&&H==="onScroll"&&xn("scroll",a):me!=null&&R(a,H,me,te))}switch(_){case"input":Me(a),Te(a,A,!1);break;case"textarea":Me(a),yt(a);break;case"option":A.value!=null&&a.setAttribute("value",""+ue(A.value));break;case"select":a.multiple=!!A.multiple,H=A.value,H!=null?Be(a,!!A.multiple,H,!1):A.defaultValue!=null&&Be(a,!!A.multiple,A.defaultValue,!0);break;default:typeof B.onClick=="function"&&(a.onclick=Ce)}switch(_){case"button":case"input":case"select":case"textarea":A=!!A.autoFocus;break e;case"img":A=!0;break e;default:A=!1}}A&&(h.flags|=4)}h.ref!==null&&(h.flags|=512,h.flags|=2097152)}return Kr(h),null;case 6:if(a&&h.stateNode!=null)yE(a,h,a.memoizedProps,A);else{if(typeof A!="string"&&h.stateNode===null)throw Error(t(166));if(_=Cc(Rh.current),Cc(Eo.current),np(h)){if(A=h.stateNode,_=h.memoizedProps,A[_s]=h,(H=A.nodeValue!==_)&&(a=Ji,a!==null))switch(a.tag){case 3:Ee(A.nodeValue,_,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Ee(A.nodeValue,_,(a.mode&1)!==0)}H&&(h.flags|=4)}else A=(_.nodeType===9?_:_.ownerDocument).createTextNode(A),A[_s]=h,h.stateNode=A}return Kr(h),null;case 13:if(kn(Bn),A=h.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(jn&&es!==null&&(h.mode&1)!==0&&(h.flags&128)===0)xw(),Ju(),h.flags|=98560,H=!1;else if(H=np(h),A!==null&&A.dehydrated!==null){if(a===null){if(!H)throw Error(t(318));if(H=h.memoizedState,H=H!==null?H.dehydrated:null,!H)throw Error(t(317));H[_s]=h}else Ju(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Kr(h),H=!1}else Zs!==null&&(bv(Zs),Zs=null),H=!0;if(!H)return h.flags&65536?h:null}return(h.flags&128)!==0?(h.lanes=_,h):(A=A!==null,A!==(a!==null&&a.memoizedState!==null)&&A&&(h.child.flags|=8192,(h.mode&1)!==0&&(a===null||(Bn.current&1)!==0?hr===0&&(hr=3):Sv())),h.updateQueue!==null&&(h.flags|=4),Kr(h),null);case 4:return rd(),uv(a,h),a===null&&fl(h.stateNode.containerInfo),Kr(h),null;case 10:return F0(h.type._context),Kr(h),null;case 17:return Ci(h.type)&&Qm(),Kr(h),null;case 19:if(kn(Bn),H=h.memoizedState,H===null)return Kr(h),null;if(A=(h.flags&128)!==0,te=H.rendering,te===null)if(A)Lh(H,!1);else{if(hr!==0||a!==null&&(a.flags&128)!==0)for(a=h.child;a!==null;){if(te=lp(a),te!==null){for(h.flags|=128,Lh(H,!1),A=te.updateQueue,A!==null&&(h.updateQueue=A,h.flags|=4),h.subtreeFlags=0,A=_,_=h.child;_!==null;)H=_,a=A,H.flags&=14680066,te=H.alternate,te===null?(H.childLanes=0,H.lanes=a,H.child=null,H.subtreeFlags=0,H.memoizedProps=null,H.memoizedState=null,H.updateQueue=null,H.dependencies=null,H.stateNode=null):(H.childLanes=te.childLanes,H.lanes=te.lanes,H.child=te.child,H.subtreeFlags=0,H.deletions=null,H.memoizedProps=te.memoizedProps,H.memoizedState=te.memoizedState,H.updateQueue=te.updateQueue,H.type=te.type,a=te.dependencies,H.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),_=_.sibling;return Nn(Bn,Bn.current&1|2),h.child}a=a.sibling}H.tail!==null&&Pt()>ad&&(h.flags|=128,A=!0,Lh(H,!1),h.lanes=4194304)}else{if(!A)if(a=lp(te),a!==null){if(h.flags|=128,A=!0,_=a.updateQueue,_!==null&&(h.updateQueue=_,h.flags|=4),Lh(H,!0),H.tail===null&&H.tailMode==="hidden"&&!te.alternate&&!jn)return Kr(h),null}else 2*Pt()-H.renderingStartTime>ad&&_!==1073741824&&(h.flags|=128,A=!0,Lh(H,!1),h.lanes=4194304);H.isBackwards?(te.sibling=h.child,h.child=te):(_=H.last,_!==null?_.sibling=te:h.child=te,H.last=te)}return H.tail!==null?(h=H.tail,H.rendering=h,H.tail=h.sibling,H.renderingStartTime=Pt(),h.sibling=null,_=Bn.current,Nn(Bn,A?_&1|2:_&1),h):(Kr(h),null);case 22:case 23:return Ev(),A=h.memoizedState!==null,a!==null&&a.memoizedState!==null!==A&&(h.flags|=8192),A&&(h.mode&1)!==0?(ts&1073741824)!==0&&(Kr(h),h.subtreeFlags&6&&(h.flags|=8192)):Kr(h),null;case 24:return null;case 25:return null}throw Error(t(156,h.tag))}function s5(a,h){switch(R0(h),h.tag){case 1:return Ci(h.type)&&Qm(),a=h.flags,a&65536?(h.flags=a&-65537|128,h):null;case 3:return rd(),kn(ki),kn(Wr),$0(),a=h.flags,(a&65536)!==0&&(a&128)===0?(h.flags=a&-65537|128,h):null;case 5:return q0(h),null;case 13:if(kn(Bn),a=h.memoizedState,a!==null&&a.dehydrated!==null){if(h.alternate===null)throw Error(t(340));Ju()}return a=h.flags,a&65536?(h.flags=a&-65537|128,h):null;case 19:return kn(Bn),null;case 4:return rd(),null;case 10:return F0(h.type._context),null;case 22:case 23:return Ev(),null;case 24:return null;default:return null}}var yp=!1,Yr=!1,o5=typeof WeakSet=="function"?WeakSet:Set,Xe=null;function sd(a,h){var _=a.ref;if(_!==null)if(typeof _=="function")try{_(null)}catch(A){$n(a,h,A)}else _.current=null}function dv(a,h,_){try{_()}catch(A){$n(a,h,A)}}var vE=!1;function a5(a,h){if(We=Hs,a=xh(),bh(a)){if("selectionStart"in a)var _={start:a.selectionStart,end:a.selectionEnd};else e:{_=(_=a.ownerDocument)&&_.defaultView||window;var A=_.getSelection&&_.getSelection();if(A&&A.rangeCount!==0){_=A.anchorNode;var B=A.anchorOffset,H=A.focusNode;A=A.focusOffset;try{_.nodeType,H.nodeType}catch{_=null;break e}var te=0,de=-1,me=-1,Se=0,Oe=0,Fe=a,Re=null;t:for(;;){for(var Ye;Fe!==_||B!==0&&Fe.nodeType!==3||(de=te+B),Fe!==H||A!==0&&Fe.nodeType!==3||(me=te+A),Fe.nodeType===3&&(te+=Fe.nodeValue.length),(Ye=Fe.firstChild)!==null;)Re=Fe,Fe=Ye;for(;;){if(Fe===a)break t;if(Re===_&&++Se===B&&(de=te),Re===H&&++Oe===A&&(me=te),(Ye=Fe.nextSibling)!==null)break;Fe=Re,Re=Fe.parentNode}Fe=Ye}_=de===-1||me===-1?null:{start:de,end:me}}else _=null}_=_||{start:0,end:0}}else _=null;for(ht={focusedElem:a,selectionRange:_},Hs=!1,Xe=h;Xe!==null;)if(h=Xe,a=h.child,(h.subtreeFlags&1028)!==0&&a!==null)a.return=h,Xe=a;else for(;Xe!==null;){h=Xe;try{var tt=h.alternate;if((h.flags&1024)!==0)switch(h.tag){case 0:case 11:case 15:break;case 1:if(tt!==null){var it=tt.memoizedProps,Zn=tt.memoizedState,be=h.stateNode,ge=be.getSnapshotBeforeUpdate(h.elementType===h.type?it:Qs(h.type,it),Zn);be.__reactInternalSnapshotBeforeUpdate=ge}break;case 3:var we=h.stateNode.containerInfo;we.nodeType===1?we.textContent="":we.nodeType===9&&we.documentElement&&we.removeChild(we.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ue){$n(h,h.return,Ue)}if(a=h.sibling,a!==null){a.return=h.return,Xe=a;break}Xe=h.return}return tt=vE,vE=!1,tt}function Fh(a,h,_){var A=h.updateQueue;if(A=A!==null?A.lastEffect:null,A!==null){var B=A=A.next;do{if((B.tag&a)===a){var H=B.destroy;B.destroy=void 0,H!==void 0&&dv(h,_,H)}B=B.next}while(B!==A)}}function vp(a,h){if(h=h.updateQueue,h=h!==null?h.lastEffect:null,h!==null){var _=h=h.next;do{if((_.tag&a)===a){var A=_.create;_.destroy=A()}_=_.next}while(_!==h)}}function hv(a){var h=a.ref;if(h!==null){var _=a.stateNode;switch(a.tag){case 5:a=_;break;default:a=_}typeof h=="function"?h(a):h.current=a}}function _E(a){var h=a.alternate;h!==null&&(a.alternate=null,_E(h)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(h=a.stateNode,h!==null&&(delete h[_s],delete h[pl],delete h[gl],delete h[N0],delete h[I0])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function xE(a){return a.tag===5||a.tag===3||a.tag===4}function bE(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||xE(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function fv(a,h,_){var A=a.tag;if(A===5||A===6)a=a.stateNode,h?_.nodeType===8?_.parentNode.insertBefore(a,h):_.insertBefore(a,h):(_.nodeType===8?(h=_.parentNode,h.insertBefore(a,_)):(h=_,h.appendChild(a)),_=_._reactRootContainer,_!=null||h.onclick!==null||(h.onclick=Ce));else if(A!==4&&(a=a.child,a!==null))for(fv(a,h,_),a=a.sibling;a!==null;)fv(a,h,_),a=a.sibling}function mv(a,h,_){var A=a.tag;if(A===5||A===6)a=a.stateNode,h?_.insertBefore(a,h):_.appendChild(a);else if(A!==4&&(a=a.child,a!==null))for(mv(a,h,_),a=a.sibling;a!==null;)mv(a,h,_),a=a.sibling}var Or=null,Xs=!1;function wl(a,h,_){for(_=_.child;_!==null;)wE(a,h,_),_=_.sibling}function wE(a,h,_){if(lr&&typeof lr.onCommitFiberUnmount=="function")try{lr.onCommitFiberUnmount(Wi,_)}catch{}switch(_.tag){case 5:Yr||sd(_,h);case 6:var A=Or,B=Xs;Or=null,wl(a,h,_),Or=A,Xs=B,Or!==null&&(Xs?(a=Or,_=_.stateNode,a.nodeType===8?a.parentNode.removeChild(_):a.removeChild(_)):Or.removeChild(_.stateNode));break;case 18:Or!==null&&(Xs?(a=Or,_=_.stateNode,a.nodeType===8?Ih(a.parentNode,_):a.nodeType===1&&Ih(a,_),cr(a)):Ih(Or,_.stateNode));break;case 4:A=Or,B=Xs,Or=_.stateNode.containerInfo,Xs=!0,wl(a,h,_),Or=A,Xs=B;break;case 0:case 11:case 14:case 15:if(!Yr&&(A=_.updateQueue,A!==null&&(A=A.lastEffect,A!==null))){B=A=A.next;do{var H=B,te=H.destroy;H=H.tag,te!==void 0&&((H&2)!==0||(H&4)!==0)&&dv(_,h,te),B=B.next}while(B!==A)}wl(a,h,_);break;case 1:if(!Yr&&(sd(_,h),A=_.stateNode,typeof A.componentWillUnmount=="function"))try{A.props=_.memoizedProps,A.state=_.memoizedState,A.componentWillUnmount()}catch(de){$n(_,h,de)}wl(a,h,_);break;case 21:wl(a,h,_);break;case 22:_.mode&1?(Yr=(A=Yr)||_.memoizedState!==null,wl(a,h,_),Yr=A):wl(a,h,_);break;default:wl(a,h,_)}}function EE(a){var h=a.updateQueue;if(h!==null){a.updateQueue=null;var _=a.stateNode;_===null&&(_=a.stateNode=new o5),h.forEach(function(A){var B=g5.bind(null,a,A);_.has(A)||(_.add(A),A.then(B,B))})}}function Js(a,h){var _=h.deletions;if(_!==null)for(var A=0;A<_.length;A++){var B=_[A];try{var H=a,te=h,de=te;e:for(;de!==null;){switch(de.tag){case 5:Or=de.stateNode,Xs=!1;break e;case 3:Or=de.stateNode.containerInfo,Xs=!0;break e;case 4:Or=de.stateNode.containerInfo,Xs=!0;break e}de=de.return}if(Or===null)throw Error(t(160));wE(H,te,B),Or=null,Xs=!1;var me=B.alternate;me!==null&&(me.return=null),B.return=null}catch(Se){$n(B,h,Se)}}if(h.subtreeFlags&12854)for(h=h.child;h!==null;)SE(h,a),h=h.sibling}function SE(a,h){var _=a.alternate,A=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(Js(h,a),To(a),A&4){try{Fh(3,a,a.return),vp(3,a)}catch(it){$n(a,a.return,it)}try{Fh(5,a,a.return)}catch(it){$n(a,a.return,it)}}break;case 1:Js(h,a),To(a),A&512&&_!==null&&sd(_,_.return);break;case 5:if(Js(h,a),To(a),A&512&&_!==null&&sd(_,_.return),a.flags&32){var B=a.stateNode;try{Gt(B,"")}catch(it){$n(a,a.return,it)}}if(A&4&&(B=a.stateNode,B!=null)){var H=a.memoizedProps,te=_!==null?_.memoizedProps:H,de=a.type,me=a.updateQueue;if(a.updateQueue=null,me!==null)try{de==="input"&&H.type==="radio"&&H.name!=null&&Ct(B,H),ni(de,te);var Se=ni(de,H);for(te=0;te<me.length;te+=2){var Oe=me[te],Fe=me[te+1];Oe==="style"?yi(B,Fe):Oe==="dangerouslySetInnerHTML"?cs(B,Fe):Oe==="children"?Gt(B,Fe):R(B,Oe,Fe,Se)}switch(de){case"input":bt(B,H);break;case"textarea":gt(B,H);break;case"select":var Re=B._wrapperState.wasMultiple;B._wrapperState.wasMultiple=!!H.multiple;var Ye=H.value;Ye!=null?Be(B,!!H.multiple,Ye,!1):Re!==!!H.multiple&&(H.defaultValue!=null?Be(B,!!H.multiple,H.defaultValue,!0):Be(B,!!H.multiple,H.multiple?[]:"",!1))}B[pl]=H}catch(it){$n(a,a.return,it)}}break;case 6:if(Js(h,a),To(a),A&4){if(a.stateNode===null)throw Error(t(162));B=a.stateNode,H=a.memoizedProps;try{B.nodeValue=H}catch(it){$n(a,a.return,it)}}break;case 3:if(Js(h,a),To(a),A&4&&_!==null&&_.memoizedState.isDehydrated)try{cr(h.containerInfo)}catch(it){$n(a,a.return,it)}break;case 4:Js(h,a),To(a);break;case 13:Js(h,a),To(a),B=a.child,B.flags&8192&&(H=B.memoizedState!==null,B.stateNode.isHidden=H,!H||B.alternate!==null&&B.alternate.memoizedState!==null||(yv=Pt())),A&4&&EE(a);break;case 22:if(Oe=_!==null&&_.memoizedState!==null,a.mode&1?(Yr=(Se=Yr)||Oe,Js(h,a),Yr=Se):Js(h,a),To(a),A&8192){if(Se=a.memoizedState!==null,(a.stateNode.isHidden=Se)&&!Oe&&(a.mode&1)!==0)for(Xe=a,Oe=a.child;Oe!==null;){for(Fe=Xe=Oe;Xe!==null;){switch(Re=Xe,Ye=Re.child,Re.tag){case 0:case 11:case 14:case 15:Fh(4,Re,Re.return);break;case 1:sd(Re,Re.return);var tt=Re.stateNode;if(typeof tt.componentWillUnmount=="function"){A=Re,_=Re.return;try{h=A,tt.props=h.memoizedProps,tt.state=h.memoizedState,tt.componentWillUnmount()}catch(it){$n(A,_,it)}}break;case 5:sd(Re,Re.return);break;case 22:if(Re.memoizedState!==null){NE(Fe);continue}}Ye!==null?(Ye.return=Re,Xe=Ye):NE(Fe)}Oe=Oe.sibling}e:for(Oe=null,Fe=a;;){if(Fe.tag===5){if(Oe===null){Oe=Fe;try{B=Fe.stateNode,Se?(H=B.style,typeof H.setProperty=="function"?H.setProperty("display","none","important"):H.display="none"):(de=Fe.stateNode,me=Fe.memoizedProps.style,te=me!=null&&me.hasOwnProperty("display")?me.display:null,de.style.display=Ui("display",te))}catch(it){$n(a,a.return,it)}}}else if(Fe.tag===6){if(Oe===null)try{Fe.stateNode.nodeValue=Se?"":Fe.memoizedProps}catch(it){$n(a,a.return,it)}}else if((Fe.tag!==22&&Fe.tag!==23||Fe.memoizedState===null||Fe===a)&&Fe.child!==null){Fe.child.return=Fe,Fe=Fe.child;continue}if(Fe===a)break e;for(;Fe.sibling===null;){if(Fe.return===null||Fe.return===a)break e;Oe===Fe&&(Oe=null),Fe=Fe.return}Oe===Fe&&(Oe=null),Fe.sibling.return=Fe.return,Fe=Fe.sibling}}break;case 19:Js(h,a),To(a),A&4&&EE(a);break;case 21:break;default:Js(h,a),To(a)}}function To(a){var h=a.flags;if(h&2){try{e:{for(var _=a.return;_!==null;){if(xE(_)){var A=_;break e}_=_.return}throw Error(t(160))}switch(A.tag){case 5:var B=A.stateNode;A.flags&32&&(Gt(B,""),A.flags&=-33);var H=bE(a);mv(a,H,B);break;case 3:case 4:var te=A.stateNode.containerInfo,de=bE(a);fv(a,de,te);break;default:throw Error(t(161))}}catch(me){$n(a,a.return,me)}a.flags&=-3}h&4096&&(a.flags&=-4097)}function l5(a,h,_){Xe=a,TE(a)}function TE(a,h,_){for(var A=(a.mode&1)!==0;Xe!==null;){var B=Xe,H=B.child;if(B.tag===22&&A){var te=B.memoizedState!==null||yp;if(!te){var de=B.alternate,me=de!==null&&de.memoizedState!==null||Yr;de=yp;var Se=Yr;if(yp=te,(Yr=me)&&!Se)for(Xe=B;Xe!==null;)te=Xe,me=te.child,te.tag===22&&te.memoizedState!==null?IE(B):me!==null?(me.return=te,Xe=me):IE(B);for(;H!==null;)Xe=H,TE(H),H=H.sibling;Xe=B,yp=de,Yr=Se}AE(a)}else(B.subtreeFlags&8772)!==0&&H!==null?(H.return=B,Xe=H):AE(a)}}function AE(a){for(;Xe!==null;){var h=Xe;if((h.flags&8772)!==0){var _=h.alternate;try{if((h.flags&8772)!==0)switch(h.tag){case 0:case 11:case 15:Yr||vp(5,h);break;case 1:var A=h.stateNode;if(h.flags&4&&!Yr)if(_===null)A.componentDidMount();else{var B=h.elementType===h.type?_.memoizedProps:Qs(h.type,_.memoizedProps);A.componentDidUpdate(B,_.memoizedState,A.__reactInternalSnapshotBeforeUpdate)}var H=h.updateQueue;H!==null&&Nw(h,H,A);break;case 3:var te=h.updateQueue;if(te!==null){if(_=null,h.child!==null)switch(h.child.tag){case 5:_=h.child.stateNode;break;case 1:_=h.child.stateNode}Nw(h,te,_)}break;case 5:var de=h.stateNode;if(_===null&&h.flags&4){_=de;var me=h.memoizedProps;switch(h.type){case"button":case"input":case"select":case"textarea":me.autoFocus&&_.focus();break;case"img":me.src&&(_.src=me.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(h.memoizedState===null){var Se=h.alternate;if(Se!==null){var Oe=Se.memoizedState;if(Oe!==null){var Fe=Oe.dehydrated;Fe!==null&&cr(Fe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Yr||h.flags&512&&hv(h)}catch(Re){$n(h,h.return,Re)}}if(h===a){Xe=null;break}if(_=h.sibling,_!==null){_.return=h.return,Xe=_;break}Xe=h.return}}function NE(a){for(;Xe!==null;){var h=Xe;if(h===a){Xe=null;break}var _=h.sibling;if(_!==null){_.return=h.return,Xe=_;break}Xe=h.return}}function IE(a){for(;Xe!==null;){var h=Xe;try{switch(h.tag){case 0:case 11:case 15:var _=h.return;try{vp(4,h)}catch(me){$n(h,_,me)}break;case 1:var A=h.stateNode;if(typeof A.componentDidMount=="function"){var B=h.return;try{A.componentDidMount()}catch(me){$n(h,B,me)}}var H=h.return;try{hv(h)}catch(me){$n(h,H,me)}break;case 5:var te=h.return;try{hv(h)}catch(me){$n(h,te,me)}}}catch(me){$n(h,h.return,me)}if(h===a){Xe=null;break}var de=h.sibling;if(de!==null){de.return=h.return,Xe=de;break}Xe=h.return}}var c5=Math.ceil,_p=I.ReactCurrentDispatcher,pv=I.ReactCurrentOwner,Ss=I.ReactCurrentBatchConfig,Xt=0,wr=null,or=null,Dr=0,ts=0,od=yl(0),hr=0,Vh=null,jc=0,xp=0,gv=0,Bh=null,ji=null,yv=0,ad=1/0,ma=null,bp=!1,vv=null,El=null,wp=!1,Sl=null,Ep=0,zh=0,_v=null,Sp=-1,Tp=0;function ci(){return(Xt&6)!==0?Pt():Sp!==-1?Sp:Sp=Pt()}function Tl(a){return(a.mode&1)===0?1:(Xt&2)!==0&&Dr!==0?Dr&-Dr:WR.transition!==null?(Tp===0&&(Tp=Go()),Tp):(a=jt,a!==0||(a=window.event,a=a===void 0?16:Dt(a.type)),a)}function eo(a,h,_,A){if(50<zh)throw zh=0,_v=null,Error(t(185));zr(a,_,A),((Xt&2)===0||a!==wr)&&(a===wr&&((Xt&2)===0&&(xp|=_),hr===4&&Al(a,Dr)),Oi(a,A),_===1&&Xt===0&&(h.mode&1)===0&&(ad=Pt()+500,Jm&&_l()))}function Oi(a,h){var _=a.callbackNode;Ei(a,h);var A=dn(a,a===wr?Dr:0);if(A===0)_!==null&&De(_),a.callbackNode=null,a.callbackPriority=0;else if(h=A&-A,a.callbackPriority!==h){if(_!=null&&De(_),h===1)a.tag===0?$R(kE.bind(null,a)):pw(kE.bind(null,a)),$r(function(){(Xt&6)===0&&_l()}),_=null;else{switch(Si(A)){case 1:_=Rn;break;case 4:_=tr;break;case 16:_=Kn;break;case 536870912:_=_n;break;default:_=Kn}_=FE(_,PE.bind(null,a))}a.callbackPriority=h,a.callbackNode=_}}function PE(a,h){if(Sp=-1,Tp=0,(Xt&6)!==0)throw Error(t(327));var _=a.callbackNode;if(ld()&&a.callbackNode!==_)return null;var A=dn(a,a===wr?Dr:0);if(A===0)return null;if((A&30)!==0||(A&a.expiredLanes)!==0||h)h=Ap(a,A);else{h=A;var B=Xt;Xt|=2;var H=RE();(wr!==a||Dr!==h)&&(ma=null,ad=Pt()+500,Dc(a,h));do try{h5();break}catch(de){CE(a,de)}while(!0);L0(),_p.current=H,Xt=B,or!==null?h=0:(wr=null,Dr=0,h=hr)}if(h!==0){if(h===2&&(B=Tn(a),B!==0&&(A=B,h=xv(a,B))),h===1)throw _=Vh,Dc(a,0),Al(a,A),Oi(a,Pt()),_;if(h===6)Al(a,A);else{if(B=a.current.alternate,(A&30)===0&&!u5(B)&&(h=Ap(a,A),h===2&&(H=Tn(a),H!==0&&(A=H,h=xv(a,H))),h===1))throw _=Vh,Dc(a,0),Al(a,A),Oi(a,Pt()),_;switch(a.finishedWork=B,a.finishedLanes=A,h){case 0:case 1:throw Error(t(345));case 2:Mc(a,ji,ma);break;case 3:if(Al(a,A),(A&130023424)===A&&(h=yv+500-Pt(),10<h)){if(dn(a,0)!==0)break;if(B=a.suspendedLanes,(B&A)!==A){ci(),a.pingedLanes|=a.suspendedLanes&B;break}a.timeoutHandle=ur(Mc.bind(null,a,ji,ma),h);break}Mc(a,ji,ma);break;case 4:if(Al(a,A),(A&4194240)===A)break;for(h=a.eventTimes,B=-1;0<A;){var te=31-At(A);H=1<<te,te=h[te],te>B&&(B=te),A&=~H}if(A=B,A=Pt()-A,A=(120>A?120:480>A?480:1080>A?1080:1920>A?1920:3e3>A?3e3:4320>A?4320:1960*c5(A/1960))-A,10<A){a.timeoutHandle=ur(Mc.bind(null,a,ji,ma),A);break}Mc(a,ji,ma);break;case 5:Mc(a,ji,ma);break;default:throw Error(t(329))}}}return Oi(a,Pt()),a.callbackNode===_?PE.bind(null,a):null}function xv(a,h){var _=Bh;return a.current.memoizedState.isDehydrated&&(Dc(a,h).flags|=256),a=Ap(a,h),a!==2&&(h=ji,ji=_,h!==null&&bv(h)),a}function bv(a){ji===null?ji=a:ji.push.apply(ji,a)}function u5(a){for(var h=a;;){if(h.flags&16384){var _=h.updateQueue;if(_!==null&&(_=_.stores,_!==null))for(var A=0;A<_.length;A++){var B=_[A],H=B.getSnapshot;B=B.value;try{if(!Qi(H(),B))return!1}catch{return!1}}}if(_=h.child,h.subtreeFlags&16384&&_!==null)_.return=h,h=_;else{if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function Al(a,h){for(h&=~gv,h&=~xp,a.suspendedLanes|=h,a.pingedLanes&=~h,a=a.expirationTimes;0<h;){var _=31-At(h),A=1<<_;a[_]=-1,h&=~A}}function kE(a){if((Xt&6)!==0)throw Error(t(327));ld();var h=dn(a,0);if((h&1)===0)return Oi(a,Pt()),null;var _=Ap(a,h);if(a.tag!==0&&_===2){var A=Tn(a);A!==0&&(h=A,_=xv(a,A))}if(_===1)throw _=Vh,Dc(a,0),Al(a,h),Oi(a,Pt()),_;if(_===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=h,Mc(a,ji,ma),Oi(a,Pt()),null}function wv(a,h){var _=Xt;Xt|=1;try{return a(h)}finally{Xt=_,Xt===0&&(ad=Pt()+500,Jm&&_l())}}function Oc(a){Sl!==null&&Sl.tag===0&&(Xt&6)===0&&ld();var h=Xt;Xt|=1;var _=Ss.transition,A=jt;try{if(Ss.transition=null,jt=1,a)return a()}finally{jt=A,Ss.transition=_,Xt=h,(Xt&6)===0&&_l()}}function Ev(){ts=od.current,kn(od)}function Dc(a,h){a.finishedWork=null,a.finishedLanes=0;var _=a.timeoutHandle;if(_!==-1&&(a.timeoutHandle=-1,sr(_)),or!==null)for(_=or.return;_!==null;){var A=_;switch(R0(A),A.tag){case 1:A=A.type.childContextTypes,A!=null&&Qm();break;case 3:rd(),kn(ki),kn(Wr),$0();break;case 5:q0(A);break;case 4:rd();break;case 13:kn(Bn);break;case 19:kn(Bn);break;case 10:F0(A.type._context);break;case 22:case 23:Ev()}_=_.return}if(wr=a,or=a=Nl(a.current,null),Dr=ts=h,hr=0,Vh=null,gv=xp=jc=0,ji=Bh=null,kc!==null){for(h=0;h<kc.length;h++)if(_=kc[h],A=_.interleaved,A!==null){_.interleaved=null;var B=A.next,H=_.pending;if(H!==null){var te=H.next;H.next=B,A.next=te}_.pending=A}kc=null}return a}function CE(a,h){do{var _=or;try{if(L0(),cp.current=fp,up){for(var A=zn.memoizedState;A!==null;){var B=A.queue;B!==null&&(B.pending=null),A=A.next}up=!1}if(Rc=0,br=dr=zn=null,jh=!1,Oh=0,pv.current=null,_===null||_.return===null){hr=1,Vh=h,or=null;break}e:{var H=a,te=_.return,de=_,me=h;if(h=Dr,de.flags|=32768,me!==null&&typeof me=="object"&&typeof me.then=="function"){var Se=me,Oe=de,Fe=Oe.tag;if((Oe.mode&1)===0&&(Fe===0||Fe===11||Fe===15)){var Re=Oe.alternate;Re?(Oe.updateQueue=Re.updateQueue,Oe.memoizedState=Re.memoizedState,Oe.lanes=Re.lanes):(Oe.updateQueue=null,Oe.memoizedState=null)}var Ye=nE(te);if(Ye!==null){Ye.flags&=-257,rE(Ye,te,de,H,h),Ye.mode&1&&tE(H,Se,h),h=Ye,me=Se;var tt=h.updateQueue;if(tt===null){var it=new Set;it.add(me),h.updateQueue=it}else tt.add(me);break e}else{if((h&1)===0){tE(H,Se,h),Sv();break e}me=Error(t(426))}}else if(jn&&de.mode&1){var Zn=nE(te);if(Zn!==null){(Zn.flags&65536)===0&&(Zn.flags|=256),rE(Zn,te,de,H,h),D0(id(me,de));break e}}H=me=id(me,de),hr!==4&&(hr=2),Bh===null?Bh=[H]:Bh.push(H),H=te;do{switch(H.tag){case 3:H.flags|=65536,h&=-h,H.lanes|=h;var be=Jw(H,me,h);Aw(H,be);break e;case 1:de=me;var ge=H.type,we=H.stateNode;if((H.flags&128)===0&&(typeof ge.getDerivedStateFromError=="function"||we!==null&&typeof we.componentDidCatch=="function"&&(El===null||!El.has(we)))){H.flags|=65536,h&=-h,H.lanes|=h;var Ue=eE(H,de,h);Aw(H,Ue);break e}}H=H.return}while(H!==null)}OE(_)}catch(st){h=st,or===_&&_!==null&&(or=_=_.return);continue}break}while(!0)}function RE(){var a=_p.current;return _p.current=fp,a===null?fp:a}function Sv(){(hr===0||hr===3||hr===2)&&(hr=4),wr===null||(jc&268435455)===0&&(xp&268435455)===0||Al(wr,Dr)}function Ap(a,h){var _=Xt;Xt|=2;var A=RE();(wr!==a||Dr!==h)&&(ma=null,Dc(a,h));do try{d5();break}catch(B){CE(a,B)}while(!0);if(L0(),Xt=_,_p.current=A,or!==null)throw Error(t(261));return wr=null,Dr=0,hr}function d5(){for(;or!==null;)jE(or)}function h5(){for(;or!==null&&!Qe();)jE(or)}function jE(a){var h=LE(a.alternate,a,ts);a.memoizedProps=a.pendingProps,h===null?OE(a):or=h,pv.current=null}function OE(a){var h=a;do{var _=h.alternate;if(a=h.return,(h.flags&32768)===0){if(_=i5(_,h,ts),_!==null){or=_;return}}else{if(_=s5(_,h),_!==null){_.flags&=32767,or=_;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{hr=6,or=null;return}}if(h=h.sibling,h!==null){or=h;return}or=h=a}while(h!==null);hr===0&&(hr=5)}function Mc(a,h,_){var A=jt,B=Ss.transition;try{Ss.transition=null,jt=1,f5(a,h,_,A)}finally{Ss.transition=B,jt=A}return null}function f5(a,h,_,A){do ld();while(Sl!==null);if((Xt&6)!==0)throw Error(t(327));_=a.finishedWork;var B=a.finishedLanes;if(_===null)return null;if(a.finishedWork=null,a.finishedLanes=0,_===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var H=_.lanes|_.childLanes;if(Nt(a,H),a===wr&&(or=wr=null,Dr=0),(_.subtreeFlags&2064)===0&&(_.flags&2064)===0||wp||(wp=!0,FE(Kn,function(){return ld(),null})),H=(_.flags&15990)!==0,(_.subtreeFlags&15990)!==0||H){H=Ss.transition,Ss.transition=null;var te=jt;jt=1;var de=Xt;Xt|=4,pv.current=null,a5(a,_),SE(_,a),ys(ht),Hs=!!We,ht=We=null,a.current=_,l5(_),Qt(),Xt=de,jt=te,Ss.transition=H}else a.current=_;if(wp&&(wp=!1,Sl=a,Ep=B),H=a.pendingLanes,H===0&&(El=null),mo(_.stateNode),Oi(a,Pt()),h!==null)for(A=a.onRecoverableError,_=0;_<h.length;_++)B=h[_],A(B.value,{componentStack:B.stack,digest:B.digest});if(bp)throw bp=!1,a=vv,vv=null,a;return(Ep&1)!==0&&a.tag!==0&&ld(),H=a.pendingLanes,(H&1)!==0?a===_v?zh++:(zh=0,_v=a):zh=0,_l(),null}function ld(){if(Sl!==null){var a=Si(Ep),h=Ss.transition,_=jt;try{if(Ss.transition=null,jt=16>a?16:a,Sl===null)var A=!1;else{if(a=Sl,Sl=null,Ep=0,(Xt&6)!==0)throw Error(t(331));var B=Xt;for(Xt|=4,Xe=a.current;Xe!==null;){var H=Xe,te=H.child;if((Xe.flags&16)!==0){var de=H.deletions;if(de!==null){for(var me=0;me<de.length;me++){var Se=de[me];for(Xe=Se;Xe!==null;){var Oe=Xe;switch(Oe.tag){case 0:case 11:case 15:Fh(8,Oe,H)}var Fe=Oe.child;if(Fe!==null)Fe.return=Oe,Xe=Fe;else for(;Xe!==null;){Oe=Xe;var Re=Oe.sibling,Ye=Oe.return;if(_E(Oe),Oe===Se){Xe=null;break}if(Re!==null){Re.return=Ye,Xe=Re;break}Xe=Ye}}}var tt=H.alternate;if(tt!==null){var it=tt.child;if(it!==null){tt.child=null;do{var Zn=it.sibling;it.sibling=null,it=Zn}while(it!==null)}}Xe=H}}if((H.subtreeFlags&2064)!==0&&te!==null)te.return=H,Xe=te;else e:for(;Xe!==null;){if(H=Xe,(H.flags&2048)!==0)switch(H.tag){case 0:case 11:case 15:Fh(9,H,H.return)}var be=H.sibling;if(be!==null){be.return=H.return,Xe=be;break e}Xe=H.return}}var ge=a.current;for(Xe=ge;Xe!==null;){te=Xe;var we=te.child;if((te.subtreeFlags&2064)!==0&&we!==null)we.return=te,Xe=we;else e:for(te=ge;Xe!==null;){if(de=Xe,(de.flags&2048)!==0)try{switch(de.tag){case 0:case 11:case 15:vp(9,de)}}catch(st){$n(de,de.return,st)}if(de===te){Xe=null;break e}var Ue=de.sibling;if(Ue!==null){Ue.return=de.return,Xe=Ue;break e}Xe=de.return}}if(Xt=B,_l(),lr&&typeof lr.onPostCommitFiberRoot=="function")try{lr.onPostCommitFiberRoot(Wi,a)}catch{}A=!0}return A}finally{jt=_,Ss.transition=h}}return!1}function DE(a,h,_){h=id(_,h),h=Jw(a,h,1),a=bl(a,h,1),h=ci(),a!==null&&(zr(a,1,h),Oi(a,h))}function $n(a,h,_){if(a.tag===3)DE(a,a,_);else for(;h!==null;){if(h.tag===3){DE(h,a,_);break}else if(h.tag===1){var A=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof A.componentDidCatch=="function"&&(El===null||!El.has(A))){a=id(_,a),a=eE(h,a,1),h=bl(h,a,1),a=ci(),h!==null&&(zr(h,1,a),Oi(h,a));break}}h=h.return}}function m5(a,h,_){var A=a.pingCache;A!==null&&A.delete(h),h=ci(),a.pingedLanes|=a.suspendedLanes&_,wr===a&&(Dr&_)===_&&(hr===4||hr===3&&(Dr&130023424)===Dr&&500>Pt()-yv?Dc(a,0):gv|=_),Oi(a,h)}function ME(a,h){h===0&&((a.mode&1)===0?h=1:(h=po,po<<=1,(po&130023424)===0&&(po=4194304)));var _=ci();a=da(a,h),a!==null&&(zr(a,h,_),Oi(a,_))}function p5(a){var h=a.memoizedState,_=0;h!==null&&(_=h.retryLane),ME(a,_)}function g5(a,h){var _=0;switch(a.tag){case 13:var A=a.stateNode,B=a.memoizedState;B!==null&&(_=B.retryLane);break;case 19:A=a.stateNode;break;default:throw Error(t(314))}A!==null&&A.delete(h),ME(a,_)}var LE;LE=function(a,h,_){if(a!==null)if(a.memoizedProps!==h.pendingProps||ki.current)Ri=!0;else{if((a.lanes&_)===0&&(h.flags&128)===0)return Ri=!1,r5(a,h,_);Ri=(a.flags&131072)!==0}else Ri=!1,jn&&(h.flags&1048576)!==0&&gw(h,tp,h.index);switch(h.lanes=0,h.tag){case 2:var A=h.type;gp(a,h),a=h.pendingProps;var B=Zu(h,Wr.current);nd(h,_),B=K0(null,h,A,a,B,_);var H=Y0();return h.flags|=1,typeof B=="object"&&B!==null&&typeof B.render=="function"&&B.$$typeof===void 0?(h.tag=1,h.memoizedState=null,h.updateQueue=null,Ci(A)?(H=!0,Xm(h)):H=!1,h.memoizedState=B.state!==null&&B.state!==void 0?B.state:null,z0(h),B.updater=mp,h.stateNode=B,B._reactInternals=h,tv(h,A,a,_),h=sv(null,h,A,!0,H,_)):(h.tag=0,jn&&H&&C0(h),li(null,h,B,_),h=h.child),h;case 16:A=h.elementType;e:{switch(gp(a,h),a=h.pendingProps,B=A._init,A=B(A._payload),h.type=A,B=h.tag=v5(A),a=Qs(A,a),B){case 0:h=iv(null,h,A,a,_);break e;case 1:h=cE(null,h,A,a,_);break e;case 11:h=iE(null,h,A,a,_);break e;case 14:h=sE(null,h,A,Qs(A.type,a),_);break e}throw Error(t(306,A,""))}return h;case 0:return A=h.type,B=h.pendingProps,B=h.elementType===A?B:Qs(A,B),iv(a,h,A,B,_);case 1:return A=h.type,B=h.pendingProps,B=h.elementType===A?B:Qs(A,B),cE(a,h,A,B,_);case 3:e:{if(uE(h),a===null)throw Error(t(387));A=h.pendingProps,H=h.memoizedState,B=H.element,Tw(a,h),ap(h,A,null,_);var te=h.memoizedState;if(A=te.element,H.isDehydrated)if(H={element:A,isDehydrated:!1,cache:te.cache,pendingSuspenseBoundaries:te.pendingSuspenseBoundaries,transitions:te.transitions},h.updateQueue.baseState=H,h.memoizedState=H,h.flags&256){B=id(Error(t(423)),h),h=dE(a,h,A,_,B);break e}else if(A!==B){B=id(Error(t(424)),h),h=dE(a,h,A,_,B);break e}else for(es=wo(h.stateNode.containerInfo.firstChild),Ji=h,jn=!0,Zs=null,_=Ew(h,null,A,_),h.child=_;_;)_.flags=_.flags&-3|4096,_=_.sibling;else{if(Ju(),A===B){h=fa(a,h,_);break e}li(a,h,A,_)}h=h.child}return h;case 5:return Iw(h),a===null&&O0(h),A=h.type,B=h.pendingProps,H=a!==null?a.memoizedProps:null,te=B.children,Rt(A,B)?te=null:H!==null&&Rt(A,H)&&(h.flags|=32),lE(a,h),li(a,h,te,_),h.child;case 6:return a===null&&O0(h),null;case 13:return hE(a,h,_);case 4:return U0(h,h.stateNode.containerInfo),A=h.pendingProps,a===null?h.child=ed(h,null,A,_):li(a,h,A,_),h.child;case 11:return A=h.type,B=h.pendingProps,B=h.elementType===A?B:Qs(A,B),iE(a,h,A,B,_);case 7:return li(a,h,h.pendingProps,_),h.child;case 8:return li(a,h,h.pendingProps.children,_),h.child;case 12:return li(a,h,h.pendingProps.children,_),h.child;case 10:e:{if(A=h.type._context,B=h.pendingProps,H=h.memoizedProps,te=B.value,Nn(ip,A._currentValue),A._currentValue=te,H!==null)if(Qi(H.value,te)){if(H.children===B.children&&!ki.current){h=fa(a,h,_);break e}}else for(H=h.child,H!==null&&(H.return=h);H!==null;){var de=H.dependencies;if(de!==null){te=H.child;for(var me=de.firstContext;me!==null;){if(me.context===A){if(H.tag===1){me=ha(-1,_&-_),me.tag=2;var Se=H.updateQueue;if(Se!==null){Se=Se.shared;var Oe=Se.pending;Oe===null?me.next=me:(me.next=Oe.next,Oe.next=me),Se.pending=me}}H.lanes|=_,me=H.alternate,me!==null&&(me.lanes|=_),V0(H.return,_,h),de.lanes|=_;break}me=me.next}}else if(H.tag===10)te=H.type===h.type?null:H.child;else if(H.tag===18){if(te=H.return,te===null)throw Error(t(341));te.lanes|=_,de=te.alternate,de!==null&&(de.lanes|=_),V0(te,_,h),te=H.sibling}else te=H.child;if(te!==null)te.return=H;else for(te=H;te!==null;){if(te===h){te=null;break}if(H=te.sibling,H!==null){H.return=te.return,te=H;break}te=te.return}H=te}li(a,h,B.children,_),h=h.child}return h;case 9:return B=h.type,A=h.pendingProps.children,nd(h,_),B=ws(B),A=A(B),h.flags|=1,li(a,h,A,_),h.child;case 14:return A=h.type,B=Qs(A,h.pendingProps),B=Qs(A.type,B),sE(a,h,A,B,_);case 15:return oE(a,h,h.type,h.pendingProps,_);case 17:return A=h.type,B=h.pendingProps,B=h.elementType===A?B:Qs(A,B),gp(a,h),h.tag=1,Ci(A)?(a=!0,Xm(h)):a=!1,nd(h,_),Qw(h,A,B),tv(h,A,B,_),sv(null,h,A,!0,a,_);case 19:return mE(a,h,_);case 22:return aE(a,h,_)}throw Error(t(156,h.tag))};function FE(a,h){return pe(a,h)}function y5(a,h,_,A){this.tag=a,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=A,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ts(a,h,_,A){return new y5(a,h,_,A)}function Tv(a){return a=a.prototype,!(!a||!a.isReactComponent)}function v5(a){if(typeof a=="function")return Tv(a)?1:0;if(a!=null){if(a=a.$$typeof,a===M)return 11;if(a===K)return 14}return 2}function Nl(a,h){var _=a.alternate;return _===null?(_=Ts(a.tag,h,a.key,a.mode),_.elementType=a.elementType,_.type=a.type,_.stateNode=a.stateNode,_.alternate=a,a.alternate=_):(_.pendingProps=h,_.type=a.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=a.flags&14680064,_.childLanes=a.childLanes,_.lanes=a.lanes,_.child=a.child,_.memoizedProps=a.memoizedProps,_.memoizedState=a.memoizedState,_.updateQueue=a.updateQueue,h=a.dependencies,_.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},_.sibling=a.sibling,_.index=a.index,_.ref=a.ref,_}function Np(a,h,_,A,B,H){var te=2;if(A=a,typeof a=="function")Tv(a)&&(te=1);else if(typeof a=="string")te=5;else e:switch(a){case P:return Lc(_.children,B,H,h);case k:te=8,B|=8;break;case F:return a=Ts(12,_,h,B|2),a.elementType=F,a.lanes=H,a;case D:return a=Ts(13,_,h,B),a.elementType=D,a.lanes=H,a;case $:return a=Ts(19,_,h,B),a.elementType=$,a.lanes=H,a;case se:return Ip(_,B,H,h);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case O:te=10;break e;case C:te=9;break e;case M:te=11;break e;case K:te=14;break e;case ee:te=16,A=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return h=Ts(te,_,h,B),h.elementType=a,h.type=A,h.lanes=H,h}function Lc(a,h,_,A){return a=Ts(7,a,A,h),a.lanes=_,a}function Ip(a,h,_,A){return a=Ts(22,a,A,h),a.elementType=se,a.lanes=_,a.stateNode={isHidden:!1},a}function Av(a,h,_){return a=Ts(6,a,null,h),a.lanes=_,a}function Nv(a,h,_){return h=Ts(4,a.children!==null?a.children:[],a.key,h),h.lanes=_,h.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},h}function _5(a,h,_,A,B){this.tag=h,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ki(0),this.expirationTimes=Ki(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ki(0),this.identifierPrefix=A,this.onRecoverableError=B,this.mutableSourceEagerHydrationData=null}function Iv(a,h,_,A,B,H,te,de,me){return a=new _5(a,h,_,de,me),h===1?(h=1,H===!0&&(h|=8)):h=0,H=Ts(3,null,null,h),a.current=H,H.stateNode=a,H.memoizedState={element:A,isDehydrated:_,cache:null,transitions:null,pendingSuspenseBoundaries:null},z0(H),a}function x5(a,h,_){var A=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U,key:A==null?null:""+A,children:a,containerInfo:h,implementation:_}}function VE(a){if(!a)return vl;a=a._reactInternals;e:{if(Pr(a)!==a||a.tag!==1)throw Error(t(170));var h=a;do{switch(h.tag){case 3:h=h.stateNode.context;break e;case 1:if(Ci(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break e}}h=h.return}while(h!==null);throw Error(t(171))}if(a.tag===1){var _=a.type;if(Ci(_))return fw(a,_,h)}return h}function BE(a,h,_,A,B,H,te,de,me){return a=Iv(_,A,!0,a,B,H,te,de,me),a.context=VE(null),_=a.current,A=ci(),B=Tl(_),H=ha(A,B),H.callback=h??null,bl(_,H,B),a.current.lanes=B,zr(a,B,A),Oi(a,A),a}function Pp(a,h,_,A){var B=h.current,H=ci(),te=Tl(B);return _=VE(_),h.context===null?h.context=_:h.pendingContext=_,h=ha(H,te),h.payload={element:a},A=A===void 0?null:A,A!==null&&(h.callback=A),a=bl(B,h,te),a!==null&&(eo(a,B,te,H),op(a,B,te)),te}function kp(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function zE(a,h){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var _=a.retryLane;a.retryLane=_!==0&&_<h?_:h}}function Pv(a,h){zE(a,h),(a=a.alternate)&&zE(a,h)}function b5(){return null}var UE=typeof reportError=="function"?reportError:function(a){console.error(a)};function kv(a){this._internalRoot=a}Cp.prototype.render=kv.prototype.render=function(a){var h=this._internalRoot;if(h===null)throw Error(t(409));Pp(a,h,null,null)},Cp.prototype.unmount=kv.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var h=a.containerInfo;Oc(function(){Pp(null,a,null,null)}),h[on]=null}};function Cp(a){this._internalRoot=a}Cp.prototype.unstable_scheduleHydration=function(a){if(a){var h=Ya();a={blockedOn:null,target:a,priority:h};for(var _=0;_<Yn.length&&h!==0&&h<Yn[_].priority;_++);Yn.splice(_,0,a),_===0&&Za(a)}};function Cv(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Rp(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function qE(){}function w5(a,h,_,A,B){if(B){if(typeof A=="function"){var H=A;A=function(){var Se=kp(te);H.call(Se)}}var te=BE(h,A,a,0,null,!1,!1,"",qE);return a._reactRootContainer=te,a[on]=te.current,fl(a.nodeType===8?a.parentNode:a),Oc(),te}for(;B=a.lastChild;)a.removeChild(B);if(typeof A=="function"){var de=A;A=function(){var Se=kp(me);de.call(Se)}}var me=Iv(a,0,!1,null,null,!1,!1,"",qE);return a._reactRootContainer=me,a[on]=me.current,fl(a.nodeType===8?a.parentNode:a),Oc(function(){Pp(h,me,_,A)}),me}function jp(a,h,_,A,B){var H=_._reactRootContainer;if(H){var te=H;if(typeof B=="function"){var de=B;B=function(){var me=kp(te);de.call(me)}}Pp(h,te,a,B)}else te=w5(_,h,a,B,A);return kp(te)}Ga=function(a){switch(a.tag){case 3:var h=a.stateNode;if(h.current.memoizedState.isDehydrated){var _=wt(h.pendingLanes);_!==0&&(Ur(h,_|1),Oi(h,Pt()),(Xt&6)===0&&(ad=Pt()+500,_l()))}break;case 13:Oc(function(){var A=da(a,1);if(A!==null){var B=ci();eo(A,a,1,B)}}),Pv(a,1)}},fs=function(a){if(a.tag===13){var h=da(a,134217728);if(h!==null){var _=ci();eo(h,a,134217728,_)}Pv(a,134217728)}},Ka=function(a){if(a.tag===13){var h=Tl(a),_=da(a,h);if(_!==null){var A=ci();eo(_,a,h,A)}Pv(a,h)}},Ya=function(){return jt},Ko=function(a,h){var _=jt;try{return jt=a,h()}finally{jt=_}},_i=function(a,h,_){switch(h){case"input":if(bt(a,_),h=_.name,_.type==="radio"&&h!=null){for(_=a;_.parentNode;)_=_.parentNode;for(_=_.querySelectorAll("input[name="+JSON.stringify(""+h)+'][type="radio"]'),h=0;h<_.length;h++){var A=_[h];if(A!==a&&A.form===a.form){var B=Ku(A);if(!B)throw Error(t(90));Pe(A),bt(A,B)}}}break;case"textarea":gt(a,_);break;case"select":h=_.value,h!=null&&Be(a,!!_.multiple,h,!1)}},vn=wv,wi=Oc;var E5={usingClientEntryPoint:!1,Events:[oa,aa,Ku,bi,qo,wv]},Uh={findFiberByHostInstance:sa,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},S5={bundleType:Uh.bundleType,version:Uh.version,rendererPackageName:Uh.rendererPackageName,rendererConfig:Uh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:I.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=$o(a),a===null?null:a.stateNode},findFiberByHostInstance:Uh.findFiberByHostInstance||b5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Op=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Op.isDisabled&&Op.supportsFiber)try{Wi=Op.inject(S5),lr=Op}catch{}}return Di.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=E5,Di.createPortal=function(a,h){var _=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Cv(h))throw Error(t(200));return x5(a,h,null,_)},Di.createRoot=function(a,h){if(!Cv(a))throw Error(t(299));var _=!1,A="",B=UE;return h!=null&&(h.unstable_strictMode===!0&&(_=!0),h.identifierPrefix!==void 0&&(A=h.identifierPrefix),h.onRecoverableError!==void 0&&(B=h.onRecoverableError)),h=Iv(a,1,!1,null,null,_,!1,A,B),a[on]=h.current,fl(a.nodeType===8?a.parentNode:a),new kv(h)},Di.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var h=a._reactInternals;if(h===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=$o(h),a=a===null?null:a.stateNode,a},Di.flushSync=function(a){return Oc(a)},Di.hydrate=function(a,h,_){if(!Rp(h))throw Error(t(200));return jp(null,a,h,!0,_)},Di.hydrateRoot=function(a,h,_){if(!Cv(a))throw Error(t(405));var A=_!=null&&_.hydratedSources||null,B=!1,H="",te=UE;if(_!=null&&(_.unstable_strictMode===!0&&(B=!0),_.identifierPrefix!==void 0&&(H=_.identifierPrefix),_.onRecoverableError!==void 0&&(te=_.onRecoverableError)),h=BE(h,null,a,1,_??null,B,!1,H,te),a[on]=h.current,fl(a),A)for(a=0;a<A.length;a++)_=A[a],B=_._getVersion,B=B(_._source),h.mutableSourceEagerHydrationData==null?h.mutableSourceEagerHydrationData=[_,B]:h.mutableSourceEagerHydrationData.push(_,B);return new Cp(h)},Di.render=function(a,h,_){if(!Rp(h))throw Error(t(200));return jp(null,a,h,!1,_)},Di.unmountComponentAtNode=function(a){if(!Rp(a))throw Error(t(40));return a._reactRootContainer?(Oc(function(){jp(null,null,a,!1,function(){a._reactRootContainer=null,a[on]=null})}),!0):!1},Di.unstable_batchedUpdates=wv,Di.unstable_renderSubtreeIntoContainer=function(a,h,_,A){if(!Rp(_))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return jp(a,h,_,!1,A)},Di.version="18.3.1-next-f1338f8080-20240426",Di}var QE;function rb(){if(QE)return Ov.exports;QE=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),Ov.exports=j5(),Ov.exports}var XE;function O5(){if(XE)return Mp;XE=1;var r=rb();return Mp.createRoot=r.createRoot,Mp.hydrateRoot=r.hydrateRoot,Mp}var D5=O5();const M5=nb(D5),L5=()=>{};var JE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const N4=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},F5=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=r[t++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=r[t++],o=r[t++],l=r[t++],d=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(d>>10)),e[n++]=String.fromCharCode(56320+(d&1023))}else{const s=r[t++],o=r[t++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},I4={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const s=r[i],o=i+1<r.length,l=o?r[i+1]:0,d=i+2<r.length,f=d?r[i+2]:0,m=s>>2,p=(s&3)<<4|l>>4;let g=(l&15)<<2|f>>6,v=f&63;d||(v=64,o||(g=64)),n.push(t[m],t[p],t[g],t[v])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(N4(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):F5(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const s=t[r.charAt(i++)],l=i<r.length?t[r.charAt(i)]:0;++i;const f=i<r.length?t[r.charAt(i)]:64;++i;const p=i<r.length?t[r.charAt(i)]:64;if(++i,s==null||l==null||f==null||p==null)throw new V5;const g=s<<2|l>>4;if(n.push(g),f!==64){const v=l<<4&240|f>>2;if(n.push(v),p!==64){const E=f<<6&192|p;n.push(E)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class V5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const B5=function(r){const e=N4(r);return I4.encodeByteArray(e,!0)},Dg=function(r){return B5(r).replace(/\./g,"")},P4=function(r){try{return I4.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k4(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z5=()=>k4().__FIREBASE_DEFAULTS__,U5=()=>{if(typeof process>"u"||typeof JE>"u")return;const r=JE.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},q5=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&P4(r[1]);return e&&JSON.parse(e)},Ey=()=>{try{return L5()||z5()||U5()||q5()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},C4=r=>{var e,t;return(t=(e=Ey())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[r]},R4=r=>{const e=C4(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},j4=()=>{var r;return(r=Ey())===null||r===void 0?void 0:r.config},O4=r=>{var e;return(e=Ey())===null||e===void 0?void 0:e[`_${r}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Su(r){return r.endsWith(".cloudworkstations.dev")}async function ib(r){return(await fetch(r,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $5(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",i=r.iat||0,s=r.sub||r.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},r);return[Dg(JSON.stringify(t)),Dg(JSON.stringify(o)),""].join(".")}const Nf={};function W5(){const r={prod:[],emulator:[]};for(const e of Object.keys(Nf))Nf[e]?r.emulator.push(e):r.prod.push(e);return r}function G5(r){let e=document.getElementById(r),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",r),t=!0),{created:t,element:e}}let eS=!1;function sb(r,e){if(typeof window>"u"||typeof document>"u"||!Su(window.location.host)||Nf[r]===e||Nf[r]||eS)return;Nf[r]=e;function t(g){return`__firebase__banner__${g}`}const n="__firebase__banner",s=W5().prod.length>0;function o(){const g=document.getElementById(n);g&&g.remove()}function l(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function d(g,v){g.setAttribute("width","24"),g.setAttribute("id",v),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function f(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{eS=!0,o()},g}function m(g,v){g.setAttribute("id",v),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function p(){const g=G5(n),v=t("text"),E=document.getElementById(v)||document.createElement("span"),x=t("learnmore"),b=document.getElementById(x)||document.createElement("a"),S=t("preprendIcon"),N=document.getElementById(S)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const R=g.element;l(R),m(b,x);const I=f();d(N,S),R.append(N,E,b,I),document.body.appendChild(R)}s?(E.innerText="Preview backend disconnected.",N.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(N.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",v)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",p):p()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function K5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pr())}function D4(){var r;const e=(r=Ey())===null||r===void 0?void 0:r.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function Y5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function Z5(){const r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function Q5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function X5(){const r=pr();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}function M4(){return!D4()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function L4(){return!D4()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function F4(){try{return typeof indexedDB=="object"}catch{return!1}}function J5(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ej="FirebaseError";class Ma extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=ej,Object.setPrototypeOf(this,Ma.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,xm.prototype.create)}}class xm{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?tj(s,n):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new Ma(i,l,n)}}function tj(r,e){return r.replace(nj,(t,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const nj=/\{\$([^}]+)}/g;function rj(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}function Xl(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const s=r[i],o=e[i];if(tS(s)&&tS(o)){if(!Xl(s,o))return!1}else if(s!==o)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function tS(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bm(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function mf(r){const e={};return r.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,s]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function pf(r){const e=r.indexOf("?");if(!e)return"";const t=r.indexOf("#",e);return r.substring(e,t>0?t:void 0)}function ij(r,e){const t=new sj(r,e);return t.subscribe.bind(t)}class sj{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");oj(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:n},i.next===void 0&&(i.next=Lv),i.error===void 0&&(i.error=Lv),i.complete===void 0&&(i.complete=Lv);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function oj(r,e){if(typeof r!="object"||r===null)return!1;for(const t of e)if(t in r&&typeof r[t]=="function")return!0;return!1}function Lv(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function In(r){return r&&r._delegate?r._delegate:r}class Jl{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uc="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aj{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new H5;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(cj(e))try{this.getOrInitializeService({instanceIdentifier:Uc})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Uc){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Uc){return this.instances.has(e)}getOptions(e=Uc){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);n===l&&o.resolve(i)}return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:lj(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Uc){return this.component?this.component.multipleInstances?e:Uc:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function lj(r){return r===Uc?void 0:r}function cj(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uj{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new aj(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $t;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})($t||($t={}));const dj={debug:$t.DEBUG,verbose:$t.VERBOSE,info:$t.INFO,warn:$t.WARN,error:$t.ERROR,silent:$t.SILENT},hj=$t.INFO,fj={[$t.DEBUG]:"log",[$t.VERBOSE]:"log",[$t.INFO]:"info",[$t.WARN]:"warn",[$t.ERROR]:"error"},mj=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),i=fj[e];if(i)console[i](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ob{constructor(e){this.name=e,this._logLevel=hj,this._logHandler=mj,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in $t))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?dj[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,$t.DEBUG,...e),this._logHandler(this,$t.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,$t.VERBOSE,...e),this._logHandler(this,$t.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,$t.INFO,...e),this._logHandler(this,$t.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,$t.WARN,...e),this._logHandler(this,$t.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,$t.ERROR,...e),this._logHandler(this,$t.ERROR,...e)}}const pj=(r,e)=>e.some(t=>r instanceof t);let nS,rS;function gj(){return nS||(nS=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function yj(){return rS||(rS=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const V4=new WeakMap,ex=new WeakMap,B4=new WeakMap,Fv=new WeakMap,ab=new WeakMap;function vj(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",o)},s=()=>{t(Wl(r.result)),i()},o=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&V4.set(t,r)}).catch(()=>{}),ab.set(e,r),e}function _j(r){if(ex.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",o),r.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",o),r.addEventListener("abort",o)});ex.set(r,e)}let tx={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return ex.get(r);if(e==="objectStoreNames")return r.objectStoreNames||B4.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Wl(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function xj(r){tx=r(tx)}function bj(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(Vv(this),e,...t);return B4.set(n,e.sort?e.sort():[e]),Wl(n)}:yj().includes(r)?function(...e){return r.apply(Vv(this),e),Wl(V4.get(this))}:function(...e){return Wl(r.apply(Vv(this),e))}}function wj(r){return typeof r=="function"?bj(r):(r instanceof IDBTransaction&&_j(r),pj(r,gj())?new Proxy(r,tx):r)}function Wl(r){if(r instanceof IDBRequest)return vj(r);if(Fv.has(r))return Fv.get(r);const e=wj(r);return e!==r&&(Fv.set(r,e),ab.set(e,r)),e}const Vv=r=>ab.get(r);function Ej(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const o=indexedDB.open(r,e),l=Wl(o);return n&&o.addEventListener("upgradeneeded",d=>{n(Wl(o.result),d.oldVersion,d.newVersion,Wl(o.transaction),d)}),t&&o.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),l.then(d=>{s&&d.addEventListener("close",()=>s()),i&&d.addEventListener("versionchange",f=>i(f.oldVersion,f.newVersion,f))}).catch(()=>{}),l}const Sj=["get","getKey","getAll","getAllKeys","count"],Tj=["put","add","delete","clear"],Bv=new Map;function iS(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(Bv.get(e))return Bv.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=Tj.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||Sj.includes(t)))return;const s=async function(o,...l){const d=this.transaction(o,i?"readwrite":"readonly");let f=d.store;return n&&(f=f.index(l.shift())),(await Promise.all([f[t](...l),i&&d.done]))[0]};return Bv.set(e,s),s}xj(r=>({...r,get:(e,t,n)=>iS(e,t)||r.get(e,t,n),has:(e,t)=>!!iS(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(Nj(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function Nj(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const nx="@firebase/app",sS="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pa=new ob("@firebase/app"),Ij="@firebase/app-compat",Pj="@firebase/analytics-compat",kj="@firebase/analytics",Cj="@firebase/app-check-compat",Rj="@firebase/app-check",jj="@firebase/auth",Oj="@firebase/auth-compat",Dj="@firebase/database",Mj="@firebase/data-connect",Lj="@firebase/database-compat",Fj="@firebase/functions",Vj="@firebase/functions-compat",Bj="@firebase/installations",zj="@firebase/installations-compat",Uj="@firebase/messaging",qj="@firebase/messaging-compat",Hj="@firebase/performance",$j="@firebase/performance-compat",Wj="@firebase/remote-config",Gj="@firebase/remote-config-compat",Kj="@firebase/storage",Yj="@firebase/storage-compat",Zj="@firebase/firestore",Qj="@firebase/ai",Xj="@firebase/firestore-compat",Jj="firebase",e7="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rx="[DEFAULT]",t7={[nx]:"fire-core",[Ij]:"fire-core-compat",[kj]:"fire-analytics",[Pj]:"fire-analytics-compat",[Rj]:"fire-app-check",[Cj]:"fire-app-check-compat",[jj]:"fire-auth",[Oj]:"fire-auth-compat",[Dj]:"fire-rtdb",[Mj]:"fire-data-connect",[Lj]:"fire-rtdb-compat",[Fj]:"fire-fn",[Vj]:"fire-fn-compat",[Bj]:"fire-iid",[zj]:"fire-iid-compat",[Uj]:"fire-fcm",[qj]:"fire-fcm-compat",[Hj]:"fire-perf",[$j]:"fire-perf-compat",[Wj]:"fire-rc",[Gj]:"fire-rc-compat",[Kj]:"fire-gcs",[Yj]:"fire-gcs-compat",[Zj]:"fire-fst",[Xj]:"fire-fst-compat",[Qj]:"fire-vertex","fire-js":"fire-js",[Jj]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qf=new Map,n7=new Map,ix=new Map;function oS(r,e){try{r.container.addComponent(e)}catch(t){Pa.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function iu(r){const e=r.name;if(ix.has(e))return Pa.debug(`There were multiple attempts to register component ${e}.`),!1;ix.set(e,r);for(const t of qf.values())oS(t,r);for(const t of n7.values())oS(t,r);return!0}function Sy(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function di(r){return r==null?!1:r.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const r7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Gl=new xm("app","Firebase",r7);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i7{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Jl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Gl.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const th=e7;function z4(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n=Object.assign({name:rx,automaticDataCollectionEnabled:!0},e),i=n.name;if(typeof i!="string"||!i)throw Gl.create("bad-app-name",{appName:String(i)});if(t||(t=j4()),!t)throw Gl.create("no-options");const s=qf.get(i);if(s){if(Xl(t,s.options)&&Xl(n,s.config))return s;throw Gl.create("duplicate-app",{appName:i})}const o=new uj(i);for(const d of ix.values())o.addComponent(d);const l=new i7(t,n,o);return qf.set(i,l),l}function Ty(r=rx){const e=qf.get(r);if(!e&&r===rx&&j4())return z4();if(!e)throw Gl.create("no-app",{appName:r});return e}function s7(){return Array.from(qf.values())}function jo(r,e,t){var n;let i=(n=t7[r])!==null&&n!==void 0?n:r;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Pa.warn(l.join(" "));return}iu(new Jl(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o7="firebase-heartbeat-database",a7=1,Hf="firebase-heartbeat-store";let zv=null;function U4(){return zv||(zv=Ej(o7,a7,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(Hf)}catch(t){console.warn(t)}}}}).catch(r=>{throw Gl.create("idb-open",{originalErrorMessage:r.message})})),zv}async function l7(r){try{const t=(await U4()).transaction(Hf),n=await t.objectStore(Hf).get(q4(r));return await t.done,n}catch(e){if(e instanceof Ma)Pa.warn(e.message);else{const t=Gl.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Pa.warn(t.message)}}}async function aS(r,e){try{const n=(await U4()).transaction(Hf,"readwrite");await n.objectStore(Hf).put(e,q4(r)),await n.done}catch(t){if(t instanceof Ma)Pa.warn(t.message);else{const n=Gl.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Pa.warn(n.message)}}}function q4(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const c7=1024,u7=30;class d7{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new f7(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=lS();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>u7){const o=m7(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Pa.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=lS(),{heartbeatsToSend:n,unsentEntries:i}=h7(this._heartbeatsCache.heartbeats),s=Dg(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Pa.warn(t),""}}}function lS(){return new Date().toISOString().substring(0,10)}function h7(r,e=c7){const t=[];let n=r.slice();for(const i of r){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),cS(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),cS(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class f7{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return F4()?J5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await l7(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return aS(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return aS(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function cS(r){return Dg(JSON.stringify({version:2,heartbeats:r})).length}function m7(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let n=1;n<r.length;n++)r[n].date<t&&(t=r[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function p7(r){iu(new Jl("platform-logger",e=>new Aj(e),"PRIVATE")),iu(new Jl("heartbeat",e=>new d7(e),"PRIVATE")),jo(nx,sS,r),jo(nx,sS,"esm2017"),jo("fire-js","")}p7("");function lb(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t}function H4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const g7=H4,$4=new xm("auth","Firebase",H4());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mg=new ob("@firebase/auth");function y7(r,...e){Mg.logLevel<=$t.WARN&&Mg.warn(`Auth (${th}): ${r}`,...e)}function hg(r,...e){Mg.logLevel<=$t.ERROR&&Mg.error(`Auth (${th}): ${r}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ks(r,...e){throw ub(r,...e)}function lo(r,...e){return ub(r,...e)}function cb(r,e,t){const n=Object.assign(Object.assign({},g7()),{[e]:t});return new xm("auth","Firebase",n).create(e,{appName:r.name})}function Oo(r){return cb(r,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function v7(r,e,t){const n=t;if(!(e instanceof n))throw n.name!==e.constructor.name&&ks(r,"argument-error"),cb(r,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function ub(r,...e){if(typeof r!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return $4.create(r,...e)}function ut(r,e,...t){if(!r)throw ub(e,...t)}function wa(r){const e="INTERNAL ASSERTION FAILED: "+r;throw hg(e),new Error(e)}function ka(r,e){r||wa(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lg(){var r;return typeof self<"u"&&((r=self.location)===null||r===void 0?void 0:r.href)||""}function _7(){return uS()==="http:"||uS()==="https:"}function uS(){var r;return typeof self<"u"&&((r=self.location)===null||r===void 0?void 0:r.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x7(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(_7()||Z5()||"connection"in navigator)?navigator.onLine:!0}function b7(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wm{constructor(e,t){this.shortDelay=e,this.longDelay=t,ka(t>e,"Short delay should be less than long delay!"),this.isMobile=K5()||Q5()}get(){return x7()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function db(r,e){ka(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W4{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;wa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;wa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;wa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w7={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E7=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],S7=new wm(3e4,6e4);function La(r,e){return r.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:r.tenantId}):e}async function Fa(r,e,t,n,i={}){return G4(r,i,async()=>{let s={},o={};n&&(e==="GET"?o=n:s={body:JSON.stringify(n)});const l=bm(Object.assign({key:r.config.apiKey},o)).slice(1),d=await r._getAdditionalHeaders();d["Content-Type"]="application/json",r.languageCode&&(d["X-Firebase-Locale"]=r.languageCode);const f=Object.assign({method:e,headers:d},s);return Y5()||(f.referrerPolicy="no-referrer"),r.emulatorConfig&&Su(r.emulatorConfig.host)&&(f.credentials="include"),W4.fetch()(await K4(r,r.config.apiHost,t,l),f)})}async function G4(r,e,t){r._canInitEmulator=!1;const n=Object.assign(Object.assign({},w7),e);try{const i=new A7(r),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw Lp(r,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[d,f]=l.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw Lp(r,"credential-already-in-use",o);if(d==="EMAIL_EXISTS")throw Lp(r,"email-already-in-use",o);if(d==="USER_DISABLED")throw Lp(r,"user-disabled",o);const m=n[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw cb(r,m,f);ks(r,m)}}catch(i){if(i instanceof Ma)throw i;ks(r,"network-request-failed",{message:String(i)})}}async function Em(r,e,t,n,i={}){const s=await Fa(r,e,t,n,i);return"mfaPendingCredential"in s&&ks(r,"multi-factor-auth-required",{_serverResponse:s}),s}async function K4(r,e,t,n){const i=`${e}${t}?${n}`,s=r,o=s.config.emulator?db(r.config,i):`${r.config.apiScheme}://${i}`;return E7.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function T7(r){switch(r){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class A7{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(lo(this.auth,"network-request-failed")),S7.get())})}}function Lp(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const i=lo(r,e,n);return i.customData._tokenResponse=t,i}function dS(r){return r!==void 0&&r.enterprise!==void 0}class N7{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return T7(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function I7(r,e){return Fa(r,"GET","/v2/recaptchaConfig",La(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function P7(r,e){return Fa(r,"POST","/v1/accounts:delete",e)}async function Fg(r,e){return Fa(r,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function If(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function k7(r,e=!1){const t=In(r),n=await t.getIdToken(e),i=hb(n);ut(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:If(Uv(i.auth_time)),issuedAtTime:If(Uv(i.iat)),expirationTime:If(Uv(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Uv(r){return Number(r)*1e3}function hb(r){const[e,t,n]=r.split(".");if(e===void 0||t===void 0||n===void 0)return hg("JWT malformed, contained fewer than 3 sections"),null;try{const i=P4(t);return i?JSON.parse(i):(hg("Failed to decode base64 JWT payload"),null)}catch(i){return hg("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function hS(r){const e=hb(r);return ut(e,"internal-error"),ut(typeof e.exp<"u","internal-error"),ut(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $f(r,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof Ma&&C7(n)&&r.auth.currentUser===r&&await r.auth.signOut(),n}}function C7({code:r}){return r==="auth/user-disabled"||r==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R7{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sx{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=If(this.lastLoginAt),this.creationTime=If(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vg(r){var e;const t=r.auth,n=await r.getIdToken(),i=await $f(r,Fg(t,{idToken:n}));ut(i==null?void 0:i.users.length,t,"internal-error");const s=i.users[0];r._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?Y4(s.providerUserInfo):[],l=O7(r.providerData,o),d=r.isAnonymous,f=!(r.email&&s.passwordHash)&&!(l!=null&&l.length),m=d?f:!1,p={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new sx(s.createdAt,s.lastLoginAt),isAnonymous:m};Object.assign(r,p)}async function j7(r){const e=In(r);await Vg(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function O7(r,e){return[...r.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function Y4(r){return r.map(e=>{var{providerId:t}=e,n=lb(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function D7(r,e){const t=await G4(r,{},async()=>{const n=bm({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=r.config,o=await K4(r,i,"/v1/token",`key=${s}`),l=await r._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:l,body:n};return r.emulatorConfig&&Su(r.emulatorConfig.host)&&(d.credentials="include"),W4.fetch()(o,d)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function M7(r,e){return Fa(r,"POST","/v2/accounts:revokeToken",La(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ut(e.idToken,"internal-error"),ut(typeof e.idToken<"u","internal-error"),ut(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):hS(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ut(e.length!==0,"internal-error");const t=hS(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ut(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:s}=await D7(e,t);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:s}=t,o=new Nd;return n&&(ut(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),i&&(ut(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(ut(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Nd,this.toJSON())}_performRefresh(){return wa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pl(r,e){ut(typeof r=="string"||typeof r>"u","internal-error",{appName:e})}class ao{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,s=lb(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new R7(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new sx(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await $f(this,this.stsTokenManager.getToken(this.auth,e));return ut(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return k7(this,e)}reload(){return j7(this)}_assign(e){this!==e&&(ut(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new ao(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ut(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Vg(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(di(this.auth.app))return Promise.reject(Oo(this.auth));const e=await this.getIdToken();return await $f(this,P7(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,s,o,l,d,f,m;const p=(n=t.displayName)!==null&&n!==void 0?n:void 0,g=(i=t.email)!==null&&i!==void 0?i:void 0,v=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,E=(o=t.photoURL)!==null&&o!==void 0?o:void 0,x=(l=t.tenantId)!==null&&l!==void 0?l:void 0,b=(d=t._redirectEventId)!==null&&d!==void 0?d:void 0,S=(f=t.createdAt)!==null&&f!==void 0?f:void 0,N=(m=t.lastLoginAt)!==null&&m!==void 0?m:void 0,{uid:R,emailVerified:I,isAnonymous:j,providerData:U,stsTokenManager:P}=t;ut(R&&P,e,"internal-error");const k=Nd.fromJSON(this.name,P);ut(typeof R=="string",e,"internal-error"),Pl(p,e.name),Pl(g,e.name),ut(typeof I=="boolean",e,"internal-error"),ut(typeof j=="boolean",e,"internal-error"),Pl(v,e.name),Pl(E,e.name),Pl(x,e.name),Pl(b,e.name),Pl(S,e.name),Pl(N,e.name);const F=new ao({uid:R,auth:e,email:g,emailVerified:I,displayName:p,isAnonymous:j,photoURL:E,phoneNumber:v,tenantId:x,stsTokenManager:k,createdAt:S,lastLoginAt:N});return U&&Array.isArray(U)&&(F.providerData=U.map(O=>Object.assign({},O))),b&&(F._redirectEventId=b),F}static async _fromIdTokenResponse(e,t,n=!1){const i=new Nd;i.updateFromServerResponse(t);const s=new ao({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Vg(s),s}static async _fromGetAccountInfoResponse(e,t,n){const i=t.users[0];ut(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?Y4(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),l=new Nd;l.updateFromIdToken(n);const d=new ao({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:o}),f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new sx(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(d,f),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fS=new Map;function Ea(r){ka(r instanceof Function,"Expected a class definition");let e=fS.get(r);return e?(ka(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,fS.set(r,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}Z4.type="NONE";const mS=Z4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fg(r,e,t){return`firebase:${r}:${e}:${t}`}class Id{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=fg(this.userKey,i.apiKey,s),this.fullPersistenceKey=fg("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Fg(this.auth,{idToken:e}).catch(()=>{});return t?ao._fromGetAccountInfoResponse(this.auth,t,e):null}return ao._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new Id(Ea(mS),e,n);const i=(await Promise.all(t.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f);let s=i[0]||Ea(mS);const o=fg(n,e.config.apiKey,e.name);let l=null;for(const f of t)try{const m=await f._get(o);if(m){let p;if(typeof m=="string"){const g=await Fg(e,{idToken:m}).catch(()=>{});if(!g)break;p=await ao._fromGetAccountInfoResponse(e,g,m)}else p=ao._fromJSON(e,m);f!==s&&(l=p),s=f;break}}catch{}const d=i.filter(f=>f._shouldAllowMigration);return!s._shouldAllowMigration||!d.length?new Id(s,e,n):(s=d[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async f=>{if(f!==s)try{await f._remove(o)}catch{}})),new Id(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pS(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(eP(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Q4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(nP(e))return"Blackberry";if(rP(e))return"Webos";if(X4(e))return"Safari";if((e.includes("chrome/")||J4(e))&&!e.includes("edge/"))return"Chrome";if(tP(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=r.match(t);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function Q4(r=pr()){return/firefox\//i.test(r)}function X4(r=pr()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function J4(r=pr()){return/crios\//i.test(r)}function eP(r=pr()){return/iemobile/i.test(r)}function tP(r=pr()){return/android/i.test(r)}function nP(r=pr()){return/blackberry/i.test(r)}function rP(r=pr()){return/webos/i.test(r)}function fb(r=pr()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function L7(r=pr()){var e;return fb(r)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function F7(){return X5()&&document.documentMode===10}function iP(r=pr()){return fb(r)||tP(r)||rP(r)||nP(r)||/windows phone/i.test(r)||eP(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sP(r,e=[]){let t;switch(r){case"Browser":t=pS(pr());break;case"Worker":t=`${pS(pr())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${th}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V7{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=s=>new Promise((o,l)=>{try{const d=e(s);o(d)}catch(d){l(d)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function B7(r,e={}){return Fa(r,"GET","/v2/passwordPolicy",La(r,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z7=6;class U7{constructor(e){var t,n,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:z7,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,i,s,o,l;const d={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,d),this.validatePasswordCharacterOptions(e,d),d.isValid&&(d.isValid=(t=d.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),d.isValid&&(d.isValid=(n=d.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),d.isValid&&(d.isValid=(i=d.containsLowercaseLetter)!==null&&i!==void 0?i:!0),d.isValid&&(d.isValid=(s=d.containsUppercaseLetter)!==null&&s!==void 0?s:!0),d.isValid&&(d.isValid=(o=d.containsNumericCharacter)!==null&&o!==void 0?o:!0),d.isValid&&(d.isValid=(l=d.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),d}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class q7{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new gS(this),this.idTokenSubscription=new gS(this),this.beforeStateQueue=new V7(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=$4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=Ea(t)),this._initializationPromise=this.queue(async()=>{var n,i,s;if(!this._deleted&&(this.persistenceManager=await Id.create(this,e),(n=this._resolvePersistenceManagerAvailable)===null||n===void 0||n.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Fg(this,{idToken:e}),n=await ao._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(di(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,l=i==null?void 0:i._redirectEventId,d=await this.tryRedirectSignIn(e);(!o||o===l)&&(d!=null&&d.user)&&(i=d.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ut(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Vg(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=b7()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(di(this.app))return Promise.reject(Oo(this));const t=e?In(e):null;return t&&ut(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ut(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return di(this.app)?Promise.reject(Oo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return di(this.app)?Promise.reject(Oo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Ea(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await B7(this),t=new U7(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new xm("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await M7(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&Ea(e)||this._popupRedirectResolver;ut(t,this,"argument-error"),this.redirectPersistenceManager=await Id.create(this,[Ea(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(ut(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const d=e.addObserver(t,n,i);return()=>{o=!0,d()}}else{const d=e.addObserver(t);return()=>{o=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ut(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=sP(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;if(di(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&y7(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Bo(r){return In(r)}class gS{constructor(e){this.auth=e,this.observer=null,this.addObserver=ij(t=>this.observer=t)}get next(){return ut(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ay={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function H7(r){Ay=r}function oP(r){return Ay.loadJS(r)}function $7(){return Ay.recaptchaEnterpriseScript}function W7(){return Ay.gapiScript}function G7(r){return`__${r}${Math.floor(Math.random()*1e6)}`}class K7{constructor(){this.enterprise=new Y7}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Y7{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Z7="recaptcha-enterprise",aP="NO_RECAPTCHA";class Q7{constructor(e){this.type=Z7,this.auth=Bo(e)}async verify(e="verify",t=!1){async function n(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,l)=>{I7(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const f=new N7(d);return s.tenantId==null?s._agentRecaptchaConfig=f:s._tenantRecaptchaConfigs[s.tenantId]=f,o(f.siteKey)}}).catch(d=>{l(d)})})}function i(s,o,l){const d=window.grecaptcha;dS(d)?d.enterprise.ready(()=>{d.enterprise.execute(s,{action:e}).then(f=>{o(f)}).catch(()=>{o(aP)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new K7().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{n(this.auth).then(l=>{if(!t&&dS(window.grecaptcha))i(l,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let d=$7();d.length!==0&&(d+=l),oP(d).then(()=>{i(l,s,o)}).catch(f=>{o(f)})}}).catch(l=>{o(l)})})}}async function yS(r,e,t,n=!1,i=!1){const s=new Q7(r);let o;if(i)o=aP;else try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}const l=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const d=l.phoneEnrollmentInfo.phoneNumber,f=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:d,recaptchaToken:f,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const d=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return n?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function Wf(r,e,t,n,i){var s;if(!((s=r._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await yS(r,e,t,t==="getOobCode");return n(r,o)}else return n(r,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await yS(r,e,t,t==="getOobCode");return n(r,l)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function X7(r,e){const t=Sy(r,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(Xl(s,e??{}))return i;ks(i,"already-initialized")}return t.initialize({options:e})}function J7(r,e){const t=(e==null?void 0:e.persistence)||[],n=(Array.isArray(t)?t:[t]).map(Ea);e!=null&&e.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function eO(r,e,t){const n=Bo(r);ut(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=lP(e),{host:o,port:l}=tO(e),d=l===null?"":`:${l}`,f={url:`${s}//${o}${d}/`},m=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){ut(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),ut(Xl(f,n.config.emulator)&&Xl(m,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=f,n.emulatorConfig=m,n.settings.appVerificationDisabledForTesting=!0,Su(o)?(ib(`${s}//${o}${d}`),sb("Auth",!0)):nO()}function lP(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function tO(r){const e=lP(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:vS(n.substr(s.length+1))}}else{const[s,o]=n.split(":");return{host:s,port:vS(o)}}}function vS(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}function nO(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",r):r())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mb{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return wa("not implemented")}_getIdTokenResponse(e){return wa("not implemented")}_linkToIdToken(e,t){return wa("not implemented")}_getReauthenticationResolver(e){return wa("not implemented")}}async function rO(r,e){return Fa(r,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function iO(r,e){return Em(r,"POST","/v1/accounts:signInWithPassword",La(r,e))}async function cP(r,e){return Fa(r,"POST","/v1/accounts:sendOobCode",La(r,e))}async function sO(r,e){return cP(r,e)}async function oO(r,e){return cP(r,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aO(r,e){return Em(r,"POST","/v1/accounts:signInWithEmailLink",La(r,e))}async function lO(r,e){return Em(r,"POST","/v1/accounts:signInWithEmailLink",La(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gf extends mb{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Gf(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Gf(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Wf(e,t,"signInWithPassword",iO);case"emailLink":return aO(e,{email:this._email,oobCode:this._password});default:ks(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Wf(e,n,"signUpPassword",rO);case"emailLink":return lO(e,{idToken:t,email:this._email,oobCode:this._password});default:ks(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pd(r,e){return Em(r,"POST","/v1/accounts:signInWithIdp",La(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cO="http://localhost";class su extends mb{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new su(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ks("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,s=lb(t,["providerId","signInMethod"]);if(!n||!i)return null;const o=new su(n,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return Pd(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Pd(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Pd(e,t)}buildRequest(){const e={requestUri:cO,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=bm(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uO(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function dO(r){const e=mf(pf(r)).link,t=e?mf(pf(e)).deep_link_id:null,n=mf(pf(r)).deep_link_id;return(n?mf(pf(n)).link:null)||n||t||e||r}class Ny{constructor(e){var t,n,i,s,o,l;const d=mf(pf(e)),f=(t=d.apiKey)!==null&&t!==void 0?t:null,m=(n=d.oobCode)!==null&&n!==void 0?n:null,p=uO((i=d.mode)!==null&&i!==void 0?i:null);ut(f&&m&&p,"argument-error"),this.apiKey=f,this.operation=p,this.code=m,this.continueUrl=(s=d.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=d.lang)!==null&&o!==void 0?o:null,this.tenantId=(l=d.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const t=dO(e);try{return new Ny(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tu{constructor(){this.providerId=Tu.PROVIDER_ID}static credential(e,t){return Gf._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Ny.parseLink(t);return ut(n,"argument-error"),Gf._fromEmailAndCode(e,n.code,n.tenantId)}}Tu.PROVIDER_ID="password";Tu.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Tu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pb{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sm extends pb{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ol extends Sm{constructor(){super("facebook.com")}static credential(e){return su._fromParams({providerId:Ol.PROVIDER_ID,signInMethod:Ol.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Ol.credentialFromTaggedObject(e)}static credentialFromError(e){return Ol.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Ol.credential(e.oauthAccessToken)}catch{return null}}}Ol.FACEBOOK_SIGN_IN_METHOD="facebook.com";Ol.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ba extends Sm{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return su._fromParams({providerId:ba.PROVIDER_ID,signInMethod:ba.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ba.credentialFromTaggedObject(e)}static credentialFromError(e){return ba.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return ba.credential(t,n)}catch{return null}}}ba.GOOGLE_SIGN_IN_METHOD="google.com";ba.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dl extends Sm{constructor(){super("github.com")}static credential(e){return su._fromParams({providerId:Dl.PROVIDER_ID,signInMethod:Dl.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Dl.credentialFromTaggedObject(e)}static credentialFromError(e){return Dl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Dl.credential(e.oauthAccessToken)}catch{return null}}}Dl.GITHUB_SIGN_IN_METHOD="github.com";Dl.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ml extends Sm{constructor(){super("twitter.com")}static credential(e,t){return su._fromParams({providerId:Ml.PROVIDER_ID,signInMethod:Ml.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ml.credentialFromTaggedObject(e)}static credentialFromError(e){return Ml.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Ml.credential(t,n)}catch{return null}}}Ml.TWITTER_SIGN_IN_METHOD="twitter.com";Ml.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hO(r,e){return Em(r,"POST","/v1/accounts:signUp",La(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ou{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const s=await ao._fromIdTokenResponse(e,n,i),o=_S(n);return new ou({user:s,providerId:o,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=_S(n);return new ou({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function _S(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bg extends Ma{constructor(e,t,n,i){var s;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Bg.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new Bg(e,t,n,i)}}function uP(r,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Bg._fromErrorAndOperation(r,s,e,n):s})}async function fO(r,e,t=!1){const n=await $f(r,e._linkToIdToken(r.auth,await r.getIdToken()),t);return ou._forOperation(r,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mO(r,e,t=!1){const{auth:n}=r;if(di(n.app))return Promise.reject(Oo(n));const i="reauthenticate";try{const s=await $f(r,uP(n,i,e,r),t);ut(s.idToken,n,"internal-error");const o=hb(s.idToken);ut(o,n,"internal-error");const{sub:l}=o;return ut(r.uid===l,n,"user-mismatch"),ou._forOperation(r,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&ks(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dP(r,e,t=!1){if(di(r.app))return Promise.reject(Oo(r));const n="signIn",i=await uP(r,n,e),s=await ou._fromIdTokenResponse(r,n,i);return t||await r._updateCurrentUser(s.user),s}async function hP(r,e){return dP(Bo(r),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pO(r,e,t){var n;ut(((n=t.url)===null||n===void 0?void 0:n.length)>0,r,"invalid-continue-uri"),ut(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,r,"invalid-dynamic-link-domain"),ut(typeof t.linkDomain>"u"||t.linkDomain.length>0,r,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(ut(t.iOS.bundleId.length>0,r,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(ut(t.android.packageName.length>0,r,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fP(r){const e=Bo(r);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function gO(r,e,t){const n=Bo(r);await Wf(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",sO)}async function yO(r,e,t){if(di(r.app))return Promise.reject(Oo(r));const n=Bo(r),o=await Wf(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",hO).catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&fP(r),d}),l=await ou._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(l.user),l}function vO(r,e,t){return di(r.app)?Promise.reject(Oo(r)):hP(In(r),Tu.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&fP(r),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _O(r,e,t){const n=Bo(r),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,l){ut(l.handleCodeInApp,n,"argument-error"),l&&pO(n,o,l)}s(i,t),await Wf(n,i,"getOobCode",oO)}function mP(r,e){const t=Ny.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function xO(r,e,t){if(di(r.app))return Promise.reject(Oo(r));const n=In(r),i=Tu.credentialWithLink(e,t||Lg());return ut(i._tenantId===(n.tenantId||null),n,"tenant-id-mismatch"),hP(n,i)}function bO(r,e,t,n){return In(r).onIdTokenChanged(e,t,n)}function wO(r,e,t){return In(r).beforeAuthStateChanged(e,t)}function EO(r,e,t,n){return In(r).onAuthStateChanged(e,t,n)}function SO(r){return In(r).signOut()}const zg="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pP{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(zg,"1"),this.storage.removeItem(zg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TO=1e3,AO=10;class gP extends pP{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=iP(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,d)=>{this.notifyListeners(o,d)});return}const n=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(n);!t&&this.localCache[n]===o||this.notifyListeners(n,o)},s=this.storage.getItem(n);F7()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,AO):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},TO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}gP.type="LOCAL";const NO=gP;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yP extends pP{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}yP.type="SESSION";const vP=yP;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IO(r){return Promise.all(r.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iy{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const n=new Iy(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const l=Array.from(o).map(async f=>f(t.origin,s)),d=await IO(l);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:d})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Iy.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gb(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return r+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((l,d)=>{const f=gb("",20);i.port1.start();const m=setTimeout(()=>{d(new Error("unsupported_event"))},n);o={messageChannel:i,onMessage(p){const g=p;if(g.data.eventId===f)switch(g.data.status){case"ack":clearTimeout(m),s=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(g.data.response);break;default:clearTimeout(m),clearTimeout(s),d(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:f,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Do(){return window}function kO(r){Do().location.href=r}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _P(){return typeof Do().WorkerGlobalScope<"u"&&typeof Do().importScripts=="function"}async function CO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function RO(){var r;return((r=navigator==null?void 0:navigator.serviceWorker)===null||r===void 0?void 0:r.controller)||null}function jO(){return _P()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xP="firebaseLocalStorageDb",OO=1,Ug="firebaseLocalStorage",bP="fbase_key";class Tm{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Py(r,e){return r.transaction([Ug],e?"readwrite":"readonly").objectStore(Ug)}function DO(){const r=indexedDB.deleteDatabase(xP);return new Tm(r).toPromise()}function ox(){const r=indexedDB.open(xP,OO);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(Ug,{keyPath:bP})}catch(i){t(i)}}),r.addEventListener("success",async()=>{const n=r.result;n.objectStoreNames.contains(Ug)?e(n):(n.close(),await DO(),e(await ox()))})})}async function xS(r,e,t){const n=Py(r,!0).put({[bP]:e,value:t});return new Tm(n).toPromise()}async function MO(r,e){const t=Py(r,!1).get(e),n=await new Tm(t).toPromise();return n===void 0?null:n.value}function bS(r,e){const t=Py(r,!0).delete(e);return new Tm(t).toPromise()}const LO=800,FO=3;class wP{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await ox(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>FO)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return _P()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Iy._getInstance(jO()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await CO(),!this.activeServiceWorker)return;this.sender=new PO(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((t=n[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||RO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await ox();return await xS(e,zg,"1"),await bS(e,zg),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>xS(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>MO(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>bS(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Py(i,!1).getAll();return new Tm(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),LO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}wP.type="LOCAL";const VO=wP;new wm(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EP(r,e){return e?Ea(e):(ut(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yb extends mb{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Pd(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Pd(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Pd(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function BO(r){return dP(r.auth,new yb(r),r.bypassAuthState)}function zO(r){const{auth:e,user:t}=r;return ut(t,e,"internal-error"),mO(t,new yb(r),r.bypassAuthState)}async function UO(r){const{auth:e,user:t}=r;return ut(t,e,"internal-error"),fO(t,new yb(r),r.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SP{constructor(e,t,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const d={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(d))}catch(f){this.reject(f)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return BO;case"linkViaPopup":case"linkViaRedirect":return UO;case"reauthViaPopup":case"reauthViaRedirect":return zO;default:ks(this.auth,"internal-error")}}resolve(e){ka(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ka(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qO=new wm(2e3,1e4);async function HO(r,e,t){if(di(r.app))return Promise.reject(lo(r,"operation-not-supported-in-this-environment"));const n=Bo(r);v7(r,e,pb);const i=EP(n,t);return new Qc(n,"signInViaPopup",e,i).executeNotNull()}class Qc extends SP{constructor(e,t,n,i,s){super(e,t,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Qc.currentPopupAction&&Qc.currentPopupAction.cancel(),Qc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ut(e,this.auth,"internal-error"),e}async onExecution(){ka(this.filter.length===1,"Popup operations only handle one event");const e=gb();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(lo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(lo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Qc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;if(!((n=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(lo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,qO.get())};e()}}Qc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $O="pendingRedirect",mg=new Map;class WO extends SP{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=mg.get(this.auth._key());if(!e){try{const n=await GO(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}mg.set(this.auth._key(),e)}return this.bypassAuthState||mg.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function GO(r,e){const t=ZO(e),n=YO(r);if(!await n._isAvailable())return!1;const i=await n._get(t)==="true";return await n._remove(t),i}function KO(r,e){mg.set(r._key(),e)}function YO(r){return Ea(r._redirectPersistence)}function ZO(r){return fg($O,r.config.apiKey,r.name)}async function QO(r,e,t=!1){if(di(r.app))return Promise.reject(Oo(r));const n=Bo(r),i=EP(n,e),o=await new WO(n,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XO=10*60*1e3;class JO{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!eD(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!TP(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";t.onError(lo(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=XO&&this.cachedEventUids.clear(),this.cachedEventUids.has(wS(e))}saveEventToCache(e){this.cachedEventUids.add(wS(e)),this.lastProcessedEventTime=Date.now()}}function wS(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function TP({type:r,error:e}){return r==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function eD(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return TP(r);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tD(r,e={}){return Fa(r,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nD=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,rD=/^https?/;async function iD(r){if(r.config.emulator)return;const{authorizedDomains:e}=await tD(r);for(const t of e)try{if(sD(t))return}catch{}ks(r,"unauthorized-domain")}function sD(r){const e=Lg(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const o=new URL(r);return o.hostname===""&&n===""?t==="chrome-extension:"&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===n}if(!rD.test(t))return!1;if(nD.test(r))return n===r;const i=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oD=new wm(3e4,6e4);function ES(){const r=Do().___jsl;if(r!=null&&r.H){for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}}function aD(r){return new Promise((e,t)=>{var n,i,s;function o(){ES(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{ES(),t(lo(r,"network-request-failed"))},timeout:oD.get()})}if(!((i=(n=Do().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Do().gapi)===null||s===void 0)&&s.load)o();else{const l=G7("iframefcb");return Do()[l]=()=>{gapi.load?o():t(lo(r,"network-request-failed"))},oP(`${W7()}?onload=${l}`).catch(d=>t(d))}}).catch(e=>{throw pg=null,e})}let pg=null;function lD(r){return pg=pg||aD(r),pg}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cD=new wm(5e3,15e3),uD="__/auth/iframe",dD="emulator/auth/iframe",hD={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},fD=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function mD(r){const e=r.config;ut(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?db(e,dD):`https://${r.config.authDomain}/${uD}`,n={apiKey:e.apiKey,appName:r.name,v:th},i=fD.get(r.config.apiHost);i&&(n.eid=i);const s=r._getFrameworks();return s.length&&(n.fw=s.join(",")),`${t}?${bm(n).slice(1)}`}async function pD(r){const e=await lD(r),t=Do().gapi;return ut(t,r,"internal-error"),e.open({where:document.body,url:mD(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:hD,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const o=lo(r,"network-request-failed"),l=Do().setTimeout(()=>{s(o)},cD.get());function d(){Do().clearTimeout(l),i(n)}n.ping(d).then(d,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gD={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},yD=500,vD=600,_D="_blank",xD="http://localhost";class SS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function bD(r,e,t,n=yD,i=vD){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const d=Object.assign(Object.assign({},gD),{width:n.toString(),height:i.toString(),top:s,left:o}),f=pr().toLowerCase();t&&(l=J4(f)?_D:t),Q4(f)&&(e=e||xD,d.scrollbars="yes");const m=Object.entries(d).reduce((g,[v,E])=>`${g}${v}=${E},`,"");if(L7(f)&&l!=="_self")return wD(e||"",l),new SS(null);const p=window.open(e||"",l,m);ut(p,r,"popup-blocked");try{p.focus()}catch{}return new SS(p)}function wD(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ED="__/auth/handler",SD="emulator/auth/handler",TD=encodeURIComponent("fac");async function TS(r,e,t,n,i,s){ut(r.config.authDomain,r,"auth-domain-config-required"),ut(r.config.apiKey,r,"invalid-api-key");const o={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:th,eventId:i};if(e instanceof pb){e.setDefaultLanguage(r.languageCode),o.providerId=e.providerId||"",rj(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,p]of Object.entries({}))o[m]=p}if(e instanceof Sm){const m=e.getScopes().filter(p=>p!=="");m.length>0&&(o.scopes=m.join(","))}r.tenantId&&(o.tid=r.tenantId);const l=o;for(const m of Object.keys(l))l[m]===void 0&&delete l[m];const d=await r._getAppCheckToken(),f=d?`#${TD}=${encodeURIComponent(d)}`:"";return`${AD(r)}?${bm(l).slice(1)}${f}`}function AD({config:r}){return r.emulator?db(r,SD):`https://${r.authDomain}/${ED}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qv="webStorageSupport";class ND{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=vP,this._completeRedirectFn=QO,this._overrideRedirectResult=KO}async _openPopup(e,t,n,i){var s;ka((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await TS(e,t,n,Lg(),i);return bD(e,o,gb())}async _openRedirect(e,t,n,i){await this._originValidation(e);const s=await TS(e,t,n,Lg(),i);return kO(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(ka(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await pD(e),n=new JO(e);return t.register("authEvent",i=>(ut(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(qv,{type:qv},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[qv];o!==void 0&&t(!!o),ks(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=iD(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return iP()||X4()||fb()}}const ID=ND;var AS="@firebase/auth",NS="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PD{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ut(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kD(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function CD(r){iu(new Jl("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=n.options;ut(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const d={apiKey:o,authDomain:l,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:sP(r)},f=new q7(n,i,s,d);return J7(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),iu(new Jl("auth-internal",e=>{const t=Bo(e.getProvider("auth").getImmediate());return(n=>new PD(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),jo(AS,NS,kD(r)),jo(AS,NS,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RD=5*60,jD=O4("authIdTokenMaxAge")||RD;let IS=null;const OD=r=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>jD)return;const i=t==null?void 0:t.token;IS!==i&&(IS=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function vb(r=Ty()){const e=Sy(r,"auth");if(e.isInitialized())return e.getImmediate();const t=X7(r,{popupRedirectResolver:ID,persistence:[VO,NO,vP]}),n=O4("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const o=OD(s.toString());wO(t,o,()=>o(t.currentUser)),bO(t,l=>o(l))}}const i=C4("auth");return i&&eO(t,`http://${i}`),t}function DD(){var r,e;return(e=(r=document.getElementsByTagName("head"))===null||r===void 0?void 0:r[0])!==null&&e!==void 0?e:document}H7({loadJS(r){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=i=>{const s=lo("internal-error");s.customData=i,t(s)},n.type="text/javascript",n.charset="UTF-8",DD().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});CD("Browser");var PS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Kl,AP;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(P,k){function F(){}F.prototype=k.prototype,P.D=k.prototype,P.prototype=new F,P.prototype.constructor=P,P.C=function(O,C,M){for(var D=Array(arguments.length-2),$=2;$<arguments.length;$++)D[$-2]=arguments[$];return k.prototype[C].apply(O,D)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(P,k,F){F||(F=0);var O=Array(16);if(typeof k=="string")for(var C=0;16>C;++C)O[C]=k.charCodeAt(F++)|k.charCodeAt(F++)<<8|k.charCodeAt(F++)<<16|k.charCodeAt(F++)<<24;else for(C=0;16>C;++C)O[C]=k[F++]|k[F++]<<8|k[F++]<<16|k[F++]<<24;k=P.g[0],F=P.g[1],C=P.g[2];var M=P.g[3],D=k+(M^F&(C^M))+O[0]+3614090360&4294967295;k=F+(D<<7&4294967295|D>>>25),D=M+(C^k&(F^C))+O[1]+3905402710&4294967295,M=k+(D<<12&4294967295|D>>>20),D=C+(F^M&(k^F))+O[2]+606105819&4294967295,C=M+(D<<17&4294967295|D>>>15),D=F+(k^C&(M^k))+O[3]+3250441966&4294967295,F=C+(D<<22&4294967295|D>>>10),D=k+(M^F&(C^M))+O[4]+4118548399&4294967295,k=F+(D<<7&4294967295|D>>>25),D=M+(C^k&(F^C))+O[5]+1200080426&4294967295,M=k+(D<<12&4294967295|D>>>20),D=C+(F^M&(k^F))+O[6]+2821735955&4294967295,C=M+(D<<17&4294967295|D>>>15),D=F+(k^C&(M^k))+O[7]+4249261313&4294967295,F=C+(D<<22&4294967295|D>>>10),D=k+(M^F&(C^M))+O[8]+1770035416&4294967295,k=F+(D<<7&4294967295|D>>>25),D=M+(C^k&(F^C))+O[9]+2336552879&4294967295,M=k+(D<<12&4294967295|D>>>20),D=C+(F^M&(k^F))+O[10]+4294925233&4294967295,C=M+(D<<17&4294967295|D>>>15),D=F+(k^C&(M^k))+O[11]+2304563134&4294967295,F=C+(D<<22&4294967295|D>>>10),D=k+(M^F&(C^M))+O[12]+1804603682&4294967295,k=F+(D<<7&4294967295|D>>>25),D=M+(C^k&(F^C))+O[13]+4254626195&4294967295,M=k+(D<<12&4294967295|D>>>20),D=C+(F^M&(k^F))+O[14]+2792965006&4294967295,C=M+(D<<17&4294967295|D>>>15),D=F+(k^C&(M^k))+O[15]+1236535329&4294967295,F=C+(D<<22&4294967295|D>>>10),D=k+(C^M&(F^C))+O[1]+4129170786&4294967295,k=F+(D<<5&4294967295|D>>>27),D=M+(F^C&(k^F))+O[6]+3225465664&4294967295,M=k+(D<<9&4294967295|D>>>23),D=C+(k^F&(M^k))+O[11]+643717713&4294967295,C=M+(D<<14&4294967295|D>>>18),D=F+(M^k&(C^M))+O[0]+3921069994&4294967295,F=C+(D<<20&4294967295|D>>>12),D=k+(C^M&(F^C))+O[5]+3593408605&4294967295,k=F+(D<<5&4294967295|D>>>27),D=M+(F^C&(k^F))+O[10]+38016083&4294967295,M=k+(D<<9&4294967295|D>>>23),D=C+(k^F&(M^k))+O[15]+3634488961&4294967295,C=M+(D<<14&4294967295|D>>>18),D=F+(M^k&(C^M))+O[4]+3889429448&4294967295,F=C+(D<<20&4294967295|D>>>12),D=k+(C^M&(F^C))+O[9]+568446438&4294967295,k=F+(D<<5&4294967295|D>>>27),D=M+(F^C&(k^F))+O[14]+3275163606&4294967295,M=k+(D<<9&4294967295|D>>>23),D=C+(k^F&(M^k))+O[3]+4107603335&4294967295,C=M+(D<<14&4294967295|D>>>18),D=F+(M^k&(C^M))+O[8]+1163531501&4294967295,F=C+(D<<20&4294967295|D>>>12),D=k+(C^M&(F^C))+O[13]+2850285829&4294967295,k=F+(D<<5&4294967295|D>>>27),D=M+(F^C&(k^F))+O[2]+4243563512&4294967295,M=k+(D<<9&4294967295|D>>>23),D=C+(k^F&(M^k))+O[7]+1735328473&4294967295,C=M+(D<<14&4294967295|D>>>18),D=F+(M^k&(C^M))+O[12]+2368359562&4294967295,F=C+(D<<20&4294967295|D>>>12),D=k+(F^C^M)+O[5]+4294588738&4294967295,k=F+(D<<4&4294967295|D>>>28),D=M+(k^F^C)+O[8]+2272392833&4294967295,M=k+(D<<11&4294967295|D>>>21),D=C+(M^k^F)+O[11]+1839030562&4294967295,C=M+(D<<16&4294967295|D>>>16),D=F+(C^M^k)+O[14]+4259657740&4294967295,F=C+(D<<23&4294967295|D>>>9),D=k+(F^C^M)+O[1]+2763975236&4294967295,k=F+(D<<4&4294967295|D>>>28),D=M+(k^F^C)+O[4]+1272893353&4294967295,M=k+(D<<11&4294967295|D>>>21),D=C+(M^k^F)+O[7]+4139469664&4294967295,C=M+(D<<16&4294967295|D>>>16),D=F+(C^M^k)+O[10]+3200236656&4294967295,F=C+(D<<23&4294967295|D>>>9),D=k+(F^C^M)+O[13]+681279174&4294967295,k=F+(D<<4&4294967295|D>>>28),D=M+(k^F^C)+O[0]+3936430074&4294967295,M=k+(D<<11&4294967295|D>>>21),D=C+(M^k^F)+O[3]+3572445317&4294967295,C=M+(D<<16&4294967295|D>>>16),D=F+(C^M^k)+O[6]+76029189&4294967295,F=C+(D<<23&4294967295|D>>>9),D=k+(F^C^M)+O[9]+3654602809&4294967295,k=F+(D<<4&4294967295|D>>>28),D=M+(k^F^C)+O[12]+3873151461&4294967295,M=k+(D<<11&4294967295|D>>>21),D=C+(M^k^F)+O[15]+530742520&4294967295,C=M+(D<<16&4294967295|D>>>16),D=F+(C^M^k)+O[2]+3299628645&4294967295,F=C+(D<<23&4294967295|D>>>9),D=k+(C^(F|~M))+O[0]+4096336452&4294967295,k=F+(D<<6&4294967295|D>>>26),D=M+(F^(k|~C))+O[7]+1126891415&4294967295,M=k+(D<<10&4294967295|D>>>22),D=C+(k^(M|~F))+O[14]+2878612391&4294967295,C=M+(D<<15&4294967295|D>>>17),D=F+(M^(C|~k))+O[5]+4237533241&4294967295,F=C+(D<<21&4294967295|D>>>11),D=k+(C^(F|~M))+O[12]+1700485571&4294967295,k=F+(D<<6&4294967295|D>>>26),D=M+(F^(k|~C))+O[3]+2399980690&4294967295,M=k+(D<<10&4294967295|D>>>22),D=C+(k^(M|~F))+O[10]+4293915773&4294967295,C=M+(D<<15&4294967295|D>>>17),D=F+(M^(C|~k))+O[1]+2240044497&4294967295,F=C+(D<<21&4294967295|D>>>11),D=k+(C^(F|~M))+O[8]+1873313359&4294967295,k=F+(D<<6&4294967295|D>>>26),D=M+(F^(k|~C))+O[15]+4264355552&4294967295,M=k+(D<<10&4294967295|D>>>22),D=C+(k^(M|~F))+O[6]+2734768916&4294967295,C=M+(D<<15&4294967295|D>>>17),D=F+(M^(C|~k))+O[13]+1309151649&4294967295,F=C+(D<<21&4294967295|D>>>11),D=k+(C^(F|~M))+O[4]+4149444226&4294967295,k=F+(D<<6&4294967295|D>>>26),D=M+(F^(k|~C))+O[11]+3174756917&4294967295,M=k+(D<<10&4294967295|D>>>22),D=C+(k^(M|~F))+O[2]+718787259&4294967295,C=M+(D<<15&4294967295|D>>>17),D=F+(M^(C|~k))+O[9]+3951481745&4294967295,P.g[0]=P.g[0]+k&4294967295,P.g[1]=P.g[1]+(C+(D<<21&4294967295|D>>>11))&4294967295,P.g[2]=P.g[2]+C&4294967295,P.g[3]=P.g[3]+M&4294967295}n.prototype.u=function(P,k){k===void 0&&(k=P.length);for(var F=k-this.blockSize,O=this.B,C=this.h,M=0;M<k;){if(C==0)for(;M<=F;)i(this,P,M),M+=this.blockSize;if(typeof P=="string"){for(;M<k;)if(O[C++]=P.charCodeAt(M++),C==this.blockSize){i(this,O),C=0;break}}else for(;M<k;)if(O[C++]=P[M++],C==this.blockSize){i(this,O),C=0;break}}this.h=C,this.o+=k},n.prototype.v=function(){var P=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);P[0]=128;for(var k=1;k<P.length-8;++k)P[k]=0;var F=8*this.o;for(k=P.length-8;k<P.length;++k)P[k]=F&255,F/=256;for(this.u(P),P=Array(16),k=F=0;4>k;++k)for(var O=0;32>O;O+=8)P[F++]=this.g[k]>>>O&255;return P};function s(P,k){var F=l;return Object.prototype.hasOwnProperty.call(F,P)?F[P]:F[P]=k(P)}function o(P,k){this.h=k;for(var F=[],O=!0,C=P.length-1;0<=C;C--){var M=P[C]|0;O&&M==k||(F[C]=M,O=!1)}this.g=F}var l={};function d(P){return-128<=P&&128>P?s(P,function(k){return new o([k|0],0>k?-1:0)}):new o([P|0],0>P?-1:0)}function f(P){if(isNaN(P)||!isFinite(P))return p;if(0>P)return b(f(-P));for(var k=[],F=1,O=0;P>=F;O++)k[O]=P/F|0,F*=4294967296;return new o(k,0)}function m(P,k){if(P.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(P.charAt(0)=="-")return b(m(P.substring(1),k));if(0<=P.indexOf("-"))throw Error('number format error: interior "-" character');for(var F=f(Math.pow(k,8)),O=p,C=0;C<P.length;C+=8){var M=Math.min(8,P.length-C),D=parseInt(P.substring(C,C+M),k);8>M?(M=f(Math.pow(k,M)),O=O.j(M).add(f(D))):(O=O.j(F),O=O.add(f(D)))}return O}var p=d(0),g=d(1),v=d(16777216);r=o.prototype,r.m=function(){if(x(this))return-b(this).m();for(var P=0,k=1,F=0;F<this.g.length;F++){var O=this.i(F);P+=(0<=O?O:4294967296+O)*k,k*=4294967296}return P},r.toString=function(P){if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(E(this))return"0";if(x(this))return"-"+b(this).toString(P);for(var k=f(Math.pow(P,6)),F=this,O="";;){var C=I(F,k).g;F=S(F,C.j(k));var M=((0<F.g.length?F.g[0]:F.h)>>>0).toString(P);if(F=C,E(F))return M+O;for(;6>M.length;)M="0"+M;O=M+O}},r.i=function(P){return 0>P?0:P<this.g.length?this.g[P]:this.h};function E(P){if(P.h!=0)return!1;for(var k=0;k<P.g.length;k++)if(P.g[k]!=0)return!1;return!0}function x(P){return P.h==-1}r.l=function(P){return P=S(this,P),x(P)?-1:E(P)?0:1};function b(P){for(var k=P.g.length,F=[],O=0;O<k;O++)F[O]=~P.g[O];return new o(F,~P.h).add(g)}r.abs=function(){return x(this)?b(this):this},r.add=function(P){for(var k=Math.max(this.g.length,P.g.length),F=[],O=0,C=0;C<=k;C++){var M=O+(this.i(C)&65535)+(P.i(C)&65535),D=(M>>>16)+(this.i(C)>>>16)+(P.i(C)>>>16);O=D>>>16,M&=65535,D&=65535,F[C]=D<<16|M}return new o(F,F[F.length-1]&-2147483648?-1:0)};function S(P,k){return P.add(b(k))}r.j=function(P){if(E(this)||E(P))return p;if(x(this))return x(P)?b(this).j(b(P)):b(b(this).j(P));if(x(P))return b(this.j(b(P)));if(0>this.l(v)&&0>P.l(v))return f(this.m()*P.m());for(var k=this.g.length+P.g.length,F=[],O=0;O<2*k;O++)F[O]=0;for(O=0;O<this.g.length;O++)for(var C=0;C<P.g.length;C++){var M=this.i(O)>>>16,D=this.i(O)&65535,$=P.i(C)>>>16,K=P.i(C)&65535;F[2*O+2*C]+=D*K,N(F,2*O+2*C),F[2*O+2*C+1]+=M*K,N(F,2*O+2*C+1),F[2*O+2*C+1]+=D*$,N(F,2*O+2*C+1),F[2*O+2*C+2]+=M*$,N(F,2*O+2*C+2)}for(O=0;O<k;O++)F[O]=F[2*O+1]<<16|F[2*O];for(O=k;O<2*k;O++)F[O]=0;return new o(F,0)};function N(P,k){for(;(P[k]&65535)!=P[k];)P[k+1]+=P[k]>>>16,P[k]&=65535,k++}function R(P,k){this.g=P,this.h=k}function I(P,k){if(E(k))throw Error("division by zero");if(E(P))return new R(p,p);if(x(P))return k=I(b(P),k),new R(b(k.g),b(k.h));if(x(k))return k=I(P,b(k)),new R(b(k.g),k.h);if(30<P.g.length){if(x(P)||x(k))throw Error("slowDivide_ only works with positive integers.");for(var F=g,O=k;0>=O.l(P);)F=j(F),O=j(O);var C=U(F,1),M=U(O,1);for(O=U(O,2),F=U(F,2);!E(O);){var D=M.add(O);0>=D.l(P)&&(C=C.add(F),M=D),O=U(O,1),F=U(F,1)}return k=S(P,C.j(k)),new R(C,k)}for(C=p;0<=P.l(k);){for(F=Math.max(1,Math.floor(P.m()/k.m())),O=Math.ceil(Math.log(F)/Math.LN2),O=48>=O?1:Math.pow(2,O-48),M=f(F),D=M.j(k);x(D)||0<D.l(P);)F-=O,M=f(F),D=M.j(k);E(M)&&(M=g),C=C.add(M),P=S(P,D)}return new R(C,P)}r.A=function(P){return I(this,P).h},r.and=function(P){for(var k=Math.max(this.g.length,P.g.length),F=[],O=0;O<k;O++)F[O]=this.i(O)&P.i(O);return new o(F,this.h&P.h)},r.or=function(P){for(var k=Math.max(this.g.length,P.g.length),F=[],O=0;O<k;O++)F[O]=this.i(O)|P.i(O);return new o(F,this.h|P.h)},r.xor=function(P){for(var k=Math.max(this.g.length,P.g.length),F=[],O=0;O<k;O++)F[O]=this.i(O)^P.i(O);return new o(F,this.h^P.h)};function j(P){for(var k=P.g.length+1,F=[],O=0;O<k;O++)F[O]=P.i(O)<<1|P.i(O-1)>>>31;return new o(F,P.h)}function U(P,k){var F=k>>5;k%=32;for(var O=P.g.length-F,C=[],M=0;M<O;M++)C[M]=0<k?P.i(M+F)>>>k|P.i(M+F+1)<<32-k:P.i(M+F);return new o(C,P.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,AP=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=f,o.fromString=m,Kl=o}).apply(typeof PS<"u"?PS:typeof self<"u"?self:typeof window<"u"?window:{});var Fp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var NP,gf,IP,gg,ax,PP,kP,CP;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(w,q,Y){return w==Array.prototype||w==Object.prototype||(w[q]=Y.value),w};function t(w){w=[typeof globalThis=="object"&&globalThis,w,typeof window=="object"&&window,typeof self=="object"&&self,typeof Fp=="object"&&Fp];for(var q=0;q<w.length;++q){var Y=w[q];if(Y&&Y.Math==Math)return Y}throw Error("Cannot find global object")}var n=t(this);function i(w,q){if(q)e:{var Y=n;w=w.split(".");for(var oe=0;oe<w.length-1;oe++){var ye=w[oe];if(!(ye in Y))break e;Y=Y[ye]}w=w[w.length-1],oe=Y[w],q=q(oe),q!=oe&&q!=null&&e(Y,w,{configurable:!0,writable:!0,value:q})}}function s(w,q){w instanceof String&&(w+="");var Y=0,oe=!1,ye={next:function(){if(!oe&&Y<w.length){var Ae=Y++;return{value:q(Ae,w[Ae]),done:!1}}return oe=!0,{done:!0,value:void 0}}};return ye[Symbol.iterator]=function(){return ye},ye}i("Array.prototype.values",function(w){return w||function(){return s(this,function(q,Y){return Y})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function d(w){var q=typeof w;return q=q!="object"?q:w?Array.isArray(w)?"array":q:"null",q=="array"||q=="object"&&typeof w.length=="number"}function f(w){var q=typeof w;return q=="object"&&w!=null||q=="function"}function m(w,q,Y){return w.call.apply(w.bind,arguments)}function p(w,q,Y){if(!w)throw Error();if(2<arguments.length){var oe=Array.prototype.slice.call(arguments,2);return function(){var ye=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ye,oe),w.apply(q,ye)}}return function(){return w.apply(q,arguments)}}function g(w,q,Y){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:p,g.apply(null,arguments)}function v(w,q){var Y=Array.prototype.slice.call(arguments,1);return function(){var oe=Y.slice();return oe.push.apply(oe,arguments),w.apply(this,oe)}}function E(w,q){function Y(){}Y.prototype=q.prototype,w.aa=q.prototype,w.prototype=new Y,w.prototype.constructor=w,w.Qb=function(oe,ye,Ae){for(var He=Array(arguments.length-2),nn=2;nn<arguments.length;nn++)He[nn-2]=arguments[nn];return q.prototype[ye].apply(oe,He)}}function x(w){const q=w.length;if(0<q){const Y=Array(q);for(let oe=0;oe<q;oe++)Y[oe]=w[oe];return Y}return[]}function b(w,q){for(let Y=1;Y<arguments.length;Y++){const oe=arguments[Y];if(d(oe)){const ye=w.length||0,Ae=oe.length||0;w.length=ye+Ae;for(let He=0;He<Ae;He++)w[ye+He]=oe[He]}else w.push(oe)}}class S{constructor(q,Y){this.i=q,this.j=Y,this.h=0,this.g=null}get(){let q;return 0<this.h?(this.h--,q=this.g,this.g=q.next,q.next=null):q=this.i(),q}}function N(w){return/^[\s\xa0]*$/.test(w)}function R(){var w=l.navigator;return w&&(w=w.userAgent)?w:""}function I(w){return I[" "](w),w}I[" "]=function(){};var j=R().indexOf("Gecko")!=-1&&!(R().toLowerCase().indexOf("webkit")!=-1&&R().indexOf("Edge")==-1)&&!(R().indexOf("Trident")!=-1||R().indexOf("MSIE")!=-1)&&R().indexOf("Edge")==-1;function U(w,q,Y){for(const oe in w)q.call(Y,w[oe],oe,w)}function P(w,q){for(const Y in w)q.call(void 0,w[Y],Y,w)}function k(w){const q={};for(const Y in w)q[Y]=w[Y];return q}const F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(w,q){let Y,oe;for(let ye=1;ye<arguments.length;ye++){oe=arguments[ye];for(Y in oe)w[Y]=oe[Y];for(let Ae=0;Ae<F.length;Ae++)Y=F[Ae],Object.prototype.hasOwnProperty.call(oe,Y)&&(w[Y]=oe[Y])}}function C(w){var q=1;w=w.split(":");const Y=[];for(;0<q&&w.length;)Y.push(w.shift()),q--;return w.length&&Y.push(w.join(":")),Y}function M(w){l.setTimeout(()=>{throw w},0)}function D(){var w=re;let q=null;return w.g&&(q=w.g,w.g=w.g.next,w.g||(w.h=null),q.next=null),q}class ${constructor(){this.h=this.g=null}add(q,Y){const oe=K.get();oe.set(q,Y),this.h?this.h.next=oe:this.g=oe,this.h=oe}}var K=new S(()=>new ee,w=>w.reset());class ee{constructor(){this.next=this.g=this.h=null}set(q,Y){this.h=q,this.g=Y,this.next=null}reset(){this.next=this.g=this.h=null}}let se,ie=!1,re=new $,G=()=>{const w=l.Promise.resolve(void 0);se=()=>{w.then(z)}};var z=()=>{for(var w;w=D();){try{w.h.call(w.g)}catch(Y){M(Y)}var q=K;q.j(w),100>q.h&&(q.h++,w.next=q.g,q.g=w)}ie=!1};function Z(){this.s=this.s,this.C=this.C}Z.prototype.s=!1,Z.prototype.ma=function(){this.s||(this.s=!0,this.N())},Z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function J(w,q){this.type=w,this.g=this.target=q,this.defaultPrevented=!1}J.prototype.h=function(){this.defaultPrevented=!0};var ae=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var w=!1,q=Object.defineProperty({},"passive",{get:function(){w=!0}});try{const Y=()=>{};l.addEventListener("test",Y,q),l.removeEventListener("test",Y,q)}catch{}return w}();function le(w,q){if(J.call(this,w?w.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,w){var Y=this.type=w.type,oe=w.changedTouches&&w.changedTouches.length?w.changedTouches[0]:null;if(this.target=w.target||w.srcElement,this.g=q,q=w.relatedTarget){if(j){e:{try{I(q.nodeName);var ye=!0;break e}catch{}ye=!1}ye||(q=null)}}else Y=="mouseover"?q=w.fromElement:Y=="mouseout"&&(q=w.toElement);this.relatedTarget=q,oe?(this.clientX=oe.clientX!==void 0?oe.clientX:oe.pageX,this.clientY=oe.clientY!==void 0?oe.clientY:oe.pageY,this.screenX=oe.screenX||0,this.screenY=oe.screenY||0):(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0),this.button=w.button,this.key=w.key||"",this.ctrlKey=w.ctrlKey,this.altKey=w.altKey,this.shiftKey=w.shiftKey,this.metaKey=w.metaKey,this.pointerId=w.pointerId||0,this.pointerType=typeof w.pointerType=="string"?w.pointerType:Q[w.pointerType]||"",this.state=w.state,this.i=w,w.defaultPrevented&&le.aa.h.call(this)}}E(le,J);var Q={2:"touch",3:"pen",4:"mouse"};le.prototype.h=function(){le.aa.h.call(this);var w=this.i;w.preventDefault?w.preventDefault():w.returnValue=!1};var ce="closure_listenable_"+(1e6*Math.random()|0),ue=0;function fe(w,q,Y,oe,ye){this.listener=w,this.proxy=null,this.src=q,this.type=Y,this.capture=!!oe,this.ha=ye,this.key=++ue,this.da=this.fa=!1}function ve(w){w.da=!0,w.listener=null,w.proxy=null,w.src=null,w.ha=null}function Me(w){this.src=w,this.g={},this.h=0}Me.prototype.add=function(w,q,Y,oe,ye){var Ae=w.toString();w=this.g[Ae],w||(w=this.g[Ae]=[],this.h++);var He=qe(w,q,oe,ye);return-1<He?(q=w[He],Y||(q.fa=!1)):(q=new fe(q,this.src,Ae,!!oe,ye),q.fa=Y,w.push(q)),q};function Pe(w,q){var Y=q.type;if(Y in w.g){var oe=w.g[Y],ye=Array.prototype.indexOf.call(oe,q,void 0),Ae;(Ae=0<=ye)&&Array.prototype.splice.call(oe,ye,1),Ae&&(ve(q),w.g[Y].length==0&&(delete w.g[Y],w.h--))}}function qe(w,q,Y,oe){for(var ye=0;ye<w.length;++ye){var Ae=w[ye];if(!Ae.da&&Ae.listener==q&&Ae.capture==!!Y&&Ae.ha==oe)return ye}return-1}var Ge="closure_lm_"+(1e6*Math.random()|0),lt={};function Ct(w,q,Y,oe,ye){if(Array.isArray(q)){for(var Ae=0;Ae<q.length;Ae++)Ct(w,q[Ae],Y,oe,ye);return null}return Y=yt(Y),w&&w[ce]?w.K(q,Y,f(oe)?!!oe.capture:!1,ye):bt(w,q,Y,!1,oe,ye)}function bt(w,q,Y,oe,ye,Ae){if(!q)throw Error("Invalid event type");var He=f(ye)?!!ye.capture:!!ye,nn=_t(w);if(nn||(w[Ge]=nn=new Me(w)),Y=nn.add(q,Y,oe,He,Ae),Y.proxy)return Y;if(oe=Te(),Y.proxy=oe,oe.src=w,oe.listener=Y,w.addEventListener)ae||(ye=He),ye===void 0&&(ye=!1),w.addEventListener(q.toString(),oe,ye);else if(w.attachEvent)w.attachEvent(Be(q.toString()),oe);else if(w.addListener&&w.removeListener)w.addListener(oe);else throw Error("addEventListener and attachEvent are unavailable.");return Y}function Te(){function w(Y){return q.call(w.src,w.listener,Y)}const q=ke;return w}function Ie(w,q,Y,oe,ye){if(Array.isArray(q))for(var Ae=0;Ae<q.length;Ae++)Ie(w,q[Ae],Y,oe,ye);else oe=f(oe)?!!oe.capture:!!oe,Y=yt(Y),w&&w[ce]?(w=w.i,q=String(q).toString(),q in w.g&&(Ae=w.g[q],Y=qe(Ae,Y,oe,ye),-1<Y&&(ve(Ae[Y]),Array.prototype.splice.call(Ae,Y,1),Ae.length==0&&(delete w.g[q],w.h--)))):w&&(w=_t(w))&&(q=w.g[q.toString()],w=-1,q&&(w=qe(q,Y,oe,ye)),(Y=-1<w?q[w]:null)&&Le(Y))}function Le(w){if(typeof w!="number"&&w&&!w.da){var q=w.src;if(q&&q[ce])Pe(q.i,w);else{var Y=w.type,oe=w.proxy;q.removeEventListener?q.removeEventListener(Y,oe,w.capture):q.detachEvent?q.detachEvent(Be(Y),oe):q.addListener&&q.removeListener&&q.removeListener(oe),(Y=_t(q))?(Pe(Y,w),Y.h==0&&(Y.src=null,q[Ge]=null)):ve(w)}}}function Be(w){return w in lt?lt[w]:lt[w]="on"+w}function ke(w,q){if(w.da)w=!0;else{q=new le(q,this);var Y=w.listener,oe=w.ha||w.src;w.fa&&Le(w),w=Y.call(oe,q)}return w}function _t(w){return w=w[Ge],w instanceof Me?w:null}var gt="__closure_events_fn_"+(1e9*Math.random()>>>0);function yt(w){return typeof w=="function"?w:(w[gt]||(w[gt]=function(q){return w.handleEvent(q)}),w[gt])}function kt(){Z.call(this),this.i=new Me(this),this.M=this,this.F=null}E(kt,Z),kt.prototype[ce]=!0,kt.prototype.removeEventListener=function(w,q,Y,oe){Ie(this,w,q,Y,oe)};function Ft(w,q){var Y,oe=w.F;if(oe)for(Y=[];oe;oe=oe.F)Y.push(oe);if(w=w.M,oe=q.type||q,typeof q=="string")q=new J(q,w);else if(q instanceof J)q.target=q.target||w;else{var ye=q;q=new J(oe,w),O(q,ye)}if(ye=!0,Y)for(var Ae=Y.length-1;0<=Ae;Ae--){var He=q.g=Y[Ae];ye=Vt(He,oe,!0,q)&&ye}if(He=q.g=w,ye=Vt(He,oe,!0,q)&&ye,ye=Vt(He,oe,!1,q)&&ye,Y)for(Ae=0;Ae<Y.length;Ae++)He=q.g=Y[Ae],ye=Vt(He,oe,!1,q)&&ye}kt.prototype.N=function(){if(kt.aa.N.call(this),this.i){var w=this.i,q;for(q in w.g){for(var Y=w.g[q],oe=0;oe<Y.length;oe++)ve(Y[oe]);delete w.g[q],w.h--}}this.F=null},kt.prototype.K=function(w,q,Y,oe){return this.i.add(String(w),q,!1,Y,oe)},kt.prototype.L=function(w,q,Y,oe){return this.i.add(String(w),q,!0,Y,oe)};function Vt(w,q,Y,oe){if(q=w.i.g[String(q)],!q)return!0;q=q.concat();for(var ye=!0,Ae=0;Ae<q.length;++Ae){var He=q[Ae];if(He&&!He.da&&He.capture==Y){var nn=He.listener,Hn=He.ha||He.src;He.fa&&Pe(w.i,He),ye=nn.call(Hn,oe)!==!1&&ye}}return ye&&!oe.defaultPrevented}function cs(w,q,Y){if(typeof w=="function")Y&&(w=g(w,Y));else if(w&&typeof w.handleEvent=="function")w=g(w.handleEvent,w);else throw Error("Invalid listener argument");return 2147483647<Number(q)?-1:l.setTimeout(w,q||0)}function Gt(w){w.g=cs(()=>{w.g=null,w.i&&(w.i=!1,Gt(w))},w.l);const q=w.h;w.h=null,w.m.apply(null,q)}class Fn extends Z{constructor(q,Y){super(),this.m=q,this.l=Y,this.h=null,this.i=!1,this.g=null}j(q){this.h=arguments,this.g?this.i=!0:Gt(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function us(w){Z.call(this),this.h=w,this.g={}}E(us,Z);var Ui=[];function yi(w){U(w.g,function(q,Y){this.g.hasOwnProperty(Y)&&Le(q)},w),w.g={}}us.prototype.N=function(){us.aa.N.call(this),yi(this)},us.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var yr=l.JSON.stringify,vi=l.JSON.parse,ni=class{stringify(w){return l.JSON.stringify(w,void 0)}parse(w){return l.JSON.parse(w,void 0)}};function qi(){}qi.prototype.h=null;function ho(w){return w.h||(w.h=w.i())}function _i(){}var er={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ri(){J.call(this,"d")}E(ri,J);function xi(){J.call(this,"c")}E(xi,J);var bi={},qo=null;function vn(){return qo=qo||new kt}bi.La="serverreachability";function wi(w){J.call(this,bi.La,w)}E(wi,J);function Hi(w){const q=vn();Ft(q,new wi(q))}bi.STAT_EVENT="statevent";function ds(w,q){J.call(this,bi.STAT_EVENT,w),this.stat=q}E(ds,J);function bn(w){const q=vn();Ft(q,new ds(q,w))}bi.Ma="timingevent";function Vs(w,q){J.call(this,bi.Ma,w),this.size=q}E(Vs,J);function Br(w,q){if(typeof w!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){w()},q)}function Bs(){this.g=!0}Bs.prototype.xa=function(){this.g=!1};function cn(w,q,Y,oe,ye,Ae){w.info(function(){if(w.g)if(Ae)for(var He="",nn=Ae.split("&"),Hn=0;Hn<nn.length;Hn++){var Ht=nn[Hn].split("=");if(1<Ht.length){var sn=Ht[0];Ht=Ht[1];var En=sn.split("_");He=2<=En.length&&En[1]=="type"?He+(sn+"="+Ht+"&"):He+(sn+"=redacted&")}}else He=null;else He=Ae;return"XMLHTTP REQ ("+oe+") [attempt "+ye+"]: "+q+`
`+Y+`
`+He})}function Ke(w,q,Y,oe,ye,Ae,He){w.info(function(){return"XMLHTTP RESP ("+oe+") [ attempt "+ye+"]: "+q+`
`+Y+`
`+Ae+" "+He})}function Ir(w,q,Y,oe){w.info(function(){return"XMLHTTP TEXT ("+q+"): "+fo(w,Y)+(oe?" "+oe:"")})}function zs(w,q){w.info(function(){return"TIMEOUT: "+q})}Bs.prototype.info=function(){};function fo(w,q){if(!w.g)return q;if(!q)return null;try{var Y=JSON.parse(q);if(Y){for(w=0;w<Y.length;w++)if(Array.isArray(Y[w])){var oe=Y[w];if(!(2>oe.length)){var ye=oe[1];if(Array.isArray(ye)&&!(1>ye.length)){var Ae=ye[0];if(Ae!="noop"&&Ae!="stop"&&Ae!="close")for(var He=1;He<ye.length;He++)ye[He]=""}}}}return yr(Y)}catch{return q}}var hs={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},vr={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Pr;function kr(){}E(kr,qi),kr.prototype.g=function(){return new XMLHttpRequest},kr.prototype.i=function(){return{}},Pr=new kr;function Cr(w,q,Y,oe){this.j=w,this.i=q,this.l=Y,this.R=oe||1,this.U=new us(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ho}function Ho(){this.i=null,this.g="",this.h=!1}var $o={},et={};function pe(w,q,Y){w.L=1,w.v=Ur(Tn(q)),w.m=Y,w.P=!0,De(w,null)}function De(w,q){w.F=Date.now(),Pt(w),w.A=Tn(w.v);var Y=w.A,oe=w.R;Array.isArray(oe)||(oe=[String(oe)]),go(Y.i,"t",oe),w.C=0,Y=w.j.J,w.h=new Ho,w.g=Mu(w.j,Y?q:null,!w.m),0<w.O&&(w.M=new Fn(g(w.Y,w,w.g),w.O)),q=w.U,Y=w.g,oe=w.ca;var ye="readystatechange";Array.isArray(ye)||(ye&&(Ui[0]=ye.toString()),ye=Ui);for(var Ae=0;Ae<ye.length;Ae++){var He=Ct(Y,ye[Ae],oe||q.handleEvent,!1,q.h||q);if(!He)break;q.g[He.key]=He}q=w.H?k(w.H):{},w.m?(w.u||(w.u="POST"),q["Content-Type"]="application/x-www-form-urlencoded",w.g.ea(w.A,w.u,w.m,q)):(w.u="GET",w.g.ea(w.A,w.u,null,q)),Hi(),cn(w.i,w.u,w.A,w.l,w.R,w.m)}Cr.prototype.ca=function(w){w=w.target;const q=this.M;q&&nr(w)==3?q.j():this.Y(w)},Cr.prototype.Y=function(w){try{if(w==this.g)e:{const En=nr(this.g);var q=this.g.Ba();const Pi=this.g.Z();if(!(3>En)&&(En!=3||this.g&&(this.h.h||this.g.oa()||Qa(this.g)))){this.J||En!=4||q==7||(q==8||0>=Pi?Hi(3):Hi(2)),Rn(this);var Y=this.g.Z();this.X=Y;t:if(Qe(this)){var oe=Qa(this.g);w="";var ye=oe.length,Ae=nr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Kn(this),tr(this);var He="";break t}this.h.i=new l.TextDecoder}for(q=0;q<ye;q++)this.h.h=!0,w+=this.h.i.decode(oe[q],{stream:!(Ae&&q==ye-1)});oe.length=0,this.h.g+=w,this.C=0,He=this.h.g}else He=this.g.oa();if(this.o=Y==200,Ke(this.i,this.u,this.A,this.l,this.R,En,Y),this.o){if(this.T&&!this.K){t:{if(this.g){var nn,Hn=this.g;if((nn=Hn.g?Hn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(nn)){var Ht=nn;break t}}Ht=null}if(Y=Ht)Ir(this.i,this.l,Y,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$i(this,Y);else{this.o=!1,this.s=3,bn(12),Kn(this),tr(this);break e}}if(this.P){Y=!0;let Vn;for(;!this.J&&this.C<He.length;)if(Vn=Qt(this,He),Vn==et){En==4&&(this.s=4,bn(14),Y=!1),Ir(this.i,this.l,null,"[Incomplete Response]");break}else if(Vn==$o){this.s=4,bn(15),Ir(this.i,this.l,He,"[Invalid Chunk]"),Y=!1;break}else Ir(this.i,this.l,Vn,null),$i(this,Vn);if(Qe(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),En!=4||He.length!=0||this.h.h||(this.s=1,bn(16),Y=!1),this.o=this.o&&Y,!Y)Ir(this.i,this.l,He,"[Invalid Chunked Response]"),Kn(this),tr(this);else if(0<He.length&&!this.W){this.W=!0;var sn=this.j;sn.g==this&&sn.ba&&!sn.M&&(sn.j.info("Great, no buffering proxy detected. Bytes received: "+He.length),el(sn),sn.M=!0,bn(11))}}else Ir(this.i,this.l,He,null),$i(this,He);En==4&&Kn(this),this.o&&!this.J&&(En==4?ea(this.j,this):(this.o=!1,Pt(this)))}else Xa(this.g),Y==400&&0<He.indexOf("Unknown SID")?(this.s=3,bn(12)):(this.s=0,bn(13)),Kn(this),tr(this)}}}catch{}finally{}};function Qe(w){return w.g?w.u=="GET"&&w.L!=2&&w.j.Ca:!1}function Qt(w,q){var Y=w.C,oe=q.indexOf(`
`,Y);return oe==-1?et:(Y=Number(q.substring(Y,oe)),isNaN(Y)?$o:(oe+=1,oe+Y>q.length?et:(q=q.slice(oe,oe+Y),w.C=oe+Y,q)))}Cr.prototype.cancel=function(){this.J=!0,Kn(this)};function Pt(w){w.S=Date.now()+w.I,wn(w,w.I)}function wn(w,q){if(w.B!=null)throw Error("WatchDog timer not null");w.B=Br(g(w.ba,w),q)}function Rn(w){w.B&&(l.clearTimeout(w.B),w.B=null)}Cr.prototype.ba=function(){this.B=null;const w=Date.now();0<=w-this.S?(zs(this.i,this.A),this.L!=2&&(Hi(),bn(17)),Kn(this),this.s=2,tr(this)):wn(this,this.S-w)};function tr(w){w.j.G==0||w.J||ea(w.j,w)}function Kn(w){Rn(w);var q=w.M;q&&typeof q.ma=="function"&&q.ma(),w.M=null,yi(w.U),w.g&&(q=w.g,w.g=null,q.abort(),q.ma())}function $i(w,q){try{var Y=w.j;if(Y.G!=0&&(Y.g==w||At(Y.h,w))){if(!w.K&&At(Y.h,w)&&Y.G==3){try{var oe=Y.Da.g.parse(q)}catch{oe=null}if(Array.isArray(oe)&&oe.length==3){var ye=oe;if(ye[0]==0){e:if(!Y.u){if(Y.g)if(Y.g.F+3e3<w.F)nl(Y),Yi(Y);else break e;Jo(Y),bn(18)}}else Y.za=ye[1],0<Y.za-Y.T&&37500>ye[2]&&Y.F&&Y.v==0&&!Y.C&&(Y.C=Br(g(Y.Za,Y),6e3));if(1>=mo(Y.h)&&Y.ca){try{Y.ca()}catch{}Y.ca=void 0}}else Gs(Y,11)}else if((w.K||Y.g==w)&&nl(Y),!N(q))for(ye=Y.Da.g.parse(q),q=0;q<ye.length;q++){let Ht=ye[q];if(Y.T=Ht[0],Ht=Ht[1],Y.G==2)if(Ht[0]=="c"){Y.K=Ht[1],Y.ia=Ht[2];const sn=Ht[3];sn!=null&&(Y.la=sn,Y.j.info("VER="+Y.la));const En=Ht[4];En!=null&&(Y.Aa=En,Y.j.info("SVER="+Y.Aa));const Pi=Ht[5];Pi!=null&&typeof Pi=="number"&&0<Pi&&(oe=1.5*Pi,Y.L=oe,Y.j.info("backChannelRequestTimeoutMs_="+oe)),oe=Y;const Vn=w.g;if(Vn){const na=Vn.g?Vn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(na){var Ae=oe.h;Ae.g||na.indexOf("spdy")==-1&&na.indexOf("quic")==-1&&na.indexOf("h2")==-1||(Ae.j=Ae.l,Ae.g=new Set,Ae.h&&(un(Ae,Ae.h),Ae.h=null))}if(oe.D){const Zi=Vn.g?Vn.g.getResponseHeader("X-HTTP-Session-Id"):null;Zi&&(oe.ya=Zi,Nt(oe.I,oe.D,Zi))}}Y.G=3,Y.l&&Y.l.ua(),Y.ba&&(Y.R=Date.now()-w.F,Y.j.info("Handshake RTT: "+Y.R+"ms")),oe=Y;var He=w;if(oe.qa=rl(oe,oe.J?oe.ia:null,oe.W),He.K){Wo(oe.h,He);var nn=He,Hn=oe.L;Hn&&(nn.I=Hn),nn.B&&(Rn(nn),Pt(nn)),oe.g=He}else qr(oe);0<Y.i.length&&Ii(Y)}else Ht[0]!="stop"&&Ht[0]!="close"||Gs(Y,7);else Y.G==3&&(Ht[0]=="stop"||Ht[0]=="close"?Ht[0]=="stop"?Gs(Y,7):rr(Y):Ht[0]!="noop"&&Y.l&&Y.l.ta(Ht),Y.v=0)}}Hi(4)}catch{}}var _n=class{constructor(w,q){this.g=w,this.map=q}};function Wi(w){this.l=w||10,l.PerformanceNavigationTiming?(w=l.performance.getEntriesByType("navigation"),w=0<w.length&&(w[0].nextHopProtocol=="hq"||w[0].nextHopProtocol=="h2")):w=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=w?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function lr(w){return w.h?!0:w.g?w.g.size>=w.j:!1}function mo(w){return w.h?1:w.g?w.g.size:0}function At(w,q){return w.h?w.h==q:w.g?w.g.has(q):!1}function un(w,q){w.g?w.g.add(q):w.h=q}function Wo(w,q){w.h&&w.h==q?w.h=null:w.g&&w.g.has(q)&&w.g.delete(q)}Wi.prototype.cancel=function(){if(this.i=Us(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const w of this.g.values())w.cancel();this.g.clear()}};function Us(w){if(w.h!=null)return w.i.concat(w.h.D);if(w.g!=null&&w.g.size!==0){let q=w.i;for(const Y of w.g.values())q=q.concat(Y.D);return q}return x(w.i)}function Gi(w){if(w.V&&typeof w.V=="function")return w.V();if(typeof Map<"u"&&w instanceof Map||typeof Set<"u"&&w instanceof Set)return Array.from(w.values());if(typeof w=="string")return w.split("");if(d(w)){for(var q=[],Y=w.length,oe=0;oe<Y;oe++)q.push(w[oe]);return q}q=[],Y=0;for(oe in w)q[Y++]=w[oe];return q}function po(w){if(w.na&&typeof w.na=="function")return w.na();if(!w.V||typeof w.V!="function"){if(typeof Map<"u"&&w instanceof Map)return Array.from(w.keys());if(!(typeof Set<"u"&&w instanceof Set)){if(d(w)||typeof w=="string"){var q=[];w=w.length;for(var Y=0;Y<w;Y++)q.push(Y);return q}q=[],Y=0;for(const oe in w)q[Y++]=oe;return q}}}function wt(w,q){if(w.forEach&&typeof w.forEach=="function")w.forEach(q,void 0);else if(d(w)||typeof w=="string")Array.prototype.forEach.call(w,q,void 0);else for(var Y=po(w),oe=Gi(w),ye=oe.length,Ae=0;Ae<ye;Ae++)q.call(void 0,oe[Ae],Y&&Y[Ae],w)}var dn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function yc(w,q){if(w){w=w.split("&");for(var Y=0;Y<w.length;Y++){var oe=w[Y].indexOf("="),ye=null;if(0<=oe){var Ae=w[Y].substring(0,oe);ye=w[Y].substring(oe+1)}else Ae=w[Y];q(Ae,ye?decodeURIComponent(ye.replace(/\+/g," ")):"")}}}function Ei(w){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,w instanceof Ei){this.h=w.h,Go(this,w.j),this.o=w.o,this.g=w.g,Ki(this,w.s),this.l=w.l;var q=w.i,Y=new Ti;Y.i=q.i,q.g&&(Y.g=new Map(q.g),Y.h=q.h),zr(this,Y),this.m=w.m}else w&&(q=String(w).match(dn))?(this.h=!1,Go(this,q[1]||"",!0),this.o=jt(q[2]||""),this.g=jt(q[3]||"",!0),Ki(this,q[4]),this.l=jt(q[5]||"",!0),zr(this,q[6]||"",!0),this.m=jt(q[7]||"")):(this.h=!1,this.i=new Ti(null,this.h))}Ei.prototype.toString=function(){var w=[],q=this.j;q&&w.push(Si(q,fs,!0),":");var Y=this.g;return(Y||q=="file")&&(w.push("//"),(q=this.o)&&w.push(Si(q,fs,!0),"@"),w.push(encodeURIComponent(String(Y)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),Y=this.s,Y!=null&&w.push(":",String(Y))),(Y=this.l)&&(this.g&&Y.charAt(0)!="/"&&w.push("/"),w.push(Si(Y,Y.charAt(0)=="/"?Ya:Ka,!0))),(Y=this.i.toString())&&w.push("?",Y),(Y=this.m)&&w.push("#",Si(Y,Yo)),w.join("")};function Tn(w){return new Ei(w)}function Go(w,q,Y){w.j=Y?jt(q,!0):q,w.j&&(w.j=w.j.replace(/:$/,""))}function Ki(w,q){if(q){if(q=Number(q),isNaN(q)||0>q)throw Error("Bad port number "+q);w.s=q}else w.s=null}function zr(w,q,Y){q instanceof Ti?(w.i=q,Yn(w.i,w.h)):(Y||(q=Si(q,Ko)),w.i=new Ti(q,w.h))}function Nt(w,q,Y){w.i.set(q,Y)}function Ur(w){return Nt(w,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),w}function jt(w,q){return w?q?decodeURI(w.replace(/%25/g,"%2525")):decodeURIComponent(w):""}function Si(w,q,Y){return typeof w=="string"?(w=encodeURI(w).replace(q,Ga),Y&&(w=w.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w):null}function Ga(w){return w=w.charCodeAt(0),"%"+(w>>4&15).toString(16)+(w&15).toString(16)}var fs=/[#\/\?@]/g,Ka=/[#\?:]/g,Ya=/[#\?]/g,Ko=/[#\?@]/g,Yo=/#/g;function Ti(w,q){this.h=this.g=null,this.i=w||null,this.j=!!q}function qn(w){w.g||(w.g=new Map,w.h=0,w.i&&yc(w.i,function(q,Y){w.add(decodeURIComponent(q.replace(/\+/g," ")),Y)}))}r=Ti.prototype,r.add=function(w,q){qn(this),this.i=null,w=dt(this,w);var Y=this.g.get(w);return Y||this.g.set(w,Y=[]),Y.push(q),this.h+=1,this};function Ai(w,q){qn(w),q=dt(w,q),w.g.has(q)&&(w.i=null,w.h-=w.g.get(q).length,w.g.delete(q))}function ii(w,q){return qn(w),q=dt(w,q),w.g.has(q)}r.forEach=function(w,q){qn(this),this.g.forEach(function(Y,oe){Y.forEach(function(ye){w.call(q,ye,oe,this)},this)},this)},r.na=function(){qn(this);const w=Array.from(this.g.values()),q=Array.from(this.g.keys()),Y=[];for(let oe=0;oe<q.length;oe++){const ye=w[oe];for(let Ae=0;Ae<ye.length;Ae++)Y.push(q[oe])}return Y},r.V=function(w){qn(this);let q=[];if(typeof w=="string")ii(this,w)&&(q=q.concat(this.g.get(dt(this,w))));else{w=Array.from(this.g.values());for(let Y=0;Y<w.length;Y++)q=q.concat(w[Y])}return q},r.set=function(w,q){return qn(this),this.i=null,w=dt(this,w),ii(this,w)&&(this.h-=this.g.get(w).length),this.g.set(w,[q]),this.h+=1,this},r.get=function(w,q){return w?(w=this.V(w),0<w.length?String(w[0]):q):q};function go(w,q,Y){Ai(w,q),0<Y.length&&(w.i=null,w.g.set(dt(w,q),x(Y)),w.h+=Y.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const w=[],q=Array.from(this.g.keys());for(var Y=0;Y<q.length;Y++){var oe=q[Y];const Ae=encodeURIComponent(String(oe)),He=this.V(oe);for(oe=0;oe<He.length;oe++){var ye=Ae;He[oe]!==""&&(ye+="="+encodeURIComponent(String(He[oe]))),w.push(ye)}}return this.i=w.join("&")};function dt(w,q){return q=String(q),w.j&&(q=q.toLowerCase()),q}function Yn(w,q){q&&!w.j&&(qn(w),w.i=null,w.g.forEach(function(Y,oe){var ye=oe.toLowerCase();oe!=ye&&(Ai(this,oe),go(this,ye,Y))},w)),w.j=q}function rn(w,q){const Y=new Bs;if(l.Image){const oe=new Image;oe.onload=v(_r,Y,"TestLoadImage: loaded",!0,q,oe),oe.onerror=v(_r,Y,"TestLoadImage: error",!1,q,oe),oe.onabort=v(_r,Y,"TestLoadImage: abort",!1,q,oe),oe.ontimeout=v(_r,Y,"TestLoadImage: timeout",!1,q,oe),l.setTimeout(function(){oe.ontimeout&&oe.ontimeout()},1e4),oe.src=w}else q(!1)}function vc(w,q){const Y=new Bs,oe=new AbortController,ye=setTimeout(()=>{oe.abort(),_r(Y,"TestPingServer: timeout",!1,q)},1e4);fetch(w,{signal:oe.signal}).then(Ae=>{clearTimeout(ye),Ae.ok?_r(Y,"TestPingServer: ok",!0,q):_r(Y,"TestPingServer: server error",!1,q)}).catch(()=>{clearTimeout(ye),_r(Y,"TestPingServer: error",!1,q)})}function _r(w,q,Y,oe,ye){try{ye&&(ye.onload=null,ye.onerror=null,ye.onabort=null,ye.ontimeout=null),oe(Y)}catch{}}function _c(){this.g=new ni}function Za(w,q,Y){const oe=Y||"";try{wt(w,function(ye,Ae){let He=ye;f(ye)&&(He=yr(ye)),q.push(oe+Ae+"="+encodeURIComponent(He))})}catch(ye){throw q.push(oe+"type="+encodeURIComponent("_badmap")),ye}}function Rr(w){this.l=w.Ub||null,this.j=w.eb||!1}E(Rr,qi),Rr.prototype.g=function(){return new qs(this.l,this.j)},Rr.prototype.i=function(w){return function(){return w}}({});function qs(w,q){kt.call(this),this.D=w,this.o=q,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(qs,kt),r=qs.prototype,r.open=function(w,q){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=w,this.A=q,this.readyState=1,cr(this)},r.send=function(w){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const q={headers:this.u,method:this.B,credentials:this.m,cache:void 0};w&&(q.body=w),(this.D||l).fetch(new Request(this.A,q)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,hn(this)),this.readyState=0},r.Sa=function(w){if(this.g&&(this.l=w,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=w.headers,this.readyState=2,cr(this)),this.g&&(this.readyState=3,cr(this),this.g)))if(this.responseType==="arraybuffer")w.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in w){if(this.j=w.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;yo(this)}else w.text().then(this.Ra.bind(this),this.ga.bind(this))};function yo(w){w.j.read().then(w.Pa.bind(w)).catch(w.ga.bind(w))}r.Pa=function(w){if(this.g){if(this.o&&w.value)this.response.push(w.value);else if(!this.o){var q=w.value?w.value:new Uint8Array(0);(q=this.v.decode(q,{stream:!w.done}))&&(this.response=this.responseText+=q)}w.done?hn(this):cr(this),this.readyState==3&&yo(this)}},r.Ra=function(w){this.g&&(this.response=this.responseText=w,hn(this))},r.Qa=function(w){this.g&&(this.response=w,hn(this))},r.ga=function(){this.g&&hn(this)};function hn(w){w.readyState=4,w.l=null,w.j=null,w.v=null,cr(w)}r.setRequestHeader=function(w,q){this.u.append(w,q)},r.getResponseHeader=function(w){return this.h&&this.h.get(w.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const w=[],q=this.h.entries();for(var Y=q.next();!Y.done;)Y=Y.value,w.push(Y[0]+": "+Y[1]),Y=q.next();return w.join(`\r
`)};function cr(w){w.onreadystatechange&&w.onreadystatechange.call(w)}Object.defineProperty(qs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(w){this.m=w?"include":"same-origin"}});function ms(w){let q="";return U(w,function(Y,oe){q+=oe,q+=":",q+=Y,q+=`\r
`}),q}function Hs(w,q,Y){e:{for(oe in Y){var oe=!1;break e}oe=!0}oe||(Y=ms(Y),typeof w=="string"?Y!=null&&encodeURIComponent(String(Y)):Nt(w,q,Y))}function An(w){kt.call(this),this.headers=new Map,this.o=w||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(An,kt);var Ou=/^https?$/i,Zo=["POST","PUT"];r=An.prototype,r.Ha=function(w){this.J=w},r.ea=function(w,q,Y,oe){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+w);q=q?q.toUpperCase():"GET",this.D=w,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Pr.g(),this.v=this.o?ho(this.o):ho(Pr),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(q,String(w),!0),this.B=!1}catch(Ae){Qo(this,Ae);return}if(w=Y||"",Y=new Map(this.headers),oe)if(Object.getPrototypeOf(oe)===Object.prototype)for(var ye in oe)Y.set(ye,oe[ye]);else if(typeof oe.keys=="function"&&typeof oe.get=="function")for(const Ae of oe.keys())Y.set(Ae,oe.get(Ae));else throw Error("Unknown input type for opt_headers: "+String(oe));oe=Array.from(Y.keys()).find(Ae=>Ae.toLowerCase()=="content-type"),ye=l.FormData&&w instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Zo,q,void 0))||oe||ye||Y.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ae,He]of Y)this.g.setRequestHeader(Ae,He);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{xr(this),this.u=!0,this.g.send(w),this.u=!1}catch(Ae){Qo(this,Ae)}};function Qo(w,q){w.h=!1,w.g&&(w.j=!0,w.g.abort(),w.j=!1),w.l=q,w.m=5,Xo(w),si(w)}function Xo(w){w.A||(w.A=!0,Ft(w,"complete"),Ft(w,"error"))}r.abort=function(w){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=w||7,Ft(this,"complete"),Ft(this,"abort"),si(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),si(this,!0)),An.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?Dt(this):this.bb())},r.bb=function(){Dt(this)};function Dt(w){if(w.h&&typeof o<"u"&&(!w.v[1]||nr(w)!=4||w.Z()!=2)){if(w.u&&nr(w)==4)cs(w.Ea,0,w);else if(Ft(w,"readystatechange"),nr(w)==4){w.h=!1;try{const He=w.Z();e:switch(He){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var q=!0;break e;default:q=!1}var Y;if(!(Y=q)){var oe;if(oe=He===0){var ye=String(w.D).match(dn)[1]||null;!ye&&l.self&&l.self.location&&(ye=l.self.location.protocol.slice(0,-1)),oe=!Ou.test(ye?ye.toLowerCase():"")}Y=oe}if(Y)Ft(w,"complete"),Ft(w,"success");else{w.m=6;try{var Ae=2<nr(w)?w.g.statusText:""}catch{Ae=""}w.l=Ae+" ["+w.Z()+"]",Xo(w)}}finally{si(w)}}}}function si(w,q){if(w.g){xr(w);const Y=w.g,oe=w.v[0]?()=>{}:null;w.g=null,w.v=null,q||Ft(w,"ready");try{Y.onreadystatechange=oe}catch{}}}function xr(w){w.I&&(l.clearTimeout(w.I),w.I=null)}r.isActive=function(){return!!this.g};function nr(w){return w.g?w.g.readyState:0}r.Z=function(){try{return 2<nr(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(w){if(this.g){var q=this.g.responseText;return w&&q.indexOf(w)==0&&(q=q.substring(w.length)),vi(q)}};function Qa(w){try{if(!w.g)return null;if("response"in w.g)return w.g.response;switch(w.H){case"":case"text":return w.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in w.g)return w.g.mozResponseArrayBuffer}return null}catch{return null}}function Xa(w){const q={};w=(w.g&&2<=nr(w)&&w.g.getAllResponseHeaders()||"").split(`\r
`);for(let oe=0;oe<w.length;oe++){if(N(w[oe]))continue;var Y=C(w[oe]);const ye=Y[0];if(Y=Y[1],typeof Y!="string")continue;Y=Y.trim();const Ae=q[ye]||[];q[ye]=Ae,Ae.push(Y)}P(q,function(oe){return oe.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ni(w,q,Y){return Y&&Y.internalChannelParams&&Y.internalChannelParams[w]||q}function xc(w){this.Aa=0,this.i=[],this.j=new Bs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ni("failFast",!1,w),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ni("baseRetryDelayMs",5e3,w),this.cb=Ni("retryDelaySeedMs",1e4,w),this.Wa=Ni("forwardChannelMaxRetries",2,w),this.wa=Ni("forwardChannelRequestTimeoutMs",2e4,w),this.pa=w&&w.xmlHttpFactory||void 0,this.Xa=w&&w.Tb||void 0,this.Ca=w&&w.useFetchStreams||!1,this.L=void 0,this.J=w&&w.supportsCrossDomainXhr||!1,this.K="",this.h=new Wi(w&&w.concurrentRequestLimit),this.Da=new _c,this.P=w&&w.fastHandshake||!1,this.O=w&&w.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=w&&w.Rb||!1,w&&w.xa&&this.j.xa(),w&&w.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&w&&w.detectBufferingProxy||!1,this.ja=void 0,w&&w.longPollingTimeout&&0<w.longPollingTimeout&&(this.ja=w.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=xc.prototype,r.la=8,r.G=1,r.connect=function(w,q,Y,oe){bn(0),this.W=w,this.H=q||{},Y&&oe!==void 0&&(this.H.OSID=Y,this.H.OAID=oe),this.F=this.X,this.I=rl(this,null,this.W),Ii(this)};function rr(w){if(Ja(w),w.G==3){var q=w.U++,Y=Tn(w.I);if(Nt(Y,"SID",w.K),Nt(Y,"RID",q),Nt(Y,"TYPE","terminate"),$s(w,Y),q=new Cr(w,w.j,q),q.L=2,q.v=Ur(Tn(Y)),Y=!1,l.navigator&&l.navigator.sendBeacon)try{Y=l.navigator.sendBeacon(q.v.toString(),"")}catch{}!Y&&l.Image&&(new Image().src=q.v,Y=!0),Y||(q.g=Mu(q.j,null),q.g.ea(q.v)),q.F=Date.now(),Pt(q)}Du(w)}function Yi(w){w.g&&(el(w),w.g.cancel(),w.g=null)}function Ja(w){Yi(w),w.u&&(l.clearTimeout(w.u),w.u=null),nl(w),w.h.cancel(),w.s&&(typeof w.s=="number"&&l.clearTimeout(w.s),w.s=null)}function Ii(w){if(!lr(w.h)&&!w.s){w.s=!0;var q=w.Ga;se||G(),ie||(se(),ie=!0),re.add(q,w),w.B=0}}function gh(w,q){return mo(w.h)>=w.h.j-(w.s?1:0)?!1:w.s?(w.i=q.D.concat(w.i),!0):w.G==1||w.G==2||w.B>=(w.Va?0:w.Wa)?!1:(w.s=Br(g(w.Ga,w,q),bc(w,w.B)),w.B++,!0)}r.Ga=function(w){if(this.s)if(this.s=null,this.G==1){if(!w){this.U=Math.floor(1e5*Math.random()),w=this.U++;const ye=new Cr(this,this.j,w);let Ae=this.o;if(this.S&&(Ae?(Ae=k(Ae),O(Ae,this.S)):Ae=this.S),this.m!==null||this.O||(ye.H=Ae,Ae=null),this.P)e:{for(var q=0,Y=0;Y<this.i.length;Y++){t:{var oe=this.i[Y];if("__data__"in oe.map&&(oe=oe.map.__data__,typeof oe=="string")){oe=oe.length;break t}oe=void 0}if(oe===void 0)break;if(q+=oe,4096<q){q=Y;break e}if(q===4096||Y===this.i.length-1){q=Y+1;break e}}q=1e3}else q=1e3;q=Ws(this,ye,q),Y=Tn(this.I),Nt(Y,"RID",w),Nt(Y,"CVER",22),this.D&&Nt(Y,"X-HTTP-Session-Id",this.D),$s(this,Y),Ae&&(this.O?q="headers="+encodeURIComponent(String(ms(Ae)))+"&"+q:this.m&&Hs(Y,this.m,Ae)),un(this.h,ye),this.Ua&&Nt(Y,"TYPE","init"),this.P?(Nt(Y,"$req",q),Nt(Y,"SID","null"),ye.T=!0,pe(ye,Y,null)):pe(ye,Y,q),this.G=2}}else this.G==3&&(w?jr(this,w):this.i.length==0||lr(this.h)||jr(this))};function jr(w,q){var Y;q?Y=q.l:Y=w.U++;const oe=Tn(w.I);Nt(oe,"SID",w.K),Nt(oe,"RID",Y),Nt(oe,"AID",w.T),$s(w,oe),w.m&&w.o&&Hs(oe,w.m,w.o),Y=new Cr(w,w.j,Y,w.B+1),w.m===null&&(Y.H=w.o),q&&(w.i=q.D.concat(w.i)),q=Ws(w,Y,1e3),Y.I=Math.round(.5*w.wa)+Math.round(.5*w.wa*Math.random()),un(w.h,Y),pe(Y,oe,q)}function $s(w,q){w.H&&U(w.H,function(Y,oe){Nt(q,oe,Y)}),w.l&&wt({},function(Y,oe){Nt(q,oe,Y)})}function Ws(w,q,Y){Y=Math.min(w.i.length,Y);var oe=w.l?g(w.l.Na,w.l,w):null;e:{var ye=w.i;let Ae=-1;for(;;){const He=["count="+Y];Ae==-1?0<Y?(Ae=ye[0].g,He.push("ofs="+Ae)):Ae=0:He.push("ofs="+Ae);let nn=!0;for(let Hn=0;Hn<Y;Hn++){let Ht=ye[Hn].g;const sn=ye[Hn].map;if(Ht-=Ae,0>Ht)Ae=Math.max(0,ye[Hn].g-100),nn=!1;else try{Za(sn,He,"req"+Ht+"_")}catch{oe&&oe(sn)}}if(nn){oe=He.join("&");break e}}}return w=w.i.splice(0,Y),q.D=w,oe}function qr(w){if(!w.g&&!w.u){w.Y=1;var q=w.Fa;se||G(),ie||(se(),ie=!0),re.add(q,w),w.v=0}}function Jo(w){return w.g||w.u||3<=w.v?!1:(w.Y++,w.u=Br(g(w.Fa,w),bc(w,w.v)),w.v++,!0)}r.Fa=function(){if(this.u=null,tl(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var w=2*this.R;this.j.info("BP detection timer enabled: "+w),this.A=Br(g(this.ab,this),w)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,bn(10),Yi(this),tl(this))};function el(w){w.A!=null&&(l.clearTimeout(w.A),w.A=null)}function tl(w){w.g=new Cr(w,w.j,"rpc",w.Y),w.m===null&&(w.g.H=w.o),w.g.O=0;var q=Tn(w.qa);Nt(q,"RID","rpc"),Nt(q,"SID",w.K),Nt(q,"AID",w.T),Nt(q,"CI",w.F?"0":"1"),!w.F&&w.ja&&Nt(q,"TO",w.ja),Nt(q,"TYPE","xmlhttp"),$s(w,q),w.m&&w.o&&Hs(q,w.m,w.o),w.L&&(w.g.I=w.L);var Y=w.g;w=w.ia,Y.L=1,Y.v=Ur(Tn(q)),Y.m=null,Y.P=!0,De(Y,w)}r.Za=function(){this.C!=null&&(this.C=null,Yi(this),Jo(this),bn(19))};function nl(w){w.C!=null&&(l.clearTimeout(w.C),w.C=null)}function ea(w,q){var Y=null;if(w.g==q){nl(w),el(w),w.g=null;var oe=2}else if(At(w.h,q))Y=q.D,Wo(w.h,q),oe=1;else return;if(w.G!=0){if(q.o)if(oe==1){Y=q.m?q.m.length:0,q=Date.now()-q.F;var ye=w.B;oe=vn(),Ft(oe,new Vs(oe,Y)),Ii(w)}else qr(w);else if(ye=q.s,ye==3||ye==0&&0<q.X||!(oe==1&&gh(w,q)||oe==2&&Jo(w)))switch(Y&&0<Y.length&&(q=w.h,q.i=q.i.concat(Y)),ye){case 1:Gs(w,5);break;case 4:Gs(w,10);break;case 3:Gs(w,6);break;default:Gs(w,2)}}}function bc(w,q){let Y=w.Ta+Math.floor(Math.random()*w.cb);return w.isActive()||(Y*=2),Y*q}function Gs(w,q){if(w.j.info("Error code "+q),q==2){var Y=g(w.fb,w),oe=w.Xa;const ye=!oe;oe=new Ei(oe||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Go(oe,"https"),Ur(oe),ye?rn(oe.toString(),Y):vc(oe.toString(),Y)}else bn(2);w.G=0,w.l&&w.l.sa(q),Du(w),Ja(w)}r.fb=function(w){w?(this.j.info("Successfully pinged google.com"),bn(2)):(this.j.info("Failed to ping google.com"),bn(1))};function Du(w){if(w.G=0,w.ka=[],w.l){const q=Us(w.h);(q.length!=0||w.i.length!=0)&&(b(w.ka,q),b(w.ka,w.i),w.h.i.length=0,x(w.i),w.i.length=0),w.l.ra()}}function rl(w,q,Y){var oe=Y instanceof Ei?Tn(Y):new Ei(Y);if(oe.g!="")q&&(oe.g=q+"."+oe.g),Ki(oe,oe.s);else{var ye=l.location;oe=ye.protocol,q=q?q+"."+ye.hostname:ye.hostname,ye=+ye.port;var Ae=new Ei(null);oe&&Go(Ae,oe),q&&(Ae.g=q),ye&&Ki(Ae,ye),Y&&(Ae.l=Y),oe=Ae}return Y=w.D,q=w.ya,Y&&q&&Nt(oe,Y,q),Nt(oe,"VER",w.la),$s(w,oe),oe}function Mu(w,q,Y){if(q&&!w.J)throw Error("Can't create secondary domain capable XhrIo object.");return q=w.Ca&&!w.pa?new An(new Rr({eb:Y})):new An(w.pa),q.Ha(w.J),q}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function il(){}r=il.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function ta(){}ta.prototype.g=function(w,q){return new ir(w,q)};function ir(w,q){kt.call(this),this.g=new xc(q),this.l=w,this.h=q&&q.messageUrlParams||null,w=q&&q.messageHeaders||null,q&&q.clientProtocolHeaderRequired&&(w?w["X-Client-Protocol"]="webchannel":w={"X-Client-Protocol":"webchannel"}),this.g.o=w,w=q&&q.initMessageHeaders||null,q&&q.messageContentType&&(w?w["X-WebChannel-Content-Type"]=q.messageContentType:w={"X-WebChannel-Content-Type":q.messageContentType}),q&&q.va&&(w?w["X-WebChannel-Client-Profile"]=q.va:w={"X-WebChannel-Client-Profile":q.va}),this.g.S=w,(w=q&&q.Sb)&&!N(w)&&(this.g.m=w),this.v=q&&q.supportsCrossDomainXhr||!1,this.u=q&&q.sendRawJson||!1,(q=q&&q.httpSessionIdParam)&&!N(q)&&(this.g.D=q,w=this.h,w!==null&&q in w&&(w=this.h,q in w&&delete w[q])),this.j=new Hr(this)}E(ir,kt),ir.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ir.prototype.close=function(){rr(this.g)},ir.prototype.o=function(w){var q=this.g;if(typeof w=="string"){var Y={};Y.__data__=w,w=Y}else this.u&&(Y={},Y.__data__=yr(w),w=Y);q.i.push(new _n(q.Ya++,w)),q.G==3&&Ii(q)},ir.prototype.N=function(){this.g.l=null,delete this.j,rr(this.g),delete this.g,ir.aa.N.call(this)};function ps(w){ri.call(this),w.__headers__&&(this.headers=w.__headers__,this.statusCode=w.__status__,delete w.__headers__,delete w.__status__);var q=w.__sm__;if(q){e:{for(const Y in q){w=Y;break e}w=void 0}(this.i=w)&&(w=this.i,q=q!==null&&w in q?q[w]:void 0),this.data=q}else this.data=w}E(ps,ri);function Lu(){xi.call(this),this.status=1}E(Lu,xi);function Hr(w){this.g=w}E(Hr,il),Hr.prototype.ua=function(){Ft(this.g,"a")},Hr.prototype.ta=function(w){Ft(this.g,new ps(w))},Hr.prototype.sa=function(w){Ft(this.g,new Lu)},Hr.prototype.ra=function(){Ft(this.g,"b")},ta.prototype.createWebChannel=ta.prototype.g,ir.prototype.send=ir.prototype.o,ir.prototype.open=ir.prototype.m,ir.prototype.close=ir.prototype.close,CP=function(){return new ta},kP=function(){return vn()},PP=bi,ax={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},hs.NO_ERROR=0,hs.TIMEOUT=8,hs.HTTP_ERROR=6,gg=hs,vr.COMPLETE="complete",IP=vr,_i.EventType=er,er.OPEN="a",er.CLOSE="b",er.ERROR="c",er.MESSAGE="d",kt.prototype.listen=kt.prototype.K,gf=_i,An.prototype.listenOnce=An.prototype.L,An.prototype.getLastError=An.prototype.Ka,An.prototype.getLastErrorCode=An.prototype.Ba,An.prototype.getStatus=An.prototype.Z,An.prototype.getResponseJson=An.prototype.Oa,An.prototype.getResponseText=An.prototype.oa,An.prototype.send=An.prototype.ea,An.prototype.setWithCredentials=An.prototype.Ha,NP=An}).apply(typeof Fp<"u"?Fp:typeof self<"u"?self:typeof window<"u"?window:{});const kS="@firebase/firestore",CS="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tr=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Tr.UNAUTHENTICATED=new Tr(null),Tr.GOOGLE_CREDENTIALS=new Tr("google-credentials-uid"),Tr.FIRST_PARTY=new Tr("first-party-uid"),Tr.MOCK_USER=new Tr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nh="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const au=new ob("@firebase/firestore");function _d(){return au.logLevel}function je(r,...e){if(au.logLevel<=$t.DEBUG){const t=e.map(_b);au.debug(`Firestore (${nh}): ${r}`,...t)}}function Qn(r,...e){if(au.logLevel<=$t.ERROR){const t=e.map(_b);au.error(`Firestore (${nh}): ${r}`,...t)}}function lu(r,...e){if(au.logLevel<=$t.WARN){const t=e.map(_b);au.warn(`Firestore (${nh}): ${r}`,...t)}}function _b(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ze(r,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,RP(r,n,t)}function RP(r,e,t){let n=`FIRESTORE (${nh}) INTERNAL ASSERTION FAILED: ${e} (ID: ${r.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw Qn(n),new Error(n)}function rt(r,e,t,n){let i="Unexpected state";typeof t=="string"?i=t:n=t,r||RP(e,i,n)}function Je(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ve extends Ma{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ps{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jP{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class MD{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Tr.UNAUTHENTICATED))}shutdown(){}}class LD{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class FD{constructor(e){this.t=e,this.currentUser=Tr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){rt(this.o===void 0,42304);let n=this.i;const i=d=>this.i!==n?(n=this.i,t(d)):Promise.resolve();let s=new Ps;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new Ps,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const d=s;e.enqueueRetryable(async()=>{await d.promise,await i(this.currentUser)})},l=d=>{je("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(d=>l(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?l(d):(je("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new Ps)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(je("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(rt(typeof n.accessToken=="string",31837,{l:n}),new jP(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return rt(e===null||typeof e=="string",2055,{h:e}),new Tr(e)}}class VD{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Tr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class BD{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new VD(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Tr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class RS{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class zD{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,di(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){rt(this.o===void 0,3512);const n=s=>{s.error!=null&&je("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,je("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{je("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):je("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new RS(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(rt(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new RS(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UD(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OP(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=UD(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+=e.charAt(i[s]%62))}return n}}function Et(r,e){return r<e?-1:r>e?1:0}function lx(r,e){let t=0;for(;t<r.length&&t<e.length;){const n=r.codePointAt(t),i=e.codePointAt(t);if(n!==i){if(n<128&&i<128)return Et(n,i);{const s=OP(),o=qD(s.encode(jS(r,t)),s.encode(jS(e,t)));return o!==0?o:Et(n,i)}}t+=n>65535?2:1}return Et(r.length,e.length)}function jS(r,e){return r.codePointAt(e)>65535?r.substring(e,e+2):r.substring(e,e+1)}function qD(r,e){for(let t=0;t<r.length&&t<e.length;++t)if(r[t]!==e[t])return Et(r[t],e[t]);return Et(r.length,e.length)}function Dd(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}function MP(r){return r+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OS=-62135596800,DS=1e6;class Ot{static now(){return Ot.fromMillis(Date.now())}static fromDate(e){return Ot.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*DS);return new Ot(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ve(Ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ve(Ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<OS)throw new Ve(Ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ve(Ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/DS}_compareTo(e){return this.seconds===e.seconds?Et(this.nanoseconds,e.nanoseconds):Et(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-OS;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class at{static fromTimestamp(e){return new at(e)}static min(){return new at(new Ot(0,0))}static max(){return new at(new Ot(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cx="__name__";class Po{constructor(e,t,n){t===void 0?t=0:t>e.length&&Ze(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&Ze(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Po.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Po?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const s=Po.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return Et(e.length,t.length)}static compareSegments(e,t){const n=Po.isNumericId(e),i=Po.isNumericId(t);return n&&!i?-1:!n&&i?1:n&&i?Po.extractNumericId(e).compare(Po.extractNumericId(t)):lx(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Kl.fromString(e.substring(4,e.length-2))}}class Jt extends Po{construct(e,t,n){return new Jt(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ve(Ne.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new Jt(t)}static emptyPath(){return new Jt([])}}const HD=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Un extends Po{construct(e,t,n){return new Un(e,t,n)}static isValidIdentifier(e){return HD.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Un.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===cx}static keyField(){return new Un([cx])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(n.length===0)throw new Ve(Ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new Ve(Ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[i+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new Ve(Ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=d,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(n+=l,i++):(s(),i++)}if(s(),o)throw new Ve(Ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Un(t)}static emptyPath(){return new Un([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e){this.path=e}static fromPath(e){return new $e(Jt.fromString(e))}static fromName(e){return new $e(Jt.fromString(e).popFirst(5))}static empty(){return new $e(Jt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Jt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return Jt.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new $e(new Jt(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Md=-1;class qg{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}}function ux(r){return r.fields.find(e=>e.kind===2)}function qc(r){return r.fields.filter(e=>e.kind!==2)}qg.UNKNOWN_ID=-1;class yg{constructor(e,t){this.fieldPath=e,this.kind=t}}class Kf{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Kf(0,os.min())}}function LP(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=at.fromTimestamp(n===1e9?new Ot(t+1,0):new Ot(t,n));return new os(i,$e.empty(),e)}function FP(r){return new os(r.readTime,r.key,Md)}class os{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new os(at.min(),$e.empty(),Md)}static max(){return new os(at.max(),$e.empty(),Md)}}function xb(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=$e.comparator(r.documentKey,e.documentKey),t!==0?t:Et(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VP="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class BP{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uc(r){if(r.code!==Ne.FAILED_PRECONDITION||r.message!==VP)throw r;je("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ze(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new _e((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof _e?t:_e.resolve(t)}catch(t){return _e.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):_e.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):_e.reject(t)}static resolve(e){return new _e((t,n)=>{t(e)})}static reject(e){return new _e((t,n)=>{n(e)})}static waitFor(e){return new _e((t,n)=>{let i=0,s=0,o=!1;e.forEach(l=>{++i,l.next(()=>{++s,o&&s===i&&t()},d=>n(d))}),o=!0,s===i&&t()})}static or(e){let t=_e.resolve(!1);for(const n of e)t=t.next(i=>i?_e.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,s)=>{n.push(t.call(this,i,s))}),this.waitFor(n)}static mapArray(e,t){return new _e((n,i)=>{const s=e.length,o=new Array(s);let l=0;for(let d=0;d<s;d++){const f=d;t(e[f]).next(m=>{o[f]=m,++l,l===s&&n(o)},m=>i(m))}})}static doWhile(e,t){return new _e((n,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):n()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ns="SimpleDb";class ky{static open(e,t,n,i){try{return new ky(t,e.transaction(i,n))}catch(s){throw new Pf(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new Ps,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Pf(e,t.error)):this.S.resolve()},this.transaction.onerror=n=>{const i=bb(n.target.error);this.S.reject(new Pf(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(je(ns,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new WD(t)}}class Yl{static delete(e){return je(ns,"Removing database:",e),Gc(k4().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!F4())return!1;if(Yl.F())return!0;const e=pr(),t=Yl.M(e),n=0<t&&t<10,i=zP(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.B=n,this.L=null,Yl.M(pr())===12.2&&Qn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(je(ns,"Opening database:",this.name),this.db=await new Promise((t,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;t(o)},i.onblocked=()=>{n(new Pf(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?n(new Ve(Ne.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?n(new Ve(Ne.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):n(new Pf(e,o))},i.onupgradeneeded=s=>{je(ns,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;if(this.L!==null&&this.L!==s.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${s.oldVersion}, event.newVersion=${s.newVersion}, db.version=${o.version}`);this.B.q(o,i.transaction,s.oldVersion,this.version).next(()=>{je(ns,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",t=>{const n=t.target;this.L=n.version},{passive:!0})),this.$&&(this.db.onversionchange=t=>this.$(t)),this.db}U(e){this.$=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,i){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.k(e);const l=ky.open(this.db,e,s?"readonly":"readwrite",n),d=i(l).next(f=>(l.v(),f)).catch(f=>(l.abort(f),_e.reject(f))).toPromise();return d.catch(()=>{}),await l.D,d}catch(l){const d=l,f=d.name!=="FirebaseError"&&o<3;if(je(ns,"Transaction failed with error:",d.message,"Retrying:",f),this.close(),!f)return Promise.reject(d)}}}close(){this.db&&this.db.close(),this.db=void 0}}function zP(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class $D{constructor(e){this.K=e,this.W=!1,this.G=null}get isDone(){return this.W}get j(){return this.G}set cursor(e){this.K=e}done(){this.W=!0}H(e){this.G=e}delete(){return Gc(this.K.delete())}}class Pf extends Ve{constructor(e,t){super(Ne.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function dc(r){return r.name==="IndexedDbTransactionError"}class WD{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(je(ns,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(je(ns,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Gc(n)}add(e){return je(ns,"ADD",this.store.name,e,e),Gc(this.store.add(e))}get(e){return Gc(this.store.get(e)).next(t=>(t===void 0&&(t=null),je(ns,"GET",this.store.name,e,t),t))}delete(e){return je(ns,"DELETE",this.store.name,e),Gc(this.store.delete(e))}count(){return je(ns,"COUNT",this.store.name),Gc(this.store.count())}J(e,t){const n=this.options(e,t),i=n.index?this.store.index(n.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(n.range);return new _e((o,l)=>{s.onerror=d=>{l(d.target.error)},s.onsuccess=d=>{o(d.target.result)}})}{const s=this.cursor(n),o=[];return this.Y(s,(l,d)=>{o.push(d)}).next(()=>o)}}Z(e,t){const n=this.store.getAll(e,t===null?void 0:t);return new _e((i,s)=>{n.onerror=o=>{s(o.target.error)},n.onsuccess=o=>{i(o.target.result)}})}X(e,t){je(ns,"DELETE ALL",this.store.name);const n=this.options(e,t);n.ee=!1;const i=this.cursor(n);return this.Y(i,(s,o,l)=>l.delete())}te(e,t){let n;t?n=e:(n={},t=e);const i=this.cursor(n);return this.Y(i,t)}ne(e){const t=this.cursor({});return new _e((n,i)=>{t.onerror=s=>{const o=bb(s.target.error);i(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():n()}):n()}})}Y(e,t){const n=[];return new _e((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void i();const d=new $D(l),f=t(l.primaryKey,l.value,d);if(f instanceof _e){const m=f.catch(p=>(d.done(),_e.reject(p)));n.push(m)}d.isDone?i():d.j===null?l.continue():l.continue(d.j)}}).next(()=>_e.waitFor(n))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.ee?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Gc(r){return new _e((e,t)=>{r.onsuccess=n=>{const i=n.target.result;e(i)},r.onerror=n=>{const i=bb(n.target.error);t(i)}})}let MS=!1;function bb(r){const e=Yl.M(pr());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(r.message.indexOf(t)>=0){const n=new Ve("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return MS||(MS=!0,setTimeout(()=>{throw n},0)),n}}return r}const kf="IndexBackfiller";class GD{constructor(e,t){this.asyncQueue=e,this.re=t,this.task=null}start(){this.ie(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ie(e){je(kf,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.re.se();je(kf,`Documents written: ${t}`)}catch(t){dc(t)?je(kf,"Ignoring IndexedDB error during index backfill: ",t):await uc(t)}await this.ie(6e4)})}}class KD{constructor(e,t){this.localStore=e,this.persistence=t}async se(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.oe(t,e))}oe(e,t){const n=new Set;let i=t,s=!0;return _e.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!n.has(o))return je(kf,`Processing collection: ${o}`),this._e(e,o,i).next(l=>{i-=l,n.add(o)});s=!1})).next(()=>t-i)}_e(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,n).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ae(i,s)).next(l=>(je(kf,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l))).next(()=>o.size)}))}ae(e,t){let n=e;return t.changes.forEach((i,s)=>{const o=FP(s);xb(o,n)>0&&(n=o)}),new os(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ue(n),this.ce=n=>t.writeSequenceNumber(n))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}Bi.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eu=-1;function Am(r){return r==null}function Yf(r){return r===0&&1/r==-1/0}function UP(r){return typeof r=="number"&&Number.isInteger(r)&&!Yf(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hg="";function ti(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=LS(e)),e=YD(r.get(t),e);return LS(e)}function YD(r,e){let t=e;const n=r.length;for(let i=0;i<n;i++){const s=r.charAt(i);switch(s){case"\0":t+="";break;case Hg:t+="";break;default:t+=s}}return t}function LS(r){return r+Hg+""}function Co(r){const e=r.length;if(rt(e>=2,64408,{path:r}),e===2)return rt(r.charAt(0)===Hg&&r.charAt(1)==="",56145,{path:r}),Jt.emptyPath();const t=e-2,n=[];let i="";for(let s=0;s<e;){const o=r.indexOf(Hg,s);switch((o<0||o>t)&&Ze(50515,{path:r}),r.charAt(o+1)){case"":const l=r.substring(s,o);let d;i.length===0?d=l:(i+=l,d=i,i=""),n.push(d);break;case"":i+=r.substring(s,o),i+="\0";break;case"":i+=r.substring(s,o+1);break;default:Ze(61167,{path:r})}s=o+2}return new Jt(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hc="remoteDocuments",Nm="owner",cd="owner",Zf="mutationQueues",ZD="userId",so="mutations",FS="batchId",Xc="userMutationsIndex",VS=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vg(r,e){return[r,ti(e)]}function qP(r,e,t){return[r,ti(e),t]}const QD={},Ld="documentMutations",$g="remoteDocumentsV14",XD=["prefixPath","collectionGroup","readTime","documentId"],_g="documentKeyIndex",JD=["prefixPath","collectionGroup","documentId"],HP="collectionGroupIndex",eM=["collectionGroup","readTime","prefixPath","documentId"],Qf="remoteDocumentGlobal",dx="remoteDocumentGlobalKey",Fd="targets",$P="queryTargetsIndex",tM=["canonicalId","targetId"],Vd="targetDocuments",nM=["targetId","path"],wb="documentTargetsIndex",rM=["path","targetId"],Wg="targetGlobalKey",tu="targetGlobal",Xf="collectionParents",iM=["collectionId","parent"],Bd="clientMetadata",sM="clientId",Cy="bundles",oM="bundleId",Ry="namedQueries",aM="name",Eb="indexConfiguration",lM="indexId",hx="collectionGroupIndex",cM="collectionGroup",Cf="indexState",uM=["indexId","uid"],WP="sequenceNumberIndex",dM=["uid","sequenceNumber"],Rf="indexEntries",hM=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],GP="documentKeyIndex",fM=["indexId","uid","orderedDocumentKey"],jy="documentOverlays",mM=["userId","collectionPath","documentId"],fx="collectionPathOverlayIndex",pM=["userId","collectionPath","largestBatchId"],KP="collectionGroupOverlayIndex",gM=["userId","collectionGroup","largestBatchId"],Sb="globals",yM="name",YP=[Zf,so,Ld,Hc,Fd,Nm,tu,Vd,Bd,Qf,Xf,Cy,Ry],vM=[...YP,jy],ZP=[Zf,so,Ld,$g,Fd,Nm,tu,Vd,Bd,Qf,Xf,Cy,Ry,jy],QP=ZP,Tb=[...QP,Eb,Cf,Rf],_M=Tb,XP=[...Tb,Sb],xM=XP;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mx extends BP{constructor(e,t){super(),this.he=e,this.currentSequenceNumber=t}}function gr(r,e){const t=Je(r);return Yl.N(t.he,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BS(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function hc(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function bM(r,e){const t=[];for(const n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.push(e(r[n],n,r));return t}function JP(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pn{constructor(e,t){this.comparator=e,this.root=t||Mr.EMPTY}insert(e,t){return new Pn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Mr.BLACK,null,null))}remove(e){return new Pn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Mr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vp(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vp(this.root,e,this.comparator,!0)}}class Vp{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Mr{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??Mr.RED,this.left=i??Mr.EMPTY,this.right=s??Mr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new Mr(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Mr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Mr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Mr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Mr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ze(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ze(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ze(27949);return e+(this.isRed()?0:1)}}Mr.EMPTY=null,Mr.RED=!0,Mr.BLACK=!1;Mr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ze(57766)}get value(){throw Ze(16141)}get color(){throw Ze(16727)}get left(){throw Ze(29726)}get right(){throw Ze(36894)}copy(e,t,n,i,s){return this}insert(e,t,n){return new Mr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gn{constructor(e){this.comparator=e,this.data=new Pn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new zS(this.data.getIterator())}getIteratorFrom(e){return new zS(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof gn)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new gn(this.comparator);return t.data=e,t}}class zS{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ud(r){return r.hasNext()?r.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(e){this.fields=e,e.sort(Un.comparator)}static empty(){return new zi([])}unionWith(e){let t=new gn(Un.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new zi(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Dd(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ek extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new ek("Invalid base64 string: "+s):s}}(e);return new Jn(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Jn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Et(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Jn.EMPTY_BYTE_STRING=new Jn("");const wM=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ca(r){if(rt(!!r,39018),typeof r=="string"){let e=0;const t=wM.exec(r);if(rt(!!t,46558,{timestamp:r}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:On(r.seconds),nanos:On(r.nanos)}}function On(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function Ra(r){return typeof r=="string"?Jn.fromBase64String(r):Jn.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tk="server_timestamp",nk="__type__",rk="__previous_value__",ik="__local_write_time__";function Oy(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[nk])===null||t===void 0?void 0:t.stringValue)===tk}function Dy(r){const e=r.mapValue.fields[rk];return Oy(e)?Dy(e):e}function Jf(r){const e=Ca(r.mapValue.fields[ik].timestampValue);return new Ot(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EM{constructor(e,t,n,i,s,o,l,d,f,m){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=d,this.useFetchStreams=f,this.isUsingEmulator=m}}const Gg="(default)";class cu{constructor(e,t){this.projectId=e,this.database=t||Gg}static empty(){return new cu("","")}get isDefaultDatabase(){return this.database===Gg}isEqual(e){return e instanceof cu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ab="__type__",sk="__max__",Bl={mapValue:{fields:{__type__:{stringValue:sk}}}},Nb="__vector__",zd="value",xg={nullValue:"NULL_VALUE"};function ec(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?Oy(r)?4:ok(r)?9007199254740991:My(r)?10:11:Ze(28295,{value:r})}function Lo(r,e){if(r===e)return!0;const t=ec(r);if(t!==ec(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return Jf(r).isEqual(Jf(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Ca(i.timestampValue),l=Ca(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(i,s){return Ra(i.bytesValue).isEqual(Ra(s.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,s){return On(i.geoPointValue.latitude)===On(s.geoPointValue.latitude)&&On(i.geoPointValue.longitude)===On(s.geoPointValue.longitude)}(r,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return On(i.integerValue)===On(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=On(i.doubleValue),l=On(s.doubleValue);return o===l?Yf(o)===Yf(l):isNaN(o)&&isNaN(l)}return!1}(r,e);case 9:return Dd(r.arrayValue.values||[],e.arrayValue.values||[],Lo);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(BS(o)!==BS(l))return!1;for(const d in o)if(o.hasOwnProperty(d)&&(l[d]===void 0||!Lo(o[d],l[d])))return!1;return!0}(r,e);default:return Ze(52216,{left:r})}}function em(r,e){return(r.values||[]).find(t=>Lo(t,e))!==void 0}function tc(r,e){if(r===e)return 0;const t=ec(r),n=ec(e);if(t!==n)return Et(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return Et(r.booleanValue,e.booleanValue);case 2:return function(s,o){const l=On(s.integerValue||s.doubleValue),d=On(o.integerValue||o.doubleValue);return l<d?-1:l>d?1:l===d?0:isNaN(l)?isNaN(d)?0:-1:1}(r,e);case 3:return US(r.timestampValue,e.timestampValue);case 4:return US(Jf(r),Jf(e));case 5:return lx(r.stringValue,e.stringValue);case 6:return function(s,o){const l=Ra(s),d=Ra(o);return l.compareTo(d)}(r.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),d=o.split("/");for(let f=0;f<l.length&&f<d.length;f++){const m=Et(l[f],d[f]);if(m!==0)return m}return Et(l.length,d.length)}(r.referenceValue,e.referenceValue);case 8:return function(s,o){const l=Et(On(s.latitude),On(o.latitude));return l!==0?l:Et(On(s.longitude),On(o.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return qS(r.arrayValue,e.arrayValue);case 10:return function(s,o){var l,d,f,m;const p=s.fields||{},g=o.fields||{},v=(l=p[zd])===null||l===void 0?void 0:l.arrayValue,E=(d=g[zd])===null||d===void 0?void 0:d.arrayValue,x=Et(((f=v==null?void 0:v.values)===null||f===void 0?void 0:f.length)||0,((m=E==null?void 0:E.values)===null||m===void 0?void 0:m.length)||0);return x!==0?x:qS(v,E)}(r.mapValue,e.mapValue);case 11:return function(s,o){if(s===Bl.mapValue&&o===Bl.mapValue)return 0;if(s===Bl.mapValue)return 1;if(o===Bl.mapValue)return-1;const l=s.fields||{},d=Object.keys(l),f=o.fields||{},m=Object.keys(f);d.sort(),m.sort();for(let p=0;p<d.length&&p<m.length;++p){const g=lx(d[p],m[p]);if(g!==0)return g;const v=tc(l[d[p]],f[m[p]]);if(v!==0)return v}return Et(d.length,m.length)}(r.mapValue,e.mapValue);default:throw Ze(23264,{Pe:t})}}function US(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return Et(r,e);const t=Ca(r),n=Ca(e),i=Et(t.seconds,n.seconds);return i!==0?i:Et(t.nanos,n.nanos)}function qS(r,e){const t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){const s=tc(t[i],n[i]);if(s)return s}return Et(t.length,n.length)}function Ud(r){return px(r)}function px(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const n=Ca(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return Ra(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return $e.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(const s of t.values||[])i?i=!1:n+=",",n+=px(s);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){const n=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of n)s?s=!1:i+=",",i+=`${o}:${px(t.fields[o])}`;return i+"}"}(r.mapValue):Ze(61005,{value:r})}function bg(r){switch(ec(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Dy(r);return e?16+bg(e):16;case 5:return 2*r.stringValue.length;case 6:return Ra(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,s)=>i+bg(s),0)}(r.arrayValue);case 10:case 11:return function(n){let i=0;return hc(n.fields,(s,o)=>{i+=s.length+bg(o)}),i}(r.mapValue);default:throw Ze(13486,{value:r})}}function uu(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function gx(r){return!!r&&"integerValue"in r}function tm(r){return!!r&&"arrayValue"in r}function HS(r){return!!r&&"nullValue"in r}function $S(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function wg(r){return!!r&&"mapValue"in r}function My(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[Ab])===null||t===void 0?void 0:t.stringValue)===Nb}function jf(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return hc(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=jf(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=jf(r.arrayValue.values[t]);return e}return Object.assign({},r)}function ok(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===sk}const ak={mapValue:{fields:{[Ab]:{stringValue:Nb},[zd]:{arrayValue:{}}}}};function SM(r){return"nullValue"in r?xg:"booleanValue"in r?{booleanValue:!1}:"integerValue"in r||"doubleValue"in r?{doubleValue:NaN}:"timestampValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in r?{stringValue:""}:"bytesValue"in r?{bytesValue:""}:"referenceValue"in r?uu(cu.empty(),$e.empty()):"geoPointValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in r?{arrayValue:{}}:"mapValue"in r?My(r)?ak:{mapValue:{}}:Ze(35942,{value:r})}function TM(r){return"nullValue"in r?{booleanValue:!1}:"booleanValue"in r?{doubleValue:NaN}:"integerValue"in r||"doubleValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in r?{stringValue:""}:"stringValue"in r?{bytesValue:""}:"bytesValue"in r?uu(cu.empty(),$e.empty()):"referenceValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in r?{arrayValue:{}}:"arrayValue"in r?ak:"mapValue"in r?My(r)?{mapValue:{}}:Bl:Ze(61959,{value:r})}function WS(r,e){const t=tc(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?-1:!r.inclusive&&e.inclusive?1:0}function GS(r,e){const t=tc(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?1:!r.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lr{constructor(e){this.value=e}static empty(){return new Lr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!wg(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=jf(t)}setAll(e){let t=Un.emptyPath(),n={},i=[];e.forEach((o,l)=>{if(!t.isImmediateParentOf(l)){const d=this.getFieldsMap(t);this.applyChanges(d,n,i),n={},i=[],t=l.popLast()}o?n[l.lastSegment()]=jf(o):i.push(l.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());wg(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Lo(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];wg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){hc(t,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new Lr(jf(this.value))}}function lk(r){const e=[];return hc(r.fields,(t,n)=>{const i=new Un([t]);if(wg(n)){const s=lk(n.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new zi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e,t,n,i,s,o,l){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Dn(e,0,at.min(),at.min(),at.min(),Lr.empty(),0)}static newFoundDocument(e,t,n,i){return new Dn(e,1,t,at.min(),n,i,0)}static newNoDocument(e,t){return new Dn(e,2,t,at.min(),at.min(),Lr.empty(),0)}static newUnknownDocument(e,t){return new Dn(e,3,t,at.min(),at.min(),Lr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(at.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Lr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Lr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=at.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Dn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Dn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nc{constructor(e,t){this.position=e,this.inclusive=t}}function KS(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const s=e[i],o=r.position[i];if(s.field.isKeyField()?n=$e.comparator($e.fromName(o.referenceValue),t.key):n=tc(o,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function YS(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!Lo(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nm{constructor(e,t="asc"){this.field=e,this.dir=t}}function AM(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ck=class{};class Wt extends ck{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new NM(e,t,n):t==="array-contains"?new kM(e,n):t==="in"?new pk(e,n):t==="not-in"?new CM(e,n):t==="array-contains-any"?new RM(e,n):new Wt(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new IM(e,n):new PM(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(tc(t,this.value)):t!==null&&ec(this.value)===ec(t)&&this.matchesComparison(tc(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ze(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class pn extends ck{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new pn(e,t)}matches(e){return qd(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function qd(r){return r.op==="and"}function yx(r){return r.op==="or"}function Ib(r){return uk(r)&&qd(r)}function uk(r){for(const e of r.filters)if(e instanceof pn)return!1;return!0}function vx(r){if(r instanceof Wt)return r.field.canonicalString()+r.op.toString()+Ud(r.value);if(Ib(r))return r.filters.map(e=>vx(e)).join(",");{const e=r.filters.map(t=>vx(t)).join(",");return`${r.op}(${e})`}}function dk(r,e){return r instanceof Wt?function(n,i){return i instanceof Wt&&n.op===i.op&&n.field.isEqual(i.field)&&Lo(n.value,i.value)}(r,e):r instanceof pn?function(n,i){return i instanceof pn&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,o,l)=>s&&dk(o,i.filters[l]),!0):!1}(r,e):void Ze(19439)}function hk(r,e){const t=r.filters.concat(e);return pn.create(t,r.op)}function fk(r){return r instanceof Wt?function(t){return`${t.field.canonicalString()} ${t.op} ${Ud(t.value)}`}(r):r instanceof pn?function(t){return t.op.toString()+" {"+t.getFilters().map(fk).join(" ,")+"}"}(r):"Filter"}class NM extends Wt{constructor(e,t,n){super(e,t,n),this.key=$e.fromName(n.referenceValue)}matches(e){const t=$e.comparator(e.key,this.key);return this.matchesComparison(t)}}class IM extends Wt{constructor(e,t){super(e,"in",t),this.keys=mk("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class PM extends Wt{constructor(e,t){super(e,"not-in",t),this.keys=mk("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function mk(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>$e.fromName(n.referenceValue))}class kM extends Wt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return tm(t)&&em(t.arrayValue,this.value)}}class pk extends Wt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&em(this.value.arrayValue,t)}}class CM extends Wt{constructor(e,t){super(e,"not-in",t)}matches(e){if(em(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!em(this.value.arrayValue,t)}}class RM extends Wt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!tm(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>em(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jM{constructor(e,t=null,n=[],i=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.Ie=null}}function _x(r,e=null,t=[],n=[],i=null,s=null,o=null){return new jM(r,e,t,n,i,s,o)}function du(r){const e=Je(r);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>vx(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Am(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Ud(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Ud(n)).join(",")),e.Ie=t}return e.Ie}function Im(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!AM(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!dk(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!YS(r.startAt,e.startAt)&&YS(r.endAt,e.endAt)}function Kg(r){return $e.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}function Yg(r,e){return r.filters.filter(t=>t instanceof Wt&&t.field.isEqual(e))}function ZS(r,e,t){let n=xg,i=!0;for(const s of Yg(r,e)){let o=xg,l=!0;switch(s.op){case"<":case"<=":o=SM(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=xg}WS({value:n,inclusive:i},{value:o,inclusive:l})<0&&(n=o,i=l)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){const o=t.position[s];WS({value:n,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(n=o,i=t.inclusive);break}}return{value:n,inclusive:i}}function QS(r,e,t){let n=Bl,i=!0;for(const s of Yg(r,e)){let o=Bl,l=!0;switch(s.op){case">=":case">":o=TM(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=Bl}GS({value:n,inclusive:i},{value:o,inclusive:l})>0&&(n=o,i=l)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){const o=t.position[s];GS({value:n,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(n=o,i=t.inclusive);break}}return{value:n,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Au{constructor(e,t=null,n=[],i=[],s=null,o="F",l=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=d,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function gk(r,e,t,n,i,s,o,l){return new Au(r,e,t,n,i,s,o,l)}function Pm(r){return new Au(r)}function XS(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function Pb(r){return r.collectionGroup!==null}function kd(r){const e=Je(r);if(e.Ee===null){e.Ee=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ee.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new gn(Un.comparator);return o.filters.forEach(d=>{d.getFlattenedFilters().forEach(f=>{f.isInequality()&&(l=l.add(f.field))})}),l})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ee.push(new nm(s,n))}),t.has(Un.keyField().canonicalString())||e.Ee.push(new nm(Un.keyField(),n))}return e.Ee}function is(r){const e=Je(r);return e.de||(e.de=yk(e,kd(r))),e.de}function OM(r){const e=Je(r);return e.Ae||(e.Ae=yk(e,r.explicitOrderBy)),e.Ae}function yk(r,e){if(r.limitType==="F")return _x(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new nm(i.field,s)});const t=r.endAt?new nc(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new nc(r.startAt.position,r.startAt.inclusive):null;return _x(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function xx(r,e){const t=r.filters.concat([e]);return new Au(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function Zg(r,e,t){return new Au(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function Ly(r,e){return Im(is(r),is(e))&&r.limitType===e.limitType}function vk(r){return`${du(is(r))}|lt:${r.limitType}`}function xd(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>fk(i)).join(", ")}]`),Am(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>Ud(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>Ud(i)).join(",")),`Target(${n})`}(is(r))}; limitType=${r.limitType})`}function km(r,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):$e.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(r,e)&&function(n,i){for(const s of kd(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(r,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(r,e)&&function(n,i){return!(n.startAt&&!function(o,l,d){const f=KS(o,l,d);return o.inclusive?f<=0:f<0}(n.startAt,kd(n),i)||n.endAt&&!function(o,l,d){const f=KS(o,l,d);return o.inclusive?f>=0:f>0}(n.endAt,kd(n),i))}(r,e)}function _k(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function xk(r){return(e,t)=>{let n=!1;for(const i of kd(r)){const s=DM(i,e,t);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function DM(r,e,t){const n=r.field.isKeyField()?$e.comparator(e.key,t.key):function(s,o,l){const d=o.data.field(s),f=l.data.field(s);return d!==null&&f!==null?tc(d,f):Ze(42886)}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return Ze(19790,{direction:r.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Va{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){hc(this.inner,(t,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return JP(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MM=new Pn($e.comparator);function rs(){return MM}const bk=new Pn($e.comparator);function yf(...r){let e=bk;for(const t of r)e=e.insert(t.key,t);return e}function wk(r){let e=bk;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Ro(){return Of()}function Ek(){return Of()}function Of(){return new Va(r=>r.toString(),(r,e)=>r.isEqual(e))}const LM=new Pn($e.comparator),FM=new gn($e.comparator);function zt(...r){let e=FM;for(const t of r)e=e.add(t);return e}const VM=new gn(Et);function kb(){return VM}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cb(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Yf(e)?"-0":e}}function Sk(r){return{integerValue:""+r}}function BM(r,e){return UP(e)?Sk(e):Cb(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{constructor(){this._=void 0}}function zM(r,e,t){return r instanceof Hd?function(i,s){const o={fields:{[nk]:{stringValue:tk},[ik]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&Oy(s)&&(s=Dy(s)),s&&(o.fields[rk]=s),{mapValue:o}}(t,e):r instanceof hu?Ak(r,e):r instanceof $d?Nk(r,e):function(i,s){const o=Tk(i,s),l=JS(o)+JS(i.Re);return gx(o)&&gx(i.Re)?Sk(l):Cb(i.serializer,l)}(r,e)}function UM(r,e,t){return r instanceof hu?Ak(r,e):r instanceof $d?Nk(r,e):t}function Tk(r,e){return r instanceof rm?function(n){return gx(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class Hd extends Fy{}class hu extends Fy{constructor(e){super(),this.elements=e}}function Ak(r,e){const t=Ik(e);for(const n of r.elements)t.some(i=>Lo(i,n))||t.push(n);return{arrayValue:{values:t}}}class $d extends Fy{constructor(e){super(),this.elements=e}}function Nk(r,e){let t=Ik(e);for(const n of r.elements)t=t.filter(i=>!Lo(i,n));return{arrayValue:{values:t}}}class rm extends Fy{constructor(e,t){super(),this.serializer=e,this.Re=t}}function JS(r){return On(r.integerValue||r.doubleValue)}function Ik(r){return tm(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rb{constructor(e,t){this.field=e,this.transform=t}}function qM(r,e){return r.field.isEqual(e.field)&&function(n,i){return n instanceof hu&&i instanceof hu||n instanceof $d&&i instanceof $d?Dd(n.elements,i.elements,Lo):n instanceof rm&&i instanceof rm?Lo(n.Re,i.Re):n instanceof Hd&&i instanceof Hd}(r.transform,e.transform)}class HM{constructor(e,t){this.version=e,this.transformResults=t}}class Mn{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Mn}static exists(e){return new Mn(void 0,e)}static updateTime(e){return new Mn(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Eg(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class Vy{}function Pk(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new ih(r.key,Mn.none()):new rh(r.key,r.data,Mn.none());{const t=r.data,n=Lr.empty();let i=new gn(Un.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?n.delete(s):n.set(s,o),i=i.add(s)}return new Ba(r.key,n,new zi(i.toArray()),Mn.none())}}function $M(r,e,t){r instanceof rh?function(i,s,o){const l=i.value.clone(),d=tT(i.fieldTransforms,s,o.transformResults);l.setAll(d),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(r,e,t):r instanceof Ba?function(i,s,o){if(!Eg(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=tT(i.fieldTransforms,s,o.transformResults),d=s.data;d.setAll(kk(i)),d.setAll(l),s.convertToFoundDocument(o.version,d).setHasCommittedMutations()}(r,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Df(r,e,t,n){return r instanceof rh?function(s,o,l,d){if(!Eg(s.precondition,o))return l;const f=s.value.clone(),m=nT(s.fieldTransforms,d,o);return f.setAll(m),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),null}(r,e,t,n):r instanceof Ba?function(s,o,l,d){if(!Eg(s.precondition,o))return l;const f=nT(s.fieldTransforms,d,o),m=o.data;return m.setAll(kk(s)),m.setAll(f),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(p=>p.field))}(r,e,t,n):function(s,o,l){return Eg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(r,e,t)}function WM(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),s=Tk(n.transform,i||null);s!=null&&(t===null&&(t=Lr.empty()),t.set(n.field,s))}return t||null}function eT(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Dd(n,i,(s,o)=>qM(s,o))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class rh extends Vy{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ba extends Vy{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function kk(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function tT(r,e,t){const n=new Map;rt(r.length===t.length,32656,{Ve:t.length,me:r.length});for(let i=0;i<t.length;i++){const s=r[i],o=s.transform,l=e.data.field(s.field);n.set(s.field,UM(o,l,t[i]))}return n}function nT(r,e,t){const n=new Map;for(const i of r){const s=i.transform,o=t.data.field(i.field);n.set(i.field,zM(s,o,e))}return n}class ih extends Vy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class jb extends Vy{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ob{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&$M(s,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Df(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Df(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Ek();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(i.key)?null:l;const d=Pk(o,l);d!==null&&n.set(i.key,d),o.isValidDocument()||o.convertToNoDocument(at.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),zt())}isEqual(e){return this.batchId===e.batchId&&Dd(this.mutations,e.mutations,(t,n)=>eT(t,n))&&Dd(this.baseMutations,e.baseMutations,(t,n)=>eT(t,n))}}class Db{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){rt(e.mutations.length===n.length,58842,{fe:e.mutations.length,ge:n.length});let i=function(){return LM}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,n[o].version);return new Db(e,t,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mb{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GM{constructor(e,t,n){this.alias=e,this.aggregateType=t,this.fieldPath=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KM{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ar,Kt;function Ck(r){switch(r){case Ne.OK:return Ze(64938);case Ne.CANCELLED:case Ne.UNKNOWN:case Ne.DEADLINE_EXCEEDED:case Ne.RESOURCE_EXHAUSTED:case Ne.INTERNAL:case Ne.UNAVAILABLE:case Ne.UNAUTHENTICATED:return!1;case Ne.INVALID_ARGUMENT:case Ne.NOT_FOUND:case Ne.ALREADY_EXISTS:case Ne.PERMISSION_DENIED:case Ne.FAILED_PRECONDITION:case Ne.ABORTED:case Ne.OUT_OF_RANGE:case Ne.UNIMPLEMENTED:case Ne.DATA_LOSS:return!0;default:return Ze(15467,{code:r})}}function Rk(r){if(r===void 0)return Qn("GRPC error has no .code"),Ne.UNKNOWN;switch(r){case ar.OK:return Ne.OK;case ar.CANCELLED:return Ne.CANCELLED;case ar.UNKNOWN:return Ne.UNKNOWN;case ar.DEADLINE_EXCEEDED:return Ne.DEADLINE_EXCEEDED;case ar.RESOURCE_EXHAUSTED:return Ne.RESOURCE_EXHAUSTED;case ar.INTERNAL:return Ne.INTERNAL;case ar.UNAVAILABLE:return Ne.UNAVAILABLE;case ar.UNAUTHENTICATED:return Ne.UNAUTHENTICATED;case ar.INVALID_ARGUMENT:return Ne.INVALID_ARGUMENT;case ar.NOT_FOUND:return Ne.NOT_FOUND;case ar.ALREADY_EXISTS:return Ne.ALREADY_EXISTS;case ar.PERMISSION_DENIED:return Ne.PERMISSION_DENIED;case ar.FAILED_PRECONDITION:return Ne.FAILED_PRECONDITION;case ar.ABORTED:return Ne.ABORTED;case ar.OUT_OF_RANGE:return Ne.OUT_OF_RANGE;case ar.UNIMPLEMENTED:return Ne.UNIMPLEMENTED;case ar.DATA_LOSS:return Ne.DATA_LOSS;default:return Ze(39323,{code:r})}}(Kt=ar||(ar={}))[Kt.OK=0]="OK",Kt[Kt.CANCELLED=1]="CANCELLED",Kt[Kt.UNKNOWN=2]="UNKNOWN",Kt[Kt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Kt[Kt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Kt[Kt.NOT_FOUND=5]="NOT_FOUND",Kt[Kt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Kt[Kt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Kt[Kt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Kt[Kt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Kt[Kt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Kt[Kt.ABORTED=10]="ABORTED",Kt[Kt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Kt[Kt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Kt[Kt.INTERNAL=13]="INTERNAL",Kt[Kt.UNAVAILABLE=14]="UNAVAILABLE",Kt[Kt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YM=new Kl([4294967295,4294967295],0);function rT(r){const e=OP().encode(r),t=new AP;return t.update(e),new Uint8Array(t.digest())}function iT(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Kl([t,n],0),new Kl([i,s],0)]}class Lb{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new vf(`Invalid padding: ${t}`);if(n<0)throw new vf(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new vf(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new vf(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=Kl.fromNumber(this.pe)}we(e,t,n){let i=e.add(t.multiply(Kl.fromNumber(n)));return i.compare(YM)===1&&(i=new Kl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=rT(e),[n,i]=iT(t);for(let s=0;s<this.hashCount;s++){const o=this.we(n,i,s);if(!this.be(o))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Lb(s,i,t);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.pe===0)return;const t=rT(e),[n,i]=iT(t);for(let s=0;s<this.hashCount;s++){const o=this.we(n,i,s);this.Se(o)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class vf extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cm{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,Rm.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Cm(at.min(),i,new Pn(Et),rs(),zt())}}class Rm{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Rm(n,t,zt(),zt(),zt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sg{constructor(e,t,n,i){this.De=e,this.removedTargetIds=t,this.key=n,this.ve=i}}class jk{constructor(e,t){this.targetId=e,this.Ce=t}}class Ok{constructor(e,t,n=Jn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class sT{constructor(){this.Fe=0,this.Me=oT(),this.xe=Jn.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=zt(),t=zt(),n=zt();return this.Me.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:Ze(38017,{changeType:s})}}),new Rm(this.xe,this.Oe,e,t,n)}Qe(){this.Ne=!1,this.Me=oT()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,rt(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class ZM{constructor(e){this.ze=e,this.je=new Map,this.He=rs(),this.Je=Bp(),this.Ye=Bp(),this.Ze=new Pn(Et)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const n=this.rt(t);switch(e.state){case 0:this.it(t)&&n.ke(e.resumeToken);break;case 1:n.We(),n.Be||n.Qe(),n.ke(e.resumeToken);break;case 2:n.We(),n.Be||this.removeTarget(t);break;case 3:this.it(t)&&(n.Ge(),n.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),n.ke(e.resumeToken));break;default:Ze(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((n,i)=>{this.it(i)&&t(i)})}ot(e){const t=e.targetId,n=e.Ce.count,i=this._t(t);if(i){const s=i.target;if(Kg(s))if(n===0){const o=new $e(s.path);this.tt(t,o,Dn.newNoDocument(o,at.min()))}else rt(n===1,20013,{expectedCount:n});else{const o=this.ut(t);if(o!==n){const l=this.ct(e),d=l?this.lt(l,e,o):1;if(d!==0){this.st(t);const f=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,f)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=t;let o,l;try{o=Ra(n).toUint8Array()}catch(d){if(d instanceof ek)return lu("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{l=new Lb(o,i,s)}catch(d){return lu(d instanceof vf?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return l.pe===0?null:l}lt(e,t,n){return t.Ce.count===n-this.Tt(e,t.targetId)?0:2}Tt(e,t){const n=this.ze.getRemoteKeysForTarget(t);let i=0;return n.forEach(s=>{const o=this.ze.Pt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.tt(t,s,null),i++)}),i}It(e){const t=new Map;this.je.forEach((s,o)=>{const l=this._t(o);if(l){if(s.current&&Kg(l.target)){const d=new $e(l.target.path);this.Et(d).has(o)||this.dt(o,d)||this.tt(o,d,Dn.newNoDocument(d,e))}s.Le&&(t.set(o,s.qe()),s.Qe())}});let n=zt();this.Ye.forEach((s,o)=>{let l=!0;o.forEachWhile(d=>{const f=this._t(d);return!f||f.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(s))}),this.He.forEach((s,o)=>o.setReadTime(e));const i=new Cm(e,t,this.Ze,this.He,n);return this.He=rs(),this.Je=Bp(),this.Ye=Bp(),this.Ze=new Pn(Et),i}et(e,t){if(!this.it(e))return;const n=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,n),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,n){if(!this.it(e))return;const i=this.rt(e);this.dt(e,t)?i.$e(t,1):i.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),n&&(this.He=this.He.insert(t,n))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new sT,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new gn(Et),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new gn(Et),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||je("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new sT),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function Bp(){return new Pn($e.comparator)}function oT(){return new Pn($e.comparator)}const QM={asc:"ASCENDING",desc:"DESCENDING"},XM={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},JM={and:"AND",or:"OR"};class e6{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function bx(r,e){return r.useProto3Json||Am(e)?e:{value:e}}function Wd(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Dk(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function t6(r,e){return Wd(r,e.toTimestamp())}function Ar(r){return rt(!!r,49232),at.fromTimestamp(function(t){const n=Ca(t);return new Ot(n.seconds,n.nanos)}(r))}function Fb(r,e){return wx(r,e).canonicalString()}function wx(r,e){const t=function(i){return new Jt(["projects",i.projectId,"databases",i.database])}(r).child("documents");return e===void 0?t:t.child(e)}function Mk(r){const e=Jt.fromString(r);return rt(Hk(e),10190,{key:e.toString()}),e}function im(r,e){return Fb(r.databaseId,e.path)}function Aa(r,e){const t=Mk(e);if(t.get(1)!==r.databaseId.projectId)throw new Ve(Ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new Ve(Ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new $e(Vk(t))}function Lk(r,e){return Fb(r.databaseId,e)}function Fk(r){const e=Mk(r);return e.length===4?Jt.emptyPath():Vk(e)}function Ex(r){return new Jt(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function Vk(r){return rt(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}function aT(r,e,t){return{name:im(r,e),fields:t.value.mapValue.fields}}function n6(r,e,t){const n=Aa(r,e.name),i=Ar(e.updateTime),s=e.createTime?Ar(e.createTime):at.min(),o=new Lr({mapValue:{fields:e.fields}}),l=Dn.newFoundDocument(n,i,s,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function r6(r,e){return"found"in e?function(n,i){rt(!!i.found,43571),i.found.name,i.found.updateTime;const s=Aa(n,i.found.name),o=Ar(i.found.updateTime),l=i.found.createTime?Ar(i.found.createTime):at.min(),d=new Lr({mapValue:{fields:i.found.fields}});return Dn.newFoundDocument(s,o,l,d)}(r,e):"missing"in e?function(n,i){rt(!!i.missing,3894),rt(!!i.readTime,22933);const s=Aa(n,i.missing),o=Ar(i.readTime);return Dn.newNoDocument(s,o)}(r,e):Ze(7234,{result:e})}function i6(r,e){let t;if("targetChange"in e){e.targetChange;const n=function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:Ze(39313,{state:f})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(f,m){return f.useProto3Json?(rt(m===void 0||typeof m=="string",58123),Jn.fromBase64String(m||"")):(rt(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),Jn.fromUint8Array(m||new Uint8Array))}(r,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(f){const m=f.code===void 0?Ne.UNKNOWN:Rk(f.code);return new Ve(m,f.message||"")}(o);t=new Ok(n,i,s,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Aa(r,n.document.name),s=Ar(n.document.updateTime),o=n.document.createTime?Ar(n.document.createTime):at.min(),l=new Lr({mapValue:{fields:n.document.fields}}),d=Dn.newFoundDocument(i,s,o,l),f=n.targetIds||[],m=n.removedTargetIds||[];t=new Sg(f,m,d.key,d)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Aa(r,n.document),s=n.readTime?Ar(n.readTime):at.min(),o=Dn.newNoDocument(i,s),l=n.removedTargetIds||[];t=new Sg([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Aa(r,n.document),s=n.removedTargetIds||[];t=new Sg([],s,i,null)}else{if(!("filter"in e))return Ze(11601,{Vt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,o=new KM(i,s),l=n.targetId;t=new jk(l,o)}}return t}function sm(r,e){let t;if(e instanceof rh)t={update:aT(r,e.key,e.value)};else if(e instanceof ih)t={delete:im(r,e.key)};else if(e instanceof Ba)t={update:aT(r,e.key,e.data),updateMask:d6(e.fieldMask)};else{if(!(e instanceof jb))return Ze(16599,{ft:e.type});t={verify:im(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,o){const l=o.transform;if(l instanceof Hd)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof hu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof $d)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof rm)return{fieldPath:o.field.canonicalString(),increment:l.Re};throw Ze(20930,{transform:o.transform})}(0,n))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:t6(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ze(27497)}(r,e.precondition)),t}function Sx(r,e){const t=e.currentDocument?function(s){return s.updateTime!==void 0?Mn.updateTime(Ar(s.updateTime)):s.exists!==void 0?Mn.exists(s.exists):Mn.none()}(e.currentDocument):Mn.none(),n=e.updateTransforms?e.updateTransforms.map(i=>function(o,l){let d=null;if("setToServerValue"in l)rt(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),d=new Hd;else if("appendMissingElements"in l){const m=l.appendMissingElements.values||[];d=new hu(m)}else if("removeAllFromArray"in l){const m=l.removeAllFromArray.values||[];d=new $d(m)}else"increment"in l?d=new rm(o,l.increment):Ze(16584,{proto:l});const f=Un.fromServerFormat(l.fieldPath);return new Rb(f,d)}(r,i)):[];if(e.update){e.update.name;const i=Aa(r,e.update.name),s=new Lr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(d){const f=d.fieldPaths||[];return new zi(f.map(m=>Un.fromServerFormat(m)))}(e.updateMask);return new Ba(i,s,o,t,n)}return new rh(i,s,t,n)}if(e.delete){const i=Aa(r,e.delete);return new ih(i,t)}if(e.verify){const i=Aa(r,e.verify);return new jb(i,t)}return Ze(1463,{proto:e})}function s6(r,e){return r&&r.length>0?(rt(e!==void 0,14353),r.map(t=>function(i,s){let o=i.updateTime?Ar(i.updateTime):Ar(s);return o.isEqual(at.min())&&(o=Ar(s)),new HM(o,i.transformResults||[])}(t,e))):[]}function Bk(r,e){return{documents:[Lk(r,e.path)]}}function Vb(r,e){const t={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=Lk(r,i);const s=function(f){if(f.length!==0)return qk(pn.create(f,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(f){if(f.length!==0)return f.map(m=>function(g){return{field:Ll(g.field),direction:l6(g.dir)}}(m))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=bx(r,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(f){return{before:f.inclusive,values:f.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(f){return{before:!f.inclusive,values:f.position}}(e.endAt)),{gt:t,parent:i}}function o6(r,e,t,n){const{gt:i,parent:s}=Vb(r,e),o={},l=[];let d=0;return t.forEach(f=>{const m="aggregate_"+d++;o[m]=f.alias,f.aggregateType==="count"?l.push({alias:m,count:{}}):f.aggregateType==="avg"?l.push({alias:m,avg:{field:Ll(f.fieldPath)}}):f.aggregateType==="sum"&&l.push({alias:m,sum:{field:Ll(f.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:l,structuredQuery:i.structuredQuery},parent:i.parent},yt:o,parent:s}}function zk(r){let e=Fk(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){rt(n===1,65062);const m=t.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let s=[];t.where&&(s=function(p){const g=Uk(p);return g instanceof pn&&Ib(g)?g.getFilters():[g]}(t.where));let o=[];t.orderBy&&(o=function(p){return p.map(g=>function(E){return new nm(bd(E.field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(g))}(t.orderBy));let l=null;t.limit&&(l=function(p){let g;return g=typeof p=="object"?p.value:p,Am(g)?null:g}(t.limit));let d=null;t.startAt&&(d=function(p){const g=!!p.before,v=p.values||[];return new nc(v,g)}(t.startAt));let f=null;return t.endAt&&(f=function(p){const g=!p.before,v=p.values||[];return new nc(v,g)}(t.endAt)),gk(e,i,o,s,l,"F",d,f)}function a6(r,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ze(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function Uk(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=bd(t.unaryFilter.field);return Wt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=bd(t.unaryFilter.field);return Wt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=bd(t.unaryFilter.field);return Wt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=bd(t.unaryFilter.field);return Wt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ze(61313);default:return Ze(60726)}}(r):r.fieldFilter!==void 0?function(t){return Wt.create(bd(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ze(58110);default:return Ze(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return pn.create(t.compositeFilter.filters.map(n=>Uk(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ze(1026)}}(t.compositeFilter.op))}(r):Ze(30097,{filter:r})}function l6(r){return QM[r]}function c6(r){return XM[r]}function u6(r){return JM[r]}function Ll(r){return{fieldPath:r.canonicalString()}}function bd(r){return Un.fromServerFormat(r.fieldPath)}function qk(r){return r instanceof Wt?function(t){if(t.op==="=="){if($S(t.value))return{unaryFilter:{field:Ll(t.field),op:"IS_NAN"}};if(HS(t.value))return{unaryFilter:{field:Ll(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if($S(t.value))return{unaryFilter:{field:Ll(t.field),op:"IS_NOT_NAN"}};if(HS(t.value))return{unaryFilter:{field:Ll(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ll(t.field),op:c6(t.op),value:t.value}}}(r):r instanceof pn?function(t){const n=t.getFilters().map(i=>qk(i));return n.length===1?n[0]:{compositeFilter:{op:u6(t.op),filters:n}}}(r):Ze(54877,{filter:r})}function d6(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function Hk(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sa{constructor(e,t,n,i,s=at.min(),o=at.min(),l=Jn.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=d}withSequenceNumber(e){return new Sa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Sa(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Sa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Sa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $k{constructor(e){this.wt=e}}function h6(r,e){let t;if(e.document)t=n6(r.wt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=$e.fromSegments(e.noDocument.path),i=mu(e.noDocument.readTime);t=Dn.newNoDocument(n,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ze(56709);{const n=$e.fromSegments(e.unknownDocument.path),i=mu(e.unknownDocument.version);t=Dn.newUnknownDocument(n,i)}}return e.readTime&&t.setReadTime(function(i){const s=new Ot(i[0],i[1]);return at.fromTimestamp(s)}(e.readTime)),t}function lT(r,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Qg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(s,o){return{name:im(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Wd(s,o.version.toTimestamp()),createTime:Wd(s,o.createTime.toTimestamp())}}(r.wt,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:fu(e.version)};else{if(!e.isUnknownDocument())return Ze(57904,{document:e});n.unknownDocument={path:t.path.toArray(),version:fu(e.version)}}return n}function Qg(r){const e=r.toTimestamp();return[e.seconds,e.nanoseconds]}function fu(r){const e=r.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function mu(r){const e=new Ot(r.seconds,r.nanoseconds);return at.fromTimestamp(e)}function Kc(r,e){const t=(e.baseMutations||[]).map(s=>Sx(r.wt,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const n=e.mutations.map(s=>Sx(r.wt,s)),i=Ot.fromMillis(e.localWriteTimeMs);return new Ob(e.batchId,i,t,n)}function _f(r){const e=mu(r.readTime),t=r.lastLimboFreeSnapshotVersion!==void 0?mu(r.lastLimboFreeSnapshotVersion):at.min();let n;return n=function(s){return s.documents!==void 0}(r.query)?function(s){const o=s.documents.length;return rt(o===1,1966,{count:o}),is(Pm(Fk(s.documents[0])))}(r.query):function(s){return is(zk(s))}(r.query),new Sa(n,r.targetId,"TargetPurposeListen",r.lastListenSequenceNumber,e,t,Jn.fromBase64String(r.resumeToken))}function Wk(r,e){const t=fu(e.snapshotVersion),n=fu(e.lastLimboFreeSnapshotVersion);let i;i=Kg(e.target)?Bk(r.wt,e.target):Vb(r.wt,e.target).gt;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:du(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:i}}function Gk(r){const e=zk({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?Zg(e,e.limit,"L"):e}function Hv(r,e){return new Mb(e.largestBatchId,Sx(r.wt,e.overlayMutation))}function cT(r,e){const t=e.path.lastSegment();return[r,ti(e.path.popLast()),t]}function uT(r,e,t,n){return{indexId:r,uid:e,sequenceNumber:t,readTime:fu(n.readTime),documentKey:ti(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class f6{getBundleMetadata(e,t){return dT(e).get(t).next(n=>{if(n)return function(s){return{id:s.bundleId,createTime:mu(s.createTime),version:s.version}}(n)})}saveBundleMetadata(e,t){return dT(e).put(function(i){return{bundleId:i.id,createTime:fu(Ar(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return hT(e).get(t).next(n=>{if(n)return function(s){return{name:s.name,query:Gk(s.bundledQuery),readTime:mu(s.readTime)}}(n)})}saveNamedQuery(e,t){return hT(e).put(function(i){return{name:i.name,readTime:fu(Ar(i.readTime)),bundledQuery:i.bundledQuery}}(t))}}function dT(r){return gr(r,Cy)}function hT(r){return gr(r,Ry)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class By{constructor(e,t){this.serializer=e,this.userId=t}static bt(e,t){const n=t.uid||"";return new By(e,n)}getOverlay(e,t){return Hh(e).get(cT(this.userId,t)).next(n=>n?Hv(this.serializer,n):null)}getOverlays(e,t){const n=Ro();return _e.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){const i=[];return n.forEach((s,o)=>{const l=new Mb(t,o);i.push(this.St(e,l))}),_e.waitFor(i)}removeOverlaysForBatchId(e,t,n){const i=new Set;t.forEach(o=>i.add(ti(o.getCollectionPath())));const s=[];return i.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,n+1],!1,!0);s.push(Hh(e).X(fx,l))}),_e.waitFor(s)}getOverlaysForCollection(e,t,n){const i=Ro(),s=ti(t),o=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Hh(e).J(fx,o).next(l=>{for(const d of l){const f=Hv(this.serializer,d);i.set(f.getKey(),f)}return i})}getOverlaysForCollectionGroup(e,t,n,i){const s=Ro();let o;const l=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Hh(e).te({index:KP,range:l},(d,f,m)=>{const p=Hv(this.serializer,f);s.size()<i||p.largestBatchId===o?(s.set(p.getKey(),p),o=p.largestBatchId):m.done()}).next(()=>s)}St(e,t){return Hh(e).put(function(i,s,o){const[l,d,f]=cT(s,o.mutation.key);return{userId:s,collectionPath:d,documentId:f,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:sm(i.wt,o.mutation)}}(this.serializer,this.userId,t))}}function Hh(r){return gr(r,jy)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m6{Dt(e){return gr(e,Sb)}getSessionToken(e){return this.Dt(e).get("sessionToken").next(t=>{const n=t==null?void 0:t.value;return n?Jn.fromUint8Array(n):Jn.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Dt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yc{constructor(){}vt(e,t){this.Ct(e,t),t.Ft()}Ct(e,t){if("nullValue"in e)this.Mt(t,5);else if("booleanValue"in e)this.Mt(t,10),t.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(t,15),t.xt(On(e.integerValue));else if("doubleValue"in e){const n=On(e.doubleValue);isNaN(n)?this.Mt(t,13):(this.Mt(t,15),Yf(n)?t.xt(0):t.xt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Mt(t,20),typeof n=="string"&&(n=Ca(n)),t.Ot(`${n.seconds||""}`),t.xt(n.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,t),this.Bt(t);else if("bytesValue"in e)this.Mt(t,30),t.Lt(Ra(e.bytesValue)),this.Bt(t);else if("referenceValue"in e)this.kt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Mt(t,45),t.xt(n.latitude||0),t.xt(n.longitude||0)}else"mapValue"in e?ok(e)?this.Mt(t,Number.MAX_SAFE_INTEGER):My(e)?this.qt(e.mapValue,t):(this.Qt(e.mapValue,t),this.Bt(t)):"arrayValue"in e?(this.$t(e.arrayValue,t),this.Bt(t)):Ze(19022,{Ut:e})}Nt(e,t){this.Mt(t,25),this.Kt(e,t)}Kt(e,t){t.Ot(e)}Qt(e,t){const n=e.fields||{};this.Mt(t,55);for(const i of Object.keys(n))this.Nt(i,t),this.Ct(n[i],t)}qt(e,t){var n,i;const s=e.fields||{};this.Mt(t,53);const o=zd,l=((i=(n=s[o].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.length)||0;this.Mt(t,15),t.xt(On(l)),this.Nt(o,t),this.Ct(s[o],t)}$t(e,t){const n=e.values||[];this.Mt(t,50);for(const i of n)this.Ct(i,t)}kt(e,t){this.Mt(t,37),$e.fromName(e).path.forEach(n=>{this.Mt(t,60),this.Kt(n,t)})}Mt(e,t){e.xt(t)}Bt(e){e.xt(2)}}Yc.Wt=new Yc;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dd=255;function p6(r){if(r===0)return 8;let e=0;return r>>4||(e+=4,r<<=4),r>>6||(e+=2,r<<=2),r>>7||(e+=1),e}function fT(r){const e=64-function(n){let i=0;for(let s=0;s<8;++s){const o=p6(255&n[s]);if(i+=o,o!==8)break}return i}(r);return Math.ceil(e/8)}class g6{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Gt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.zt(n.value),n=t.next();this.jt()}Ht(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Jt(n.value),n=t.next();this.Yt()}Zt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.zt(n);else if(n<2048)this.zt(960|n>>>6),this.zt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.zt(480|n>>>12),this.zt(128|63&n>>>6),this.zt(128|63&n);else{const i=t.codePointAt(0);this.zt(240|i>>>18),this.zt(128|63&i>>>12),this.zt(128|63&i>>>6),this.zt(128|63&i)}}this.jt()}Xt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Jt(n);else if(n<2048)this.Jt(960|n>>>6),this.Jt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|n>>>12),this.Jt(128|63&n>>>6),this.Jt(128|63&n);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Yt()}en(e){const t=this.tn(e),n=fT(t);this.nn(1+n),this.buffer[this.position++]=255&n;for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=255&t[i]}rn(e){const t=this.tn(e),n=fT(t);this.nn(1+n),this.buffer[this.position++]=~(255&n);for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}sn(){this._n(dd),this._n(255)}an(){this.un(dd),this.un(255)}reset(){this.position=0}seed(e){this.nn(e.length),this.buffer.set(e,this.position),this.position+=e.length}cn(){return this.buffer.slice(0,this.position)}tn(e){const t=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let i=1;i<t.length;++i)t[i]^=n?255:0;return t}zt(e){const t=255&e;t===0?(this._n(0),this._n(255)):t===dd?(this._n(dd),this._n(0)):this._n(t)}Jt(e){const t=255&e;t===0?(this.un(0),this.un(255)):t===dd?(this.un(dd),this.un(0)):this.un(e)}jt(){this._n(0),this._n(1)}Yt(){this.un(0),this.un(1)}_n(e){this.nn(1),this.buffer[this.position++]=e}un(e){this.nn(1),this.buffer[this.position++]=~e}nn(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}}class y6{constructor(e){this.ln=e}Lt(e){this.ln.Gt(e)}Ot(e){this.ln.Zt(e)}xt(e){this.ln.en(e)}Ft(){this.ln.sn()}}class v6{constructor(e){this.ln=e}Lt(e){this.ln.Ht(e)}Ot(e){this.ln.Xt(e)}xt(e){this.ln.rn(e)}Ft(){this.ln.an()}}class $h{constructor(){this.ln=new g6,this.hn=new y6(this.ln),this.Pn=new v6(this.ln)}seed(e){this.ln.seed(e)}Tn(e){return e===0?this.hn:this.Pn}cn(){return this.ln.cn()}reset(){this.ln.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc{constructor(e,t,n,i){this.In=e,this.En=t,this.dn=n,this.An=i}Rn(){const e=this.An.length,t=e===0||this.An[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.An,0),t!==e?n.set([0],this.An.length):++n[n.length-1],new Zc(this.In,this.En,this.dn,n)}Vn(e,t,n){return{indexId:this.In,uid:e,arrayValue:Tg(this.dn),directionalValue:Tg(this.An),orderedDocumentKey:Tg(t),documentKey:n.path.toArray()}}mn(e,t,n){const i=this.Vn(e,t,n);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function kl(r,e){let t=r.In-e.In;return t!==0?t:(t=mT(r.dn,e.dn),t!==0?t:(t=mT(r.An,e.An),t!==0?t:$e.comparator(r.En,e.En)))}function mT(r,e){for(let t=0;t<r.length&&t<e.length;++t){const n=r[t]-e[t];if(n!==0)return n}return r.length-e.length}function Tg(r){return L4()?function(t){let n="";for(let i=0;i<t.length;i++)n+=String.fromCharCode(t[i]);return n}(r):r}function pT(r){return typeof r!="string"?r:function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(r)}class gT{constructor(e){this.fn=new gn((t,n)=>Un.comparator(t.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.gn=e.orderBy,this.pn=[];for(const t of e.filters){const n=t;n.isInequality()?this.fn=this.fn.add(n):this.pn.push(n)}}get yn(){return this.fn.size>1}wn(e){if(rt(e.collectionGroup===this.collectionId,49279),this.yn)return!1;const t=ux(e);if(t!==void 0&&!this.bn(t))return!1;const n=qc(e);let i=new Set,s=0,o=0;for(;s<n.length&&this.bn(n[s]);++s)i=i.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.fn.size>0){const l=this.fn.getIterator().getNext();if(!i.has(l.field.canonicalString())){const d=n[s];if(!this.Sn(l,d)||!this.Dn(this.gn[o++],d))return!1}++s}for(;s<n.length;++s){const l=n[s];if(o>=this.gn.length||!this.Dn(this.gn[o++],l))return!1}return!0}vn(){if(this.yn)return null;let e=new gn(Un.comparator);const t=[];for(const n of this.pn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new yg(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new yg(n.field,0))}for(const n of this.gn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new yg(n.field,n.dir==="asc"?0:1)));return new qg(qg.UNKNOWN_ID,this.collectionId,t,Kf.empty())}bn(e){for(const t of this.pn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}Dn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kk(r){var e,t;if(rt(r instanceof Wt||r instanceof pn,20012),r instanceof Wt){if(r instanceof pk){const i=((t=(e=r.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>Wt.create(r.field,"==",s)))||[];return pn.create(i,"or")}return r}const n=r.filters.map(i=>Kk(i));return pn.create(n,r.op)}function _6(r){if(r.getFilters().length===0)return[];const e=Nx(Kk(r));return rt(Yk(e),7391),Tx(e)||Ax(e)?[e]:e.getFilters()}function Tx(r){return r instanceof Wt}function Ax(r){return r instanceof pn&&Ib(r)}function Yk(r){return Tx(r)||Ax(r)||function(t){if(t instanceof pn&&yx(t)){for(const n of t.getFilters())if(!Tx(n)&&!Ax(n))return!1;return!0}return!1}(r)}function Nx(r){if(rt(r instanceof Wt||r instanceof pn,34018),r instanceof Wt)return r;if(r.filters.length===1)return Nx(r.filters[0]);const e=r.filters.map(n=>Nx(n));let t=pn.create(e,r.op);return t=Xg(t),Yk(t)?t:(rt(t instanceof pn,64498),rt(qd(t),40251),rt(t.filters.length>1,57927),t.filters.reduce((n,i)=>Bb(n,i)))}function Bb(r,e){let t;return rt(r instanceof Wt||r instanceof pn,38388),rt(e instanceof Wt||e instanceof pn,25473),t=r instanceof Wt?e instanceof Wt?function(i,s){return pn.create([i,s],"and")}(r,e):yT(r,e):e instanceof Wt?yT(e,r):function(i,s){if(rt(i.filters.length>0&&s.filters.length>0,48005),qd(i)&&qd(s))return hk(i,s.getFilters());const o=yx(i)?i:s,l=yx(i)?s:i,d=o.filters.map(f=>Bb(f,l));return pn.create(d,"or")}(r,e),Xg(t)}function yT(r,e){if(qd(e))return hk(e,r.getFilters());{const t=e.filters.map(n=>Bb(r,n));return pn.create(t,"or")}}function Xg(r){if(rt(r instanceof Wt||r instanceof pn,11850),r instanceof Wt)return r;const e=r.getFilters();if(e.length===1)return Xg(e[0]);if(uk(r))return r;const t=e.map(i=>Xg(i)),n=[];return t.forEach(i=>{i instanceof Wt?n.push(i):i instanceof pn&&(i.op===r.op?n.push(...i.filters):n.push(i))}),n.length===1?n[0]:pn.create(n,r.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x6{constructor(){this.Cn=new zb}addToCollectionParentIndex(e,t){return this.Cn.add(t),_e.resolve()}getCollectionParents(e,t){return _e.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return _e.resolve()}deleteFieldIndex(e,t){return _e.resolve()}deleteAllFieldIndexes(e){return _e.resolve()}createTargetIndexes(e,t){return _e.resolve()}getDocumentsMatchingTarget(e,t){return _e.resolve(null)}getIndexType(e,t){return _e.resolve(0)}getFieldIndexes(e,t){return _e.resolve([])}getNextCollectionGroupToUpdate(e){return _e.resolve(null)}getMinOffset(e,t){return _e.resolve(os.min())}getMinOffsetFromCollectionGroup(e,t){return _e.resolve(os.min())}updateCollectionGroup(e,t,n){return _e.resolve()}updateIndexEntries(e,t){return _e.resolve()}}class zb{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new gn(Jt.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new gn(Jt.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vT="IndexedDbIndexManager",zp=new Uint8Array(0);class b6{constructor(e,t){this.databaseId=t,this.Fn=new zb,this.Mn=new Va(n=>du(n),(n,i)=>Im(n,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Fn.has(t)){const n=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.Fn.add(t)});const s={collectionId:n,parent:ti(i)};return _T(e).put(s)}return _e.resolve()}getCollectionParents(e,t){const n=[],i=IDBKeyRange.bound([t,""],[MP(t),""],!1,!0);return _T(e).J(i).next(s=>{for(const o of s){if(o.collectionId!==t)break;n.push(Co(o.parent))}return n})}addFieldIndex(e,t){const n=Wh(e),i=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(d=>[d.fieldPath.canonicalString(),d.kind])}}(t);delete i.indexId;const s=n.add(i);if(t.indexState){const o=fd(e);return s.next(l=>{o.put(uT(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const n=Wh(e),i=fd(e),s=hd(e);return n.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Wh(e),n=hd(e),i=fd(e);return t.X().next(()=>n.X()).next(()=>i.X())}createTargetIndexes(e,t){return _e.forEach(this.xn(t),n=>this.getIndexType(e,n).next(i=>{if(i===0||i===1){const s=new gT(n).vn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const n=hd(e);let i=!0;const s=new Map;return _e.forEach(this.xn(t),o=>this.On(e,o).next(l=>{i&&(i=!!l),s.set(o,l)})).next(()=>{if(i){let o=zt();const l=[];return _e.forEach(s,(d,f)=>{je(vT,`Using index ${function(R){return`id=${R.indexId}|cg=${R.collectionGroup}|f=${R.fields.map(I=>`${I.fieldPath}:${I.kind}`).join(",")}`}(d)} to execute ${du(t)}`);const m=function(R,I){const j=ux(I);if(j===void 0)return null;for(const U of Yg(R,j.fieldPath))switch(U.op){case"array-contains-any":return U.value.arrayValue.values||[];case"array-contains":return[U.value]}return null}(f,d),p=function(R,I){const j=new Map;for(const U of qc(I))for(const P of Yg(R,U.fieldPath))switch(P.op){case"==":case"in":j.set(U.fieldPath.canonicalString(),P.value);break;case"not-in":case"!=":return j.set(U.fieldPath.canonicalString(),P.value),Array.from(j.values())}return null}(f,d),g=function(R,I){const j=[];let U=!0;for(const P of qc(I)){const k=P.kind===0?ZS(R,P.fieldPath,R.startAt):QS(R,P.fieldPath,R.startAt);j.push(k.value),U&&(U=k.inclusive)}return new nc(j,U)}(f,d),v=function(R,I){const j=[];let U=!0;for(const P of qc(I)){const k=P.kind===0?QS(R,P.fieldPath,R.endAt):ZS(R,P.fieldPath,R.endAt);j.push(k.value),U&&(U=k.inclusive)}return new nc(j,U)}(f,d),E=this.Nn(d,f,g),x=this.Nn(d,f,v),b=this.Bn(d,f,p),S=this.Ln(d.indexId,m,E,g.inclusive,x,v.inclusive,b);return _e.forEach(S,N=>n.Z(N,t.limit).next(R=>{R.forEach(I=>{const j=$e.fromSegments(I.documentKey);o.has(j)||(o=o.add(j),l.push(j))})}))}).next(()=>l)}return _e.resolve(null)})}xn(e){let t=this.Mn.get(e);return t||(e.filters.length===0?t=[e]:t=_6(pn.create(e.filters,"and")).map(n=>_x(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.Mn.set(e,t),t)}Ln(e,t,n,i,s,o,l){const d=(t!=null?t.length:1)*Math.max(n.length,s.length),f=d/(t!=null?t.length:1),m=[];for(let p=0;p<d;++p){const g=t?this.kn(t[p/f]):zp,v=this.qn(e,g,n[p%f],i),E=this.Qn(e,g,s[p%f],o),x=l.map(b=>this.qn(e,g,b,!0));m.push(...this.createRange(v,E,x))}return m}qn(e,t,n,i){const s=new Zc(e,$e.empty(),t,n);return i?s:s.Rn()}Qn(e,t,n,i){const s=new Zc(e,$e.empty(),t,n);return i?s.Rn():s}On(e,t){const n=new gT(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const l of s)n.wn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,t){let n=2;const i=this.xn(t);return _e.forEach(i,s=>this.On(e,s).next(o=>{o?n!==0&&o.fields.length<function(d){let f=new gn(Un.comparator),m=!1;for(const p of d.filters)for(const g of p.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?m=!0:f=f.add(g.field));for(const p of d.orderBy)p.field.isKeyField()||(f=f.add(p.field));return f.size+(m?1:0)}(s)&&(n=1):n=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&n===2?1:n)}$n(e,t){const n=new $h;for(const i of qc(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const o=n.Tn(i.kind);Yc.Wt.vt(s,o)}return n.cn()}kn(e){const t=new $h;return Yc.Wt.vt(e,t.Tn(0)),t.cn()}Un(e,t){const n=new $h;return Yc.Wt.vt(uu(this.databaseId,t),n.Tn(function(s){const o=qc(s);return o.length===0?0:o[o.length-1].kind}(e))),n.cn()}Bn(e,t,n){if(n===null)return[];let i=[];i.push(new $h);let s=0;for(const o of qc(e)){const l=n[s++];for(const d of i)if(this.Kn(t,o.fieldPath)&&tm(l))i=this.Wn(i,o,l);else{const f=d.Tn(o.kind);Yc.Wt.vt(l,f)}}return this.Gn(i)}Nn(e,t,n){return this.Bn(e,t,n.position)}Gn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].cn();return t}Wn(e,t,n){const i=[...e],s=[];for(const o of n.arrayValue.values||[])for(const l of i){const d=new $h;d.seed(l.cn()),Yc.Wt.vt(o,d.Tn(t.kind)),s.push(d)}return s}Kn(e,t){return!!e.filters.find(n=>n instanceof Wt&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,t){const n=Wh(e),i=fd(e);return(t?n.J(hx,IDBKeyRange.bound(t,t)):n.J()).next(s=>{const o=[];return _e.forEach(s,l=>i.get([l.indexId,this.uid]).next(d=>{o.push(function(m,p){const g=p?new Kf(p.sequenceNumber,new os(mu(p.readTime),new $e(Co(p.documentKey)),p.largestBatchId)):Kf.empty(),v=m.fields.map(([E,x])=>new yg(Un.fromServerFormat(E),x));return new qg(m.indexId,m.collectionGroup,v,g)}(l,d))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((n,i)=>{const s=n.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:Et(n.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,n){const i=Wh(e),s=fd(e);return this.zn(e).next(o=>i.J(hx,IDBKeyRange.bound(t,t)).next(l=>_e.forEach(l,d=>s.put(uT(d.indexId,this.uid,o,n)))))}updateIndexEntries(e,t){const n=new Map;return _e.forEach(t,(i,s)=>{const o=n.get(i.collectionGroup);return(o?_e.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(l=>(n.set(i.collectionGroup,l),_e.forEach(l,d=>this.jn(e,i,d).next(f=>{const m=this.Hn(s,d);return f.isEqual(m)?_e.resolve():this.Jn(e,s,d,f,m)}))))})}Yn(e,t,n,i){return hd(e).put(i.Vn(this.uid,this.Un(n,t.key),t.key))}Zn(e,t,n,i){return hd(e).delete(i.mn(this.uid,this.Un(n,t.key),t.key))}jn(e,t,n){const i=hd(e);let s=new gn(kl);return i.te({index:GP,range:IDBKeyRange.only([n.indexId,this.uid,Tg(this.Un(n,t))])},(o,l)=>{s=s.add(new Zc(n.indexId,t,pT(l.arrayValue),pT(l.directionalValue)))}).next(()=>s)}Hn(e,t){let n=new gn(kl);const i=this.$n(t,e);if(i==null)return n;const s=ux(t);if(s!=null){const o=e.data.field(s.fieldPath);if(tm(o))for(const l of o.arrayValue.values||[])n=n.add(new Zc(t.indexId,e.key,this.kn(l),i))}else n=n.add(new Zc(t.indexId,e.key,zp,i));return n}Jn(e,t,n,i,s){je(vT,"Updating index entries for document '%s'",t.key);const o=[];return function(d,f,m,p,g){const v=d.getIterator(),E=f.getIterator();let x=ud(v),b=ud(E);for(;x||b;){let S=!1,N=!1;if(x&&b){const R=m(x,b);R<0?N=!0:R>0&&(S=!0)}else x!=null?N=!0:S=!0;S?(p(b),b=ud(E)):N?(g(x),x=ud(v)):(x=ud(v),b=ud(E))}}(i,s,kl,l=>{o.push(this.Yn(e,t,n,l))},l=>{o.push(this.Zn(e,t,n,l))}),_e.waitFor(o)}zn(e){let t=1;return fd(e).te({index:WP,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((o,l)=>kl(o,l)).filter((o,l,d)=>!l||kl(o,d[l-1])!==0);const i=[];i.push(e);for(const o of n){const l=kl(o,e),d=kl(o,t);if(l===0)i[0]=e.Rn();else if(l>0&&d<0)i.push(o),i.push(o.Rn());else if(d>0)break}i.push(t);const s=[];for(let o=0;o<i.length;o+=2){if(this.Xn(i[o],i[o+1]))return[];const l=i[o].mn(this.uid,zp,$e.empty()),d=i[o+1].mn(this.uid,zp,$e.empty());s.push(IDBKeyRange.bound(l,d))}return s}Xn(e,t){return kl(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(xT)}getMinOffset(e,t){return _e.mapArray(this.xn(t),n=>this.On(e,n).next(i=>i||Ze(44426))).next(xT)}}function _T(r){return gr(r,Xf)}function hd(r){return gr(r,Rf)}function Wh(r){return gr(r,Eb)}function fd(r){return gr(r,Cf)}function xT(r){rt(r.length!==0,28825);let e=r[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<r.length;n++){const i=r[n].indexState.offset;xb(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new os(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Zk=41943040;class Xr{static withCacheSize(e){return new Xr(e,Xr.DEFAULT_COLLECTION_PERCENTILE,Xr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qk(r,e,t){const n=r.store(so),i=r.store(Ld),s=[],o=IDBKeyRange.only(t.batchId);let l=0;const d=n.te({range:o},(m,p,g)=>(l++,g.delete()));s.push(d.next(()=>{rt(l===1,47070,{batchId:t.batchId})}));const f=[];for(const m of t.mutations){const p=qP(e,m.key.path,t.batchId);s.push(i.delete(p)),f.push(m.key)}return _e.waitFor(s).next(()=>f)}function Jg(r){if(!r)return 0;let e;if(r.document)e=r.document;else if(r.unknownDocument)e=r.unknownDocument;else{if(!r.noDocument)throw Ze(14731);e=r.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Xr.DEFAULT_COLLECTION_PERCENTILE=10,Xr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Xr.DEFAULT=new Xr(Zk,Xr.DEFAULT_COLLECTION_PERCENTILE,Xr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Xr.DISABLED=new Xr(-1,0,0);class zy{constructor(e,t,n,i){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=i,this.er={}}static bt(e,t,n,i){rt(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new zy(s,t,n,i)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Cl(e).te({index:Xc,range:n},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,n,i){const s=wd(e),o=Cl(e);return o.add({}).next(l=>{rt(typeof l=="number",49019);const d=new Ob(l,t,n,i),f=function(v,E,x){const b=x.baseMutations.map(N=>sm(v.wt,N)),S=x.mutations.map(N=>sm(v.wt,N));return{userId:E,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:b,mutations:S}}(this.serializer,this.userId,d),m=[];let p=new gn((g,v)=>Et(g.canonicalString(),v.canonicalString()));for(const g of i){const v=qP(this.userId,g.key.path,l);p=p.add(g.key.path.popLast()),m.push(o.put(f)),m.push(s.put(v,QD))}return p.forEach(g=>{m.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.er[l]=d.keys()}),_e.waitFor(m).next(()=>d)})}lookupMutationBatch(e,t){return Cl(e).get(t).next(n=>n?(rt(n.userId===this.userId,48,"Unexpected user for mutation batch",{userId:n.userId,batchId:t}),Kc(this.serializer,n)):null)}tr(e,t){return this.er[t]?_e.resolve(this.er[t]):this.lookupMutationBatch(e,t).next(n=>{if(n){const i=n.keys();return this.er[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return Cl(e).te({index:Xc,range:i},(o,l,d)=>{l.userId===this.userId&&(rt(l.batchId>=n,47524,{nr:n}),s=Kc(this.serializer,l)),d.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=eu;return Cl(e).te({index:Xc,range:t,reverse:!0},(i,s,o)=>{n=s.batchId,o.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,eu],[this.userId,Number.POSITIVE_INFINITY]);return Cl(e).J(Xc,t).next(n=>n.map(i=>Kc(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=vg(this.userId,t.path),i=IDBKeyRange.lowerBound(n),s=[];return wd(e).te({range:i},(o,l,d)=>{const[f,m,p]=o,g=Co(m);if(f===this.userId&&t.path.isEqual(g))return Cl(e).get(p).next(v=>{if(!v)throw Ze(61480,{rr:o,batchId:p});rt(v.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:v.userId,batchId:p}),s.push(Kc(this.serializer,v))});d.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new gn(Et);const i=[];return t.forEach(s=>{const o=vg(this.userId,s.path),l=IDBKeyRange.lowerBound(o),d=wd(e).te({range:l},(f,m,p)=>{const[g,v,E]=f,x=Co(v);g===this.userId&&s.path.isEqual(x)?n=n.add(E):p.done()});i.push(d)}),_e.waitFor(i).next(()=>this.ir(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1,s=vg(this.userId,n),o=IDBKeyRange.lowerBound(s);let l=new gn(Et);return wd(e).te({range:o},(d,f,m)=>{const[p,g,v]=d,E=Co(g);p===this.userId&&n.isPrefixOf(E)?E.length===i&&(l=l.add(v)):m.done()}).next(()=>this.ir(e,l))}ir(e,t){const n=[],i=[];return t.forEach(s=>{i.push(Cl(e).get(s).next(o=>{if(o===null)throw Ze(35274,{batchId:s});rt(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),n.push(Kc(this.serializer,o))}))}),_e.waitFor(i).next(()=>n)}removeMutationBatch(e,t){return Qk(e.he,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.sr(t.batchId)}),_e.forEach(n,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}sr(e){delete this.er[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return _e.resolve();const n=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return wd(e).te({range:n},(s,o,l)=>{if(s[0]===this.userId){const d=Co(s[1]);i.push(d)}else l.done()}).next(()=>{rt(i.length===0,56720,{_r:i.map(s=>s.canonicalString())})})})}containsKey(e,t){return Xk(e,this.userId,t)}ar(e){return Jk(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:eu,lastStreamToken:""})}}function Xk(r,e,t){const n=vg(e,t.path),i=n[1],s=IDBKeyRange.lowerBound(n);let o=!1;return wd(r).te({range:s,ee:!0},(l,d,f)=>{const[m,p,g]=l;m===e&&p===i&&(o=!0),f.done()}).next(()=>o)}function Cl(r){return gr(r,so)}function wd(r){return gr(r,Ld)}function Jk(r){return gr(r,Zf)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new pu(0)}static lr(){return new pu(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w6{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.hr(e).next(t=>{const n=new pu(t.highestTargetId);return t.highestTargetId=n.next(),this.Pr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.hr(e).next(t=>at.fromTimestamp(new Ot(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.hr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.hr(e).next(i=>(i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Pr(e,i)))}addTargetData(e,t){return this.Tr(e,t).next(()=>this.hr(e).next(n=>(n.targetCount+=1,this.Ir(t,n),this.Pr(e,n))))}updateTargetData(e,t){return this.Tr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>md(e).delete(t.targetId)).next(()=>this.hr(e)).next(n=>(rt(n.targetCount>0,8065),n.targetCount-=1,this.Pr(e,n)))}removeTargets(e,t,n){let i=0;const s=[];return md(e).te((o,l)=>{const d=_f(l);d.sequenceNumber<=t&&n.get(d.targetId)===null&&(i++,s.push(this.removeTargetData(e,d)))}).next(()=>_e.waitFor(s)).next(()=>i)}forEachTarget(e,t){return md(e).te((n,i)=>{const s=_f(i);t(s)})}hr(e){return wT(e).get(Wg).next(t=>(rt(t!==null,2888),t))}Pr(e,t){return wT(e).put(Wg,t)}Tr(e,t){return md(e).put(Wk(this.serializer,t))}Ir(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.hr(e).next(t=>t.targetCount)}getTargetData(e,t){const n=du(t),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return md(e).te({range:i,index:$P},(o,l,d)=>{const f=_f(l);Im(t,f.target)&&(s=f,d.done())}).next(()=>s)}addMatchingKeys(e,t,n){const i=[],s=Fl(e);return t.forEach(o=>{const l=ti(o.path);i.push(s.put({targetId:n,path:l})),i.push(this.referenceDelegate.addReference(e,n,o))}),_e.waitFor(i)}removeMatchingKeys(e,t,n){const i=Fl(e);return _e.forEach(t,s=>{const o=ti(s.path);return _e.waitFor([i.delete([n,o]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,t){const n=Fl(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),i=Fl(e);let s=zt();return i.te({range:n,ee:!0},(o,l,d)=>{const f=Co(o[1]),m=new $e(f);s=s.add(m)}).next(()=>s)}containsKey(e,t){const n=ti(t.path),i=IDBKeyRange.bound([n],[MP(n)],!1,!0);let s=0;return Fl(e).te({index:wb,ee:!0,range:i},([o,l],d,f)=>{o!==0&&(s++,f.done())}).next(()=>s>0)}Rt(e,t){return md(e).get(t).next(n=>n?_f(n):null)}}function md(r){return gr(r,Fd)}function wT(r){return gr(r,tu)}function Fl(r){return gr(r,Vd)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ET="LruGarbageCollector",E6=1048576;function ST([r,e],[t,n]){const i=Et(r,t);return i===0?Et(e,n):i}class S6{constructor(e){this.Er=e,this.buffer=new gn(ST),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();ST(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class eC{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){je(ET,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){dc(t)?je(ET,"Ignoring IndexedDB error during garbage collection: ",t):await uc(t)}await this.mr(3e5)})}}class T6{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return _e.resolve(Bi.le);const n=new S6(t);return this.gr.forEachTarget(e,i=>n.Rr(i.sequenceNumber)).next(()=>this.gr.yr(e,i=>n.Rr(i))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.gr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(je("LruGarbageCollector","Garbage collection skipped; disabled"),_e.resolve(bT)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(je("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),bT):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let n,i,s,o,l,d,f;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(p=>(p>this.params.maximumSequenceNumbersToCollect?(je("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${p}`),i=this.params.maximumSequenceNumbersToCollect):i=p,o=Date.now(),this.nthSequenceNumber(e,i))).next(p=>(n=p,l=Date.now(),this.removeTargets(e,n,t))).next(p=>(s=p,d=Date.now(),this.removeOrphanedDocuments(e,n))).next(p=>(f=Date.now(),_d()<=$t.DEBUG&&je("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-m}ms
	Determined least recently used ${i} in `+(l-o)+`ms
	Removed ${s} targets in `+(d-l)+`ms
	Removed ${p} documents in `+(f-d)+`ms
Total Duration: ${f-m}ms`),_e.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:p})))}}function tC(r,e){return new T6(r,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6{constructor(e,t){this.db=e,this.garbageCollector=tC(this,t)}pr(e){const t=this.br(e);return this.db.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}br(e){let t=0;return this.yr(e,n=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}yr(e,t){return this.Sr(e,(n,i)=>t(i))}addReference(e,t,n){return Up(e,n)}removeReference(e,t,n){return Up(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Up(e,t)}Dr(e,t){return function(i,s){let o=!1;return Jk(i).ne(l=>Xk(i,l,s).next(d=>(d&&(o=!0),_e.resolve(!d)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,(o,l)=>{if(l<=t){const d=this.Dr(e,o).next(f=>{if(!f)return s++,n.getEntry(e,o).next(()=>(n.removeEntry(o,at.min()),Fl(e).delete(function(p){return[0,ti(p.path)]}(o))))});i.push(d)}}).next(()=>_e.waitFor(i)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Up(e,t)}Sr(e,t){const n=Fl(e);let i,s=Bi.le;return n.te({index:wb},([o,l],{path:d,sequenceNumber:f})=>{o===0?(s!==Bi.le&&t(new $e(Co(i)),s),s=f,i=d):s=Bi.le}).next(()=>{s!==Bi.le&&t(new $e(Co(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Up(r,e){return Fl(r).put(function(n,i){return{targetId:0,path:ti(n.path),sequenceNumber:i}}(e,r.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nC{constructor(){this.changes=new Va(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Dn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?_e.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N6{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Fc(e).put(n)}removeEntry(e,t,n){return Fc(e).delete(function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Qg(o),l[l.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.vr(e,n)))}getEntry(e,t){let n=Dn.newInvalidDocument(t);return Fc(e).te({index:_g,range:IDBKeyRange.only(Gh(t))},(i,s)=>{n=this.Cr(t,s)}).next(()=>n)}Fr(e,t){let n={size:0,document:Dn.newInvalidDocument(t)};return Fc(e).te({index:_g,range:IDBKeyRange.only(Gh(t))},(i,s)=>{n={document:this.Cr(t,s),size:Jg(s)}}).next(()=>n)}getEntries(e,t){let n=rs();return this.Mr(e,t,(i,s)=>{const o=this.Cr(i,s);n=n.insert(i,o)}).next(()=>n)}Or(e,t){let n=rs(),i=new Pn($e.comparator);return this.Mr(e,t,(s,o)=>{const l=this.Cr(s,o);n=n.insert(s,l),i=i.insert(s,Jg(o))}).next(()=>({documents:n,Nr:i}))}Mr(e,t,n){if(t.isEmpty())return _e.resolve();let i=new gn(NT);t.forEach(d=>i=i.add(d));const s=IDBKeyRange.bound(Gh(i.first()),Gh(i.last())),o=i.getIterator();let l=o.getNext();return Fc(e).te({index:_g,range:s},(d,f,m)=>{const p=$e.fromSegments([...f.prefixPath,f.collectionGroup,f.documentId]);for(;l&&NT(l,p)<0;)n(l,null),l=o.getNext();l&&l.isEqual(p)&&(n(l,f),l=o.hasNext()?o.getNext():null),l?m.H(Gh(l)):m.done()}).next(()=>{for(;l;)n(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,n,i,s){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),Qg(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],d=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Fc(e).J(IDBKeyRange.bound(l,d,!0)).next(f=>{s==null||s.incrementDocumentReadCount(f.length);let m=rs();for(const p of f){const g=this.Cr($e.fromSegments(p.prefixPath.concat(p.collectionGroup,p.documentId)),p);g.isFoundDocument()&&(km(t,g)||i.has(g.key))&&(m=m.insert(g.key,g))}return m})}getAllFromCollectionGroup(e,t,n,i){let s=rs();const o=AT(t,n),l=AT(t,os.max());return Fc(e).te({index:HP,range:IDBKeyRange.bound(o,l,!0)},(d,f,m)=>{const p=this.Cr($e.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);s=s.insert(p.key,p),s.size===i&&m.done()}).next(()=>s)}newChangeBuffer(e){return new I6(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return TT(e).get(dx).next(t=>(rt(!!t,20021),t))}vr(e,t){return TT(e).put(dx,t)}Cr(e,t){if(t){const n=h6(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(at.min())))return n}return Dn.newInvalidDocument(e)}}function rC(r){return new N6(r)}class I6 extends nC{constructor(e,t){super(),this.Br=e,this.trackRemovals=t,this.Lr=new Va(n=>n.toString(),(n,i)=>n.isEqual(i))}applyChanges(e){const t=[];let n=0,i=new gn((s,o)=>Et(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const l=this.Lr.get(s);if(t.push(this.Br.removeEntry(e,s,l.readTime)),o.isValidDocument()){const d=lT(this.Br.serializer,o);i=i.add(s.path.popLast());const f=Jg(d);n+=f-l.size,t.push(this.Br.addEntry(e,s,d))}else if(n-=l.size,this.trackRemovals){const d=lT(this.Br.serializer,o.convertToNoDocument(at.min()));t.push(this.Br.addEntry(e,s,d))}}),i.forEach(s=>{t.push(this.Br.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.Br.updateMetadata(e,n)),_e.waitFor(t)}getFromCache(e,t){return this.Br.Fr(e,t).next(n=>(this.Lr.set(t,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,t){return this.Br.Or(e,t).next(({documents:n,Nr:i})=>(i.forEach((s,o)=>{this.Lr.set(s,{size:o,readTime:n.get(s).readTime})}),n))}}function TT(r){return gr(r,Qf)}function Fc(r){return gr(r,$g)}function Gh(r){const e=r.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function AT(r,e){const t=e.documentKey.path.toArray();return[r,Qg(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function NT(r,e){const t=r.path.toArray(),n=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<n.length-2;++s)if(i=Et(t[s],n[s]),i)return i;return i=Et(t.length,n.length),i||(i=Et(t[t.length-2],n[n.length-2]),i||Et(t[t.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P6{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iC{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(n!==null&&Df(n.mutation,i,zi.empty(),Ot.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,zt()).next(()=>n))}getLocalViewOfDocuments(e,t,n=zt()){const i=Ro();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(s=>{let o=yf();return s.forEach((l,d)=>{o=o.insert(l,d.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=Ro();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,zt()))}populateOverlays(e,t,n){const i=[];return n.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,l)=>{t.set(o,l)})})}computeViews(e,t,n,i){let s=rs();const o=Of(),l=function(){return Of()}();return t.forEach((d,f)=>{const m=n.get(f.key);i.has(f.key)&&(m===void 0||m.mutation instanceof Ba)?s=s.insert(f.key,f):m!==void 0?(o.set(f.key,m.mutation.getFieldMask()),Df(m.mutation,f,m.mutation.getFieldMask(),Ot.now())):o.set(f.key,zi.empty())}),this.recalculateAndSaveOverlays(e,s).next(d=>(d.forEach((f,m)=>o.set(f,m)),t.forEach((f,m)=>{var p;return l.set(f,new P6(m,(p=o.get(f))!==null&&p!==void 0?p:null))}),l))}recalculateAndSaveOverlays(e,t){const n=Of();let i=new Pn((o,l)=>o-l),s=zt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const l of o)l.keys().forEach(d=>{const f=t.get(d);if(f===null)return;let m=n.get(d)||zi.empty();m=l.applyToLocalView(f,m),n.set(d,m);const p=(i.get(l.batchId)||zt()).add(d);i=i.insert(l.batchId,p)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const d=l.getNext(),f=d.key,m=d.value,p=Ek();m.forEach(g=>{if(!s.has(g)){const v=Pk(t.get(g),n.get(g));v!==null&&p.set(g,v),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,f,p))}return _e.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return function(o){return $e.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Pb(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):_e.resolve(Ro());let l=Md,d=s;return o.next(f=>_e.forEach(f,(m,p)=>(l<p.largestBatchId&&(l=p.largestBatchId),s.get(m)?_e.resolve():this.remoteDocumentCache.getEntry(e,m).next(g=>{d=d.insert(m,g)}))).next(()=>this.populateOverlays(e,f,s)).next(()=>this.computeViews(e,d,f,zt())).next(m=>({batchId:l,changes:wk(m)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new $e(t)).next(n=>{let i=yf();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const s=t.collectionGroup;let o=yf();return this.indexManager.getCollectionParents(e,s).next(l=>_e.forEach(l,d=>{const f=function(p,g){return new Au(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(t,d.child(s));return this.getDocumentsMatchingCollectionQuery(e,f,n,i).next(m=>{m.forEach((p,g)=>{o=o.insert(p,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,i))).next(o=>{s.forEach((d,f)=>{const m=f.getKey();o.get(m)===null&&(o=o.insert(m,Dn.newInvalidDocument(m)))});let l=yf();return o.forEach((d,f)=>{const m=s.get(d);m!==void 0&&Df(m.mutation,f,zi.empty(),Ot.now()),km(t,f)&&(l=l.insert(d,f))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k6{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return _e.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:Ar(i.createTime)}}(t)),_e.resolve()}getNamedQuery(e,t){return _e.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(i){return{name:i.name,query:Gk(i.bundledQuery),readTime:Ar(i.readTime)}}(t)),_e.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class C6{constructor(){this.overlays=new Pn($e.comparator),this.Qr=new Map}getOverlay(e,t){return _e.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Ro();return _e.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,s)=>{this.St(e,t,s)}),_e.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.Qr.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Qr.delete(n)),_e.resolve()}getOverlaysForCollection(e,t,n){const i=Ro(),s=t.length+1,o=new $e(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const d=l.getNext().value,f=d.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===s&&d.largestBatchId>n&&i.set(d.getKey(),d)}return _e.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new Pn((f,m)=>f-m);const o=this.overlays.getIterator();for(;o.hasNext();){const f=o.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>n){let m=s.get(f.largestBatchId);m===null&&(m=Ro(),s=s.insert(f.largestBatchId,m)),m.set(f.getKey(),f)}}const l=Ro(),d=s.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((f,m)=>l.set(f,m)),!(l.size()>=i)););return _e.resolve(l)}St(e,t,n){const i=this.overlays.get(n.key);if(i!==null){const o=this.Qr.get(i.largestBatchId).delete(n.key);this.Qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new Mb(t,n));let s=this.Qr.get(t);s===void 0&&(s=zt(),this.Qr.set(t,s)),this.Qr.set(t,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R6{constructor(){this.sessionToken=Jn.EMPTY_BYTE_STRING}getSessionToken(e){return _e.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,_e.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{constructor(){this.$r=new gn(Sr.Ur),this.Kr=new gn(Sr.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const n=new Sr(e,t);this.$r=this.$r.add(n),this.Kr=this.Kr.add(n)}Gr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.zr(new Sr(e,t))}jr(e,t){e.forEach(n=>this.removeReference(n,t))}Hr(e){const t=new $e(new Jt([])),n=new Sr(t,e),i=new Sr(t,e+1),s=[];return this.Kr.forEachInRange([n,i],o=>{this.zr(o),s.push(o.key)}),s}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new $e(new Jt([])),n=new Sr(t,e),i=new Sr(t,e+1);let s=zt();return this.Kr.forEachInRange([n,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new Sr(e,0),n=this.$r.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class Sr{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return $e.comparator(e.key,t.key)||Et(e.Zr,t.Zr)}static Wr(e,t){return Et(e.Zr,t.Zr)||$e.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new gn(Sr.Ur)}checkEmpty(e){return _e.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){const s=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Ob(s,t,n,i);this.mutationQueue.push(o);for(const l of i)this.Xr=this.Xr.add(new Sr(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return _e.resolve(o)}lookupMutationBatch(e,t){return _e.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.ti(n),s=i<0?0:i;return _e.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return _e.resolve(this.mutationQueue.length===0?eu:this.nr-1)}getAllMutationBatches(e){return _e.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Sr(t,0),i=new Sr(t,Number.POSITIVE_INFINITY),s=[];return this.Xr.forEachInRange([n,i],o=>{const l=this.ei(o.Zr);s.push(l)}),_e.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new gn(Et);return t.forEach(i=>{const s=new Sr(i,0),o=new Sr(i,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([s,o],l=>{n=n.add(l.Zr)})}),_e.resolve(this.ni(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;$e.isDocumentKey(s)||(s=s.child(""));const o=new Sr(new $e(s),0);let l=new gn(Et);return this.Xr.forEachWhile(d=>{const f=d.key.path;return!!n.isPrefixOf(f)&&(f.length===i&&(l=l.add(d.Zr)),!0)},o),_e.resolve(this.ni(l))}ni(e){const t=[];return e.forEach(n=>{const i=this.ei(n);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){rt(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Xr;return _e.forEach(t.mutations,i=>{const s=new Sr(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Xr=n})}sr(e){}containsKey(e,t){const n=new Sr(t,0),i=this.Xr.firstAfterOrEqual(n);return _e.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,_e.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O6{constructor(e){this.ii=e,this.docs=function(){return new Pn($e.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,o=this.ii(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return _e.resolve(n?n.document.mutableCopy():Dn.newInvalidDocument(t))}getEntries(e,t){let n=rs();return t.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Dn.newInvalidDocument(i))}),_e.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=rs();const o=t.path,l=new $e(o.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(l);for(;d.hasNext();){const{key:f,value:{document:m}}=d.getNext();if(!o.isPrefixOf(f.path))break;f.path.length>o.length+1||xb(FP(m),n)<=0||(i.has(m.key)||km(t,m))&&(s=s.insert(m.key,m.mutableCopy()))}return _e.resolve(s)}getAllFromCollectionGroup(e,t,n,i){Ze(9500)}si(e,t){return _e.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new D6(this)}getSize(e){return _e.resolve(this.size)}}class D6 extends nC{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.Br.addEntry(e,i)):this.Br.removeEntry(n)}),_e.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M6{constructor(e){this.persistence=e,this.oi=new Va(t=>du(t),Im),this.lastRemoteSnapshotVersion=at.min(),this.highestTargetId=0,this._i=0,this.ai=new Ub,this.targetCount=0,this.ui=pu.cr()}forEachTarget(e,t){return this.oi.forEach((n,i)=>t(i)),_e.resolve()}getLastRemoteSnapshotVersion(e){return _e.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return _e.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),_e.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this._i&&(this._i=t),_e.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new pu(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,_e.resolve()}updateTargetData(e,t){return this.Tr(t),_e.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,_e.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.oi.forEach((o,l)=>{l.sequenceNumber<=t&&n.get(l.targetId)===null&&(this.oi.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),_e.waitFor(s).next(()=>i)}getTargetCount(e){return _e.resolve(this.targetCount)}getTargetData(e,t){const n=this.oi.get(t)||null;return _e.resolve(n)}addMatchingKeys(e,t,n){return this.ai.Gr(t,n),_e.resolve()}removeMatchingKeys(e,t,n){this.ai.jr(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),_e.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),_e.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ai.Yr(t);return _e.resolve(n)}containsKey(e,t){return _e.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qb{constructor(e,t){this.ci={},this.overlays={},this.li=new Bi(0),this.hi=!1,this.hi=!0,this.Pi=new R6,this.referenceDelegate=e(this),this.Ti=new M6(this),this.indexManager=new x6,this.remoteDocumentCache=function(i){return new O6(i)}(n=>this.referenceDelegate.Ii(n)),this.serializer=new $k(t),this.Ei=new k6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new C6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ci[e.toKey()];return n||(n=new j6(t,this.referenceDelegate),this.ci[e.toKey()]=n),n}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,n){je("MemoryPersistence","Starting transaction:",e);const i=new L6(this.li.next());return this.referenceDelegate.di(),n(i).next(s=>this.referenceDelegate.Ai(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ri(e,t){return _e.or(Object.values(this.ci).map(n=>()=>n.containsKey(e,t)))}}class L6 extends BP{constructor(e){super(),this.currentSequenceNumber=e}}class Uy{constructor(e){this.persistence=e,this.Vi=new Ub,this.mi=null}static fi(e){return new Uy(e)}get gi(){if(this.mi)return this.mi;throw Ze(60996)}addReference(e,t,n){return this.Vi.addReference(n,t),this.gi.delete(n.toString()),_e.resolve()}removeReference(e,t,n){return this.Vi.removeReference(n,t),this.gi.add(n.toString()),_e.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),_e.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(i=>this.gi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.gi.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return _e.forEach(this.gi,n=>{const i=$e.fromPath(n);return this.pi(e,i).next(s=>{s||t.removeEntry(i,at.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(n=>{n?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return _e.or([()=>_e.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class ey{constructor(e,t){this.persistence=e,this.yi=new Va(n=>ti(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=tC(this,t)}static fi(e,t){return new ey(e,t)}di(){}Ai(e){return _e.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}br(e){let t=0;return this.yr(e,n=>{t++}).next(()=>t)}yr(e,t){return _e.forEach(this.yi,(n,i)=>this.Dr(e,n,i).next(s=>s?_e.resolve():t(i)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.si(e,o=>this.Dr(e,o,t).next(l=>{l||(n++,s.removeEntry(o,at.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),_e.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.yi.set(n,e.currentSequenceNumber),_e.resolve()}removeReference(e,t,n){return this.yi.set(n,e.currentSequenceNumber),_e.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),_e.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=bg(e.data.value)),t}Dr(e,t,n){return _e.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.yi.get(t);return _e.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F6{constructor(e){this.serializer=e}q(e,t,n,i){const s=new ky("createOrUpgrade",t);n<1&&i>=1&&(function(d){d.createObjectStore(Nm)}(e),function(d){d.createObjectStore(Zf,{keyPath:ZD}),d.createObjectStore(so,{keyPath:FS,autoIncrement:!0}).createIndex(Xc,VS,{unique:!0}),d.createObjectStore(Ld)}(e),IT(e),function(d){d.createObjectStore(Hc)}(e));let o=_e.resolve();return n<3&&i>=3&&(n!==0&&(function(d){d.deleteObjectStore(Vd),d.deleteObjectStore(Fd),d.deleteObjectStore(tu)}(e),IT(e)),o=o.next(()=>function(d){const f=d.store(tu),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:at.min().toTimestamp(),targetCount:0};return f.put(Wg,m)}(s))),n<4&&i>=4&&(n!==0&&(o=o.next(()=>function(d,f){return f.store(so).J().next(p=>{d.deleteObjectStore(so),d.createObjectStore(so,{keyPath:FS,autoIncrement:!0}).createIndex(Xc,VS,{unique:!0});const g=f.store(so),v=p.map(E=>g.put(E));return _e.waitFor(v)})}(e,s))),o=o.next(()=>{(function(d){d.createObjectStore(Bd,{keyPath:sM})})(e)})),n<5&&i>=5&&(o=o.next(()=>this.wi(s))),n<6&&i>=6&&(o=o.next(()=>(function(d){d.createObjectStore(Qf)}(e),this.bi(s)))),n<7&&i>=7&&(o=o.next(()=>this.Si(s))),n<8&&i>=8&&(o=o.next(()=>this.Di(e,s))),n<9&&i>=9&&(o=o.next(()=>{(function(d){d.objectStoreNames.contains("remoteDocumentChanges")&&d.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&i>=10&&(o=o.next(()=>this.Ci(s))),n<11&&i>=11&&(o=o.next(()=>{(function(d){d.createObjectStore(Cy,{keyPath:oM})})(e),function(d){d.createObjectStore(Ry,{keyPath:aM})}(e)})),n<12&&i>=12&&(o=o.next(()=>{(function(d){const f=d.createObjectStore(jy,{keyPath:mM});f.createIndex(fx,pM,{unique:!1}),f.createIndex(KP,gM,{unique:!1})})(e)})),n<13&&i>=13&&(o=o.next(()=>function(d){const f=d.createObjectStore($g,{keyPath:XD});f.createIndex(_g,JD),f.createIndex(HP,eM)}(e)).next(()=>this.Fi(e,s)).next(()=>e.deleteObjectStore(Hc))),n<14&&i>=14&&(o=o.next(()=>this.Mi(e,s))),n<15&&i>=15&&(o=o.next(()=>function(d){d.createObjectStore(Eb,{keyPath:lM,autoIncrement:!0}).createIndex(hx,cM,{unique:!1}),d.createObjectStore(Cf,{keyPath:uM}).createIndex(WP,dM,{unique:!1}),d.createObjectStore(Rf,{keyPath:hM}).createIndex(GP,fM,{unique:!1})}(e))),n<16&&i>=16&&(o=o.next(()=>{t.objectStore(Cf).clear()}).next(()=>{t.objectStore(Rf).clear()})),n<17&&i>=17&&(o=o.next(()=>{(function(d){d.createObjectStore(Sb,{keyPath:yM})})(e)})),n<18&&i>=18&&L4()&&(o=o.next(()=>{t.objectStore(Cf).clear()}).next(()=>{t.objectStore(Rf).clear()})),o}bi(e){let t=0;return e.store(Hc).te((n,i)=>{t+=Jg(i)}).next(()=>{const n={byteSize:t};return e.store(Qf).put(dx,n)})}wi(e){const t=e.store(Zf),n=e.store(so);return t.J().next(i=>_e.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,eu],[s.userId,s.lastAcknowledgedBatchId]);return n.J(Xc,o).next(l=>_e.forEach(l,d=>{rt(d.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:d.batchId});const f=Kc(this.serializer,d);return Qk(e,s.userId,f).next(()=>{})}))}))}Si(e){const t=e.store(Vd),n=e.store(Hc);return e.store(tu).get(Wg).next(i=>{const s=[];return n.te((o,l)=>{const d=new Jt(o),f=function(p){return[0,ti(p)]}(d);s.push(t.get(f).next(m=>m?_e.resolve():(p=>t.put({targetId:0,path:ti(p),sequenceNumber:i.highestListenSequenceNumber}))(d)))}).next(()=>_e.waitFor(s))})}Di(e,t){e.createObjectStore(Xf,{keyPath:iM});const n=t.store(Xf),i=new zb,s=o=>{if(i.add(o)){const l=o.lastSegment(),d=o.popLast();return n.put({collectionId:l,parent:ti(d)})}};return t.store(Hc).te({ee:!0},(o,l)=>{const d=new Jt(o);return s(d.popLast())}).next(()=>t.store(Ld).te({ee:!0},([o,l,d],f)=>{const m=Co(l);return s(m.popLast())}))}Ci(e){const t=e.store(Fd);return t.te((n,i)=>{const s=_f(i),o=Wk(this.serializer,s);return t.put(o)})}Fi(e,t){const n=t.store(Hc),i=[];return n.te((s,o)=>{const l=t.store($g),d=function(p){return p.document?new $e(Jt.fromString(p.document.name).popFirst(5)):p.noDocument?$e.fromSegments(p.noDocument.path):p.unknownDocument?$e.fromSegments(p.unknownDocument.path):Ze(36783)}(o).path.toArray(),f={prefixPath:d.slice(0,d.length-2),collectionGroup:d[d.length-2],documentId:d[d.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(l.put(f))}).next(()=>_e.waitFor(i))}Mi(e,t){const n=t.store(so),i=rC(this.serializer),s=new qb(Uy.fi,this.serializer.wt);return n.J().next(o=>{const l=new Map;return o.forEach(d=>{var f;let m=(f=l.get(d.userId))!==null&&f!==void 0?f:zt();Kc(this.serializer,d).keys().forEach(p=>m=m.add(p)),l.set(d.userId,m)}),_e.forEach(l,(d,f)=>{const m=new Tr(f),p=By.bt(this.serializer,m),g=s.getIndexManager(m),v=zy.bt(m,this.serializer,g,s.referenceDelegate);return new iC(i,v,p,g).recalculateAndSaveOverlaysForDocumentKeys(new mx(t,Bi.le),d).next()})})}}function IT(r){r.createObjectStore(Vd,{keyPath:nM}).createIndex(wb,rM,{unique:!0}),r.createObjectStore(Fd,{keyPath:"targetId"}).createIndex($P,tM,{unique:!0}),r.createObjectStore(tu)}const Rl="IndexedDbPersistence",$v=18e5,Wv=5e3,Gv="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",V6="main";class Hb{constructor(e,t,n,i,s,o,l,d,f,m,p=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.xi=s,this.window=o,this.document=l,this.Oi=f,this.Ni=m,this.Bi=p,this.li=null,this.hi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Li=null,this.inForeground=!1,this.ki=null,this.qi=null,this.Qi=Number.NEGATIVE_INFINITY,this.$i=g=>Promise.resolve(),!Hb.C())throw new Ve(Ne.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new A6(this,i),this.Ui=t+V6,this.serializer=new $k(d),this.Ki=new Yl(this.Ui,this.Bi,new F6(this.serializer)),this.Pi=new m6,this.Ti=new w6(this.referenceDelegate,this.serializer),this.remoteDocumentCache=rC(this.serializer),this.Ei=new f6,this.window&&this.window.localStorage?this.Wi=this.window.localStorage:(this.Wi=null,m===!1&&Qn(Rl,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Gi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ve(Ne.FAILED_PRECONDITION,Gv);return this.zi(),this.ji(),this.Hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ti.getHighestSequenceNumber(e))}).then(e=>{this.li=new Bi(e,this.Oi)}).then(()=>{this.hi=!0}).catch(e=>(this.Ki&&this.Ki.close(),Promise.reject(e)))}Ji(e){return this.$i=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ki.U(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.xi.enqueueAndForget(async()=>{this.started&&await this.Gi()}))}Gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>qp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Yi(e).next(t=>{t||(this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)))})}).next(()=>this.Zi(e)).next(t=>this.isPrimary&&!t?this.Xi(e).next(()=>!1):!!t&&this.es(e).next(()=>!0))).catch(e=>{if(dc(e))return je(Rl,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return je(Rl,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.xi.enqueueRetryable(()=>this.$i(e)),this.isPrimary=e})}Yi(e){return Kh(e).get(cd).next(t=>_e.resolve(this.ts(t)))}ns(e){return qp(e).delete(this.clientId)}async rs(){if(this.isPrimary&&!this.ss(this.Qi,$v)){this.Qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const n=gr(t,Bd);return n.J().next(i=>{const s=this._s(i,$v),o=i.filter(l=>s.indexOf(l)===-1);return _e.forEach(o,l=>n.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Wi)for(const t of e)this.Wi.removeItem(this.us(t.clientId))}}Hi(){this.qi=this.xi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Gi().then(()=>this.rs()).then(()=>this.Hi()))}ts(e){return!!e&&e.ownerId===this.clientId}Zi(e){return this.Ni?_e.resolve(!0):Kh(e).get(cd).next(t=>{if(t!==null&&this.ss(t.leaseTimestampMs,Wv)&&!this.cs(t.ownerId)){if(this.ts(t)&&this.networkEnabled)return!0;if(!this.ts(t)){if(!t.allowTabSynchronization)throw new Ve(Ne.FAILED_PRECONDITION,Gv);return!1}}return!(!this.networkEnabled||!this.inForeground)||qp(e).J().next(n=>this._s(n,Wv).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,l=this.networkEnabled===i.networkEnabled;if(s||o&&l)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&je(Rl,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.hi=!1,this.ls(),this.qi&&(this.qi.cancel(),this.qi=null),this.hs(),this.Ps(),await this.Ki.runTransaction("shutdown","readwrite",[Nm,Bd],e=>{const t=new mx(e,Bi.le);return this.Xi(t).next(()=>this.ns(t))}),this.Ki.close(),this.Ts()}_s(e,t){return e.filter(n=>this.ss(n.updateTimeMs,t)&&!this.cs(n.clientId))}Is(){return this.runTransaction("getActiveClients","readonly",e=>qp(e).J().next(t=>this._s(t,$v).map(n=>n.clientId)))}get started(){return this.hi}getGlobalsCache(){return this.Pi}getMutationQueue(e,t){return zy.bt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new b6(e,this.serializer.wt.databaseId)}getDocumentOverlayCache(e){return By.bt(this.serializer,e)}getBundleCache(){return this.Ei}runTransaction(e,t,n){je(Rl,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=function(d){return d===18?xM:d===17?XP:d===16?_M:d===15?Tb:d===14?QP:d===13?ZP:d===12?vM:d===11?YP:void Ze(60245)}(this.Bi);let o;return this.Ki.runTransaction(e,i,s,l=>(o=new mx(l,this.li?this.li.next():Bi.le),t==="readwrite-primary"?this.Yi(o).next(d=>!!d||this.Zi(o)).next(d=>{if(!d)throw Qn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)),new Ve(Ne.FAILED_PRECONDITION,VP);return n(o)}).next(d=>this.es(o).next(()=>d)):this.Es(o).next(()=>n(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Es(e){return Kh(e).get(cd).next(t=>{if(t!==null&&this.ss(t.leaseTimestampMs,Wv)&&!this.cs(t.ownerId)&&!this.ts(t)&&!(this.Ni||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ve(Ne.FAILED_PRECONDITION,Gv)})}es(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Kh(e).put(cd,t)}static C(){return Yl.C()}Xi(e){const t=Kh(e);return t.get(cd).next(n=>this.ts(n)?(je(Rl,"Releasing primary lease."),t.delete(cd)):_e.resolve())}ss(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(Qn(`Detected an update time that is in the future: ${e} > ${n}`),!1))}zi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ki=()=>{this.xi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Gi()))},this.document.addEventListener("visibilitychange",this.ki),this.inForeground=this.document.visibilityState==="visible")}hs(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)}ji(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Li=()=>{this.ls();const t=/(?:Version|Mobile)\/1[456]/;M4()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.xi.enterRestrictedMode(!0),this.xi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Li))}Ps(){this.Li&&(this.window.removeEventListener("pagehide",this.Li),this.Li=null)}cs(e){var t;try{const n=((t=this.Wi)===null||t===void 0?void 0:t.getItem(this.us(e)))!==null;return je(Rl,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Qn(Rl,"Failed to get zombied client id.",n),!1}}ls(){if(this.Wi)try{this.Wi.setItem(this.us(this.clientId),String(Date.now()))}catch(e){Qn("Failed to set zombie client id.",e)}}Ts(){if(this.Wi)try{this.Wi.removeItem(this.us(this.clientId))}catch{}}us(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Kh(r){return gr(r,Nm)}function qp(r){return gr(r,Bd)}function sC(r,e){let t=r.projectId;return r.isDefaultDatabase||(t+="."+r.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.ds=n,this.As=i}static Rs(e,t){let n=zt(),i=zt();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new $b(e,t.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oC{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return M4()?8:zP(pr())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,n,i){const s={result:null};return this.ws(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.bs(e,t,i,n).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new B6;return this.Ss(e,t,o).next(l=>{if(s.result=l,this.fs)return this.Ds(e,t,o,l.size)})}).next(()=>s.result)}Ds(e,t,n,i){return n.documentReadCount<this.gs?(_d()<=$t.DEBUG&&je("QueryEngine","SDK will not create cache indexes for query:",xd(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),_e.resolve()):(_d()<=$t.DEBUG&&je("QueryEngine","Query:",xd(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.ps*i?(_d()<=$t.DEBUG&&je("QueryEngine","The SDK decides to create cache indexes for query:",xd(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,is(t))):_e.resolve())}ws(e,t){if(XS(t))return _e.resolve(null);let n=is(t);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Zg(t,null,"F"),n=is(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=zt(...s);return this.ys.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(d=>{const f=this.vs(t,l);return this.Cs(t,f,o,d.readTime)?this.ws(e,Zg(t,null,"F")):this.Fs(e,f,t,d)}))})))}bs(e,t,n,i){return XS(t)||i.isEqual(at.min())?_e.resolve(null):this.ys.getDocuments(e,n).next(s=>{const o=this.vs(t,s);return this.Cs(t,o,n,i)?_e.resolve(null):(_d()<=$t.DEBUG&&je("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),xd(t)),this.Fs(e,o,t,LP(i,Md)).next(l=>l))})}vs(e,t){let n=new gn(xk(e));return t.forEach((i,s)=>{km(e,s)&&(n=n.add(s))}),n}Cs(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,n){return _d()<=$t.DEBUG&&je("QueryEngine","Using full collection scan to execute query:",xd(t)),this.ys.getDocumentsMatchingQuery(e,t,os.min(),n)}Fs(e,t,n,i){return this.ys.getDocumentsMatchingQuery(e,n,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wb="LocalStore",z6=3e8;class U6{constructor(e,t,n,i){this.persistence=e,this.Ms=t,this.serializer=i,this.xs=new Pn(Et),this.Os=new Va(s=>du(s),Im),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(n)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new iC(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function aC(r,e,t,n){return new U6(r,e,t,n)}async function lC(r,e){const t=Je(r);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,t.Ls(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],l=[];let d=zt();for(const f of i){o.push(f.batchId);for(const m of f.mutations)d=d.add(m.key)}for(const f of s){l.push(f.batchId);for(const m of f.mutations)d=d.add(m.key)}return t.localDocuments.getDocuments(n,d).next(f=>({ks:f,removedBatchIds:o,addedBatchIds:l}))})})}function q6(r,e){const t=Je(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=t.Bs.newChangeBuffer({trackRemovals:!0});return function(l,d,f,m){const p=f.batch,g=p.keys();let v=_e.resolve();return g.forEach(E=>{v=v.next(()=>m.getEntry(d,E)).next(x=>{const b=f.docVersions.get(E);rt(b!==null,48541),x.version.compareTo(b)<0&&(p.applyToRemoteDocument(x,f),x.isValidDocument()&&(x.setReadTime(f.commitVersion),m.addEntry(x)))})}),v.next(()=>l.mutationQueue.removeMutationBatch(d,p))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let d=zt();for(let f=0;f<l.mutationResults.length;++f)l.mutationResults[f].transformResults.length>0&&(d=d.add(l.batch.mutations[f].key));return d}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}function cC(r){const e=Je(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function H6(r,e){const t=Je(r),n=e.snapshotVersion;let i=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.Bs.newChangeBuffer({trackRemovals:!0});i=t.xs;const l=[];e.targetChanges.forEach((m,p)=>{const g=i.get(p);if(!g)return;l.push(t.Ti.removeMatchingKeys(s,m.removedDocuments,p).next(()=>t.Ti.addMatchingKeys(s,m.addedDocuments,p)));let v=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(p)!==null?v=v.withResumeToken(Jn.EMPTY_BYTE_STRING,at.min()).withLastLimboFreeSnapshotVersion(at.min()):m.resumeToken.approximateByteSize()>0&&(v=v.withResumeToken(m.resumeToken,n)),i=i.insert(p,v),function(x,b,S){return x.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=z6?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(g,v,m)&&l.push(t.Ti.updateTargetData(s,v))});let d=rs(),f=zt();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(s,m))}),l.push($6(s,o,e.documentUpdates).next(m=>{d=m.qs,f=m.Qs})),!n.isEqual(at.min())){const m=t.Ti.getLastRemoteSnapshotVersion(s).next(p=>t.Ti.setTargetsMetadata(s,s.currentSequenceNumber,n));l.push(m)}return _e.waitFor(l).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,d,f)).next(()=>d)}).then(s=>(t.xs=i,s))}function $6(r,e,t){let n=zt(),i=zt();return t.forEach(s=>n=n.add(s)),e.getEntries(r,n).next(s=>{let o=rs();return t.forEach((l,d)=>{const f=s.get(l);d.isFoundDocument()!==f.isFoundDocument()&&(i=i.add(l)),d.isNoDocument()&&d.version.isEqual(at.min())?(e.removeEntry(l,d.readTime),o=o.insert(l,d)):!f.isValidDocument()||d.version.compareTo(f.version)>0||d.version.compareTo(f.version)===0&&f.hasPendingWrites?(e.addEntry(d),o=o.insert(l,d)):je(Wb,"Ignoring outdated watch update for ",l,". Current version:",f.version," Watch version:",d.version)}),{qs:o,Qs:i}})}function W6(r,e){const t=Je(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=eu),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function ty(r,e){const t=Je(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Ti.getTargetData(n,e).next(s=>s?(i=s,_e.resolve(i)):t.Ti.allocateTargetId(n).next(o=>(i=new Sa(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Ti.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.xs.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.xs=t.xs.insert(n.targetId,n),t.Os.set(e,n.targetId)),n})}async function Gd(r,e,t){const n=Je(r),i=n.xs.get(e),s=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!dc(o))throw o;je(Wb,`Failed to update sequence numbers for target ${e}: ${o}`)}n.xs=n.xs.remove(e),n.Os.delete(i.target)}function Ix(r,e,t){const n=Je(r);let i=at.min(),s=zt();return n.persistence.runTransaction("Execute query","readwrite",o=>function(d,f,m){const p=Je(d),g=p.Os.get(m);return g!==void 0?_e.resolve(p.xs.get(g)):p.Ti.getTargetData(f,m)}(n,o,is(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,n.Ti.getMatchingKeysForTargetId(o,l.targetId).next(d=>{s=d})}).next(()=>n.Ms.getDocumentsMatchingQuery(o,e,t?i:at.min(),t?s:zt())).next(l=>(hC(n,_k(e),l),{documents:l,$s:s})))}function uC(r,e){const t=Je(r),n=Je(t.Ti),i=t.xs.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>n.Rt(s,e).next(o=>o?o.target:null))}function dC(r,e){const t=Je(r),n=t.Ns.get(e)||at.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Bs.getAllFromCollectionGroup(i,e,LP(n,Md),Number.MAX_SAFE_INTEGER)).then(i=>(hC(t,e,i),i))}function hC(r,e,t){let n=r.Ns.get(e)||at.min();t.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),r.Ns.set(e,n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fC="firestore_clients";function PT(r,e){return`${fC}_${r}_${e}`}const mC="firestore_mutations";function kT(r,e,t){let n=`${mC}_${r}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}const pC="firestore_targets";function Kv(r,e){return`${pC}_${r}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ko="SharedClientState";class ny{constructor(e,t,n,i){this.user=e,this.batchId=t,this.state=n,this.error=i}static Gs(e,t,n){const i=JSON.parse(n);let s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new Ve(i.error.code,i.error.message))),o?new ny(e,t,i.state,s):(Qn(ko,`Failed to parse mutation state for ID '${t}': ${n}`),null)}zs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Mf{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Gs(e,t){const n=JSON.parse(t);let i,s=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return s&&n.error&&(s=typeof n.error.message=="string"&&typeof n.error.code=="string",s&&(i=new Ve(n.error.code,n.error.message))),s?new Mf(e,n.state,i):(Qn(ko,`Failed to parse target state for ID '${e}': ${t}`),null)}zs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class ry{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Gs(e,t){const n=JSON.parse(t);let i=typeof n=="object"&&n.activeTargetIds instanceof Array,s=kb();for(let o=0;i&&o<n.activeTargetIds.length;++o)i=UP(n.activeTargetIds[o]),s=s.add(n.activeTargetIds[o]);return i?new ry(e,s):(Qn(ko,`Failed to parse client data for instance '${e}': ${t}`),null)}}class Gb{constructor(e,t){this.clientId=e,this.onlineState=t}static Gs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Gb(t.clientId,t.onlineState):(Qn(ko,`Failed to parse online state: ${e}`),null)}}class Px{constructor(){this.activeTargetIds=kb()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Yv{constructor(e,t,n,i,s){this.window=e,this.xi=t,this.persistenceKey=n,this.Js=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ys=this.Zs.bind(this),this.Xs=new Pn(Et),this.started=!1,this.eo=[];const o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.no=PT(this.persistenceKey,this.Js),this.ro=function(d){return`firestore_sequence_number_${d}`}(this.persistenceKey),this.Xs=this.Xs.insert(this.Js,new Px),this.io=new RegExp(`^${fC}_${o}_([^_]*)$`),this.so=new RegExp(`^${mC}_${o}_(\\d+)(?:_(.*))?$`),this.oo=new RegExp(`^${pC}_${o}_(\\d+)$`),this._o=function(d){return`firestore_online_state_${d}`}(this.persistenceKey),this.ao=function(d){return`firestore_bundle_loaded_v2_${d}`}(this.persistenceKey),this.window.addEventListener("storage",this.Ys)}static C(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Is();for(const n of e){if(n===this.Js)continue;const i=this.getItem(PT(this.persistenceKey,n));if(i){const s=ry.Gs(n,i);s&&(this.Xs=this.Xs.insert(s.clientId,s))}}this.uo();const t=this.storage.getItem(this._o);if(t){const n=this.co(t);n&&this.lo(n)}for(const n of this.eo)this.Zs(n);this.eo=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ro,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ho(this.Xs)}isActiveQueryTarget(e){let t=!1;return this.Xs.forEach((n,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Po(e,"pending")}updateMutationState(e,t,n){this.Po(e,t,n),this.To(e)}addLocalQueryTarget(e,t=!0){let n="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(Kv(this.persistenceKey,e));if(i){const s=Mf.Gs(e,i);s&&(n=s.state)}}return t&&this.Io.js(e),this.uo(),n}removeLocalQueryTarget(e){this.Io.Hs(e),this.uo()}isLocalQueryTarget(e){return this.Io.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Kv(this.persistenceKey,e))}updateQueryState(e,t,n){this.Eo(e,t,n)}handleUserChange(e,t,n){t.forEach(i=>{this.To(i)}),this.currentUser=e,n.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Ao(e)}notifyBundleLoaded(e){this.Ro(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Ys),this.removeItem(this.no),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return je(ko,"READ",e,t),t}setItem(e,t){je(ko,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){je(ko,"REMOVE",e),this.storage.removeItem(e)}Zs(e){const t=e;if(t.storageArea===this.storage){if(je(ko,"EVENT",t.key,t.newValue),t.key===this.no)return void Qn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.xi.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.io.test(t.key)){if(t.newValue==null){const n=this.Vo(t.key);return this.mo(n,null)}{const n=this.fo(t.key,t.newValue);if(n)return this.mo(n.clientId,n)}}else if(this.so.test(t.key)){if(t.newValue!==null){const n=this.po(t.key,t.newValue);if(n)return this.yo(n)}}else if(this.oo.test(t.key)){if(t.newValue!==null){const n=this.wo(t.key,t.newValue);if(n)return this.bo(n)}}else if(t.key===this._o){if(t.newValue!==null){const n=this.co(t.newValue);if(n)return this.lo(n)}}else if(t.key===this.ro){const n=function(s){let o=Bi.le;if(s!=null)try{const l=JSON.parse(s);rt(typeof l=="number",30636,{So:s}),o=l}catch(l){Qn(ko,"Failed to read sequence number from WebStorage",l)}return o}(t.newValue);n!==Bi.le&&this.sequenceNumberHandler(n)}else if(t.key===this.ao){const n=this.Do(t.newValue);await Promise.all(n.map(i=>this.syncEngine.vo(i)))}}}else this.eo.push(t)})}}get Io(){return this.Xs.get(this.Js)}uo(){this.setItem(this.no,this.Io.zs())}Po(e,t,n){const i=new ny(this.currentUser,e,t,n),s=kT(this.persistenceKey,this.currentUser,e);this.setItem(s,i.zs())}To(e){const t=kT(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Ao(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this._o,JSON.stringify(t))}Eo(e,t,n){const i=Kv(this.persistenceKey,e),s=new Mf(e,t,n);this.setItem(i,s.zs())}Ro(e){const t=JSON.stringify(Array.from(e));this.setItem(this.ao,t)}Vo(e){const t=this.io.exec(e);return t?t[1]:null}fo(e,t){const n=this.Vo(e);return ry.Gs(n,t)}po(e,t){const n=this.so.exec(e),i=Number(n[1]),s=n[2]!==void 0?n[2]:null;return ny.Gs(new Tr(s),i,t)}wo(e,t){const n=this.oo.exec(e),i=Number(n[1]);return Mf.Gs(i,t)}co(e){return Gb.Gs(e)}Do(e){return JSON.parse(e)}async yo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);je(ko,`Ignoring mutation for non-active user ${e.user.uid}`)}bo(e){return this.syncEngine.Fo(e.targetId,e.state,e.error)}mo(e,t){const n=t?this.Xs.insert(e,t):this.Xs.remove(e),i=this.ho(this.Xs),s=this.ho(n),o=[],l=[];return s.forEach(d=>{i.has(d)||o.push(d)}),i.forEach(d=>{s.has(d)||l.push(d)}),this.syncEngine.Mo(o,l).then(()=>{this.Xs=n})}lo(e){this.Xs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ho(e){let t=kb();return e.forEach((n,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class gC{constructor(){this.xo=new Px,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,n){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new Px,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G6{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CT="ConnectivityMonitor";class RT{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){je(CT,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){je(CT,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Hp=null;function kx(){return Hp===null?Hp=function(){return 268435456+Math.round(2147483648*Math.random())}():Hp++,"0x"+Hp.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zv="RestConnection",K6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Y6{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${n}/databases/${i}`,this.Go=this.databaseId.database===Gg?`project_id=${n}`:`project_id=${n}&database_id=${i}`}zo(e,t,n,i,s){const o=kx(),l=this.jo(e,t.toUriEncodedString());je(Zv,`Sending RPC '${e}' ${o}:`,l,n);const d={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(d,i,s);const{host:f}=new URL(l),m=Su(f);return this.Jo(e,l,d,n,m).then(p=>(je(Zv,`Received RPC '${e}' ${o}: `,p),p),p=>{throw lu(Zv,`RPC '${e}' ${o} failed with error: `,p,"url: ",l,"request:",n),p})}Yo(e,t,n,i,s,o){return this.zo(e,t,n,i,s)}Ho(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+nh}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),n&&n.headers.forEach((i,s)=>e[s]=i)}jo(e,t){const n=K6[e];return`${this.Ko}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z6{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zr="WebChannelConnection";class Q6 extends Y6{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,i,s){const o=kx();return new Promise((l,d)=>{const f=new NP;f.setWithCredentials(!0),f.listenOnce(IP.COMPLETE,()=>{try{switch(f.getLastErrorCode()){case gg.NO_ERROR:const p=f.getResponseJson();je(Zr,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(p)),l(p);break;case gg.TIMEOUT:je(Zr,`RPC '${e}' ${o} timed out`),d(new Ve(Ne.DEADLINE_EXCEEDED,"Request time out"));break;case gg.HTTP_ERROR:const g=f.getStatus();if(je(Zr,`RPC '${e}' ${o} failed with status:`,g,"response text:",f.getResponseText()),g>0){let v=f.getResponseJson();Array.isArray(v)&&(v=v[0]);const E=v==null?void 0:v.error;if(E&&E.status&&E.message){const x=function(S){const N=S.toLowerCase().replace(/_/g,"-");return Object.values(Ne).indexOf(N)>=0?N:Ne.UNKNOWN}(E.status);d(new Ve(x,E.message))}else d(new Ve(Ne.UNKNOWN,"Server responded with status "+f.getStatus()))}else d(new Ve(Ne.UNAVAILABLE,"Connection failed."));break;default:Ze(9055,{h_:e,streamId:o,P_:f.getLastErrorCode(),T_:f.getLastError()})}}finally{je(Zr,`RPC '${e}' ${o} completed.`)}});const m=JSON.stringify(i);je(Zr,`RPC '${e}' ${o} sending request:`,i),f.send(t,"POST",m,n,15)})}I_(e,t,n){const i=kx(),s=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=CP(),l=kP(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(d.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Ho(d.initMessageHeaders,t,n),d.encodeInitMessageHeaders=!0;const m=s.join("");je(Zr,`Creating RPC '${e}' stream ${i}: ${m}`,d);const p=o.createWebChannel(m,d);this.E_(p);let g=!1,v=!1;const E=new Z6({Zo:b=>{v?je(Zr,`Not sending because RPC '${e}' stream ${i} is closed:`,b):(g||(je(Zr,`Opening RPC '${e}' stream ${i} transport.`),p.open(),g=!0),je(Zr,`RPC '${e}' stream ${i} sending:`,b),p.send(b))},Xo:()=>p.close()}),x=(b,S,N)=>{b.listen(S,R=>{try{N(R)}catch(I){setTimeout(()=>{throw I},0)}})};return x(p,gf.EventType.OPEN,()=>{v||(je(Zr,`RPC '${e}' stream ${i} transport opened.`),E.__())}),x(p,gf.EventType.CLOSE,()=>{v||(v=!0,je(Zr,`RPC '${e}' stream ${i} transport closed`),E.u_(),this.d_(p))}),x(p,gf.EventType.ERROR,b=>{v||(v=!0,lu(Zr,`RPC '${e}' stream ${i} transport errored. Name:`,b.name,"Message:",b.message),E.u_(new Ve(Ne.UNAVAILABLE,"The operation could not be completed")))}),x(p,gf.EventType.MESSAGE,b=>{var S;if(!v){const N=b.data[0];rt(!!N,16349);const R=N,I=(R==null?void 0:R.error)||((S=R[0])===null||S===void 0?void 0:S.error);if(I){je(Zr,`RPC '${e}' stream ${i} received error:`,I);const j=I.status;let U=function(F){const O=ar[F];if(O!==void 0)return Rk(O)}(j),P=I.message;U===void 0&&(U=Ne.INTERNAL,P="Unknown error status: "+j+" with message "+I.message),v=!0,E.u_(new Ve(U,P)),p.close()}else je(Zr,`RPC '${e}' stream ${i} received:`,N),E.c_(N)}}),x(l,PP.STAT_EVENT,b=>{b.stat===ax.PROXY?je(Zr,`RPC '${e}' stream ${i} detected buffering proxy`):b.stat===ax.NOPROXY&&je(Zr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.a_()},0),E}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yC(){return typeof window<"u"?window:null}function Ag(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qy(r){return new e6(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kb{constructor(e,t,n=1e3,i=1.5,s=6e4){this.xi=e,this.timerId=t,this.A_=n,this.R_=i,this.V_=s,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),n=Math.max(0,Date.now()-this.g_),i=Math.max(0,t-n);i>0&&je("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,i,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jT="PersistentStream";class vC{constructor(e,t,n,i,s,o,l,d){this.xi=e,this.S_=n,this.D_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=d,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new Kb(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===Ne.RESOURCE_EXHAUSTED?(Qn(t.toString()),Qn("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===Ne.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.v_===t&&this.z_(n,i)},n=>{e(()=>{const i=new Ve(Ne.UNKNOWN,"Fetching auth token failed: "+n.message);return this.j_(i)})})}z_(e,t){const n=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{n(()=>this.listener.e_())}),this.stream.n_(()=>{n(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(i=>{n(()=>this.j_(i))}),this.stream.onMessage(i=>{n(()=>++this.M_==1?this.J_(i):this.onNext(i))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return je(jT,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(je(jT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class X6 extends vC{constructor(e,t,n,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=i6(this.serializer,e),n=function(s){if(!("targetChange"in s))return at.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?at.min():o.readTime?Ar(o.readTime):at.min()}(e);return this.listener.Y_(t,n)}Z_(e){const t={};t.database=Ex(this.serializer),t.addTarget=function(s,o){let l;const d=o.target;if(l=Kg(d)?{documents:Bk(s,d)}:{query:Vb(s,d).gt},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=Dk(s,o.resumeToken);const f=bx(s,o.expectedCount);f!==null&&(l.expectedCount=f)}else if(o.snapshotVersion.compareTo(at.min())>0){l.readTime=Wd(s,o.snapshotVersion.toTimestamp());const f=bx(s,o.expectedCount);f!==null&&(l.expectedCount=f)}return l}(this.serializer,e);const n=a6(this.serializer,e);n&&(t.labels=n),this.Q_(t)}X_(e){const t={};t.database=Ex(this.serializer),t.removeTarget=e,this.Q_(t)}}class J6 extends vC{constructor(e,t,n,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return rt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,rt(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){rt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=s6(e.writeResults,e.commitTime),n=Ar(e.commitTime);return this.listener.ra(n,t)}ia(){const e={};e.database=Ex(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>sm(this.serializer,n))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eL{}class tL extends eL{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.sa=!1}oa(){if(this.sa)throw new Ve(Ne.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,n,i){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.zo(e,wx(t,n),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ve(Ne.UNKNOWN,s.toString())})}Yo(e,t,n,i,s){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Yo(e,wx(t,n),i,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ve(Ne.UNKNOWN,o.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class nL{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Qn(t),this.ua=!1):je("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gu="RemoteStore";class rL{constructor(e,t,n,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=s,this.Ra.No(o=>{n.enqueueAndForget(async()=>{Nu(this)&&(je(gu,"Restarting streams for network reachability change."),await async function(d){const f=Je(d);f.da.add(4),await jm(f),f.Va.set("Unknown"),f.da.delete(4),await Hy(f)}(this))})}),this.Va=new nL(n,i)}}async function Hy(r){if(Nu(r))for(const e of r.Aa)await e(!0)}async function jm(r){for(const e of r.Aa)await e(!1)}function $y(r,e){const t=Je(r);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),Qb(t)?Zb(t):oh(t).N_()&&Yb(t,e))}function Kd(r,e){const t=Je(r),n=oh(t);t.Ea.delete(e),n.N_()&&_C(t,e),t.Ea.size===0&&(n.N_()?n.k_():Nu(t)&&t.Va.set("Unknown"))}function Yb(r,e){if(r.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(at.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}oh(r).Z_(e)}function _C(r,e){r.ma.Ke(e),oh(r).X_(e)}function Zb(r){r.ma=new ZM({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>r.Ea.get(e)||null,Pt:()=>r.datastore.serializer.databaseId}),oh(r).start(),r.Va.ca()}function Qb(r){return Nu(r)&&!oh(r).O_()&&r.Ea.size>0}function Nu(r){return Je(r).da.size===0}function xC(r){r.ma=void 0}async function iL(r){r.Va.set("Online")}async function sL(r){r.Ea.forEach((e,t)=>{Yb(r,e)})}async function oL(r,e){xC(r),Qb(r)?(r.Va.Pa(e),Zb(r)):r.Va.set("Unknown")}async function aL(r,e,t){if(r.Va.set("Online"),e instanceof Ok&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const l of s.targetIds)i.Ea.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.Ea.delete(l),i.ma.removeTarget(l))}(r,e)}catch(n){je(gu,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await iy(r,n)}else if(e instanceof Sg?r.ma.Xe(e):e instanceof jk?r.ma.ot(e):r.ma.nt(e),!t.isEqual(at.min()))try{const n=await cC(r.localStore);t.compareTo(n)>=0&&await function(s,o){const l=s.ma.It(o);return l.targetChanges.forEach((d,f)=>{if(d.resumeToken.approximateByteSize()>0){const m=s.Ea.get(f);m&&s.Ea.set(f,m.withResumeToken(d.resumeToken,o))}}),l.targetMismatches.forEach((d,f)=>{const m=s.Ea.get(d);if(!m)return;s.Ea.set(d,m.withResumeToken(Jn.EMPTY_BYTE_STRING,m.snapshotVersion)),_C(s,d);const p=new Sa(m.target,d,f,m.sequenceNumber);Yb(s,p)}),s.remoteSyncer.applyRemoteEvent(l)}(r,t)}catch(n){je(gu,"Failed to raise snapshot:",n),await iy(r,n)}}async function iy(r,e,t){if(!dc(e))throw e;r.da.add(1),await jm(r),r.Va.set("Offline"),t||(t=()=>cC(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{je(gu,"Retrying IndexedDB access"),await t(),r.da.delete(1),await Hy(r)})}function bC(r,e){return e().catch(t=>iy(r,t,e))}async function sh(r){const e=Je(r),t=rc(e);let n=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:eu;for(;lL(e);)try{const i=await W6(e.localStore,n);if(i===null){e.Ia.length===0&&t.k_();break}n=i.batchId,cL(e,i)}catch(i){await iy(e,i)}wC(e)&&EC(e)}function lL(r){return Nu(r)&&r.Ia.length<10}function cL(r,e){r.Ia.push(e);const t=rc(r);t.N_()&&t.ea&&t.ta(e.mutations)}function wC(r){return Nu(r)&&!rc(r).O_()&&r.Ia.length>0}function EC(r){rc(r).start()}async function uL(r){rc(r).ia()}async function dL(r){const e=rc(r);for(const t of r.Ia)e.ta(t.mutations)}async function hL(r,e,t){const n=r.Ia.shift(),i=Db.from(n,e,t);await bC(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),await sh(r)}async function fL(r,e){e&&rc(r).ea&&await async function(n,i){if(function(o){return Ck(o)&&o!==Ne.ABORTED}(i.code)){const s=n.Ia.shift();rc(n).L_(),await bC(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await sh(n)}}(r,e),wC(r)&&EC(r)}async function OT(r,e){const t=Je(r);t.asyncQueue.verifyOperationInProgress(),je(gu,"RemoteStore received new credentials");const n=Nu(t);t.da.add(3),await jm(t),n&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await Hy(t)}async function Cx(r,e){const t=Je(r);e?(t.da.delete(2),await Hy(t)):e||(t.da.add(2),await jm(t),t.Va.set("Unknown"))}function oh(r){return r.fa||(r.fa=function(t,n,i){const s=Je(t);return s.oa(),new X6(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{e_:iL.bind(null,r),n_:sL.bind(null,r),i_:oL.bind(null,r),Y_:aL.bind(null,r)}),r.Aa.push(async e=>{e?(r.fa.L_(),Qb(r)?Zb(r):r.Va.set("Unknown")):(await r.fa.stop(),xC(r))})),r.fa}function rc(r){return r.ga||(r.ga=function(t,n,i){const s=Je(t);return s.oa(),new J6(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{e_:()=>Promise.resolve(),n_:uL.bind(null,r),i_:fL.bind(null,r),na:dL.bind(null,r),ra:hL.bind(null,r)}),r.Aa.push(async e=>{e?(r.ga.L_(),await sh(r)):(await r.ga.stop(),r.Ia.length>0&&(je(gu,`Stopping write stream with ${r.Ia.length} pending writes`),r.Ia=[]))})),r.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xb{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new Ps,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,s){const o=Date.now()+n,l=new Xb(e,t,o,i,s);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ve(Ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Jb(r,e){if(Qn("AsyncQueue",`${e}: ${r}`),dc(r))return new Ve(Ne.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd{static emptySet(e){return new Cd(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||$e.comparator(t.key,n.key):(t,n)=>$e.comparator(t.key,n.key),this.keyedMap=yf(),this.sortedSet=new Pn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Cd)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new Cd;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DT{constructor(){this.pa=new Pn($e.comparator)}track(e){const t=e.doc.key,n=this.pa.get(t);n?e.type!==0&&n.type===3?this.pa=this.pa.insert(t,e):e.type===3&&n.type!==1?this.pa=this.pa.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.pa=this.pa.remove(t):e.type===1&&n.type===2?this.pa=this.pa.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):Ze(63341,{Vt:e,ya:n}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,n)=>{e.push(n)}),e}}class Yd{constructor(e,t,n,i,s,o,l,d,f){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=d,this.hasCachedResults=f}static fromInitialDocuments(e,t,n,i,s){const o=[];return t.forEach(l=>{o.push({type:0,doc:l})}),new Yd(e,t,Cd.emptySet(t),o,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ly(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mL{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class pL{constructor(){this.queries=MT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const i=Je(t),s=i.queries;i.queries=MT(),s.forEach((o,l)=>{for(const d of l.Sa)d.onError(n)})})(this,new Ve(Ne.ABORTED,"Firestore shutting down"))}}function MT(){return new Va(r=>vk(r),Ly)}async function e2(r,e){const t=Je(r);let n=3;const i=e.query;let s=t.queries.get(i);s?!s.Da()&&e.va()&&(n=2):(s=new mL,n=e.va()?0:1);try{switch(n){case 0:s.ba=await t.onListen(i,!0);break;case 1:s.ba=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const l=Jb(o,`Initialization of query '${xd(e.query)}' failed`);return void e.onError(l)}t.queries.set(i,s),s.Sa.push(e),e.Fa(t.onlineState),s.ba&&e.Ma(s.ba)&&n2(t)}async function t2(r,e){const t=Je(r),n=e.query;let i=3;const s=t.queries.get(n);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.va()?0:1:!s.Da()&&e.va()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function gL(r,e){const t=Je(r);let n=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const l of o.Sa)l.Ma(i)&&(n=!0);o.ba=i}}n&&n2(t)}function yL(r,e,t){const n=Je(r),i=n.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);n.queries.delete(e)}function n2(r){r.Ca.forEach(e=>{e.next()})}var Rx,LT;(LT=Rx||(Rx={})).xa="default",LT.Cache="cache";class r2{constructor(e,t,n){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=n||{}}Ma(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Yd(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const n=t!=="Offline";return(!this.options.Qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=Yd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==Rx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SC{constructor(e){this.key=e}}class TC{constructor(e){this.key=e}}class vL{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=zt(),this.mutatedKeys=zt(),this.Za=xk(e),this.Xa=new Cd(this.Za)}get eu(){return this.Ha}tu(e,t){const n=t?t.nu:new DT,i=t?t.Xa:this.Xa;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,l=!1;const d=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,f=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((m,p)=>{const g=i.get(m),v=km(this.query,p)?p:null,E=!!g&&this.mutatedKeys.has(g.key),x=!!v&&(v.hasLocalMutations||this.mutatedKeys.has(v.key)&&v.hasCommittedMutations);let b=!1;g&&v?g.data.isEqual(v.data)?E!==x&&(n.track({type:3,doc:v}),b=!0):this.ru(g,v)||(n.track({type:2,doc:v}),b=!0,(d&&this.Za(v,d)>0||f&&this.Za(v,f)<0)&&(l=!0)):!g&&v?(n.track({type:0,doc:v}),b=!0):g&&!v&&(n.track({type:1,doc:g}),b=!0,(d||f)&&(l=!0)),b&&(v?(o=o.add(v),s=x?s.add(m):s.delete(m)):(o=o.delete(m),s=s.delete(m)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const m=this.query.limitType==="F"?o.last():o.first();o=o.delete(m.key),s=s.delete(m.key),n.track({type:1,doc:m})}return{Xa:o,nu:n,Cs:l,mutatedKeys:s}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const s=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const o=e.nu.wa();o.sort((m,p)=>function(v,E){const x=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ze(20277,{Vt:b})}};return x(v)-x(E)}(m.type,p.type)||this.Za(m.doc,p.doc)),this.iu(n),i=i!=null&&i;const l=t&&!i?this.su():[],d=this.Ya.size===0&&this.current&&!i?1:0,f=d!==this.Ja;return this.Ja=d,o.length!==0||f?{snapshot:new Yd(this.query,e.Xa,s,o,e.mutatedKeys,d===0,f,!1,!!n&&n.resumeToken.approximateByteSize()>0),ou:l}:{ou:l}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new DT,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=zt(),this.Xa.forEach(n=>{this._u(n.key)&&(this.Ya=this.Ya.add(n.key))});const t=[];return e.forEach(n=>{this.Ya.has(n)||t.push(new TC(n))}),this.Ya.forEach(n=>{e.has(n)||t.push(new SC(n))}),t}au(e){this.Ha=e.$s,this.Ya=zt();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return Yd.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const ah="SyncEngine";class _L{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class xL{constructor(e){this.key=e,this.cu=!1}}class bL{constructor(e,t,n,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.lu={},this.hu=new Va(l=>vk(l),Ly),this.Pu=new Map,this.Tu=new Set,this.Iu=new Pn($e.comparator),this.Eu=new Map,this.du=new Ub,this.Au={},this.Ru=new Map,this.Vu=pu.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function wL(r,e,t=!0){const n=Wy(r);let i;const s=n.hu.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.uu()):i=await AC(n,e,t,!0),i}async function EL(r,e){const t=Wy(r);await AC(t,e,!0,!1)}async function AC(r,e,t,n){const i=await ty(r.localStore,is(e)),s=i.targetId,o=r.sharedClientState.addLocalQueryTarget(s,t);let l;return n&&(l=await i2(r,e,s,o==="current",i.resumeToken)),r.isPrimaryClient&&t&&$y(r.remoteStore,i),l}async function i2(r,e,t,n,i){r.fu=(p,g,v)=>async function(x,b,S,N){let R=b.view.tu(S);R.Cs&&(R=await Ix(x.localStore,b.query,!1).then(({documents:P})=>b.view.tu(P,R)));const I=N&&N.targetChanges.get(b.targetId),j=N&&N.targetMismatches.get(b.targetId)!=null,U=b.view.applyChanges(R,x.isPrimaryClient,I,j);return jx(x,b.targetId,U.ou),U.snapshot}(r,p,g,v);const s=await Ix(r.localStore,e,!0),o=new vL(e,s.$s),l=o.tu(s.documents),d=Rm.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),f=o.applyChanges(l,r.isPrimaryClient,d);jx(r,t,f.ou);const m=new _L(e,t,o);return r.hu.set(e,m),r.Pu.has(t)?r.Pu.get(t).push(e):r.Pu.set(t,[e]),f.snapshot}async function SL(r,e,t){const n=Je(r),i=n.hu.get(e),s=n.Pu.get(i.targetId);if(s.length>1)return n.Pu.set(i.targetId,s.filter(o=>!Ly(o,e))),void n.hu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Gd(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),t&&Kd(n.remoteStore,i.targetId),Zd(n,i.targetId)}).catch(uc)):(Zd(n,i.targetId),await Gd(n.localStore,i.targetId,!0))}async function TL(r,e){const t=Je(r),n=t.hu.get(e),i=t.Pu.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),Kd(t.remoteStore,n.targetId))}async function AL(r,e,t){const n=l2(r);try{const i=await function(o,l){const d=Je(o),f=Ot.now(),m=l.reduce((v,E)=>v.add(E.key),zt());let p,g;return d.persistence.runTransaction("Locally write mutations","readwrite",v=>{let E=rs(),x=zt();return d.Bs.getEntries(v,m).next(b=>{E=b,E.forEach((S,N)=>{N.isValidDocument()||(x=x.add(S))})}).next(()=>d.localDocuments.getOverlayedDocuments(v,E)).next(b=>{p=b;const S=[];for(const N of l){const R=WM(N,p.get(N.key).overlayedDocument);R!=null&&S.push(new Ba(N.key,R,lk(R.value.mapValue),Mn.exists(!0)))}return d.mutationQueue.addMutationBatch(v,f,S,l)}).next(b=>{g=b;const S=b.applyToLocalDocumentSet(p,x);return d.documentOverlayCache.saveOverlays(v,b.batchId,S)})}).then(()=>({batchId:g.batchId,changes:wk(p)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(o,l,d){let f=o.Au[o.currentUser.toKey()];f||(f=new Pn(Et)),f=f.insert(l,d),o.Au[o.currentUser.toKey()]=f}(n,i.batchId,t),await fc(n,i.changes),await sh(n.remoteStore)}catch(i){const s=Jb(i,"Failed to persist write");t.reject(s)}}async function NC(r,e){const t=Je(r);try{const n=await H6(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.Eu.get(s);o&&(rt(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.cu=!0:i.modifiedDocuments.size>0?rt(o.cu,14607):i.removedDocuments.size>0&&(rt(o.cu,42227),o.cu=!1))}),await fc(t,n,e)}catch(n){await uc(n)}}function FT(r,e,t){const n=Je(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const i=[];n.hu.forEach((s,o)=>{const l=o.view.Fa(e);l.snapshot&&i.push(l.snapshot)}),function(o,l){const d=Je(o);d.onlineState=l;let f=!1;d.queries.forEach((m,p)=>{for(const g of p.Sa)g.Fa(l)&&(f=!0)}),f&&n2(d)}(n.eventManager,e),i.length&&n.lu.Y_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function NL(r,e,t){const n=Je(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.Eu.get(e),s=i&&i.key;if(s){let o=new Pn($e.comparator);o=o.insert(s,Dn.newNoDocument(s,at.min()));const l=zt().add(s),d=new Cm(at.min(),new Map,new Pn(Et),o,l);await NC(n,d),n.Iu=n.Iu.remove(s),n.Eu.delete(e),a2(n)}else await Gd(n.localStore,e,!1).then(()=>Zd(n,e,t)).catch(uc)}async function IL(r,e){const t=Je(r),n=e.batch.batchId;try{const i=await q6(t.localStore,e);o2(t,n,null),s2(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await fc(t,i)}catch(i){await uc(i)}}async function PL(r,e,t){const n=Je(r);try{const i=await function(o,l){const d=Je(o);return d.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let m;return d.mutationQueue.lookupMutationBatch(f,l).next(p=>(rt(p!==null,37113),m=p.keys(),d.mutationQueue.removeMutationBatch(f,p))).next(()=>d.mutationQueue.performConsistencyCheck(f)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(f,m,l)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,m)).next(()=>d.localDocuments.getDocuments(f,m))})}(n.localStore,e);o2(n,e,t),s2(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await fc(n,i)}catch(i){await uc(i)}}function s2(r,e){(r.Ru.get(e)||[]).forEach(t=>{t.resolve()}),r.Ru.delete(e)}function o2(r,e,t){const n=Je(r);let i=n.Au[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.Au[n.currentUser.toKey()]=i}}function Zd(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.Pu.get(e))r.hu.delete(n),t&&r.lu.gu(n,t);r.Pu.delete(e),r.isPrimaryClient&&r.du.Hr(e).forEach(n=>{r.du.containsKey(n)||IC(r,n)})}function IC(r,e){r.Tu.delete(e.path.canonicalString());const t=r.Iu.get(e);t!==null&&(Kd(r.remoteStore,t),r.Iu=r.Iu.remove(e),r.Eu.delete(t),a2(r))}function jx(r,e,t){for(const n of t)n instanceof SC?(r.du.addReference(n.key,e),kL(r,n)):n instanceof TC?(je(ah,"Document no longer in limbo: "+n.key),r.du.removeReference(n.key,e),r.du.containsKey(n.key)||IC(r,n.key)):Ze(19791,{pu:n})}function kL(r,e){const t=e.key,n=t.path.canonicalString();r.Iu.get(t)||r.Tu.has(n)||(je(ah,"New document in limbo: "+t),r.Tu.add(n),a2(r))}function a2(r){for(;r.Tu.size>0&&r.Iu.size<r.maxConcurrentLimboResolutions;){const e=r.Tu.values().next().value;r.Tu.delete(e);const t=new $e(Jt.fromString(e)),n=r.Vu.next();r.Eu.set(n,new xL(t)),r.Iu=r.Iu.insert(t,n),$y(r.remoteStore,new Sa(is(Pm(t.path)),n,"TargetPurposeLimboResolution",Bi.le))}}async function fc(r,e,t){const n=Je(r),i=[],s=[],o=[];n.hu.isEmpty()||(n.hu.forEach((l,d)=>{o.push(n.fu(d,e,t).then(f=>{var m;if((f||t)&&n.isPrimaryClient){const p=f?!f.fromCache:(m=t==null?void 0:t.targetChanges.get(d.targetId))===null||m===void 0?void 0:m.current;n.sharedClientState.updateQueryState(d.targetId,p?"current":"not-current")}if(f){i.push(f);const p=$b.Rs(d.targetId,f);s.push(p)}}))}),await Promise.all(o),n.lu.Y_(i),await async function(d,f){const m=Je(d);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",p=>_e.forEach(f,g=>_e.forEach(g.ds,v=>m.persistence.referenceDelegate.addReference(p,g.targetId,v)).next(()=>_e.forEach(g.As,v=>m.persistence.referenceDelegate.removeReference(p,g.targetId,v)))))}catch(p){if(!dc(p))throw p;je(Wb,"Failed to update sequence numbers: "+p)}for(const p of f){const g=p.targetId;if(!p.fromCache){const v=m.xs.get(g),E=v.snapshotVersion,x=v.withLastLimboFreeSnapshotVersion(E);m.xs=m.xs.insert(g,x)}}}(n.localStore,s))}async function CL(r,e){const t=Je(r);if(!t.currentUser.isEqual(e)){je(ah,"User change. New user:",e.toKey());const n=await lC(t.localStore,e);t.currentUser=e,function(s,o){s.Ru.forEach(l=>{l.forEach(d=>{d.reject(new Ve(Ne.CANCELLED,o))})}),s.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await fc(t,n.ks)}}function RL(r,e){const t=Je(r),n=t.Eu.get(e);if(n&&n.cu)return zt().add(n.key);{let i=zt();const s=t.Pu.get(e);if(!s)return i;for(const o of s){const l=t.hu.get(o);i=i.unionWith(l.view.eu)}return i}}async function jL(r,e){const t=Je(r),n=await Ix(t.localStore,e.query,!0),i=e.view.au(n);return t.isPrimaryClient&&jx(t,e.targetId,i.ou),i}async function OL(r,e){const t=Je(r);return dC(t.localStore,e).then(n=>fc(t,n))}async function DL(r,e,t,n){const i=Je(r),s=await function(l,d){const f=Je(l),m=Je(f.mutationQueue);return f.persistence.runTransaction("Lookup mutation documents","readonly",p=>m.tr(p,d).next(g=>g?f.localDocuments.getDocuments(p,g):_e.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?await sh(i.remoteStore):t==="acknowledged"||t==="rejected"?(o2(i,e,n||null),s2(i,e),function(l,d){Je(Je(l).mutationQueue).sr(d)}(i.localStore,e)):Ze(6720,"Unknown batchState",{yu:t}),await fc(i,s)):je(ah,"Cannot apply mutation batch with id: "+e)}async function ML(r,e){const t=Je(r);if(Wy(t),l2(t),e===!0&&t.mu!==!0){const n=t.sharedClientState.getAllActiveQueryTargets(),i=await VT(t,n.toArray());t.mu=!0,await Cx(t.remoteStore,!0);for(const s of i)$y(t.remoteStore,s)}else if(e===!1&&t.mu!==!1){const n=[];let i=Promise.resolve();t.Pu.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?n.push(o):i=i.then(()=>(Zd(t,o),Gd(t.localStore,o,!0))),Kd(t.remoteStore,o)}),await i,await VT(t,n),function(o){const l=Je(o);l.Eu.forEach((d,f)=>{Kd(l.remoteStore,f)}),l.du.Jr(),l.Eu=new Map,l.Iu=new Pn($e.comparator)}(t),t.mu=!1,await Cx(t.remoteStore,!1)}}async function VT(r,e,t){const n=Je(r),i=[],s=[];for(const o of e){let l;const d=n.Pu.get(o);if(d&&d.length!==0){l=await ty(n.localStore,is(d[0]));for(const f of d){const m=n.hu.get(f),p=await jL(n,m);p.snapshot&&s.push(p.snapshot)}}else{const f=await uC(n.localStore,o);l=await ty(n.localStore,f),await i2(n,PC(f),o,!1,l.resumeToken)}i.push(l)}return n.lu.Y_(s),i}function PC(r){return gk(r.path,r.collectionGroup,r.orderBy,r.filters,r.limit,"F",r.startAt,r.endAt)}function LL(r){return function(t){return Je(Je(t).persistence).Is()}(Je(r).localStore)}async function FL(r,e,t,n){const i=Je(r);if(i.mu)return void je(ah,"Ignoring unexpected query state notification.");const s=i.Pu.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const o=await dC(i.localStore,_k(s[0])),l=Cm.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Jn.EMPTY_BYTE_STRING);await fc(i,o,l);break}case"rejected":await Gd(i.localStore,e,!0),Zd(i,e,n);break;default:Ze(64155,t)}}async function VL(r,e,t){const n=Wy(r);if(n.mu){for(const i of e){if(n.Pu.has(i)&&n.sharedClientState.isActiveQueryTarget(i)){je(ah,"Adding an already active target "+i);continue}const s=await uC(n.localStore,i),o=await ty(n.localStore,s);await i2(n,PC(s),o.targetId,!1,o.resumeToken),$y(n.remoteStore,o)}for(const i of t)n.Pu.has(i)&&await Gd(n.localStore,i,!1).then(()=>{Kd(n.remoteStore,i),Zd(n,i)}).catch(uc)}}function Wy(r){const e=Je(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=NC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=RL.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=NL.bind(null,e),e.lu.Y_=gL.bind(null,e.eventManager),e.lu.gu=yL.bind(null,e.eventManager),e}function l2(r){const e=Je(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=IL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=PL.bind(null,e),e}class om{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=qy(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return aC(this.persistence,new oC,e.initialUser,this.serializer)}Su(e){return new qb(Uy.fi,this.serializer)}bu(e){return new gC}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}om.provider={build:()=>new om};class BL extends om{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){rt(this.persistence.referenceDelegate instanceof ey,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new eC(n,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?Xr.withCacheSize(this.cacheSizeBytes):Xr.DEFAULT;return new qb(n=>ey.fi(n,t),this.serializer)}}class zL extends om{constructor(e,t,n){super(),this.Fu=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Fu.initialize(this,e),await l2(this.Fu.syncEngine),await sh(this.Fu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}Du(e){return aC(this.persistence,new oC,e.initialUser,this.serializer)}vu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new eC(n,e.asyncQueue,t)}Cu(e,t){const n=new KD(t,this.persistence);return new GD(e.asyncQueue,n)}Su(e){const t=sC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Xr.withCacheSize(this.cacheSizeBytes):Xr.DEFAULT;return new Hb(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,yC(),Ag(),this.serializer,this.sharedClientState,!!this.forceOwnership)}bu(e){return new gC}}class UL extends zL{constructor(e,t){super(e,t,!1),this.Fu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Fu.syncEngine;this.sharedClientState instanceof Yv&&(this.sharedClientState.syncEngine={Co:DL.bind(null,t),Fo:FL.bind(null,t),Mo:VL.bind(null,t),Is:LL.bind(null,t),vo:OL.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji(async n=>{await ML(this.Fu.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())})}bu(e){const t=yC();if(!Yv.C(t))throw new Ve(Ne.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=sC(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Yv(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class sy{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>FT(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=CL.bind(null,this.syncEngine),await Cx(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new pL}()}createDatastore(e){const t=qy(e.databaseInfo.databaseId),n=function(s){return new Q6(s)}(e.databaseInfo);return function(s,o,l,d){return new tL(s,o,l,d)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,i,s,o,l){return new rL(n,i,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,t=>FT(this.syncEngine,t,0),function(){return RT.C()?new RT:new G6}())}createSyncEngine(e,t){return function(i,s,o,l,d,f,m){const p=new bL(i,s,o,l,d,f);return m&&(p.mu=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=Je(i);je(gu,"RemoteStore shutting down."),s.da.add(5),await jm(s),s.Ra.shutdown(),s.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}sy.provider={build:()=>new sy};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class c2{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):Qn("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qL{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new Ve(Ne.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(i,s){const o=Je(i),l={documents:s.map(p=>im(o.serializer,p))},d=await o.Yo("BatchGetDocuments",o.serializer.databaseId,Jt.emptyPath(),l,s.length),f=new Map;d.forEach(p=>{const g=r6(o.serializer,p);f.set(g.key.toString(),g)});const m=[];return s.forEach(p=>{const g=f.get(p.toString());rt(!!g,55234,{key:p}),m.push(g)}),m}(this.datastore,e);return t.forEach(n=>this.recordVersion(n)),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(n){this.lastTransactionError=n}this.writtenDocs.add(e.toString())}delete(e){this.write(new ih(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach(t=>{e.delete(t.key.toString())}),e.forEach((t,n)=>{const i=$e.fromPath(n);this.mutations.push(new jb(i,this.precondition(i)))}),await async function(n,i){const s=Je(n),o={writes:i.map(l=>sm(s.serializer,l))};await s.zo("Commit",s.serializer.databaseId,Jt.emptyPath(),o)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw Ze(50498,{Uu:e.constructor.name});t=at.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new Ve(Ne.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(at.min())?Mn.exists(!1):Mn.updateTime(t):Mn.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(at.min()))throw new Ve(Ne.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Mn.updateTime(t)}return Mn.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class HL{constructor(e,t,n,i,s){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=i,this.deferred=s,this.Ku=n.maxAttempts,this.x_=new Kb(this.asyncQueue,"transaction_retry")}Wu(){this.Ku-=1,this.Gu()}Gu(){this.x_.y_(async()=>{const e=new qL(this.datastore),t=this.zu(e);t&&t.then(n=>{this.asyncQueue.enqueueAndForget(()=>e.commit().then(()=>{this.deferred.resolve(n)}).catch(i=>{this.ju(i)}))}).catch(n=>{this.ju(n)})})}zu(e){try{const t=this.updateFunction(e);return!Am(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(t){return this.deferred.reject(t),null}}ju(e){this.Ku>0&&this.Hu(e)?(this.Ku-=1,this.asyncQueue.enqueueAndForget(()=>(this.Gu(),Promise.resolve()))):this.deferred.reject(e)}Hu(e){if(e.name==="FirebaseError"){const t=e.code;return t==="aborted"||t==="failed-precondition"||t==="already-exists"||!Ck(t)}return!1}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ic="FirestoreClient";class $L{constructor(e,t,n,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=Tr.UNAUTHENTICATED,this.clientId=DP.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async o=>{je(ic,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(je(ic,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ps;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Jb(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function Qv(r,e){r.asyncQueue.verifyOperationInProgress(),je(ic,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(async i=>{n.isEqual(i)||(await lC(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}async function BT(r,e){r.asyncQueue.verifyOperationInProgress();const t=await WL(r);je(ic,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>OT(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>OT(e.remoteStore,i)),r._onlineComponents=e}async function WL(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){je(ic,"Using user provided OfflineComponentProvider");try{await Qv(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===Ne.FAILED_PRECONDITION||i.code===Ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;lu("Error using user provided cache. Falling back to memory cache: "+t),await Qv(r,new om)}}else je(ic,"Using default OfflineComponentProvider"),await Qv(r,new BL(void 0));return r._offlineComponents}async function u2(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(je(ic,"Using user provided OnlineComponentProvider"),await BT(r,r._uninitializedComponentsProvider._online)):(je(ic,"Using default OnlineComponentProvider"),await BT(r,new sy))),r._onlineComponents}function GL(r){return u2(r).then(e=>e.syncEngine)}function kC(r){return u2(r).then(e=>e.datastore)}async function oy(r){const e=await u2(r),t=e.eventManager;return t.onListen=wL.bind(null,e.syncEngine),t.onUnlisten=SL.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=EL.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=TL.bind(null,e.syncEngine),t}function KL(r,e,t={}){const n=new Ps;return r.asyncQueue.enqueueAndForget(async()=>function(s,o,l,d,f){const m=new c2({next:g=>{m.xu(),o.enqueueAndForget(()=>t2(s,p));const v=g.docs.has(l);!v&&g.fromCache?f.reject(new Ve(Ne.UNAVAILABLE,"Failed to get document because the client is offline.")):v&&g.fromCache&&d&&d.source==="server"?f.reject(new Ve(Ne.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(g)},error:g=>f.reject(g)}),p=new r2(Pm(l.path),m,{includeMetadataChanges:!0,Qa:!0});return e2(s,p)}(await oy(r),r.asyncQueue,e,t,n)),n.promise}function YL(r,e,t={}){const n=new Ps;return r.asyncQueue.enqueueAndForget(async()=>function(s,o,l,d,f){const m=new c2({next:g=>{m.xu(),o.enqueueAndForget(()=>t2(s,p)),g.fromCache&&d.source==="server"?f.reject(new Ve(Ne.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(g)},error:g=>f.reject(g)}),p=new r2(l,m,{includeMetadataChanges:!0,Qa:!0});return e2(s,p)}(await oy(r),r.asyncQueue,e,t,n)),n.promise}function ZL(r,e,t){const n=new Ps;return r.asyncQueue.enqueueAndForget(async()=>{try{const i=await kC(r);n.resolve(async function(o,l,d){var f;const m=Je(o),{request:p,yt:g,parent:v}=o6(m.serializer,OM(l),d);m.connection.Uo||delete p.parent;const E=(await m.Yo("RunAggregationQuery",m.serializer.databaseId,v,p,1)).filter(b=>!!b.result);rt(E.length===1,64727);const x=(f=E[0].result)===null||f===void 0?void 0:f.aggregateFields;return Object.keys(x).reduce((b,S)=>(b[g[S]]=x[S],b),{})}(i,e,t))}catch(i){n.reject(i)}}),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CC(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zT=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RC(r,e,t){if(!t)throw new Ve(Ne.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function QL(r,e,t,n){if(e===!0&&n===!0)throw new Ve(Ne.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function UT(r){if(!$e.isDocumentKey(r))throw new Ve(Ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function qT(r){if($e.isDocumentKey(r))throw new Ve(Ne.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function Gy(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":Ze(12329,{type:typeof r})}function Nr(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new Ve(Ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Gy(r);throw new Ve(Ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}function XL(r,e){if(e<=0)throw new Ve(Ne.INVALID_ARGUMENT,`Function ${r}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jC="firestore.googleapis.com",HT=!0;class $T{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Ve(Ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=jC,this.ssl=HT}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:HT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=Zk;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<E6)throw new Ve(Ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}QL("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=CC((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Ve(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Ve(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Ve(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ky{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new $T({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ve(Ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ve(Ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new $T(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new MD;switch(n.type){case"firstParty":return new BD(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ve(Ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=zT.get(t);n&&(je("ComponentProvider","Removing Datastore"),zT.delete(t),n.terminate())}(this),Promise.resolve()}}function JL(r,e,t,n={}){var i;r=Nr(r,Ky);const s=Su(e),o=r._getSettings(),l=Object.assign(Object.assign({},o),{emulatorOptions:r._getEmulatorOptions()}),d=`${e}:${t}`;s&&(ib(`https://${d}`),sb("Firestore",!0)),o.host!==jC&&o.host!==d&&lu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f=Object.assign(Object.assign({},o),{host:d,ssl:s,emulatorOptions:n});if(!Xl(f,l)&&(r._setSettings(f),n.mockUserToken)){let m,p;if(typeof n.mockUserToken=="string")m=n.mockUserToken,p=Tr.MOCK_USER;else{m=$5(n.mockUserToken,(i=r._app)===null||i===void 0?void 0:i.options.projectId);const g=n.mockUserToken.sub||n.mockUserToken.user_id;if(!g)throw new Ve(Ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Tr(g)}r._authCredentials=new LD(new jP(m,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zo{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new zo(this.firestore,e,this._query)}}class Fr{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Zl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Fr(this.firestore,e,this._key)}}class Zl extends zo{constructor(e,t,n){super(e,t,Pm(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Fr(this.firestore,null,new $e(e))}withConverter(e){return new Zl(this.firestore,e,this._path)}}function ct(r,e,...t){if(r=In(r),RC("collection","path",e),r instanceof Ky){const n=Jt.fromString(e,...t);return qT(n),new Zl(r,null,n)}{if(!(r instanceof Fr||r instanceof Zl))throw new Ve(Ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Jt.fromString(e,...t));return qT(n),new Zl(r.firestore,null,n)}}function Lt(r,e,...t){if(r=In(r),arguments.length===1&&(e=DP.newId()),RC("doc","path",e),r instanceof Ky){const n=Jt.fromString(e,...t);return UT(n),new Fr(r,null,new $e(n))}{if(!(r instanceof Fr||r instanceof Zl))throw new Ve(Ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(Jt.fromString(e,...t));return UT(n),new Fr(r.firestore,r instanceof Zl?r.converter:null,new $e(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WT="AsyncQueue";class GT{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new Kb(this,"async_queue_retry"),this.rc=()=>{const n=Ag();n&&je(WT,"Visibility state changed to "+n.visibilityState),this.x_.b_()},this.sc=e;const t=Ag();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=Ag();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new Ps;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!dc(e))throw e;je(WT,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(n=>{throw this.Xu=n,this.ec=!1,Qn("INTERNAL UNHANDLED ERROR: ",KT(n)),n}).then(n=>(this.ec=!1,n))));return this.sc=t,t}enqueueAfterDelay(e,t,n){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const i=Xb.createAndSchedule(this,e,t,n,s=>this.uc(s));return this.Zu.push(i),i}oc(){this.Xu&&Ze(47125,{cc:KT(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function KT(r){let e=r.message||"";return r.stack&&(e=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YT(r){return function(t,n){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(r,["next","error","complete"])}class as extends Ky{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new GT,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new GT(e),this._firestoreClient=void 0,await e}}}function e8(r,e){const t=typeof r=="object"?r:Ty(),n=typeof r=="string"?r:Gg,i=Sy(t,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=R4("firestore");s&&JL(i,...s)}return i}function Iu(r){if(r._terminated)throw new Ve(Ne.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||OC(r),r._firestoreClient}function OC(r){var e,t,n;const i=r._freezeSettings(),s=function(l,d,f,m){return new EM(l,d,f,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,CC(m.experimentalLongPollingOptions),m.useFetchStreams,m.isUsingEmulator)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,i);r._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(r._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),r._firestoreClient=new $L(r._authCredentials,r._appCheckCredentials,r._queue,s,r._componentsProvider&&function(l){const d=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(d),_online:d}}(r._componentsProvider))}async function t8(r){lu("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=r._freezeSettings();n8(r,sy.provider,{build:t=>new UL(t,e.cacheSizeBytes)})}function n8(r,e,t){if((r=Nr(r,as))._firestoreClient||r._terminated)throw new Ve(Ne.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(r._componentsProvider||r._getSettings().localCache)throw new Ve(Ne.FAILED_PRECONDITION,"SDK cache is already specified.");r._componentsProvider={_online:e,_offline:t},OC(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r8{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class i8{constructor(e,t,n){this._userDataWriter=t,this._data=n,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yu{constructor(e){this._byteString=e}static fromBase64String(e){try{return new yu(Jn.fromBase64String(e))}catch(t){throw new Ve(Ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new yu(Jn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pu{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ve(Ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Un(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function DC(){return new Pu(cx)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lh{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d2{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ve(Ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ve(Ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Et(this._lat,e._lat)||Et(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h2{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s8=/^__.*__$/;class o8{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Ba(e,this.data,this.fieldMask,t,this.fieldTransforms):new rh(e,this.data,t,this.fieldTransforms)}}class MC{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Ba(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function LC(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ze(40011,{Ic:r})}}class Yy{constructor(e,t,n,i,s,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.Ec(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new Yy(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.dc({path:n,Rc:!1});return i.Vc(e),i}mc(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.dc({path:n,Rc:!1});return i.Ec(),i}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return ay(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(LC(this.Ic)&&s8.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class a8{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||qy(e)}bc(e,t,n,i=!1){return new Yy({Ic:e,methodName:t,wc:n,path:Un.emptyPath(),Rc:!1,yc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ku(r){const e=r._freezeSettings(),t=qy(r._databaseId);return new a8(r._databaseId,!!e.ignoreUndefinedProperties,t)}function Zy(r,e,t,n,i,s={}){const o=r.bc(s.merge||s.mergeFields?2:0,e,t,i);y2("Data must be an object, but it was:",o,n);const l=VC(n,o);let d,f;if(s.merge)d=new zi(o.fieldMask),f=o.fieldTransforms;else if(s.mergeFields){const m=[];for(const p of s.mergeFields){const g=Ox(e,p,t);if(!o.contains(g))throw new Ve(Ne.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);zC(m,g)||m.push(g)}d=new zi(m),f=o.fieldTransforms.filter(p=>d.covers(p.field))}else d=null,f=o.fieldTransforms;return new o8(new Lr(l),d,f)}class Qy extends lh{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Qy}}function l8(r,e,t){return new Yy({Ic:3,wc:e.settings.wc,methodName:r._methodName,Rc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class f2 extends lh{_toFieldTransform(e){return new Rb(e.path,new Hd)}isEqual(e){return e instanceof f2}}class m2 extends lh{constructor(e,t){super(e),this.Sc=t}_toFieldTransform(e){const t=l8(this,e,!0),n=this.Sc.map(s=>ch(s,t)),i=new hu(n);return new Rb(e.path,i)}isEqual(e){return e instanceof m2&&Xl(this.Sc,e.Sc)}}function p2(r,e,t,n){const i=r.bc(1,e,t);y2("Data must be an object, but it was:",i,n);const s=[],o=Lr.empty();hc(n,(d,f)=>{const m=v2(e,d,t);f=In(f);const p=i.mc(m);if(f instanceof Qy)s.push(m);else{const g=ch(f,p);g!=null&&(s.push(m),o.set(m,g))}});const l=new zi(s);return new MC(o,l,i.fieldTransforms)}function g2(r,e,t,n,i,s){const o=r.bc(1,e,t),l=[Ox(e,n,t)],d=[i];if(s.length%2!=0)throw new Ve(Ne.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)l.push(Ox(e,s[g])),d.push(s[g+1]);const f=[],m=Lr.empty();for(let g=l.length-1;g>=0;--g)if(!zC(f,l[g])){const v=l[g];let E=d[g];E=In(E);const x=o.mc(v);if(E instanceof Qy)f.push(v);else{const b=ch(E,x);b!=null&&(f.push(v),m.set(v,b))}}const p=new zi(f);return new MC(m,p,o.fieldTransforms)}function FC(r,e,t,n=!1){return ch(t,r.bc(n?4:3,e))}function ch(r,e){if(BC(r=In(r)))return y2("Unsupported field value:",e,r),VC(r,e);if(r instanceof lh)return function(n,i){if(!LC(i.Ic))throw i.gc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.gc(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(n,i){const s=[];let o=0;for(const l of n){let d=ch(l,i.fc(o));d==null&&(d={nullValue:"NULL_VALUE"}),s.push(d),o++}return{arrayValue:{values:s}}}(r,e)}return function(n,i){if((n=In(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return BM(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Ot.fromDate(n);return{timestampValue:Wd(i.serializer,s)}}if(n instanceof Ot){const s=new Ot(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Wd(i.serializer,s)}}if(n instanceof d2)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof yu)return{bytesValue:Dk(i.serializer,n._byteString)};if(n instanceof Fr){const s=i.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw i.gc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Fb(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof h2)return function(o,l){return{mapValue:{fields:{[Ab]:{stringValue:Nb},[zd]:{arrayValue:{values:o.toArray().map(f=>{if(typeof f!="number")throw l.gc("VectorValues must only contain numeric values.");return Cb(l.serializer,f)})}}}}}}(n,i);throw i.gc(`Unsupported field value: ${Gy(n)}`)}(r,e)}function VC(r,e){const t={};return JP(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):hc(r,(n,i)=>{const s=ch(i,e.Ac(n));s!=null&&(t[n]=s)}),{mapValue:{fields:t}}}function BC(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof Ot||r instanceof d2||r instanceof yu||r instanceof Fr||r instanceof lh||r instanceof h2)}function y2(r,e,t){if(!BC(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const n=Gy(t);throw n==="an object"?e.gc(r+" a custom object"):e.gc(r+" "+n)}}function Ox(r,e,t){if((e=In(e))instanceof Pu)return e._internalPath;if(typeof e=="string")return v2(r,e);throw ay("Field path arguments must be of type string or ",r,!1,void 0,t)}const c8=new RegExp("[~\\*/\\[\\]]");function v2(r,e,t){if(e.search(c8)>=0)throw ay(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new Pu(...e.split("."))._internalPath}catch{throw ay(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function ay(r,e,t,n,i){const s=n&&!n.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let d="";return(s||o)&&(d+=" (found",s&&(d+=` in field ${n}`),o&&(d+=` in document ${i}`),d+=")"),new Ve(Ne.INVALID_ARGUMENT,l+r+d)}function zC(r,e){return r.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class am{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Fr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new u8(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Xy("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class u8 extends am{data(){return super.data()}}function Xy(r,e){return typeof e=="string"?v2(r,e):e instanceof Pu?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UC(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new Ve(Ne.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class _2{}class Jy extends _2{}function pt(r,e,...t){let n=[];e instanceof _2&&n.push(e),n=n.concat(t),function(s){const o=s.filter(d=>d instanceof x2).length,l=s.filter(d=>d instanceof e0).length;if(o>1||o>0&&l>0)throw new Ve(Ne.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)r=i._apply(r);return r}class e0 extends Jy{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new e0(e,t,n)}_apply(e){const t=this._parse(e);return qC(e._query,t),new zo(e.firestore,e.converter,xx(e._query,t))}_parse(e){const t=ku(e.firestore);return function(s,o,l,d,f,m,p){let g;if(f.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new Ve(Ne.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){QT(p,m);const E=[];for(const x of p)E.push(ZT(d,s,x));g={arrayValue:{values:E}}}else g=ZT(d,s,p)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||QT(p,m),g=FC(l,o,p,m==="in"||m==="not-in");return Wt.create(f,m,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function St(r,e,t){const n=e,i=Xy("where",r);return e0._create(i,n,t)}class x2 extends _2{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new x2(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:pn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i;const l=s.getFlattenedFilters();for(const d of l)qC(o,d),o=xx(o,d)}(e._query,t),new zo(e.firestore,e.converter,xx(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class b2 extends Jy{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new b2(e,t)}_apply(e){const t=function(i,s,o){if(i.startAt!==null)throw new Ve(Ne.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Ve(Ne.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new nm(s,o)}(e._query,this._field,this._direction);return new zo(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Au(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function Gn(r,e="asc"){const t=e,n=Xy("orderBy",r);return b2._create(n,t)}class w2 extends Jy{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new w2(e,t,n)}_apply(e){return new zo(e.firestore,e.converter,Zg(e._query,this._limit,this._limitType))}}function vu(r){return XL("limit",r),w2._create("limit",r,"F")}class E2 extends Jy{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new E2(e,t,n)}_apply(e){const t=h8(e,this.type,this._docOrFields,this._inclusive);return new zo(e.firestore,e.converter,function(i,s){return new Au(i.path,i.collectionGroup,i.explicitOrderBy.slice(),i.filters.slice(),i.limit,i.limitType,s,i.endAt)}(e._query,t))}}function d8(...r){return E2._create("startAfter",r,!1)}function h8(r,e,t,n){if(t[0]=In(t[0]),t[0]instanceof am)return function(s,o,l,d,f){if(!d)throw new Ve(Ne.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${l}().`);const m=[];for(const p of kd(s))if(p.field.isKeyField())m.push(uu(o,d.key));else{const g=d.data.field(p.field);if(Oy(g))throw new Ve(Ne.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+p.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(g===null){const v=p.field.canonicalString();throw new Ve(Ne.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${v}' (used as the orderBy) does not exist.`)}m.push(g)}return new nc(m,f)}(r._query,r.firestore._databaseId,e,t[0]._document,n);{const i=ku(r.firestore);return function(o,l,d,f,m,p){const g=o.explicitOrderBy;if(m.length>g.length)throw new Ve(Ne.INVALID_ARGUMENT,`Too many arguments provided to ${f}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const v=[];for(let E=0;E<m.length;E++){const x=m[E];if(g[E].field.isKeyField()){if(typeof x!="string")throw new Ve(Ne.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${f}(), but got a ${typeof x}`);if(!Pb(o)&&x.indexOf("/")!==-1)throw new Ve(Ne.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${f}() must be a plain document ID, but '${x}' contains a slash.`);const b=o.path.child(Jt.fromString(x));if(!$e.isDocumentKey(b))throw new Ve(Ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${f}() must result in a valid document path, but '${b}' is not because it contains an odd number of segments.`);const S=new $e(b);v.push(uu(l,S))}else{const b=FC(d,f,x);v.push(b)}}return new nc(v,p)}(r._query,r.firestore._databaseId,i,e,t,n)}}function ZT(r,e,t){if(typeof(t=In(t))=="string"){if(t==="")throw new Ve(Ne.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Pb(e)&&t.indexOf("/")!==-1)throw new Ve(Ne.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(Jt.fromString(t));if(!$e.isDocumentKey(n))throw new Ve(Ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return uu(r,new $e(n))}if(t instanceof Fr)return uu(r,t._key);throw new Ve(Ne.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Gy(t)}.`)}function QT(r,e){if(!Array.isArray(r)||r.length===0)throw new Ve(Ne.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function qC(r,e){const t=function(i,s){for(const o of i)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(r.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new Ve(Ne.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ve(Ne.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class HC{convertValue(e,t="none"){switch(ec(e)){case 0:return null;case 1:return e.booleanValue;case 2:return On(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ra(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ze(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return hc(e,(i,s)=>{n[i]=this.convertValue(s,t)}),n}convertVectorValue(e){var t,n,i;const s=(i=(n=(t=e.fields)===null||t===void 0?void 0:t[zd].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(o=>On(o.doubleValue));return new h2(s)}convertGeoPoint(e){return new d2(On(e.latitude),On(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Dy(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Jf(e));default:return null}}convertTimestamp(e){const t=Ca(e);return new Ot(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=Jt.fromString(e);rt(Hk(n),9688,{name:e});const i=new cu(n.get(1),n.get(3)),s=new $e(n.popFirst(5));return i.isEqual(t)||Qn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t0(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}class f8 extends HC{constructor(e){super(),this.firestore=e}convertBytes(e){return new yu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Fr(this.firestore,null,t)}}function m8(){return new r8("count")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ed{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class S2 extends am{constructor(e,t,n,i,s,o){super(e,t,n,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new Ng(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Xy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Ng extends S2{data(e={}){return super.data(e)}}class $C{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Ed(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new Ng(this._firestore,this._userDataWriter,n.key,n,new Ed(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ve(Ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const d=new Ng(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Ed(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:d,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const d=new Ng(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Ed(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let f=-1,m=-1;return l.type!==0&&(f=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),m=o.indexOf(l.doc.key)),{type:p8(l.type),doc:d,oldIndex:f,newIndex:m}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function p8(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ze(61501,{type:r})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Na(r){r=Nr(r,Fr);const e=Nr(r.firestore,as);return KL(Iu(e),r._key).then(t=>WC(e,r,t))}class Om extends HC{constructor(e){super(),this.firestore=e}convertBytes(e){return new yu(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Fr(this.firestore,null,t)}}function vt(r){r=Nr(r,zo);const e=Nr(r.firestore,as),t=Iu(e),n=new Om(e);return UC(r._query),YL(t,r._query).then(i=>new $C(e,n,r,i))}function g8(r,e,t){r=Nr(r,Fr);const n=Nr(r.firestore,as),i=t0(r.converter,e,t);return Mm(n,[Zy(ku(n),"setDoc",r._key,i,r.converter!==null,t).toMutation(r._key,Mn.none())])}function ls(r,e,t,...n){r=Nr(r,Fr);const i=Nr(r.firestore,as),s=ku(i);let o;return o=typeof(e=In(e))=="string"||e instanceof Pu?g2(s,"updateDoc",r._key,e,t,n):p2(s,"updateDoc",r._key,e),Mm(i,[o.toMutation(r._key,Mn.exists(!0))])}function Dm(r){return Mm(Nr(r.firestore,as),[new ih(r._key,Mn.none())])}function uh(r,e){const t=Nr(r.firestore,as),n=Lt(r),i=t0(r.converter,e);return Mm(t,[Zy(ku(r.firestore),"addDoc",n._key,i,r.converter!==null,{}).toMutation(n._key,Mn.exists(!1))]).then(()=>n)}function Dx(r,...e){var t,n,i;r=In(r);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||YT(e[o])||(s=e[o],o++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(YT(e[o])){const p=e[o];e[o]=(t=p.next)===null||t===void 0?void 0:t.bind(p),e[o+1]=(n=p.error)===null||n===void 0?void 0:n.bind(p),e[o+2]=(i=p.complete)===null||i===void 0?void 0:i.bind(p)}let d,f,m;if(r instanceof Fr)f=Nr(r.firestore,as),m=Pm(r._key.path),d={next:p=>{e[o]&&e[o](WC(f,r,p))},error:e[o+1],complete:e[o+2]};else{const p=Nr(r,zo);f=Nr(p.firestore,as),m=p._query;const g=new Om(f);d={next:v=>{e[o]&&e[o](new $C(f,g,p,v))},error:e[o+1],complete:e[o+2]},UC(r._query)}return function(g,v,E,x){const b=new c2(x),S=new r2(v,b,E);return g.asyncQueue.enqueueAndForget(async()=>e2(await oy(g),S)),()=>{b.xu(),g.asyncQueue.enqueueAndForget(async()=>t2(await oy(g),S))}}(Iu(f),m,l,d)}function Mm(r,e){return function(n,i){const s=new Ps;return n.asyncQueue.enqueueAndForget(async()=>AL(await GL(n),i,s)),s.promise}(Iu(r),e)}function WC(r,e,t){const n=t.docs.get(e._key),i=new Om(r);return new S2(r,i,e._key,n,new Ed(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mx(r){return y8(r,{count:m8()})}function y8(r,e){const t=Nr(r.firestore,as),n=Iu(t),i=bM(e,(s,o)=>new GM(o,s.aggregateType,s._internalFieldPath));return ZL(n,r._query,i).then(s=>function(l,d,f){const m=new Om(l);return new i8(d,m,f)}(t,r,s))}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const v8={maxAttempts:5};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _8{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=ku(e)}set(e,t,n){this._verifyNotCommitted();const i=zl(e,this._firestore),s=t0(i.converter,t,n),o=Zy(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,n);return this._mutations.push(o.toMutation(i._key,Mn.none())),this}update(e,t,n,...i){this._verifyNotCommitted();const s=zl(e,this._firestore);let o;return o=typeof(t=In(t))=="string"||t instanceof Pu?g2(this._dataReader,"WriteBatch.update",s._key,t,n,i):p2(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,Mn.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=zl(e,this._firestore);return this._mutations=this._mutations.concat(new ih(t._key,Mn.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ve(Ne.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function zl(r,e){if((r=In(r)).firestore!==e)throw new Ve(Ne.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x8{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=ku(e)}get(e){const t=zl(e,this._firestore),n=new f8(this._firestore);return this._transaction.lookup([t._key]).then(i=>{if(!i||i.length!==1)return Ze(24041);const s=i[0];if(s.isFoundDocument())return new am(this._firestore,n,s.key,s,t.converter);if(s.isNoDocument())return new am(this._firestore,n,t._key,null,t.converter);throw Ze(18433,{doc:s})})}set(e,t,n){const i=zl(e,this._firestore),s=t0(i.converter,t,n),o=Zy(this._dataReader,"Transaction.set",i._key,s,i.converter!==null,n);return this._transaction.set(i._key,o),this}update(e,t,n,...i){const s=zl(e,this._firestore);let o;return o=typeof(t=In(t))=="string"||t instanceof Pu?g2(this._dataReader,"Transaction.update",s._key,t,n,i):p2(this._dataReader,"Transaction.update",s._key,t),this._transaction.update(s._key,o),this}delete(e){const t=zl(e,this._firestore);return this._transaction.delete(t._key),this}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b8 extends x8{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=zl(e,this._firestore),n=new Om(this._firestore);return super.get(e).then(i=>new S2(this._firestore,n,t._key,i._document,new Ed(!1,!1),t.converter))}}function w8(r,e,t){r=Nr(r,as);const n=Object.assign(Object.assign({},v8),t);return function(s){if(s.maxAttempts<1)throw new Ve(Ne.INVALID_ARGUMENT,"Max attempts must be at least 1")}(n),function(s,o,l){const d=new Ps;return s.asyncQueue.enqueueAndForget(async()=>{const f=await kC(s);new HL(s.asyncQueue,f,l,o,d).Wu()}),d.promise}(Iu(r),i=>e(new b8(r,i)),n)}function Sn(){return new f2("serverTimestamp")}function T2(...r){return new m2("arrayUnion",r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function za(r){return Iu(r=Nr(r,as)),new _8(r,e=>Mm(r,e))}(function(e,t=!0){(function(i){nh=i})(th),iu(new Jl("firestore",(n,{instanceIdentifier:i,options:s})=>{const o=n.getProvider("app").getImmediate(),l=new as(new FD(n.getProvider("auth-internal")),new zD(o,n.getProvider("app-check-internal")),function(f,m){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new Ve(Ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new cu(f.options.projectId,m)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),jo(kS,CS,e),jo(kS,CS,"esm2017")})();var E8="firebase",S8="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jo(E8,S8,"app");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GC="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T8{constructor(e,t,n,i){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,di(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||t.get().then(s=>this.auth=s,()=>{}),this.messaging||n.get().then(s=>this.messaging=s,()=>{}),this.appCheck||i==null||i.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),n=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:t,messagingToken:n,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lx="us-central1";class A8{constructor(e,t,n,i,s=Lx,o=(...l)=>fetch(...l)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new T8(e,t,n,i),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(s);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=Lx}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function N8(r,e,t){const n=Su(e);r.emulatorOrigin=`http${n?"s":""}://${e}:${t}`,n&&(ib(r.emulatorOrigin),sb("Functions",!0))}const XT="@firebase/functions",JT="0.12.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I8="auth-internal",P8="app-check-internal",k8="messaging-internal";function C8(r){const e=(t,{instanceIdentifier:n})=>{const i=t.getProvider("app").getImmediate(),s=t.getProvider(I8),o=t.getProvider(k8),l=t.getProvider(P8);return new A8(i,s,o,l,n)};iu(new Jl(GC,e,"PUBLIC").setMultipleInstances(!0)),jo(XT,JT,r),jo(XT,JT,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function R8(r=Ty(),e=Lx){const n=Sy(In(r),GC).getImmediate({identifier:e}),i=R4("functions");return i&&j8(n,...i),n}function j8(r,e,t){N8(In(r),e,t)}C8();const O8={apiKey:"",authDomain:"",projectId:"agwa-wsi",storageBucket:"",messagingSenderId:"",appId:"",measurementId:""};let lm;s7().length?lm=Ty():lm=z4(O8);const Yh=vb(lm),Yt=e8(lm);R8(lm);console.log(" Connecting to Production Firebase Services ");t8(Yt).then(()=>{console.log("Firestore offline persistence enabled for multiple tabs.")}).catch(r=>{r.code==="failed-precondition"?console.warn("Firestore offline persistence failed: Multiple tabs open or other issues."):r.code==="unimplemented"?console.warn("Firestore offline persistence failed: Browser does not support all features."):console.warn("Firestore persistence error:",r.message)});function D8(){return"users"}function Uo(r){return`${D8()}/${r}/profile/data`}function mc(){return"public/data"}function Ln(){return`${mc()}/profiles`}function pc(){return`${mc()}/support_tickets`}function n0(r){return`${pc()}/${r}`}function Lm(){return`${mc()}/announcements`}function KC(r){return`${Lm()}/${r}`}function Qd(){return`${mc()}/system_config/settings`}function mi(){return`${mc()}/all_bills`}function YC(r){return`${mi()}/${r}`}function Ua(){return`${mc()}/all_meter_readings`}function ZC(r){return`${Ua()}/${r}`}function sc(){return`${mc()}/meter_routes`}function Cu(){return`${mc()}/service_interruptions`}function QC(r){return`${Cu()}/${r}`}const gc=r=>{let e=r.message||"An unknown authentication error occurred.";return r.code&&(e=r.code.replace("auth/","").replace(/-/g," "),e=e.charAt(0).toUpperCase()+e.slice(1)+".",(r.code==="auth/invalid-credential"||r.code==="auth/wrong-password"||r.code==="auth/user-not-found")&&(e="Invalid credentials. Please check your email and password."),r.code==="auth/email-already-in-use"&&(e="This email address is already registered. Please try logging in.")),console.error("Auth Service Error:",r.code,r.message),e},M8=async(r,e,t)=>{try{return{success:!0,userCredential:await yO(r,e,t)}}catch(n){return{success:!1,error:gc(n)}}},L8=async(r,e,t)=>{try{return{success:!0,userCredential:await vO(r,e,t)}}catch(n){return{success:!1,error:gc(n)}}},F8=async r=>{try{const e=new ba;return{success:!0,userCredential:await HO(r,e)}}catch(e){return{success:!1,error:gc(e)}}},V8=async(r,e,t)=>{try{return await _O(r,e,t),window.localStorage.setItem("emailForSignIn",e),{success:!0,message:`Sign-in link sent to ${e}!`}}catch(n){return{success:!1,error:gc(n)}}},B8=async(r,e,t)=>{if(mP(r,t))try{const n=await xO(r,e,t);return window.localStorage.removeItem("emailForSignIn"),{success:!0,userCredential:n}}catch(n){return{success:!1,error:gc(n)}}return{success:!1,error:"Not a valid sign-in-with-email-link request."}},z8=async(r,e)=>{try{return await gO(r,e),{success:!0,message:"Password reset email sent!"}}catch(t){return{success:!1,error:gc(t)}}},U8=async r=>{try{return await SO(r),{success:!0,message:"Logged out successfully."}}catch(e){return{success:!1,error:gc(e)}}},XC=(r,e,t='1/2"',n={})=>{var F,O,C,M,D;let i=0,s=0,o=0,l=0,d=0,f=0,m=0;const p=parseFloat(r)||0,g={fcdaPercentage:1.29,environmentalChargePercentage:25,sewerageChargePercentageCommercial:32.85,governmentTaxPercentage:2,vatPercentage:12,minimumChargeResidential:195.49,minimumChargeCommercial:512.3,minimumChargeResLowIncome:70.07,minimumChargeSemiBusiness:195.49,minimumChargeIndustrial:72.68,rates:{resLowIncome:[{limit:10,rate:0,fixed:70.07},{limit:20,rate:14.29},{limit:30,rate:23.82},{limit:40,rate:45.17},{limit:1/0,rate:59.54}],residential:[{limit:10,rate:0,fixed:195.49},{limit:20,rate:23.82},{limit:30,rate:45.17},{limit:50,rate:59.54},{limit:70,rate:69.52},{limit:90,rate:72.89},{limit:140,rate:76.14},{limit:200,rate:79.42},{limit:1/0,rate:82.67}],semiBusiness:[{limit:10,rate:0,fixed:195.49},{limit:20,rate:39.9},{limit:40,rate:49.22},{limit:60,rate:62.55},{limit:80,rate:72.88},{limit:130,rate:76.14},{limit:180,rate:79.42},{limit:1/0,rate:82.67}],commercial:[{limit:10,rate:0,fixed:512.3},{limit:20,rate:53.61},{limit:40,rate:58.98},{limit:60,rate:64.33},{limit:80,rate:69.69},{limit:100,rate:72.88},{limit:150,rate:76.14},{limit:200,rate:79.42},{limit:1/0,rate:82.67}],industrial:{rate:72.68}}},v={...g,...n},E=(v.fcdaPercentage||g.fcdaPercentage)/100,x=(v.environmentalChargePercentage||g.environmentalChargePercentage)/100,b=(v.sewerageChargePercentageCommercial||g.sewerageChargePercentageCommercial)/100,S=(v.governmentTaxPercentage||g.governmentTaxPercentage)/100,N=(v.vatPercentage||g.vatPercentage)/100,R={resLowIncome:((F=v.rates)==null?void 0:F.resLowIncome)||g.rates.resLowIncome,residential:((O=v.rates)==null?void 0:O.residential)||g.rates.residential,semiBusiness:((C=v.rates)==null?void 0:C.semiBusiness)||g.rates.semiBusiness,commercial:((M=v.rates)==null?void 0:M.commercial)||g.rates.commercial,industrial:((D=v.rates)==null?void 0:D.industrial)||g.rates.industrial};R.resLowIncome[0].fixed=v.minimumChargeResLowIncome||g.minimumChargeResLowIncome,R.residential[0].fixed=v.minimumChargeResidential||g.minimumChargeResidential,R.semiBusiness[0].fixed=v.minimumChargeSemiBusiness||g.minimumChargeSemiBusiness,R.commercial[0].fixed=v.minimumChargeCommercial||g.minimumChargeCommercial,R.industrial.rate=v.minimumChargeIndustrial||g.minimumChargeIndustrial;const I=String(t).replace(/["]/g,"").trim();I==="1/2"||I==="15mm"?d=1.5:I==="3/4"||I==="20mm"?d=2:I==="1"||I==="25mm"?d=3:I==="1 1/4"||I==="40mm"||I==="1 1/2"||I==="32mm"?d=4:I==="2"||I==="50mm"?d=6:I==="3"||I==="75mm"?d=10:I==="4"||I==="100mm"?d=20:I==="6"||I==="150mm"?d=35:I==="8"||I==="200mm"?d=50:d=1.5;const j=$=>{let K=0,ee=p;ee>0&&$[0].fixed&&(K+=$[0].fixed,ee-=$[0].limit);for(let se=1;se<$.length&&!(ee<=0);se++){const ie=$[se-1].limit,re=$[se].limit-ie,G=Math.min(ee,re);K+=G*$[se].rate,ee-=G}return K};e==="Residential Low-Income"?i=j(R.resLowIncome):e==="Residential"?i=j(R.residential):e==="Semi-Business"?i=j(R.semiBusiness):e==="Commercial"||e==="Admin"?i=j(R.commercial):e==="Industrial"||e==="Meter Reading Personnel"?i=p*R.industrial.rate:i=j(R.residential),s=i*E;const U=i+s;o=U*x,e==="Commercial"||e==="Industrial"||e==="Admin"||e==="Meter Reading Personnel"?l=U*b:l=v.sewerageChargeResidential/100*U||0;const P=U+o+l+d;f=P*S,m=P*N;const k=P+f+m;return{consumption:p,serviceType:e,meterSize:I,basicCharge:parseFloat(i.toFixed(2)),fcda:parseFloat(s.toFixed(2)),environmentalCharge:parseFloat(o.toFixed(2)),sewerageCharge:parseFloat(l.toFixed(2)),maintenanceServiceCharge:parseFloat(d.toFixed(2)),subTotalBeforeTaxes:parseFloat(P.toFixed(2)),governmentTaxes:parseFloat(f.toFixed(2)),vatableSales:parseFloat(P.toFixed(2)),vat:parseFloat(m.toFixed(2)),totalCalculatedCharges:parseFloat(k.toFixed(2))}},A2=r=>{if(!r||typeof r!="string")return{serviceType:"Residential",role:"customer"};const e=r.toUpperCase().trim();return e.startsWith("ADM")?{serviceType:"Admin",role:"admin"}:e.startsWith("PER")?{serviceType:"Meter Reading Personnel",role:"meter_reader"}:e.startsWith("CLE")?{serviceType:"Clerk Operations",role:"clerk_cashier"}:e.startsWith("RES-LI")?{serviceType:"Residential Low-Income",role:"customer"}:e.startsWith("RES")?{serviceType:"Residential",role:"customer"}:e.startsWith("COM")?{serviceType:"Commercial",role:"customer"}:e.startsWith("IND")?{serviceType:"Industrial",role:"customer"}:{serviceType:"Residential",role:"customer"}},q8=r=>`https://placehold.co/100x100/3b82f6/FFFFFF?text=${r?r.charAt(0).toUpperCase():"A"}`,Mt=(r,e={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})=>{if(!r)return"";let t;if(r.toDate&&typeof r.toDate=="function")t=r.toDate();else if(r instanceof Date)t=r;else if(typeof r=="string"||typeof r=="number")t=new Date(r);else return"Invalid Date";if(isNaN(t.getTime()))return"Invalid Date";try{return new Intl.DateTimeFormat("en-US",e).format(t)}catch{return"Invalid Date"}},H8=(r,e)=>{if(!r||!e)return 0;if(r.penaltyAmount&&r.penaltyAmount>0)return r.penaltyAmount;const t=(e.latePaymentPenaltyPercentage||2)/100,n=r.totalCalculatedCharges||0;return n>0&&t>0?parseFloat((n*t).toFixed(2)):0},N2=(r,e)=>{var i;if(!r||!e||r.status==="Paid")return 0;const t=new Date,n=(i=r.dueDate)!=null&&i.toDate?r.dueDate.toDate():null;if(!n)return 0;if(t>n){if(r.penaltyAmount&&r.penaltyAmount>0)return r.penaltyAmount;const s=(e.latePaymentPenaltyPercentage||2)/100,o=r.totalCalculatedCharges||0;if(o>0&&s>0)return parseFloat((o*s).toFixed(2))}return 0};function ot(r,e){console.error(`Firestore Error [${r}]:`,e);const t=e.code||"unknown",n=e.message||"An unexpected error occurred.";let i=`An error occurred while ${r.replace(/([A-Z])/g," $1").toLowerCase()}. Code: ${t}.`;return t==="failed-precondition"?i=`Query failed: ${n}. This almost always means you are missing a Firestore index. Check the console logs (on your server or browser) for a link to create the required index.`:t==="permission-denied"?i=`An error occurred: Permission denied. You don't have permission for this action. Please check your Firestore rules. (Function: ${r})`:i=`An error occurred in ${r}: ${n} (Code: ${t}). Please check your connection or contact support if the issue persists.`,{success:!1,error:i}}async function $8(r,e,t,n,i){try{return await w8(r,async s=>{const o=Lt(r,Ln(),e),l=Lt(r,Uo(e)),d=Lt(r,YC(t)),[f,m]=await Promise.all([s.get(o),s.get(d)]);if(!f.exists())throw new Error("User profile not found.");if(!m.exists())throw new Error("Bill document not found.");if((f.data().rebatePoints||0)<n)throw new Error("Insufficient rebate points.");const g=new Date,v=Ot.fromDate(g),E={date:g,timestamp:v,reference:`POINTS-PAY-${g.getTime().toString().slice(-6)}`,amount:i,method:"Rebate Points"},x={status:"Paid",paymentDate:g,paymentTimestamp:v,amountPaid:i,paymentMethod:"Rebate Points",paymentReference:E.reference,lastUpdatedAt:Sn(),paymentHistory:T2(E)},b={rebatePoints:lh.increment(-n),updatedAt:Sn()};s.update(d,x),s.update(o,b),s.update(l,b)}),{success:!0}}catch(s){return ot("paying bill with points",s)}}async function W8(r,e,t){if(!e||e.length===0)return{success:!0};try{const n=za(r);return e.forEach(i=>{const s=Lt(r,n0(i));n.update(s,{status:t,lastUpdatedAt:Sn()})}),await n.commit(),{success:!0,count:e.length}}catch(n){return ot("batch updating ticket status",n)}}async function G8(r,e){if(!e)return{success:!1,error:"User ID is required."};try{const t=za(r),n=Lt(r,Ln(),e),i=Lt(r,Uo(e));return t.delete(n),t.delete(i),await t.commit(),{success:!0}}catch(t){return ot(`deleting user profile ${e}`,t)}}async function dh(r,e){try{const t=await vt(pt(ct(r,e),vu(500)));if(t.empty)return{success:!0,count:0};let n=0,i=t;for(;!i.empty;){const s=za(r);if(i.docs.forEach(o=>{s.delete(o.ref)}),await s.commit(),n+=i.size,i.size<500)break;i=await vt(pt(ct(r,e),vu(500)))}return{success:!0,count:n}}catch(t){return ot(`deleting all from ${e}`,t)}}function K8(r){return dh(r,pc())}function Y8(r){return dh(r,mi())}function Z8(r){return dh(r,Ua())}function Q8(r){return dh(r,Lm())}function X8(r){return dh(r,Cu())}function J8(r){return dh(r,sc())}async function e9(r){try{const e=ct(r,Ln()),t=await vt(pt(e,vu(500)));if(t.empty)return{success:!0,count:0};let n=0,i=t;const s={rebatePoints:0,rebateTier:"Bronze"};for(;!i.empty;){const o=za(r);if(i.docs.forEach(d=>{o.update(d.ref,s);const f=Lt(r,Uo(d.id));o.update(f,s)}),await o.commit(),n+=i.size,i.size<500)break;const l=i.docs[i.docs.length-1];i=await vt(pt(e,Gn(DC()),d8(l),vu(500)))}return{success:!0,count:n}}catch(e){return ot("clearing all rebate points",e)}}async function t9(r){try{const e=await vt(pt(ct(r,Ln())));if(e.empty)return{success:!0,count:0};const t=za(r);return e.docs.forEach(n=>{t.delete(Lt(r,Ln(),n.id)),t.delete(Lt(r,Uo(n.id)))}),await t.commit(),{success:!0,count:e.size}}catch(e){return ot("deleting all users",e)}}async function n9(r,e,t){if(!t||!e)return{success:!1,error:"User ID and Account Number required."};const n=t.trim().toUpperCase();if(!n)return{success:!1,error:"Account Number cannot be empty."};try{const i=ct(r,Ln()),s=pt(i,St("accountNumber","==",n)),o=await vt(s);if(o.empty)return{success:!1,error:`Account Number "${n}" not found.`};const l=o.docs[0],d=l.data(),f=l.id;if(f===e)return{success:!0};if(d.uid&&d.uid!==e)return{success:!1,error:"Account already linked to another user."};const{role:m,serviceType:p}=A2(n),g={uid:e,accountNumber:n,role:m,serviceType:p,meterSerialNumber:d.meterSerialNumber||"",meterSize:d.meterSize||'1/2"',serviceAddress:d.serviceAddress||{}},v=za(r);return v.update(Lt(r,Ln(),f),g),v.update(Lt(r,Uo(e)),g),await v.commit(),{success:!0}}catch(i){return ot("linking account number",i)}}async function r9(r){try{const e=ct(r,Ln()),t=await vt(e),n=new Set;return t.docs.forEach(i=>{var o;const s=(o=i.data().serviceAddress)==null?void 0:o.barangay;s&&n.add(s)}),{success:!0,data:Array.from(n).sort()}}catch(e){return ot("getting unique service locations",e)}}async function i9(r,e){if(!e)return{success:!0,data:[]};try{const t=ct(r,Ln()),n=pt(t,St("serviceAddress.barangay","==",e));return{success:!0,data:(await vt(n)).docs.map(o=>o.data().accountNumber).filter(Boolean)}}catch(t){return ot(`getting accounts in ${e}`,t)}}async function s9(r,e,t=null){try{const n={...e,updatedAt:Sn()};return t?await ls(Lt(r,sc(),t),n):(n.createdAt=Sn(),await uh(ct(r,sc()),n)),{success:!0}}catch(n){return ot("saving meter route",n)}}async function o9(r){try{const e=pt(ct(r,sc()),Gn("name","asc"));return{success:!0,data:(await vt(e)).docs.map(n=>({id:n.id,...n.data()}))}}catch(e){return ot("getting all meter routes",e)}}async function a9(r,e){try{return await Dm(Lt(r,sc(),e)),{success:!0}}catch(t){return ot("deleting meter route",t)}}async function l9(r){try{const e=pt(ct(r,Ln()),St("role","==","meter_reader"),Gn("displayName","asc"));return{success:!0,data:(await vt(e)).docs.map(n=>({id:n.id,...n.data()}))}}catch(e){return ot("getting all meter readers",e)}}async function c9(r){try{const e=pt(ct(r,mi()),St("status","==","Paid")),t=await vt(e),n={};t.forEach(s=>{var f;const o=s.data(),l=(f=o.paymentDate)!=null&&f.toDate?o.paymentDate.toDate():null;if(!l)return;const d=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`;n[d]=(n[d]||0)+(o.amountPaid||0)});const i=Object.entries(n).sort(([s],[o])=>s.localeCompare(o)).slice(-12);return{success:!0,data:Object.fromEntries(i)}}catch(e){return ot("getting revenue stats",e)}}async function u9(r){try{const e=pt(ct(r,mi()),St("status","==","Paid")),t=await vt(e);if(t.empty)return{success:!0,data:{}};const n={},i=[...new Set(t.docs.map(o=>o.data().userId).filter(Boolean))],s={};for(let o=0;o<i.length;o+=30){const l=i.slice(o,o+30);if(l.length===0)continue;const d=pt(ct(r,Ln()),St(DC(),"in",l));(await vt(d)).forEach(m=>s[m.id]=m.data())}return t.forEach(o=>{var m;const l=o.data(),d=s[l.userId];if(!d)return;const f=((m=d.serviceAddress)==null?void 0:m.barangay)||"Unknown Barangay";n[f]=(n[f]||0)+(l.amountPaid||0)}),{success:!0,data:n}}catch(e){return ot("getting revenue by location",e)}}async function d9(r){try{const e=pt(ct(r,mi()),St("status","==","Unpaid")),t=await vt(e);let n=0;return t.forEach(i=>{n+=i.data().amount||0}),{success:!0,data:{totalOutstanding:n}}}catch(e){return ot("getting outstanding balance",e)}}async function h9(r,e){const t=e==null?void 0:e.accountNumbers;if(!Array.isArray(t)||t.length===0)return{success:!0,data:[]};try{const n=ct(r,Ln()),i=[];for(let s=0;s<t.length;s+=30){const o=t.slice(s,s+30);if(o.length===0)continue;const l=pt(n,St("accountNumber","in",o));(await vt(l)).forEach(f=>i.push({id:f.id,...f.data()}))}return{success:!0,data:i}}catch(n){return ot("getting accounts in route",n)}}async function I2(r,e){if(!e)return{success:!1,error:"User ID required."};try{const t=Lt(r,Ln(),e),n=await Na(t);if(n.exists())return{success:!0,data:{id:n.id,...n.data()}};{const i=Lt(r,Uo(e)),s=await Na(i);return s.exists()?{success:!0,data:{id:s.id,...s.data()}}:{success:!1,error:"User profile not found."}}}catch(t){return ot(`getting user profile ${e}`,t)}}async function r0(r,e){const t=e==null?void 0:e.trim().toLowerCase();if(!t)return{success:!1,error:"Search term required."};const n=e.trim().toUpperCase();try{const i=ct(r,Ln()),s=[pt(i,St("accountNumber","==",n)),pt(i,St("email","==",t)),pt(i,St("meterSerialNumber","==",n)),pt(i,Gn("displayNameLower"),St("displayNameLower",">=",t),St("displayNameLower","<=",t+""))],o=await Promise.allSettled(s.map(d=>vt(d))),l=new Map;return o.forEach(d=>{d.status==="fulfilled"?d.value.forEach(f=>{l.has(f.id)||l.set(f.id,{id:f.id,...f.data()})}):console.error("Search query failed:",d.reason)}),{success:!0,data:Array.from(l.values())}}catch(i){return ot("searching user profiles",i)}}function eA(r){return r?r.toLocaleDateString("en-CA"):""}async function JC(r,e,t){if(!e||!t)return{success:!1,error:"User ID and profile required."};try{const n=await i0(r),i=n.success?n.data:{},s=i.latePaymentPenaltyDelayDays||10,o=3,l=pt(ct(r,Ua()),St("userId","==",e),Gn("readingDate","desc"),vu(3)),d=await vt(l);if(d.docs.length<2)return{success:!1,error:"At least two readings needed."};const f=d.docs[0],m=d.docs[1],p=d.docs[2]||null,g=f.data(),v=m.data(),E=g.readingValue-v.readingValue;if(E<0)return{success:!1,error:"Latest reading is lower than previous."};const x=g.readingDate.toDate(),b=v.readingDate.toDate(),S=b.toLocaleString("en-US",{month:"long",year:"numeric"}),N=pt(ct(r,mi()),St("userId","==",e),St("monthYear","==",S));if(!(await vt(N)).empty)return{success:!1,error:`Bill for ${S} already exists.`};const I=new Date(x);I.setDate(I.getDate()+o);const j=new Date(I);j.setDate(j.getDate()+s);let U=null;if(p){const se=p.data();U=v.readingValue-se.readingValue}const P=XC(E,t.serviceType,t.meterSize,i),k=P.totalCalculatedCharges||0,F=t.discountStatus==="verified"&&(i.seniorCitizenDiscountPercentage||0)>0?parseFloat((k*(i.seniorCitizenDiscountPercentage/100)).toFixed(2)):0;let O=0;const C=pt(ct(r,mi()),St("userId","==",e),St("status","==","Unpaid"),Gn("dueDate","desc")),M=await vt(C);M.empty||M.docs.forEach(se=>{const ie=se.data();O+=ie.amount||0});const D=k+O-F,$={userId:e,accountNumber:t.accountNumber,userName:t.displayName,billingPeriod:`${eA(b)} - ${eA(x)}`,monthYear:S,billDate:Ot.fromDate(I),dueDate:Ot.fromDate(j),previousReading:v.readingValue,currentReading:g.readingValue,consumption:E,prev3MonthsConsumption:U||null,...P,penaltyAmount:0,previousUnpaidAmount:parseFloat(O.toFixed(2)),seniorCitizenDiscount:parseFloat(F.toFixed(2)),amount:parseFloat(D.toFixed(2)),status:"Unpaid",createdAt:Sn(),previousReadingId:m.id,currentReadingId:f.id,paymentHistory:[],adjustments:[]},K=await uh(ct(r,mi()),$),ee=`AGWA-${K.id.slice(0,4).toUpperCase()}-${I.getFullYear()}${String(I.getMonth()+1).padStart(2,"0")}${String(I.getDate()).padStart(2,"0")}`;return await ls(K,{billId:K.id,invoiceNumber:ee}),{success:!0,message:`Bill for ${S} generated.`,billId:K.id}}catch(n){return ot(`generating bill for ${t==null?void 0:t.accountNumber}`,n)}}async function f9(r,e){if(!e)return{success:!1,error:"Location required."};try{const t=ct(r,Cu()),n=pt(t,St("affectedAreas","array-contains",e),St("status","in",["Scheduled","Ongoing"]),St("isBillingPaused","==",!0));if(!(await vt(n)).empty)return{success:!0,data:[]};const s=pt(ct(r,Ln()),St("serviceAddress.barangay","==",e),Gn("displayName","asc")),o=await vt(s);if(o.empty)return{success:!0,data:[]};const l=[];for(const d of o.docs){const f={id:d.id,...d.data()};if(!f.accountNumber)continue;const m=pt(ct(r,Ua()),St("userId","==",f.id),Gn("readingDate","desc"),vu(2)),p=await vt(m);if(p.docs.length<2)continue;const v=p.docs[1].data().readingDate.toDate().toLocaleString("default",{month:"long",year:"numeric"}),E=pt(ct(r,mi()),St("userId","==",f.id),St("monthYear","==",v),vu(1));(await vt(E)).empty&&l.push(f)}return{success:!0,data:l}}catch(t){return ot(`getting billable accounts in ${e}`,t)}}async function m9(r,e){const t=[];let n=0,i=0;for(const s of e){const o=await JC(r,s.id,s);t.push({success:o.success,message:`${o.success?"SUCCESS":"FAILED"} [${s.accountNumber}]: ${o.message||o.error}`}),o.success?n++:i++}return{logs:t,successCount:n,failCount:i}}async function p9(r,e,t){if(!e)return{success:!1,error:"User ID required."};try{const n=za(r),i={...t,accountNumber:t.accountNumber?t.accountNumber.toUpperCase():"",uid:e,createdAt:Sn(),lastLoginAt:Sn(),displayNameLower:t.displayName?t.displayName.toLowerCase():"",rebatePoints:0,rebateTier:"Bronze",discountStatus:"none"};return n.set(Lt(r,Uo(e)),i),n.set(Lt(r,Ln(),e),i),await n.commit(),{success:!0}}catch(n){return ot("creating user profile",n)}}async function Sd(r,e,t){if(!e)return{success:!1,error:"User ID required."};try{const n=za(r),i={...t,updatedAt:Sn()};return i.accountNumber&&(i.accountNumber=i.accountNumber.toUpperCase()),i.displayName&&(i.displayNameLower=i.displayName.toLowerCase()),t.discountStatus!==void 0&&(i.discountStatus=t.discountStatus),n.update(Lt(r,Uo(e)),i),n.update(Lt(r,Ln(),e),i),await n.commit(),{success:!0}}catch(n){return ot(`updating user profile ${e}`,n)}}async function g9(r){try{return{success:!0,data:(await vt(pt(ct(r,Ln()),Gn("displayNameLower","asc")))).docs.map(t=>({id:t.id,...t.data()}))}}catch(e){return ot("getting all users profiles",e)}}async function y9(r,e){try{const t=await uh(ct(r,pc()),{...e,status:"Open",submittedAt:Sn(),lastUpdatedAt:Sn(),conversation:[]});return await ls(t,{ticketId:t.id}),{success:!0,id:t.id}}catch(t){return ot("creating support ticket",t)}}async function v9(r,e){try{return await Dm(Lt(r,n0(e))),{success:!0}}catch(t){return ot("deleting support ticket",t)}}async function e3(r,e,t){var n;if(!e||!(t!=null&&t.text))return{success:!1,error:"Ticket ID and reply text required."};try{const i=Lt(r,n0(e)),s={conversation:T2(t),lastUpdatedAt:Sn()},l=(n=(await Na(i)).data())==null?void 0:n.status;return t.authorRole!=="admin"&&(l==="Resolved"||l==="Closed")?s.status="Open":(t.authorRole==="admin"&&l==="Open"||t.authorRole!=="admin"&&l==="Awaiting Customer")&&(s.status="In Progress"),await ls(i,s),{success:!0}}catch(i){return ot("adding ticket reply",i)}}async function tA(r){try{const e=pt(ct(r,pc()),Gn("lastUpdatedAt","desc"));return{success:!0,data:(await vt(e)).docs.map(n=>({id:n.id,...n.data()}))}}catch(e){return ot("getting all support tickets",e)}}async function t3(r,e){try{const t=pt(ct(r,pc()),St("userId","==",e),Gn("lastUpdatedAt","desc"));return{success:!0,data:(await vt(t)).docs.map(i=>({id:i.id,...i.data()}))}}catch(t){return ot("getting tickets by reporter",t)}}async function _9(r,e,t){try{return await ls(Lt(r,n0(e)),{...t,lastUpdatedAt:Sn()}),{success:!0}}catch(n){return ot("updating support ticket",n)}}async function x9(r,e){try{const t=await uh(ct(r,Lm()),{...e,createdAt:Sn(),updatedAt:Sn()});return await ls(t,{announcementId:t.id}),{success:!0,id:t.id}}catch(t){return ot("creating announcement",t)}}async function b9(r,e=!1){try{const t=e?[St("status","==","active"),Gn("startDate","desc")]:[Gn("createdAt","desc")],n=pt(ct(r,Lm()),...t);return{success:!0,data:(await vt(n)).docs.map(s=>({id:s.id,...s.data()}))}}catch(t){return ot("getting announcements",t)}}async function nA(r,e,t){try{return await ls(Lt(r,KC(e)),{...t,updatedAt:Sn()}),{success:!0}}catch(n){return ot("updating announcement",n)}}async function w9(r,e){try{return await Dm(Lt(r,KC(e))),{success:!0}}catch(t){return ot("deleting announcement",t)}}async function i0(r){try{const e=await Na(Lt(r,Qd()));return{success:!0,data:e.exists()?e.data():null}}catch(e){return ot("getting system settings",e)}}async function E9(r,e){try{return await g8(Lt(r,Qd()),e,{merge:!0}),{success:!0}}catch(t){return ot("updating system settings",t)}}async function _u(r,e){try{const t=pt(ct(r,mi()),St("userId","==",e),Gn("billDate","desc"));return{success:!0,data:(await vt(t)).docs.map(s=>({id:s.id,...s.data()}))}}catch(t){return ot("getting bills for user",t)}}async function S9(r,e,t,n,i){var s,o,l,d;if(!(!(i!=null&&i.isRebateProgramEnabled)||!e))try{const f=parseFloat(i.pointsPerPeso);if(isNaN(f)||f<=0)return;const m=parseInt(i.earlyPaymentDaysThreshold,10)||7,p=parseInt(i.earlyPaymentBonusPoints,10)||10;let g=n*f;const v=(s=t.dueDate)!=null&&s.toDate?t.dueDate.toDate():(o=t.dueDate)!=null&&o.seconds?new Date(t.dueDate.seconds*1e3):null,E=(l=t.paymentDate)!=null&&l.toDate?t.paymentDate.toDate():t.paymentDate instanceof Date?t.paymentDate:(d=t.paymentDate)!=null&&d.seconds?t.paymentDate.toDate():new Date;v&&(v.getTime()-E.getTime())/864e5>=m&&(g+=p);const x=Math.round(g);if(x<=0)return;const b=Lt(r,Ln(),e),S=await Na(b);if(!S.exists()){console.error(`dataService: CRITICAL! Public profile ${e} not found. Cannot award points.`);return}const N=Lt(r,Uo(e)),I=(S.data().rebatePoints||0)+x;let j="Bronze";I>=3e3?j="Platinum":I>=1500?j="Gold":I>=500&&(j="Silver");const U={rebatePoints:I,rebateTier:j,updatedAt:Sn()},P=za(r);P.update(b,U),P.update(N,U),await P.commit()}catch(f){console.error("dataService: Failed to award rebate points:",f)}}async function n3(r,e,t){var n;try{const i=Lt(r,YC(e)),s=t.amountPaid;let o={};if(t.status==="Paid"){const l=await Na(i);if(l.exists()){const d=l.data(),f=t.paymentDate||new Date,m=(n=d.dueDate)!=null&&n.toDate?d.dueDate.toDate():null,p={...t,lastUpdatedAt:Sn()};if(m&&f>m&&!d.penaltyAmount){const g=await Na(Lt(r,Qd())),E=((g.exists()?g.data():{}).latePaymentPenaltyPercentage||2)/100,x=d.totalCalculatedCharges||0;if(x>0&&E>0){const b=parseFloat((x*E).toFixed(2));p.penaltyAmount=b;const S=d.amount||d.totalCalculatedCharges+(d.previousUnpaidAmount||0)-(d.seniorCitizenDiscount||0);p.amount=S+b,(!p.amountPaid||p.amountPaid<p.amount)&&(p.amountPaid=p.amount)}}if(p.amountPaid>0){const g={date:p.paymentDate||f,timestamp:p.paymentTimestamp||Sn(),reference:p.paymentReference||`PAY-${Date.now().toString().slice(-6)}`,amount:p.amountPaid,method:p.paymentMethod||"Unknown"};p.paymentHistory=T2(g)}if(o={...d,...p},await ls(i,p),d.userId&&s>0&&p.paymentMethod!=="Rebate Points"){const g=await Na(Lt(r,Qd())),v=g.exists()?g.data():{};await S9(r,d.userId,o,s,v)}return{success:!0}}else throw new Error("Bill document not found.")}return await ls(i,{...t,lastUpdatedAt:Sn()}),{success:!0}}catch(i){return ot("updating bill",i)}}async function r3(r,e){try{const t=new Date(e.readingDate);if(isNaN(t))throw new Error("Invalid reading date format.");t.setHours(0,0,0,0);const n={...e,readingValue:parseFloat(e.readingValue)||0,readingDate:Ot.fromDate(t),readingDateString:e.readingDate,recordedAt:Sn()},i=await uh(ct(r,Ua()),n);return await ls(i,{readingId:i.id}),{success:!0,id:i.id}}catch(t){return ot("adding meter reading",t)}}async function T9(r,e,t){try{const n=Lt(r,ZC(e)),i={...t,lastUpdatedAt:Sn()};if(i.readingDate&&typeof i.readingDate=="string"){const s=new Date(i.readingDate);s.setHours(0,0,0,0),isNaN(s)?(delete i.readingDate,delete i.readingDateString):(i.readingDate=Ot.fromDate(s),i.readingDateString=i.readingDate)}return i.readingValue!==void 0&&(i.readingValue=parseFloat(i.readingValue)||0),await ls(n,i),{success:!0}}catch(n){return ot("updating meter reading",n)}}async function A9(r,e){try{return await Dm(Lt(r,ZC(e))),{success:!0}}catch(t){return ot("deleting meter reading",t)}}async function N9(r,e){try{const t=pt(ct(r,Ua()),St("accountNumber","==",e),Gn("readingDate","desc"));return{success:!0,data:(await vt(t)).docs.map(i=>({id:i.id,...i.data()}))}}catch(t){return ot("getting meter readings for account",t)}}async function i3(r,e){try{const t=pt(ct(r,sc()),St("assignedReaderId","==",e),Gn("name"));return{success:!0,data:(await vt(t)).docs.map(i=>({id:i.id,...i.data()}))}}catch(t){return ot("getting routes for reader",t)}}async function I9(r,e,t=[]){try{const n=pt(ct(r,e),...t);return{success:!0,data:(await vt(n)).docs.map(s=>({id:s.id,...s.data()}))}}catch(n){return ot(`getting documents from ${e.split("/").pop()}`,n)}}async function s3(r){try{const e=ct(r,Ln()),t=await Mx(e),i=(await vt(e)).docs.reduce((s,o)=>{const l=o.data().role||"unknown";return s[l]=(s[l]||0)+1,s},{});return{success:!0,data:{total:t.data().count,byRole:i}}}catch(e){return ot("getting users stats",e)}}async function o3(r){try{const e=ct(r,pc()),t=pt(e,Gn("lastUpdatedAt","asc")),n=await vt(t);let i=0;const s={total:n.size,byStatus:{},byType:{}};return n.forEach(o=>{const l=o.data(),d=l.status||"Unknown",f=l.issueType||"Other Concern";s.byStatus[d]=(s.byStatus[d]||0)+1,s.byType[f]=(s.byType[f]||0)+1,d!=="Closed"&&d!=="Resolved"&&i++}),s.openCount=i,{success:!0,data:s}}catch(e){return ot("getting tickets stats",e)}}async function P9(r){try{const e=ct(r,Lm()),t=await Mx(e),n=pt(e,St("status","==","active")),i=await Mx(n).catch(()=>({data:()=>({count:0})}));return{success:!0,data:{total:t.data().count,active:i.data().count}}}catch(e){return ot("getting announcements stats",e)}}async function k9(r,e){if(!e)return{success:!1,error:"Clerk ID required."};try{const t=new Date;t.setHours(0,0,0,0);const n=new Date;n.setHours(23,59,59,999);const i=Ot.fromDate(t),s=Ot.fromDate(n),o=pt(ct(r,mi()),St("processedByClerkId","==",e),St("paymentTimestamp",">=",i),St("paymentTimestamp","<=",s)),l=await vt(o);let d=0;const f=l.docs.map(m=>{const p=m.data();return d+=p.amountPaid||0,{id:m.id,...p}});return{success:!0,data:{paymentsTodayCount:l.size,totalCollectedToday:d,transactions:f.sort((m,p)=>p.paymentTimestamp.toDate()-m.paymentTimestamp.toDate())}}}catch(t){return ot("getting payments by clerk for today",t)}}async function C9(r,e){try{const t=await uh(ct(r,Cu()),{...e,startDate:Ot.fromDate(new Date(e.startDate)),estimatedEndDate:e.estimatedEndDate?Ot.fromDate(new Date(e.estimatedEndDate)):null,isBillingPaused:e.isBillingPaused||!1,createdAt:Sn(),updatedAt:Sn()});return await ls(t,{interruptionId:t.id}),{success:!0,id:t.id}}catch(t){return ot("creating service interruption",t)}}async function R9(r,e,t){try{const n={...t,updatedAt:Sn()};return n.startDate&&typeof n.startDate=="string"&&(n.startDate=Ot.fromDate(new Date(n.startDate))),n.estimatedEndDate&&typeof n.estimatedEndDate=="string"&&(n.estimatedEndDate=Ot.fromDate(new Date(n.estimatedEndDate))),n.status==="Resolved"&&!n.resolvedAt&&(n.resolvedAt=Sn()),await ls(Lt(r,QC(e)),n),{success:!0}}catch(n){return ot("updating service interruption",n)}}async function j9(r,e){try{return await Dm(Lt(r,QC(e))),{success:!0}}catch(t){return ot("deleting service interruption",t)}}async function P2(r){try{const e=Ot.now(),t=pt(ct(r,Cu()),St("status","in",["Ongoing","Scheduled"]),Gn("startDate","desc"));return{success:!0,data:(await vt(t)).docs.map(s=>({id:s.id,...s.data()})).filter(s=>s.status==="Scheduled"&&s.startDate.toMillis()>e.toMillis()?!0:s.status==="Ongoing"?s.estimatedEndDate?s.estimatedEndDate.toMillis()>e.toMillis():!0:s.status!=="Resolved"&&s.startDate.toMillis()<=e.toMillis()&&(!s.estimatedEndDate||s.estimatedEndDate.toMillis()>e.toMillis()))}}catch(e){return ot("getting active service interruptions",e)}}async function O9(r){try{const e=pt(ct(r,Cu()),Gn("createdAt","desc"));return{success:!0,data:(await vt(e)).docs.map(n=>({id:n.id,...n.data()}))}}catch(e){return ot("getting all service interruptions",e)}}async function D9(r){try{const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),n=Ot.fromDate(t),[i,s,o]=await Promise.all([vt(pt(ct(r,pc()),St("submittedAt",">=",n))),vt(pt(ct(r,Ua()),St("recordedAt",">=",n))),vt(pt(ct(r,mi()),St("paymentTimestamp",">=",n)))]),l=Array(24).fill(0).map(()=>({tickets:0,readings:0,payments:0}));return i.forEach(d=>{const f=d.data().submittedAt.toDate().getHours();l[f].tickets++}),s.forEach(d=>{const f=d.data().recordedAt.toDate().getHours();l[f].payments++}),o.forEach(d=>{const f=d.data().paymentTimestamp.toDate().getHours();l[f].payments++}),{success:!0,data:l}}catch(e){return ot("getting hourly activity stats",e)}}async function M9(r){try{const e=new Date;e.setHours(0,0,0,0);const t=Ot.fromDate(e),[n,i,s]=await Promise.all([vt(pt(ct(r,Ua()),St("recordedAt",">=",t))),vt(pt(ct(r,mi()),St("processedByClerkId",">",""),St("paymentTimestamp",">=",t))),vt(pt(ct(r,pc()),St("lastUpdatedAt",">=",t)))]),o=n.docs.reduce((f,m)=>{const p=m.data().readBy||"Unknown Reader";return f[p]=(f[p]||0)+1,f},{}),l=i.docs.reduce((f,m)=>{const p=m.data().processedByClerkName||"Unknown Clerk";return f[p]=(f[p]||0)+1,f},{}),d=s.docs.reduce((f,m)=>{const p=m.data();if(p.status==="Resolved"||p.status==="Closed"){const g=p.lastUpdatedByAdminName||"Unknown Admin";f[g]=(f[g]||0)+1}return f},{});return{success:!0,data:{readerActivity:o,clerkActivity:l,adminActivity:d}}}catch(e){return ot("getting staff activity stats",e)}}async function L9(r){try{const[e,t,n]=await Promise.all([vt(ct(r,sc())),vt(pt(ct(r,Cu()),St("status","in",["Scheduled","Ongoing"]),Gn("startDate","desc"))),vt(pt(ct(r,sc()),St("assignedReaderId","==",""),Gn("name","asc")))]),i=e.size,s=e.docs.reduce((d,f)=>{var m;return d+(((m=f.data().accountNumbers)==null?void 0:m.length)||0)},0),o=t.size,l=n.size;return{success:!0,data:{totalRoutes:i,totalAccounts:s,activeInterrupts:o,unassignedRoutes:l}}}catch(e){return ot("getting technical stats",e)}}async function F9(r){try{const e=pt(ct(r,mi())),t=await vt(e),n={};t.forEach(s=>{var f;const o=s.data(),l=(f=o.billDate)!=null&&f.toDate?o.billDate.toDate():null;if(!l||typeof o.consumption!="number")return;const d=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`;n[d]=(n[d]||0)+(o.consumption||0)});const i=Object.entries(n).sort(([s],[o])=>s.localeCompare(o)).slice(-12);return{success:!0,data:Object.fromEntries(i)}}catch(e){return ot("getting consumption stats",e)}}async function V9(r){try{const e=pt(ct(r,mi()),St("status","==","Paid")),t=await vt(e),n={};return t.forEach(i=>{const s=i.data().paymentMethod||"Unknown";n[s]=(n[s]||0)+1}),{success:!0,data:n}}catch(e){return ot("getting payment method stats",e)}}async function B9(r){try{const e=pt(ct(r,Ln()),St("createdAt","!=",null)),t=await vt(e),n={};t.forEach(s=>{var f;const o=s.data(),l=(f=o.createdAt)!=null&&f.toDate?o.createdAt.toDate():null;if(!l)return;const d=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`;n[d]=(n[d]||0)+1});const i=Object.entries(n).sort(([s],[o])=>s.localeCompare(o)).slice(-12);return{success:!0,data:Object.fromEntries(i)}}catch(e){return ot("getting user growth stats",e)}}async function z9(r){try{const e=ct(r,Ln()),t=await vt(pt(e,St("role","==","customer"))),n={none:0,pending:0,verified:0};return t.forEach(i=>{const s=i.data().discountStatus||"none";n.hasOwnProperty(s)&&n[s]++}),{success:!0,data:n}}catch(e){return ot("getting discount stats",e)}}/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U9=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a3=(...r)=>r.filter((e,t,n)=>!!e&&n.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var q9={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H9=X.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:o,...l},d)=>X.createElement("svg",{ref:d,...q9,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:a3("lucide",i),...l},[...o.map(([f,m])=>X.createElement(f,m)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=(r,e)=>{const t=X.forwardRef(({className:n,...i},s)=>X.createElement(H9,{ref:s,iconNode:e,className:a3(`lucide-${U9(r)}`,n),...i}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ly=ze("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rA=ze("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cy=ze("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $9=ze("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k2=ze("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fx=ze("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C2=ze("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xu=ze("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vx=ze("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W9=ze("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R2=ze("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G9=ze("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=ze("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j2=ze("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K9=ze("CirclePause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y9=ze("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s0=ze("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=ze("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z9=ze("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q9=ze("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O2=ze("ClipboardPen",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",key:"1oijnt"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-5.5",key:"cereej"}],["path",{d:"M4 13.5V6a2 2 0 0 1 2-2h2",key:"5ua5vh"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hi=ze("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X9=ze("Compass",[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o0=ze("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vl=ze("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J9=ze("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eF=ze("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uy=ze("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=ze("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tF=ze("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nF=ze("FilePlus",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D2=ze("FileSearch",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4.268 21a2 2 0 0 0 1.727 1H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"ms7g94"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}],["circle",{cx:"5",cy:"14",r:"3",key:"ufru5t"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oc=ze("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rF=ze("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ac=ze("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bu=ze("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iF=ze("HardHat",[["path",{d:"M2 18a1 1 0 0 0 1 1h18a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v2z",key:"1dej2m"}],["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6",key:"9ciidu"}],["path",{d:"M14 6a6 6 0 0 1 6 6v3",key:"1hnv84"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=ze("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M2=ze("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yn=ze("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sF=ze("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dy=ze("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L2=ze("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l3=ze("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oF=ze("ListFilter",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aF=ze("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tt=ze("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a0=ze("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fo=ze("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const co=ze("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lc=ze("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rd=ze("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lF=ze("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cF=ze("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=ze("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c3=ze("OctagonAlert",[["polygon",{points:"7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2",key:"h1p8hx"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F2=ze("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uF=ze("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _a=ze("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=ze("PhoneCall",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dF=ze("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V2=ze("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hF=ze("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qa=ze("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ha=ze("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=ze("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l0=ze("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0=ze("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hh=ze("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fF=ze("ShieldQuestion",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ds=ze("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d3=ze("SquareCheckBig",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cm=ze("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mF=ze("SquareX",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lf=ze("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pF=ze("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gF=ze("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fh=ze("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h3=ze("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zt=ze("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yF=ze("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f3=ze("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vF=ze("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m3=ze("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p3=ze("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xv=ze("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _F=ze("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xF=ze("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=ze("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iA=ze("Wind",[["path",{d:"M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2",key:"1k4u03"}],["path",{d:"M9.6 4.6A2 2 0 1 1 11 8H2",key:"b7d0fd"}],["path",{d:"M12.6 19.4A2 2 0 1 0 14 16H2",key:"1p5cb3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u0=ze("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g3=ze("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),Bx=ss.memo(({message:r,type:e,onClose:t})=>{if(X.useEffect(()=>{if(!r)return;const s=setTimeout(()=>{t()},5e3);return()=>clearTimeout(s)},[t,r,e]),!r)return null;let n="bg-red-500",i=Zt;return e==="success"?(n="bg-green-500",i=Cs):e==="warning"?(n="bg-yellow-500",i=Zt):e==="info"&&(n="bg-blue-500",i=Zt),c.jsxs("div",{className:`fixed top-5 right-5 ${n} text-white p-4 rounded-lg shadow-xl flex items-center space-x-3 z-[200] animate-slide-in-right`,role:"alert",children:[c.jsx(i,{size:24,"aria-hidden":"true"}),c.jsx("span",{className:"text-sm font-medium",children:r}),c.jsx("button",{onClick:t,className:"ml-auto p-1 rounded-full hover:bg-white/20 transition-colors","aria-label":"Close notification",children:c.jsx(u0,{size:18})}),c.jsx("style",{children:`
        @keyframes slide-in-right {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }
        .animate-slide-in-right {
          animation: slide-in-right 0.5s cubic-bezier(0.25, 0.8, 0.25, 1) forwards;
        }
      `})]})});Bx.displayName="Notification";const sA=({message:r="Loading..."})=>c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-700 to-indigo-800 flex flex-col justify-center items-center p-4 font-inter text-white selection:bg-blue-300 selection:text-blue-900",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("h1",{className:"text-6xl font-bold tracking-tight mb-2 animate-pulse",children:"AGWA"}),c.jsx("p",{className:"text-blue-200 text-lg italic mb-8",children:"Ensuring Clarity, Sustaining Life."}),c.jsx(Tt,{className:"h-12 w-12 mx-auto animate-spin text-blue-300"}),c.jsx("p",{className:"text-blue-300 text-sm mt-4",children:r})]}),c.jsxs("p",{className:"text-center text-xs text-blue-400 mt-12 absolute bottom-6",children:[" ",new Date().getFullYear()," AGWA Water Services, Inc."]})]}),bF=()=>c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn leading-relaxed text-gray-700",children:[c.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(ja,{size:30,className:"mr-3 text-blue-600"}),"Data Privacy Notice"]})}),c.jsx("p",{className:"mb-4 text-sm text-gray-500",children:"Last Updated: November 15, 2025"}),c.jsxs("div",{className:"prose prose-sm max-w-none",children:[c.jsx("h4",{children:"Our Commitment to Privacy"}),c.jsx("p",{children:'AGWA Water Services, Inc. ("AGWA", "we", "us", "our") is committed to protecting your privacy in compliance with Republic Act No. 10173, the Data Privacy Act of 2012 (DPA), its Implementing Rules and Regulations (IRR), and other relevant data privacy and protection laws.'}),c.jsx("p",{children:'This notice explains how we collect, use, disclose, process, store, and protect your personal data when you use our Customer Portal ("Portal") and our services.'}),c.jsx("h4",{children:"1. What Personal Information We Collect"}),c.jsx("p",{children:"We collect, store, and process your personal information when you register for an account, use our services, pay your bills, or interact with our customer support. This information may include:"}),c.jsxs("ul",{children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Personal Identification Data:"})," Full name, email address, phone number, and service address."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Account and Service Data:"})," AGWA Account Number, meter serial number, service type, account status, and account creation date."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Financial and Transaction Data:"})," Billing history, payment history, consumption data (meter readings), payment method details (which are securely tokenized and processed by our third-party payment partners), and rebate point information."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Communication Data:"})," Records of your correspondence with us, such as support tickets, chat logs, and issue reports."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Technical Data:"})," IP address, device type, browser information, and portal usage data, collected automatically when you interact with the Portal for security and analytics purposes."]})]}),c.jsx("h4",{children:"2. How We Use Your Information"}),c.jsx("p",{children:"Your personal data is used for the following legitimate business purposes:"}),c.jsxs("ul",{children:[c.jsx("li",{children:"To create, maintain, and secure your AGWA Portal account."}),c.jsx("li",{children:"To provide and manage your water services, including meter reading, billing, and maintenance."}),c.jsx("li",{children:"To process your bill payments (including card, e-wallet, and rebate point transactions) and manage your account."}),c.jsx("li",{children:"To respond to your inquiries, concerns, and support tickets, and to provide customer support."}),c.jsx("li",{children:"To send you essential service advisories, billing reminders, and other system notifications."}),c.jsx("li",{children:"To manage your participation in programs such as the AGWA Rewards Program."}),c.jsx("li",{children:"To analyze portal and service usage to improve our operations, services, and user experience."}),c.jsx("li",{children:"To investigate and prevent fraud, security incidents, or other illegal activities."}),c.jsx("li",{children:"To comply with our legal and regulatory obligations as a public utility."})]}),c.jsx("h4",{children:"3. Data Sharing and Disclosure"}),c.jsx("p",{children:"We do not sell or rent your personal information. We may share your data in the following limited circumstances:"}),c.jsxs("ul",{children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Third-Party Service Providers:"})," With trusted partners who perform services on our behalf, such as payment gateways (e.g., Stripe) and cloud data hosting (e.g., Google Cloud/Firebase). These partners are contractually bound to protect your data and use it only for the purposes we specify."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Legal and Regulatory Requirements:"})," When required by law, such as in response to a subpoena, court order, or formal request from government authorities (e.g., the National Privacy Commission)."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Emergency:"})," To protect the vital interests of any individual, such as during emergencies or service-related safety incidents."]})]}),c.jsx("h4",{children:"4. Data Security and Retention"}),c.jsx("p",{children:"We implement robust technical, physical, and organizational security measures to protect your personal information from unauthorized access, use, alteration, or disclosure. This includes data encryption in transit and at rest, access controls, and secure server environments."}),c.jsx("p",{children:"We retain your personal data only for as long as your account is active or as necessary to fulfill the purposes outlined in this notice, and as required by law for auditing and regulatory record-keeping, after which it will be securely disposed of."}),c.jsx("h4",{children:"5. Your Rights as a Data Subject"}),c.jsx("p",{children:"In accordance with the Data Privacy Act, you have the right to:"}),c.jsxs("ul",{children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Be Informed"})," that your personal data will be, are being, or were processed."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Access"})," your personal information we hold."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Rectify"})," any inaccuracies or errors in your data."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Erase or Block"})," your data from our systems, subject to legal and contractual limitations."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Object"})," to the processing of your personal data."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Data Portability"})," to obtain a copy of your data in a machine-readable format."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Lodge a Complaint"})," with the National Privacy Commission (NPC) if you feel your data privacy rights have been violated."]})]}),c.jsx("h4",{children:"6. Contacting Us"}),c.jsx("p",{children:"To exercise any of these rights or if you have any questions about this privacy notice, please contact our Data Privacy Officer at:"}),c.jsxs("p",{children:[c.jsx("strong",{children:"Email:"})," ",c.jsx("a",{href:"mailto:dpo@agwa-waterservices.com.ph",children:"dpo@agwa-waterservices.com.ph"}),c.jsx("br",{}),c.jsx("strong",{children:"Address:"})," Attn: Data Privacy Officer, AGWA Water Services Bldg., Governor's Drive, Brgy. Ibayo Silangan, Naic, Cavite 4110"]}),c.jsx("h4",{children:"7. Changes to This Notice"}),c.jsx("p",{children:'We may update this Data Privacy Notice from time to time. We will notify you of any significant changes by posting the new notice on this page and updating the "Last Updated" date.'})]})]}),Vr=ss.memo(({isOpen:r,onClose:e,title:t="",children:n,size:i="md",hideCloseButton:s=!1,modalDialogClassName:o="",contentClassName:l=""})=>{const d=X.useCallback(p=>{p.key==="Escape"&&e()},[e]);if(X.useEffect(()=>(r?(window.addEventListener("keydown",d),document.body.style.overflow="hidden"):(window.removeEventListener("keydown",d),document.body.style.overflow="unset"),()=>{window.removeEventListener("keydown",d),document.body.style.overflow="unset"}),[r,d]),!r)return null;const f={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl","2xl":"max-w-2xl","3xl":"max-w-3xl","4xl":"max-w-4xl","5xl":"max-w-5xl",full:"max-w-full h-full sm:h-auto sm:max-h-[95vh]"},m=`bg-white rounded-xl shadow-2xl w-full ${f[i]||f.md} transform transition-all duration-300 ease-out scale-95 opacity-0 animate-modal-appear flex flex-col max-h-[90vh] ${o}`;return c.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex justify-center items-center z-[100] p-4 overflow-y-auto animate-fadeIn",onClick:s?void 0:e,role:"dialog","aria-modal":"true","aria-labelledby":t?"modal-title":void 0,children:[c.jsxs("div",{className:m,onClick:p=>p.stopPropagation(),role:"document",children:[t&&c.jsxs("div",{className:"flex justify-between items-center p-4 sm:p-5 border-b border-gray-200 sticky top-0 bg-white z-10 rounded-t-xl",children:[c.jsx("h3",{id:"modal-title",className:"text-lg sm:text-xl font-semibold text-gray-800",children:t}),!s&&c.jsx("button",{type:"button",onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors p-1 rounded-full hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Close modal",children:c.jsx(u0,{size:24})})]}),c.jsx("div",{className:`p-4 sm:p-6 flex-grow overflow-y-auto ${l}`,children:n})]}),c.jsx("style",{children:`
                @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
                .animate-fadeIn { animation: fadeIn 0.2s ease-out forwards; }
                @keyframes modal-appear { 0% { transform: scale(0.95) translateY(10px); opacity: 0; } 100% { transform: scale(1) translateY(0); opacity: 1; } }
                .animate-modal-appear { animation: modal-appear 0.25s cubic-bezier(0.25, 0.8, 0.25, 1) forwards; }
                `})]})});Vr.displayName="Modal";const wF=({isOpen:r,onClose:e})=>c.jsx(Vr,{isOpen:r,onClose:e,title:"Data Privacy Notice",size:"3xl",children:c.jsxs("div",{className:"prose prose-sm max-w-none max-h-[70vh] overflow-y-auto pr-2",children:[c.jsx("p",{children:c.jsx("strong",{children:"Last Updated: November 15, 2025"})}),c.jsx("h4",{children:"Our Commitment to Privacy"}),c.jsx("p",{children:'AGWA Water Services, Inc. ("AGWA", "we", "us", "our") is committed to protecting your privacy in compliance with Republic Act No. 10173, the Data Privacy Act of 2012 (DPA), its Implementing Rules and Regulations (IRR), and other relevant data privacy and protection laws.'}),c.jsx("p",{children:'This notice explains how we collect, use, disclose, process, store, and protect your personal data when you use our Customer Portal ("Portal") and our services.'}),c.jsx("h4",{children:"1. What Personal Information We Collect"}),c.jsx("p",{children:"We collect, store, and process your personal information when you register for an account, use our services, pay your bills, or interact with our customer support. This information may include:"}),c.jsxs("ul",{children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Personal Identification Data:"})," Full name, email address, phone number, and service address."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Account and Service Data:"})," AGWA Account Number, meter serial number, service type, account status, and account creation date."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Financial and Transaction Data:"})," Billing history, payment history, consumption data (meter readings), payment method details (which are securely tokenized and processed by our third-party payment partners), and rebate point information."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Communication Data:"})," Records of your correspondence with us, such as support tickets, chat logs, and issue reports."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Technical Data:"})," IP address, device type, browser information, and portal usage data, collected automatically when you interact with the Portal for security and analytics purposes."]})]}),c.jsx("h4",{children:"2. How We Use Your Information"}),c.jsx("p",{children:"Your personal data is used for the following legitimate business purposes:"}),c.jsxs("ul",{children:[c.jsx("li",{children:"To create, maintain, and secure your AGWA Portal account."}),c.jsx("li",{children:"To provide and manage your water services, including meter reading, billing, and maintenance."}),c.jsx("li",{children:"To process your bill payments (including card, e-wallet, and rebate point transactions) and manage your account."}),c.jsx("li",{children:"To respond to your inquiries, concerns, and support tickets, and to provide customer support."}),c.jsx("li",{children:"To send you essential service advisories, billing reminders, and other system notifications."}),c.jsx("li",{children:"To manage your participation in programs such as the AGWA Rewards Program."}),c.jsx("li",{children:"To analyze portal and service usage to improve our operations, services, and user experience."}),c.jsx("li",{children:"To investigate and prevent fraud, security incidents, or other illegal activities."}),c.jsx("li",{children:"To comply with our legal and regulatory obligations as a public utility."})]}),c.jsx("h4",{children:"3. Data Sharing and Disclosure"}),c.jsx("p",{children:"We do not sell or rent your personal information. We may share your data in the following limited circumstances:"}),c.jsxs("ul",{children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Third-Party Service Providers:"})," With trusted partners who perform services on our behalf, such as payment gateways (e.g., Stripe) and cloud data hosting (e.g., Google Cloud/Firebase). These partners are contractually bound to protect your data and use it only for the purposes we specify."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Legal and Regulatory Requirements:"})," When required by law, such as in response to a subpoena, court order, or formal request from government authorities (e.g., the National Privacy Commission)."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Emergency:"})," To protect the vital interests of any individual, such as during emergencies or service-related safety incidents."]})]}),c.jsx("h4",{children:"4. Data Security and Retention"}),c.jsx("p",{children:"We implement robust technical, physical, and organizational security measures to protect your personal information from unauthorized access, use, alteration, or disclosure. This includes data encryption in transit and at rest, access controls, and secure server environments."}),c.jsx("p",{children:"We retain your personal data only for as long as your account is active or as necessary to fulfill the purposes outlined in this notice, and as required by law for auditing and regulatory record-keeping, after which it will be securely disposed of."}),c.jsx("h4",{children:"5. Your Rights as a Data Subject"}),c.jsx("p",{children:"In accordance with the Data Privacy Act, you have the right to:"}),c.jsxs("ul",{children:[c.jsxs("li",{children:[c.jsx("strong",{children:"Be Informed"})," that your personal data will be, are being, or were processed."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Access"})," your personal information we hold."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Rectify"})," any inaccuracies or errors in your data."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Erase or Block"})," your data from our systems, subject to legal and contractual limitations."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Object"})," to the processing of your personal data."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Data Portability"})," to obtain a copy of your data in a machine-readable format."]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Lodge a Complaint"})," with the National Privacy Commission (NPC) if you feel your data privacy rights have been violated."]})]}),c.jsx("h4",{children:"6. Contacting Us"}),c.jsx("p",{children:"To exercise any of these rights or if you have any questions about this privacy notice, please contact our Data Privacy Officer at:"}),c.jsxs("p",{children:[c.jsx("strong",{children:"Email:"})," ",c.jsx("a",{href:"mailto:dpo@agwa-waterservices.com.ph",children:"dpo@agwa-waterservices.com.ph"}),c.jsx("br",{}),c.jsx("strong",{children:"Address:"})," Attn: Data Privacy Officer, AGWA Water Services Bldg., Governor's Drive, Brgy. Ibayo Silangan, Naic, Cavite 4110"]}),c.jsx("h4",{children:"7. Changes to This Notice"}),c.jsx("p",{children:'We may update this Data Privacy Notice from time to time. We will notify you of any significant changes by posting the new notice on this page and updating the "Last Updated" date.'})]})}),y3=ss.memo(({children:r,authError:e,appIdForPaths:t,systemSettings:n={}})=>{const[i,s]=X.useState(!1),[o,l]=X.useState(!1);return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-700 to-indigo-800 flex flex-col justify-center items-center p-4 font-sans selection:bg-blue-300 selection:text-blue-900",children:[c.jsxs("div",{className:"bg-white p-8 sm:p-10 md:p-12 rounded-xl shadow-2xl w-full max-w-md transform transition-all duration-500 ease-out animate-fadeInUp",children:[c.jsxs("div",{className:"text-center mb-8",children:[c.jsx("h1",{className:"text-5xl font-bold text-blue-600 tracking-tight",children:"AGWA"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1 italic",children:"Ensuring Clarity, Sustaining Life."})]}),e&&c.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 text-red-700 rounded-lg text-sm text-center animate-shake",role:"alert",children:e}),ss.cloneElement(r,{systemSettings:n}),c.jsxs("p",{className:"text-xs text-gray-400 text-center mt-6",children:["By continuing, you agree to our ",c.jsx("br",{}),c.jsx("button",{type:"button",onClick:()=>s(!0),className:"font-medium text-blue-600 hover:underline",children:"Terms of Service"})," ","and"," ",c.jsx("button",{type:"button",onClick:()=>l(!0),className:"font-medium text-blue-600 hover:underline",children:"Data Privacy Notice"}),"."]})]}),t&&c.jsxs("p",{className:"text-center text-xs text-blue-200 mt-8",children:["App ID (DB): ",c.jsx("span",{className:"font-semibold opacity-80",children:t})]}),c.jsxs("p",{className:"text-center text-xs text-blue-300 mt-2",children:[" ",new Date().getFullYear()," AGWA Water Services, Inc."]}),c.jsx("div",{id:"recaptcha-container",className:"my-2 mx-auto"}),c.jsx("style",{children:`
          @keyframes fadeInUp {
            from {
              opacity: 0;
              transform: translateY(20px);
            }
            to {
              opacity: 1;
              transform: translateY(0);
            }
          }
          .animate-fadeInUp {
            animation: fadeInUp 0.6s ease-out forwards;
          }

          @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
          }
          .animate-shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
          }
        `})]}),c.jsx(bF,{isOpen:i,onClose:()=>s(!1)}),c.jsx(wF,{isOpen:o,onClose:()=>l(!1)})]})});y3.displayName="AuthFormContainer";function v3(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var i=r.length;for(e=0;e<i;e++)r[e]&&(t=v3(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function B2(){for(var r,e,t=0,n="",i=arguments.length;t<i;t++)(r=arguments[t])&&(e=v3(r))&&(n&&(n+=" "),n+=e);return n}const Fi="w-full px-4 py-3 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 focus:outline-none transition duration-200 text-gray-900 placeholder-gray-400 disabled:bg-gray-200 disabled:cursor-not-allowed",um=r=>B2("w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 active:scale-95 flex items-center justify-center",{"opacity-60 cursor-not-allowed":r}),_3=r=>B2("w-full bg-white hover:bg-gray-100 text-gray-700 font-semibold py-3 px-4 rounded-lg border border-gray-300 shadow-sm hover:shadow transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-opacity-50 flex items-center justify-center space-x-2 active:scale-95",{"opacity-50 cursor-not-allowed":r}),x3=r=>B2("w-full bg-teal-500 hover:bg-teal-600 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-teal-400 focus:ring-opacity-50 flex items-center justify-center space-x-2 active:scale-95",{"opacity-50 cursor-not-allowed":r}),EF=({navigateTo:r,authActionLoading:e,handleLoginExternal:t,handleGoogleSignIn:n,setAuthError:i,systemSettings:s={}})=>{const[o,l]=X.useState(""),[d,f]=X.useState(""),[m,p]=X.useState(!1),g=async S=>{if(S.preventDefault(),!o||!d){i&&i("Please enter both email and password.");return}i&&i(""),await t(o,d)},v=async()=>{i&&i(""),await n()},{isGoogleLoginEnabled:E=!0,isPasswordlessLoginEnabled:x=!0,isSignupEnabled:b=!0}=s;return c.jsxs("form",{onSubmit:g,className:"space-y-5",children:[c.jsxs("div",{className:"relative",children:[c.jsx(Fo,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"email",placeholder:"Email Address *",value:o,onChange:S=>l(S.target.value),className:`${Fi} pl-11`,required:!0,disabled:e,"aria-label":"Email Address"})]}),c.jsxs("div",{className:"relative",children:[c.jsx(dy,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:m?"text":"password",placeholder:"Password *",value:d,onChange:S=>f(S.target.value),className:`${Fi} pl-11`,required:!0,disabled:e,"aria-label":"Password"}),c.jsx("button",{type:"button",onClick:()=>p(!m),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 p-1 focus:outline-none","aria-label":m?"Hide password":"Show password",disabled:e,children:m?c.jsx(uy,{size:20}):c.jsx(ja,{size:20})})]}),c.jsxs("button",{type:"submit",className:um(e),disabled:e,children:[e&&c.jsx(Tt,{className:"animate-spin inline mr-2",size:18}),e?"Logging In...":"Login"]}),(E||x)&&c.jsxs("div",{className:"relative my-4",children:[c.jsx("div",{className:"absolute inset-0 flex items-center",children:c.jsx("div",{className:"w-full border-t border-gray-300"})}),c.jsx("div",{className:"relative flex justify-center text-sm",children:c.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with"})})]}),E&&c.jsxs("button",{type:"button",onClick:v,className:_3(e),disabled:e,children:[c.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",className:"h-5 w-5",onError:S=>S.target.style.display="none"}),c.jsx("span",{children:"Sign in with Google"})]}),x&&c.jsxs("button",{type:"button",onClick:()=>r("passwordlessLogin"),className:x3(e),disabled:e,children:[c.jsx(L2,{size:18,className:"mr-2"}),c.jsx("span",{children:"Sign in with Email Link"})]}),c.jsxs("div",{className:"text-sm text-center mt-5 space-y-1.5",children:[b&&c.jsxs("p",{className:"text-gray-600",children:["Don't have an account?"," ",c.jsx("button",{type:"button",onClick:()=>r("signup"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-70",disabled:e,children:"Sign Up"})]}),c.jsx("p",{className:"text-gray-600",children:c.jsx("button",{type:"button",onClick:()=>r("forgotPassword"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-70",disabled:e,children:"Forgot Password?"})})]})]})},SF=({navigateTo:r,authActionLoading:e,handleSignupExternal:t,handleGoogleSignIn:n,setAuthError:i,showNotification:s,systemSettings:o={}})=>{const[l,d]=X.useState(""),[f,m]=X.useState(""),[p,g]=X.useState(""),[v,E]=X.useState(""),[x,b]=X.useState(""),[S,N]=X.useState(!1),[R,I]=X.useState(!1),j=async k=>{if(k.preventDefault(),i(""),!v.trim()){i("Full Name is required."),s("Full Name is required.","warning");return}if(!x.trim()){i("AGWA Account Number is required (e.g., RES-12345, ADM-001)."),s("AGWA Account Number is required.","warning");return}if(f.length<6){i("Password must be at least 6 characters long."),s("Password too short (min. 6 chars).","warning");return}if(f!==p){i("Passwords do not match."),s("Passwords don't match.","warning");return}await t(l,f,v,x)},U=async()=>{await n()},{isGoogleLoginEnabled:P=!0}=o;return c.jsxs("form",{onSubmit:j,className:"space-y-5",children:[c.jsxs("div",{className:"relative",children:[c.jsx(Rs,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"Full Name *",value:v,onChange:k=>E(k.target.value),className:`${Fi} pl-11`,required:!0,disabled:e,"aria-label":"Full Name"})]}),c.jsxs("div",{className:"relative",children:[c.jsx(js,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"AGWA Account Number (e.g., RES-12345) *",value:x,onChange:k=>b(k.target.value),className:`${Fi} pl-11`,required:!0,disabled:e,"aria-label":"AGWA Account Number"})]}),c.jsxs("div",{className:"relative",children:[c.jsx(Fo,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"email",placeholder:"Email Address *",value:l,onChange:k=>d(k.target.value),className:`${Fi} pl-11`,required:!0,disabled:e,"aria-label":"Email Address"})]}),c.jsxs("div",{className:"relative",children:[c.jsx(dy,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:S?"text":"password",placeholder:"Password (min. 6 chars) *",value:f,onChange:k=>m(k.target.value),className:`${Fi} pl-11`,required:!0,disabled:e,"aria-label":"Password"}),c.jsx("button",{type:"button",onClick:()=>N(!S),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 p-1 focus:outline-none","aria-label":S?"Hide password":"Show password",disabled:e,children:S?c.jsx(uy,{size:20}):c.jsx(ja,{size:20})})]}),c.jsxs("div",{className:"relative",children:[c.jsx(dy,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:R?"text":"password",placeholder:"Confirm Password *",value:p,onChange:k=>g(k.target.value),className:`${Fi} pl-11`,required:!0,disabled:e,"aria-label":"Confirm Password"}),c.jsx("button",{type:"button",onClick:()=>I(!R),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 p-1 focus:outline-none","aria-label":R?"Hide confirm password":"Show confirm password",disabled:e,children:R?c.jsx(uy,{size:20}):c.jsx(ja,{size:20})})]}),c.jsxs("button",{type:"submit",className:um(e),disabled:e,children:[e&&c.jsx(Tt,{className:"animate-spin inline mr-2",size:18}),e?"Creating Account...":"Create My Account"]}),P&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"relative my-4",children:[c.jsx("div",{className:"absolute inset-0 flex items-center",children:c.jsx("div",{className:"w-full border-t border-gray-300"})}),c.jsx("div",{className:"relative flex justify-center text-sm",children:c.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or sign up with"})})]}),c.jsxs("button",{type:"button",onClick:U,className:_3(e),disabled:e,children:[c.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",className:"h-5 w-5",onError:k=>k.target.style.display="none"}),c.jsx("span",{children:"Sign up with Google"})]})]}),c.jsxs("p",{className:"text-sm text-center text-gray-600 mt-5",children:["Already have an account?"," ",c.jsx("button",{type:"button",onClick:()=>r("login"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-70",disabled:e,children:"Login"})]})]})},TF=({handleForgotPasswordExternal:r,navigateTo:e,authActionLoading:t})=>{const[n,i]=X.useState(""),[s,o]=X.useState(!1),l=async d=>{if(d.preventDefault(),!n.trim()){alert("Please enter your email address.");return}await r(n)&&o(!0)};return s?c.jsxs("div",{className:"space-y-5 text-center",children:[c.jsx(Fo,{size:48,className:"mx-auto text-green-500 mb-3"}),c.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Password Reset Email Sent"}),c.jsxs("p",{className:"text-sm text-gray-600",children:["If an account exists for ",c.jsx("strong",{children:n}),", you will receive an email with instructions to reset your password. Please check your inbox (and spam folder)."]}),c.jsxs("button",{type:"button",onClick:()=>e("login"),className:`${um(!1)} bg-green-600 hover:bg-green-700 focus:ring-green-500 mt-4`,children:[c.jsx(ly,{size:18,className:"mr-2"})," Back to Login"]})]}):c.jsxs("form",{onSubmit:l,className:"space-y-5",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-4 text-center",children:"Enter your email address below, and we'll send you a link to reset your password."}),c.jsxs("div",{className:"relative",children:[c.jsx(Fo,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"email",placeholder:"Enter your Email Address",value:n,onChange:d=>i(d.target.value),className:`${Fi} pl-11`,required:!0,disabled:t,"aria-label":"Email for password reset"})]}),c.jsxs("button",{type:"submit",className:um(t||!n.trim()),disabled:t||!n.trim(),children:[t?c.jsx(Tt,{className:"animate-spin mr-2",size:20}):null,t?"Sending Link...":"Send Password Reset Link"]}),c.jsx("div",{className:"text-sm text-center mt-6",children:c.jsxs("button",{type:"button",onClick:()=>e("login"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-50",disabled:t,children:[c.jsx(ly,{size:16,className:"inline mr-1"})," Remembered your password? Login"]})})]})},AF=({handlePasswordlessSignInExternal:r,navigateTo:e,authActionLoading:t})=>{const[n,i]=X.useState(""),[s,o]=X.useState(!1),l=async d=>{if(d.preventDefault(),!n.trim()){alert("Please enter your email address.");return}const f=await r(n);f&&f.success&&o(!0)};return s?c.jsxs("div",{className:"space-y-5 text-center",children:[c.jsx(Cs,{size:48,className:"mx-auto text-green-500 mb-3"}),c.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Sign-in Link Sent!"}),c.jsxs("p",{className:"text-sm text-gray-600",children:["A magic sign-in link has been sent to ",c.jsx("strong",{children:n}),". Please check your email and click the link to sign in. The link is valid for a limited time."]}),c.jsxs("button",{type:"button",onClick:()=>e("login"),className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 flex items-center justify-center mt-4",children:[c.jsx(ly,{size:18,className:"mr-2"})," Okay, Got It!"]})]}):c.jsxs("form",{onSubmit:l,className:"space-y-5",children:[c.jsx("p",{className:"text-sm text-gray-600 mb-4 text-center",children:"Enter your email address, and we'll send you a magic link to sign in instantly. No password needed!"}),c.jsxs("div",{className:"relative",children:[c.jsx(Fo,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"email",placeholder:"Enter your Email Address",value:n,onChange:d=>i(d.target.value),className:`${Fi} pl-11`,required:!0,disabled:t,"aria-label":"Email for passwordless sign-in"})]}),c.jsxs("button",{type:"submit",className:x3(t||!n.trim()),disabled:t||!n.trim(),children:[t?c.jsx(Tt,{className:"animate-spin mr-2",size:20}):c.jsx(L2,{size:20,className:"mr-2"}),t?"Sending Link...":"Send Sign-in Link"]}),c.jsx("div",{className:"text-sm text-center mt-6",children:c.jsxs("button",{type:"button",onClick:()=>e("login"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-50",disabled:t,children:[c.jsx(ly,{size:16,className:"inline mr-1"})," Prefer a password? Login"]})})]})},NF={Home:M2,UserCog:p3,FileText:oc,AlertTriangle:Zt,Users:Ia,MessageSquare:Oa,Settings:c0,HelpCircle:j2,Info:yn,PhoneCall:u3,LogOut:a0,ShieldCheck:hh,Megaphone:Rd,BarChart3:k2,Edit:cm,Gauge:ac,Map:lc,ClipboardEdit:O2,Search:Os,Banknote:cy,FileSearch:D2,TrendingUp:h3,Gift:bu,AlertIcon:Zt,EditIcon:cm,Eye:ja},IF=({userData:r,navItems:e,activeSection:t,onNavigate:n,onLogout:i,isMobileOpen:s,setMobileOpen:o})=>{var p;const l=`https://placehold.co/40x40/FFFFFF/3B82F6?text=${((r==null?void 0:r.displayName)||(r==null?void 0:r.email)||"U").charAt(0).toUpperCase()}`,d=e.reduce((g,v)=>{const E=v.group||"General";return g[E]||(g[E]=[]),g[E].push(v),g},{}),f=["Main","Account","Operations","Administration","Support","Information","Help & Info"],m=c.jsxs("div",{className:"h-full flex flex-col bg-gradient-to-b from-blue-700 to-blue-900 text-white shadow-2xl",children:[c.jsxs("div",{className:"p-5 pt-6 text-center border-b border-blue-600",children:[c.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-white tracking-tight",children:"AGWA"}),c.jsx("p",{className:"text-xs text-blue-200 font-light mt-0.5 italic",children:"Ensuring Clarity, Sustaining Life."})]}),c.jsx("nav",{className:"flex-grow p-3 space-y-1.5 overflow-y-auto scrollbar-thin scrollbar-thumb-blue-500 scrollbar-track-blue-800",children:f.map(g=>{const v=d[g];return v?c.jsxs("div",{className:"space-y-1.5",children:[f.length>1&&c.jsx("h3",{className:"px-3.5 pt-3 pb-1 text-xs font-semibold text-blue-300 uppercase tracking-wider",children:g}),v.map(E=>{const x=NF[E.iconName]||j2,b=t===E.section;return c.jsxs("button",{onClick:()=>{n(E.section),o&&o(!1)},className:`w-full flex items-center space-x-3 px-3.5 py-2.5 rounded-lg transition-all duration-200 ease-in-out text-sm font-medium focus:outline-none focus:ring-2 focus:ring-opacity-50 focus:ring-sky-300 group
                                            ${b?"bg-sky-500 text-white shadow-md transform scale-105 font-semibold":"text-blue-100 hover:bg-blue-600/70 hover:text-white hover:translate-x-1"}`,title:E.name,children:[c.jsx(x,{size:20,className:`${b?"text-white":"text-blue-300 group-hover:text-white transition-colors"}`}),c.jsx("span",{className:"truncate",children:E.name})]},E.section||E.name)})]},g):null})}),c.jsxs("div",{className:"p-4 border-t border-blue-600",children:[r&&c.jsxs("div",{className:"flex items-center mb-3 p-2.5 bg-blue-800/50 rounded-lg shadow-inner",children:[c.jsx("img",{src:r.photoURL||l,alt:"User",className:"h-10 w-10 rounded-full border-2 border-blue-400 object-cover bg-gray-200 flex-shrink-0",onError:g=>{g.target.onerror=null,g.target.src=l}}),c.jsxs("div",{className:"ml-3 overflow-hidden",children:[c.jsx("p",{className:"text-sm font-semibold leading-tight truncate text-white",title:r.displayName||r.email,children:r.displayName||r.email}),c.jsxs("p",{className:"text-xs text-blue-200 leading-tight capitalize truncate",title:`Role: ${r.role}`,children:["Role: ",((p=r.role)==null?void 0:p.replace("_"," "))||"N/A"]}),r.role==="customer"&&c.jsxs("p",{className:"text-xs text-blue-300 leading-tight truncate",title:`Account: ${r.accountNumber||"N/A"}`,children:["Acc: ",r.accountNumber||"N/A"]})]})]}),c.jsxs("button",{onClick:i,className:"w-full flex items-center justify-center space-x-2 bg-red-600 hover:bg-red-700 text-white font-semibold py-2.5 px-4 rounded-lg transition-all duration-150 active:scale-95 focus:outline-none focus:ring-2 focus:ring-red-400 ring-offset-2 ring-offset-blue-800",children:[c.jsx(a0,{size:20}),c.jsx("span",{children:"Logout"})]})]})]});return c.jsxs(c.Fragment,{children:[c.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-60 z-40 lg:hidden transition-opacity duration-300 ${s?"opacity-100":"opacity-0 pointer-events-none"} no-print`,onClick:()=>o(!1),"aria-hidden":"true"}),c.jsx("aside",{className:`fixed top-0 left-0 h-full w-64 z-50 transform transition-transform duration-300 ease-in-out lg:translate-x-0 ${s?"translate-x-0 shadow-xl":"-translate-x-full"} no-print`,children:m}),c.jsx("style",{children:`
                .scrollbar-thin { scrollbar-width: thin; scrollbar-color: #3b82f6 #1e40af; }
                .scrollbar-thin::-webkit-scrollbar { width: 6px; height: 6px; }
                .scrollbar-thin::-webkit-scrollbar-track { background: #1e40af; border-radius: 3px;}
                .scrollbar-thin::-webkit-scrollbar-thumb { background-color: #3b82f6; border-radius: 3px; border: 1px solid #1e40af; }
                .scrollbar-thin::-webkit-scrollbar-thumb:hover { background-color: #2563eb; }
             `})]})},PF=({title:r,value:e,icon:t,iconColor:n="text-blue-600",borderColor:i="border-blue-600",subtext:s,onClick:o,className:l=""})=>{const d="bg-white p-5 rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 ease-in-out flex items-start space-x-4 border-l-4",f=o?"cursor-pointer":"";return c.jsxs("div",{className:`${d} ${i} ${f} ${l}`,onClick:o,role:o?"button":"figure",tabIndex:o?0:-1,onKeyDown:o?m=>{(m.key==="Enter"||m.key===" ")&&o()}:void 0,children:[t&&c.jsx("div",{className:"p-2 bg-gray-100 rounded-full",children:c.jsx(t,{className:`w-7 h-7 ${n}`,"aria-hidden":"true"})}),c.jsxs("div",{className:"flex-1 overflow-hidden",children:[c.jsx("p",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider truncate",title:r,children:r}),c.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-gray-800 truncate",title:String(e),children:e}),s&&c.jsx("p",{className:"text-xs text-gray-500 mt-1 truncate",title:s,children:s})]})]})},fi=ss.memo(PF),ln=({size:r="h-8 w-8",color:e="text-blue-600",className:t="",message:n="",messageClassName:i="text-sm text-gray-500 mt-2"})=>c.jsxs("div",{className:`flex flex-col items-center justify-center ${t}`,children:[c.jsx(Tt,{className:`animate-spin ${r} ${e}`}),n&&c.jsx("p",{className:i,children:n})]}),Vo=async(r,e="llama-3.1-8b-instant")=>{throw new Error("Groq API key is missing. Please check your .env file for VITE_GROQ_API_KEY.")},kF=async(r,e)=>{const t=r.map(i=>({role:i.role==="assistant"?"assistant":"user",content:i.text})),n=[{role:"system",content:e},...t];return Vo(n,"llama-3.1-8b-instant")},CF=async({title:r,reason:e,area:t,time:n})=>Vo(),b3=async({ticketDescription:r,conversationHistory:e,draftReply:t,customerName:n})=>Vo(),RF=async({billDetails:r,charges:e,customerName:t,serviceType:n})=>(`${t}${r.monthYear}${r.amount.toFixed(2)}${Mt(r.dueDate)}${r.consumption}${r.monthYear}${e.basicCharge.toFixed(2)}${r.consumption}${n}${e.fcda.toFixed(2)}${e.environmentalCharge.toFixed(2)}${e.maintenanceServiceCharge.toFixed(2)}`,e.sewerageCharge>0&&`${e.sewerageCharge.toFixed(2)}`,`${e.vat.toFixed(2)}`,r.previousUnpaidAmount>0&&`${(r.previousUnpaidAmount||0).toFixed(2)}`,r.seniorCitizenDiscount>0&&`${(r.seniorCitizenDiscount||0).toFixed(2)}`,`${r.amount.toFixed(2)}${Mt(r.dueDate)}`,Vo()),As=async(r,e)=>{const t=Array.isArray(e)?JSON.stringify(e):JSON.stringify(Object.entries(e).map(([s,o])=>({[s]:o}))),i=[{role:"user",content:`
        You are a formal, senior business analyst for AGWA Water Services, writing an internal technical report.
        The currency for all financial data is Philippine Pesos (PHP).
        
        Analyze the following dataset for a specific chart. Provide a concise, data-driven analysis (2-3 sentences).

        **CRITICAL FORMATTING RULES:**
        1.  Your ENTIRE response MUST be a single HTML block.
        2.  The response MUST start with \`<p><strong>Analysis:</strong>\`.
        3.  You MUST NOT use any markdown (e.g., \`**\` or \`##\`). All emphasis MUST use \`<strong>\` or \`<em>\` tags.

        **TONE & CONTENT INSTRUCTIONS:**
        -   Use a professional, corporate, and technical tone.
        -   Do not simply state what the chart shows (e.g., "Cash is 60%").
        -   Explain what the data *implies* for business operations, revenue impact, or operational efficiency. Provide inferences.

        Chart Title: "${r}"
        Data: ${t}
        
        Output ONLY the HTML, starting with <p>.
    `}];return Vo(i,"llama-3.1-8b-instant")},jF=({user:r,userData:e,db:t,showNotification:n,setActiveSection:i,billingService:s,systemSettings:o})=>{const[l,d]=X.useState([]),[f,m]=X.useState(!0),[p,g]=X.useState(""),[v,E]=X.useState(0),[x,b]=X.useState(""),[S,N]=X.useState(""),[R,I]=X.useState(!1),[j,U]=X.useState(!1),P=X.useCallback(async()=>{if(!r||!r.uid||!e||!s){m(!1),g("User data or essential services are unavailable.");return}m(!0),g("");try{const D=await _u(t,r.uid);if(D.success){const $=D.data.map(ee=>{var G;const se=s(ee.consumption,e.serviceType,e.meterSize,o||{}),ie=N2(ee,o),re=(ee.amount||0)+ie;return{...ee,calculatedCharges:se,amount:re,displayPenalty:ie,billDateTimestamp:(G=ee.billDate)!=null&&G.toDate?ee.billDate.toDate():new Date(ee.billDate)}}).sort((ee,se)=>se.billDateTimestamp-ee.billDateTimestamp);d($.slice(0,3));const K=$.filter(ee=>ee.status==="Unpaid");if(K.length>0){const se=K.sort((re,G)=>{var z,Z;return new Date(((z=re.dueDate)==null?void 0:z.toDate())||0)-new Date(((Z=G.dueDate)==null?void 0:Z.toDate())||0)})[0],ie=K.reduce((re,G)=>re+(G.amount||0),0);E(ie),b(se.dueDate)}else E(0),b("")}else g(D.error||"Failed to fetch recent bills."),n(D.error||"Failed to fetch recent bills.","error")}catch(D){console.error("Error fetching customer dashboard data:",D);const $="An error occurred while loading your dashboard information.";g($),n($,"error")}m(!1)},[r,e,t,n,s,o]);X.useEffect(()=>{P()},[P]);const k=async()=>{I(!0),U(!0),N("");try{const D=e.serviceAddress&&e.serviceAddress.barangay?`for a household in ${e.serviceAddress.barangay}`:"for a household",ee=await Vo([{role:"user",content:`
                You are Agie, a professional and helpful AI assistant for AGWA Water Services.
                Please provide 8 practical water-saving tips and 2 surprising water trivia facts for a customer in the Philippines.
                
                Instructions:
                1.  Provide a short, friendly opening paragraph (e.g., "Hello! I'm Agie...").
                2.  Create a section titled "<strong>Practical Water-Saving Tips</strong>".
                3.  List 8 tips using a <ul> with <li> elements.
                4.  Include at least one Philippines-specific tip (like using a "tabo" or "timba" / pail).
                5.  Create a second section titled "<strong>Water Trivia</strong>".
                6.  List 2 surprising facts, also in a <ul>.
                7.  Wrap all content in simple HTML tags: <p>, <ul>, <li>, <strong>.
                8.  Do NOT use any markdown (like *, **, or #).
            `}]);N(ee)}catch(D){const $=(D==null?void 0:D.message)||"Could not fetch water saving tips at the moment.";n($,"error"),N("<p>Sorry, couldn't fetch tips right now. A simple tip: Always check for leaky faucets and toilets, as they are the most common sources of water waste!</p>")}finally{I(!1)}},F=`${v.toFixed(2)}`,O=v>0&&x?`Next Due: ${Mt(x,{month:"short",day:"numeric",year:"numeric"})}`:v===0?"All bills settled!":"",C="p-5 bg-white rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 ease-in-out text-left focus:outline-none focus:ring-2 focus:ring-opacity-75 flex flex-col items-start h-full",M=()=>c.jsx("span",{className:"font-bold",children:""});return c.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5",children:[c.jsx(fi,{title:"Account Status",value:f&&!e.accountStatus?c.jsx(Tt,{className:"animate-spin h-5 w-5"}):e.accountStatus||"Active",icon:hh,borderColor:"border-green-500",iconColor:"text-green-500"}),c.jsx(fi,{title:"Current Balance",value:f&&v===0&&x===""?c.jsx(Tt,{className:"animate-spin h-5 w-5"}):F,subtext:O,icon:M,borderColor:v>0?"border-red-500":"border-green-500",iconColor:v>0?"text-red-500":"text-green-500"}),c.jsx(fi,{title:"Account Number",value:e.accountNumber||"N/A",icon:Rs,borderColor:"border-blue-500",iconColor:"text-blue-500"}),c.jsx(fi,{title:"Service Type",value:e.serviceType||"Residential",icon:M2,borderColor:"border-purple-500",iconColor:"text-purple-500"})]}),p&&c.jsxs("div",{className:"p-4 bg-red-50 text-red-700 border border-red-200 rounded-lg text-sm flex items-center justify-center",children:[c.jsx(Zt,{size:20,className:"mr-2"})," ",p]}),c.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:c.jsxs("div",{className:"lg:col-span-3 bg-white p-5 rounded-xl shadow-lg",children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-3 flex items-center",children:[c.jsx(oc,{size:22,className:"mr-2 text-gray-500"}),"Recent Bills Summary"]}),f?c.jsx(ln,{message:"Loading recent bills..."}):l.length>0?c.jsxs("div",{className:"space-y-3",children:[l.map(D=>{const $=D.status==="Paid",K=$&&D.amountPaid||D.amount;return c.jsxs("div",{className:`flex flex-col sm:flex-row justify-between items-start sm:items-center p-3.5 border rounded-lg hover:bg-gray-50/70 transition-colors duration-150 ${$?"border-green-200 bg-green-50/50":"border-yellow-200 bg-yellow-50/30"}`,children:[c.jsxs("div",{children:[c.jsxs("p",{className:"font-medium text-gray-800 text-sm",children:[D.monthYear||D.billingPeriod," - ",c.jsxs("span",{className:"font-bold",children:["",K==null?void 0:K.toFixed(2)]})]}),c.jsxs("p",{className:`text-xs mt-0.5 font-semibold ${$?"text-green-600":"text-orange-600"}`,children:["Status: ",D.status," ",!$&&`(Due: ${Mt(D.dueDate,{month:"short",day:"numeric"})})`,D.displayPenalty>0&&!$&&c.jsxs("span",{className:"text-xs text-red-500 font-semibold block",children:["(Includes ",D.displayPenalty.toFixed(2)," penalty)"]})]})]}),c.jsxs("div",{className:"flex gap-2 mt-2 sm:mt-0",children:[!$&&c.jsx("button",{onClick:()=>i("myBills"),className:"text-xs bg-red-500 hover:bg-red-600 text-white py-1.5 px-3 rounded-md transition-all active:scale-95 font-medium",children:"Pay Now"}),c.jsx("button",{onClick:()=>i("myBills"),className:"text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 py-1.5 px-3 rounded-md transition-all font-medium",children:"View Details"})]})]},D.id)}),c.jsx("button",{onClick:()=>i("myBills"),className:"mt-3 text-sm text-blue-600 hover:text-blue-800 font-medium hover:underline",children:"View All Bills & Payment History "})]}):c.jsxs("div",{className:"text-sm text-gray-500 py-4 text-center",children:[c.jsx(yn,{size:24,className:"mx-auto mb-1 text-gray-400"}),"No recent bills to display. All up to date!"]})]})}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[c.jsxs("button",{onClick:()=>i("myBills"),className:`${C} focus:ring-green-500 border-l-4 border-green-500`,children:[c.jsx(o0,{size:26,className:"mb-2 text-green-500"}),c.jsx("h4",{className:"font-semibold text-green-700 text-md",children:"Pay My Bill"}),c.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"View outstanding bills and make (simulated) payments."})]}),c.jsxs("button",{onClick:()=>i("reportIssue"),className:`${C} focus:ring-orange-500 border-l-4 border-orange-500`,children:[c.jsx(Zt,{size:26,className:"mb-2 text-orange-500"}),c.jsx("h4",{className:"font-semibold text-orange-700 text-md",children:"Report an Issue"}),c.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Report leaks, service interruptions, or other concerns."})]}),c.jsxs("button",{onClick:k,className:`${C} focus:ring-teal-500 border-l-4 border-teal-500`,disabled:R,children:[c.jsxs("div",{className:"flex items-center justify-between w-full",children:[c.jsx(Ds,{size:26,className:"mb-2 text-teal-500"}),R&&c.jsx(Tt,{className:"animate-spin text-teal-500",size:20})]}),c.jsx("h4",{className:"font-semibold text-teal-700 text-md",children:R?"Getting Tips...":" Get Water Saving Tips"}),c.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Discover ways to conserve water and save money."})]})]}),c.jsx(Vr,{isOpen:j,onClose:()=>U(!1),title:" Water Saving Tips by Agie",size:"lg",children:R?c.jsx("div",{className:"flex justify-center items-center h-40",children:c.jsx(ln,{message:"Agie is thinking of the best tips for you..."})}):c.jsx("div",{className:"prose prose-sm sm:prose max-w-none p-2 leading-relaxed text-gray-700",dangerouslySetInnerHTML:{__html:S||"<p>No tips available at the moment. Please try again!</p>"}})})]})},Da=({isOpen:r,onClose:e,onConfirm:t,title:n,children:i,confirmText:s="Confirm",cancelText:o="Cancel",confirmButtonClass:l="bg-red-600 hover:bg-red-700 focus:ring-red-500",cancelButtonClass:d="bg-gray-200 hover:bg-gray-300 text-gray-700 focus:ring-gray-400",iconType:f="warning",isConfirming:m=!1})=>{if(!r)return null;let p,g="";switch(f){case"success":p=Cs,g="text-green-500";break;case"danger":p=Z9,g="text-red-500";break;case"warning":default:p=Zt,g="text-yellow-500";break}return c.jsxs(Vr,{isOpen:r,onClose:e,title:n,size:"md",children:[c.jsxs("div",{className:"text-center",children:[p&&c.jsx("div",{className:`mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-${f==="warning"?"yellow":f==="success"?"green":"red"}-100 mb-4`,children:c.jsx(p,{className:`h-6 w-6 ${g}`,"aria-hidden":"true"})}),c.jsx("div",{className:"text-sm text-gray-600 mb-6",children:i})]}),c.jsxs("div",{className:"mt-5 sm:mt-6 flex flex-col sm:flex-row-reverse gap-3",children:[c.jsxs("button",{type:"button",className:`w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 text-base font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 sm:text-sm ${l} ${m?"opacity-50 cursor-not-allowed":""}`,onClick:t,disabled:m,children:[m?c.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[c.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),c.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):null,m?"Processing...":s]}),c.jsx("button",{type:"button",className:`w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 text-base font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 sm:text-sm ${d}`,onClick:e,disabled:m,children:o})]})]})};var w3="clover",OF=function(e){return e===3?"v3":e},E3="https://js.stripe.com",DF="".concat(E3,"/").concat(w3,"/stripe.js"),MF=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,LF=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var FF=function(e){return MF.test(e)||LF.test(e)},VF=function(){for(var e=document.querySelectorAll('script[src^="'.concat(E3,'"]')),t=0;t<e.length;t++){var n=e[t];if(FF(n.src))return n}return null},oA=function(e){var t="",n=document.createElement("script");n.src="".concat(DF).concat(t);var i=document.head||document.body;if(!i)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return i.appendChild(n),n},BF=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"8.2.0",startTime:t})},Zh=null,$p=null,Wp=null,zF=function(e){return function(t){e(new Error("Failed to load Stripe.js",{cause:t}))}},UF=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},qF=function(e){return Zh!==null?Zh:(Zh=new Promise(function(t,n){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe){t(window.Stripe);return}try{var i=VF();if(!(i&&e)){if(!i)i=oA(e);else if(i&&Wp!==null&&$p!==null){var s;i.removeEventListener("load",Wp),i.removeEventListener("error",$p),(s=i.parentNode)===null||s===void 0||s.removeChild(i),i=oA(e)}}Wp=UF(t,n),$p=zF(n),i.addEventListener("load",Wp),i.addEventListener("error",$p)}catch(o){n(o);return}}),Zh.catch(function(t){return Zh=null,Promise.reject(t)}))},HF=function(e,t,n){if(e===null)return null;var i=t[0],s=i.match(/^pk_test/),o=OF(e.version),l=w3;s&&o!==l&&console.warn("Stripe.js@".concat(o," was loaded on the page, but @stripe/stripe-js@").concat("8.2.0"," expected Stripe.js@").concat(l,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var d=e.apply(void 0,t);return BF(d,n),d},Qh,S3=!1,T3=function(){return Qh||(Qh=qF(null).catch(function(e){return Qh=null,Promise.reject(e)}),Qh)};Promise.resolve().then(function(){return T3()}).catch(function(r){S3||console.warn(r)});var $F=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];S3=!0;var i=Date.now();return T3().then(function(s){return HF(s,t,i)})};const WF=$F(void 0),GF=()=>WF,KF=async(r,e,t,n,i)=>{try{const o=vb().currentUser;if(!o)throw new Error("User not authenticated.");const l=await o.getIdToken(),d=Math.round(e*100),f=`${window.location.origin}/?payment=success&session_id={CHECKOUT_SESSION_ID}`,m=`${window.location.origin}/?payment=cancel`,p=await fetch("/api/createStripeCheckoutSession",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({billId:r,amount:d,userEmail:t,userId:n,accountNumber:i,successUrl:f,cancelUrl:m})});if(!p.ok){let v=`API Error: ${p.statusText}`;try{v=(await p.json()).error||"Failed to create session from API"}catch{v=`API route returned an invalid or empty response. Status: ${p.status}.`}throw new Error(v)}const g=await p.json();if(!g||!g.sessionUrl)throw new Error("Invalid response from checkout session API. Missing sessionUrl.");return g.sessionUrl}catch(s){throw console.error("Error creating checkout session:",s),new Error(s.message||"Could not connect to payment service.")}},YF=async(r,e)=>{try{const n=vb().currentUser;if(!n)throw new Error("User not authenticated.");const i=await n.getIdToken(),s=await fetch("/api/verifyStripePayment",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({sessionId:r})});if(!s.ok){const l=await s.json();throw new Error(l.error||"Payment verification failed.")}const o=await s.json();if(o.success&&o.paymentDetails){const{billId:l,amount:d,amountPaid:f,paymentMethod:m,paymentReference:p}=o.paymentDetails,v=parseFloat(d||f)/100,x=await n3(e,l,{status:"Paid",paymentDate:new Date,paymentTimestamp:new Date,amountPaid:v,paymentMethod:m||"Stripe",paymentReference:p});if(!x.success)throw new Error(x.error||"Failed to update bill after payment verification.");return{success:!0}}else throw new Error(o.error||"Invalid verification response from server.")}catch(t){return console.error("Error verifying checkout session:",t),{success:!1,error:"An error occurred while verifying your payment. Please try again."}}},ZF=({isOpen:r,onClose:e,billToPay:t,userData:n,showNotification:i,stripePromise:s})=>{var p;const[o,l]=X.useState(!1),[d,f]=X.useState(""),m=async()=>{if(l(!0),f(""),!s||!t||!n){f("Payment system is not initialized."),l(!1);return}try{const g=await KF(t.id,t.amount,n.email,n.uid,n.accountNumber);if(g&&(g.startsWith("https://checkout.stripe.com/")||g.startsWith("https://test.stripe.com/")))window.location.href=g;else throw console.error("Invalid or untrusted session URL received:",g),new Error("Received an invalid payment URL. Please try again.")}catch(g){const v="Failed to create payment session. This could be a temporary network issue or a problem with the payment service. Please try again in a moment. (Error: "+(g.message||"Unknown")+")";f(v),i("Failed to create payment session. Please try again.","error"),l(!1)}};return r?c.jsx(Vr,{isOpen:r,onClose:e,title:"Secure Payment with Stripe",size:"md",children:c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg text-center",children:[c.jsx("p",{className:"text-sm text-blue-700",children:"You are paying for bill:"}),c.jsx("p",{className:"font-bold text-lg text-blue-800",children:t.monthYear}),c.jsxs("div",{className:"mt-2 text-3xl font-bold text-gray-800",children:["",((p=t.amount)==null?void 0:p.toFixed(2))||"0.00"]})]}),d&&c.jsxs("div",{className:"p-3 bg-red-100 border border-red-300 text-red-700 rounded-lg text-sm flex items-center gap-2",children:[c.jsx(Zt,{size:18}),c.jsx("span",{children:d})]}),c.jsxs("div",{className:"pt-6 border-t border-gray-200",children:[c.jsx("button",{onClick:m,className:"w-full flex items-center justify-center py-3 px-4 bg-blue-600 text-white font-bold rounded-lg text-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors",disabled:o,children:o?c.jsxs(c.Fragment,{children:[c.jsx(Tt,{className:"animate-spin mr-2"})," Processing..."]}):c.jsxs(c.Fragment,{children:[" ",c.jsx(o0,{className:"mr-2",size:20})," Proceed to Secure Checkout"]})}),c.jsx("p",{className:"text-xs text-center text-gray-500 mt-2",children:"You will be redirected to Stripe to complete your payment."})]})]})}):null},A3=({value:r})=>{if(!r)return null;const e=n=>{const i={0:"1101100",1:"1100110",2:"1001101",3:"1011001",4:"1010011",5:"1100101",6:"1000111",7:"1011100",8:"1110100",9:"1110010","-":"1001011"},s="10100",o="10100";let l=s;for(const d of n)i[d]&&(l+=i[d]);return l+=o,l.split("").map((d,f)=>c.jsx("div",{style:{height:"100%",width:"1px",backgroundColor:d==="1"?"#000":"transparent"}},f))},t=r.replace(/[^0-9-]/g,"");return c.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},children:[c.jsx("div",{style:{display:"flex",height:"48px",alignItems:"stretch"},"aria-label":`Barcode for ${t}`,children:e(t)}),c.jsx("p",{style:{letterSpacing:"0.1em",fontSize:"10px",fontFamily:"monospace",marginTop:"4px"},children:t})]})};/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:N3,setPrototypeOf:aA,isFrozen:QF,getPrototypeOf:XF,getOwnPropertyDescriptor:JF}=Object;let{freeze:pi,seal:Ms,create:zx}=Object,{apply:Ux,construct:qx}=typeof Reflect<"u"&&Reflect;pi||(pi=function(e){return e});Ms||(Ms=function(e){return e});Ux||(Ux=function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];return e.apply(t,i)});qx||(qx=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new e(...n)});const Gp=gi(Array.prototype.forEach),eV=gi(Array.prototype.lastIndexOf),lA=gi(Array.prototype.pop),Xh=gi(Array.prototype.push),tV=gi(Array.prototype.splice),Ig=gi(String.prototype.toLowerCase),Jv=gi(String.prototype.toString),e1=gi(String.prototype.match),Jh=gi(String.prototype.replace),nV=gi(String.prototype.indexOf),rV=gi(String.prototype.trim),io=gi(Object.prototype.hasOwnProperty),ui=gi(RegExp.prototype.test),ef=iV(TypeError);function gi(r){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Ux(r,e,n)}}function iV(r){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return qx(r,t)}}function qt(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:Ig;aA&&aA(r,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){const s=t(i);s!==i&&(QF(e)||(e[n]=s),i=s)}r[i]=!0}return r}function sV(r){for(let e=0;e<r.length;e++)io(r,e)||(r[e]=null);return r}function ga(r){const e=zx(null);for(const[t,n]of N3(r))io(r,t)&&(Array.isArray(n)?e[t]=sV(n):n&&typeof n=="object"&&n.constructor===Object?e[t]=ga(n):e[t]=n);return e}function tf(r,e){for(;r!==null;){const n=JF(r,e);if(n){if(n.get)return gi(n.get);if(typeof n.value=="function")return gi(n.value)}r=XF(r)}function t(){return null}return t}const cA=pi(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),t1=pi(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),n1=pi(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),oV=pi(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),r1=pi(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),aV=pi(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),uA=pi(["#text"]),dA=pi(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),i1=pi(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),hA=pi(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Kp=pi(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),lV=Ms(/\{\{[\w\W]*|[\w\W]*\}\}/gm),cV=Ms(/<%[\w\W]*|[\w\W]*%>/gm),uV=Ms(/\$\{[\w\W]*/gm),dV=Ms(/^data-[\-\w.\u00B7-\uFFFF]+$/),hV=Ms(/^aria-[\-\w]+$/),I3=Ms(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),fV=Ms(/^(?:\w+script|data):/i),mV=Ms(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),P3=Ms(/^html$/i),pV=Ms(/^[a-z][.\w]*(-[.\w]+)+$/i);var fA=Object.freeze({__proto__:null,ARIA_ATTR:hV,ATTR_WHITESPACE:mV,CUSTOM_ELEMENT:pV,DATA_ATTR:dV,DOCTYPE_NAME:P3,ERB_EXPR:cV,IS_ALLOWED_URI:I3,IS_SCRIPT_OR_DATA:fV,MUSTACHE_EXPR:lV,TMPLIT_EXPR:uV});const nf={element:1,text:3,progressingInstruction:7,comment:8,document:9},gV=function(){return typeof window>"u"?null:window},yV=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(n=t.getAttribute(i));const s="dompurify"+(n?"#"+n:"");try{return e.createPolicy(s,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},mA=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function k3(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:gV();const e=et=>k3(et);if(e.version="3.3.0",e.removed=[],!r||!r.document||r.document.nodeType!==nf.document||!r.Element)return e.isSupported=!1,e;let{document:t}=r;const n=t,i=n.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:l,Element:d,NodeFilter:f,NamedNodeMap:m=r.NamedNodeMap||r.MozNamedAttrMap,HTMLFormElement:p,DOMParser:g,trustedTypes:v}=r,E=d.prototype,x=tf(E,"cloneNode"),b=tf(E,"remove"),S=tf(E,"nextSibling"),N=tf(E,"childNodes"),R=tf(E,"parentNode");if(typeof o=="function"){const et=t.createElement("template");et.content&&et.content.ownerDocument&&(t=et.content.ownerDocument)}let I,j="";const{implementation:U,createNodeIterator:P,createDocumentFragment:k,getElementsByTagName:F}=t,{importNode:O}=n;let C=mA();e.isSupported=typeof N3=="function"&&typeof R=="function"&&U&&U.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:M,ERB_EXPR:D,TMPLIT_EXPR:$,DATA_ATTR:K,ARIA_ATTR:ee,IS_SCRIPT_OR_DATA:se,ATTR_WHITESPACE:ie,CUSTOM_ELEMENT:re}=fA;let{IS_ALLOWED_URI:G}=fA,z=null;const Z=qt({},[...cA,...t1,...n1,...r1,...uA]);let J=null;const ae=qt({},[...dA,...i1,...hA,...Kp]);let le=Object.seal(zx(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Q=null,ce=null;const ue=Object.seal(zx(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let fe=!0,ve=!0,Me=!1,Pe=!0,qe=!1,Ge=!0,lt=!1,Ct=!1,bt=!1,Te=!1,Ie=!1,Le=!1,Be=!0,ke=!1;const _t="user-content-";let gt=!0,yt=!1,kt={},Ft=null;const Vt=qt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let cs=null;const Gt=qt({},["audio","video","img","source","image","track"]);let Fn=null;const us=qt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ui="http://www.w3.org/1998/Math/MathML",yi="http://www.w3.org/2000/svg",yr="http://www.w3.org/1999/xhtml";let vi=yr,ni=!1,qi=null;const ho=qt({},[Ui,yi,yr],Jv);let _i=qt({},["mi","mo","mn","ms","mtext"]),er=qt({},["annotation-xml"]);const ri=qt({},["title","style","font","a","script"]);let xi=null;const bi=["application/xhtml+xml","text/html"],qo="text/html";let vn=null,wi=null;const Hi=t.createElement("form"),ds=function(pe){return pe instanceof RegExp||pe instanceof Function},bn=function(){let pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(wi&&wi===pe)){if((!pe||typeof pe!="object")&&(pe={}),pe=ga(pe),xi=bi.indexOf(pe.PARSER_MEDIA_TYPE)===-1?qo:pe.PARSER_MEDIA_TYPE,vn=xi==="application/xhtml+xml"?Jv:Ig,z=io(pe,"ALLOWED_TAGS")?qt({},pe.ALLOWED_TAGS,vn):Z,J=io(pe,"ALLOWED_ATTR")?qt({},pe.ALLOWED_ATTR,vn):ae,qi=io(pe,"ALLOWED_NAMESPACES")?qt({},pe.ALLOWED_NAMESPACES,Jv):ho,Fn=io(pe,"ADD_URI_SAFE_ATTR")?qt(ga(us),pe.ADD_URI_SAFE_ATTR,vn):us,cs=io(pe,"ADD_DATA_URI_TAGS")?qt(ga(Gt),pe.ADD_DATA_URI_TAGS,vn):Gt,Ft=io(pe,"FORBID_CONTENTS")?qt({},pe.FORBID_CONTENTS,vn):Vt,Q=io(pe,"FORBID_TAGS")?qt({},pe.FORBID_TAGS,vn):ga({}),ce=io(pe,"FORBID_ATTR")?qt({},pe.FORBID_ATTR,vn):ga({}),kt=io(pe,"USE_PROFILES")?pe.USE_PROFILES:!1,fe=pe.ALLOW_ARIA_ATTR!==!1,ve=pe.ALLOW_DATA_ATTR!==!1,Me=pe.ALLOW_UNKNOWN_PROTOCOLS||!1,Pe=pe.ALLOW_SELF_CLOSE_IN_ATTR!==!1,qe=pe.SAFE_FOR_TEMPLATES||!1,Ge=pe.SAFE_FOR_XML!==!1,lt=pe.WHOLE_DOCUMENT||!1,Te=pe.RETURN_DOM||!1,Ie=pe.RETURN_DOM_FRAGMENT||!1,Le=pe.RETURN_TRUSTED_TYPE||!1,bt=pe.FORCE_BODY||!1,Be=pe.SANITIZE_DOM!==!1,ke=pe.SANITIZE_NAMED_PROPS||!1,gt=pe.KEEP_CONTENT!==!1,yt=pe.IN_PLACE||!1,G=pe.ALLOWED_URI_REGEXP||I3,vi=pe.NAMESPACE||yr,_i=pe.MATHML_TEXT_INTEGRATION_POINTS||_i,er=pe.HTML_INTEGRATION_POINTS||er,le=pe.CUSTOM_ELEMENT_HANDLING||{},pe.CUSTOM_ELEMENT_HANDLING&&ds(pe.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(le.tagNameCheck=pe.CUSTOM_ELEMENT_HANDLING.tagNameCheck),pe.CUSTOM_ELEMENT_HANDLING&&ds(pe.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(le.attributeNameCheck=pe.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),pe.CUSTOM_ELEMENT_HANDLING&&typeof pe.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(le.allowCustomizedBuiltInElements=pe.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),qe&&(ve=!1),Ie&&(Te=!0),kt&&(z=qt({},uA),J=[],kt.html===!0&&(qt(z,cA),qt(J,dA)),kt.svg===!0&&(qt(z,t1),qt(J,i1),qt(J,Kp)),kt.svgFilters===!0&&(qt(z,n1),qt(J,i1),qt(J,Kp)),kt.mathMl===!0&&(qt(z,r1),qt(J,hA),qt(J,Kp))),pe.ADD_TAGS&&(typeof pe.ADD_TAGS=="function"?ue.tagCheck=pe.ADD_TAGS:(z===Z&&(z=ga(z)),qt(z,pe.ADD_TAGS,vn))),pe.ADD_ATTR&&(typeof pe.ADD_ATTR=="function"?ue.attributeCheck=pe.ADD_ATTR:(J===ae&&(J=ga(J)),qt(J,pe.ADD_ATTR,vn))),pe.ADD_URI_SAFE_ATTR&&qt(Fn,pe.ADD_URI_SAFE_ATTR,vn),pe.FORBID_CONTENTS&&(Ft===Vt&&(Ft=ga(Ft)),qt(Ft,pe.FORBID_CONTENTS,vn)),gt&&(z["#text"]=!0),lt&&qt(z,["html","head","body"]),z.table&&(qt(z,["tbody"]),delete Q.tbody),pe.TRUSTED_TYPES_POLICY){if(typeof pe.TRUSTED_TYPES_POLICY.createHTML!="function")throw ef('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof pe.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw ef('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');I=pe.TRUSTED_TYPES_POLICY,j=I.createHTML("")}else I===void 0&&(I=yV(v,i)),I!==null&&typeof j=="string"&&(j=I.createHTML(""));pi&&pi(pe),wi=pe}},Vs=qt({},[...t1,...n1,...oV]),Br=qt({},[...r1,...aV]),Bs=function(pe){let De=R(pe);(!De||!De.tagName)&&(De={namespaceURI:vi,tagName:"template"});const Qe=Ig(pe.tagName),Qt=Ig(De.tagName);return qi[pe.namespaceURI]?pe.namespaceURI===yi?De.namespaceURI===yr?Qe==="svg":De.namespaceURI===Ui?Qe==="svg"&&(Qt==="annotation-xml"||_i[Qt]):!!Vs[Qe]:pe.namespaceURI===Ui?De.namespaceURI===yr?Qe==="math":De.namespaceURI===yi?Qe==="math"&&er[Qt]:!!Br[Qe]:pe.namespaceURI===yr?De.namespaceURI===yi&&!er[Qt]||De.namespaceURI===Ui&&!_i[Qt]?!1:!Br[Qe]&&(ri[Qe]||!Vs[Qe]):!!(xi==="application/xhtml+xml"&&qi[pe.namespaceURI]):!1},cn=function(pe){Xh(e.removed,{element:pe});try{R(pe).removeChild(pe)}catch{b(pe)}},Ke=function(pe,De){try{Xh(e.removed,{attribute:De.getAttributeNode(pe),from:De})}catch{Xh(e.removed,{attribute:null,from:De})}if(De.removeAttribute(pe),pe==="is")if(Te||Ie)try{cn(De)}catch{}else try{De.setAttribute(pe,"")}catch{}},Ir=function(pe){let De=null,Qe=null;if(bt)pe="<remove></remove>"+pe;else{const wn=e1(pe,/^[\r\n\t ]+/);Qe=wn&&wn[0]}xi==="application/xhtml+xml"&&vi===yr&&(pe='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+pe+"</body></html>");const Qt=I?I.createHTML(pe):pe;if(vi===yr)try{De=new g().parseFromString(Qt,xi)}catch{}if(!De||!De.documentElement){De=U.createDocument(vi,"template",null);try{De.documentElement.innerHTML=ni?j:Qt}catch{}}const Pt=De.body||De.documentElement;return pe&&Qe&&Pt.insertBefore(t.createTextNode(Qe),Pt.childNodes[0]||null),vi===yr?F.call(De,lt?"html":"body")[0]:lt?De.documentElement:Pt},zs=function(pe){return P.call(pe.ownerDocument||pe,pe,f.SHOW_ELEMENT|f.SHOW_COMMENT|f.SHOW_TEXT|f.SHOW_PROCESSING_INSTRUCTION|f.SHOW_CDATA_SECTION,null)},fo=function(pe){return pe instanceof p&&(typeof pe.nodeName!="string"||typeof pe.textContent!="string"||typeof pe.removeChild!="function"||!(pe.attributes instanceof m)||typeof pe.removeAttribute!="function"||typeof pe.setAttribute!="function"||typeof pe.namespaceURI!="string"||typeof pe.insertBefore!="function"||typeof pe.hasChildNodes!="function")},hs=function(pe){return typeof l=="function"&&pe instanceof l};function vr(et,pe,De){Gp(et,Qe=>{Qe.call(e,pe,De,wi)})}const Pr=function(pe){let De=null;if(vr(C.beforeSanitizeElements,pe,null),fo(pe))return cn(pe),!0;const Qe=vn(pe.nodeName);if(vr(C.uponSanitizeElement,pe,{tagName:Qe,allowedTags:z}),Ge&&pe.hasChildNodes()&&!hs(pe.firstElementChild)&&ui(/<[/\w!]/g,pe.innerHTML)&&ui(/<[/\w!]/g,pe.textContent)||pe.nodeType===nf.progressingInstruction||Ge&&pe.nodeType===nf.comment&&ui(/<[/\w]/g,pe.data))return cn(pe),!0;if(!(ue.tagCheck instanceof Function&&ue.tagCheck(Qe))&&(!z[Qe]||Q[Qe])){if(!Q[Qe]&&Cr(Qe)&&(le.tagNameCheck instanceof RegExp&&ui(le.tagNameCheck,Qe)||le.tagNameCheck instanceof Function&&le.tagNameCheck(Qe)))return!1;if(gt&&!Ft[Qe]){const Qt=R(pe)||pe.parentNode,Pt=N(pe)||pe.childNodes;if(Pt&&Qt){const wn=Pt.length;for(let Rn=wn-1;Rn>=0;--Rn){const tr=x(Pt[Rn],!0);tr.__removalCount=(pe.__removalCount||0)+1,Qt.insertBefore(tr,S(pe))}}}return cn(pe),!0}return pe instanceof d&&!Bs(pe)||(Qe==="noscript"||Qe==="noembed"||Qe==="noframes")&&ui(/<\/no(script|embed|frames)/i,pe.innerHTML)?(cn(pe),!0):(qe&&pe.nodeType===nf.text&&(De=pe.textContent,Gp([M,D,$],Qt=>{De=Jh(De,Qt," ")}),pe.textContent!==De&&(Xh(e.removed,{element:pe.cloneNode()}),pe.textContent=De)),vr(C.afterSanitizeElements,pe,null),!1)},kr=function(pe,De,Qe){if(Be&&(De==="id"||De==="name")&&(Qe in t||Qe in Hi))return!1;if(!(ve&&!ce[De]&&ui(K,De))){if(!(fe&&ui(ee,De))){if(!(ue.attributeCheck instanceof Function&&ue.attributeCheck(De,pe))){if(!J[De]||ce[De]){if(!(Cr(pe)&&(le.tagNameCheck instanceof RegExp&&ui(le.tagNameCheck,pe)||le.tagNameCheck instanceof Function&&le.tagNameCheck(pe))&&(le.attributeNameCheck instanceof RegExp&&ui(le.attributeNameCheck,De)||le.attributeNameCheck instanceof Function&&le.attributeNameCheck(De,pe))||De==="is"&&le.allowCustomizedBuiltInElements&&(le.tagNameCheck instanceof RegExp&&ui(le.tagNameCheck,Qe)||le.tagNameCheck instanceof Function&&le.tagNameCheck(Qe))))return!1}else if(!Fn[De]){if(!ui(G,Jh(Qe,ie,""))){if(!((De==="src"||De==="xlink:href"||De==="href")&&pe!=="script"&&nV(Qe,"data:")===0&&cs[pe])){if(!(Me&&!ui(se,Jh(Qe,ie,"")))){if(Qe)return!1}}}}}}}return!0},Cr=function(pe){return pe!=="annotation-xml"&&e1(pe,re)},Ho=function(pe){vr(C.beforeSanitizeAttributes,pe,null);const{attributes:De}=pe;if(!De||fo(pe))return;const Qe={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:J,forceKeepAttr:void 0};let Qt=De.length;for(;Qt--;){const Pt=De[Qt],{name:wn,namespaceURI:Rn,value:tr}=Pt,Kn=vn(wn),$i=tr;let _n=wn==="value"?$i:rV($i);if(Qe.attrName=Kn,Qe.attrValue=_n,Qe.keepAttr=!0,Qe.forceKeepAttr=void 0,vr(C.uponSanitizeAttribute,pe,Qe),_n=Qe.attrValue,ke&&(Kn==="id"||Kn==="name")&&(Ke(wn,pe),_n=_t+_n),Ge&&ui(/((--!?|])>)|<\/(style|title|textarea)/i,_n)){Ke(wn,pe);continue}if(Kn==="attributename"&&e1(_n,"href")){Ke(wn,pe);continue}if(Qe.forceKeepAttr)continue;if(!Qe.keepAttr){Ke(wn,pe);continue}if(!Pe&&ui(/\/>/i,_n)){Ke(wn,pe);continue}qe&&Gp([M,D,$],lr=>{_n=Jh(_n,lr," ")});const Wi=vn(pe.nodeName);if(!kr(Wi,Kn,_n)){Ke(wn,pe);continue}if(I&&typeof v=="object"&&typeof v.getAttributeType=="function"&&!Rn)switch(v.getAttributeType(Wi,Kn)){case"TrustedHTML":{_n=I.createHTML(_n);break}case"TrustedScriptURL":{_n=I.createScriptURL(_n);break}}if(_n!==$i)try{Rn?pe.setAttributeNS(Rn,wn,_n):pe.setAttribute(wn,_n),fo(pe)?cn(pe):lA(e.removed)}catch{Ke(wn,pe)}}vr(C.afterSanitizeAttributes,pe,null)},$o=function et(pe){let De=null;const Qe=zs(pe);for(vr(C.beforeSanitizeShadowDOM,pe,null);De=Qe.nextNode();)vr(C.uponSanitizeShadowNode,De,null),Pr(De),Ho(De),De.content instanceof s&&et(De.content);vr(C.afterSanitizeShadowDOM,pe,null)};return e.sanitize=function(et){let pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},De=null,Qe=null,Qt=null,Pt=null;if(ni=!et,ni&&(et="<!-->"),typeof et!="string"&&!hs(et))if(typeof et.toString=="function"){if(et=et.toString(),typeof et!="string")throw ef("dirty is not a string, aborting")}else throw ef("toString is not a function");if(!e.isSupported)return et;if(Ct||bn(pe),e.removed=[],typeof et=="string"&&(yt=!1),yt){if(et.nodeName){const tr=vn(et.nodeName);if(!z[tr]||Q[tr])throw ef("root node is forbidden and cannot be sanitized in-place")}}else if(et instanceof l)De=Ir("<!---->"),Qe=De.ownerDocument.importNode(et,!0),Qe.nodeType===nf.element&&Qe.nodeName==="BODY"||Qe.nodeName==="HTML"?De=Qe:De.appendChild(Qe);else{if(!Te&&!qe&&!lt&&et.indexOf("<")===-1)return I&&Le?I.createHTML(et):et;if(De=Ir(et),!De)return Te?null:Le?j:""}De&&bt&&cn(De.firstChild);const wn=zs(yt?et:De);for(;Qt=wn.nextNode();)Pr(Qt),Ho(Qt),Qt.content instanceof s&&$o(Qt.content);if(yt)return et;if(Te){if(Ie)for(Pt=k.call(De.ownerDocument);De.firstChild;)Pt.appendChild(De.firstChild);else Pt=De;return(J.shadowroot||J.shadowrootmode)&&(Pt=O.call(n,Pt,!0)),Pt}let Rn=lt?De.outerHTML:De.innerHTML;return lt&&z["!doctype"]&&De.ownerDocument&&De.ownerDocument.doctype&&De.ownerDocument.doctype.name&&ui(P3,De.ownerDocument.doctype.name)&&(Rn="<!DOCTYPE "+De.ownerDocument.doctype.name+`>
`+Rn),qe&&Gp([M,D,$],tr=>{Rn=Jh(Rn,tr," ")}),I&&Le?I.createHTML(Rn):Rn},e.setConfig=function(){let et=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};bn(et),Ct=!0},e.clearConfig=function(){wi=null,Ct=!1},e.isValidAttribute=function(et,pe,De){wi||bn({});const Qe=vn(et),Qt=vn(pe);return kr(Qe,Qt,De)},e.addHook=function(et,pe){typeof pe=="function"&&Xh(C[et],pe)},e.removeHook=function(et,pe){if(pe!==void 0){const De=eV(C[et],pe);return De===-1?void 0:tV(C[et],De,1)[0]}return lA(C[et])},e.removeHooks=function(et){C[et]=[]},e.removeAllHooks=function(){C=mA()},e}var uo=k3();const C3=({isOpen:r,onClose:e,bill:t,allUserBills:n=[],userData:i,calculateBillDetails:s,showNotification:o,systemSettings:l={}})=>{var M,D,$,K,ee,se,ie,re,G,z,Z,J,ae,le;if(!r||!t||!i)return null;const d=(M=t.billDate)!=null&&M.toDate?t.billDate.toDate():new Date,f=new Date(d);f.setDate(f.getDate()-90);const m=n.filter(Q=>{var ue;const ce=(ue=Q.billDate)!=null&&ue.toDate?Q.billDate.toDate():new Date(0);return ce>=f&&ce<=d}).sort((Q,ce)=>{var ue,fe;return((ue=ce.billDate)!=null&&ue.toDate?ce.billDate.toDate():new Date(0))-((fe=Q.billDate)!=null&&fe.toDate?Q.billDate.toDate():new Date(0))}),p=m.flatMap(Q=>(Q.paymentHistory||[]).map(ce=>({...ce,billMonthYear:Q.monthYear||Q.billingPeriod}))).sort((Q,ce)=>{var ue,fe;return((ue=ce.date)!=null&&ue.toDate?ce.date.toDate():new Date(ce.date))-((fe=Q.date)!=null&&fe.toDate?Q.date.toDate():new Date(Q.date))});m.flatMap(Q=>(Q.adjustments||[]).map(ce=>({...ce,billMonthYear:Q.monthYear||Q.billingPeriod}))).sort((Q,ce)=>{var ue,fe;return((ue=ce.date)!=null&&ue.toDate?ce.date.toDate():new Date(ce.date))-((fe=Q.date)!=null&&fe.toDate?Q.date.toDate():new Date(Q.date))});const g=m.map(Q=>({id:Q.id,monthYear:Q.monthYear||Q.billingPeriod,readingDate:Q.currentReadingDate?Mt(Q.currentReadingDate,{month:"short",day:"numeric",year:"numeric"}):Mt(Q.billDate,{month:"short",day:"numeric",year:"numeric"}),consumption:Q.consumption})),v=t.calculatedCharges||s(t.consumption,i.serviceType,i.meterSize||'1/2"'),E=parseFloat(((D=t.totalCalculatedCharges)==null?void 0:D.toFixed(2))||0),x=parseFloat((t.seniorCitizenDiscount||0).toFixed(2)),b=t.baseAmount||0,S=t.potentialPenalty||0,N=(b+S).toFixed(2),R=t.amount||0,I=($=t.billDate)!=null&&$.toDate?t.billDate.toDate():null,j=I?`${I.getFullYear()}${String(I.getMonth()+1).padStart(2,"0")}${String(I.getDate()).padStart(2,"0")}`:Date.now().toString().slice(-6),U=t.invoiceNumber||`AGWA-${(K=t.id)==null?void 0:K.slice(0,4).toUpperCase()}-${j}`,k=(Q=>!Q||typeof Q!="object"?Q||"":[Q.street,Q.barangay,Q.district,"Naic, Cavite"].filter(ue=>ue&&ue.trim()).join(", "))(i.serviceAddress),F=()=>{const Q=document.getElementById("invoice-content-to-print-modal-fullscreen"),ce=document.getElementById("invoice-print-styles");if(!Q||!ce){o("Print content not found.","error");return}const ue=window.open("","_blank","height=800,width=1000,scrollbars=yes");ue.document.write("<html><head><title>AGWA Invoice "+U+"</title>"),ue.document.write('<script src="https://cdn.tailwindcss.com"><\/script>');const fe=ue.document.createElement("style");fe.innerHTML=ce.innerHTML,ue.document.head.appendChild(fe),ue.document.write("</head><body>"),ue.document.write(Q.innerHTML),ue.document.write(`
            <script>
                window.onload = function() {
                    setTimeout(function() { 
                        window.print();
                        window.close();
                    }, 1000); 
                };
            <\/script>
        `),ue.document.write("</body></html>"),ue.document.close()},O=({label:Q,value:ce,isBold:ue=!1,isSubtotal:fe=!1,isTotal:ve=!1})=>c.jsxs("tr",{className:fe?"border-t border-gray-300":"",children:[c.jsx("td",{className:`py-0.5 ${fe?"pt-1":""} ${ue?"font-semibold":""} ${ve?"font-bold":""}`,children:Q}),c.jsx("td",{className:`py-0.5 ${fe?"pt-1":""} text-right ${ue?"font-semibold":""} ${ve?"font-bold":""}`,children:ce})]}),C=()=>c.jsxs("div",{className:"w-full border-t-2 border-dashed border-gray-400 mt-4 pt-3 text-xs tear-off-slip-print",children:[c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{className:"pr-2 max-w-[50%]",children:[c.jsx("p",{children:"Contract Account Number:"}),c.jsx("p",{className:"font-mono font-bold tracking-wider mb-1 slip-account-number",children:i.accountNumber}),c.jsx("p",{className:"font-semibold slip-user-name",children:i.displayName}),c.jsx("p",{children:k}),c.jsxs("p",{className:"mt-2 font-semibold",children:["Total Amount Due: ",R.toFixed(2)]}),c.jsxs("p",{className:"font-semibold",children:["Due Date: ",Mt(t.dueDate,{month:"short",day:"numeric",year:"numeric"})]})]}),c.jsxs("div",{className:"text-right flex-shrink-0",children:[c.jsx("div",{className:"flex justify-end mb-2",children:c.jsx("div",{className:"text-2xl font-bold text-blue-700 logo-print",children:"AGWA"})}),c.jsxs("p",{children:["INVOICE No.: ",c.jsx("span",{className:"font-semibold",children:U})]}),c.jsxs("p",{children:["Billing Period: ",c.jsx("span",{className:"font-semibold",children:t.billingPeriod||t.monthYear})]}),c.jsxs("p",{children:["Bill Date: ",c.jsx("span",{className:"font-semibold",children:Mt(t.billDate,{month:"short",day:"numeric",year:"numeric"})})]})]})]}),c.jsx("div",{className:"max-w-[240px] mx-auto mt-2 barcode-container-print",children:c.jsx(A3,{value:U})})]});return c.jsxs(Vr,{isOpen:r,onClose:e,title:"",size:"full",modalDialogClassName:"sm:max-w-4xl w-[95vw] h-[95vh]",contentClassName:"p-0 bg-gray-200",children:[c.jsx("style",{id:"invoice-print-styles",dangerouslySetInnerHTML:{__html:`
                .paid-stamp-base {
                    position: absolute;
                    top: 45%;
                    left: 50%;
                    transform: translate(-50%, -50%) rotate(-20deg);
                    padding: 0.5rem 1.5rem;
                    border-radius: 8px;
                    text-align: center;
                    opacity: 1;
                    z-index: 10;
                    pointer-events: none;
                    font-family: 'Arial Black', 'Impact', sans-serif;
                    letter-spacing: 0.1em;
                    text-transform: uppercase;
                }
                .paid-stamp-modal {
                    color: rgba(220, 38, 38, 0.25);
                    border: 7px double rgba(220, 38, 38, 0.25);
                }
                .paid-stamp-main { font-size: 4rem; font-weight: 900; line-height: 1; }
                .paid-stamp-date { font-size: 1rem; font-weight: 700; display: block; border-top: 2px solid rgba(220, 38, 38, 0.25); padding-top: 4px; margin-top: 4px; }
            
                @media print {
                    @page {
                        size: A4 portrait;
                        margin: 0.4in;
                    }
                    body { 
                        font-family: 'Times New Roman', Times, serif; 
                        -webkit-print-color-adjust: exact !important; 
                        print-color-adjust: exact !important;
                        color: #000;
                        font-size: 8pt; 
                    }
                    .no-print { display: none !important; }
                    .printable-area { padding: 0 !important; max-width: 100%; margin: auto; box-shadow: none !important; border: none !important; font-size: 8pt; }
                    .invoice-header-print {
                        display: flex;
                        justify-content: space-between;
                        align-items: flex-start;
                        padding-bottom: 0.2rem;
                    }
                    .invoice-header-print .logo-print { font-size: 16pt; font-weight: 700; color: #1e3a8a !important; line-height: 1; }
                    .invoice-header-print .tagline-print { font-size: 7pt; color: #1d4ed8 !important; font-style: italic; }
                    .invoice-header-print .company-address-print { text-align: right; font-size: 7pt; line-height: 1.2; color: #374151 !important; }
                    
                    .invoice-title-print { font-size: 12pt; font-weight: 700; text-align: center; margin-top: 0.25rem; margin-bottom: 0.25rem; }

                    .invoice-grid-print { display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.75rem; }
                    .invoice-grid-print-left { grid-column: span 1 / span 1; }
                    .invoice-grid-print-right { grid-column: span 1 / span 1; }

                    .invoice-section-print h2 { font-weight: 700; font-size: 8pt; border-bottom: 1px solid #000; padding-bottom: 0.1rem; margin-bottom: 0.15rem; text-transform: uppercase; }
                    .invoice-section-print p { margin: 0.1rem 0; line-height: 1.2; font-size: 8pt; }
                    .invoice-section-print p span { font-weight: 600; }
                    .invoice-section-print .h-line { border-top: 1px solid #000; margin-top: 0.25rem; padding-top: 0.25rem; }
                    .invoice-section-print .text-center { text-align: center; }
                    .invoice-section-print .history-note { font-size: 7pt; font-style: italic; color: #555 !important; }
                    .invoice-section-print .signature-line { height: 1.5rem; border-bottom: 1px solid #999; }
                    
                    .blue-box-print { background-color: #DBEAFE !important; border: 1px solid #BFDBFE !important; padding: 0.2rem 0.4rem; text-align: left; margin-top: 0.25rem; }
                    .blue-box-print p { margin: 0; font-size: 7.5pt; font-weight: 700; color: #1E40AF !important; }
                    .blue-box-print .due-amount { font-size: 10pt; color: #1D4ED8 !important; }
                    .blue-box-print .due-date { font-size: 9pt; color: #1D4ED8 !important; }
                    
                    .charges-table-print { width: 100%; margin-top: 0.5rem; border-collapse: collapse; font-size: 8pt; }
                    .charges-table-print td { padding: 0.05rem 0.2rem; }
                    .charges-table-print td:last-child { text-align: right; }
                    .charges-table-print tr.border-t td { border-top: 1px solid #999 !important; padding-top: 0.2rem; }
                    .charges-table-print .total-due-row td { padding-top: 0.2rem; }
                    .charges-table-print .total-due-row .border-t-2 td { border-top: 2px solid #000 !important; }
                    .charges-table-print .total-due-row .border-t td { border-top: 1px solid #999 !important; }
                    .charges-table-print .total-due-row .text-lg { font-size: 9pt; font-weight: 700; }
                    .charges-table-print .total-due-row .text-red-600 { color: #A94442 !important; }
                    .charges-table-print .total-due-row .text-green-600 { color: #256625 !important; }

                    .history-table-print { width: 100%; font-size: 7pt; }
                    .history-table-print th { text-align: left; font-size: 7pt; color: #374151 !important; border-bottom: 1px solid #999; padding-bottom: 2px; }
                    .history-table-print td { text-align: left; font-size: 7pt; padding-top: 1px; }
                    .history-table-print td:last-child { text-align: right; }
                    
                    .bir-permit-print { text-align: center; font-size: 6pt; color: #4B5563 !important; margin-top: 0.5rem; padding-top: 0.25rem; border-top: 1px solid #999; }
                    
                    .tear-off-slip-print { font-size: 7.5pt; border-top: 2px dashed #000; margin-top: 0.5rem; padding-top: 0.25rem; page-break-before: auto; }
                    .tear-off-slip-print .slip-account-number { font-size: 8pt; }
                    .tear-off-slip-print .slip-user-name { font-size: 8pt; }
                    .tear-off-slip-print .logo-print { font-size: 12pt; }
                    .barcode-container-print { max-width: 160px; margin: 0.25rem auto 0 auto; }
                    
                    .paid-stamp-print {
                        position: absolute;
                        top: 45%;
                        left: 50%;
                        transform: translate(-50%, -50%) rotate(-20deg);
                        color: rgba(220, 38, 38, 0.25) !important;
                        border: 7px double rgba(220, 38, 38, 0.25) !important;
                        font-family: 'Arial Black', 'Impact', sans-serif;
                        letter-spacing: 0.1em;
                        text-transform: uppercase;
                    }
                    .paid-stamp-main-print { font-size: 2.5rem; font-weight: 900; line-height: 1; }
                    .paid-stamp-date-print { font-size: 8pt; font-weight: 700; display: block; border-top: 2px solid rgba(220, 38, 38, 0.25); padding-top: 4px; margin-top: 4px; }
                    
                    .penalty-notice-print {
                        font-size: 7pt;
                        color: #A94442 !important;
                        background-color: #FDF7F7 !important;
                        padding: 0.25rem;
                        border: 1px solid #F3D0D0 !important;
                        margin-top: 0.25rem;
                        text-align: left;
                    }
                }
            `}}),c.jsxs("div",{className:"flex justify-between items-center p-3 sm:p-4 border-b border-gray-300 bg-gray-100 rounded-t-xl sticky top-0 z-20 no-print",children:[c.jsxs("h3",{className:"text-md sm:text-lg font-semibold text-gray-800 truncate",title:U,children:[c.jsx(oc,{size:22,className:"mr-2.5 text-blue-600 inline-block"}),"Invoice: ",U]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsxs("button",{onClick:F,className:"p-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors flex items-center focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50",title:"Print/Download Invoice",children:[c.jsx(J9,{size:16,className:"mr-0 sm:mr-1.5"})," ",c.jsx("span",{className:"hidden sm:inline",children:"Print/Save"})]}),c.jsx("button",{onClick:e,className:"p-2 text-gray-500 hover:text-gray-700 bg-gray-200 hover:bg-gray-300 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500",title:"Close Invoice View",children:c.jsx(u0,{size:18})})]})]}),c.jsx("div",{className:"overflow-y-auto flex-grow p-1",children:c.jsxs("div",{id:"invoice-content-to-print-modal-fullscreen",className:"printable-area bg-white p-4 sm:p-8 max-w-4xl mx-auto my-4 shadow-lg font-sans text-xs",children:[((ee=t.status)==null?void 0:ee.toLowerCase())==="paid"&&c.jsxs("div",{className:"paid-stamp-base paid-stamp-modal paid-stamp-print",children:[c.jsx("div",{className:"paid-stamp-main paid-stamp-main-print",children:"PAID"}),c.jsx("div",{className:"paid-stamp-date paid-stamp-date-print",children:Mt(t.paymentDate,{year:"numeric",month:"short",day:"numeric"})})]}),c.jsxs("div",{className:"relative z-0",children:[c.jsxs("header",{className:"invoice-header-print mb-4 flex justify-between items-start",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"logo-print text-4xl font-bold text-blue-700",children:"AGWA"}),c.jsx("p",{className:"tagline-print text-sm text-blue-600 italic -mt-1",children:"Ensuring Clarity, Sustaining Life."})]}),c.jsxs("div",{className:"company-address-print text-right text-xs",children:[c.jsx("strong",{children:"AGWA Water Services, Inc."}),c.jsx("br",{}),"AGWA Water Services Bldg., Governor's Drive",c.jsx("br",{}),"Brgy. Ibayo Silangan, Naic, Cavite 4110"]})]}),c.jsx("h1",{className:"invoice-title-print text-center my-4 text-xl font-bold",children:"INVOICE"}),c.jsxs("div",{className:"invoice-grid-print grid grid-cols-2 gap-3 mt-4",children:[c.jsxs("div",{className:"invoice-grid-print-left space-y-3",children:[c.jsxs("div",{className:"invoice-section-print",children:[c.jsx("p",{className:"font-semibold text-sm",children:i.displayName}),c.jsx("p",{children:k}),c.jsxs("p",{className:"mt-2",children:["CAN: ",c.jsx("span",{className:"font-semibold",children:i.accountNumber})]}),c.jsxs("p",{children:["Rate Class: ",c.jsx("span",{className:"font-semibold",children:i.serviceType})]}),c.jsxs("p",{children:["Meter Number: ",c.jsx("span",{className:"font-semibold",children:i.meterSerialNumber||""})]}),c.jsxs("p",{children:["Service Area: ",c.jsx("span",{className:"font-semibold",children:((se=i.serviceAddress)==null?void 0:se.barangay)||""})]}),c.jsxs("p",{children:["MRU/SEQ No.: ",c.jsx("span",{className:"font-semibold",children:i.mruSeq||""})]}),c.jsx("p",{className:"mt-2",children:"SC, PWD/Gov't ID No./Signature:"}),c.jsx("div",{className:"signature-line h-6 border-b border-gray-400"})]}),c.jsxs("div",{className:"invoice-section-print h-line",children:[c.jsx("h2",{className:"font-bold text-xs border-b border-black pb-1 mb-1 uppercase",children:"Billing Information"}),c.jsxs("div",{className:"grid grid-cols-2",children:[c.jsxs("div",{children:[c.jsx("p",{children:"Billing Date:"}),c.jsx("p",{children:"Billing Period:"}),c.jsx("p",{children:"Current Reading:"}),c.jsx("p",{children:"Previous Reading:"}),c.jsx("p",{children:"Consumption:"}),c.jsx("p",{children:"Prev. 3 Mos. Cons.:"})]}),c.jsxs("div",{className:"font-semibold text-right",children:[c.jsx("p",{children:Mt(t.billDate,{month:"short",day:"numeric",year:"numeric"})}),c.jsx("p",{children:t.billingPeriod||t.monthYear}),c.jsxs("p",{children:[t.currentReading," m"]}),c.jsxs("p",{children:[t.previousReading," m"]}),c.jsxs("p",{children:[t.consumption," m"]}),c.jsx("p",{children:t.prev3MonthsConsumption?`${t.prev3MonthsConsumption} m`:""})]})]})]}),c.jsxs("div",{className:"invoice-section-print h-line",children:[c.jsx("h2",{className:"font-bold text-xs border-b border-black pb-1 mb-1 uppercase",children:"Consumption Log (Last 90 Days)"}),c.jsxs("table",{className:"w-full history-table-print",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Billing Period/Month"}),c.jsx("th",{children:"Reading Date"}),c.jsx("th",{className:"text-right",children:"Usage Read (m)"})]})}),c.jsx("tbody",{children:g.length>0?g.map(Q=>c.jsxs("tr",{children:[c.jsx("td",{children:Q.monthYear}),c.jsx("td",{children:Q.readingDate}),c.jsxs("td",{className:"text-right",children:[Q.consumption," m"]})]},Q.id)):c.jsx("tr",{children:c.jsx("td",{colSpan:"3",className:"text-center py-1 text-gray-500",children:"No consumption history in the last 90 days."})})})]})]}),c.jsxs("div",{className:"invoice-section-print h-line",children:[c.jsx("h2",{className:"font-bold text-xs border-b border-black pb-1 mb-1 uppercase",children:"Payment History (Last 90 Days)"}),c.jsxs("table",{className:"w-full history-table-print",children:[c.jsx("thead",{children:c.jsxs("tr",{children:[c.jsx("th",{children:"Billing Period/Month"}),c.jsx("th",{children:"Date Paid"}),c.jsx("th",{className:"text-right",children:"Amount Paid"})]})}),c.jsx("tbody",{children:p.length>0?p.map((Q,ce)=>c.jsxs("tr",{children:[c.jsx("td",{children:Q.billMonthYear}),c.jsx("td",{children:Mt(Q.date,{month:"short",day:"numeric"})}),c.jsxs("td",{className:"text-right",children:["",Q.amount.toFixed(2)]})]},ce)):c.jsx("tr",{children:c.jsx("td",{colSpan:"3",className:"text-center py-1 text-gray-500",children:"No payments posted in the last 90 days."})})})]})]}),c.jsxs("div",{className:"invoice-section-print h-line text-center",children:[c.jsx("h2",{className:"font-bold text-xs border-b border-black pb-1 mb-1 uppercase",children:"Important Reminders"}),c.jsx("p",{className:"text-xs",children:"CUSTOMER SERVICE HOTLINE: 1627-AGWA"}),c.jsx("hr",{className:"border-t border-gray-400 my-1"}),c.jsx("p",{className:"text-xs",children:"PLEASE PAY VIA GCASH OR THROUGH OTHER ACCREDITED PAYMENT CENTERS. METER READERS AND CONTRACTORS ARE NOT ALLOWED TO ACCEPT PAYMENTS."})]})]}),c.jsxs("div",{className:"invoice-grid-print-right",children:[c.jsxs("div",{className:"invoice-section-print",children:[c.jsxs("p",{children:["Invoice No.: ",c.jsx("span",{className:"font-semibold",children:U})]}),c.jsxs("p",{children:["TIN: ",c.jsx("span",{className:"font-semibold",children:i.tin||""})]}),c.jsxs("p",{children:["Payer Name: ",c.jsx("span",{className:"font-semibold",children:i.displayName})]}),c.jsxs("p",{children:["Payer TIN: ",c.jsx("span",{className:"font-semibold",children:i.tin||""})]})]}),t.status==="Paid"?c.jsxs("div",{className:"text-center p-3 bg-green-100 border border-green-300 rounded-lg my-2",children:[c.jsxs("p",{className:"font-bold text-green-700",children:["AMOUNT PAID: ",(t.amountPaid||t.amount).toFixed(2)]}),c.jsxs("p",{className:"text-xs text-gray-700",children:["Paid on: ",Mt(t.paymentDate,{month:"short",day:"numeric",year:"numeric"})]})]}):c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"blue-box-print p-3 bg-blue-50 border border-blue-200 my-2",children:[c.jsx("p",{className:"text-xs font-semibold text-blue-700",children:"Contract Account Number"}),c.jsx("p",{className:"text-xl font-bold text-blue-800 font-mono mb-1",children:i.accountNumber}),c.jsx("p",{className:"text-xs font-semibold text-blue-700",children:"TOTAL AMOUNT DUE"}),c.jsxs("p",{className:"text-2xl font-bold text-blue-800 due-amount",children:["",R.toFixed(2)]}),c.jsx("p",{className:"text-xs font-semibold text-blue-700 mt-1",children:"DUE DATE"}),c.jsx("p",{className:"text-xl font-bold text-blue-800 due-date",children:Mt(t.dueDate,{month:"long",day:"numeric",year:"numeric"})})]}),t.status==="Unpaid"&&S>0&&R===b&&c.jsxs("div",{className:"text-xs text-red-600 bg-red-50 p-2 rounded-lg border border-red-200 text-left penalty-notice-print",children:["Pay after ",Mt(t.dueDate,{month:"short",day:"numeric"})," to include a",c.jsxs("strong",{children:[" ",S.toFixed(2)," penalty"]}),".",c.jsx("br",{}),"Total amount after due date will be ",c.jsxs("strong",{children:[" ",N]}),"."]}),t.status==="Unpaid"&&R>b&&c.jsxs("div",{className:"text-xs text-red-600 bg-red-50 p-2 rounded-lg border border-red-200 text-left penalty-notice-print",children:["This amount includes a ",c.jsxs("strong",{children:["",(R-b).toFixed(2)," penalty"]})," for late payment."]})]}),c.jsxs("div",{className:"invoice-section-print mt-2",children:[c.jsx("table",{className:"charges-table-print w-full",children:c.jsxs("tbody",{children:[c.jsx(O,{label:"Water Charges",value:null,isBold:!0}),c.jsx(O,{label:"Basic Charge",value:(ie=v.basicCharge)==null?void 0:ie.toFixed(2)}),c.jsx(O,{label:"FCDA",value:(re=v.fcda)==null?void 0:re.toFixed(2)}),c.jsx(O,{label:"Environmental Charge",value:(G=v.environmentalCharge)==null?void 0:G.toFixed(2)}),c.jsx(O,{label:"Sewer Charge",value:(z=v.sewerageCharge)==null?void 0:z.toFixed(2)}),c.jsx(O,{label:"Maintenance Service Charge",value:(Z=v.maintenanceServiceCharge)==null?void 0:Z.toFixed(2)}),c.jsx(O,{label:"SUBTOTAL (A)",value:v.subTotalBeforeTaxes.toFixed(2),isBold:!0,isSubtotal:!0}),c.jsx("tr",{className:"h-2",children:c.jsx("td",{colSpan:"2"})}),c.jsx(O,{label:"Taxes and Discounts",value:null,isBold:!0}),c.jsx(O,{label:"Government Taxes",value:(J=v.governmentTaxes)==null?void 0:J.toFixed(2)}),c.jsx(O,{label:"VAT",value:(ae=v.vat)==null?void 0:ae.toFixed(2)}),c.jsx(O,{label:"Senior Citizen Discount",value:x>0?`(${x.toFixed(2)})`:"0.00"}),c.jsx(O,{label:"SUBTOTAL (B)",value:(v.governmentTaxes+v.vat-x).toFixed(2),isBold:!0,isSubtotal:!0}),c.jsx("tr",{className:"h-2",children:c.jsx("td",{colSpan:"2"})}),c.jsx(O,{label:"TOTAL CURRENT CHARGES (A+B)",value:E.toFixed(2),isBold:!0,isSubtotal:!0}),c.jsx("tr",{className:"h-4",children:c.jsx("td",{colSpan:"2"})}),c.jsx(O,{label:"VATable Sales",value:(le=v.vatableSales)==null?void 0:le.toFixed(2)}),c.jsx(O,{label:"VAT Zero-rated",value:"0.00"}),c.jsx(O,{label:"VAT Exempt",value:"0.00"})]})}),c.jsx("table",{className:"charges-table-print w-full mt-4",children:c.jsxs("tbody",{className:"total-due-row",children:[t.status==="Paid"?c.jsxs(c.Fragment,{children:[c.jsxs("tr",{className:"border-t-2 border-black",children:[c.jsx("td",{className:"py-1 font-bold text-lg text-green-600",children:"AMOUNT PAID"}),c.jsxs("td",{className:"py-1 text-right font-bold text-lg text-green-600",children:["",(t.amountPaid||R).toFixed(2)]})]}),c.jsxs("tr",{children:[c.jsx("td",{className:"py-1 font-semibold",children:"Date Paid"}),c.jsx("td",{className:"py-1 text-right font-semibold",children:Mt(t.paymentDate,{month:"long",day:"numeric",year:"numeric"})})]})]}):c.jsxs(c.Fragment,{children:[c.jsxs("tr",{className:"border-t-2 border-black",children:[c.jsx("td",{className:"py-1 font-semibold",children:"Amount Due (Before Due Date)"}),c.jsxs("td",{className:"py-1 text-right font-semibold",children:["",b.toFixed(2)]})]}),S>0&&c.jsxs(c.Fragment,{children:[c.jsxs("tr",{children:[c.jsx("td",{className:"py-1 font-semibold text-red-600",children:"Penalty (After Due Date)"}),c.jsxs("td",{className:"py-1 text-right font-semibold text-red-600",children:["",S.toFixed(2)]})]}),c.jsxs("tr",{className:"border-t border-gray-400",children:[c.jsx("td",{className:"py-1 font-semibold",children:"Amount Due (After Due Date)"}),c.jsxs("td",{className:"py-1 text-right font-semibold",children:["",N]})]})]}),R>b&&c.jsxs("tr",{className:"border-t border-gray-400",children:[c.jsx("td",{className:"py-1 font-bold text-lg text-red-600",children:"CURRENT TOTAL DUE (incl. Penalty)"}),c.jsxs("td",{className:"py-1 text-right font-bold text-lg text-red-600",children:["",R.toFixed(2)]})]}),R===b&&!S>0&&c.jsxs("tr",{className:"border-t border-gray-400",children:[c.jsx("td",{className:"py-1 font-bold text-lg",children:"CURRENT TOTAL DUE"}),c.jsxs("td",{className:"py-1 text-right font-bold text-lg",children:["",R.toFixed(2)]})]})]}),c.jsxs("tr",{className:"border-t border-gray-400",children:[c.jsx("td",{className:"py-1 font-semibold",children:"DUE DATE"}),c.jsx("td",{className:"py-1 text-right font-semibold",children:Mt(t.dueDate,{month:"long",day:"numeric",year:"numeric"})})]})]})})]})]})]}),c.jsx("div",{className:"bir-permit-print text-center text-xs text-gray-600 mt-6 pt-4 border-t border-gray-400",children:c.jsx("p",{children:"BIR PERMIT NO.: AC_116_102024_000436 DATE OF ISSUE: 10/17/2024 SERIES RANGE: 0000000001 - 9999999999"})})]}),c.jsx(C,{})]})})]})},dm=({children:r,text:e,position:t="top",className:n="",delay:i=100})=>{const[s,o]=X.useState(!1),[l,d]=X.useState(null),f=()=>{const v=setTimeout(()=>{o(!0)},i);d(v)},m=()=>{l&&(clearTimeout(l),d(null)),o(!1)},p={top:"bottom-full left-1/2 -translate-x-1/2 mb-2",bottom:"top-full left-1/2 -translate-x-1/2 mt-2",left:"right-full top-1/2 -translate-y-1/2 mr-2",right:"left-full top-1/2 -translate-y-1/2 ml-2"},g={top:"absolute left-1/2 -translate-x-1/2 top-full h-0 w-0 border-x-4 border-x-transparent border-t-4 border-t-gray-800",bottom:"absolute left-1/2 -translate-x-1/2 bottom-full h-0 w-0 border-x-4 border-x-transparent border-b-4 border-b-gray-800",left:"absolute top-1/2 -translate-y-1/2 left-full h-0 w-0 border-y-4 border-y-transparent border-l-4 border-l-gray-800",right:"absolute top-1/2 -translate-y-1/2 right-full h-0 w-0 border-y-4 border-y-transparent border-r-4 border-r-gray-800"};return e?c.jsxs("div",{className:"relative inline-flex",onMouseEnter:f,onMouseLeave:m,onFocus:f,onBlur:m,tabIndex:0,children:[r,s&&c.jsxs("div",{role:"tooltip",className:`absolute z-50 whitespace-nowrap px-3 py-1.5 text-xs font-medium text-white bg-gray-800 rounded-md shadow-lg transition-opacity duration-150 ease-in-out opacity-100 ${p[t]} ${n}`,children:[e,c.jsx("div",{className:g[t]})]})]}):c.jsx(c.Fragment,{children:r})},vV=({user:r,userData:e,setUserData:t,db:n,showNotification:i,billingService:s,systemSettings:o={}})=>{const[l,d]=X.useState([]),[f,m]=X.useState(!0),[p,g]=X.useState(""),[v,E]=X.useState(null),[x,b]=X.useState(!1),[S,N]=X.useState(!1),[R,I]=X.useState(null),[j,U]=X.useState(""),[P,k]=X.useState(!1),[F,O]=X.useState(null),[C,M]=X.useState(!1),[D,$]=X.useState(null),[K,ee]=X.useState(!1),[se,ie]=X.useState(!1),{isOnlinePaymentsEnabled:re=!0}=o,G=GF(),z=JSON.stringify(o),Z=JSON.stringify(e),J=X.useCallback(async()=>{m(!0),g("");const Pe=JSON.parse(Z),qe=JSON.parse(z);if(!(r!=null&&r.uid)||!(Pe!=null&&Pe.serviceType)){g("Missing user data for fetching bills."),m(!1);return}const Ge=await _u(n,r.uid);if(Ge.success){const Ct=Ge.data.sort((bt,Te)=>{var Be,ke;const Ie=(Be=bt.billDate)!=null&&Be.toDate?bt.billDate.toDate():new Date(0);return((ke=Te.billDate)!=null&&ke.toDate?Te.billDate.toDate():new Date(0))-Ie}).map(bt=>{const Te=s(bt.consumption??0,Pe.serviceType,Pe.meterSize,qe),Ie=(bt.totalCalculatedCharges||0)+(bt.previousUnpaidAmount||0)-(bt.seniorCitizenDiscount||0),Le=H8(bt,qe),Be=N2(bt,qe),ke=Ie+Be;return{...bt,calculatedCharges:Te,baseAmount:Ie,potentialPenalty:Le,amount:ke,displayPenalty:Be}}).filter(bt=>bt.amount!==void 0);d(Ct)}else g(Ge.error||"Failed to fetch your bills."),i(Ge.error||"Failed to fetch bills.","error");m(!1)},[n,r==null?void 0:r.uid,i,s,Z,z]),ae=X.useCallback(async()=>{if(r!=null&&r.uid&&t){const Pe=await I2(n,r.uid);Pe.success&&t(Pe.data)}},[n,r==null?void 0:r.uid,t]);X.useEffect(()=>{J()},[J]),X.useEffect(()=>{const Pe=new URLSearchParams(window.location.search),qe=Pe.get("payment"),Ge=Pe.get("session_id"),lt=window.location.pathname;qe==="success"&&Ge?(N(!0),i("Payment successful, verifying transaction...","info"),YF(Ge,n).then(Ct=>{Ct.success?i("Payment verified! Your bill and points are updated.","success"):i(`Payment verification failed: ${Ct.error}`,"error")}).catch(Ct=>{i(`An error occurred during verification: ${Ct.message}`,"error")}).finally(()=>{N(!1),J(),ae(),window.history.replaceState({},document.title,lt)})):qe==="cancel"&&(i("Payment was cancelled. Your bill remains unpaid.","warning"),window.history.replaceState({},document.title,lt))},[J,i,n,ae]);const le=Pe=>{E(Pe),b(!0)},Q=async Pe=>{if(!Pe||!Pe.calculatedCharges){i("Bill details unavailable for explanation.","warning");return}I(Pe),U(""),k(!0);try{const qe={...Pe,amount:Pe.baseAmount},Ge=await RF({billDetails:qe,charges:Pe.calculatedCharges,customerName:e.displayName||"Valued Customer",serviceType:e.serviceType||"Residential"}),lt=Pe.potentialPenalty>0&&Pe.status==="Unpaid"?`<p><strong>Note on Late Payment:</strong> A penalty of <strong>${Pe.potentialPenalty.toFixed(2)}</strong> will be applied if not paid by the due date.</p>`:"";U(Ge+lt)}catch(qe){const Ge=(qe==null?void 0:qe.message)||"AI explanation failed.";U("<p>Sorry, an error occurred while generating the explanation. Please view the detailed invoice instead.</p>"),i(Ge,"error")}finally{k(!1)}},ce=Pe=>{O(Pe),M(!0)},ue=Pe=>{$(Pe),ee(!0)},fe=async()=>{if(!D)return;const Pe=Math.round(D.amount);if(e.rebatePoints<Pe){i("You do not have enough points to pay this bill.","error"),ee(!1);return}ie(!0);const qe=await $8(n,r.uid,D.id,Pe,D.amount);qe.success?(i("Bill paid successfully using rebate points!","success"),await J(),await ae()):i(qe.error||"Failed to process payment with points.","error"),ie(!1),ee(!1),$(null)},ve=Pe=>{var lt,Ct;if(Pe.invoiceNumber)return Pe.invoiceNumber;const qe=(lt=Pe.billDate)!=null&&lt.toDate?Pe.billDate.toDate():null,Ge=qe?`${qe.getFullYear()}${String(qe.getMonth()+1).padStart(2,"0")}${String(qe.getDate()).padStart(2,"0")}`:Date.now().toString().slice(-6);return`AGWA-${(Ct=Pe.id)==null?void 0:Ct.slice(0,4).toUpperCase()}-${Ge}`};if(f||S){const Pe=S?"Verifying your payment...":"Loading your bills...";return c.jsx(ln,{message:Pe})}const Me=(e==null?void 0:e.rebatePoints)||0;return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center mb-6 pb-4 border-b border-gray-200",children:[c.jsx(oc,{size:30,className:"mr-3 text-blue-600"})," My Bills & Payment History"]}),p&&c.jsx("div",{className:"text-red-500 bg-red-50 p-3 rounded-md text-center",children:p}),l.length===0&&!p&&c.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner",children:[c.jsx(yn,{size:48,className:"mx-auto text-gray-400 mb-4"}),c.jsx("p",{className:"text-gray-600 text-lg",children:"No billing history found."})]}),c.jsx("div",{className:"space-y-4",children:l.map(Pe=>{var Ie,Le,Be;const qe=ve(Pe),Ge=Pe.status==="Paid",lt=(Pe.baseAmount+Pe.potentialPenalty).toFixed(2),Ct=Math.round(Pe.amount),bt=!Ge&&Me>=Ct,Te=!Ge&&!bt&&Me>0&&o.isRebateProgramEnabled;return c.jsxs("div",{className:`p-4 rounded-lg shadow-md border-l-4 ${Ge?"bg-green-50 border-green-400":"bg-yellow-50 border-yellow-400"}`,children:[c.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-2",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:Pe.monthYear||Pe.billingPeriod||""}),c.jsxs("p",{className:`text-sm font-semibold ${Ge?"text-green-600":"text-red-600"}`,children:["Due: ",Mt(Pe.dueDate,{month:"long",day:"numeric"})]}),c.jsxs("p",{className:"text-xs text-gray-500 mt-1",title:qe,children:["Invoice No: ",qe]})]}),c.jsx("div",{className:"text-right",children:Ge?c.jsxs(c.Fragment,{children:[c.jsxs("p",{className:"text-2xl font-bold text-gray-700",children:["",((Ie=Pe.amountPaid)==null?void 0:Ie.toFixed(2))??((Le=Pe.amount)==null?void 0:Le.toFixed(2))]}),c.jsxs("p",{className:"text-sm font-semibold text-green-600",children:["Paid on ",Mt(Pe.paymentDate,{month:"short",day:"numeric"})]})]}):c.jsxs(c.Fragment,{children:[c.jsxs("p",{className:"text-2xl font-bold text-gray-700",children:["",(Be=Pe.baseAmount)==null?void 0:Be.toFixed(2)]}),c.jsxs("p",{className:"text-sm font-semibold text-red-600",children:["(After Due Date: ",lt,")"]}),Pe.displayPenalty>0&&c.jsxs("span",{className:"text-xs text-red-500 font-semibold block",children:["(Currently includes ",Pe.displayPenalty.toFixed(2)," penalty)"]})]})})]}),c.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200/80 flex flex-wrap gap-2 justify-end",children:[c.jsxs("button",{onClick:()=>ce(Pe),className:"text-xs font-medium bg-blue-100 text-blue-700 hover:bg-blue-200 px-3 py-1.5 rounded-md transition flex items-center",children:[c.jsx(ja,{size:14,className:"mr-1"}),"View Invoice"]}),c.jsxs("button",{onClick:()=>Q(Pe),className:"text-xs font-medium bg-purple-100 text-purple-700 hover:bg-purple-200 px-3 py-1.5 rounded-md transition flex items-center",disabled:P&&(R==null?void 0:R.id)===Pe.id,children:[P&&(R==null?void 0:R.id)===Pe.id?c.jsx(Tt,{size:14,className:"animate-spin mr-1"}):c.jsx(Ds,{size:14,className:"mr-1"})," Explain Bill (AI)"]}),bt&&o.isRebateProgramEnabled&&c.jsxs("button",{onClick:()=>ue(Pe),className:"text-xs font-bold bg-amber-500 text-white hover:bg-amber-600 px-4 py-1.5 rounded-md transition flex items-center",children:[c.jsx(bu,{size:14,className:"mr-1.5"})," Pay with ",Ct," Points"]}),Te&&c.jsx(dm,{text:`You need ${Ct} points to pay this bill. You currently have ${Me}.`,children:c.jsxs("button",{className:"text-xs font-bold bg-gray-300 text-gray-500 px-4 py-1.5 rounded-md flex items-center cursor-not-allowed",children:[c.jsx(bu,{size:14,className:"mr-1.5"})," Pay with ",Ct," Points"]})}),!Ge&&re&&c.jsxs("button",{onClick:()=>le(Pe),className:"text-xs font-bold bg-green-500 text-white hover:bg-green-600 px-4 py-1.5 rounded-md transition flex items-center",children:[c.jsx("span",{className:"mr-1 font-bold",children:""})," Pay with Card (",Pe.amount.toFixed(2),")"]})]})]},Pe.id)})}),c.jsx(Vr,{isOpen:!!R,onClose:()=>I(null),title:` AI Explanation for ${(R==null?void 0:R.monthYear)||"Bill"}`,size:"lg",children:P?c.jsx(ln,{message:"Agie is analyzing your bill..."}):c.jsx("div",{className:"prose prose-sm max-w-none leading-relaxed p-2",dangerouslySetInnerHTML:{__html:uo.sanitize(j||"")}})}),x&&v&&c.jsx(ZF,{isOpen:x,onClose:()=>b(!1),billToPay:v,userData:e,showNotification:i,stripePromise:G}),C&&F&&c.jsx(C3,{isOpen:C,onClose:()=>M(!1),bill:F,allUserBills:l,userData:e,calculateBillDetails:s,showNotification:i,systemSettings:o}),K&&D&&c.jsxs(Da,{isOpen:K,onClose:()=>ee(!1),onConfirm:fe,title:"Confirm Payment with Points",confirmText:`Yes, Pay ${D.amount.toFixed(2)}`,isConfirming:se,iconType:"success",children:[c.jsxs("p",{children:["Are you sure you want to use ",c.jsxs("strong",{className:"text-amber-600",children:[Math.round(D.amount).toLocaleString()," points"]})," to pay for your bill of ",c.jsxs("strong",{children:["",D.amount.toFixed(2)]}),"?"]}),c.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["This action is irreversible. ",Math.round(D.amount).toLocaleString()," points will be deducted from your account."]})]})]})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Fm(r){return r+.5|0}const Ul=(r,e,t)=>Math.max(Math.min(r,t),e);function xf(r){return Ul(Fm(r*2.55),0,255)}function Ql(r){return Ul(Fm(r*255),0,255)}function xa(r){return Ul(Fm(r/2.55)/100,0,1)}function pA(r){return Ul(Fm(r*100),0,100)}const Ns={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Hx=[..."0123456789ABCDEF"],_V=r=>Hx[r&15],xV=r=>Hx[(r&240)>>4]+Hx[r&15],Yp=r=>(r&240)>>4===(r&15),bV=r=>Yp(r.r)&&Yp(r.g)&&Yp(r.b)&&Yp(r.a);function wV(r){var e=r.length,t;return r[0]==="#"&&(e===4||e===5?t={r:255&Ns[r[1]]*17,g:255&Ns[r[2]]*17,b:255&Ns[r[3]]*17,a:e===5?Ns[r[4]]*17:255}:(e===7||e===9)&&(t={r:Ns[r[1]]<<4|Ns[r[2]],g:Ns[r[3]]<<4|Ns[r[4]],b:Ns[r[5]]<<4|Ns[r[6]],a:e===9?Ns[r[7]]<<4|Ns[r[8]]:255})),t}const EV=(r,e)=>r<255?e(r):"";function SV(r){var e=bV(r)?_V:xV;return r?"#"+e(r.r)+e(r.g)+e(r.b)+EV(r.a,e):void 0}const TV=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function R3(r,e,t){const n=e*Math.min(t,1-t),i=(s,o=(s+r/30)%12)=>t-n*Math.max(Math.min(o-3,9-o,1),-1);return[i(0),i(8),i(4)]}function AV(r,e,t){const n=(i,s=(i+r/60)%6)=>t-t*e*Math.max(Math.min(s,4-s,1),0);return[n(5),n(3),n(1)]}function NV(r,e,t){const n=R3(r,1,.5);let i;for(e+t>1&&(i=1/(e+t),e*=i,t*=i),i=0;i<3;i++)n[i]*=1-e-t,n[i]+=e;return n}function IV(r,e,t,n,i){return r===i?(e-t)/n+(e<t?6:0):e===i?(t-r)/n+2:(r-e)/n+4}function z2(r){const t=r.r/255,n=r.g/255,i=r.b/255,s=Math.max(t,n,i),o=Math.min(t,n,i),l=(s+o)/2;let d,f,m;return s!==o&&(m=s-o,f=l>.5?m/(2-s-o):m/(s+o),d=IV(t,n,i,m,s),d=d*60+.5),[d|0,f||0,l]}function U2(r,e,t,n){return(Array.isArray(e)?r(e[0],e[1],e[2]):r(e,t,n)).map(Ql)}function q2(r,e,t){return U2(R3,r,e,t)}function PV(r,e,t){return U2(NV,r,e,t)}function kV(r,e,t){return U2(AV,r,e,t)}function j3(r){return(r%360+360)%360}function CV(r){const e=TV.exec(r);let t=255,n;if(!e)return;e[5]!==n&&(t=e[6]?xf(+e[5]):Ql(+e[5]));const i=j3(+e[2]),s=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?n=PV(i,s,o):e[1]==="hsv"?n=kV(i,s,o):n=q2(i,s,o),{r:n[0],g:n[1],b:n[2],a:t}}function RV(r,e){var t=z2(r);t[0]=j3(t[0]+e),t=q2(t),r.r=t[0],r.g=t[1],r.b=t[2]}function jV(r){if(!r)return;const e=z2(r),t=e[0],n=pA(e[1]),i=pA(e[2]);return r.a<255?`hsla(${t}, ${n}%, ${i}%, ${xa(r.a)})`:`hsl(${t}, ${n}%, ${i}%)`}const gA={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},yA={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function OV(){const r={},e=Object.keys(yA),t=Object.keys(gA);let n,i,s,o,l;for(n=0;n<e.length;n++){for(o=l=e[n],i=0;i<t.length;i++)s=t[i],l=l.replace(s,gA[s]);s=parseInt(yA[o],16),r[l]=[s>>16&255,s>>8&255,s&255]}return r}let Zp;function DV(r){Zp||(Zp=OV(),Zp.transparent=[0,0,0,0]);const e=Zp[r.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const MV=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function LV(r){const e=MV.exec(r);let t=255,n,i,s;if(e){if(e[7]!==n){const o=+e[7];t=e[8]?xf(o):Ul(o*255,0,255)}return n=+e[1],i=+e[3],s=+e[5],n=255&(e[2]?xf(n):Ul(n,0,255)),i=255&(e[4]?xf(i):Ul(i,0,255)),s=255&(e[6]?xf(s):Ul(s,0,255)),{r:n,g:i,b:s,a:t}}}function FV(r){return r&&(r.a<255?`rgba(${r.r}, ${r.g}, ${r.b}, ${xa(r.a)})`:`rgb(${r.r}, ${r.g}, ${r.b})`)}const s1=r=>r<=.0031308?r*12.92:Math.pow(r,1/2.4)*1.055-.055,pd=r=>r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4);function VV(r,e,t){const n=pd(xa(r.r)),i=pd(xa(r.g)),s=pd(xa(r.b));return{r:Ql(s1(n+t*(pd(xa(e.r))-n))),g:Ql(s1(i+t*(pd(xa(e.g))-i))),b:Ql(s1(s+t*(pd(xa(e.b))-s))),a:r.a+t*(e.a-r.a)}}function Qp(r,e,t){if(r){let n=z2(r);n[e]=Math.max(0,Math.min(n[e]+n[e]*t,e===0?360:1)),n=q2(n),r.r=n[0],r.g=n[1],r.b=n[2]}}function O3(r,e){return r&&Object.assign(e||{},r)}function vA(r){var e={r:0,g:0,b:0,a:255};return Array.isArray(r)?r.length>=3&&(e={r:r[0],g:r[1],b:r[2],a:255},r.length>3&&(e.a=Ql(r[3]))):(e=O3(r,{r:0,g:0,b:0,a:1}),e.a=Ql(e.a)),e}function BV(r){return r.charAt(0)==="r"?LV(r):CV(r)}class hm{constructor(e){if(e instanceof hm)return e;const t=typeof e;let n;t==="object"?n=vA(e):t==="string"&&(n=wV(e)||DV(e)||BV(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=O3(this._rgb);return e&&(e.a=xa(e.a)),e}set rgb(e){this._rgb=vA(e)}rgbString(){return this._valid?FV(this._rgb):void 0}hexString(){return this._valid?SV(this._rgb):void 0}hslString(){return this._valid?jV(this._rgb):void 0}mix(e,t){if(e){const n=this.rgb,i=e.rgb;let s;const o=t===s?.5:t,l=2*o-1,d=n.a-i.a,f=((l*d===-1?l:(l+d)/(1+l*d))+1)/2;s=1-f,n.r=255&f*n.r+s*i.r+.5,n.g=255&f*n.g+s*i.g+.5,n.b=255&f*n.b+s*i.b+.5,n.a=o*n.a+(1-o)*i.a,this.rgb=n}return this}interpolate(e,t){return e&&(this._rgb=VV(this._rgb,e._rgb,t)),this}clone(){return new hm(this.rgb)}alpha(e){return this._rgb.a=Ql(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=Fm(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Qp(this._rgb,2,e),this}darken(e){return Qp(this._rgb,2,-e),this}saturate(e){return Qp(this._rgb,1,e),this}desaturate(e){return Qp(this._rgb,1,-e),this}rotate(e){return RV(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function pa(){}const zV=(()=>{let r=0;return()=>r++})();function an(r){return r==null}function fr(r){if(Array.isArray&&Array.isArray(r))return!0;const e=Object.prototype.toString.call(r);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function en(r){return r!==null&&Object.prototype.toString.call(r)==="[object Object]"}function Ls(r){return(typeof r=="number"||r instanceof Number)&&isFinite(+r)}function Ao(r,e){return Ls(r)?r:e}function Bt(r,e){return typeof r>"u"?e:r}const UV=(r,e)=>typeof r=="string"&&r.endsWith("%")?parseFloat(r)/100:+r/e,D3=(r,e)=>typeof r=="string"&&r.endsWith("%")?parseFloat(r)/100*e:+r;function Cn(r,e,t){if(r&&typeof r.call=="function")return r.apply(t,e)}function fn(r,e,t,n){let i,s,o;if(fr(r))for(s=r.length,i=0;i<s;i++)e.call(t,r[i],i);else if(en(r))for(o=Object.keys(r),s=o.length,i=0;i<s;i++)e.call(t,r[o[i]],o[i])}function hy(r,e){let t,n,i,s;if(!r||!e||r.length!==e.length)return!1;for(t=0,n=r.length;t<n;++t)if(i=r[t],s=e[t],i.datasetIndex!==s.datasetIndex||i.index!==s.index)return!1;return!0}function fy(r){if(fr(r))return r.map(fy);if(en(r)){const e=Object.create(null),t=Object.keys(r),n=t.length;let i=0;for(;i<n;++i)e[t[i]]=fy(r[t[i]]);return e}return r}function M3(r){return["__proto__","prototype","constructor"].indexOf(r)===-1}function qV(r,e,t,n){if(!M3(r))return;const i=e[r],s=t[r];en(i)&&en(s)?fm(i,s,n):e[r]=fy(s)}function fm(r,e,t){const n=fr(e)?e:[e],i=n.length;if(!en(r))return r;t=t||{};const s=t.merger||qV;let o;for(let l=0;l<i;++l){if(o=n[l],!en(o))continue;const d=Object.keys(o);for(let f=0,m=d.length;f<m;++f)s(d[f],r,o,t)}return r}function Ff(r,e){return fm(r,e,{merger:HV})}function HV(r,e,t){if(!M3(r))return;const n=e[r],i=t[r];en(n)&&en(i)?Ff(n,i):Object.prototype.hasOwnProperty.call(e,r)||(e[r]=fy(i))}const _A={"":r=>r,x:r=>r.x,y:r=>r.y};function $V(r){const e=r.split("."),t=[];let n="";for(const i of e)n+=i,n.endsWith("\\")?n=n.slice(0,-1)+".":(t.push(n),n="");return t}function WV(r){const e=$V(r);return t=>{for(const n of e){if(n==="")break;t=t&&t[n]}return t}}function wu(r,e){return(_A[e]||(_A[e]=WV(e)))(r)}function H2(r){return r.charAt(0).toUpperCase()+r.slice(1)}const mm=r=>typeof r<"u",cc=r=>typeof r=="function",xA=(r,e)=>{if(r.size!==e.size)return!1;for(const t of r)if(!e.has(t))return!1;return!0};function GV(r){return r.type==="mouseup"||r.type==="click"||r.type==="contextmenu"}const mn=Math.PI,Wn=2*mn,KV=Wn+mn,my=Number.POSITIVE_INFINITY,YV=mn/180,mr=mn/2,Vc=mn/4,bA=mn*2/3,L3=Math.log10,Mo=Math.sign;function Vf(r,e,t){return Math.abs(r-e)<t}function wA(r){const e=Math.round(r);r=Vf(r,e,r/1e3)?e:r;const t=Math.pow(10,Math.floor(L3(r))),n=r/t;return(n<=1?1:n<=2?2:n<=5?5:10)*t}function ZV(r){const e=[],t=Math.sqrt(r);let n;for(n=1;n<t;n++)r%n===0&&(e.push(n),e.push(r/n));return t===(t|0)&&e.push(t),e.sort((i,s)=>i-s).pop(),e}function QV(r){return typeof r=="symbol"||typeof r=="object"&&r!==null&&!(Symbol.toPrimitive in r||"toString"in r||"valueOf"in r)}function pm(r){return!QV(r)&&!isNaN(parseFloat(r))&&isFinite(r)}function XV(r,e){const t=Math.round(r);return t-e<=r&&t+e>=r}function JV(r,e,t){let n,i,s;for(n=0,i=r.length;n<i;n++)s=r[n][t],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function Ta(r){return r*(mn/180)}function eB(r){return r*(180/mn)}function EA(r){if(!Ls(r))return;let e=1,t=0;for(;Math.round(r*e)/e!==r;)e*=10,t++;return t}function F3(r,e){const t=e.x-r.x,n=e.y-r.y,i=Math.sqrt(t*t+n*n);let s=Math.atan2(n,t);return s<-.5*mn&&(s+=Wn),{angle:s,distance:i}}function $x(r,e){return Math.sqrt(Math.pow(e.x-r.x,2)+Math.pow(e.y-r.y,2))}function tB(r,e){return(r-e+KV)%Wn-mn}function oo(r){return(r%Wn+Wn)%Wn}function gm(r,e,t,n){const i=oo(r),s=oo(e),o=oo(t),l=oo(s-i),d=oo(o-i),f=oo(i-s),m=oo(i-o);return i===s||i===o||n&&s===o||l>d&&f<m}function Jr(r,e,t){return Math.max(e,Math.min(t,r))}function nB(r){return Jr(r,-32768,32767)}function ql(r,e,t,n=1e-6){return r>=Math.min(e,t)-n&&r<=Math.max(e,t)+n}function $2(r,e,t){t=t||(o=>r[o]<e);let n=r.length-1,i=0,s;for(;n-i>1;)s=i+n>>1,t(s)?i=s:n=s;return{lo:i,hi:n}}const Jc=(r,e,t,n)=>$2(r,t,n?i=>{const s=r[i][e];return s<t||s===t&&r[i+1][e]===t}:i=>r[i][e]<t),rB=(r,e,t)=>$2(r,t,n=>r[n][e]>=t);function iB(r,e,t){let n=0,i=r.length;for(;n<i&&r[n]<e;)n++;for(;i>n&&r[i-1]>t;)i--;return n>0||i<r.length?r.slice(n,i):r}const V3=["push","pop","shift","splice","unshift"];function sB(r,e){if(r._chartjs){r._chartjs.listeners.push(e);return}Object.defineProperty(r,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),V3.forEach(t=>{const n="_onData"+H2(t),i=r[t];Object.defineProperty(r,t,{configurable:!0,enumerable:!1,value(...s){const o=i.apply(this,s);return r._chartjs.listeners.forEach(l=>{typeof l[n]=="function"&&l[n](...s)}),o}})})}function SA(r,e){const t=r._chartjs;if(!t)return;const n=t.listeners,i=n.indexOf(e);i!==-1&&n.splice(i,1),!(n.length>0)&&(V3.forEach(s=>{delete r[s]}),delete r._chartjs)}function B3(r){const e=new Set(r);return e.size===r.length?r:Array.from(e)}const z3=function(){return typeof window>"u"?function(r){return r()}:window.requestAnimationFrame}();function U3(r,e){let t=[],n=!1;return function(...i){t=i,n||(n=!0,z3.call(window,()=>{n=!1,r.apply(e,t)}))}}function oB(r,e){let t;return function(...n){return e?(clearTimeout(t),t=setTimeout(r,e,n)):r.apply(this,n),e}}const W2=r=>r==="start"?"left":r==="end"?"right":"center",Qr=(r,e,t)=>r==="start"?e:r==="end"?t:(e+t)/2,aB=(r,e,t,n)=>r===(n?"left":"right")?t:r==="center"?(e+t)/2:e;function lB(r,e,t){const n=e.length;let i=0,s=n;if(r._sorted){const{iScale:o,vScale:l,_parsed:d}=r,f=r.dataset&&r.dataset.options?r.dataset.options.spanGaps:null,m=o.axis,{min:p,max:g,minDefined:v,maxDefined:E}=o.getUserBounds();if(v){if(i=Math.min(Jc(d,m,p).lo,t?n:Jc(e,m,o.getPixelForValue(p)).lo),f){const x=d.slice(0,i+1).reverse().findIndex(b=>!an(b[l.axis]));i-=Math.max(0,x)}i=Jr(i,0,n-1)}if(E){let x=Math.max(Jc(d,o.axis,g,!0).hi+1,t?0:Jc(e,m,o.getPixelForValue(g),!0).hi+1);if(f){const b=d.slice(x-1).findIndex(S=>!an(S[l.axis]));x+=Math.max(0,b)}s=Jr(x,i,n)-i}else s=n-i}return{start:i,count:s}}function cB(r){const{xScale:e,yScale:t,_scaleRanges:n}=r,i={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!n)return r._scaleRanges=i,!0;const s=n.xmin!==e.min||n.xmax!==e.max||n.ymin!==t.min||n.ymax!==t.max;return Object.assign(n,i),s}const Xp=r=>r===0||r===1,TA=(r,e,t)=>-(Math.pow(2,10*(r-=1))*Math.sin((r-e)*Wn/t)),AA=(r,e,t)=>Math.pow(2,-10*r)*Math.sin((r-e)*Wn/t)+1,Bf={linear:r=>r,easeInQuad:r=>r*r,easeOutQuad:r=>-r*(r-2),easeInOutQuad:r=>(r/=.5)<1?.5*r*r:-.5*(--r*(r-2)-1),easeInCubic:r=>r*r*r,easeOutCubic:r=>(r-=1)*r*r+1,easeInOutCubic:r=>(r/=.5)<1?.5*r*r*r:.5*((r-=2)*r*r+2),easeInQuart:r=>r*r*r*r,easeOutQuart:r=>-((r-=1)*r*r*r-1),easeInOutQuart:r=>(r/=.5)<1?.5*r*r*r*r:-.5*((r-=2)*r*r*r-2),easeInQuint:r=>r*r*r*r*r,easeOutQuint:r=>(r-=1)*r*r*r*r+1,easeInOutQuint:r=>(r/=.5)<1?.5*r*r*r*r*r:.5*((r-=2)*r*r*r*r+2),easeInSine:r=>-Math.cos(r*mr)+1,easeOutSine:r=>Math.sin(r*mr),easeInOutSine:r=>-.5*(Math.cos(mn*r)-1),easeInExpo:r=>r===0?0:Math.pow(2,10*(r-1)),easeOutExpo:r=>r===1?1:-Math.pow(2,-10*r)+1,easeInOutExpo:r=>Xp(r)?r:r<.5?.5*Math.pow(2,10*(r*2-1)):.5*(-Math.pow(2,-10*(r*2-1))+2),easeInCirc:r=>r>=1?r:-(Math.sqrt(1-r*r)-1),easeOutCirc:r=>Math.sqrt(1-(r-=1)*r),easeInOutCirc:r=>(r/=.5)<1?-.5*(Math.sqrt(1-r*r)-1):.5*(Math.sqrt(1-(r-=2)*r)+1),easeInElastic:r=>Xp(r)?r:TA(r,.075,.3),easeOutElastic:r=>Xp(r)?r:AA(r,.075,.3),easeInOutElastic(r){return Xp(r)?r:r<.5?.5*TA(r*2,.1125,.45):.5+.5*AA(r*2-1,.1125,.45)},easeInBack(r){return r*r*((1.70158+1)*r-1.70158)},easeOutBack(r){return(r-=1)*r*((1.70158+1)*r+1.70158)+1},easeInOutBack(r){let e=1.70158;return(r/=.5)<1?.5*(r*r*(((e*=1.525)+1)*r-e)):.5*((r-=2)*r*(((e*=1.525)+1)*r+e)+2)},easeInBounce:r=>1-Bf.easeOutBounce(1-r),easeOutBounce(r){return r<1/2.75?7.5625*r*r:r<2/2.75?7.5625*(r-=1.5/2.75)*r+.75:r<2.5/2.75?7.5625*(r-=2.25/2.75)*r+.9375:7.5625*(r-=2.625/2.75)*r+.984375},easeInOutBounce:r=>r<.5?Bf.easeInBounce(r*2)*.5:Bf.easeOutBounce(r*2-1)*.5+.5};function G2(r){if(r&&typeof r=="object"){const e=r.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function NA(r){return G2(r)?r:new hm(r)}function o1(r){return G2(r)?r:new hm(r).saturate(.5).darken(.1).hexString()}const uB=["x","y","borderWidth","radius","tension"],dB=["color","borderColor","backgroundColor"];function hB(r){r.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),r.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),r.set("animations",{colors:{type:"color",properties:dB},numbers:{type:"number",properties:uB}}),r.describe("animations",{_fallback:"animation"}),r.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function fB(r){r.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const IA=new Map;function mB(r,e){e=e||{};const t=r+JSON.stringify(e);let n=IA.get(t);return n||(n=new Intl.NumberFormat(r,e),IA.set(t,n)),n}function K2(r,e,t){return mB(e,t).format(r)}const pB={values(r){return fr(r)?r:""+r},numeric(r,e,t){if(r===0)return"0";const n=this.chart.options.locale;let i,s=r;if(t.length>1){const f=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(f<1e-4||f>1e15)&&(i="scientific"),s=gB(r,t)}const o=L3(Math.abs(s)),l=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),d={notation:i,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(d,this.options.ticks.format),K2(r,n,d)}};function gB(r,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&r!==Math.floor(r)&&(t=r-Math.floor(r)),t}var q3={formatters:pB};function yB(r){r.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:q3.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),r.route("scale.ticks","color","","color"),r.route("scale.grid","color","","borderColor"),r.route("scale.border","color","","borderColor"),r.route("scale.title","color","","color"),r.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),r.describe("scales",{_fallback:"scale"}),r.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Eu=Object.create(null),Wx=Object.create(null);function zf(r,e){if(!e)return r;const t=e.split(".");for(let n=0,i=t.length;n<i;++n){const s=t[n];r=r[s]||(r[s]=Object.create(null))}return r}function a1(r,e,t){return typeof e=="string"?fm(zf(r,e),t):fm(zf(r,""),e)}class vB{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,i)=>o1(i.backgroundColor),this.hoverBorderColor=(n,i)=>o1(i.borderColor),this.hoverColor=(n,i)=>o1(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return a1(this,e,t)}get(e){return zf(this,e)}describe(e,t){return a1(Wx,e,t)}override(e,t){return a1(Eu,e,t)}route(e,t,n,i){const s=zf(this,e),o=zf(this,n),l="_"+t;Object.defineProperties(s,{[l]:{value:s[t],writable:!0},[t]:{enumerable:!0,get(){const d=this[l],f=o[i];return en(d)?Object.assign({},f,d):Bt(d,f)},set(d){this[l]=d}}})}apply(e){e.forEach(t=>t(this))}}var Xn=new vB({_scriptable:r=>!r.startsWith("on"),_indexable:r=>r!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[hB,fB,yB]);function _B(r){return!r||an(r.size)||an(r.family)?null:(r.style?r.style+" ":"")+(r.weight?r.weight+" ":"")+r.size+"px "+r.family}function PA(r,e,t,n,i){let s=e[i];return s||(s=e[i]=r.measureText(i).width,t.push(i)),s>n&&(n=s),n}function Bc(r,e,t){const n=r.currentDevicePixelRatio,i=t!==0?Math.max(t/2,.5):0;return Math.round((e-i)*n)/n+i}function kA(r,e){!e&&!r||(e=e||r.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,r.width,r.height),e.restore())}function Gx(r,e,t,n){H3(r,e,t,n,null)}function H3(r,e,t,n,i){let s,o,l,d,f,m,p,g;const v=e.pointStyle,E=e.rotation,x=e.radius;let b=(E||0)*YV;if(v&&typeof v=="object"&&(s=v.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){r.save(),r.translate(t,n),r.rotate(b),r.drawImage(v,-v.width/2,-v.height/2,v.width,v.height),r.restore();return}if(!(isNaN(x)||x<=0)){switch(r.beginPath(),v){default:i?r.ellipse(t,n,i/2,x,0,0,Wn):r.arc(t,n,x,0,Wn),r.closePath();break;case"triangle":m=i?i/2:x,r.moveTo(t+Math.sin(b)*m,n-Math.cos(b)*x),b+=bA,r.lineTo(t+Math.sin(b)*m,n-Math.cos(b)*x),b+=bA,r.lineTo(t+Math.sin(b)*m,n-Math.cos(b)*x),r.closePath();break;case"rectRounded":f=x*.516,d=x-f,o=Math.cos(b+Vc)*d,p=Math.cos(b+Vc)*(i?i/2-f:d),l=Math.sin(b+Vc)*d,g=Math.sin(b+Vc)*(i?i/2-f:d),r.arc(t-p,n-l,f,b-mn,b-mr),r.arc(t+g,n-o,f,b-mr,b),r.arc(t+p,n+l,f,b,b+mr),r.arc(t-g,n+o,f,b+mr,b+mn),r.closePath();break;case"rect":if(!E){d=Math.SQRT1_2*x,m=i?i/2:d,r.rect(t-m,n-d,2*m,2*d);break}b+=Vc;case"rectRot":p=Math.cos(b)*(i?i/2:x),o=Math.cos(b)*x,l=Math.sin(b)*x,g=Math.sin(b)*(i?i/2:x),r.moveTo(t-p,n-l),r.lineTo(t+g,n-o),r.lineTo(t+p,n+l),r.lineTo(t-g,n+o),r.closePath();break;case"crossRot":b+=Vc;case"cross":p=Math.cos(b)*(i?i/2:x),o=Math.cos(b)*x,l=Math.sin(b)*x,g=Math.sin(b)*(i?i/2:x),r.moveTo(t-p,n-l),r.lineTo(t+p,n+l),r.moveTo(t+g,n-o),r.lineTo(t-g,n+o);break;case"star":p=Math.cos(b)*(i?i/2:x),o=Math.cos(b)*x,l=Math.sin(b)*x,g=Math.sin(b)*(i?i/2:x),r.moveTo(t-p,n-l),r.lineTo(t+p,n+l),r.moveTo(t+g,n-o),r.lineTo(t-g,n+o),b+=Vc,p=Math.cos(b)*(i?i/2:x),o=Math.cos(b)*x,l=Math.sin(b)*x,g=Math.sin(b)*(i?i/2:x),r.moveTo(t-p,n-l),r.lineTo(t+p,n+l),r.moveTo(t+g,n-o),r.lineTo(t-g,n+o);break;case"line":o=i?i/2:Math.cos(b)*x,l=Math.sin(b)*x,r.moveTo(t-o,n-l),r.lineTo(t+o,n+l);break;case"dash":r.moveTo(t,n),r.lineTo(t+Math.cos(b)*(i?i/2:x),n+Math.sin(b)*x);break;case!1:r.closePath();break}r.fill(),e.borderWidth>0&&r.stroke()}}function ym(r,e,t){return t=t||.5,!e||r&&r.x>e.left-t&&r.x<e.right+t&&r.y>e.top-t&&r.y<e.bottom+t}function Y2(r,e){r.save(),r.beginPath(),r.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),r.clip()}function Z2(r){r.restore()}function xB(r,e,t,n,i){if(!e)return r.lineTo(t.x,t.y);if(i==="middle"){const s=(e.x+t.x)/2;r.lineTo(s,e.y),r.lineTo(s,t.y)}else i==="after"!=!!n?r.lineTo(e.x,t.y):r.lineTo(t.x,e.y);r.lineTo(t.x,t.y)}function bB(r,e,t,n){if(!e)return r.lineTo(t.x,t.y);r.bezierCurveTo(n?e.cp1x:e.cp2x,n?e.cp1y:e.cp2y,n?t.cp2x:t.cp1x,n?t.cp2y:t.cp1y,t.x,t.y)}function wB(r,e){e.translation&&r.translate(e.translation[0],e.translation[1]),an(e.rotation)||r.rotate(e.rotation),e.color&&(r.fillStyle=e.color),e.textAlign&&(r.textAlign=e.textAlign),e.textBaseline&&(r.textBaseline=e.textBaseline)}function EB(r,e,t,n,i){if(i.strikethrough||i.underline){const s=r.measureText(n),o=e-s.actualBoundingBoxLeft,l=e+s.actualBoundingBoxRight,d=t-s.actualBoundingBoxAscent,f=t+s.actualBoundingBoxDescent,m=i.strikethrough?(d+f)/2:f;r.strokeStyle=r.fillStyle,r.beginPath(),r.lineWidth=i.decorationWidth||2,r.moveTo(o,m),r.lineTo(l,m),r.stroke()}}function SB(r,e){const t=r.fillStyle;r.fillStyle=e.color,r.fillRect(e.left,e.top,e.width,e.height),r.fillStyle=t}function vm(r,e,t,n,i,s={}){const o=fr(e)?e:[e],l=s.strokeWidth>0&&s.strokeColor!=="";let d,f;for(r.save(),r.font=i.string,wB(r,s),d=0;d<o.length;++d)f=o[d],s.backdrop&&SB(r,s.backdrop),l&&(s.strokeColor&&(r.strokeStyle=s.strokeColor),an(s.strokeWidth)||(r.lineWidth=s.strokeWidth),r.strokeText(f,t,n,s.maxWidth)),r.fillText(f,t,n,s.maxWidth),EB(r,t,n,f,s),n+=Number(i.lineHeight);r.restore()}function py(r,e){const{x:t,y:n,w:i,h:s,radius:o}=e;r.arc(t+o.topLeft,n+o.topLeft,o.topLeft,1.5*mn,mn,!0),r.lineTo(t,n+s-o.bottomLeft),r.arc(t+o.bottomLeft,n+s-o.bottomLeft,o.bottomLeft,mn,mr,!0),r.lineTo(t+i-o.bottomRight,n+s),r.arc(t+i-o.bottomRight,n+s-o.bottomRight,o.bottomRight,mr,0,!0),r.lineTo(t+i,n+o.topRight),r.arc(t+i-o.topRight,n+o.topRight,o.topRight,0,-mr,!0),r.lineTo(t+o.topLeft,n)}const TB=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,AB=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function NB(r,e){const t=(""+r).match(TB);if(!t||t[1]==="normal")return e*1.2;switch(r=+t[2],t[3]){case"px":return r;case"%":r/=100;break}return e*r}const IB=r=>+r||0;function Q2(r,e){const t={},n=en(e),i=n?Object.keys(e):e,s=en(r)?n?o=>Bt(r[o],r[e[o]]):o=>r[o]:()=>r;for(const o of i)t[o]=IB(s(o));return t}function $3(r){return Q2(r,{top:"y",right:"x",bottom:"y",left:"x"})}function jd(r){return Q2(r,["topLeft","topRight","bottomLeft","bottomRight"])}function Fs(r){const e=$3(r);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function ei(r,e){r=r||{},e=e||Xn.font;let t=Bt(r.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let n=Bt(r.style,e.style);n&&!(""+n).match(AB)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const i={family:Bt(r.family,e.family),lineHeight:NB(Bt(r.lineHeight,e.lineHeight),t),size:t,style:n,weight:Bt(r.weight,e.weight),string:""};return i.string=_B(i),i}function Jp(r,e,t,n){let i,s,o;for(i=0,s=r.length;i<s;++i)if(o=r[i],o!==void 0&&o!==void 0)return o}function PB(r,e,t){const{min:n,max:i}=r,s=D3(e,(i-n)/2),o=(l,d)=>t&&l===0?0:l+d;return{min:o(n,-Math.abs(s)),max:o(i,s)}}function Ru(r,e){return Object.assign(Object.create(r),e)}function X2(r,e=[""],t,n,i=()=>r[0]){const s=t||r;typeof n>"u"&&(n=Y3("_fallback",r));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:r,_rootScopes:s,_fallback:n,_getTarget:i,override:l=>X2([l,...r],e,s,n)};return new Proxy(o,{deleteProperty(l,d){return delete l[d],delete l._keys,delete r[0][d],!0},get(l,d){return G3(l,d,()=>LB(d,e,r,l))},getOwnPropertyDescriptor(l,d){return Reflect.getOwnPropertyDescriptor(l._scopes[0],d)},getPrototypeOf(){return Reflect.getPrototypeOf(r[0])},has(l,d){return RA(l).includes(d)},ownKeys(l){return RA(l)},set(l,d,f){const m=l._storage||(l._storage=i());return l[d]=m[d]=f,delete l._keys,!0}})}function Xd(r,e,t,n){const i={_cacheable:!1,_proxy:r,_context:e,_subProxy:t,_stack:new Set,_descriptors:W3(r,n),setContext:s=>Xd(r,s,t,n),override:s=>Xd(r.override(s),e,t,n)};return new Proxy(i,{deleteProperty(s,o){return delete s[o],delete r[o],!0},get(s,o,l){return G3(s,o,()=>CB(s,o,l))},getOwnPropertyDescriptor(s,o){return s._descriptors.allKeys?Reflect.has(r,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(r,o)},getPrototypeOf(){return Reflect.getPrototypeOf(r)},has(s,o){return Reflect.has(r,o)},ownKeys(){return Reflect.ownKeys(r)},set(s,o,l){return r[o]=l,delete s[o],!0}})}function W3(r,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:n=e.indexable,_allKeys:i=e.allKeys}=r;return{allKeys:i,scriptable:t,indexable:n,isScriptable:cc(t)?t:()=>t,isIndexable:cc(n)?n:()=>n}}const kB=(r,e)=>r?r+H2(e):e,J2=(r,e)=>en(e)&&r!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function G3(r,e,t){if(Object.prototype.hasOwnProperty.call(r,e)||e==="constructor")return r[e];const n=t();return r[e]=n,n}function CB(r,e,t){const{_proxy:n,_context:i,_subProxy:s,_descriptors:o}=r;let l=n[e];return cc(l)&&o.isScriptable(e)&&(l=RB(e,l,r,t)),fr(l)&&l.length&&(l=jB(e,l,r,o.isIndexable)),J2(e,l)&&(l=Xd(l,i,s&&s[e],o)),l}function RB(r,e,t,n){const{_proxy:i,_context:s,_subProxy:o,_stack:l}=t;if(l.has(r))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+r);l.add(r);let d=e(s,o||n);return l.delete(r),J2(r,d)&&(d=ew(i._scopes,i,r,d)),d}function jB(r,e,t,n){const{_proxy:i,_context:s,_subProxy:o,_descriptors:l}=t;if(typeof s.index<"u"&&n(r))return e[s.index%e.length];if(en(e[0])){const d=e,f=i._scopes.filter(m=>m!==d);e=[];for(const m of d){const p=ew(f,i,r,m);e.push(Xd(p,s,o&&o[r],l))}}return e}function K3(r,e,t){return cc(r)?r(e,t):r}const OB=(r,e)=>r===!0?e:typeof r=="string"?wu(e,r):void 0;function DB(r,e,t,n,i){for(const s of e){const o=OB(t,s);if(o){r.add(o);const l=K3(o._fallback,t,i);if(typeof l<"u"&&l!==t&&l!==n)return l}else if(o===!1&&typeof n<"u"&&t!==n)return null}return!1}function ew(r,e,t,n){const i=e._rootScopes,s=K3(e._fallback,t,n),o=[...r,...i],l=new Set;l.add(n);let d=CA(l,o,t,s||t,n);return d===null||typeof s<"u"&&s!==t&&(d=CA(l,o,s,d,n),d===null)?!1:X2(Array.from(l),[""],i,s,()=>MB(e,t,n))}function CA(r,e,t,n,i){for(;t;)t=DB(r,e,t,n,i);return t}function MB(r,e,t){const n=r._getTarget();e in n||(n[e]={});const i=n[e];return fr(i)&&en(t)?t:i||{}}function LB(r,e,t,n){let i;for(const s of e)if(i=Y3(kB(s,r),t),typeof i<"u")return J2(r,i)?ew(t,n,r,i):i}function Y3(r,e){for(const t of e){if(!t)continue;const n=t[r];if(typeof n<"u")return n}}function RA(r){let e=r._keys;return e||(e=r._keys=FB(r._scopes)),e}function FB(r){const e=new Set;for(const t of r)for(const n of Object.keys(t).filter(i=>!i.startsWith("_")))e.add(n);return Array.from(e)}const VB=Number.EPSILON||1e-14,Jd=(r,e)=>e<r.length&&!r[e].skip&&r[e],Z3=r=>r==="x"?"y":"x";function BB(r,e,t,n){const i=r.skip?e:r,s=e,o=t.skip?e:t,l=$x(s,i),d=$x(o,s);let f=l/(l+d),m=d/(l+d);f=isNaN(f)?0:f,m=isNaN(m)?0:m;const p=n*f,g=n*m;return{previous:{x:s.x-p*(o.x-i.x),y:s.y-p*(o.y-i.y)},next:{x:s.x+g*(o.x-i.x),y:s.y+g*(o.y-i.y)}}}function zB(r,e,t){const n=r.length;let i,s,o,l,d,f=Jd(r,0);for(let m=0;m<n-1;++m)if(d=f,f=Jd(r,m+1),!(!d||!f)){if(Vf(e[m],0,VB)){t[m]=t[m+1]=0;continue}i=t[m]/e[m],s=t[m+1]/e[m],l=Math.pow(i,2)+Math.pow(s,2),!(l<=9)&&(o=3/Math.sqrt(l),t[m]=i*o*e[m],t[m+1]=s*o*e[m])}}function UB(r,e,t="x"){const n=Z3(t),i=r.length;let s,o,l,d=Jd(r,0);for(let f=0;f<i;++f){if(o=l,l=d,d=Jd(r,f+1),!l)continue;const m=l[t],p=l[n];o&&(s=(m-o[t])/3,l[`cp1${t}`]=m-s,l[`cp1${n}`]=p-s*e[f]),d&&(s=(d[t]-m)/3,l[`cp2${t}`]=m+s,l[`cp2${n}`]=p+s*e[f])}}function qB(r,e="x"){const t=Z3(e),n=r.length,i=Array(n).fill(0),s=Array(n);let o,l,d,f=Jd(r,0);for(o=0;o<n;++o)if(l=d,d=f,f=Jd(r,o+1),!!d){if(f){const m=f[e]-d[e];i[o]=m!==0?(f[t]-d[t])/m:0}s[o]=l?f?Mo(i[o-1])!==Mo(i[o])?0:(i[o-1]+i[o])/2:i[o-1]:i[o]}zB(r,i,s),UB(r,s,e)}function eg(r,e,t){return Math.max(Math.min(r,t),e)}function HB(r,e){let t,n,i,s,o,l=ym(r[0],e);for(t=0,n=r.length;t<n;++t)o=s,s=l,l=t<n-1&&ym(r[t+1],e),s&&(i=r[t],o&&(i.cp1x=eg(i.cp1x,e.left,e.right),i.cp1y=eg(i.cp1y,e.top,e.bottom)),l&&(i.cp2x=eg(i.cp2x,e.left,e.right),i.cp2y=eg(i.cp2y,e.top,e.bottom)))}function $B(r,e,t,n,i){let s,o,l,d;if(e.spanGaps&&(r=r.filter(f=>!f.skip)),e.cubicInterpolationMode==="monotone")qB(r,i);else{let f=n?r[r.length-1]:r[0];for(s=0,o=r.length;s<o;++s)l=r[s],d=BB(f,l,r[Math.min(s+1,o-(n?0:1))%o],e.tension),l.cp1x=d.previous.x,l.cp1y=d.previous.y,l.cp2x=d.next.x,l.cp2y=d.next.y,f=l}e.capBezierPoints&&HB(r,t)}function tw(){return typeof window<"u"&&typeof document<"u"}function nw(r){let e=r.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function gy(r,e,t){let n;return typeof r=="string"?(n=parseInt(r,10),r.indexOf("%")!==-1&&(n=n/100*e.parentNode[t])):n=r,n}const d0=r=>r.ownerDocument.defaultView.getComputedStyle(r,null);function WB(r,e){return d0(r).getPropertyValue(e)}const GB=["top","right","bottom","left"];function nu(r,e,t){const n={};t=t?"-"+t:"";for(let i=0;i<4;i++){const s=GB[i];n[s]=parseFloat(r[e+"-"+s+t])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const KB=(r,e,t)=>(r>0||e>0)&&(!t||!t.shadowRoot);function YB(r,e){const t=r.touches,n=t&&t.length?t[0]:r,{offsetX:i,offsetY:s}=n;let o=!1,l,d;if(KB(i,s,r.target))l=i,d=s;else{const f=e.getBoundingClientRect();l=n.clientX-f.left,d=n.clientY-f.top,o=!0}return{x:l,y:d,box:o}}function $c(r,e){if("native"in r)return r;const{canvas:t,currentDevicePixelRatio:n}=e,i=d0(t),s=i.boxSizing==="border-box",o=nu(i,"padding"),l=nu(i,"border","width"),{x:d,y:f,box:m}=YB(r,t),p=o.left+(m&&l.left),g=o.top+(m&&l.top);let{width:v,height:E}=e;return s&&(v-=o.width+l.width,E-=o.height+l.height),{x:Math.round((d-p)/v*t.width/n),y:Math.round((f-g)/E*t.height/n)}}function ZB(r,e,t){let n,i;if(e===void 0||t===void 0){const s=r&&nw(r);if(!s)e=r.clientWidth,t=r.clientHeight;else{const o=s.getBoundingClientRect(),l=d0(s),d=nu(l,"border","width"),f=nu(l,"padding");e=o.width-f.width-d.width,t=o.height-f.height-d.height,n=gy(l.maxWidth,s,"clientWidth"),i=gy(l.maxHeight,s,"clientHeight")}}return{width:e,height:t,maxWidth:n||my,maxHeight:i||my}}const Hl=r=>Math.round(r*10)/10;function QB(r,e,t,n){const i=d0(r),s=nu(i,"margin"),o=gy(i.maxWidth,r,"clientWidth")||my,l=gy(i.maxHeight,r,"clientHeight")||my,d=ZB(r,e,t);let{width:f,height:m}=d;if(i.boxSizing==="content-box"){const g=nu(i,"border","width"),v=nu(i,"padding");f-=v.width+g.width,m-=v.height+g.height}return f=Math.max(0,f-s.width),m=Math.max(0,n?f/n:m-s.height),f=Hl(Math.min(f,o,d.maxWidth)),m=Hl(Math.min(m,l,d.maxHeight)),f&&!m&&(m=Hl(f/2)),(e!==void 0||t!==void 0)&&n&&d.height&&m>d.height&&(m=d.height,f=Hl(Math.floor(m*n))),{width:f,height:m}}function jA(r,e,t){const n=e||1,i=Hl(r.height*n),s=Hl(r.width*n);r.height=Hl(r.height),r.width=Hl(r.width);const o=r.canvas;return o.style&&(t||!o.style.height&&!o.style.width)&&(o.style.height=`${r.height}px`,o.style.width=`${r.width}px`),r.currentDevicePixelRatio!==n||o.height!==i||o.width!==s?(r.currentDevicePixelRatio=n,o.height=i,o.width=s,r.ctx.setTransform(n,0,0,n,0,0),!0):!1}const XB=function(){let r=!1;try{const e={get passive(){return r=!0,!1}};tw()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return r}();function OA(r,e){const t=WB(r,e),n=t&&t.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function Wc(r,e,t,n){return{x:r.x+t*(e.x-r.x),y:r.y+t*(e.y-r.y)}}function JB(r,e,t,n){return{x:r.x+t*(e.x-r.x),y:n==="middle"?t<.5?r.y:e.y:n==="after"?t<1?r.y:e.y:t>0?e.y:r.y}}function ez(r,e,t,n){const i={x:r.cp2x,y:r.cp2y},s={x:e.cp1x,y:e.cp1y},o=Wc(r,i,t),l=Wc(i,s,t),d=Wc(s,e,t),f=Wc(o,l,t),m=Wc(l,d,t);return Wc(f,m,t)}const tz=function(r,e){return{x(t){return r+r+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,n){return t-n},leftForLtr(t,n){return t-n}}},nz=function(){return{x(r){return r},setWidth(r){},textAlign(r){return r},xPlus(r,e){return r+e},leftForLtr(r,e){return r}}};function Od(r,e,t){return r?tz(e,t):nz()}function Q3(r,e){let t,n;(e==="ltr"||e==="rtl")&&(t=r.canvas.style,n=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),r.prevTextDirection=n)}function X3(r,e){e!==void 0&&(delete r.prevTextDirection,r.canvas.style.setProperty("direction",e[0],e[1]))}function J3(r){return r==="angle"?{between:gm,compare:tB,normalize:oo}:{between:ql,compare:(e,t)=>e-t,normalize:e=>e}}function DA({start:r,end:e,count:t,loop:n,style:i}){return{start:r%t,end:e%t,loop:n&&(e-r+1)%t===0,style:i}}function rz(r,e,t){const{property:n,start:i,end:s}=t,{between:o,normalize:l}=J3(n),d=e.length;let{start:f,end:m,loop:p}=r,g,v;if(p){for(f+=d,m+=d,g=0,v=d;g<v&&o(l(e[f%d][n]),i,s);++g)f--,m--;f%=d,m%=d}return m<f&&(m+=d),{start:f,end:m,loop:p,style:r.style}}function iz(r,e,t){if(!t)return[r];const{property:n,start:i,end:s}=t,o=e.length,{compare:l,between:d,normalize:f}=J3(n),{start:m,end:p,loop:g,style:v}=rz(r,e,t),E=[];let x=!1,b=null,S,N,R;const I=()=>d(i,R,S)&&l(i,R)!==0,j=()=>l(s,S)===0||d(s,R,S),U=()=>x||I(),P=()=>!x||j();for(let k=m,F=m;k<=p;++k)N=e[k%o],!N.skip&&(S=f(N[n]),S!==R&&(x=d(S,i,s),b===null&&U()&&(b=l(S,i)===0?k:F),b!==null&&P()&&(E.push(DA({start:b,end:k,loop:g,count:o,style:v})),b=null),F=k,R=S));return b!==null&&E.push(DA({start:b,end:p,loop:g,count:o,style:v})),E}function sz(r,e){const t=[],n=r.segments;for(let i=0;i<n.length;i++){const s=iz(n[i],r.points,e);s.length&&t.push(...s)}return t}function oz(r,e,t,n){let i=0,s=e-1;if(t&&!n)for(;i<e&&!r[i].skip;)i++;for(;i<e&&r[i].skip;)i++;for(i%=e,t&&(s+=i);s>i&&r[s%e].skip;)s--;return s%=e,{start:i,end:s}}function az(r,e,t,n){const i=r.length,s=[];let o=e,l=r[e],d;for(d=e+1;d<=t;++d){const f=r[d%i];f.skip||f.stop?l.skip||(n=!1,s.push({start:e%i,end:(d-1)%i,loop:n}),e=o=f.stop?d:null):(o=d,l.skip&&(e=d)),l=f}return o!==null&&s.push({start:e%i,end:o%i,loop:n}),s}function lz(r,e){const t=r.points,n=r.options.spanGaps,i=t.length;if(!i)return[];const s=!!r._loop,{start:o,end:l}=oz(t,i,s,n);if(n===!0)return MA(r,[{start:o,end:l,loop:s}],t,e);const d=l<o?l+i:l,f=!!r._fullLoop&&o===0&&l===i-1;return MA(r,az(t,o,d,f),t,e)}function MA(r,e,t,n){return!n||!n.setContext||!t?e:cz(r,e,t,n)}function cz(r,e,t,n){const i=r._chart.getContext(),s=LA(r.options),{_datasetIndex:o,options:{spanGaps:l}}=r,d=t.length,f=[];let m=s,p=e[0].start,g=p;function v(E,x,b,S){const N=l?-1:1;if(E!==x){for(E+=d;t[E%d].skip;)E-=N;for(;t[x%d].skip;)x+=N;E%d!==x%d&&(f.push({start:E%d,end:x%d,loop:b,style:S}),m=S,p=x%d)}}for(const E of e){p=l?p:E.start;let x=t[p%d],b;for(g=p+1;g<=E.end;g++){const S=t[g%d];b=LA(n.setContext(Ru(i,{type:"segment",p0:x,p1:S,p0DataIndex:(g-1)%d,p1DataIndex:g%d,datasetIndex:o}))),uz(b,m)&&v(p,g-1,E.loop,m),x=S,m=b}p<g-1&&v(p,g-1,E.loop,m)}return f}function LA(r){return{backgroundColor:r.backgroundColor,borderCapStyle:r.borderCapStyle,borderDash:r.borderDash,borderDashOffset:r.borderDashOffset,borderJoinStyle:r.borderJoinStyle,borderWidth:r.borderWidth,borderColor:r.borderColor}}function uz(r,e){if(!e)return!1;const t=[],n=function(i,s){return G2(s)?(t.includes(s)||t.push(s),t.indexOf(s)):s};return JSON.stringify(r,n)!==JSON.stringify(e,n)}function tg(r,e,t){return r.options.clip?r[t]:e[t]}function dz(r,e){const{xScale:t,yScale:n}=r;return t&&n?{left:tg(t,e,"left"),right:tg(t,e,"right"),top:tg(n,e,"top"),bottom:tg(n,e,"bottom")}:e}function hz(r,e){const t=e._clip;if(t.disabled)return!1;const n=dz(e,r.chartArea);return{left:t.left===!1?0:n.left-(t.left===!0?0:t.left),right:t.right===!1?r.width:n.right+(t.right===!0?0:t.right),top:t.top===!1?0:n.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?r.height:n.bottom+(t.bottom===!0?0:t.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class fz{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,n,i){const s=t.listeners[i],o=t.duration;s.forEach(l=>l({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(n-t.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=z3.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((n,i)=>{if(!n.running||!n.items.length)return;const s=n.items;let o=s.length-1,l=!1,d;for(;o>=0;--o)d=s[o],d._active?(d._total>n.duration&&(n.duration=d._total),d.tick(e),l=!0):(s[o]=s[s.length-1],s.pop());l&&(i.draw(),this._notify(i,n,e,"progress")),s.length||(n.running=!1,this._notify(i,n,e,"complete"),n.initial=!1),t+=s.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}listen(e,t,n){this._getAnims(e).listeners[t].push(n)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((n,i)=>Math.max(n,i._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const n=t.items;let i=n.length-1;for(;i>=0;--i)n[i].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var ya=new fz;const FA="transparent",mz={boolean(r,e,t){return t>.5?e:r},color(r,e,t){const n=NA(r||FA),i=n.valid&&NA(e||FA);return i&&i.valid?i.mix(n,t).hexString():e},number(r,e,t){return r+(e-r)*t}};class pz{constructor(e,t,n,i){const s=t[n];i=Jp([e.to,i,s,e.from]);const o=Jp([e.from,s,i]);this._active=!0,this._fn=e.fn||mz[e.type||typeof o],this._easing=Bf[e.easing]||Bf.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=n,this._from=o,this._to=i,this._promises=void 0}active(){return this._active}update(e,t,n){if(this._active){this._notify(!1);const i=this._target[this._prop],s=n-this._start,o=this._duration-s;this._start=n,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=Jp([e.to,t,i,e.from]),this._from=Jp([e.from,i,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,n=this._duration,i=this._prop,s=this._from,o=this._loop,l=this._to;let d;if(this._active=s!==l&&(o||t<n),!this._active){this._target[i]=l,this._notify(!0);return}if(t<0){this._target[i]=s;return}d=t/n%2,d=o&&d>1?2-d:d,d=this._easing(Math.min(1,Math.max(0,d))),this._target[i]=this._fn(s,l,d)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,n)=>{e.push({res:t,rej:n})})}_notify(e){const t=e?"res":"rej",n=this._promises||[];for(let i=0;i<n.length;i++)n[i][t]()}}class eR{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!en(e))return;const t=Object.keys(Xn.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach(i=>{const s=e[i];if(!en(s))return;const o={};for(const l of t)o[l]=s[l];(fr(s.properties)&&s.properties||[i]).forEach(l=>{(l===i||!n.has(l))&&n.set(l,o)})})}_animateOptions(e,t){const n=t.options,i=yz(e,n);if(!i)return[];const s=this._createAnimations(i,n);return n.$shared&&gz(e.options.$animations,n).then(()=>{e.options=n},()=>{}),s}_createAnimations(e,t){const n=this._properties,i=[],s=e.$animations||(e.$animations={}),o=Object.keys(t),l=Date.now();let d;for(d=o.length-1;d>=0;--d){const f=o[d];if(f.charAt(0)==="$")continue;if(f==="options"){i.push(...this._animateOptions(e,t));continue}const m=t[f];let p=s[f];const g=n.get(f);if(p)if(g&&p.active()){p.update(g,m,l);continue}else p.cancel();if(!g||!g.duration){e[f]=m;continue}s[f]=p=new pz(g,e,f,m),i.push(p)}return i}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const n=this._createAnimations(e,t);if(n.length)return ya.add(this._chart,n),!0}}function gz(r,e){const t=[],n=Object.keys(e);for(let i=0;i<n.length;i++){const s=r[n[i]];s&&s.active()&&t.push(s.wait())}return Promise.all(t)}function yz(r,e){if(!e)return;let t=r.options;if(!t){r.options=e;return}return t.$shared&&(r.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function VA(r,e){const t=r&&r.options||{},n=t.reverse,i=t.min===void 0?e:0,s=t.max===void 0?e:0;return{start:n?s:i,end:n?i:s}}function vz(r,e,t){if(t===!1)return!1;const n=VA(r,t),i=VA(e,t);return{top:i.end,right:n.end,bottom:i.start,left:n.start}}function _z(r){let e,t,n,i;return en(r)?(e=r.top,t=r.right,n=r.bottom,i=r.left):e=t=n=i=r,{top:e,right:t,bottom:n,left:i,disabled:r===!1}}function tR(r,e){const t=[],n=r._getSortedDatasetMetas(e);let i,s;for(i=0,s=n.length;i<s;++i)t.push(n[i].index);return t}function BA(r,e,t,n={}){const i=r.keys,s=n.mode==="single";let o,l,d,f;if(e===null)return;let m=!1;for(o=0,l=i.length;o<l;++o){if(d=+i[o],d===t){if(m=!0,n.all)continue;break}f=r.values[d],Ls(f)&&(s||e===0||Mo(e)===Mo(f))&&(e+=f)}return!m&&!n.all?0:e}function xz(r,e){const{iScale:t,vScale:n}=e,i=t.axis==="x"?"x":"y",s=n.axis==="x"?"x":"y",o=Object.keys(r),l=new Array(o.length);let d,f,m;for(d=0,f=o.length;d<f;++d)m=o[d],l[d]={[i]:m,[s]:r[m]};return l}function l1(r,e){const t=r&&r.options.stacked;return t||t===void 0&&e.stack!==void 0}function bz(r,e,t){return`${r.id}.${e.id}.${t.stack||t.type}`}function wz(r){const{min:e,max:t,minDefined:n,maxDefined:i}=r.getUserBounds();return{min:n?e:Number.NEGATIVE_INFINITY,max:i?t:Number.POSITIVE_INFINITY}}function Ez(r,e,t){const n=r[e]||(r[e]={});return n[t]||(n[t]={})}function zA(r,e,t,n){for(const i of e.getMatchingVisibleMetas(n).reverse()){const s=r[i.index];if(t&&s>0||!t&&s<0)return i.index}return null}function UA(r,e){const{chart:t,_cachedMeta:n}=r,i=t._stacks||(t._stacks={}),{iScale:s,vScale:o,index:l}=n,d=s.axis,f=o.axis,m=bz(s,o,n),p=e.length;let g;for(let v=0;v<p;++v){const E=e[v],{[d]:x,[f]:b}=E,S=E._stacks||(E._stacks={});g=S[f]=Ez(i,m,x),g[l]=b,g._top=zA(g,o,!0,n.type),g._bottom=zA(g,o,!1,n.type);const N=g._visualValues||(g._visualValues={});N[l]=b}}function c1(r,e){const t=r.scales;return Object.keys(t).filter(n=>t[n].axis===e).shift()}function Sz(r,e){return Ru(r,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function Tz(r,e,t){return Ru(r,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function rf(r,e){const t=r.controller.index,n=r.vScale&&r.vScale.axis;if(n){e=e||r._parsed;for(const i of e){const s=i._stacks;if(!s||s[n]===void 0||s[n][t]===void 0)return;delete s[n][t],s[n]._visualValues!==void 0&&s[n]._visualValues[t]!==void 0&&delete s[n]._visualValues[t]}}}const u1=r=>r==="reset"||r==="none",qA=(r,e)=>e?r:Object.assign({},r),Az=(r,e,t)=>r&&!e.hidden&&e._stacked&&{keys:tR(t,!0),values:null};class ru{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=l1(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&rf(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,n=this.getDataset(),i=(p,g,v,E)=>p==="x"?g:p==="r"?E:v,s=t.xAxisID=Bt(n.xAxisID,c1(e,"x")),o=t.yAxisID=Bt(n.yAxisID,c1(e,"y")),l=t.rAxisID=Bt(n.rAxisID,c1(e,"r")),d=t.indexAxis,f=t.iAxisID=i(d,s,o,l),m=t.vAxisID=i(d,o,s,l);t.xScale=this.getScaleForId(s),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(l),t.iScale=this.getScaleForId(f),t.vScale=this.getScaleForId(m)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&SA(this._data,this),e._stacked&&rf(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),n=this._data;if(en(t)){const i=this._cachedMeta;this._data=xz(t,i)}else if(n!==t){if(n){SA(n,this);const i=this._cachedMeta;rf(i),i._parsed=[]}t&&Object.isExtensible(t)&&sB(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,n=this.getDataset();let i=!1;this._dataCheck();const s=t._stacked;t._stacked=l1(t.vScale,t),t.stack!==n.stack&&(i=!0,rf(t),t.stack=n.stack),this._resyncElements(e),(i||s!==t._stacked)&&(UA(this,t._parsed),t._stacked=l1(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:n,_data:i}=this,{iScale:s,_stacked:o}=n,l=s.axis;let d=e===0&&t===i.length?!0:n._sorted,f=e>0&&n._parsed[e-1],m,p,g;if(this._parsing===!1)n._parsed=i,n._sorted=!0,g=i;else{fr(i[e])?g=this.parseArrayData(n,i,e,t):en(i[e])?g=this.parseObjectData(n,i,e,t):g=this.parsePrimitiveData(n,i,e,t);const v=()=>p[l]===null||f&&p[l]<f[l];for(m=0;m<t;++m)n._parsed[m+e]=p=g[m],d&&(v()&&(d=!1),f=p);n._sorted=d}o&&UA(this,g)}parsePrimitiveData(e,t,n,i){const{iScale:s,vScale:o}=e,l=s.axis,d=o.axis,f=s.getLabels(),m=s===o,p=new Array(i);let g,v,E;for(g=0,v=i;g<v;++g)E=g+n,p[g]={[l]:m||s.parse(f[E],E),[d]:o.parse(t[E],E)};return p}parseArrayData(e,t,n,i){const{xScale:s,yScale:o}=e,l=new Array(i);let d,f,m,p;for(d=0,f=i;d<f;++d)m=d+n,p=t[m],l[d]={x:s.parse(p[0],m),y:o.parse(p[1],m)};return l}parseObjectData(e,t,n,i){const{xScale:s,yScale:o}=e,{xAxisKey:l="x",yAxisKey:d="y"}=this._parsing,f=new Array(i);let m,p,g,v;for(m=0,p=i;m<p;++m)g=m+n,v=t[g],f[m]={x:s.parse(wu(v,l),g),y:o.parse(wu(v,d),g)};return f}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,n){const i=this.chart,s=this._cachedMeta,o=t[e.axis],l={keys:tR(i,!0),values:t._stacks[e.axis]._visualValues};return BA(l,o,s.index,{mode:n})}updateRangeFromParsed(e,t,n,i){const s=n[t.axis];let o=s===null?NaN:s;const l=i&&n._stacks[t.axis];i&&l&&(i.values=l,o=BA(i,s,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const n=this._cachedMeta,i=n._parsed,s=n._sorted&&e===n.iScale,o=i.length,l=this._getOtherScale(e),d=Az(t,n,this.chart),f={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:m,max:p}=wz(l);let g,v;function E(){v=i[g];const x=v[l.axis];return!Ls(v[e.axis])||m>x||p<x}for(g=0;g<o&&!(!E()&&(this.updateRangeFromParsed(f,e,v,d),s));++g);if(s){for(g=o-1;g>=0;--g)if(!E()){this.updateRangeFromParsed(f,e,v,d);break}}return f}getAllParsedValues(e){const t=this._cachedMeta._parsed,n=[];let i,s,o;for(i=0,s=t.length;i<s;++i)o=t[i][e.axis],Ls(o)&&n.push(o);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,n=t.iScale,i=t.vScale,s=this.getParsed(e);return{label:n?""+n.getLabelForValue(s[n.axis]):"",value:i?""+i.getLabelForValue(s[i.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=_z(Bt(this.options.clip,vz(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,n=this._cachedMeta,i=n.data||[],s=t.chartArea,o=[],l=this._drawStart||0,d=this._drawCount||i.length-l,f=this.options.drawActiveElementsOnTop;let m;for(n.dataset&&n.dataset.draw(e,s,l,d),m=l;m<l+d;++m){const p=i[m];p.hidden||(p.active&&f?o.push(p):p.draw(e,s))}for(m=0;m<o.length;++m)o[m].draw(e,s)}getStyle(e,t){const n=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,t,n){const i=this.getDataset();let s;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];s=o.$context||(o.$context=Tz(this.getContext(),e,o)),s.parsed=this.getParsed(e),s.raw=i.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=Sz(this.chart.getContext(),this.index)),s.dataset=i,s.index=s.datasetIndex=this.index;return s.active=!!t,s.mode=n,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",n){const i=t==="active",s=this._cachedDataOpts,o=e+"-"+t,l=s[o],d=this.enableOptionSharing&&mm(n);if(l)return qA(l,d);const f=this.chart.config,m=f.datasetElementScopeKeys(this._type,e),p=i?[`${e}Hover`,"hover",e,""]:[e,""],g=f.getOptionScopes(this.getDataset(),m),v=Object.keys(Xn.elements[e]),E=()=>this.getContext(n,i,t),x=f.resolveNamedOptions(g,v,E,p);return x.$shared&&(x.$shared=d,s[o]=Object.freeze(qA(x,d))),x}_resolveAnimations(e,t,n){const i=this.chart,s=this._cachedDataOpts,o=`animation-${t}`,l=s[o];if(l)return l;let d;if(i.options.animation!==!1){const m=this.chart.config,p=m.datasetAnimationScopeKeys(this._type,t),g=m.getOptionScopes(this.getDataset(),p);d=m.createResolver(g,this.getContext(e,n,t))}const f=new eR(i,d&&d.animations);return d&&d._cacheable&&(s[o]=Object.freeze(f)),f}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||u1(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const n=this.resolveDataElementOptions(e,t),i=this._sharedOptions,s=this.getSharedOptions(n),o=this.includeOptions(t,s)||s!==i;return this.updateSharedOptions(s,t,n),{sharedOptions:s,includeOptions:o}}updateElement(e,t,n,i){u1(i)?Object.assign(e,n):this._resolveAnimations(t,i).update(e,n)}updateSharedOptions(e,t,n){e&&!u1(t)&&this._resolveAnimations(void 0,t).update(e,n)}_setStyle(e,t,n,i){e.active=i;const s=this.getStyle(t,i);this._resolveAnimations(t,n,i).update(e,{options:!i&&this.getSharedOptions(s)||s})}removeHoverStyle(e,t,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,t,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,n=this._cachedMeta.data;for(const[l,d,f]of this._syncList)this[l](d,f);this._syncList=[];const i=n.length,s=t.length,o=Math.min(s,i);o&&this.parse(0,o),s>i?this._insertElements(i,s-i,e):s<i&&this._removeElements(s,i-s)}_insertElements(e,t,n=!0){const i=this._cachedMeta,s=i.data,o=e+t;let l;const d=f=>{for(f.length+=t,l=f.length-1;l>=o;l--)f[l]=f[l-t]};for(d(s),l=e;l<o;++l)s[l]=new this.dataElementType;this._parsing&&d(i._parsed),this.parse(e,t),n&&this.updateElements(s,e,t,"reset")}updateElements(e,t,n,i){}_removeElements(e,t){const n=this._cachedMeta;if(this._parsing){const i=n._parsed.splice(e,t);n._stacked&&rf(n,i)}n.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,n,i]=e;this[t](n,i)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}nt(ru,"defaults",{}),nt(ru,"datasetElementType",null),nt(ru,"dataElementType",null);function Nz(r,e){if(!r._cache.$bar){const t=r.getMatchingVisibleMetas(e);let n=[];for(let i=0,s=t.length;i<s;i++)n=n.concat(t[i].controller.getAllParsedValues(r));r._cache.$bar=B3(n.sort((i,s)=>i-s))}return r._cache.$bar}function Iz(r){const e=r.iScale,t=Nz(e,r.type);let n=e._length,i,s,o,l;const d=()=>{o===32767||o===-32768||(mm(l)&&(n=Math.min(n,Math.abs(o-l)||n)),l=o)};for(i=0,s=t.length;i<s;++i)o=e.getPixelForValue(t[i]),d();for(l=void 0,i=0,s=e.ticks.length;i<s;++i)o=e.getPixelForTick(i),d();return n}function Pz(r,e,t,n){const i=t.barThickness;let s,o;return an(i)?(s=e.min*t.categoryPercentage,o=t.barPercentage):(s=i*n,o=1),{chunk:s/n,ratio:o,start:e.pixels[r]-s/2}}function kz(r,e,t,n){const i=e.pixels,s=i[r];let o=r>0?i[r-1]:null,l=r<i.length-1?i[r+1]:null;const d=t.categoryPercentage;o===null&&(o=s-(l===null?e.end-e.start:l-s)),l===null&&(l=s+s-o);const f=s-(s-Math.min(o,l))/2*d;return{chunk:Math.abs(l-o)/2*d/n,ratio:t.barPercentage,start:f}}function Cz(r,e,t,n){const i=t.parse(r[0],n),s=t.parse(r[1],n),o=Math.min(i,s),l=Math.max(i,s);let d=o,f=l;Math.abs(o)>Math.abs(l)&&(d=l,f=o),e[t.axis]=f,e._custom={barStart:d,barEnd:f,start:i,end:s,min:o,max:l}}function nR(r,e,t,n){return fr(r)?Cz(r,e,t,n):e[t.axis]=t.parse(r,n),e}function HA(r,e,t,n){const i=r.iScale,s=r.vScale,o=i.getLabels(),l=i===s,d=[];let f,m,p,g;for(f=t,m=t+n;f<m;++f)g=e[f],p={},p[i.axis]=l||i.parse(o[f],f),d.push(nR(g,p,s,f));return d}function d1(r){return r&&r.barStart!==void 0&&r.barEnd!==void 0}function Rz(r,e,t){return r!==0?Mo(r):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function jz(r){let e,t,n,i,s;return r.horizontal?(e=r.base>r.x,t="left",n="right"):(e=r.base<r.y,t="bottom",n="top"),e?(i="end",s="start"):(i="start",s="end"),{start:t,end:n,reverse:e,top:i,bottom:s}}function Oz(r,e,t,n){let i=e.borderSkipped;const s={};if(!i){r.borderSkipped=s;return}if(i===!0){r.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:l,reverse:d,top:f,bottom:m}=jz(r);i==="middle"&&t&&(r.enableBorderRadius=!0,(t._top||0)===n?i=f:(t._bottom||0)===n?i=m:(s[$A(m,o,l,d)]=!0,i=f)),s[$A(i,o,l,d)]=!0,r.borderSkipped=s}function $A(r,e,t,n){return n?(r=Dz(r,e,t),r=WA(r,t,e)):r=WA(r,e,t),r}function Dz(r,e,t){return r===e?t:r===t?e:r}function WA(r,e,t){return r==="start"?e:r==="end"?t:r}function Mz(r,{inflateAmount:e},t){r.inflateAmount=e==="auto"?t===1?.33:0:e}class Pg extends ru{parsePrimitiveData(e,t,n,i){return HA(e,t,n,i)}parseArrayData(e,t,n,i){return HA(e,t,n,i)}parseObjectData(e,t,n,i){const{iScale:s,vScale:o}=e,{xAxisKey:l="x",yAxisKey:d="y"}=this._parsing,f=s.axis==="x"?l:d,m=o.axis==="x"?l:d,p=[];let g,v,E,x;for(g=n,v=n+i;g<v;++g)x=t[g],E={},E[s.axis]=s.parse(wu(x,f),g),p.push(nR(wu(x,m),E,o,g));return p}updateRangeFromParsed(e,t,n,i){super.updateRangeFromParsed(e,t,n,i);const s=n._custom;s&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,s.min),e.max=Math.max(e.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:n,vScale:i}=t,s=this.getParsed(e),o=s._custom,l=d1(o)?"["+o.start+", "+o.end+"]":""+i.getLabelForValue(s[i.axis]);return{label:""+n.getLabelForValue(s[n.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,n,i){const s=i==="reset",{index:o,_cachedMeta:{vScale:l}}=this,d=l.getBasePixel(),f=l.isHorizontal(),m=this._getRuler(),{sharedOptions:p,includeOptions:g}=this._getSharedOptions(t,i);for(let v=t;v<t+n;v++){const E=this.getParsed(v),x=s||an(E[l.axis])?{base:d,head:d}:this._calculateBarValuePixels(v),b=this._calculateBarIndexPixels(v,m),S=(E._stacks||{})[l.axis],N={horizontal:f,base:x.base,enableBorderRadius:!S||d1(E._custom)||o===S._top||o===S._bottom,x:f?x.head:b.center,y:f?b.center:x.head,height:f?b.size:Math.abs(x.size),width:f?Math.abs(x.size):b.size};g&&(N.options=p||this.resolveDataElementOptions(v,e[v].active?"active":i));const R=N.options||e[v].options;Oz(N,R,S,o),Mz(N,R,m.ratio),this.updateElement(e[v],v,N,i)}}_getStacks(e,t){const{iScale:n}=this._cachedMeta,i=n.getMatchingVisibleMetas(this._type).filter(m=>m.controller.options.grouped),s=n.options.stacked,o=[],l=this._cachedMeta.controller.getParsed(t),d=l&&l[n.axis],f=m=>{const p=m._parsed.find(v=>v[n.axis]===d),g=p&&p[m.vScale.axis];if(an(g)||isNaN(g))return!0};for(const m of i)if(!(t!==void 0&&f(m))&&((s===!1||o.indexOf(m.stack)===-1||s===void 0&&m.stack===void 0)&&o.push(m.stack),m.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(n=>e[n].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const n of this.chart.data.datasets)e[Bt(this.chart.options.indexAxis==="x"?n.xAxisID:n.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,n){const i=this._getStacks(e,n),s=t!==void 0?i.indexOf(t):-1;return s===-1?i.length-1:s}_getRuler(){const e=this.options,t=this._cachedMeta,n=t.iScale,i=[];let s,o;for(s=0,o=t.data.length;s<o;++s)i.push(n.getPixelForValue(this.getParsed(s)[n.axis],s));const l=e.barThickness;return{min:l||Iz(t),pixels:i,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:e.grouped,ratio:l?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:n,index:i},options:{base:s,minBarLength:o}}=this,l=s||0,d=this.getParsed(e),f=d._custom,m=d1(f);let p=d[t.axis],g=0,v=n?this.applyStack(t,d,n):p,E,x;v!==p&&(g=v-p,v=p),m&&(p=f.barStart,v=f.barEnd-f.barStart,p!==0&&Mo(p)!==Mo(f.barEnd)&&(g=0),g+=p);const b=!an(s)&&!m?s:g;let S=t.getPixelForValue(b);if(this.chart.getDataVisibility(e)?E=t.getPixelForValue(g+v):E=S,x=E-S,Math.abs(x)<o){x=Rz(x,t,l)*o,p===l&&(S-=x/2);const N=t.getPixelForDecimal(0),R=t.getPixelForDecimal(1),I=Math.min(N,R),j=Math.max(N,R);S=Math.max(Math.min(S,j),I),E=S+x,n&&!m&&(d._stacks[t.axis]._visualValues[i]=t.getValueForPixel(E)-t.getValueForPixel(S))}if(S===t.getPixelForValue(l)){const N=Mo(x)*t.getLineWidthForValue(l)/2;S+=N,x-=N}return{size:x,base:S,head:E,center:E+x/2}}_calculateBarIndexPixels(e,t){const n=t.scale,i=this.options,s=i.skipNull,o=Bt(i.maxBarThickness,1/0);let l,d;const f=this._getAxisCount();if(t.grouped){const m=s?this._getStackCount(e):t.stackCount,p=i.barThickness==="flex"?kz(e,t,i,m*f):Pz(e,t,i,m*f),g=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,v=this._getAxis().indexOf(Bt(g,this.getFirstScaleIdForIndexAxis())),E=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0)+v;l=p.start+p.chunk*E+p.chunk/2,d=Math.min(o,p.chunk*p.ratio)}else l=n.getPixelForValue(this.getParsed(e)[n.axis],e),d=Math.min(o,t.min*t.ratio);return{base:l-d/2,head:l+d/2,center:l,size:d}}draw(){const e=this._cachedMeta,t=e.vScale,n=e.data,i=n.length;let s=0;for(;s<i;++s)this.getParsed(s)[t.axis]!==null&&!n[s].hidden&&n[s].draw(this._ctx)}}nt(Pg,"id","bar"),nt(Pg,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),nt(Pg,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function Lz(r,e,t){let n=1,i=1,s=0,o=0;if(e<Wn){const l=r,d=l+e,f=Math.cos(l),m=Math.sin(l),p=Math.cos(d),g=Math.sin(d),v=(R,I,j)=>gm(R,l,d,!0)?1:Math.max(I,I*t,j,j*t),E=(R,I,j)=>gm(R,l,d,!0)?-1:Math.min(I,I*t,j,j*t),x=v(0,f,p),b=v(mr,m,g),S=E(mn,f,p),N=E(mn+mr,m,g);n=(x-S)/2,i=(b-N)/2,s=-(x+S)/2,o=-(b+N)/2}return{ratioX:n,ratioY:i,offsetX:s,offsetY:o}}class Td extends ru{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const n=this.getDataset().data,i=this._cachedMeta;if(this._parsing===!1)i._parsed=n;else{let s=d=>+n[d];if(en(n[e])){const{key:d="value"}=this._parsing;s=f=>+wu(n[f],d)}let o,l;for(o=e,l=e+t;o<l;++o)i._parsed[o]=s(o)}}_getRotation(){return Ta(this.options.rotation-90)}_getCircumference(){return Ta(this.options.circumference)}_getRotationExtents(){let e=Wn,t=-Wn;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const i=this.chart.getDatasetMeta(n).controller,s=i._getRotation(),o=i._getCircumference();e=Math.min(e,s),t=Math.max(t,s+o)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:n}=t,i=this._cachedMeta,s=i.data,o=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,l=Math.max((Math.min(n.width,n.height)-o)/2,0),d=Math.min(UV(this.options.cutout,l),1),f=this._getRingWeight(this.index),{circumference:m,rotation:p}=this._getRotationExtents(),{ratioX:g,ratioY:v,offsetX:E,offsetY:x}=Lz(p,m,d),b=(n.width-o)/g,S=(n.height-o)/v,N=Math.max(Math.min(b,S)/2,0),R=D3(this.options.radius,N),I=Math.max(R*d,0),j=(R-I)/this._getVisibleDatasetWeightTotal();this.offsetX=E*R,this.offsetY=x*R,i.total=this.calculateTotal(),this.outerRadius=R-j*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-j*f,0),this.updateElements(s,0,s.length,e)}_circumference(e,t){const n=this.options,i=this._cachedMeta,s=this._getCircumference();return t&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||i._parsed[e]===null||i.data[e].hidden?0:this.calculateCircumference(i._parsed[e]*s/Wn)}updateElements(e,t,n,i){const s=i==="reset",o=this.chart,l=o.chartArea,f=o.options.animation,m=(l.left+l.right)/2,p=(l.top+l.bottom)/2,g=s&&f.animateScale,v=g?0:this.innerRadius,E=g?0:this.outerRadius,{sharedOptions:x,includeOptions:b}=this._getSharedOptions(t,i);let S=this._getRotation(),N;for(N=0;N<t;++N)S+=this._circumference(N,s);for(N=t;N<t+n;++N){const R=this._circumference(N,s),I=e[N],j={x:m+this.offsetX,y:p+this.offsetY,startAngle:S,endAngle:S+R,circumference:R,outerRadius:E,innerRadius:v};b&&(j.options=x||this.resolveDataElementOptions(N,I.active?"active":i)),S+=R,this.updateElement(I,N,j,i)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let n=0,i;for(i=0;i<t.length;i++){const s=e._parsed[i];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(i)&&!t[i].hidden&&(n+=Math.abs(s))}return n}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?Wn*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,i=n.data.labels||[],s=K2(t._parsed[e],n.options.locale);return{label:i[e]||"",value:s}}getMaxBorderWidth(e){let t=0;const n=this.chart;let i,s,o,l,d;if(!e){for(i=0,s=n.data.datasets.length;i<s;++i)if(n.isDatasetVisible(i)){o=n.getDatasetMeta(i),e=o.data,l=o.controller;break}}if(!e)return 0;for(i=0,s=e.length;i<s;++i)d=l.resolveDataElementOptions(i),d.borderAlign!=="inner"&&(t=Math.max(t,d.borderWidth||0,d.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let n=0,i=e.length;n<i;++n){const s=this.resolveDataElementOptions(n);t=Math.max(t,s.offset||0,s.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t}_getRingWeight(e){return Math.max(Bt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}nt(Td,"id","doughnut"),nt(Td,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),nt(Td,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),nt(Td,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data,{labels:{pointStyle:n,textAlign:i,color:s,useBorderRadius:o,borderRadius:l}}=e.legend.options;return t.labels.length&&t.datasets.length?t.labels.map((d,f)=>{const p=e.getDatasetMeta(0).controller.getStyle(f);return{text:d,fillStyle:p.backgroundColor,fontColor:s,hidden:!e.getDataVisibility(f),lineDash:p.borderDash,lineDashOffset:p.borderDashOffset,lineJoin:p.borderJoinStyle,lineWidth:p.borderWidth,strokeStyle:p.borderColor,textAlign:i,pointStyle:n,borderRadius:o&&(l||p.borderRadius),index:f}}):[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}}});class kg extends ru{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:n,data:i=[],_dataset:s}=t,o=this.chart._animationsDisabled;let{start:l,count:d}=lB(t,i,o);this._drawStart=l,this._drawCount=d,cB(t)&&(l=0,d=i.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!s._decimated,n.points=i;const f=this.resolveDatasetElementOptions(e);this.options.showLine||(f.borderWidth=0),f.segment=this.options.segment,this.updateElement(n,void 0,{animated:!o,options:f},e),this.updateElements(i,l,d,e)}updateElements(e,t,n,i){const s=i==="reset",{iScale:o,vScale:l,_stacked:d,_dataset:f}=this._cachedMeta,{sharedOptions:m,includeOptions:p}=this._getSharedOptions(t,i),g=o.axis,v=l.axis,{spanGaps:E,segment:x}=this.options,b=pm(E)?E:Number.POSITIVE_INFINITY,S=this.chart._animationsDisabled||s||i==="none",N=t+n,R=e.length;let I=t>0&&this.getParsed(t-1);for(let j=0;j<R;++j){const U=e[j],P=S?U:{};if(j<t||j>=N){P.skip=!0;continue}const k=this.getParsed(j),F=an(k[v]),O=P[g]=o.getPixelForValue(k[g],j),C=P[v]=s||F?l.getBasePixel():l.getPixelForValue(d?this.applyStack(l,k,d):k[v],j);P.skip=isNaN(O)||isNaN(C)||F,P.stop=j>0&&Math.abs(k[g]-I[g])>b,x&&(P.parsed=k,P.raw=f.data[j]),p&&(P.options=m||this.resolveDataElementOptions(j,U.active?"active":i)),S||this.updateElement(U,j,P,i),I=k}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,n=t.options&&t.options.borderWidth||0,i=e.data||[];if(!i.length)return n;const s=i[0].size(this.resolveDataElementOptions(0)),o=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(n,s,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}nt(kg,"id","line"),nt(kg,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),nt(kg,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class Kx extends Td{}nt(Kx,"id","pie"),nt(Kx,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});function zc(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class rw{constructor(e){nt(this,"options");this.options=e||{}}static override(e){Object.assign(rw.prototype,e)}init(){}formats(){return zc()}parse(){return zc()}format(){return zc()}add(){return zc()}diff(){return zc()}startOf(){return zc()}endOf(){return zc()}}var Fz={_date:rw};function Vz(r,e,t,n){const{controller:i,data:s,_sorted:o}=r,l=i._cachedMeta.iScale,d=r.dataset&&r.dataset.options?r.dataset.options.spanGaps:null;if(l&&e===l.axis&&e!=="r"&&o&&s.length){const f=l._reversePixels?rB:Jc;if(n){if(i._sharedOptions){const m=s[0],p=typeof m.getRange=="function"&&m.getRange(e);if(p){const g=f(s,e,t-p),v=f(s,e,t+p);return{lo:g.lo,hi:v.hi}}}}else{const m=f(s,e,t);if(d){const{vScale:p}=i._cachedMeta,{_parsed:g}=r,v=g.slice(0,m.lo+1).reverse().findIndex(x=>!an(x[p.axis]));m.lo-=Math.max(0,v);const E=g.slice(m.hi).findIndex(x=>!an(x[p.axis]));m.hi+=Math.max(0,E)}return m}}return{lo:0,hi:s.length-1}}function h0(r,e,t,n,i){const s=r.getSortedVisibleDatasetMetas(),o=t[e];for(let l=0,d=s.length;l<d;++l){const{index:f,data:m}=s[l],{lo:p,hi:g}=Vz(s[l],e,o,i);for(let v=p;v<=g;++v){const E=m[v];E.skip||n(E,f,v)}}}function Bz(r){const e=r.indexOf("x")!==-1,t=r.indexOf("y")!==-1;return function(n,i){const s=e?Math.abs(n.x-i.x):0,o=t?Math.abs(n.y-i.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(o,2))}}function h1(r,e,t,n,i){const s=[];return!i&&!r.isPointInArea(e)||h0(r,t,e,function(l,d,f){!i&&!ym(l,r.chartArea,0)||l.inRange(e.x,e.y,n)&&s.push({element:l,datasetIndex:d,index:f})},!0),s}function zz(r,e,t,n){let i=[];function s(o,l,d){const{startAngle:f,endAngle:m}=o.getProps(["startAngle","endAngle"],n),{angle:p}=F3(o,{x:e.x,y:e.y});gm(p,f,m)&&i.push({element:o,datasetIndex:l,index:d})}return h0(r,t,e,s),i}function Uz(r,e,t,n,i,s){let o=[];const l=Bz(t);let d=Number.POSITIVE_INFINITY;function f(m,p,g){const v=m.inRange(e.x,e.y,i);if(n&&!v)return;const E=m.getCenterPoint(i);if(!(!!s||r.isPointInArea(E))&&!v)return;const b=l(e,E);b<d?(o=[{element:m,datasetIndex:p,index:g}],d=b):b===d&&o.push({element:m,datasetIndex:p,index:g})}return h0(r,t,e,f),o}function f1(r,e,t,n,i,s){return!s&&!r.isPointInArea(e)?[]:t==="r"&&!n?zz(r,e,t,i):Uz(r,e,t,n,i,s)}function GA(r,e,t,n,i){const s=[],o=t==="x"?"inXRange":"inYRange";let l=!1;return h0(r,t,e,(d,f,m)=>{d[o]&&d[o](e[t],i)&&(s.push({element:d,datasetIndex:f,index:m}),l=l||d.inRange(e.x,e.y,i))}),n&&!l?[]:s}var qz={modes:{index(r,e,t,n){const i=$c(e,r),s=t.axis||"x",o=t.includeInvisible||!1,l=t.intersect?h1(r,i,s,n,o):f1(r,i,s,!1,n,o),d=[];return l.length?(r.getSortedVisibleDatasetMetas().forEach(f=>{const m=l[0].index,p=f.data[m];p&&!p.skip&&d.push({element:p,datasetIndex:f.index,index:m})}),d):[]},dataset(r,e,t,n){const i=$c(e,r),s=t.axis||"xy",o=t.includeInvisible||!1;let l=t.intersect?h1(r,i,s,n,o):f1(r,i,s,!1,n,o);if(l.length>0){const d=l[0].datasetIndex,f=r.getDatasetMeta(d).data;l=[];for(let m=0;m<f.length;++m)l.push({element:f[m],datasetIndex:d,index:m})}return l},point(r,e,t,n){const i=$c(e,r),s=t.axis||"xy",o=t.includeInvisible||!1;return h1(r,i,s,n,o)},nearest(r,e,t,n){const i=$c(e,r),s=t.axis||"xy",o=t.includeInvisible||!1;return f1(r,i,s,t.intersect,n,o)},x(r,e,t,n){const i=$c(e,r);return GA(r,i,"x",t.intersect,n)},y(r,e,t,n){const i=$c(e,r);return GA(r,i,"y",t.intersect,n)}}};const rR=["left","top","right","bottom"];function sf(r,e){return r.filter(t=>t.pos===e)}function KA(r,e){return r.filter(t=>rR.indexOf(t.pos)===-1&&t.box.axis===e)}function of(r,e){return r.sort((t,n)=>{const i=e?n:t,s=e?t:n;return i.weight===s.weight?i.index-s.index:i.weight-s.weight})}function Hz(r){const e=[];let t,n,i,s,o,l;for(t=0,n=(r||[]).length;t<n;++t)i=r[t],{position:s,options:{stack:o,stackWeight:l=1}}=i,e.push({index:t,box:i,pos:s,horizontal:i.isHorizontal(),weight:i.weight,stack:o&&s+o,stackWeight:l});return e}function $z(r){const e={};for(const t of r){const{stack:n,pos:i,stackWeight:s}=t;if(!n||!rR.includes(i))continue;const o=e[n]||(e[n]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=s}return e}function Wz(r,e){const t=$z(r),{vBoxMaxWidth:n,hBoxMaxHeight:i}=e;let s,o,l;for(s=0,o=r.length;s<o;++s){l=r[s];const{fullSize:d}=l.box,f=t[l.stack],m=f&&l.stackWeight/f.weight;l.horizontal?(l.width=m?m*n:d&&e.availableWidth,l.height=i):(l.width=n,l.height=m?m*i:d&&e.availableHeight)}return t}function Gz(r){const e=Hz(r),t=of(e.filter(f=>f.box.fullSize),!0),n=of(sf(e,"left"),!0),i=of(sf(e,"right")),s=of(sf(e,"top"),!0),o=of(sf(e,"bottom")),l=KA(e,"x"),d=KA(e,"y");return{fullSize:t,leftAndTop:n.concat(s),rightAndBottom:i.concat(d).concat(o).concat(l),chartArea:sf(e,"chartArea"),vertical:n.concat(i).concat(d),horizontal:s.concat(o).concat(l)}}function YA(r,e,t,n){return Math.max(r[t],e[t])+Math.max(r[n],e[n])}function iR(r,e){r.top=Math.max(r.top,e.top),r.left=Math.max(r.left,e.left),r.bottom=Math.max(r.bottom,e.bottom),r.right=Math.max(r.right,e.right)}function Kz(r,e,t,n){const{pos:i,box:s}=t,o=r.maxPadding;if(!en(i)){t.size&&(r[i]-=t.size);const p=n[t.stack]||{size:0,count:1};p.size=Math.max(p.size,t.horizontal?s.height:s.width),t.size=p.size/p.count,r[i]+=t.size}s.getPadding&&iR(o,s.getPadding());const l=Math.max(0,e.outerWidth-YA(o,r,"left","right")),d=Math.max(0,e.outerHeight-YA(o,r,"top","bottom")),f=l!==r.w,m=d!==r.h;return r.w=l,r.h=d,t.horizontal?{same:f,other:m}:{same:m,other:f}}function Yz(r){const e=r.maxPadding;function t(n){const i=Math.max(e[n]-r[n],0);return r[n]+=i,i}r.y+=t("top"),r.x+=t("left"),t("right"),t("bottom")}function Zz(r,e){const t=e.maxPadding;function n(i){const s={left:0,top:0,right:0,bottom:0};return i.forEach(o=>{s[o]=Math.max(e[o],t[o])}),s}return n(r?["left","right"]:["top","bottom"])}function bf(r,e,t,n){const i=[];let s,o,l,d,f,m;for(s=0,o=r.length,f=0;s<o;++s){l=r[s],d=l.box,d.update(l.width||e.w,l.height||e.h,Zz(l.horizontal,e));const{same:p,other:g}=Kz(e,t,l,n);f|=p&&i.length,m=m||g,d.fullSize||i.push(l)}return f&&bf(i,e,t,n)||m}function ng(r,e,t,n,i){r.top=t,r.left=e,r.right=e+n,r.bottom=t+i,r.width=n,r.height=i}function ZA(r,e,t,n){const i=t.padding;let{x:s,y:o}=e;for(const l of r){const d=l.box,f=n[l.stack]||{placed:0,weight:1},m=l.stackWeight/f.weight||1;if(l.horizontal){const p=e.w*m,g=f.size||d.height;mm(f.start)&&(o=f.start),d.fullSize?ng(d,i.left,o,t.outerWidth-i.right-i.left,g):ng(d,e.left+f.placed,o,p,g),f.start=o,f.placed+=p,o=d.bottom}else{const p=e.h*m,g=f.size||d.width;mm(f.start)&&(s=f.start),d.fullSize?ng(d,s,i.top,g,t.outerHeight-i.bottom-i.top):ng(d,s,e.top+f.placed,g,p),f.start=s,f.placed+=p,s=d.right}}e.x=s,e.y=o}var Is={addBox(r,e){r.boxes||(r.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},r.boxes.push(e)},removeBox(r,e){const t=r.boxes?r.boxes.indexOf(e):-1;t!==-1&&r.boxes.splice(t,1)},configure(r,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(r,e,t,n){if(!r)return;const i=Fs(r.options.layout.padding),s=Math.max(e-i.width,0),o=Math.max(t-i.height,0),l=Gz(r.boxes),d=l.vertical,f=l.horizontal;fn(r.boxes,x=>{typeof x.beforeLayout=="function"&&x.beforeLayout()});const m=d.reduce((x,b)=>b.box.options&&b.box.options.display===!1?x:x+1,0)||1,p=Object.freeze({outerWidth:e,outerHeight:t,padding:i,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/m,hBoxMaxHeight:o/2}),g=Object.assign({},i);iR(g,Fs(n));const v=Object.assign({maxPadding:g,w:s,h:o,x:i.left,y:i.top},i),E=Wz(d.concat(f),p);bf(l.fullSize,v,p,E),bf(d,v,p,E),bf(f,v,p,E)&&bf(d,v,p,E),Yz(v),ZA(l.leftAndTop,v,p,E),v.x+=v.w,v.y+=v.h,ZA(l.rightAndBottom,v,p,E),r.chartArea={left:v.left,top:v.top,right:v.left+v.w,bottom:v.top+v.h,height:v.h,width:v.w},fn(l.chartArea,x=>{const b=x.box;Object.assign(b,r.chartArea),b.update(v.w,v.h,{left:0,top:0,right:0,bottom:0})})}};class sR{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,n){}removeEventListener(e,t,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,n,i){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,i?Math.floor(t/i):n)}}isAttached(e){return!0}updateConfig(e){}}class Qz extends sR{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Cg="$chartjs",Xz={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},QA=r=>r===null||r==="";function Jz(r,e){const t=r.style,n=r.getAttribute("height"),i=r.getAttribute("width");if(r[Cg]={initial:{height:n,width:i,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",QA(i)){const s=OA(r,"width");s!==void 0&&(r.width=s)}if(QA(n))if(r.style.height==="")r.height=r.width/(e||2);else{const s=OA(r,"height");s!==void 0&&(r.height=s)}return r}const oR=XB?{passive:!0}:!1;function eU(r,e,t){r&&r.addEventListener(e,t,oR)}function tU(r,e,t){r&&r.canvas&&r.canvas.removeEventListener(e,t,oR)}function nU(r,e){const t=Xz[r.type]||r.type,{x:n,y:i}=$c(r,e);return{type:t,chart:e,native:r,x:n!==void 0?n:null,y:i!==void 0?i:null}}function yy(r,e){for(const t of r)if(t===e||t.contains(e))return!0}function rU(r,e,t){const n=r.canvas,i=new MutationObserver(s=>{let o=!1;for(const l of s)o=o||yy(l.addedNodes,n),o=o&&!yy(l.removedNodes,n);o&&t()});return i.observe(document,{childList:!0,subtree:!0}),i}function iU(r,e,t){const n=r.canvas,i=new MutationObserver(s=>{let o=!1;for(const l of s)o=o||yy(l.removedNodes,n),o=o&&!yy(l.addedNodes,n);o&&t()});return i.observe(document,{childList:!0,subtree:!0}),i}const _m=new Map;let XA=0;function aR(){const r=window.devicePixelRatio;r!==XA&&(XA=r,_m.forEach((e,t)=>{t.currentDevicePixelRatio!==r&&e()}))}function sU(r,e){_m.size||window.addEventListener("resize",aR),_m.set(r,e)}function oU(r){_m.delete(r),_m.size||window.removeEventListener("resize",aR)}function aU(r,e,t){const n=r.canvas,i=n&&nw(n);if(!i)return;const s=U3((l,d)=>{const f=i.clientWidth;t(l,d),f<i.clientWidth&&t()},window),o=new ResizeObserver(l=>{const d=l[0],f=d.contentRect.width,m=d.contentRect.height;f===0&&m===0||s(f,m)});return o.observe(i),sU(r,s),o}function m1(r,e,t){t&&t.disconnect(),e==="resize"&&oU(r)}function lU(r,e,t){const n=r.canvas,i=U3(s=>{r.ctx!==null&&t(nU(s,r))},r);return eU(n,e,i),i}class cU extends sR{acquireContext(e,t){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(Jz(e,t),n):null}releaseContext(e){const t=e.canvas;if(!t[Cg])return!1;const n=t[Cg].initial;["height","width"].forEach(s=>{const o=n[s];an(o)?t.removeAttribute(s):t.setAttribute(s,o)});const i=n.style||{};return Object.keys(i).forEach(s=>{t.style[s]=i[s]}),t.width=t.width,delete t[Cg],!0}addEventListener(e,t,n){this.removeEventListener(e,t);const i=e.$proxies||(e.$proxies={}),o={attach:rU,detach:iU,resize:aU}[t]||lU;i[t]=o(e,t,n)}removeEventListener(e,t){const n=e.$proxies||(e.$proxies={}),i=n[t];if(!i)return;({attach:m1,detach:m1,resize:m1}[t]||tU)(e,t,i),n[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,n,i){return QB(e,t,n,i)}isAttached(e){const t=e&&nw(e);return!!(t&&t.isConnected)}}function uU(r){return!tw()||typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas?Qz:cU}var dg;let $a=(dg=class{constructor(){nt(this,"x");nt(this,"y");nt(this,"active",!1);nt(this,"options");nt(this,"$animations")}tooltipPosition(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}hasValue(){return pm(this.x)&&pm(this.y)}getProps(e,t){const n=this.$animations;if(!t||!n)return this;const i={};return e.forEach(s=>{i[s]=n[s]&&n[s].active()?n[s]._to:this[s]}),i}},nt(dg,"defaults",{}),nt(dg,"defaultRoutes"),dg);function dU(r,e){const t=r.options.ticks,n=hU(r),i=Math.min(t.maxTicksLimit||n,n),s=t.major.enabled?mU(e):[],o=s.length,l=s[0],d=s[o-1],f=[];if(o>i)return pU(e,f,s,o/i),f;const m=fU(s,e,i);if(o>0){let p,g;const v=o>1?Math.round((d-l)/(o-1)):null;for(rg(e,f,m,an(v)?0:l-v,l),p=0,g=o-1;p<g;p++)rg(e,f,m,s[p],s[p+1]);return rg(e,f,m,d,an(v)?e.length:d+v),f}return rg(e,f,m),f}function hU(r){const e=r.options.offset,t=r._tickSize(),n=r._length/t+(e?0:1),i=r._maxLength/t;return Math.floor(Math.min(n,i))}function fU(r,e,t){const n=gU(r),i=e.length/t;if(!n)return Math.max(i,1);const s=ZV(n);for(let o=0,l=s.length-1;o<l;o++){const d=s[o];if(d>i)return d}return Math.max(i,1)}function mU(r){const e=[];let t,n;for(t=0,n=r.length;t<n;t++)r[t].major&&e.push(t);return e}function pU(r,e,t,n){let i=0,s=t[0],o;for(n=Math.ceil(n),o=0;o<r.length;o++)o===s&&(e.push(r[o]),i++,s=t[i*n])}function rg(r,e,t,n,i){const s=Bt(n,0),o=Math.min(Bt(i,r.length),r.length);let l=0,d,f,m;for(t=Math.ceil(t),i&&(d=i-n,t=d/Math.floor(d/t)),m=s;m<0;)l++,m=Math.round(s+l*t);for(f=Math.max(s,0);f<o;f++)f===m&&(e.push(r[f]),l++,m=Math.round(s+l*t))}function gU(r){const e=r.length;let t,n;if(e<2)return!1;for(n=r[0],t=1;t<e;++t)if(r[t]-r[t-1]!==n)return!1;return n}const yU=r=>r==="left"?"right":r==="right"?"left":r,JA=(r,e,t)=>e==="top"||e==="left"?r[e]+t:r[e]-t,eN=(r,e)=>Math.min(e||r,r);function tN(r,e){const t=[],n=r.length/e,i=r.length;let s=0;for(;s<i;s+=n)t.push(r[Math.floor(s)]);return t}function vU(r,e,t){const n=r.ticks.length,i=Math.min(e,n-1),s=r._startPixel,o=r._endPixel,l=1e-6;let d=r.getPixelForTick(i),f;if(!(t&&(n===1?f=Math.max(d-s,o-d):e===0?f=(r.getPixelForTick(1)-d)/2:f=(d-r.getPixelForTick(i-1))/2,d+=i<e?f:-f,d<s-l||d>o+l)))return d}function _U(r,e){fn(r,t=>{const n=t.gc,i=n.length/2;let s;if(i>e){for(s=0;s<i;++s)delete t.data[n[s]];n.splice(0,i)}})}function af(r){return r.drawTicks?r.tickLength:0}function nN(r,e){if(!r.display)return 0;const t=ei(r.font,e),n=Fs(r.padding);return(fr(r.text)?r.text.length:1)*t.lineHeight+n.height}function xU(r,e){return Ru(r,{scale:e,type:"scale"})}function bU(r,e,t){return Ru(r,{tick:t,index:e,type:"tick"})}function wU(r,e,t){let n=W2(r);return(t&&e!=="right"||!t&&e==="right")&&(n=yU(n)),n}function EU(r,e,t,n){const{top:i,left:s,bottom:o,right:l,chart:d}=r,{chartArea:f,scales:m}=d;let p=0,g,v,E;const x=o-i,b=l-s;if(r.isHorizontal()){if(v=Qr(n,s,l),en(t)){const S=Object.keys(t)[0],N=t[S];E=m[S].getPixelForValue(N)+x-e}else t==="center"?E=(f.bottom+f.top)/2+x-e:E=JA(r,t,e);g=l-s}else{if(en(t)){const S=Object.keys(t)[0],N=t[S];v=m[S].getPixelForValue(N)-b+e}else t==="center"?v=(f.left+f.right)/2-b+e:v=JA(r,t,e);E=Qr(n,o,i),p=t==="left"?-mr:mr}return{titleX:v,titleY:E,maxWidth:g,rotation:p}}class mh extends $a{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:n,_suggestedMax:i}=this;return e=Ao(e,Number.POSITIVE_INFINITY),t=Ao(t,Number.NEGATIVE_INFINITY),n=Ao(n,Number.POSITIVE_INFINITY),i=Ao(i,Number.NEGATIVE_INFINITY),{min:Ao(e,n),max:Ao(t,i),minDefined:Ls(e),maxDefined:Ls(t)}}getMinMax(e){let{min:t,max:n,minDefined:i,maxDefined:s}=this.getUserBounds(),o;if(i&&s)return{min:t,max:n};const l=this.getMatchingVisibleMetas();for(let d=0,f=l.length;d<f;++d)o=l[d].controller.getMinMax(this,e),i||(t=Math.min(t,o.min)),s||(n=Math.max(n,o.max));return t=s&&t>n?n:t,n=i&&t>n?t:n,{min:Ao(t,Ao(n,t)),max:Ao(n,Ao(t,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Cn(this.options.beforeUpdate,[this])}update(e,t,n){const{beginAtZero:i,grace:s,ticks:o}=this.options,l=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=PB(this,s,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const d=l<this.ticks.length;this._convertTicksToLabels(d?tN(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=dU(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),d&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,n;this.isHorizontal()?(t=this.left,n=this.right):(t=this.top,n=this.bottom,e=!e),this._startPixel=t,this._endPixel=n,this._reversePixels=e,this._length=n-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Cn(this.options.afterUpdate,[this])}beforeSetDimensions(){Cn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Cn(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Cn(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Cn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let n,i,s;for(n=0,i=e.length;n<i;n++)s=e[n],s.label=Cn(t.callback,[s.value,n,e],this)}afterTickToLabelConversion(){Cn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Cn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,n=eN(this.ticks.length,e.ticks.maxTicksLimit),i=t.minRotation||0,s=t.maxRotation;let o=i,l,d,f;if(!this._isVisible()||!t.display||i>=s||n<=1||!this.isHorizontal()){this.labelRotation=i;return}const m=this._getLabelSizes(),p=m.widest.width,g=m.highest.height,v=Jr(this.chart.width-p,0,this.maxWidth);l=e.offset?this.maxWidth/n:v/(n-1),p+6>l&&(l=v/(n-(e.offset?.5:1)),d=this.maxHeight-af(e.grid)-t.padding-nN(e.title,this.chart.options.font),f=Math.sqrt(p*p+g*g),o=eB(Math.min(Math.asin(Jr((m.highest.height+6)/l,-1,1)),Math.asin(Jr(d/f,-1,1))-Math.asin(Jr(g/f,-1,1)))),o=Math.max(i,Math.min(s,o))),this.labelRotation=o}afterCalculateLabelRotation(){Cn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Cn(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:n,title:i,grid:s}}=this,o=this._isVisible(),l=this.isHorizontal();if(o){const d=nN(i,t.options.font);if(l?(e.width=this.maxWidth,e.height=af(s)+d):(e.height=this.maxHeight,e.width=af(s)+d),n.display&&this.ticks.length){const{first:f,last:m,widest:p,highest:g}=this._getLabelSizes(),v=n.padding*2,E=Ta(this.labelRotation),x=Math.cos(E),b=Math.sin(E);if(l){const S=n.mirror?0:b*p.width+x*g.height;e.height=Math.min(this.maxHeight,e.height+S+v)}else{const S=n.mirror?0:x*p.width+b*g.height;e.width=Math.min(this.maxWidth,e.width+S+v)}this._calculatePadding(f,m,b,x)}}this._handleMargins(),l?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,n,i){const{ticks:{align:s,padding:o},position:l}=this.options,d=this.labelRotation!==0,f=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const m=this.getPixelForTick(0)-this.left,p=this.right-this.getPixelForTick(this.ticks.length-1);let g=0,v=0;d?f?(g=i*e.width,v=n*t.height):(g=n*e.height,v=i*t.width):s==="start"?v=t.width:s==="end"?g=e.width:s!=="inner"&&(g=e.width/2,v=t.width/2),this.paddingLeft=Math.max((g-m+o)*this.width/(this.width-m),0),this.paddingRight=Math.max((v-p+o)*this.width/(this.width-p),0)}else{let m=t.height/2,p=e.height/2;s==="start"?(m=0,p=e.height):s==="end"&&(m=t.height,p=0),this.paddingTop=m+o,this.paddingBottom=p+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Cn(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,n;for(t=0,n=e.length;t<n;t++)an(e[t].label)&&(e.splice(t,1),n--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let n=this.ticks;t<n.length&&(n=tN(n,t)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,n){const{ctx:i,_longestTextCache:s}=this,o=[],l=[],d=Math.floor(t/eN(t,n));let f=0,m=0,p,g,v,E,x,b,S,N,R,I,j;for(p=0;p<t;p+=d){if(E=e[p].label,x=this._resolveTickFontOptions(p),i.font=b=x.string,S=s[b]=s[b]||{data:{},gc:[]},N=x.lineHeight,R=I=0,!an(E)&&!fr(E))R=PA(i,S.data,S.gc,R,E),I=N;else if(fr(E))for(g=0,v=E.length;g<v;++g)j=E[g],!an(j)&&!fr(j)&&(R=PA(i,S.data,S.gc,R,j),I+=N);o.push(R),l.push(I),f=Math.max(R,f),m=Math.max(I,m)}_U(s,t);const U=o.indexOf(f),P=l.indexOf(m),k=F=>({width:o[F]||0,height:l[F]||0});return{first:k(0),last:k(t-1),widest:k(U),highest:k(P),widths:o,heights:l}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return nB(this._alignToPixels?Bc(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const n=t[e];return n.$context||(n.$context=bU(this.getContext(),e,n))}return this.$context||(this.$context=xU(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=Ta(this.labelRotation),n=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t)),s=this._getLabelSizes(),o=e.autoSkipPadding||0,l=s?s.widest.width+o:0,d=s?s.highest.height+o:0;return this.isHorizontal()?d*n>l*i?l/n:d/i:d*i<l*n?d/n:l/i}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,n=this.chart,i=this.options,{grid:s,position:o,border:l}=i,d=s.offset,f=this.isHorizontal(),p=this.ticks.length+(d?1:0),g=af(s),v=[],E=l.setContext(this.getContext()),x=E.display?E.width:0,b=x/2,S=function(ee){return Bc(n,ee,x)};let N,R,I,j,U,P,k,F,O,C,M,D;if(o==="top")N=S(this.bottom),P=this.bottom-g,F=N-b,C=S(e.top)+b,D=e.bottom;else if(o==="bottom")N=S(this.top),C=e.top,D=S(e.bottom)-b,P=N+b,F=this.top+g;else if(o==="left")N=S(this.right),U=this.right-g,k=N-b,O=S(e.left)+b,M=e.right;else if(o==="right")N=S(this.left),O=e.left,M=S(e.right)-b,U=N+b,k=this.left+g;else if(t==="x"){if(o==="center")N=S((e.top+e.bottom)/2+.5);else if(en(o)){const ee=Object.keys(o)[0],se=o[ee];N=S(this.chart.scales[ee].getPixelForValue(se))}C=e.top,D=e.bottom,P=N+b,F=P+g}else if(t==="y"){if(o==="center")N=S((e.left+e.right)/2);else if(en(o)){const ee=Object.keys(o)[0],se=o[ee];N=S(this.chart.scales[ee].getPixelForValue(se))}U=N-b,k=U-g,O=e.left,M=e.right}const $=Bt(i.ticks.maxTicksLimit,p),K=Math.max(1,Math.ceil(p/$));for(R=0;R<p;R+=K){const ee=this.getContext(R),se=s.setContext(ee),ie=l.setContext(ee),re=se.lineWidth,G=se.color,z=ie.dash||[],Z=ie.dashOffset,J=se.tickWidth,ae=se.tickColor,le=se.tickBorderDash||[],Q=se.tickBorderDashOffset;I=vU(this,R,d),I!==void 0&&(j=Bc(n,I,re),f?U=k=O=M=j:P=F=C=D=j,v.push({tx1:U,ty1:P,tx2:k,ty2:F,x1:O,y1:C,x2:M,y2:D,width:re,color:G,borderDash:z,borderDashOffset:Z,tickWidth:J,tickColor:ae,tickBorderDash:le,tickBorderDashOffset:Q}))}return this._ticksLength=p,this._borderValue=N,v}_computeLabelItems(e){const t=this.axis,n=this.options,{position:i,ticks:s}=n,o=this.isHorizontal(),l=this.ticks,{align:d,crossAlign:f,padding:m,mirror:p}=s,g=af(n.grid),v=g+m,E=p?-m:v,x=-Ta(this.labelRotation),b=[];let S,N,R,I,j,U,P,k,F,O,C,M,D="middle";if(i==="top")U=this.bottom-E,P=this._getXAxisLabelAlignment();else if(i==="bottom")U=this.top+E,P=this._getXAxisLabelAlignment();else if(i==="left"){const K=this._getYAxisLabelAlignment(g);P=K.textAlign,j=K.x}else if(i==="right"){const K=this._getYAxisLabelAlignment(g);P=K.textAlign,j=K.x}else if(t==="x"){if(i==="center")U=(e.top+e.bottom)/2+v;else if(en(i)){const K=Object.keys(i)[0],ee=i[K];U=this.chart.scales[K].getPixelForValue(ee)+v}P=this._getXAxisLabelAlignment()}else if(t==="y"){if(i==="center")j=(e.left+e.right)/2-v;else if(en(i)){const K=Object.keys(i)[0],ee=i[K];j=this.chart.scales[K].getPixelForValue(ee)}P=this._getYAxisLabelAlignment(g).textAlign}t==="y"&&(d==="start"?D="top":d==="end"&&(D="bottom"));const $=this._getLabelSizes();for(S=0,N=l.length;S<N;++S){R=l[S],I=R.label;const K=s.setContext(this.getContext(S));k=this.getPixelForTick(S)+s.labelOffset,F=this._resolveTickFontOptions(S),O=F.lineHeight,C=fr(I)?I.length:1;const ee=C/2,se=K.color,ie=K.textStrokeColor,re=K.textStrokeWidth;let G=P;o?(j=k,P==="inner"&&(S===N-1?G=this.options.reverse?"left":"right":S===0?G=this.options.reverse?"right":"left":G="center"),i==="top"?f==="near"||x!==0?M=-C*O+O/2:f==="center"?M=-$.highest.height/2-ee*O+O:M=-$.highest.height+O/2:f==="near"||x!==0?M=O/2:f==="center"?M=$.highest.height/2-ee*O:M=$.highest.height-C*O,p&&(M*=-1),x!==0&&!K.showLabelBackdrop&&(j+=O/2*Math.sin(x))):(U=k,M=(1-C)*O/2);let z;if(K.showLabelBackdrop){const Z=Fs(K.backdropPadding),J=$.heights[S],ae=$.widths[S];let le=M-Z.top,Q=0-Z.left;switch(D){case"middle":le-=J/2;break;case"bottom":le-=J;break}switch(P){case"center":Q-=ae/2;break;case"right":Q-=ae;break;case"inner":S===N-1?Q-=ae:S>0&&(Q-=ae/2);break}z={left:Q,top:le,width:ae+Z.width,height:J+Z.height,color:K.backdropColor}}b.push({label:I,font:F,textOffset:M,options:{rotation:x,color:se,strokeColor:ie,strokeWidth:re,textAlign:G,textBaseline:D,translation:[j,U],backdrop:z}})}return b}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-Ta(this.labelRotation))return e==="top"?"left":"right";let i="center";return t.align==="start"?i="left":t.align==="end"?i="right":t.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:n,mirror:i,padding:s}}=this.options,o=this._getLabelSizes(),l=e+s,d=o.widest.width;let f,m;return t==="left"?i?(m=this.right+s,n==="near"?f="left":n==="center"?(f="center",m+=d/2):(f="right",m+=d)):(m=this.right-l,n==="near"?f="right":n==="center"?(f="center",m-=d/2):(f="left",m=this.left)):t==="right"?i?(m=this.left+s,n==="near"?f="right":n==="center"?(f="center",m-=d/2):(f="left",m-=d)):(m=this.left+l,n==="near"?f="left":n==="center"?(f="center",m+=d/2):(f="right",m=this.right)):f="right",{textAlign:f,x:m}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:n,top:i,width:s,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(n,i,s,o),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const i=this.ticks.findIndex(s=>s.value===e);return i>=0?t.setContext(this.getContext(i)).lineWidth:0}drawGrid(e){const t=this.options.grid,n=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let s,o;const l=(d,f,m)=>{!m.width||!m.color||(n.save(),n.lineWidth=m.width,n.strokeStyle=m.color,n.setLineDash(m.borderDash||[]),n.lineDashOffset=m.borderDashOffset,n.beginPath(),n.moveTo(d.x,d.y),n.lineTo(f.x,f.y),n.stroke(),n.restore())};if(t.display)for(s=0,o=i.length;s<o;++s){const d=i[s];t.drawOnChartArea&&l({x:d.x1,y:d.y1},{x:d.x2,y:d.y2},d),t.drawTicks&&l({x:d.tx1,y:d.ty1},{x:d.tx2,y:d.ty2},{color:d.tickColor,width:d.tickWidth,borderDash:d.tickBorderDash,borderDashOffset:d.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:n,grid:i}}=this,s=n.setContext(this.getContext()),o=n.display?s.width:0;if(!o)return;const l=i.setContext(this.getContext(0)).lineWidth,d=this._borderValue;let f,m,p,g;this.isHorizontal()?(f=Bc(e,this.left,o)-o/2,m=Bc(e,this.right,l)+l/2,p=g=d):(p=Bc(e,this.top,o)-o/2,g=Bc(e,this.bottom,l)+l/2,f=m=d),t.save(),t.lineWidth=s.width,t.strokeStyle=s.color,t.beginPath(),t.moveTo(f,p),t.lineTo(m,g),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const n=this.ctx,i=this._computeLabelArea();i&&Y2(n,i);const s=this.getLabelItems(e);for(const o of s){const l=o.options,d=o.font,f=o.label,m=o.textOffset;vm(n,f,0,m,d,l)}i&&Z2(n)}drawTitle(){const{ctx:e,options:{position:t,title:n,reverse:i}}=this;if(!n.display)return;const s=ei(n.font),o=Fs(n.padding),l=n.align;let d=s.lineHeight/2;t==="bottom"||t==="center"||en(t)?(d+=o.bottom,fr(n.text)&&(d+=s.lineHeight*(n.text.length-1))):d+=o.top;const{titleX:f,titleY:m,maxWidth:p,rotation:g}=EU(this,d,t,l);vm(e,n.text,0,0,s,{color:n.color,maxWidth:p,rotation:g,textAlign:wU(l,t,i),textBaseline:"middle",translation:[f,m]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,n=Bt(e.grid&&e.grid.z,-1),i=Bt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==mh.prototype.draw?[{z:t,draw:s=>{this.draw(s)}}]:[{z:n,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:t,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",i=[];let s,o;for(s=0,o=t.length;s<o;++s){const l=t[s];l[n]===this.id&&(!e||l.type===e)&&i.push(l)}return i}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return ei(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class ig{constructor(e,t,n){this.type=e,this.scope=t,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let n;AU(t)&&(n=this.register(t));const i=this.items,s=e.id,o=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in i||(i[s]=e,SU(e,o,n),this.override&&Xn.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,n=e.id,i=this.scope;n in t&&delete t[n],i&&n in Xn[i]&&(delete Xn[i][n],this.override&&delete Eu[n])}}function SU(r,e,t){const n=fm(Object.create(null),[t?Xn.get(t):{},Xn.get(e),r.defaults]);Xn.set(e,n),r.defaultRoutes&&TU(e,r.defaultRoutes),r.descriptors&&Xn.describe(e,r.descriptors)}function TU(r,e){Object.keys(e).forEach(t=>{const n=t.split("."),i=n.pop(),s=[r].concat(n).join("."),o=e[t].split("."),l=o.pop(),d=o.join(".");Xn.route(s,i,d,l)})}function AU(r){return"id"in r&&"defaults"in r}class NU{constructor(){this.controllers=new ig(ru,"datasets",!0),this.elements=new ig($a,"elements"),this.plugins=new ig(Object,"plugins"),this.scales=new ig(mh,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,n){[...t].forEach(i=>{const s=n||this._getRegistryForType(i);n||s.isForType(i)||s===this.plugins&&i.id?this._exec(e,s,i):fn(i,o=>{const l=n||this._getRegistryForType(o);this._exec(e,l,o)})})}_exec(e,t,n){const i=H2(e);Cn(n["before"+i],[],n),t[e](n),Cn(n["after"+i],[],n)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}_get(e,t,n){const i=t.get(e);if(i===void 0)throw new Error('"'+e+'" is not a registered '+n+".");return i}}var Io=new NU;class IU{constructor(){this._init=void 0}notify(e,t,n,i){if(t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const s=i?this._descriptors(e).filter(i):this._descriptors(e),o=this._notify(s,e,t,n);return t==="afterDestroy"&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),o}_notify(e,t,n,i){i=i||{};for(const s of e){const o=s.plugin,l=o[n],d=[t,i,s.options];if(Cn(l,d,o)===!1&&i.cancelable)return!1}return!0}invalidate(){an(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const n=e&&e.config,i=Bt(n.options&&n.options.plugins,{}),s=PU(n);return i===!1&&!t?[]:CU(e,s,i,t)}_notifyStateChanges(e){const t=this._oldCache||[],n=this._cache,i=(s,o)=>s.filter(l=>!o.some(d=>l.plugin.id===d.plugin.id));this._notify(i(t,n),e,"stop"),this._notify(i(n,t),e,"start")}}function PU(r){const e={},t=[],n=Object.keys(Io.plugins.items);for(let s=0;s<n.length;s++)t.push(Io.getPlugin(n[s]));const i=r.plugins||[];for(let s=0;s<i.length;s++){const o=i[s];t.indexOf(o)===-1&&(t.push(o),e[o.id]=!0)}return{plugins:t,localIds:e}}function kU(r,e){return!e&&r===!1?null:r===!0?{}:r}function CU(r,{plugins:e,localIds:t},n,i){const s=[],o=r.getContext();for(const l of e){const d=l.id,f=kU(n[d],i);f!==null&&s.push({plugin:l,options:RU(r.config,{plugin:l,local:t[d]},f,o)})}return s}function RU(r,{plugin:e,local:t},n,i){const s=r.pluginScopeKeys(e),o=r.getOptionScopes(n,s);return t&&e.defaults&&o.push(e.defaults),r.createResolver(o,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Yx(r,e){const t=Xn.datasets[r]||{};return((e.datasets||{})[r]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function jU(r,e){let t=r;return r==="_index_"?t=e:r==="_value_"&&(t=e==="x"?"y":"x"),t}function OU(r,e){return r===e?"_index_":"_value_"}function rN(r){if(r==="x"||r==="y"||r==="r")return r}function DU(r){if(r==="top"||r==="bottom")return"x";if(r==="left"||r==="right")return"y"}function Zx(r,...e){if(rN(r))return r;for(const t of e){const n=t.axis||DU(t.position)||r.length>1&&rN(r[0].toLowerCase());if(n)return n}throw new Error(`Cannot determine type of '${r}' axis. Please provide 'axis' or 'position' option.`)}function iN(r,e,t){if(t[e+"AxisID"]===r)return{axis:e}}function MU(r,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(n=>n.xAxisID===r||n.yAxisID===r);if(t.length)return iN(r,"x",t[0])||iN(r,"y",t[0])}return{}}function LU(r,e){const t=Eu[r.type]||{scales:{}},n=e.scales||{},i=Yx(r.type,e),s=Object.create(null);return Object.keys(n).forEach(o=>{const l=n[o];if(!en(l))return console.error(`Invalid scale configuration for scale: ${o}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const d=Zx(o,l,MU(o,r),Xn.scales[l.type]),f=OU(d,i),m=t.scales||{};s[o]=Ff(Object.create(null),[{axis:d},l,m[d],m[f]])}),r.data.datasets.forEach(o=>{const l=o.type||r.type,d=o.indexAxis||Yx(l,e),m=(Eu[l]||{}).scales||{};Object.keys(m).forEach(p=>{const g=jU(p,d),v=o[g+"AxisID"]||g;s[v]=s[v]||Object.create(null),Ff(s[v],[{axis:g},n[v],m[p]])})}),Object.keys(s).forEach(o=>{const l=s[o];Ff(l,[Xn.scales[l.type],Xn.scale])}),s}function lR(r){const e=r.options||(r.options={});e.plugins=Bt(e.plugins,{}),e.scales=LU(r,e)}function cR(r){return r=r||{},r.datasets=r.datasets||[],r.labels=r.labels||[],r}function FU(r){return r=r||{},r.data=cR(r.data),lR(r),r}const sN=new Map,uR=new Set;function sg(r,e){let t=sN.get(r);return t||(t=e(),sN.set(r,t),uR.add(t)),t}const lf=(r,e,t)=>{const n=wu(e,t);n!==void 0&&r.add(n)};class VU{constructor(e){this._config=FU(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=cR(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),lR(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return sg(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return sg(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return sg(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,n=this.type;return sg(`${n}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const n=this._scopeCache;let i=n.get(e);return(!i||t)&&(i=new Map,n.set(e,i)),i}getOptionScopes(e,t,n){const{options:i,type:s}=this,o=this._cachedScopes(e,n),l=o.get(t);if(l)return l;const d=new Set;t.forEach(m=>{e&&(d.add(e),m.forEach(p=>lf(d,e,p))),m.forEach(p=>lf(d,i,p)),m.forEach(p=>lf(d,Eu[s]||{},p)),m.forEach(p=>lf(d,Xn,p)),m.forEach(p=>lf(d,Wx,p))});const f=Array.from(d);return f.length===0&&f.push(Object.create(null)),uR.has(t)&&o.set(t,f),f}chartOptionScopes(){const{options:e,type:t}=this;return[e,Eu[t]||{},Xn.datasets[t]||{},{type:t},Xn,Wx]}resolveNamedOptions(e,t,n,i=[""]){const s={$shared:!0},{resolver:o,subPrefixes:l}=oN(this._resolverCache,e,i);let d=o;if(zU(o,t)){s.$shared=!1,n=cc(n)?n():n;const f=this.createResolver(e,n,l);d=Xd(o,n,f)}for(const f of t)s[f]=d[f];return s}createResolver(e,t,n=[""],i){const{resolver:s}=oN(this._resolverCache,e,n);return en(t)?Xd(s,t,void 0,i):s}}function oN(r,e,t){let n=r.get(e);n||(n=new Map,r.set(e,n));const i=t.join();let s=n.get(i);return s||(s={resolver:X2(e,t),subPrefixes:t.filter(l=>!l.toLowerCase().includes("hover"))},n.set(i,s)),s}const BU=r=>en(r)&&Object.getOwnPropertyNames(r).some(e=>cc(r[e]));function zU(r,e){const{isScriptable:t,isIndexable:n}=W3(r);for(const i of e){const s=t(i),o=n(i),l=(o||s)&&r[i];if(s&&(cc(l)||BU(l))||o&&fr(l))return!0}return!1}var UU="4.5.1";const qU=["top","bottom","left","right","chartArea"];function aN(r,e){return r==="top"||r==="bottom"||qU.indexOf(r)===-1&&e==="x"}function lN(r,e){return function(t,n){return t[r]===n[r]?t[e]-n[e]:t[r]-n[r]}}function cN(r){const e=r.chart,t=e.options.animation;e.notifyPlugins("afterRender"),Cn(t&&t.onComplete,[r],e)}function HU(r){const e=r.chart,t=e.options.animation;Cn(t&&t.onProgress,[r],e)}function dR(r){return tw()&&typeof r=="string"?r=document.getElementById(r):r&&r.length&&(r=r[0]),r&&r.canvas&&(r=r.canvas),r}const Rg={},uN=r=>{const e=dR(r);return Object.values(Rg).filter(t=>t.canvas===e).pop()};function $U(r,e,t){const n=Object.keys(r);for(const i of n){const s=+i;if(s>=e){const o=r[i];delete r[i],(t>0||s>e)&&(r[s+t]=o)}}}function WU(r,e,t,n){return!t||r.type==="mouseout"?null:n?e:r}var jl;let ju=(jl=class{static register(...e){Io.add(...e),dN()}static unregister(...e){Io.remove(...e),dN()}constructor(e,t){const n=this.config=new VU(t),i=dR(e),s=uN(i);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const o=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||uU(i)),this.platform.updateConfig(n);const l=this.platform.acquireContext(i,o.aspectRatio),d=l&&l.canvas,f=d&&d.height,m=d&&d.width;if(this.id=zV(),this.ctx=l,this.canvas=d,this.width=m,this.height=f,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new IU,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=oB(p=>this.update(p),o.resizeDelay||0),this._dataChanges=[],Rg[this.id]=this,!l||!d){console.error("Failed to create chart: can't acquire context from the given item");return}ya.listen(this,"complete",cN),ya.listen(this,"progress",HU),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:n,height:i,_aspectRatio:s}=this;return an(e)?t&&s?s:i?n/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Io}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():jA(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return kA(this.canvas,this.ctx),this}stop(){return ya.stop(this),this}resize(e,t){ya.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const n=this.options,i=this.canvas,s=n.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(i,e,t,s),l=n.devicePixelRatio||this.platform.getDevicePixelRatio(),d=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,jA(this,l,!0)&&(this.notifyPlugins("resize",{size:o}),Cn(n.onResize,[this,o],this),this.attached&&this._doResize(d)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};fn(t,(n,i)=>{n.id=i})}buildOrUpdateScales(){const e=this.options,t=e.scales,n=this.scales,i=Object.keys(n).reduce((o,l)=>(o[l]=!1,o),{});let s=[];t&&(s=s.concat(Object.keys(t).map(o=>{const l=t[o],d=Zx(o,l),f=d==="r",m=d==="x";return{options:l,dposition:f?"chartArea":m?"bottom":"left",dtype:f?"radialLinear":m?"category":"linear"}}))),fn(s,o=>{const l=o.options,d=l.id,f=Zx(d,l),m=Bt(l.type,o.dtype);(l.position===void 0||aN(l.position,f)!==aN(o.dposition))&&(l.position=o.dposition),i[d]=!0;let p=null;if(d in n&&n[d].type===m)p=n[d];else{const g=Io.getScale(m);p=new g({id:d,type:m,ctx:this.ctx,chart:this}),n[p.id]=p}p.init(l,e)}),fn(i,(o,l)=>{o||delete n[l]}),fn(n,o=>{Is.configure(this,o,o.options),Is.addBox(this,o)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,n=e.length;if(e.sort((i,s)=>i.index-s.index),n>t){for(let i=t;i<n;++i)this._destroyDatasetMeta(i);e.splice(t,n-t)}this._sortedMetasets=e.slice(0).sort(lN("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((n,i)=>{t.filter(s=>s===n._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let n,i;for(this._removeUnreferencedMetasets(),n=0,i=t.length;n<i;n++){const s=t[n];let o=this.getDatasetMeta(n);const l=s.type||this.config.type;if(o.type&&o.type!==l&&(this._destroyDatasetMeta(n),o=this.getDatasetMeta(n)),o.type=l,o.indexAxis=s.indexAxis||Yx(l,this.options),o.order=s.order||0,o.index=n,o.label=""+s.label,o.visible=this.isDatasetVisible(n),o.controller)o.controller.updateIndex(n),o.controller.linkScales();else{const d=Io.getController(l),{datasetElementType:f,dataElementType:m}=Xn.datasets[l];Object.assign(d,{dataElementType:Io.getElement(m),datasetElementType:f&&Io.getElement(f)}),o.controller=new d(this,n),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){fn(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const n=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let f=0,m=this.data.datasets.length;f<m;f++){const{controller:p}=this.getDatasetMeta(f),g=!i&&s.indexOf(p)===-1;p.buildOrUpdateElements(g),o=Math.max(+p.getMaxOverflow(),o)}o=this._minPadding=n.layout.autoPadding?o:0,this._updateLayout(o),i||fn(s,f=>{f.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(lN("z","_idx"));const{_active:l,_lastEvent:d}=this;d?this._eventHandler(d,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){fn(this.scales,e=>{Is.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),n=new Set(e.events);(!xA(t,n)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:n,start:i,count:s}of t){const o=n==="_removeElements"?-s:s;$U(e,i,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,n=s=>new Set(e.filter(o=>o[0]===s).map((o,l)=>l+","+o.splice(1).join(","))),i=n(0);for(let s=1;s<t;s++)if(!xA(i,n(s)))return;return Array.from(i).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Is.update(this,this.width,this.height,e);const t=this.chartArea,n=t.width<=0||t.height<=0;this._layers=[],fn(this.boxes,i=>{n&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,s)=>{i._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,n=this.data.datasets.length;t<n;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,n=this.data.datasets.length;t<n;++t)this._updateDataset(t,cc(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const n=this.getDatasetMeta(e),i={meta:n,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(n.controller._update(t),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(ya.has(this)?this.attached&&!ya.running(this)&&ya.start(this):(this.draw(),cN({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:n,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(n,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,n=[];let i,s;for(i=0,s=t.length;i<s;++i){const o=t[i];(!e||o.visible)&&n.push(o)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,n={meta:e,index:e.index,cancelable:!0},i=hz(this,e);this.notifyPlugins("beforeDatasetDraw",n)!==!1&&(i&&Y2(t,i),e.controller.draw(),i&&Z2(t),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(e){return ym(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,n,i){const s=qz.modes[t];return typeof s=="function"?s(this,e,n,i):[]}getDatasetMeta(e){const t=this.data.datasets[e],n=this._metasets;let i=n.filter(s=>s&&s._dataset===t).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(i)),i}getContext(){return this.$context||(this.$context=Ru(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const n=this.getDatasetMeta(e);return typeof n.hidden=="boolean"?!n.hidden:!t.hidden}setDatasetVisibility(e,t){const n=this.getDatasetMeta(e);n.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,n){const i=n?"show":"hide",s=this.getDatasetMeta(e),o=s.controller._resolveAnimations(void 0,i);mm(t)?(s.data[t].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),o.update(s,{visible:n}),this.update(l=>l.datasetIndex===e?i:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),ya.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),kA(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete Rg[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,n=(s,o)=>{t.addEventListener(this,s,o),e[s]=o},i=(s,o,l)=>{s.offsetX=o,s.offsetY=l,this._eventHandler(s)};fn(this.options.events,s=>n(s,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,n=(d,f)=>{t.addEventListener(this,d,f),e[d]=f},i=(d,f)=>{e[d]&&(t.removeEventListener(this,d,f),delete e[d])},s=(d,f)=>{this.canvas&&this.resize(d,f)};let o;const l=()=>{i("attach",l),this.attached=!0,this.resize(),n("resize",s),n("detach",o)};o=()=>{this.attached=!1,i("resize",s),this._stop(),this._resize(0,0),n("attach",l)},t.isAttached(this.canvas)?l():o()}unbindEvents(){fn(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},fn(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,n){const i=n?"set":"remove";let s,o,l,d;for(t==="dataset"&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+i+"DatasetHoverStyle"]()),l=0,d=e.length;l<d;++l){o=e[l];const f=o&&this.getDatasetMeta(o.datasetIndex).controller;f&&f[i+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],n=e.map(({datasetIndex:s,index:o})=>{const l=this.getDatasetMeta(s);if(!l)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:l.data[o],index:o}});!hy(n,t)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,t))}notifyPlugins(e,t,n){return this._plugins.notify(this,e,t,n)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,n){const i=this.options.hover,s=(d,f)=>d.filter(m=>!f.some(p=>m.datasetIndex===p.datasetIndex&&m.index===p.index)),o=s(t,e),l=n?e:s(e,t);o.length&&this.updateHoverStyle(o,i.mode,!1),l.length&&i.mode&&this.updateHoverStyle(l,i.mode,!0)}_eventHandler(e,t){const n={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},i=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",n,i)===!1)return;const s=this._handleEvent(e,t,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,i),(s||n.changed)&&this.render(),this}_handleEvent(e,t,n){const{_active:i=[],options:s}=this,o=t,l=this._getActiveElements(e,i,n,o),d=GV(e),f=WU(e,this._lastEvent,n,d);n&&(this._lastEvent=null,Cn(s.onHover,[e,l,this],this),d&&Cn(s.onClick,[e,l,this],this));const m=!hy(l,i);return(m||t)&&(this._active=l,this._updateHoverStyles(l,i,t)),this._lastEvent=f,m}_getActiveElements(e,t,n,i){if(e.type==="mouseout")return[];if(!n)return t;const s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,i)}},nt(jl,"defaults",Xn),nt(jl,"instances",Rg),nt(jl,"overrides",Eu),nt(jl,"registry",Io),nt(jl,"version",UU),nt(jl,"getChart",uN),jl);function dN(){return fn(ju.instances,r=>r._plugins.invalidate())}function GU(r,e,t){const{startAngle:n,x:i,y:s,outerRadius:o,innerRadius:l,options:d}=e,{borderWidth:f,borderJoinStyle:m}=d,p=Math.min(f/o,oo(n-t));if(r.beginPath(),r.arc(i,s,o-f/2,n+p/2,t-p/2),l>0){const g=Math.min(f/l,oo(n-t));r.arc(i,s,l+f/2,t-g/2,n+g/2,!0)}else{const g=Math.min(f/2,o*oo(n-t));if(m==="round")r.arc(i,s,g,t-mn/2,n+mn/2,!0);else if(m==="bevel"){const v=2*g*g,E=-v*Math.cos(t+mn/2)+i,x=-v*Math.sin(t+mn/2)+s,b=v*Math.cos(n+mn/2)+i,S=v*Math.sin(n+mn/2)+s;r.lineTo(E,x),r.lineTo(b,S)}}r.closePath(),r.moveTo(0,0),r.rect(0,0,r.canvas.width,r.canvas.height),r.clip("evenodd")}function KU(r,e,t){const{startAngle:n,pixelMargin:i,x:s,y:o,outerRadius:l,innerRadius:d}=e;let f=i/l;r.beginPath(),r.arc(s,o,l,n-f,t+f),d>i?(f=i/d,r.arc(s,o,d,t+f,n-f,!0)):r.arc(s,o,i,t+mr,n-mr),r.closePath(),r.clip()}function YU(r){return Q2(r,["outerStart","outerEnd","innerStart","innerEnd"])}function ZU(r,e,t,n){const i=YU(r.options.borderRadius),s=(t-e)/2,o=Math.min(s,n*e/2),l=d=>{const f=(t-Math.min(s,d))*n/2;return Jr(d,0,Math.min(s,f))};return{outerStart:l(i.outerStart),outerEnd:l(i.outerEnd),innerStart:Jr(i.innerStart,0,o),innerEnd:Jr(i.innerEnd,0,o)}}function gd(r,e,t,n){return{x:t+r*Math.cos(e),y:n+r*Math.sin(e)}}function vy(r,e,t,n,i,s){const{x:o,y:l,startAngle:d,pixelMargin:f,innerRadius:m}=e,p=Math.max(e.outerRadius+n+t-f,0),g=m>0?m+n+t+f:0;let v=0;const E=i-d;if(n){const K=m>0?m-n:0,ee=p>0?p-n:0,se=(K+ee)/2,ie=se!==0?E*se/(se+n):E;v=(E-ie)/2}const x=Math.max(.001,E*p-t/mn)/p,b=(E-x)/2,S=d+b+v,N=i-b-v,{outerStart:R,outerEnd:I,innerStart:j,innerEnd:U}=ZU(e,g,p,N-S),P=p-R,k=p-I,F=S+R/P,O=N-I/k,C=g+j,M=g+U,D=S+j/C,$=N-U/M;if(r.beginPath(),s){const K=(F+O)/2;if(r.arc(o,l,p,F,K),r.arc(o,l,p,K,O),I>0){const re=gd(k,O,o,l);r.arc(re.x,re.y,I,O,N+mr)}const ee=gd(M,N,o,l);if(r.lineTo(ee.x,ee.y),U>0){const re=gd(M,$,o,l);r.arc(re.x,re.y,U,N+mr,$+Math.PI)}const se=(N-U/g+(S+j/g))/2;if(r.arc(o,l,g,N-U/g,se,!0),r.arc(o,l,g,se,S+j/g,!0),j>0){const re=gd(C,D,o,l);r.arc(re.x,re.y,j,D+Math.PI,S-mr)}const ie=gd(P,S,o,l);if(r.lineTo(ie.x,ie.y),R>0){const re=gd(P,F,o,l);r.arc(re.x,re.y,R,S-mr,F)}}else{r.moveTo(o,l);const K=Math.cos(F)*p+o,ee=Math.sin(F)*p+l;r.lineTo(K,ee);const se=Math.cos(O)*p+o,ie=Math.sin(O)*p+l;r.lineTo(se,ie)}r.closePath()}function QU(r,e,t,n,i){const{fullCircles:s,startAngle:o,circumference:l}=e;let d=e.endAngle;if(s){vy(r,e,t,n,d,i);for(let f=0;f<s;++f)r.fill();isNaN(l)||(d=o+(l%Wn||Wn))}return vy(r,e,t,n,d,i),r.fill(),d}function XU(r,e,t,n,i){const{fullCircles:s,startAngle:o,circumference:l,options:d}=e,{borderWidth:f,borderJoinStyle:m,borderDash:p,borderDashOffset:g,borderRadius:v}=d,E=d.borderAlign==="inner";if(!f)return;r.setLineDash(p||[]),r.lineDashOffset=g,E?(r.lineWidth=f*2,r.lineJoin=m||"round"):(r.lineWidth=f,r.lineJoin=m||"bevel");let x=e.endAngle;if(s){vy(r,e,t,n,x,i);for(let b=0;b<s;++b)r.stroke();isNaN(l)||(x=o+(l%Wn||Wn))}E&&KU(r,e,x),d.selfJoin&&x-o>=mn&&v===0&&m!=="miter"&&GU(r,e,x),s||(vy(r,e,t,n,x,i),r.stroke())}class Ad extends $a{constructor(t){super();nt(this,"circumference");nt(this,"endAngle");nt(this,"fullCircles");nt(this,"innerRadius");nt(this,"outerRadius");nt(this,"pixelMargin");nt(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,n,i){const s=this.getProps(["x","y"],i),{angle:o,distance:l}=F3(s,{x:t,y:n}),{startAngle:d,endAngle:f,innerRadius:m,outerRadius:p,circumference:g}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),v=(this.options.spacing+this.options.borderWidth)/2,E=Bt(g,f-d),x=gm(o,d,f)&&d!==f,b=E>=Wn||x,S=ql(l,m+v,p+v);return b&&S}getCenterPoint(t){const{x:n,y:i,startAngle:s,endAngle:o,innerRadius:l,outerRadius:d}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:f,spacing:m}=this.options,p=(s+o)/2,g=(l+d+m+f)/2;return{x:n+Math.cos(p)*g,y:i+Math.sin(p)*g}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:n,circumference:i}=this,s=(n.offset||0)/4,o=(n.spacing||0)/2,l=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=i>Wn?Math.floor(i/Wn):0,i===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const d=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(d)*s,Math.sin(d)*s);const f=1-Math.sin(Math.min(mn,i||0)),m=s*f;t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor,QU(t,this,m,o,l),XU(t,this,m,o,l),t.restore()}}nt(Ad,"id","arc"),nt(Ad,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),nt(Ad,"defaultRoutes",{backgroundColor:"backgroundColor"}),nt(Ad,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"});function hR(r,e,t=e){r.lineCap=Bt(t.borderCapStyle,e.borderCapStyle),r.setLineDash(Bt(t.borderDash,e.borderDash)),r.lineDashOffset=Bt(t.borderDashOffset,e.borderDashOffset),r.lineJoin=Bt(t.borderJoinStyle,e.borderJoinStyle),r.lineWidth=Bt(t.borderWidth,e.borderWidth),r.strokeStyle=Bt(t.borderColor,e.borderColor)}function JU(r,e,t){r.lineTo(t.x,t.y)}function eq(r){return r.stepped?xB:r.tension||r.cubicInterpolationMode==="monotone"?bB:JU}function fR(r,e,t={}){const n=r.length,{start:i=0,end:s=n-1}=t,{start:o,end:l}=e,d=Math.max(i,o),f=Math.min(s,l),m=i<o&&s<o||i>l&&s>l;return{count:n,start:d,loop:e.loop,ilen:f<d&&!m?n+f-d:f-d}}function tq(r,e,t,n){const{points:i,options:s}=e,{count:o,start:l,loop:d,ilen:f}=fR(i,t,n),m=eq(s);let{move:p=!0,reverse:g}=n||{},v,E,x;for(v=0;v<=f;++v)E=i[(l+(g?f-v:v))%o],!E.skip&&(p?(r.moveTo(E.x,E.y),p=!1):m(r,x,E,g,s.stepped),x=E);return d&&(E=i[(l+(g?f:0))%o],m(r,x,E,g,s.stepped)),!!d}function nq(r,e,t,n){const i=e.points,{count:s,start:o,ilen:l}=fR(i,t,n),{move:d=!0,reverse:f}=n||{};let m=0,p=0,g,v,E,x,b,S;const N=I=>(o+(f?l-I:I))%s,R=()=>{x!==b&&(r.lineTo(m,b),r.lineTo(m,x),r.lineTo(m,S))};for(d&&(v=i[N(0)],r.moveTo(v.x,v.y)),g=0;g<=l;++g){if(v=i[N(g)],v.skip)continue;const I=v.x,j=v.y,U=I|0;U===E?(j<x?x=j:j>b&&(b=j),m=(p*m+I)/++p):(R(),r.lineTo(I,j),E=U,p=0,x=b=j),S=j}R()}function Qx(r){const e=r.options,t=e.borderDash&&e.borderDash.length;return!r._decimated&&!r._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?nq:tq}function rq(r){return r.stepped?JB:r.tension||r.cubicInterpolationMode==="monotone"?ez:Wc}function iq(r,e,t,n){let i=e._path;i||(i=e._path=new Path2D,e.path(i,t,n)&&i.closePath()),hR(r,e.options),r.stroke(i)}function sq(r,e,t,n){const{segments:i,options:s}=e,o=Qx(e);for(const l of i)hR(r,s,l.style),r.beginPath(),o(r,e,l,{start:t,end:t+n-1})&&r.closePath(),r.stroke()}const oq=typeof Path2D=="function";function aq(r,e,t,n){oq&&!e.options.segment?iq(r,e,t,n):sq(r,e,t,n)}class wf extends $a{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const n=this.options;if((n.tension||n.cubicInterpolationMode==="monotone")&&!n.stepped&&!this._pointsUpdated){const i=n.spanGaps?this._loop:this._fullLoop;$B(this._points,n,e,i,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=lz(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,n=e.length;return n&&t[e[n-1].end]}interpolate(e,t){const n=this.options,i=e[t],s=this.points,o=sz(this,{property:t,start:i,end:i});if(!o.length)return;const l=[],d=rq(n);let f,m;for(f=0,m=o.length;f<m;++f){const{start:p,end:g}=o[f],v=s[p],E=s[g];if(v===E){l.push(v);continue}const x=Math.abs((i-v[t])/(E[t]-v[t])),b=d(v,E,x,n.stepped);b[t]=e[t],l.push(b)}return l.length===1?l[0]:l}pathSegment(e,t,n){return Qx(this)(e,this,t,n)}path(e,t,n){const i=this.segments,s=Qx(this);let o=this._loop;t=t||0,n=n||this.points.length-t;for(const l of i)o&=s(e,this,l,{start:t,end:t+n-1});return!!o}draw(e,t,n,i){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),aq(e,this,n,i),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}nt(wf,"id","line"),nt(wf,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),nt(wf,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),nt(wf,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function hN(r,e,t,n){const i=r.options,{[t]:s}=r.getProps([t],n);return Math.abs(e-s)<i.radius+i.hitRadius}class jg extends $a{constructor(t){super();nt(this,"parsed");nt(this,"skip");nt(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,n,i){const s=this.options,{x:o,y:l}=this.getProps(["x","y"],i);return Math.pow(t-o,2)+Math.pow(n-l,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(t,n){return hN(this,t,"x",n)}inYRange(t,n){return hN(this,t,"y",n)}getCenterPoint(t){const{x:n,y:i}=this.getProps(["x","y"],t);return{x:n,y:i}}size(t){t=t||this.options||{};let n=t.radius||0;n=Math.max(n,n&&t.hoverRadius||0);const i=n&&t.borderWidth||0;return(n+i)*2}draw(t,n){const i=this.options;this.skip||i.radius<.1||!ym(this,n,this.size(i)/2)||(t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.fillStyle=i.backgroundColor,Gx(t,i,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}nt(jg,"id","point"),nt(jg,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),nt(jg,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function mR(r,e){const{x:t,y:n,base:i,width:s,height:o}=r.getProps(["x","y","base","width","height"],e);let l,d,f,m,p;return r.horizontal?(p=o/2,l=Math.min(t,i),d=Math.max(t,i),f=n-p,m=n+p):(p=s/2,l=t-p,d=t+p,f=Math.min(n,i),m=Math.max(n,i)),{left:l,top:f,right:d,bottom:m}}function $l(r,e,t,n){return r?0:Jr(e,t,n)}function lq(r,e,t){const n=r.options.borderWidth,i=r.borderSkipped,s=$3(n);return{t:$l(i.top,s.top,0,t),r:$l(i.right,s.right,0,e),b:$l(i.bottom,s.bottom,0,t),l:$l(i.left,s.left,0,e)}}function cq(r,e,t){const{enableBorderRadius:n}=r.getProps(["enableBorderRadius"]),i=r.options.borderRadius,s=jd(i),o=Math.min(e,t),l=r.borderSkipped,d=n||en(i);return{topLeft:$l(!d||l.top||l.left,s.topLeft,0,o),topRight:$l(!d||l.top||l.right,s.topRight,0,o),bottomLeft:$l(!d||l.bottom||l.left,s.bottomLeft,0,o),bottomRight:$l(!d||l.bottom||l.right,s.bottomRight,0,o)}}function uq(r){const e=mR(r),t=e.right-e.left,n=e.bottom-e.top,i=lq(r,t/2,n/2),s=cq(r,t/2,n/2);return{outer:{x:e.left,y:e.top,w:t,h:n,radius:s},inner:{x:e.left+i.l,y:e.top+i.t,w:t-i.l-i.r,h:n-i.t-i.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,s.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(i.b,i.r))}}}}function p1(r,e,t,n){const i=e===null,s=t===null,l=r&&!(i&&s)&&mR(r,n);return l&&(i||ql(e,l.left,l.right))&&(s||ql(t,l.top,l.bottom))}function dq(r){return r.topLeft||r.topRight||r.bottomLeft||r.bottomRight}function hq(r,e){r.rect(e.x,e.y,e.w,e.h)}function g1(r,e,t={}){const n=r.x!==t.x?-e:0,i=r.y!==t.y?-e:0,s=(r.x+r.w!==t.x+t.w?e:0)-n,o=(r.y+r.h!==t.y+t.h?e:0)-i;return{x:r.x+n,y:r.y+i,w:r.w+s,h:r.h+o,radius:r.radius}}class Uf extends $a{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:n,backgroundColor:i}}=this,{inner:s,outer:o}=uq(this),l=dq(o.radius)?py:hq;e.save(),(o.w!==s.w||o.h!==s.h)&&(e.beginPath(),l(e,g1(o,t,s)),e.clip(),l(e,g1(s,-t,o)),e.fillStyle=n,e.fill("evenodd")),e.beginPath(),l(e,g1(s,t)),e.fillStyle=i,e.fill(),e.restore()}inRange(e,t,n){return p1(this,e,t,n)}inXRange(e,t){return p1(this,e,null,t)}inYRange(e,t){return p1(this,null,e,t)}getCenterPoint(e){const{x:t,y:n,base:i,horizontal:s}=this.getProps(["x","y","base","horizontal"],e);return{x:s?(t+i)/2:t,y:s?n:(n+i)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}nt(Uf,"id","bar"),nt(Uf,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),nt(Uf,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const fN=(r,e)=>{let{boxHeight:t=e,boxWidth:n=e}=r;return r.usePointStyle&&(t=Math.min(t,e),n=r.pointStyleWidth||Math.min(n,e)),{boxWidth:n,boxHeight:t,itemHeight:Math.max(e,t)}},fq=(r,e)=>r!==null&&e!==null&&r.datasetIndex===e.datasetIndex&&r.index===e.index;class mN extends $a{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,n){this.maxWidth=e,this.maxHeight=t,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Cn(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(n=>e.filter(n,this.chart.data))),e.sort&&(t=t.sort((n,i)=>e.sort(n,i,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const n=e.labels,i=ei(n.font),s=i.size,o=this._computeTitleHeight(),{boxWidth:l,itemHeight:d}=fN(n,s);let f,m;t.font=i.string,this.isHorizontal()?(f=this.maxWidth,m=this._fitRows(o,s,l,d)+10):(m=this.maxHeight,f=this._fitCols(o,i,l,d)+10),this.width=Math.min(f,e.maxWidth||this.maxWidth),this.height=Math.min(m,e.maxHeight||this.maxHeight)}_fitRows(e,t,n,i){const{ctx:s,maxWidth:o,options:{labels:{padding:l}}}=this,d=this.legendHitBoxes=[],f=this.lineWidths=[0],m=i+l;let p=e;s.textAlign="left",s.textBaseline="middle";let g=-1,v=-m;return this.legendItems.forEach((E,x)=>{const b=n+t/2+s.measureText(E.text).width;(x===0||f[f.length-1]+b+2*l>o)&&(p+=m,f[f.length-(x>0?0:1)]=0,v+=m,g++),d[x]={left:0,top:v,row:g,width:b,height:i},f[f.length-1]+=b+l}),p}_fitCols(e,t,n,i){const{ctx:s,maxHeight:o,options:{labels:{padding:l}}}=this,d=this.legendHitBoxes=[],f=this.columnSizes=[],m=o-e;let p=l,g=0,v=0,E=0,x=0;return this.legendItems.forEach((b,S)=>{const{itemWidth:N,itemHeight:R}=mq(n,t,s,b,i);S>0&&v+R+2*l>m&&(p+=g+l,f.push({width:g,height:v}),E+=g+l,x++,g=v=0),d[S]={left:E,top:v,col:x,width:N,height:R},g=Math.max(g,N),v+=R+l}),p+=g,f.push({width:g,height:v}),p}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:n,labels:{padding:i},rtl:s}}=this,o=Od(s,this.left,this.width);if(this.isHorizontal()){let l=0,d=Qr(n,this.left+i,this.right-this.lineWidths[l]);for(const f of t)l!==f.row&&(l=f.row,d=Qr(n,this.left+i,this.right-this.lineWidths[l])),f.top+=this.top+e+i,f.left=o.leftForLtr(o.x(d),f.width),d+=f.width+i}else{let l=0,d=Qr(n,this.top+e+i,this.bottom-this.columnSizes[l].height);for(const f of t)f.col!==l&&(l=f.col,d=Qr(n,this.top+e+i,this.bottom-this.columnSizes[l].height)),f.top=d,f.left+=this.left+i,f.left=o.leftForLtr(o.x(f.left),f.width),d+=f.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Y2(e,this),this._draw(),Z2(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:n,ctx:i}=this,{align:s,labels:o}=e,l=Xn.color,d=Od(e.rtl,this.left,this.width),f=ei(o.font),{padding:m}=o,p=f.size,g=p/2;let v;this.drawTitle(),i.textAlign=d.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=f.string;const{boxWidth:E,boxHeight:x,itemHeight:b}=fN(o,p),S=function(U,P,k){if(isNaN(E)||E<=0||isNaN(x)||x<0)return;i.save();const F=Bt(k.lineWidth,1);if(i.fillStyle=Bt(k.fillStyle,l),i.lineCap=Bt(k.lineCap,"butt"),i.lineDashOffset=Bt(k.lineDashOffset,0),i.lineJoin=Bt(k.lineJoin,"miter"),i.lineWidth=F,i.strokeStyle=Bt(k.strokeStyle,l),i.setLineDash(Bt(k.lineDash,[])),o.usePointStyle){const O={radius:x*Math.SQRT2/2,pointStyle:k.pointStyle,rotation:k.rotation,borderWidth:F},C=d.xPlus(U,E/2),M=P+g;H3(i,O,C,M,o.pointStyleWidth&&E)}else{const O=P+Math.max((p-x)/2,0),C=d.leftForLtr(U,E),M=jd(k.borderRadius);i.beginPath(),Object.values(M).some(D=>D!==0)?py(i,{x:C,y:O,w:E,h:x,radius:M}):i.rect(C,O,E,x),i.fill(),F!==0&&i.stroke()}i.restore()},N=function(U,P,k){vm(i,k.text,U,P+b/2,f,{strikethrough:k.hidden,textAlign:d.textAlign(k.textAlign)})},R=this.isHorizontal(),I=this._computeTitleHeight();R?v={x:Qr(s,this.left+m,this.right-n[0]),y:this.top+m+I,line:0}:v={x:this.left+m,y:Qr(s,this.top+I+m,this.bottom-t[0].height),line:0},Q3(this.ctx,e.textDirection);const j=b+m;this.legendItems.forEach((U,P)=>{i.strokeStyle=U.fontColor,i.fillStyle=U.fontColor;const k=i.measureText(U.text).width,F=d.textAlign(U.textAlign||(U.textAlign=o.textAlign)),O=E+g+k;let C=v.x,M=v.y;d.setWidth(this.width),R?P>0&&C+O+m>this.right&&(M=v.y+=j,v.line++,C=v.x=Qr(s,this.left+m,this.right-n[v.line])):P>0&&M+j>this.bottom&&(C=v.x=C+t[v.line].width+m,v.line++,M=v.y=Qr(s,this.top+I+m,this.bottom-t[v.line].height));const D=d.x(C);if(S(D,M,U),C=aB(F,C+E+g,R?C+O:this.right,e.rtl),N(d.x(C),M,U),R)v.x+=O+m;else if(typeof U.text!="string"){const $=f.lineHeight;v.y+=pR(U,$)+m}else v.y+=j}),X3(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,n=ei(t.font),i=Fs(t.padding);if(!t.display)return;const s=Od(e.rtl,this.left,this.width),o=this.ctx,l=t.position,d=n.size/2,f=i.top+d;let m,p=this.left,g=this.width;if(this.isHorizontal())g=Math.max(...this.lineWidths),m=this.top+f,p=Qr(e.align,p,this.right-g);else{const E=this.columnSizes.reduce((x,b)=>Math.max(x,b.height),0);m=f+Qr(e.align,this.top,this.bottom-E-e.labels.padding-this._computeTitleHeight())}const v=Qr(l,p,p+g);o.textAlign=s.textAlign(W2(l)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=n.string,vm(o,t.text,v,m,n)}_computeTitleHeight(){const e=this.options.title,t=ei(e.font),n=Fs(e.padding);return e.display?t.lineHeight+n.height:0}_getLegendItemAt(e,t){let n,i,s;if(ql(e,this.left,this.right)&&ql(t,this.top,this.bottom)){for(s=this.legendHitBoxes,n=0;n<s.length;++n)if(i=s[n],ql(e,i.left,i.left+i.width)&&ql(t,i.top,i.top+i.height))return this.legendItems[n]}return null}handleEvent(e){const t=this.options;if(!yq(e.type,t))return;const n=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const i=this._hoveredItem,s=fq(i,n);i&&!s&&Cn(t.onLeave,[e,i,this],this),this._hoveredItem=n,n&&!s&&Cn(t.onHover,[e,n,this],this)}else n&&Cn(t.onClick,[e,n,this],this)}}function mq(r,e,t,n,i){const s=pq(n,r,e,t),o=gq(i,n,e.lineHeight);return{itemWidth:s,itemHeight:o}}function pq(r,e,t,n){let i=r.text;return i&&typeof i!="string"&&(i=i.reduce((s,o)=>s.length>o.length?s:o)),e+t.size/2+n.measureText(i).width}function gq(r,e,t){let n=r;return typeof e.text!="string"&&(n=pR(e,t)),n}function pR(r,e){const t=r.text?r.text.length:0;return e*t}function yq(r,e){return!!((r==="mousemove"||r==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(r==="click"||r==="mouseup"))}var iw={id:"legend",_element:mN,start(r,e,t){const n=r.legend=new mN({ctx:r.ctx,options:t,chart:r});Is.configure(r,n,t),Is.addBox(r,n)},stop(r){Is.removeBox(r,r.legend),delete r.legend},beforeUpdate(r,e,t){const n=r.legend;Is.configure(r,n,t),n.options=t},afterUpdate(r){const e=r.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(r,e){e.replay||r.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(r,e,t){const n=e.datasetIndex,i=t.chart;i.isDatasetVisible(n)?(i.hide(n),e.hidden=!0):(i.show(n),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:r=>r.chart.options.color,boxWidth:40,padding:10,generateLabels(r){const e=r.data.datasets,{labels:{usePointStyle:t,pointStyle:n,textAlign:i,color:s,useBorderRadius:o,borderRadius:l}}=r.legend.options;return r._getSortedDatasetMetas().map(d=>{const f=d.controller.getStyle(t?0:void 0),m=Fs(f.borderWidth);return{text:e[d.index].label,fillStyle:f.backgroundColor,fontColor:s,hidden:!d.visible,lineCap:f.borderCapStyle,lineDash:f.borderDash,lineDashOffset:f.borderDashOffset,lineJoin:f.borderJoinStyle,lineWidth:(m.width+m.height)/4,strokeStyle:f.borderColor,pointStyle:n||f.pointStyle,rotation:f.rotation,textAlign:i||f.textAlign,borderRadius:o&&(l||f.borderRadius),datasetIndex:d.index}},this)}},title:{color:r=>r.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:r=>!r.startsWith("on"),labels:{_scriptable:r=>!["generateLabels","filter","sort"].includes(r)}}};class gR extends $a{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const i=fr(n.text)?n.text.length:1;this._padding=Fs(n.padding);const s=i*ei(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:n,bottom:i,right:s,options:o}=this,l=o.align;let d=0,f,m,p;return this.isHorizontal()?(m=Qr(l,n,s),p=t+e,f=s-n):(o.position==="left"?(m=n+e,p=Qr(l,i,t),d=mn*-.5):(m=s-e,p=Qr(l,t,i),d=mn*.5),f=i-t),{titleX:m,titleY:p,maxWidth:f,rotation:d}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const n=ei(t.font),s=n.lineHeight/2+this._padding.top,{titleX:o,titleY:l,maxWidth:d,rotation:f}=this._drawArgs(s);vm(e,t.text,0,0,n,{color:t.color,maxWidth:d,rotation:f,textAlign:W2(t.align),textBaseline:"middle",translation:[o,l]})}}function vq(r,e){const t=new gR({ctx:r.ctx,options:e,chart:r});Is.configure(r,t,e),Is.addBox(r,t),r.titleBlock=t}var sw={id:"title",_element:gR,start(r,e,t){vq(r,t)},stop(r){const e=r.titleBlock;Is.removeBox(r,e),delete r.titleBlock},beforeUpdate(r,e,t){const n=r.titleBlock;Is.configure(r,n,t),n.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const Ef={average(r){if(!r.length)return!1;let e,t,n=new Set,i=0,s=0;for(e=0,t=r.length;e<t;++e){const l=r[e].element;if(l&&l.hasValue()){const d=l.tooltipPosition();n.add(d.x),i+=d.y,++s}}return s===0||n.size===0?!1:{x:[...n].reduce((l,d)=>l+d)/n.size,y:i/s}},nearest(r,e){if(!r.length)return!1;let t=e.x,n=e.y,i=Number.POSITIVE_INFINITY,s,o,l;for(s=0,o=r.length;s<o;++s){const d=r[s].element;if(d&&d.hasValue()){const f=d.getCenterPoint(),m=$x(e,f);m<i&&(i=m,l=d)}}if(l){const d=l.tooltipPosition();t=d.x,n=d.y}return{x:t,y:n}}};function No(r,e){return e&&(fr(e)?Array.prototype.push.apply(r,e):r.push(e)),r}function va(r){return(typeof r=="string"||r instanceof String)&&r.indexOf(`
`)>-1?r.split(`
`):r}function _q(r,e){const{element:t,datasetIndex:n,index:i}=e,s=r.getDatasetMeta(n).controller,{label:o,value:l}=s.getLabelAndValue(i);return{chart:r,label:o,parsed:s.getParsed(i),raw:r.data.datasets[n].data[i],formattedValue:l,dataset:s.getDataset(),dataIndex:i,datasetIndex:n,element:t}}function pN(r,e){const t=r.chart.ctx,{body:n,footer:i,title:s}=r,{boxWidth:o,boxHeight:l}=e,d=ei(e.bodyFont),f=ei(e.titleFont),m=ei(e.footerFont),p=s.length,g=i.length,v=n.length,E=Fs(e.padding);let x=E.height,b=0,S=n.reduce((I,j)=>I+j.before.length+j.lines.length+j.after.length,0);if(S+=r.beforeBody.length+r.afterBody.length,p&&(x+=p*f.lineHeight+(p-1)*e.titleSpacing+e.titleMarginBottom),S){const I=e.displayColors?Math.max(l,d.lineHeight):d.lineHeight;x+=v*I+(S-v)*d.lineHeight+(S-1)*e.bodySpacing}g&&(x+=e.footerMarginTop+g*m.lineHeight+(g-1)*e.footerSpacing);let N=0;const R=function(I){b=Math.max(b,t.measureText(I).width+N)};return t.save(),t.font=f.string,fn(r.title,R),t.font=d.string,fn(r.beforeBody.concat(r.afterBody),R),N=e.displayColors?o+2+e.boxPadding:0,fn(n,I=>{fn(I.before,R),fn(I.lines,R),fn(I.after,R)}),N=0,t.font=m.string,fn(r.footer,R),t.restore(),b+=E.width,{width:b,height:x}}function xq(r,e){const{y:t,height:n}=e;return t<n/2?"top":t>r.height-n/2?"bottom":"center"}function bq(r,e,t,n){const{x:i,width:s}=n,o=t.caretSize+t.caretPadding;if(r==="left"&&i+s+o>e.width||r==="right"&&i-s-o<0)return!0}function wq(r,e,t,n){const{x:i,width:s}=t,{width:o,chartArea:{left:l,right:d}}=r;let f="center";return n==="center"?f=i<=(l+d)/2?"left":"right":i<=s/2?f="left":i>=o-s/2&&(f="right"),bq(f,r,e,t)&&(f="center"),f}function gN(r,e,t){const n=t.yAlign||e.yAlign||xq(r,t);return{xAlign:t.xAlign||e.xAlign||wq(r,e,t,n),yAlign:n}}function Eq(r,e){let{x:t,width:n}=r;return e==="right"?t-=n:e==="center"&&(t-=n/2),t}function Sq(r,e,t){let{y:n,height:i}=r;return e==="top"?n+=t:e==="bottom"?n-=i+t:n-=i/2,n}function yN(r,e,t,n){const{caretSize:i,caretPadding:s,cornerRadius:o}=r,{xAlign:l,yAlign:d}=t,f=i+s,{topLeft:m,topRight:p,bottomLeft:g,bottomRight:v}=jd(o);let E=Eq(e,l);const x=Sq(e,d,f);return d==="center"?l==="left"?E+=f:l==="right"&&(E-=f):l==="left"?E-=Math.max(m,g)+i:l==="right"&&(E+=Math.max(p,v)+i),{x:Jr(E,0,n.width-e.width),y:Jr(x,0,n.height-e.height)}}function og(r,e,t){const n=Fs(t.padding);return e==="center"?r.x+r.width/2:e==="right"?r.x+r.width-n.right:r.x+n.left}function vN(r){return No([],va(r))}function Tq(r,e,t){return Ru(r,{tooltip:e,tooltipItems:t,type:"tooltip"})}function _N(r,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?r.override(t):r}const yR={beforeTitle:pa,title(r){if(r.length>0){const e=r[0],t=e.chart.data.labels,n=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(n>0&&e.dataIndex<n)return t[e.dataIndex]}return""},afterTitle:pa,beforeBody:pa,beforeLabel:pa,label(r){if(this&&this.options&&this.options.mode==="dataset")return r.label+": "+r.formattedValue||r.formattedValue;let e=r.dataset.label||"";e&&(e+=": ");const t=r.formattedValue;return an(t)||(e+=t),e},labelColor(r){const t=r.chart.getDatasetMeta(r.datasetIndex).controller.getStyle(r.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(r){const t=r.chart.getDatasetMeta(r.datasetIndex).controller.getStyle(r.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:pa,afterBody:pa,beforeFooter:pa,footer:pa,afterFooter:pa};function Mi(r,e,t,n){const i=r[e].call(t,n);return typeof i>"u"?yR[e].call(t,n):i}class Xx extends $a{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,n=this.options.setContext(this.getContext()),i=n.enabled&&t.options.animation&&n.animations,s=new eR(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=Tq(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:n}=t,i=Mi(n,"beforeTitle",this,e),s=Mi(n,"title",this,e),o=Mi(n,"afterTitle",this,e);let l=[];return l=No(l,va(i)),l=No(l,va(s)),l=No(l,va(o)),l}getBeforeBody(e,t){return vN(Mi(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:n}=t,i=[];return fn(e,s=>{const o={before:[],lines:[],after:[]},l=_N(n,s);No(o.before,va(Mi(l,"beforeLabel",this,s))),No(o.lines,Mi(l,"label",this,s)),No(o.after,va(Mi(l,"afterLabel",this,s))),i.push(o)}),i}getAfterBody(e,t){return vN(Mi(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:n}=t,i=Mi(n,"beforeFooter",this,e),s=Mi(n,"footer",this,e),o=Mi(n,"afterFooter",this,e);let l=[];return l=No(l,va(i)),l=No(l,va(s)),l=No(l,va(o)),l}_createItems(e){const t=this._active,n=this.chart.data,i=[],s=[],o=[];let l=[],d,f;for(d=0,f=t.length;d<f;++d)l.push(_q(this.chart,t[d]));return e.filter&&(l=l.filter((m,p,g)=>e.filter(m,p,g,n))),e.itemSort&&(l=l.sort((m,p)=>e.itemSort(m,p,n))),fn(l,m=>{const p=_N(e.callbacks,m);i.push(Mi(p,"labelColor",this,m)),s.push(Mi(p,"labelPointStyle",this,m)),o.push(Mi(p,"labelTextColor",this,m))}),this.labelColors=i,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=l,l}update(e,t){const n=this.options.setContext(this.getContext()),i=this._active;let s,o=[];if(!i.length)this.opacity!==0&&(s={opacity:0});else{const l=Ef[n.position].call(this,i,this._eventPosition);o=this._createItems(n),this.title=this.getTitle(o,n),this.beforeBody=this.getBeforeBody(o,n),this.body=this.getBody(o,n),this.afterBody=this.getAfterBody(o,n),this.footer=this.getFooter(o,n);const d=this._size=pN(this,n),f=Object.assign({},l,d),m=gN(this.chart,n,f),p=yN(n,f,m,this.chart);this.xAlign=m.xAlign,this.yAlign=m.yAlign,s={opacity:1,x:p.x,y:p.y,width:d.width,height:d.height,caretX:l.x,caretY:l.y}}this._tooltipItems=o,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,n,i){const s=this.getCaretPosition(e,n,i);t.lineTo(s.x1,s.y1),t.lineTo(s.x2,s.y2),t.lineTo(s.x3,s.y3)}getCaretPosition(e,t,n){const{xAlign:i,yAlign:s}=this,{caretSize:o,cornerRadius:l}=n,{topLeft:d,topRight:f,bottomLeft:m,bottomRight:p}=jd(l),{x:g,y:v}=e,{width:E,height:x}=t;let b,S,N,R,I,j;return s==="center"?(I=v+x/2,i==="left"?(b=g,S=b-o,R=I+o,j=I-o):(b=g+E,S=b+o,R=I-o,j=I+o),N=b):(i==="left"?S=g+Math.max(d,m)+o:i==="right"?S=g+E-Math.max(f,p)-o:S=this.caretX,s==="top"?(R=v,I=R-o,b=S-o,N=S+o):(R=v+x,I=R+o,b=S+o,N=S-o),j=R),{x1:b,x2:S,x3:N,y1:R,y2:I,y3:j}}drawTitle(e,t,n){const i=this.title,s=i.length;let o,l,d;if(s){const f=Od(n.rtl,this.x,this.width);for(e.x=og(this,n.titleAlign,n),t.textAlign=f.textAlign(n.titleAlign),t.textBaseline="middle",o=ei(n.titleFont),l=n.titleSpacing,t.fillStyle=n.titleColor,t.font=o.string,d=0;d<s;++d)t.fillText(i[d],f.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+l,d+1===s&&(e.y+=n.titleMarginBottom-l)}}_drawColorBox(e,t,n,i,s){const o=this.labelColors[n],l=this.labelPointStyles[n],{boxHeight:d,boxWidth:f}=s,m=ei(s.bodyFont),p=og(this,"left",s),g=i.x(p),v=d<m.lineHeight?(m.lineHeight-d)/2:0,E=t.y+v;if(s.usePointStyle){const x={radius:Math.min(f,d)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},b=i.leftForLtr(g,f)+f/2,S=E+d/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,Gx(e,x,b,S),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,Gx(e,x,b,S)}else{e.lineWidth=en(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const x=i.leftForLtr(g,f),b=i.leftForLtr(i.xPlus(g,1),f-2),S=jd(o.borderRadius);Object.values(S).some(N=>N!==0)?(e.beginPath(),e.fillStyle=s.multiKeyBackground,py(e,{x,y:E,w:f,h:d,radius:S}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),py(e,{x:b,y:E+1,w:f-2,h:d-2,radius:S}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(x,E,f,d),e.strokeRect(x,E,f,d),e.fillStyle=o.backgroundColor,e.fillRect(b,E+1,f-2,d-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,t,n){const{body:i}=this,{bodySpacing:s,bodyAlign:o,displayColors:l,boxHeight:d,boxWidth:f,boxPadding:m}=n,p=ei(n.bodyFont);let g=p.lineHeight,v=0;const E=Od(n.rtl,this.x,this.width),x=function(k){t.fillText(k,E.x(e.x+v),e.y+g/2),e.y+=g+s},b=E.textAlign(o);let S,N,R,I,j,U,P;for(t.textAlign=o,t.textBaseline="middle",t.font=p.string,e.x=og(this,b,n),t.fillStyle=n.bodyColor,fn(this.beforeBody,x),v=l&&b!=="right"?o==="center"?f/2+m:f+2+m:0,I=0,U=i.length;I<U;++I){for(S=i[I],N=this.labelTextColors[I],t.fillStyle=N,fn(S.before,x),R=S.lines,l&&R.length&&(this._drawColorBox(t,e,I,E,n),g=Math.max(p.lineHeight,d)),j=0,P=R.length;j<P;++j)x(R[j]),g=p.lineHeight;fn(S.after,x)}v=0,g=p.lineHeight,fn(this.afterBody,x),e.y-=s}drawFooter(e,t,n){const i=this.footer,s=i.length;let o,l;if(s){const d=Od(n.rtl,this.x,this.width);for(e.x=og(this,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=d.textAlign(n.footerAlign),t.textBaseline="middle",o=ei(n.footerFont),t.fillStyle=n.footerColor,t.font=o.string,l=0;l<s;++l)t.fillText(i[l],d.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+n.footerSpacing}}drawBackground(e,t,n,i){const{xAlign:s,yAlign:o}=this,{x:l,y:d}=e,{width:f,height:m}=n,{topLeft:p,topRight:g,bottomLeft:v,bottomRight:E}=jd(i.cornerRadius);t.fillStyle=i.backgroundColor,t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.beginPath(),t.moveTo(l+p,d),o==="top"&&this.drawCaret(e,t,n,i),t.lineTo(l+f-g,d),t.quadraticCurveTo(l+f,d,l+f,d+g),o==="center"&&s==="right"&&this.drawCaret(e,t,n,i),t.lineTo(l+f,d+m-E),t.quadraticCurveTo(l+f,d+m,l+f-E,d+m),o==="bottom"&&this.drawCaret(e,t,n,i),t.lineTo(l+v,d+m),t.quadraticCurveTo(l,d+m,l,d+m-v),o==="center"&&s==="left"&&this.drawCaret(e,t,n,i),t.lineTo(l,d+p),t.quadraticCurveTo(l,d,l+p,d),t.closePath(),t.fill(),i.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,n=this.$animations,i=n&&n.x,s=n&&n.y;if(i||s){const o=Ef[e.position].call(this,this._active,this._eventPosition);if(!o)return;const l=this._size=pN(this,e),d=Object.assign({},o,this._size),f=gN(t,e,d),m=yN(e,d,f,t);(i._to!==m.x||s._to!==m.y)&&(this.xAlign=f.xAlign,this.yAlign=f.yAlign,this.width=l.width,this.height=l.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,m))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(t);const i={width:this.width,height:this.height},s={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const o=Fs(t.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&l&&(e.save(),e.globalAlpha=n,this.drawBackground(s,e,i,t),Q3(e,t.textDirection),s.y+=o.top,this.drawTitle(s,e,t),this.drawBody(s,e,t),this.drawFooter(s,e,t),X3(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const n=this._active,i=e.map(({datasetIndex:l,index:d})=>{const f=this.chart.getDatasetMeta(l);if(!f)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:f.data[d],index:d}}),s=!hy(n,i),o=this._positionChanged(i,t);(s||o)&&(this._active=i,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,n=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,s=this._active||[],o=this._getActiveElements(e,s,t,n),l=this._positionChanged(o,e),d=t||!hy(o,s)||l;return d&&(this._active=o,(i.enabled||i.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),d}_getActiveElements(e,t,n,i){const s=this.options;if(e.type==="mouseout")return[];if(!i)return t.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,s.mode,s,n);return s.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:n,caretY:i,options:s}=this,o=Ef[s.position].call(this,e,t);return o!==!1&&(n!==o.x||i!==o.y)}}nt(Xx,"positioners",Ef);var ow={id:"tooltip",_element:Xx,positioners:Ef,afterInit(r,e,t){t&&(r.tooltip=new Xx({chart:r,options:t}))},beforeUpdate(r,e,t){r.tooltip&&r.tooltip.initialize(t)},reset(r,e,t){r.tooltip&&r.tooltip.initialize(t)},afterDraw(r){const e=r.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(r.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(r.ctx),r.notifyPlugins("afterTooltipDraw",t)}},afterEvent(r,e){if(r.tooltip){const t=e.replay;r.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(r,e)=>e.bodyFont.size,boxWidth:(r,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:yR},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:r=>r!=="filter"&&r!=="itemSort"&&r!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Aq=(r,e,t,n)=>(typeof e=="string"?(t=r.push(e)-1,n.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function Nq(r,e,t,n){const i=r.indexOf(e);if(i===-1)return Aq(r,e,t,n);const s=r.lastIndexOf(e);return i!==s?t:i}const Iq=(r,e)=>r===null?null:Jr(Math.round(r),0,e);function xN(r){const e=this.getLabels();return r>=0&&r<e.length?e[r]:r}class _y extends mh{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const n=this.getLabels();for(const{index:i,label:s}of t)n[i]===s&&n.splice(i,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(an(e))return null;const n=this.getLabels();return t=isFinite(t)&&n[t]===e?t:Nq(n,e,Bt(t,e),this._addedLabels),Iq(t,n.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:n,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(n=0),t||(i=this.getLabels().length-1)),this.min=n,this.max=i}buildTicks(){const e=this.min,t=this.max,n=this.options.offset,i=[];let s=this.getLabels();s=e===0&&t===s.length-1?s:s.slice(e,t+1),this._valueRange=Math.max(s.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let o=e;o<=t;o++)i.push({value:o});return i}getLabelForValue(e){return xN.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}nt(_y,"id","category"),nt(_y,"defaults",{ticks:{callback:xN}});function Pq(r,e){const t=[],{bounds:i,step:s,min:o,max:l,precision:d,count:f,maxTicks:m,maxDigits:p,includeBounds:g}=r,v=s||1,E=m-1,{min:x,max:b}=e,S=!an(o),N=!an(l),R=!an(f),I=(b-x)/(p+1);let j=wA((b-x)/E/v)*v,U,P,k,F;if(j<1e-14&&!S&&!N)return[{value:x},{value:b}];F=Math.ceil(b/j)-Math.floor(x/j),F>E&&(j=wA(F*j/E/v)*v),an(d)||(U=Math.pow(10,d),j=Math.ceil(j*U)/U),i==="ticks"?(P=Math.floor(x/j)*j,k=Math.ceil(b/j)*j):(P=x,k=b),S&&N&&s&&XV((l-o)/s,j/1e3)?(F=Math.round(Math.min((l-o)/j,m)),j=(l-o)/F,P=o,k=l):R?(P=S?o:P,k=N?l:k,F=f-1,j=(k-P)/F):(F=(k-P)/j,Vf(F,Math.round(F),j/1e3)?F=Math.round(F):F=Math.ceil(F));const O=Math.max(EA(j),EA(P));U=Math.pow(10,an(d)?O:d),P=Math.round(P*U)/U,k=Math.round(k*U)/U;let C=0;for(S&&(g&&P!==o?(t.push({value:o}),P<o&&C++,Vf(Math.round((P+C*j)*U)/U,o,bN(o,I,r))&&C++):P<o&&C++);C<F;++C){const M=Math.round((P+C*j)*U)/U;if(N&&M>l)break;t.push({value:M})}return N&&g&&k!==l?t.length&&Vf(t[t.length-1].value,l,bN(l,I,r))?t[t.length-1].value=l:t.push({value:l}):(!N||k===l)&&t.push({value:k}),t}function bN(r,e,{horizontal:t,minRotation:n}){const i=Ta(n),s=(t?Math.sin(i):Math.cos(i))||.001,o=.75*e*(""+r).length;return Math.min(e/s,o)}class kq extends mh{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return an(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:i,max:s}=this;const o=d=>i=t?i:d,l=d=>s=n?s:d;if(e){const d=Mo(i),f=Mo(s);d<0&&f<0?l(0):d>0&&f>0&&o(0)}if(i===s){let d=s===0?1:Math.abs(s*.05);l(s+d),e||o(i-d)}this.min=i,this.max=s}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:n}=e,i;return n?(i=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),t=t||11),t&&(i=Math.min(t,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let n=this.getTickLimit();n=Math.max(2,n);const i={maxTicks:n,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},s=this._range||this,o=Pq(i,s);return e.bounds==="ticks"&&JV(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let t=this.min,n=this.max;if(super.configure(),this.options.offset&&e.length){const i=(n-t)/Math.max(e.length-1,1)/2;t-=i,n+=i}this._startValue=t,this._endValue=n,this._valueRange=n-t}getLabelForValue(e){return K2(e,this.chart.options.locale,this.options.ticks.format)}}class xy extends kq{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=Ls(e)?e:0,this.max=Ls(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,n=Ta(this.options.ticks.minRotation),i=(e?Math.sin(n):Math.cos(n))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,s.lineHeight/i))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}nt(xy,"id","linear"),nt(xy,"defaults",{ticks:{callback:q3.formatters.numeric}});const f0={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Vi=Object.keys(f0);function wN(r,e){return r-e}function EN(r,e){if(an(e))return null;const t=r._adapter,{parser:n,round:i,isoWeekday:s}=r._parseOpts;let o=e;return typeof n=="function"&&(o=n(o)),Ls(o)||(o=typeof n=="string"?t.parse(o,n):t.parse(o)),o===null?null:(i&&(o=i==="week"&&(pm(s)||s===!0)?t.startOf(o,"isoWeek",s):t.startOf(o,i)),+o)}function SN(r,e,t,n){const i=Vi.length;for(let s=Vi.indexOf(r);s<i-1;++s){const o=f0[Vi[s]],l=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((t-e)/(l*o.size))<=n)return Vi[s]}return Vi[i-1]}function Cq(r,e,t,n,i){for(let s=Vi.length-1;s>=Vi.indexOf(t);s--){const o=Vi[s];if(f0[o].common&&r._adapter.diff(i,n,o)>=e-1)return o}return Vi[t?Vi.indexOf(t):0]}function Rq(r){for(let e=Vi.indexOf(r)+1,t=Vi.length;e<t;++e)if(f0[Vi[e]].common)return Vi[e]}function TN(r,e,t){if(!t)r[e]=!0;else if(t.length){const{lo:n,hi:i}=$2(t,e),s=t[n]>=e?t[n]:t[i];r[s]=!0}}function jq(r,e,t,n){const i=r._adapter,s=+i.startOf(e[0].value,n),o=e[e.length-1].value;let l,d;for(l=s;l<=o;l=+i.add(l,1,n))d=t[l],d>=0&&(e[d].major=!0);return e}function AN(r,e,t){const n=[],i={},s=e.length;let o,l;for(o=0;o<s;++o)l=e[o],i[l]=o,n.push({value:l,major:!1});return s===0||!t?n:jq(r,n,i,t)}class by extends mh{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const n=e.time||(e.time={}),i=this._adapter=new Fz._date(e.adapters.date);i.init(t),Ff(n.displayFormats,i.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:EN(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,n=e.time.unit||"day";let{min:i,max:s,minDefined:o,maxDefined:l}=this.getUserBounds();function d(f){!o&&!isNaN(f.min)&&(i=Math.min(i,f.min)),!l&&!isNaN(f.max)&&(s=Math.max(s,f.max))}(!o||!l)&&(d(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&d(this.getMinMax(!1))),i=Ls(i)&&!isNaN(i)?i:+t.startOf(Date.now(),n),s=Ls(s)&&!isNaN(s)?s:+t.endOf(Date.now(),n)+1,this.min=Math.min(i,s-1),this.max=Math.max(i+1,s)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],n=e[e.length-1]),{min:t,max:n}}buildTicks(){const e=this.options,t=e.time,n=e.ticks,i=n.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const s=this.min,o=this.max,l=iB(i,s,o);return this._unit=t.unit||(n.autoSkip?SN(t.minUnit,this.min,this.max,this._getLabelCapacity(s)):Cq(this,l.length,t.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:Rq(this._unit),this.initOffsets(i),e.reverse&&l.reverse(),AN(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,n=0,i,s;this.options.offset&&e.length&&(i=this.getDecimalForValue(e[0]),e.length===1?t=1-i:t=(this.getDecimalForValue(e[1])-i)/2,s=this.getDecimalForValue(e[e.length-1]),e.length===1?n=s:n=(s-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;t=Jr(t,0,o),n=Jr(n,0,o),this._offsets={start:t,end:n,factor:1/(t+1+n)}}_generate(){const e=this._adapter,t=this.min,n=this.max,i=this.options,s=i.time,o=s.unit||SN(s.minUnit,t,n,this._getLabelCapacity(t)),l=Bt(i.ticks.stepSize,1),d=o==="week"?s.isoWeekday:!1,f=pm(d)||d===!0,m={};let p=t,g,v;if(f&&(p=+e.startOf(p,"isoWeek",d)),p=+e.startOf(p,f?"day":o),e.diff(n,t,o)>1e5*l)throw new Error(t+" and "+n+" are too far apart with stepSize of "+l+" "+o);const E=i.ticks.source==="data"&&this.getDataTimestamps();for(g=p,v=0;g<n;g=+e.add(g,l,o),v++)TN(m,g,E);return(g===n||i.bounds==="ticks"||v===1)&&TN(m,g,E),Object.keys(m).sort(wN).map(x=>+x)}getLabelForValue(e){const t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}format(e,t){const i=this.options.time.displayFormats,s=this._unit,o=t||i[s];return this._adapter.format(e,o)}_tickFormatFunction(e,t,n,i){const s=this.options,o=s.ticks.callback;if(o)return Cn(o,[e,t,n],this);const l=s.time.displayFormats,d=this._unit,f=this._majorUnit,m=d&&l[d],p=f&&l[f],g=n[t],v=f&&p&&g&&g.major;return this._adapter.format(e,i||(v?p:m))}generateTickLabels(e){let t,n,i;for(t=0,n=e.length;t<n;++t)i=e[t],i.label=this._tickFormatFunction(i.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+n)*t.factor)}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,n=this.ctx.measureText(e).width,i=Ta(this.isHorizontal()?t.maxRotation:t.minRotation),s=Math.cos(i),o=Math.sin(i),l=this._resolveTickFontOptions(0).size;return{w:n*s+l*o,h:n*o+l*s}}_getLabelCapacity(e){const t=this.options.time,n=t.displayFormats,i=n[t.unit]||n.millisecond,s=this._tickFormatFunction(e,0,AN(this,[e],this._majorUnit),i),o=this._getLabelSize(s),l=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return l>0?l:1}getDataTimestamps(){let e=this._cache.data||[],t,n;if(e.length)return e;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(t=0,n=i.length;t<n;++t)e=e.concat(i[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,n;if(e.length)return e;const i=this.getLabels();for(t=0,n=i.length;t<n;++t)e.push(EN(this,i[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return B3(e.sort(wN))}}nt(by,"id","time"),nt(by,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function ag(r,e,t){let n=0,i=r.length-1,s,o,l,d;t?(e>=r[n].pos&&e<=r[i].pos&&({lo:n,hi:i}=Jc(r,"pos",e)),{pos:s,time:l}=r[n],{pos:o,time:d}=r[i]):(e>=r[n].time&&e<=r[i].time&&({lo:n,hi:i}=Jc(r,"time",e)),{time:s,pos:l}=r[n],{time:o,pos:d}=r[i]);const f=o-s;return f?l+(d-l)*(e-s)/f:l}class NN extends by{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=ag(t,this.min),this._tableRange=ag(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:n}=this,i=[],s=[];let o,l,d,f,m;for(o=0,l=e.length;o<l;++o)f=e[o],f>=t&&f<=n&&i.push(f);if(i.length<2)return[{time:t,pos:0},{time:n,pos:1}];for(o=0,l=i.length;o<l;++o)m=i[o+1],d=i[o-1],f=i[o],Math.round((m+d)/2)!==f&&s.push({time:f,pos:o/(l-1)});return s}_generate(){const e=this.min,t=this.max;let n=super.getDataTimestamps();return(!n.includes(e)||!n.length)&&n.splice(0,0,e),(!n.includes(t)||n.length===1)&&n.push(t),n.sort((i,s)=>i-s)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),n=this.getLabelTimestamps();return t.length&&n.length?e=this.normalize(t.concat(n)):e=t.length?t:n,e=this._cache.all=e,e}getDecimalForValue(e){return(ag(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return ag(this._table,n*this._tableRange+this._minPos,!0)}}nt(NN,"id","timeseries"),nt(NN,"defaults",by.defaults);const vR="label";function IN(r,e){typeof r=="function"?r(e):r&&(r.current=e)}function Oq(r,e){const t=r.options;t&&e&&Object.assign(t,e)}function _R(r,e){r.labels=e}function xR(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:vR;const n=[];r.datasets=e.map(i=>{const s=r.datasets.find(o=>o[t]===i[t]);return!s||!i.data||n.includes(s)?{...i}:(n.push(s),Object.assign(s,i),s)})}function Dq(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vR;const t={labels:[],datasets:[]};return _R(t,r.labels),xR(t,r.datasets,e),t}function Mq(r,e){const{height:t=150,width:n=300,redraw:i=!1,datasetIdKey:s,type:o,data:l,options:d,plugins:f=[],fallbackContent:m,updateMode:p,...g}=r,v=X.useRef(null),E=X.useRef(null),x=()=>{v.current&&(E.current=new ju(v.current,{type:o,data:Dq(l,s),options:d&&{...d},plugins:f}),IN(e,E.current))},b=()=>{IN(e,null),E.current&&(E.current.destroy(),E.current=null)};return X.useEffect(()=>{!i&&E.current&&d&&Oq(E.current,d)},[i,d]),X.useEffect(()=>{!i&&E.current&&_R(E.current.config.data,l.labels)},[i,l.labels]),X.useEffect(()=>{!i&&E.current&&l.datasets&&xR(E.current.config.data,l.datasets,s)},[i,l.datasets]),X.useEffect(()=>{E.current&&(i?(b(),setTimeout(x)):E.current.update(p))},[i,d,l.labels,l.datasets,p]),X.useEffect(()=>{E.current&&(b(),setTimeout(x))},[o]),X.useEffect(()=>(x(),()=>b()),[]),ss.createElement("canvas",{ref:v,role:"img",height:t,width:n,...g},m)}const Lq=X.forwardRef(Mq);function m0(r,e){return ju.register(e),X.forwardRef((t,n)=>ss.createElement(Lq,{...t,ref:n,type:r}))}const Fq=m0("line",kg),bR=m0("bar",Pg),Vq=m0("doughnut",Td),wR=m0("pie",Kx);ju.register(_y,xy,Uf,sw,ow,iw);const Bq=()=>{const r=new Date;return r.setMonth(r.getMonth()-6),r.toISOString().split("T")[0]},PN=()=>new Date().toISOString().split("T")[0],zq=({user:r,userData:e,db:t,showNotification:n})=>{const[i,s]=X.useState([]),[o,l]=X.useState("monthly"),[d,f]=X.useState(Bq()),[m,p]=X.useState(PN()),[g,v]=X.useState(!0),[E,x]=X.useState(""),b=X.useCallback(async()=>{if(!r||!r.uid){x("User data not available."),v(!1);return}v(!0),x("");try{const P=await _u(t,r.uid);if(P.success){const k=P.data.filter(F=>{var O;return((O=F.billDate)==null?void 0:O.toDate)&&typeof F.consumption=="number"&&F.consumption>=0}).sort((F,O)=>F.billDate.toDate()-O.billDate.toDate());s(k)}else throw new Error(P.error||"Failed to fetch billing data.")}catch(P){x(P.message||"An unexpected error occurred fetching data."),n(P.message||"Could not load consumption data.","error")}finally{v(!1)}},[t,r,n]);X.useEffect(()=>{b()},[b]);const N=((P,k,F,O)=>{const C={},M=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],D=new Date(F).getTime(),$=new Date(O).getTime()+(24*60*60*1e3-1);return P.filter(se=>{const ie=se.billDate.toDate().getTime();return ie>=D&&ie<=$}).forEach(se=>{const ie=se.billDate.toDate(),re=ie.getFullYear(),G=ie.getMonth();let z;switch(k){case"yearly":z=`${re}`;break;case"daily":z=`${re}-${String(G+1).padStart(2,"0")}-${String(ie.getDate()).padStart(2,"0")}`;break;case"monthly":default:z=`${re}-${String(G+1).padStart(2,"0")}`;break}C[z]=(C[z]||0)+(se.consumption||0)}),Object.keys(C).sort().reduce((se,ie)=>{let re=ie;if(k==="monthly"){const[G,z]=ie.split("-");z&&M[parseInt(z)-1]&&(re=`${M[parseInt(z)-1]} '${G.slice(-2)}`)}else if(k==="daily"){const[G,z,Z]=ie.split("-");z&&Z&&(re=`${M[parseInt(z)-1]} ${Z}, '${G.slice(-2)}`)}return se[re]=C[ie],se},{})})(i,o,d,m),R={labels:Object.keys(N),datasets:[{label:"Consumption (m)",data:Object.values(N),backgroundColor:"rgba(59, 130, 246, 0.7)",borderColor:"rgba(37, 99, 235, 1)",borderWidth:1,borderRadius:4,hoverBackgroundColor:"rgba(37, 99, 235, 0.8)"}]},I={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:`Water Consumption Trend (${o.charAt(0).toUpperCase()+o.slice(1)})`,font:{size:16},color:"#374151",padding:{bottom:15}},tooltip:{backgroundColor:"#1F2937",titleColor:"#E5E7EB",bodyColor:"#D1D5DB",borderColor:"#4B5563",borderWidth:1,padding:10,callbacks:{label:function(P){return` Consumption: ${P.parsed.y.toFixed(2)} m`}}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Consumption (m)",color:"#4B5563"},grid:{color:"#E5E7EB"},ticks:{color:"#6B7280"}},x:{title:{display:!0,text:"Period",color:"#4B5563"},grid:{display:!1},ticks:{color:"#6B7280"}}}},j=i.length>0?i.reduce((P,k)=>P+(k.consumption||0),0)/i.length:0,U=P=>{const k=Object.values(P),F=Object.keys(P);if(k.length<2)return"Not enough data for comparison in the selected range.";const O=k[k.length-1],C=k[k.length-2],M=F[k.length-1],D=O-C,$=C!==0?D/C*100:O>0?1/0:0;let K=`Consumption in ${M} was ${O.toFixed(2)} m. `;return $===1/0?K+="This is up from 0 in the previous period.":D>0?(K+=`This is ${$>=.1?"+":""}${$.toFixed(1)}% (${D>=0?"+":""}${D.toFixed(2)} m) compared to the previous period.`,$>25&&(K+=" Consider checking for potential leaks or reviewing usage patterns.")):D<0?K+=`This is a ${Math.abs($).toFixed(1)}% decrease (${D.toFixed(2)} m) compared to the previous period.`:K+="Consumption remained stable compared to the previous period.",K};return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200 gap-4",children:[c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(h3,{size:30,className:"mr-3 text-blue-600"})," Water Consumption Analytics"]}),c.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3 w-full sm:w-auto",children:[c.jsxs("div",{className:"flex items-center gap-2 w-full",children:[c.jsx($9,{size:18,className:"text-gray-500"}),c.jsxs("select",{value:o,onChange:P=>l(P.target.value),className:"p-2 border rounded-md text-sm bg-gray-50 focus:ring-blue-500 focus:border-blue-500 w-full",disabled:g,children:[c.jsx("option",{value:"daily",children:"Group by Day"}),c.jsx("option",{value:"monthly",children:"Group by Month"}),c.jsx("option",{value:"yearly",children:"Group by Year"})]})]}),c.jsxs("div",{className:"flex items-center gap-2 w-full",children:[c.jsx(Vx,{size:18,className:"text-gray-500"}),c.jsx("input",{type:"date",value:d,onChange:P=>f(P.target.value),className:"p-2 border rounded-md text-sm bg-gray-50 focus:ring-blue-500 focus:border-blue-500 w-full",disabled:g,max:m}),c.jsx("span",{className:"text-gray-500",children:"-"}),c.jsx("input",{type:"date",value:m,onChange:P=>p(P.target.value),className:"p-2 border rounded-md text-sm bg-gray-50 focus:ring-blue-500 focus:border-blue-500 w-full",disabled:g,min:d,max:PN()})]})]})]}),g&&c.jsx(ln,{message:"Loading consumption data..."}),E&&!g&&c.jsxs("div",{className:"text-center py-10 bg-red-50 p-4 rounded-lg",children:[c.jsx(Zt,{size:48,className:"mx-auto text-red-400 mb-3"}),c.jsx("p",{className:"text-red-600 text-lg font-semibold",children:"Error Loading Data"}),c.jsx("p",{className:"text-sm text-red-500 mt-1",children:E})]}),!g&&!E&&i.length===0&&c.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner",children:[c.jsx(yn,{size:48,className:"mx-auto text-gray-400 mb-4"}),c.jsx("p",{className:"text-gray-600 text-lg",children:"No consumption data found yet."}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Analytics will appear after your first few bills."})]}),!g&&!E&&i.length>0&&Object.keys(N).length>0&&c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"text-sm text-center text-gray-700 bg-blue-50 p-3 rounded-md border border-blue-200 shadow-sm",children:[c.jsxs("p",{children:[c.jsx("strong",{children:"Insight:"})," ",U(N)]}),c.jsxs("p",{className:"mt-1",children:["Average monthly use (all data): ",c.jsxs("strong",{children:[j.toFixed(2)," m"]}),"."]})]}),c.jsx("div",{className:"h-64 md:h-80 lg:h-96 w-full p-4 border rounded-lg bg-gray-50 shadow-inner",children:c.jsx(bR,{options:I,data:R})})]}),!g&&!E&&i.length>0&&Object.keys(N).length===0&&c.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner",children:[c.jsx(yn,{size:48,className:"mx-auto text-gray-400 mb-4"}),c.jsx("p",{className:"text-gray-600 text-lg",children:"No data found for the selected date range and grouping."}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Try expanding your date range or changing the grouping."})]})]})};ju.register(Ad,ow,iw,sw);const kN={Cash:"rgba(16, 185, 129, 0.7)",Stripe:"rgba(59, 130, 246, 0.7)",Card:"rgba(59, 130, 246, 0.7)",Check:"rgba(249, 115, 22, 0.7)","E-wallet (GCash/Maya)":"rgba(139, 92, 246, 0.7)",Unknown:"rgba(107, 114, 128, 0.7)"},CN={Cash:"rgba(16, 185, 129, 1)",Stripe:"rgba(59, 130, 246, 1)",Card:"rgba(59, 130, 246, 1)",Check:"rgba(249, 115, 22, 1)","E-wallet (GCash/Maya)":"rgba(139, 92, 246, 1)",Unknown:"rgba(107, 114, 128, 1)"},Uq=({user:r,db:e,showNotification:t})=>{const[n,i]=X.useState(null),[s,o]=X.useState(!0),[l,d]=X.useState(""),f=X.useCallback(async()=>{if(!r||!r.uid){d("User data not available."),o(!1);return}o(!0),d("");try{const p=await _u(e,r.uid);if(p.success){const g=p.data.filter(v=>v.status==="Paid");if(g.length===0)i(null);else{const v={};g.forEach(b=>{let S=b.paymentMethod||"Unknown";S==="card"&&(S="Stripe"),S==="Card (Debit/Credit)"&&(S="Card"),v[S]=(v[S]||0)+1});const E=Object.keys(v),x=Object.values(v);i({labels:E,datasets:[{label:"Number of Payments",data:x,backgroundColor:E.map(b=>kN[b]||kN.Unknown),borderColor:E.map(b=>CN[b]||CN.Unknown),borderWidth:1}]})}}else throw new Error(p.error||"Failed to fetch billing data.")}catch(p){d(p.message||"An unexpected error occurred fetching data."),t(p.message||"Could not load payment data.","error")}finally{o(!1)}},[e,r,t]);X.useEffect(()=>{f()},[f]);const m={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"},title:{display:!0,text:"Your Payment Methods (by count)",font:{size:18},color:"#374151",padding:{bottom:20}},tooltip:{callbacks:{label:function(p){let g=p.label||"";return g&&(g+=": "),p.parsed!==null&&(g+=`${p.parsed} payment(s)`),g}}}}};return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200 gap-4",children:c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(o0,{size:30,className:"mr-3 text-purple-600"})," Payment Analytics"]})}),s&&c.jsx(ln,{message:"Loading your payment history..."}),l&&c.jsxs("div",{className:"text-center py-10 bg-red-50 p-4 rounded-lg",children:[c.jsx(yn,{size:48,className:"mx-auto text-red-400 mb-3"}),c.jsx("p",{className:"text-red-600 text-lg font-semibold",children:"Error Loading Data"}),c.jsx("p",{className:"text-sm text-red-500 mt-1",children:l})]}),!s&&!l&&!n&&c.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner",children:[c.jsx(yn,{size:48,className:"mx-auto text-gray-400 mb-4"}),c.jsx("p",{className:"text-gray-600 text-lg",children:"No Payment Data Found"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Your payment analytics will appear here once you pay a bill."})]}),!s&&!l&&n&&c.jsx("div",{className:"h-80 md:h-96 w-full p-4 border rounded-lg bg-gray-50 shadow-inner",children:c.jsx(wR,{data:n,options:m})})]})},yd={Bronze:{points:0,color:"text-yellow-700",iconColor:"#cd7f32",benefits:["Standard Support Access","Basic Portal Features","Regular Service Updates"]},Silver:{points:500,color:"text-gray-600",iconColor:"#c0c0c0",benefits:["Priority Support Queue","Eligibility for 1% Annual Bill Rebate*","Early Access to Water Saving Tips","+ Bronze Benefits"]},Gold:{points:1500,color:"text-amber-500",iconColor:"#ffd700",benefits:["Dedicated Support Agent Option","Eligibility for 2.5% Annual Bill Rebate*","Exclusive Conservation Workshop Invites","+ Silver Benefits"]},Platinum:{points:3e3,color:"text-blue-700",iconColor:"#e5e4e2",benefits:["Highest Priority Support Escalation","Eligibility for 5% Annual Bill Rebate*","Free Annual Water Audit Consultation (On Request)","+ Gold Benefits"]}},qq=({userData:r,systemSettings:e={}})=>{const t=(r==null?void 0:r.rebatePoints)||0,i=(x=>x>=yd.Platinum.points?"Platinum":x>=yd.Gold.points?"Gold":x>=yd.Silver.points?"Silver":"Bronze")(t),s=yd[i],l=(x=>{const b=Object.keys(yd),S=b.indexOf(x);if(S>=0&&S<b.length-1){const N=b[S+1];return{name:N,...yd[N]}}return null})(i),d=l?l.points-t:0,f=l?Math.max(0,Math.min(100,t/l.points*100)):100,{isRebateProgramEnabled:m=!1,pointsPerPeso:p=.01,earlyPaymentBonusPoints:g=10,earlyPaymentDaysThreshold:v=7}=e,E=p*100;return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(bu,{size:30,className:"mr-3 text-amber-500"})," AGWA Rewards Program"]})}),c.jsxs("section",{className:"mb-8 p-6 bg-gradient-to-r from-blue-600 to-indigo-700 text-white rounded-lg shadow-xl text-center",children:[c.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Your Rewards Status"}),c.jsxs("div",{className:"text-4xl font-bold mb-1 flex items-center justify-center gap-2",children:[c.jsx(Lf,{size:36,fill:s.iconColor,stroke:s.iconColor}),c.jsxs("span",{style:{color:s.iconColor},children:[i," Tier"]})]}),c.jsxs("p",{className:"text-2xl font-semibold text-blue-100 mb-3",children:[t.toLocaleString()," Points"]}),l&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"w-full max-w-md mx-auto bg-blue-400 rounded-full h-3 mb-1 overflow-hidden shadow-inner",children:c.jsx("div",{className:"bg-yellow-400 h-3 rounded-full transition-all duration-500 ease-out",style:{width:`${f}%`}})}),c.jsx("p",{className:"text-xs text-blue-100",children:d>0?`${d.toLocaleString()} points needed for ${l.name} tier (${l.points.toLocaleString()} total).`:`You've reached the ${l.name} tier!`})]}),i==="Platinum"&&c.jsx("p",{className:"text-sm text-yellow-300 font-semibold mt-2",children:" You are a Platinum member! Enjoy the highest rewards."})]}),c.jsxs("section",{className:"mb-8",children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:["Benefits for ",i," Tier"]}),c.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50 shadow-inner",children:[c.jsx("ul",{className:"list-disc list-inside space-y-1.5 text-sm text-gray-700 pl-4",children:s.benefits.map((x,b)=>c.jsx("li",{children:x.replace("*","")},b))}),c.jsx("p",{className:"text-xs text-gray-500 mt-3",children:"*Annual Bill Rebate eligibility requires 12 consecutive months of good standing within the tier. Rebate applied as bill credit. See terms."})]})]}),c.jsxs("section",{className:"mb-8 p-4 bg-blue-50 border border-blue-200 rounded-lg shadow-sm",children:[c.jsxs("h3",{className:"text-lg font-semibold text-blue-800 mb-3 flex items-center",children:[c.jsx(j2,{size:20,className:"mr-2"})," How to Earn & Use Points (Mechanics)"]}),m?c.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[c.jsx("p",{children:"Earning and using points is simple:"}),c.jsxs("ul",{className:"list-none space-y-2 pl-2",children:[c.jsxs("li",{className:"flex items-start",children:[c.jsx(Lf,{size:16,className:"text-yellow-500 mr-2 mt-0.5 flex-shrink-0"}),c.jsxs("div",{children:[c.jsx("strong",{children:"EARN by Paying Your Bill:"})," Earn ",c.jsxs("strong",{children:[E.toLocaleString()," point",E!==1?"s":""]})," for every ",c.jsx("strong",{children:"100.00"})," paid on your water bill."]})]}),c.jsxs("li",{className:"flex items-start",children:[c.jsx(Lf,{size:16,className:"text-yellow-500 mr-2 mt-0.5 flex-shrink-0"}),c.jsxs("div",{children:[c.jsx("strong",{children:"EARN by Paying Early:"})," Earn a ",c.jsxs("strong",{children:[g," point bonus"]})," when you pay your bill in full at least ",c.jsxs("strong",{children:[v," day",v!==1?"s":""]})," before your due date."]})]}),c.jsxs("li",{className:"flex items-start",children:[c.jsx(bu,{size:16,className:"text-green-600 mr-2 mt-0.5 flex-shrink-0"}),c.jsxs("div",{children:[c.jsx("strong",{children:"USE to Pay Your Bill:"})," Use your points to pay your bill directly! ",c.jsx("strong",{children:"1 Point = 1.00"}),`. If you have enough points to cover your entire bill, a "Pay with Points" button will automatically appear in the 'My Bills' section.`]})]})]}),c.jsx("p",{className:"text-xs text-gray-500",children:"Points are automatically credited to your account after your payment is successfully posted (usually within 24-48 hours)."})]}):c.jsx("p",{className:"text-sm text-gray-700",children:"The AGWA Rewards Program is not currently active."})]}),c.jsxs("section",{children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-3 flex items-center",children:[c.jsx(hh,{size:20,className:"mr-2 text-gray-500"})," Program Terms & Conditions"]}),c.jsxs("details",{className:"text-xs text-gray-500 space-y-2 border p-3 rounded bg-gray-50 cursor-pointer group hover:bg-gray-100 transition-colors",children:[c.jsxs("summary",{className:"font-medium text-gray-700 group-hover:text-blue-600 list-none flex justify-between items-center",children:["Click to view Terms & Conditions",c.jsx("span",{className:"transition-transform duration-200 group-open:rotate-180",children:""})]}),c.jsxs("div",{className:"mt-2 space-y-1.5 max-h-0 overflow-hidden group-open:max-h-[500px] transition-all duration-500 ease-in-out pt-2 border-t",children:[c.jsxs("p",{children:[c.jsx("strong",{children:"1. Eligibility:"}),' All AGWA Water Services, Inc. customers with an active residential or commercial account in good standing are eligible to participate in the AGWA Rewards Program ("Program").']}),c.jsxs("p",{children:[c.jsx("strong",{children:"2. Earning Points:"}),' Points are earned based on (a) the total amount paid for water bills and (b) bonuses for early payments, as specified in the "How to Earn Points" section. Earning rates are determined by AGWA and may be subject to change based on system settings.']}),c.jsxs("p",{children:[c.jsx("strong",{children:"3. Point Crediting:"})," Points will be credited to the customer's account after a payment is successfully processed and posted. This may take up to 48 hours. Points are not earned on payments made using Rebate Points."]}),c.jsxs("p",{children:[c.jsx("strong",{children:"4. Redeeming Points:"}),' Points may be redeemed as full payment for an outstanding water bill ("Bill"), subject to the following conditions: (a) The customer must have sufficient points to cover the *entire* amount of the Bill. (Redemption Rate: 1 Point = 1 Philippine Peso). (b) Partial payments using points are not supported. (c) If sufficient points are available, a "Pay with Points" option will be automatically presented in the Portal. (d) Point redemption is final and irreversible.']}),c.jsxs("p",{children:[c.jsx("strong",{children:"5. Tiers and Benefits:"})," Tier status (Bronze, Silver, Gold, Platinum) is determined by the total accumulated points. Benefits are associated with each tier and are non-transferable. AGWA reserves the right to modify, add, or remove benefits at any time."]}),c.jsxs("p",{children:[c.jsx("strong",{children:"6. Annual Bill Rebate:"}),' Rebates mentioned in tier benefits (e.g., "Eligibility for 1% Annual Bill Rebate") are not automatic. To qualify, a customer must maintain their tier status (Silver or higher) and remain in good standing (no service disconnections due to non-payment) for 12 consecutive months. The rebate is calculated on the total basic charges paid within that 12-month period and will be applied as a credit to a future bill, not as a cash payout.']}),c.jsxs("p",{children:[c.jsx("strong",{children:"7. Point Expiration:"})," Points do not expire. Points will remain valid as long as the customer's account with AGWA remains active."]}),c.jsxs("p",{children:[c.jsx("strong",{children:"8. No Cash Value:"})," Points have no cash value, are non-transferable, and cannot be sold, bartered, or redeemed for cash."]}),c.jsxs("p",{children:[c.jsx("strong",{children:"9. Program Modification/Termination:"})," AGWA Water Services, Inc. reserves the right to modify, suspend, or terminate the AGWA Rewards Program, its rules, tiers, benefits, or earning/redemption mechanics at any time, with or without prior notice."]}),c.jsxs("p",{children:[c.jsx("strong",{children:"10. Account Status:"})," Customers must be in good standing to enjoy tier benefits. Accounts that are suspended or disconnected may have their benefits temporarily revoked."]}),c.jsxs("p",{children:[c.jsx("strong",{children:"11. Disputes:"})," Any discrepancies in point calculation must be reported to AGWA customer service within 60 days of the payment date. AGWA's decision on point disputes is final."]}),c.jsxs("p",{children:[c.jsx("strong",{children:"12. Acceptance of Terms:"})," Continued participation in the Program, including earning and redeeming benefits, constitutes acceptance of these Terms & Conditions."]})]})]})]})]})},ER={Poblacion:["Capt. C. Nazareno","Gombalza","Kanluran","Ibayo Silangan","Humbac","Balsahan"],"Baybayin Bayan-Hilaga":["Timalan Balsahan","Timalan Concepcion","Munting Mapino","Ibayo Estacion","Latoria","Bucana Sasahan"],"Baybayin Timog":["Bagong Kalsada","Bucana Malaki","Bancaan","Mabulo","Labac","Sapa"],"Ilayang Hilaga":["Calubcob","Halang","Palangue Central","Palangue 2&3","Sabang","Makina"],"Ilayang Timog":["Muzon","Malainen Bago","Malainen Luma","Molino","San Roque","Santulan"]},p0=()=>Object.keys(ER),eh=r=>ER[r]||[],Hq=({isOpen:r,onClose:e,onSubmit:t,isSaving:n})=>c.jsx(Vr,{isOpen:r,onClose:e,title:"Apply for Senior/PWD Discount",size:"lg",children:c.jsxs("div",{className:"space-y-6",children:[c.jsx("p",{className:"text-sm text-gray-600",children:"To apply for your Senior Citizen or PWD discount, you must provide a valid ID for verification. Please choose one of the following methods to submit your application."}),c.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[c.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center mb-2",children:[c.jsx(Fo,{size:18,className:"mr-2 text-blue-600"}),"Option 1: Online Submission (Email)"]}),c.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Email a clear photo of your valid Senior Citizen or PWD ID to our verification team."}),c.jsxs("ul",{className:"text-sm space-y-1 mb-3",children:[c.jsxs("li",{children:[c.jsx("strong",{children:"To:"})," ",c.jsx("a",{href:"mailto:admin@agwa.ph",className:"text-blue-600 hover:underline",children:"admin@agwa.ph"})]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Cc:"})," ",c.jsx("a",{href:"mailto:benjamesduag.edu@gmail.com",className:"text-blue-600 hover:underline",children:"benjamesduag.edu@gmail.com"})]}),c.jsxs("li",{children:[c.jsx("strong",{children:"Subject:"})," Discount Application - ","{Your Account Number}"]})]}),c.jsx("p",{className:"text-xs text-gray-500 bg-yellow-50 p-2 border border-yellow-200 rounded-md",children:'After emailing, click "Submit Application" below. Our team will review your email and update your account status within 2-3 business days.'})]}),c.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[c.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center mb-2",children:[c.jsx(C2,{size:18,className:"mr-2 text-green-600"}),"Option 2: In-Person Verification"]}),c.jsx("p",{className:"text-sm text-gray-600",children:"Visit any AGWA business office and present your valid ID to a customer service representative. Your account will be updated on the spot."})]}),c.jsxs("div",{className:"pt-4 flex flex-col sm:flex-row-reverse gap-3",children:[c.jsxs("button",{type:"button",onClick:t,className:"w-full sm:w-auto flex items-center justify-center px-6 py-2.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg",disabled:n,children:[n?c.jsx(Tt,{size:18,className:"animate-spin mr-2"}):c.jsx(vF,{size:18,className:"mr-2"}),n?"Submitting...":"Submit Application (Set to Pending)"]}),c.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto px-6 py-2.5 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg border",disabled:n,children:"Cancel"})]})]})}),to="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",cf="bg-gray-200 cursor-not-allowed text-gray-500",$q=({user:r,userData:e,setUserData:t,auth:n,db:i,showNotification:s})=>{var K;const[o,l]=X.useState(!1),[d,f]=X.useState({}),[m,p]=X.useState({district:"",barangay:"",street:"",landmark:""}),[g,v]=X.useState(!1),[E,x]=X.useState(""),[b,S]=X.useState([]),[N,R]=X.useState([]),[I,j]=X.useState(!1),U=(e==null?void 0:e.role)==="customer";X.useEffect(()=>{if(S(p0()),e)if(f({...e}),U&&e.serviceAddress&&typeof e.serviceAddress=="object"){const ee=e.serviceAddress.district||"";p(e.serviceAddress),ee&&R(eh(ee))}else p({district:"",barangay:"",street:"",landmark:""})},[e,U]);const P=ee=>!ee||typeof ee!="object"?"N/A":[ee.street,ee.barangay,ee.district,"Naic, Cavite"].filter(ie=>ie&&ie.trim()).join(", "),k=ee=>{const{name:se,value:ie}=ee.target;p(re=>{const G={...re,[se]:ie};return se==="district"&&(G.barangay="",R(eh(ie))),G})},F=ee=>{const{name:se,value:ie,type:re,checked:G}=ee.target;f(z=>({...z,[se]:re==="checkbox"?G:ie}))},O=async ee=>{var re,G;if(ee.preventDefault(),x(""),!((re=d.displayName)!=null&&re.trim())){x("Display Name cannot be empty.");return}v(!0);const se={displayName:d.displayName.trim(),photoURL:((G=d.photoURL)==null?void 0:G.trim())||"",serviceAddress:U?m:e.serviceAddress||{}},ie=await Sd(i,r.uid,se);if(!ie.success){s(ie.error||"Failed to update profile in database.","error"),v(!1);return}t(z=>({...z,...se})),s("Profile updated successfully!","success"),l(!1),v(!1)},C=()=>{l(!1),x(""),f({...e}),U&&e.serviceAddress&&typeof e.serviceAddress=="object"&&p(e.serviceAddress)},M=async()=>{v(!0);const ee={discountStatus:"pending"},se=await Sd(i,r.uid,ee);se.success?(t(ie=>({...ie,...ee})),f(ie=>({...ie,...ee})),s("Application submitted! Your status is now 'Pending Verification'.","success"),j(!1)):s(se.error||"Failed to submit application.","error"),v(!1)};if(!e)return c.jsx(ln,{message:"Loading profile..."});const D=d.photoURL||q8(d.displayName),$=d.discountStatus||"none";return c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[c.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center",children:[c.jsx(p3,{size:30,className:"mr-3 text-blue-600"})," My Profile"]}),!o&&c.jsxs("button",{onClick:()=>l(!0),className:"flex items-center bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg",children:[c.jsx(F2,{size:18,className:"mr-2"})," Edit Profile"]})]}),E&&c.jsxs("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg text-sm flex items-center",children:[c.jsx(Zt,{size:20,className:"mr-2"})," ",E]}),c.jsxs("form",{onSubmit:O,className:"space-y-5",children:[c.jsxs("div",{className:"text-center space-y-3",children:[c.jsx("img",{src:D,alt:"Profile",className:"h-28 w-28 rounded-full object-cover border-4 border-blue-200 shadow-md bg-gray-200 mx-auto"}),o&&c.jsx("input",{type:"url",name:"photoURL",value:d.photoURL||"",onChange:F,className:`${to} max-w-sm mx-auto text-center`,placeholder:"Image URL"})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs font-medium text-gray-600 mb-1 flex items-center",children:[c.jsx(Rs,{size:14,className:"mr-1.5"}),"Full Name"]}),o?c.jsx("input",{type:"text",name:"displayName",value:d.displayName||"",onChange:F,className:to}):c.jsx("p",{className:`${to} ${cf}`,children:d.displayName})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs font-medium text-gray-600 mb-1 flex items-center",children:[c.jsx(Fo,{size:14,className:"mr-1.5"}),"Email Address"]}),c.jsx("p",{className:`${to} ${cf}`,children:d.email})]}),U&&c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs font-medium text-gray-600 mb-1 flex items-center",children:[c.jsx(js,{size:14,className:"mr-1.5"}),"Account Number"]}),c.jsx("p",{className:`${to} ${cf}`,children:d.accountNumber})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"text-xs font-medium text-gray-600 mb-1 flex items-center",children:[c.jsx(Fx,{size:14,className:"mr-1.5"}),"User Role"]}),c.jsx("p",{className:`${to} ${cf} capitalize`,children:(K=d.role)==null?void 0:K.replace("_"," ")})]})]}),U&&c.jsxs("div",{className:"pt-4 mt-4 border-t",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Service Address"}),o?c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1",children:"District"}),c.jsxs("select",{name:"district",value:m.district,onChange:k,className:to,children:[c.jsx("option",{value:"",children:"Select District"}),b.map(ee=>c.jsx("option",{value:ee,children:ee},ee))]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1",children:"Barangay"}),c.jsxs("select",{name:"barangay",value:m.barangay,onChange:k,className:to,disabled:!m.district,children:[c.jsx("option",{value:"",children:"Select Barangay"}),N.map(ee=>c.jsx("option",{value:ee,children:ee},ee))]})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1",children:"Street Name, Building, House No."}),c.jsx("input",{type:"text",name:"street",value:m.street,onChange:k,className:to})]}),c.jsxs("div",{className:"md:col-span-2",children:[c.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1",children:"Landmark"}),c.jsx("input",{type:"text",name:"landmark",value:m.landmark,onChange:k,className:to})]})]}):c.jsx("p",{className:`${to} ${cf}`,children:P(d.serviceAddress)})]}),U&&c.jsxs("div",{className:"pt-4 mt-4 border-t",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Discount Status"}),c.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border bg-gray-50",children:[$==="none"&&c.jsxs("div",{className:"flex-grow",children:[c.jsx("p",{className:"font-medium text-gray-700",children:"No discount applied."}),c.jsx("p",{className:"text-xs text-gray-500",children:"Apply for a Senior Citizen / PWD discount."})]}),$==="pending"&&c.jsxs("div",{className:"flex-grow",children:[c.jsxs("p",{className:"font-medium text-yellow-700 flex items-center",children:[c.jsx(hi,{size:16,className:"mr-2"})," Application Pending Verification"]}),c.jsx("p",{className:"text-xs text-gray-500",children:"We are reviewing your application. Please wait for an admin to approve it."})]}),$==="verified"&&c.jsxs("div",{className:"flex-grow",children:[c.jsxs("p",{className:"font-medium text-green-700 flex items-center",children:[c.jsx(d3,{size:16,className:"mr-2"})," Discount Active"]}),c.jsx("p",{className:"text-xs text-gray-500",children:"Your Senior/PWD discount is active and will be applied to new bills."})]}),!o&&$==="none"&&c.jsx("button",{type:"button",onClick:()=>j(!0),className:"bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg text-sm",children:"Apply Now"})]})]}),o&&c.jsxs("div",{className:"flex justify-end space-x-4 pt-5",children:[c.jsx("button",{type:"button",onClick:C,className:"px-6 py-2.5 text-sm font-medium bg-gray-100 rounded-lg",disabled:g,children:"Cancel"}),c.jsxs("button",{type:"submit",className:"px-6 py-2.5 text-sm font-medium text-white bg-green-600 rounded-lg flex items-center",disabled:g,children:[g?c.jsx(Tt,{size:18,className:"animate-spin mr-2"}):c.jsx(Ha,{size:18,className:"mr-2"}),g?"Saving...":"Save Changes"]})]})]})]}),c.jsx(Hq,{isOpen:I,onClose:()=>j(!1),onSubmit:M,isSaving:g})]})};function Wq(r,e,t){const[n,i]=X.useState(r),[s,o]=X.useState({}),[l,d]=X.useState(!1),[f,m]=X.useState(!1),p=X.useCallback(x=>{const{name:b,value:S,type:N,checked:R}=x.target;i(I=>({...I,[b]:N==="checkbox"?R:S})),s[b]&&o(I=>({...I,[b]:void 0}))},[s]),g=X.useCallback((x,b)=>{i(S=>({...S,[x]:b})),s[x]&&o(S=>({...S,[x]:void 0}))},[s]),v=X.useCallback(()=>{i(r),o({}),d(!1),m(!1)},[r]);return{values:n,setValues:i,setFieldValue:g,errors:s,setErrors:o,isLoading:l,handleChange:p,handleSubmit:async x=>{if(x&&x.preventDefault(),f)return;m(!0),d(!0),o({});let b={};if(e&&(b=e(n),o(b)),Object.keys(b).length===0)try{t&&await t(n,v)}catch(S){console.error("Form submission error:",S),o(N=>({...N,submit:S.message||"An unexpected error occurred during submission."}))}d(!1),m(!1)},resetForm:v}}const y1="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",v1="flex items-center justify-center px-5 py-2.5 rounded-lg font-semibold transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95 text-sm",Gq=r=>!r||typeof r!="object"?"":[r.street,r.barangay,r.district].filter(t=>t&&t.trim()).join(", "),Kq=({user:r,userData:e,db:t,auth:n,showNotification:i})=>{const s=()=>e!=null&&e.serviceAddress&&typeof e.serviceAddress=="object"?Gq(e.serviceAddress):(e==null?void 0:e.accountNumber)||"",o={issueType:"",description:"",issueAddress:s()},[l,d]=X.useState(!1),[f,m]=X.useState(!1),p=C=>{const M={};return C.issueType||(M.issueType="Please select an issue type."),C.description.trim()||(M.description="Description cannot be empty."),C.issueAddress.trim()||(M.issueAddress="Please specify the location of the issue."),M},g=async(C,M)=>{const D={...C,userId:r.uid,userName:e.displayName,userEmail:e.email,accountNumber:e.accountNumber||"N/A"},$=await y9(t,D);$.success?(i("Support ticket submitted successfully!","success"),M()):i($.error||"Failed to submit ticket.","error")},{values:v,errors:E,isLoading:x,handleChange:b,handleSubmit:S,setFieldValue:N}=Wq(o,p,g),R=["Billing Discrepancy or Inquiry","Water Leak (Before Meter)","Water Leak (After Meter - Your Property)","No Water Supply / Low Pressure","Water Quality Issue (Color, Odor, Taste)","Meter Problem (Damaged, Stuck, Inaccurate)","Online Portal Issue / Account Access","Request for Service (Disconnection/Reconnection)","Chatbot Assistance Follow-up","Other Concern"],I=["Unable to Access Meter","Damaged or Tampered Meter Found","Suspected Illegal Connection","Route Data Inaccuracy","Safety Concern on Route","Device or App Problem","Customer Inquiry on Field","Other Field Report"],j=["Payment Posting Issue","Customer Account Inquiry","Bill Printing Problem","System Access/Login Issue","Other Office Concern"],U=["User Role/Permission Change Request","Data Correction Request","System Bug Report","Feature Request","Urgent System Alert"],[P,k]=X.useState(R);X.useEffect(()=>{switch(e==null?void 0:e.role){case"meter_reader":k(I);break;case"clerk_cashier":k(j);break;case"admin":k(U);break;default:k(R)}N("issueType","")},[e.role,N]),X.useEffect(()=>{N("issueAddress",s())},[e,N]);const F=async()=>{if(!v.description.trim()){i("Please describe your issue first before using the AI categorizer.","warning");return}d(!0);try{const D=[{role:"user",content:`Based on the following user complaint, which of these categories does it best fit into? Categories: [${P.join(", ")}]. Respond with only the exact category name from the list and nothing else. Complaint: "${v.description}"`}];let $=await Vo(D);$=$.replace(/["'.*]/g,"").trim(),P.includes($)?(N("issueType",$),i(`AI suggested category: "${$}"`,"success")):i("AI could not determine a matching category. Please select one manually.","info")}catch(C){const M=(C==null?void 0:C.message)||"AI categorization failed.";i(M,"error")}finally{d(!1)}},O=async()=>{if(!v.description.trim()){i("Please provide some keywords or a brief description for the AI to expand upon.","warning");return}m(!0);try{const M=[{role:"user",content:`You are helping a user report an issue to AGWA Water Services. Elaborate on the following user-provided details to create a clear, detailed, and formal issue description. Be polite and include any relevant questions the user might need to answer. Do not add any extra commentary, just provide the refined description.

User's input: "${v.description}"`}],D=await Vo(M);N("description",D),i("AI has helped draft your issue description!","success")}catch(C){const M=(C==null?void 0:C.message)||"AI assistance failed.";i(M,"error")}finally{m(!1)}};return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(Zt,{size:30,className:"mr-3 text-orange-500"})," Report an Issue or Concern"]})}),c.jsxs("form",{onSubmit:S,className:"space-y-6",children:[c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"issueType",className:"text-sm font-medium text-gray-700 mb-1 flex items-center",children:[c.jsx(l3,{size:16,className:"mr-1.5 text-gray-500"})," Issue Type / Category *"]}),c.jsxs("div",{className:"flex gap-2 items-center",children:[c.jsxs("select",{id:"issueType",name:"issueType",value:v.issueType,onChange:b,className:`${y1} ${E.issueType?"border-red-500":""}`,children:[c.jsx("option",{value:"",disabled:!0,children:"Select the type of issue..."}),P.map(C=>c.jsx("option",{value:C,children:C},C))]}),c.jsx(dm,{text:"Let AI suggest a category based on your description below.",children:c.jsx("button",{type:"button",onClick:F,className:`${v1} w-auto bg-blue-100 text-blue-700 hover:bg-blue-200 focus:ring-blue-300 px-3`,disabled:l||x,children:l?c.jsx(Tt,{size:16,className:"animate-spin"}):c.jsx(Ds,{size:16})})})]}),E.issueType&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.issueType})]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"issueAddress",className:"text-sm font-medium text-gray-700 mb-1 flex items-center",children:[c.jsx(co,{size:16,className:"mr-1.5 text-gray-500"})," Address / Location of Issue *"]}),c.jsx("input",{type:"text",id:"issueAddress",name:"issueAddress",value:v.issueAddress,onChange:b,className:`${y1} ${E.issueAddress?"border-red-500":""}`,placeholder:"E.g., Your service address, specific street, or account number if general"}),E.issueAddress&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.issueAddress})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between items-center mb-1",children:[c.jsxs("label",{htmlFor:"description",className:"text-sm font-medium text-gray-700 flex items-center",children:[c.jsx(cF,{size:16,className:"mr-1.5 text-gray-500"})," Detailed Description of Issue *"]}),c.jsx(dm,{text:v.description.trim()?"Use AI to help draft or refine your description.":"Write a description first to enable AI Assist",children:c.jsxs("button",{type:"button",onClick:O,className:`${v1} text-xs bg-purple-100 text-purple-700 hover:bg-purple-200 focus:ring-purple-300 py-1.5 px-3`,disabled:f||x||!v.description.trim(),children:[f?c.jsx(Tt,{size:16,className:"animate-spin mr-1.5"}):c.jsx(Ds,{size:16,className:"mr-1.5"}),f?"Drafting...":"AI Assist"]})})]}),c.jsx("textarea",{id:"description",name:"description",value:v.description,onChange:b,rows:"6",className:`${y1} ${E.description?"border-red-500":""}`,placeholder:"Please provide as much detail as possible: What is the problem? When did it start? Any specific error messages or observations?"}),E.description&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.description})]}),c.jsx("div",{className:"pt-3",children:c.jsxs("button",{type:"submit",className:`${v1} w-full bg-orange-500 hover:bg-orange-600 text-white focus:ring-orange-400`,disabled:x||f||l,children:[x?c.jsx(Tt,{size:20,className:"animate-spin mr-2"}):c.jsx(l0,{size:18,className:"mr-2"}),x?"Submitting Report...":"Submit Issue Report"]})})]})]})},Yq=[{q:"How do I register for an online account?",a:"Click 'Sign Up' on the login page. Provide your full name, AGWA account number (e.g., RES-12345), a valid email address, and create a password of at least 6 characters."},{q:"I forgot my password. How can I reset it?",a:"On the login page, click the 'Forgot Password?' link. Enter the email address associated with your AGWA account, and we'll send you a link to reset your password."},{q:"How can I pay my water bill through this portal?",a:"Once logged in, navigate to 'My Bills'. Select an unpaid bill, click 'Pay Now', and choose a simulated payment option (e.g., GCash, Maya, Bank Transfer, Credit Card). Please note that payments in this portal are for demonstration purposes only. For actual payments, please use AGWA's officially accredited payment channels."},{q:"How is my water consumption calculated?",a:"Your consumption is the difference between your current meter reading and your previous meter reading, measured in cubic meters (m). This consumption is then used with the tariff rates applicable to your service type to calculate your water bill charges."},{q:"What are the different charges on my bill?",a:"Your bill typically includes a Basic Charge (based on consumption and service type), Foreign Currency Differential Adjustment (FCDA), Environmental Charge (EC), Sewerage Charge (SC, if applicable), Maintenance Service Charge (based on your meter size), Government Taxes, and Value Added Tax (VAT). You can use the ' Explain Bill' feature in the 'My Bills' section for a personalized breakdown of a specific bill."},{q:"How can I view my past bills and payment history?",a:"Navigate to the 'My Bills' section after logging in. You'll find a history of your past bills, their status (Paid/Unpaid), and payment details if paid via the portal (simulated). You can also view a detailed invoice for each bill."},{q:"What should I do if I suspect a water leak at my premises?",a:"If it's safe to do so, try to identify the source of the leak and turn off your main water shut-off valve (usually located near your meter). Immediately report the suspected leak to AGWA via the 'Report Issue' section in the portal or by calling our 24/7 emergency hotline: 1627-AGWA (1627-2492)."},{q:"My water supply is interrupted. What should I do?",a:"First, check for any service advisories on our official AGWA website or social media channels. If there are no posted advisories for your area, please report the interruption via the 'Report Issue' section in the portal or call our customer service hotline with your account details."},{q:"Can I change my registered email address or other profile details?",a:"You can update your Display Name, Photo URL, Service Address, and Meter Size in the 'My Profile' section. For changes to critical information like your registered email address (if it's your primary login ID), account number, or assigned role, please contact AGWA customer support for assistance and verification."},{q:"What is FCDA (Foreign Currency Differential Adjustment)?",a:"FCDA is a tariff mechanism approved by regulatory bodies that allows water utilities like AGWA to recover or pass on to customers the gains or losses arising from fluctuations in foreign exchange rates. These fluctuations affect the cost of foreign currency-denominated loans and expenses used for service improvements and operational needs."},{q:"Why is there an Environmental Charge (EC) on my bill?",a:"The Environmental Charge (EC) is a fee collected to fund projects and initiatives related to wastewater treatment, septage management, and other environmental protection programs. This helps ensure that water resources are used sustainably and that wastewater is treated properly before being discharged back into the environment."},{q:"What if I think my water meter is malfunctioning or inaccurate?",a:"If you suspect your water meter is not recording your consumption accurately, please report it immediately. You can do this through the 'Report Issue' section of the portal (select 'Meter Problem') or by contacting AGWA customer service. We will arrange for an inspection and testing of your meter."},{q:"How often are water meters read?",a:"Water meters are typically read on a monthly cycle. The specific reading schedule can vary by area. Your billing statement will indicate the period covered by the meter reading (e.g., 'Billing Period: 01 Jan 2025 to 31 Jan 2025')."},{q:"Are there discounts for senior citizens or Persons with Disabilities (PWDs)?",a:"Yes, AGWA Water Services adheres to Republic Act No. 9994 (Expanded Senior Citizens Act) and Republic Act No. 10754 (Act Expanding the Benefits and Privileges of Persons with Disability). Qualified senior citizens and PWDs are entitled to a discount on their water consumption, subject to certain conditions (e.g., the account must be registered in their name, consumption limits). Please update your details in 'My Profile' or contact customer service with the necessary identification to apply for these discounts."},{q:"How do I update my contact number or service address on file with AGWA?",a:"You can update your Service Address directly in the 'My Profile' section of this portal. For changes to your primary contact number, especially if it's used for OTPs or critical alerts, it's best to contact AGWA customer service or visit one of our business offices to ensure your records are accurately updated and verified."},{q:"What are the accepted payment methods for my water bill?",a:"This portal simulates payments via various methods for demonstration. For actual payments, AGWA accepts payments through a wide range of accredited channels, including: AGWA Business Offices, Bayad Centers, 7-Eleven, SM Bills Payment, selected banks (over-the-counter and online banking), and mobile wallets like GCash and Maya. Please refer to the official AGWA website or your bill statement for a complete list of authorized payment partners."},{q:"How can I get an official receipt (OR) after making a payment?",a:"For payments made through this portal (which are simulated), a transaction reference is provided. For actual payments made via AGWA's accredited channels, an official receipt or proof of payment will be issued by that specific channel (e.g., a bank validation slip, a payment center receipt, a digital receipt from an e-wallet). AGWA is continuously working on enhancing digital services, including the future provision of consolidated digital ORs through the portal."},{q:"What is a 'meter deposit' for new service connections?",a:"A meter deposit is a one-time charge collected from customers upon application for a new water service connection. This deposit serves as a security against potential unpaid bills or damages to the water meter. It is refundable, with interest (if applicable by law), upon termination of the service contract, provided all outstanding obligations to AGWA have been settled."},{q:"How do I report a damaged, leaking, or stolen water meter?",a:"Report any instance of a damaged, leaking, or stolen water meter to AGWA immediately. You can use the 'Report Issue' section in this portal (select 'Meter Problem') or call our emergency hotline. Tampering with or unauthorized removal of water meters is illegal and may result in penalties."},{q:"Can I request for a temporary disconnection of my water service if I'll be away for an extended period?",a:"Yes, you can request a temporary or voluntary disconnection of your water service. To do this, please visit any AGWA business office to file your formal request. There might be applicable fees for the disconnection and subsequent reconnection process. Please inquire about the specific requirements and charges."}],Zq=()=>c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(fF,{size:30,className:"mr-3 text-blue-600"}),"Frequently Asked Questions"]})}),c.jsx("div",{className:"space-y-4",children:Yq.map((r,e)=>c.jsxs("details",{className:"group bg-gray-50 hover:bg-gray-100 p-4 rounded-lg shadow-sm hover:shadow-md transition-all duration-200 ease-in-out",children:[c.jsxs("summary",{className:"flex justify-between items-center font-medium cursor-pointer list-none text-gray-900 text-sm sm:text-base",children:[c.jsx("span",{className:"group-open:text-blue-700 group-open:font-semibold",children:r.q}),c.jsx("span",{className:"transition-transform duration-300 transform group-open:rotate-180 text-blue-600 group-open:text-blue-700",children:c.jsx(R2,{size:24})})]}),c.jsx("div",{className:"text-gray-600 mt-3 prose prose-sm max-w-none grid grid-rows-[0fr] group-open:grid-rows-[1fr] transition-all duration-500 ease-in-out",children:c.jsx("div",{className:"overflow-hidden",children:c.jsx("p",{className:"pb-2",children:r.a})})})]},e))})]}),Qq=()=>{const r=[{letter:"C",word:"Customer-Centricity",desc:"Our customers are at the heart of every decision and action we take, ensuring their needs are met with utmost priority and care.",icon:Rs},{letter:"R",word:"Responsibility",desc:"We hold ourselves accountable for our impact on the communities we serve and the environment, operating with integrity and a commitment to social good.",icon:hh},{letter:"E",word:"Excellence",desc:"We relentlessly pursue the highest standards in all aspects of our service, operations, and innovation, striving for continuous improvement.",icon:Ds},{letter:"S",word:"Sustainability",desc:"We are dedicated to the long-term health and viability of our precious water resources and the planet, implementing eco-friendly practices.",icon:ac},{letter:"T",word:"Teamwork & Integrity",desc:"We foster a collaborative environment built on mutual respect, honesty, and transparency, working together to achieve our common goals.",icon:Ia}],e=[{title:"Deliver Quality",description:"Consistently provide safe, reliable, and affordable water and wastewater services that exceed customer expectations and meet stringent regulatory standards."},{title:"Innovate & Adapt",description:"Embrace technological advancements and innovative practices to enhance operational efficiency, service delivery, and resource management in an ever-changing world."},{title:"Customer First",description:"Cultivate a culture of exceptional customer care through responsive, transparent, fair, and easily accessible service channels, including this advanced digital portal."},{title:"Protect Resources",description:"Champion water conservation, actively work to reduce non-revenue water, and promote environmental protection through sustainable practices and robust community engagement."},{title:"Empower People",description:"Invest in the growth, professional development, and overall well-being of our employees, fostering a skilled, motivated, diverse, and safety-conscious workforce."},{title:"Community Partnership",description:"Actively contribute to the socio-economic development, health, and resilience of the communities we serve through targeted corporate social responsibility programs and collaborative partnerships."}];return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn leading-relaxed text-gray-700",children:[c.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(yn,{size:30,className:"mr-3 text-blue-600"}),"About AGWA Water Services, Inc."]})}),c.jsxs("section",{className:"mb-8",children:[c.jsxs("h3",{className:"text-xl font-semibold text-blue-700 mb-2 flex items-center",children:[c.jsx(C2,{size:22,className:"mr-2.5 text-blue-600/80"})," Our Genesis & Enduring Commitment"]}),c.jsx("p",{children:"AGWA Water Services, Inc. was established in 2005 with a singular, profound vision: to ensure every Filipino has access to clean, safe, and sustainable water. Recognizing water as the cornerstone of life, health, and economic progress, AGWA embarked on a mission to become a leading force in the Philippine water utility sector. From humble beginnings, we have grown through unwavering dedication, strategic investments in infrastructure and technology, and a deep-rooted commitment to the communities we are privileged to serve. Our journey has been one of continuous learning, adaptation, and an ever-stronger resolve to meet the evolving water needs of a dynamic nation."})]}),c.jsxs("section",{className:"mb-8",children:[c.jsxs("h3",{className:"text-xl font-semibold text-blue-700 mb-2 flex items-center",children:[c.jsx(Ds,{size:22,className:"mr-2.5 text-blue-600/80"})," Operational Excellence & Innovation"]}),c.jsx("p",{children:"At the heart of AGWA lies a relentless pursuit of excellence. We employ state-of-the-art water sourcing techniques, advanced multi-stage treatment processes, and smart distribution networks, all managed by a team of highly skilled engineers, certified technicians, and dedicated customer service professionals. Our operations strictly adhere to, and often exceed, national and international quality standards (PNSDW, WHO guidelines), ensuring that the water reaching your taps is not just potable but of the highest purity and reliability. We continuously invest in research and development to innovate and improve our services, from leak detection technologies and pressure management systems to digital customer interfaces and data-driven resource planning."})]}),c.jsxs("section",{className:"mb-8",children:[c.jsxs("h3",{className:"text-xl font-semibold text-blue-700 mb-2 flex items-center",children:[c.jsx(ac,{size:22,className:"mr-2.5 text-blue-600/80"})," Sustainability and Environmental Stewardship: Our Pledge"]}),c.jsx("p",{children:"AGWA is profoundly aware of its responsibility as a steward of one of Earth's most precious resources. Sustainability is not just a buzzword for us; it's integrated into every facet of our operations. This includes responsible water abstraction from diverse sources, active participation in watershed protection and reforestation programs, and the implementation of advanced wastewater treatment and water recycling initiatives to minimize our environmental footprint. We actively promote water conservation education among our consumers and invest in projects that enhance climate resilience and mitigate environmental impact, ensuring that future generations can also enjoy the gift of clean water."})]}),c.jsxs("div",{className:"my-10 p-6 bg-gradient-to-r from-blue-600 to-indigo-700 text-white rounded-xl shadow-xl text-center",children:[c.jsx(ja,{size:36,className:"mx-auto mb-3 text-blue-200"}),c.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Our Vision"}),c.jsx("p",{className:"italic text-lg text-blue-100 leading-relaxed max-w-3xl mx-auto",children:`"To be the Philippines' most trusted and innovative water solutions provider, empowering communities with sustainable access to life-enhancing water services and championing environmental stewardship for a resilient future."`})]}),c.jsxs("div",{className:"my-10",children:[c.jsxs("h3",{className:"text-2xl font-bold text-blue-700 mb-6 text-center flex items-center justify-center",children:[c.jsx(gF,{size:28,className:"mr-3 text-blue-600"})," Our Mission"]}),c.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-5",children:e.map((t,n)=>c.jsxs("div",{className:"bg-blue-50 p-5 rounded-lg shadow-md hover:shadow-lg transition-shadow h-full flex flex-col",children:[c.jsx("strong",{className:"text-blue-700 block text-md mb-1.5",children:t.title}),c.jsx("p",{className:"text-sm text-gray-600 leading-normal flex-grow",children:t.description})]},n))})]}),c.jsxs("div",{className:"my-12 pt-8 border-t border-gray-200",children:[c.jsx("h3",{className:"text-2xl font-bold text-blue-700 mb-8 text-center",children:"Our Core Values: The AGWA C.R.E.S.T."}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-5",children:r.map(t=>{const n=t.icon;return c.jsxs("div",{className:"p-5 border border-blue-100 rounded-xl bg-white shadow-lg hover:shadow-2xl transition-all duration-300 flex flex-col items-center text-center h-full hover:border-blue-300 transform hover:-translate-y-1",children:[c.jsx("div",{className:"p-3 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 text-white mb-3 shadow-md",children:c.jsx(n,{className:"",size:32})}),c.jsx("p",{className:"text-4xl font-bold text-blue-600 mb-1",children:t.letter}),c.jsx("strong",{className:"text-blue-700 block text-md mb-1.5",children:t.word}),c.jsx("p",{className:"text-xs text-gray-600 mt-1 leading-snug flex-grow",children:t.desc})]},t.letter)})})]}),c.jsx("p",{className:"pt-8 mt-8 text-gray-800 font-medium text-center text-lg border-t border-gray-200",children:"AGWA Water Services, Inc.  Ensuring Clarity, Sustaining Life."})]})},Xq=({type:r,href:e})=>{let t,n="hover:text-blue-700";switch(r){case"Facebook":t=tF,n="hover:text-blue-600";break;case"Twitter":t=yF,n="hover:text-sky-500";break;case"Instagram":t=sF,n="hover:text-pink-600";break;default:return null}return c.jsx("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:`text-gray-500 transition-colors duration-200 ${n}`,title:r,children:c.jsx(t,{size:28})})},Jq=({systemSettings:r={}})=>{const{supportHotline:e="1627-AGWA (24/7 Emergency)",supportEmail:t="support@agwa-waterservices.com.ph"}=r,n=[{icon:u3,title:"Customer Service Hotlines",lines:[{text:e,valueClass:"text-2xl font-semibold text-blue-700 tracking-tight"},{text:"(+63 2) 8162-2492 (Outside Metro Manila / Standard Hours)",valueClass:"text-lg text-gray-700"}],note:"Emergency reports are handled 24/7. General inquiries: Mon - Fri, 8 AM - 5 PM PHT.",bgColor:"bg-blue-50",iconColor:"text-blue-600"},{icon:Fo,title:"Email Support",lines:[{text:t,valueClass:"text-lg text-green-700 hover:underline"}],note:"For general inquiries, billing concerns, feedback, and non-urgent requests. Expect a response within 1-2 business days.",href:`mailto:${t}`,bgColor:"bg-green-50",iconColor:"text-green-600"}],i={title:"AGWA Head Office",addressLines:["AGWA Water Services Bldg.","Governor's Drive, Brgy. Ibayo Silangan","Naic, Cavite, Philippines 4110"],hours:"Mon - Fri, 8:00 AM - 5:00 PM PHT (Closed on weekends & public holidays)",note:"Walk-ins are welcome for payments and specific services. For complex concerns, an appointment is recommended to ensure specialist availability.",mapLink:"https://www.google.com/maps/place/Naic,+Cavite/",bgColor:"bg-gray-100",iconColor:"text-gray-600"},s=[{type:"Facebook",href:"https://facebook.com/AGWAwaterservices"},{type:"Twitter",href:"https://twitter.com/AGWAwaterserv"},{type:"Instagram",href:"https://instagram.com/AGWAwater"}];return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(Oa,{size:30,className:"mr-3 text-blue-600"}),"Get In Touch With AGWA"]})}),c.jsx("p",{className:"text-gray-700 mb-8 leading-relaxed text-sm sm:text-base",children:"We value your feedback and are dedicated to assisting you with your water service needs. For immediate assistance, especially during emergencies like major leaks or widespread service interruptions, please use our 24/7 hotline. For other inquiries, choose the most convenient channel below."}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:n.map((o,l)=>{const d=o.icon;return c.jsxs("div",{className:`p-5 rounded-xl shadow-lg hover:shadow-xl transition-shadow ${o.bgColor} border border-gray-200`,children:[c.jsxs("div",{className:"flex items-start mb-3",children:[c.jsx(d,{size:28,className:`mr-4 mt-1 flex-shrink-0 ${o.iconColor}`}),c.jsxs("div",{children:[c.jsx("h3",{className:`text-lg font-semibold ${o.iconColor}`,children:o.title}),o.lines.map((f,m)=>o.href&&m===0?c.jsx("a",{href:o.href,className:f.valueClass,children:f.text},m):c.jsx("p",{className:f.valueClass,children:f.text},m))]})]}),c.jsx("p",{className:"text-xs text-gray-500 leading-normal",children:o.note})]},l)})}),c.jsxs("div",{className:`p-5 rounded-xl shadow-lg hover:shadow-xl transition-shadow mb-8 ${i.bgColor} border border-gray-200`,children:[c.jsxs("div",{className:"flex items-start mb-3",children:[c.jsx(C2,{size:28,className:`mr-4 mt-1 flex-shrink-0 ${i.iconColor}`}),c.jsxs("div",{children:[c.jsx("h3",{className:`text-lg font-semibold ${i.iconColor}`,children:i.title}),i.addressLines.map((o,l)=>c.jsx("p",{className:"text-sm text-gray-700 leading-snug",children:o},l))]})]}),c.jsxs("div",{className:"text-sm text-gray-600 space-y-1 mt-2",children:[c.jsxs("p",{className:"flex items-center",children:[c.jsx(hi,{size:14,className:"mr-2 text-gray-500"}),c.jsx("strong",{children:"Hours:"})," ",i.hours]}),c.jsxs("p",{className:"flex items-start",children:[c.jsx(co,{size:14,className:"mr-2 mt-0.5 text-gray-500 flex-shrink-0"}),c.jsx("strong",{children:"Location Note:"})," ",i.note]})]}),c.jsxs("a",{href:i.mapLink,target:"_blank",rel:"noopener noreferrer",className:"mt-3 inline-flex items-center text-xs text-blue-600 hover:text-blue-800 hover:underline font-medium",children:["View on Map ",c.jsx(co,{size:12,className:"ml-1"})]})]}),c.jsxs("div",{className:"mt-10 text-center border-t border-gray-200 pt-8",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"Stay Connected"}),c.jsx("p",{className:"text-sm text-gray-600 mb-5 max-w-md mx-auto",children:"Follow us on our official social media channels for the latest news, service advisories, water conservation tips, and community program updates."}),c.jsx("div",{className:"flex justify-center space-x-6 sm:space-x-8",children:s.map(o=>c.jsx(Xq,{type:o.type,href:o.href},o.type))}),c.jsxs("p",{className:"mt-8 text-xs text-gray-500",children:["For online self-service options, please ",c.jsx("button",{onClick:()=>{alert("Please log in to access self-service options.")},className:"text-blue-600 hover:underline font-medium",children:"log in"})," to your account. ",c.jsx("br",{}),"General information is also available on our official website: ",c.jsx("a",{href:"https://www.agwa-waterservices.com.ph",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline font-medium",children:"www.agwa-waterservices.com.ph"})]})]})]})},eH=({user:r,userData:e,db:t,showNotification:n,setActiveSection:i})=>{const[s,o]=X.useState({totalUsers:0,openTickets:0,activeAnnouncements:0,systemStatus:"Operational"}),[l,d]=X.useState(!0),[f,m]=X.useState(""),p=X.useCallback(async()=>{d(!0),m("");try{const v=await Promise.allSettled([s3(t),o3(t),P9(t)]),[E,x,b]=v,S={systemStatus:"Operational"};let N="";E.status==="fulfilled"&&E.value.success?S.totalUsers=E.value.data.total:N+="Users data unavailable. ",x.status==="fulfilled"&&x.value.success?S.openTickets=x.value.data.openCount||0:N+="Tickets data unavailable. ",b.status==="fulfilled"&&b.value.success?S.activeAnnouncements=b.value.data.active:N+="Announcements data unavailable. ",o(R=>({...R,...S})),N.trim()&&(m(N.trim()),n(`Partial data load: ${N}`,"warning"))}catch{const E="A critical error occurred while fetching dashboard statistics.";m(E),n(E,"error"),o(x=>({...x,systemStatus:"Error"}))}finally{d(!1)}},[t,n]);X.useEffect(()=>{p()},[p]);const g=[{title:"User Management",icon:Ia,section:"userManagement",description:"View, edit, and manage all user accounts.",color:"blue"},{title:"Support Tickets",icon:Oa,section:"supportTickets",description:"Address and manage user-submitted issues.",color:"purple"},{title:"Announcements",icon:Rd,section:"manageAnnouncements",description:"Create and publish portal-wide announcements.",color:"teal"},{title:"System Analytics",icon:k2,section:"systemAnalytics",description:"View key metrics and system performance data.",color:"orange"},{title:"Meter Readings Mgt.",icon:ac,section:"editMeterReadingsAdmin",description:"Oversee and manage meter reading entries.",color:"sky"},{title:"System Settings",icon:c0,section:"systemSettings",description:"Configure application parameters and settings.",color:"gray"}];return l?c.jsx(ln,{message:"Loading admin dashboard statistics...",className:"mt-10 h-48"}):c.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[c.jsx("div",{className:"p-6 bg-gradient-to-r from-slate-700 to-slate-900 text-white rounded-xl shadow-2xl",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl sm:text-3xl font-bold",children:"Administrator Dashboard"}),c.jsxs("p",{className:"mt-1 text-slate-300",children:["Welcome, ",(e==null?void 0:e.displayName)||"Admin",". Oversee portal operations."]})]}),c.jsxs("button",{onClick:p,className:"text-sm flex items-center bg-slate-600 hover:bg-slate-500 text-white font-medium py-2 px-3 rounded-lg transition-colors disabled:opacity-70",disabled:l,title:"Refresh Statistics",children:[l?c.jsx(Tt,{size:16,className:"animate-spin"}):c.jsx(qa,{size:16}),c.jsx("span",{className:"ml-2 hidden sm:inline",children:"Refresh"})]})]})}),f&&c.jsxs("p",{className:"text-sm text-yellow-600 bg-yellow-50 p-3 rounded-md text-center flex items-center justify-center gap-2",children:[c.jsx(yn,{size:16})," ",f]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5",children:[c.jsx(fi,{title:"Total Users",value:s.totalUsers??"N/A",icon:Ia,borderColor:"border-blue-500",iconColor:"text-blue-500",onClick:()=>i("userManagement")}),c.jsx(fi,{title:"Open Support Tickets",value:s.openTickets,icon:Zt,borderColor:"border-red-500",iconColor:"text-red-500",onClick:()=>i("supportTickets")}),c.jsx(fi,{title:"Active Announcements",value:s.activeAnnouncements??"N/A",icon:Rd,borderColor:"border-teal-500",iconColor:"text-teal-500",onClick:()=>i("viewAnnouncements")}),c.jsx(fi,{title:"System Status",value:s.systemStatus,icon:hh,borderColor:s.systemStatus==="Error"?"border-red-500":"border-green-500",iconColor:s.systemStatus==="Error"?"text-red-500":"text-green-500"})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-5 mt-8 pt-5 border-t border-gray-200",children:"Administrative Tools"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(v=>c.jsxs("button",{onClick:()=>i(v.section),className:`p-6 bg-white rounded-xl shadow-lg hover:shadow-2xl transform hover:-translate-y-1.5 transition-all duration-300 ease-in-out text-left focus:outline-none focus:ring-2 focus:ring-${v.color}-500 focus:ring-opacity-75 group h-full flex flex-col`,children:[c.jsx("div",{className:`p-3 bg-${v.color}-100 rounded-full inline-block mb-3 self-start group-hover:scale-110 transition-transform`,children:c.jsx(v.icon,{size:28,className:`text-${v.color}-600`})}),c.jsx("h4",{className:`text-lg font-semibold text-gray-800 group-hover:text-${v.color}-700 transition-colors`,children:v.title}),c.jsx("p",{className:"text-sm text-gray-500 mt-1 leading-normal flex-grow",children:v.description})]},v.section))})]})]})},Li="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",RN="bg-gray-200 cursor-not-allowed text-gray-500",tH=({user:r,isOpen:e,onClose:t,onSave:n,isSaving:i,determineServiceTypeAndRole:s})=>{const[o,l]=X.useState({displayName:"",email:"",accountNumber:"",accountStatus:"Active",role:"customer",serviceType:"Residential",meterSerialNumber:"",meterSize:'1/2"',discountStatus:"none",photoURL:""}),[d,f]=X.useState({district:"",barangay:"",street:"",landmark:""}),[m,p]=X.useState([]),[g,v]=X.useState([]),E=o.role==="customer";X.useEffect(()=>{if(p(p0()),r){const N=r.role||"customer",R=N==="customer";if(l({displayName:r.displayName||"",email:r.email||"",accountNumber:r.accountNumber||"",accountStatus:r.accountStatus||"Active",role:N,serviceType:r.serviceType||"Residential",meterSerialNumber:r.meterSerialNumber||"",meterSize:r.meterSize||'1/2"',discountStatus:r.discountStatus||"none",photoURL:r.photoURL||""}),R&&r.serviceAddress&&typeof r.serviceAddress=="object"){const I=r.serviceAddress.district||"";f({district:r.serviceAddress.district||"",barangay:r.serviceAddress.barangay||"",street:r.serviceAddress.street||"",landmark:r.serviceAddress.landmark||""}),I&&v(eh(I))}else f({district:"",barangay:"",street:"",landmark:""})}},[r]);const x=N=>{const{name:R,value:I}=N.target;f(j=>{const U={...j,[R]:I};return R==="district"&&(U.barangay="",v(eh(I))),U})},b=N=>{const{name:R,value:I,type:j,checked:U}=N.target;let P={...o,[R]:j==="checkbox"?U:I};if(R==="accountNumber"&&s){const{role:k,serviceType:F}=s(I);P={...P,role:k,serviceType:F}}if(R==="role"&&I!=="customer"){P.accountNumber="",P.meterSerialNumber="",P.meterSize="",P.discountStatus="none";const{serviceType:k}=s("");P.serviceType=k,f({district:"",barangay:"",street:"",landmark:""})}l(P)},S=N=>{N.preventDefault();const R={...o,serviceAddress:E?d:{}};E||(delete R.meterSerialNumber,delete R.meterSize,delete R.serviceAddress,delete R.discountStatus),n(R)};return c.jsx(Vr,{isOpen:e,onClose:t,title:`Edit User: ${r.displayName||r.email}`,size:"3xl",children:c.jsxs("form",{onSubmit:S,className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsx("input",{type:"text",name:"displayName",value:o.displayName,onChange:b,className:Li,placeholder:"Full Name"}),c.jsx("input",{type:"email",name:"email",value:o.email,className:`${Li} ${RN}`,disabled:!0}),c.jsx("select",{name:"role",value:o.role,onChange:b,className:`${Li} capitalize`,children:["customer","admin","meter_reader","clerk_cashier"].map(N=>c.jsx("option",{value:N,children:N.replace("_"," ")},N))}),c.jsxs("select",{name:"accountStatus",value:o.accountStatus,onChange:b,className:Li,children:[c.jsx("option",{value:"Active",children:"Active"}),c.jsx("option",{value:"Inactive",children:"Inactive"}),c.jsx("option",{value:"Suspended",children:"Suspended"})]}),c.jsx("input",{type:"text",name:"accountNumber",value:o.accountNumber,onChange:b,className:Li,placeholder:"Account Number",disabled:!E}),c.jsx("input",{type:"text",name:"serviceType",value:o.serviceType,className:`${Li} ${RN}`,disabled:!0}),E&&c.jsxs(c.Fragment,{children:[c.jsx("input",{type:"text",name:"meterSerialNumber",value:o.meterSerialNumber,onChange:b,className:Li,placeholder:"Meter Serial Number"}),c.jsx("input",{type:"text",name:"meterSize",value:o.meterSize,onChange:b,className:Li,placeholder:"Meter Size"})]})]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"photoURL",className:"block text-sm font-medium text-gray-700 mb-1",children:[c.jsx(W9,{size:14,className:"inline mr-1.5"}),"Photo URL"]}),c.jsx("input",{type:"url",name:"photoURL",value:o.photoURL,onChange:b,className:Li,placeholder:"https://example.com/image.png"})]}),E&&c.jsxs("div",{className:"pt-4 mt-4 border-t",children:[c.jsx("h3",{className:"text-md font-semibold text-gray-700 mb-2",children:"Service Address"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("select",{name:"district",value:d.district,onChange:x,className:Li,children:[c.jsx("option",{value:"",children:"Select District"}),m.map(N=>c.jsx("option",{value:N,children:N},N))]}),c.jsxs("select",{name:"barangay",value:d.barangay,onChange:x,className:Li,disabled:!d.district,children:[c.jsx("option",{value:"",children:"Select Barangay"}),g.map(N=>c.jsx("option",{value:N,children:N},N))]}),c.jsx("div",{className:"md:col-span-2",children:c.jsx("input",{type:"text",name:"street",value:d.street,onChange:x,className:Li,placeholder:"Street Name, Building, House No."})}),c.jsx("div",{className:"md:col-span-2",children:c.jsx("input",{type:"text",name:"landmark",value:d.landmark,onChange:x,className:Li,placeholder:"Landmark"})})]})]}),E&&c.jsxs("div",{className:"pt-4 mt-4 border-t",children:[c.jsx("h3",{className:"text-md font-semibold text-gray-700 mb-2",children:"Discount Status"}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"discountStatus",className:"block text-xs font-medium text-gray-600 mb-1",children:"Set Verification Status"}),c.jsxs("select",{id:"discountStatus",name:"discountStatus",value:o.discountStatus,onChange:b,className:Li,children:[c.jsx("option",{value:"none",children:"None"}),c.jsx("option",{value:"pending",children:"Pending Verification"}),c.jsx("option",{value:"verified",children:"Verified (Active)"})]}),c.jsxs("p",{className:"text-xs text-gray-500 mt-1 p-2 bg-yellow-50 border border-yellow-200 rounded-md",children:[c.jsx(yn,{size:14,className:"inline mr-1.5"}),c.jsx("strong",{children:"Admin Only:"}),' Set to "Verified" only after seeing a valid Senior/PWD ID.']})]})]}),c.jsxs("div",{className:"pt-4 flex justify-end space-x-3",children:[c.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg border",disabled:i,children:"Cancel"}),c.jsxs("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg flex items-center",disabled:i,children:[i?c.jsx(Tt,{size:18,className:"animate-spin mr-2"}):c.jsx(Ha,{size:18,className:"mr-2"}),i?"Saving...":"Save Changes"]})]})]})})};function Jx(){return Jx=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Jx.apply(null,arguments)}function jN(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function eb(r,e){return eb=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},eb(r,e)}function nH(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,eb(r,e)}var ON=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function rH(r,e){return!!(r===e||ON(r)&&ON(e))}function iH(r,e){if(r.length!==e.length)return!1;for(var t=0;t<r.length;t++)if(!rH(r[t],e[t]))return!1;return!0}function _1(r,e){e===void 0&&(e=iH);var t,n=[],i,s=!1;function o(){for(var l=[],d=0;d<arguments.length;d++)l[d]=arguments[d];return s&&t===this&&e(l,n)||(i=r.apply(this,l),s=!0,t=this,n=l),i}return o}var sH=typeof performance=="object"&&typeof performance.now=="function",DN=sH?function(){return performance.now()}:function(){return Date.now()};function MN(r){cancelAnimationFrame(r.id)}function oH(r,e){var t=DN();function n(){DN()-t>=e?r.call(null):i.id=requestAnimationFrame(n)}var i={id:requestAnimationFrame(n)};return i}var x1=-1;function LN(r){if(r===void 0&&(r=!1),x1===-1||r){var e=document.createElement("div"),t=e.style;t.width="50px",t.height="50px",t.overflow="scroll",document.body.appendChild(e),x1=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return x1}var vd=null;function FN(r){if(r===void 0&&(r=!1),vd===null||r){var e=document.createElement("div"),t=e.style;t.width="50px",t.height="50px",t.overflow="scroll",t.direction="rtl";var n=document.createElement("div"),i=n.style;return i.width="100px",i.height="100px",e.appendChild(n),document.body.appendChild(e),e.scrollLeft>0?vd="positive-descending":(e.scrollLeft=1,e.scrollLeft===0?vd="negative":vd="positive-ascending"),document.body.removeChild(e),vd}return vd}var aH=150,lH=function(e,t){return e};function cH(r){var e,t=r.getItemOffset,n=r.getEstimatedTotalSize,i=r.getItemSize,s=r.getOffsetForIndexAndAlignment,o=r.getStartIndexForOffset,l=r.getStopIndexForStartIndex,d=r.initInstanceProps,f=r.shouldResetStyleCacheOnItemSizeChange,m=r.validateProps;return e=function(p){nH(g,p);function g(E){var x;return x=p.call(this,E)||this,x._instanceProps=d(x.props,jN(x)),x._outerRef=void 0,x._resetIsScrollingTimeoutId=null,x.state={instance:jN(x),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof x.props.initialScrollOffset=="number"?x.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},x._callOnItemsRendered=void 0,x._callOnItemsRendered=_1(function(b,S,N,R){return x.props.onItemsRendered({overscanStartIndex:b,overscanStopIndex:S,visibleStartIndex:N,visibleStopIndex:R})}),x._callOnScroll=void 0,x._callOnScroll=_1(function(b,S,N){return x.props.onScroll({scrollDirection:b,scrollOffset:S,scrollUpdateWasRequested:N})}),x._getItemStyle=void 0,x._getItemStyle=function(b){var S=x.props,N=S.direction,R=S.itemSize,I=S.layout,j=x._getItemStyleCache(f&&R,f&&I,f&&N),U;if(j.hasOwnProperty(b))U=j[b];else{var P=t(x.props,b,x._instanceProps),k=i(x.props,b,x._instanceProps),F=N==="horizontal"||I==="horizontal",O=N==="rtl",C=F?P:0;j[b]=U={position:"absolute",left:O?void 0:C,right:O?C:void 0,top:F?0:P,height:F?"100%":k,width:F?k:"100%"}}return U},x._getItemStyleCache=void 0,x._getItemStyleCache=_1(function(b,S,N){return{}}),x._onScrollHorizontal=function(b){var S=b.currentTarget,N=S.clientWidth,R=S.scrollLeft,I=S.scrollWidth;x.setState(function(j){if(j.scrollOffset===R)return null;var U=x.props.direction,P=R;if(U==="rtl")switch(FN()){case"negative":P=-R;break;case"positive-descending":P=I-N-R;break}return P=Math.max(0,Math.min(P,I-N)),{isScrolling:!0,scrollDirection:j.scrollOffset<P?"forward":"backward",scrollOffset:P,scrollUpdateWasRequested:!1}},x._resetIsScrollingDebounced)},x._onScrollVertical=function(b){var S=b.currentTarget,N=S.clientHeight,R=S.scrollHeight,I=S.scrollTop;x.setState(function(j){if(j.scrollOffset===I)return null;var U=Math.max(0,Math.min(I,R-N));return{isScrolling:!0,scrollDirection:j.scrollOffset<U?"forward":"backward",scrollOffset:U,scrollUpdateWasRequested:!1}},x._resetIsScrollingDebounced)},x._outerRefSetter=function(b){var S=x.props.outerRef;x._outerRef=b,typeof S=="function"?S(b):S!=null&&typeof S=="object"&&S.hasOwnProperty("current")&&(S.current=b)},x._resetIsScrollingDebounced=function(){x._resetIsScrollingTimeoutId!==null&&MN(x._resetIsScrollingTimeoutId),x._resetIsScrollingTimeoutId=oH(x._resetIsScrolling,aH)},x._resetIsScrolling=function(){x._resetIsScrollingTimeoutId=null,x.setState({isScrolling:!1},function(){x._getItemStyleCache(-1,null)})},x}g.getDerivedStateFromProps=function(x,b){return uH(x,b),m(x),null};var v=g.prototype;return v.scrollTo=function(x){x=Math.max(0,x),this.setState(function(b){return b.scrollOffset===x?null:{scrollDirection:b.scrollOffset<x?"forward":"backward",scrollOffset:x,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},v.scrollToItem=function(x,b){b===void 0&&(b="auto");var S=this.props,N=S.itemCount,R=S.layout,I=this.state.scrollOffset;x=Math.max(0,Math.min(x,N-1));var j=0;if(this._outerRef){var U=this._outerRef;R==="vertical"?j=U.scrollWidth>U.clientWidth?LN():0:j=U.scrollHeight>U.clientHeight?LN():0}this.scrollTo(s(this.props,x,b,I,this._instanceProps,j))},v.componentDidMount=function(){var x=this.props,b=x.direction,S=x.initialScrollOffset,N=x.layout;if(typeof S=="number"&&this._outerRef!=null){var R=this._outerRef;b==="horizontal"||N==="horizontal"?R.scrollLeft=S:R.scrollTop=S}this._callPropsCallbacks()},v.componentDidUpdate=function(){var x=this.props,b=x.direction,S=x.layout,N=this.state,R=N.scrollOffset,I=N.scrollUpdateWasRequested;if(I&&this._outerRef!=null){var j=this._outerRef;if(b==="horizontal"||S==="horizontal")if(b==="rtl")switch(FN()){case"negative":j.scrollLeft=-R;break;case"positive-ascending":j.scrollLeft=R;break;default:var U=j.clientWidth,P=j.scrollWidth;j.scrollLeft=P-U-R;break}else j.scrollLeft=R;else j.scrollTop=R}this._callPropsCallbacks()},v.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&MN(this._resetIsScrollingTimeoutId)},v.render=function(){var x=this.props,b=x.children,S=x.className,N=x.direction,R=x.height,I=x.innerRef,j=x.innerElementType,U=x.innerTagName,P=x.itemCount,k=x.itemData,F=x.itemKey,O=F===void 0?lH:F,C=x.layout,M=x.outerElementType,D=x.outerTagName,$=x.style,K=x.useIsScrolling,ee=x.width,se=this.state.isScrolling,ie=N==="horizontal"||C==="horizontal",re=ie?this._onScrollHorizontal:this._onScrollVertical,G=this._getRangeToRender(),z=G[0],Z=G[1],J=[];if(P>0)for(var ae=z;ae<=Z;ae++)J.push(X.createElement(b,{data:k,key:O(ae,k),index:ae,isScrolling:K?se:void 0,style:this._getItemStyle(ae)}));var le=n(this.props,this._instanceProps);return X.createElement(M||D||"div",{className:S,onScroll:re,ref:this._outerRefSetter,style:Jx({position:"relative",height:R,width:ee,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:N},$)},X.createElement(j||U||"div",{children:J,ref:I,style:{height:ie?"100%":le,pointerEvents:se?"none":void 0,width:ie?le:"100%"}}))},v._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var x=this.props.itemCount;if(x>0){var b=this._getRangeToRender(),S=b[0],N=b[1],R=b[2],I=b[3];this._callOnItemsRendered(S,N,R,I)}}if(typeof this.props.onScroll=="function"){var j=this.state,U=j.scrollDirection,P=j.scrollOffset,k=j.scrollUpdateWasRequested;this._callOnScroll(U,P,k)}},v._getRangeToRender=function(){var x=this.props,b=x.itemCount,S=x.overscanCount,N=this.state,R=N.isScrolling,I=N.scrollDirection,j=N.scrollOffset;if(b===0)return[0,0,0,0];var U=o(this.props,j,this._instanceProps),P=l(this.props,U,j,this._instanceProps),k=!R||I==="backward"?Math.max(1,S):1,F=!R||I==="forward"?Math.max(1,S):1;return[Math.max(0,U-k),Math.max(0,Math.min(b-1,P+F)),U,P]},g}(X.PureComponent),e.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},e}var uH=function(e,t){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,t.instance},dH=cH({getItemOffset:function(e,t){var n=e.itemSize;return t*n},getItemSize:function(e,t){var n=e.itemSize;return n},getEstimatedTotalSize:function(e){var t=e.itemCount,n=e.itemSize;return n*t},getOffsetForIndexAndAlignment:function(e,t,n,i,s,o){var l=e.direction,d=e.height,f=e.itemCount,m=e.itemSize,p=e.layout,g=e.width,v=l==="horizontal"||p==="horizontal",E=v?g:d,x=Math.max(0,f*m-E),b=Math.min(x,t*m),S=Math.max(0,t*m-E+m+o);switch(n==="smart"&&(i>=S-E&&i<=b+E?n="auto":n="center"),n){case"start":return b;case"end":return S;case"center":{var N=Math.round(S+(b-S)/2);return N<Math.ceil(E/2)?0:N>x+Math.floor(E/2)?x:N}case"auto":default:return i>=S&&i<=b?i:i<S?S:b}},getStartIndexForOffset:function(e,t){var n=e.itemCount,i=e.itemSize;return Math.max(0,Math.min(n-1,Math.floor(t/i)))},getStopIndexForStartIndex:function(e,t,n){var i=e.direction,s=e.height,o=e.itemCount,l=e.itemSize,d=e.layout,f=e.width,m=i==="horizontal"||d==="horizontal",p=t*l,g=m?f:s,v=Math.ceil((g+n-p)/l);return Math.max(0,Math.min(o-1,t+v-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.itemSize}});const lg="w-full px-3 py-2 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",hH=({db:r,showNotification:e,determineServiceTypeAndRole:t,userData:n})=>{const[i,s]=X.useState([]),[o,l]=X.useState(!0),[d,f]=X.useState(null),[m,p]=X.useState(null),[g,v]=X.useState(""),[E,x]=X.useState(!1),[b,S]=X.useState(!1),[N,R]=X.useState(""),[I,j]=X.useState(""),[U,P]=X.useState(""),[k,F]=X.useState(""),[O,C]=X.useState(!1),[M,D]=X.useState(""),$=X.useCallback(async()=>{l(!0),D("");const ue=await g9(r);if(ue.success)s(ue.data.sort((fe,ve)=>(fe.displayName||fe.email||"").localeCompare(ve.displayName||ve.email||"")));else{const fe=ue.error||"Failed to fetch user list. Please try again.";D(fe)}l(!1)},[r]);X.useEffect(()=>{$()},[$]);const K=ue=>f(ue),ee=()=>f(null),se=async ue=>{if(!d)return;C(!0);const fe=await Sd(r,d.id,ue);fe.success?(e("User profile updated successfully!","success"),ee(),$()):e(fe.error||"Failed to update user profile.","error"),C(!1)},ie=(ue,fe)=>{p(ue),v(fe),x(!0)},re=async()=>{!m||!g||(C(!0),await Sd(r,m.id,{accountStatus:g}),e(`User account status changed to ${g}.`,"success"),$(),x(!1),p(null),v(""),C(!1))},G=ue=>{p(ue),S(!0)},z=async()=>{if(!m)return;C(!0),await Sd(r,m.id,{accountStatus:"Suspended"});const ue=await G8(r,m.id);ue.success?(e(`User ${m.displayName} has been permanently deleted.`,"success"),$()):(e(ue.error||"Failed to delete user profile.","error"),await Sd(r,m.id,{accountStatus:m.accountStatus})),S(!1),p(null),C(!1)},Z=i.filter(ue=>{var ve,Me,Pe;const fe=N.toLowerCase();return(((ve=ue.displayName)==null?void 0:ve.toLowerCase().includes(fe))||((Me=ue.email)==null?void 0:Me.toLowerCase().includes(fe))||((Pe=ue.accountNumber)==null?void 0:Pe.toLowerCase().includes(fe)))&&(I?ue.role===I:!0)&&(U?ue.accountStatus===U:!0)&&(k?(ue.discountStatus||"none")===k:!0)}),J={admin:"bg-purple-100 text-purple-700",customer:"bg-blue-100 text-blue-700",meter_reader:"bg-teal-100 text-teal-700",clerk_cashier:"bg-indigo-100 text-indigo-700",unknown:"bg-gray-100 text-gray-700"},ae={Active:"bg-green-100 text-green-700",Inactive:"bg-gray-200 text-gray-600",Suspended:"bg-red-100 text-red-700","Profile Missing":"bg-yellow-100 text-yellow-700",Unknown:"bg-gray-100 text-gray-600"},le={none:"bg-gray-100 text-gray-600",pending:"bg-yellow-100 text-yellow-700",verified:"bg-green-100 text-green-700"},Q={none:"None",pending:"Pending",verified:"Verified"},ce=({index:ue,style:fe})=>{var Pe;const ve=Z[ue],Me=ve.discountStatus||"none";return c.jsxs("div",{style:fe,className:"flex items-center border-b border-gray-200 text-sm",children:[c.jsx("div",{className:"px-4 py-2 whitespace-nowrap text-gray-800 font-medium flex-1",children:ve.displayName||"N/A"}),c.jsx("div",{className:"px-4 py-2 whitespace-nowrap text-gray-500 truncate flex-1",title:ve.email||ve.phoneNumber,children:ve.email||ve.phoneNumber||"N/A"}),c.jsx("div",{className:"px-4 py-2 flex-1",children:c.jsx("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full capitalize ${J[ve.role||"unknown"]}`,children:((Pe=ve.role)==null?void 0:Pe.replace("_"," "))||"Unknown"})}),c.jsx("div",{className:"px-4 py-2 whitespace-nowrap text-gray-500 font-mono text-xs flex-1",children:ve.accountNumber||"N/A"}),c.jsx("div",{className:"px-4 py-2 flex-1",children:c.jsx("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full ${ae[ve.accountStatus||"Unknown"]}`,children:ve.accountStatus||"Unknown"})}),c.jsx("div",{className:"px-4 py-2 flex-1",children:c.jsx("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full ${le[Me]}`,children:Q[Me]})}),c.jsxs("div",{className:"px-4 py-2 whitespace-nowrap text-sm text-center space-x-1.5 flex-1",children:[c.jsx("button",{onClick:()=>K(ve),className:"text-blue-600 hover:text-blue-800 p-1 hover:bg-blue-100 rounded-md",title:"Edit User",children:c.jsx(F2,{size:16})}),ve.accountStatus!=="Suspended"&&c.jsx("button",{onClick:()=>ie(ve,"Suspended"),className:"text-orange-500 hover:text-orange-700 p-1 hover:bg-orange-100 rounded-md",title:"Suspend User",children:c.jsx(_F,{size:16})}),(ve.accountStatus==="Suspended"||ve.accountStatus==="Inactive")&&c.jsx("button",{onClick:()=>ie(ve,"Active"),className:"text-green-500 hover:text-green-700 p-1 hover:bg-green-100 rounded-md",title:"Activate User",children:c.jsx(m3,{size:16})}),(n==null?void 0:n.uid)!==ve.id&&c.jsx("button",{onClick:()=>G(ve),className:"text-red-600 hover:text-red-800 p-1 hover:bg-red-100 rounded-md",title:"Delete User",children:c.jsx(fh,{size:16})})]})]})};return o?c.jsx(ln,{message:"Loading user accounts...",className:"mt-10 h-64"}):c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(Ia,{size:30,className:"mr-3 text-blue-600"})," User Account Management"]}),c.jsxs("button",{onClick:$,className:"mt-3 sm:mt-0 text-sm flex items-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-3 rounded-lg border border-gray-300 transition-colors",disabled:o,title:"Refresh User List",children:[o?c.jsx(Tt,{size:16,className:"animate-spin mr-1.5"}):c.jsx(qa,{size:16,className:"mr-1.5"})," Refresh List"]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6 p-4 bg-gray-50 rounded-lg shadow-sm",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"userMgmtSearchTerm",className:"block text-xs font-medium text-gray-600 mb-1",children:"Search Users"}),c.jsxs("div",{className:"relative",children:[c.jsx(Os,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx("input",{type:"text",id:"userMgmtSearchTerm",placeholder:"Name, Email, Account No...",className:`${lg} pl-9`,value:N,onChange:ue=>R(ue.target.value)})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"userMgmtFilterRole",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Role"}),c.jsxs("div",{className:"relative",children:[c.jsx(rF,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsxs("select",{id:"userMgmtFilterRole",className:`${lg} pl-9`,value:I,onChange:ue=>j(ue.target.value),children:[c.jsx("option",{value:"",children:"All Roles"}),c.jsx("option",{value:"customer",children:"Customer"}),c.jsx("option",{value:"admin",children:"Admin"}),c.jsx("option",{value:"meter_reader",children:"Meter Reader"}),c.jsx("option",{value:"clerk_cashier",children:"Clerk/Cashier"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"userMgmtFilterStatus",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Status"}),c.jsxs("div",{className:"relative",children:[c.jsx(hh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsxs("select",{id:"userMgmtFilterStatus",className:`${lg} pl-9`,value:U,onChange:ue=>P(ue.target.value),children:[c.jsx("option",{value:"",children:"All Statuses"}),c.jsx("option",{value:"Active",children:"Active"}),c.jsx("option",{value:"Inactive",children:"Inactive"}),c.jsx("option",{value:"Suspended",children:"Suspended"}),c.jsx("option",{value:"Profile Missing",children:"Profile Missing"})]})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"userMgmtFilterDiscount",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Discount"}),c.jsxs("div",{className:"relative",children:[c.jsx(_a,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsxs("select",{id:"userMgmtFilterDiscount",className:`${lg} pl-9`,value:k,onChange:ue=>F(ue.target.value),children:[c.jsx("option",{value:"",children:"All"}),c.jsx("option",{value:"none",children:"None"}),c.jsx("option",{value:"pending",children:"Pending"}),c.jsx("option",{value:"verified",children:"Verified"})]})]})]})]}),!o&&Z.length===0&&c.jsxs("div",{className:"text-center py-10",children:[c.jsx(yn,{size:48,className:"mx-auto text-gray-400 mb-3"}),c.jsx("p",{className:"text-gray-500 text-lg",children:i.length===0&&!M?"No users found.":"No users match your filters."})]}),!o&&Z.length>0&&c.jsxs("div",{className:"overflow-x-auto shadow-md rounded-lg border border-gray-200",children:[c.jsxs("div",{className:"flex bg-gray-100 text-xs font-medium text-gray-500 uppercase tracking-wider",children:[c.jsx("div",{className:"px-4 py-3 flex-1",children:"Name"}),c.jsx("div",{className:"px-4 py-3 flex-1",children:"Email / Contact"}),c.jsx("div",{className:"px-4 py-3 flex-1",children:"Role"}),c.jsx("div",{className:"px-4 py-3 flex-1",children:"Account No."}),c.jsx("div",{className:"px-4 py-3 flex-1",children:"Status"}),c.jsx("div",{className:"px-4 py-3 flex-1",children:"Discount"}),c.jsx("div",{className:"px-4 py-3 text-center flex-1",children:"Actions"})]}),c.jsx(dH,{height:400,itemCount:Z.length,itemSize:60,width:"100%",children:ce})]}),d&&c.jsx(tH,{user:d,isOpen:!!d,onClose:ee,onSave:se,isSaving:O,determineServiceTypeAndRole:t,showNotification:e}),E&&m&&c.jsx(Da,{isOpen:E,onClose:()=>x(!1),onConfirm:re,title:"Confirm Status Change",confirmText:O?"Updating...":`Set to ${g}`,isConfirming:O,iconType:g==="Active"?"success":"danger",confirmButtonClass:g==="Active"?"bg-green-600 hover:bg-green-700 focus:ring-green-500":"bg-red-600 hover:bg-red-700 focus:ring-red-500",children:c.jsxs("p",{children:["Change status for ",c.jsx("strong",{children:m.displayName||m.email})," to ",c.jsx("strong",{className:g==="Active"?"text-green-600":"text-red-600",children:g}),"?"]})}),b&&m&&c.jsxs(Da,{isOpen:b,onClose:()=>S(!1),onConfirm:z,title:"Confirm User Deletion",confirmText:"Yes, Permanently Delete",isConfirming:O,iconType:"danger",children:[c.jsxs("p",{children:["Are you sure you want to delete ",c.jsx("strong",{children:m.displayName||m.email}),"?"]}),c.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"This will permanently delete the user's profile and data. Their authentication account will be disabled. This action cannot be undone."})]})]})};var b1,VN;function fH(){if(VN)return b1;VN=1;function r(){this.__data__=[],this.size=0}return b1=r,b1}var w1,BN;function SR(){if(BN)return w1;BN=1;function r(e,t){return e===t||e!==e&&t!==t}return w1=r,w1}var E1,zN;function g0(){if(zN)return E1;zN=1;var r=SR();function e(t,n){for(var i=t.length;i--;)if(r(t[i][0],n))return i;return-1}return E1=e,E1}var S1,UN;function mH(){if(UN)return S1;UN=1;var r=g0(),e=Array.prototype,t=e.splice;function n(i){var s=this.__data__,o=r(s,i);if(o<0)return!1;var l=s.length-1;return o==l?s.pop():t.call(s,o,1),--this.size,!0}return S1=n,S1}var T1,qN;function pH(){if(qN)return T1;qN=1;var r=g0();function e(t){var n=this.__data__,i=r(n,t);return i<0?void 0:n[i][1]}return T1=e,T1}var A1,HN;function gH(){if(HN)return A1;HN=1;var r=g0();function e(t){return r(this.__data__,t)>-1}return A1=e,A1}var N1,$N;function yH(){if($N)return N1;$N=1;var r=g0();function e(t,n){var i=this.__data__,s=r(i,t);return s<0?(++this.size,i.push([t,n])):i[s][1]=n,this}return N1=e,N1}var I1,WN;function y0(){if(WN)return I1;WN=1;var r=fH(),e=mH(),t=pH(),n=gH(),i=yH();function s(o){var l=-1,d=o==null?0:o.length;for(this.clear();++l<d;){var f=o[l];this.set(f[0],f[1])}}return s.prototype.clear=r,s.prototype.delete=e,s.prototype.get=t,s.prototype.has=n,s.prototype.set=i,I1=s,I1}var P1,GN;function vH(){if(GN)return P1;GN=1;var r=y0();function e(){this.__data__=new r,this.size=0}return P1=e,P1}var k1,KN;function _H(){if(KN)return k1;KN=1;function r(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}return k1=r,k1}var C1,YN;function xH(){if(YN)return C1;YN=1;function r(e){return this.__data__.get(e)}return C1=r,C1}var R1,ZN;function bH(){if(ZN)return R1;ZN=1;function r(e){return this.__data__.has(e)}return R1=r,R1}var j1,QN;function TR(){if(QN)return j1;QN=1;var r=typeof Dp=="object"&&Dp&&Dp.Object===Object&&Dp;return j1=r,j1}var O1,XN;function Wa(){if(XN)return O1;XN=1;var r=TR(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=r||e||Function("return this")();return O1=t,O1}var D1,JN;function aw(){if(JN)return D1;JN=1;var r=Wa(),e=r.Symbol;return D1=e,D1}var M1,eI;function wH(){if(eI)return M1;eI=1;var r=aw(),e=Object.prototype,t=e.hasOwnProperty,n=e.toString,i=r?r.toStringTag:void 0;function s(o){var l=t.call(o,i),d=o[i];try{o[i]=void 0;var f=!0}catch{}var m=n.call(o);return f&&(l?o[i]=d:delete o[i]),m}return M1=s,M1}var L1,tI;function EH(){if(tI)return L1;tI=1;var r=Object.prototype,e=r.toString;function t(n){return e.call(n)}return L1=t,L1}var F1,nI;function v0(){if(nI)return F1;nI=1;var r=aw(),e=wH(),t=EH(),n="[object Null]",i="[object Undefined]",s=r?r.toStringTag:void 0;function o(l){return l==null?l===void 0?i:n:s&&s in Object(l)?e(l):t(l)}return F1=o,F1}var V1,rI;function AR(){if(rI)return V1;rI=1;function r(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return V1=r,V1}var B1,iI;function NR(){if(iI)return B1;iI=1;var r=v0(),e=AR(),t="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",s="[object Proxy]";function o(l){if(!e(l))return!1;var d=r(l);return d==n||d==i||d==t||d==s}return B1=o,B1}var z1,sI;function SH(){if(sI)return z1;sI=1;var r=Wa(),e=r["__core-js_shared__"];return z1=e,z1}var U1,oI;function TH(){if(oI)return U1;oI=1;var r=SH(),e=function(){var n=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function t(n){return!!e&&e in n}return U1=t,U1}var q1,aI;function IR(){if(aI)return q1;aI=1;var r=Function.prototype,e=r.toString;function t(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return q1=t,q1}var H1,lI;function AH(){if(lI)return H1;lI=1;var r=NR(),e=TH(),t=AR(),n=IR(),i=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,o=Function.prototype,l=Object.prototype,d=o.toString,f=l.hasOwnProperty,m=RegExp("^"+d.call(f).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function p(g){if(!t(g)||e(g))return!1;var v=r(g)?m:s;return v.test(n(g))}return H1=p,H1}var $1,cI;function NH(){if(cI)return $1;cI=1;function r(e,t){return e==null?void 0:e[t]}return $1=r,$1}var W1,uI;function ph(){if(uI)return W1;uI=1;var r=AH(),e=NH();function t(n,i){var s=e(n,i);return r(s)?s:void 0}return W1=t,W1}var G1,dI;function lw(){if(dI)return G1;dI=1;var r=ph(),e=Wa(),t=r(e,"Map");return G1=t,G1}var K1,hI;function _0(){if(hI)return K1;hI=1;var r=ph(),e=r(Object,"create");return K1=e,K1}var Y1,fI;function IH(){if(fI)return Y1;fI=1;var r=_0();function e(){this.__data__=r?r(null):{},this.size=0}return Y1=e,Y1}var Z1,mI;function PH(){if(mI)return Z1;mI=1;function r(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}return Z1=r,Z1}var Q1,pI;function kH(){if(pI)return Q1;pI=1;var r=_0(),e="__lodash_hash_undefined__",t=Object.prototype,n=t.hasOwnProperty;function i(s){var o=this.__data__;if(r){var l=o[s];return l===e?void 0:l}return n.call(o,s)?o[s]:void 0}return Q1=i,Q1}var X1,gI;function CH(){if(gI)return X1;gI=1;var r=_0(),e=Object.prototype,t=e.hasOwnProperty;function n(i){var s=this.__data__;return r?s[i]!==void 0:t.call(s,i)}return X1=n,X1}var J1,yI;function RH(){if(yI)return J1;yI=1;var r=_0(),e="__lodash_hash_undefined__";function t(n,i){var s=this.__data__;return this.size+=this.has(n)?0:1,s[n]=r&&i===void 0?e:i,this}return J1=t,J1}var e_,vI;function jH(){if(vI)return e_;vI=1;var r=IH(),e=PH(),t=kH(),n=CH(),i=RH();function s(o){var l=-1,d=o==null?0:o.length;for(this.clear();++l<d;){var f=o[l];this.set(f[0],f[1])}}return s.prototype.clear=r,s.prototype.delete=e,s.prototype.get=t,s.prototype.has=n,s.prototype.set=i,e_=s,e_}var t_,_I;function OH(){if(_I)return t_;_I=1;var r=jH(),e=y0(),t=lw();function n(){this.size=0,this.__data__={hash:new r,map:new(t||e),string:new r}}return t_=n,t_}var n_,xI;function DH(){if(xI)return n_;xI=1;function r(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}return n_=r,n_}var r_,bI;function x0(){if(bI)return r_;bI=1;var r=DH();function e(t,n){var i=t.__data__;return r(n)?i[typeof n=="string"?"string":"hash"]:i.map}return r_=e,r_}var i_,wI;function MH(){if(wI)return i_;wI=1;var r=x0();function e(t){var n=r(this,t).delete(t);return this.size-=n?1:0,n}return i_=e,i_}var s_,EI;function LH(){if(EI)return s_;EI=1;var r=x0();function e(t){return r(this,t).get(t)}return s_=e,s_}var o_,SI;function FH(){if(SI)return o_;SI=1;var r=x0();function e(t){return r(this,t).has(t)}return o_=e,o_}var a_,TI;function VH(){if(TI)return a_;TI=1;var r=x0();function e(t,n){var i=r(this,t),s=i.size;return i.set(t,n),this.size+=i.size==s?0:1,this}return a_=e,a_}var l_,AI;function PR(){if(AI)return l_;AI=1;var r=OH(),e=MH(),t=LH(),n=FH(),i=VH();function s(o){var l=-1,d=o==null?0:o.length;for(this.clear();++l<d;){var f=o[l];this.set(f[0],f[1])}}return s.prototype.clear=r,s.prototype.delete=e,s.prototype.get=t,s.prototype.has=n,s.prototype.set=i,l_=s,l_}var c_,NI;function BH(){if(NI)return c_;NI=1;var r=y0(),e=lw(),t=PR(),n=200;function i(s,o){var l=this.__data__;if(l instanceof r){var d=l.__data__;if(!e||d.length<n-1)return d.push([s,o]),this.size=++l.size,this;l=this.__data__=new t(d)}return l.set(s,o),this.size=l.size,this}return c_=i,c_}var u_,II;function zH(){if(II)return u_;II=1;var r=y0(),e=vH(),t=_H(),n=xH(),i=bH(),s=BH();function o(l){var d=this.__data__=new r(l);this.size=d.size}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=i,o.prototype.set=s,u_=o,u_}var d_,PI;function UH(){if(PI)return d_;PI=1;var r="__lodash_hash_undefined__";function e(t){return this.__data__.set(t,r),this}return d_=e,d_}var h_,kI;function qH(){if(kI)return h_;kI=1;function r(e){return this.__data__.has(e)}return h_=r,h_}var f_,CI;function HH(){if(CI)return f_;CI=1;var r=PR(),e=UH(),t=qH();function n(i){var s=-1,o=i==null?0:i.length;for(this.__data__=new r;++s<o;)this.add(i[s])}return n.prototype.add=n.prototype.push=e,n.prototype.has=t,f_=n,f_}var m_,RI;function $H(){if(RI)return m_;RI=1;function r(e,t){for(var n=-1,i=e==null?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}return m_=r,m_}var p_,jI;function WH(){if(jI)return p_;jI=1;function r(e,t){return e.has(t)}return p_=r,p_}var g_,OI;function kR(){if(OI)return g_;OI=1;var r=HH(),e=$H(),t=WH(),n=1,i=2;function s(o,l,d,f,m,p){var g=d&n,v=o.length,E=l.length;if(v!=E&&!(g&&E>v))return!1;var x=p.get(o),b=p.get(l);if(x&&b)return x==l&&b==o;var S=-1,N=!0,R=d&i?new r:void 0;for(p.set(o,l),p.set(l,o);++S<v;){var I=o[S],j=l[S];if(f)var U=g?f(j,I,S,l,o,p):f(I,j,S,o,l,p);if(U!==void 0){if(U)continue;N=!1;break}if(R){if(!e(l,function(P,k){if(!t(R,k)&&(I===P||m(I,P,d,f,p)))return R.push(k)})){N=!1;break}}else if(!(I===j||m(I,j,d,f,p))){N=!1;break}}return p.delete(o),p.delete(l),N}return g_=s,g_}var y_,DI;function GH(){if(DI)return y_;DI=1;var r=Wa(),e=r.Uint8Array;return y_=e,y_}var v_,MI;function KH(){if(MI)return v_;MI=1;function r(e){var t=-1,n=Array(e.size);return e.forEach(function(i,s){n[++t]=[s,i]}),n}return v_=r,v_}var __,LI;function YH(){if(LI)return __;LI=1;function r(e){var t=-1,n=Array(e.size);return e.forEach(function(i){n[++t]=i}),n}return __=r,__}var x_,FI;function ZH(){if(FI)return x_;FI=1;var r=aw(),e=GH(),t=SR(),n=kR(),i=KH(),s=YH(),o=1,l=2,d="[object Boolean]",f="[object Date]",m="[object Error]",p="[object Map]",g="[object Number]",v="[object RegExp]",E="[object Set]",x="[object String]",b="[object Symbol]",S="[object ArrayBuffer]",N="[object DataView]",R=r?r.prototype:void 0,I=R?R.valueOf:void 0;function j(U,P,k,F,O,C,M){switch(k){case N:if(U.byteLength!=P.byteLength||U.byteOffset!=P.byteOffset)return!1;U=U.buffer,P=P.buffer;case S:return!(U.byteLength!=P.byteLength||!C(new e(U),new e(P)));case d:case f:case g:return t(+U,+P);case m:return U.name==P.name&&U.message==P.message;case v:case x:return U==P+"";case p:var D=i;case E:var $=F&o;if(D||(D=s),U.size!=P.size&&!$)return!1;var K=M.get(U);if(K)return K==P;F|=l,M.set(U,P);var ee=n(D(U),D(P),F,O,C,M);return M.delete(U),ee;case b:if(I)return I.call(U)==I.call(P)}return!1}return x_=j,x_}var b_,VI;function QH(){if(VI)return b_;VI=1;function r(e,t){for(var n=-1,i=t.length,s=e.length;++n<i;)e[s+n]=t[n];return e}return b_=r,b_}var w_,BI;function cw(){if(BI)return w_;BI=1;var r=Array.isArray;return w_=r,w_}var E_,zI;function XH(){if(zI)return E_;zI=1;var r=QH(),e=cw();function t(n,i,s){var o=i(n);return e(n)?o:r(o,s(n))}return E_=t,E_}var S_,UI;function JH(){if(UI)return S_;UI=1;function r(e,t){for(var n=-1,i=e==null?0:e.length,s=0,o=[];++n<i;){var l=e[n];t(l,n,e)&&(o[s++]=l)}return o}return S_=r,S_}var T_,qI;function e$(){if(qI)return T_;qI=1;function r(){return[]}return T_=r,T_}var A_,HI;function t$(){if(HI)return A_;HI=1;var r=JH(),e=e$(),t=Object.prototype,n=t.propertyIsEnumerable,i=Object.getOwnPropertySymbols,s=i?function(o){return o==null?[]:(o=Object(o),r(i(o),function(l){return n.call(o,l)}))}:e;return A_=s,A_}var N_,$I;function n$(){if($I)return N_;$I=1;function r(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}return N_=r,N_}var I_,WI;function b0(){if(WI)return I_;WI=1;function r(e){return e!=null&&typeof e=="object"}return I_=r,I_}var P_,GI;function r$(){if(GI)return P_;GI=1;var r=v0(),e=b0(),t="[object Arguments]";function n(i){return e(i)&&r(i)==t}return P_=n,P_}var k_,KI;function i$(){if(KI)return k_;KI=1;var r=r$(),e=b0(),t=Object.prototype,n=t.hasOwnProperty,i=t.propertyIsEnumerable,s=r(function(){return arguments}())?r:function(o){return e(o)&&n.call(o,"callee")&&!i.call(o,"callee")};return k_=s,k_}var Sf={exports:{}},C_,YI;function s$(){if(YI)return C_;YI=1;function r(){return!1}return C_=r,C_}Sf.exports;var ZI;function CR(){return ZI||(ZI=1,function(r,e){var t=Wa(),n=s$(),i=e&&!e.nodeType&&e,s=i&&!0&&r&&!r.nodeType&&r,o=s&&s.exports===i,l=o?t.Buffer:void 0,d=l?l.isBuffer:void 0,f=d||n;r.exports=f}(Sf,Sf.exports)),Sf.exports}var R_,QI;function o$(){if(QI)return R_;QI=1;var r=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function t(n,i){var s=typeof n;return i=i??r,!!i&&(s=="number"||s!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<i}return R_=t,R_}var j_,XI;function RR(){if(XI)return j_;XI=1;var r=9007199254740991;function e(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=r}return j_=e,j_}var O_,JI;function a$(){if(JI)return O_;JI=1;var r=v0(),e=RR(),t=b0(),n="[object Arguments]",i="[object Array]",s="[object Boolean]",o="[object Date]",l="[object Error]",d="[object Function]",f="[object Map]",m="[object Number]",p="[object Object]",g="[object RegExp]",v="[object Set]",E="[object String]",x="[object WeakMap]",b="[object ArrayBuffer]",S="[object DataView]",N="[object Float32Array]",R="[object Float64Array]",I="[object Int8Array]",j="[object Int16Array]",U="[object Int32Array]",P="[object Uint8Array]",k="[object Uint8ClampedArray]",F="[object Uint16Array]",O="[object Uint32Array]",C={};C[N]=C[R]=C[I]=C[j]=C[U]=C[P]=C[k]=C[F]=C[O]=!0,C[n]=C[i]=C[b]=C[s]=C[S]=C[o]=C[l]=C[d]=C[f]=C[m]=C[p]=C[g]=C[v]=C[E]=C[x]=!1;function M(D){return t(D)&&e(D.length)&&!!C[r(D)]}return O_=M,O_}var D_,e4;function l$(){if(e4)return D_;e4=1;function r(e){return function(t){return e(t)}}return D_=r,D_}var Tf={exports:{}};Tf.exports;var t4;function c$(){return t4||(t4=1,function(r,e){var t=TR(),n=e&&!e.nodeType&&e,i=n&&!0&&r&&!r.nodeType&&r,s=i&&i.exports===n,o=s&&t.process,l=function(){try{var d=i&&i.require&&i.require("util").types;return d||o&&o.binding&&o.binding("util")}catch{}}();r.exports=l}(Tf,Tf.exports)),Tf.exports}var M_,n4;function jR(){if(n4)return M_;n4=1;var r=a$(),e=l$(),t=c$(),n=t&&t.isTypedArray,i=n?e(n):r;return M_=i,M_}var L_,r4;function u$(){if(r4)return L_;r4=1;var r=n$(),e=i$(),t=cw(),n=CR(),i=o$(),s=jR(),o=Object.prototype,l=o.hasOwnProperty;function d(f,m){var p=t(f),g=!p&&e(f),v=!p&&!g&&n(f),E=!p&&!g&&!v&&s(f),x=p||g||v||E,b=x?r(f.length,String):[],S=b.length;for(var N in f)(m||l.call(f,N))&&!(x&&(N=="length"||v&&(N=="offset"||N=="parent")||E&&(N=="buffer"||N=="byteLength"||N=="byteOffset")||i(N,S)))&&b.push(N);return b}return L_=d,L_}var F_,i4;function d$(){if(i4)return F_;i4=1;var r=Object.prototype;function e(t){var n=t&&t.constructor,i=typeof n=="function"&&n.prototype||r;return t===i}return F_=e,F_}var V_,s4;function h$(){if(s4)return V_;s4=1;function r(e,t){return function(n){return e(t(n))}}return V_=r,V_}var B_,o4;function f$(){if(o4)return B_;o4=1;var r=h$(),e=r(Object.keys,Object);return B_=e,B_}var z_,a4;function m$(){if(a4)return z_;a4=1;var r=d$(),e=f$(),t=Object.prototype,n=t.hasOwnProperty;function i(s){if(!r(s))return e(s);var o=[];for(var l in Object(s))n.call(s,l)&&l!="constructor"&&o.push(l);return o}return z_=i,z_}var U_,l4;function p$(){if(l4)return U_;l4=1;var r=NR(),e=RR();function t(n){return n!=null&&e(n.length)&&!r(n)}return U_=t,U_}var q_,c4;function g$(){if(c4)return q_;c4=1;var r=u$(),e=m$(),t=p$();function n(i){return t(i)?r(i):e(i)}return q_=n,q_}var H_,u4;function y$(){if(u4)return H_;u4=1;var r=XH(),e=t$(),t=g$();function n(i){return r(i,t,e)}return H_=n,H_}var $_,d4;function v$(){if(d4)return $_;d4=1;var r=y$(),e=1,t=Object.prototype,n=t.hasOwnProperty;function i(s,o,l,d,f,m){var p=l&e,g=r(s),v=g.length,E=r(o),x=E.length;if(v!=x&&!p)return!1;for(var b=v;b--;){var S=g[b];if(!(p?S in o:n.call(o,S)))return!1}var N=m.get(s),R=m.get(o);if(N&&R)return N==o&&R==s;var I=!0;m.set(s,o),m.set(o,s);for(var j=p;++b<v;){S=g[b];var U=s[S],P=o[S];if(d)var k=p?d(P,U,S,o,s,m):d(U,P,S,s,o,m);if(!(k===void 0?U===P||f(U,P,l,d,m):k)){I=!1;break}j||(j=S=="constructor")}if(I&&!j){var F=s.constructor,O=o.constructor;F!=O&&"constructor"in s&&"constructor"in o&&!(typeof F=="function"&&F instanceof F&&typeof O=="function"&&O instanceof O)&&(I=!1)}return m.delete(s),m.delete(o),I}return $_=i,$_}var W_,h4;function _$(){if(h4)return W_;h4=1;var r=ph(),e=Wa(),t=r(e,"DataView");return W_=t,W_}var G_,f4;function x$(){if(f4)return G_;f4=1;var r=ph(),e=Wa(),t=r(e,"Promise");return G_=t,G_}var K_,m4;function b$(){if(m4)return K_;m4=1;var r=ph(),e=Wa(),t=r(e,"Set");return K_=t,K_}var Y_,p4;function w$(){if(p4)return Y_;p4=1;var r=ph(),e=Wa(),t=r(e,"WeakMap");return Y_=t,Y_}var Z_,g4;function E$(){if(g4)return Z_;g4=1;var r=_$(),e=lw(),t=x$(),n=b$(),i=w$(),s=v0(),o=IR(),l="[object Map]",d="[object Object]",f="[object Promise]",m="[object Set]",p="[object WeakMap]",g="[object DataView]",v=o(r),E=o(e),x=o(t),b=o(n),S=o(i),N=s;return(r&&N(new r(new ArrayBuffer(1)))!=g||e&&N(new e)!=l||t&&N(t.resolve())!=f||n&&N(new n)!=m||i&&N(new i)!=p)&&(N=function(R){var I=s(R),j=I==d?R.constructor:void 0,U=j?o(j):"";if(U)switch(U){case v:return g;case E:return l;case x:return f;case b:return m;case S:return p}return I}),Z_=N,Z_}var Q_,y4;function S$(){if(y4)return Q_;y4=1;var r=zH(),e=kR(),t=ZH(),n=v$(),i=E$(),s=cw(),o=CR(),l=jR(),d=1,f="[object Arguments]",m="[object Array]",p="[object Object]",g=Object.prototype,v=g.hasOwnProperty;function E(x,b,S,N,R,I){var j=s(x),U=s(b),P=j?m:i(x),k=U?m:i(b);P=P==f?p:P,k=k==f?p:k;var F=P==p,O=k==p,C=P==k;if(C&&o(x)){if(!o(b))return!1;j=!0,F=!1}if(C&&!F)return I||(I=new r),j||l(x)?e(x,b,S,N,R,I):t(x,b,P,S,N,R,I);if(!(S&d)){var M=F&&v.call(x,"__wrapped__"),D=O&&v.call(b,"__wrapped__");if(M||D){var $=M?x.value():x,K=D?b.value():b;return I||(I=new r),R($,K,S,N,I)}}return C?(I||(I=new r),n(x,b,S,N,R,I)):!1}return Q_=E,Q_}var X_,v4;function T$(){if(v4)return X_;v4=1;var r=S$(),e=b0();function t(n,i,s,o,l){return n===i?!0:n==null||i==null||!e(n)&&!e(i)?n!==n&&i!==i:r(n,i,s,o,t,l)}return X_=t,X_}var J_,_4;function A$(){if(_4)return J_;_4=1;var r=T$();function e(t,n){return r(t,n)}return J_=e,J_}var Og={exports:{}};/*!
 * Quill Editor v1.3.7
 * https://quilljs.com/
 * Copyright (c) 2014, Jason Chen
 * Copyright (c) 2013, salesforce.com
 */var N$=Og.exports,x4;function I$(){return x4||(x4=1,function(r,e){(function(n,i){r.exports=i()})(typeof self<"u"?self:N$,function(){return function(t){var n={};function i(s){if(n[s])return n[s].exports;var o=n[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=n,i.d=function(s,o,l){i.o(s,o)||Object.defineProperty(s,o,{configurable:!1,enumerable:!0,get:l})},i.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return i.d(o,"a",o),o},i.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},i.p="",i(i.s=109)}([function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(17),o=i(18),l=i(19),d=i(45),f=i(46),m=i(47),p=i(48),g=i(49),v=i(12),E=i(32),x=i(33),b=i(31),S=i(1),N={Scope:S.Scope,create:S.create,find:S.find,query:S.query,register:S.register,Container:s.default,Format:o.default,Leaf:l.default,Embed:p.default,Scroll:d.default,Block:m.default,Inline:f.default,Text:g.default,Attributor:{Attribute:v.default,Class:E.default,Style:x.default,Store:b.default}};n.default=N},function(t,n,i){var s=this&&this.__extends||function(){var b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(S,N){S.__proto__=N}||function(S,N){for(var R in N)N.hasOwnProperty(R)&&(S[R]=N[R])};return function(S,N){b(S,N);function R(){this.constructor=S}S.prototype=N===null?Object.create(N):(R.prototype=N.prototype,new R)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=function(b){s(S,b);function S(N){var R=this;return N="[Parchment] "+N,R=b.call(this,N)||this,R.message=N,R.name=R.constructor.name,R}return S}(Error);n.ParchmentError=o;var l={},d={},f={},m={};n.DATA_KEY="__blot";var p;(function(b){b[b.TYPE=3]="TYPE",b[b.LEVEL=12]="LEVEL",b[b.ATTRIBUTE=13]="ATTRIBUTE",b[b.BLOT=14]="BLOT",b[b.INLINE=7]="INLINE",b[b.BLOCK=11]="BLOCK",b[b.BLOCK_BLOT=10]="BLOCK_BLOT",b[b.INLINE_BLOT=6]="INLINE_BLOT",b[b.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",b[b.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",b[b.ANY=15]="ANY"})(p=n.Scope||(n.Scope={}));function g(b,S){var N=E(b);if(N==null)throw new o("Unable to create "+b+" blot");var R=N,I=b instanceof Node||b.nodeType===Node.TEXT_NODE?b:R.create(S);return new R(I,S)}n.create=g;function v(b,S){return S===void 0&&(S=!1),b==null?null:b[n.DATA_KEY]!=null?b[n.DATA_KEY].blot:S?v(b.parentNode,S):null}n.find=v;function E(b,S){S===void 0&&(S=p.ANY);var N;if(typeof b=="string")N=m[b]||l[b];else if(b instanceof Text||b.nodeType===Node.TEXT_NODE)N=m.text;else if(typeof b=="number")b&p.LEVEL&p.BLOCK?N=m.block:b&p.LEVEL&p.INLINE&&(N=m.inline);else if(b instanceof HTMLElement){var R=(b.getAttribute("class")||"").split(/\s+/);for(var I in R)if(N=d[R[I]],N)break;N=N||f[b.tagName]}return N==null?null:S&p.LEVEL&N.scope&&S&p.TYPE&N.scope?N:null}n.query=E;function x(){for(var b=[],S=0;S<arguments.length;S++)b[S]=arguments[S];if(b.length>1)return b.map(function(I){return x(I)});var N=b[0];if(typeof N.blotName!="string"&&typeof N.attrName!="string")throw new o("Invalid definition");if(N.blotName==="abstract")throw new o("Cannot register abstract class");if(m[N.blotName||N.attrName]=N,typeof N.keyName=="string")l[N.keyName]=N;else if(N.className!=null&&(d[N.className]=N),N.tagName!=null){Array.isArray(N.tagName)?N.tagName=N.tagName.map(function(I){return I.toUpperCase()}):N.tagName=N.tagName.toUpperCase();var R=Array.isArray(N.tagName)?N.tagName:[N.tagName];R.forEach(function(I){(f[I]==null||N.className==null)&&(f[I]=N)})}return N}n.register=x},function(t,n,i){var s=i(51),o=i(11),l=i(3),d=i(20),f="\0",m=function(p){Array.isArray(p)?this.ops=p:p!=null&&Array.isArray(p.ops)?this.ops=p.ops:this.ops=[]};m.prototype.insert=function(p,g){var v={};return p.length===0?this:(v.insert=p,g!=null&&typeof g=="object"&&Object.keys(g).length>0&&(v.attributes=g),this.push(v))},m.prototype.delete=function(p){return p<=0?this:this.push({delete:p})},m.prototype.retain=function(p,g){if(p<=0)return this;var v={retain:p};return g!=null&&typeof g=="object"&&Object.keys(g).length>0&&(v.attributes=g),this.push(v)},m.prototype.push=function(p){var g=this.ops.length,v=this.ops[g-1];if(p=l(!0,{},p),typeof v=="object"){if(typeof p.delete=="number"&&typeof v.delete=="number")return this.ops[g-1]={delete:v.delete+p.delete},this;if(typeof v.delete=="number"&&p.insert!=null&&(g-=1,v=this.ops[g-1],typeof v!="object"))return this.ops.unshift(p),this;if(o(p.attributes,v.attributes)){if(typeof p.insert=="string"&&typeof v.insert=="string")return this.ops[g-1]={insert:v.insert+p.insert},typeof p.attributes=="object"&&(this.ops[g-1].attributes=p.attributes),this;if(typeof p.retain=="number"&&typeof v.retain=="number")return this.ops[g-1]={retain:v.retain+p.retain},typeof p.attributes=="object"&&(this.ops[g-1].attributes=p.attributes),this}}return g===this.ops.length?this.ops.push(p):this.ops.splice(g,0,p),this},m.prototype.chop=function(){var p=this.ops[this.ops.length-1];return p&&p.retain&&!p.attributes&&this.ops.pop(),this},m.prototype.filter=function(p){return this.ops.filter(p)},m.prototype.forEach=function(p){this.ops.forEach(p)},m.prototype.map=function(p){return this.ops.map(p)},m.prototype.partition=function(p){var g=[],v=[];return this.forEach(function(E){var x=p(E)?g:v;x.push(E)}),[g,v]},m.prototype.reduce=function(p,g){return this.ops.reduce(p,g)},m.prototype.changeLength=function(){return this.reduce(function(p,g){return g.insert?p+d.length(g):g.delete?p-g.delete:p},0)},m.prototype.length=function(){return this.reduce(function(p,g){return p+d.length(g)},0)},m.prototype.slice=function(p,g){p=p||0,typeof g!="number"&&(g=1/0);for(var v=[],E=d.iterator(this.ops),x=0;x<g&&E.hasNext();){var b;x<p?b=E.next(p-x):(b=E.next(g-x),v.push(b)),x+=d.length(b)}return new m(v)},m.prototype.compose=function(p){var g=d.iterator(this.ops),v=d.iterator(p.ops),E=[],x=v.peek();if(x!=null&&typeof x.retain=="number"&&x.attributes==null){for(var b=x.retain;g.peekType()==="insert"&&g.peekLength()<=b;)b-=g.peekLength(),E.push(g.next());x.retain-b>0&&v.next(x.retain-b)}for(var S=new m(E);g.hasNext()||v.hasNext();)if(v.peekType()==="insert")S.push(v.next());else if(g.peekType()==="delete")S.push(g.next());else{var N=Math.min(g.peekLength(),v.peekLength()),R=g.next(N),I=v.next(N);if(typeof I.retain=="number"){var j={};typeof R.retain=="number"?j.retain=N:j.insert=R.insert;var U=d.attributes.compose(R.attributes,I.attributes,typeof R.retain=="number");if(U&&(j.attributes=U),S.push(j),!v.hasNext()&&o(S.ops[S.ops.length-1],j)){var P=new m(g.rest());return S.concat(P).chop()}}else typeof I.delete=="number"&&typeof R.retain=="number"&&S.push(I)}return S.chop()},m.prototype.concat=function(p){var g=new m(this.ops.slice());return p.ops.length>0&&(g.push(p.ops[0]),g.ops=g.ops.concat(p.ops.slice(1))),g},m.prototype.diff=function(p,g){if(this.ops===p.ops)return new m;var v=[this,p].map(function(N){return N.map(function(R){if(R.insert!=null)return typeof R.insert=="string"?R.insert:f;var I=N===p?"on":"with";throw new Error("diff() called "+I+" non-document")}).join("")}),E=new m,x=s(v[0],v[1],g),b=d.iterator(this.ops),S=d.iterator(p.ops);return x.forEach(function(N){for(var R=N[1].length;R>0;){var I=0;switch(N[0]){case s.INSERT:I=Math.min(S.peekLength(),R),E.push(S.next(I));break;case s.DELETE:I=Math.min(R,b.peekLength()),b.next(I),E.delete(I);break;case s.EQUAL:I=Math.min(b.peekLength(),S.peekLength(),R);var j=b.next(I),U=S.next(I);o(j.insert,U.insert)?E.retain(I,d.attributes.diff(j.attributes,U.attributes)):E.push(U).delete(I);break}R-=I}}),E.chop()},m.prototype.eachLine=function(p,g){g=g||`
`;for(var v=d.iterator(this.ops),E=new m,x=0;v.hasNext();){if(v.peekType()!=="insert")return;var b=v.peek(),S=d.length(b)-v.peekLength(),N=typeof b.insert=="string"?b.insert.indexOf(g,S)-S:-1;if(N<0)E.push(v.next());else if(N>0)E.push(v.next(N));else{if(p(E,v.next(1).attributes||{},x)===!1)return;x+=1,E=new m}}E.length()>0&&p(E,{},x)},m.prototype.transform=function(p,g){if(g=!!g,typeof p=="number")return this.transformPosition(p,g);for(var v=d.iterator(this.ops),E=d.iterator(p.ops),x=new m;v.hasNext()||E.hasNext();)if(v.peekType()==="insert"&&(g||E.peekType()!=="insert"))x.retain(d.length(v.next()));else if(E.peekType()==="insert")x.push(E.next());else{var b=Math.min(v.peekLength(),E.peekLength()),S=v.next(b),N=E.next(b);if(S.delete)continue;N.delete?x.push(N):x.retain(b,d.attributes.transform(S.attributes,N.attributes,g))}return x.chop()},m.prototype.transformPosition=function(p,g){g=!!g;for(var v=d.iterator(this.ops),E=0;v.hasNext()&&E<=p;){var x=v.peekLength(),b=v.peekType();if(v.next(),b==="delete"){p-=Math.min(x,p-E);continue}else b==="insert"&&(E<p||!g)&&(p+=x);E+=x}return p},t.exports=m},function(t,n){var i=Object.prototype.hasOwnProperty,s=Object.prototype.toString,o=Object.defineProperty,l=Object.getOwnPropertyDescriptor,d=function(v){return typeof Array.isArray=="function"?Array.isArray(v):s.call(v)==="[object Array]"},f=function(v){if(!v||s.call(v)!=="[object Object]")return!1;var E=i.call(v,"constructor"),x=v.constructor&&v.constructor.prototype&&i.call(v.constructor.prototype,"isPrototypeOf");if(v.constructor&&!E&&!x)return!1;var b;for(b in v);return typeof b>"u"||i.call(v,b)},m=function(v,E){o&&E.name==="__proto__"?o(v,E.name,{enumerable:!0,configurable:!0,value:E.newValue,writable:!0}):v[E.name]=E.newValue},p=function(v,E){if(E==="__proto__")if(i.call(v,E)){if(l)return l(v,E).value}else return;return v[E]};t.exports=function g(){var v,E,x,b,S,N,R=arguments[0],I=1,j=arguments.length,U=!1;for(typeof R=="boolean"&&(U=R,R=arguments[1]||{},I=2),(R==null||typeof R!="object"&&typeof R!="function")&&(R={});I<j;++I)if(v=arguments[I],v!=null)for(E in v)x=p(R,E),b=p(v,E),R!==b&&(U&&b&&(f(b)||(S=d(b)))?(S?(S=!1,N=x&&d(x)?x:[]):N=x&&f(x)?x:{},m(R,{name:E,newValue:g(U,N,b)})):typeof b<"u"&&m(R,{name:E,newValue:b}));return R}},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BlockEmbed=n.bubbleFormats=void 0;var s=function(){function C(M,D){for(var $=0;$<D.length;$++){var K=D[$];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(M,K.key,K)}}return function(M,D,$){return D&&C(M.prototype,D),$&&C(M,$),M}}(),o=function C(M,D,$){M===null&&(M=Function.prototype);var K=Object.getOwnPropertyDescriptor(M,D);if(K===void 0){var ee=Object.getPrototypeOf(M);return ee===null?void 0:C(ee,D,$)}else{if("value"in K)return K.value;var se=K.get;return se===void 0?void 0:se.call($)}},l=i(3),d=R(l),f=i(2),m=R(f),p=i(0),g=R(p),v=i(16),E=R(v),x=i(6),b=R(x),S=i(7),N=R(S);function R(C){return C&&C.__esModule?C:{default:C}}function I(C,M){if(!(C instanceof M))throw new TypeError("Cannot call a class as a function")}function j(C,M){if(!C)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return M&&(typeof M=="object"||typeof M=="function")?M:C}function U(C,M){if(typeof M!="function"&&M!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof M);C.prototype=Object.create(M&&M.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(C,M):C.__proto__=M)}var P=1,k=function(C){U(M,C);function M(){return I(this,M),j(this,(M.__proto__||Object.getPrototypeOf(M)).apply(this,arguments))}return s(M,[{key:"attach",value:function(){o(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"attach",this).call(this),this.attributes=new g.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return new m.default().insert(this.value(),(0,d.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function($,K){var ee=g.default.query($,g.default.Scope.BLOCK_ATTRIBUTE);ee!=null&&this.attributes.attribute(ee,K)}},{key:"formatAt",value:function($,K,ee,se){this.format(ee,se)}},{key:"insertAt",value:function($,K,ee){if(typeof K=="string"&&K.endsWith(`
`)){var se=g.default.create(F.blotName);this.parent.insertBefore(se,$===0?this:this.next),se.insertAt(0,K.slice(0,-1))}else o(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"insertAt",this).call(this,$,K,ee)}}]),M}(g.default.Embed);k.scope=g.default.Scope.BLOCK_BLOT;var F=function(C){U(M,C);function M(D){I(this,M);var $=j(this,(M.__proto__||Object.getPrototypeOf(M)).call(this,D));return $.cache={},$}return s(M,[{key:"delta",value:function(){return this.cache.delta==null&&(this.cache.delta=this.descendants(g.default.Leaf).reduce(function($,K){return K.length()===0?$:$.insert(K.value(),O(K))},new m.default).insert(`
`,O(this))),this.cache.delta}},{key:"deleteAt",value:function($,K){o(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"deleteAt",this).call(this,$,K),this.cache={}}},{key:"formatAt",value:function($,K,ee,se){K<=0||(g.default.query(ee,g.default.Scope.BLOCK)?$+K===this.length()&&this.format(ee,se):o(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"formatAt",this).call(this,$,Math.min(K,this.length()-$-1),ee,se),this.cache={})}},{key:"insertAt",value:function($,K,ee){if(ee!=null)return o(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"insertAt",this).call(this,$,K,ee);if(K.length!==0){var se=K.split(`
`),ie=se.shift();ie.length>0&&($<this.length()-1||this.children.tail==null?o(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"insertAt",this).call(this,Math.min($,this.length()-1),ie):this.children.tail.insertAt(this.children.tail.length(),ie),this.cache={});var re=this;se.reduce(function(G,z){return re=re.split(G,!0),re.insertAt(0,z),z.length},$+ie.length)}}},{key:"insertBefore",value:function($,K){var ee=this.children.head;o(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"insertBefore",this).call(this,$,K),ee instanceof E.default&&ee.remove(),this.cache={}}},{key:"length",value:function(){return this.cache.length==null&&(this.cache.length=o(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"length",this).call(this)+P),this.cache.length}},{key:"moveChildren",value:function($,K){o(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"moveChildren",this).call(this,$,K),this.cache={}}},{key:"optimize",value:function($){o(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"optimize",this).call(this,$),this.cache={}}},{key:"path",value:function($){return o(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"path",this).call(this,$,!0)}},{key:"removeChild",value:function($){o(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"removeChild",this).call(this,$),this.cache={}}},{key:"split",value:function($){var K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(K&&($===0||$>=this.length()-P)){var ee=this.clone();return $===0?(this.parent.insertBefore(ee,this),this):(this.parent.insertBefore(ee,this.next),ee)}else{var se=o(M.prototype.__proto__||Object.getPrototypeOf(M.prototype),"split",this).call(this,$,K);return this.cache={},se}}}]),M}(g.default.Block);F.blotName="block",F.tagName="P",F.defaultChild="break",F.allowedChildren=[b.default,g.default.Embed,N.default];function O(C){var M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return C==null||(typeof C.formats=="function"&&(M=(0,d.default)(M,C.formats())),C.parent==null||C.parent.blotName=="scroll"||C.parent.statics.scope!==C.statics.scope)?M:O(C.parent,M)}n.bubbleFormats=O,n.BlockEmbed=k,n.default=F},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.overload=n.expandConfig=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(re){return typeof re}:function(re){return re&&typeof Symbol=="function"&&re.constructor===Symbol&&re!==Symbol.prototype?"symbol":typeof re},o=function(){function re(G,z){var Z=[],J=!0,ae=!1,le=void 0;try{for(var Q=G[Symbol.iterator](),ce;!(J=(ce=Q.next()).done)&&(Z.push(ce.value),!(z&&Z.length===z));J=!0);}catch(ue){ae=!0,le=ue}finally{try{!J&&Q.return&&Q.return()}finally{if(ae)throw le}}return Z}return function(G,z){if(Array.isArray(G))return G;if(Symbol.iterator in Object(G))return re(G,z);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function re(G,z){for(var Z=0;Z<z.length;Z++){var J=z[Z];J.enumerable=J.enumerable||!1,J.configurable=!0,"value"in J&&(J.writable=!0),Object.defineProperty(G,J.key,J)}}return function(G,z,Z){return z&&re(G.prototype,z),Z&&re(G,Z),G}}();i(50);var d=i(2),f=O(d),m=i(14),p=O(m),g=i(8),v=O(g),E=i(9),x=O(E),b=i(0),S=O(b),N=i(15),R=O(N),I=i(3),j=O(I),U=i(10),P=O(U),k=i(34),F=O(k);function O(re){return re&&re.__esModule?re:{default:re}}function C(re,G,z){return G in re?Object.defineProperty(re,G,{value:z,enumerable:!0,configurable:!0,writable:!0}):re[G]=z,re}function M(re,G){if(!(re instanceof G))throw new TypeError("Cannot call a class as a function")}var D=(0,P.default)("quill"),$=function(){l(re,null,[{key:"debug",value:function(z){z===!0&&(z="log"),P.default.level(z)}},{key:"find",value:function(z){return z.__quill||S.default.find(z)}},{key:"import",value:function(z){return this.imports[z]==null&&D.error("Cannot import "+z+". Are you sure it was registered?"),this.imports[z]}},{key:"register",value:function(z,Z){var J=this,ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof z!="string"){var le=z.attrName||z.blotName;typeof le=="string"?this.register("formats/"+le,z,Z):Object.keys(z).forEach(function(Q){J.register(Q,z[Q],Z)})}else this.imports[z]!=null&&!ae&&D.warn("Overwriting "+z+" with",Z),this.imports[z]=Z,(z.startsWith("blots/")||z.startsWith("formats/"))&&Z.blotName!=="abstract"?S.default.register(Z):z.startsWith("modules")&&typeof Z.register=="function"&&Z.register()}}]);function re(G){var z=this,Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(M(this,re),this.options=K(G,Z),this.container=this.options.container,this.container==null)return D.error("Invalid Quill container",G);this.options.debug&&re.debug(this.options.debug);var J=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new v.default,this.scroll=S.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new p.default(this.scroll),this.selection=new R.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(v.default.events.EDITOR_CHANGE,function(le){le===v.default.events.TEXT_CHANGE&&z.root.classList.toggle("ql-blank",z.editor.isBlank())}),this.emitter.on(v.default.events.SCROLL_UPDATE,function(le,Q){var ce=z.selection.lastRange,ue=ce&&ce.length===0?ce.index:void 0;ee.call(z,function(){return z.editor.update(null,Q,ue)},le)});var ae=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">`+J+"<p><br></p></div>");this.setContents(ae),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return l(re,[{key:"addContainer",value:function(z){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof z=="string"){var J=z;z=document.createElement("div"),z.classList.add(J)}return this.container.insertBefore(z,Z),z}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(z,Z,J){var ae=this,le=se(z,Z,J),Q=o(le,4);return z=Q[0],Z=Q[1],J=Q[3],ee.call(this,function(){return ae.editor.deleteText(z,Z)},J,z,-1*Z)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(z),this.container.classList.toggle("ql-disabled",!z)}},{key:"focus",value:function(){var z=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=z,this.scrollIntoView()}},{key:"format",value:function(z,Z){var J=this,ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:v.default.sources.API;return ee.call(this,function(){var le=J.getSelection(!0),Q=new f.default;if(le==null)return Q;if(S.default.query(z,S.default.Scope.BLOCK))Q=J.editor.formatLine(le.index,le.length,C({},z,Z));else{if(le.length===0)return J.selection.format(z,Z),Q;Q=J.editor.formatText(le.index,le.length,C({},z,Z))}return J.setSelection(le,v.default.sources.SILENT),Q},ae)}},{key:"formatLine",value:function(z,Z,J,ae,le){var Q=this,ce=void 0,ue=se(z,Z,J,ae,le),fe=o(ue,4);return z=fe[0],Z=fe[1],ce=fe[2],le=fe[3],ee.call(this,function(){return Q.editor.formatLine(z,Z,ce)},le,z,0)}},{key:"formatText",value:function(z,Z,J,ae,le){var Q=this,ce=void 0,ue=se(z,Z,J,ae,le),fe=o(ue,4);return z=fe[0],Z=fe[1],ce=fe[2],le=fe[3],ee.call(this,function(){return Q.editor.formatText(z,Z,ce)},le,z,0)}},{key:"getBounds",value:function(z){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,J=void 0;typeof z=="number"?J=this.selection.getBounds(z,Z):J=this.selection.getBounds(z.index,z.length);var ae=this.container.getBoundingClientRect();return{bottom:J.bottom-ae.top,height:J.height,left:J.left-ae.left,right:J.right-ae.left,top:J.top-ae.top,width:J.width}}},{key:"getContents",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-z,J=se(z,Z),ae=o(J,2);return z=ae[0],Z=ae[1],this.editor.getContents(z,Z)}},{key:"getFormat",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof z=="number"?this.editor.getFormat(z,Z):this.editor.getFormat(z.index,z.length)}},{key:"getIndex",value:function(z){return z.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(z){return this.scroll.leaf(z)}},{key:"getLine",value:function(z){return this.scroll.line(z)}},{key:"getLines",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof z!="number"?this.scroll.lines(z.index,z.length):this.scroll.lines(z,Z)}},{key:"getModule",value:function(z){return this.theme.modules[z]}},{key:"getSelection",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return z&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-z,J=se(z,Z),ae=o(J,2);return z=ae[0],Z=ae[1],this.editor.getText(z,Z)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(z,Z,J){var ae=this,le=arguments.length>3&&arguments[3]!==void 0?arguments[3]:re.sources.API;return ee.call(this,function(){return ae.editor.insertEmbed(z,Z,J)},le,z)}},{key:"insertText",value:function(z,Z,J,ae,le){var Q=this,ce=void 0,ue=se(z,0,J,ae,le),fe=o(ue,4);return z=fe[0],ce=fe[2],le=fe[3],ee.call(this,function(){return Q.editor.insertText(z,Z,ce)},le,z,Z.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(z,Z,J){this.clipboard.dangerouslyPasteHTML(z,Z,J)}},{key:"removeFormat",value:function(z,Z,J){var ae=this,le=se(z,Z,J),Q=o(le,4);return z=Q[0],Z=Q[1],J=Q[3],ee.call(this,function(){return ae.editor.removeFormat(z,Z)},J,z)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(z){var Z=this,J=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v.default.sources.API;return ee.call(this,function(){z=new f.default(z);var ae=Z.getLength(),le=Z.editor.deleteText(0,ae),Q=Z.editor.applyDelta(z),ce=Q.ops[Q.ops.length-1];ce!=null&&typeof ce.insert=="string"&&ce.insert[ce.insert.length-1]===`
`&&(Z.editor.deleteText(Z.getLength()-1,1),Q.delete(1));var ue=le.compose(Q);return ue},J)}},{key:"setSelection",value:function(z,Z,J){if(z==null)this.selection.setRange(null,Z||re.sources.API);else{var ae=se(z,Z,J),le=o(ae,4);z=le[0],Z=le[1],J=le[3],this.selection.setRange(new N.Range(z,Z),J),J!==v.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(z){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v.default.sources.API,J=new f.default().insert(z);return this.setContents(J,Z)}},{key:"update",value:function(){var z=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v.default.sources.USER,Z=this.scroll.update(z);return this.selection.update(z),Z}},{key:"updateContents",value:function(z){var Z=this,J=arguments.length>1&&arguments[1]!==void 0?arguments[1]:v.default.sources.API;return ee.call(this,function(){return z=new f.default(z),Z.editor.applyDelta(z,J)},J,!0)}}]),re}();$.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},$.events=v.default.events,$.sources=v.default.sources,$.version="1.3.7",$.imports={delta:f.default,parchment:S.default,"core/module":x.default,"core/theme":F.default};function K(re,G){if(G=(0,j.default)(!0,{container:re,modules:{clipboard:!0,keyboard:!0,history:!0}},G),!G.theme||G.theme===$.DEFAULTS.theme)G.theme=F.default;else if(G.theme=$.import("themes/"+G.theme),G.theme==null)throw new Error("Invalid theme "+G.theme+". Did you register it?");var z=(0,j.default)(!0,{},G.theme.DEFAULTS);[z,G].forEach(function(ae){ae.modules=ae.modules||{},Object.keys(ae.modules).forEach(function(le){ae.modules[le]===!0&&(ae.modules[le]={})})});var Z=Object.keys(z.modules).concat(Object.keys(G.modules)),J=Z.reduce(function(ae,le){var Q=$.import("modules/"+le);return Q==null?D.error("Cannot load "+le+" module. Are you sure you registered it?"):ae[le]=Q.DEFAULTS||{},ae},{});return G.modules!=null&&G.modules.toolbar&&G.modules.toolbar.constructor!==Object&&(G.modules.toolbar={container:G.modules.toolbar}),G=(0,j.default)(!0,{},$.DEFAULTS,{modules:J},z,G),["bounds","container","scrollingContainer"].forEach(function(ae){typeof G[ae]=="string"&&(G[ae]=document.querySelector(G[ae]))}),G.modules=Object.keys(G.modules).reduce(function(ae,le){return G.modules[le]&&(ae[le]=G.modules[le]),ae},{}),G}function ee(re,G,z,Z){if(this.options.strict&&!this.isEnabled()&&G===v.default.sources.USER)return new f.default;var J=z==null?null:this.getSelection(),ae=this.editor.delta,le=re();if(J!=null&&(z===!0&&(z=J.index),Z==null?J=ie(J,le,G):Z!==0&&(J=ie(J,z,Z,G)),this.setSelection(J,v.default.sources.SILENT)),le.length()>0){var Q,ce=[v.default.events.TEXT_CHANGE,le,ae,G];if((Q=this.emitter).emit.apply(Q,[v.default.events.EDITOR_CHANGE].concat(ce)),G!==v.default.sources.SILENT){var ue;(ue=this.emitter).emit.apply(ue,ce)}}return le}function se(re,G,z,Z,J){var ae={};return typeof re.index=="number"&&typeof re.length=="number"?typeof G!="number"?(J=Z,Z=z,z=G,G=re.length,re=re.index):(G=re.length,re=re.index):typeof G!="number"&&(J=Z,Z=z,z=G,G=0),(typeof z>"u"?"undefined":s(z))==="object"?(ae=z,J=Z):typeof z=="string"&&(Z!=null?ae[z]=Z:J=z),J=J||v.default.sources.API,[re,G,ae,J]}function ie(re,G,z,Z){if(re==null)return null;var J=void 0,ae=void 0;if(G instanceof f.default){var le=[re.index,re.index+re.length].map(function(fe){return G.transformPosition(fe,Z!==v.default.sources.USER)}),Q=o(le,2);J=Q[0],ae=Q[1]}else{var ce=[re.index,re.index+re.length].map(function(fe){return fe<G||fe===G&&Z===v.default.sources.USER?fe:z>=0?fe+z:Math.max(G,fe+z)}),ue=o(ce,2);J=ue[0],ae=ue[1]}return new N.Range(J,ae-J)}n.expandConfig=K,n.overload=se,n.default=$},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function b(S,N){for(var R=0;R<N.length;R++){var I=N[R];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(S,I.key,I)}}return function(S,N,R){return N&&b(S.prototype,N),R&&b(S,R),S}}(),o=function b(S,N,R){S===null&&(S=Function.prototype);var I=Object.getOwnPropertyDescriptor(S,N);if(I===void 0){var j=Object.getPrototypeOf(S);return j===null?void 0:b(j,N,R)}else{if("value"in I)return I.value;var U=I.get;return U===void 0?void 0:U.call(R)}},l=i(7),d=p(l),f=i(0),m=p(f);function p(b){return b&&b.__esModule?b:{default:b}}function g(b,S){if(!(b instanceof S))throw new TypeError("Cannot call a class as a function")}function v(b,S){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:b}function E(b,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);b.prototype=Object.create(S&&S.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(b,S):b.__proto__=S)}var x=function(b){E(S,b);function S(){return g(this,S),v(this,(S.__proto__||Object.getPrototypeOf(S)).apply(this,arguments))}return s(S,[{key:"formatAt",value:function(R,I,j,U){if(S.compare(this.statics.blotName,j)<0&&m.default.query(j,m.default.Scope.BLOT)){var P=this.isolate(R,I);U&&P.wrap(j,U)}else o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"formatAt",this).call(this,R,I,j,U)}},{key:"optimize",value:function(R){if(o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"optimize",this).call(this,R),this.parent instanceof S&&S.compare(this.statics.blotName,this.parent.statics.blotName)>0){var I=this.parent.isolate(this.offset(),this.length());this.moveChildren(I),I.wrap(this)}}}],[{key:"compare",value:function(R,I){var j=S.order.indexOf(R),U=S.order.indexOf(I);return j>=0||U>=0?j-U:R===I?0:R<I?-1:1}}]),S}(m.default.Inline);x.allowedChildren=[x,m.default.Embed,d.default],x.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],n.default=x},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(0),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}function d(g,v){if(!(g instanceof v))throw new TypeError("Cannot call a class as a function")}function f(g,v){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:g}function m(g,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);g.prototype=Object.create(v&&v.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(g,v):g.__proto__=v)}var p=function(g){m(v,g);function v(){return d(this,v),f(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return v}(o.default.Text);n.default=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function N(R,I){for(var j=0;j<I.length;j++){var U=I[j];U.enumerable=U.enumerable||!1,U.configurable=!0,"value"in U&&(U.writable=!0),Object.defineProperty(R,U.key,U)}}return function(R,I,j){return I&&N(R.prototype,I),j&&N(R,j),R}}(),o=function N(R,I,j){R===null&&(R=Function.prototype);var U=Object.getOwnPropertyDescriptor(R,I);if(U===void 0){var P=Object.getPrototypeOf(R);return P===null?void 0:N(P,I,j)}else{if("value"in U)return U.value;var k=U.get;return k===void 0?void 0:k.call(j)}},l=i(54),d=p(l),f=i(10),m=p(f);function p(N){return N&&N.__esModule?N:{default:N}}function g(N,R){if(!(N instanceof R))throw new TypeError("Cannot call a class as a function")}function v(N,R){if(!N)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R&&(typeof R=="object"||typeof R=="function")?R:N}function E(N,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof R);N.prototype=Object.create(R&&R.prototype,{constructor:{value:N,enumerable:!1,writable:!0,configurable:!0}}),R&&(Object.setPrototypeOf?Object.setPrototypeOf(N,R):N.__proto__=R)}var x=(0,m.default)("quill:events"),b=["selectionchange","mousedown","mouseup","click"];b.forEach(function(N){document.addEventListener(N,function(){for(var R=arguments.length,I=Array(R),j=0;j<R;j++)I[j]=arguments[j];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(U){if(U.__quill&&U.__quill.emitter){var P;(P=U.__quill.emitter).handleDOM.apply(P,I)}})})});var S=function(N){E(R,N);function R(){g(this,R);var I=v(this,(R.__proto__||Object.getPrototypeOf(R)).call(this));return I.listeners={},I.on("error",x.error),I}return s(R,[{key:"emit",value:function(){x.log.apply(x,arguments),o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(j){for(var U=arguments.length,P=Array(U>1?U-1:0),k=1;k<U;k++)P[k-1]=arguments[k];(this.listeners[j.type]||[]).forEach(function(F){var O=F.node,C=F.handler;(j.target===O||O.contains(j.target))&&C.apply(void 0,[j].concat(P))})}},{key:"listenDOM",value:function(j,U,P){this.listeners[j]||(this.listeners[j]=[]),this.listeners[j].push({node:U,handler:P})}}]),R}(d.default);S.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},S.sources={API:"api",SILENT:"silent",USER:"user"},n.default=S},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});function s(l,d){if(!(l instanceof d))throw new TypeError("Cannot call a class as a function")}var o=function l(d){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};s(this,l),this.quill=d,this.options=f};o.DEFAULTS={},n.default=o},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=["error","warn","log","info"],o="warn";function l(f){if(s.indexOf(f)<=s.indexOf(o)){for(var m,p=arguments.length,g=Array(p>1?p-1:0),v=1;v<p;v++)g[v-1]=arguments[v];(m=console)[f].apply(m,g)}}function d(f){return s.reduce(function(m,p){return m[p]=l.bind(console,p,f),m},{})}l.level=d.level=function(f){o=f},n.default=d},function(t,n,i){var s=Array.prototype.slice,o=i(52),l=i(53),d=t.exports=function(g,v,E){return E||(E={}),g===v?!0:g instanceof Date&&v instanceof Date?g.getTime()===v.getTime():!g||!v||typeof g!="object"&&typeof v!="object"?E.strict?g===v:g==v:p(g,v,E)};function f(g){return g==null}function m(g){return!(!g||typeof g!="object"||typeof g.length!="number"||typeof g.copy!="function"||typeof g.slice!="function"||g.length>0&&typeof g[0]!="number")}function p(g,v,E){var x,b;if(f(g)||f(v)||g.prototype!==v.prototype)return!1;if(l(g))return l(v)?(g=s.call(g),v=s.call(v),d(g,v,E)):!1;if(m(g)){if(!m(v)||g.length!==v.length)return!1;for(x=0;x<g.length;x++)if(g[x]!==v[x])return!1;return!0}try{var S=o(g),N=o(v)}catch{return!1}if(S.length!=N.length)return!1;for(S.sort(),N.sort(),x=S.length-1;x>=0;x--)if(S[x]!=N[x])return!1;for(x=S.length-1;x>=0;x--)if(b=S[x],!d(g[b],v[b],E))return!1;return typeof g==typeof v}},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(1),o=function(){function l(d,f,m){m===void 0&&(m={}),this.attrName=d,this.keyName=f;var p=s.Scope.TYPE&s.Scope.ATTRIBUTE;m.scope!=null?this.scope=m.scope&s.Scope.LEVEL|p:this.scope=s.Scope.ATTRIBUTE,m.whitelist!=null&&(this.whitelist=m.whitelist)}return l.keys=function(d){return[].map.call(d.attributes,function(f){return f.name})},l.prototype.add=function(d,f){return this.canAdd(d,f)?(d.setAttribute(this.keyName,f),!0):!1},l.prototype.canAdd=function(d,f){var m=s.query(d,s.Scope.BLOT&(this.scope|s.Scope.TYPE));return m==null?!1:this.whitelist==null?!0:typeof f=="string"?this.whitelist.indexOf(f.replace(/["']/g,""))>-1:this.whitelist.indexOf(f)>-1},l.prototype.remove=function(d){d.removeAttribute(this.keyName)},l.prototype.value=function(d){var f=d.getAttribute(this.keyName);return this.canAdd(d,f)&&f?f:""},l}();n.default=o},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Code=void 0;var s=function(){function k(F,O){var C=[],M=!0,D=!1,$=void 0;try{for(var K=F[Symbol.iterator](),ee;!(M=(ee=K.next()).done)&&(C.push(ee.value),!(O&&C.length===O));M=!0);}catch(se){D=!0,$=se}finally{try{!M&&K.return&&K.return()}finally{if(D)throw $}}return C}return function(F,O){if(Array.isArray(F))return F;if(Symbol.iterator in Object(F))return k(F,O);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function k(F,O){for(var C=0;C<O.length;C++){var M=O[C];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(F,M.key,M)}}return function(F,O,C){return O&&k(F.prototype,O),C&&k(F,C),F}}(),l=function k(F,O,C){F===null&&(F=Function.prototype);var M=Object.getOwnPropertyDescriptor(F,O);if(M===void 0){var D=Object.getPrototypeOf(F);return D===null?void 0:k(D,O,C)}else{if("value"in M)return M.value;var $=M.get;return $===void 0?void 0:$.call(C)}},d=i(2),f=N(d),m=i(0),p=N(m),g=i(4),v=N(g),E=i(6),x=N(E),b=i(7),S=N(b);function N(k){return k&&k.__esModule?k:{default:k}}function R(k,F){if(!(k instanceof F))throw new TypeError("Cannot call a class as a function")}function I(k,F){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F&&(typeof F=="object"||typeof F=="function")?F:k}function j(k,F){if(typeof F!="function"&&F!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof F);k.prototype=Object.create(F&&F.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),F&&(Object.setPrototypeOf?Object.setPrototypeOf(k,F):k.__proto__=F)}var U=function(k){j(F,k);function F(){return R(this,F),I(this,(F.__proto__||Object.getPrototypeOf(F)).apply(this,arguments))}return F}(x.default);U.blotName="code",U.tagName="CODE";var P=function(k){j(F,k);function F(){return R(this,F),I(this,(F.__proto__||Object.getPrototypeOf(F)).apply(this,arguments))}return o(F,[{key:"delta",value:function(){var C=this,M=this.domNode.textContent;return M.endsWith(`
`)&&(M=M.slice(0,-1)),M.split(`
`).reduce(function(D,$){return D.insert($).insert(`
`,C.formats())},new f.default)}},{key:"format",value:function(C,M){if(!(C===this.statics.blotName&&M)){var D=this.descendant(S.default,this.length()-1),$=s(D,1),K=$[0];K!=null&&K.deleteAt(K.length()-1,1),l(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"format",this).call(this,C,M)}}},{key:"formatAt",value:function(C,M,D,$){if(M!==0&&!(p.default.query(D,p.default.Scope.BLOCK)==null||D===this.statics.blotName&&$===this.statics.formats(this.domNode))){var K=this.newlineIndex(C);if(!(K<0||K>=C+M)){var ee=this.newlineIndex(C,!0)+1,se=K-ee+1,ie=this.isolate(ee,se),re=ie.next;ie.format(D,$),re instanceof F&&re.formatAt(0,C-ee+M-se,D,$)}}}},{key:"insertAt",value:function(C,M,D){if(D==null){var $=this.descendant(S.default,C),K=s($,2),ee=K[0],se=K[1];ee.insertAt(se,M)}}},{key:"length",value:function(){var C=this.domNode.textContent.length;return this.domNode.textContent.endsWith(`
`)?C:C+1}},{key:"newlineIndex",value:function(C){var M=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(M)return this.domNode.textContent.slice(0,C).lastIndexOf(`
`);var D=this.domNode.textContent.slice(C).indexOf(`
`);return D>-1?C+D:-1}},{key:"optimize",value:function(C){this.domNode.textContent.endsWith(`
`)||this.appendChild(p.default.create("text",`
`)),l(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"optimize",this).call(this,C);var M=this.next;M!=null&&M.prev===this&&M.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===M.statics.formats(M.domNode)&&(M.optimize(C),M.moveChildren(this),M.remove())}},{key:"replace",value:function(C){l(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"replace",this).call(this,C),[].slice.call(this.domNode.querySelectorAll("*")).forEach(function(M){var D=p.default.find(M);D==null?M.parentNode.removeChild(M):D instanceof p.default.Embed?D.remove():D.unwrap()})}}],[{key:"create",value:function(C){var M=l(F.__proto__||Object.getPrototypeOf(F),"create",this).call(this,C);return M.setAttribute("spellcheck",!1),M}},{key:"formats",value:function(){return!0}}]),F}(v.default);P.blotName="code-block",P.tagName="PRE",P.TAB="  ",n.Code=U,n.default=P},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(re){return typeof re}:function(re){return re&&typeof Symbol=="function"&&re.constructor===Symbol&&re!==Symbol.prototype?"symbol":typeof re},o=function(){function re(G,z){var Z=[],J=!0,ae=!1,le=void 0;try{for(var Q=G[Symbol.iterator](),ce;!(J=(ce=Q.next()).done)&&(Z.push(ce.value),!(z&&Z.length===z));J=!0);}catch(ue){ae=!0,le=ue}finally{try{!J&&Q.return&&Q.return()}finally{if(ae)throw le}}return Z}return function(G,z){if(Array.isArray(G))return G;if(Symbol.iterator in Object(G))return re(G,z);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function re(G,z){for(var Z=0;Z<z.length;Z++){var J=z[Z];J.enumerable=J.enumerable||!1,J.configurable=!0,"value"in J&&(J.writable=!0),Object.defineProperty(G,J.key,J)}}return function(G,z,Z){return z&&re(G.prototype,z),Z&&re(G,Z),G}}(),d=i(2),f=M(d),m=i(20),p=M(m),g=i(0),v=M(g),E=i(13),x=M(E),b=i(24),S=M(b),N=i(4),R=M(N),I=i(16),j=M(I),U=i(21),P=M(U),k=i(11),F=M(k),O=i(3),C=M(O);function M(re){return re&&re.__esModule?re:{default:re}}function D(re,G,z){return G in re?Object.defineProperty(re,G,{value:z,enumerable:!0,configurable:!0,writable:!0}):re[G]=z,re}function $(re,G){if(!(re instanceof G))throw new TypeError("Cannot call a class as a function")}var K=/^[ -~]*$/,ee=function(){function re(G){$(this,re),this.scroll=G,this.delta=this.getDelta()}return l(re,[{key:"applyDelta",value:function(z){var Z=this,J=!1;this.scroll.update();var ae=this.scroll.length();return this.scroll.batchStart(),z=ie(z),z.reduce(function(le,Q){var ce=Q.retain||Q.delete||Q.insert.length||1,ue=Q.attributes||{};if(Q.insert!=null){if(typeof Q.insert=="string"){var fe=Q.insert;fe.endsWith(`
`)&&J&&(J=!1,fe=fe.slice(0,-1)),le>=ae&&!fe.endsWith(`
`)&&(J=!0),Z.scroll.insertAt(le,fe);var ve=Z.scroll.line(le),Me=o(ve,2),Pe=Me[0],qe=Me[1],Ge=(0,C.default)({},(0,N.bubbleFormats)(Pe));if(Pe instanceof R.default){var lt=Pe.descendant(v.default.Leaf,qe),Ct=o(lt,1),bt=Ct[0];Ge=(0,C.default)(Ge,(0,N.bubbleFormats)(bt))}ue=p.default.attributes.diff(Ge,ue)||{}}else if(s(Q.insert)==="object"){var Te=Object.keys(Q.insert)[0];if(Te==null)return le;Z.scroll.insertAt(le,Te,Q.insert[Te])}ae+=ce}return Object.keys(ue).forEach(function(Ie){Z.scroll.formatAt(le,ce,Ie,ue[Ie])}),le+ce},0),z.reduce(function(le,Q){return typeof Q.delete=="number"?(Z.scroll.deleteAt(le,Q.delete),le):le+(Q.retain||Q.insert.length||1)},0),this.scroll.batchEnd(),this.update(z)}},{key:"deleteText",value:function(z,Z){return this.scroll.deleteAt(z,Z),this.update(new f.default().retain(z).delete(Z))}},{key:"formatLine",value:function(z,Z){var J=this,ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.scroll.update(),Object.keys(ae).forEach(function(le){if(!(J.scroll.whitelist!=null&&!J.scroll.whitelist[le])){var Q=J.scroll.lines(z,Math.max(Z,1)),ce=Z;Q.forEach(function(ue){var fe=ue.length();if(!(ue instanceof x.default))ue.format(le,ae[le]);else{var ve=z-ue.offset(J.scroll),Me=ue.newlineIndex(ve+ce)-ve+1;ue.formatAt(ve,Me,le,ae[le])}ce-=fe})}}),this.scroll.optimize(),this.update(new f.default().retain(z).retain(Z,(0,P.default)(ae)))}},{key:"formatText",value:function(z,Z){var J=this,ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Object.keys(ae).forEach(function(le){J.scroll.formatAt(z,Z,le,ae[le])}),this.update(new f.default().retain(z).retain(Z,(0,P.default)(ae)))}},{key:"getContents",value:function(z,Z){return this.delta.slice(z,z+Z)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce(function(z,Z){return z.concat(Z.delta())},new f.default)}},{key:"getFormat",value:function(z){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,J=[],ae=[];Z===0?this.scroll.path(z).forEach(function(Q){var ce=o(Q,1),ue=ce[0];ue instanceof R.default?J.push(ue):ue instanceof v.default.Leaf&&ae.push(ue)}):(J=this.scroll.lines(z,Z),ae=this.scroll.descendants(v.default.Leaf,z,Z));var le=[J,ae].map(function(Q){if(Q.length===0)return{};for(var ce=(0,N.bubbleFormats)(Q.shift());Object.keys(ce).length>0;){var ue=Q.shift();if(ue==null)return ce;ce=se((0,N.bubbleFormats)(ue),ce)}return ce});return C.default.apply(C.default,le)}},{key:"getText",value:function(z,Z){return this.getContents(z,Z).filter(function(J){return typeof J.insert=="string"}).map(function(J){return J.insert}).join("")}},{key:"insertEmbed",value:function(z,Z,J){return this.scroll.insertAt(z,Z,J),this.update(new f.default().retain(z).insert(D({},Z,J)))}},{key:"insertText",value:function(z,Z){var J=this,ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Z=Z.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(z,Z),Object.keys(ae).forEach(function(le){J.scroll.formatAt(z,Z.length,le,ae[le])}),this.update(new f.default().retain(z).insert(Z,(0,P.default)(ae)))}},{key:"isBlank",value:function(){if(this.scroll.children.length==0)return!0;if(this.scroll.children.length>1)return!1;var z=this.scroll.children.head;return z.statics.blotName!==R.default.blotName||z.children.length>1?!1:z.children.head instanceof j.default}},{key:"removeFormat",value:function(z,Z){var J=this.getText(z,Z),ae=this.scroll.line(z+Z),le=o(ae,2),Q=le[0],ce=le[1],ue=0,fe=new f.default;Q!=null&&(Q instanceof x.default?ue=Q.newlineIndex(ce)-ce+1:ue=Q.length()-ce,fe=Q.delta().slice(ce,ce+ue-1).insert(`
`));var ve=this.getContents(z,Z+ue),Me=ve.diff(new f.default().insert(J).concat(fe)),Pe=new f.default().retain(z).concat(Me);return this.applyDelta(Pe)}},{key:"update",value:function(z){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],J=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,ae=this.delta;if(Z.length===1&&Z[0].type==="characterData"&&Z[0].target.data.match(K)&&v.default.find(Z[0].target)){var le=v.default.find(Z[0].target),Q=(0,N.bubbleFormats)(le),ce=le.offset(this.scroll),ue=Z[0].oldValue.replace(S.default.CONTENTS,""),fe=new f.default().insert(ue),ve=new f.default().insert(le.value()),Me=new f.default().retain(ce).concat(fe.diff(ve,J));z=Me.reduce(function(Pe,qe){return qe.insert?Pe.insert(qe.insert,Q):Pe.push(qe)},new f.default),this.delta=ae.compose(z)}else this.delta=this.getDelta(),(!z||!(0,F.default)(ae.compose(z),this.delta))&&(z=ae.diff(this.delta,J));return z}}]),re}();function se(re,G){return Object.keys(G).reduce(function(z,Z){return re[Z]==null||(G[Z]===re[Z]?z[Z]=G[Z]:Array.isArray(G[Z])?G[Z].indexOf(re[Z])<0&&(z[Z]=G[Z].concat([re[Z]])):z[Z]=[G[Z],re[Z]]),z},{})}function ie(re){return re.reduce(function(G,z){if(z.insert===1){var Z=(0,P.default)(z.attributes);return delete Z.image,G.insert({image:z.attributes.image},Z)}if(z.attributes!=null&&(z.attributes.list===!0||z.attributes.bullet===!0)&&(z=(0,P.default)(z),z.attributes.list?z.attributes.list="ordered":(z.attributes.list="bullet",delete z.attributes.bullet)),typeof z.insert=="string"){var J=z.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return G.insert(J,z.attributes)}return G.push(z)},new f.default)}n.default=ee},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Range=void 0;var s=function(){function k(F,O){var C=[],M=!0,D=!1,$=void 0;try{for(var K=F[Symbol.iterator](),ee;!(M=(ee=K.next()).done)&&(C.push(ee.value),!(O&&C.length===O));M=!0);}catch(se){D=!0,$=se}finally{try{!M&&K.return&&K.return()}finally{if(D)throw $}}return C}return function(F,O){if(Array.isArray(F))return F;if(Symbol.iterator in Object(F))return k(F,O);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function k(F,O){for(var C=0;C<O.length;C++){var M=O[C];M.enumerable=M.enumerable||!1,M.configurable=!0,"value"in M&&(M.writable=!0),Object.defineProperty(F,M.key,M)}}return function(F,O,C){return O&&k(F.prototype,O),C&&k(F,C),F}}(),l=i(0),d=S(l),f=i(21),m=S(f),p=i(11),g=S(p),v=i(8),E=S(v),x=i(10),b=S(x);function S(k){return k&&k.__esModule?k:{default:k}}function N(k){if(Array.isArray(k)){for(var F=0,O=Array(k.length);F<k.length;F++)O[F]=k[F];return O}else return Array.from(k)}function R(k,F){if(!(k instanceof F))throw new TypeError("Cannot call a class as a function")}var I=(0,b.default)("quill:selection"),j=function k(F){var O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;R(this,k),this.index=F,this.length=O},U=function(){function k(F,O){var C=this;R(this,k),this.emitter=O,this.scroll=F,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=d.default.create("cursor",this),this.lastRange=this.savedRange=new j(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){C.mouseDown||setTimeout(C.update.bind(C,E.default.sources.USER),1)}),this.emitter.on(E.default.events.EDITOR_CHANGE,function(M,D){M===E.default.events.TEXT_CHANGE&&D.length()>0&&C.update(E.default.sources.SILENT)}),this.emitter.on(E.default.events.SCROLL_BEFORE_UPDATE,function(){if(C.hasFocus()){var M=C.getNativeRange();M!=null&&M.start.node!==C.cursor.textNode&&C.emitter.once(E.default.events.SCROLL_UPDATE,function(){try{C.setNativeRange(M.start.node,M.start.offset,M.end.node,M.end.offset)}catch{}})}}),this.emitter.on(E.default.events.SCROLL_OPTIMIZE,function(M,D){if(D.range){var $=D.range,K=$.startNode,ee=$.startOffset,se=$.endNode,ie=$.endOffset;C.setNativeRange(K,ee,se,ie)}}),this.update(E.default.sources.SILENT)}return o(k,[{key:"handleComposition",value:function(){var O=this;this.root.addEventListener("compositionstart",function(){O.composing=!0}),this.root.addEventListener("compositionend",function(){if(O.composing=!1,O.cursor.parent){var C=O.cursor.restore();if(!C)return;setTimeout(function(){O.setNativeRange(C.startNode,C.startOffset,C.endNode,C.endOffset)},1)}})}},{key:"handleDragging",value:function(){var O=this;this.emitter.listenDOM("mousedown",document.body,function(){O.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){O.mouseDown=!1,O.update(E.default.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(O,C){if(!(this.scroll.whitelist!=null&&!this.scroll.whitelist[O])){this.scroll.update();var M=this.getNativeRange();if(!(M==null||!M.native.collapsed||d.default.query(O,d.default.Scope.BLOCK))){if(M.start.node!==this.cursor.textNode){var D=d.default.find(M.start.node,!1);if(D==null)return;if(D instanceof d.default.Leaf){var $=D.split(M.start.offset);D.parent.insertBefore(this.cursor,$)}else D.insertBefore(this.cursor,M.start.node);this.cursor.attach()}this.cursor.format(O,C),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(O){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,M=this.scroll.length();O=Math.min(O,M-1),C=Math.min(O+C,M-1)-O;var D=void 0,$=this.scroll.leaf(O),K=s($,2),ee=K[0],se=K[1];if(ee==null)return null;var ie=ee.position(se,!0),re=s(ie,2);D=re[0],se=re[1];var G=document.createRange();if(C>0){G.setStart(D,se);var z=this.scroll.leaf(O+C),Z=s(z,2);if(ee=Z[0],se=Z[1],ee==null)return null;var J=ee.position(se,!0),ae=s(J,2);return D=ae[0],se=ae[1],G.setEnd(D,se),G.getBoundingClientRect()}else{var le="left",Q=void 0;return D instanceof Text?(se<D.data.length?(G.setStart(D,se),G.setEnd(D,se+1)):(G.setStart(D,se-1),G.setEnd(D,se),le="right"),Q=G.getBoundingClientRect()):(Q=ee.domNode.getBoundingClientRect(),se>0&&(le="right")),{bottom:Q.top+Q.height,height:Q.height,left:Q[le],right:Q[le],top:Q.top,width:0}}}},{key:"getNativeRange",value:function(){var O=document.getSelection();if(O==null||O.rangeCount<=0)return null;var C=O.getRangeAt(0);if(C==null)return null;var M=this.normalizeNative(C);return I.info("getNativeRange",M),M}},{key:"getRange",value:function(){var O=this.getNativeRange();if(O==null)return[null,null];var C=this.normalizedToRange(O);return[C,O]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(O){var C=this,M=[[O.start.node,O.start.offset]];O.native.collapsed||M.push([O.end.node,O.end.offset]);var D=M.map(function(ee){var se=s(ee,2),ie=se[0],re=se[1],G=d.default.find(ie,!0),z=G.offset(C.scroll);return re===0?z:G instanceof d.default.Container?z+G.length():z+G.index(ie,re)}),$=Math.min(Math.max.apply(Math,N(D)),this.scroll.length()-1),K=Math.min.apply(Math,[$].concat(N(D)));return new j(K,$-K)}},{key:"normalizeNative",value:function(O){if(!P(this.root,O.startContainer)||!O.collapsed&&!P(this.root,O.endContainer))return null;var C={start:{node:O.startContainer,offset:O.startOffset},end:{node:O.endContainer,offset:O.endOffset},native:O};return[C.start,C.end].forEach(function(M){for(var D=M.node,$=M.offset;!(D instanceof Text)&&D.childNodes.length>0;)if(D.childNodes.length>$)D=D.childNodes[$],$=0;else if(D.childNodes.length===$)D=D.lastChild,$=D instanceof Text?D.data.length:D.childNodes.length+1;else break;M.node=D,M.offset=$}),C}},{key:"rangeToNative",value:function(O){var C=this,M=O.collapsed?[O.index]:[O.index,O.index+O.length],D=[],$=this.scroll.length();return M.forEach(function(K,ee){K=Math.min($-1,K);var se=void 0,ie=C.scroll.leaf(K),re=s(ie,2),G=re[0],z=re[1],Z=G.position(z,ee!==0),J=s(Z,2);se=J[0],z=J[1],D.push(se,z)}),D.length<2&&(D=D.concat(D)),D}},{key:"scrollIntoView",value:function(O){var C=this.lastRange;if(C!=null){var M=this.getBounds(C.index,C.length);if(M!=null){var D=this.scroll.length()-1,$=this.scroll.line(Math.min(C.index,D)),K=s($,1),ee=K[0],se=ee;if(C.length>0){var ie=this.scroll.line(Math.min(C.index+C.length,D)),re=s(ie,1);se=re[0]}if(!(ee==null||se==null)){var G=O.getBoundingClientRect();M.top<G.top?O.scrollTop-=G.top-M.top:M.bottom>G.bottom&&(O.scrollTop+=M.bottom-G.bottom)}}}}},{key:"setNativeRange",value:function(O,C){var M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:O,D=arguments.length>3&&arguments[3]!==void 0?arguments[3]:C,$=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(I.info("setNativeRange",O,C,M,D),!(O!=null&&(this.root.parentNode==null||O.parentNode==null||M.parentNode==null))){var K=document.getSelection();if(K!=null)if(O!=null){this.hasFocus()||this.root.focus();var ee=(this.getNativeRange()||{}).native;if(ee==null||$||O!==ee.startContainer||C!==ee.startOffset||M!==ee.endContainer||D!==ee.endOffset){O.tagName=="BR"&&(C=[].indexOf.call(O.parentNode.childNodes,O),O=O.parentNode),M.tagName=="BR"&&(D=[].indexOf.call(M.parentNode.childNodes,M),M=M.parentNode);var se=document.createRange();se.setStart(O,C),se.setEnd(M,D),K.removeAllRanges(),K.addRange(se)}}else K.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(O){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:E.default.sources.API;if(typeof C=="string"&&(M=C,C=!1),I.info("setRange",O),O!=null){var D=this.rangeToNative(O);this.setNativeRange.apply(this,N(D).concat([C]))}else this.setNativeRange(null);this.update(M)}},{key:"update",value:function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:E.default.sources.USER,C=this.lastRange,M=this.getRange(),D=s(M,2),$=D[0],K=D[1];if(this.lastRange=$,this.lastRange!=null&&(this.savedRange=this.lastRange),!(0,g.default)(C,this.lastRange)){var ee;!this.composing&&K!=null&&K.native.collapsed&&K.start.node!==this.cursor.textNode&&this.cursor.restore();var se=[E.default.events.SELECTION_CHANGE,(0,m.default)(this.lastRange),(0,m.default)(C),O];if((ee=this.emitter).emit.apply(ee,[E.default.events.EDITOR_CHANGE].concat(se)),O!==E.default.sources.SILENT){var ie;(ie=this.emitter).emit.apply(ie,se)}}}}]),k}();function P(k,F){try{F.parentNode}catch{return!1}return F instanceof Text&&(F=F.parentNode),k.contains(F)}n.Range=j,n.default=U},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function E(x,b){for(var S=0;S<b.length;S++){var N=b[S];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(x,N.key,N)}}return function(x,b,S){return b&&E(x.prototype,b),S&&E(x,S),x}}(),o=function E(x,b,S){x===null&&(x=Function.prototype);var N=Object.getOwnPropertyDescriptor(x,b);if(N===void 0){var R=Object.getPrototypeOf(x);return R===null?void 0:E(R,b,S)}else{if("value"in N)return N.value;var I=N.get;return I===void 0?void 0:I.call(S)}},l=i(0),d=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function p(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var v=function(E){g(x,E);function x(){return m(this,x),p(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return s(x,[{key:"insertInto",value:function(S,N){S.children.length===0?o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"insertInto",this).call(this,S,N):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),x}(d.default.Embed);v.blotName="break",v.tagName="BR",n.default=v},function(t,n,i){var s=this&&this.__extends||function(){var p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,v){g.__proto__=v}||function(g,v){for(var E in v)v.hasOwnProperty(E)&&(g[E]=v[E])};return function(g,v){p(g,v);function E(){this.constructor=g}g.prototype=v===null?Object.create(v):(E.prototype=v.prototype,new E)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(44),l=i(30),d=i(1),f=function(p){s(g,p);function g(v){var E=p.call(this,v)||this;return E.build(),E}return g.prototype.appendChild=function(v){this.insertBefore(v)},g.prototype.attach=function(){p.prototype.attach.call(this),this.children.forEach(function(v){v.attach()})},g.prototype.build=function(){var v=this;this.children=new o.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(E){try{var x=m(E);v.insertBefore(x,v.children.head||void 0)}catch(b){if(b instanceof d.ParchmentError)return;throw b}})},g.prototype.deleteAt=function(v,E){if(v===0&&E===this.length())return this.remove();this.children.forEachAt(v,E,function(x,b,S){x.deleteAt(b,S)})},g.prototype.descendant=function(v,E){var x=this.children.find(E),b=x[0],S=x[1];return v.blotName==null&&v(b)||v.blotName!=null&&b instanceof v?[b,S]:b instanceof g?b.descendant(v,S):[null,-1]},g.prototype.descendants=function(v,E,x){E===void 0&&(E=0),x===void 0&&(x=Number.MAX_VALUE);var b=[],S=x;return this.children.forEachAt(E,x,function(N,R,I){(v.blotName==null&&v(N)||v.blotName!=null&&N instanceof v)&&b.push(N),N instanceof g&&(b=b.concat(N.descendants(v,R,S))),S-=I}),b},g.prototype.detach=function(){this.children.forEach(function(v){v.detach()}),p.prototype.detach.call(this)},g.prototype.formatAt=function(v,E,x,b){this.children.forEachAt(v,E,function(S,N,R){S.formatAt(N,R,x,b)})},g.prototype.insertAt=function(v,E,x){var b=this.children.find(v),S=b[0],N=b[1];if(S)S.insertAt(N,E,x);else{var R=x==null?d.create("text",E):d.create(E,x);this.appendChild(R)}},g.prototype.insertBefore=function(v,E){if(this.statics.allowedChildren!=null&&!this.statics.allowedChildren.some(function(x){return v instanceof x}))throw new d.ParchmentError("Cannot insert "+v.statics.blotName+" into "+this.statics.blotName);v.insertInto(this,E)},g.prototype.length=function(){return this.children.reduce(function(v,E){return v+E.length()},0)},g.prototype.moveChildren=function(v,E){this.children.forEach(function(x){v.insertBefore(x,E)})},g.prototype.optimize=function(v){if(p.prototype.optimize.call(this,v),this.children.length===0)if(this.statics.defaultChild!=null){var E=d.create(this.statics.defaultChild);this.appendChild(E),E.optimize(v)}else this.remove()},g.prototype.path=function(v,E){E===void 0&&(E=!1);var x=this.children.find(v,E),b=x[0],S=x[1],N=[[this,v]];return b instanceof g?N.concat(b.path(S,E)):(b!=null&&N.push([b,S]),N)},g.prototype.removeChild=function(v){this.children.remove(v)},g.prototype.replace=function(v){v instanceof g&&v.moveChildren(this),p.prototype.replace.call(this,v)},g.prototype.split=function(v,E){if(E===void 0&&(E=!1),!E){if(v===0)return this;if(v===this.length())return this.next}var x=this.clone();return this.parent.insertBefore(x,this.next),this.children.forEachAt(v,this.length(),function(b,S,N){b=b.split(S,E),x.appendChild(b)}),x},g.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},g.prototype.update=function(v,E){var x=this,b=[],S=[];v.forEach(function(N){N.target===x.domNode&&N.type==="childList"&&(b.push.apply(b,N.addedNodes),S.push.apply(S,N.removedNodes))}),S.forEach(function(N){if(!(N.parentNode!=null&&N.tagName!=="IFRAME"&&document.body.compareDocumentPosition(N)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var R=d.find(N);R!=null&&(R.domNode.parentNode==null||R.domNode.parentNode===x.domNode)&&R.detach()}}),b.filter(function(N){return N.parentNode==x.domNode}).sort(function(N,R){return N===R?0:N.compareDocumentPosition(R)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(N){var R=null;N.nextSibling!=null&&(R=d.find(N.nextSibling));var I=m(N);(I.next!=R||I.next==null)&&(I.parent!=null&&I.parent.removeChild(x),x.insertBefore(I,R||void 0))})},g}(l.default);function m(p){var g=d.find(p);if(g==null)try{g=d.create(p)}catch{g=d.create(d.Scope.INLINE),[].slice.call(p.childNodes).forEach(function(E){g.domNode.appendChild(E)}),p.parentNode&&p.parentNode.replaceChild(g.domNode,p),g.attach()}return g}n.default=f},function(t,n,i){var s=this&&this.__extends||function(){var p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,v){g.__proto__=v}||function(g,v){for(var E in v)v.hasOwnProperty(E)&&(g[E]=v[E])};return function(g,v){p(g,v);function E(){this.constructor=g}g.prototype=v===null?Object.create(v):(E.prototype=v.prototype,new E)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12),l=i(31),d=i(17),f=i(1),m=function(p){s(g,p);function g(v){var E=p.call(this,v)||this;return E.attributes=new l.default(E.domNode),E}return g.formats=function(v){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return v.tagName.toLowerCase()},g.prototype.format=function(v,E){var x=f.query(v);x instanceof o.default?this.attributes.attribute(x,E):E&&x!=null&&(v!==this.statics.blotName||this.formats()[v]!==E)&&this.replaceWith(v,E)},g.prototype.formats=function(){var v=this.attributes.values(),E=this.statics.formats(this.domNode);return E!=null&&(v[this.statics.blotName]=E),v},g.prototype.replaceWith=function(v,E){var x=p.prototype.replaceWith.call(this,v,E);return this.attributes.copy(x),x},g.prototype.update=function(v,E){var x=this;p.prototype.update.call(this,v,E),v.some(function(b){return b.target===x.domNode&&b.type==="attributes"})&&this.attributes.build()},g.prototype.wrap=function(v,E){var x=p.prototype.wrap.call(this,v,E);return x instanceof g&&x.statics.scope===this.statics.scope&&this.attributes.move(x),x},g}(d.default);n.default=m},function(t,n,i){var s=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,p){m.__proto__=p}||function(m,p){for(var g in p)p.hasOwnProperty(g)&&(m[g]=p[g])};return function(m,p){f(m,p);function g(){this.constructor=m}m.prototype=p===null?Object.create(p):(g.prototype=p.prototype,new g)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(30),l=i(1),d=function(f){s(m,f);function m(){return f!==null&&f.apply(this,arguments)||this}return m.value=function(p){return!0},m.prototype.index=function(p,g){return this.domNode===p||this.domNode.compareDocumentPosition(p)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(g,1):-1},m.prototype.position=function(p,g){var v=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return p>0&&(v+=1),[this.parent.domNode,v]},m.prototype.value=function(){var p;return p={},p[this.statics.blotName]=this.statics.value(this.domNode)||!0,p},m.scope=l.Scope.INLINE_BLOT,m}(o.default);n.default=d},function(t,n,i){var s=i(11),o=i(3),l={attributes:{compose:function(f,m,p){typeof f!="object"&&(f={}),typeof m!="object"&&(m={});var g=o(!0,{},m);p||(g=Object.keys(g).reduce(function(E,x){return g[x]!=null&&(E[x]=g[x]),E},{}));for(var v in f)f[v]!==void 0&&m[v]===void 0&&(g[v]=f[v]);return Object.keys(g).length>0?g:void 0},diff:function(f,m){typeof f!="object"&&(f={}),typeof m!="object"&&(m={});var p=Object.keys(f).concat(Object.keys(m)).reduce(function(g,v){return s(f[v],m[v])||(g[v]=m[v]===void 0?null:m[v]),g},{});return Object.keys(p).length>0?p:void 0},transform:function(f,m,p){if(typeof f!="object")return m;if(typeof m=="object"){if(!p)return m;var g=Object.keys(m).reduce(function(v,E){return f[E]===void 0&&(v[E]=m[E]),v},{});return Object.keys(g).length>0?g:void 0}}},iterator:function(f){return new d(f)},length:function(f){return typeof f.delete=="number"?f.delete:typeof f.retain=="number"?f.retain:typeof f.insert=="string"?f.insert.length:1}};function d(f){this.ops=f,this.index=0,this.offset=0}d.prototype.hasNext=function(){return this.peekLength()<1/0},d.prototype.next=function(f){f||(f=1/0);var m=this.ops[this.index];if(m){var p=this.offset,g=l.length(m);if(f>=g-p?(f=g-p,this.index+=1,this.offset=0):this.offset+=f,typeof m.delete=="number")return{delete:f};var v={};return m.attributes&&(v.attributes=m.attributes),typeof m.retain=="number"?v.retain=f:typeof m.insert=="string"?v.insert=m.insert.substr(p,f):v.insert=m.insert,v}else return{retain:1/0}},d.prototype.peek=function(){return this.ops[this.index]},d.prototype.peekLength=function(){return this.ops[this.index]?l.length(this.ops[this.index])-this.offset:1/0},d.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},d.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var f=this.offset,m=this.index,p=this.next(),g=this.ops.slice(this.index);return this.offset=f,this.index=m,[p].concat(g)}else return[]},t.exports=l},function(t,n){var i=function(){function s(x,b){return b!=null&&x instanceof b}var o;try{o=Map}catch{o=function(){}}var l;try{l=Set}catch{l=function(){}}var d;try{d=Promise}catch{d=function(){}}function f(x,b,S,N,R){typeof b=="object"&&(S=b.depth,N=b.prototype,R=b.includeNonEnumerable,b=b.circular);var I=[],j=[],U=typeof Buffer<"u";typeof b>"u"&&(b=!0),typeof S>"u"&&(S=1/0);function P(k,F){if(k===null)return null;if(F===0)return k;var O,C;if(typeof k!="object")return k;if(s(k,o))O=new o;else if(s(k,l))O=new l;else if(s(k,d))O=new d(function(G,z){k.then(function(Z){G(P(Z,F-1))},function(Z){z(P(Z,F-1))})});else if(f.__isArray(k))O=[];else if(f.__isRegExp(k))O=new RegExp(k.source,E(k)),k.lastIndex&&(O.lastIndex=k.lastIndex);else if(f.__isDate(k))O=new Date(k.getTime());else{if(U&&Buffer.isBuffer(k))return Buffer.allocUnsafe?O=Buffer.allocUnsafe(k.length):O=new Buffer(k.length),k.copy(O),O;s(k,Error)?O=Object.create(k):typeof N>"u"?(C=Object.getPrototypeOf(k),O=Object.create(C)):(O=Object.create(N),C=N)}if(b){var M=I.indexOf(k);if(M!=-1)return j[M];I.push(k),j.push(O)}s(k,o)&&k.forEach(function(G,z){var Z=P(z,F-1),J=P(G,F-1);O.set(Z,J)}),s(k,l)&&k.forEach(function(G){var z=P(G,F-1);O.add(z)});for(var D in k){var $;C&&($=Object.getOwnPropertyDescriptor(C,D)),!($&&$.set==null)&&(O[D]=P(k[D],F-1))}if(Object.getOwnPropertySymbols)for(var K=Object.getOwnPropertySymbols(k),D=0;D<K.length;D++){var ee=K[D],se=Object.getOwnPropertyDescriptor(k,ee);se&&!se.enumerable&&!R||(O[ee]=P(k[ee],F-1),se.enumerable||Object.defineProperty(O,ee,{enumerable:!1}))}if(R)for(var ie=Object.getOwnPropertyNames(k),D=0;D<ie.length;D++){var re=ie[D],se=Object.getOwnPropertyDescriptor(k,re);se&&se.enumerable||(O[re]=P(k[re],F-1),Object.defineProperty(O,re,{enumerable:!1}))}return O}return P(x,S)}f.clonePrototype=function(b){if(b===null)return null;var S=function(){};return S.prototype=b,new S};function m(x){return Object.prototype.toString.call(x)}f.__objToStr=m;function p(x){return typeof x=="object"&&m(x)==="[object Date]"}f.__isDate=p;function g(x){return typeof x=="object"&&m(x)==="[object Array]"}f.__isArray=g;function v(x){return typeof x=="object"&&m(x)==="[object RegExp]"}f.__isRegExp=v;function E(x){var b="";return x.global&&(b+="g"),x.ignoreCase&&(b+="i"),x.multiline&&(b+="m"),b}return f.__getRegExpFlags=E,f}();typeof t=="object"&&t.exports&&(t.exports=i)},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function O(C,M){var D=[],$=!0,K=!1,ee=void 0;try{for(var se=C[Symbol.iterator](),ie;!($=(ie=se.next()).done)&&(D.push(ie.value),!(M&&D.length===M));$=!0);}catch(re){K=!0,ee=re}finally{try{!$&&se.return&&se.return()}finally{if(K)throw ee}}return D}return function(C,M){if(Array.isArray(C))return C;if(Symbol.iterator in Object(C))return O(C,M);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function O(C,M){for(var D=0;D<M.length;D++){var $=M[D];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(C,$.key,$)}}return function(C,M,D){return M&&O(C.prototype,M),D&&O(C,D),C}}(),l=function O(C,M,D){C===null&&(C=Function.prototype);var $=Object.getOwnPropertyDescriptor(C,M);if($===void 0){var K=Object.getPrototypeOf(C);return K===null?void 0:O(K,M,D)}else{if("value"in $)return $.value;var ee=$.get;return ee===void 0?void 0:ee.call(D)}},d=i(0),f=I(d),m=i(8),p=I(m),g=i(4),v=I(g),E=i(16),x=I(E),b=i(13),S=I(b),N=i(25),R=I(N);function I(O){return O&&O.__esModule?O:{default:O}}function j(O,C){if(!(O instanceof C))throw new TypeError("Cannot call a class as a function")}function U(O,C){if(!O)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C&&(typeof C=="object"||typeof C=="function")?C:O}function P(O,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof C);O.prototype=Object.create(C&&C.prototype,{constructor:{value:O,enumerable:!1,writable:!0,configurable:!0}}),C&&(Object.setPrototypeOf?Object.setPrototypeOf(O,C):O.__proto__=C)}function k(O){return O instanceof v.default||O instanceof g.BlockEmbed}var F=function(O){P(C,O);function C(M,D){j(this,C);var $=U(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,M));return $.emitter=D.emitter,Array.isArray(D.whitelist)&&($.whitelist=D.whitelist.reduce(function(K,ee){return K[ee]=!0,K},{})),$.domNode.addEventListener("DOMNodeInserted",function(){}),$.optimize(),$.enable(),$}return o(C,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(D,$){var K=this.line(D),ee=s(K,2),se=ee[0],ie=ee[1],re=this.line(D+$),G=s(re,1),z=G[0];if(l(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"deleteAt",this).call(this,D,$),z!=null&&se!==z&&ie>0){if(se instanceof g.BlockEmbed||z instanceof g.BlockEmbed){this.optimize();return}if(se instanceof S.default){var Z=se.newlineIndex(se.length(),!0);if(Z>-1&&(se=se.split(Z+1),se===z)){this.optimize();return}}else if(z instanceof S.default){var J=z.newlineIndex(0);J>-1&&z.split(J+1)}var ae=z.children.head instanceof x.default?null:z.children.head;se.moveChildren(z,ae),se.remove()}this.optimize()}},{key:"enable",value:function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",D)}},{key:"formatAt",value:function(D,$,K,ee){this.whitelist!=null&&!this.whitelist[K]||(l(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"formatAt",this).call(this,D,$,K,ee),this.optimize())}},{key:"insertAt",value:function(D,$,K){if(!(K!=null&&this.whitelist!=null&&!this.whitelist[$])){if(D>=this.length())if(K==null||f.default.query($,f.default.Scope.BLOCK)==null){var ee=f.default.create(this.statics.defaultChild);this.appendChild(ee),K==null&&$.endsWith(`
`)&&($=$.slice(0,-1)),ee.insertAt(0,$,K)}else{var se=f.default.create($,K);this.appendChild(se)}else l(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"insertAt",this).call(this,D,$,K);this.optimize()}}},{key:"insertBefore",value:function(D,$){if(D.statics.scope===f.default.Scope.INLINE_BLOT){var K=f.default.create(this.statics.defaultChild);K.appendChild(D),D=K}l(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"insertBefore",this).call(this,D,$)}},{key:"leaf",value:function(D){return this.path(D).pop()||[null,-1]}},{key:"line",value:function(D){return D===this.length()?this.line(D-1):this.descendant(k,D)}},{key:"lines",value:function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,K=function ee(se,ie,re){var G=[],z=re;return se.children.forEachAt(ie,re,function(Z,J,ae){k(Z)?G.push(Z):Z instanceof f.default.Container&&(G=G.concat(ee(Z,J,z))),z-=ae}),G};return K(this,D,$)}},{key:"optimize",value:function(){var D=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch!==!0&&(l(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"optimize",this).call(this,D,$),D.length>0&&this.emitter.emit(p.default.events.SCROLL_OPTIMIZE,D,$))}},{key:"path",value:function(D){return l(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"path",this).call(this,D).slice(1)}},{key:"update",value:function(D){if(this.batch!==!0){var $=p.default.sources.USER;typeof D=="string"&&($=D),Array.isArray(D)||(D=this.observer.takeRecords()),D.length>0&&this.emitter.emit(p.default.events.SCROLL_BEFORE_UPDATE,$,D),l(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"update",this).call(this,D.concat([])),D.length>0&&this.emitter.emit(p.default.events.SCROLL_UPDATE,$,D)}}}]),C}(f.default.Scroll);F.blotName="scroll",F.className="ql-editor",F.tagName="DIV",F.defaultChild="block",F.allowedChildren=[v.default,g.BlockEmbed,R.default],n.default=F},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SHORTKEY=n.default=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Q){return typeof Q}:function(Q){return Q&&typeof Symbol=="function"&&Q.constructor===Symbol&&Q!==Symbol.prototype?"symbol":typeof Q},o=function(){function Q(ce,ue){var fe=[],ve=!0,Me=!1,Pe=void 0;try{for(var qe=ce[Symbol.iterator](),Ge;!(ve=(Ge=qe.next()).done)&&(fe.push(Ge.value),!(ue&&fe.length===ue));ve=!0);}catch(lt){Me=!0,Pe=lt}finally{try{!ve&&qe.return&&qe.return()}finally{if(Me)throw Pe}}return fe}return function(ce,ue){if(Array.isArray(ce))return ce;if(Symbol.iterator in Object(ce))return Q(ce,ue);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function Q(ce,ue){for(var fe=0;fe<ue.length;fe++){var ve=ue[fe];ve.enumerable=ve.enumerable||!1,ve.configurable=!0,"value"in ve&&(ve.writable=!0),Object.defineProperty(ce,ve.key,ve)}}return function(ce,ue,fe){return ue&&Q(ce.prototype,ue),fe&&Q(ce,fe),ce}}(),d=i(21),f=O(d),m=i(11),p=O(m),g=i(3),v=O(g),E=i(2),x=O(E),b=i(20),S=O(b),N=i(0),R=O(N),I=i(5),j=O(I),U=i(10),P=O(U),k=i(9),F=O(k);function O(Q){return Q&&Q.__esModule?Q:{default:Q}}function C(Q,ce,ue){return ce in Q?Object.defineProperty(Q,ce,{value:ue,enumerable:!0,configurable:!0,writable:!0}):Q[ce]=ue,Q}function M(Q,ce){if(!(Q instanceof ce))throw new TypeError("Cannot call a class as a function")}function D(Q,ce){if(!Q)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ce&&(typeof ce=="object"||typeof ce=="function")?ce:Q}function $(Q,ce){if(typeof ce!="function"&&ce!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ce);Q.prototype=Object.create(ce&&ce.prototype,{constructor:{value:Q,enumerable:!1,writable:!0,configurable:!0}}),ce&&(Object.setPrototypeOf?Object.setPrototypeOf(Q,ce):Q.__proto__=ce)}var K=(0,P.default)("quill:keyboard"),ee=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",se=function(Q){$(ce,Q),l(ce,null,[{key:"match",value:function(fe,ve){return ve=le(ve),["altKey","ctrlKey","metaKey","shiftKey"].some(function(Me){return!!ve[Me]!==fe[Me]&&ve[Me]!==null})?!1:ve.key===(fe.which||fe.keyCode)}}]);function ce(ue,fe){M(this,ce);var ve=D(this,(ce.__proto__||Object.getPrototypeOf(ce)).call(this,ue,fe));return ve.bindings={},Object.keys(ve.options.bindings).forEach(function(Me){Me==="list autofill"&&ue.scroll.whitelist!=null&&!ue.scroll.whitelist.list||ve.options.bindings[Me]&&ve.addBinding(ve.options.bindings[Me])}),ve.addBinding({key:ce.keys.ENTER,shiftKey:null},Z),ve.addBinding({key:ce.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},function(){}),/Firefox/i.test(navigator.userAgent)?(ve.addBinding({key:ce.keys.BACKSPACE},{collapsed:!0},re),ve.addBinding({key:ce.keys.DELETE},{collapsed:!0},G)):(ve.addBinding({key:ce.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},re),ve.addBinding({key:ce.keys.DELETE},{collapsed:!0,suffix:/^.?$/},G)),ve.addBinding({key:ce.keys.BACKSPACE},{collapsed:!1},z),ve.addBinding({key:ce.keys.DELETE},{collapsed:!1},z),ve.addBinding({key:ce.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},re),ve.listen(),ve}return l(ce,[{key:"addBinding",value:function(fe){var ve=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Me=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Pe=le(fe);if(Pe==null||Pe.key==null)return K.warn("Attempted to add invalid keyboard binding",Pe);typeof ve=="function"&&(ve={handler:ve}),typeof Me=="function"&&(Me={handler:Me}),Pe=(0,v.default)(Pe,ve,Me),this.bindings[Pe.key]=this.bindings[Pe.key]||[],this.bindings[Pe.key].push(Pe)}},{key:"listen",value:function(){var fe=this;this.quill.root.addEventListener("keydown",function(ve){if(!ve.defaultPrevented){var Me=ve.which||ve.keyCode,Pe=(fe.bindings[Me]||[]).filter(function(Gt){return ce.match(ve,Gt)});if(Pe.length!==0){var qe=fe.quill.getSelection();if(!(qe==null||!fe.quill.hasFocus())){var Ge=fe.quill.getLine(qe.index),lt=o(Ge,2),Ct=lt[0],bt=lt[1],Te=fe.quill.getLeaf(qe.index),Ie=o(Te,2),Le=Ie[0],Be=Ie[1],ke=qe.length===0?[Le,Be]:fe.quill.getLeaf(qe.index+qe.length),_t=o(ke,2),gt=_t[0],yt=_t[1],kt=Le instanceof R.default.Text?Le.value().slice(0,Be):"",Ft=gt instanceof R.default.Text?gt.value().slice(yt):"",Vt={collapsed:qe.length===0,empty:qe.length===0&&Ct.length()<=1,format:fe.quill.getFormat(qe),offset:bt,prefix:kt,suffix:Ft},cs=Pe.some(function(Gt){if(Gt.collapsed!=null&&Gt.collapsed!==Vt.collapsed||Gt.empty!=null&&Gt.empty!==Vt.empty||Gt.offset!=null&&Gt.offset!==Vt.offset)return!1;if(Array.isArray(Gt.format)){if(Gt.format.every(function(Fn){return Vt.format[Fn]==null}))return!1}else if(s(Gt.format)==="object"&&!Object.keys(Gt.format).every(function(Fn){return Gt.format[Fn]===!0?Vt.format[Fn]!=null:Gt.format[Fn]===!1?Vt.format[Fn]==null:(0,p.default)(Gt.format[Fn],Vt.format[Fn])}))return!1;return Gt.prefix!=null&&!Gt.prefix.test(Vt.prefix)||Gt.suffix!=null&&!Gt.suffix.test(Vt.suffix)?!1:Gt.handler.call(fe,qe,Vt)!==!0});cs&&ve.preventDefault()}}}})}}]),ce}(F.default);se.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},se.DEFAULTS={bindings:{bold:ae("bold"),italic:ae("italic"),underline:ae("underline"),indent:{key:se.keys.TAB,format:["blockquote","indent","list"],handler:function(ce,ue){if(ue.collapsed&&ue.offset!==0)return!0;this.quill.format("indent","+1",j.default.sources.USER)}},outdent:{key:se.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(ce,ue){if(ue.collapsed&&ue.offset!==0)return!0;this.quill.format("indent","-1",j.default.sources.USER)}},"outdent backspace":{key:se.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(ce,ue){ue.format.indent!=null?this.quill.format("indent","-1",j.default.sources.USER):ue.format.list!=null&&this.quill.format("list",!1,j.default.sources.USER)}},"indent code-block":J(!0),"outdent code-block":J(!1),"remove tab":{key:se.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(ce){this.quill.deleteText(ce.index-1,1,j.default.sources.USER)}},tab:{key:se.keys.TAB,handler:function(ce){this.quill.history.cutoff();var ue=new x.default().retain(ce.index).delete(ce.length).insert("	");this.quill.updateContents(ue,j.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(ce.index+1,j.default.sources.SILENT)}},"list empty enter":{key:se.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(ce,ue){this.quill.format("list",!1,j.default.sources.USER),ue.format.indent&&this.quill.format("indent",!1,j.default.sources.USER)}},"checklist enter":{key:se.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(ce){var ue=this.quill.getLine(ce.index),fe=o(ue,2),ve=fe[0],Me=fe[1],Pe=(0,v.default)({},ve.formats(),{list:"checked"}),qe=new x.default().retain(ce.index).insert(`
`,Pe).retain(ve.length()-Me-1).retain(1,{list:"unchecked"});this.quill.updateContents(qe,j.default.sources.USER),this.quill.setSelection(ce.index+1,j.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:se.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(ce,ue){var fe=this.quill.getLine(ce.index),ve=o(fe,2),Me=ve[0],Pe=ve[1],qe=new x.default().retain(ce.index).insert(`
`,ue.format).retain(Me.length()-Pe-1).retain(1,{header:null});this.quill.updateContents(qe,j.default.sources.USER),this.quill.setSelection(ce.index+1,j.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(ce,ue){var fe=ue.prefix.length,ve=this.quill.getLine(ce.index),Me=o(ve,2),Pe=Me[0],qe=Me[1];if(qe>fe)return!0;var Ge=void 0;switch(ue.prefix.trim()){case"[]":case"[ ]":Ge="unchecked";break;case"[x]":Ge="checked";break;case"-":case"*":Ge="bullet";break;default:Ge="ordered"}this.quill.insertText(ce.index," ",j.default.sources.USER),this.quill.history.cutoff();var lt=new x.default().retain(ce.index-qe).delete(fe+1).retain(Pe.length()-2-qe).retain(1,{list:Ge});this.quill.updateContents(lt,j.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(ce.index-fe,j.default.sources.SILENT)}},"code exit":{key:se.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(ce){var ue=this.quill.getLine(ce.index),fe=o(ue,2),ve=fe[0],Me=fe[1],Pe=new x.default().retain(ce.index+ve.length()-Me-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(Pe,j.default.sources.USER)}},"embed left":ie(se.keys.LEFT,!1),"embed left shift":ie(se.keys.LEFT,!0),"embed right":ie(se.keys.RIGHT,!1),"embed right shift":ie(se.keys.RIGHT,!0)}};function ie(Q,ce){var ue,fe=Q===se.keys.LEFT?"prefix":"suffix";return ue={key:Q,shiftKey:ce,altKey:null},C(ue,fe,/^$/),C(ue,"handler",function(Me){var Pe=Me.index;Q===se.keys.RIGHT&&(Pe+=Me.length+1);var qe=this.quill.getLeaf(Pe),Ge=o(qe,1),lt=Ge[0];return lt instanceof R.default.Embed?(Q===se.keys.LEFT?ce?this.quill.setSelection(Me.index-1,Me.length+1,j.default.sources.USER):this.quill.setSelection(Me.index-1,j.default.sources.USER):ce?this.quill.setSelection(Me.index,Me.length+1,j.default.sources.USER):this.quill.setSelection(Me.index+Me.length+1,j.default.sources.USER),!1):!0}),ue}function re(Q,ce){if(!(Q.index===0||this.quill.getLength()<=1)){var ue=this.quill.getLine(Q.index),fe=o(ue,1),ve=fe[0],Me={};if(ce.offset===0){var Pe=this.quill.getLine(Q.index-1),qe=o(Pe,1),Ge=qe[0];if(Ge!=null&&Ge.length()>1){var lt=ve.formats(),Ct=this.quill.getFormat(Q.index-1,1);Me=S.default.attributes.diff(lt,Ct)||{}}}var bt=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(ce.prefix)?2:1;this.quill.deleteText(Q.index-bt,bt,j.default.sources.USER),Object.keys(Me).length>0&&this.quill.formatLine(Q.index-bt,bt,Me,j.default.sources.USER),this.quill.focus()}}function G(Q,ce){var ue=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(ce.suffix)?2:1;if(!(Q.index>=this.quill.getLength()-ue)){var fe={},ve=0,Me=this.quill.getLine(Q.index),Pe=o(Me,1),qe=Pe[0];if(ce.offset>=qe.length()-1){var Ge=this.quill.getLine(Q.index+1),lt=o(Ge,1),Ct=lt[0];if(Ct){var bt=qe.formats(),Te=this.quill.getFormat(Q.index,1);fe=S.default.attributes.diff(bt,Te)||{},ve=Ct.length()}}this.quill.deleteText(Q.index,ue,j.default.sources.USER),Object.keys(fe).length>0&&this.quill.formatLine(Q.index+ve-1,ue,fe,j.default.sources.USER)}}function z(Q){var ce=this.quill.getLines(Q),ue={};if(ce.length>1){var fe=ce[0].formats(),ve=ce[ce.length-1].formats();ue=S.default.attributes.diff(ve,fe)||{}}this.quill.deleteText(Q,j.default.sources.USER),Object.keys(ue).length>0&&this.quill.formatLine(Q.index,1,ue,j.default.sources.USER),this.quill.setSelection(Q.index,j.default.sources.SILENT),this.quill.focus()}function Z(Q,ce){var ue=this;Q.length>0&&this.quill.scroll.deleteAt(Q.index,Q.length);var fe=Object.keys(ce.format).reduce(function(ve,Me){return R.default.query(Me,R.default.Scope.BLOCK)&&!Array.isArray(ce.format[Me])&&(ve[Me]=ce.format[Me]),ve},{});this.quill.insertText(Q.index,`
`,fe,j.default.sources.USER),this.quill.setSelection(Q.index+1,j.default.sources.SILENT),this.quill.focus(),Object.keys(ce.format).forEach(function(ve){fe[ve]==null&&(Array.isArray(ce.format[ve])||ve!=="link"&&ue.quill.format(ve,ce.format[ve],j.default.sources.USER))})}function J(Q){return{key:se.keys.TAB,shiftKey:!Q,format:{"code-block":!0},handler:function(ue){var fe=R.default.query("code-block"),ve=ue.index,Me=ue.length,Pe=this.quill.scroll.descendant(fe,ve),qe=o(Pe,2),Ge=qe[0],lt=qe[1];if(Ge!=null){var Ct=this.quill.getIndex(Ge),bt=Ge.newlineIndex(lt,!0)+1,Te=Ge.newlineIndex(Ct+lt+Me),Ie=Ge.domNode.textContent.slice(bt,Te).split(`
`);lt=0,Ie.forEach(function(Le,Be){Q?(Ge.insertAt(bt+lt,fe.TAB),lt+=fe.TAB.length,Be===0?ve+=fe.TAB.length:Me+=fe.TAB.length):Le.startsWith(fe.TAB)&&(Ge.deleteAt(bt+lt,fe.TAB.length),lt-=fe.TAB.length,Be===0?ve-=fe.TAB.length:Me-=fe.TAB.length),lt+=Le.length+1}),this.quill.update(j.default.sources.USER),this.quill.setSelection(ve,Me,j.default.sources.SILENT)}}}}function ae(Q){return{key:Q[0].toUpperCase(),shortKey:!0,handler:function(ue,fe){this.quill.format(Q,!fe.format[Q],j.default.sources.USER)}}}function le(Q){if(typeof Q=="string"||typeof Q=="number")return le({key:Q});if((typeof Q>"u"?"undefined":s(Q))==="object"&&(Q=(0,f.default)(Q,!1)),typeof Q.key=="string")if(se.keys[Q.key.toUpperCase()]!=null)Q.key=se.keys[Q.key.toUpperCase()];else if(Q.key.length===1)Q.key=Q.key.toUpperCase().charCodeAt(0);else return null;return Q.shortKey&&(Q[ee]=Q.shortKey,delete Q.shortKey),Q}n.default=se,n.SHORTKEY=ee},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function S(N,R){var I=[],j=!0,U=!1,P=void 0;try{for(var k=N[Symbol.iterator](),F;!(j=(F=k.next()).done)&&(I.push(F.value),!(R&&I.length===R));j=!0);}catch(O){U=!0,P=O}finally{try{!j&&k.return&&k.return()}finally{if(U)throw P}}return I}return function(N,R){if(Array.isArray(N))return N;if(Symbol.iterator in Object(N))return S(N,R);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function S(N,R,I){N===null&&(N=Function.prototype);var j=Object.getOwnPropertyDescriptor(N,R);if(j===void 0){var U=Object.getPrototypeOf(N);return U===null?void 0:S(U,R,I)}else{if("value"in j)return j.value;var P=j.get;return P===void 0?void 0:P.call(I)}},l=function(){function S(N,R){for(var I=0;I<R.length;I++){var j=R[I];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(N,j.key,j)}}return function(N,R,I){return R&&S(N.prototype,R),I&&S(N,I),N}}(),d=i(0),f=g(d),m=i(7),p=g(m);function g(S){return S&&S.__esModule?S:{default:S}}function v(S,N){if(!(S instanceof N))throw new TypeError("Cannot call a class as a function")}function E(S,N){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:S}function x(S,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);S.prototype=Object.create(N&&N.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(S,N):S.__proto__=N)}var b=function(S){x(N,S),l(N,null,[{key:"value",value:function(){}}]);function N(R,I){v(this,N);var j=E(this,(N.__proto__||Object.getPrototypeOf(N)).call(this,R));return j.selection=I,j.textNode=document.createTextNode(N.CONTENTS),j.domNode.appendChild(j.textNode),j._length=0,j}return l(N,[{key:"detach",value:function(){this.parent!=null&&this.parent.removeChild(this)}},{key:"format",value:function(I,j){if(this._length!==0)return o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"format",this).call(this,I,j);for(var U=this,P=0;U!=null&&U.statics.scope!==f.default.Scope.BLOCK_BLOT;)P+=U.offset(U.parent),U=U.parent;U!=null&&(this._length=N.CONTENTS.length,U.optimize(),U.formatAt(P,N.CONTENTS.length,I,j),this._length=0)}},{key:"index",value:function(I,j){return I===this.textNode?0:o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"index",this).call(this,I,j)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!(this.selection.composing||this.parent==null)){var I=this.textNode,j=this.selection.getNativeRange(),U=void 0,P=void 0,k=void 0;if(j!=null&&j.start.node===I&&j.end.node===I){var F=[I,j.start.offset,j.end.offset];U=F[0],P=F[1],k=F[2]}for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==N.CONTENTS){var O=this.textNode.data.split(N.CONTENTS).join("");this.next instanceof p.default?(U=this.next.domNode,this.next.insertAt(0,O),this.textNode.data=N.CONTENTS):(this.textNode.data=O,this.parent.insertBefore(f.default.create(this.textNode),this),this.textNode=document.createTextNode(N.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),P!=null){var C=[P,k].map(function(D){return Math.max(0,Math.min(U.data.length,D-1))}),M=s(C,2);return P=M[0],k=M[1],{startNode:U,startOffset:P,endNode:U,endOffset:k}}}}},{key:"update",value:function(I,j){var U=this;if(I.some(function(k){return k.type==="characterData"&&k.target===U.textNode})){var P=this.restore();P&&(j.range=P)}}},{key:"value",value:function(){return""}}]),N}(f.default.Embed);b.blotName="cursor",b.className="ql-cursor",b.tagName="span",b.CONTENTS="\uFEFF",n.default=b},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(0),o=f(s),l=i(4),d=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function p(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var v=function(E){g(x,E);function x(){return m(this,x),p(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return x}(o.default.Container);v.allowedChildren=[d.default,l.BlockEmbed,v],n.default=v},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ColorStyle=n.ColorClass=n.ColorAttributor=void 0;var s=function(){function b(S,N){for(var R=0;R<N.length;R++){var I=N[R];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(S,I.key,I)}}return function(S,N,R){return N&&b(S.prototype,N),R&&b(S,R),S}}(),o=function b(S,N,R){S===null&&(S=Function.prototype);var I=Object.getOwnPropertyDescriptor(S,N);if(I===void 0){var j=Object.getPrototypeOf(S);return j===null?void 0:b(j,N,R)}else{if("value"in I)return I.value;var U=I.get;return U===void 0?void 0:U.call(R)}},l=i(0),d=f(l);function f(b){return b&&b.__esModule?b:{default:b}}function m(b,S){if(!(b instanceof S))throw new TypeError("Cannot call a class as a function")}function p(b,S){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:b}function g(b,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);b.prototype=Object.create(S&&S.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(b,S):b.__proto__=S)}var v=function(b){g(S,b);function S(){return m(this,S),p(this,(S.__proto__||Object.getPrototypeOf(S)).apply(this,arguments))}return s(S,[{key:"value",value:function(R){var I=o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"value",this).call(this,R);return I.startsWith("rgb(")?(I=I.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+I.split(",").map(function(j){return("00"+parseInt(j).toString(16)).slice(-2)}).join("")):I}}]),S}(d.default.Attributor.Style),E=new d.default.Attributor.Class("color","ql-color",{scope:d.default.Scope.INLINE}),x=new v("color","color",{scope:d.default.Scope.INLINE});n.ColorAttributor=v,n.ColorClass=E,n.ColorStyle=x},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.sanitize=n.default=void 0;var s=function(){function x(b,S){for(var N=0;N<S.length;N++){var R=S[N];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(b,R.key,R)}}return function(b,S,N){return S&&x(b.prototype,S),N&&x(b,N),b}}(),o=function x(b,S,N){b===null&&(b=Function.prototype);var R=Object.getOwnPropertyDescriptor(b,S);if(R===void 0){var I=Object.getPrototypeOf(b);return I===null?void 0:x(I,S,N)}else{if("value"in R)return R.value;var j=R.get;return j===void 0?void 0:j.call(N)}},l=i(6),d=f(l);function f(x){return x&&x.__esModule?x:{default:x}}function m(x,b){if(!(x instanceof b))throw new TypeError("Cannot call a class as a function")}function p(x,b){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:x}function g(x,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);x.prototype=Object.create(b&&b.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(x,b):x.__proto__=b)}var v=function(x){g(b,x);function b(){return m(this,b),p(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return s(b,[{key:"format",value:function(N,R){if(N!==this.statics.blotName||!R)return o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"format",this).call(this,N,R);R=this.constructor.sanitize(R),this.domNode.setAttribute("href",R)}}],[{key:"create",value:function(N){var R=o(b.__proto__||Object.getPrototypeOf(b),"create",this).call(this,N);return N=this.sanitize(N),R.setAttribute("href",N),R.setAttribute("rel","noopener noreferrer"),R.setAttribute("target","_blank"),R}},{key:"formats",value:function(N){return N.getAttribute("href")}},{key:"sanitize",value:function(N){return E(N,this.PROTOCOL_WHITELIST)?N:this.SANITIZED_URL}}]),b}(d.default);v.blotName="link",v.tagName="A",v.SANITIZED_URL="about:blank",v.PROTOCOL_WHITELIST=["http","https","mailto","tel"];function E(x,b){var S=document.createElement("a");S.href=x;var N=S.href.slice(0,S.href.indexOf(":"));return b.indexOf(N)>-1}n.default=v,n.sanitize=E},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},o=function(){function b(S,N){for(var R=0;R<N.length;R++){var I=N[R];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(S,I.key,I)}}return function(S,N,R){return N&&b(S.prototype,N),R&&b(S,R),S}}(),l=i(23),d=p(l),f=i(107),m=p(f);function p(b){return b&&b.__esModule?b:{default:b}}function g(b,S){if(!(b instanceof S))throw new TypeError("Cannot call a class as a function")}var v=0;function E(b,S){b.setAttribute(S,b.getAttribute(S)!=="true")}var x=function(){function b(S){var N=this;g(this,b),this.select=S,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",function(){N.togglePicker()}),this.label.addEventListener("keydown",function(R){switch(R.keyCode){case d.default.keys.ENTER:N.togglePicker();break;case d.default.keys.ESCAPE:N.escape(),R.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}return o(b,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),E(this.label,"aria-expanded"),E(this.options,"aria-hidden")}},{key:"buildItem",value:function(N){var R=this,I=document.createElement("span");return I.tabIndex="0",I.setAttribute("role","button"),I.classList.add("ql-picker-item"),N.hasAttribute("value")&&I.setAttribute("data-value",N.getAttribute("value")),N.textContent&&I.setAttribute("data-label",N.textContent),I.addEventListener("click",function(){R.selectItem(I,!0)}),I.addEventListener("keydown",function(j){switch(j.keyCode){case d.default.keys.ENTER:R.selectItem(I,!0),j.preventDefault();break;case d.default.keys.ESCAPE:R.escape(),j.preventDefault();break}}),I}},{key:"buildLabel",value:function(){var N=document.createElement("span");return N.classList.add("ql-picker-label"),N.innerHTML=m.default,N.tabIndex="0",N.setAttribute("role","button"),N.setAttribute("aria-expanded","false"),this.container.appendChild(N),N}},{key:"buildOptions",value:function(){var N=this,R=document.createElement("span");R.classList.add("ql-picker-options"),R.setAttribute("aria-hidden","true"),R.tabIndex="-1",R.id="ql-picker-options-"+v,v+=1,this.label.setAttribute("aria-controls",R.id),this.options=R,[].slice.call(this.select.options).forEach(function(I){var j=N.buildItem(I);R.appendChild(j),I.selected===!0&&N.selectItem(j)}),this.container.appendChild(R)}},{key:"buildPicker",value:function(){var N=this;[].slice.call(this.select.attributes).forEach(function(R){N.container.setAttribute(R.name,R.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var N=this;this.close(),setTimeout(function(){return N.label.focus()},1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(N){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,I=this.container.querySelector(".ql-selected");if(N!==I&&(I!=null&&I.classList.remove("ql-selected"),N!=null&&(N.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(N.parentNode.children,N),N.hasAttribute("data-value")?this.label.setAttribute("data-value",N.getAttribute("data-value")):this.label.removeAttribute("data-value"),N.hasAttribute("data-label")?this.label.setAttribute("data-label",N.getAttribute("data-label")):this.label.removeAttribute("data-label"),R))){if(typeof Event=="function")this.select.dispatchEvent(new Event("change"));else if((typeof Event>"u"?"undefined":s(Event))==="object"){var j=document.createEvent("Event");j.initEvent("change",!0,!0),this.select.dispatchEvent(j)}this.close()}}},{key:"update",value:function(){var N=void 0;if(this.select.selectedIndex>-1){var R=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];N=this.select.options[this.select.selectedIndex],this.selectItem(R)}else this.selectItem(null);var I=N!=null&&N!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",I)}}]),b}();n.default=x},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(0),o=K(s),l=i(5),d=K(l),f=i(4),m=K(f),p=i(16),g=K(p),v=i(25),E=K(v),x=i(24),b=K(x),S=i(35),N=K(S),R=i(6),I=K(R),j=i(22),U=K(j),P=i(7),k=K(P),F=i(55),O=K(F),C=i(42),M=K(C),D=i(23),$=K(D);function K(ee){return ee&&ee.__esModule?ee:{default:ee}}d.default.register({"blots/block":m.default,"blots/block/embed":f.BlockEmbed,"blots/break":g.default,"blots/container":E.default,"blots/cursor":b.default,"blots/embed":N.default,"blots/inline":I.default,"blots/scroll":U.default,"blots/text":k.default,"modules/clipboard":O.default,"modules/history":M.default,"modules/keyboard":$.default}),o.default.register(m.default,g.default,b.default,I.default,U.default,k.default),n.default=d.default},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(1),o=function(){function l(d){this.domNode=d,this.domNode[s.DATA_KEY]={blot:this}}return Object.defineProperty(l.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),l.create=function(d){if(this.tagName==null)throw new s.ParchmentError("Blot definition missing tagName");var f;return Array.isArray(this.tagName)?(typeof d=="string"&&(d=d.toUpperCase(),parseInt(d).toString()===d&&(d=parseInt(d))),typeof d=="number"?f=document.createElement(this.tagName[d-1]):this.tagName.indexOf(d)>-1?f=document.createElement(d):f=document.createElement(this.tagName[0])):f=document.createElement(this.tagName),this.className&&f.classList.add(this.className),f},l.prototype.attach=function(){this.parent!=null&&(this.scroll=this.parent.scroll)},l.prototype.clone=function(){var d=this.domNode.cloneNode(!1);return s.create(d)},l.prototype.detach=function(){this.parent!=null&&this.parent.removeChild(this),delete this.domNode[s.DATA_KEY]},l.prototype.deleteAt=function(d,f){var m=this.isolate(d,f);m.remove()},l.prototype.formatAt=function(d,f,m,p){var g=this.isolate(d,f);if(s.query(m,s.Scope.BLOT)!=null&&p)g.wrap(m,p);else if(s.query(m,s.Scope.ATTRIBUTE)!=null){var v=s.create(this.statics.scope);g.wrap(v),v.format(m,p)}},l.prototype.insertAt=function(d,f,m){var p=m==null?s.create("text",f):s.create(f,m),g=this.split(d);this.parent.insertBefore(p,g)},l.prototype.insertInto=function(d,f){f===void 0&&(f=null),this.parent!=null&&this.parent.children.remove(this);var m=null;d.children.insertBefore(this,f),f!=null&&(m=f.domNode),(this.domNode.parentNode!=d.domNode||this.domNode.nextSibling!=m)&&d.domNode.insertBefore(this.domNode,m),this.parent=d,this.attach()},l.prototype.isolate=function(d,f){var m=this.split(d);return m.split(f),m},l.prototype.length=function(){return 1},l.prototype.offset=function(d){return d===void 0&&(d=this.parent),this.parent==null||this==d?0:this.parent.children.offset(this)+this.parent.offset(d)},l.prototype.optimize=function(d){this.domNode[s.DATA_KEY]!=null&&delete this.domNode[s.DATA_KEY].mutations},l.prototype.remove=function(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},l.prototype.replace=function(d){d.parent!=null&&(d.parent.insertBefore(this,d.next),d.remove())},l.prototype.replaceWith=function(d,f){var m=typeof d=="string"?s.create(d,f):d;return m.replace(this),m},l.prototype.split=function(d,f){return d===0?this:this.next},l.prototype.update=function(d,f){},l.prototype.wrap=function(d,f){var m=typeof d=="string"?s.create(d,f):d;return this.parent!=null&&this.parent.insertBefore(m,this.next),m.appendChild(this),m},l.blotName="abstract",l}();n.default=o},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(12),o=i(32),l=i(33),d=i(1),f=function(){function m(p){this.attributes={},this.domNode=p,this.build()}return m.prototype.attribute=function(p,g){g?p.add(this.domNode,g)&&(p.value(this.domNode)!=null?this.attributes[p.attrName]=p:delete this.attributes[p.attrName]):(p.remove(this.domNode),delete this.attributes[p.attrName])},m.prototype.build=function(){var p=this;this.attributes={};var g=s.default.keys(this.domNode),v=o.default.keys(this.domNode),E=l.default.keys(this.domNode);g.concat(v).concat(E).forEach(function(x){var b=d.query(x,d.Scope.ATTRIBUTE);b instanceof s.default&&(p.attributes[b.attrName]=b)})},m.prototype.copy=function(p){var g=this;Object.keys(this.attributes).forEach(function(v){var E=g.attributes[v].value(g.domNode);p.format(v,E)})},m.prototype.move=function(p){var g=this;this.copy(p),Object.keys(this.attributes).forEach(function(v){g.attributes[v].remove(g.domNode)}),this.attributes={}},m.prototype.values=function(){var p=this;return Object.keys(this.attributes).reduce(function(g,v){return g[v]=p.attributes[v].value(p.domNode),g},{})},m}();n.default=f},function(t,n,i){var s=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,p){m.__proto__=p}||function(m,p){for(var g in p)p.hasOwnProperty(g)&&(m[g]=p[g])};return function(m,p){f(m,p);function g(){this.constructor=m}m.prototype=p===null?Object.create(p):(g.prototype=p.prototype,new g)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12);function l(f,m){var p=f.getAttribute("class")||"";return p.split(/\s+/).filter(function(g){return g.indexOf(m+"-")===0})}var d=function(f){s(m,f);function m(){return f!==null&&f.apply(this,arguments)||this}return m.keys=function(p){return(p.getAttribute("class")||"").split(/\s+/).map(function(g){return g.split("-").slice(0,-1).join("-")})},m.prototype.add=function(p,g){return this.canAdd(p,g)?(this.remove(p),p.classList.add(this.keyName+"-"+g),!0):!1},m.prototype.remove=function(p){var g=l(p,this.keyName);g.forEach(function(v){p.classList.remove(v)}),p.classList.length===0&&p.removeAttribute("class")},m.prototype.value=function(p){var g=l(p,this.keyName)[0]||"",v=g.slice(this.keyName.length+1);return this.canAdd(p,v)?v:""},m}(o.default);n.default=d},function(t,n,i){var s=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,p){m.__proto__=p}||function(m,p){for(var g in p)p.hasOwnProperty(g)&&(m[g]=p[g])};return function(m,p){f(m,p);function g(){this.constructor=m}m.prototype=p===null?Object.create(p):(g.prototype=p.prototype,new g)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12);function l(f){var m=f.split("-"),p=m.slice(1).map(function(g){return g[0].toUpperCase()+g.slice(1)}).join("");return m[0]+p}var d=function(f){s(m,f);function m(){return f!==null&&f.apply(this,arguments)||this}return m.keys=function(p){return(p.getAttribute("style")||"").split(";").map(function(g){var v=g.split(":");return v[0].trim()})},m.prototype.add=function(p,g){return this.canAdd(p,g)?(p.style[l(this.keyName)]=g,!0):!1},m.prototype.remove=function(p){p.style[l(this.keyName)]="",p.getAttribute("style")||p.removeAttribute("style")},m.prototype.value=function(p){var g=p.style[l(this.keyName)];return this.canAdd(p,g)?g:""},m}(o.default);n.default=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function d(f,m){for(var p=0;p<m.length;p++){var g=m[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(f,m,p){return m&&d(f.prototype,m),p&&d(f,p),f}}();function o(d,f){if(!(d instanceof f))throw new TypeError("Cannot call a class as a function")}var l=function(){function d(f,m){o(this,d),this.quill=f,this.options=m,this.modules={}}return s(d,[{key:"init",value:function(){var m=this;Object.keys(this.options.modules).forEach(function(p){m.modules[p]==null&&m.addModule(p)})}},{key:"addModule",value:function(m){var p=this.quill.constructor.import("modules/"+m);return this.modules[m]=new p(this.quill,this.options.modules[m]||{}),this.modules[m]}}]),d}();l.DEFAULTS={modules:{}},l.themes={default:l},n.default=l},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function S(N,R){for(var I=0;I<R.length;I++){var j=R[I];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(N,j.key,j)}}return function(N,R,I){return R&&S(N.prototype,R),I&&S(N,I),N}}(),o=function S(N,R,I){N===null&&(N=Function.prototype);var j=Object.getOwnPropertyDescriptor(N,R);if(j===void 0){var U=Object.getPrototypeOf(N);return U===null?void 0:S(U,R,I)}else{if("value"in j)return j.value;var P=j.get;return P===void 0?void 0:P.call(I)}},l=i(0),d=p(l),f=i(7),m=p(f);function p(S){return S&&S.__esModule?S:{default:S}}function g(S,N){if(!(S instanceof N))throw new TypeError("Cannot call a class as a function")}function v(S,N){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:S}function E(S,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);S.prototype=Object.create(N&&N.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(S,N):S.__proto__=N)}var x="\uFEFF",b=function(S){E(N,S);function N(R){g(this,N);var I=v(this,(N.__proto__||Object.getPrototypeOf(N)).call(this,R));return I.contentNode=document.createElement("span"),I.contentNode.setAttribute("contenteditable",!1),[].slice.call(I.domNode.childNodes).forEach(function(j){I.contentNode.appendChild(j)}),I.leftGuard=document.createTextNode(x),I.rightGuard=document.createTextNode(x),I.domNode.appendChild(I.leftGuard),I.domNode.appendChild(I.contentNode),I.domNode.appendChild(I.rightGuard),I}return s(N,[{key:"index",value:function(I,j){return I===this.leftGuard?0:I===this.rightGuard?1:o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"index",this).call(this,I,j)}},{key:"restore",value:function(I){var j=void 0,U=void 0,P=I.data.split(x).join("");if(I===this.leftGuard)if(this.prev instanceof m.default){var k=this.prev.length();this.prev.insertAt(k,P),j={startNode:this.prev.domNode,startOffset:k+P.length}}else U=document.createTextNode(P),this.parent.insertBefore(d.default.create(U),this),j={startNode:U,startOffset:P.length};else I===this.rightGuard&&(this.next instanceof m.default?(this.next.insertAt(0,P),j={startNode:this.next.domNode,startOffset:P.length}):(U=document.createTextNode(P),this.parent.insertBefore(d.default.create(U),this.next),j={startNode:U,startOffset:P.length}));return I.data=x,j}},{key:"update",value:function(I,j){var U=this;I.forEach(function(P){if(P.type==="characterData"&&(P.target===U.leftGuard||P.target===U.rightGuard)){var k=U.restore(P.target);k&&(j.range=k)}})}}]),N}(d.default.Embed);n.default=b},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.AlignStyle=n.AlignClass=n.AlignAttribute=void 0;var s=i(0),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}var d={scope:o.default.Scope.BLOCK,whitelist:["right","center","justify"]},f=new o.default.Attributor.Attribute("align","align",d),m=new o.default.Attributor.Class("align","ql-align",d),p=new o.default.Attributor.Style("align","text-align",d);n.AlignAttribute=f,n.AlignClass=m,n.AlignStyle=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.BackgroundStyle=n.BackgroundClass=void 0;var s=i(0),o=d(s),l=i(26);function d(p){return p&&p.__esModule?p:{default:p}}var f=new o.default.Attributor.Class("background","ql-bg",{scope:o.default.Scope.INLINE}),m=new l.ColorAttributor("background","background-color",{scope:o.default.Scope.INLINE});n.BackgroundClass=f,n.BackgroundStyle=m},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.DirectionStyle=n.DirectionClass=n.DirectionAttribute=void 0;var s=i(0),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}var d={scope:o.default.Scope.BLOCK,whitelist:["rtl"]},f=new o.default.Attributor.Attribute("direction","dir",d),m=new o.default.Attributor.Class("direction","ql-direction",d),p=new o.default.Attributor.Style("direction","direction",d);n.DirectionAttribute=f,n.DirectionClass=m,n.DirectionStyle=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.FontClass=n.FontStyle=void 0;var s=function(){function S(N,R){for(var I=0;I<R.length;I++){var j=R[I];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(N,j.key,j)}}return function(N,R,I){return R&&S(N.prototype,R),I&&S(N,I),N}}(),o=function S(N,R,I){N===null&&(N=Function.prototype);var j=Object.getOwnPropertyDescriptor(N,R);if(j===void 0){var U=Object.getPrototypeOf(N);return U===null?void 0:S(U,R,I)}else{if("value"in j)return j.value;var P=j.get;return P===void 0?void 0:P.call(I)}},l=i(0),d=f(l);function f(S){return S&&S.__esModule?S:{default:S}}function m(S,N){if(!(S instanceof N))throw new TypeError("Cannot call a class as a function")}function p(S,N){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:S}function g(S,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);S.prototype=Object.create(N&&N.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(S,N):S.__proto__=N)}var v={scope:d.default.Scope.INLINE,whitelist:["serif","monospace"]},E=new d.default.Attributor.Class("font","ql-font",v),x=function(S){g(N,S);function N(){return m(this,N),p(this,(N.__proto__||Object.getPrototypeOf(N)).apply(this,arguments))}return s(N,[{key:"value",value:function(I){return o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"value",this).call(this,I).replace(/["']/g,"")}}]),N}(d.default.Attributor.Style),b=new x("font","font-family",v);n.FontStyle=b,n.FontClass=E},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SizeStyle=n.SizeClass=void 0;var s=i(0),o=l(s);function l(m){return m&&m.__esModule?m:{default:m}}var d=new o.default.Attributor.Class("size","ql-size",{scope:o.default.Scope.INLINE,whitelist:["small","large","huge"]}),f=new o.default.Attributor.Style("size","font-size",{scope:o.default.Scope.INLINE,whitelist:["10px","18px","32px"]});n.SizeClass=d,n.SizeStyle=f},function(t,n,i){t.exports={align:{"":i(76),center:i(77),right:i(78),justify:i(79)},background:i(80),blockquote:i(81),bold:i(82),clean:i(83),code:i(58),"code-block":i(58),color:i(84),direction:{"":i(85),rtl:i(86)},float:{center:i(87),full:i(88),left:i(89),right:i(90)},formula:i(91),header:{1:i(92),2:i(93)},italic:i(94),image:i(95),indent:{"+1":i(96),"-1":i(97)},link:i(98),list:{ordered:i(99),bullet:i(100),check:i(101)},script:{sub:i(102),super:i(103)},strike:i(104),underline:i(105),video:i(106)}},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.getLastChangeIndex=n.default=void 0;var s=function(){function R(I,j){for(var U=0;U<j.length;U++){var P=j[U];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(I,P.key,P)}}return function(I,j,U){return j&&R(I.prototype,j),U&&R(I,U),I}}(),o=i(0),l=g(o),d=i(5),f=g(d),m=i(9),p=g(m);function g(R){return R&&R.__esModule?R:{default:R}}function v(R,I){if(!(R instanceof I))throw new TypeError("Cannot call a class as a function")}function E(R,I){if(!R)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I&&(typeof I=="object"||typeof I=="function")?I:R}function x(R,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof I);R.prototype=Object.create(I&&I.prototype,{constructor:{value:R,enumerable:!1,writable:!0,configurable:!0}}),I&&(Object.setPrototypeOf?Object.setPrototypeOf(R,I):R.__proto__=I)}var b=function(R){x(I,R);function I(j,U){v(this,I);var P=E(this,(I.__proto__||Object.getPrototypeOf(I)).call(this,j,U));return P.lastRecorded=0,P.ignoreChange=!1,P.clear(),P.quill.on(f.default.events.EDITOR_CHANGE,function(k,F,O,C){k!==f.default.events.TEXT_CHANGE||P.ignoreChange||(!P.options.userOnly||C===f.default.sources.USER?P.record(F,O):P.transform(F))}),P.quill.keyboard.addBinding({key:"Z",shortKey:!0},P.undo.bind(P)),P.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},P.redo.bind(P)),/Win/i.test(navigator.platform)&&P.quill.keyboard.addBinding({key:"Y",shortKey:!0},P.redo.bind(P)),P}return s(I,[{key:"change",value:function(U,P){if(this.stack[U].length!==0){var k=this.stack[U].pop();this.stack[P].push(k),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(k[U],f.default.sources.USER),this.ignoreChange=!1;var F=N(k[U]);this.quill.setSelection(F)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(U,P){if(U.ops.length!==0){this.stack.redo=[];var k=this.quill.getContents().diff(P),F=Date.now();if(this.lastRecorded+this.options.delay>F&&this.stack.undo.length>0){var O=this.stack.undo.pop();k=k.compose(O.undo),U=O.redo.compose(U)}else this.lastRecorded=F;this.stack.undo.push({redo:U,undo:k}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(U){this.stack.undo.forEach(function(P){P.undo=U.transform(P.undo,!0),P.redo=U.transform(P.redo,!0)}),this.stack.redo.forEach(function(P){P.undo=U.transform(P.undo,!0),P.redo=U.transform(P.redo,!0)})}},{key:"undo",value:function(){this.change("undo","redo")}}]),I}(p.default);b.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};function S(R){var I=R.ops[R.ops.length-1];return I==null?!1:I.insert!=null?typeof I.insert=="string"&&I.insert.endsWith(`
`):I.attributes!=null?Object.keys(I.attributes).some(function(j){return l.default.query(j,l.default.Scope.BLOCK)!=null}):!1}function N(R){var I=R.reduce(function(U,P){return U+=P.delete||0,U},0),j=R.length()-I;return S(R)&&(j-=1),j}n.default=b,n.getLastChangeIndex=N},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BaseTooltip=void 0;var s=function(){function Z(J,ae){for(var le=0;le<ae.length;le++){var Q=ae[le];Q.enumerable=Q.enumerable||!1,Q.configurable=!0,"value"in Q&&(Q.writable=!0),Object.defineProperty(J,Q.key,Q)}}return function(J,ae,le){return ae&&Z(J.prototype,ae),le&&Z(J,le),J}}(),o=function Z(J,ae,le){J===null&&(J=Function.prototype);var Q=Object.getOwnPropertyDescriptor(J,ae);if(Q===void 0){var ce=Object.getPrototypeOf(J);return ce===null?void 0:Z(ce,ae,le)}else{if("value"in Q)return Q.value;var ue=Q.get;return ue===void 0?void 0:ue.call(le)}},l=i(3),d=F(l),f=i(2),m=F(f),p=i(8),g=F(p),v=i(23),E=F(v),x=i(34),b=F(x),S=i(59),N=F(S),R=i(60),I=F(R),j=i(28),U=F(j),P=i(61),k=F(P);function F(Z){return Z&&Z.__esModule?Z:{default:Z}}function O(Z,J){if(!(Z instanceof J))throw new TypeError("Cannot call a class as a function")}function C(Z,J){if(!Z)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return J&&(typeof J=="object"||typeof J=="function")?J:Z}function M(Z,J){if(typeof J!="function"&&J!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof J);Z.prototype=Object.create(J&&J.prototype,{constructor:{value:Z,enumerable:!1,writable:!0,configurable:!0}}),J&&(Object.setPrototypeOf?Object.setPrototypeOf(Z,J):Z.__proto__=J)}var D=[!1,"center","right","justify"],$=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],K=[!1,"serif","monospace"],ee=["1","2","3",!1],se=["small",!1,"large","huge"],ie=function(Z){M(J,Z);function J(ae,le){O(this,J);var Q=C(this,(J.__proto__||Object.getPrototypeOf(J)).call(this,ae,le)),ce=function ue(fe){if(!document.body.contains(ae.root))return document.body.removeEventListener("click",ue);Q.tooltip!=null&&!Q.tooltip.root.contains(fe.target)&&document.activeElement!==Q.tooltip.textbox&&!Q.quill.hasFocus()&&Q.tooltip.hide(),Q.pickers!=null&&Q.pickers.forEach(function(ve){ve.container.contains(fe.target)||ve.close()})};return ae.emitter.listenDOM("click",document.body,ce),Q}return s(J,[{key:"addModule",value:function(le){var Q=o(J.prototype.__proto__||Object.getPrototypeOf(J.prototype),"addModule",this).call(this,le);return le==="toolbar"&&this.extendToolbar(Q),Q}},{key:"buildButtons",value:function(le,Q){le.forEach(function(ce){var ue=ce.getAttribute("class")||"";ue.split(/\s+/).forEach(function(fe){if(fe.startsWith("ql-")&&(fe=fe.slice(3),Q[fe]!=null))if(fe==="direction")ce.innerHTML=Q[fe][""]+Q[fe].rtl;else if(typeof Q[fe]=="string")ce.innerHTML=Q[fe];else{var ve=ce.value||"";ve!=null&&Q[fe][ve]&&(ce.innerHTML=Q[fe][ve])}})})}},{key:"buildPickers",value:function(le,Q){var ce=this;this.pickers=le.map(function(fe){if(fe.classList.contains("ql-align"))return fe.querySelector("option")==null&&z(fe,D),new I.default(fe,Q.align);if(fe.classList.contains("ql-background")||fe.classList.contains("ql-color")){var ve=fe.classList.contains("ql-background")?"background":"color";return fe.querySelector("option")==null&&z(fe,$,ve==="background"?"#ffffff":"#000000"),new N.default(fe,Q[ve])}else return fe.querySelector("option")==null&&(fe.classList.contains("ql-font")?z(fe,K):fe.classList.contains("ql-header")?z(fe,ee):fe.classList.contains("ql-size")&&z(fe,se)),new U.default(fe)});var ue=function(){ce.pickers.forEach(function(ve){ve.update()})};this.quill.on(g.default.events.EDITOR_CHANGE,ue)}}]),J}(b.default);ie.DEFAULTS=(0,d.default)(!0,{},b.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var J=this,ae=this.container.querySelector("input.ql-image[type=file]");ae==null&&(ae=document.createElement("input"),ae.setAttribute("type","file"),ae.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),ae.classList.add("ql-image"),ae.addEventListener("change",function(){if(ae.files!=null&&ae.files[0]!=null){var le=new FileReader;le.onload=function(Q){var ce=J.quill.getSelection(!0);J.quill.updateContents(new m.default().retain(ce.index).delete(ce.length).insert({image:Q.target.result}),g.default.sources.USER),J.quill.setSelection(ce.index+1,g.default.sources.SILENT),ae.value=""},le.readAsDataURL(ae.files[0])}}),this.container.appendChild(ae)),ae.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var re=function(Z){M(J,Z);function J(ae,le){O(this,J);var Q=C(this,(J.__proto__||Object.getPrototypeOf(J)).call(this,ae,le));return Q.textbox=Q.root.querySelector('input[type="text"]'),Q.listen(),Q}return s(J,[{key:"listen",value:function(){var le=this;this.textbox.addEventListener("keydown",function(Q){E.default.match(Q,"enter")?(le.save(),Q.preventDefault()):E.default.match(Q,"escape")&&(le.cancel(),Q.preventDefault())})}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var le=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),Q!=null?this.textbox.value=Q:le!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+le)||""),this.root.setAttribute("data-mode",le)}},{key:"restoreFocus",value:function(){var le=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=le}},{key:"save",value:function(){var le=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":{var Q=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",le,g.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",le,g.default.sources.USER)),this.quill.root.scrollTop=Q;break}case"video":le=G(le);case"formula":{if(!le)break;var ce=this.quill.getSelection(!0);if(ce!=null){var ue=ce.index+ce.length;this.quill.insertEmbed(ue,this.root.getAttribute("data-mode"),le,g.default.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(ue+1," ",g.default.sources.USER),this.quill.setSelection(ue+2,g.default.sources.USER)}break}}this.textbox.value="",this.hide()}}]),J}(k.default);function G(Z){var J=Z.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||Z.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return J?(J[1]||"https")+"://www.youtube.com/embed/"+J[2]+"?showinfo=0":(J=Z.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?(J[1]||"https")+"://player.vimeo.com/video/"+J[2]+"/":Z}function z(Z,J){var ae=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;J.forEach(function(le){var Q=document.createElement("option");le===ae?Q.setAttribute("selected","selected"):Q.setAttribute("value",le),Z.appendChild(Q)})}n.BaseTooltip=re,n.default=ie},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function o(){this.head=this.tail=null,this.length=0}return o.prototype.append=function(){for(var l=[],d=0;d<arguments.length;d++)l[d]=arguments[d];this.insertBefore(l[0],null),l.length>1&&this.append.apply(this,l.slice(1))},o.prototype.contains=function(l){for(var d,f=this.iterator();d=f();)if(d===l)return!0;return!1},o.prototype.insertBefore=function(l,d){l&&(l.next=d,d!=null?(l.prev=d.prev,d.prev!=null&&(d.prev.next=l),d.prev=l,d===this.head&&(this.head=l)):this.tail!=null?(this.tail.next=l,l.prev=this.tail,this.tail=l):(l.prev=null,this.head=this.tail=l),this.length+=1)},o.prototype.offset=function(l){for(var d=0,f=this.head;f!=null;){if(f===l)return d;d+=f.length(),f=f.next}return-1},o.prototype.remove=function(l){this.contains(l)&&(l.prev!=null&&(l.prev.next=l.next),l.next!=null&&(l.next.prev=l.prev),l===this.head&&(this.head=l.next),l===this.tail&&(this.tail=l.prev),this.length-=1)},o.prototype.iterator=function(l){return l===void 0&&(l=this.head),function(){var d=l;return l!=null&&(l=l.next),d}},o.prototype.find=function(l,d){d===void 0&&(d=!1);for(var f,m=this.iterator();f=m();){var p=f.length();if(l<p||d&&l===p&&(f.next==null||f.next.length()!==0))return[f,l];l-=p}return[null,0]},o.prototype.forEach=function(l){for(var d,f=this.iterator();d=f();)l(d)},o.prototype.forEachAt=function(l,d,f){if(!(d<=0))for(var m=this.find(l),p=m[0],g=m[1],v,E=l-g,x=this.iterator(p);(v=x())&&E<l+d;){var b=v.length();l>E?f(v,l-E,Math.min(d,E+b-l)):f(v,0,Math.min(b,l+d-E)),E+=b}},o.prototype.map=function(l){return this.reduce(function(d,f){return d.push(l(f)),d},[])},o.prototype.reduce=function(l,d){for(var f,m=this.iterator();f=m();)d=l(d,f);return d},o}();n.default=s},function(t,n,i){var s=this&&this.__extends||function(){var p=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,v){g.__proto__=v}||function(g,v){for(var E in v)v.hasOwnProperty(E)&&(g[E]=v[E])};return function(g,v){p(g,v);function E(){this.constructor=g}g.prototype=v===null?Object.create(v):(E.prototype=v.prototype,new E)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(17),l=i(1),d={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},f=100,m=function(p){s(g,p);function g(v){var E=p.call(this,v)||this;return E.scroll=E,E.observer=new MutationObserver(function(x){E.update(x)}),E.observer.observe(E.domNode,d),E.attach(),E}return g.prototype.detach=function(){p.prototype.detach.call(this),this.observer.disconnect()},g.prototype.deleteAt=function(v,E){this.update(),v===0&&E===this.length()?this.children.forEach(function(x){x.remove()}):p.prototype.deleteAt.call(this,v,E)},g.prototype.formatAt=function(v,E,x,b){this.update(),p.prototype.formatAt.call(this,v,E,x,b)},g.prototype.insertAt=function(v,E,x){this.update(),p.prototype.insertAt.call(this,v,E,x)},g.prototype.optimize=function(v,E){var x=this;v===void 0&&(v=[]),E===void 0&&(E={}),p.prototype.optimize.call(this,E);for(var b=[].slice.call(this.observer.takeRecords());b.length>0;)v.push(b.pop());for(var S=function(j,U){U===void 0&&(U=!0),!(j==null||j===x)&&j.domNode.parentNode!=null&&(j.domNode[l.DATA_KEY].mutations==null&&(j.domNode[l.DATA_KEY].mutations=[]),U&&S(j.parent))},N=function(j){j.domNode[l.DATA_KEY]==null||j.domNode[l.DATA_KEY].mutations==null||(j instanceof o.default&&j.children.forEach(N),j.optimize(E))},R=v,I=0;R.length>0;I+=1){if(I>=f)throw new Error("[Parchment] Maximum optimize iterations reached");for(R.forEach(function(j){var U=l.find(j.target,!0);U!=null&&(U.domNode===j.target&&(j.type==="childList"?(S(l.find(j.previousSibling,!1)),[].forEach.call(j.addedNodes,function(P){var k=l.find(P,!1);S(k,!1),k instanceof o.default&&k.children.forEach(function(F){S(F,!1)})})):j.type==="attributes"&&S(U.prev)),S(U))}),this.children.forEach(N),R=[].slice.call(this.observer.takeRecords()),b=R.slice();b.length>0;)v.push(b.pop())}},g.prototype.update=function(v,E){var x=this;E===void 0&&(E={}),v=v||this.observer.takeRecords(),v.map(function(b){var S=l.find(b.target,!0);return S==null?null:S.domNode[l.DATA_KEY].mutations==null?(S.domNode[l.DATA_KEY].mutations=[b],S):(S.domNode[l.DATA_KEY].mutations.push(b),null)}).forEach(function(b){b==null||b===x||b.domNode[l.DATA_KEY]==null||b.update(b.domNode[l.DATA_KEY].mutations||[],E)}),this.domNode[l.DATA_KEY].mutations!=null&&p.prototype.update.call(this,this.domNode[l.DATA_KEY].mutations,E),this.optimize(v,E)},g.blotName="scroll",g.defaultChild="block",g.scope=l.Scope.BLOCK_BLOT,g.tagName="DIV",g}(o.default);n.default=m},function(t,n,i){var s=this&&this.__extends||function(){var m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(p,g){p.__proto__=g}||function(p,g){for(var v in g)g.hasOwnProperty(v)&&(p[v]=g[v])};return function(p,g){m(p,g);function v(){this.constructor=p}p.prototype=g===null?Object.create(g):(v.prototype=g.prototype,new v)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(18),l=i(1);function d(m,p){if(Object.keys(m).length!==Object.keys(p).length)return!1;for(var g in m)if(m[g]!==p[g])return!1;return!0}var f=function(m){s(p,m);function p(){return m!==null&&m.apply(this,arguments)||this}return p.formats=function(g){if(g.tagName!==p.tagName)return m.formats.call(this,g)},p.prototype.format=function(g,v){var E=this;g===this.statics.blotName&&!v?(this.children.forEach(function(x){x instanceof o.default||(x=x.wrap(p.blotName,!0)),E.attributes.copy(x)}),this.unwrap()):m.prototype.format.call(this,g,v)},p.prototype.formatAt=function(g,v,E,x){if(this.formats()[E]!=null||l.query(E,l.Scope.ATTRIBUTE)){var b=this.isolate(g,v);b.format(E,x)}else m.prototype.formatAt.call(this,g,v,E,x)},p.prototype.optimize=function(g){m.prototype.optimize.call(this,g);var v=this.formats();if(Object.keys(v).length===0)return this.unwrap();var E=this.next;E instanceof p&&E.prev===this&&d(v,E.formats())&&(E.moveChildren(this),E.remove())},p.blotName="inline",p.scope=l.Scope.INLINE_BLOT,p.tagName="SPAN",p}(o.default);n.default=f},function(t,n,i){var s=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,p){m.__proto__=p}||function(m,p){for(var g in p)p.hasOwnProperty(g)&&(m[g]=p[g])};return function(m,p){f(m,p);function g(){this.constructor=m}m.prototype=p===null?Object.create(p):(g.prototype=p.prototype,new g)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(18),l=i(1),d=function(f){s(m,f);function m(){return f!==null&&f.apply(this,arguments)||this}return m.formats=function(p){var g=l.query(m.blotName).tagName;if(p.tagName!==g)return f.formats.call(this,p)},m.prototype.format=function(p,g){l.query(p,l.Scope.BLOCK)!=null&&(p===this.statics.blotName&&!g?this.replaceWith(m.blotName):f.prototype.format.call(this,p,g))},m.prototype.formatAt=function(p,g,v,E){l.query(v,l.Scope.BLOCK)!=null?this.format(v,E):f.prototype.formatAt.call(this,p,g,v,E)},m.prototype.insertAt=function(p,g,v){if(v==null||l.query(g,l.Scope.INLINE)!=null)f.prototype.insertAt.call(this,p,g,v);else{var E=this.split(p),x=l.create(g,v);E.parent.insertBefore(x,E)}},m.prototype.update=function(p,g){navigator.userAgent.match(/Trident/)?this.build():f.prototype.update.call(this,p,g)},m.blotName="block",m.scope=l.Scope.BLOCK_BLOT,m.tagName="P",m}(o.default);n.default=d},function(t,n,i){var s=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,m){f.__proto__=m}||function(f,m){for(var p in m)m.hasOwnProperty(p)&&(f[p]=m[p])};return function(f,m){d(f,m);function p(){this.constructor=f}f.prototype=m===null?Object.create(m):(p.prototype=m.prototype,new p)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(19),l=function(d){s(f,d);function f(){return d!==null&&d.apply(this,arguments)||this}return f.formats=function(m){},f.prototype.format=function(m,p){d.prototype.formatAt.call(this,0,this.length(),m,p)},f.prototype.formatAt=function(m,p,g,v){m===0&&p===this.length()?this.format(g,v):d.prototype.formatAt.call(this,m,p,g,v)},f.prototype.formats=function(){return this.statics.formats(this.domNode)},f}(o.default);n.default=l},function(t,n,i){var s=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,p){m.__proto__=p}||function(m,p){for(var g in p)p.hasOwnProperty(g)&&(m[g]=p[g])};return function(m,p){f(m,p);function g(){this.constructor=m}m.prototype=p===null?Object.create(p):(g.prototype=p.prototype,new g)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(19),l=i(1),d=function(f){s(m,f);function m(p){var g=f.call(this,p)||this;return g.text=g.statics.value(g.domNode),g}return m.create=function(p){return document.createTextNode(p)},m.value=function(p){var g=p.data;return g.normalize&&(g=g.normalize()),g},m.prototype.deleteAt=function(p,g){this.domNode.data=this.text=this.text.slice(0,p)+this.text.slice(p+g)},m.prototype.index=function(p,g){return this.domNode===p?g:-1},m.prototype.insertAt=function(p,g,v){v==null?(this.text=this.text.slice(0,p)+g+this.text.slice(p),this.domNode.data=this.text):f.prototype.insertAt.call(this,p,g,v)},m.prototype.length=function(){return this.text.length},m.prototype.optimize=function(p){f.prototype.optimize.call(this,p),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof m&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},m.prototype.position=function(p,g){return[this.domNode,p]},m.prototype.split=function(p,g){if(g===void 0&&(g=!1),!g){if(p===0)return this;if(p===this.length())return this.next}var v=l.create(this.domNode.splitText(p));return this.parent.insertBefore(v,this.next),this.text=this.statics.value(this.domNode),v},m.prototype.update=function(p,g){var v=this;p.some(function(E){return E.type==="characterData"&&E.target===v.domNode})&&(this.text=this.statics.value(this.domNode))},m.prototype.value=function(){return this.text},m.blotName="text",m.scope=l.Scope.INLINE_BLOT,m}(o.default);n.default=d},function(t,n,i){var s=document.createElement("div");if(s.classList.toggle("test-class",!1),s.classList.contains("test-class")){var o=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(l,d){return arguments.length>1&&!this.contains(l)==!d?d:o.call(this,l)}}String.prototype.startsWith||(String.prototype.startsWith=function(l,d){return d=d||0,this.substr(d,l.length)===l}),String.prototype.endsWith||(String.prototype.endsWith=function(l,d){var f=this.toString();(typeof d!="number"||!isFinite(d)||Math.floor(d)!==d||d>f.length)&&(d=f.length),d-=l.length;var m=f.indexOf(l,d);return m!==-1&&m===d}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(d){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof d!="function")throw new TypeError("predicate must be a function");for(var f=Object(this),m=f.length>>>0,p=arguments[1],g,v=0;v<m;v++)if(g=f[v],d.call(p,g,v,f))return g}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})},function(t,n){var i=-1,s=1,o=0;function l(I,j,U){if(I==j)return I?[[o,I]]:[];(U<0||I.length<U)&&(U=null);var P=p(I,j),k=I.substring(0,P);I=I.substring(P),j=j.substring(P),P=g(I,j);var F=I.substring(I.length-P);I=I.substring(0,I.length-P),j=j.substring(0,j.length-P);var O=d(I,j);return k&&O.unshift([o,k]),F&&O.push([o,F]),E(O),U!=null&&(O=S(O,U)),O=N(O),O}function d(I,j){var U;if(!I)return[[s,j]];if(!j)return[[i,I]];var P=I.length>j.length?I:j,k=I.length>j.length?j:I,F=P.indexOf(k);if(F!=-1)return U=[[s,P.substring(0,F)],[o,k],[s,P.substring(F+k.length)]],I.length>j.length&&(U[0][0]=U[2][0]=i),U;if(k.length==1)return[[i,I],[s,j]];var O=v(I,j);if(O){var C=O[0],M=O[1],D=O[2],$=O[3],K=O[4],ee=l(C,D),se=l(M,$);return ee.concat([[o,K]],se)}return f(I,j)}function f(I,j){for(var U=I.length,P=j.length,k=Math.ceil((U+P)/2),F=k,O=2*k,C=new Array(O),M=new Array(O),D=0;D<O;D++)C[D]=-1,M[D]=-1;C[F+1]=0,M[F+1]=0;for(var $=U-P,K=$%2!=0,ee=0,se=0,ie=0,re=0,G=0;G<k;G++){for(var z=-G+ee;z<=G-se;z+=2){var Z=F+z,J;z==-G||z!=G&&C[Z-1]<C[Z+1]?J=C[Z+1]:J=C[Z-1]+1;for(var ae=J-z;J<U&&ae<P&&I.charAt(J)==j.charAt(ae);)J++,ae++;if(C[Z]=J,J>U)se+=2;else if(ae>P)ee+=2;else if(K){var le=F+$-z;if(le>=0&&le<O&&M[le]!=-1){var Q=U-M[le];if(J>=Q)return m(I,j,J,ae)}}}for(var ce=-G+ie;ce<=G-re;ce+=2){var le=F+ce,Q;ce==-G||ce!=G&&M[le-1]<M[le+1]?Q=M[le+1]:Q=M[le-1]+1;for(var ue=Q-ce;Q<U&&ue<P&&I.charAt(U-Q-1)==j.charAt(P-ue-1);)Q++,ue++;if(M[le]=Q,Q>U)re+=2;else if(ue>P)ie+=2;else if(!K){var Z=F+$-ce;if(Z>=0&&Z<O&&C[Z]!=-1){var J=C[Z],ae=F+J-Z;if(Q=U-Q,J>=Q)return m(I,j,J,ae)}}}}return[[i,I],[s,j]]}function m(I,j,U,P){var k=I.substring(0,U),F=j.substring(0,P),O=I.substring(U),C=j.substring(P),M=l(k,F),D=l(O,C);return M.concat(D)}function p(I,j){if(!I||!j||I.charAt(0)!=j.charAt(0))return 0;for(var U=0,P=Math.min(I.length,j.length),k=P,F=0;U<k;)I.substring(F,k)==j.substring(F,k)?(U=k,F=U):P=k,k=Math.floor((P-U)/2+U);return k}function g(I,j){if(!I||!j||I.charAt(I.length-1)!=j.charAt(j.length-1))return 0;for(var U=0,P=Math.min(I.length,j.length),k=P,F=0;U<k;)I.substring(I.length-k,I.length-F)==j.substring(j.length-k,j.length-F)?(U=k,F=U):P=k,k=Math.floor((P-U)/2+U);return k}function v(I,j){var U=I.length>j.length?I:j,P=I.length>j.length?j:I;if(U.length<4||P.length*2<U.length)return null;function k(se,ie,re){for(var G=se.substring(re,re+Math.floor(se.length/4)),z=-1,Z="",J,ae,le,Q;(z=ie.indexOf(G,z+1))!=-1;){var ce=p(se.substring(re),ie.substring(z)),ue=g(se.substring(0,re),ie.substring(0,z));Z.length<ue+ce&&(Z=ie.substring(z-ue,z)+ie.substring(z,z+ce),J=se.substring(0,re-ue),ae=se.substring(re+ce),le=ie.substring(0,z-ue),Q=ie.substring(z+ce))}return Z.length*2>=se.length?[J,ae,le,Q,Z]:null}var F=k(U,P,Math.ceil(U.length/4)),O=k(U,P,Math.ceil(U.length/2)),C;if(!F&&!O)return null;O?F?C=F[4].length>O[4].length?F:O:C=O:C=F;var M,D,$,K;I.length>j.length?(M=C[0],D=C[1],$=C[2],K=C[3]):($=C[0],K=C[1],M=C[2],D=C[3]);var ee=C[4];return[M,D,$,K,ee]}function E(I){I.push([o,""]);for(var j=0,U=0,P=0,k="",F="",O;j<I.length;)switch(I[j][0]){case s:P++,F+=I[j][1],j++;break;case i:U++,k+=I[j][1],j++;break;case o:U+P>1?(U!==0&&P!==0&&(O=p(F,k),O!==0&&(j-U-P>0&&I[j-U-P-1][0]==o?I[j-U-P-1][1]+=F.substring(0,O):(I.splice(0,0,[o,F.substring(0,O)]),j++),F=F.substring(O),k=k.substring(O)),O=g(F,k),O!==0&&(I[j][1]=F.substring(F.length-O)+I[j][1],F=F.substring(0,F.length-O),k=k.substring(0,k.length-O))),U===0?I.splice(j-P,U+P,[s,F]):P===0?I.splice(j-U,U+P,[i,k]):I.splice(j-U-P,U+P,[i,k],[s,F]),j=j-U-P+(U?1:0)+(P?1:0)+1):j!==0&&I[j-1][0]==o?(I[j-1][1]+=I[j][1],I.splice(j,1)):j++,P=0,U=0,k="",F="";break}I[I.length-1][1]===""&&I.pop();var C=!1;for(j=1;j<I.length-1;)I[j-1][0]==o&&I[j+1][0]==o&&(I[j][1].substring(I[j][1].length-I[j-1][1].length)==I[j-1][1]?(I[j][1]=I[j-1][1]+I[j][1].substring(0,I[j][1].length-I[j-1][1].length),I[j+1][1]=I[j-1][1]+I[j+1][1],I.splice(j-1,1),C=!0):I[j][1].substring(0,I[j+1][1].length)==I[j+1][1]&&(I[j-1][1]+=I[j+1][1],I[j][1]=I[j][1].substring(I[j+1][1].length)+I[j+1][1],I.splice(j+1,1),C=!0)),j++;C&&E(I)}var x=l;x.INSERT=s,x.DELETE=i,x.EQUAL=o,t.exports=x;function b(I,j){if(j===0)return[o,I];for(var U=0,P=0;P<I.length;P++){var k=I[P];if(k[0]===i||k[0]===o){var F=U+k[1].length;if(j===F)return[P+1,I];if(j<F){I=I.slice();var O=j-U,C=[k[0],k[1].slice(0,O)],M=[k[0],k[1].slice(O)];return I.splice(P,1,C,M),[P+1,I]}else U=F}}throw new Error("cursor_pos is out of bounds!")}function S(I,j){var U=b(I,j),P=U[1],k=U[0],F=P[k],O=P[k+1];if(F==null)return I;if(F[0]!==o)return I;if(O!=null&&F[1]+O[1]===O[1]+F[1])return P.splice(k,2,O,F),R(P,k,2);if(O!=null&&O[1].indexOf(F[1])===0){P.splice(k,2,[O[0],F[1]],[0,F[1]]);var C=O[1].slice(F[1].length);return C.length>0&&P.splice(k+2,0,[O[0],C]),R(P,k,3)}else return I}function N(I){for(var j=!1,U=function(O){return O.charCodeAt(0)>=56320&&O.charCodeAt(0)<=57343},P=function(O){return O.charCodeAt(O.length-1)>=55296&&O.charCodeAt(O.length-1)<=56319},k=2;k<I.length;k+=1)I[k-2][0]===o&&P(I[k-2][1])&&I[k-1][0]===i&&U(I[k-1][1])&&I[k][0]===s&&U(I[k][1])&&(j=!0,I[k-1][1]=I[k-2][1].slice(-1)+I[k-1][1],I[k][1]=I[k-2][1].slice(-1)+I[k][1],I[k-2][1]=I[k-2][1].slice(0,-1));if(!j)return I;for(var F=[],k=0;k<I.length;k+=1)I[k][1].length>0&&F.push(I[k]);return F}function R(I,j,U){for(var P=j+U-1;P>=0&&P>=j-1;P--)if(P+1<I.length){var k=I[P],F=I[P+1];k[0]===F[1]&&I.splice(P,2,[k[0],k[1]+F[1]])}return I}},function(t,n){n=t.exports=typeof Object.keys=="function"?Object.keys:i,n.shim=i;function i(s){var o=[];for(var l in s)o.push(l);return o}},function(t,n){var i=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";n=t.exports=i?s:o,n.supported=s;function s(l){return Object.prototype.toString.call(l)=="[object Arguments]"}n.unsupported=o;function o(l){return l&&typeof l=="object"&&typeof l.length=="number"&&Object.prototype.hasOwnProperty.call(l,"callee")&&!Object.prototype.propertyIsEnumerable.call(l,"callee")||!1}},function(t,n){var i=Object.prototype.hasOwnProperty,s="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(s=!1));function l(f,m,p){this.fn=f,this.context=m,this.once=p||!1}function d(){this._events=new o,this._eventsCount=0}d.prototype.eventNames=function(){var m=[],p,g;if(this._eventsCount===0)return m;for(g in p=this._events)i.call(p,g)&&m.push(s?g.slice(1):g);return Object.getOwnPropertySymbols?m.concat(Object.getOwnPropertySymbols(p)):m},d.prototype.listeners=function(m,p){var g=s?s+m:m,v=this._events[g];if(p)return!!v;if(!v)return[];if(v.fn)return[v.fn];for(var E=0,x=v.length,b=new Array(x);E<x;E++)b[E]=v[E].fn;return b},d.prototype.emit=function(m,p,g,v,E,x){var b=s?s+m:m;if(!this._events[b])return!1;var S=this._events[b],N=arguments.length,R,I;if(S.fn){switch(S.once&&this.removeListener(m,S.fn,void 0,!0),N){case 1:return S.fn.call(S.context),!0;case 2:return S.fn.call(S.context,p),!0;case 3:return S.fn.call(S.context,p,g),!0;case 4:return S.fn.call(S.context,p,g,v),!0;case 5:return S.fn.call(S.context,p,g,v,E),!0;case 6:return S.fn.call(S.context,p,g,v,E,x),!0}for(I=1,R=new Array(N-1);I<N;I++)R[I-1]=arguments[I];S.fn.apply(S.context,R)}else{var j=S.length,U;for(I=0;I<j;I++)switch(S[I].once&&this.removeListener(m,S[I].fn,void 0,!0),N){case 1:S[I].fn.call(S[I].context);break;case 2:S[I].fn.call(S[I].context,p);break;case 3:S[I].fn.call(S[I].context,p,g);break;case 4:S[I].fn.call(S[I].context,p,g,v);break;default:if(!R)for(U=1,R=new Array(N-1);U<N;U++)R[U-1]=arguments[U];S[I].fn.apply(S[I].context,R)}}return!0},d.prototype.on=function(m,p,g){var v=new l(p,g||this),E=s?s+m:m;return this._events[E]?this._events[E].fn?this._events[E]=[this._events[E],v]:this._events[E].push(v):(this._events[E]=v,this._eventsCount++),this},d.prototype.once=function(m,p,g){var v=new l(p,g||this,!0),E=s?s+m:m;return this._events[E]?this._events[E].fn?this._events[E]=[this._events[E],v]:this._events[E].push(v):(this._events[E]=v,this._eventsCount++),this},d.prototype.removeListener=function(m,p,g,v){var E=s?s+m:m;if(!this._events[E])return this;if(!p)return--this._eventsCount===0?this._events=new o:delete this._events[E],this;var x=this._events[E];if(x.fn)x.fn===p&&(!v||x.once)&&(!g||x.context===g)&&(--this._eventsCount===0?this._events=new o:delete this._events[E]);else{for(var b=0,S=[],N=x.length;b<N;b++)(x[b].fn!==p||v&&!x[b].once||g&&x[b].context!==g)&&S.push(x[b]);S.length?this._events[E]=S.length===1?S[0]:S:--this._eventsCount===0?this._events=new o:delete this._events[E]}return this},d.prototype.removeAllListeners=function(m){var p;return m?(p=s?s+m:m,this._events[p]&&(--this._eventsCount===0?this._events=new o:delete this._events[p])):(this._events=new o,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prototype.setMaxListeners=function(){return this},d.prefixed=s,d.EventEmitter=d,typeof t<"u"&&(t.exports=d)},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.matchText=n.matchSpacing=n.matchNewline=n.matchBlot=n.matchAttributor=n.default=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Te){return typeof Te}:function(Te){return Te&&typeof Symbol=="function"&&Te.constructor===Symbol&&Te!==Symbol.prototype?"symbol":typeof Te},o=function(){function Te(Ie,Le){var Be=[],ke=!0,_t=!1,gt=void 0;try{for(var yt=Ie[Symbol.iterator](),kt;!(ke=(kt=yt.next()).done)&&(Be.push(kt.value),!(Le&&Be.length===Le));ke=!0);}catch(Ft){_t=!0,gt=Ft}finally{try{!ke&&yt.return&&yt.return()}finally{if(_t)throw gt}}return Be}return function(Ie,Le){if(Array.isArray(Ie))return Ie;if(Symbol.iterator in Object(Ie))return Te(Ie,Le);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function Te(Ie,Le){for(var Be=0;Be<Le.length;Be++){var ke=Le[Be];ke.enumerable=ke.enumerable||!1,ke.configurable=!0,"value"in ke&&(ke.writable=!0),Object.defineProperty(Ie,ke.key,ke)}}return function(Ie,Le,Be){return Le&&Te(Ie.prototype,Le),Be&&Te(Ie,Be),Ie}}(),d=i(3),f=M(d),m=i(2),p=M(m),g=i(0),v=M(g),E=i(5),x=M(E),b=i(10),S=M(b),N=i(9),R=M(N),I=i(36),j=i(37),U=i(13),P=M(U),k=i(26),F=i(38),O=i(39),C=i(40);function M(Te){return Te&&Te.__esModule?Te:{default:Te}}function D(Te,Ie,Le){return Ie in Te?Object.defineProperty(Te,Ie,{value:Le,enumerable:!0,configurable:!0,writable:!0}):Te[Ie]=Le,Te}function $(Te,Ie){if(!(Te instanceof Ie))throw new TypeError("Cannot call a class as a function")}function K(Te,Ie){if(!Te)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Ie&&(typeof Ie=="object"||typeof Ie=="function")?Ie:Te}function ee(Te,Ie){if(typeof Ie!="function"&&Ie!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Ie);Te.prototype=Object.create(Ie&&Ie.prototype,{constructor:{value:Te,enumerable:!1,writable:!0,configurable:!0}}),Ie&&(Object.setPrototypeOf?Object.setPrototypeOf(Te,Ie):Te.__proto__=Ie)}var se=(0,S.default)("quill:clipboard"),ie="__ql-matcher",re=[[Node.TEXT_NODE,bt],[Node.TEXT_NODE,Ge],["br",Me],[Node.ELEMENT_NODE,Ge],[Node.ELEMENT_NODE,ve],[Node.ELEMENT_NODE,lt],[Node.ELEMENT_NODE,fe],[Node.ELEMENT_NODE,Ct],["li",qe],["b",ue.bind(ue,"bold")],["i",ue.bind(ue,"italic")],["style",Pe]],G=[I.AlignAttribute,F.DirectionAttribute].reduce(function(Te,Ie){return Te[Ie.keyName]=Ie,Te},{}),z=[I.AlignStyle,j.BackgroundStyle,k.ColorStyle,F.DirectionStyle,O.FontStyle,C.SizeStyle].reduce(function(Te,Ie){return Te[Ie.keyName]=Ie,Te},{}),Z=function(Te){ee(Ie,Te);function Ie(Le,Be){$(this,Ie);var ke=K(this,(Ie.__proto__||Object.getPrototypeOf(Ie)).call(this,Le,Be));return ke.quill.root.addEventListener("paste",ke.onPaste.bind(ke)),ke.container=ke.quill.addContainer("ql-clipboard"),ke.container.setAttribute("contenteditable",!0),ke.container.setAttribute("tabindex",-1),ke.matchers=[],re.concat(ke.options.matchers).forEach(function(_t){var gt=o(_t,2),yt=gt[0],kt=gt[1];!Be.matchVisual&&kt===lt||ke.addMatcher(yt,kt)}),ke}return l(Ie,[{key:"addMatcher",value:function(Be,ke){this.matchers.push([Be,ke])}},{key:"convert",value:function(Be){if(typeof Be=="string")return this.container.innerHTML=Be.replace(/\>\r?\n +\</g,"><"),this.convert();var ke=this.quill.getFormat(this.quill.selection.savedRange.index);if(ke[P.default.blotName]){var _t=this.container.innerText;return this.container.innerHTML="",new p.default().insert(_t,D({},P.default.blotName,ke[P.default.blotName]))}var gt=this.prepareMatching(),yt=o(gt,2),kt=yt[0],Ft=yt[1],Vt=ce(this.container,kt,Ft);return le(Vt,`
`)&&Vt.ops[Vt.ops.length-1].attributes==null&&(Vt=Vt.compose(new p.default().retain(Vt.length()-1).delete(1))),se.log("convert",this.container.innerHTML,Vt),this.container.innerHTML="",Vt}},{key:"dangerouslyPasteHTML",value:function(Be,ke){var _t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:x.default.sources.API;if(typeof Be=="string")this.quill.setContents(this.convert(Be),ke),this.quill.setSelection(0,x.default.sources.SILENT);else{var gt=this.convert(ke);this.quill.updateContents(new p.default().retain(Be).concat(gt),_t),this.quill.setSelection(Be+gt.length(),x.default.sources.SILENT)}}},{key:"onPaste",value:function(Be){var ke=this;if(!(Be.defaultPrevented||!this.quill.isEnabled())){var _t=this.quill.getSelection(),gt=new p.default().retain(_t.index),yt=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(x.default.sources.SILENT),setTimeout(function(){gt=gt.concat(ke.convert()).delete(_t.length),ke.quill.updateContents(gt,x.default.sources.USER),ke.quill.setSelection(gt.length()-_t.length,x.default.sources.SILENT),ke.quill.scrollingContainer.scrollTop=yt,ke.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var Be=this,ke=[],_t=[];return this.matchers.forEach(function(gt){var yt=o(gt,2),kt=yt[0],Ft=yt[1];switch(kt){case Node.TEXT_NODE:_t.push(Ft);break;case Node.ELEMENT_NODE:ke.push(Ft);break;default:[].forEach.call(Be.container.querySelectorAll(kt),function(Vt){Vt[ie]=Vt[ie]||[],Vt[ie].push(Ft)});break}}),[ke,_t]}}]),Ie}(R.default);Z.DEFAULTS={matchers:[],matchVisual:!0};function J(Te,Ie,Le){return(typeof Ie>"u"?"undefined":s(Ie))==="object"?Object.keys(Ie).reduce(function(Be,ke){return J(Be,ke,Ie[ke])},Te):Te.reduce(function(Be,ke){return ke.attributes&&ke.attributes[Ie]?Be.push(ke):Be.insert(ke.insert,(0,f.default)({},D({},Ie,Le),ke.attributes))},new p.default)}function ae(Te){if(Te.nodeType!==Node.ELEMENT_NODE)return{};var Ie="__ql-computed-style";return Te[Ie]||(Te[Ie]=window.getComputedStyle(Te))}function le(Te,Ie){for(var Le="",Be=Te.ops.length-1;Be>=0&&Le.length<Ie.length;--Be){var ke=Te.ops[Be];if(typeof ke.insert!="string")break;Le=ke.insert+Le}return Le.slice(-1*Ie.length)===Ie}function Q(Te){if(Te.childNodes.length===0)return!1;var Ie=ae(Te);return["block","list-item"].indexOf(Ie.display)>-1}function ce(Te,Ie,Le){return Te.nodeType===Te.TEXT_NODE?Le.reduce(function(Be,ke){return ke(Te,Be)},new p.default):Te.nodeType===Te.ELEMENT_NODE?[].reduce.call(Te.childNodes||[],function(Be,ke){var _t=ce(ke,Ie,Le);return ke.nodeType===Te.ELEMENT_NODE&&(_t=Ie.reduce(function(gt,yt){return yt(ke,gt)},_t),_t=(ke[ie]||[]).reduce(function(gt,yt){return yt(ke,gt)},_t)),Be.concat(_t)},new p.default):new p.default}function ue(Te,Ie,Le){return J(Le,Te,!0)}function fe(Te,Ie){var Le=v.default.Attributor.Attribute.keys(Te),Be=v.default.Attributor.Class.keys(Te),ke=v.default.Attributor.Style.keys(Te),_t={};return Le.concat(Be).concat(ke).forEach(function(gt){var yt=v.default.query(gt,v.default.Scope.ATTRIBUTE);yt!=null&&(_t[yt.attrName]=yt.value(Te),_t[yt.attrName])||(yt=G[gt],yt!=null&&(yt.attrName===gt||yt.keyName===gt)&&(_t[yt.attrName]=yt.value(Te)||void 0),yt=z[gt],yt!=null&&(yt.attrName===gt||yt.keyName===gt)&&(yt=z[gt],_t[yt.attrName]=yt.value(Te)||void 0))}),Object.keys(_t).length>0&&(Ie=J(Ie,_t)),Ie}function ve(Te,Ie){var Le=v.default.query(Te);if(Le==null)return Ie;if(Le.prototype instanceof v.default.Embed){var Be={},ke=Le.value(Te);ke!=null&&(Be[Le.blotName]=ke,Ie=new p.default().insert(Be,Le.formats(Te)))}else typeof Le.formats=="function"&&(Ie=J(Ie,Le.blotName,Le.formats(Te)));return Ie}function Me(Te,Ie){return le(Ie,`
`)||Ie.insert(`
`),Ie}function Pe(){return new p.default}function qe(Te,Ie){var Le=v.default.query(Te);if(Le==null||Le.blotName!=="list-item"||!le(Ie,`
`))return Ie;for(var Be=-1,ke=Te.parentNode;!ke.classList.contains("ql-clipboard");)(v.default.query(ke)||{}).blotName==="list"&&(Be+=1),ke=ke.parentNode;return Be<=0?Ie:Ie.compose(new p.default().retain(Ie.length()-1).retain(1,{indent:Be}))}function Ge(Te,Ie){return le(Ie,`
`)||(Q(Te)||Ie.length()>0&&Te.nextSibling&&Q(Te.nextSibling))&&Ie.insert(`
`),Ie}function lt(Te,Ie){if(Q(Te)&&Te.nextElementSibling!=null&&!le(Ie,`

`)){var Le=Te.offsetHeight+parseFloat(ae(Te).marginTop)+parseFloat(ae(Te).marginBottom);Te.nextElementSibling.offsetTop>Te.offsetTop+Le*1.5&&Ie.insert(`
`)}return Ie}function Ct(Te,Ie){var Le={},Be=Te.style||{};return Be.fontStyle&&ae(Te).fontStyle==="italic"&&(Le.italic=!0),Be.fontWeight&&(ae(Te).fontWeight.startsWith("bold")||parseInt(ae(Te).fontWeight)>=700)&&(Le.bold=!0),Object.keys(Le).length>0&&(Ie=J(Ie,Le)),parseFloat(Be.textIndent||0)>0&&(Ie=new p.default().insert("	").concat(Ie)),Ie}function bt(Te,Ie){var Le=Te.data;if(Te.parentNode.tagName==="O:P")return Ie.insert(Le.trim());if(Le.trim().length===0&&Te.parentNode.classList.contains("ql-clipboard"))return Ie;if(!ae(Te.parentNode).whiteSpace.startsWith("pre")){var Be=function(_t,gt){return gt=gt.replace(/[^\u00a0]/g,""),gt.length<1&&_t?" ":gt};Le=Le.replace(/\r\n/g," ").replace(/\n/g," "),Le=Le.replace(/\s\s+/g,Be.bind(Be,!0)),(Te.previousSibling==null&&Q(Te.parentNode)||Te.previousSibling!=null&&Q(Te.previousSibling))&&(Le=Le.replace(/^\s+/,Be.bind(Be,!1))),(Te.nextSibling==null&&Q(Te.parentNode)||Te.nextSibling!=null&&Q(Te.nextSibling))&&(Le=Le.replace(/\s+$/,Be.bind(Be,!1)))}return Ie.insert(Le)}n.default=Z,n.matchAttributor=fe,n.matchBlot=ve,n.matchNewline=Ge,n.matchSpacing=lt,n.matchText=bt},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function E(x,b){for(var S=0;S<b.length;S++){var N=b[S];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(x,N.key,N)}}return function(x,b,S){return b&&E(x.prototype,b),S&&E(x,S),x}}(),o=function E(x,b,S){x===null&&(x=Function.prototype);var N=Object.getOwnPropertyDescriptor(x,b);if(N===void 0){var R=Object.getPrototypeOf(x);return R===null?void 0:E(R,b,S)}else{if("value"in N)return N.value;var I=N.get;return I===void 0?void 0:I.call(S)}},l=i(6),d=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function p(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var v=function(E){g(x,E);function x(){return m(this,x),p(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return s(x,[{key:"optimize",value:function(S){o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"optimize",this).call(this,S),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return o(x.__proto__||Object.getPrototypeOf(x),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),x}(d.default);v.blotName="bold",v.tagName=["STRONG","B"],n.default=v},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.addControls=n.default=void 0;var s=function(){function C(M,D){var $=[],K=!0,ee=!1,se=void 0;try{for(var ie=M[Symbol.iterator](),re;!(K=(re=ie.next()).done)&&($.push(re.value),!(D&&$.length===D));K=!0);}catch(G){ee=!0,se=G}finally{try{!K&&ie.return&&ie.return()}finally{if(ee)throw se}}return $}return function(M,D){if(Array.isArray(M))return M;if(Symbol.iterator in Object(M))return C(M,D);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function C(M,D){for(var $=0;$<D.length;$++){var K=D[$];K.enumerable=K.enumerable||!1,K.configurable=!0,"value"in K&&(K.writable=!0),Object.defineProperty(M,K.key,K)}}return function(M,D,$){return D&&C(M.prototype,D),$&&C(M,$),M}}(),l=i(2),d=S(l),f=i(0),m=S(f),p=i(5),g=S(p),v=i(10),E=S(v),x=i(9),b=S(x);function S(C){return C&&C.__esModule?C:{default:C}}function N(C,M,D){return M in C?Object.defineProperty(C,M,{value:D,enumerable:!0,configurable:!0,writable:!0}):C[M]=D,C}function R(C,M){if(!(C instanceof M))throw new TypeError("Cannot call a class as a function")}function I(C,M){if(!C)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return M&&(typeof M=="object"||typeof M=="function")?M:C}function j(C,M){if(typeof M!="function"&&M!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof M);C.prototype=Object.create(M&&M.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(C,M):C.__proto__=M)}var U=(0,E.default)("quill:toolbar"),P=function(C){j(M,C);function M(D,$){R(this,M);var K=I(this,(M.__proto__||Object.getPrototypeOf(M)).call(this,D,$));if(Array.isArray(K.options.container)){var ee=document.createElement("div");F(ee,K.options.container),D.container.parentNode.insertBefore(ee,D.container),K.container=ee}else typeof K.options.container=="string"?K.container=document.querySelector(K.options.container):K.container=K.options.container;if(!(K.container instanceof HTMLElement)){var se;return se=U.error("Container required for toolbar",K.options),I(K,se)}return K.container.classList.add("ql-toolbar"),K.controls=[],K.handlers={},Object.keys(K.options.handlers).forEach(function(ie){K.addHandler(ie,K.options.handlers[ie])}),[].forEach.call(K.container.querySelectorAll("button, select"),function(ie){K.attach(ie)}),K.quill.on(g.default.events.EDITOR_CHANGE,function(ie,re){ie===g.default.events.SELECTION_CHANGE&&K.update(re)}),K.quill.on(g.default.events.SCROLL_OPTIMIZE,function(){var ie=K.quill.selection.getRange(),re=s(ie,1),G=re[0];K.update(G)}),K}return o(M,[{key:"addHandler",value:function($,K){this.handlers[$]=K}},{key:"attach",value:function($){var K=this,ee=[].find.call($.classList,function(ie){return ie.indexOf("ql-")===0});if(ee){if(ee=ee.slice(3),$.tagName==="BUTTON"&&$.setAttribute("type","button"),this.handlers[ee]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[ee]==null){U.warn("ignoring attaching to disabled format",ee,$);return}if(m.default.query(ee)==null){U.warn("ignoring attaching to nonexistent format",ee,$);return}}var se=$.tagName==="SELECT"?"change":"click";$.addEventListener(se,function(ie){var re=void 0;if($.tagName==="SELECT"){if($.selectedIndex<0)return;var G=$.options[$.selectedIndex];G.hasAttribute("selected")?re=!1:re=G.value||!1}else $.classList.contains("ql-active")?re=!1:re=$.value||!$.hasAttribute("value"),ie.preventDefault();K.quill.focus();var z=K.quill.selection.getRange(),Z=s(z,1),J=Z[0];if(K.handlers[ee]!=null)K.handlers[ee].call(K,re);else if(m.default.query(ee).prototype instanceof m.default.Embed){if(re=prompt("Enter "+ee),!re)return;K.quill.updateContents(new d.default().retain(J.index).delete(J.length).insert(N({},ee,re)),g.default.sources.USER)}else K.quill.format(ee,re,g.default.sources.USER);K.update(J)}),this.controls.push([ee,$])}}},{key:"update",value:function($){var K=$==null?{}:this.quill.getFormat($);this.controls.forEach(function(ee){var se=s(ee,2),ie=se[0],re=se[1];if(re.tagName==="SELECT"){var G=void 0;if($==null)G=null;else if(K[ie]==null)G=re.querySelector("option[selected]");else if(!Array.isArray(K[ie])){var z=K[ie];typeof z=="string"&&(z=z.replace(/\"/g,'\\"')),G=re.querySelector('option[value="'+z+'"]')}G==null?(re.value="",re.selectedIndex=-1):G.selected=!0}else if($==null)re.classList.remove("ql-active");else if(re.hasAttribute("value")){var Z=K[ie]===re.getAttribute("value")||K[ie]!=null&&K[ie].toString()===re.getAttribute("value")||K[ie]==null&&!re.getAttribute("value");re.classList.toggle("ql-active",Z)}else re.classList.toggle("ql-active",K[ie]!=null)})}}]),M}(b.default);P.DEFAULTS={};function k(C,M,D){var $=document.createElement("button");$.setAttribute("type","button"),$.classList.add("ql-"+M),D!=null&&($.value=D),C.appendChild($)}function F(C,M){Array.isArray(M[0])||(M=[M]),M.forEach(function(D){var $=document.createElement("span");$.classList.add("ql-formats"),D.forEach(function(K){if(typeof K=="string")k($,K);else{var ee=Object.keys(K)[0],se=K[ee];Array.isArray(se)?O($,ee,se):k($,ee,se)}}),C.appendChild($)})}function O(C,M,D){var $=document.createElement("select");$.classList.add("ql-"+M),D.forEach(function(K){var ee=document.createElement("option");K!==!1?ee.setAttribute("value",K):ee.setAttribute("selected","selected"),$.appendChild(ee)}),C.appendChild($)}P.DEFAULTS={container:null,handlers:{clean:function(){var M=this,D=this.quill.getSelection();if(D!=null)if(D.length==0){var $=this.quill.getFormat();Object.keys($).forEach(function(K){m.default.query(K,m.default.Scope.INLINE)!=null&&M.quill.format(K,!1)})}else this.quill.removeFormat(D,g.default.sources.USER)},direction:function(M){var D=this.quill.getFormat().align;M==="rtl"&&D==null?this.quill.format("align","right",g.default.sources.USER):!M&&D==="right"&&this.quill.format("align",!1,g.default.sources.USER),this.quill.format("direction",M,g.default.sources.USER)},indent:function(M){var D=this.quill.getSelection(),$=this.quill.getFormat(D),K=parseInt($.indent||0);if(M==="+1"||M==="-1"){var ee=M==="+1"?1:-1;$.direction==="rtl"&&(ee*=-1),this.quill.format("indent",K+ee,g.default.sources.USER)}},link:function(M){M===!0&&(M=prompt("Enter link URL:")),this.quill.format("link",M,g.default.sources.USER)},list:function(M){var D=this.quill.getSelection(),$=this.quill.getFormat(D);M==="check"?$.list==="checked"||$.list==="unchecked"?this.quill.format("list",!1,g.default.sources.USER):this.quill.format("list","unchecked",g.default.sources.USER):this.quill.format("list",M,g.default.sources.USER)}}},n.default=P,n.addControls=F},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function E(x,b){for(var S=0;S<b.length;S++){var N=b[S];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(x,N.key,N)}}return function(x,b,S){return b&&E(x.prototype,b),S&&E(x,S),x}}(),o=function E(x,b,S){x===null&&(x=Function.prototype);var N=Object.getOwnPropertyDescriptor(x,b);if(N===void 0){var R=Object.getPrototypeOf(x);return R===null?void 0:E(R,b,S)}else{if("value"in N)return N.value;var I=N.get;return I===void 0?void 0:I.call(S)}},l=i(28),d=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function p(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var v=function(E){g(x,E);function x(b,S){m(this,x);var N=p(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,b));return N.label.innerHTML=S,N.container.classList.add("ql-color-picker"),[].slice.call(N.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(R){R.classList.add("ql-primary")}),N}return s(x,[{key:"buildItem",value:function(S){var N=o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"buildItem",this).call(this,S);return N.style.backgroundColor=S.getAttribute("value")||"",N}},{key:"selectItem",value:function(S,N){o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"selectItem",this).call(this,S,N);var R=this.label.querySelector(".ql-color-label"),I=S&&S.getAttribute("data-value")||"";R&&(R.tagName==="line"?R.style.stroke=I:R.style.fill=I)}}]),x}(d.default);n.default=v},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function E(x,b){for(var S=0;S<b.length;S++){var N=b[S];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(x,N.key,N)}}return function(x,b,S){return b&&E(x.prototype,b),S&&E(x,S),x}}(),o=function E(x,b,S){x===null&&(x=Function.prototype);var N=Object.getOwnPropertyDescriptor(x,b);if(N===void 0){var R=Object.getPrototypeOf(x);return R===null?void 0:E(R,b,S)}else{if("value"in N)return N.value;var I=N.get;return I===void 0?void 0:I.call(S)}},l=i(28),d=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function p(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var v=function(E){g(x,E);function x(b,S){m(this,x);var N=p(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,b));return N.container.classList.add("ql-icon-picker"),[].forEach.call(N.container.querySelectorAll(".ql-picker-item"),function(R){R.innerHTML=S[R.getAttribute("data-value")||""]}),N.defaultItem=N.container.querySelector(".ql-selected"),N.selectItem(N.defaultItem),N}return s(x,[{key:"selectItem",value:function(S,N){o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"selectItem",this).call(this,S,N),S=S||this.defaultItem,this.label.innerHTML=S.innerHTML}}]),x}(d.default);n.default=v},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function d(f,m){for(var p=0;p<m.length;p++){var g=m[p];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(f,m,p){return m&&d(f.prototype,m),p&&d(f,p),f}}();function o(d,f){if(!(d instanceof f))throw new TypeError("Cannot call a class as a function")}var l=function(){function d(f,m){var p=this;o(this,d),this.quill=f,this.boundsContainer=m||document.body,this.root=f.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){p.root.style.marginTop=-1*p.quill.root.scrollTop+"px"}),this.hide()}return s(d,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(m){var p=m.left+m.width/2-this.root.offsetWidth/2,g=m.bottom+this.quill.root.scrollTop;this.root.style.left=p+"px",this.root.style.top=g+"px",this.root.classList.remove("ql-flip");var v=this.boundsContainer.getBoundingClientRect(),E=this.root.getBoundingClientRect(),x=0;if(E.right>v.right&&(x=v.right-E.right,this.root.style.left=p+x+"px"),E.left<v.left&&(x=v.left-E.left,this.root.style.left=p+x+"px"),E.bottom>v.bottom){var b=E.bottom-E.top,S=m.bottom-m.top+b;this.root.style.top=g-S+"px",this.root.classList.add("ql-flip")}return x}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),d}();n.default=l},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function O(C,M){var D=[],$=!0,K=!1,ee=void 0;try{for(var se=C[Symbol.iterator](),ie;!($=(ie=se.next()).done)&&(D.push(ie.value),!(M&&D.length===M));$=!0);}catch(re){K=!0,ee=re}finally{try{!$&&se.return&&se.return()}finally{if(K)throw ee}}return D}return function(C,M){if(Array.isArray(C))return C;if(Symbol.iterator in Object(C))return O(C,M);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function O(C,M,D){C===null&&(C=Function.prototype);var $=Object.getOwnPropertyDescriptor(C,M);if($===void 0){var K=Object.getPrototypeOf(C);return K===null?void 0:O(K,M,D)}else{if("value"in $)return $.value;var ee=$.get;return ee===void 0?void 0:ee.call(D)}},l=function(){function O(C,M){for(var D=0;D<M.length;D++){var $=M[D];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(C,$.key,$)}}return function(C,M,D){return M&&O(C.prototype,M),D&&O(C,D),C}}(),d=i(3),f=R(d),m=i(8),p=R(m),g=i(43),v=R(g),E=i(27),x=R(E),b=i(15),S=i(41),N=R(S);function R(O){return O&&O.__esModule?O:{default:O}}function I(O,C){if(!(O instanceof C))throw new TypeError("Cannot call a class as a function")}function j(O,C){if(!O)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C&&(typeof C=="object"||typeof C=="function")?C:O}function U(O,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof C);O.prototype=Object.create(C&&C.prototype,{constructor:{value:O,enumerable:!1,writable:!0,configurable:!0}}),C&&(Object.setPrototypeOf?Object.setPrototypeOf(O,C):O.__proto__=C)}var P=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],k=function(O){U(C,O);function C(M,D){I(this,C),D.modules.toolbar!=null&&D.modules.toolbar.container==null&&(D.modules.toolbar.container=P);var $=j(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,M,D));return $.quill.container.classList.add("ql-snow"),$}return l(C,[{key:"extendToolbar",value:function(D){D.container.classList.add("ql-snow"),this.buildButtons([].slice.call(D.container.querySelectorAll("button")),N.default),this.buildPickers([].slice.call(D.container.querySelectorAll("select")),N.default),this.tooltip=new F(this.quill,this.options.bounds),D.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function($,K){D.handlers.link.call(D,!K.format.link)})}}]),C}(v.default);k.DEFAULTS=(0,f.default)(!0,{},v.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(C){if(C){var M=this.quill.getSelection();if(M==null||M.length==0)return;var D=this.quill.getText(M);/^\S+@\S+\.\S+$/.test(D)&&D.indexOf("mailto:")!==0&&(D="mailto:"+D);var $=this.quill.theme.tooltip;$.edit("link",D)}else this.quill.format("link",!1)}}}}});var F=function(O){U(C,O);function C(M,D){I(this,C);var $=j(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,M,D));return $.preview=$.root.querySelector("a.ql-preview"),$}return l(C,[{key:"listen",value:function(){var D=this;o(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function($){D.root.classList.contains("ql-editing")?D.save():D.edit("link",D.preview.textContent),$.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function($){if(D.linkRange!=null){var K=D.linkRange;D.restoreFocus(),D.quill.formatText(K,"link",!1,p.default.sources.USER),delete D.linkRange}$.preventDefault(),D.hide()}),this.quill.on(p.default.events.SELECTION_CHANGE,function($,K,ee){if($!=null){if($.length===0&&ee===p.default.sources.USER){var se=D.quill.scroll.descendant(x.default,$.index),ie=s(se,2),re=ie[0],G=ie[1];if(re!=null){D.linkRange=new b.Range($.index-G,re.length());var z=x.default.formats(re.domNode);D.preview.textContent=z,D.preview.setAttribute("href",z),D.show(),D.position(D.quill.getBounds(D.linkRange));return}}else delete D.linkRange;D.hide()}})}},{key:"show",value:function(){o(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),C}(g.BaseTooltip);F.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),n.default=k},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(29),o=ke(s),l=i(36),d=i(38),f=i(64),m=i(65),p=ke(m),g=i(66),v=ke(g),E=i(67),x=ke(E),b=i(37),S=i(26),N=i(39),R=i(40),I=i(56),j=ke(I),U=i(68),P=ke(U),k=i(27),F=ke(k),O=i(69),C=ke(O),M=i(70),D=ke(M),$=i(71),K=ke($),ee=i(72),se=ke(ee),ie=i(73),re=ke(ie),G=i(13),z=ke(G),Z=i(74),J=ke(Z),ae=i(75),le=ke(ae),Q=i(57),ce=ke(Q),ue=i(41),fe=ke(ue),ve=i(28),Me=ke(ve),Pe=i(59),qe=ke(Pe),Ge=i(60),lt=ke(Ge),Ct=i(61),bt=ke(Ct),Te=i(108),Ie=ke(Te),Le=i(62),Be=ke(Le);function ke(_t){return _t&&_t.__esModule?_t:{default:_t}}o.default.register({"attributors/attribute/direction":d.DirectionAttribute,"attributors/class/align":l.AlignClass,"attributors/class/background":b.BackgroundClass,"attributors/class/color":S.ColorClass,"attributors/class/direction":d.DirectionClass,"attributors/class/font":N.FontClass,"attributors/class/size":R.SizeClass,"attributors/style/align":l.AlignStyle,"attributors/style/background":b.BackgroundStyle,"attributors/style/color":S.ColorStyle,"attributors/style/direction":d.DirectionStyle,"attributors/style/font":N.FontStyle,"attributors/style/size":R.SizeStyle},!0),o.default.register({"formats/align":l.AlignClass,"formats/direction":d.DirectionClass,"formats/indent":f.IndentClass,"formats/background":b.BackgroundStyle,"formats/color":S.ColorStyle,"formats/font":N.FontClass,"formats/size":R.SizeClass,"formats/blockquote":p.default,"formats/code-block":z.default,"formats/header":v.default,"formats/list":x.default,"formats/bold":j.default,"formats/code":G.Code,"formats/italic":P.default,"formats/link":F.default,"formats/script":C.default,"formats/strike":D.default,"formats/underline":K.default,"formats/image":se.default,"formats/video":re.default,"formats/list/item":E.ListItem,"modules/formula":J.default,"modules/syntax":le.default,"modules/toolbar":ce.default,"themes/bubble":Ie.default,"themes/snow":Be.default,"ui/icons":fe.default,"ui/picker":Me.default,"ui/icon-picker":lt.default,"ui/color-picker":qe.default,"ui/tooltip":bt.default},!0),n.default=o.default},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.IndentClass=void 0;var s=function(){function x(b,S){for(var N=0;N<S.length;N++){var R=S[N];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(b,R.key,R)}}return function(b,S,N){return S&&x(b.prototype,S),N&&x(b,N),b}}(),o=function x(b,S,N){b===null&&(b=Function.prototype);var R=Object.getOwnPropertyDescriptor(b,S);if(R===void 0){var I=Object.getPrototypeOf(b);return I===null?void 0:x(I,S,N)}else{if("value"in R)return R.value;var j=R.get;return j===void 0?void 0:j.call(N)}},l=i(0),d=f(l);function f(x){return x&&x.__esModule?x:{default:x}}function m(x,b){if(!(x instanceof b))throw new TypeError("Cannot call a class as a function")}function p(x,b){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:x}function g(x,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);x.prototype=Object.create(b&&b.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(x,b):x.__proto__=b)}var v=function(x){g(b,x);function b(){return m(this,b),p(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return s(b,[{key:"add",value:function(N,R){if(R==="+1"||R==="-1"){var I=this.value(N)||0;R=R==="+1"?I+1:I-1}return R===0?(this.remove(N),!0):o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"add",this).call(this,N,R)}},{key:"canAdd",value:function(N,R){return o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"canAdd",this).call(this,N,R)||o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"canAdd",this).call(this,N,parseInt(R))}},{key:"value",value:function(N){return parseInt(o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"value",this).call(this,N))||void 0}}]),b}(d.default.Attributor.Class),E=new v("indent","ql-indent",{scope:d.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});n.IndentClass=E},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(4),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}function d(g,v){if(!(g instanceof v))throw new TypeError("Cannot call a class as a function")}function f(g,v){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:g}function m(g,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);g.prototype=Object.create(v&&v.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(g,v):g.__proto__=v)}var p=function(g){m(v,g);function v(){return d(this,v),f(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return v}(o.default);p.blotName="blockquote",p.tagName="blockquote",n.default=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function v(E,x){for(var b=0;b<x.length;b++){var S=x[b];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(E,S.key,S)}}return function(E,x,b){return x&&v(E.prototype,x),b&&v(E,b),E}}(),o=i(4),l=d(o);function d(v){return v&&v.__esModule?v:{default:v}}function f(v,E){if(!(v instanceof E))throw new TypeError("Cannot call a class as a function")}function m(v,E){if(!v)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&(typeof E=="object"||typeof E=="function")?E:v}function p(v,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);v.prototype=Object.create(E&&E.prototype,{constructor:{value:v,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(v,E):v.__proto__=E)}var g=function(v){p(E,v);function E(){return f(this,E),m(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return s(E,null,[{key:"formats",value:function(b){return this.tagName.indexOf(b.tagName)+1}}]),E}(l.default);g.blotName="header",g.tagName=["H1","H2","H3","H4","H5","H6"],n.default=g},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.ListItem=void 0;var s=function(){function I(j,U){for(var P=0;P<U.length;P++){var k=U[P];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(j,k.key,k)}}return function(j,U,P){return U&&I(j.prototype,U),P&&I(j,P),j}}(),o=function I(j,U,P){j===null&&(j=Function.prototype);var k=Object.getOwnPropertyDescriptor(j,U);if(k===void 0){var F=Object.getPrototypeOf(j);return F===null?void 0:I(F,U,P)}else{if("value"in k)return k.value;var O=k.get;return O===void 0?void 0:O.call(P)}},l=i(0),d=v(l),f=i(4),m=v(f),p=i(25),g=v(p);function v(I){return I&&I.__esModule?I:{default:I}}function E(I,j,U){return j in I?Object.defineProperty(I,j,{value:U,enumerable:!0,configurable:!0,writable:!0}):I[j]=U,I}function x(I,j){if(!(I instanceof j))throw new TypeError("Cannot call a class as a function")}function b(I,j){if(!I)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return j&&(typeof j=="object"||typeof j=="function")?j:I}function S(I,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof j);I.prototype=Object.create(j&&j.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}),j&&(Object.setPrototypeOf?Object.setPrototypeOf(I,j):I.__proto__=j)}var N=function(I){S(j,I);function j(){return x(this,j),b(this,(j.__proto__||Object.getPrototypeOf(j)).apply(this,arguments))}return s(j,[{key:"format",value:function(P,k){P===R.blotName&&!k?this.replaceWith(d.default.create(this.statics.scope)):o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"format",this).call(this,P,k)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(P,k){return this.parent.isolate(this.offset(this.parent),this.length()),P===this.parent.statics.blotName?(this.parent.replaceWith(P,k),this):(this.parent.unwrap(),o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"replaceWith",this).call(this,P,k))}}],[{key:"formats",value:function(P){return P.tagName===this.tagName?void 0:o(j.__proto__||Object.getPrototypeOf(j),"formats",this).call(this,P)}}]),j}(m.default);N.blotName="list-item",N.tagName="LI";var R=function(I){S(j,I),s(j,null,[{key:"create",value:function(P){var k=P==="ordered"?"OL":"UL",F=o(j.__proto__||Object.getPrototypeOf(j),"create",this).call(this,k);return(P==="checked"||P==="unchecked")&&F.setAttribute("data-checked",P==="checked"),F}},{key:"formats",value:function(P){if(P.tagName==="OL")return"ordered";if(P.tagName==="UL")return P.hasAttribute("data-checked")?P.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function j(U){x(this,j);var P=b(this,(j.__proto__||Object.getPrototypeOf(j)).call(this,U)),k=function(O){if(O.target.parentNode===U){var C=P.statics.formats(U),M=d.default.find(O.target);C==="checked"?M.format("list","unchecked"):C==="unchecked"&&M.format("list","checked")}};return U.addEventListener("touchstart",k),U.addEventListener("mousedown",k),P}return s(j,[{key:"format",value:function(P,k){this.children.length>0&&this.children.tail.format(P,k)}},{key:"formats",value:function(){return E({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(P,k){if(P instanceof N)o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"insertBefore",this).call(this,P,k);else{var F=k==null?this.length():k.offset(this),O=this.split(F);O.parent.insertBefore(P,O)}}},{key:"optimize",value:function(P){o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"optimize",this).call(this,P);var k=this.next;k!=null&&k.prev===this&&k.statics.blotName===this.statics.blotName&&k.domNode.tagName===this.domNode.tagName&&k.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(k.moveChildren(this),k.remove())}},{key:"replace",value:function(P){if(P.statics.blotName!==this.statics.blotName){var k=d.default.create(this.statics.defaultChild);P.moveChildren(k),this.appendChild(k)}o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"replace",this).call(this,P)}}]),j}(g.default);R.blotName="list",R.scope=d.default.Scope.BLOCK_BLOT,R.tagName=["OL","UL"],R.defaultChild="list-item",R.allowedChildren=[N],n.ListItem=N,n.default=R},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(56),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}function d(g,v){if(!(g instanceof v))throw new TypeError("Cannot call a class as a function")}function f(g,v){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:g}function m(g,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);g.prototype=Object.create(v&&v.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(g,v):g.__proto__=v)}var p=function(g){m(v,g);function v(){return d(this,v),f(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return v}(o.default);p.blotName="italic",p.tagName=["EM","I"],n.default=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function E(x,b){for(var S=0;S<b.length;S++){var N=b[S];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(x,N.key,N)}}return function(x,b,S){return b&&E(x.prototype,b),S&&E(x,S),x}}(),o=function E(x,b,S){x===null&&(x=Function.prototype);var N=Object.getOwnPropertyDescriptor(x,b);if(N===void 0){var R=Object.getPrototypeOf(x);return R===null?void 0:E(R,b,S)}else{if("value"in N)return N.value;var I=N.get;return I===void 0?void 0:I.call(S)}},l=i(6),d=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function p(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var v=function(E){g(x,E);function x(){return m(this,x),p(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return s(x,null,[{key:"create",value:function(S){return S==="super"?document.createElement("sup"):S==="sub"?document.createElement("sub"):o(x.__proto__||Object.getPrototypeOf(x),"create",this).call(this,S)}},{key:"formats",value:function(S){if(S.tagName==="SUB")return"sub";if(S.tagName==="SUP")return"super"}}]),x}(d.default);v.blotName="script",v.tagName=["SUB","SUP"],n.default=v},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(6),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}function d(g,v){if(!(g instanceof v))throw new TypeError("Cannot call a class as a function")}function f(g,v){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:g}function m(g,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);g.prototype=Object.create(v&&v.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(g,v):g.__proto__=v)}var p=function(g){m(v,g);function v(){return d(this,v),f(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return v}(o.default);p.blotName="strike",p.tagName="S",n.default=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(6),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}function d(g,v){if(!(g instanceof v))throw new TypeError("Cannot call a class as a function")}function f(g,v){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v&&(typeof v=="object"||typeof v=="function")?v:g}function m(g,v){if(typeof v!="function"&&v!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof v);g.prototype=Object.create(v&&v.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),v&&(Object.setPrototypeOf?Object.setPrototypeOf(g,v):g.__proto__=v)}var p=function(g){m(v,g);function v(){return d(this,v),f(this,(v.__proto__||Object.getPrototypeOf(v)).apply(this,arguments))}return v}(o.default);p.blotName="underline",p.tagName="U",n.default=p},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function b(S,N){for(var R=0;R<N.length;R++){var I=N[R];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(S,I.key,I)}}return function(S,N,R){return N&&b(S.prototype,N),R&&b(S,R),S}}(),o=function b(S,N,R){S===null&&(S=Function.prototype);var I=Object.getOwnPropertyDescriptor(S,N);if(I===void 0){var j=Object.getPrototypeOf(S);return j===null?void 0:b(j,N,R)}else{if("value"in I)return I.value;var U=I.get;return U===void 0?void 0:U.call(R)}},l=i(0),d=m(l),f=i(27);function m(b){return b&&b.__esModule?b:{default:b}}function p(b,S){if(!(b instanceof S))throw new TypeError("Cannot call a class as a function")}function g(b,S){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:b}function v(b,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);b.prototype=Object.create(S&&S.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(b,S):b.__proto__=S)}var E=["alt","height","width"],x=function(b){v(S,b);function S(){return p(this,S),g(this,(S.__proto__||Object.getPrototypeOf(S)).apply(this,arguments))}return s(S,[{key:"format",value:function(R,I){E.indexOf(R)>-1?I?this.domNode.setAttribute(R,I):this.domNode.removeAttribute(R):o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"format",this).call(this,R,I)}}],[{key:"create",value:function(R){var I=o(S.__proto__||Object.getPrototypeOf(S),"create",this).call(this,R);return typeof R=="string"&&I.setAttribute("src",this.sanitize(R)),I}},{key:"formats",value:function(R){return E.reduce(function(I,j){return R.hasAttribute(j)&&(I[j]=R.getAttribute(j)),I},{})}},{key:"match",value:function(R){return/\.(jpe?g|gif|png)$/.test(R)||/^data:image\/.+;base64/.test(R)}},{key:"sanitize",value:function(R){return(0,f.sanitize)(R,["http","https","data"])?R:"//:0"}},{key:"value",value:function(R){return R.getAttribute("src")}}]),S}(d.default.Embed);x.blotName="image",x.tagName="IMG",n.default=x},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function b(S,N){for(var R=0;R<N.length;R++){var I=N[R];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(S,I.key,I)}}return function(S,N,R){return N&&b(S.prototype,N),R&&b(S,R),S}}(),o=function b(S,N,R){S===null&&(S=Function.prototype);var I=Object.getOwnPropertyDescriptor(S,N);if(I===void 0){var j=Object.getPrototypeOf(S);return j===null?void 0:b(j,N,R)}else{if("value"in I)return I.value;var U=I.get;return U===void 0?void 0:U.call(R)}},l=i(4),d=i(27),f=m(d);function m(b){return b&&b.__esModule?b:{default:b}}function p(b,S){if(!(b instanceof S))throw new TypeError("Cannot call a class as a function")}function g(b,S){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:b}function v(b,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);b.prototype=Object.create(S&&S.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(b,S):b.__proto__=S)}var E=["height","width"],x=function(b){v(S,b);function S(){return p(this,S),g(this,(S.__proto__||Object.getPrototypeOf(S)).apply(this,arguments))}return s(S,[{key:"format",value:function(R,I){E.indexOf(R)>-1?I?this.domNode.setAttribute(R,I):this.domNode.removeAttribute(R):o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"format",this).call(this,R,I)}}],[{key:"create",value:function(R){var I=o(S.__proto__||Object.getPrototypeOf(S),"create",this).call(this,R);return I.setAttribute("frameborder","0"),I.setAttribute("allowfullscreen",!0),I.setAttribute("src",this.sanitize(R)),I}},{key:"formats",value:function(R){return E.reduce(function(I,j){return R.hasAttribute(j)&&(I[j]=R.getAttribute(j)),I},{})}},{key:"sanitize",value:function(R){return f.default.sanitize(R)}},{key:"value",value:function(R){return R.getAttribute("src")}}]),S}(l.BlockEmbed);x.blotName="video",x.className="ql-video",x.tagName="IFRAME",n.default=x},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.FormulaBlot=void 0;var s=function(){function R(I,j){for(var U=0;U<j.length;U++){var P=j[U];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(I,P.key,P)}}return function(I,j,U){return j&&R(I.prototype,j),U&&R(I,U),I}}(),o=function R(I,j,U){I===null&&(I=Function.prototype);var P=Object.getOwnPropertyDescriptor(I,j);if(P===void 0){var k=Object.getPrototypeOf(I);return k===null?void 0:R(k,j,U)}else{if("value"in P)return P.value;var F=P.get;return F===void 0?void 0:F.call(U)}},l=i(35),d=v(l),f=i(5),m=v(f),p=i(9),g=v(p);function v(R){return R&&R.__esModule?R:{default:R}}function E(R,I){if(!(R instanceof I))throw new TypeError("Cannot call a class as a function")}function x(R,I){if(!R)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I&&(typeof I=="object"||typeof I=="function")?I:R}function b(R,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof I);R.prototype=Object.create(I&&I.prototype,{constructor:{value:R,enumerable:!1,writable:!0,configurable:!0}}),I&&(Object.setPrototypeOf?Object.setPrototypeOf(R,I):R.__proto__=I)}var S=function(R){b(I,R);function I(){return E(this,I),x(this,(I.__proto__||Object.getPrototypeOf(I)).apply(this,arguments))}return s(I,null,[{key:"create",value:function(U){var P=o(I.__proto__||Object.getPrototypeOf(I),"create",this).call(this,U);return typeof U=="string"&&(window.katex.render(U,P,{throwOnError:!1,errorColor:"#f00"}),P.setAttribute("data-value",U)),P}},{key:"value",value:function(U){return U.getAttribute("data-value")}}]),I}(d.default);S.blotName="formula",S.className="ql-formula",S.tagName="SPAN";var N=function(R){b(I,R),s(I,null,[{key:"register",value:function(){m.default.register(S,!0)}}]);function I(){E(this,I);var j=x(this,(I.__proto__||Object.getPrototypeOf(I)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return j}return I}(g.default);n.FormulaBlot=S,n.default=N},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.CodeToken=n.CodeBlock=void 0;var s=function(){function U(P,k){for(var F=0;F<k.length;F++){var O=k[F];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(P,O.key,O)}}return function(P,k,F){return k&&U(P.prototype,k),F&&U(P,F),P}}(),o=function U(P,k,F){P===null&&(P=Function.prototype);var O=Object.getOwnPropertyDescriptor(P,k);if(O===void 0){var C=Object.getPrototypeOf(P);return C===null?void 0:U(C,k,F)}else{if("value"in O)return O.value;var M=O.get;return M===void 0?void 0:M.call(F)}},l=i(0),d=x(l),f=i(5),m=x(f),p=i(9),g=x(p),v=i(13),E=x(v);function x(U){return U&&U.__esModule?U:{default:U}}function b(U,P){if(!(U instanceof P))throw new TypeError("Cannot call a class as a function")}function S(U,P){if(!U)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P&&(typeof P=="object"||typeof P=="function")?P:U}function N(U,P){if(typeof P!="function"&&P!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof P);U.prototype=Object.create(P&&P.prototype,{constructor:{value:U,enumerable:!1,writable:!0,configurable:!0}}),P&&(Object.setPrototypeOf?Object.setPrototypeOf(U,P):U.__proto__=P)}var R=function(U){N(P,U);function P(){return b(this,P),S(this,(P.__proto__||Object.getPrototypeOf(P)).apply(this,arguments))}return s(P,[{key:"replaceWith",value:function(F){this.domNode.textContent=this.domNode.textContent,this.attach(),o(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"replaceWith",this).call(this,F)}},{key:"highlight",value:function(F){var O=this.domNode.textContent;this.cachedText!==O&&((O.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=F(O),this.domNode.normalize(),this.attach()),this.cachedText=O)}}]),P}(E.default);R.className="ql-syntax";var I=new d.default.Attributor.Class("token","hljs",{scope:d.default.Scope.INLINE}),j=function(U){N(P,U),s(P,null,[{key:"register",value:function(){m.default.register(I,!0),m.default.register(R,!0)}}]);function P(k,F){b(this,P);var O=S(this,(P.__proto__||Object.getPrototypeOf(P)).call(this,k,F));if(typeof O.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var C=null;return O.quill.on(m.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(C),C=setTimeout(function(){O.highlight(),C=null},O.options.interval)}),O.highlight(),O}return s(P,[{key:"highlight",value:function(){var F=this;if(!this.quill.selection.composing){this.quill.update(m.default.sources.USER);var O=this.quill.getSelection();this.quill.scroll.descendants(R).forEach(function(C){C.highlight(F.options.highlight)}),this.quill.update(m.default.sources.SILENT),O!=null&&this.quill.setSelection(O,m.default.sources.SILENT)}}}]),P}(g.default);j.DEFAULTS={highlight:function(){return window.hljs==null?null:function(U){var P=window.hljs.highlightAuto(U);return P.value}}(),interval:1e3},n.CodeBlock=R,n.CodeToken=I,n.default=j},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(t,n){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(t,n){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(t,n){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(t,n){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BubbleTooltip=void 0;var s=function P(k,F,O){k===null&&(k=Function.prototype);var C=Object.getOwnPropertyDescriptor(k,F);if(C===void 0){var M=Object.getPrototypeOf(k);return M===null?void 0:P(M,F,O)}else{if("value"in C)return C.value;var D=C.get;return D===void 0?void 0:D.call(O)}},o=function(){function P(k,F){for(var O=0;O<F.length;O++){var C=F[O];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(k,C.key,C)}}return function(k,F,O){return F&&P(k.prototype,F),O&&P(k,O),k}}(),l=i(3),d=b(l),f=i(8),m=b(f),p=i(43),g=b(p),v=i(15),E=i(41),x=b(E);function b(P){return P&&P.__esModule?P:{default:P}}function S(P,k){if(!(P instanceof k))throw new TypeError("Cannot call a class as a function")}function N(P,k){if(!P)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k&&(typeof k=="object"||typeof k=="function")?k:P}function R(P,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof k);P.prototype=Object.create(k&&k.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),k&&(Object.setPrototypeOf?Object.setPrototypeOf(P,k):P.__proto__=k)}var I=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],j=function(P){R(k,P);function k(F,O){S(this,k),O.modules.toolbar!=null&&O.modules.toolbar.container==null&&(O.modules.toolbar.container=I);var C=N(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,F,O));return C.quill.container.classList.add("ql-bubble"),C}return o(k,[{key:"extendToolbar",value:function(O){this.tooltip=new U(this.quill,this.options.bounds),this.tooltip.root.appendChild(O.container),this.buildButtons([].slice.call(O.container.querySelectorAll("button")),x.default),this.buildPickers([].slice.call(O.container.querySelectorAll("select")),x.default)}}]),k}(g.default);j.DEFAULTS=(0,d.default)(!0,{},g.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(k){k?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var U=function(P){R(k,P);function k(F,O){S(this,k);var C=N(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,F,O));return C.quill.on(m.default.events.EDITOR_CHANGE,function(M,D,$,K){if(M===m.default.events.SELECTION_CHANGE)if(D!=null&&D.length>0&&K===m.default.sources.USER){C.show(),C.root.style.left="0px",C.root.style.width="",C.root.style.width=C.root.offsetWidth+"px";var ee=C.quill.getLines(D.index,D.length);if(ee.length===1)C.position(C.quill.getBounds(D));else{var se=ee[ee.length-1],ie=C.quill.getIndex(se),re=Math.min(se.length()-1,D.index+D.length-ie),G=C.quill.getBounds(new v.Range(ie,re));C.position(G)}}else document.activeElement!==C.textbox&&C.quill.hasFocus()&&C.hide()}),C}return o(k,[{key:"listen",value:function(){var O=this;s(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){O.root.classList.remove("ql-editing")}),this.quill.on(m.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!O.root.classList.contains("ql-hidden")){var C=O.quill.getSelection();C!=null&&O.position(O.quill.getBounds(C))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(O){var C=s(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"position",this).call(this,O),M=this.root.querySelector(".ql-tooltip-arrow");if(M.style.marginLeft="",C===0)return C;M.style.marginLeft=-1*C-M.offsetWidth/2+"px"}}]),k}(p.BaseTooltip);U.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),n.BubbleTooltip=U,n.default=j},function(t,n,i){t.exports=i(63)}]).default})}(Og)),Og.exports}var no,b4;function P$(){if(b4)return no;b4=1;var r=no&&no.__extends||function(){var m=function(p,g){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(v,E){v.__proto__=E}||function(v,E){for(var x in E)E.hasOwnProperty(x)&&(v[x]=E[x])},m(p,g)};return function(p,g){m(p,g);function v(){this.constructor=p}p.prototype=g===null?Object.create(g):(v.prototype=g.prototype,new v)}}(),e=no&&no.__assign||function(){return e=Object.assign||function(m){for(var p,g=1,v=arguments.length;g<v;g++){p=arguments[g];for(var E in p)Object.prototype.hasOwnProperty.call(p,E)&&(m[E]=p[E])}return m},e.apply(this,arguments)},t=no&&no.__spreadArrays||function(){for(var m=0,p=0,g=arguments.length;p<g;p++)m+=arguments[p].length;for(var v=Array(m),E=0,p=0;p<g;p++)for(var x=arguments[p],b=0,S=x.length;b<S;b++,E++)v[E]=x[b];return v},n=no&&no.__importDefault||function(m){return m&&m.__esModule?m:{default:m}},i=n(wy()),s=n(rb()),o=n(A$()),l=n(I$()),d=function(m){r(p,m);function p(g){var v=m.call(this,g)||this;v.dirtyProps=["modules","formats","bounds","theme","children"],v.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],v.state={generation:0},v.selection=null,v.onEditorChange=function(x,b,S,N){var R,I,j,U;x==="text-change"?(I=(R=v).onEditorChangeText)===null||I===void 0||I.call(R,v.editor.root.innerHTML,b,N,v.unprivilegedEditor):x==="selection-change"&&((U=(j=v).onEditorChangeSelection)===null||U===void 0||U.call(j,b,N,v.unprivilegedEditor))};var E=v.isControlled()?g.value:g.defaultValue;return v.value=E??"",v}return p.prototype.validateProps=function(g){var v;if(i.default.Children.count(g.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(i.default.Children.count(g.children)){var E=i.default.Children.only(g.children);if(((v=E)===null||v===void 0?void 0:v.type)==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.")}if(this.lastDeltaChangeSet&&g.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")},p.prototype.shouldComponentUpdate=function(g,v){var E=this,x;if(this.validateProps(g),!this.editor||this.state.generation!==v.generation)return!0;if("value"in g){var b=this.getEditorContents(),S=(x=g.value,x??"");this.isEqualValue(S,b)||this.setEditorContents(this.editor,S)}return g.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,g.readOnly),t(this.cleanProps,this.dirtyProps).some(function(N){return!o.default(g[N],E.props[N])})},p.prototype.shouldComponentRegenerate=function(g){var v=this;return this.dirtyProps.some(function(E){return!o.default(g[E],v.props[E])})},p.prototype.componentDidMount=function(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())},p.prototype.componentWillUnmount=function(){this.destroyEditor()},p.prototype.componentDidUpdate=function(g,v){var E=this;if(this.editor&&this.shouldComponentRegenerate(g)){var x=this.editor.getContents(),b=this.editor.getSelection();this.regenerationSnapshot={delta:x,selection:b},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.state.generation!==v.generation){var S=this.regenerationSnapshot,x=S.delta,N=S.selection;delete this.regenerationSnapshot,this.instantiateEditor();var R=this.editor;R.setContents(x),f(function(){return E.setEditorSelection(R,N)})}},p.prototype.instantiateEditor=function(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())},p.prototype.destroyEditor=function(){this.editor&&this.unhookEditor(this.editor)},p.prototype.isControlled=function(){return"value"in this.props},p.prototype.getEditorConfig=function(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,scrollingContainer:this.props.scrollingContainer,tabIndex:this.props.tabIndex,theme:this.props.theme}},p.prototype.getEditor=function(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor},p.prototype.createEditor=function(g,v){var E=new l.default(g,v);return v.tabIndex!=null&&this.setEditorTabIndex(E,v.tabIndex),this.hookEditor(E),E},p.prototype.hookEditor=function(g){this.unprivilegedEditor=this.makeUnprivilegedEditor(g),g.on("editor-change",this.onEditorChange)},p.prototype.unhookEditor=function(g){g.off("editor-change",this.onEditorChange)},p.prototype.getEditorContents=function(){return this.value},p.prototype.getEditorSelection=function(){return this.selection},p.prototype.isDelta=function(g){return g&&g.ops},p.prototype.isEqualValue=function(g,v){return this.isDelta(g)&&this.isDelta(v)?o.default(g.ops,v.ops):o.default(g,v)},p.prototype.setEditorContents=function(g,v){var E=this;this.value=v;var x=this.getEditorSelection();typeof v=="string"?g.setContents(g.clipboard.convert(v)):g.setContents(v),f(function(){return E.setEditorSelection(g,x)})},p.prototype.setEditorSelection=function(g,v){if(this.selection=v,v){var E=g.getLength();v.index=Math.max(0,Math.min(v.index,E-1)),v.length=Math.max(0,Math.min(v.length,E-1-v.index)),g.setSelection(v)}},p.prototype.setEditorTabIndex=function(g,v){var E,x;!((x=(E=g)===null||E===void 0?void 0:E.scroll)===null||x===void 0)&&x.domNode&&(g.scroll.domNode.tabIndex=v)},p.prototype.setEditorReadOnly=function(g,v){v?g.disable():g.enable()},p.prototype.makeUnprivilegedEditor=function(g){var v=g;return{getHTML:function(){return v.root.innerHTML},getLength:v.getLength.bind(v),getText:v.getText.bind(v),getContents:v.getContents.bind(v),getSelection:v.getSelection.bind(v),getBounds:v.getBounds.bind(v)}},p.prototype.getEditingArea=function(){if(!this.editingArea)throw new Error("Instantiating on missing editing area");var g=s.default.findDOMNode(this.editingArea);if(!g)throw new Error("Cannot find element for editing area");if(g.nodeType===3)throw new Error("Editing area cannot be a text node");return g},p.prototype.renderEditingArea=function(){var g=this,v=this.props,E=v.children,x=v.preserveWhitespace,b=this.state.generation,S={key:b,ref:function(N){g.editingArea=N}};return i.default.Children.count(E)?i.default.cloneElement(i.default.Children.only(E),S):x?i.default.createElement("pre",e({},S)):i.default.createElement("div",e({},S))},p.prototype.render=function(){var g;return i.default.createElement("div",{id:this.props.id,style:this.props.style,key:this.state.generation,className:"quill "+(g=this.props.className,g??""),onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())},p.prototype.onEditorChangeText=function(g,v,E,x){var b,S;if(this.editor){var N=this.isDelta(this.value)?x.getContents():x.getHTML();N!==this.getEditorContents()&&(this.lastDeltaChangeSet=v,this.value=N,(S=(b=this.props).onChange)===null||S===void 0||S.call(b,g,v,E,x))}},p.prototype.onEditorChangeSelection=function(g,v,E){var x,b,S,N,R,I;if(this.editor){var j=this.getEditorSelection(),U=!j&&g,P=j&&!g;o.default(g,j)||(this.selection=g,(b=(x=this.props).onChangeSelection)===null||b===void 0||b.call(x,g,v,E),U?(N=(S=this.props).onFocus)===null||N===void 0||N.call(S,g,v,E):P&&((I=(R=this.props).onBlur)===null||I===void 0||I.call(R,j,v,E)))}},p.prototype.focus=function(){this.editor&&this.editor.focus()},p.prototype.blur=function(){this.editor&&(this.selection=null,this.editor.blur())},p.displayName="React Quill",p.Quill=l.default,p.defaultProps={theme:"snow",modules:{},readOnly:!1},p}(i.default.Component);function f(m){Promise.resolve().then(m)}return no=d,no}var k$=P$();const C$=nb(k$),R$={toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["link"],[{color:[]},{background:[]}],[{align:[]}],["clean"]]},j$=["header","bold","italic","underline","strike","list","bullet","link","color","background","align"],w0=({value:r,onChange:e,placeholder:t,readOnly:n=!1,theme:i="snow",className:s=""})=>c.jsx(C$,{theme:i,value:r||"",onChange:e,modules:R$,formats:j$,placeholder:t,readOnly:n,className:s}),O$=({isOpen:r,onClose:e,ticket:t,db:n,adminUserData:i,showNotification:s,onTicketUpdate:o})=>{const[l,d]=X.useState(null),[f,m]=X.useState(""),[p,g]=X.useState(""),[v,E]=X.useState(!1),[x,b]=X.useState(!1),[S,N]=X.useState(!1),R=X.useRef(null);if(X.useEffect(()=>{t?(d(t),m(t.status||"Open"),g("")):d(null)},[t]),X.useEffect(()=>{var D;(D=R.current)==null||D.scrollIntoView({behavior:"smooth",block:"end"})},[l==null?void 0:l.conversation]),!r||!l)return null;const I="w-full px-3 py-2 rounded-md bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm",j="flex items-center justify-center px-4 py-2 rounded-md font-semibold text-sm transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95",U=async()=>{if(!f||f===l.status){s("Status is unchanged or invalid.","info");return}E(!0);const D={status:f,lastUpdatedByAdminName:i.displayName||"Admin",lastUpdatedByAdminId:i.uid},$=await _9(n,l.id,D);if($.success){s("Ticket status updated!","success");const K={...l,...D,status:f,lastUpdatedAt:Ot.now()};d(K),o&&o(K)}else s($.error||"Failed to update status.","error");E(!1)},P=D=>{g(D)},k=async()=>{if(!p.replace(/<[^>]*>?/gm,"").trim()){s("Reply cannot be empty.","warning");return}b(!0);const K={text:uo.sanitize(p),authorId:i.uid,authorName:i.displayName||"Admin",authorRole:i.role||"admin",timestamp:Ot.now()},ee=await e3(n,l.id,K);if(ee.success){s("Reply sent!","success");const se=[...l.conversation||[],K],ie=f==="Open"||f==="Awaiting Customer"?"In Progress":f,re={...l,conversation:se,lastUpdatedAt:Ot.now(),status:ie};ie!==f&&m(ie),d(re),o&&o(re),g("")}else s(ee.error||"Failed to send reply.","error");b(!1)},F=async()=>{const D=p.replace(/<[^>]*>?/gm,"").trim();if(!D){s("Write a draft or keywords first.","warning");return}N(!0);try{const $=(l.conversation||[]).map(ee=>`${ee.authorRole==="admin"?"Support":"Customer"}: ${ee.text.replace(/<[^>]*>?/gm,"")}`).join(`

`),K=await b3({ticketDescription:l.description,conversationHistory:$,draftReply:D,customerName:l.userName});g(K),s("AI refined your reply.","success")}catch($){const K=($==null?void 0:$.message)||"AI assistance failed.";s(K,"error")}finally{N(!1)}},O=({label:D,value:$,icon:K,valueClass:ee="text-gray-700"})=>c.jsxs("div",{className:"flex items-start py-2 border-b border-slate-100 last:border-b-0",children:[c.jsxs("span",{className:"text-xs font-semibold text-slate-500 w-32 flex items-center shrink-0",children:[K&&c.jsx(K,{size:14,className:"mr-2 text-slate-400"}),D,":"]}),c.jsx("span",{className:`text-sm ${ee} flex-1 break-words`,children:$||"N/A"})]}),C=D=>{switch(D){case"Open":return"bg-red-100 text-red-700";case"In Progress":return"bg-yellow-100 text-yellow-700";case"Resolved":return"bg-green-100 text-green-700";case"Closed":return"bg-purple-100 text-purple-700";case"Awaiting Customer":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-600"}},M=["Open","In Progress","Awaiting Customer","Resolved","Closed"];return c.jsxs(Vr,{isOpen:r,onClose:e,title:"Ticket Details",size:"full",modalDialogClassName:"sm:max-w-4xl w-[95vw] h-[95vh]",contentClassName:"p-0 flex flex-col",children:[c.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 bg-slate-50 rounded-t-xl sticky top-0 z-10",children:[c.jsxs("h3",{className:"text-lg font-semibold text-slate-800 truncate",title:l.issueType,children:[l.issueType," - ID: ",l.id.substring(0,8),"..."]}),c.jsx("button",{onClick:e,className:"p-2 text-gray-500 hover:text-gray-700 rounded-lg",children:c.jsx(u0,{size:18})})]}),c.jsxs("div",{className:"overflow-y-auto flex-grow p-4 space-y-4",children:[c.jsx("div",{className:"p-4 border rounded-lg bg-slate-50/70",children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4",children:[c.jsx(O,{label:"User",value:`${l.userName} (${l.userEmail||"N/A"})`,icon:Rs}),c.jsx(O,{label:"Account No",value:l.accountNumber||"N/A",icon:js}),c.jsx(O,{label:"Submitted",value:Mt(l.submittedAt),icon:xu}),c.jsx(O,{label:"Last Update",value:Mt(l.lastUpdatedAt),icon:hi}),c.jsx(O,{label:"Status",value:c.jsx("span",{className:`px-2 py-0.5 text-xs font-semibold rounded-full ${C(l.status)}`,children:l.status}),icon:Zt}),c.jsx(O,{label:"Ticket ID",value:l.id,icon:js,valueClass:"font-mono text-xs"})]})}),c.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[c.jsx("h4",{className:"text-sm font-semibold text-slate-600 mb-1",children:"Initial Description:"}),c.jsx("div",{className:"p-3 bg-slate-100 rounded-md text-sm text-slate-800 whitespace-pre-line prose prose-sm max-w-none",children:l.description})]}),c.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[c.jsx("h4",{className:"text-sm font-semibold text-slate-600 mb-2",children:"Conversation History"}),c.jsxs("div",{className:"max-h-60 overflow-y-auto space-y-3 p-3 bg-slate-50 border rounded-md",children:[l.conversation&&l.conversation.length>0?l.conversation.map((D,$)=>c.jsxs("div",{className:`p-2.5 rounded-lg ${D.authorRole==="admin"?"bg-blue-100":"bg-green-50"}`,children:[c.jsxs("p",{className:"text-xs font-bold text-gray-800",children:[D.authorName," (",D.authorRole,")"]}),c.jsx("div",{className:"text-sm text-gray-700 prose prose-sm max-w-none break-words",dangerouslySetInnerHTML:{__html:uo.sanitize(D.text||"")}}),c.jsx("p",{className:"text-right text-xs text-gray-500 mt-1",children:Mt(D.timestamp)})]},$)):c.jsx("p",{className:"text-sm text-center text-gray-500 py-4",children:"No replies yet."}),c.jsx("div",{ref:R})]})]}),c.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[c.jsx("h4",{className:"text-sm font-semibold text-slate-600 mb-2",children:"Send Reply"}),c.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[c.jsx(w0,{value:p,onChange:P,placeholder:"Type your reply...",className:"flex-grow bg-white rounded-lg border border-gray-300 min-h-[120px]",readOnly:x||S}),c.jsx("button",{onClick:F,className:`${j} bg-purple-100 text-purple-700 hover:bg-purple-200 self-start p-2`,disabled:S||!p.replace(/<[^>]*>?/gm,"").trim(),title:"Refine reply with AI",children:S?c.jsx(Tt,{size:18,className:"animate-spin"}):c.jsx(Ds,{size:18})})]}),c.jsxs("button",{onClick:k,className:`${j} bg-blue-600 hover:bg-blue-700 text-white`,disabled:x||!p.replace(/<[^>]*>?/gm,"").trim(),children:[x?c.jsx(Tt,{size:18,className:"animate-spin mr-2"}):c.jsx(l0,{size:16,className:"mr-2"}),"Send Reply"]})]}),c.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[c.jsx("label",{htmlFor:"ticketStatusUpdate",className:"block text-sm font-semibold text-slate-600 mb-1.5",children:"Update Ticket Status:"}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("select",{id:"ticketStatusUpdate",value:f,onChange:D=>m(D.target.value),className:`${I} flex-grow`,disabled:v,children:M.map(D=>c.jsx("option",{value:D,children:D},D))}),c.jsxs("button",{onClick:U,className:`${j} bg-green-600 hover:bg-green-700 text-white`,disabled:v||f===l.status,children:[v?c.jsx(Tt,{size:18,className:"animate-spin mr-2"}):c.jsx(Ha,{size:18,className:"mr-2"}),"Update Status"]})]})]})]})]})},D$=({db:r,appId:e,userData:t,showNotification:n})=>{const[i,s]=X.useState([]),[o,l]=X.useState(!0),[d,f]=X.useState(null),[m,p]=X.useState(null),[g,v]=X.useState(!1),[E,x]=X.useState(""),[b,S]=X.useState(""),[N,R]=X.useState(""),I="w-full sm:w-auto text-sm px-3 py-2 rounded-md bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150",j=`${I} placeholder-gray-400`,U=X.useCallback(async(K,ee)=>{const se=ee==null?void 0:ee.autoCloseTicketsDays;if(!se||isNaN(se)||se<=0)return;const ie=new Date,re=[];if(K.forEach(G=>{var z;if(G.status==="Resolved"){const Z=(z=G.lastUpdatedAt)!=null&&z.toDate?G.lastUpdatedAt.toDate():new Date(0);(ie-Z)/(1e3*60*60*24)>se&&re.push(G.id)}}),re.length>0){const G=await W8(r,re,"Closed");G.success?n(`Successfully auto-closed ${re.length} inactive ticket(s).`,"success"):n(`Failed to auto-close tickets: ${G.error}`,"error")}},[r,n]),P=X.useCallback(async()=>{l(!0);const[K,ee]=await Promise.all([tA(r),i0(r)]);if(K.success){if(s(K.data),ee.success&&ee.data&&(await U(K.data,ee.data),K.data.some(se=>se.status==="Resolved"))){const se=await tA(r);se.success&&s(se.data)}}else n(K.error||"Failed to fetch support tickets.","error"),s([]);l(!1)},[r,n,U]);X.useEffect(()=>{P()},[P]);const k=K=>{f(K)},F=()=>{f(null)},O=K=>{s(ee=>ee.map(se=>se.id===K.id?K:se))},C=async()=>{if(!m)return;v(!0);const K=await v9(r,m.id);K.success?(n("Support ticket deleted successfully.","success"),P()):n(K.error||"Failed to delete ticket.","error"),v(!1),p(null)},M=K=>{switch(K){case"Open":return"bg-red-100 text-red-700";case"In Progress":return"bg-yellow-100 text-yellow-700";case"On Hold":return"bg-gray-200 text-gray-700";case"Awaiting Customer":return"bg-blue-100 text-blue-700";case"Resolved":return"bg-green-100 text-green-700";case"Closed":return"bg-purple-100 text-purple-700";default:return"bg-gray-100 text-gray-600"}},D=i.filter(K=>{var G,z,Z,J,ae;const ee=N.toLowerCase(),se=N?((G=K.id)==null?void 0:G.toLowerCase().includes(ee))||((z=K.userName)==null?void 0:z.toLowerCase().includes(ee))||((Z=K.userEmail)==null?void 0:Z.toLowerCase().includes(ee))||((J=K.accountNumber)==null?void 0:J.toLowerCase().includes(ee))||((ae=K.description)==null?void 0:ae.toLowerCase().includes(ee)):!0,ie=E?K.status===E:!0,re=b?K.issueType===b:!0;return se&&ie&&re}),$=Array.from(new Set(i.map(K=>K.issueType))).sort();return o&&i.length===0?c.jsx(ln,{message:"Loading support tickets...",className:"mt-10 h-64"}):c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(Oa,{size:30,className:"mr-3 text-purple-600"})," Support Ticket Management"]}),c.jsxs("button",{onClick:P,className:"mt-3 sm:mt-0 text-sm flex items-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-3 rounded-lg border border-gray-300 transition-colors",disabled:o,title:"Refresh Ticket List",children:[o?c.jsx(Tt,{size:16,className:"animate-spin mr-1.5"}):c.jsx(qa,{size:16,className:"mr-1.5"}),"Refresh"]})]}),c.jsxs("div",{className:"mb-5 p-4 bg-gray-50 rounded-lg shadow-sm grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 items-end",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"searchTerm",className:"block text-xs font-medium text-gray-600 mb-1",children:"Search Tickets"}),c.jsx("input",{type:"text",id:"searchTerm",placeholder:"ID, Name, Email, Account#, Keyword...",value:N,onChange:K=>R(K.target.value),className:j})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"filterStatus",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Status"}),c.jsxs("select",{id:"filterStatus",value:E,onChange:K=>x(K.target.value),className:I,children:[c.jsx("option",{value:"",children:"All Statuses"}),["Open","In Progress","On Hold","Awaiting Customer","Resolved","Closed"].map(K=>c.jsx("option",{value:K,children:K},K))]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"filterIssueType",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Issue Type"}),c.jsxs("select",{id:"filterIssueType",value:b,onChange:K=>S(K.target.value),className:I,children:[c.jsx("option",{value:"",children:"All Issue Types"}),$.map(K=>c.jsx("option",{value:K,children:K},K))]})]})]}),!o&&D.length===0&&c.jsxs("div",{className:"text-center py-10",children:[c.jsx(yn,{size:48,className:"mx-auto text-gray-400 mb-3"}),c.jsx("p",{className:"text-gray-500 text-lg",children:i.length===0?"No support tickets found in the system.":"No tickets match your current filters."})]}),D.length>0&&c.jsx("div",{className:"overflow-x-auto shadow-md rounded-lg border border-gray-200",children:c.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ticket ID"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Submitted"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Issue Type"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Update"}),c.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:D.map(K=>c.jsxs("tr",{className:"hover:bg-gray-50/80 transition-colors duration-100",children:[c.jsxs("td",{className:"px-4 py-3 whitespace-nowrap font-mono text-xs text-gray-600",title:K.id,children:[K.id.substring(0,8),"..."]}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-500",children:Mt(K.submittedAt,{month:"short",day:"numeric",year:"2-digit"})}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-800 font-medium truncate max-w-[150px]",title:K.userName||K.userEmail,children:K.userName||K.userEmail}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-600 truncate max-w-[180px]",title:K.issueType,children:K.issueType}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:c.jsx("span",{className:`px-2.5 py-1 inline-flex text-xs leading-tight font-semibold rounded-full ${M(K.status)}`,children:K.status})}),c.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-500",children:Mt(K.lastUpdatedAt||K.lastUpdatedByAdmin||K.submittedAt,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),c.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-center space-x-2",children:[c.jsx("button",{onClick:()=>k(K),className:"text-indigo-600 hover:text-indigo-800 p-1.5 rounded-md hover:bg-indigo-50 transition-colors",title:"View & Manage Ticket",children:c.jsx(ja,{size:18})}),c.jsx("button",{onClick:()=>p(K),className:"text-red-600 hover:text-red-800 p-1.5 rounded-md hover:bg-red-50 transition-colors",title:"Delete Ticket",children:c.jsx(fh,{size:18})})]})]},K.id))})]})}),d&&t&&c.jsx(O$,{isOpen:!!d,onClose:F,ticket:d,db:r,appId:e,adminUserData:t,showNotification:n,onTicketUpdate:O}),m&&c.jsxs(Da,{isOpen:!!m,onClose:()=>p(null),onConfirm:C,title:"Confirm Ticket Deletion",confirmText:"Yes, Delete Ticket",isConfirming:g,iconType:"danger",children:[c.jsxs("p",{children:["Are you sure you want to permanently delete ticket ",c.jsxs("strong",{children:[m.id.substring(0,8),"..."]}),"?"]}),c.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"This action cannot be undone."})]})]})},w4="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",M$="flex items-center justify-center px-5 py-2.5 rounded-lg font-semibold text-sm transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95",uf=({field:r,settings:e,handleChange:t})=>{const n=r.icon;return c.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50/50",children:[c.jsxs("label",{className:`block text-sm font-medium text-gray-700 mb-1.5 ${r.type!=="checkbox"?"flex items-center":""}`,children:[n&&c.jsx(n,{size:16,className:"mr-2 text-gray-500"}),r.label]}),r.type==="textarea"?c.jsx("textarea",{name:r.name,rows:r.rows||3,value:e[r.name]||"",onChange:t,className:w4,placeholder:r.placeholder}):r.type==="checkbox"?c.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-2",children:[c.jsx("input",{type:"checkbox",name:r.name,checked:!!e[r.name],onChange:t,className:"h-5 w-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),c.jsx("span",{className:"text-sm text-gray-600 select-none",children:r.description||"Enable/Disable"})]}):c.jsx("input",{type:r.type,name:r.name,value:e[r.name]??"",onChange:t,className:w4,step:r.step||"0.01",placeholder:r.placeholder})]},r.name)},L$=({showNotification:r=console.log})=>{const[e,t]=X.useState({portalName:"AGWA Water Services, Inc.",portalAnnouncement:"",isBannerEnabled:!1,maintenanceMode:!1,sessionTimeoutMinutes:60,isSignupEnabled:!0,isGoogleLoginEnabled:!0,isPasswordlessLoginEnabled:!0,isOnlinePaymentsEnabled:!0,isChatbotEnabled:!0,isRebateProgramEnabled:!0,minimumChargeResidential:195.49,minimumChargeCommercial:888.4,minimumChargeResLowIncome:70.07,minimumChargeSemiBusiness:195.49,minimumChargeIndustrial:961.26,sewerageChargeResidential:0,billingCycleDay:1,latePaymentPenaltyPercentage:2,latePaymentPenaltyDelayDays:15,reconnectionFee:290,fcdaPercentage:1.29,environmentalChargePercentage:25,sewerageChargePercentageCommercial:32.85,governmentTaxPercentage:2,vatPercentage:12,seniorCitizenDiscountPercentage:5,pointsPerPeso:.01,earlyPaymentBonusPoints:10,earlyPaymentDaysThreshold:7,supportHotline:"1627-AGWA (24/7)",supportEmail:"support@agwa-waterservices.com.ph",adminEmailForNotifications:"admin@agwa.ph",autoCloseTicketsDays:14,defaultInterruptionMsg:"AGWA is conducting emergency maintenance. Water service may be temporarily unavailable in your area.",readingReminderDaysBefore:3}),[n,i]=X.useState(!0),[s,o]=X.useState(!1),[l,d]=X.useState(""),[f,m]=X.useState(null),[p,g]=X.useState(!1),v=X.useCallback(async()=>{i(!0),d("");const P=await i0(Yt);P.success&&P.data?t(k=>({...k,...P.data})):d("Could not load existing settings. Default values are shown. Click 'Save' to create the settings document."),i(!1)},[]);X.useEffect(()=>{v()},[v]);const E=P=>{const{name:k,value:F,type:O,checked:C}=P.target;t(M=>({...M,[k]:O==="checkbox"?C:O==="number"&&F!==""?parseFloat(F):F}))},x=async P=>{P.preventDefault(),o(!0),d("");const k={...e};for(const O in k)typeof k[O]=="string"&&!isNaN(parseFloat(k[O]))&&O!=="supportHotline"&&O!=="portalAnnouncement"&&O!=="supportEmail"&&O!=="defaultInterruptionMsg"&&O!=="portalName"&&O!=="adminEmailForNotifications"&&(k[O]===""?k[O]=0:k[O]=parseFloat(k[O]));const F=await E9(Yt,k);F.success?(r("System settings updated successfully!","success"),t(k)):(d(F.error||"Failed to save system settings."),r(F.error||"Failed to save system settings.","error")),o(!1)},b=async()=>{if(!f)return;g(!0);let P,k=f;try{switch(k){case"tickets":P=await K8(Yt);break;case"bills":P=await Y8(Yt);break;case"readings":P=await Z8(Yt);break;case"announcements":P=await Q8(Yt);break;case"interruptions":P=await X8(Yt);break;case"routes":P=await J8(Yt);break;case"rebatePoints":P=await e9(Yt);break;case"users":P=await t9(Yt);break;default:P={success:!1,error:"Unknown data type."}}P.success?r(`Successfully deleted ${P.count} ${k}.`,"success"):r(P.error||`Failed to delete ${k}.`,"error")}catch(F){r(F.message||`An error occurred deleting ${k}.`,"error")}g(!1),m(null)},S=[{name:"portalName",label:"Portal Name",type:"text",icon:Fx,placeholder:"AGWA Water Services, Inc."},{name:"sessionTimeoutMinutes",label:"Session Timeout (Minutes)",type:"number",icon:hi,step:"1",placeholder:"60"},{name:"maintenanceMode",label:"Enable Portal Maintenance Mode",type:"checkbox",icon:Zt,description:"If enabled, only Admins can log in."},{name:"portalAnnouncement",label:"Portal-Wide Announcement Banner Text",type:"textarea",icon:Rd,rows:2},{name:"isBannerEnabled",label:"Enable Announcement Banner",type:"checkbox",icon:Rd}],N=[{name:"isSignupEnabled",label:"Enable New User Sign-ups",type:"checkbox",icon:Xv},{name:"isGoogleLoginEnabled",label:"Enable Sign-in with Google",type:"checkbox",icon:Xv},{name:"isPasswordlessLoginEnabled",label:"Enable Passwordless (Email Link) Sign-in",type:"checkbox",icon:Xv},{name:"isOnlinePaymentsEnabled",label:"Enable Online Payments",type:"checkbox",icon:o0},{name:"isChatbotEnabled",label:"Enable Chatbot",type:"checkbox",icon:Oa},{name:"isRebateProgramEnabled",label:"Enable Rebate Program",type:"checkbox",icon:bu,description:"Enable customer rewards."}],R=[{name:"minimumChargeResidential",label:"Min. Charge Residential (PHP)",type:"number",icon:Vl,placeholder:"195.49"},{name:"minimumChargeResLowIncome",label:"Min. Charge Res. Low-Income (PHP)",type:"number",icon:Vl,placeholder:"70.07"},{name:"minimumChargeSemiBusiness",label:"Min. Charge Semi-Business (PHP)",type:"number",icon:Vl,placeholder:"195.49"},{name:"minimumChargeCommercial",label:"Min. Charge Commercial (PHP)",type:"number",icon:Vl,placeholder:"888.40"},{name:"minimumChargeIndustrial",label:"Min. Charge Industrial (PHP)",type:"number",icon:Vl,placeholder:"961.26"},{name:"billingCycleDay",label:"Billing Cycle Day (e.g., 1)",type:"number",icon:Vx,step:"1",placeholder:"1"},{name:"latePaymentPenaltyDelayDays",label:"Late Payment Grace Period (Days)",type:"number",icon:hi,step:"1",placeholder:"15"},{name:"latePaymentPenaltyPercentage",label:"Late Payment Penalty (%)",type:"number",icon:_a,placeholder:"2.0"},{name:"reconnectionFee",label:"Reconnection Fee (PHP)",type:"number",icon:dy,placeholder:"290.00"},{name:"fcdaPercentage",label:"FCDA (%)",type:"number",icon:_a,placeholder:"1.29"},{name:"environmentalChargePercentage",label:"Environmental Charge (%)",type:"number",icon:iA,placeholder:"25.0"},{name:"sewerageChargeResidential",label:"Sewerage Charge (Res. %)",type:"number",icon:_a,placeholder:"0"},{name:"sewerageChargePercentageCommercial",label:"Sewerage Charge (Comm. %)",type:"number",icon:_a,placeholder:"32.85"},{name:"governmentTaxPercentage",label:"Government Taxes (%)",type:"number",icon:_a,placeholder:"2.0"},{name:"vatPercentage",label:"VAT (%)",type:"number",icon:_a,placeholder:"12.0"},{name:"seniorCitizenDiscountPercentage",label:"Senior/PWD Discount (%)",type:"number",icon:_a,placeholder:"5.0"}],I=[{name:"pointsPerPeso",label:"Points Awarded per 1.00 Paid",type:"number",icon:Lf,placeholder:"e.g., 0.01",step:"0.001"},{name:"earlyPaymentBonusPoints",label:"Early Payment Bonus (Points)",type:"number",icon:Lf,placeholder:"e.g., 10",step:"1"},{name:"earlyPaymentDaysThreshold",label:"Early Payment Threshold (Days)",type:"number",icon:Vx,placeholder:"e.g., 7",step:"1"}],j=[{name:"supportHotline",label:"Support Hotline Number",type:"text",icon:dF,placeholder:"e.g., 1627-AGWA"},{name:"supportEmail",label:"Support Email Address",type:"email",icon:rA,placeholder:"e.g., support@agos.com"},{name:"adminEmailForNotifications",label:"Admin Email (for system alerts)",type:"email",icon:rA,placeholder:"e.g., admin@agos.com"},{name:"autoCloseTicketsDays",label:"Auto-close Resolved Tickets After (Days)",type:"number",icon:hi,step:"1",placeholder:"14"},{name:"readingReminderDaysBefore",label:"Reading Reminder (Days Before)",type:"number",icon:hi,step:"1",placeholder:"3"},{name:"defaultInterruptionMsg",label:"Default Interruption Message",type:"textarea",icon:Zt,rows:2,placeholder:"Service interruption ongoing..."}],U=[{label:"Clear All Support Tickets",action:"tickets",icon:Oa,isUser:!1},{label:"Clear All Bills",action:"bills",icon:Fx,isUser:!1},{label:"Clear All Meter Readings",action:"readings",icon:iA,isUser:!1},{label:"Clear All Announcements",action:"announcements",icon:Rd,isUser:!1},{label:"Clear All Interruptions",action:"interruptions",icon:Zt,isUser:!1},{label:"Clear All Meter Routes",action:"routes",icon:lc,isUser:!1},{label:"Clear All Rebate Points",action:"rebatePoints",icon:bu,isUser:!1},{label:"Clear All User Profiles",action:"users",icon:Ia,isUser:!0}];return n?c.jsx(ln,{message:"Loading system settings...",className:"mt-10 h-64"}):c.jsxs("form",{onSubmit:x,className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(c0,{size:30,className:"mr-3 text-gray-600"})," System Configuration"]}),c.jsxs("button",{type:"submit",className:`${M$} bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500 w-auto mt-4 sm:mt-0`,disabled:s||n,children:[s?c.jsx(Tt,{size:18,className:"animate-spin mr-2"}):c.jsx(Ha,{size:18,className:"mr-2"}),s?"Saving...":"Save All Settings"]})]}),l&&c.jsxs("div",{className:"mb-4 p-3 bg-yellow-100 border border-yellow-400 text-yellow-800 rounded-lg text-sm flex items-center",children:[c.jsx(Zt,{size:20,className:"mr-2"})," ",l]}),c.jsxs("div",{className:"space-y-8",children:[c.jsxs("section",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"General & Maintenance"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:S.map(P=>c.jsx(uf,{field:P,settings:e,handleChange:E},P.name))})]}),c.jsxs("section",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"Portal Features & Authentication"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:N.map(P=>c.jsx(uf,{field:P,settings:e,handleChange:E},P.name))})]}),c.jsxs("section",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"Billing & Financial"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:R.map(P=>c.jsx(uf,{field:P,settings:e,handleChange:E},P.name))})]}),c.jsxs("section",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"Rewards Program"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:I.map(P=>c.jsx(uf,{field:P,settings:e,handleChange:E},P.name))})]}),c.jsxs("section",{children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"Communication & Support"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:j.map(P=>c.jsx(uf,{field:P,settings:e,handleChange:E},P.name))})]})]}),c.jsxs("div",{className:"mt-12 pt-6 border-t-2 border-red-300",children:[c.jsxs("h3",{className:"text-xl font-bold text-red-700 flex items-center",children:[c.jsx(Zt,{size:24,className:"mr-2"})," Danger Zone"]}),c.jsx("p",{className:"text-sm text-gray-600 mt-1 mb-4",children:"These actions are destructive and cannot be undone. This will permanently delete data from the database, effectively resetting parts of your system."}),c.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:U.map(P=>{const k=P.icon,F=P.isUser?"This is the most destructive action and will force all users to sign up again.":`Permanently delete all ${P.action} from the database.`;return c.jsxs("button",{type:"button",onClick:()=>m(P.action),className:`p-4 border rounded-lg transition-colors text-left ${P.isUser?"border-red-300 bg-red-100 hover:bg-red-200 hover:border-red-500":"border-red-200 bg-red-50 hover:bg-red-100 hover:border-red-400"}`,children:[c.jsxs("p",{className:`font-semibold flex items-center ${P.isUser?"text-red-900":"text-red-800"}`,children:[c.jsx(k,{size:16,className:"mr-2"}),P.label]}),c.jsx("p",{className:`text-xs mt-1 ${P.isUser?"text-red-700":"text-red-600"}`,children:F})]},P.action)})})]}),f&&c.jsx(Da,{isOpen:!!f,onClose:()=>m(null),onConfirm:b,title:`Confirm Deletion of All ${f.charAt(0).toUpperCase()+f.slice(1)}`,confirmText:`Yes, delete all ${f}`,isConfirming:p,iconType:"danger",children:c.jsxs("p",{children:["Are you absolutely sure you want to proceed? All ",c.jsx("strong",{children:f})," data will be permanently erased. This action cannot be undone."]})})]})},F$=({initialData:r=null,onSubmit:e,onCancel:t,isSaving:n,showNotification:i})=>{const[s,o]=X.useState(""),[l,d]=X.useState(""),[f,m]=X.useState("info"),[p,g]=X.useState("active"),[v,E]=X.useState(""),[x,b]=X.useState(""),[S,N]=X.useState(["all"]),[R,I]=X.useState(""),[j,U]=X.useState(!1),[P,k]=X.useState("");X.useEffect(()=>{var $,K;if(r)o(r.title||""),d(r.content||""),m(r.type||"info"),g(r.status||"active"),E(($=r.startDate)!=null&&$.toDate?r.startDate.toDate().toISOString().split("T")[0]:""),b((K=r.endDate)!=null&&K.toDate?r.endDate.toDate().toISOString().split("T")[0]:""),N(r.targetRoles||["all"]);else{const ee=new Date().toISOString().split("T")[0];E(ee),g("active"),o(""),d(""),m("info"),b(""),N(["all"]),I("")}},[r]);const F=$=>{d($),P&&$.replace(/<[^>]*>?/gm,"").trim()&&k("")},O=async()=>{const $=l.replace(/<[^>]*>?/gm,"").trim();if(R.trim()){U(!0);try{const K=await CF({title:s||R,reason:R,area:"",time:""});d(K),!s.trim()&&R.trim()&&o(R.trim()),i("AI generated a new draft!","success")}catch(K){const ee=(K==null?void 0:K.message)||"AI generation failed.";i(ee,"error")}finally{U(!1)}}else if($){U(!0);try{const ee=[{role:"user",content:`Refine this announcement draft for AGWA Water Services. Make it clear, professional, concise, using simple HTML (<p>, <strong>, <ul>, <li>). Announcement Type: ${f}. Title: "${s}". Original Content (may contain HTML): "${l}". Respond only with the refined HTML content.`}],se=await Vo(ee);d(se),i("AI has refined your content!","success")}catch(K){const ee=(K==null?void 0:K.message)||"AI assistance failed.";i(ee,"error")}finally{U(!1)}}else i("Please provide a prompt or write some content for the AI to assist with.","warning")},C=$=>{$.preventDefault(),k("");const K=l.replace(/<[^>]*>?/gm,"").trim();if(!s.trim()||!K||!v){k("Title, Content, and Start Date are required.");return}if(x&&new Date(x)<new Date(v)){k("End date cannot be before start date.");return}const ee=uo.sanitize(l),se={title:s.trim(),content:ee,type:f,status:p,startDate:new Date(v),endDate:x?new Date(x):null,targetRoles:S.length===0||S.includes("all")?["all"]:S};e(se)},M="w-full px-4 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 focus:outline-none transition duration-200 text-gray-900",D="flex items-center justify-center px-4 py-2.5 rounded-lg font-semibold transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95";return c.jsx("div",{className:"p-1",children:c.jsxs("form",{onSubmit:C,className:"space-y-6",id:"announcementForm",children:[P&&c.jsxs("div",{className:"p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg text-sm flex items-center",children:[c.jsx(G9,{size:20,className:"mr-2"})," ",P]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"announcementTitle",className:"block text-sm font-medium text-gray-700 mb-1",children:[c.jsx(f3,{size:16,className:"inline mr-1.5"}),"Title *"]}),c.jsx("input",{type:"text",id:"announcementTitle",value:s,onChange:$=>o($.target.value),className:M,placeholder:"E.g., Scheduled Maintenance in Poblacion",required:!0})]}),c.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg space-y-3",children:[c.jsxs("label",{htmlFor:"aiPrompt",className:"block text-sm font-medium text-blue-800",children:[c.jsx(Ds,{size:16,className:"inline mr-1.5"}),"AI Assistant"]}),c.jsx("input",{type:"text",id:"aiPrompt",value:R,onChange:$=>I($.target.value),className:M,placeholder:"Type a prompt to generate new content (e.g., 'Emergency repair in Muzon')"}),c.jsxs("button",{type:"button",onClick:O,className:`${D} text-sm bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-300 py-2 px-4`,disabled:j||n,children:[j?c.jsx(Tt,{size:16,className:"animate-spin mr-1.5"}):c.jsx(Ds,{size:16,className:"mr-1.5"}),R.trim()?"Generate Content":"Refine Existing Content"]}),c.jsx("p",{className:"text-xs text-gray-500",children:"If the prompt is filled, AI will generate new content. If the prompt is empty and the editor has content, AI will refine it."})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Content *"}),c.jsx(w0,{value:l,onChange:F,placeholder:"Describe the announcement, or use the AI Assistant above to generate content.",className:"bg-white rounded-lg border border-gray-300 min-h-[250px]"}),P&&!l.replace(/<[^>]*>?/gm,"").trim()&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:"Content is required."})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"announcementType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),c.jsxs("select",{id:"announcementType",value:f,onChange:$=>m($.target.value),className:M,children:[c.jsx("option",{value:"info",children:"Info"}),c.jsx("option",{value:"warning",children:"Warning"}),c.jsx("option",{value:"critical",children:"Critical"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),c.jsxs("button",{type:"button",onClick:()=>g(p==="active"?"archived":"active"),className:`${D} w-full ${p==="active"?"bg-green-500 hover:bg-green-600 text-white focus:ring-green-400":"bg-gray-200 hover:bg-gray-300 text-gray-700 focus:ring-gray-300"}`,children:[p==="active"?c.jsx(d3,{size:18,className:"mr-2"}):c.jsx(mF,{size:18,className:"mr-2"}),p==="active"?"Active":"Archived"]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700 mb-1",children:[c.jsx(xu,{size:16,className:"inline mr-1.5"}),"Start Date *"]}),c.jsx("input",{type:"date",id:"startDate",value:v,onChange:$=>E($.target.value),className:M,required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700 mb-1",children:[c.jsx(xu,{size:16,className:"inline mr-1.5"}),"End Date (Optional)"]}),c.jsx("input",{type:"date",id:"endDate",value:x,onChange:$=>b($.target.value),className:M,min:v})]})]}),c.jsxs("div",{className:"pt-6 border-t mt-6 flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-4",children:[c.jsx("button",{type:"button",onClick:t,className:`${D} bg-gray-100 hover:bg-gray-200 text-gray-700 border border-gray-300 focus:ring-gray-300 w-full sm:w-auto order-2 sm:order-1`,disabled:n||j,children:"Cancel"}),c.jsxs("button",{type:"submit",form:"announcementForm",className:`${D} bg-green-600 hover:bg-green-700 text-white focus:ring-green-500 w-full sm:w-auto order-1 sm:order-2`,disabled:n||j||!s.trim()||!l.replace(/<[^>]*>?/gm,"").trim(),children:[n?c.jsx(Tt,{size:20,className:"animate-spin mr-2"}):c.jsx(Ha,{size:20,className:"mr-2"}),n?"Saving...":r?"Update Announcement":"Create Announcement"]})]})]})})},V$=({announcements:r,onEdit:e,onDelete:t,onToggleStatus:n,actionLoadingId:i,viewOnly:s=!1})=>{const o=l=>{if(!l)return"N/A";let d;try{if(l.toDate&&typeof l.toDate=="function")d=l.toDate();else if(l instanceof Date)d=l;else if(typeof l=="string"||typeof l=="number")d=new Date(l);else return"Invalid Date";return isNaN(d.getTime())?"Invalid Date":d.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Invalid Date"}};return!r||r.length===0?c.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner border border-gray-200",children:[c.jsx(yn,{size:48,className:"mx-auto text-gray-400 mb-4"}),c.jsx("p",{className:"text-gray-600 text-lg",children:"No announcements found."}),!s&&c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Create one using the 'New Announcement' button."})]}):c.jsx("div",{className:"space-y-4",children:r.map(l=>{var f,m;const d=uo.sanitize(l.content||"");return c.jsxs("div",{className:`p-4 rounded-lg shadow-md border-l-4 transition-opacity ${l.status==="active"?"border-green-500 bg-white hover:shadow-lg":"border-gray-400 bg-gray-50 opacity-80 hover:opacity-100 hover:shadow-md"}`,children:[c.jsxs("div",{className:"flex justify-between items-start gap-3",children:[c.jsxs("div",{className:"flex-grow pr-4",children:[c.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:l.title}),c.jsxs("div",{className:"flex items-center flex-wrap gap-2 text-xs mt-1",children:[c.jsx("span",{className:`px-2 py-0.5 font-semibold uppercase tracking-wider rounded-full ${l.status==="active"?"bg-green-100 text-green-800":"bg-gray-200 text-gray-600"}`,children:l.status}),c.jsx("span",{className:`px-2 py-0.5 font-semibold uppercase tracking-wider rounded-full ${l.type==="critical"?"bg-red-100 text-red-800":l.type==="warning"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:l.type}),c.jsxs("span",{className:"text-gray-400 font-mono flex items-center",children:[c.jsx(js,{size:12,className:"mr-0.5"}),l.id.substring(0,8),"..."]})]})]}),!s&&c.jsx("div",{className:"flex space-x-2 items-center flex-shrink-0",children:i===l.id?c.jsx(Tt,{className:"animate-spin text-gray-500"}):c.jsxs(c.Fragment,{children:[n&&c.jsx("button",{onClick:()=>n(l),className:`p-1.5 rounded-md hover:bg-opacity-20 transition-colors ${l.status==="active"?"text-yellow-600 hover:bg-yellow-100":"text-green-600 hover:bg-green-100"}`,title:l.status==="active"?"Archive":"Activate",children:l.status==="active"?c.jsx(uy,{size:18}):c.jsx(ja,{size:18})}),e&&c.jsx("button",{onClick:()=>e(l),className:"text-blue-600 hover:text-blue-800 p-1.5 rounded-md hover:bg-blue-100 transition-colors",title:"Edit",children:c.jsx(uF,{size:18})}),t&&c.jsx("button",{onClick:()=>t(l.id),className:"text-red-600 hover:text-red-800 p-1.5 rounded-md hover:bg-red-100 transition-colors",title:"Delete",children:c.jsx(fh,{size:18})})]})})]}),c.jsx("div",{className:"prose prose-sm max-w-none text-gray-700 mt-3 pt-3 border-t border-gray-200/80 leading-relaxed",dangerouslySetInnerHTML:{__html:d}}),c.jsxs("div",{className:"text-xs text-gray-500 mt-3 pt-2 border-t border-gray-200/80",children:[c.jsxs("p",{children:["Author: ",l.authorName||"Admin"]}),c.jsxs("p",{children:["Created: ",o(l.createdAt)]}),l.updatedAt&&((f=l.updatedAt)==null?void 0:f.seconds)!==((m=l.createdAt)==null?void 0:m.seconds)&&c.jsxs("p",{children:["Updated: ",o(l.updatedAt)]}),c.jsxs("p",{children:["Display: ",o(l.startDate)," to ",l.endDate?o(l.endDate):"Ongoing"]})]})]},l.id)})})},E4=({db:r,userData:e,showNotification:t,viewOnly:n=!1})=>{const[i,s]=X.useState([]),[o,l]=X.useState(!0),[d,f]=X.useState(!1),[m,p]=X.useState(null),[g,v]=X.useState(!1),[E,x]=X.useState(null),[b,S]=X.useState(!1),[N,R]=X.useState(null),I=X.useCallback(async()=>{l(!0);try{const C=await b9(r,n);if(C.success)s(C.data||[]);else throw new Error(C.error)}catch{t("Failed to load announcements.","error")}finally{l(!1)}},[r,t,n]);X.useEffect(()=>{I()},[I]);const j=()=>{p(null),f(!0)},U=C=>{p(C),f(!0)},P=async C=>{v(!0);const D=await(m?nA(r,m.id,{...C,updatedBy:e.uid}):x9(r,{...C,createdBy:e.uid,authorName:e.displayName}));D.success?(t(`Announcement ${m?"updated":"created"} successfully!`,"success"),I(),f(!1)):t(`Failed to save announcement: ${D.error}`,"error"),v(!1)},k=C=>{R(C),S(!0)},F=async()=>{if(!N)return;x(N);const C=await w9(r,N);C.success?(t("Announcement deleted successfully!","success"),I()):t(`Failed to delete announcement: ${C.error}`,"error"),S(!1),R(null),x(null)},O=async C=>{x(C.id);const M=C.status==="active"?"archived":"active",D=await nA(r,C.id,{status:M,updatedBy:e.uid});D.success?(t(`Announcement status changed to ${M}.`,"success"),I()):t("Failed to update status: "+D.error,"error"),x(null)};return c.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-xl",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[c.jsx("h3",{className:"text-2xl font-semibold",children:n?"Company Announcements":"Manage Announcements"}),!n&&c.jsxs("button",{onClick:j,className:"bg-blue-600 text-white font-medium py-2 px-4 rounded-lg flex items-center",children:[c.jsx(s0,{size:18,className:"mr-2"})," New Announcement"]})]}),o?c.jsx(ln,{message:"Loading Announcements..."}):c.jsx(V$,{announcements:i,onEdit:n?void 0:U,onDelete:n?void 0:k,onToggleStatus:n?void 0:O,actionLoadingId:E,viewOnly:n}),!n&&d&&c.jsx(Vr,{isOpen:d,onClose:()=>f(!1),title:m?"Edit Announcement":"Create Announcement",size:"full",children:c.jsx(F$,{initialData:m,onSubmit:P,onCancel:()=>f(!1),isSaving:g,showNotification:t})}),!n&&b&&c.jsx(Da,{isOpen:b,onClose:()=>S(!1),onConfirm:F,title:"Confirm Deletion",isConfirming:!!E,children:"Are you sure you want to delete this announcement? This action cannot be undone."})]})},B$=({initialData:r=null,onSubmit:e,onCancel:t,isSaving:n,showNotification:i})=>{const[s,o]=X.useState(""),[l,d]=X.useState(""),[f,m]=X.useState("Maintenance"),[p,g]=X.useState("Scheduled"),[v,E]=X.useState(""),[x,b]=X.useState("08:00"),[S,N]=X.useState(""),[R,I]=X.useState("17:00"),[j,U]=X.useState([]),[P,k]=X.useState(!1),[F,O]=X.useState(""),[C,M]=X.useState({}),[D,$]=X.useState([]);X.useEffect(()=>{const ae=p0(),le=[],Q=ae.reduce((ce,ue)=>{const fe=eh(ue).sort();return ce[ue]=fe,le.push(...fe),ce},{});M(Q),$(le.sort())},[]),X.useEffect(()=>{var ae,le;if(r){o(r.title||""),d(r.description||""),m(r.type||"Maintenance"),g(r.status||"Scheduled"),U(r.affectedAreas||[]),k(r.isBillingPaused||!1);const Q=(ae=r.startDate)!=null&&ae.toDate?r.startDate.toDate():null,ce=(le=r.estimatedEndDate)!=null&&le.toDate?r.estimatedEndDate.toDate():null;E(Q?Q.toISOString().split("T")[0]:""),b(Q?`${String(Q.getHours()).padStart(2,"0")}:${String(Q.getMinutes()).padStart(2,"0")}`:"08:00"),N(ce?ce.toISOString().split("T")[0]:""),I(ce?`${String(ce.getHours()).padStart(2,"0")}:${String(ce.getMinutes()).padStart(2,"0")}`:"17:00")}else{const ce=new Date().toISOString().split("T")[0];o(""),d(""),m("Maintenance"),g("Scheduled"),E(ce),b("08:00"),N(ce),I("17:00"),U([]),k(!1)}},[r]);const K=ae=>{d(ae),F&&ae.replace(/<[^>]*>?/gm,"").trim()&&O("")},ee=ae=>{U(le=>le.includes(ae)?le.filter(Q=>Q!==ae):[...le,ae]),F&&j.length>0&&O("")},se=()=>{j.length===D.length?U([]):(U([...D]),F&&O(""))},ie=(ae,le)=>{const Q=le.every(ce=>j.includes(ce));U(Q?ce=>ce.filter(ue=>!le.includes(ue)):ce=>[...new Set([...ce,...le])])},re=ae=>{ae.preventDefault(),O("");const le=l.replace(/<[^>]*>?/gm,"").trim();if(!s.trim()||!le||!v||!x||j.length===0){O("Title, Description, Affected Area(s), Start Date/Time are required.");return}const Q=new Date(`${v}T${x}`);if(isNaN(Q)){O("Invalid Start Date or Time.");return}let ce=null;if(S&&R){if(ce=new Date(`${S}T${R}`),isNaN(ce)){O("Invalid Estimated End Date or Time.");return}if(ce<=Q){O("Estimated End must be after Start.");return}}const ue=uo.sanitize(l),fe={title:s.trim(),description:ue,type:f,status:p,startDate:Q,estimatedEndDate:ce,affectedAreas:j.sort(),isBillingPaused:P};e(fe)},G="w-full px-4 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm text-gray-900",z="flex items-center justify-center px-4 py-2.5 rounded-lg font-semibold transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95 text-sm",Z=["Maintenance","Emergency Repair","System Upgrade","Leak Detection","Other"],J=["Scheduled","Ongoing","Resolved"];return c.jsxs("form",{onSubmit:re,className:"space-y-6 p-1",children:[F&&c.jsxs("div",{className:"p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg text-sm flex items-center",children:[c.jsx(Zt,{size:20,className:"mr-2"})," ",F]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"interruptionTitle",className:"block text-sm font-medium text-gray-700 mb-1",children:[c.jsx(f3,{size:16,className:"inline mr-1.5"}),"Title *"]}),c.jsx("input",{type:"text",id:"interruptionTitle",value:s,onChange:ae=>o(ae.target.value),className:G,placeholder:"E.g., Water Interruption in Brgy. Muzon",required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),c.jsx(w0,{value:l,onChange:K,placeholder:"Provide details...",className:"bg-white rounded-lg border border-gray-300 min-h-[150px]"}),F&&!l.replace(/<[^>]*>?/gm,"").trim()&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:"Description is required."})]}),c.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50 max-h-72 overflow-y-auto scrollbar-thin",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2 sticky top-0 bg-gray-50 py-1 -mt-1 border-b border-gray-200",children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[c.jsx(co,{size:16,className:"inline mr-1.5"}),"Affected Area(s) *"]}),c.jsx("button",{type:"button",onClick:se,className:"text-xs font-medium text-blue-600 hover:underline",children:j.length===D.length?"Deselect All":`Select All (${D.length})`})]}),c.jsx("div",{className:"space-y-2",children:Object.entries(C).map(([ae,le])=>c.jsxs("details",{className:"group bg-white border rounded-md",children:[c.jsxs("summary",{className:"flex justify-between items-center p-2 cursor-pointer list-none",children:[c.jsx("span",{className:"font-semibold text-sm text-blue-700",children:ae}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("button",{type:"button",onClick:Q=>{Q.preventDefault(),ie(ae,le)},className:"text-xs text-blue-600 hover:underline mr-2",children:"Toggle District"}),c.jsx(R2,{size:18,className:"text-gray-500 group-open:rotate-180 transition-transform"})]})]}),c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 p-3 border-t border-gray-100",children:le.map(Q=>c.jsxs("label",{className:"flex items-center space-x-2 p-1.5 rounded bg-gray-50 border border-gray-200 hover:bg-blue-50 cursor-pointer text-xs has-[:checked]:bg-blue-100 has-[:checked]:border-blue-300",children:[c.jsx("input",{type:"checkbox",checked:j.includes(Q),onChange:()=>ee(Q),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 shrink-0"}),c.jsx("span",{className:"truncate",title:Q,children:Q})]},Q))})]},ae))}),F&&j.length===0&&c.jsx("p",{className:"text-red-500 text-xs mt-2",children:"Select at least one area."})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"interruptionType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Type *"}),c.jsx("select",{id:"interruptionType",value:f,onChange:ae=>m(ae.target.value),className:G,required:!0,children:Z.map(ae=>c.jsx("option",{value:ae,children:ae},ae))})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"interruptionStatus",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status *"}),c.jsx("select",{id:"interruptionStatus",value:p,onChange:ae=>g(ae.target.value),className:G,required:!0,children:J.map(ae=>c.jsx("option",{value:ae,children:ae},ae))})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),c.jsxs("label",{className:"flex items-center space-x-2 p-2.5 rounded-lg bg-yellow-50 border border-yellow-200 cursor-pointer hover:bg-yellow-100",children:[c.jsx("input",{type:"checkbox",checked:P,onChange:ae=>k(ae.target.checked),className:"h-4 w-4 text-yellow-600 border-gray-300 rounded focus:ring-yellow-500"}),c.jsxs("span",{className:"text-sm font-medium text-yellow-800 flex items-center",children:[c.jsx(K9,{size:16,className:"mr-1.5"})," Pause Billing"]})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[c.jsx(xu,{size:16,className:"inline mr-1.5"}),"Start Date & Time *"]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"date",id:"startDate",value:v,onChange:ae=>E(ae.target.value),className:G,required:!0}),c.jsx("input",{type:"time",id:"startTime",value:x,onChange:ae=>b(ae.target.value),className:G,required:!0})]})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[c.jsx(hi,{size:16,className:"inline mr-1.5"}),"Estimated End Date & Time"]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("input",{type:"date",id:"estimatedEndDate",value:S,onChange:ae=>N(ae.target.value),className:G,min:v}),c.jsx("input",{type:"time",id:"estimatedEndTime",value:R,onChange:ae=>I(ae.target.value),className:G})]}),F.includes("End Date/Time")&&c.jsx("p",{className:"text-red-500 text-xs mt-1",children:F})]})]}),c.jsxs("div",{className:"pt-6 border-t mt-6 flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-4",children:[c.jsx("button",{type:"button",onClick:t,className:`${z} bg-gray-100 hover:bg-gray-200 text-gray-700 border border-gray-300 focus:ring-gray-300 w-full sm:w-auto order-2 sm:order-1`,disabled:n,children:"Cancel"}),c.jsxs("button",{type:"submit",className:`${z} bg-green-600 hover:bg-green-700 text-white focus:ring-green-500 w-full sm:w-auto order-1 sm:order-2`,disabled:n,children:[n?c.jsx(Tt,{size:20,className:"animate-spin mr-2"}):c.jsx(Ha,{size:20,className:"mr-2"}),n?"Saving...":r?"Update Advisory":"Create Advisory"]})]}),c.jsx("style",{children:`
                .scrollbar-thin { scrollbar-width: thin; scrollbar-color: #9ca3af #f3f4f6; }
                .scrollbar-thin::-webkit-scrollbar { width: 6px; height: 6px;}
                .scrollbar-thin::-webkit-scrollbar-track { background: #f3f4f6; border-radius:3px; }
                .scrollbar-thin::-webkit-scrollbar-thumb { background-color: #9ca3af; border-radius: 3px; border: 1px solid #f3f4f6;}
                .scrollbar-thin::-webkit-scrollbar-thumb:hover { background-color: #6b7280; }
             `})]})},z$=({db:r,userData:e,showNotification:t})=>{const[n,i]=X.useState([]),[s,o]=X.useState(!0),[l,d]=X.useState(!1),[f,m]=X.useState(null),[p,g]=X.useState(!1),[v,E]=X.useState(null),[x,b]=X.useState(!1),[S,N]=X.useState(null),R=X.useCallback(async()=>{o(!0);try{const O=await O9(r);if(O.success)i(O.data||[]);else throw new Error(O.error)}catch(O){t(O.message||"Failed to load interruptions.","error")}finally{o(!1)}},[r,t]);X.useEffect(()=>{R()},[R]);const I=()=>{m(null),d(!0)},j=O=>{m(O),d(!0)},U=async O=>{g(!0);const M=await(f?R9(r,f.id,O):C9(r,O));M.success?(t(`Advisory ${f?"updated":"created"} successfully!`,"success"),R(),d(!1)):t(M.error||"Failed to save advisory.","error"),g(!1)},P=O=>{N(O),b(!0)},k=async()=>{if(!S)return;E(S.id);const O=await j9(r,S.id);O.success?(t("Advisory deleted successfully!","success"),R()):t(O.error||"Failed to delete advisory.","error"),b(!1),N(null),E(null)},F=(O,C)=>{if((C==="Emergency Repair"||C==="Leak Detection")&&O!=="Resolved")return{icon:g3,color:"text-red-700",bgColor:"bg-red-100",label:"Emergency"};switch(O){case"Ongoing":return{icon:Zt,color:"text-orange-600",bgColor:"bg-orange-100",label:"Ongoing"};case"Scheduled":return{icon:hi,color:"text-blue-600",bgColor:"bg-blue-100",label:"Scheduled"};case"Resolved":return{icon:Cs,color:"text-green-600",bgColor:"bg-green-100",label:"Resolved"};default:return{icon:yn,color:"text-gray-500",bgColor:"bg-gray-100",label:O||"Unknown"}}};return c.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-xl",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[c.jsxs("h3",{className:"text-2xl font-semibold flex items-center",children:[c.jsx(Zt,{className:"mr-3 text-orange-500"})," Manage Service Advisories"]}),c.jsxs("button",{onClick:I,className:"bg-blue-600 text-white font-medium py-2 px-4 rounded-lg flex items-center text-sm",children:[c.jsx(s0,{size:16,className:"mr-2"})," New Advisory"]})]}),s?c.jsx(ln,{message:"Loading Advisories..."}):c.jsxs("div",{className:"space-y-3",children:[n.length===0&&c.jsxs("div",{className:"text-center py-10 bg-gray-50 rounded-lg",children:[c.jsx(yn,{size:32,className:"mx-auto text-gray-400 mb-2"}),c.jsx("p",{className:"text-gray-500",children:"No advisories found."})]}),n.map(O=>{var D,$,K;const C=F(O.status,O.type),M=C.icon;return c.jsxs("div",{className:`p-4 rounded-lg shadow border-l-4 flex justify-between items-start gap-4 ${C.bgColor.replace("bg-","border-")}`,children:[c.jsxs("div",{className:"flex-grow",children:[c.jsx("h4",{className:"font-semibold text-gray-800",children:O.title}),c.jsxs("div",{className:"text-xs text-gray-600 mt-1 space-y-0.5",children:[c.jsxs("p",{className:"flex items-center",children:[c.jsx(co,{size:12,className:"mr-1.5"})," Areas: ",(D=O.affectedAreas)==null?void 0:D.slice(0,3).join(", "),(($=O.affectedAreas)==null?void 0:$.length)>3?"...":""," (",((K=O.affectedAreas)==null?void 0:K.length)||0,")"]}),c.jsxs("p",{className:"flex items-center",children:[c.jsx(hi,{size:12,className:"mr-1.5"})," Start: ",Mt(O.startDate)]}),O.estimatedEndDate&&c.jsxs("p",{className:"flex items-center",children:[c.jsx(hi,{size:12,className:"mr-1.5"})," End: ",Mt(O.estimatedEndDate)]}),c.jsxs("p",{className:"text-gray-400",children:["ID: ",O.id.substring(0,8),"..."]})]})]}),c.jsxs("div",{className:"flex flex-col items-end gap-2 shrink-0",children:[c.jsxs("span",{className:`px-2 py-0.5 text-xs font-semibold rounded-full flex items-center ${C.bgColor} ${C.color}`,children:[c.jsx(M,{size:12,className:"mr-1"})," ",C.label]}),c.jsxs("div",{className:"flex space-x-1",children:[c.jsx("button",{onClick:()=>j(O),className:"p-1.5 text-blue-600 hover:bg-blue-100 rounded-md disabled:opacity-50",disabled:v===O.id,children:c.jsx(cm,{size:16})}),c.jsx("button",{onClick:()=>P(O),className:"p-1.5 text-red-600 hover:bg-red-100 rounded-md disabled:opacity-50",disabled:v===O.id,children:v===O.id?c.jsx(Tt,{className:"animate-spin",size:16}):c.jsx(fh,{size:16})})]})]})]},O.id)})]}),l&&c.jsx(Vr,{isOpen:l,onClose:()=>d(!1),title:f?"Edit Advisory":"Create New Advisory",size:"2xl",children:c.jsx(B$,{initialData:f,onSubmit:U,onCancel:()=>d(!1),isSaving:p,showNotification:t})}),x&&S&&c.jsxs(Da,{isOpen:x,onClose:()=>b(!1),onConfirm:k,title:"Confirm Deletion",isConfirming:!!v,confirmText:"Yes, Delete",iconType:"danger",children:['Delete advisory "',S.title,'"? This cannot be undone.']})]})};ju.register(_y,xy,Uf,wf,jg,Ad,sw,ow,iw);const xt={blue:"rgba(59, 130, 246, 0.6)",blueBorder:"rgba(59, 130, 246, 1)",green:"rgba(16, 185, 129, 0.6)",greenBorder:"rgba(16, 185, 129, 1)",purple:"rgba(139, 92, 246, 0.6)",purpleBorder:"rgba(139, 92, 246, 1)",red:"rgba(239, 68, 68, 0.6)",redBorder:"rgba(239, 68, 68, 1)",orange:"rgba(249, 115, 22, 0.6)",orangeBorder:"rgba(249, 115, 22, 1)",teal:"rgba(20, 184, 166, 0.6)",tealBorder:"rgba(20, 184, 166, 1)",sky:"rgba(14, 165, 233, 0.6)",skyBorder:"rgba(14, 165, 233, 1)",pink:"rgba(236, 72, 153, 0.6)",yellow:"rgba(234, 179, 8, 0.6)",gray:"rgba(107, 114, 128, 0.6)"},OR=r=>({responsive:!0,maintainAspectRatio:!1,animation:!1,plugins:{legend:{display:!0,position:"bottom"},title:{display:!0,text:r,font:{size:16},color:"#374151",padding:{bottom:15}},tooltip:{backgroundColor:"#1F2937",titleColor:"#E5E7EB",bodyColor:"#D1D5DB",borderColor:"#4B5563",borderWidth:1,padding:10,boxPadding:3}},scales:{y:{beginAtZero:!0,grid:{color:"#E5E7EB"},ticks:{color:"#6B7280"}},x:{grid:{display:!1},ticks:{color:"#6B7280"}}}}),cg=({data:r,title:e,label:t,color:n,borderColor:i})=>{if(!r||Object.keys(r).length===0)return c.jsxs("p",{className:"text-sm text-gray-500 text-center py-10",children:["No data available for ",e,"."]});const s={labels:Object.keys(r),datasets:[{label:t,data:Object.values(r),backgroundColor:n,borderColor:i,borderWidth:1,borderRadius:4}]};return c.jsx("div",{className:"h-72 w-full",children:c.jsx(bR,{options:OR(e),data:s})})},S4=({data:r,title:e,datasets:t})=>{if(!r||Array.isArray(r)&&r.length===0||typeof r=="object"&&Object.keys(r).length===0)return c.jsxs("p",{className:"text-sm text-gray-500 text-center py-10",children:["No data available for ",e,"."]});let n;return t?n={labels:Object.keys(r),datasets:t.map(i=>({...i,data:Object.values(r).map(s=>s[i.key]||s||0)}))}:n={labels:Array.from({length:24},(s,o)=>`${o}:00`),datasets:[{label:"Tickets",data:r.map(s=>s.tickets),borderColor:xt.blueBorder,backgroundColor:xt.blue,tension:.1},{label:"Readings",data:r.map(s=>s.readings),borderColor:xt.greenBorder,backgroundColor:xt.green,tension:.1},{label:"Payments",data:r.map(s=>s.payments),borderColor:xt.purpleBorder,backgroundColor:xt.purple,tension:.1}]},c.jsx("div",{className:"h-72 w-full",children:c.jsx(Fq,{options:OR(e),data:n})})},df=({data:r,title:e,colorMap:t})=>{if(!r||Object.keys(r).length===0)return c.jsxs("p",{className:"text-sm text-gray-500 text-center py-10",children:["No data for ",e,"."]});const n=[xt.blue,xt.green,xt.purple,xt.orange,xt.red,xt.teal,xt.sky,xt.pink,xt.yellow,xt.gray],i=t?Object.keys(r).map(l=>t[l]||xt.gray):n.slice(0,Object.keys(r).length),s={labels:Object.keys(r).map(l=>l.charAt(0).toUpperCase()+l.slice(1)),datasets:[{data:Object.values(r),backgroundColor:i,borderColor:"#FFFFFF",borderWidth:2}]},o={responsive:!0,maintainAspectRatio:!1,animation:!1,plugins:{legend:{display:!0,position:"bottom",labels:{boxWidth:12,padding:15}},title:{display:!0,text:e,font:{size:16},color:"#374151",padding:{bottom:15}},tooltip:{backgroundColor:"#1F2937",titleColor:"#E5E7EB",bodyColor:"#D1D5DB",borderColor:"#4B5563",borderWidth:1,padding:10,boxPadding:3}}};return c.jsx("div",{className:"h-72 w-full",children:c.jsx(Vq,{options:o,data:s})})},U$=({data:r,title:e})=>{if(!r||Object.keys(r).length===0)return c.jsxs("p",{className:"text-sm text-gray-500 text-center py-10",children:["No data for ",e,"."]});const t={labels:Object.keys(r),datasets:[{data:Object.values(r),backgroundColor:[xt.teal,xt.orange,xt.pink,xt.yellow,xt.sky,xt.blue,xt.green,xt.purple,xt.red],borderColor:"#FFFFFF",borderWidth:2}]},n={responsive:!0,maintainAspectRatio:!1,animation:!1,plugins:{legend:{display:!0,position:"bottom",labels:{boxWidth:12,padding:15}},title:{display:!0,text:e,font:{size:16},color:"#374151",padding:{bottom:15}},tooltip:{backgroundColor:"#1F2937",titleColor:"#E5E7EB",bodyColor:"#D1D5DB",borderColor:"#4B5563",borderWidth:1,padding:10,boxPadding:3}}};return c.jsx("div",{className:"h-72 w-full",children:c.jsx(wR,{options:n,data:t})})},ro=({title:r,value:e,icon:t,color:n})=>c.jsx("div",{className:"bg-gray-50 p-4 rounded-lg shadow border-l-4",style:{borderColor:n},children:c.jsxs("div",{className:"flex items-center",children:[c.jsx("div",{className:"p-2 rounded-full mr-3",style:{backgroundColor:`${n}20`},children:c.jsx(t,{size:20,style:{color:n}})}),c.jsxs("div",{children:[c.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase",children:r}),c.jsx("p",{className:"text-xl font-bold text-gray-800",children:e})]})]})}),q$=({showNotification:r=console.log})=>{var E,x,b,S,N,R,I;const[e,t]=X.useState(null),[n,i]=X.useState(!0),[s,o]=X.useState(""),[l,d]=X.useState(!1),f=X.useCallback(async()=>{i(!0),o("");try{const j=await Promise.allSettled([s3(Yt),o3(Yt),c9(Yt),D9(Yt),M9(Yt),L9(Yt),u9(Yt),d9(Yt),F9(Yt),V9(Yt),B9(Yt),z9(Yt)]),[U,P,k,F,O,C,M,D,$,K,ee,se]=j;let ie="";const re={},G=(z,Z,J)=>{var ae,le;if(z.status==="fulfilled"&&z.value.success)re[J]=z.value.data,Z==="User"&&(re.totalUsers=z.value.data.total,re.usersByRole=z.value.data.byRole),Z==="Ticket"&&(re.ticketStats=z.value.data.byStatus,re.ticketsByType=z.value.data.byType,re.totalTickets=z.value.data.total,re.openTickets=z.value.data.openCount),Z==="Outstanding balance"&&(re.outstandingBalance=z.value.data.totalOutstanding);else{let Q="Unknown error";z.status==="rejected"?Q=((ae=z.reason)==null?void 0:ae.message)||z.reason.toString():(le=z.value)!=null&&le.error&&(Q=z.value.error),ie+=`${Z} stats failed: ${Q} | `}};G(U,"User","users"),G(P,"Ticket","tickets"),G(k,"Monthly revenue","monthlyRevenue"),G(F,"Hourly activity","hourlyActivity"),G(O,"Staff activity","staffActivity"),G(C,"Technical","techStats"),G(M,"Location revenue","revenueByLocation"),G(D,"Outstanding balance","outstanding"),G($,"Consumption","monthlyConsumption"),G(K,"Payment methods","paymentMethods"),G(ee,"User growth","userGrowth"),G(se,"Discount","discountStats"),ie&&o(ie.trim().slice(0,-1)),t(re)}catch(j){o("Critical error fetching statistics."),console.error("fetchStatistics error:",j)}finally{i(!1)}},[r]);X.useEffect(()=>{f()},[f]);const m=async j=>{const U=`
            You are 'Agie', an AI analyst for AGWA Water Services. The currency is **Philippine Pesos (PHP)**.
            Analyze the following JSON data and generate a professional, high-level "Executive Summary" narrative for a printed report.
            - Start with "<h3 class='print-section-title'>Executive Summary</h3>".
            - Use simple HTML for formatting: <p>, <strong>, <ul>, <li>.
            - Write 2-3 short paragraphs.
            - Paragraph 1: Cover Business Analytics (Revenue, Outstanding Balance in PHP).
            - Paragraph 2: Cover User & Support Analytics (User totals, ticket status).
            - Paragraph 3: Cover Technical & Staff Operations (Routes, Interruptions, Staff Activity).
            - Be concise and highlight the most important numbers (e.g., total users, total revenue (PHP), open tickets, active interruptions).
            - Data: ${JSON.stringify(j)}
        `;try{return await Vo([{role:"user",content:U}],"llama-3.1-8b-instant")}catch(P){return console.error("AI Executive Summary Generation Failed:",P),"<h3 class='print-section-title'>Executive Summary</h3><p><strong>Analysis:</strong> <em>AI narrative generation failed. Please check the API connection or key.</em></p>"}},p=async()=>{var j,U,P,k,F,O,C,M,D;if(!(l||!e)){d(!0),r("Generating report... This may take a moment.","info");try{const $=document.getElementById("stats-print-area").querySelectorAll("canvas"),K=Array.from($).map(ue=>new Promise(fe=>{var Me;const ve=Object.values(ju.instances).find(Pe=>Pe.canvas===ue);if(ve){const Pe=(Me=ue.closest("[data-chart-id]"))==null?void 0:Me.dataset.chartId;fe(Pe?{id:Pe,dataUrl:ve.toBase64Image("image/png",1)}:null)}else fe(null)})),se=(await Promise.all(K)).filter(Boolean).reduce((ue,fe)=>(ue[fe.id]=fe.dataUrl,ue),{}),ie={business:{totalRevenue_12mo_PHP:g,totalOutstanding_PHP:e.outstandingBalance,totalConsumption_12mo_m3:v,revenueByLocation_PHP:e.revenueByLocation,paymentMethods:e.paymentMethods},userSupport:{totalUsers:e.totalUsers,usersByRole:e.usersByRole,totalTickets:e.totalTickets,openTickets:e.openTickets,ticketsByStatus:e.ticketStats,ticketsByType:e.ticketsByType,discountStats:e.discountStats},technical:{totalRoutes:(j=e.techStats)==null?void 0:j.totalRoutes,totalAccounts:(U=e.techStats)==null?void 0:U.totalAccounts,activeInterrupts:(P=e.techStats)==null?void 0:P.activeInterrupts,unassignedRoutes:(k=e.techStats)==null?void 0:k.unassignedRoutes},activity:{staffReadings:(F=e.staffActivity)==null?void 0:F.readerActivity,staffPayments:(O=e.staffActivity)==null?void 0:O.clerkActivity}},re=[m(ie),As("Monthly Collected Revenue (Last 12 Months)",e.monthlyRevenue||{}),As("Monthly Water Consumption (Last 12 Months)",e.monthlyConsumption||{}),As("Revenue by Location",e.revenueByLocation||{}),As("Payments by Method",e.paymentMethods||{}),As("New User Signups (Last 12 Months)",e.userGrowth||{}),As("Users by Role",e.usersByRole||{}),As("Tickets by Type",e.ticketsByType||{}),As("Support Tickets by Status",e.ticketStats||{}),As("Customer Discount Status",e.discountStats||{}),As("Readings Submitted Today (by Staff)",((C=e.staffActivity)==null?void 0:C.readerActivity)||{}),As("Payments Processed Today (by Staff)",((M=e.staffActivity)==null?void 0:M.clerkActivity)||{}),As("Hourly Portal Activity (Today)",e.hourlyActivity||[])],G=await Promise.allSettled(re),z=(ue,fe)=>G[ue].status==="fulfilled"?G[ue].value:`<p><strong>Analysis:</strong> <em>${fe}</em></p>`,Z={summary:z(0,"Executive summary generation failed."),revenue:z(1,"Revenue analysis failed."),consumption:z(2,"Consumption analysis failed."),locationRevenue:z(3,"Location revenue analysis failed."),paymentMethods:z(4,"Payment method analysis failed."),userGrowth:z(5,"User growth analysis failed."),userRoles:z(6,"User role analysis failed."),ticketTypes:z(7,"Ticket type analysis failed."),ticketStatus:z(8,"Ticket status analysis failed."),discountStatus:z(9,"Discount status analysis failed."),staffReadings:z(10,"Staff reading analysis failed."),staffPayments:z(11,"Staff payment analysis failed."),hourlyActivity:z(12,"Hourly activity analysis failed.")},J=((D=document.getElementById("stats-print-styles"))==null?void 0:D.innerHTML)||"",ae=window.open("","","height=800,width=1200");ae.document.write("<html><head><title>System Analytics Report</title>"),ae.document.write('<script src="https://cdn.tailwindcss.com"><\/script>'),ae.document.write(`<style>${J}</style>`),ae.document.write('</head><body class="bg-white">');const le=`
                <div class="printable-area p-8">
                    <header class="report-header">
                        <div>
                            <h1 class="logo-print">AGWA</h1>
                            <p class="tagline-print">Ensuring Clarity, Sustaining Life.</p>
                        </div>
                        <div class="company-address-print">
                            <strong>AGWA Water Services, Inc.</strong><br/>
                            AGWA Water Services Bldg., Governor's Drive<br/>
                            Brgy. Ibayo Silangan, Naic, Cavite 4110
                        </div>
                    </header>
                    <h1 class="report-title">SYSTEM ANALYTICS REPORT</h1>
                    <p class="report-generated-date">Generated: ${new Date().toLocaleString()}</p>
                    
                    <section class="print-section" id="ai-summary">
                        ${uo.sanitize(Z.summary)}
                    </section>
            `;ae.document.write(le);const Q=(ue,fe,ve="lg:col-span-1")=>{const Me=se[ue];return Me?`
                    <div class="chart-container ${ve}">
                        <img src="${Me}" alt="${ue} Chart" />
                        <div class="analysis-narrative">
                            ${uo.sanitize(fe)}
                        </div>
                    </div>
                `:`<div class="chart-container ${ve}"><div class="analysis-narrative"><p><strong>Analysis:</strong> <em>Chart data not found.</em></p></div></div>`};let ce=`
                <section class="print-section">
                    <h3 class="print-section-title">Business Analytics</h3>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        ${Q("revenue",Z.revenue)}
                        ${Q("consumption",Z.consumption)}
                        ${Q("locationRevenue",Z.locationRevenue)}
                        ${Q("paymentMethods",Z.paymentMethods)}
                    </div>
                </section>

                <section class="print-section">
                    <h3 class="print-section-title">User & Support Analytics</h3>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        ${Q("userGrowth",Z.userGrowth)}
                        ${Q("userRoles",Z.userRoles)}
                        ${Q("ticketTypes",Z.ticketTypes)}
                        ${Q("ticketStatus",Z.ticketStatus)}
                        ${Q("discountStatus",Z.discountStatus,"lg:col-span-2")}
                    </div>
                </section>

                <section class="print-section">
                    <h3 class="print-section-title">Staff & Technical Analytics</h3>
                     <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        ${Q("staffReadings",Z.staffReadings)}
                        ${Q("staffPayments",Z.staffPayments)}
                        ${Q("hourlyActivity",Z.hourlyActivity)}
                    </div>
                </section>
            `;ae.document.write(ce),ae.document.write(`
                    <script>
                        window.onload = function() {
                            setTimeout(function() { 
                                window.print();
                                window.close();
                            }, 1500); 
                        };
                    <\/script>
                </div></body></html>
            `),ae.document.close()}catch($){console.error("Print Report Error:",$),r("Failed to generate the full report.","error")}finally{d(!1)}}},g=X.useMemo(()=>e!=null&&e.monthlyRevenue?Object.values(e.monthlyRevenue).reduce((j,U)=>j+U,0):0,[e==null?void 0:e.monthlyRevenue]),v=X.useMemo(()=>e!=null&&e.monthlyConsumption?Object.values(e.monthlyConsumption).reduce((j,U)=>j+U,0):0,[e==null?void 0:e.monthlyConsumption]);return n?c.jsx(ln,{message:"Loading system analytics...",className:"mt-10 h-64"}):c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsx("style",{id:"stats-print-styles",dangerouslySetInnerHTML:{__html:`
                @media print {
                    @page {
                        size: A4 portrait;
                        margin: 0.75in;
                    }
                    body { 
                        font-family: 'Times New Roman', Times, serif; 
                        -webkit-print-color-adjust: exact !important; 
                        print-color-adjust: exact !important;
                        color: #000;
                        font-size: 11pt; 
                    }
                    .no-print { display: none !important; }
                    .printable-area { padding: 0 !important; max-width: 100%; margin: auto; }
                    .report-header { display: flex; justify-content: space-between; align-items: flex-start; text-align: left; border-bottom: 2px solid #000; padding-bottom: 1rem; }
                    .report-header .logo-print { font-size: 2.5rem; font-weight: 700; color: #1e3a8a !important; line-height: 1; margin: 0; }
                    .report-header .tagline-print { font-size: 0.8rem; color: #1d4ed8 !important; font-style: italic; margin: 0; }
                    .report-header .company-address-print { text-align: right; font-size: 0.8rem; line-height: 1.4; color: #374151 !important; }
                    h1.report-title { font-size: 1.5rem; font-weight: 700; color: #000 !important; margin-top: 1.5rem; margin-bottom: 0.5rem; text-align: center; text-transform: uppercase; }
                    p.report-generated-date { text-align: center; font-size: 0.9rem; color: #4b5563; margin-bottom: 1.5rem; }
                    
                    .print-section { 
                        page-break-inside: avoid !important; 
                        margin-top: 1.5rem; 
                        padding-top: 1.5rem !important;
                        border-top: 1px solid #d1d5db !important;
                    }
                    #ai-summary {
                        background-color: #f3f4f6 !important;
                        border: 1px solid #e5e7eb !important;
                        border-radius: 8px;
                        padding: 1.25rem;
                        font-size: 10.5pt;
                        line-height: 1.6;
                        color: #374151 !important;
                    }
                    #ai-summary p { margin-bottom: 0.75rem; }
                    #ai-summary strong { color: #111827 !important; }
                    #ai-summary ul { margin-left: 1.25rem; list-style-type: disc; }

                    h3.print-section-title {
                        font-size: 1.3rem; 
                        font-weight: 700; 
                        border-bottom: 1px solid #4b5563; 
                        padding-bottom: 0.25rem; 
                        margin-bottom: 1rem; 
                        color: #111827 !important;
                    }
                    h3.print-section-title svg { display: none; }

                    .chart-container {
                        page-break-inside: avoid !important;
                        margin-bottom: 1.5rem;
                        border: 1px solid #e5e7eb;
                        border-radius: 8px;
                        padding: 1rem;
                        background-color: #F9FAFB !important;
                    }
                    .chart-container img {
                        width: 100%;
                        height: auto;
                        border-bottom: 1px solid #e5e7eb;
                        padding-bottom: 1rem;
                        margin-bottom: 1rem;
                    }
                    .analysis-narrative {
                        font-size: 10pt;
                        color: #374151 !important;
                        font-family: 'Georgia', serif;
                    }
                    .analysis-narrative p { margin-bottom: 0.5rem; }
                    .analysis-narrative strong { color: #111827 !important; font-weight: 600; }
                    .analysis-narrative em { font-style: italic; }

                    .shadow-xl, .shadow-md, .shadow-lg, .border { 
                        box-shadow: none !important; 
                    }
                    .bg-gray-50, .bg-white { background-color: transparent !important; }
                    .h-72 { height: auto !important; }
                }
             `}}),c.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-200 no-print",children:[c.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center",children:[c.jsx(k2,{size:30,className:"mr-3 text-orange-600"})," System Analytics"]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsxs("button",{onClick:f,disabled:n||l,className:"flex items-center text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-3 rounded-lg border border-gray-300 disabled:opacity-50",children:[n?c.jsx(Tt,{size:16,className:"animate-spin mr-2"}):c.jsx(qa,{size:16,className:"mr-2"}),"Refresh"]}),c.jsxs("button",{onClick:p,disabled:n||l,className:"flex items-center text-sm bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-3 rounded-lg disabled:bg-gray-400",children:[l?c.jsx(Tt,{size:16,className:"animate-spin mr-2"}):c.jsx(V2,{size:16,className:"mr-2"}),l?"Generating Report...":"Print Report"]})]})]}),s&&c.jsxs("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 p-4 my-4 flex items-start no-print",role:"alert",children:[c.jsx(yn,{size:20,className:"mr-3 mt-1 flex-shrink-0"}),c.jsxs("p",{className:"text-sm",children:["Could not load all statistics: ",c.jsx("span",{className:"font-mono text-xs break-all",children:s})]})]}),c.jsx("div",{id:"stats-print-area",className:"printable-area",children:c.jsxs("div",{className:"space-y-8",children:[c.jsxs("section",{className:"print-section",children:[c.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center print-section-title",children:[c.jsx(Vl,{size:22,className:"mr-2 text-green-600"}),"Business Analytics"]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6 no-print",children:[c.jsx(ro,{title:"Total Revenue (12 Mo.)",value:`${g.toLocaleString("en-US",{minimumFractionDigits:0})}`,icon:Vl,color:xt.greenBorder}),c.jsx(ro,{title:"Total Outstanding",value:`${((e==null?void 0:e.outstandingBalance)??0).toLocaleString("en-US",{minimumFractionDigits:0})}`,icon:c3,color:xt.redBorder}),c.jsx(ro,{title:"Total Consumption (12 Mo.)",value:`${v.toLocaleString("en-US")} m`,icon:eF,color:xt.blueBorder})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[c.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"revenue",children:c.jsx(cg,{data:(e==null?void 0:e.monthlyRevenue)||{},title:"Monthly Collected Revenue (Last 12 Months)",label:"Revenue",color:xt.green,borderColor:xt.greenBorder})}),c.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"consumption",children:c.jsx(cg,{data:(e==null?void 0:e.monthlyConsumption)||{},title:"Monthly Water Consumption (Last 12 Months)",label:"Consumption (m)",color:xt.blue,borderColor:xt.blueBorder})}),c.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"locationRevenue",children:c.jsx(df,{data:e==null?void 0:e.revenueByLocation,title:"Revenue by Location"})}),c.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"paymentMethods",children:c.jsx(df,{data:e==null?void 0:e.paymentMethods,title:"Payments by Method"})})]})]}),c.jsxs("section",{className:"print-section pt-6 border-t",children:[c.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center print-section-title",children:[c.jsx(Ia,{size:22,className:"mr-2 text-purple-600"}),"User & Support Analytics"]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6 no-print",children:[c.jsx(ro,{title:"Total Users",value:(e==null?void 0:e.totalUsers)??"N/A",icon:Ia,color:xt.purpleBorder}),c.jsx(ro,{title:"Total Tickets",value:(e==null?void 0:e.totalTickets)??"N/A",icon:Oa,color:xt.orangeBorder}),c.jsx(ro,{title:"Open Tickets",value:(e==null?void 0:e.openTickets)??"0",icon:Zt,color:xt.redBorder}),c.jsx(ro,{title:"Verified Discounts",value:((E=e==null?void 0:e.discountStats)==null?void 0:E.verified)??"N/A",icon:_a,color:xt.greenBorder})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[c.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"userGrowth",children:c.jsx(S4,{data:(e==null?void 0:e.userGrowth)||{},title:"New User Signups (Last 12 Months)",datasets:[{label:"New Users",key:"users",borderColor:xt.purpleBorder,backgroundColor:xt.purple,tension:.1}]})}),c.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"userRoles",children:c.jsx(df,{data:e==null?void 0:e.usersByRole,title:"Users by Role"})}),c.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"ticketTypes",children:c.jsx(U$,{data:e==null?void 0:e.ticketsByType,title:"Tickets by Type"})}),c.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"ticketStatus",children:c.jsx(df,{data:e==null?void 0:e.ticketStats,title:"Support Tickets by Status"})}),c.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border lg:col-span-2","data-chart-id":"discountStatus",children:c.jsx(df,{data:e==null?void 0:e.discountStats,title:"Customer Discount Status",colorMap:{none:xt.gray,pending:xt.yellow,verified:xt.green}})})]})]}),c.jsxs("section",{className:"print-section pt-6 border-t",children:[c.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center print-section-title",children:[c.jsx(m3,{size:22,className:"mr-2 text-sky-600"}),"Staff & Technical Analytics"]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6 no-print",children:[c.jsx(ro,{title:"Total Routes",value:((x=e==null?void 0:e.techStats)==null?void 0:x.totalRoutes)??"N/A",icon:co,color:xt.tealBorder}),c.jsx(ro,{title:"Total Accounts",value:((b=e==null?void 0:e.techStats)==null?void 0:b.totalAccounts)??"N/A",icon:Ia,color:xt.tealBorder}),c.jsx(ro,{title:"Active Interruptions",value:((S=e==null?void 0:e.techStats)==null?void 0:S.activeInterrupts)??"N/A",icon:Zt,color:xt.redBorder}),c.jsx(ro,{title:"Unassigned Routes",value:((N=e==null?void 0:e.techStats)==null?void 0:N.unassignedRoutes)??"N/A",icon:c0,color:xt.orangeBorder})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"staffReadings",children:c.jsx(cg,{data:((R=e==null?void 0:e.staffActivity)==null?void 0:R.readerActivity)||{},title:"Readings Submitted Today (by Staff)",label:"Readings",color:xt.sky,borderColor:xt.skyBorder})}),c.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"staffPayments",children:c.jsx(cg,{data:((I=e==null?void 0:e.staffActivity)==null?void 0:I.clerkActivity)||{},title:"Payments Processed Today (by Staff)",label:"Payments",color:xt.purple,borderColor:xt.purpleBorder})}),c.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"hourlyActivity",children:c.jsx(S4,{data:(e==null?void 0:e.hourlyActivity)||[],title:"Hourly Portal Activity (Today)"})})]})]})]})})]})},H$=({isOpen:r,onClose:e,onSave:t,reading:n,isSaving:i,accountNumber:s})=>{const[o,l]=X.useState({});X.useEffect(()=>{var f;if(n){const m=(f=n.readingDate)!=null&&f.toDate?n.readingDate.toDate():new Date(n.readingDate),p=m.getFullYear(),g=String(m.getMonth()+1).padStart(2,"0"),v=String(m.getDate()).padStart(2,"0");l({readingValue:n.readingValue||"",readingDate:`${p}-${g}-${v}`,readingType:n.readingType||"Actual",notes:n.notes||""})}else l({readingValue:"",readingDate:new Date().toISOString().split("T")[0],readingType:"Actual",notes:""})},[n]);const d=f=>{f.preventDefault(),t(n==null?void 0:n.id,o)};return r?c.jsx(Vr,{isOpen:r,onClose:e,title:n?`Edit Reading for ${n.accountNumber}`:`Create New Reading for ${s}`,children:c.jsxs("form",{onSubmit:d,className:"space-y-4",children:[c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"readingValue",className:"text-sm font-medium text-gray-700 flex items-center mb-1",children:[c.jsx(ac,{size:14,className:"mr-1.5"}),"Reading Value (m)"]}),c.jsx("input",{type:"number",name:"readingValue",value:o.readingValue,onChange:f=>l({...o,readingValue:f.target.value}),className:Fi,step:"0.01",required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"readingDate",className:"text-sm font-medium text-gray-700 flex items-center mb-1",children:[c.jsx(xu,{size:14,className:"mr-1.5"}),"Reading Date"]}),c.jsx("input",{type:"date",name:"readingDate",value:o.readingDate,onChange:f=>l({...o,readingDate:f.target.value}),className:Fi,required:!0})]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"readingType",className:"text-sm font-medium text-gray-700 flex items-center mb-1",children:[c.jsx(Q9,{size:14,className:"mr-1.5"}),"Reading Type"]}),c.jsxs("select",{name:"readingType",value:o.readingType,onChange:f=>l({...o,readingType:f.target.value}),className:Fi,children:[c.jsx("option",{value:"Actual",children:"Actual"}),c.jsx("option",{value:"Estimated",children:"Estimated"}),c.jsx("option",{value:"No Reading",children:"No Reading"})]})]}),c.jsxs("div",{children:[c.jsxs("label",{htmlFor:"notes",className:"text-sm font-medium text-gray-700 flex items-center mb-1",children:[c.jsx(pF,{size:14,className:"mr-1.5"}),"Notes"]}),c.jsx("textarea",{name:"notes",rows:"3",value:o.notes,onChange:f=>l({...o,notes:f.target.value}),className:Fi})]}),c.jsxs("div",{className:"pt-4 flex justify-end space-x-3",children:[c.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg border",disabled:i,children:"Cancel"}),c.jsxs("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg flex items-center",disabled:i,children:[i?c.jsx(Tt,{size:18,className:"animate-spin mr-2"}):c.jsx(Ha,{size:18,className:"mr-2"}),i?"Saving...":"Save Changes"]})]})]})}):null},$$=({showNotification:r,userData:e})=>{var ee,se,ie;const[t,n]=X.useState(""),[i,s]=X.useState(null),[o,l]=X.useState(!1),[d,f]=X.useState(""),[m,p]=X.useState(!1),[g,v]=X.useState(null),[E,x]=X.useState(!1),[b,S]=X.useState(null),[N,R]=X.useState(!1),[I,j]=X.useState(!1),U=async re=>{if(re.preventDefault(),!t.trim()){f("Please enter an account number.");return}l(!0),f(""),p(!0),s(null);try{const G=ct(Yt,Ln()),z=pt(G,St("accountNumber","==",t.trim().toUpperCase())),Z=await vt(z);if(Z.empty){f("No user found with the provided account number."),l(!1);return}const J=Z.docs[0];await P({id:J.id,...J.data()})}catch(G){console.error("Error searching for user or readings:",G),f("An error occurred during the search. Check Firestore rules and indexes."),l(!1)}},P=async re=>{const G=ct(Yt,Ua()),z=pt(G,St("userId","==",re.id),Gn("readingDate","desc")),J=(await vt(z)).docs.map(ae=>({id:ae.id,...ae.data()}));s({user:re,readings:J}),l(!1)},k=re=>{x(!1),v(re)},F=()=>{if(!(i!=null&&i.user)){r("Please search for a user first before creating a reading.","warning");return}v(null),x(!0)},O=()=>{v(null),x(!1)},C=async(re,G)=>{R(!0);const z=await T9(Yt,re,G);z.success?(r("Meter reading updated successfully!","success"),await P(i.user),O()):r(z.error||"Failed to update reading.","error"),R(!1)},M=async(re,G)=>{R(!0);const z={...G,userId:i.user.id,accountNumber:i.user.accountNumber,meterSerialNumber:i.user.meterSerialNumber||"N/A",readBy:e.displayName||"Admin",readerId:e.uid},Z=await r3(Yt,z);Z.success?(r("New meter reading created successfully!","success"),await P(i.user),O()):r(Z.error||"Failed to create reading.","error"),R(!1)},D=async()=>{if(!(i!=null&&i.user)){r("Please search for a user first.","error");return}j(!0);const re=await JC(Yt,i.user.id,i.user);re.success?r(re.message,"success"):r(re.error,"error"),j(!1)},$=re=>{S(re)},K=async()=>{if(!b)return;R(!0);const re=await A9(Yt,b);re.success?(r("Meter reading deleted successfully!","success"),await P(i.user)):r(re.error||"Failed to delete reading.","error"),S(null),R(!1)};return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl",children:[c.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Meter Reading & Billing"}),c.jsxs("form",{onSubmit:U,className:"mb-6 flex flex-col sm:flex-row gap-2 items-center bg-gray-50 p-4 rounded-lg shadow-sm",children:[c.jsx("input",{type:"text",value:t,onChange:re=>n(re.target.value),placeholder:"Enter user account number...",className:"w-full p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500"}),c.jsxs("button",{type:"submit",disabled:o,className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 disabled:bg-blue-400 flex items-center justify-center w-full sm:w-auto",children:[o?c.jsx(Tt,{className:"animate-spin mr-2"}):c.jsx(Os,{className:"mr-2",size:18}),o?"Searching...":"Search"]})]}),d&&c.jsx("p",{className:"text-red-500 text-center mb-4",children:d}),o&&c.jsx(ln,{message:"Fetching data..."}),(i==null?void 0:i.user)&&c.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-lg shadow-md mt-6 border border-gray-200",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-3",children:[c.jsxs("h2",{className:"text-xl font-semibold",children:["Data for ",i.user.displayName," (",i.user.accountNumber,")"]}),c.jsxs("div",{className:"flex gap-2 flex-wrap",children:[c.jsxs("button",{onClick:F,className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 flex items-center text-sm",children:[c.jsx(s0,{size:16,className:"mr-2"})," Create Reading"]}),c.jsxs("button",{onClick:D,className:"bg-cyan-600 text-white px-4 py-2 rounded-md hover:bg-cyan-700 flex items-center text-sm disabled:bg-gray-400",disabled:I||i.readings.length<2,title:i.readings.length<2?"At least 2 readings are required to generate a bill":"Generate bill from latest reading",children:[I?c.jsx(Tt,{size:16,className:"animate-spin mr-2"}):c.jsx(oc,{size:16,className:"mr-2"}),I?"Generating...":"Generate Bill"]})]})]}),c.jsxs("div",{className:"overflow-x-auto",children:[c.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[c.jsx("thead",{className:"bg-gray-50",children:c.jsxs("tr",{children:[c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reading (m)"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reader"}),c.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),c.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),c.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(ee=i.readings)==null?void 0:ee.map(re=>c.jsxs("tr",{children:[c.jsx("td",{className:"px-4 py-4 whitespace-nowrap font-medium",children:re.readingValue}),c.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:Mt(re.readingDate,{year:"numeric",month:"short",day:"numeric"})}),c.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:re.readBy||"N/A"}),c.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:re.readingType||"N/A"}),c.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-center space-x-2",children:[c.jsx("button",{onClick:()=>k(re),className:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded-md transition-colors",title:"Edit Reading",children:c.jsx(cm,{size:16})}),c.jsx("button",{onClick:()=>$(re.id),className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-100 rounded-md transition-colors",title:"Delete Reading",children:c.jsx(fh,{size:16})})]})]},re.id))})]}),((se=i.readings)==null?void 0:se.length)<2&&c.jsx("p",{className:"text-xs text-center text-yellow-600 bg-yellow-50 p-2 mt-2 rounded-md",children:"Note: At least two readings are needed before a bill can be generated."})]})]}),(g||E)&&c.jsx(H$,{isOpen:!0,onClose:O,onSave:E?M:C,reading:g,isSaving:N,accountNumber:(ie=i==null?void 0:i.user)==null?void 0:ie.accountNumber}),b&&c.jsx(Da,{isOpen:!!b,onClose:()=>S(null),onConfirm:K,title:"Confirm Deletion",confirmText:"Yes, Delete",isConfirming:N,iconType:"danger",children:"Are you sure you want to permanently delete this meter reading? This action cannot be undone."})]})},ug="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition-150 text-sm",W$=({isOpen:r,onClose:e,onSave:t,route:n,readers:i,isSaving:s,db:o})=>{const[l,d]=X.useState({name:"",areaCode:"",description:"",assignedReaderId:""}),[f,m]=X.useState([]),[p,g]=X.useState([]),[v,E]=X.useState({}),[x,b]=X.useState([]),[S,N]=X.useState(!1);X.useEffect(()=>{const C=p0(),M=[],D=C.reduce(($,K)=>{const ee=eh(K).sort();return $[K]=ee,M.push(...ee),$},{});E(D),b(M.sort())},[]),X.useEffect(()=>{if(r)if(n){d({name:n.name||"",areaCode:n.areaCode||"",description:n.description||"",assignedReaderId:n.assignedReaderId||""});const C=Array.isArray(n.barangays)?n.barangays:n.barangay?[n.barangay]:[];m(C),g(n.accountNumbers||[])}else d({name:"",areaCode:"",description:"",assignedReaderId:""}),m([]),g([])},[n,r]);const R=X.useCallback(async C=>{if(!C||C.length===0){g([]);return}N(!0);let M=[];for(const D of C){const $=await i9(o,D);$.success&&(M=[...M,...$.data])}g([...new Set(M)]),N(!1)},[o]);X.useEffect(()=>{R(f)},[f,R]);const I=C=>{m(M=>M.includes(C)?M.filter(D=>D!==C):[...M,C])},j=()=>{f.length===x.length?m([]):m([...x])},U=(C,M)=>{const D=M.every($=>f.includes($));m(D?$=>$.filter(K=>!M.includes(K)):$=>[...new Set([...$,...M])])},P=C=>C?C.split(" ").map(M=>M[0]).join("").toUpperCase():"",k=C=>{const M=C.target.value;d(D=>({...D,name:M,areaCode:P(M)}))},F=C=>{const{name:M,value:D}=C.target;d($=>({...$,[M]:D}))},O=C=>{C.preventDefault(),t({name:l.name,areaCode:l.areaCode,description:l.description,assignedReaderId:l.assignedReaderId,barangays:f,accountNumbers:p})};return c.jsxs(Vr,{isOpen:r,onClose:e,title:n?"Edit Meter Route":"Create New Meter Route",size:"2xl",children:[c.jsxs("form",{onSubmit:O,className:"space-y-4",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"name",className:"block text-sm font-medium mb-1",children:"Route Name"}),c.jsx("input",{type:"text",name:"name",value:l.name,onChange:k,className:ug,required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"areaCode",className:"block text-sm font-medium mb-1",children:"Generated Area Code"}),c.jsx("input",{type:"text",name:"areaCode",value:l.areaCode,className:`${ug} bg-gray-200`,readOnly:!0})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"assignedReaderId",className:"block text-sm font-medium mb-1",children:"Assign to Meter Reader"}),c.jsxs("select",{name:"assignedReaderId",value:l.assignedReaderId,onChange:F,className:ug,children:[c.jsx("option",{value:"",children:"Unassigned"}),i.map(C=>c.jsxs("option",{value:C.id,children:[C.displayName," (",C.email,")"]},C.id))]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"description",className:"block text-sm font-medium mb-1",children:"Description"}),c.jsx("textarea",{name:"description",value:l.description,onChange:F,rows:"2",className:ug})]}),c.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50 max-h-72 overflow-y-auto scrollbar-thin",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2 sticky top-0 bg-gray-50 py-1 -mt-1 border-b border-gray-200",children:[c.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[c.jsx(co,{size:16,className:"inline mr-1.5"}),"Assigned Area(s) *"]}),c.jsx("button",{type:"button",onClick:j,className:"text-xs font-medium text-blue-600 hover:underline",children:f.length===x.length?"Deselect All":`Select All (${x.length})`})]}),c.jsx("div",{className:"space-y-2",children:Object.entries(v).map(([C,M])=>c.jsxs("details",{className:"group bg-white border rounded-md",children:[c.jsxs("summary",{className:"flex justify-between items-center p-2 cursor-pointer list-none",children:[c.jsx("span",{className:"font-semibold text-sm text-blue-700",children:C}),c.jsxs("div",{className:"flex items-center",children:[c.jsx("button",{type:"button",onClick:D=>{D.preventDefault(),U(C,M)},className:"text-xs text-blue-600 hover:underline mr-2",children:"Toggle District"}),c.jsx(R2,{size:18,className:"text-gray-500 group-open:rotate-180 transition-transform"})]})]}),c.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 p-3 border-t border-gray-100",children:M.map(D=>c.jsxs("label",{className:"flex items-center space-x-2 p-1.5 rounded bg-gray-50 border border-gray-200 hover:bg-blue-50 cursor-pointer text-xs has-[:checked]:bg-blue-100 has-[:checked]:border-blue-300",children:[c.jsx("input",{type:"checkbox",checked:f.includes(D),onChange:()=>I(D),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 shrink-0"}),c.jsx("span",{className:"truncate",title:D,children:D})]},D))})]},C))})]}),c.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[c.jsxs("p",{className:"text-sm font-medium text-blue-800 flex items-center",children:[c.jsx(aF,{size:16,className:"mr-2"}),"Auto-Assigned Accounts"]}),S?c.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[c.jsx(Tt,{className:"animate-spin h-4 w-4 mr-2"}),"Searching for accounts..."]}):f.length>0&&p.length>0?c.jsxs("p",{className:"text-sm text-gray-700",children:[p.length," total accounts found in ",f.length," selected area(s)."]}):f.length>0&&p.length===0?c.jsxs("p",{className:"text-sm text-orange-700 bg-orange-100 p-2 rounded-md flex items-center",children:[c.jsx(yn,{size:14,className:"mr-2"}),"No accounts found for this location. You cannot save an empty route."]}):c.jsx("p",{className:"text-xs text-gray-500",children:"Select at least one area to find and assign accounts."})]}),c.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[c.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium bg-gray-200 rounded-lg",disabled:s,children:"Cancel"}),c.jsxs("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg flex items-center disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:s||S||p.length===0,children:[s?c.jsx(Tt,{size:18,className:"animate-spin mr-2"}):c.jsx(Ha,{size:18,className:"mr-2"}),s?"Saving...":"Save Route"]})]})]}),c.jsx("style",{children:`
                .scrollbar-thin { scrollbar-width: thin; scrollbar-color: #9ca3af #f3f4f6; }
                .scrollbar-thin::-webkit-scrollbar { width: 6px; height: 6px;}
                .scrollbar-thin::-webkit-scrollbar-track { background: #f3f4f6; border-radius:3px; }
                .scrollbar-thin::-webkit-scrollbar-thumb { background-color: #9ca3af; border-radius: 3px; border: 1px solid #f3f4f6;}
                .scrollbar-thin::-webkit-scrollbar-thumb:hover { background-color: #6b7280; }
             `})]})},G$=({db:r,showNotification:e})=>{const[t,n]=X.useState([]),[i,s]=X.useState([]),[o,l]=X.useState(!0),[d,f]=X.useState(""),[m,p]=X.useState(!1),[g,v]=X.useState(null),[E,x]=X.useState(!1),[b,S]=X.useState(null),N=X.useCallback(async()=>{l(!0),f("");try{const[k,F]=await Promise.all([o9(r),l9(r)]);k.success?n(k.data):f(k.error||"Failed to load routes."),F.success?s(F.data):f(O=>O+(F.error||" Failed to load meter readers."))}catch{f("An unexpected error occurred while fetching data.")}l(!1)},[r]);X.useEffect(()=>{N()},[N]);const R=(k=null)=>{v(k),p(!0)},I=()=>{v(null),p(!1)},j=async k=>{x(!0);const F=await s9(r,k,g==null?void 0:g.id);F.success?(e(`Route ${g?"updated":"created"} successfully!`,"success"),N(),I()):e(F.error||"Failed to save route.","error"),x(!1)},U=async()=>{if(!b)return;x(!0);const k=await a9(r,b.id);k.success?(e("Route deleted successfully!","success"),S(null),N()):e(k.error||"Failed to delete route.","error"),x(!1)},P=k=>{var F;return((F=i.find(O=>O.id===k))==null?void 0:F.displayName)||"Unassigned"};return o?c.jsx(ln,{message:"Loading route data..."}):c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[c.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center",children:[c.jsx(lc,{size:30,className:"mr-3 text-blue-600"})," Meter Route Management"]}),c.jsxs("button",{onClick:()=>R(),className:"bg-blue-600 text-white font-medium py-2 px-4 rounded-lg flex items-center",children:[c.jsx(s0,{size:18,className:"mr-2"})," Add New Route"]})]}),d&&c.jsx("p",{className:"text-red-500 mb-4",children:d}),c.jsx("div",{className:"space-y-3",children:t.length>0?t.map(k=>{var F;return c.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsxs("p",{className:"font-bold text-gray-800",children:[k.name," ",c.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["(",k.areaCode,")"]})]}),c.jsxs("p",{className:"text-xs text-gray-600 flex items-center mt-1",children:[c.jsx(xF,{size:12,className:"mr-1.5"}),"Assigned to: ",c.jsx("span",{className:"font-medium ml-1",children:P(k.assignedReaderId)})]}),c.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Accounts: ",((F=k.accountNumbers)==null?void 0:F.length)||0]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("button",{onClick:()=>R(k),className:"p-2 text-blue-600 hover:bg-blue-100 rounded-full",children:c.jsx(cm,{size:18})}),c.jsx("button",{onClick:()=>S(k),className:"p-2 text-red-600 hover:bg-red-100 rounded-full",children:c.jsx(fh,{size:18})})]})]},k.id)}):c.jsxs("div",{className:"text-center py-10",children:[c.jsx(yn,{size:48,className:"mx-auto text-gray-400 mb-3"}),c.jsx("p",{className:"text-gray-500",children:"No routes found. Click 'Add New Route' to create one."})]})}),m&&c.jsx(W$,{isOpen:m,onClose:I,onSave:j,route:g,readers:i,isSaving:E,db:r}),b&&c.jsxs(Da,{isOpen:!!b,onClose:()=>S(null),onConfirm:U,title:"Confirm Route Deletion",isConfirming:E,children:['Are you sure you want to delete the route "',b.name,'"? This action cannot be undone.']})]})},K$=({db:r,showNotification:e})=>{const[t,n]=X.useState([]),[i,s]=X.useState(""),[o,l]=X.useState([]),[d,f]=X.useState(!1),[m,p]=X.useState(!1),[g,v]=X.useState([]);X.useEffect(()=>{(async()=>{const S=await r9(r);S.success?n(S.data):e(S.error,"error")})()},[r,e]);const E=async b=>{if(s(b),!b){l([]);return}f(!0),l([]);const S=await f9(r,b);S.success?l(S.data):e(S.error,"error"),f(!1)},x=async()=>{if(o.length===0){e("No billable accounts in the selected area.","warning");return}p(!0),v([]);const b=await m9(r,o);v(b),p(!1),e("Batch billing process completed. Check logs for details.","success"),E(i)};return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl",children:[c.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center mb-4",children:[c.jsx(oc,{size:30,className:"mr-3 text-green-600"})," Batch Bill Generation"]}),c.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Select a service area to find eligible accounts and generate bills in bulk. An account is eligible if it has a new reading that has not yet been billed."}),c.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border",children:[c.jsx("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Service Area (Barangay)"}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[c.jsxs("select",{id:"location",value:i,onChange:b=>E(b.target.value),className:"w-full p-2 border rounded-md bg-white",children:[c.jsx("option",{value:"",children:"-- Select an Area --"}),t.map(b=>c.jsx("option",{value:b,children:b},b))]}),c.jsxs("button",{onClick:x,className:"bg-green-600 text-white px-5 py-2 rounded-md flex items-center justify-center whitespace-nowrap disabled:bg-gray-400",disabled:d||m||o.length===0,children:[m?c.jsx(Tt,{size:18,className:"animate-spin mr-2"}):c.jsx(Y9,{size:18,className:"mr-2"}),m?"Processing...":`Generate ${o.length} Bills`]})]})]}),c.jsxs("div",{className:"mt-6",children:[c.jsxs("h3",{className:"font-semibold",children:["Eligible Accounts in ",i||"..."]}),d&&c.jsx(ln,{message:"Finding billable accounts..."}),!d&&i&&o.length===0&&c.jsxs("div",{className:"text-center py-6 bg-gray-50 mt-2 rounded-md",children:[c.jsx(yn,{size:32,className:"mx-auto text-gray-400 mb-2"}),c.jsx("p",{className:"text-gray-600",children:"No new readings eligible for billing in this area."})]}),!d&&o.length>0&&c.jsxs("p",{className:"text-green-700 font-medium my-2",children:[o.length," accounts ready for billing."]})]}),g.length>0&&c.jsxs("div",{className:"mt-6 pt-4 border-t",children:[c.jsx("h3",{className:"font-semibold mb-2",children:"Processing Log"}),c.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto bg-gray-900 text-white font-mono text-xs p-4 rounded-md",children:g.map((b,S)=>c.jsxs("div",{className:`flex items-start ${b.success?"text-green-400":"text-red-400"}`,children:[b.success?c.jsx(Cs,{size:14,className:"mr-2 mt-0.5 flex-shrink-0"}):c.jsx(Zt,{size:14,className:"mr-2 mt-0.5 flex-shrink-0"}),c.jsx("span",{children:b.message})]},S))})]})]})},Y$=({userData:r,db:e,showNotification:t,setActiveSection:n})=>{const[i,s]=X.useState({assignedRoutesCount:0,totalAccountsInRoutes:0,pendingReadingsInRoutes:0,readingsCompletedToday:0,issuesReportedByMe:0}),[o,l]=X.useState([]),[d,f]=X.useState(new Set),[m,p]=X.useState(!0),[g,v]=X.useState(""),E=X.useCallback(async()=>{if(!r||!r.uid){t("Meter reader data not available.","error"),p(!1);return}p(!0),v(""),l([]);try{const[b,S,N]=await Promise.allSettled([i3(e,r.uid),t3(e,r.uid),P2(e)]),R={};let I="",j=new Set;if(b.status==="fulfilled"&&b.value.success){const U=b.value.data.map(P=>{var k,F;return{...P,accountCount:P.accountCount||((k=P.accountNumbers)==null?void 0:k.length)||0,completedCount:P.completedReadingsToday||0,pendingCount:Math.max(0,(P.accountCount||((F=P.accountNumbers)==null?void 0:F.length)||0)-(P.completedReadingsToday||0))}});R.assignedRoutesCount=U.length,R.totalAccountsInRoutes=U.reduce((P,k)=>P+k.accountCount,0),R.pendingReadingsInRoutes=U.reduce((P,k)=>P+k.pendingCount,0),R.readingsCompletedToday=U.reduce((P,k)=>P+k.completedCount,0),j=new Set(U.flatMap(P=>P.barangays||[])),f(j)}else I+="Route data unavailable. ";if(N.status==="fulfilled"&&N.value.success){if(j.size>0){const U=N.value.data.filter(P=>P.affectedAreas&&P.affectedAreas.some(k=>j.has(k)));l(U)}}else I+="Interruption data unavailable. ";S.status==="fulfilled"&&S.value.success?R.issuesReportedByMe=S.value.data.length:I+="Reported issues data unavailable. ",s(U=>({...U,...R})),I.trim()&&(v(I.trim()),t("Some dashboard statistics could not be loaded.","warning"))}catch{const S="Could not load meter reader dashboard statistics. Please try refreshing.";v(S),t(S,"error")}finally{p(!1)}},[e,r,t]);X.useEffect(()=>{E()},[E]);const x=[{title:"View Assigned Routes",icon:lc,section:"assignedRoutes",description:"Check your daily routes and assigned accounts for reading.",color:"blue"},{title:"Manual Reading Entry",icon:O2,section:"searchAndSubmitReading",description:"Submit a reading for an account not on your immediate list.",color:"green"},{title:"Search Customer Info",icon:Os,section:"searchCustomerMeterReader",description:"Look up customer or meter details for verification.",color:"teal"},{title:"Report Field Issue",icon:Zt,section:"reportIssue",description:"Log issues like meter damage, leaks, or access problems.",color:"orange"}];return m?c.jsx(ln,{message:"Loading your dashboard...",className:"mt-10 h-48"}):c.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[c.jsx("div",{className:"p-6 bg-gradient-to-r from-sky-600 to-cyan-700 text-white rounded-xl shadow-xl",children:c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl sm:text-3xl font-bold",children:"Meter Reader Dashboard"}),c.jsxs("p",{className:"mt-1 text-sky-100",children:["Welcome, ",r.displayName||"Meter Reader","! Your tasks and tools are below."]})]}),c.jsxs("button",{onClick:E,className:"mt-3 sm:mt-0 text-sm flex items-center bg-sky-500 hover:bg-sky-400 text-white font-medium py-2 px-3 rounded-lg transition-colors disabled:opacity-70 self-start sm:self-center",disabled:m,title:"Refresh Statistics",children:[m?c.jsx(Tt,{size:16,className:"animate-spin"}):c.jsx(qa,{size:16}),c.jsx("span",{className:"ml-2 hidden sm:inline",children:"Refresh"})]})]})}),g&&c.jsxs("p",{className:"text-sm text-yellow-600 bg-yellow-50 p-3 rounded-md text-center my-4 flex items-center justify-center gap-2",children:[c.jsx(yn,{size:16})," ",g]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5",children:[c.jsx(fi,{title:"Assigned Routes",value:i.assignedRoutesCount,icon:lc,borderColor:"border-blue-500",iconColor:"text-blue-500",onClick:()=>n("assignedRoutes")}),c.jsx(fi,{title:"Pending Readings",value:i.pendingReadingsInRoutes,icon:oF,borderColor:"border-orange-500",iconColor:"text-orange-500",subtext:`Across ${i.totalAccountsInRoutes} total accounts`,onClick:()=>n("assignedRoutes")}),c.jsx(fi,{title:"Readings Done Today",value:i.readingsCompletedToday,icon:Cs,borderColor:"border-green-500",iconColor:"text-green-500"}),c.jsx(fi,{title:"My Reported Issues",value:i.issuesReportedByMe,icon:Zt,borderColor:"border-red-500",iconColor:"text-red-500",onClick:()=>n("myTickets")})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-5 mt-8 pt-5 border-t border-gray-200",children:"Your Tools & Actions"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:x.map(b=>c.jsxs("button",{onClick:()=>n(b.section),className:`p-6 bg-white rounded-xl shadow-lg hover:shadow-2xl transform hover:-translate-y-1.5 transition-all duration-300 ease-in-out text-left focus:outline-none focus:ring-2 focus:ring-${b.color}-500 focus:ring-opacity-75 group h-full flex flex-col`,children:[c.jsx("div",{className:`p-3 bg-${b.color}-100 rounded-full inline-block mb-3 self-start group-hover:scale-110 transition-transform`,children:c.jsx(b.icon,{size:28,className:`text-${b.color}-600`})}),c.jsx("h4",{className:`text-lg font-semibold text-gray-800 group-hover:text-${b.color}-700 transition-colors`,children:b.title}),c.jsx("p",{className:"text-sm text-gray-500 mt-1 leading-normal flex-grow",children:b.description})]},b.section))})]}),c.jsxs("div",{className:"mt-8 p-5 bg-gray-50 rounded-xl shadow",children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-3 flex items-center",children:[c.jsx(Zt,{size:20,className:"mr-2 text-yellow-500"})," Important Notices / Route Highlights"]}),o.length>0?c.jsx("div",{className:"space-y-3 mb-4",children:o.map(b=>c.jsxs("div",{className:"p-3 bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 rounded-r-lg",children:[c.jsx("p",{className:"font-semibold text-sm",children:b.title}),c.jsxs("p",{className:"text-xs mt-1 flex items-center",children:[c.jsx(co,{size:12,className:"mr-1.5"}),c.jsx("strong",{children:"Affected Areas on your route:"})," ",b.affectedAreas.filter(S=>d.has(S)).join(", ")]})]},b.id))}):c.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"No specific system notices for your routes today."}),c.jsx("p",{className:"text-sm text-gray-500 border-t border-gray-200 pt-3 mt-3",children:"Please ensure all readings are accurate and submitted on time. Report any discrepancies or issues immediately. Stay safe and hydrated!"})]})]})},hf="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",DR=({db:r,userData:e,showNotification:t,customerToRead:n,onReadingSubmitted:i,isModalMode:s=!1,onCloseModal:o})=>{const[l,d]=X.useState(""),[f,m]=X.useState(!1),[p,g]=X.useState(""),[v,E]=X.useState(n||null),[x,b]=X.useState(""),[S,N]=X.useState(new Date().toISOString().split("T")[0]),[R,I]=X.useState("Actual"),[j,U]=X.useState(""),[P,k]=X.useState(!1),F=async M=>{if(M.preventDefault(),!l.trim()){t("Please enter a search term.","warning");return}m(!0),g(""),E(null);const D=await r0(r,l);D.success&&D.data.length>0?E(D.data[0]):D.success?g(`No customer found matching "${l}".`):g(D.error||"Failed to execute user search."),m(!1)},O=async M=>{if(M.preventDefault(),!v){t("No customer selected. Please search for a customer first.","error");return}if(!x||isNaN(parseFloat(x))||parseFloat(x)<0){t("Meter reading must be a valid, non-negative number.","warning");return}k(!0);const D={userId:v.id,accountNumber:v.accountNumber,meterSerialNumber:v.meterSerialNumber||"N/A",readingValue:parseFloat(x),readingDate:S,readingDateString:S,readingType:R,notes:j.trim(),readBy:e.displayName||e.email,readerId:e.uid},$=await r3(r,D);$.success?s&&i?i($.id,D):(t(`Reading for ${v.accountNumber} submitted successfully!`,"success"),d(""),E(null),b(""),U(""),I("Actual")):t($.error||"Failed to submit meter reading.","error"),k(!1)},C=["Actual","Estimated","No Reading","Customer Refused","Unable to Access Meter"];return c.jsxs("div",{className:s?"":"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[!s&&c.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(O2,{size:30,className:"mr-3 text-blue-600"})," Search & Submit Reading"]})}),!v&&!s&&c.jsxs("form",{onSubmit:F,className:"mb-6 p-4 bg-gray-50 rounded-lg shadow-sm",children:[c.jsx("label",{htmlFor:"customerSearchTerm",className:"block text-sm font-medium text-gray-700 mb-1",children:"Find Customer to Read"}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[c.jsxs("div",{className:"relative flex-grow",children:[c.jsx(Os,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx("input",{type:"text",id:"customerSearchTerm",value:l,onChange:M=>d(M.target.value),className:`${hf} pl-9`,placeholder:"Search by Account No, Name, or Meter No...",disabled:f})]}),c.jsxs("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2.5 px-6 rounded-lg flex items-center justify-center",disabled:f,children:[f?c.jsx(Tt,{size:18,className:"animate-spin mr-2"}):c.jsx(Os,{size:18,className:"mr-2"}),"Find"]})]}),p&&c.jsx("p",{className:"text-red-500 text-xs mt-2",children:p})]}),f&&c.jsx(ln,{message:"Searching..."}),v&&c.jsxs("form",{onSubmit:O,className:"space-y-5 p-4 border-t-4 border-blue-500 bg-blue-50 rounded-lg shadow-md animate-fadeIn",children:[c.jsxs("div",{className:"p-3 border border-blue-200 bg-white rounded-md text-sm space-y-1",children:[c.jsxs("p",{className:"font-semibold text-blue-800 flex items-center",children:[c.jsx(Rs,{size:16,className:"mr-2"}),v.displayName]}),c.jsxs("p",{className:"text-gray-600 flex items-center",children:[c.jsx(js,{size:14,className:"mr-2"}),"Account No: ",v.accountNumber]}),c.jsxs("p",{className:"text-gray-600 flex items-center",children:[c.jsx(ac,{size:14,className:"mr-2"}),"Meter No: ",v.meterSerialNumber||"N/A"]})]}),c.jsxs("fieldset",{disabled:P,className:"space-y-5",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"readingValue",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Meter Reading (m)*"}),c.jsx("input",{type:"number",id:"readingValue",value:x,onChange:M=>b(M.target.value),className:hf,step:"0.01",required:!0})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[c.jsxs("div",{children:[c.jsx("label",{htmlFor:"readingDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Reading Date*"}),c.jsx("input",{type:"date",id:"readingDate",value:S,onChange:M=>N(M.target.value),className:hf,required:!0})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"readingType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Reading Type*"}),c.jsx("select",{id:"readingType",value:R,onChange:M=>I(M.target.value),className:hf,required:!0,children:C.map(M=>c.jsx("option",{value:M,children:M},M))})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes / Remarks"}),c.jsx("textarea",{id:"notes",value:j,onChange:M=>U(M.target.value),rows:"3",className:hf,placeholder:"e.g., Meter obstructed, Dog on premises..."})]})]}),c.jsxs("div",{className:"flex gap-3",children:[s&&c.jsx("button",{type:"button",onClick:o,className:"w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2.5 px-6 rounded-lg",disabled:P,children:"Cancel"}),c.jsxs("button",{type:"submit",className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-2.5 px-6 rounded-lg flex items-center justify-center disabled:opacity-60",disabled:P,children:[P?c.jsx(Tt,{size:20,className:"animate-spin mr-2"}):c.jsx(Ha,{size:20,className:"mr-2"}),P?"Submitting...":"Submit Reading"]})]})]})]})},Z$="w-full px-3 py-2 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",Q$=({db:r,userData:e,showNotification:t})=>{const[n,i]=X.useState([]),[s,o]=X.useState(null),[l,d]=X.useState([]),[f,m]=X.useState(!0),[p,g]=X.useState(!1),[v,E]=X.useState(""),[x,b]=X.useState(""),[S,N]=X.useState(null),[R,I]=X.useState(!1),[j,U]=X.useState(""),P=X.useCallback(async($=!0)=>{if(!e||!e.uid){E("Meter reader ID not available. Cannot fetch routes."),m(!1);return}$&&m(!0),E("");const K=await i3(r,e.uid);if(K.success){const ee=K.data.map(se=>{var ie,re,G;return{...se,accountCount:se.accountCount||((ie=se.accountNumbers)==null?void 0:ie.length)||((re=se.accountIds)==null?void 0:re.length)||0,completedCount:se.completedReadingsToday||0,pendingCount:Math.max(0,(se.accountCount||((G=se.accountNumbers)==null?void 0:G.length)||0)-(se.completedReadingsToday||0))}});i(ee.sort((se,ie)=>(se.name||"").localeCompare(ie.name||"")))}else{const ee=K.error||"Failed to fetch assigned routes.";E(ee),i([])}$&&m(!1)},[r,e]);X.useEffect(()=>{P()},[P]);const k=X.useCallback(async $=>{if(!$)return;g(!0),b("");const K=await h9(r,$);if(K.success){const ee=new Date().toISOString().split("T")[0],se=await Promise.all(K.data.map(async ie=>{var Z;let re={readingValue:"",readingDate:null},G=!1;const z=await N9(r,ie.accountNumber);if(z.success&&z.data.length>0){const J=z.data[0];re.readingValue=J.readingValue,re.readingDate=(Z=J.readingDate)!=null&&Z.toDate?J.readingDate.toDate():new Date(J.readingDate),J.readingDate.toDate().toISOString().split("T")[0]===ee&&(G=!0)}return{...ie,lastReading:re.readingValue,lastReadingDateDisplay:re.readingDate?Mt(re.readingDate,{month:"short",day:"numeric"}):"",readingStatus:G?"Completed Today":"Pending"}}));d(se.sort((ie,re)=>{var G,z;return(((G=ie.serviceAddress)==null?void 0:G.street)||"").localeCompare(((z=re.serviceAddress)==null?void 0:z.street)||"")}))}else{const ee=K.error||`Failed to fetch accounts for route ${$.name}.`;b(ee),d([])}g(!1)},[r]),F=$=>{(s==null?void 0:s.id)!==($==null?void 0:$.id)&&(o($),U(""),d([]),$&&k($))},O=$=>{N($),I(!0)},C=($,K)=>{if(t(`Reading for ${K.accountNumber} submitted successfully.`,"success"),d(ee=>ee.map(se=>se.accountNumber===K.accountNumber?{...se,readingStatus:"Completed Today",lastReading:K.readingValue,lastReadingDateDisplay:Mt(new Date,{month:"short",day:"numeric"})}:se)),s){const ee=n.map(ie=>{if(ie.id===s.id){const re=(ie.completedCount||0)+1;return{...ie,completedCount:re,pendingCount:Math.max(0,ie.accountCount-re)}}return ie});i(ee);const se=ee.find(ie=>ie.id===s.id);se&&o(se)}I(!1),N(null)},M=$=>!$||typeof $!="object"?"":[$.street,$.barangay,$.district].filter(ee=>ee&&ee.trim()).join(", "),D=l.filter($=>{var se,ie,re;const K=j.toLowerCase(),ee=M($.serviceAddress).toLowerCase();return((se=$.displayName)==null?void 0:se.toLowerCase().includes(K))||((ie=$.accountNumber)==null?void 0:ie.toLowerCase().includes(K))||ee.includes(K)||((re=$.meterSerialNumber)==null?void 0:re.toLowerCase().includes(K))});return f?c.jsx(ln,{message:"Loading your assigned routes...",className:"mt-10 h-64"}):v&&n.length===0?c.jsxs("div",{className:"text-center py-10 bg-red-50 p-4 rounded-lg",children:[c.jsx(Zt,{size:48,className:"mx-auto text-red-400 mb-3"}),c.jsx("p",{className:"text-red-600 text-lg font-semibold",children:"Error Loading Routes"}),c.jsx("p",{className:"text-sm text-red-500 mt-1",children:v})]}):c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(lc,{size:30,className:"mr-3 text-blue-600"})," Assigned Routes & Meter Reading"]}),c.jsxs("button",{onClick:()=>P(!1),className:"mt-3 sm:mt-0 text-sm flex items-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-3 rounded-lg border border-gray-300 transition-colors",disabled:f||p,title:"Refresh Route List",children:[c.jsx(qa,{size:16,className:`mr-1.5 ${f?"animate-spin":""}`}),"Refresh Routes"]})]}),n.length===0&&!f&&!v&&c.jsxs("div",{className:"text-center py-10 bg-gray-50 rounded-lg p-4",children:[c.jsx(yn,{size:48,className:"mx-auto text-gray-400 mb-3"}),c.jsx("p",{className:"text-gray-500 text-lg",children:"No routes are currently assigned to you."})]}),n.length>0&&c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[c.jsxs("div",{className:"lg:col-span-1 bg-slate-50 p-3.5 rounded-lg shadow-md max-h-[75vh] overflow-y-auto",children:[c.jsxs("h3",{className:"text-md font-semibold text-slate-700 mb-3 sticky top-0 bg-slate-50 py-2 z-10 border-b border-slate-200",children:["My Routes (",n.length,")"]}),c.jsx("div",{className:"space-y-2.5",children:n.map($=>c.jsxs("button",{onClick:()=>F($),className:`w-full text-left p-3 rounded-lg border-2 transition-all duration-200 transform hover:scale-[1.02] focus:outline-none focus:ring-2 focus:ring-offset-1
                                        ${(s==null?void 0:s.id)===$.id?"bg-blue-600 text-white shadow-lg border-blue-700 ring-blue-500":"bg-white hover:bg-blue-50 border-gray-200 hover:border-blue-400"}`,children:[c.jsx("p",{className:`font-semibold text-sm ${(s==null?void 0:s.id)===$.id?"text-white":"text-blue-700"}`,children:$.name}),c.jsxs("p",{className:`text-xs mt-0.5 ${(s==null?void 0:s.id)===$.id?"text-blue-100":"text-gray-500"}`,children:["Area: ",$.areaCode||""]}),c.jsxs("div",{className:"mt-1.5 text-xs",children:[c.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-white text-[10px] ${($.pendingCount||0)>0?"bg-orange-500":"bg-green-500"}`,children:($.pendingCount||0)===0&&$.accountCount>0?"All Read":`${$.pendingCount} Pending`}),c.jsxs("span",{className:`ml-1.5 ${(s==null?void 0:s.id)===$.id?"text-blue-200":"text-gray-400"}`,children:["(",$.completedCount||0," / ",$.accountCount||0,")"]})]})]},$.id))})]}),c.jsxs("div",{className:"lg:col-span-3",children:[!s&&!p&&c.jsxs("div",{className:"p-6 text-center text-gray-400 bg-slate-50 rounded-lg shadow-inner h-full flex flex-col justify-center items-center min-h-[300px]",children:[c.jsx(l3,{size:48,className:"mb-3 opacity-70"}),c.jsx("p",{className:"text-lg",children:"Please select a route to view accounts."})]}),s&&p&&c.jsx(ln,{message:`Loading accounts for ${s.name}...`,className:"min-h-[300px]"}),s&&!p&&c.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg shadow-md",children:[c.jsxs("div",{className:"pb-2 mb-3 border-b border-slate-200",children:[c.jsxs("h3",{className:"text-lg font-semibold text-slate-700",children:["Accounts in: ",s.name]}),c.jsx("p",{className:"text-xs text-slate-500",children:s.description||"No route description provided."})]}),c.jsxs("div",{className:"relative mb-4",children:[c.jsx(Os,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"}),c.jsx("input",{type:"text",placeholder:"Search by Name, Account No, Address...",value:j,onChange:$=>U($.target.value),className:`${Z$} pl-9`})]}),x&&c.jsx("p",{className:"text-sm text-red-500 text-center py-3 bg-red-50 rounded-md",children:x}),c.jsx("div",{className:"space-y-3 max-h-[65vh] overflow-y-auto pr-1 pb-2",children:D.length>0?D.map($=>c.jsxs("div",{className:`p-3.5 border rounded-lg flex flex-col sm:flex-row justify-between items-start sm:items-center transition-shadow hover:shadow-md 
                                            ${$.readingStatus==="Completed Today"?"bg-green-50 border-green-300":"bg-white border-gray-200 hover:border-blue-400"}`,children:[c.jsxs("div",{className:"flex-grow mb-2 sm:mb-0",children:[c.jsxs("p",{className:"font-medium text-slate-800 text-sm",children:[$.displayName," ",c.jsxs("span",{className:"text-xs text-slate-500 font-mono",children:["(",$.accountNumber,")"]})]}),c.jsx("p",{className:"text-xs text-slate-600 mt-0.5",children:M($.serviceAddress)}),c.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:["Meter: ",$.meterSerialNumber," | Last Reading: ",$.lastReading||""," ",$.lastReadingDateDisplay?`on ${$.lastReadingDateDisplay}`:""]}),c.jsxs("p",{className:`text-xs font-semibold mt-1 ${$.readingStatus==="Completed Today"?"text-green-600":"text-orange-600"}`,children:["Status: ",$.readingStatus]})]}),c.jsxs("button",{onClick:()=>O($),className:`text-xs font-medium py-1.5 px-3.5 rounded-md flex items-center transition-colors active:scale-95 whitespace-nowrap
                                                    ${$.readingStatus==="Completed Today"?"bg-yellow-500 hover:bg-yellow-600 text-white":"bg-blue-600 hover:bg-blue-700 text-white"}`,title:$.readingStatus==="Completed Today"?"Review or Edit Reading":"Submit New Reading",children:[c.jsx(F2,{size:13,className:"mr-1.5"})," ",$.readingStatus==="Completed Today"?"Edit":"Enter Reading"]})]},$.id||$.accountNumber)):c.jsxs("div",{className:"py-6 text-center text-gray-500",children:[c.jsx(Rs,{size:36,className:"mx-auto mb-2 text-gray-400"}),"No accounts ",j?"match your search.":"found for this route."]})})]})]})]}),R&&S&&c.jsx(Vr,{isOpen:R,onClose:()=>{I(!1),N(null)},title:`Meter Reading: ${S.displayName} (${S.accountNumber})`,size:"lg",children:c.jsx(DR,{db:r,userData:e,showNotification:t,customerToRead:S,onReadingSubmitted:C,isModalMode:!0,onCloseModal:()=>{I(!1),N(null)}})})]})},X$="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",J$=({db:r,showNotification:e})=>{const[t,n]=X.useState(""),[i,s]=X.useState(null),[o,l]=X.useState(!1),[d,f]=X.useState(""),m=async v=>{if(v.preventDefault(),!t.trim()){e("Please enter a search term (Account No., Name, or Meter No.).","warning");return}l(!0),f(""),s(null);try{const E=await r0(r,t);E.success&&E.data.length>0?s(E.data[0]):E.success?f(`No customer found matching "${t}".`):f(E.error||"Failed to search for users.")}catch{f("An error occurred during the search.")}l(!1)},p=v=>!v||typeof v!="object"?v||"":[v.street,v.barangay,v.district,"Naic, Cavite"].filter(x=>x&&x.trim()).join(", "),g=({label:v,value:E,icon:x})=>c.jsxs("div",{className:"flex items-start py-2 border-b border-gray-100",children:[x&&c.jsx(x,{size:16,className:"mr-2.5 text-blue-500 flex-shrink-0 mt-0.5"}),c.jsxs("span",{className:"text-xs font-medium text-gray-500 w-32 sm:w-40",children:[v,":"]}),c.jsx("span",{className:"text-sm text-gray-800 flex-1 break-words",children:E||""})]});return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(Os,{size:30,className:"mr-3 text-blue-600"})," Search Customer Profile"]})}),c.jsxs("form",{onSubmit:m,className:"mb-8 p-4 bg-gray-50 rounded-lg shadow",children:[c.jsx("label",{htmlFor:"customerSearchTerm",className:"block text-sm font-medium text-gray-700 mb-1",children:"Find Customer"}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[c.jsxs("div",{className:"relative flex-grow",children:[c.jsx(Rs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx("input",{type:"text",id:"customerSearchTerm",value:t,onChange:v=>n(v.target.value),className:`${X$} pl-9`,placeholder:"Account No, Name, or Meter No."})]}),c.jsxs("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2.5 px-6 rounded-lg flex items-center justify-center sm:w-auto w-full",disabled:o,children:[o?c.jsx(Tt,{size:18,className:"animate-spin mr-2"}):c.jsx(Os,{size:18,className:"mr-2"}),"Search Customer"]})]}),d&&c.jsx("p",{className:"text-red-600 text-xs mt-2",children:d})]}),o&&c.jsx(ln,{message:"Searching for customer..."}),!o&&i&&c.jsxs("div",{className:"mt-6 p-5 border border-blue-200 bg-blue-50 rounded-lg shadow-md animate-fadeIn",children:[c.jsx("h3",{className:"text-xl font-semibold text-blue-700 mb-4 border-b border-blue-200 pb-2",children:"Customer Details"}),c.jsxs("div",{className:"space-y-1",children:[c.jsx(g,{label:"Account Name",value:i.displayName,icon:Rs}),c.jsx(g,{label:"Account Number",value:i.accountNumber,icon:js}),c.jsx(g,{label:"Email Address",value:i.email,icon:Fo}),c.jsx(g,{label:"Service Address",value:p(i.serviceAddress),icon:co}),c.jsx(g,{label:"Meter Serial No.",value:i.meterSerialNumber,icon:ac}),c.jsx(g,{label:"Meter Size",value:i.meterSize,icon:ac}),c.jsx(g,{label:"Service Type",value:i.serviceType,icon:yn}),c.jsx(g,{label:"Account Status",value:i.accountStatus,icon:i.accountStatus==="Active"?Cs:Zt})]})]})]})},eW=({userData:r,showNotification:e,setActiveSection:t,db:n})=>{const[i,s]=X.useState({paymentsTodayCount:0,totalCollectedToday:0,avgPaymentAmount:0}),[o,l]=X.useState([]),[d,f]=X.useState(!0),[m,p]=X.useState(""),g=X.useCallback(async()=>{if(!r||!r.uid){f(!1),p("Clerk user data is not available.");return}f(!0),p("");try{const b=await k9(n,r.uid);if(b.success&&b.data){const{paymentsTodayCount:S,totalCollectedToday:N,transactions:R}=b.data,I=R.reduce((j,U)=>{const P=U.paymentMethod||"Other";return j[P]=(j[P]||0)+(U.amountPaid||0),j},{});s({paymentsTodayCount:S,totalCollectedToday:N,avgPaymentAmount:S>0?N/S:0,paymentMethodSummary:I}),l(R)}else p(b.error||"Today's payment data unavailable.")}catch{p("Could not load clerk dashboard statistics. Please try refreshing.")}finally{f(!1)}},[r,n]);X.useEffect(()=>{g()},[g]);const v=()=>{const b=document.getElementById("eod-report-content"),S=document.getElementById("clerk-print-styles");if(b&&S){const N=window.open("","","height=800,width=1000");N.document.write("<html><head><title>Cashier Daily Collection Report</title>"),N.document.write("<style>"+S.innerHTML+"</style>"),N.document.write('</head><body><div class="printable-area">'),N.document.write(b.innerHTML),N.document.write("</div><script>"),N.document.write("window.onload = function() { setTimeout(function() { window.print(); window.close(); }, 750); };"),N.document.write("<\/script></body></html>"),N.document.close()}},E=[{title:"Process Walk-in Payment",icon:cy,section:"walkInPayments",description:"Record payments for customers paying in person at the counter.",color:"blue"},{title:"Search Account / Bill",icon:D2,section:"searchAccountOrBill",description:"Look up customer account details, outstanding bills, or payment history.",color:"teal"}],x=()=>c.jsx("span",{className:"font-bold",children:""});return d?c.jsx(ln,{message:"Loading clerk dashboard...",className:"mt-10 h-48"}):c.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[c.jsx("style",{id:"clerk-print-styles",children:`
                @page {
                    size: A4 portrait;
                    margin: 0.75in;
                }
                body { 
                    font-family: 'Times New Roman', Times, serif; 
                    -webkit-print-color-adjust: exact !important; 
                    print-color-adjust: exact !important; 
                    color: #000;
                    font-size: 10pt;
                }
                .printable-area { 
                    max-width: 100%;
                    margin: auto; 
                }
                .report-header { 
                    display: flex;
                    justify-content: space-between;
                    align-items: flex-start;
                    text-align: left;
                    border-bottom: 2px solid #000; 
                    padding-bottom: 1rem; 
                }
                .report-header .logo-print { 
                    font-size: 2.5rem; 
                    font-weight: 700; 
                    color: #1e3a8a !important; 
                    line-height: 1;
                    margin: 0; 
                }
                .report-header .tagline-print { 
                    font-size: 0.8rem; 
                    color: #1d4ed8 !important; 
                    font-style: italic;
                    margin: 0;
                }
                .report-header .company-address-print {
                    text-align: right;
                    font-size: 0.8rem;
                    line-height: 1.4;
                    color: #374151 !important;
                }
                h1.report-title { 
                    font-size: 1.5rem; 
                    font-weight: 700; 
                    color: #000 !important; 
                    margin-top: 1.5rem; 
                    margin-bottom: 1rem; 
                    text-align: center;
                    text-transform: uppercase;
                }
                .report-section { 
                    margin-top: 1.5rem; 
                    page-break-inside: avoid;
                }
                .report-section h2 { 
                    font-size: 1.25rem; 
                    font-weight: 700; 
                    border-bottom: 1px solid #4b5563; 
                    padding-bottom: 0.25rem; 
                    margin-bottom: 1rem; 
                    color: #111827 !important;
                }
                .info-table { 
                    width: 100%; 
                    font-size: 10pt;
                }
                .info-table td { 
                    padding: 4px 0; 
                    vertical-align: top;
                }
                .info-table td:nth-child(odd) { 
                    font-weight: 700; 
                    color: #374151 !important; 
                    width: auto; 
                    white-space: nowrap; 
                    padding-right: 1rem; 
                }
                .summary-grid { 
                    display: grid !important; 
                    grid-template-columns: repeat(3, 1fr) !important; 
                    gap: 1.5rem; 
                }
                .summary-card { 
                    background-color: #f9fafb !important; 
                    border: 1px solid #e5e7eb; 
                    padding: 1.25rem; 
                    border-radius: 0.5rem; 
                    text-align: center; 
                }
                .summary-card p { 
                    margin: 0; 
                    font-size: 0.875rem; 
                    font-weight: 600;
                    text-transform: uppercase; 
                    color: #4b5563 !important; 
                }
                .summary-card span { 
                    font-size: 1.875rem; 
                    font-weight: 700; 
                    color: #000 !important; 
                    display: block; 
                    margin-top: 0.25rem;
                }
                table.data-table { 
                    width: 100%; 
                    border-collapse: collapse; 
                    margin-top: 1rem; 
                    font-size: 9.5pt;
                }
                .data-table th, .data-table td { 
                    border: 1px solid #d1d5db; 
                    padding: 0.5rem 0.75rem; 
                    text-align: left; 
                }
                .data-table th { 
                    background-color: #f3f4f6 !important; 
                    font-weight: 700; 
                    text-transform: uppercase;
                    font-size: 0.75rem;
                    color: #374151 !important;
                }
                .data-table .text-right { text-align: right; }
                .data-table .font-mono { font-family: "Courier New", Courier, monospace; }
                .data-table .font-semibold { font-weight: 600; }
                .data-table .total-row td {
                    font-weight: 700;
                    font-size: 1.125rem;
                    background-color: #f3f4f6 !important;
                    border-top: 2px solid #374151;
                }
                .report-footer { 
                    margin-top: 4rem; 
                    padding-top: 2rem; 
                    border-top: 1px solid #9ca3af; 
                }
                .signature-line { 
                    width: 60%; 
                    margin: 2rem auto 0 auto; 
                    border-top: 1px solid #333; 
                    padding-top: 8px; 
                    text-align: center; 
                }
                @media print {
                    .no-print { display: none !important; }
                    body { margin: 0; font-size: 10pt; }
                    .printable-area { padding: 0 !important; box-shadow: none !important; border: none !important; }
                }
            `}),c.jsx("div",{className:"p-6 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl shadow-xl no-print",children:c.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl sm:text-3xl font-bold",children:"Clerk / Cashier Dashboard"}),c.jsxs("p",{className:"mt-1 text-indigo-100",children:["Welcome, ",r.displayName||"Clerk","! Manage payments and customer inquiries."]})]}),c.jsxs("button",{onClick:g,className:"mt-3 sm:mt-0 text-sm flex items-center bg-indigo-400 hover:bg-indigo-300 text-white font-medium py-2 px-3 rounded-lg transition-colors disabled:opacity-70 self-start sm:self-center",disabled:d,title:"Refresh Statistics",children:[d?c.jsx(Tt,{size:16,className:"animate-spin"}):c.jsx(qa,{size:16}),c.jsx("span",{className:"ml-2 hidden sm:inline",children:"Refresh"})]})]})}),m&&c.jsxs("p",{className:"text-sm text-yellow-600 bg-yellow-50 p-3 rounded-md text-center my-4 flex items-center justify-center gap-2 no-print",children:[c.jsx(yn,{size:16})," ",m]}),c.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 no-print",children:[c.jsx(fi,{title:"Payments Today",value:i.paymentsTodayCount,icon:cy,borderColor:"border-green-500",iconColor:"text-green-500",onClick:()=>{var b;return(b=document.getElementById("eod-report-wrapper"))==null?void 0:b.scrollIntoView({behavior:"smooth"})}}),c.jsx(fi,{title:"Total Collected Today",value:`${i.totalCollectedToday.toLocaleString("en-US",{minimumFractionDigits:2})}`,icon:x,borderColor:"border-emerald-500",iconColor:"text-emerald-500"}),c.jsx(fi,{title:"Avg. Payment Today",value:`${i.avgPaymentAmount.toLocaleString("en-US",{minimumFractionDigits:2})}`,icon:x,borderColor:"border-teal-500",iconColor:"text-teal-500"})]}),c.jsxs("div",{className:"no-print",children:[c.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-5 mt-8 pt-5 border-t border-gray-200",children:"Primary Tasks"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:E.map(b=>c.jsxs("button",{onClick:()=>t(b.section),className:`p-6 bg-white rounded-xl shadow-lg hover:shadow-2xl transform hover:-translate-y-1.5 transition-all duration-300 ease-in-out text-left focus:outline-none focus:ring-2 focus:ring-${b.color}-500 focus:ring-opacity-75 group h-full flex flex-col`,children:[c.jsx("div",{className:`p-3 bg-${b.color}-100 rounded-full inline-block mb-3 self-start group-hover:scale-110 transition-transform`,children:c.jsx(b.icon,{size:28,className:`text-${b.color}-600`})}),c.jsx("h4",{className:`text-lg font-semibold text-gray-800 group-hover:text-${b.color}-700 transition-colors`,children:b.title}),c.jsx("p",{className:"text-sm text-gray-500 mt-1 leading-normal flex-grow",children:b.description})]},b.section))})]}),c.jsxs("div",{id:"eod-report-wrapper",className:"mt-8 p-3 sm:p-5 bg-gray-50 rounded-xl shadow",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4 no-print",children:[c.jsxs("h3",{className:"text-lg font-semibold text-gray-700 flex items-center",children:[c.jsx(hi,{size:20,className:"mr-2 text-gray-500"})," Shift Summary / End-of-Day Report"]}),c.jsxs("button",{onClick:v,className:"flex items-center bg-blue-500 text-white text-xs font-semibold px-3 py-1.5 rounded-lg hover:bg-blue-600 transition-colors",children:[c.jsx(V2,{size:14,className:"mr-1.5"})," Print Report"]})]}),c.jsxs("div",{id:"eod-report-content",className:"bg-white p-6 sm:p-10 rounded-lg border border-gray-200 text-gray-800 text-[10pt] leading-normal printable-area",children:[c.jsxs("div",{className:"report-header",children:[c.jsxs("div",{children:[c.jsx("h1",{className:"logo-print",children:"AGWA"}),c.jsx("p",{className:"tagline-print",children:"Ensuring Clarity, Sustaining Life."})]}),c.jsxs("div",{className:"company-address-print",children:[c.jsx("strong",{children:"AGWA Water Services, Inc."}),c.jsx("br",{}),"AGWA Water Services Bldg., Governor's Drive",c.jsx("br",{}),"Brgy. Ibayo Silangan, Naic, Cavite 4110"]})]}),c.jsx("h1",{className:"report-title",children:"CASHIER'S DAILY COLLECTION REPORT"}),c.jsx("div",{className:"report-section mt-6",children:c.jsx("table",{className:"info-table w-full",children:c.jsxs("tbody",{children:[c.jsxs("tr",{className:"!border-none",children:[c.jsx("td",{className:"font-semibold text-gray-600 !pr-4 !border-none !p-1",children:"Cashier Name:"}),c.jsx("td",{className:"font-medium !border-none !p-1",children:r.displayName}),c.jsx("td",{className:"font-semibold text-gray-600 !pr-4 !border-none !p-1",children:"Report Date:"}),c.jsx("td",{className:"font-medium !border-none !p-1",children:Mt(new Date,{year:"numeric",month:"long",day:"numeric"})})]}),c.jsxs("tr",{className:"!border-none",children:[c.jsx("td",{className:"font-semibold text-gray-600 !pr-4 !border-none !p-1",children:"Cashier ID:"}),c.jsx("td",{className:"font-mono !border-none !p-1",children:r.accountNumber||r.uid.substring(0,10)}),c.jsx("td",{className:"font-semibold text-gray-600 !pr-4 !border-none !p-1",children:"Time Generated:"}),c.jsx("td",{className:"font-medium !border-none !p-1",children:Mt(new Date,{hour:"2-digit",minute:"2-digit",hour12:!0})})]})]})})}),c.jsxs("section",{className:"report-section mt-8",children:[c.jsx("h2",{className:"text-lg font-semibold border-b border-gray-300 pb-2 mb-4 text-gray-700",children:"Collection Summary"}),c.jsxs("div",{className:"summary-grid grid grid-cols-1 sm:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"summary-card bg-gray-50 border border-gray-200 p-4 rounded-lg text-center",children:[c.jsx("p",{className:"text-sm font-medium text-gray-500 uppercase",children:"Total Collected"}),c.jsxs("span",{className:"text-2xl font-bold text-gray-800",children:["",i.totalCollectedToday.toLocaleString("en-US",{minimumFractionDigits:2})]})]}),c.jsxs("div",{className:"summary-card bg-gray-50 border border-gray-200 p-4 rounded-lg text-center",children:[c.jsx("p",{className:"text-sm font-medium text-gray-500 uppercase",children:"Total Transactions"}),c.jsx("span",{className:"text-2xl font-bold text-gray-800",children:i.paymentsTodayCount})]}),c.jsxs("div",{className:"summary-card bg-gray-50 border border-gray-200 p-4 rounded-lg text-center",children:[c.jsx("p",{className:"text-sm font-medium text-gray-500 uppercase",children:"Average Transaction"}),c.jsxs("span",{className:"text-2xl font-bold text-gray-800",children:["",i.avgPaymentAmount.toLocaleString("en-US",{minimumFractionDigits:2})]})]})]})]}),i.paymentMethodSummary&&Object.keys(i.paymentMethodSummary).length>0&&c.jsxs("section",{className:"report-section mt-8",children:[c.jsx("h2",{className:"text-lg font-semibold border-b border-gray-300 pb-2 mb-4 text-gray-700",children:"Breakdown by Payment Method"}),c.jsxs("table",{className:"data-table w-full border-collapse text-sm",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"border p-2 text-left text-xs font-semibold text-gray-600 uppercase",children:"Payment Method"}),c.jsx("th",{className:"border p-2 text-right text-xs font-semibold text-gray-600 uppercase",children:"Total Amount (PHP)"})]})}),c.jsxs("tbody",{children:[Object.entries(i.paymentMethodSummary).map(([b,S])=>c.jsxs("tr",{className:"border-b",children:[c.jsx("td",{className:"border p-2.5",children:b}),c.jsxs("td",{className:"border p-2.5 text-right font-semibold",children:["",S.toLocaleString("en-US",{minimumFractionDigits:2})]})]},b)),c.jsxs("tr",{className:"total-row bg-gray-100",children:[c.jsx("td",{className:"border p-3 font-bold text-base",children:"GRAND TOTAL"}),c.jsxs("td",{className:"border p-3 text-right font-bold text-base",children:["",i.totalCollectedToday.toLocaleString("en-US",{minimumFractionDigits:2})]})]})]})]})]}),c.jsxs("section",{className:"report-section mt-8",children:[c.jsx("h2",{className:"text-lg font-semibold border-b border-gray-300 pb-2 mb-4 text-gray-700",children:"Transaction Log (Today)"}),o.length>0?c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"data-table w-full border-collapse text-sm",children:[c.jsx("thead",{className:"bg-gray-100",children:c.jsxs("tr",{children:[c.jsx("th",{className:"border p-2 text-left text-xs font-semibold text-gray-600 uppercase",children:"Time"}),c.jsx("th",{className:"border p-2 text-left text-xs font-semibold text-gray-600 uppercase",children:"Account #"}),c.jsx("th",{className:"border p-2 text-left text-xs font-semibold text-gray-600 uppercase",children:"Reference #"}),c.jsx("th",{className:"border p-2 text-right text-xs font-semibold text-gray-600 uppercase",children:"Amount (PHP)"})]})}),c.jsx("tbody",{children:o.map(b=>{var S,N;return c.jsxs("tr",{className:"border-b",children:[c.jsx("td",{className:"border p-2.5 whitespace-nowrap",children:Mt((S=b.paymentTimestamp)==null?void 0:S.toDate(),{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})}),c.jsx("td",{className:"border p-2.5 whitespace-nowrap font-mono",children:b.accountNumber}),c.jsx("td",{className:"border p-2.5 whitespace-nowrap font-mono",children:b.paymentReference}),c.jsxs("td",{className:"border p-2.5 whitespace-nowrap text-right font-semibold",children:["",(N=b.amountPaid)==null?void 0:N.toFixed(2)]})]},b.id)})})]})}):c.jsxs("div",{className:"text-center py-10 bg-gray-50 rounded-md border",children:[c.jsx(yn,{size:32,className:"mx-auto text-gray-400 mb-2"}),c.jsx("p",{className:"text-gray-500",children:"No payments have been processed yet today."})]})]}),c.jsx("footer",{className:"report-footer mt-16 pt-8 border-t border-gray-400",children:c.jsxs("div",{className:"signature-line w-3/5 mx-auto border-t border-gray-700 pt-2 text-center",children:[c.jsx("p",{className:"text-sm font-semibold",children:r.displayName}),c.jsx("p",{className:"text-xs text-gray-600",children:"Cashier's Signature Over Printed Name"})]})})]})]})]})},ff="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",tW=({db:r,userData:e,showNotification:t,billingService:n})=>{const[i,s]=X.useState(""),[o,l]=X.useState(null),[d,f]=X.useState([]),[m,p]=X.useState(null),[g,v]=X.useState(""),[E,x]=X.useState("Cash"),[b,S]=X.useState(""),[N,R]=X.useState({}),[I,j]=X.useState(!1),[U,P]=X.useState(!1),[k,F]=X.useState(!1),[O,C]=X.useState(null),[M,D]=X.useState("");X.useEffect(()=>{i0(r).then(G=>{G.success&&R(G.data||{})})},[r]);const $=async G=>{if(G&&G.preventDefault(),!i.trim()){t("Please enter an Account Number to search.","warning");return}j(!0),D(""),l(null),f([]),p(null),v(""),C(null);try{const z=await r0(r,i.trim());if(z.success&&z.data.length>0){const Z=z.data.find(J=>J.accountNumber.toLowerCase()===i.trim().toLowerCase());Z?(l(Z),K(Z)):D(`No customer found with Account Number: "${i}".`)}else D(`No customer found with Account Number: "${i}".`)}catch{D("An error occurred during customer search.")}j(!1)},K=async G=>{P(!0);const z=await _u(r,G.id);if(z.success){const Z=z.data.filter(J=>J.status==="Unpaid").map(J=>{const le=((J.calculatedCharges||n(J.consumption,G.serviceType,G.meterSize,N)).totalCalculatedCharges||0)+(J.previousUnpaidAmount||0)-(J.seniorCitizenDiscount||0),Q=N2(J,N),ce=le+Q;return{...J,amount:ce,displayPenalty:Q}}).sort((J,ae)=>{var le,Q;return new Date(((le=J.dueDate)==null?void 0:le.toDate())||0)-new Date(((Q=ae.dueDate)==null?void 0:Q.toDate())||0)});f(Z),Z.length===0&&t(`No unpaid bills found for Account #${G.accountNumber}.`,"info")}else t(z.error||"Failed to fetch customer bills.","error");P(!1)};X.useEffect(()=>{var G;if(m)v(((G=m.amount)==null?void 0:G.toFixed(2))||"");else if(d.length===0)v("");else if(d.length>0&&!d.find(z=>z.id===(m==null?void 0:m.id))){const z=d.reduce((Z,J)=>Z+(J.amount||0),0);v(z>0?z.toFixed(2):"")}},[m,d]);const ee=async G=>{if(G.preventDefault(),!m&&d.length===0){t("No bill selected or available for payment.","warning");return}const z=parseFloat(g);if(isNaN(z)||z<=0){t("Please enter a valid payment amount.","warning");return}if(E!=="Cash"&&!b.trim()){t("Reference number is required for this payment method.","warning");return}F(!0),C(null);const Z=m||d.find(J=>J.status==="Unpaid");if(!Z){t("Cannot determine which bill to pay. Please select a bill.","warning"),F(!1);return}if(z<Z.amount){t(`Partial payments are not supported. Amount must be ${Z.amount.toFixed(2)}.`,"warning"),F(!1);return}try{const J=Sn(),ae=new Date,le=await n3(r,Z.id,{status:"Paid",paymentDate:ae,paymentTimestamp:J,amountPaid:z,paymentMethod:E,paymentReference:b.trim()||`CASH-${Date.now().toString().slice(-8)}`,processedByClerkId:e.uid,processedByClerkName:e.displayName});if(!le.success)throw new Error(le.error||"Failed to update bill status.");const Q={customerName:o.displayName,accountNumber:o.accountNumber,serviceAddress:o.serviceAddress,billId:Z.id,billMonthYear:Z.monthYear||Z.billingPeriod,amountPaid:z,paymentDate:ae,paymentMethod:E,referenceNumber:b.trim()||`CASH-${Date.now().toString().slice(-8)}`,processedBy:e.displayName,receiptId:`OR-${Date.now()}`};C(Q),t(`Payment of ${z.toFixed(2)} processed successfully!`,"success"),v(""),S(""),p(null),K(o)}catch(J){t(J.message||"An error occurred while processing the payment.","error")}F(!1)},se=()=>{const G=document.getElementById("payment-receipt-content");if(G){const z=window.open("","_blank","height=800,width=1000");z.document.write("<html><head><title>AGWA Payment Receipt</title>"),z.document.write('<script src="https://cdn.tailwindcss.com"><\/script>'),z.document.write(`
                <style>
                    body { font-family: 'Inter', sans-serif; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                    .paid-stamp {
                        position: absolute;
                        top: 50%;
                        left: 50%;
                        transform: translate(-50%, -50%) rotate(-30deg);
                        font-size: 4rem;
                        font-weight: bold;
                        color: rgba(0, 128, 0, 0.15);
                        z-index: -1;
                        letter-spacing: 0.1em;
                        border: 8px solid rgba(0, 128, 0, 0.15);
                        padding: 0.5em 1em;
                        border-radius: 10px;
                        text-transform: uppercase;
                    }
                    .no-print { display: none; }
                </style>
            `),z.document.write('</head><body class="bg-gray-100 p-4">'),z.document.write(G.innerHTML),z.document.write("</body></html>"),z.document.close(),setTimeout(()=>z.print(),700)}},ie=["Cash","Check","Card (Debit/Credit)","E-wallet (GCash/Maya)"],re=({label:G,value:z})=>c.jsxs("div",{className:"flex justify-between py-1.5 text-sm border-b border-gray-200 last:border-b-0",children:[c.jsxs("span",{className:"text-gray-500",children:[G,":"]}),c.jsx("span",{className:"font-medium text-gray-800 text-right",children:z})]});return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[!O&&c.jsxs(c.Fragment,{children:[c.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(cy,{size:30,className:"mr-3 text-green-600"})," Process Walk-in Payment"]})}),c.jsxs("form",{onSubmit:$,className:"mb-6 p-4 bg-gray-50 rounded-lg shadow",children:[c.jsx("label",{htmlFor:"accountNumberSearch",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Customer by Account Number"}),c.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[c.jsxs("div",{className:"relative flex-grow",children:[c.jsx(js,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx("input",{type:"text",id:"accountNumberSearch",value:i,onChange:G=>s(G.target.value),className:`${ff} pl-9`,placeholder:"Enter Account Number"})]}),c.jsxs("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2.5 px-5 rounded-lg flex items-center justify-center sm:w-auto w-full",disabled:I,children:[I?c.jsx(Tt,{size:18,className:"animate-spin mr-2"}):c.jsx(Os,{size:18,className:"mr-2"})," Find Customer"]})]}),M&&!I&&c.jsx("p",{className:"text-red-500 text-xs mt-2",children:M})]})]}),I&&c.jsx(ln,{message:"Searching for customer..."}),o&&!O&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"mb-6 p-4 border border-blue-200 bg-blue-50 rounded-lg shadow",children:[c.jsxs("h3",{className:"text-lg font-semibold text-blue-700 mb-2 flex items-center",children:[c.jsx(Rs,{size:20,className:"mr-2"})," ",o.displayName,c.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["(",o.accountNumber,")"]})]}),U&&c.jsx(ln,{message:"Loading bills..."}),!U&&d.length===0&&c.jsx("p",{className:"text-sm text-green-600 mt-2",children:"No unpaid bills found for this customer."}),!U&&d.length>0&&c.jsxs("div",{className:"mt-3",children:[c.jsx("label",{htmlFor:"selectBill",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Bill to Pay (or pay total outstanding):"}),c.jsxs("select",{id:"selectBill",className:ff,value:m?m.id:"",onChange:G=>{const z=d.find(Z=>Z.id===G.target.value);p(z||null)},children:[c.jsx("option",{value:"",children:"Pay Total Unpaid / Select Specific Bill"}),d.map(G=>{var z,Z;return c.jsxs("option",{value:G.id,children:[G.monthYear||G.billingPeriod," - ",(z=G.amount)==null?void 0:z.toFixed(2)," (Due: ",Mt((Z=G.dueDate)==null?void 0:Z.toDate(),{month:"short",day:"numeric"}),")",G.displayPenalty>0&&` (Penalty: ${G.displayPenalty.toFixed(2)})`]},G.id)})]})]})]}),d.length>0&&c.jsxs("form",{onSubmit:ee,className:"space-y-5 p-4 border border-gray-200 rounded-lg",children:[c.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-1",children:"Payment Details"}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"paymentAmount",className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount to Pay (PHP) *"}),c.jsxs("div",{className:"relative",children:[c.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:""}),c.jsx("input",{type:"number",id:"paymentAmount",value:g,onChange:G=>v(G.target.value),className:`${ff} pl-7`,step:"0.01",required:!0})]})]}),c.jsxs("div",{children:[c.jsx("label",{htmlFor:"paymentMethod",className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),c.jsx("select",{id:"paymentMethod",value:E,onChange:G=>x(G.target.value),className:ff,required:!0,children:ie.map(G=>c.jsx("option",{value:G,children:G},G))})]}),E!=="Cash"&&c.jsxs("div",{children:[c.jsx("label",{htmlFor:"referenceNumber",className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference / Transaction No. *"}),c.jsx("input",{type:"text",id:"referenceNumber",value:b,onChange:G=>S(G.target.value),className:ff,placeholder:"e.g., Check No., Card Approval Code",required:!0})]}),c.jsxs("button",{type:"submit",className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-2.5 px-5 rounded-lg flex items-center justify-center transition-colors active:scale-95",disabled:k||!g||parseFloat(g)<=0,children:[k?c.jsx(Tt,{size:20,className:"animate-spin mr-2"}):c.jsx(Cs,{size:20,className:"mr-2"}),k?"Processing...":"Process Payment"]})]})]}),O&&c.jsxs("div",{className:"mt-6 p-6 bg-green-50 rounded-lg",children:[c.jsxs("div",{className:"text-center mb-5",children:[c.jsx(Cs,{size:48,className:"mx-auto text-green-500 mb-2"}),c.jsx("h3",{className:"text-2xl font-semibold text-green-800",children:"Payment Successful!"}),c.jsx("p",{className:"text-sm text-gray-600",children:"Official Receipt has been generated."})]}),c.jsxs("div",{id:"payment-receipt-content",className:"p-6 bg-white rounded-lg shadow-lg max-w-2xl mx-auto font-sans relative overflow-hidden",children:[c.jsx("div",{className:"paid-stamp",children:"PAID"}),c.jsxs("div",{className:"flex justify-between items-start mb-5 pb-4 border-b-2 border-blue-700",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-3xl font-bold text-blue-700",children:"AGWA"}),c.jsx("div",{className:"text-xs text-blue-600 italic",children:"Ensuring Clarity, Sustaining Life."})]}),c.jsxs("div",{className:"text-right text-xs",children:[c.jsx("p",{className:"font-semibold",children:"AGWA Water Services, Inc."}),c.jsx("p",{children:"AGWA Water Services Bldg., Governor's Drive"}),c.jsx("p",{children:"Brgy. Ibayo Silangan, Naic, Cavite 4110"})]})]}),c.jsxs("div",{className:"text-center mb-6",children:[c.jsx("h4",{className:"text-xl font-bold text-gray-800",children:"OFFICIAL RECEIPT"}),c.jsxs("p",{className:"text-sm text-gray-500",children:["Receipt No: ",O.receiptId]})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx(re,{label:"Received From",value:O.customerName}),c.jsx(re,{label:"Account Number",value:O.accountNumber})]}),c.jsxs("div",{className:"mb-4",children:[c.jsx(re,{label:"Payment For",value:`Water Bill - ${O.billMonthYear}`}),c.jsx(re,{label:"Payment Date",value:Mt(O.paymentDate,{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})}),c.jsx(re,{label:"Payment Method",value:O.paymentMethod}),O.referenceNumber&&!O.referenceNumber.startsWith("CASH-")&&c.jsx(re,{label:"Reference No.",value:O.referenceNumber})]}),c.jsxs("div",{className:"mt-4 p-3 bg-gray-100 rounded-lg flex justify-between items-center",children:[c.jsx("span",{className:"text-lg font-semibold text-gray-800",children:"AMOUNT PAID"}),c.jsxs("span",{className:"text-2xl font-bold text-green-600",children:["",O.amountPaid.toFixed(2)]})]}),c.jsx("div",{className:"mt-4 pt-4 border-t border-dashed",children:c.jsx(A3,{value:O.receiptId})}),c.jsxs("div",{className:"text-xs text-gray-500 mt-4",children:[c.jsxs("p",{children:["Cashier: ",O.processedBy]}),c.jsx("p",{children:"This is a system-generated receipt. Thank you for your payment."})]})]}),c.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-3 mt-6 no-print",children:[c.jsxs("button",{onClick:se,className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg flex items-center justify-center",children:[c.jsx(V2,{size:18,className:"mr-2"})," Print Receipt"]}),c.jsx("button",{onClick:()=>{C(null),s(""),l(null),f([]),p(null)},className:"bg-gray-600 hover:bg-gray-700 text-white font-medium py-2 px-4 rounded-lg flex items-center justify-center",children:"Process Another Payment"})]})]})]})},nW=({db:r,showNotification:e,billingService:t})=>{var k;const[n,i]=X.useState("account"),[s,o]=X.useState(""),[l,d]=X.useState(null),[f,m]=X.useState([]),[p,g]=X.useState(!1),[v,E]=X.useState(""),[x,b]=X.useState(null),[S,N]=X.useState(null),R="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition-150 text-sm placeholder-gray-400",I=async F=>{if(F.preventDefault(),!s.trim()){e("Please enter a search term.","warning");return}g(!0),E(""),d(null),m([]),b(null),N(null);try{if(n==="account"){const O=await r0(r,s.trim());if(O.success&&O.data.length>0){const C=O.data[0];d(C);const M=await _u(r,C.id);M.success?m(M.data.sort((D,$)=>{var K,ee;return(((K=$.billDate)==null?void 0:K.toDate())||0)-(((ee=D.billDate)==null?void 0:ee.toDate())||0)})):e("Could not fetch bills for the user.","warning")}else O.success?E(`No account found matching "${s}".`):E(O.error||"Failed to search accounts.")}else{const O=await I9(r,(void 0)(),[where("id","==",s.trim())]);if(O.success&&O.data.length>0){const C=O.data[0];if(d(C),C.userId){const M=await I2(r,C.userId);if(M.success){N(M.data);const D=await _u(r,C.userId);D.success&&m(D.data)}}}else O.success?E(`No bill found matching invoice/bill ID "${s}".`):E(O.error||"Failed to search bills.")}}catch{E("An error occurred during the search.")}g(!1)},j=(F,O)=>{b(F),N(O||(l&&n==="account"?l:null))},U=F=>!F||typeof F!="object"?F||"":[F.street,F.barangay,F.district,"Naic, Cavite"].filter(C=>C&&C.trim()).join(", "),P=({label:F,value:O,icon:C,valueClass:M="text-gray-800"})=>c.jsxs("div",{className:"flex items-start py-1.5",children:[C&&c.jsx(C,{size:16,className:"mr-2.5 text-blue-500 flex-shrink-0 mt-0.5"}),c.jsxs("span",{className:"text-xs font-medium text-gray-500 w-32 sm:w-40",children:[F,":"]}),c.jsx("span",{className:`text-sm ${M} flex-1 break-words`,children:O||""})]});return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(D2,{size:30,className:"mr-3 text-indigo-600"})," Search Account / Bill"]})}),c.jsxs("form",{onSubmit:I,className:"mb-6 p-4 bg-gray-50 rounded-lg shadow",children:[c.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-end",children:[c.jsxs("div",{className:"flex-grow",children:[c.jsx("label",{htmlFor:"searchType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search For"}),c.jsxs("select",{id:"searchType",value:n,onChange:F=>{i(F.target.value),o(""),d(null),m([]),E("")},className:R,children:[c.jsx("option",{value:"account",children:"Customer Account"}),c.jsx("option",{value:"bill",children:"Specific Bill (Invoice #)"})]})]}),c.jsxs("div",{className:"flex-grow-[2]",children:[c.jsx("label",{htmlFor:"searchTerm",className:"block text-sm font-medium text-gray-700 mb-1",children:n==="account"?"Account No, Name, or Email":"Invoice Number or Bill ID"}),c.jsxs("div",{className:"relative",children:[c.jsx(Os,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),c.jsx("input",{type:"text",id:"searchTerm",value:s,onChange:F=>o(F.target.value),className:`${R} pl-9`,placeholder:`Enter ${n==="account"?"details...":"invoice #..."}`})]})]}),c.jsxs("button",{type:"submit",className:"bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2.5 px-6 rounded-lg flex items-center justify-center sm:w-auto w-full transition-colors",disabled:p,children:[p?c.jsx(Tt,{size:18,className:"animate-spin mr-2"}):c.jsx(Os,{size:18,className:"mr-2"}),"Search"]})]}),v&&!p&&c.jsx("p",{className:"text-red-500 text-xs mt-2",children:v})]}),p&&c.jsx(ln,{message:"Searching..."}),!p&&l&&c.jsxs("div",{className:"mt-6 p-5 border border-indigo-200 bg-indigo-50 rounded-lg shadow-md animate-fadeIn",children:[n==="account"&&c.jsxs(c.Fragment,{children:[c.jsx("h3",{className:"text-xl font-semibold text-indigo-700 mb-3 border-b border-indigo-200 pb-2",children:"Account Details"}),c.jsxs("div",{className:"space-y-1 mb-4",children:[c.jsx(P,{label:"Name",value:l.displayName,icon:Rs}),c.jsx(P,{label:"Account No",value:l.accountNumber,icon:js,valueClass:"font-mono"}),c.jsx(P,{label:"Email",value:l.email,icon:Fo}),c.jsx(P,{label:"Status",value:l.accountStatus,icon:yn,valueClass:`font-semibold ${l.accountStatus==="Active"?"text-green-600":"text-red-600"}`}),c.jsx(P,{label:"Service Address",value:U(l.serviceAddress),icon:co})]}),c.jsxs("h4",{className:"text-md font-semibold text-indigo-600 mt-4 mb-2",children:["Recent Bills (",f.length,")"]}),f.length>0?c.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 pr-2",children:f.map(F=>{var O;return c.jsxs("div",{className:`p-2.5 border rounded-md flex justify-between items-center text-xs ${F.status==="Paid"?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[c.jsxs("div",{children:[c.jsxs("p",{children:[c.jsx("strong",{children:"Period:"})," ",F.monthYear||F.billingPeriod]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Amount:"})," ",(O=F.amount)==null?void 0:O.toFixed(2)]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Due:"})," ",Mt(F.dueDate,{month:"short",day:"numeric",year:"numeric"})]}),c.jsxs("p",{children:[c.jsx("strong",{children:"Status:"})," ",c.jsx("span",{className:`font-semibold ${F.status==="Paid"?"text-green-700":"text-red-700"}`,children:F.status})]})]}),c.jsxs("button",{onClick:()=>j(F,l),className:"text-indigo-600 hover:text-indigo-800 hover:bg-indigo-100 p-1.5 rounded-md text-xs",children:[c.jsx(oc,{size:16,className:"inline mr-1"}),"View Invoice"]})]},F.id)})}):c.jsx("p",{className:"text-sm text-gray-500",children:"No bills found for this account."})]}),n==="bill"&&c.jsxs(c.Fragment,{children:[c.jsxs("h3",{className:"text-xl font-semibold text-indigo-700 mb-3 border-b border-indigo-200 pb-2",children:["Bill Details (Invoice: ",l.invoiceNumber||l.id,")"]}),c.jsxs("div",{className:"space-y-1",children:[c.jsx(P,{label:"Account No",value:l.accountNumber,icon:js,valueClass:"font-mono"}),S&&c.jsx(P,{label:"Customer Name",value:S.displayName,icon:Rs}),c.jsx(P,{label:"Bill Period",value:l.monthYear||l.billingPeriod,icon:xu}),c.jsx(P,{label:"Amount Due",value:`${(k=l.amount)==null?void 0:k.toFixed(2)}`,icon:Vl,valueClass:"font-bold"}),c.jsx(P,{label:"Due Date",value:Mt(l.dueDate,{month:"long",day:"numeric",year:"numeric"}),icon:xu}),c.jsx(P,{label:"Status",value:l.status,icon:yn,valueClass:`font-semibold ${l.status==="Paid"?"text-green-600":"text-red-600"}`}),l.status==="Paid"&&c.jsx(P,{label:"Paid Date",value:Mt(l.paymentDate),icon:Cs})]}),c.jsxs("button",{onClick:()=>j(l,S),className:"mt-4 bg-indigo-500 hover:bg-indigo-600 text-white font-medium py-2 px-4 rounded-lg flex items-center text-sm",children:[c.jsx(oc,{size:16,className:"mr-2"})," View Full Invoice"]})]})]}),!p&&!l&&s&&!v&&c.jsxs("div",{className:"mt-6 p-5 text-center text-gray-500 bg-gray-50 rounded-lg",children:[c.jsx(yn,{size:32,className:"mx-auto mb-2 text-gray-400"}),'No results found for "',s,'". Please refine your search.']}),x&&S&&c.jsx(C3,{isOpen:!!x,onClose:()=>{b(null)},bill:x,allUserBills:f,userData:S,calculateBillDetails:t})]})},rW=({db:r,user:e,userData:t,showNotification:n})=>{const[i,s]=X.useState([]),[o,l]=X.useState(!0),[d,f]=X.useState(""),[m,p]=X.useState({}),[g,v]=X.useState(null),[E,x]=X.useState(null),b=X.useCallback(async()=>{l(!0),f("");const j=await t3(r,e.uid);j.success?s(j.data):(f(j.error||"Failed fetching tickets."),n(j.error||"Failed fetching tickets.","error")),l(!1)},[r,e.uid,n]);X.useEffect(()=>{b()},[b]);const S=(j,U)=>{p(P=>({...P,[j]:U}))},N=async j=>{const U=m[j]||"";if(!U.replace(/<[^>]*>?/gm,"").trim()){n("Reply cannot be empty.","warning");return}v(j);const F={text:uo.sanitize(U),authorId:e.uid,authorName:t.displayName||"Customer",authorRole:t.role||"customer",timestamp:Ot.now()},O=await e3(r,j,F);O.success?(n("Reply sent!","success"),p(C=>({...C,[j]:""})),b()):n(O.error||"Failed to send reply.","error"),v(null)},R=async j=>{const P=(m[j]||"").replace(/<[^>]*>?/gm,"").trim();if(!P){n("Write a draft or keywords first.","warning");return}x(j);const k=i.find(F=>F.id===j);if(!k){x(null);return}try{const F=(k.conversation||[]).map(C=>`${C.authorRole==="admin"?"Support":"You"}: ${C.text.replace(/<[^>]*>?/gm,"")}`).join(`

`),O=await b3({ticketDescription:k.description,conversationHistory:F,draftReply:P,customerName:t.displayName});S(j,O),n("AI refined your reply.","success")}catch(F){const O=(F==null?void 0:F.message)||"AI assistance failed.";n(O,"error")}finally{x(null)}},I=j=>{switch(j){case"Open":return"bg-red-100 text-red-700";case"In Progress":return"bg-yellow-100 text-yellow-700";case"Awaiting Customer":return"bg-blue-100 text-blue-700";case"Resolved":case"Closed":return"bg-green-100 text-green-700";default:return"bg-gray-100 text-gray-600"}};return o?c.jsx(ln,{message:"Loading your support tickets..."}):c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(Oa,{size:30,className:"mr-3 text-purple-600"})," My Support Tickets"]}),c.jsxs("button",{onClick:b,disabled:o,className:"flex items-center text-sm p-2 bg-gray-100 rounded-lg hover:bg-gray-200 border border-gray-300",children:[c.jsx(qa,{size:16,className:o?"animate-spin":""}),c.jsx("span",{className:"ml-1.5 hidden sm:inline",children:"Refresh"})]})]}),d&&c.jsx("div",{className:"text-red-500 bg-red-50 p-3 rounded-md text-center border border-red-200",children:d}),i.length===0&&!d&&c.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner border border-gray-200",children:[c.jsx(yn,{size:48,className:"mx-auto text-gray-400 mb-4"}),c.jsx("p",{className:"text-gray-600 text-lg",children:"No support tickets found."}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Use 'Report an Issue' to create one."})]}),c.jsx("div",{className:"space-y-4",children:i.map(j=>c.jsxs("details",{className:"p-4 rounded-lg shadow-md border-l-4 bg-gray-50 border-purple-400 group hover:shadow-lg transition-shadow",children:[c.jsxs("summary",{className:"flex flex-wrap justify-between items-center gap-2 cursor-pointer list-none",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-md font-semibold text-gray-800",children:j.issueType||"Support Ticket"}),c.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["Submitted: ",Mt(j.submittedAt,{month:"short",day:"numeric",year:"2-digit"})]}),c.jsx(dm,{text:`Ticket ID: ${j.id}`,position:"bottom",children:c.jsxs("p",{className:"text-xs text-gray-400 font-mono mt-0.5 flex items-center",children:[c.jsx(js,{size:12,className:"mr-1"}),j.id.substring(0,8),"..."]})})]}),c.jsx("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full ${I(j.status)} shrink-0`,children:j.status||"Unknown"}),c.jsx("span",{className:"ml-auto transition-transform duration-300 transform group-open:rotate-180 text-purple-600",children:""})]}),c.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200 text-sm text-gray-700 space-y-4 grid grid-rows-[0fr] group-open:grid-rows-[1fr] transition-all duration-500 ease-in-out",children:c.jsxs("div",{className:"overflow-hidden space-y-4",children:[c.jsxs("div",{children:[c.jsx("strong",{className:"text-xs text-gray-500 block mb-1",children:"Your Initial Report:"}),c.jsx("div",{className:"p-2 bg-white border rounded-md whitespace-pre-line text-xs prose prose-xs max-w-none",children:j.description})]}),j.conversation&&j.conversation.length>0&&c.jsxs("div",{className:"space-y-2",children:[c.jsx("strong",{className:"text-xs text-gray-500 block mb-1",children:"Conversation:"}),c.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 border bg-white p-2 rounded-md scrollbar-thin",children:j.conversation.map((U,P)=>c.jsxs("div",{className:`p-2 rounded-lg text-xs ${U.authorRole==="admin"?"bg-blue-50":"bg-green-50"}`,children:[c.jsxs("p",{className:"font-bold text-gray-800",children:[U.authorName," (",U.authorRole,"):"]}),c.jsx("div",{className:"text-gray-700 prose prose-xs max-w-none break-words",dangerouslySetInnerHTML:{__html:uo.sanitize(U.text||"")}}),c.jsx("p",{className:"text-right text-gray-500 mt-1",children:Mt(U.timestamp)})]},P))})]}),j.status!=="Resolved"&&j.status!=="Closed"&&c.jsxs("div",{className:"pt-2",children:[c.jsx("label",{className:"text-xs font-semibold text-gray-600 block mb-1",children:"Send a Reply:"}),c.jsxs("div",{className:"flex items-start gap-2",children:[c.jsx(w0,{value:m[j.id]||"",onChange:U=>S(j.id,U),placeholder:"Type your reply...",className:"flex-grow bg-white rounded-lg border border-gray-300 min-h-[100px]",readOnly:g===j.id||E===j.id}),c.jsx(dm,{text:"Refine draft with AI",children:c.jsx("button",{onClick:()=>R(j.id),className:"p-2 bg-purple-100 text-purple-700 rounded-md hover:bg-purple-200 disabled:opacity-50 disabled:cursor-not-allowed",disabled:E===j.id||!(m[j.id]||"").replace(/<[^>]*>?/gm,"").trim(),children:E===j.id?c.jsx(Tt,{size:20,className:"animate-spin"}):c.jsx(Ds,{size:20})})})]}),c.jsxs("button",{onClick:()=>N(j.id),className:"mt-2 w-full sm:w-auto flex items-center justify-center bg-blue-600 text-white font-semibold py-2 px-4 rounded-md text-xs hover:bg-blue-700 disabled:opacity-60",disabled:g===j.id||!(m[j.id]||"").replace(/<[^>]*>?/gm,"").trim(),children:[g===j.id?c.jsx(Tt,{size:14,className:"animate-spin mr-2"}):c.jsx(l0,{size:14,className:"mr-2"}),"Send Reply"]})]}),j.status==="Resolved"&&c.jsx("p",{className:"text-xs text-green-700 bg-green-50 p-2 rounded border border-green-200",children:"This ticket is marked as resolved. Replying will reopen it."}),j.status==="Closed"&&c.jsx("p",{className:"text-xs text-purple-700 bg-purple-50 p-2 rounded border border-purple-200",children:"This ticket is closed. Please create a new ticket if you need further assistance."})]})})]},j.id))})]})};function iW(r,e){const t=X.useRef(e);X.useEffect(function(){e!==t.current&&r.attributionControl!=null&&(t.current!=null&&r.attributionControl.removeAttribution(t.current),e!=null&&r.attributionControl.addAttribution(e)),t.current=e},[r,e])}rb();const sW=1;function oW(r){return Object.freeze({__version:sW,map:r})}function aW(r,e){return Object.freeze({...r,...e})}const MR=X.createContext(null),LR=MR.Provider;function FR(){const r=X.useContext(MR);if(r==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return r}function lW(r){function e(t,n){const{instance:i,context:s}=r(t).current;return X.useImperativeHandle(n,()=>i),t.children==null?null:ss.createElement(LR,{value:s},t.children)}return X.forwardRef(e)}function cW(r){function e(t,n){const{instance:i}=r(t).current;return X.useImperativeHandle(n,()=>i),null}return X.forwardRef(e)}function VR(r,e){const t=X.useRef();X.useEffect(function(){return e!=null&&r.instance.on(e),t.current=e,function(){t.current!=null&&r.instance.off(t.current),t.current=null}},[r,e])}function uw(r,e){const t=r.pane??e.pane;return t?{...r,pane:t}:r}var Af={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var uW=Af.exports,T4;function dW(){return T4||(T4=1,function(r,e){(function(t,n){n(e)})(uW,function(t){var n="1.9.4";function i(u){var y,T,V,W;for(T=1,V=arguments.length;T<V;T++){W=arguments[T];for(y in W)u[y]=W[y]}return u}var s=Object.create||function(){function u(){}return function(y){return u.prototype=y,new u}}();function o(u,y){var T=Array.prototype.slice;if(u.bind)return u.bind.apply(u,T.call(arguments,1));var V=T.call(arguments,2);return function(){return u.apply(y,V.length?V.concat(T.call(arguments)):arguments)}}var l=0;function d(u){return"_leaflet_id"in u||(u._leaflet_id=++l),u._leaflet_id}function f(u,y,T){var V,W,ne,he;return he=function(){V=!1,W&&(ne.apply(T,W),W=!1)},ne=function(){V?W=arguments:(u.apply(T,arguments),setTimeout(he,y),V=!0)},ne}function m(u,y,T){var V=y[1],W=y[0],ne=V-W;return u===V&&T?u:((u-W)%ne+ne)%ne+W}function p(){return!1}function g(u,y){if(y===!1)return u;var T=Math.pow(10,y===void 0?6:y);return Math.round(u*T)/T}function v(u){return u.trim?u.trim():u.replace(/^\s+|\s+$/g,"")}function E(u){return v(u).split(/\s+/)}function x(u,y){Object.prototype.hasOwnProperty.call(u,"options")||(u.options=u.options?s(u.options):{});for(var T in y)u.options[T]=y[T];return u.options}function b(u,y,T){var V=[];for(var W in u)V.push(encodeURIComponent(T?W.toUpperCase():W)+"="+encodeURIComponent(u[W]));return(!y||y.indexOf("?")===-1?"?":"&")+V.join("&")}var S=/\{ *([\w_ -]+) *\}/g;function N(u,y){return u.replace(S,function(T,V){var W=y[V];if(W===void 0)throw new Error("No value provided for variable "+T);return typeof W=="function"&&(W=W(y)),W})}var R=Array.isArray||function(u){return Object.prototype.toString.call(u)==="[object Array]"};function I(u,y){for(var T=0;T<u.length;T++)if(u[T]===y)return T;return-1}var j="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function U(u){return window["webkit"+u]||window["moz"+u]||window["ms"+u]}var P=0;function k(u){var y=+new Date,T=Math.max(0,16-(y-P));return P=y+T,window.setTimeout(u,T)}var F=window.requestAnimationFrame||U("RequestAnimationFrame")||k,O=window.cancelAnimationFrame||U("CancelAnimationFrame")||U("CancelRequestAnimationFrame")||function(u){window.clearTimeout(u)};function C(u,y,T){if(T&&F===k)u.call(y);else return F.call(window,o(u,y))}function M(u){u&&O.call(window,u)}var D={__proto__:null,extend:i,create:s,bind:o,get lastId(){return l},stamp:d,throttle:f,wrapNum:m,falseFn:p,formatNum:g,trim:v,splitWords:E,setOptions:x,getParamString:b,template:N,isArray:R,indexOf:I,emptyImageUrl:j,requestFn:F,cancelFn:O,requestAnimFrame:C,cancelAnimFrame:M};function $(){}$.extend=function(u){var y=function(){x(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},T=y.__super__=this.prototype,V=s(T);V.constructor=y,y.prototype=V;for(var W in this)Object.prototype.hasOwnProperty.call(this,W)&&W!=="prototype"&&W!=="__super__"&&(y[W]=this[W]);return u.statics&&i(y,u.statics),u.includes&&(K(u.includes),i.apply(null,[V].concat(u.includes))),i(V,u),delete V.statics,delete V.includes,V.options&&(V.options=T.options?s(T.options):{},i(V.options,u.options)),V._initHooks=[],V.callInitHooks=function(){if(!this._initHooksCalled){T.callInitHooks&&T.callInitHooks.call(this),this._initHooksCalled=!0;for(var ne=0,he=V._initHooks.length;ne<he;ne++)V._initHooks[ne].call(this)}},y},$.include=function(u){var y=this.prototype.options;return i(this.prototype,u),u.options&&(this.prototype.options=y,this.mergeOptions(u.options)),this},$.mergeOptions=function(u){return i(this.prototype.options,u),this},$.addInitHook=function(u){var y=Array.prototype.slice.call(arguments,1),T=typeof u=="function"?u:function(){this[u].apply(this,y)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(T),this};function K(u){if(!(typeof L>"u"||!L||!L.Mixin)){u=R(u)?u:[u];for(var y=0;y<u.length;y++)u[y]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ee={on:function(u,y,T){if(typeof u=="object")for(var V in u)this._on(V,u[V],y);else{u=E(u);for(var W=0,ne=u.length;W<ne;W++)this._on(u[W],y,T)}return this},off:function(u,y,T){if(!arguments.length)delete this._events;else if(typeof u=="object")for(var V in u)this._off(V,u[V],y);else{u=E(u);for(var W=arguments.length===1,ne=0,he=u.length;ne<he;ne++)W?this._off(u[ne]):this._off(u[ne],y,T)}return this},_on:function(u,y,T,V){if(typeof y!="function"){console.warn("wrong listener type: "+typeof y);return}if(this._listens(u,y,T)===!1){T===this&&(T=void 0);var W={fn:y,ctx:T};V&&(W.once=!0),this._events=this._events||{},this._events[u]=this._events[u]||[],this._events[u].push(W)}},_off:function(u,y,T){var V,W,ne;if(this._events&&(V=this._events[u],!!V)){if(arguments.length===1){if(this._firingCount)for(W=0,ne=V.length;W<ne;W++)V[W].fn=p;delete this._events[u];return}if(typeof y!="function"){console.warn("wrong listener type: "+typeof y);return}var he=this._listens(u,y,T);if(he!==!1){var xe=V[he];this._firingCount&&(xe.fn=p,this._events[u]=V=V.slice()),V.splice(he,1)}}},fire:function(u,y,T){if(!this.listens(u,T))return this;var V=i({},y,{type:u,target:this,sourceTarget:y&&y.sourceTarget||this});if(this._events){var W=this._events[u];if(W){this._firingCount=this._firingCount+1||1;for(var ne=0,he=W.length;ne<he;ne++){var xe=W[ne],Ee=xe.fn;xe.once&&this.off(u,Ee,xe.ctx),Ee.call(xe.ctx||this,V)}this._firingCount--}}return T&&this._propagateEvent(V),this},listens:function(u,y,T,V){typeof u!="string"&&console.warn('"string" type argument expected');var W=y;typeof y!="function"&&(V=!!y,W=void 0,T=void 0);var ne=this._events&&this._events[u];if(ne&&ne.length&&this._listens(u,W,T)!==!1)return!0;if(V){for(var he in this._eventParents)if(this._eventParents[he].listens(u,y,T,V))return!0}return!1},_listens:function(u,y,T){if(!this._events)return!1;var V=this._events[u]||[];if(!y)return!!V.length;T===this&&(T=void 0);for(var W=0,ne=V.length;W<ne;W++)if(V[W].fn===y&&V[W].ctx===T)return W;return!1},once:function(u,y,T){if(typeof u=="object")for(var V in u)this._on(V,u[V],y,!0);else{u=E(u);for(var W=0,ne=u.length;W<ne;W++)this._on(u[W],y,T,!0)}return this},addEventParent:function(u){return this._eventParents=this._eventParents||{},this._eventParents[d(u)]=u,this},removeEventParent:function(u){return this._eventParents&&delete this._eventParents[d(u)],this},_propagateEvent:function(u){for(var y in this._eventParents)this._eventParents[y].fire(u.type,i({layer:u.target,propagatedFrom:u.target},u),!0)}};ee.addEventListener=ee.on,ee.removeEventListener=ee.clearAllEventListeners=ee.off,ee.addOneTimeEventListener=ee.once,ee.fireEvent=ee.fire,ee.hasEventListeners=ee.listens;var se=$.extend(ee);function ie(u,y,T){this.x=T?Math.round(u):u,this.y=T?Math.round(y):y}var re=Math.trunc||function(u){return u>0?Math.floor(u):Math.ceil(u)};ie.prototype={clone:function(){return new ie(this.x,this.y)},add:function(u){return this.clone()._add(G(u))},_add:function(u){return this.x+=u.x,this.y+=u.y,this},subtract:function(u){return this.clone()._subtract(G(u))},_subtract:function(u){return this.x-=u.x,this.y-=u.y,this},divideBy:function(u){return this.clone()._divideBy(u)},_divideBy:function(u){return this.x/=u,this.y/=u,this},multiplyBy:function(u){return this.clone()._multiplyBy(u)},_multiplyBy:function(u){return this.x*=u,this.y*=u,this},scaleBy:function(u){return new ie(this.x*u.x,this.y*u.y)},unscaleBy:function(u){return new ie(this.x/u.x,this.y/u.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=re(this.x),this.y=re(this.y),this},distanceTo:function(u){u=G(u);var y=u.x-this.x,T=u.y-this.y;return Math.sqrt(y*y+T*T)},equals:function(u){return u=G(u),u.x===this.x&&u.y===this.y},contains:function(u){return u=G(u),Math.abs(u.x)<=Math.abs(this.x)&&Math.abs(u.y)<=Math.abs(this.y)},toString:function(){return"Point("+g(this.x)+", "+g(this.y)+")"}};function G(u,y,T){return u instanceof ie?u:R(u)?new ie(u[0],u[1]):u==null?u:typeof u=="object"&&"x"in u&&"y"in u?new ie(u.x,u.y):new ie(u,y,T)}function z(u,y){if(u)for(var T=y?[u,y]:u,V=0,W=T.length;V<W;V++)this.extend(T[V])}z.prototype={extend:function(u){var y,T;if(!u)return this;if(u instanceof ie||typeof u[0]=="number"||"x"in u)y=T=G(u);else if(u=Z(u),y=u.min,T=u.max,!y||!T)return this;return!this.min&&!this.max?(this.min=y.clone(),this.max=T.clone()):(this.min.x=Math.min(y.x,this.min.x),this.max.x=Math.max(T.x,this.max.x),this.min.y=Math.min(y.y,this.min.y),this.max.y=Math.max(T.y,this.max.y)),this},getCenter:function(u){return G((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,u)},getBottomLeft:function(){return G(this.min.x,this.max.y)},getTopRight:function(){return G(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(u){var y,T;return typeof u[0]=="number"||u instanceof ie?u=G(u):u=Z(u),u instanceof z?(y=u.min,T=u.max):y=T=u,y.x>=this.min.x&&T.x<=this.max.x&&y.y>=this.min.y&&T.y<=this.max.y},intersects:function(u){u=Z(u);var y=this.min,T=this.max,V=u.min,W=u.max,ne=W.x>=y.x&&V.x<=T.x,he=W.y>=y.y&&V.y<=T.y;return ne&&he},overlaps:function(u){u=Z(u);var y=this.min,T=this.max,V=u.min,W=u.max,ne=W.x>y.x&&V.x<T.x,he=W.y>y.y&&V.y<T.y;return ne&&he},isValid:function(){return!!(this.min&&this.max)},pad:function(u){var y=this.min,T=this.max,V=Math.abs(y.x-T.x)*u,W=Math.abs(y.y-T.y)*u;return Z(G(y.x-V,y.y-W),G(T.x+V,T.y+W))},equals:function(u){return u?(u=Z(u),this.min.equals(u.getTopLeft())&&this.max.equals(u.getBottomRight())):!1}};function Z(u,y){return!u||u instanceof z?u:new z(u,y)}function J(u,y){if(u)for(var T=y?[u,y]:u,V=0,W=T.length;V<W;V++)this.extend(T[V])}J.prototype={extend:function(u){var y=this._southWest,T=this._northEast,V,W;if(u instanceof le)V=u,W=u;else if(u instanceof J){if(V=u._southWest,W=u._northEast,!V||!W)return this}else return u?this.extend(Q(u)||ae(u)):this;return!y&&!T?(this._southWest=new le(V.lat,V.lng),this._northEast=new le(W.lat,W.lng)):(y.lat=Math.min(V.lat,y.lat),y.lng=Math.min(V.lng,y.lng),T.lat=Math.max(W.lat,T.lat),T.lng=Math.max(W.lng,T.lng)),this},pad:function(u){var y=this._southWest,T=this._northEast,V=Math.abs(y.lat-T.lat)*u,W=Math.abs(y.lng-T.lng)*u;return new J(new le(y.lat-V,y.lng-W),new le(T.lat+V,T.lng+W))},getCenter:function(){return new le((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new le(this.getNorth(),this.getWest())},getSouthEast:function(){return new le(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(u){typeof u[0]=="number"||u instanceof le||"lat"in u?u=Q(u):u=ae(u);var y=this._southWest,T=this._northEast,V,W;return u instanceof J?(V=u.getSouthWest(),W=u.getNorthEast()):V=W=u,V.lat>=y.lat&&W.lat<=T.lat&&V.lng>=y.lng&&W.lng<=T.lng},intersects:function(u){u=ae(u);var y=this._southWest,T=this._northEast,V=u.getSouthWest(),W=u.getNorthEast(),ne=W.lat>=y.lat&&V.lat<=T.lat,he=W.lng>=y.lng&&V.lng<=T.lng;return ne&&he},overlaps:function(u){u=ae(u);var y=this._southWest,T=this._northEast,V=u.getSouthWest(),W=u.getNorthEast(),ne=W.lat>y.lat&&V.lat<T.lat,he=W.lng>y.lng&&V.lng<T.lng;return ne&&he},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(u,y){return u?(u=ae(u),this._southWest.equals(u.getSouthWest(),y)&&this._northEast.equals(u.getNorthEast(),y)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ae(u,y){return u instanceof J?u:new J(u,y)}function le(u,y,T){if(isNaN(u)||isNaN(y))throw new Error("Invalid LatLng object: ("+u+", "+y+")");this.lat=+u,this.lng=+y,T!==void 0&&(this.alt=+T)}le.prototype={equals:function(u,y){if(!u)return!1;u=Q(u);var T=Math.max(Math.abs(this.lat-u.lat),Math.abs(this.lng-u.lng));return T<=(y===void 0?1e-9:y)},toString:function(u){return"LatLng("+g(this.lat,u)+", "+g(this.lng,u)+")"},distanceTo:function(u){return ue.distance(this,Q(u))},wrap:function(){return ue.wrapLatLng(this)},toBounds:function(u){var y=180*u/40075017,T=y/Math.cos(Math.PI/180*this.lat);return ae([this.lat-y,this.lng-T],[this.lat+y,this.lng+T])},clone:function(){return new le(this.lat,this.lng,this.alt)}};function Q(u,y,T){return u instanceof le?u:R(u)&&typeof u[0]!="object"?u.length===3?new le(u[0],u[1],u[2]):u.length===2?new le(u[0],u[1]):null:u==null?u:typeof u=="object"&&"lat"in u?new le(u.lat,"lng"in u?u.lng:u.lon,u.alt):y===void 0?null:new le(u,y,T)}var ce={latLngToPoint:function(u,y){var T=this.projection.project(u),V=this.scale(y);return this.transformation._transform(T,V)},pointToLatLng:function(u,y){var T=this.scale(y),V=this.transformation.untransform(u,T);return this.projection.unproject(V)},project:function(u){return this.projection.project(u)},unproject:function(u){return this.projection.unproject(u)},scale:function(u){return 256*Math.pow(2,u)},zoom:function(u){return Math.log(u/256)/Math.LN2},getProjectedBounds:function(u){if(this.infinite)return null;var y=this.projection.bounds,T=this.scale(u),V=this.transformation.transform(y.min,T),W=this.transformation.transform(y.max,T);return new z(V,W)},infinite:!1,wrapLatLng:function(u){var y=this.wrapLng?m(u.lng,this.wrapLng,!0):u.lng,T=this.wrapLat?m(u.lat,this.wrapLat,!0):u.lat,V=u.alt;return new le(T,y,V)},wrapLatLngBounds:function(u){var y=u.getCenter(),T=this.wrapLatLng(y),V=y.lat-T.lat,W=y.lng-T.lng;if(V===0&&W===0)return u;var ne=u.getSouthWest(),he=u.getNorthEast(),xe=new le(ne.lat-V,ne.lng-W),Ee=new le(he.lat-V,he.lng-W);return new J(xe,Ee)}},ue=i({},ce,{wrapLng:[-180,180],R:6371e3,distance:function(u,y){var T=Math.PI/180,V=u.lat*T,W=y.lat*T,ne=Math.sin((y.lat-u.lat)*T/2),he=Math.sin((y.lng-u.lng)*T/2),xe=ne*ne+Math.cos(V)*Math.cos(W)*he*he,Ee=2*Math.atan2(Math.sqrt(xe),Math.sqrt(1-xe));return this.R*Ee}}),fe=6378137,ve={R:fe,MAX_LATITUDE:85.0511287798,project:function(u){var y=Math.PI/180,T=this.MAX_LATITUDE,V=Math.max(Math.min(T,u.lat),-T),W=Math.sin(V*y);return new ie(this.R*u.lng*y,this.R*Math.log((1+W)/(1-W))/2)},unproject:function(u){var y=180/Math.PI;return new le((2*Math.atan(Math.exp(u.y/this.R))-Math.PI/2)*y,u.x*y/this.R)},bounds:function(){var u=fe*Math.PI;return new z([-u,-u],[u,u])}()};function Me(u,y,T,V){if(R(u)){this._a=u[0],this._b=u[1],this._c=u[2],this._d=u[3];return}this._a=u,this._b=y,this._c=T,this._d=V}Me.prototype={transform:function(u,y){return this._transform(u.clone(),y)},_transform:function(u,y){return y=y||1,u.x=y*(this._a*u.x+this._b),u.y=y*(this._c*u.y+this._d),u},untransform:function(u,y){return y=y||1,new ie((u.x/y-this._b)/this._a,(u.y/y-this._d)/this._c)}};function Pe(u,y,T,V){return new Me(u,y,T,V)}var qe=i({},ue,{code:"EPSG:3857",projection:ve,transformation:function(){var u=.5/(Math.PI*ve.R);return Pe(u,.5,-u,.5)}()}),Ge=i({},qe,{code:"EPSG:900913"});function lt(u){return document.createElementNS("http://www.w3.org/2000/svg",u)}function Ct(u,y){var T="",V,W,ne,he,xe,Ee;for(V=0,ne=u.length;V<ne;V++){for(xe=u[V],W=0,he=xe.length;W<he;W++)Ee=xe[W],T+=(W?"L":"M")+Ee.x+" "+Ee.y;T+=y?Ke.svg?"z":"x":""}return T||"M0 0"}var bt=document.documentElement.style,Te="ActiveXObject"in window,Ie=Te&&!document.addEventListener,Le="msLaunchUri"in navigator&&!("documentMode"in document),Be=cn("webkit"),ke=cn("android"),_t=cn("android 2")||cn("android 3"),gt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),yt=ke&&cn("Google")&&gt<537&&!("AudioNode"in window),kt=!!window.opera,Ft=!Le&&cn("chrome"),Vt=cn("gecko")&&!Be&&!kt&&!Te,cs=!Ft&&cn("safari"),Gt=cn("phantom"),Fn="OTransition"in bt,us=navigator.platform.indexOf("Win")===0,Ui=Te&&"transition"in bt,yi="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!_t,yr="MozPerspective"in bt,vi=!window.L_DISABLE_3D&&(Ui||yi||yr)&&!Fn&&!Gt,ni=typeof orientation<"u"||cn("mobile"),qi=ni&&Be,ho=ni&&yi,_i=!window.PointerEvent&&window.MSPointerEvent,er=!!(window.PointerEvent||_i),ri="ontouchstart"in window||!!window.TouchEvent,xi=!window.L_NO_TOUCH&&(ri||er),bi=ni&&kt,qo=ni&&Vt,vn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,wi=function(){var u=!1;try{var y=Object.defineProperty({},"passive",{get:function(){u=!0}});window.addEventListener("testPassiveEventSupport",p,y),window.removeEventListener("testPassiveEventSupport",p,y)}catch{}return u}(),Hi=function(){return!!document.createElement("canvas").getContext}(),ds=!!(document.createElementNS&&lt("svg").createSVGRect),bn=!!ds&&function(){var u=document.createElement("div");return u.innerHTML="<svg/>",(u.firstChild&&u.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Vs=!ds&&function(){try{var u=document.createElement("div");u.innerHTML='<v:shape adj="1"/>';var y=u.firstChild;return y.style.behavior="url(#default#VML)",y&&typeof y.adj=="object"}catch{return!1}}(),Br=navigator.platform.indexOf("Mac")===0,Bs=navigator.platform.indexOf("Linux")===0;function cn(u){return navigator.userAgent.toLowerCase().indexOf(u)>=0}var Ke={ie:Te,ielt9:Ie,edge:Le,webkit:Be,android:ke,android23:_t,androidStock:yt,opera:kt,chrome:Ft,gecko:Vt,safari:cs,phantom:Gt,opera12:Fn,win:us,ie3d:Ui,webkit3d:yi,gecko3d:yr,any3d:vi,mobile:ni,mobileWebkit:qi,mobileWebkit3d:ho,msPointer:_i,pointer:er,touch:xi,touchNative:ri,mobileOpera:bi,mobileGecko:qo,retina:vn,passiveEvents:wi,canvas:Hi,svg:ds,vml:Vs,inlineSvg:bn,mac:Br,linux:Bs},Ir=Ke.msPointer?"MSPointerDown":"pointerdown",zs=Ke.msPointer?"MSPointerMove":"pointermove",fo=Ke.msPointer?"MSPointerUp":"pointerup",hs=Ke.msPointer?"MSPointerCancel":"pointercancel",vr={touchstart:Ir,touchmove:zs,touchend:fo,touchcancel:hs},Pr={touchstart:Pt,touchmove:Qt,touchend:Qt,touchcancel:Qt},kr={},Cr=!1;function Ho(u,y,T){return y==="touchstart"&&Qe(),Pr[y]?(T=Pr[y].bind(this,T),u.addEventListener(vr[y],T,!1),T):(console.warn("wrong event specified:",y),p)}function $o(u,y,T){if(!vr[y]){console.warn("wrong event specified:",y);return}u.removeEventListener(vr[y],T,!1)}function et(u){kr[u.pointerId]=u}function pe(u){kr[u.pointerId]&&(kr[u.pointerId]=u)}function De(u){delete kr[u.pointerId]}function Qe(){Cr||(document.addEventListener(Ir,et,!0),document.addEventListener(zs,pe,!0),document.addEventListener(fo,De,!0),document.addEventListener(hs,De,!0),Cr=!0)}function Qt(u,y){if(y.pointerType!==(y.MSPOINTER_TYPE_MOUSE||"mouse")){y.touches=[];for(var T in kr)y.touches.push(kr[T]);y.changedTouches=[y],u(y)}}function Pt(u,y){y.MSPOINTER_TYPE_TOUCH&&y.pointerType===y.MSPOINTER_TYPE_TOUCH&&hn(y),Qt(u,y)}function wn(u){var y={},T,V;for(V in u)T=u[V],y[V]=T&&T.bind?T.bind(u):T;return u=y,y.type="dblclick",y.detail=2,y.isTrusted=!1,y._simulated=!0,y}var Rn=200;function tr(u,y){u.addEventListener("dblclick",y);var T=0,V;function W(ne){if(ne.detail!==1){V=ne.detail;return}if(!(ne.pointerType==="mouse"||ne.sourceCapabilities&&!ne.sourceCapabilities.firesTouchEvents)){var he=ms(ne);if(!(he.some(function(Ee){return Ee instanceof HTMLLabelElement&&Ee.attributes.for})&&!he.some(function(Ee){return Ee instanceof HTMLInputElement||Ee instanceof HTMLSelectElement}))){var xe=Date.now();xe-T<=Rn?(V++,V===2&&y(wn(ne))):V=1,T=xe}}}return u.addEventListener("click",W),{dblclick:y,simDblclick:W}}function Kn(u,y){u.removeEventListener("dblclick",y.dblclick),u.removeEventListener("click",y.simDblclick)}var $i=Ki(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),_n=Ki(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Wi=_n==="webkitTransition"||_n==="OTransition"?_n+"End":"transitionend";function lr(u){return typeof u=="string"?document.getElementById(u):u}function mo(u,y){var T=u.style[y]||u.currentStyle&&u.currentStyle[y];if((!T||T==="auto")&&document.defaultView){var V=document.defaultView.getComputedStyle(u,null);T=V?V[y]:null}return T==="auto"?null:T}function At(u,y,T){var V=document.createElement(u);return V.className=y||"",T&&T.appendChild(V),V}function un(u){var y=u.parentNode;y&&y.removeChild(u)}function Wo(u){for(;u.firstChild;)u.removeChild(u.firstChild)}function Us(u){var y=u.parentNode;y&&y.lastChild!==u&&y.appendChild(u)}function Gi(u){var y=u.parentNode;y&&y.firstChild!==u&&y.insertBefore(u,y.firstChild)}function po(u,y){if(u.classList!==void 0)return u.classList.contains(y);var T=Ei(u);return T.length>0&&new RegExp("(^|\\s)"+y+"(\\s|$)").test(T)}function wt(u,y){if(u.classList!==void 0)for(var T=E(y),V=0,W=T.length;V<W;V++)u.classList.add(T[V]);else if(!po(u,y)){var ne=Ei(u);yc(u,(ne?ne+" ":"")+y)}}function dn(u,y){u.classList!==void 0?u.classList.remove(y):yc(u,v((" "+Ei(u)+" ").replace(" "+y+" "," ")))}function yc(u,y){u.className.baseVal===void 0?u.className=y:u.className.baseVal=y}function Ei(u){return u.correspondingElement&&(u=u.correspondingElement),u.className.baseVal===void 0?u.className:u.className.baseVal}function Tn(u,y){"opacity"in u.style?u.style.opacity=y:"filter"in u.style&&Go(u,y)}function Go(u,y){var T=!1,V="DXImageTransform.Microsoft.Alpha";try{T=u.filters.item(V)}catch{if(y===1)return}y=Math.round(y*100),T?(T.Enabled=y!==100,T.Opacity=y):u.style.filter+=" progid:"+V+"(opacity="+y+")"}function Ki(u){for(var y=document.documentElement.style,T=0;T<u.length;T++)if(u[T]in y)return u[T];return!1}function zr(u,y,T){var V=y||new ie(0,0);u.style[$i]=(Ke.ie3d?"translate("+V.x+"px,"+V.y+"px)":"translate3d("+V.x+"px,"+V.y+"px,0)")+(T?" scale("+T+")":"")}function Nt(u,y){u._leaflet_pos=y,Ke.any3d?zr(u,y):(u.style.left=y.x+"px",u.style.top=y.y+"px")}function Ur(u){return u._leaflet_pos||new ie(0,0)}var jt,Si,Ga;if("onselectstart"in document)jt=function(){dt(window,"selectstart",hn)},Si=function(){rn(window,"selectstart",hn)};else{var fs=Ki(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);jt=function(){if(fs){var u=document.documentElement.style;Ga=u[fs],u[fs]="none"}},Si=function(){fs&&(document.documentElement.style[fs]=Ga,Ga=void 0)}}function Ka(){dt(window,"dragstart",hn)}function Ya(){rn(window,"dragstart",hn)}var Ko,Yo;function Ti(u){for(;u.tabIndex===-1;)u=u.parentNode;u.style&&(qn(),Ko=u,Yo=u.style.outlineStyle,u.style.outlineStyle="none",dt(window,"keydown",qn))}function qn(){Ko&&(Ko.style.outlineStyle=Yo,Ko=void 0,Yo=void 0,rn(window,"keydown",qn))}function Ai(u){do u=u.parentNode;while((!u.offsetWidth||!u.offsetHeight)&&u!==document.body);return u}function ii(u){var y=u.getBoundingClientRect();return{x:y.width/u.offsetWidth||1,y:y.height/u.offsetHeight||1,boundingClientRect:y}}var go={__proto__:null,TRANSFORM:$i,TRANSITION:_n,TRANSITION_END:Wi,get:lr,getStyle:mo,create:At,remove:un,empty:Wo,toFront:Us,toBack:Gi,hasClass:po,addClass:wt,removeClass:dn,setClass:yc,getClass:Ei,setOpacity:Tn,testProp:Ki,setTransform:zr,setPosition:Nt,getPosition:Ur,get disableTextSelection(){return jt},get enableTextSelection(){return Si},disableImageDrag:Ka,enableImageDrag:Ya,preventOutline:Ti,restoreOutline:qn,getSizedParentNode:Ai,getScale:ii};function dt(u,y,T,V){if(y&&typeof y=="object")for(var W in y)_c(u,W,y[W],T);else{y=E(y);for(var ne=0,he=y.length;ne<he;ne++)_c(u,y[ne],T,V)}return this}var Yn="_leaflet_events";function rn(u,y,T,V){if(arguments.length===1)vc(u),delete u[Yn];else if(y&&typeof y=="object")for(var W in y)Za(u,W,y[W],T);else if(y=E(y),arguments.length===2)vc(u,function(xe){return I(y,xe)!==-1});else for(var ne=0,he=y.length;ne<he;ne++)Za(u,y[ne],T,V);return this}function vc(u,y){for(var T in u[Yn]){var V=T.split(/\d/)[0];(!y||y(V))&&Za(u,V,null,null,T)}}var _r={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function _c(u,y,T,V){var W=y+d(T)+(V?"_"+d(V):"");if(u[Yn]&&u[Yn][W])return this;var ne=function(xe){return T.call(V||u,xe||window.event)},he=ne;!Ke.touchNative&&Ke.pointer&&y.indexOf("touch")===0?ne=Ho(u,y,ne):Ke.touch&&y==="dblclick"?ne=tr(u,ne):"addEventListener"in u?y==="touchstart"||y==="touchmove"||y==="wheel"||y==="mousewheel"?u.addEventListener(_r[y]||y,ne,Ke.passiveEvents?{passive:!1}:!1):y==="mouseenter"||y==="mouseleave"?(ne=function(xe){xe=xe||window.event,Zo(u,xe)&&he(xe)},u.addEventListener(_r[y],ne,!1)):u.addEventListener(y,he,!1):u.attachEvent("on"+y,ne),u[Yn]=u[Yn]||{},u[Yn][W]=ne}function Za(u,y,T,V,W){W=W||y+d(T)+(V?"_"+d(V):"");var ne=u[Yn]&&u[Yn][W];if(!ne)return this;!Ke.touchNative&&Ke.pointer&&y.indexOf("touch")===0?$o(u,y,ne):Ke.touch&&y==="dblclick"?Kn(u,ne):"removeEventListener"in u?u.removeEventListener(_r[y]||y,ne,!1):u.detachEvent("on"+y,ne),u[Yn][W]=null}function Rr(u){return u.stopPropagation?u.stopPropagation():u.originalEvent?u.originalEvent._stopped=!0:u.cancelBubble=!0,this}function qs(u){return _c(u,"wheel",Rr),this}function yo(u){return dt(u,"mousedown touchstart dblclick contextmenu",Rr),u._leaflet_disable_click=!0,this}function hn(u){return u.preventDefault?u.preventDefault():u.returnValue=!1,this}function cr(u){return hn(u),Rr(u),this}function ms(u){if(u.composedPath)return u.composedPath();for(var y=[],T=u.target;T;)y.push(T),T=T.parentNode;return y}function Hs(u,y){if(!y)return new ie(u.clientX,u.clientY);var T=ii(y),V=T.boundingClientRect;return new ie((u.clientX-V.left)/T.x-y.clientLeft,(u.clientY-V.top)/T.y-y.clientTop)}var An=Ke.linux&&Ke.chrome?window.devicePixelRatio:Ke.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ou(u){return Ke.edge?u.wheelDeltaY/2:u.deltaY&&u.deltaMode===0?-u.deltaY/An:u.deltaY&&u.deltaMode===1?-u.deltaY*20:u.deltaY&&u.deltaMode===2?-u.deltaY*60:u.deltaX||u.deltaZ?0:u.wheelDelta?(u.wheelDeltaY||u.wheelDelta)/2:u.detail&&Math.abs(u.detail)<32765?-u.detail*20:u.detail?u.detail/-32765*60:0}function Zo(u,y){var T=y.relatedTarget;if(!T)return!0;try{for(;T&&T!==u;)T=T.parentNode}catch{return!1}return T!==u}var Qo={__proto__:null,on:dt,off:rn,stopPropagation:Rr,disableScrollPropagation:qs,disableClickPropagation:yo,preventDefault:hn,stop:cr,getPropagationPath:ms,getMousePosition:Hs,getWheelDelta:Ou,isExternalTarget:Zo,addListener:dt,removeListener:rn},Xo=se.extend({run:function(u,y,T,V){this.stop(),this._el=u,this._inProgress=!0,this._duration=T||.25,this._easeOutPower=1/Math.max(V||.5,.2),this._startPos=Ur(u),this._offset=y.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=C(this._animate,this),this._step()},_step:function(u){var y=+new Date-this._startTime,T=this._duration*1e3;y<T?this._runFrame(this._easeOut(y/T),u):(this._runFrame(1),this._complete())},_runFrame:function(u,y){var T=this._startPos.add(this._offset.multiplyBy(u));y&&T._round(),Nt(this._el,T),this.fire("step")},_complete:function(){M(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(u){return 1-Math.pow(1-u,this._easeOutPower)}}),Dt=se.extend({options:{crs:qe,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(u,y){y=x(this,y),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(u),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),y.maxBounds&&this.setMaxBounds(y.maxBounds),y.zoom!==void 0&&(this._zoom=this._limitZoom(y.zoom)),y.center&&y.zoom!==void 0&&this.setView(Q(y.center),y.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=_n&&Ke.any3d&&!Ke.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),dt(this._proxy,Wi,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(u,y,T){if(y=y===void 0?this._zoom:this._limitZoom(y),u=this._limitCenter(Q(u),y,this.options.maxBounds),T=T||{},this._stop(),this._loaded&&!T.reset&&T!==!0){T.animate!==void 0&&(T.zoom=i({animate:T.animate},T.zoom),T.pan=i({animate:T.animate,duration:T.duration},T.pan));var V=this._zoom!==y?this._tryAnimatedZoom&&this._tryAnimatedZoom(u,y,T.zoom):this._tryAnimatedPan(u,T.pan);if(V)return clearTimeout(this._sizeTimer),this}return this._resetView(u,y,T.pan&&T.pan.noMoveStart),this},setZoom:function(u,y){return this._loaded?this.setView(this.getCenter(),u,{zoom:y}):(this._zoom=u,this)},zoomIn:function(u,y){return u=u||(Ke.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+u,y)},zoomOut:function(u,y){return u=u||(Ke.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-u,y)},setZoomAround:function(u,y,T){var V=this.getZoomScale(y),W=this.getSize().divideBy(2),ne=u instanceof ie?u:this.latLngToContainerPoint(u),he=ne.subtract(W).multiplyBy(1-1/V),xe=this.containerPointToLatLng(W.add(he));return this.setView(xe,y,{zoom:T})},_getBoundsCenterZoom:function(u,y){y=y||{},u=u.getBounds?u.getBounds():ae(u);var T=G(y.paddingTopLeft||y.padding||[0,0]),V=G(y.paddingBottomRight||y.padding||[0,0]),W=this.getBoundsZoom(u,!1,T.add(V));if(W=typeof y.maxZoom=="number"?Math.min(y.maxZoom,W):W,W===1/0)return{center:u.getCenter(),zoom:W};var ne=V.subtract(T).divideBy(2),he=this.project(u.getSouthWest(),W),xe=this.project(u.getNorthEast(),W),Ee=this.unproject(he.add(xe).divideBy(2).add(ne),W);return{center:Ee,zoom:W}},fitBounds:function(u,y){if(u=ae(u),!u.isValid())throw new Error("Bounds are not valid.");var T=this._getBoundsCenterZoom(u,y);return this.setView(T.center,T.zoom,y)},fitWorld:function(u){return this.fitBounds([[-90,-180],[90,180]],u)},panTo:function(u,y){return this.setView(u,this._zoom,{pan:y})},panBy:function(u,y){if(u=G(u).round(),y=y||{},!u.x&&!u.y)return this.fire("moveend");if(y.animate!==!0&&!this.getSize().contains(u))return this._resetView(this.unproject(this.project(this.getCenter()).add(u)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Xo,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),y.noMoveStart||this.fire("movestart"),y.animate!==!1){wt(this._mapPane,"leaflet-pan-anim");var T=this._getMapPanePos().subtract(u).round();this._panAnim.run(this._mapPane,T,y.duration||.25,y.easeLinearity)}else this._rawPanBy(u),this.fire("move").fire("moveend");return this},flyTo:function(u,y,T){if(T=T||{},T.animate===!1||!Ke.any3d)return this.setView(u,y,T);this._stop();var V=this.project(this.getCenter()),W=this.project(u),ne=this.getSize(),he=this._zoom;u=Q(u),y=y===void 0?he:y;var xe=Math.max(ne.x,ne.y),Ee=xe*this.getZoomScale(he,y),Ce=W.distanceTo(V)||1,We=1.42,ht=We*We;function Rt(on){var gl=on?-1:1,N0=on?Ee:xe,I0=Ee*Ee-xe*xe+gl*ht*ht*Ce*Ce,sa=2*N0*ht*Ce,oa=I0/sa,aa=Math.sqrt(oa*oa+1)-oa,Ku=aa<1e-9?-18:Math.log(aa);return Ku}function ur(on){return(Math.exp(on)-Math.exp(-on))/2}function sr(on){return(Math.exp(on)+Math.exp(-on))/2}function ai(on){return ur(on)/sr(on)}var $r=Rt(0);function ml(on){return xe*(sr($r)/sr($r+We*on))}function Ih(on){return xe*(sr($r)*ai($r+We*on)-ur($r))/ht}function wo(on){return 1-Math.pow(1-on,1.5)}var Zm=Date.now(),ia=(Rt(1)-$r)/We,_s=T.duration?1e3*T.duration:1e3*ia*.8;function pl(){var on=(Date.now()-Zm)/_s,gl=wo(on)*ia;on<=1?(this._flyToFrame=C(pl,this),this._move(this.unproject(V.add(W.subtract(V).multiplyBy(Ih(gl)/Ce)),he),this.getScaleZoom(xe/ml(gl),he),{flyTo:!0})):this._move(u,y)._moveEnd(!0)}return this._moveStart(!0,T.noMoveStart),pl.call(this),this},flyToBounds:function(u,y){var T=this._getBoundsCenterZoom(u,y);return this.flyTo(T.center,T.zoom,y)},setMaxBounds:function(u){return u=ae(u),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),u.isValid()?(this.options.maxBounds=u,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(u){var y=this.options.minZoom;return this.options.minZoom=u,this._loaded&&y!==u&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(u):this},setMaxZoom:function(u){var y=this.options.maxZoom;return this.options.maxZoom=u,this._loaded&&y!==u&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(u):this},panInsideBounds:function(u,y){this._enforcingBounds=!0;var T=this.getCenter(),V=this._limitCenter(T,this._zoom,ae(u));return T.equals(V)||this.panTo(V,y),this._enforcingBounds=!1,this},panInside:function(u,y){y=y||{};var T=G(y.paddingTopLeft||y.padding||[0,0]),V=G(y.paddingBottomRight||y.padding||[0,0]),W=this.project(this.getCenter()),ne=this.project(u),he=this.getPixelBounds(),xe=Z([he.min.add(T),he.max.subtract(V)]),Ee=xe.getSize();if(!xe.contains(ne)){this._enforcingBounds=!0;var Ce=ne.subtract(xe.getCenter()),We=xe.extend(ne).getSize().subtract(Ee);W.x+=Ce.x<0?-We.x:We.x,W.y+=Ce.y<0?-We.y:We.y,this.panTo(this.unproject(W),y),this._enforcingBounds=!1}return this},invalidateSize:function(u){if(!this._loaded)return this;u=i({animate:!1,pan:!0},u===!0?{animate:!0}:u);var y=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var T=this.getSize(),V=y.divideBy(2).round(),W=T.divideBy(2).round(),ne=V.subtract(W);return!ne.x&&!ne.y?this:(u.animate&&u.pan?this.panBy(ne):(u.pan&&this._rawPanBy(ne),this.fire("move"),u.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:y,newSize:T}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(u){if(u=this._locateOptions=i({timeout:1e4,watch:!1},u),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var y=o(this._handleGeolocationResponse,this),T=o(this._handleGeolocationError,this);return u.watch?this._locationWatchId=navigator.geolocation.watchPosition(y,T,u):navigator.geolocation.getCurrentPosition(y,T,u),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(u){if(this._container._leaflet_id){var y=u.code,T=u.message||(y===1?"permission denied":y===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:y,message:"Geolocation error: "+T+"."})}},_handleGeolocationResponse:function(u){if(this._container._leaflet_id){var y=u.coords.latitude,T=u.coords.longitude,V=new le(y,T),W=V.toBounds(u.coords.accuracy*2),ne=this._locateOptions;if(ne.setView){var he=this.getBoundsZoom(W);this.setView(V,ne.maxZoom?Math.min(he,ne.maxZoom):he)}var xe={latlng:V,bounds:W,timestamp:u.timestamp};for(var Ee in u.coords)typeof u.coords[Ee]=="number"&&(xe[Ee]=u.coords[Ee]);this.fire("locationfound",xe)}},addHandler:function(u,y){if(!y)return this;var T=this[u]=new y(this);return this._handlers.push(T),this.options[u]&&T.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),un(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(M(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var u;for(u in this._layers)this._layers[u].remove();for(u in this._panes)un(this._panes[u]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(u,y){var T="leaflet-pane"+(u?" leaflet-"+u.replace("Pane","")+"-pane":""),V=At("div",T,y||this._mapPane);return u&&(this._panes[u]=V),V},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var u=this.getPixelBounds(),y=this.unproject(u.getBottomLeft()),T=this.unproject(u.getTopRight());return new J(y,T)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(u,y,T){u=ae(u),T=G(T||[0,0]);var V=this.getZoom()||0,W=this.getMinZoom(),ne=this.getMaxZoom(),he=u.getNorthWest(),xe=u.getSouthEast(),Ee=this.getSize().subtract(T),Ce=Z(this.project(xe,V),this.project(he,V)).getSize(),We=Ke.any3d?this.options.zoomSnap:1,ht=Ee.x/Ce.x,Rt=Ee.y/Ce.y,ur=y?Math.max(ht,Rt):Math.min(ht,Rt);return V=this.getScaleZoom(ur,V),We&&(V=Math.round(V/(We/100))*(We/100),V=y?Math.ceil(V/We)*We:Math.floor(V/We)*We),Math.max(W,Math.min(ne,V))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ie(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(u,y){var T=this._getTopLeftPoint(u,y);return new z(T,T.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(u){return this.options.crs.getProjectedBounds(u===void 0?this.getZoom():u)},getPane:function(u){return typeof u=="string"?this._panes[u]:u},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(u,y){var T=this.options.crs;return y=y===void 0?this._zoom:y,T.scale(u)/T.scale(y)},getScaleZoom:function(u,y){var T=this.options.crs;y=y===void 0?this._zoom:y;var V=T.zoom(u*T.scale(y));return isNaN(V)?1/0:V},project:function(u,y){return y=y===void 0?this._zoom:y,this.options.crs.latLngToPoint(Q(u),y)},unproject:function(u,y){return y=y===void 0?this._zoom:y,this.options.crs.pointToLatLng(G(u),y)},layerPointToLatLng:function(u){var y=G(u).add(this.getPixelOrigin());return this.unproject(y)},latLngToLayerPoint:function(u){var y=this.project(Q(u))._round();return y._subtract(this.getPixelOrigin())},wrapLatLng:function(u){return this.options.crs.wrapLatLng(Q(u))},wrapLatLngBounds:function(u){return this.options.crs.wrapLatLngBounds(ae(u))},distance:function(u,y){return this.options.crs.distance(Q(u),Q(y))},containerPointToLayerPoint:function(u){return G(u).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(u){return G(u).add(this._getMapPanePos())},containerPointToLatLng:function(u){var y=this.containerPointToLayerPoint(G(u));return this.layerPointToLatLng(y)},latLngToContainerPoint:function(u){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Q(u)))},mouseEventToContainerPoint:function(u){return Hs(u,this._container)},mouseEventToLayerPoint:function(u){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(u))},mouseEventToLatLng:function(u){return this.layerPointToLatLng(this.mouseEventToLayerPoint(u))},_initContainer:function(u){var y=this._container=lr(u);if(y){if(y._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");dt(y,"scroll",this._onScroll,this),this._containerId=d(y)},_initLayout:function(){var u=this._container;this._fadeAnimated=this.options.fadeAnimation&&Ke.any3d,wt(u,"leaflet-container"+(Ke.touch?" leaflet-touch":"")+(Ke.retina?" leaflet-retina":"")+(Ke.ielt9?" leaflet-oldie":"")+(Ke.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var y=mo(u,"position");y!=="absolute"&&y!=="relative"&&y!=="fixed"&&y!=="sticky"&&(u.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var u=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Nt(this._mapPane,new ie(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(wt(u.markerPane,"leaflet-zoom-hide"),wt(u.shadowPane,"leaflet-zoom-hide"))},_resetView:function(u,y,T){Nt(this._mapPane,new ie(0,0));var V=!this._loaded;this._loaded=!0,y=this._limitZoom(y),this.fire("viewprereset");var W=this._zoom!==y;this._moveStart(W,T)._move(u,y)._moveEnd(W),this.fire("viewreset"),V&&this.fire("load")},_moveStart:function(u,y){return u&&this.fire("zoomstart"),y||this.fire("movestart"),this},_move:function(u,y,T,V){y===void 0&&(y=this._zoom);var W=this._zoom!==y;return this._zoom=y,this._lastCenter=u,this._pixelOrigin=this._getNewPixelOrigin(u),V?T&&T.pinch&&this.fire("zoom",T):((W||T&&T.pinch)&&this.fire("zoom",T),this.fire("move",T)),this},_moveEnd:function(u){return u&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return M(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(u){Nt(this._mapPane,this._getMapPanePos().subtract(u))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(u){this._targets={},this._targets[d(this._container)]=this;var y=u?rn:dt;y(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&y(window,"resize",this._onResize,this),Ke.any3d&&this.options.transform3DLimit&&(u?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){M(this._resizeRequest),this._resizeRequest=C(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var u=this._getMapPanePos();Math.max(Math.abs(u.x),Math.abs(u.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(u,y){for(var T=[],V,W=y==="mouseout"||y==="mouseover",ne=u.target||u.srcElement,he=!1;ne;){if(V=this._targets[d(ne)],V&&(y==="click"||y==="preclick")&&this._draggableMoved(V)){he=!0;break}if(V&&V.listens(y,!0)&&(W&&!Zo(ne,u)||(T.push(V),W))||ne===this._container)break;ne=ne.parentNode}return!T.length&&!he&&!W&&this.listens(y,!0)&&(T=[this]),T},_isClickDisabled:function(u){for(;u&&u!==this._container;){if(u._leaflet_disable_click)return!0;u=u.parentNode}},_handleDOMEvent:function(u){var y=u.target||u.srcElement;if(!(!this._loaded||y._leaflet_disable_events||u.type==="click"&&this._isClickDisabled(y))){var T=u.type;T==="mousedown"&&Ti(y),this._fireDOMEvent(u,T)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(u,y,T){if(u.type==="click"){var V=i({},u);V.type="preclick",this._fireDOMEvent(V,V.type,T)}var W=this._findEventTargets(u,y);if(T){for(var ne=[],he=0;he<T.length;he++)T[he].listens(y,!0)&&ne.push(T[he]);W=ne.concat(W)}if(W.length){y==="contextmenu"&&hn(u);var xe=W[0],Ee={originalEvent:u};if(u.type!=="keypress"&&u.type!=="keydown"&&u.type!=="keyup"){var Ce=xe.getLatLng&&(!xe._radius||xe._radius<=10);Ee.containerPoint=Ce?this.latLngToContainerPoint(xe.getLatLng()):this.mouseEventToContainerPoint(u),Ee.layerPoint=this.containerPointToLayerPoint(Ee.containerPoint),Ee.latlng=Ce?xe.getLatLng():this.layerPointToLatLng(Ee.layerPoint)}for(he=0;he<W.length;he++)if(W[he].fire(y,Ee,!0),Ee.originalEvent._stopped||W[he].options.bubblingMouseEvents===!1&&I(this._mouseEvents,y)!==-1)return}},_draggableMoved:function(u){return u=u.dragging&&u.dragging.enabled()?u:this,u.dragging&&u.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var u=0,y=this._handlers.length;u<y;u++)this._handlers[u].disable()},whenReady:function(u,y){return this._loaded?u.call(y||this,{target:this}):this.on("load",u,y),this},_getMapPanePos:function(){return Ur(this._mapPane)||new ie(0,0)},_moved:function(){var u=this._getMapPanePos();return u&&!u.equals([0,0])},_getTopLeftPoint:function(u,y){var T=u&&y!==void 0?this._getNewPixelOrigin(u,y):this.getPixelOrigin();return T.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(u,y){var T=this.getSize()._divideBy(2);return this.project(u,y)._subtract(T)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(u,y,T){var V=this._getNewPixelOrigin(T,y);return this.project(u,y)._subtract(V)},_latLngBoundsToNewLayerBounds:function(u,y,T){var V=this._getNewPixelOrigin(T,y);return Z([this.project(u.getSouthWest(),y)._subtract(V),this.project(u.getNorthWest(),y)._subtract(V),this.project(u.getSouthEast(),y)._subtract(V),this.project(u.getNorthEast(),y)._subtract(V)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(u){return this.latLngToLayerPoint(u).subtract(this._getCenterLayerPoint())},_limitCenter:function(u,y,T){if(!T)return u;var V=this.project(u,y),W=this.getSize().divideBy(2),ne=new z(V.subtract(W),V.add(W)),he=this._getBoundsOffset(ne,T,y);return Math.abs(he.x)<=1&&Math.abs(he.y)<=1?u:this.unproject(V.add(he),y)},_limitOffset:function(u,y){if(!y)return u;var T=this.getPixelBounds(),V=new z(T.min.add(u),T.max.add(u));return u.add(this._getBoundsOffset(V,y))},_getBoundsOffset:function(u,y,T){var V=Z(this.project(y.getNorthEast(),T),this.project(y.getSouthWest(),T)),W=V.min.subtract(u.min),ne=V.max.subtract(u.max),he=this._rebound(W.x,-ne.x),xe=this._rebound(W.y,-ne.y);return new ie(he,xe)},_rebound:function(u,y){return u+y>0?Math.round(u-y)/2:Math.max(0,Math.ceil(u))-Math.max(0,Math.floor(y))},_limitZoom:function(u){var y=this.getMinZoom(),T=this.getMaxZoom(),V=Ke.any3d?this.options.zoomSnap:1;return V&&(u=Math.round(u/V)*V),Math.max(y,Math.min(T,u))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){dn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(u,y){var T=this._getCenterOffset(u)._trunc();return(y&&y.animate)!==!0&&!this.getSize().contains(T)?!1:(this.panBy(T,y),!0)},_createAnimProxy:function(){var u=this._proxy=At("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(u),this.on("zoomanim",function(y){var T=$i,V=this._proxy.style[T];zr(this._proxy,this.project(y.center,y.zoom),this.getZoomScale(y.zoom,1)),V===this._proxy.style[T]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){un(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var u=this.getCenter(),y=this.getZoom();zr(this._proxy,this.project(u,y),this.getZoomScale(y,1))},_catchTransitionEnd:function(u){this._animatingZoom&&u.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(u,y,T){if(this._animatingZoom)return!0;if(T=T||{},!this._zoomAnimated||T.animate===!1||this._nothingToAnimate()||Math.abs(y-this._zoom)>this.options.zoomAnimationThreshold)return!1;var V=this.getZoomScale(y),W=this._getCenterOffset(u)._divideBy(1-1/V);return T.animate!==!0&&!this.getSize().contains(W)?!1:(C(function(){this._moveStart(!0,T.noMoveStart||!1)._animateZoom(u,y,!0)},this),!0)},_animateZoom:function(u,y,T,V){this._mapPane&&(T&&(this._animatingZoom=!0,this._animateToCenter=u,this._animateToZoom=y,wt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:u,zoom:y,noUpdate:V}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&dn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function si(u,y){return new Dt(u,y)}var xr=$.extend({options:{position:"topright"},initialize:function(u){x(this,u)},getPosition:function(){return this.options.position},setPosition:function(u){var y=this._map;return y&&y.removeControl(this),this.options.position=u,y&&y.addControl(this),this},getContainer:function(){return this._container},addTo:function(u){this.remove(),this._map=u;var y=this._container=this.onAdd(u),T=this.getPosition(),V=u._controlCorners[T];return wt(y,"leaflet-control"),T.indexOf("bottom")!==-1?V.insertBefore(y,V.firstChild):V.appendChild(y),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(un(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(u){this._map&&u&&u.screenX>0&&u.screenY>0&&this._map.getContainer().focus()}}),nr=function(u){return new xr(u)};Dt.include({addControl:function(u){return u.addTo(this),this},removeControl:function(u){return u.remove(),this},_initControlPos:function(){var u=this._controlCorners={},y="leaflet-",T=this._controlContainer=At("div",y+"control-container",this._container);function V(W,ne){var he=y+W+" "+y+ne;u[W+ne]=At("div",he,T)}V("top","left"),V("top","right"),V("bottom","left"),V("bottom","right")},_clearControlPos:function(){for(var u in this._controlCorners)un(this._controlCorners[u]);un(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Qa=xr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(u,y,T,V){return T<V?-1:V<T?1:0}},initialize:function(u,y,T){x(this,T),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var V in u)this._addLayer(u[V],V);for(V in y)this._addLayer(y[V],V,!0)},onAdd:function(u){this._initLayout(),this._update(),this._map=u,u.on("zoomend",this._checkDisabledLayers,this);for(var y=0;y<this._layers.length;y++)this._layers[y].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(u){return xr.prototype.addTo.call(this,u),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var u=0;u<this._layers.length;u++)this._layers[u].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(u,y){return this._addLayer(u,y),this._map?this._update():this},addOverlay:function(u,y){return this._addLayer(u,y,!0),this._map?this._update():this},removeLayer:function(u){u.off("add remove",this._onLayerChange,this);var y=this._getLayer(d(u));return y&&this._layers.splice(this._layers.indexOf(y),1),this._map?this._update():this},expand:function(){wt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var u=this._map.getSize().y-(this._container.offsetTop+50);return u<this._section.clientHeight?(wt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=u+"px"):dn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return dn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var u="leaflet-control-layers",y=this._container=At("div",u),T=this.options.collapsed;y.setAttribute("aria-haspopup",!0),yo(y),qs(y);var V=this._section=At("section",u+"-list");T&&(this._map.on("click",this.collapse,this),dt(y,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var W=this._layersLink=At("a",u+"-toggle",y);W.href="#",W.title="Layers",W.setAttribute("role","button"),dt(W,{keydown:function(ne){ne.keyCode===13&&this._expandSafely()},click:function(ne){hn(ne),this._expandSafely()}},this),T||this.expand(),this._baseLayersList=At("div",u+"-base",V),this._separator=At("div",u+"-separator",V),this._overlaysList=At("div",u+"-overlays",V),y.appendChild(V)},_getLayer:function(u){for(var y=0;y<this._layers.length;y++)if(this._layers[y]&&d(this._layers[y].layer)===u)return this._layers[y]},_addLayer:function(u,y,T){this._map&&u.on("add remove",this._onLayerChange,this),this._layers.push({layer:u,name:y,overlay:T}),this.options.sortLayers&&this._layers.sort(o(function(V,W){return this.options.sortFunction(V.layer,W.layer,V.name,W.name)},this)),this.options.autoZIndex&&u.setZIndex&&(this._lastZIndex++,u.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Wo(this._baseLayersList),Wo(this._overlaysList),this._layerControlInputs=[];var u,y,T,V,W=0;for(T=0;T<this._layers.length;T++)V=this._layers[T],this._addItem(V),y=y||V.overlay,u=u||!V.overlay,W+=V.overlay?0:1;return this.options.hideSingleBase&&(u=u&&W>1,this._baseLayersList.style.display=u?"":"none"),this._separator.style.display=y&&u?"":"none",this},_onLayerChange:function(u){this._handlingClick||this._update();var y=this._getLayer(d(u.target)),T=y.overlay?u.type==="add"?"overlayadd":"overlayremove":u.type==="add"?"baselayerchange":null;T&&this._map.fire(T,y)},_createRadioElement:function(u,y){var T='<input type="radio" class="leaflet-control-layers-selector" name="'+u+'"'+(y?' checked="checked"':"")+"/>",V=document.createElement("div");return V.innerHTML=T,V.firstChild},_addItem:function(u){var y=document.createElement("label"),T=this._map.hasLayer(u.layer),V;u.overlay?(V=document.createElement("input"),V.type="checkbox",V.className="leaflet-control-layers-selector",V.defaultChecked=T):V=this._createRadioElement("leaflet-base-layers_"+d(this),T),this._layerControlInputs.push(V),V.layerId=d(u.layer),dt(V,"click",this._onInputClick,this);var W=document.createElement("span");W.innerHTML=" "+u.name;var ne=document.createElement("span");y.appendChild(ne),ne.appendChild(V),ne.appendChild(W);var he=u.overlay?this._overlaysList:this._baseLayersList;return he.appendChild(y),this._checkDisabledLayers(),y},_onInputClick:function(){if(!this._preventClick){var u=this._layerControlInputs,y,T,V=[],W=[];this._handlingClick=!0;for(var ne=u.length-1;ne>=0;ne--)y=u[ne],T=this._getLayer(y.layerId).layer,y.checked?V.push(T):y.checked||W.push(T);for(ne=0;ne<W.length;ne++)this._map.hasLayer(W[ne])&&this._map.removeLayer(W[ne]);for(ne=0;ne<V.length;ne++)this._map.hasLayer(V[ne])||this._map.addLayer(V[ne]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var u=this._layerControlInputs,y,T,V=this._map.getZoom(),W=u.length-1;W>=0;W--)y=u[W],T=this._getLayer(y.layerId).layer,y.disabled=T.options.minZoom!==void 0&&V<T.options.minZoom||T.options.maxZoom!==void 0&&V>T.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var u=this._section;this._preventClick=!0,dt(u,"click",hn),this.expand();var y=this;setTimeout(function(){rn(u,"click",hn),y._preventClick=!1})}}),Xa=function(u,y,T){return new Qa(u,y,T)},Ni=xr.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(u){var y="leaflet-control-zoom",T=At("div",y+" leaflet-bar"),V=this.options;return this._zoomInButton=this._createButton(V.zoomInText,V.zoomInTitle,y+"-in",T,this._zoomIn),this._zoomOutButton=this._createButton(V.zoomOutText,V.zoomOutTitle,y+"-out",T,this._zoomOut),this._updateDisabled(),u.on("zoomend zoomlevelschange",this._updateDisabled,this),T},onRemove:function(u){u.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(u){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(u.shiftKey?3:1))},_zoomOut:function(u){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(u.shiftKey?3:1))},_createButton:function(u,y,T,V,W){var ne=At("a",T,V);return ne.innerHTML=u,ne.href="#",ne.title=y,ne.setAttribute("role","button"),ne.setAttribute("aria-label",y),yo(ne),dt(ne,"click",cr),dt(ne,"click",W,this),dt(ne,"click",this._refocusOnMap,this),ne},_updateDisabled:function(){var u=this._map,y="leaflet-disabled";dn(this._zoomInButton,y),dn(this._zoomOutButton,y),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||u._zoom===u.getMinZoom())&&(wt(this._zoomOutButton,y),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||u._zoom===u.getMaxZoom())&&(wt(this._zoomInButton,y),this._zoomInButton.setAttribute("aria-disabled","true"))}});Dt.mergeOptions({zoomControl:!0}),Dt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Ni,this.addControl(this.zoomControl))});var xc=function(u){return new Ni(u)},rr=xr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(u){var y="leaflet-control-scale",T=At("div",y),V=this.options;return this._addScales(V,y+"-line",T),u.on(V.updateWhenIdle?"moveend":"move",this._update,this),u.whenReady(this._update,this),T},onRemove:function(u){u.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(u,y,T){u.metric&&(this._mScale=At("div",y,T)),u.imperial&&(this._iScale=At("div",y,T))},_update:function(){var u=this._map,y=u.getSize().y/2,T=u.distance(u.containerPointToLatLng([0,y]),u.containerPointToLatLng([this.options.maxWidth,y]));this._updateScales(T)},_updateScales:function(u){this.options.metric&&u&&this._updateMetric(u),this.options.imperial&&u&&this._updateImperial(u)},_updateMetric:function(u){var y=this._getRoundNum(u),T=y<1e3?y+" m":y/1e3+" km";this._updateScale(this._mScale,T,y/u)},_updateImperial:function(u){var y=u*3.2808399,T,V,W;y>5280?(T=y/5280,V=this._getRoundNum(T),this._updateScale(this._iScale,V+" mi",V/T)):(W=this._getRoundNum(y),this._updateScale(this._iScale,W+" ft",W/y))},_updateScale:function(u,y,T){u.style.width=Math.round(this.options.maxWidth*T)+"px",u.innerHTML=y},_getRoundNum:function(u){var y=Math.pow(10,(Math.floor(u)+"").length-1),T=u/y;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:1,y*T}}),Yi=function(u){return new rr(u)},Ja='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Ii=xr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(Ke.inlineSvg?Ja+" ":"")+"Leaflet</a>"},initialize:function(u){x(this,u),this._attributions={}},onAdd:function(u){u.attributionControl=this,this._container=At("div","leaflet-control-attribution"),yo(this._container);for(var y in u._layers)u._layers[y].getAttribution&&this.addAttribution(u._layers[y].getAttribution());return this._update(),u.on("layeradd",this._addAttribution,this),this._container},onRemove:function(u){u.off("layeradd",this._addAttribution,this)},_addAttribution:function(u){u.layer.getAttribution&&(this.addAttribution(u.layer.getAttribution()),u.layer.once("remove",function(){this.removeAttribution(u.layer.getAttribution())},this))},setPrefix:function(u){return this.options.prefix=u,this._update(),this},addAttribution:function(u){return u?(this._attributions[u]||(this._attributions[u]=0),this._attributions[u]++,this._update(),this):this},removeAttribution:function(u){return u?(this._attributions[u]&&(this._attributions[u]--,this._update()),this):this},_update:function(){if(this._map){var u=[];for(var y in this._attributions)this._attributions[y]&&u.push(y);var T=[];this.options.prefix&&T.push(this.options.prefix),u.length&&T.push(u.join(", ")),this._container.innerHTML=T.join(' <span aria-hidden="true">|</span> ')}}});Dt.mergeOptions({attributionControl:!0}),Dt.addInitHook(function(){this.options.attributionControl&&new Ii().addTo(this)});var gh=function(u){return new Ii(u)};xr.Layers=Qa,xr.Zoom=Ni,xr.Scale=rr,xr.Attribution=Ii,nr.layers=Xa,nr.zoom=xc,nr.scale=Yi,nr.attribution=gh;var jr=$.extend({initialize:function(u){this._map=u},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});jr.addTo=function(u,y){return u.addHandler(y,this),this};var $s={Events:ee},Ws=Ke.touch?"touchstart mousedown":"mousedown",qr=se.extend({options:{clickTolerance:3},initialize:function(u,y,T,V){x(this,V),this._element=u,this._dragStartTarget=y||u,this._preventOutline=T},enable:function(){this._enabled||(dt(this._dragStartTarget,Ws,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(qr._dragging===this&&this.finishDrag(!0),rn(this._dragStartTarget,Ws,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(u){if(this._enabled&&(this._moved=!1,!po(this._element,"leaflet-zoom-anim"))){if(u.touches&&u.touches.length!==1){qr._dragging===this&&this.finishDrag();return}if(!(qr._dragging||u.shiftKey||u.which!==1&&u.button!==1&&!u.touches)&&(qr._dragging=this,this._preventOutline&&Ti(this._element),Ka(),jt(),!this._moving)){this.fire("down");var y=u.touches?u.touches[0]:u,T=Ai(this._element);this._startPoint=new ie(y.clientX,y.clientY),this._startPos=Ur(this._element),this._parentScale=ii(T);var V=u.type==="mousedown";dt(document,V?"mousemove":"touchmove",this._onMove,this),dt(document,V?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(u){if(this._enabled){if(u.touches&&u.touches.length>1){this._moved=!0;return}var y=u.touches&&u.touches.length===1?u.touches[0]:u,T=new ie(y.clientX,y.clientY)._subtract(this._startPoint);!T.x&&!T.y||Math.abs(T.x)+Math.abs(T.y)<this.options.clickTolerance||(T.x/=this._parentScale.x,T.y/=this._parentScale.y,hn(u),this._moved||(this.fire("dragstart"),this._moved=!0,wt(document.body,"leaflet-dragging"),this._lastTarget=u.target||u.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),wt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(T),this._moving=!0,this._lastEvent=u,this._updatePosition())}},_updatePosition:function(){var u={originalEvent:this._lastEvent};this.fire("predrag",u),Nt(this._element,this._newPos),this.fire("drag",u)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(u){dn(document.body,"leaflet-dragging"),this._lastTarget&&(dn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),rn(document,"mousemove touchmove",this._onMove,this),rn(document,"mouseup touchend touchcancel",this._onUp,this),Ya(),Si();var y=this._moved&&this._moving;this._moving=!1,qr._dragging=!1,y&&this.fire("dragend",{noInertia:u,distance:this._newPos.distanceTo(this._startPos)})}});function Jo(u,y,T){var V,W=[1,4,2,8],ne,he,xe,Ee,Ce,We,ht,Rt;for(ne=0,We=u.length;ne<We;ne++)u[ne]._code=ps(u[ne],y);for(xe=0;xe<4;xe++){for(ht=W[xe],V=[],ne=0,We=u.length,he=We-1;ne<We;he=ne++)Ee=u[ne],Ce=u[he],Ee._code&ht?Ce._code&ht||(Rt=ir(Ce,Ee,ht,y,T),Rt._code=ps(Rt,y),V.push(Rt)):(Ce._code&ht&&(Rt=ir(Ce,Ee,ht,y,T),Rt._code=ps(Rt,y),V.push(Rt)),V.push(Ee));u=V}return u}function el(u,y){var T,V,W,ne,he,xe,Ee,Ce,We;if(!u||u.length===0)throw new Error("latlngs not passed");w(u)||(console.warn("latlngs are not flat! Only the first ring will be used"),u=u[0]);var ht=Q([0,0]),Rt=ae(u),ur=Rt.getNorthWest().distanceTo(Rt.getSouthWest())*Rt.getNorthEast().distanceTo(Rt.getNorthWest());ur<1700&&(ht=tl(u));var sr=u.length,ai=[];for(T=0;T<sr;T++){var $r=Q(u[T]);ai.push(y.project(Q([$r.lat-ht.lat,$r.lng-ht.lng])))}for(xe=Ee=Ce=0,T=0,V=sr-1;T<sr;V=T++)W=ai[T],ne=ai[V],he=W.y*ne.x-ne.y*W.x,Ee+=(W.x+ne.x)*he,Ce+=(W.y+ne.y)*he,xe+=he*3;xe===0?We=ai[0]:We=[Ee/xe,Ce/xe];var ml=y.unproject(G(We));return Q([ml.lat+ht.lat,ml.lng+ht.lng])}function tl(u){for(var y=0,T=0,V=0,W=0;W<u.length;W++){var ne=Q(u[W]);y+=ne.lat,T+=ne.lng,V++}return Q([y/V,T/V])}var nl={__proto__:null,clipPolygon:Jo,polygonCenter:el,centroid:tl};function ea(u,y){if(!y||!u.length)return u.slice();var T=y*y;return u=Mu(u,T),u=Du(u,T),u}function bc(u,y,T){return Math.sqrt(Hr(u,y,T,!0))}function Gs(u,y,T){return Hr(u,y,T)}function Du(u,y){var T=u.length,V=typeof Uint8Array<"u"?Uint8Array:Array,W=new V(T);W[0]=W[T-1]=1,rl(u,W,y,0,T-1);var ne,he=[];for(ne=0;ne<T;ne++)W[ne]&&he.push(u[ne]);return he}function rl(u,y,T,V,W){var ne=0,he,xe,Ee;for(xe=V+1;xe<=W-1;xe++)Ee=Hr(u[xe],u[V],u[W],!0),Ee>ne&&(he=xe,ne=Ee);ne>T&&(y[he]=1,rl(u,y,T,V,he),rl(u,y,T,he,W))}function Mu(u,y){for(var T=[u[0]],V=1,W=0,ne=u.length;V<ne;V++)Lu(u[V],u[W])>y&&(T.push(u[V]),W=V);return W<ne-1&&T.push(u[ne-1]),T}var il;function ta(u,y,T,V,W){var ne=V?il:ps(u,T),he=ps(y,T),xe,Ee,Ce;for(il=he;;){if(!(ne|he))return[u,y];if(ne&he)return!1;xe=ne||he,Ee=ir(u,y,xe,T,W),Ce=ps(Ee,T),xe===ne?(u=Ee,ne=Ce):(y=Ee,he=Ce)}}function ir(u,y,T,V,W){var ne=y.x-u.x,he=y.y-u.y,xe=V.min,Ee=V.max,Ce,We;return T&8?(Ce=u.x+ne*(Ee.y-u.y)/he,We=Ee.y):T&4?(Ce=u.x+ne*(xe.y-u.y)/he,We=xe.y):T&2?(Ce=Ee.x,We=u.y+he*(Ee.x-u.x)/ne):T&1&&(Ce=xe.x,We=u.y+he*(xe.x-u.x)/ne),new ie(Ce,We,W)}function ps(u,y){var T=0;return u.x<y.min.x?T|=1:u.x>y.max.x&&(T|=2),u.y<y.min.y?T|=4:u.y>y.max.y&&(T|=8),T}function Lu(u,y){var T=y.x-u.x,V=y.y-u.y;return T*T+V*V}function Hr(u,y,T,V){var W=y.x,ne=y.y,he=T.x-W,xe=T.y-ne,Ee=he*he+xe*xe,Ce;return Ee>0&&(Ce=((u.x-W)*he+(u.y-ne)*xe)/Ee,Ce>1?(W=T.x,ne=T.y):Ce>0&&(W+=he*Ce,ne+=xe*Ce)),he=u.x-W,xe=u.y-ne,V?he*he+xe*xe:new ie(W,ne)}function w(u){return!R(u[0])||typeof u[0][0]!="object"&&typeof u[0][0]<"u"}function q(u){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),w(u)}function Y(u,y){var T,V,W,ne,he,xe,Ee,Ce;if(!u||u.length===0)throw new Error("latlngs not passed");w(u)||(console.warn("latlngs are not flat! Only the first ring will be used"),u=u[0]);var We=Q([0,0]),ht=ae(u),Rt=ht.getNorthWest().distanceTo(ht.getSouthWest())*ht.getNorthEast().distanceTo(ht.getNorthWest());Rt<1700&&(We=tl(u));var ur=u.length,sr=[];for(T=0;T<ur;T++){var ai=Q(u[T]);sr.push(y.project(Q([ai.lat-We.lat,ai.lng-We.lng])))}for(T=0,V=0;T<ur-1;T++)V+=sr[T].distanceTo(sr[T+1])/2;if(V===0)Ce=sr[0];else for(T=0,ne=0;T<ur-1;T++)if(he=sr[T],xe=sr[T+1],W=he.distanceTo(xe),ne+=W,ne>V){Ee=(ne-V)/W,Ce=[xe.x-Ee*(xe.x-he.x),xe.y-Ee*(xe.y-he.y)];break}var $r=y.unproject(G(Ce));return Q([$r.lat+We.lat,$r.lng+We.lng])}var oe={__proto__:null,simplify:ea,pointToSegmentDistance:bc,closestPointOnSegment:Gs,clipSegment:ta,_getEdgeIntersection:ir,_getBitCode:ps,_sqClosestPointOnSegment:Hr,isFlat:w,_flat:q,polylineCenter:Y},ye={project:function(u){return new ie(u.lng,u.lat)},unproject:function(u){return new le(u.y,u.x)},bounds:new z([-180,-90],[180,90])},Ae={R:6378137,R_MINOR:6356752314245179e-9,bounds:new z([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(u){var y=Math.PI/180,T=this.R,V=u.lat*y,W=this.R_MINOR/T,ne=Math.sqrt(1-W*W),he=ne*Math.sin(V),xe=Math.tan(Math.PI/4-V/2)/Math.pow((1-he)/(1+he),ne/2);return V=-T*Math.log(Math.max(xe,1e-10)),new ie(u.lng*y*T,V)},unproject:function(u){for(var y=180/Math.PI,T=this.R,V=this.R_MINOR/T,W=Math.sqrt(1-V*V),ne=Math.exp(-u.y/T),he=Math.PI/2-2*Math.atan(ne),xe=0,Ee=.1,Ce;xe<15&&Math.abs(Ee)>1e-7;xe++)Ce=W*Math.sin(he),Ce=Math.pow((1-Ce)/(1+Ce),W/2),Ee=Math.PI/2-2*Math.atan(ne*Ce)-he,he+=Ee;return new le(he*y,u.x*y/T)}},He={__proto__:null,LonLat:ye,Mercator:Ae,SphericalMercator:ve},nn=i({},ue,{code:"EPSG:3395",projection:Ae,transformation:function(){var u=.5/(Math.PI*Ae.R);return Pe(u,.5,-u,.5)}()}),Hn=i({},ue,{code:"EPSG:4326",projection:ye,transformation:Pe(1/180,1,-1/180,.5)}),Ht=i({},ce,{projection:ye,transformation:Pe(1,0,-1,0),scale:function(u){return Math.pow(2,u)},zoom:function(u){return Math.log(u)/Math.LN2},distance:function(u,y){var T=y.lng-u.lng,V=y.lat-u.lat;return Math.sqrt(T*T+V*V)},infinite:!0});ce.Earth=ue,ce.EPSG3395=nn,ce.EPSG3857=qe,ce.EPSG900913=Ge,ce.EPSG4326=Hn,ce.Simple=Ht;var sn=se.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(u){return u.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(u){return u&&u.removeLayer(this),this},getPane:function(u){return this._map.getPane(u?this.options[u]||u:this.options.pane)},addInteractiveTarget:function(u){return this._map._targets[d(u)]=this,this},removeInteractiveTarget:function(u){return delete this._map._targets[d(u)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(u){var y=u.target;if(y.hasLayer(this)){if(this._map=y,this._zoomAnimated=y._zoomAnimated,this.getEvents){var T=this.getEvents();y.on(T,this),this.once("remove",function(){y.off(T,this)},this)}this.onAdd(y),this.fire("add"),y.fire("layeradd",{layer:this})}}});Dt.include({addLayer:function(u){if(!u._layerAdd)throw new Error("The provided object is not a Layer.");var y=d(u);return this._layers[y]?this:(this._layers[y]=u,u._mapToAdd=this,u.beforeAdd&&u.beforeAdd(this),this.whenReady(u._layerAdd,u),this)},removeLayer:function(u){var y=d(u);return this._layers[y]?(this._loaded&&u.onRemove(this),delete this._layers[y],this._loaded&&(this.fire("layerremove",{layer:u}),u.fire("remove")),u._map=u._mapToAdd=null,this):this},hasLayer:function(u){return d(u)in this._layers},eachLayer:function(u,y){for(var T in this._layers)u.call(y,this._layers[T]);return this},_addLayers:function(u){u=u?R(u)?u:[u]:[];for(var y=0,T=u.length;y<T;y++)this.addLayer(u[y])},_addZoomLimit:function(u){(!isNaN(u.options.maxZoom)||!isNaN(u.options.minZoom))&&(this._zoomBoundLayers[d(u)]=u,this._updateZoomLevels())},_removeZoomLimit:function(u){var y=d(u);this._zoomBoundLayers[y]&&(delete this._zoomBoundLayers[y],this._updateZoomLevels())},_updateZoomLevels:function(){var u=1/0,y=-1/0,T=this._getZoomSpan();for(var V in this._zoomBoundLayers){var W=this._zoomBoundLayers[V].options;u=W.minZoom===void 0?u:Math.min(u,W.minZoom),y=W.maxZoom===void 0?y:Math.max(y,W.maxZoom)}this._layersMaxZoom=y===-1/0?void 0:y,this._layersMinZoom=u===1/0?void 0:u,T!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var En=sn.extend({initialize:function(u,y){x(this,y),this._layers={};var T,V;if(u)for(T=0,V=u.length;T<V;T++)this.addLayer(u[T])},addLayer:function(u){var y=this.getLayerId(u);return this._layers[y]=u,this._map&&this._map.addLayer(u),this},removeLayer:function(u){var y=u in this._layers?u:this.getLayerId(u);return this._map&&this._layers[y]&&this._map.removeLayer(this._layers[y]),delete this._layers[y],this},hasLayer:function(u){var y=typeof u=="number"?u:this.getLayerId(u);return y in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(u){var y=Array.prototype.slice.call(arguments,1),T,V;for(T in this._layers)V=this._layers[T],V[u]&&V[u].apply(V,y);return this},onAdd:function(u){this.eachLayer(u.addLayer,u)},onRemove:function(u){this.eachLayer(u.removeLayer,u)},eachLayer:function(u,y){for(var T in this._layers)u.call(y,this._layers[T]);return this},getLayer:function(u){return this._layers[u]},getLayers:function(){var u=[];return this.eachLayer(u.push,u),u},setZIndex:function(u){return this.invoke("setZIndex",u)},getLayerId:function(u){return d(u)}}),Pi=function(u,y){return new En(u,y)},Vn=En.extend({addLayer:function(u){return this.hasLayer(u)?this:(u.addEventParent(this),En.prototype.addLayer.call(this,u),this.fire("layeradd",{layer:u}))},removeLayer:function(u){return this.hasLayer(u)?(u in this._layers&&(u=this._layers[u]),u.removeEventParent(this),En.prototype.removeLayer.call(this,u),this.fire("layerremove",{layer:u})):this},setStyle:function(u){return this.invoke("setStyle",u)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var u=new J;for(var y in this._layers){var T=this._layers[y];u.extend(T.getBounds?T.getBounds():T.getLatLng())}return u}}),na=function(u,y){return new Vn(u,y)},Zi=$.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(u){x(this,u)},createIcon:function(u){return this._createIcon("icon",u)},createShadow:function(u){return this._createIcon("shadow",u)},_createIcon:function(u,y){var T=this._getIconUrl(u);if(!T){if(u==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var V=this._createImg(T,y&&y.tagName==="IMG"?y:null);return this._setIconStyles(V,u),(this.options.crossOrigin||this.options.crossOrigin==="")&&(V.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),V},_setIconStyles:function(u,y){var T=this.options,V=T[y+"Size"];typeof V=="number"&&(V=[V,V]);var W=G(V),ne=G(y==="shadow"&&T.shadowAnchor||T.iconAnchor||W&&W.divideBy(2,!0));u.className="leaflet-marker-"+y+" "+(T.className||""),ne&&(u.style.marginLeft=-ne.x+"px",u.style.marginTop=-ne.y+"px"),W&&(u.style.width=W.x+"px",u.style.height=W.y+"px")},_createImg:function(u,y){return y=y||document.createElement("img"),y.src=u,y},_getIconUrl:function(u){return Ke.retina&&this.options[u+"RetinaUrl"]||this.options[u+"Url"]}});function Vm(u){return new Zi(u)}var sl=Zi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(u){return typeof sl.imagePath!="string"&&(sl.imagePath=this._detectIconPath()),(this.options.imagePath||sl.imagePath)+Zi.prototype._getIconUrl.call(this,u)},_stripUrl:function(u){var y=function(T,V,W){var ne=V.exec(T);return ne&&ne[W]};return u=y(u,/^url\((['"])?(.+)\1\)$/,2),u&&y(u,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var u=At("div","leaflet-default-icon-path",document.body),y=mo(u,"background-image")||mo(u,"backgroundImage");if(document.body.removeChild(u),y=this._stripUrl(y),y)return y;var T=document.querySelector('link[href$="leaflet.css"]');return T?T.href.substring(0,T.href.length-11-1):""}}),yh=jr.extend({initialize:function(u){this._marker=u},addHooks:function(){var u=this._marker._icon;this._draggable||(this._draggable=new qr(u,u,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),wt(u,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&dn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(u){var y=this._marker,T=y._map,V=this._marker.options.autoPanSpeed,W=this._marker.options.autoPanPadding,ne=Ur(y._icon),he=T.getPixelBounds(),xe=T.getPixelOrigin(),Ee=Z(he.min._subtract(xe).add(W),he.max._subtract(xe).subtract(W));if(!Ee.contains(ne)){var Ce=G((Math.max(Ee.max.x,ne.x)-Ee.max.x)/(he.max.x-Ee.max.x)-(Math.min(Ee.min.x,ne.x)-Ee.min.x)/(he.min.x-Ee.min.x),(Math.max(Ee.max.y,ne.y)-Ee.max.y)/(he.max.y-Ee.max.y)-(Math.min(Ee.min.y,ne.y)-Ee.min.y)/(he.min.y-Ee.min.y)).multiplyBy(V);T.panBy(Ce,{animate:!1}),this._draggable._newPos._add(Ce),this._draggable._startPos._add(Ce),Nt(y._icon,this._draggable._newPos),this._onDrag(u),this._panRequest=C(this._adjustPan.bind(this,u))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(u){this._marker.options.autoPan&&(M(this._panRequest),this._panRequest=C(this._adjustPan.bind(this,u)))},_onDrag:function(u){var y=this._marker,T=y._shadow,V=Ur(y._icon),W=y._map.layerPointToLatLng(V);T&&Nt(T,V),y._latlng=W,u.latlng=W,u.oldLatLng=this._oldLatLng,y.fire("move",u).fire("drag",u)},_onDragEnd:function(u){M(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",u)}}),Ks=sn.extend({options:{icon:new sl,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(u,y){x(this,y),this._latlng=Q(u)},onAdd:function(u){this._zoomAnimated=this._zoomAnimated&&u.options.markerZoomAnimation,this._zoomAnimated&&u.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(u){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&u.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(u){var y=this._latlng;return this._latlng=Q(u),this.update(),this.fire("move",{oldLatLng:y,latlng:this._latlng})},setZIndexOffset:function(u){return this.options.zIndexOffset=u,this.update()},getIcon:function(){return this.options.icon},setIcon:function(u){return this.options.icon=u,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var u=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(u)}return this},_initIcon:function(){var u=this.options,y="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),T=u.icon.createIcon(this._icon),V=!1;T!==this._icon&&(this._icon&&this._removeIcon(),V=!0,u.title&&(T.title=u.title),T.tagName==="IMG"&&(T.alt=u.alt||"")),wt(T,y),u.keyboard&&(T.tabIndex="0",T.setAttribute("role","button")),this._icon=T,u.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&dt(T,"focus",this._panOnFocus,this);var W=u.icon.createShadow(this._shadow),ne=!1;W!==this._shadow&&(this._removeShadow(),ne=!0),W&&(wt(W,y),W.alt=""),this._shadow=W,u.opacity<1&&this._updateOpacity(),V&&this.getPane().appendChild(this._icon),this._initInteraction(),W&&ne&&this.getPane(u.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&rn(this._icon,"focus",this._panOnFocus,this),un(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&un(this._shadow),this._shadow=null},_setPos:function(u){this._icon&&Nt(this._icon,u),this._shadow&&Nt(this._shadow,u),this._zIndex=u.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(u){this._icon&&(this._icon.style.zIndex=this._zIndex+u)},_animateZoom:function(u){var y=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center).round();this._setPos(y)},_initInteraction:function(){if(this.options.interactive&&(wt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),yh)){var u=this.options.draggable;this.dragging&&(u=this.dragging.enabled(),this.dragging.disable()),this.dragging=new yh(this),u&&this.dragging.enable()}},setOpacity:function(u){return this.options.opacity=u,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var u=this.options.opacity;this._icon&&Tn(this._icon,u),this._shadow&&Tn(this._shadow,u)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var u=this._map;if(u){var y=this.options.icon.options,T=y.iconSize?G(y.iconSize):G(0,0),V=y.iconAnchor?G(y.iconAnchor):G(0,0);u.panInside(this._latlng,{paddingTopLeft:V,paddingBottomRight:T.subtract(V)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function E0(u,y){return new Ks(u,y)}var vo=sn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(u){this._renderer=u.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(u){return x(this,u),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&u&&Object.prototype.hasOwnProperty.call(u,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Fu=vo.extend({options:{fill:!0,radius:10},initialize:function(u,y){x(this,y),this._latlng=Q(u),this._radius=this.options.radius},setLatLng:function(u){var y=this._latlng;return this._latlng=Q(u),this.redraw(),this.fire("move",{oldLatLng:y,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(u){return this.options.radius=this._radius=u,this.redraw()},getRadius:function(){return this._radius},setStyle:function(u){var y=u&&u.radius||this._radius;return vo.prototype.setStyle.call(this,u),this.setRadius(y),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var u=this._radius,y=this._radiusY||u,T=this._clickTolerance(),V=[u+T,y+T];this._pxBounds=new z(this._point.subtract(V),this._point.add(V))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(u){return u.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Bm(u,y){return new Fu(u,y)}var Vu=Fu.extend({initialize:function(u,y,T){if(typeof y=="number"&&(y=i({},T,{radius:y})),x(this,y),this._latlng=Q(u),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(u){return this._mRadius=u,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var u=[this._radius,this._radiusY||this._radius];return new J(this._map.layerPointToLatLng(this._point.subtract(u)),this._map.layerPointToLatLng(this._point.add(u)))},setStyle:vo.prototype.setStyle,_project:function(){var u=this._latlng.lng,y=this._latlng.lat,T=this._map,V=T.options.crs;if(V.distance===ue.distance){var W=Math.PI/180,ne=this._mRadius/ue.R/W,he=T.project([y+ne,u]),xe=T.project([y-ne,u]),Ee=he.add(xe).divideBy(2),Ce=T.unproject(Ee).lat,We=Math.acos((Math.cos(ne*W)-Math.sin(y*W)*Math.sin(Ce*W))/(Math.cos(y*W)*Math.cos(Ce*W)))/W;(isNaN(We)||We===0)&&(We=ne/Math.cos(Math.PI/180*y)),this._point=Ee.subtract(T.getPixelOrigin()),this._radius=isNaN(We)?0:Ee.x-T.project([Ce,u-We]).x,this._radiusY=Ee.y-he.y}else{var ht=V.unproject(V.project(this._latlng).subtract([this._mRadius,0]));this._point=T.latLngToLayerPoint(this._latlng),this._radius=this._point.x-T.latLngToLayerPoint(ht).x}this._updateBounds()}});function wc(u,y,T){return new Vu(u,y,T)}var oi=vo.extend({options:{smoothFactor:1,noClip:!1},initialize:function(u,y){x(this,y),this._setLatLngs(u)},getLatLngs:function(){return this._latlngs},setLatLngs:function(u){return this._setLatLngs(u),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(u){for(var y=1/0,T=null,V=Hr,W,ne,he=0,xe=this._parts.length;he<xe;he++)for(var Ee=this._parts[he],Ce=1,We=Ee.length;Ce<We;Ce++){W=Ee[Ce-1],ne=Ee[Ce];var ht=V(u,W,ne,!0);ht<y&&(y=ht,T=V(u,W,ne))}return T&&(T.distance=Math.sqrt(y)),T},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Y(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(u,y){return y=y||this._defaultShape(),u=Q(u),y.push(u),this._bounds.extend(u),this.redraw()},_setLatLngs:function(u){this._bounds=new J,this._latlngs=this._convertLatLngs(u)},_defaultShape:function(){return w(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(u){for(var y=[],T=w(u),V=0,W=u.length;V<W;V++)T?(y[V]=Q(u[V]),this._bounds.extend(y[V])):y[V]=this._convertLatLngs(u[V]);return y},_project:function(){var u=new z;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,u),this._bounds.isValid()&&u.isValid()&&(this._rawPxBounds=u,this._updateBounds())},_updateBounds:function(){var u=this._clickTolerance(),y=new ie(u,u);this._rawPxBounds&&(this._pxBounds=new z([this._rawPxBounds.min.subtract(y),this._rawPxBounds.max.add(y)]))},_projectLatlngs:function(u,y,T){var V=u[0]instanceof le,W=u.length,ne,he;if(V){for(he=[],ne=0;ne<W;ne++)he[ne]=this._map.latLngToLayerPoint(u[ne]),T.extend(he[ne]);y.push(he)}else for(ne=0;ne<W;ne++)this._projectLatlngs(u[ne],y,T)},_clipPoints:function(){var u=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(u))){if(this.options.noClip){this._parts=this._rings;return}var y=this._parts,T,V,W,ne,he,xe,Ee;for(T=0,W=0,ne=this._rings.length;T<ne;T++)for(Ee=this._rings[T],V=0,he=Ee.length;V<he-1;V++)xe=ta(Ee[V],Ee[V+1],u,V,!0),xe&&(y[W]=y[W]||[],y[W].push(xe[0]),(xe[1]!==Ee[V+1]||V===he-2)&&(y[W].push(xe[1]),W++))}},_simplifyPoints:function(){for(var u=this._parts,y=this.options.smoothFactor,T=0,V=u.length;T<V;T++)u[T]=ea(u[T],y)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(u,y){var T,V,W,ne,he,xe,Ee=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(u))return!1;for(T=0,ne=this._parts.length;T<ne;T++)for(xe=this._parts[T],V=0,he=xe.length,W=he-1;V<he;W=V++)if(!(!y&&V===0)&&bc(u,xe[W],xe[V])<=Ee)return!0;return!1}});function S0(u,y){return new oi(u,y)}oi._flat=q;var Ys=oi.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return el(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(u){var y=oi.prototype._convertLatLngs.call(this,u),T=y.length;return T>=2&&y[0]instanceof le&&y[0].equals(y[T-1])&&y.pop(),y},_setLatLngs:function(u){oi.prototype._setLatLngs.call(this,u),w(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return w(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var u=this._renderer._bounds,y=this.options.weight,T=new ie(y,y);if(u=new z(u.min.subtract(T),u.max.add(T)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(u))){if(this.options.noClip){this._parts=this._rings;return}for(var V=0,W=this._rings.length,ne;V<W;V++)ne=Jo(this._rings[V],u,!0),ne.length&&this._parts.push(ne)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(u){var y=!1,T,V,W,ne,he,xe,Ee,Ce;if(!this._pxBounds||!this._pxBounds.contains(u))return!1;for(ne=0,Ee=this._parts.length;ne<Ee;ne++)for(T=this._parts[ne],he=0,Ce=T.length,xe=Ce-1;he<Ce;xe=he++)V=T[he],W=T[xe],V.y>u.y!=W.y>u.y&&u.x<(W.x-V.x)*(u.y-V.y)/(W.y-V.y)+V.x&&(y=!y);return y||oi.prototype._containsPoint.call(this,u,!0)}});function T0(u,y){return new Ys(u,y)}var gs=Vn.extend({initialize:function(u,y){x(this,y),this._layers={},u&&this.addData(u)},addData:function(u){var y=R(u)?u:u.features,T,V,W;if(y){for(T=0,V=y.length;T<V;T++)W=y[T],(W.geometries||W.geometry||W.features||W.coordinates)&&this.addData(W);return this}var ne=this.options;if(ne.filter&&!ne.filter(u))return this;var he=ol(u,ne);return he?(he.feature=Hu(u),he.defaultOptions=he.options,this.resetStyle(he),ne.onEachFeature&&ne.onEachFeature(u,he),this.addLayer(he)):this},resetStyle:function(u){return u===void 0?this.eachLayer(this.resetStyle,this):(u.options=i({},u.defaultOptions),this._setLayerStyle(u,this.options.style),this)},setStyle:function(u){return this.eachLayer(function(y){this._setLayerStyle(y,u)},this)},_setLayerStyle:function(u,y){u.setStyle&&(typeof y=="function"&&(y=y(u.feature)),u.setStyle(y))}});function ol(u,y){var T=u.type==="Feature"?u.geometry:u,V=T?T.coordinates:null,W=[],ne=y&&y.pointToLayer,he=y&&y.coordsToLatLng||zu,xe,Ee,Ce,We;if(!V&&!T)return null;switch(T.type){case"Point":return xe=he(V),Bu(ne,u,xe,y);case"MultiPoint":for(Ce=0,We=V.length;Ce<We;Ce++)xe=he(V[Ce]),W.push(Bu(ne,u,xe,y));return new Vn(W);case"LineString":case"MultiLineString":return Ee=Ec(V,T.type==="LineString"?0:1,he),new oi(Ee,y);case"Polygon":case"MultiPolygon":return Ee=Ec(V,T.type==="Polygon"?1:2,he),new Ys(Ee,y);case"GeometryCollection":for(Ce=0,We=T.geometries.length;Ce<We;Ce++){var ht=ol({geometry:T.geometries[Ce],type:"Feature",properties:u.properties},y);ht&&W.push(ht)}return new Vn(W);case"FeatureCollection":for(Ce=0,We=T.features.length;Ce<We;Ce++){var Rt=ol(T.features[Ce],y);Rt&&W.push(Rt)}return new Vn(W);default:throw new Error("Invalid GeoJSON object.")}}function Bu(u,y,T,V){return u?u(y,T):new Ks(T,V&&V.markersInheritOptions&&V)}function zu(u){return new le(u[1],u[0],u[2])}function Ec(u,y,T){for(var V=[],W=0,ne=u.length,he;W<ne;W++)he=y?Ec(u[W],y-1,T):(T||zu)(u[W]),V.push(he);return V}function Uu(u,y){return u=Q(u),u.alt!==void 0?[g(u.lng,y),g(u.lat,y),g(u.alt,y)]:[g(u.lng,y),g(u.lat,y)]}function qu(u,y,T,V){for(var W=[],ne=0,he=u.length;ne<he;ne++)W.push(y?qu(u[ne],w(u[ne])?0:y-1,T,V):Uu(u[ne],V));return!y&&T&&W.length>0&&W.push(W[0].slice()),W}function al(u,y){return u.feature?i({},u.feature,{geometry:y}):Hu(y)}function Hu(u){return u.type==="Feature"||u.type==="FeatureCollection"?u:{type:"Feature",properties:{},geometry:u}}var vh={toGeoJSON:function(u){return al(this,{type:"Point",coordinates:Uu(this.getLatLng(),u)})}};Ks.include(vh),Vu.include(vh),Fu.include(vh),oi.include({toGeoJSON:function(u){var y=!w(this._latlngs),T=qu(this._latlngs,y?1:0,!1,u);return al(this,{type:(y?"Multi":"")+"LineString",coordinates:T})}}),Ys.include({toGeoJSON:function(u){var y=!w(this._latlngs),T=y&&!w(this._latlngs[0]),V=qu(this._latlngs,T?2:y?1:0,!0,u);return y||(V=[V]),al(this,{type:(T?"Multi":"")+"Polygon",coordinates:V})}}),En.include({toMultiPoint:function(u){var y=[];return this.eachLayer(function(T){y.push(T.toGeoJSON(u).geometry.coordinates)}),al(this,{type:"MultiPoint",coordinates:y})},toGeoJSON:function(u){var y=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(y==="MultiPoint")return this.toMultiPoint(u);var T=y==="GeometryCollection",V=[];return this.eachLayer(function(W){if(W.toGeoJSON){var ne=W.toGeoJSON(u);if(T)V.push(ne.geometry);else{var he=Hu(ne);he.type==="FeatureCollection"?V.push.apply(V,he.features):V.push(he)}}}),T?al(this,{geometries:V,type:"GeometryCollection"}):{type:"FeatureCollection",features:V}}});function zm(u,y){return new gs(u,y)}var Qi=zm,_o=sn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(u,y,T){this._url=u,this._bounds=ae(y),x(this,T)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(wt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){un(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(u){return this.options.opacity=u,this._image&&this._updateOpacity(),this},setStyle:function(u){return u.opacity&&this.setOpacity(u.opacity),this},bringToFront:function(){return this._map&&Us(this._image),this},bringToBack:function(){return this._map&&Gi(this._image),this},setUrl:function(u){return this._url=u,this._image&&(this._image.src=u),this},setBounds:function(u){return this._bounds=ae(u),this._map&&this._reset(),this},getEvents:function(){var u={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},setZIndex:function(u){return this.options.zIndex=u,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var u=this._url.tagName==="IMG",y=this._image=u?this._url:At("img");if(wt(y,"leaflet-image-layer"),this._zoomAnimated&&wt(y,"leaflet-zoom-animated"),this.options.className&&wt(y,this.options.className),y.onselectstart=p,y.onmousemove=p,y.onload=o(this.fire,this,"load"),y.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(y.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),u){this._url=y.src;return}y.src=this._url,y.alt=this.options.alt},_animateZoom:function(u){var y=this._map.getZoomScale(u.zoom),T=this._map._latLngBoundsToNewLayerBounds(this._bounds,u.zoom,u.center).min;zr(this._image,T,y)},_reset:function(){var u=this._image,y=new z(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),T=y.getSize();Nt(u,y.min),u.style.width=T.x+"px",u.style.height=T.y+"px"},_updateOpacity:function(){Tn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var u=this.options.errorOverlayUrl;u&&this._url!==u&&(this._url=u,this._image.src=u)},getCenter:function(){return this._bounds.getCenter()}}),Um=function(u,y,T){return new _o(u,y,T)},_h=_o.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var u=this._url.tagName==="VIDEO",y=this._image=u?this._url:At("video");if(wt(y,"leaflet-image-layer"),this._zoomAnimated&&wt(y,"leaflet-zoom-animated"),this.options.className&&wt(y,this.options.className),y.onselectstart=p,y.onmousemove=p,y.onloadeddata=o(this.fire,this,"load"),u){for(var T=y.getElementsByTagName("source"),V=[],W=0;W<T.length;W++)V.push(T[W].src);this._url=T.length>0?V:[y.src];return}R(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(y.style,"objectFit")&&(y.style.objectFit="fill"),y.autoplay=!!this.options.autoplay,y.loop=!!this.options.loop,y.muted=!!this.options.muted,y.playsInline=!!this.options.playsInline;for(var ne=0;ne<this._url.length;ne++){var he=At("source");he.src=this._url[ne],y.appendChild(he)}}});function qm(u,y,T){return new _h(u,y,T)}var xh=_o.extend({_initImage:function(){var u=this._image=this._url;wt(u,"leaflet-image-layer"),this._zoomAnimated&&wt(u,"leaflet-zoom-animated"),this.options.className&&wt(u,this.options.className),u.onselectstart=p,u.onmousemove=p}});function bh(u,y,T){return new xh(u,y,T)}var ys=sn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(u,y){u&&(u instanceof le||R(u))?(this._latlng=Q(u),x(this,y)):(x(this,u),this._source=y),this.options.content&&(this._content=this.options.content)},openOn:function(u){return u=arguments.length?u:this._source._map,u.hasLayer(this)||u.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(u){return this._map?this.close():(arguments.length?this._source=u:u=this._source,this._prepareOpen(),this.openOn(u._map)),this},onAdd:function(u){this._zoomAnimated=u._zoomAnimated,this._container||this._initLayout(),u._fadeAnimated&&Tn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),u._fadeAnimated&&Tn(this._container,1),this.bringToFront(),this.options.interactive&&(wt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(u){u._fadeAnimated?(Tn(this._container,0),this._removeTimeout=setTimeout(o(un,void 0,this._container),200)):un(this._container),this.options.interactive&&(dn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(u){return this._latlng=Q(u),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(u){return this._content=u,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var u={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Us(this._container),this},bringToBack:function(){return this._map&&Gi(this._container),this},_prepareOpen:function(u){var y=this._source;if(!y._map)return!1;if(y instanceof Vn){y=null;var T=this._source._layers;for(var V in T)if(T[V]._map){y=T[V];break}if(!y)return!1;this._source=y}if(!u)if(y.getCenter)u=y.getCenter();else if(y.getLatLng)u=y.getLatLng();else if(y.getBounds)u=y.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(u),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var u=this._contentNode,y=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof y=="string")u.innerHTML=y;else{for(;u.hasChildNodes();)u.removeChild(u.firstChild);u.appendChild(y)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var u=this._map.latLngToLayerPoint(this._latlng),y=G(this.options.offset),T=this._getAnchor();this._zoomAnimated?Nt(this._container,u.add(T)):y=y.add(u).add(T);var V=this._containerBottom=-y.y,W=this._containerLeft=-Math.round(this._containerWidth/2)+y.x;this._container.style.bottom=V+"px",this._container.style.left=W+"px"}},_getAnchor:function(){return[0,0]}});Dt.include({_initOverlay:function(u,y,T,V){var W=y;return W instanceof u||(W=new u(V).setContent(y)),T&&W.setLatLng(T),W}}),sn.include({_initOverlay:function(u,y,T,V){var W=T;return W instanceof u?(x(W,V),W._source=this):(W=y&&!V?y:new u(V,this),W.setContent(T)),W}});var $u=ys.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(u){return u=arguments.length?u:this._source._map,!u.hasLayer(this)&&u._popup&&u._popup.options.autoClose&&u.removeLayer(u._popup),u._popup=this,ys.prototype.openOn.call(this,u)},onAdd:function(u){ys.prototype.onAdd.call(this,u),u.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof vo||this._source.on("preclick",Rr))},onRemove:function(u){ys.prototype.onRemove.call(this,u),u.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof vo||this._source.off("preclick",Rr))},getEvents:function(){var u=ys.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(u.preclick=this.close),this.options.keepInView&&(u.moveend=this._adjustPan),u},_initLayout:function(){var u="leaflet-popup",y=this._container=At("div",u+" "+(this.options.className||"")+" leaflet-zoom-animated"),T=this._wrapper=At("div",u+"-content-wrapper",y);if(this._contentNode=At("div",u+"-content",T),yo(y),qs(this._contentNode),dt(y,"contextmenu",Rr),this._tipContainer=At("div",u+"-tip-container",y),this._tip=At("div",u+"-tip",this._tipContainer),this.options.closeButton){var V=this._closeButton=At("a",u+"-close-button",y);V.setAttribute("role","button"),V.setAttribute("aria-label","Close popup"),V.href="#close",V.innerHTML='<span aria-hidden="true">&#215;</span>',dt(V,"click",function(W){hn(W),this.close()},this)}},_updateLayout:function(){var u=this._contentNode,y=u.style;y.width="",y.whiteSpace="nowrap";var T=u.offsetWidth;T=Math.min(T,this.options.maxWidth),T=Math.max(T,this.options.minWidth),y.width=T+1+"px",y.whiteSpace="",y.height="";var V=u.offsetHeight,W=this.options.maxHeight,ne="leaflet-popup-scrolled";W&&V>W?(y.height=W+"px",wt(u,ne)):dn(u,ne),this._containerWidth=this._container.offsetWidth},_animateZoom:function(u){var y=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center),T=this._getAnchor();Nt(this._container,y.add(T))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var u=this._map,y=parseInt(mo(this._container,"marginBottom"),10)||0,T=this._container.offsetHeight+y,V=this._containerWidth,W=new ie(this._containerLeft,-T-this._containerBottom);W._add(Ur(this._container));var ne=u.layerPointToContainerPoint(W),he=G(this.options.autoPanPadding),xe=G(this.options.autoPanPaddingTopLeft||he),Ee=G(this.options.autoPanPaddingBottomRight||he),Ce=u.getSize(),We=0,ht=0;ne.x+V+Ee.x>Ce.x&&(We=ne.x+V-Ce.x+Ee.x),ne.x-We-xe.x<0&&(We=ne.x-xe.x),ne.y+T+Ee.y>Ce.y&&(ht=ne.y+T-Ce.y+Ee.y),ne.y-ht-xe.y<0&&(ht=ne.y-xe.y),(We||ht)&&(this.options.keepInView&&(this._autopanning=!0),u.fire("autopanstart").panBy([We,ht]))}},_getAnchor:function(){return G(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),ll=function(u,y){return new $u(u,y)};Dt.mergeOptions({closePopupOnClick:!0}),Dt.include({openPopup:function(u,y,T){return this._initOverlay($u,u,y,T).openOn(this),this},closePopup:function(u){return u=arguments.length?u:this._popup,u&&u.close(),this}}),sn.include({bindPopup:function(u,y){return this._popup=this._initOverlay($u,this._popup,u,y),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(u){return this._popup&&(this instanceof Vn||(this._popup._source=this),this._popup._prepareOpen(u||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(u){return this._popup&&this._popup.setContent(u),this},getPopup:function(){return this._popup},_openPopup:function(u){if(!(!this._popup||!this._map)){cr(u);var y=u.layer||u.target;if(this._popup._source===y&&!(y instanceof vo)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(u.latlng);return}this._popup._source=y,this.openPopup(u.latlng)}},_movePopup:function(u){this._popup.setLatLng(u.latlng)},_onKeyPress:function(u){u.originalEvent.keyCode===13&&this._openPopup(u)}});var cl=ys.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(u){ys.prototype.onAdd.call(this,u),this.setOpacity(this.options.opacity),u.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(u){ys.prototype.onRemove.call(this,u),u.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var u=ys.prototype.getEvents.call(this);return this.options.permanent||(u.preclick=this.close),u},_initLayout:function(){var u="leaflet-tooltip",y=u+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=At("div",y),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(u){var y,T,V=this._map,W=this._container,ne=V.latLngToContainerPoint(V.getCenter()),he=V.layerPointToContainerPoint(u),xe=this.options.direction,Ee=W.offsetWidth,Ce=W.offsetHeight,We=G(this.options.offset),ht=this._getAnchor();xe==="top"?(y=Ee/2,T=Ce):xe==="bottom"?(y=Ee/2,T=0):xe==="center"?(y=Ee/2,T=Ce/2):xe==="right"?(y=0,T=Ce/2):xe==="left"?(y=Ee,T=Ce/2):he.x<ne.x?(xe="right",y=0,T=Ce/2):(xe="left",y=Ee+(We.x+ht.x)*2,T=Ce/2),u=u.subtract(G(y,T,!0)).add(We).add(ht),dn(W,"leaflet-tooltip-right"),dn(W,"leaflet-tooltip-left"),dn(W,"leaflet-tooltip-top"),dn(W,"leaflet-tooltip-bottom"),wt(W,"leaflet-tooltip-"+xe),Nt(W,u)},_updatePosition:function(){var u=this._map.latLngToLayerPoint(this._latlng);this._setPosition(u)},setOpacity:function(u){this.options.opacity=u,this._container&&Tn(this._container,u)},_animateZoom:function(u){var y=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center);this._setPosition(y)},_getAnchor:function(){return G(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Sc=function(u,y){return new cl(u,y)};Dt.include({openTooltip:function(u,y,T){return this._initOverlay(cl,u,y,T).openOn(this),this},closeTooltip:function(u){return u.close(),this}}),sn.include({bindTooltip:function(u,y){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(cl,this._tooltip,u,y),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(u){if(!(!u&&this._tooltipHandlersAdded)){var y=u?"off":"on",T={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?T.add=this._openTooltip:(T.mouseover=this._openTooltip,T.mouseout=this.closeTooltip,T.click=this._openTooltip,this._map?this._addFocusListeners():T.add=this._addFocusListeners),this._tooltip.options.sticky&&(T.mousemove=this._moveTooltip),this[y](T),this._tooltipHandlersAdded=!u}},openTooltip:function(u){return this._tooltip&&(this instanceof Vn||(this._tooltip._source=this),this._tooltip._prepareOpen(u)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(u){return this._tooltip&&this._tooltip.setContent(u),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(u){var y=typeof u.getElement=="function"&&u.getElement();y&&(dt(y,"focus",function(){this._tooltip._source=u,this.openTooltip()},this),dt(y,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(u){var y=typeof u.getElement=="function"&&u.getElement();y&&y.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(u){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var y=this;this._map.once("moveend",function(){y._openOnceFlag=!1,y._openTooltip(u)});return}this._tooltip._source=u.layer||u.target,this.openTooltip(this._tooltip.options.sticky?u.latlng:void 0)}},_moveTooltip:function(u){var y=u.latlng,T,V;this._tooltip.options.sticky&&u.originalEvent&&(T=this._map.mouseEventToContainerPoint(u.originalEvent),V=this._map.containerPointToLayerPoint(T),y=this._map.layerPointToLatLng(V)),this._tooltip.setLatLng(y)}});var Wu=Zi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(u){var y=u&&u.tagName==="DIV"?u:document.createElement("div"),T=this.options;if(T.html instanceof Element?(Wo(y),y.appendChild(T.html)):y.innerHTML=T.html!==!1?T.html:"",T.bgPos){var V=G(T.bgPos);y.style.backgroundPosition=-V.x+"px "+-V.y+"px"}return this._setIconStyles(y,"icon"),y},createShadow:function(){return null}});function Hm(u){return new Wu(u)}Zi.Default=sl;var xo=sn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:Ke.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(u){x(this,u)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(u){u._addZoomLimit(this)},onRemove:function(u){this._removeAllTiles(),un(this._container),u._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Us(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Gi(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(u){return this.options.opacity=u,this._updateOpacity(),this},setZIndex:function(u){return this.options.zIndex=u,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var u=this._clampZoom(this._map.getZoom());u!==this._tileZoom&&(this._tileZoom=u,this._updateLevels()),this._update()}return this},getEvents:function(){var u={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),u.move=this._onMove),this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},createTile:function(){return document.createElement("div")},getTileSize:function(){var u=this.options.tileSize;return u instanceof ie?u:new ie(u,u)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(u){for(var y=this.getPane().children,T=-u(-1/0,1/0),V=0,W=y.length,ne;V<W;V++)ne=y[V].style.zIndex,y[V]!==this._container&&ne&&(T=u(T,+ne));isFinite(T)&&(this.options.zIndex=T+u(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!Ke.ielt9){Tn(this._container,this.options.opacity);var u=+new Date,y=!1,T=!1;for(var V in this._tiles){var W=this._tiles[V];if(!(!W.current||!W.loaded)){var ne=Math.min(1,(u-W.loaded)/200);Tn(W.el,ne),ne<1?y=!0:(W.active?T=!0:this._onOpaqueTile(W),W.active=!0)}}T&&!this._noPrune&&this._pruneTiles(),y&&(M(this._fadeFrame),this._fadeFrame=C(this._updateOpacity,this))}},_onOpaqueTile:p,_initContainer:function(){this._container||(this._container=At("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var u=this._tileZoom,y=this.options.maxZoom;if(u!==void 0){for(var T in this._levels)T=Number(T),this._levels[T].el.children.length||T===u?(this._levels[T].el.style.zIndex=y-Math.abs(u-T),this._onUpdateLevel(T)):(un(this._levels[T].el),this._removeTilesAtZoom(T),this._onRemoveLevel(T),delete this._levels[T]);var V=this._levels[u],W=this._map;return V||(V=this._levels[u]={},V.el=At("div","leaflet-tile-container leaflet-zoom-animated",this._container),V.el.style.zIndex=y,V.origin=W.project(W.unproject(W.getPixelOrigin()),u).round(),V.zoom=u,this._setZoomTransform(V,W.getCenter(),W.getZoom()),p(V.el.offsetWidth),this._onCreateLevel(V)),this._level=V,V}},_onUpdateLevel:p,_onRemoveLevel:p,_onCreateLevel:p,_pruneTiles:function(){if(this._map){var u,y,T=this._map.getZoom();if(T>this.options.maxZoom||T<this.options.minZoom){this._removeAllTiles();return}for(u in this._tiles)y=this._tiles[u],y.retain=y.current;for(u in this._tiles)if(y=this._tiles[u],y.current&&!y.active){var V=y.coords;this._retainParent(V.x,V.y,V.z,V.z-5)||this._retainChildren(V.x,V.y,V.z,V.z+2)}for(u in this._tiles)this._tiles[u].retain||this._removeTile(u)}},_removeTilesAtZoom:function(u){for(var y in this._tiles)this._tiles[y].coords.z===u&&this._removeTile(y)},_removeAllTiles:function(){for(var u in this._tiles)this._removeTile(u)},_invalidateAll:function(){for(var u in this._levels)un(this._levels[u].el),this._onRemoveLevel(Number(u)),delete this._levels[u];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(u,y,T,V){var W=Math.floor(u/2),ne=Math.floor(y/2),he=T-1,xe=new ie(+W,+ne);xe.z=+he;var Ee=this._tileCoordsToKey(xe),Ce=this._tiles[Ee];return Ce&&Ce.active?(Ce.retain=!0,!0):(Ce&&Ce.loaded&&(Ce.retain=!0),he>V?this._retainParent(W,ne,he,V):!1)},_retainChildren:function(u,y,T,V){for(var W=2*u;W<2*u+2;W++)for(var ne=2*y;ne<2*y+2;ne++){var he=new ie(W,ne);he.z=T+1;var xe=this._tileCoordsToKey(he),Ee=this._tiles[xe];if(Ee&&Ee.active){Ee.retain=!0;continue}else Ee&&Ee.loaded&&(Ee.retain=!0);T+1<V&&this._retainChildren(W,ne,T+1,V)}},_resetView:function(u){var y=u&&(u.pinch||u.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),y,y)},_animateZoom:function(u){this._setView(u.center,u.zoom,!0,u.noUpdate)},_clampZoom:function(u){var y=this.options;return y.minNativeZoom!==void 0&&u<y.minNativeZoom?y.minNativeZoom:y.maxNativeZoom!==void 0&&y.maxNativeZoom<u?y.maxNativeZoom:u},_setView:function(u,y,T,V){var W=Math.round(y);this.options.maxZoom!==void 0&&W>this.options.maxZoom||this.options.minZoom!==void 0&&W<this.options.minZoom?W=void 0:W=this._clampZoom(W);var ne=this.options.updateWhenZooming&&W!==this._tileZoom;(!V||ne)&&(this._tileZoom=W,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),W!==void 0&&this._update(u),T||this._pruneTiles(),this._noPrune=!!T),this._setZoomTransforms(u,y)},_setZoomTransforms:function(u,y){for(var T in this._levels)this._setZoomTransform(this._levels[T],u,y)},_setZoomTransform:function(u,y,T){var V=this._map.getZoomScale(T,u.zoom),W=u.origin.multiplyBy(V).subtract(this._map._getNewPixelOrigin(y,T)).round();Ke.any3d?zr(u.el,W,V):Nt(u.el,W)},_resetGrid:function(){var u=this._map,y=u.options.crs,T=this._tileSize=this.getTileSize(),V=this._tileZoom,W=this._map.getPixelWorldBounds(this._tileZoom);W&&(this._globalTileRange=this._pxBoundsToTileRange(W)),this._wrapX=y.wrapLng&&!this.options.noWrap&&[Math.floor(u.project([0,y.wrapLng[0]],V).x/T.x),Math.ceil(u.project([0,y.wrapLng[1]],V).x/T.y)],this._wrapY=y.wrapLat&&!this.options.noWrap&&[Math.floor(u.project([y.wrapLat[0],0],V).y/T.x),Math.ceil(u.project([y.wrapLat[1],0],V).y/T.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(u){var y=this._map,T=y._animatingZoom?Math.max(y._animateToZoom,y.getZoom()):y.getZoom(),V=y.getZoomScale(T,this._tileZoom),W=y.project(u,this._tileZoom).floor(),ne=y.getSize().divideBy(V*2);return new z(W.subtract(ne),W.add(ne))},_update:function(u){var y=this._map;if(y){var T=this._clampZoom(y.getZoom());if(u===void 0&&(u=y.getCenter()),this._tileZoom!==void 0){var V=this._getTiledPixelBounds(u),W=this._pxBoundsToTileRange(V),ne=W.getCenter(),he=[],xe=this.options.keepBuffer,Ee=new z(W.getBottomLeft().subtract([xe,-xe]),W.getTopRight().add([xe,-xe]));if(!(isFinite(W.min.x)&&isFinite(W.min.y)&&isFinite(W.max.x)&&isFinite(W.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ce in this._tiles){var We=this._tiles[Ce].coords;(We.z!==this._tileZoom||!Ee.contains(new ie(We.x,We.y)))&&(this._tiles[Ce].current=!1)}if(Math.abs(T-this._tileZoom)>1){this._setView(u,T);return}for(var ht=W.min.y;ht<=W.max.y;ht++)for(var Rt=W.min.x;Rt<=W.max.x;Rt++){var ur=new ie(Rt,ht);if(ur.z=this._tileZoom,!!this._isValidTile(ur)){var sr=this._tiles[this._tileCoordsToKey(ur)];sr?sr.current=!0:he.push(ur)}}if(he.sort(function($r,ml){return $r.distanceTo(ne)-ml.distanceTo(ne)}),he.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var ai=document.createDocumentFragment();for(Rt=0;Rt<he.length;Rt++)this._addTile(he[Rt],ai);this._level.el.appendChild(ai)}}}},_isValidTile:function(u){var y=this._map.options.crs;if(!y.infinite){var T=this._globalTileRange;if(!y.wrapLng&&(u.x<T.min.x||u.x>T.max.x)||!y.wrapLat&&(u.y<T.min.y||u.y>T.max.y))return!1}if(!this.options.bounds)return!0;var V=this._tileCoordsToBounds(u);return ae(this.options.bounds).overlaps(V)},_keyToBounds:function(u){return this._tileCoordsToBounds(this._keyToTileCoords(u))},_tileCoordsToNwSe:function(u){var y=this._map,T=this.getTileSize(),V=u.scaleBy(T),W=V.add(T),ne=y.unproject(V,u.z),he=y.unproject(W,u.z);return[ne,he]},_tileCoordsToBounds:function(u){var y=this._tileCoordsToNwSe(u),T=new J(y[0],y[1]);return this.options.noWrap||(T=this._map.wrapLatLngBounds(T)),T},_tileCoordsToKey:function(u){return u.x+":"+u.y+":"+u.z},_keyToTileCoords:function(u){var y=u.split(":"),T=new ie(+y[0],+y[1]);return T.z=+y[2],T},_removeTile:function(u){var y=this._tiles[u];y&&(un(y.el),delete this._tiles[u],this.fire("tileunload",{tile:y.el,coords:this._keyToTileCoords(u)}))},_initTile:function(u){wt(u,"leaflet-tile");var y=this.getTileSize();u.style.width=y.x+"px",u.style.height=y.y+"px",u.onselectstart=p,u.onmousemove=p,Ke.ielt9&&this.options.opacity<1&&Tn(u,this.options.opacity)},_addTile:function(u,y){var T=this._getTilePos(u),V=this._tileCoordsToKey(u),W=this.createTile(this._wrapCoords(u),o(this._tileReady,this,u));this._initTile(W),this.createTile.length<2&&C(o(this._tileReady,this,u,null,W)),Nt(W,T),this._tiles[V]={el:W,coords:u,current:!0},y.appendChild(W),this.fire("tileloadstart",{tile:W,coords:u})},_tileReady:function(u,y,T){y&&this.fire("tileerror",{error:y,tile:T,coords:u});var V=this._tileCoordsToKey(u);T=this._tiles[V],T&&(T.loaded=+new Date,this._map._fadeAnimated?(Tn(T.el,0),M(this._fadeFrame),this._fadeFrame=C(this._updateOpacity,this)):(T.active=!0,this._pruneTiles()),y||(wt(T.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:T.el,coords:u})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),Ke.ielt9||!this._map._fadeAnimated?C(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(u){return u.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(u){var y=new ie(this._wrapX?m(u.x,this._wrapX):u.x,this._wrapY?m(u.y,this._wrapY):u.y);return y.z=u.z,y},_pxBoundsToTileRange:function(u){var y=this.getTileSize();return new z(u.min.unscaleBy(y).floor(),u.max.unscaleBy(y).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var u in this._tiles)if(!this._tiles[u].loaded)return!1;return!0}});function ul(u){return new xo(u)}var bo=xo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(u,y){this._url=u,y=x(this,y),y.detectRetina&&Ke.retina&&y.maxZoom>0?(y.tileSize=Math.floor(y.tileSize/2),y.zoomReverse?(y.zoomOffset--,y.minZoom=Math.min(y.maxZoom,y.minZoom+1)):(y.zoomOffset++,y.maxZoom=Math.max(y.minZoom,y.maxZoom-1)),y.minZoom=Math.max(0,y.minZoom)):y.zoomReverse?y.minZoom=Math.min(y.maxZoom,y.minZoom):y.maxZoom=Math.max(y.minZoom,y.maxZoom),typeof y.subdomains=="string"&&(y.subdomains=y.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(u,y){return this._url===u&&y===void 0&&(y=!0),this._url=u,y||this.redraw(),this},createTile:function(u,y){var T=document.createElement("img");return dt(T,"load",o(this._tileOnLoad,this,y,T)),dt(T,"error",o(this._tileOnError,this,y,T)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(T.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(T.referrerPolicy=this.options.referrerPolicy),T.alt="",T.src=this.getTileUrl(u),T},getTileUrl:function(u){var y={r:Ke.retina?"@2x":"",s:this._getSubdomain(u),x:u.x,y:u.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var T=this._globalTileRange.max.y-u.y;this.options.tms&&(y.y=T),y["-y"]=T}return N(this._url,i(y,this.options))},_tileOnLoad:function(u,y){Ke.ielt9?setTimeout(o(u,this,null,y),0):u(null,y)},_tileOnError:function(u,y,T){var V=this.options.errorTileUrl;V&&y.getAttribute("src")!==V&&(y.src=V),u(T,y)},_onTileRemove:function(u){u.tile.onload=null},_getZoomForUrl:function(){var u=this._tileZoom,y=this.options.maxZoom,T=this.options.zoomReverse,V=this.options.zoomOffset;return T&&(u=y-u),u+V},_getSubdomain:function(u){var y=Math.abs(u.x+u.y)%this.options.subdomains.length;return this.options.subdomains[y]},_abortLoading:function(){var u,y;for(u in this._tiles)if(this._tiles[u].coords.z!==this._tileZoom&&(y=this._tiles[u].el,y.onload=p,y.onerror=p,!y.complete)){y.src=j;var T=this._tiles[u].coords;un(y),delete this._tiles[u],this.fire("tileabort",{tile:y,coords:T})}},_removeTile:function(u){var y=this._tiles[u];if(y)return y.el.setAttribute("src",j),xo.prototype._removeTile.call(this,u)},_tileReady:function(u,y,T){if(!(!this._map||T&&T.getAttribute("src")===j))return xo.prototype._tileReady.call(this,u,y,T)}});function wh(u,y){return new bo(u,y)}var Tc=bo.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(u,y){this._url=u;var T=i({},this.defaultWmsParams);for(var V in y)V in this.options||(T[V]=y[V]);y=x(this,y);var W=y.detectRetina&&Ke.retina?2:1,ne=this.getTileSize();T.width=ne.x*W,T.height=ne.y*W,this.wmsParams=T},onAdd:function(u){this._crs=this.options.crs||u.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var y=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[y]=this._crs.code,bo.prototype.onAdd.call(this,u)},getTileUrl:function(u){var y=this._tileCoordsToNwSe(u),T=this._crs,V=Z(T.project(y[0]),T.project(y[1])),W=V.min,ne=V.max,he=(this._wmsVersion>=1.3&&this._crs===Hn?[W.y,W.x,ne.y,ne.x]:[W.x,W.y,ne.x,ne.y]).join(","),xe=bo.prototype.getTileUrl.call(this,u);return xe+b(this.wmsParams,xe,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+he},setParams:function(u,y){return i(this.wmsParams,u),y||this.redraw(),this}});function $m(u,y){return new Tc(u,y)}bo.WMS=Tc,wh.wms=$m;var vs=sn.extend({options:{padding:.1},initialize:function(u){x(this,u),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),wt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var u={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(u.zoomanim=this._onAnimZoom),u},_onAnimZoom:function(u){this._updateTransform(u.center,u.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(u,y){var T=this._map.getZoomScale(y,this._zoom),V=this._map.getSize().multiplyBy(.5+this.options.padding),W=this._map.project(this._center,y),ne=V.multiplyBy(-T).add(W).subtract(this._map._getNewPixelOrigin(u,y));Ke.any3d?zr(this._container,ne,T):Nt(this._container,ne)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var u in this._layers)this._layers[u]._reset()},_onZoomEnd:function(){for(var u in this._layers)this._layers[u]._project()},_updatePaths:function(){for(var u in this._layers)this._layers[u]._update()},_update:function(){var u=this.options.padding,y=this._map.getSize(),T=this._map.containerPointToLayerPoint(y.multiplyBy(-u)).round();this._bounds=new z(T,T.add(y.multiplyBy(1+u*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Eh=vs.extend({options:{tolerance:0},getEvents:function(){var u=vs.prototype.getEvents.call(this);return u.viewprereset=this._onViewPreReset,u},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){vs.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var u=this._container=document.createElement("canvas");dt(u,"mousemove",this._onMouseMove,this),dt(u,"click dblclick mousedown mouseup contextmenu",this._onClick,this),dt(u,"mouseout",this._handleMouseOut,this),u._leaflet_disable_events=!0,this._ctx=u.getContext("2d")},_destroyContainer:function(){M(this._redrawRequest),delete this._ctx,un(this._container),rn(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var u;this._redrawBounds=null;for(var y in this._layers)u=this._layers[y],u._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){vs.prototype._update.call(this);var u=this._bounds,y=this._container,T=u.getSize(),V=Ke.retina?2:1;Nt(y,u.min),y.width=V*T.x,y.height=V*T.y,y.style.width=T.x+"px",y.style.height=T.y+"px",Ke.retina&&this._ctx.scale(2,2),this._ctx.translate(-u.min.x,-u.min.y),this.fire("update")}},_reset:function(){vs.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(u){this._updateDashArray(u),this._layers[d(u)]=u;var y=u._order={layer:u,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=y),this._drawLast=y,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(u){this._requestRedraw(u)},_removePath:function(u){var y=u._order,T=y.next,V=y.prev;T?T.prev=V:this._drawLast=V,V?V.next=T:this._drawFirst=T,delete u._order,delete this._layers[d(u)],this._requestRedraw(u)},_updatePath:function(u){this._extendRedrawBounds(u),u._project(),u._update(),this._requestRedraw(u)},_updateStyle:function(u){this._updateDashArray(u),this._requestRedraw(u)},_updateDashArray:function(u){if(typeof u.options.dashArray=="string"){var y=u.options.dashArray.split(/[, ]+/),T=[],V,W;for(W=0;W<y.length;W++){if(V=Number(y[W]),isNaN(V))return;T.push(V)}u.options._dashArray=T}else u.options._dashArray=u.options.dashArray},_requestRedraw:function(u){this._map&&(this._extendRedrawBounds(u),this._redrawRequest=this._redrawRequest||C(this._redraw,this))},_extendRedrawBounds:function(u){if(u._pxBounds){var y=(u.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new z,this._redrawBounds.extend(u._pxBounds.min.subtract([y,y])),this._redrawBounds.extend(u._pxBounds.max.add([y,y]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var u=this._redrawBounds;if(u){var y=u.getSize();this._ctx.clearRect(u.min.x,u.min.y,y.x,y.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var u,y=this._redrawBounds;if(this._ctx.save(),y){var T=y.getSize();this._ctx.beginPath(),this._ctx.rect(y.min.x,y.min.y,T.x,T.y),this._ctx.clip()}this._drawing=!0;for(var V=this._drawFirst;V;V=V.next)u=V.layer,(!y||u._pxBounds&&u._pxBounds.intersects(y))&&u._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(u,y){if(this._drawing){var T,V,W,ne,he=u._parts,xe=he.length,Ee=this._ctx;if(xe){for(Ee.beginPath(),T=0;T<xe;T++){for(V=0,W=he[T].length;V<W;V++)ne=he[T][V],Ee[V?"lineTo":"moveTo"](ne.x,ne.y);y&&Ee.closePath()}this._fillStroke(Ee,u)}}},_updateCircle:function(u){if(!(!this._drawing||u._empty())){var y=u._point,T=this._ctx,V=Math.max(Math.round(u._radius),1),W=(Math.max(Math.round(u._radiusY),1)||V)/V;W!==1&&(T.save(),T.scale(1,W)),T.beginPath(),T.arc(y.x,y.y/W,V,0,Math.PI*2,!1),W!==1&&T.restore(),this._fillStroke(T,u)}},_fillStroke:function(u,y){var T=y.options;T.fill&&(u.globalAlpha=T.fillOpacity,u.fillStyle=T.fillColor||T.color,u.fill(T.fillRule||"evenodd")),T.stroke&&T.weight!==0&&(u.setLineDash&&u.setLineDash(y.options&&y.options._dashArray||[]),u.globalAlpha=T.opacity,u.lineWidth=T.weight,u.strokeStyle=T.color,u.lineCap=T.lineCap,u.lineJoin=T.lineJoin,u.stroke())},_onClick:function(u){for(var y=this._map.mouseEventToLayerPoint(u),T,V,W=this._drawFirst;W;W=W.next)T=W.layer,T.options.interactive&&T._containsPoint(y)&&(!(u.type==="click"||u.type==="preclick")||!this._map._draggableMoved(T))&&(V=T);this._fireEvent(V?[V]:!1,u)},_onMouseMove:function(u){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var y=this._map.mouseEventToLayerPoint(u);this._handleMouseHover(u,y)}},_handleMouseOut:function(u){var y=this._hoveredLayer;y&&(dn(this._container,"leaflet-interactive"),this._fireEvent([y],u,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(u,y){if(!this._mouseHoverThrottled){for(var T,V,W=this._drawFirst;W;W=W.next)T=W.layer,T.options.interactive&&T._containsPoint(y)&&(V=T);V!==this._hoveredLayer&&(this._handleMouseOut(u),V&&(wt(this._container,"leaflet-interactive"),this._fireEvent([V],u,"mouseover"),this._hoveredLayer=V)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,u),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(u,y,T){this._map._fireDOMEvent(y,T||y.type,u)},_bringToFront:function(u){var y=u._order;if(y){var T=y.next,V=y.prev;if(T)T.prev=V;else return;V?V.next=T:T&&(this._drawFirst=T),y.prev=this._drawLast,this._drawLast.next=y,y.next=null,this._drawLast=y,this._requestRedraw(u)}},_bringToBack:function(u){var y=u._order;if(y){var T=y.next,V=y.prev;if(V)V.next=T;else return;T?T.prev=V:V&&(this._drawLast=V),y.prev=null,y.next=this._drawFirst,this._drawFirst.prev=y,this._drawFirst=y,this._requestRedraw(u)}}});function Sh(u){return Ke.canvas?new Eh(u):null}var dl=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(u){return document.createElement("<lvml:"+u+' class="lvml">')}}catch{}return function(u){return document.createElement("<"+u+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Wm={_initContainer:function(){this._container=At("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(vs.prototype._update.call(this),this.fire("update"))},_initPath:function(u){var y=u._container=dl("shape");wt(y,"leaflet-vml-shape "+(this.options.className||"")),y.coordsize="1 1",u._path=dl("path"),y.appendChild(u._path),this._updateStyle(u),this._layers[d(u)]=u},_addPath:function(u){var y=u._container;this._container.appendChild(y),u.options.interactive&&u.addInteractiveTarget(y)},_removePath:function(u){var y=u._container;un(y),u.removeInteractiveTarget(y),delete this._layers[d(u)]},_updateStyle:function(u){var y=u._stroke,T=u._fill,V=u.options,W=u._container;W.stroked=!!V.stroke,W.filled=!!V.fill,V.stroke?(y||(y=u._stroke=dl("stroke")),W.appendChild(y),y.weight=V.weight+"px",y.color=V.color,y.opacity=V.opacity,V.dashArray?y.dashStyle=R(V.dashArray)?V.dashArray.join(" "):V.dashArray.replace(/( *, *)/g," "):y.dashStyle="",y.endcap=V.lineCap.replace("butt","flat"),y.joinstyle=V.lineJoin):y&&(W.removeChild(y),u._stroke=null),V.fill?(T||(T=u._fill=dl("fill")),W.appendChild(T),T.color=V.fillColor||V.color,T.opacity=V.fillOpacity):T&&(W.removeChild(T),u._fill=null)},_updateCircle:function(u){var y=u._point.round(),T=Math.round(u._radius),V=Math.round(u._radiusY||T);this._setPath(u,u._empty()?"M0 0":"AL "+y.x+","+y.y+" "+T+","+V+" 0,"+65535*360)},_setPath:function(u,y){u._path.v=y},_bringToFront:function(u){Us(u._container)},_bringToBack:function(u){Gi(u._container)}},Xi=Ke.vml?dl:lt,ra=vs.extend({_initContainer:function(){this._container=Xi("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Xi("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){un(this._container),rn(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){vs.prototype._update.call(this);var u=this._bounds,y=u.getSize(),T=this._container;(!this._svgSize||!this._svgSize.equals(y))&&(this._svgSize=y,T.setAttribute("width",y.x),T.setAttribute("height",y.y)),Nt(T,u.min),T.setAttribute("viewBox",[u.min.x,u.min.y,y.x,y.y].join(" ")),this.fire("update")}},_initPath:function(u){var y=u._path=Xi("path");u.options.className&&wt(y,u.options.className),u.options.interactive&&wt(y,"leaflet-interactive"),this._updateStyle(u),this._layers[d(u)]=u},_addPath:function(u){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(u._path),u.addInteractiveTarget(u._path)},_removePath:function(u){un(u._path),u.removeInteractiveTarget(u._path),delete this._layers[d(u)]},_updatePath:function(u){u._project(),u._update()},_updateStyle:function(u){var y=u._path,T=u.options;y&&(T.stroke?(y.setAttribute("stroke",T.color),y.setAttribute("stroke-opacity",T.opacity),y.setAttribute("stroke-width",T.weight),y.setAttribute("stroke-linecap",T.lineCap),y.setAttribute("stroke-linejoin",T.lineJoin),T.dashArray?y.setAttribute("stroke-dasharray",T.dashArray):y.removeAttribute("stroke-dasharray"),T.dashOffset?y.setAttribute("stroke-dashoffset",T.dashOffset):y.removeAttribute("stroke-dashoffset")):y.setAttribute("stroke","none"),T.fill?(y.setAttribute("fill",T.fillColor||T.color),y.setAttribute("fill-opacity",T.fillOpacity),y.setAttribute("fill-rule",T.fillRule||"evenodd")):y.setAttribute("fill","none"))},_updatePoly:function(u,y){this._setPath(u,Ct(u._parts,y))},_updateCircle:function(u){var y=u._point,T=Math.max(Math.round(u._radius),1),V=Math.max(Math.round(u._radiusY),1)||T,W="a"+T+","+V+" 0 1,0 ",ne=u._empty()?"M0 0":"M"+(y.x-T)+","+y.y+W+T*2+",0 "+W+-T*2+",0 ";this._setPath(u,ne)},_setPath:function(u,y){u._path.setAttribute("d",y)},_bringToFront:function(u){Us(u._path)},_bringToBack:function(u){Gi(u._path)}});Ke.vml&&ra.include(Wm);function Gu(u){return Ke.svg||Ke.vml?new ra(u):null}Dt.include({getRenderer:function(u){var y=u.options.renderer||this._getPaneRenderer(u.options.pane)||this.options.renderer||this._renderer;return y||(y=this._renderer=this._createRenderer()),this.hasLayer(y)||this.addLayer(y),y},_getPaneRenderer:function(u){if(u==="overlayPane"||u===void 0)return!1;var y=this._paneRenderers[u];return y===void 0&&(y=this._createRenderer({pane:u}),this._paneRenderers[u]=y),y},_createRenderer:function(u){return this.options.preferCanvas&&Sh(u)||Gu(u)}});var Gm=Ys.extend({initialize:function(u,y){Ys.prototype.initialize.call(this,this._boundsToLatLngs(u),y)},setBounds:function(u){return this.setLatLngs(this._boundsToLatLngs(u))},_boundsToLatLngs:function(u){return u=ae(u),[u.getSouthWest(),u.getNorthWest(),u.getNorthEast(),u.getSouthEast()]}});function A0(u,y){return new Gm(u,y)}ra.create=Xi,ra.pointsToPath=Ct,gs.geometryToLayer=ol,gs.coordsToLatLng=zu,gs.coordsToLatLngs=Ec,gs.latLngToCoords=Uu,gs.latLngsToCoords=qu,gs.getFeature=al,gs.asFeature=Hu,Dt.mergeOptions({boxZoom:!0});var hl=jr.extend({initialize:function(u){this._map=u,this._container=u._container,this._pane=u._panes.overlayPane,this._resetStateTimeout=0,u.on("unload",this._destroy,this)},addHooks:function(){dt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){rn(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){un(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(u){if(!u.shiftKey||u.which!==1&&u.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),jt(),Ka(),this._startPoint=this._map.mouseEventToContainerPoint(u),dt(document,{contextmenu:cr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(u){this._moved||(this._moved=!0,this._box=At("div","leaflet-zoom-box",this._container),wt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(u);var y=new z(this._point,this._startPoint),T=y.getSize();Nt(this._box,y.min),this._box.style.width=T.x+"px",this._box.style.height=T.y+"px"},_finish:function(){this._moved&&(un(this._box),dn(this._container,"leaflet-crosshair")),Si(),Ya(),rn(document,{contextmenu:cr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(u){if(!(u.which!==1&&u.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var y=new J(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(y).fire("boxzoomend",{boxZoomBounds:y})}},_onKeyDown:function(u){u.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Dt.addInitHook("addHandler","boxZoom",hl),Dt.mergeOptions({doubleClickZoom:!0});var Km=jr.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(u){var y=this._map,T=y.getZoom(),V=y.options.zoomDelta,W=u.originalEvent.shiftKey?T-V:T+V;y.options.doubleClickZoom==="center"?y.setZoom(W):y.setZoomAround(u.containerPoint,W)}});Dt.addInitHook("addHandler","doubleClickZoom",Km),Dt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var Th=jr.extend({addHooks:function(){if(!this._draggable){var u=this._map;this._draggable=new qr(u._mapPane,u._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),u.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),u.on("zoomend",this._onZoomEnd,this),u.whenReady(this._onZoomEnd,this))}wt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){dn(this._map._container,"leaflet-grab"),dn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var u=this._map;if(u._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var y=ae(this._map.options.maxBounds);this._offsetLimit=Z(this._map.latLngToContainerPoint(y.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(y.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;u.fire("movestart").fire("dragstart"),u.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(u){if(this._map.options.inertia){var y=this._lastTime=+new Date,T=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(T),this._times.push(y),this._prunePositions(y)}this._map.fire("move",u).fire("drag",u)},_prunePositions:function(u){for(;this._positions.length>1&&u-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var u=this._map.getSize().divideBy(2),y=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=y.subtract(u).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(u,y){return u-(u-y)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var u=this._draggable._newPos.subtract(this._draggable._startPos),y=this._offsetLimit;u.x<y.min.x&&(u.x=this._viscousLimit(u.x,y.min.x)),u.y<y.min.y&&(u.y=this._viscousLimit(u.y,y.min.y)),u.x>y.max.x&&(u.x=this._viscousLimit(u.x,y.max.x)),u.y>y.max.y&&(u.y=this._viscousLimit(u.y,y.max.y)),this._draggable._newPos=this._draggable._startPos.add(u)}},_onPreDragWrap:function(){var u=this._worldWidth,y=Math.round(u/2),T=this._initialWorldOffset,V=this._draggable._newPos.x,W=(V-y+T)%u+y-T,ne=(V+y+T)%u-y-T,he=Math.abs(W+T)<Math.abs(ne+T)?W:ne;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=he},_onDragEnd:function(u){var y=this._map,T=y.options,V=!T.inertia||u.noInertia||this._times.length<2;if(y.fire("dragend",u),V)y.fire("moveend");else{this._prunePositions(+new Date);var W=this._lastPos.subtract(this._positions[0]),ne=(this._lastTime-this._times[0])/1e3,he=T.easeLinearity,xe=W.multiplyBy(he/ne),Ee=xe.distanceTo([0,0]),Ce=Math.min(T.inertiaMaxSpeed,Ee),We=xe.multiplyBy(Ce/Ee),ht=Ce/(T.inertiaDeceleration*he),Rt=We.multiplyBy(-ht/2).round();!Rt.x&&!Rt.y?y.fire("moveend"):(Rt=y._limitOffset(Rt,y.options.maxBounds),C(function(){y.panBy(Rt,{duration:ht,easeLinearity:he,noMoveStart:!0,animate:!0})}))}}});Dt.addInitHook("addHandler","dragging",Th),Dt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var Ah=jr.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(u){this._map=u,this._setPanDelta(u.options.keyboardPanDelta),this._setZoomDelta(u.options.zoomDelta)},addHooks:function(){var u=this._map._container;u.tabIndex<=0&&(u.tabIndex="0"),dt(u,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),rn(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var u=document.body,y=document.documentElement,T=u.scrollTop||y.scrollTop,V=u.scrollLeft||y.scrollLeft;this._map._container.focus(),window.scrollTo(V,T)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(u){var y=this._panKeys={},T=this.keyCodes,V,W;for(V=0,W=T.left.length;V<W;V++)y[T.left[V]]=[-1*u,0];for(V=0,W=T.right.length;V<W;V++)y[T.right[V]]=[u,0];for(V=0,W=T.down.length;V<W;V++)y[T.down[V]]=[0,u];for(V=0,W=T.up.length;V<W;V++)y[T.up[V]]=[0,-1*u]},_setZoomDelta:function(u){var y=this._zoomKeys={},T=this.keyCodes,V,W;for(V=0,W=T.zoomIn.length;V<W;V++)y[T.zoomIn[V]]=u;for(V=0,W=T.zoomOut.length;V<W;V++)y[T.zoomOut[V]]=-u},_addHooks:function(){dt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){rn(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(u){if(!(u.altKey||u.ctrlKey||u.metaKey)){var y=u.keyCode,T=this._map,V;if(y in this._panKeys){if(!T._panAnim||!T._panAnim._inProgress)if(V=this._panKeys[y],u.shiftKey&&(V=G(V).multiplyBy(3)),T.options.maxBounds&&(V=T._limitOffset(G(V),T.options.maxBounds)),T.options.worldCopyJump){var W=T.wrapLatLng(T.unproject(T.project(T.getCenter()).add(V)));T.panTo(W)}else T.panBy(V)}else if(y in this._zoomKeys)T.setZoom(T.getZoom()+(u.shiftKey?3:1)*this._zoomKeys[y]);else if(y===27&&T._popup&&T._popup.options.closeOnEscapeKey)T.closePopup();else return;cr(u)}}});Dt.addInitHook("addHandler","keyboard",Ah),Dt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var xn=jr.extend({addHooks:function(){dt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){rn(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(u){var y=Ou(u),T=this._map.options.wheelDebounceTime;this._delta+=y,this._lastMousePos=this._map.mouseEventToContainerPoint(u),this._startTime||(this._startTime=+new Date);var V=Math.max(T-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),V),cr(u)},_performZoom:function(){var u=this._map,y=u.getZoom(),T=this._map.options.zoomSnap||0;u._stop();var V=this._delta/(this._map.options.wheelPxPerZoomLevel*4),W=4*Math.log(2/(1+Math.exp(-Math.abs(V))))/Math.LN2,ne=T?Math.ceil(W/T)*T:W,he=u._limitZoom(y+(this._delta>0?ne:-ne))-y;this._delta=0,this._startTime=null,he&&(u.options.scrollWheelZoom==="center"?u.setZoom(y+he):u.setZoomAround(this._lastMousePos,y+he))}});Dt.addInitHook("addHandler","scrollWheelZoom",xn);var Nh=600;Dt.mergeOptions({tapHold:Ke.touchNative&&Ke.safari&&Ke.mobile,tapTolerance:15});var Ac=jr.extend({addHooks:function(){dt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){rn(this._map._container,"touchstart",this._onDown,this)},_onDown:function(u){if(clearTimeout(this._holdTimeout),u.touches.length===1){var y=u.touches[0];this._startPos=this._newPos=new ie(y.clientX,y.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(dt(document,"touchend",hn),dt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",y))},this),Nh),dt(document,"touchend touchcancel contextmenu",this._cancel,this),dt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function u(){rn(document,"touchend",hn),rn(document,"touchend touchcancel",u)},_cancel:function(){clearTimeout(this._holdTimeout),rn(document,"touchend touchcancel contextmenu",this._cancel,this),rn(document,"touchmove",this._onMove,this)},_onMove:function(u){var y=u.touches[0];this._newPos=new ie(y.clientX,y.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(u,y){var T=new MouseEvent(u,{bubbles:!0,cancelable:!0,view:window,screenX:y.screenX,screenY:y.screenY,clientX:y.clientX,clientY:y.clientY});T._simulated=!0,y.target.dispatchEvent(T)}});Dt.addInitHook("addHandler","tapHold",Ac),Dt.mergeOptions({touchZoom:Ke.touch,bounceAtZoomLimits:!0});var fl=jr.extend({addHooks:function(){wt(this._map._container,"leaflet-touch-zoom"),dt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){dn(this._map._container,"leaflet-touch-zoom"),rn(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(u){var y=this._map;if(!(!u.touches||u.touches.length!==2||y._animatingZoom||this._zooming)){var T=y.mouseEventToContainerPoint(u.touches[0]),V=y.mouseEventToContainerPoint(u.touches[1]);this._centerPoint=y.getSize()._divideBy(2),this._startLatLng=y.containerPointToLatLng(this._centerPoint),y.options.touchZoom!=="center"&&(this._pinchStartLatLng=y.containerPointToLatLng(T.add(V)._divideBy(2))),this._startDist=T.distanceTo(V),this._startZoom=y.getZoom(),this._moved=!1,this._zooming=!0,y._stop(),dt(document,"touchmove",this._onTouchMove,this),dt(document,"touchend touchcancel",this._onTouchEnd,this),hn(u)}},_onTouchMove:function(u){if(!(!u.touches||u.touches.length!==2||!this._zooming)){var y=this._map,T=y.mouseEventToContainerPoint(u.touches[0]),V=y.mouseEventToContainerPoint(u.touches[1]),W=T.distanceTo(V)/this._startDist;if(this._zoom=y.getScaleZoom(W,this._startZoom),!y.options.bounceAtZoomLimits&&(this._zoom<y.getMinZoom()&&W<1||this._zoom>y.getMaxZoom()&&W>1)&&(this._zoom=y._limitZoom(this._zoom)),y.options.touchZoom==="center"){if(this._center=this._startLatLng,W===1)return}else{var ne=T._add(V)._divideBy(2)._subtract(this._centerPoint);if(W===1&&ne.x===0&&ne.y===0)return;this._center=y.unproject(y.project(this._pinchStartLatLng,this._zoom).subtract(ne),this._zoom)}this._moved||(y._moveStart(!0,!1),this._moved=!0),M(this._animRequest);var he=o(y._move,y,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=C(he,this,!0),hn(u)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,M(this._animRequest),rn(document,"touchmove",this._onTouchMove,this),rn(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Dt.addInitHook("addHandler","touchZoom",fl),Dt.BoxZoom=hl,Dt.DoubleClickZoom=Km,Dt.Drag=Th,Dt.Keyboard=Ah,Dt.ScrollWheelZoom=xn,Dt.TapHold=Ac,Dt.TouchZoom=fl,t.Bounds=z,t.Browser=Ke,t.CRS=ce,t.Canvas=Eh,t.Circle=Vu,t.CircleMarker=Fu,t.Class=$,t.Control=xr,t.DivIcon=Wu,t.DivOverlay=ys,t.DomEvent=Qo,t.DomUtil=go,t.Draggable=qr,t.Evented=se,t.FeatureGroup=Vn,t.GeoJSON=gs,t.GridLayer=xo,t.Handler=jr,t.Icon=Zi,t.ImageOverlay=_o,t.LatLng=le,t.LatLngBounds=J,t.Layer=sn,t.LayerGroup=En,t.LineUtil=oe,t.Map=Dt,t.Marker=Ks,t.Mixin=$s,t.Path=vo,t.Point=ie,t.PolyUtil=nl,t.Polygon=Ys,t.Polyline=oi,t.Popup=$u,t.PosAnimation=Xo,t.Projection=He,t.Rectangle=Gm,t.Renderer=vs,t.SVG=ra,t.SVGOverlay=xh,t.TileLayer=bo,t.Tooltip=cl,t.Transformation=Me,t.Util=D,t.VideoOverlay=_h,t.bind=o,t.bounds=Z,t.canvas=Sh,t.circle=wc,t.circleMarker=Bm,t.control=nr,t.divIcon=Hm,t.extend=i,t.featureGroup=na,t.geoJSON=zm,t.geoJson=Qi,t.gridLayer=ul,t.icon=Vm,t.imageOverlay=Um,t.latLng=Q,t.latLngBounds=ae,t.layerGroup=Pi,t.map=si,t.marker=E0,t.point=G,t.polygon=T0,t.polyline=S0,t.popup=ll,t.rectangle=A0,t.setOptions=x,t.stamp=d,t.svg=Gu,t.svgOverlay=bh,t.tileLayer=wh,t.tooltip=Sc,t.transformation=Pe,t.version=n,t.videoOverlay=qm;var Ym=window.L;t.noConflict=function(){return window.L=Ym,this},window.L=t})}(Af,Af.exports)),Af.exports}var dw=dW();function BR(r,e,t){return Object.freeze({instance:r,context:e,container:t})}function zR(r,e){return e==null?function(n,i){const s=X.useRef();return s.current||(s.current=r(n,i)),s}:function(n,i){const s=X.useRef();s.current||(s.current=r(n,i));const o=X.useRef(n),{instance:l}=s.current;return X.useEffect(function(){o.current!==n&&(e(l,n,o.current),o.current=n)},[l,n,i]),s}}function UR(r,e){X.useEffect(function(){return(e.layerContainer??e.map).addLayer(r.instance),function(){var s;(s=e.layerContainer)==null||s.removeLayer(r.instance),e.map.removeLayer(r.instance)}},[e,r])}function hW(r){return function(t){const n=FR(),i=r(uw(t,n),n);return iW(n.map,t.attribution),VR(i.current,t.eventHandlers),UR(i.current,n),i}}function fW(r,e){const t=X.useRef();X.useEffect(function(){if(e.pathOptions!==t.current){const i=e.pathOptions??{};r.instance.setStyle(i),t.current=i}},[r,e])}function mW(r){return function(t){const n=FR(),i=r(uw(t,n),n);return VR(i.current,t.eventHandlers),UR(i.current,n),fW(i.current,t),i}}function pW(r,e){const t=zR(r,e),n=mW(t);return lW(n)}function gW(r,e){const t=zR(r,e),n=hW(t);return cW(n)}function yW(r,e,t){const{opacity:n,zIndex:i}=e;n!=null&&n!==t.opacity&&r.setOpacity(n),i!=null&&i!==t.zIndex&&r.setZIndex(i)}const vW=pW(function({data:e,...t},n){const i=new dw.GeoJSON(e,t);return BR(i,aW(n,{overlayContainer:i}))},function(e,t,n){t.style!==n.style&&(t.style==null?e.resetStyle():e.setStyle(t.style))});function tb(){return tb=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},tb.apply(this,arguments)}function _W({bounds:r,boundsOptions:e,center:t,children:n,className:i,id:s,placeholder:o,style:l,whenReady:d,zoom:f,...m},p){const[g]=X.useState({className:i,id:s,style:l}),[v,E]=X.useState(null);X.useImperativeHandle(p,()=>(v==null?void 0:v.map)??null,[v]);const x=X.useCallback(S=>{if(S!==null&&v===null){const N=new dw.Map(S,m);t!=null&&f!=null?N.setView(t,f):r!=null&&N.fitBounds(r,e),d!=null&&N.whenReady(d),E(oW(N))}},[]);X.useEffect(()=>()=>{v==null||v.map.remove()},[v]);const b=v?ss.createElement(LR,{value:v},n):o??null;return ss.createElement("div",tb({},g,{ref:x}),b)}const xW=X.forwardRef(_W),bW=gW(function({url:e,...t},n){const i=new dw.TileLayer(e,uw(t,n));return BR(i,n)},function(e,t,n){yW(e,t,n);const{url:i}=t;i!=null&&i!==n.url&&e.setUrl(i)}),qR=({geoJsonData:r,affectedAreas:e=[],mapCenter:t=[14.3207,120.7641],mapZoom:n=13,height:i="256px"})=>{const s={fillColor:"#6b7280",weight:1,opacity:1,color:"white",fillOpacity:.3},o={fillColor:"#EF4444",weight:2,opacity:1,color:"#B91C1C",fillOpacity:.7},l=m=>{var g;const p=(g=m==null?void 0:m.properties)==null?void 0:g.NAME_3;return e.includes(p)?o:s},d=(m,p)=>{var v;const g=(v=m==null?void 0:m.properties)==null?void 0:v.NAME_3;if(g){const E=e.includes(g),x=`
                <div>
                    <strong>${g}</strong>
                    <p style="color: ${E?"#B91C1C":"#374151"}; margin: 0; font-weight: bold;">
                        ${E?"AFFECTED":"Not Affected"}
                    </p>
                </div>
            `;p.bindPopup(x)}},f=JSON.stringify(e);return c.jsxs(xW,{center:t,zoom:n,scrollWheelZoom:!1,style:{height:i,width:"100%"},children:[c.jsx(bW,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),c.jsx(vW,{data:r,style:l,onEachFeature:d})]},f)},wW="FeatureCollection",EW=JSON.parse('[{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10541,"NAME_3":"Bagong Karsada","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.751953,14.32201],[120.752228,14.32222],[120.752663,14.32253],[120.753036,14.32284],[120.753357,14.32315],[120.753677,14.32344],[120.753937,14.32382],[120.754112,14.32407],[120.755127,14.32243],[120.755623,14.32164],[120.753319,14.31961],[120.753288,14.31996],[120.75325,14.32051],[120.75177,14.32179],[120.751953,14.32201]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10542,"NAME_3":"Balsahan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.757576,14.324344],[120.757652,14.32411],[120.757851,14.32374],[120.758034,14.3234],[120.758293,14.32305],[120.75853,14.32271],[120.75885,14.32232],[120.759201,14.3219],[120.759644,14.32152],[120.760017,14.32123],[120.759048,14.32047],[120.756859,14.31872],[120.756042,14.31818],[120.755547,14.31786],[120.754921,14.3172],[120.753166,14.31839],[120.753319,14.31961],[120.755623,14.32164],[120.756866,14.32269],[120.756897,14.32261],[120.757576,14.324344]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10543,"NAME_3":"Bancaan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.760017,14.32123],[120.760094,14.32119],[120.76049,14.3209],[120.760841,14.32068],[120.7612,14.32057],[120.761574,14.32058],[120.761879,14.32073],[120.762115,14.32097],[120.762291,14.31999],[120.762367,14.31954],[120.762497,14.31838],[120.763046,14.31687],[120.763611,14.31575],[120.764374,14.31534],[120.764709,14.31529],[120.760948,14.31142],[120.758423,14.30908],[120.75679,14.30764],[120.749802,14.3161],[120.749046,14.31704],[120.748451,14.31786],[120.747993,14.3185],[120.74823,14.31858],[120.748756,14.31893],[120.749207,14.31934],[120.749672,14.31971],[120.750137,14.32007],[120.750542,14.32052],[120.750763,14.32081],[120.750923,14.32101],[120.751343,14.32144],[120.75177,14.32187],[120.751953,14.32201],[120.75177,14.32179],[120.75325,14.32051],[120.753288,14.31996],[120.753319,14.31961],[120.753166,14.31839],[120.754921,14.3172],[120.755547,14.31786],[120.756042,14.31818],[120.756859,14.31872],[120.759048,14.32047],[120.760017,14.32123]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10544,"NAME_3":"Bucana Malaki","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.759468,14.32942],[120.75988,14.32972],[120.760094,14.32985],[120.760612,14.32961],[120.762527,14.32867],[120.765457,14.32651],[120.761711,14.32374],[120.762093,14.32114],[120.762115,14.32097],[120.761879,14.32073],[120.761574,14.32058],[120.7612,14.32057],[120.760841,14.32068],[120.76049,14.3209],[120.760094,14.32119],[120.760017,14.32123],[120.759644,14.32152],[120.759201,14.3219],[120.75885,14.32232],[120.75853,14.32271],[120.758293,14.32305],[120.758034,14.3234],[120.757851,14.32374],[120.757652,14.32411],[120.757576,14.324344],[120.757561,14.32441],[120.757507,14.32458],[120.757393,14.32517],[120.757378,14.32534],[120.757332,14.32586],[120.757423,14.32654],[120.757683,14.32709],[120.758034,14.32756],[120.758377,14.32805],[120.758728,14.32854],[120.759117,14.32899],[120.759468,14.32942]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10545,"NAME_3":"Bucana Sasahan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.75563,14.32561],[120.759468,14.32942],[120.759117,14.32899],[120.758728,14.32854],[120.758377,14.32805],[120.758034,14.32756],[120.757683,14.32709],[120.757423,14.32654],[120.757332,14.32586],[120.757378,14.32534],[120.757393,14.32517],[120.757507,14.32458],[120.757561,14.32441],[120.757576,14.324344],[120.756897,14.32261],[120.756866,14.32269],[120.756737,14.32314],[120.756622,14.32366],[120.756508,14.32416],[120.756378,14.32468],[120.756088,14.32519],[120.75563,14.32561]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10546,"NAME_3":"Calubcob","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.796928,14.30077],[120.795471,14.29953],[120.793137,14.29676],[120.79158,14.29506],[120.787483,14.2923],[120.786659,14.29179],[120.785629,14.29099],[120.783401,14.28984],[120.782379,14.29027],[120.782082,14.29058],[120.78141,14.29118],[120.781189,14.29207],[120.780548,14.29224],[120.780434,14.29373],[120.779984,14.29418],[120.780212,14.29477],[120.780952,14.2945],[120.780899,14.29493],[120.780457,14.29537],[120.78064,14.29603],[120.780273,14.29652],[120.779167,14.29681],[120.778511,14.29719],[120.778053,14.29832],[120.777763,14.29899],[120.777924,14.30045],[120.77832,14.30128],[120.778503,14.30227],[120.779778,14.30327],[120.783112,14.30549],[120.783958,14.30623],[120.785881,14.30723],[120.786102,14.30674],[120.787018,14.30689],[120.787827,14.30755],[120.788567,14.30743],[120.788879,14.30703],[120.78952,14.3074],[120.789886,14.30639],[120.790253,14.30608],[120.790604,14.30655],[120.791344,14.30624],[120.79174,14.30554],[120.79213,14.30448],[120.792648,14.30341],[120.793854,14.30352],[120.795471,14.30197],[120.795929,14.30115],[120.796928,14.30077]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10547,"NAME_3":"Capt. C. Nazareno","NL_NAME_3":"","VARNAME_3":"Poblacion","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.766197,14.31813],[120.763046,14.31687],[120.762497,14.31838],[120.762367,14.31954],[120.76326,14.31981],[120.763931,14.32013],[120.764572,14.32034],[120.7649,14.32048],[120.766197,14.31813]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10548,"NAME_3":"Gomez-Zamora","NL_NAME_3":"","VARNAME_3":"Poblacion","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.762115,14.32097],[120.762093,14.32114],[120.762802,14.32201],[120.763283,14.32248],[120.764091,14.3223],[120.76458,14.32184],[120.765198,14.32126],[120.766006,14.321],[120.766571,14.32094],[120.767021,14.32038],[120.767509,14.31945],[120.766197,14.31813],[120.7649,14.32048],[120.764572,14.32034],[120.763931,14.32013],[120.76326,14.31981],[120.762367,14.31954],[120.762291,14.31999],[120.762115,14.32097]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10549,"NAME_3":"Halang","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.796928,14.30077],[120.798698,14.3027],[120.800812,14.30515],[120.802559,14.3051],[120.803482,14.30436],[120.803978,14.30431],[120.805817,14.30476],[120.807091,14.3045],[120.807037,14.30409],[120.807747,14.30351],[120.808243,14.30261],[120.809677,14.30198],[120.809601,14.3011],[120.81073,14.30081],[120.811562,14.30122],[120.811897,14.30196],[120.812668,14.3024],[120.813179,14.30343],[120.814293,14.30287],[120.815407,14.3016],[120.820297,14.29734],[120.819633,14.29599],[120.819939,14.29436],[120.813843,14.29398],[120.81057,14.29228],[120.809769,14.29181],[120.806229,14.28998],[120.804901,14.28931],[120.802063,14.28757],[120.798309,14.2857],[120.792213,14.28238],[120.788612,14.2884],[120.787956,14.28963],[120.786659,14.29179],[120.787483,14.2923],[120.79158,14.29506],[120.793137,14.29676],[120.795471,14.29953],[120.796928,14.30077]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10550,"NAME_3":"Humbac","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.766197,14.31813],[120.767509,14.31945],[120.768089,14.31881],[120.769089,14.31828],[120.769676,14.31781],[120.770073,14.31745],[120.769814,14.31668],[120.769524,14.31613],[120.769234,14.31572],[120.766197,14.31813]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10551,"NAME_3":"Ibayo Estacion","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.769722,14.32933],[120.769821,14.32828],[120.770157,14.32789],[120.77076,14.32727],[120.77137,14.32683],[120.771744,14.32605],[120.772591,14.32497],[120.770638,14.32312],[120.768913,14.32191],[120.767021,14.32038],[120.766571,14.32094],[120.766006,14.321],[120.765198,14.32126],[120.76458,14.32184],[120.764091,14.3223],[120.763283,14.32248],[120.762802,14.32201],[120.762093,14.32114],[120.761711,14.32374],[120.765457,14.32651],[120.769722,14.32933]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10552,"NAME_3":"Ibayo Silangan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.773247,14.32551],[120.774567,14.32522],[120.77565,14.32507],[120.778954,14.32391],[120.781349,14.32267],[120.780998,14.32235],[120.778877,14.32059],[120.775726,14.31822],[120.773621,14.31899],[120.772987,14.31952],[120.77224,14.31976],[120.771523,14.31882],[120.771339,14.31775],[120.771278,14.31705],[120.770531,14.31729],[120.770073,14.31745],[120.769676,14.31781],[120.769089,14.31828],[120.768089,14.31881],[120.767509,14.31945],[120.767021,14.32038],[120.768913,14.32191],[120.770638,14.32312],[120.772591,14.32497],[120.773247,14.32551]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10553,"NAME_3":"Kanluran","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.763046,14.31687],[120.766197,14.31813],[120.769234,14.31572],[120.768738,14.31548],[120.767899,14.31517],[120.76712,14.31594],[120.766319,14.31657],[120.765717,14.31653],[120.765198,14.31578],[120.764709,14.31529],[120.764374,14.31534],[120.763611,14.31575],[120.763046,14.31687]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10554,"NAME_3":"Labac","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.727501,14.31074],[120.727501,14.31083],[120.728333,14.31167],[120.728333,14.31194],[120.730553,14.31417],[120.731079,14.31434],[120.731506,14.31455],[120.731941,14.31476],[120.73233,14.31499],[120.732742,14.3152],[120.7332,14.31533],[120.733643,14.31549],[120.734047,14.31551],[120.734123,14.31552],[120.734596,14.31547],[120.735077,14.31552],[120.735558,14.31549],[120.736,14.31532],[120.736488,14.31518],[120.737053,14.31506],[120.737663,14.31505],[120.738228,14.31514],[120.738731,14.31529],[120.73922,14.3154],[120.739754,14.31528],[120.739929,14.31525],[120.740311,14.31519],[120.740791,14.31544],[120.741249,14.31574],[120.741814,14.31583],[120.742416,14.31588],[120.742981,14.31611],[120.7435,14.31635],[120.744003,14.3165],[120.744476,14.31663],[120.74498,14.31673],[120.745422,14.31697],[120.745872,14.31728],[120.74633,14.31768],[120.746399,14.31705],[120.746422,14.31649],[120.746307,14.31613],[120.745743,14.31451],[120.74572,14.31392],[120.746071,14.31316],[120.7472,14.31252],[120.747627,14.31176],[120.747269,14.31077],[120.747269,14.31019],[120.747887,14.31001],[120.749023,14.31056],[120.74984,14.31044],[120.750641,14.30858],[120.751472,14.30825],[120.751663,14.30732],[120.751251,14.30685],[120.751167,14.30573],[120.75164,14.30486],[120.752296,14.30424],[120.752907,14.30395],[120.753052,14.30365],[120.746437,14.29659],[120.745796,14.29764],[120.745293,14.29806],[120.743797,14.29915],[120.742577,14.30067],[120.741898,14.3013],[120.740562,14.30152],[120.739609,14.30153],[120.739128,14.30179],[120.738258,14.30266],[120.737892,14.30344],[120.737221,14.3043],[120.736237,14.30493],[120.735184,14.3056],[120.73069,14.30862],[120.727501,14.31074]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10555,"NAME_3":"Latoria","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.760094,14.32985],[120.760246,14.32995],[120.760612,14.33011],[120.760887,14.33032],[120.761208,14.33049],[120.761642,14.33054],[120.762154,14.33055],[120.762688,14.33055],[120.763206,14.33056],[120.763702,14.33058],[120.763947,14.33063],[120.764732,14.33008],[120.765961,14.33096],[120.767014,14.33117],[120.767776,14.3311],[120.768448,14.33105],[120.769211,14.33038],[120.769722,14.32933],[120.765457,14.32651],[120.762527,14.32867],[120.760612,14.32961],[120.760094,14.32985]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10556,"NAME_3":"Mabolo","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.74633,14.31768],[120.746902,14.31804],[120.747551,14.31834],[120.747993,14.3185],[120.748451,14.31786],[120.749046,14.31704],[120.749802,14.3161],[120.75679,14.30764],[120.75473,14.30534],[120.753052,14.30365],[120.752907,14.30395],[120.752296,14.30424],[120.75164,14.30486],[120.751167,14.30573],[120.751251,14.30685],[120.751663,14.30732],[120.751472,14.30825],[120.750641,14.30858],[120.74984,14.31044],[120.749023,14.31056],[120.747887,14.31001],[120.747269,14.31019],[120.747269,14.31077],[120.747627,14.31176],[120.7472,14.31252],[120.746071,14.31316],[120.74572,14.31392],[120.745743,14.31451],[120.746307,14.31613],[120.746422,14.31649],[120.746399,14.31705],[120.74633,14.31768]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10557,"NAME_3":"Makina","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.775726,14.31822],[120.77623,14.31799],[120.776337,14.31736],[120.776016,14.31699],[120.775383,14.31703],[120.775131,14.31666],[120.775398,14.31625],[120.777046,14.31609],[120.77787,14.31627],[120.778267,14.3167],[120.779129,14.31653],[120.779984,14.31584],[120.780212,14.31507],[120.780144,14.31417],[120.780777,14.31381],[120.781914,14.31403],[120.779716,14.31219],[120.779213,14.31167],[120.778717,14.31116],[120.778137,14.31058],[120.776154,14.30884],[120.775749,14.3103],[120.774963,14.31186],[120.774757,14.3131],[120.771317,14.31285],[120.769661,14.31275],[120.768494,14.31254],[120.768318,14.31354],[120.768143,14.3146],[120.767899,14.31517],[120.768738,14.31548],[120.769234,14.31572],[120.769524,14.31613],[120.769814,14.31668],[120.770073,14.31745],[120.770531,14.31729],[120.771278,14.31705],[120.771339,14.31775],[120.771523,14.31882],[120.77224,14.31976],[120.772987,14.31952],[120.773621,14.31899],[120.775726,14.31822]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10558,"NAME_3":"Malainen Bago","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.767899,14.31517],[120.768143,14.3146],[120.768318,14.31354],[120.768494,14.31254],[120.768593,14.3121],[120.769157,14.31145],[120.769272,14.31056],[120.769203,14.30977],[120.769676,14.30846],[120.770462,14.30794],[120.771317,14.3086],[120.771599,14.30837],[120.772362,14.30716],[120.772537,14.3066],[120.773163,14.30608],[120.773613,14.30575],[120.773712,14.30503],[120.774094,14.30462],[120.774361,14.3042],[120.774208,14.30345],[120.774017,14.30235],[120.774811,14.30239],[120.775352,14.3017],[120.77562,14.30165],[120.775917,14.30212],[120.776398,14.30275],[120.777023,14.30223],[120.777603,14.30251],[120.777931,14.30307],[120.778503,14.30227],[120.77832,14.30128],[120.777924,14.30045],[120.777763,14.29899],[120.778053,14.29832],[120.778511,14.29719],[120.779167,14.29681],[120.780273,14.29652],[120.78064,14.29603],[120.780457,14.29537],[120.780899,14.29493],[120.780952,14.2945],[120.780212,14.29477],[120.779984,14.29418],[120.780434,14.29373],[120.780548,14.29224],[120.781189,14.29207],[120.78141,14.29118],[120.782082,14.29058],[120.779907,14.28971],[120.777046,14.28816],[120.775574,14.28685],[120.77198,14.28391],[120.761482,14.29684],[120.760094,14.29865],[120.75946,14.2995],[120.75473,14.30534],[120.75679,14.30764],[120.758423,14.30908],[120.760948,14.31142],[120.764709,14.31529],[120.765198,14.31578],[120.765717,14.31653],[120.766319,14.31657],[120.76712,14.31594],[120.767899,14.31517]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10559,"NAME_3":"Malainen Luma","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.794434,14.27777],[120.795692,14.27623],[120.796799,14.27539],[120.797752,14.2752],[120.798431,14.27461],[120.798401,14.27377],[120.798843,14.27331],[120.799072,14.27257],[120.798943,14.27116],[120.799187,14.27024],[120.79953,14.27012],[120.800102,14.26998],[120.800957,14.26899],[120.801849,14.26861],[120.802597,14.26735],[120.804024,14.26673],[120.804764,14.26612],[120.805527,14.26521],[120.807266,14.26317],[120.808327,14.26269],[120.809067,14.26174],[120.810127,14.26152],[120.810783,14.26001],[120.812187,14.2584],[120.81263,14.25872],[120.813477,14.25752],[120.814072,14.25646],[120.815041,14.25574],[120.816132,14.25479],[120.816208,14.25375],[120.816994,14.25316],[120.81781,14.25278],[120.818863,14.25252],[120.81945,14.25189],[120.819832,14.25076],[120.820511,14.24925],[120.826263,14.24232],[120.830116,14.23784],[120.81546,14.23471],[120.814468,14.23565],[120.813187,14.23765],[120.812798,14.23927],[120.811974,14.24012],[120.810806,14.24049],[120.809669,14.24196],[120.808357,14.24426],[120.807137,14.24588],[120.805428,14.24794],[120.802589,14.25125],[120.801048,14.25189],[120.799553,14.25132],[120.798248,14.25165],[120.797562,14.25312],[120.796822,14.25366],[120.796417,14.25413],[120.795967,14.25481],[120.795403,14.25595],[120.795319,14.2569],[120.795662,14.25829],[120.795952,14.25932],[120.795387,14.26042],[120.794853,14.26151],[120.794067,14.26296],[120.793411,14.26389],[120.792923,14.2645],[120.79171,14.26605],[120.790199,14.26781],[120.789307,14.26891],[120.788406,14.26957],[120.785469,14.27084],[120.783981,14.27122],[120.787018,14.276],[120.789368,14.27823],[120.792053,14.28081],[120.792503,14.28015],[120.793427,14.27897],[120.794434,14.27777]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10560,"NAME_3":"Molino","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.786659,14.29179],[120.787956,14.28963],[120.788612,14.2884],[120.792213,14.28238],[120.792686,14.2815],[120.792053,14.28081],[120.789368,14.27823],[120.787018,14.276],[120.783981,14.27122],[120.7817,14.2724],[120.7799,14.27285],[120.779259,14.27287],[120.778679,14.27272],[120.777924,14.2737],[120.777557,14.2741],[120.776573,14.27447],[120.775352,14.27459],[120.773949,14.27451],[120.772163,14.27538],[120.770981,14.27596],[120.769112,14.27708],[120.768066,14.27766],[120.767036,14.27842],[120.771317,14.2832],[120.77198,14.28391],[120.775574,14.28685],[120.777046,14.28816],[120.779907,14.28971],[120.782082,14.29058],[120.782379,14.29027],[120.783401,14.28984],[120.785629,14.29099],[120.786659,14.29179]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10561,"NAME_3":"Munting Mapino","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.783432,14.3349],[120.77964,14.3313],[120.77916,14.33102],[120.774933,14.32707],[120.773247,14.32551],[120.772591,14.32497],[120.771744,14.32605],[120.77137,14.32683],[120.77076,14.32727],[120.770157,14.32789],[120.769821,14.32828],[120.769722,14.32933],[120.769211,14.33038],[120.768448,14.33105],[120.767776,14.3311],[120.767014,14.33117],[120.765961,14.33096],[120.764732,14.33008],[120.763947,14.33063],[120.764137,14.33066],[120.764526,14.33078],[120.7649,14.33083],[120.765259,14.3309],[120.765602,14.33106],[120.765984,14.33118],[120.766342,14.33134],[120.766762,14.33144],[120.767151,14.33161],[120.767563,14.33169],[120.767937,14.33183],[120.76828,14.33201],[120.768578,14.33226],[120.768837,14.33259],[120.769073,14.33299],[120.769417,14.33334],[120.769791,14.33372],[120.770058,14.33416],[120.770317,14.33464],[120.77066,14.3351],[120.771019,14.33554],[120.77137,14.33595],[120.77166,14.33633],[120.771912,14.33665],[120.772141,14.33694],[120.772346,14.3372],[120.772552,14.33742],[120.772774,14.33763],[120.772972,14.33785],[120.773132,14.33811],[120.773331,14.33833],[120.773529,14.33855],[120.773697,14.33882],[120.773933,14.3391],[120.774178,14.33943],[120.774452,14.33978],[120.77475,14.34015],[120.775047,14.3405],[120.77536,14.34084],[120.775627,14.34119],[120.775887,14.34156],[120.776207,14.3419],[120.776253,14.34193],[120.783432,14.3349]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10562,"NAME_3":"Muzon","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.75473,14.30534],[120.75946,14.2995],[120.760094,14.29865],[120.761482,14.29684],[120.77198,14.28391],[120.771317,14.2832],[120.767036,14.27842],[120.765556,14.27953],[120.763527,14.28064],[120.761757,14.28257],[120.756813,14.28615],[120.752419,14.29057],[120.748428,14.29473],[120.746437,14.29659],[120.753052,14.30365],[120.75473,14.30534]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10563,"NAME_3":"Palangue 1","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.824249,14.28712],[120.824547,14.28576],[120.825531,14.2839],[120.826576,14.28211],[120.827164,14.28046],[120.827538,14.2785],[120.828331,14.27726],[120.829071,14.27591],[120.830704,14.27488],[120.832123,14.27404],[120.83358,14.2724],[120.834877,14.27046],[120.837608,14.26852],[120.84008,14.2674],[120.842598,14.26605],[120.845612,14.26456],[120.845993,14.26402],[120.846367,14.26258],[120.847366,14.26168],[120.84819,14.26081],[120.848877,14.25942],[120.850616,14.25837],[120.851151,14.25713],[120.852226,14.25636],[120.853043,14.25589],[120.85363,14.25501],[120.854843,14.25417],[120.855797,14.25342],[120.856667,14.25242],[120.857269,14.25186],[120.858932,14.25047],[120.860161,14.24863],[120.860924,14.24762],[120.860977,14.24743],[120.861153,14.24699],[120.86116,14.24634],[120.841423,14.24068],[120.840408,14.24005],[120.830116,14.23784],[120.826263,14.24232],[120.820511,14.24925],[120.819832,14.25076],[120.81945,14.25189],[120.818863,14.25252],[120.81781,14.25278],[120.816994,14.25316],[120.816208,14.25375],[120.816132,14.25479],[120.815041,14.25574],[120.814072,14.25646],[120.813477,14.25752],[120.81263,14.25872],[120.812187,14.2584],[120.810783,14.26001],[120.810127,14.26152],[120.809067,14.26174],[120.808327,14.26269],[120.807266,14.26317],[120.805527,14.26521],[120.804764,14.26612],[120.804024,14.26673],[120.802597,14.26735],[120.801849,14.26861],[120.800957,14.26899],[120.800102,14.26998],[120.79953,14.27012],[120.799187,14.27024],[120.798943,14.27116],[120.799072,14.27257],[120.798843,14.27331],[120.798401,14.27377],[120.798431,14.27461],[120.797752,14.2752],[120.796799,14.27539],[120.795692,14.27623],[120.794434,14.27777],[120.799454,14.27923],[120.806091,14.28108],[120.810387,14.28262],[120.811623,14.28306],[120.813179,14.28332],[120.814919,14.28395],[120.820442,14.28561],[120.824249,14.28712]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10564,"NAME_3":"Palangue 2 & 3","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.824249,14.28712],[120.820442,14.28561],[120.814919,14.28395],[120.813179,14.28332],[120.811623,14.28306],[120.810387,14.28262],[120.806091,14.28108],[120.799454,14.27923],[120.794434,14.27777],[120.793427,14.27897],[120.792503,14.28015],[120.792053,14.28081],[120.792686,14.2815],[120.792213,14.28238],[120.798309,14.2857],[120.802063,14.28757],[120.804901,14.28931],[120.806229,14.28998],[120.809769,14.29181],[120.81057,14.29228],[120.813843,14.29398],[120.819939,14.29436],[120.820732,14.2926],[120.821609,14.2913],[120.822838,14.28971],[120.823647,14.28833],[120.824249,14.28712]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10565,"NAME_3":"Sabang","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.788643,14.33889],[120.789307,14.33951],[120.792732,14.34074],[120.794243,14.34066],[120.7957,14.34114],[120.797279,14.34136],[120.799011,14.33994],[120.80159,14.33861],[120.803528,14.3379],[120.803902,14.33652],[120.804771,14.33587],[120.805656,14.33537],[120.806343,14.3347],[120.806549,14.33396],[120.807983,14.33238],[120.809158,14.33198],[120.810867,14.33117],[120.813759,14.32859],[120.813812,14.32728],[120.814857,14.32588],[120.815437,14.32531],[120.816597,14.32479],[120.818443,14.32394],[120.818871,14.32316],[120.819069,14.32229],[120.819817,14.32115],[120.820297,14.32056],[120.820663,14.31985],[120.821167,14.31948],[120.822182,14.31878],[120.822487,14.31704],[120.822533,14.31642],[120.822258,14.31442],[120.822929,14.31309],[120.823288,14.31146],[120.823837,14.30945],[120.82431,14.30771],[120.824966,14.30622],[120.825073,14.30456],[120.824379,14.30272],[120.823463,14.30082],[120.822388,14.29903],[120.821381,14.29831],[120.820297,14.29734],[120.815407,14.3016],[120.814293,14.30287],[120.813179,14.30343],[120.812668,14.3024],[120.811897,14.30196],[120.811562,14.30122],[120.81073,14.30081],[120.809601,14.3011],[120.809677,14.30198],[120.808243,14.30261],[120.807747,14.30351],[120.807037,14.30409],[120.807091,14.3045],[120.805817,14.30476],[120.803978,14.30431],[120.803482,14.30436],[120.802559,14.3051],[120.800812,14.30515],[120.799843,14.30533],[120.799156,14.30575],[120.798843,14.30679],[120.798538,14.30773],[120.797394,14.30863],[120.79641,14.30895],[120.795212,14.30953],[120.795059,14.3103],[120.795502,14.31064],[120.795517,14.31139],[120.794617,14.31257],[120.793159,14.31382],[120.792542,14.31418],[120.791977,14.31496],[120.790672,14.3157],[120.789467,14.31593],[120.788643,14.31569],[120.787987,14.31516],[120.787216,14.31496],[120.78614,14.31564],[120.785332,14.31589],[120.784416,14.31578],[120.783188,14.31485],[120.781914,14.31403],[120.780777,14.31381],[120.780144,14.31417],[120.780212,14.31507],[120.779984,14.31584],[120.779129,14.31653],[120.778267,14.3167],[120.77787,14.31627],[120.777046,14.31609],[120.775398,14.31625],[120.775131,14.31666],[120.775383,14.31703],[120.776016,14.31699],[120.776337,14.31736],[120.77623,14.31799],[120.775726,14.31822],[120.778877,14.32059],[120.780998,14.32235],[120.781349,14.32267],[120.778954,14.32391],[120.77565,14.32507],[120.774567,14.32522],[120.773247,14.32551],[120.774933,14.32707],[120.77916,14.33102],[120.77964,14.3313],[120.783432,14.3349],[120.784019,14.33548],[120.785622,14.33652],[120.788643,14.33889]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10566,"NAME_3":"San Roque","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.781914,14.31403],[120.783188,14.31485],[120.784416,14.31578],[120.785332,14.31589],[120.78614,14.31564],[120.787216,14.31496],[120.787987,14.31516],[120.788643,14.31569],[120.789467,14.31593],[120.790672,14.3157],[120.791977,14.31496],[120.792542,14.31418],[120.793159,14.31382],[120.794617,14.31257],[120.795517,14.31139],[120.795502,14.31064],[120.795059,14.3103],[120.795212,14.30953],[120.79641,14.30895],[120.797394,14.30863],[120.798538,14.30773],[120.798843,14.30679],[120.799156,14.30575],[120.799843,14.30533],[120.800812,14.30515],[120.798698,14.3027],[120.796928,14.30077],[120.795929,14.30115],[120.795471,14.30197],[120.793854,14.30352],[120.792648,14.30341],[120.79213,14.30448],[120.79174,14.30554],[120.791344,14.30624],[120.790604,14.30655],[120.790253,14.30608],[120.789886,14.30639],[120.78952,14.3074],[120.788879,14.30703],[120.788567,14.30743],[120.787827,14.30755],[120.787018,14.30689],[120.786102,14.30674],[120.785881,14.30723],[120.783958,14.30623],[120.783112,14.30549],[120.779778,14.30327],[120.778503,14.30227],[120.777931,14.30307],[120.777603,14.30251],[120.777023,14.30223],[120.776398,14.30275],[120.775917,14.30212],[120.77562,14.30165],[120.775352,14.3017],[120.774811,14.30239],[120.774017,14.30235],[120.774208,14.30345],[120.774361,14.3042],[120.774094,14.30462],[120.773712,14.30503],[120.773613,14.30575],[120.773163,14.30608],[120.772537,14.3066],[120.772362,14.30716],[120.773453,14.30754],[120.776154,14.30884],[120.778137,14.31058],[120.778717,14.31116],[120.779213,14.31167],[120.779716,14.31219],[120.781914,14.31403]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10567,"NAME_3":"Santulan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.768494,14.31254],[120.769661,14.31275],[120.771317,14.31285],[120.774757,14.3131],[120.774963,14.31186],[120.775749,14.3103],[120.776154,14.30884],[120.773453,14.30754],[120.772362,14.30716],[120.771599,14.30837],[120.771317,14.3086],[120.770462,14.30794],[120.769676,14.30846],[120.769203,14.30977],[120.769272,14.31056],[120.769157,14.31145],[120.768593,14.3121],[120.768494,14.31254]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10568,"NAME_3":"Sapa","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.754112,14.32407],[120.754204,14.3242],[120.754471,14.3246],[120.754807,14.32502],[120.755188,14.32543],[120.75563,14.32561],[120.756088,14.32519],[120.756378,14.32468],[120.756508,14.32416],[120.756622,14.32366],[120.756737,14.32314],[120.756866,14.32269],[120.755623,14.32164],[120.755127,14.32243],[120.754112,14.32407]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10569,"NAME_3":"Timalan Balsahan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.776253,14.34193],[120.776588,14.34224],[120.776947,14.3426],[120.777298,14.34298],[120.777634,14.34336],[120.77787,14.34373],[120.778099,14.34394],[120.778259,14.34424],[120.778481,14.34461],[120.77877,14.34497],[120.778938,14.34525],[120.779556,14.34484],[120.780693,14.34406],[120.788643,14.33889],[120.785622,14.33652],[120.784019,14.33548],[120.783432,14.3349],[120.776253,14.34193]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10570,"NAME_3":"Timalan Concepcion","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.778938,14.34525],[120.779007,14.34537],[120.77919,14.34579],[120.779373,14.34617],[120.779533,14.34659],[120.77977,14.34699],[120.780037,14.34738],[120.780357,14.34777],[120.780693,14.34819],[120.78083,14.34833],[120.780563,14.34861],[120.783401,14.34693],[120.783463,14.34691],[120.785927,14.34637],[120.786774,14.34622],[120.788094,14.34523],[120.789192,14.34419],[120.790558,14.3429],[120.792236,14.34101],[120.792732,14.34074],[120.789307,14.33951],[120.788643,14.33889],[120.780693,14.34406],[120.779556,14.34484],[120.778938,14.34525]]]}}]'),HR={type:wW,features:EW},SW=({db:r,showNotification:e})=>{const[t,n]=X.useState([]),[i,s]=X.useState(!0),[o,l]=X.useState(""),d=X.useCallback(async()=>{s(!0),l("");const m=await P2(r);m.success?n(m.data):(l(m.error||"Failed loading advisories."),e(m.error||"Failed loading advisories.","error")),s(!1)},[r,e]);X.useEffect(()=>{d()},[d]);const f=(m,p)=>{if((p==="Emergency Repair"||p==="Leak Detection")&&m!=="Resolved")return{icon:g3,color:"text-red-700",bgColor:"bg-red-50",borderColor:"border-red-400",label:"Emergency"};switch(m){case"Ongoing":return{icon:Zt,color:"text-orange-600",bgColor:"bg-orange-50",borderColor:"border-orange-400",label:"Ongoing"};case"Scheduled":return{icon:hi,color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-400",label:"Scheduled"};case"Resolved":return{icon:Cs,color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-400",label:"Resolved"};default:return{icon:yn,color:"text-gray-500",bgColor:"bg-gray-50",borderColor:"border-gray-400",label:m||"Unknown"}}};return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[c.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(Zt,{size:30,className:"mr-3 text-orange-500"})," Service Advisories"]}),c.jsxs("button",{onClick:d,disabled:i,className:"flex items-center text-sm p-2 bg-gray-100 rounded-lg hover:bg-gray-200 border border-gray-300",children:[i?c.jsx(Tt,{size:16,className:"animate-spin"}):c.jsx(qa,{size:16}),c.jsx("span",{className:"ml-1.5 hidden sm:inline",children:"Refresh"})]})]}),i&&c.jsx(ln,{message:"Loading advisories..."}),o&&c.jsx("div",{className:"text-red-600 bg-red-50 p-3 rounded-md text-center border border-red-200",children:o}),!i&&!o&&t.length===0&&c.jsxs("div",{className:"text-center py-10 bg-green-50 p-6 rounded-lg shadow-inner border border-green-200",children:[c.jsx(Cs,{size:48,className:"mx-auto text-green-400 mb-4"}),c.jsx("p",{className:"text-gray-700 text-lg font-medium",children:"No Active Service Advisories"}),c.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Water service is currently stable."})]}),!i&&!o&&t.length>0&&c.jsx("div",{className:"space-y-4",children:t.map(m=>{var E;const p=f(m.status,m.type),g=p.icon,v=uo.sanitize(m.description||"");return c.jsxs("details",{className:`p-4 rounded-lg shadow-md border-l-4 group transition-all duration-300 ease-in-out ${p.borderColor} ${p.bgColor} hover:shadow-lg`,children:[c.jsxs("summary",{className:"flex justify-between items-center cursor-pointer list-none",children:[c.jsxs("div",{className:"flex-grow pr-4",children:[c.jsx("h3",{className:"text-md sm:text-lg font-semibold text-gray-800",children:m.title||"Service Advisory"}),c.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["ID: ",m.id.substring(0,8),"..."]})]}),c.jsxs("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full flex items-center shrink-0 ${p.bgColor==="bg-red-50"?"bg-red-100 text-red-700":p.bgColor==="bg-blue-50"?"bg-blue-100 text-blue-700":p.bgColor==="bg-orange-50"?"bg-orange-100 text-orange-700":"bg-green-100 text-green-700"}`,children:[c.jsx(g,{size:14,className:`mr-1.5 ${p.color}`})," ",p.label]}),c.jsx("span",{className:"ml-2 transition-transform duration-300 transform group-open:rotate-180 text-gray-500",children:""})]}),c.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200/80 text-sm text-gray-700 space-y-3 grid grid-rows-[0fr] group-open:grid-rows-[1fr] transition-all duration-500 ease-in-out",children:c.jsxs("div",{className:"overflow-hidden space-y-4",children:[c.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:v}}),c.jsxs("div",{children:[c.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center",children:[c.jsx(lc,{size:16,className:"mr-2 text-gray-500"}),"Affected Area Map"]}),c.jsx(qR,{geoJsonData:HR,affectedAreas:m.affectedAreas||[]})]}),c.jsxs("div",{className:"text-xs text-gray-600 space-y-1 border-t border-gray-200/80 pt-3 mt-3",children:[c.jsxs("p",{className:"flex items-center",children:[c.jsx(co,{size:12,className:"mr-1.5 text-gray-400"}),c.jsx("strong",{children:"Affected:"})," ",((E=m.affectedAreas)==null?void 0:E.join(", "))||"N/A"]}),c.jsxs("p",{className:"flex items-center",children:[c.jsx(hi,{size:12,className:"mr-1.5 text-gray-400"}),c.jsx("strong",{children:"Start:"})," ",Mt(m.startDate)]}),m.estimatedEndDate&&c.jsxs("p",{className:"flex items-center",children:[c.jsx(hi,{size:12,className:"mr-1.5 text-gray-400"}),c.jsx("strong",{children:"Est. End:"})," ",Mt(m.estimatedEndDate)]})]})]})})]},m.id)})})]})},TW=({db:r,showNotification:e})=>{const[t,n]=X.useState([]),[i,s]=X.useState(!0),[o,l]=X.useState(""),d=X.useCallback(async()=>{s(!0),l("");const m=await P2(r);if(m.success){const p=new Set;m.data.forEach(g=>{var v;(v=g.affectedAreas)==null||v.forEach(E=>{p.add(E)})}),n(Array.from(p))}else l(m.error||"Failed loading advisory data."),e(m.error||"Failed loading advisories.","error");s(!1)},[r,e]);X.useEffect(()=>{d()},[d]);const f=X.useMemo(()=>HR,[]);return c.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn h-[calc(100vh-4rem)] flex flex-col",children:[c.jsx("div",{className:"flex justify-between items-center mb-4 pb-4 border-b border-gray-200",children:c.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[c.jsx(lc,{size:30,className:"mr-3 text-red-600"}),"Active Interruption Map"]})}),i&&c.jsx(ln,{message:"Loading map data..."}),o&&c.jsx("div",{className:"text-red-600 bg-red-50 p-3 rounded-md text-center border border-red-200",children:o}),!i&&!o&&c.jsxs("div",{className:"space-y-4 flex-grow flex flex-col",children:[c.jsxs("p",{className:"text-sm text-gray-600",children:["The map below highlights all areas currently affected by any active service advisory.",t.length===0?" Currently, there are no advisories reporting specific affected areas.":` A total of ${t.length} barangay(s) are affected.`]}),c.jsx("div",{className:"flex-grow w-full rounded-lg overflow-hidden border border-gray-300 shadow-inner relative z-10",children:c.jsx(qR,{geoJsonData:f,affectedAreas:t,height:"100%"})})]})]})},A4=({onNavigateHome:r})=>c.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-6 bg-gray-50 rounded-lg shadow-md m-4",children:[c.jsx(X9,{size:48,className:"text-yellow-500 mb-4"}),c.jsx("h1",{className:"text-2xl font-bold text-gray-700 mb-2",children:"404 - Page Not Found"}),c.jsx("p",{className:"text-gray-600 mb-4 max-w-md",children:"The page you are looking for does not exist or has been moved."}),r&&c.jsxs("button",{onClick:r,className:"flex items-center justify-center px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow hover:shadow-md transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50",children:[c.jsx(M2,{size:16,className:"mr-2"}),"Go to Dashboard"]})]}),AW=({isOpen:r,onClose:e,userData:t,showNotification:n,setActiveDashboardSection:i})=>{const s={role:"assistant",text:`Hello, ${(t==null?void 0:t.displayName)||"Valued Customer"}! I am Agie, your AGWA Water Services virtual assistant. How can I help you today with your account (${(t==null?void 0:t.accountNumber)||"N/A"}) or other water service inquiries?`},[o,l]=X.useState([s]),[d,f]=X.useState(""),[m,p]=X.useState(!1),[g,v]=X.useState(!1),[E,x]=X.useState(""),b=X.useRef(null);X.useEffect(()=>{b.current&&(b.current.scrollTop=b.current.scrollHeight)},[o]),X.useEffect(()=>{r&&(l([s]),f(""),p(!1),v(!1),x(""))},[r,t]);const S=async j=>{if(j.preventDefault(),!d.trim()||m)return;const U={role:"user",text:d},P=[...o,U];l(P),f(""),p(!0),v(!1),x("");try{const k=`You are Agie, the friendly and professional AI assistant for AGWA Water Services, a major water utility provider in the Philippines.
Current Customer Details:
- Name: ${t.displayName||"Valued Customer"}
- Account Number: ${t.accountNumber||"Not available"}
- Service Type: ${t.serviceType||"Not specified"}

Your primary goals are:
1.  Understand the customer's query accurately. Queries can be about billing, payments, account management, water quality, leaks, service interruptions, how to use the portal, etc.
2.  Provide clear, concise, helpful, and empathetic responses.
3.  If the query is straightforward and answerable with general knowledge or information commonly found in FAQs (e.g., "how to pay my bill?", "what is FCDA?"), provide the answer.
4.  If the query implies needing specific account data you don't have (e.g., "what was my last payment amount?", "is my meter reading correct for May?"), explain you cannot access real-time specific account details but can guide them to where they might find it in the portal (e.g., "You can check your detailed bill history under 'My Bills' section").
5.  If the customer expresses frustration, has a complex issue (like a persistent leak or no water for an extended time), or directly asks to speak to a human or create a ticket, ALWAYS offer to help them create a support ticket. In this specific scenario, and ONLY in this scenario, end your response with the exact phrase: "WOULD_YOU_LIKE_A_TICKET?".
6.  Do NOT use the phrase "WOULD_YOU_LIKE_A_TICKET?" if you are providing a direct answer or general guidance.
7.  Be polite, patient, and professional. Avoid overly technical jargon unless necessary and explain it if used.
8.  If the user's query is very vague, ask clarifying questions.
9.  Do not make up information or promise actions you cannot perform.
10. Keep responses relatively brief and to the point.

Respond to the customer's latest message based on the conversation history.`,F=await kF(P,k);if(F.includes("WOULD_YOU_LIKE_A_TICKET?")){const O=F.replace("WOULD_YOU_LIKE_A_TICKET?","").trim();l(C=>[...C,{role:"assistant",text:O}]),v(!0)}else l(O=>[...O,{role:"assistant",text:F}])}catch(k){console.error("Chatbot API error:",k);const F="I'm currently experiencing some technical difficulties and can't respond right now. Please try again in a few moments. If the issue persists, you might want to report an issue directly through the portal.";l(O=>[...O,{role:"assistant",text:F}]),x("Failed to get response from assistant.")}finally{p(!1)}},N=()=>{var P;const U=o.slice(-5).map(k=>`${k.role==="user"?t.displayName||"You":"Agie"}: ${k.text}`).join(`

`);localStorage.setItem("chatbotIssueDescription",`Issue raised via Chatbot Agie:

${U}

Initial User Query (if available):
${((P=o.find(k=>k.role==="user"))==null?void 0:P.text)||"User initiated ticket creation from chat."}`),localStorage.setItem("chatbotIssueTypeSuggestion","Chatbot Assistance Follow-up"),e(),i&&i("reportIssue"),n("Please review and submit the support ticket drafted from your chat.","success")},R=["How to pay my bill?","Report a water leak.","My water pressure is low.","What are current announcements?"],I=j=>{f(j)};return c.jsxs(Vr,{isOpen:r,onClose:e,title:"Chat with Agie - Your AGWA Assistant",size:"lg",children:[c.jsx("style",{children:`
                .animate-message-appear {
                    animation: message-appear 0.3s ease-out forwards;
                }
                @keyframes message-appear {
                    from { opacity: 0; transform: translateY(10px) scale(0.98); }
                    to { opacity: 1; transform: translateY(0) scale(1); }
                }
                .chatbot-input-shadow {
                    box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
                }
            `}),c.jsxs("div",{className:"flex flex-col h-[65vh] sm:h-[70vh] bg-gray-50",children:[c.jsxs("div",{ref:b,className:"flex-grow p-4 space-y-4 overflow-y-auto",children:[o.map((j,U)=>{var P;return c.jsxs("div",{className:`flex items-end animate-message-appear ${j.role==="user"?"justify-end":"justify-start"}`,children:[j.role==="assistant"&&c.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-2",children:c.jsx(Ds,{size:18})}),c.jsx("div",{className:`max-w-[75%] p-3 rounded-2xl shadow-sm ${j.role==="user"?"bg-blue-600 text-white rounded-br-none":"bg-white text-gray-800 border border-gray-200 rounded-bl-none"}`,children:c.jsx("p",{className:"text-sm whitespace-pre-wrap",children:j.text})}),j.role==="user"&&c.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-gray-300 text-gray-600 flex items-center justify-center ml-2 uppercase",children:((P=t==null?void 0:t.displayName)==null?void 0:P.charAt(0))||"U"})]},U)}),m&&c.jsxs("div",{className:"flex items-end justify-start animate-message-appear",children:[c.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-2",children:c.jsx(Ds,{size:18})}),c.jsx("div",{className:"max-w-[75%] p-3 rounded-2xl shadow-sm bg-white text-gray-800 border border-gray-200 rounded-bl-none",children:c.jsx(ln,{size:"h-5 w-5",color:"text-blue-500",message:""})})]}),E&&c.jsxs("div",{className:"flex items-center justify-center p-3 bg-red-50 text-red-700 rounded-lg animate-message-appear",children:[c.jsx(Zt,{size:20,className:"mr-2"}),c.jsx("p",{className:"text-sm",children:E})]})]}),g&&c.jsx("div",{className:"p-3 border-t border-gray-200 bg-white",children:c.jsxs("button",{onClick:N,className:"w-full flex items-center justify-center bg-green-600 hover:bg-green-700 text-white font-semibold py-2.5 px-4 rounded-lg transition-all duration-150 active:scale-95 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50",children:[c.jsx(nF,{size:20,className:"mr-2"})," Create Support Ticket from this Chat"]})}),!g&&o.length<=1&&c.jsx("div",{className:"p-2 border-t border-gray-200 bg-white flex flex-wrap gap-2 justify-center",children:R.map(j=>c.jsx("button",{onClick:()=>I(j),className:"text-xs bg-blue-100 text-blue-700 hover:bg-blue-200 px-3 py-1.5 rounded-full transition-colors",disabled:m,children:j},j))}),c.jsxs("form",{onSubmit:S,className:"p-3 border-t border-gray-200 flex items-center space-x-3 bg-white chatbot-input-shadow",children:[c.jsx("input",{type:"text",value:d,onChange:j=>f(j.target.value),placeholder:"Type your message to Agie...",className:"flex-grow px-4 py-2.5 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-shadow focus:shadow-md text-sm",disabled:m,"aria-label":"Chat input"}),c.jsx("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-xl disabled:opacity-60 disabled:cursor-not-allowed transition-all duration-150 active:scale-90 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50",disabled:m||!d.trim(),"aria-label":"Send message",children:c.jsx(l0,{size:20})})]})]})]})},NW=({isOpen:r,onLink:e,isLinking:t,error:n,onLogout:i})=>{const[s,o]=X.useState("");X.useEffect(()=>{r||o("")},[r]);const l=d=>{d.preventDefault(),s.trim()&&e(s.trim())};return c.jsx(Vr,{isOpen:r,onClose:()=>{},title:"Link Your AGWA Account",hideCloseButton:!0,size:"md",children:c.jsxs("form",{onSubmit:l,className:"space-y-5",children:[c.jsx("p",{className:"text-sm text-center text-gray-600",children:"To access services, please link your official AGWA account number. This is a one-time step for accounts created with Google or an Email Link."}),n&&c.jsx("div",{className:"text-center p-2 bg-red-100 text-red-700 rounded-md text-sm border border-red-200",children:n}),c.jsxs("div",{className:"relative",children:[c.jsx(js,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"AGWA Account Number (e.g., RES-12345)",value:s,onChange:d=>o(d.target.value),className:`${Fi} pl-11`,required:!0,disabled:t,"aria-label":"AGWA Account Number",autoFocus:!0})]}),c.jsxs("button",{type:"submit",className:um(t||!s.trim()),disabled:t||!s.trim(),children:[t?c.jsx(Tt,{className:"animate-spin inline mr-2",size:18}):c.jsx(L2,{className:"inline mr-2",size:18}),t?"Linking...":"Link My Account"]}),c.jsx("div",{className:"text-center mt-4",children:c.jsxs("button",{type:"button",onClick:i,className:"text-sm font-medium text-gray-500 hover:text-red-600 hover:underline",children:[c.jsx(a0,{size:14,className:"inline mr-1"})," Not you? Logout"]})})]})})},IW=({user:r,userData:e,setUserData:t,handleLogout:n,showNotification:i,auth:s,db:o})=>{const[l,d]=X.useState("mainDashboard"),[f,m]=X.useState(!1),[p,g]=X.useState(!1),[v,E]=X.useState(!1),[x,b]=X.useState(!1),[S,N]=X.useState(""),[R,I]=X.useState(null),[j,U]=X.useState({});X.useEffect(()=>{e&&!e.accountNumber&&e.role==="customer"?E(!0):E(!1)},[e]),X.useEffect(()=>{if(!o)return;const D=Lt(o,Qd()),$=Dx(D,K=>{if(K.exists()){const ee=K.data();U(ee),ee.isBannerEnabled&&ee.portalAnnouncement?I({text:ee.portalAnnouncement}):I(null)}else I(null),U({})},K=>{console.error("Error fetching system settings:",K),I(null),U({})});return()=>$()},[o]);const P=X.useCallback(D=>{d(D),f&&m(!1)},[f]),k=async D=>{b(!0),N("");const $=await n9(o,r.uid,D);if($.success){const K=await I2(o,r.uid);K.success?(t(K.data),E(!1),i("Account linked successfully!","success")):(N("Account linked, but failed to refresh profile. Please reload."),i("Account linked, but failed to refresh profile.","warning"))}else N($.error||"Failed linking account. Check number or contact support.");b(!1)},F={customer:[{name:"Dashboard",iconName:"Home",section:"mainDashboard",group:"Main"},{name:"My Profile",iconName:"UserCog",section:"myProfile",group:"Account"},{name:"My Bills & Payments",iconName:"FileText",section:"myBills",group:"Account"},{name:"Consumption Analytics",iconName:"TrendingUp",section:"waterAnalytics",group:"Account"},{name:"Payment Analytics",iconName:"CreditCard",section:"paymentAnalytics",group:"Account"},{name:"Rewards Program",iconName:"Gift",section:"rebateProgram",group:"Account"},{name:"My Support Tickets",iconName:"MessageSquare",section:"myTickets",group:"Support"},{name:"Report an Issue",iconName:"AlertTriangle",section:"reportIssue",group:"Support"},{name:"View Announcements",iconName:"Megaphone",section:"viewAnnouncements",group:"Information"},{name:"Service Advisories",iconName:"AlertIcon",section:"serviceAdvisories",group:"Information"},{name:"Interruption Map",iconName:"Map",section:"interruptionMap",group:"Information"},{name:"FAQs",iconName:"HelpCircle",section:"faqs",group:"Help & Info"},{name:"About Us",iconName:"Info",section:"aboutUs",group:"Help & Info"},{name:"Contact Us",iconName:"PhoneCall",section:"contactUs",group:"Help & Info"}],admin:[{name:"Dashboard",iconName:"Home",section:"mainDashboard",group:"Main"},{name:"System Analytics",iconName:"BarChart3",section:"systemAnalytics",group:"Main"},{name:"User Management",iconName:"Users",section:"userManagement",group:"Administration"},{name:"Support Tickets",iconName:"MessageSquare",section:"supportTickets",group:"Administration"},{name:"Manage Announcements",iconName:"Edit",section:"manageAnnouncements",group:"Administration"},{name:"Manage Interruptions",iconName:"AlertIcon",section:"manageInterruptions",group:"Administration"},{name:"System Settings",iconName:"Settings",section:"systemSettings",group:"Administration"},{name:"Batch Billing",iconName:"FileText",section:"batchBilling",group:"Operations"},{name:"Meter Reading Mgt.",iconName:"Gauge",section:"editMeterReadingsAdmin",group:"Operations"},{name:"Route Management",iconName:"Map",section:"routeManagement",group:"Operations"},{name:"My Profile",iconName:"UserCog",section:"myProfile",group:"Account"},{name:"Interruption Map",iconName:"Map",section:"interruptionMap",group:"Information"},{name:"FAQs",iconName:"HelpCircle",section:"faqs",group:"Help & Info"},{name:"About Us",iconName:"Info",section:"aboutUs",group:"Help & Info"},{name:"Contact Us",iconName:"PhoneCall",section:"contactUs",group:"Help & Info"}],meter_reader:[{name:"Dashboard",iconName:"Home",section:"mainDashboard",group:"Main"},{name:"Assigned Routes",iconName:"Map",section:"assignedRoutes",group:"Operations"},{name:"Submit Reading",iconName:"ClipboardEdit",section:"searchAndSubmitReading",group:"Operations"},{name:"Search Customer",iconName:"Search",section:"searchCustomerMeterReader",group:"Operations"},{name:"My Profile",iconName:"UserCog",section:"myProfile",group:"Account"},{name:"My Support Tickets",iconName:"MessageSquare",section:"myTickets",group:"Support"},{name:"Report an Issue",iconName:"AlertTriangle",section:"reportIssue",group:"Support"},{name:"View Announcements",iconName:"Megaphone",section:"viewAnnouncements",group:"Information"},{name:"Service Advisories",iconName:"AlertIcon",section:"serviceAdvisories",group:"Information"},{name:"Interruption Map",iconName:"Map",section:"interruptionMap",group:"Information"},{name:"FAQs",iconName:"HelpCircle",section:"faqs",group:"Help & Info"},{name:"Contact Us",iconName:"PhoneCall",section:"contactUs",group:"Help & Info"}],clerk_cashier:[{name:"Dashboard",iconName:"Home",section:"mainDashboard",group:"Main"},{name:"Process Walk-in Payment",iconName:"Banknote",section:"walkInPayments",group:"Operations"},{name:"Search Account / Bill",iconName:"FileSearch",section:"searchAccountOrBill",group:"Operations"},{name:"My Profile",iconName:"UserCog",section:"myProfile",group:"Account"},{name:"My Support Tickets",iconName:"MessageSquare",section:"myTickets",group:"Support"},{name:"Report an Issue",iconName:"AlertTriangle",section:"reportIssue",group:"Support"},{name:"View Announcements",iconName:"Megaphone",section:"viewAnnouncements",group:"Information"},{name:"Service Advisories",iconName:"AlertIcon",section:"serviceAdvisories",group:"Information"},{name:"Interruption Map",iconName:"Map",section:"interruptionMap",group:"Information"},{name:"FAQs",iconName:"HelpCircle",section:"faqs",group:"Help & Info"},{name:"Contact Us",iconName:"PhoneCall",section:"contactUs",group:"Help & Info"}]},O=F[e.role]||F.customer,C=()=>{const D={user:r,userData:e,setUserData:t,auth:s,db:o,showNotification:i,billingService:XC,determineServiceTypeAndRole:A2,setActiveSection:P,systemSettings:j};if(!e||e.role==="customer"&&!e.accountNumber)return null;switch(l){case"mainDashboard":if(e.role==="customer")return c.jsx(jF,{...D});if(e.role==="admin")return c.jsx(eH,{...D});if(e.role==="meter_reader")return c.jsx(Y$,{...D});if(e.role==="clerk_cashier")return c.jsx(eW,{...D});break;case"myProfile":return c.jsx($q,{...D});case"reportIssue":return c.jsx(Kq,{...D});case"faqs":return c.jsx(Zq,{...D});case"aboutUs":return c.jsx(Qq,{...D});case"contactUs":return c.jsx(Jq,{...D});case"viewAnnouncements":return c.jsx(E4,{...D,viewOnly:!0});case"serviceAdvisories":return c.jsx(SW,{...D});case"interruptionMap":return c.jsx(TW,{...D});case"myBills":if(e.role==="customer")return c.jsx(vV,{...D});break;case"waterAnalytics":if(e.role==="customer")return c.jsx(zq,{...D});break;case"paymentAnalytics":if(e.role==="customer")return c.jsx(Uq,{...D});break;case"rebateProgram":if(e.role==="customer")return c.jsx(qq,{...D});break;case"myTickets":if(["customer","clerk_cashier","meter_reader"].includes(e.role))return c.jsx(rW,{...D});break;case"userManagement":if(e.role==="admin")return c.jsx(hH,{...D});break;case"batchBilling":if(e.role==="admin")return c.jsx(K$,{...D});break;case"routeManagement":if(e.role==="admin")return c.jsx(G$,{...D});break;case"supportTickets":if(e.role==="admin")return c.jsx(D$,{...D});break;case"manageAnnouncements":if(e.role==="admin")return c.jsx(E4,{...D,viewOnly:!1});break;case"manageInterruptions":if(e.role==="admin")return c.jsx(z$,{...D});break;case"systemAnalytics":if(e.role==="admin")return c.jsx(q$,{...D});break;case"editMeterReadingsAdmin":if(e.role==="admin")return c.jsx($$,{...D});break;case"systemSettings":if(e.role==="admin")return c.jsx(L$,{...D});break;case"assignedRoutes":if(e.role==="meter_reader")return c.jsx(Q$,{...D});break;case"searchAndSubmitReading":if(e.role==="meter_reader")return c.jsx(DR,{...D});break;case"searchCustomerMeterReader":if(e.role==="meter_reader")return c.jsx(J$,{...D});break;case"walkInPayments":if(e.role==="clerk_cashier")return c.jsx(tW,{...D});break;case"searchAccountOrBill":if(e.role==="clerk_cashier")return c.jsx(nW,{...D});break;default:return c.jsx(A4,{onNavigateHome:()=>P("mainDashboard")})}return c.jsx(A4,{onNavigateHome:()=>P("mainDashboard")})},M=l==="interruptionMap"?"p-0":"p-4 sm:p-6 lg:p-8";return c.jsxs("div",{className:"bg-gray-100 font-sans min-h-screen",children:[c.jsx(IF,{userData:e,navItems:O,activeSection:l,onNavigate:P,onLogout:n,isMobileOpen:f,setMobileOpen:m}),c.jsxs("div",{className:"lg:pl-64 flex flex-col min-h-screen",children:[c.jsxs("header",{className:"sticky top-0 z-30 flex items-center justify-between bg-white/80 backdrop-blur-lg shadow-sm p-3 lg:hidden",children:[c.jsx("button",{onClick:()=>m(!0),className:"text-gray-600 hover:text-gray-900 p-1",children:c.jsx(lF,{size:28})}),c.jsx("h1",{className:"text-lg font-semibold text-blue-700",children:"AGWA Water Services, Inc."}),c.jsx("div",{className:"w-8"})]}),R&&c.jsx("div",{className:"bg-yellow-400 text-center p-2 text-yellow-900 font-semibold shadow-md text-sm sticky top-[57px] z-20 lg:top-0",children:R.text}),c.jsx("main",{className:`${M} flex-grow ${R?"pt-2":""}`,children:C()})]}),e&&j.isChatbotEnabled&&c.jsxs(c.Fragment,{children:[c.jsx("button",{onClick:()=>g(!0),className:"fixed bottom-6 right-6 bg-blue-600 hover:bg-blue-700 text-white rounded-full p-4 shadow-lg transform hover:scale-110 transition-transform duration-200 ease-in-out z-40 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2","aria-label":"Open Chatbot",children:c.jsx(Oa,{size:28})}),p&&c.jsx(AW,{isOpen:p,onClose:()=>g(!1),userData:e,showNotification:i,setActiveDashboardSection:P})]}),e&&e.role==="customer"&&!e.accountNumber&&c.jsx(NW,{isOpen:v,onLink:k,isLinking:x,error:S,onLogout:n})]})},PW=()=>c.jsxs("div",{className:"min-h-screen bg-gray-900 text-white flex flex-col justify-center items-center p-4 text-center",children:[c.jsx(iF,{size:64,className:"text-yellow-400 mb-4 animate-bounce"}),c.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Under Maintenance"}),c.jsx("p",{className:"text-gray-400",children:"The AGWA portal is currently undergoing maintenance."}),c.jsx("p",{className:"text-gray-400",children:"We expect to be back online shortly."})]}),kW=({error:r,onLogout:e})=>c.jsxs("div",{className:"min-h-screen bg-red-50 flex flex-col justify-center items-center p-4 text-center",children:[c.jsx(Zt,{size:48,className:"text-red-500 mb-4"}),c.jsx("h1",{className:"text-2xl font-bold text-red-700 mb-2",children:"Application Error"}),c.jsx("p",{className:"text-gray-700 mb-4 max-w-md",children:"An error occurred while loading your data:"}),c.jsx("p",{className:"text-sm text-red-600 bg-red-100 p-3 rounded mb-4 max-w-xl text-left font-mono break-words",children:r}),c.jsx("p",{className:"text-gray-600 mb-4",children:"Please try refreshing the page. If the problem persists, contact support."}),e&&c.jsxs("button",{onClick:e,className:"mt-4 flex items-center justify-center px-5 py-2.5 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg shadow",children:[c.jsx(a0,{size:16,className:"mr-2"}),"Logout and Try Again"]})]}),CW=()=>{const[r,e]=X.useState("initializing"),[t,n]=X.useState(null),[i,s]=X.useState(null),[o,l]=X.useState(null),[d,f]=X.useState(null),[m,p]=X.useState(null),[g,v]=X.useState(!1),[E,x]=X.useState(""),[b,S]=X.useState("login"),[N,R]=X.useState({message:"",type:""}),I=X.useCallback(($,K="info")=>{R({message:$,type:K}),setTimeout(()=>R({message:"",type:""}),5e3)},[]),j=X.useCallback(()=>R({message:"",type:""}),[]);X.useEffect(()=>{const $=Lt(Yt,Qd()),K=Dx($,ie=>{f(ie.exists()?ie.data():{maintenanceMode:!1}),p(null)},ie=>{console.error("Critical Error: Failed to fetch system settings:",ie),p(`Failed to load config: ${ie.message}. Maintenance mode assumed off.`),f({maintenanceMode:!1})});let ee=()=>{};const se=EO(Yh,async ie=>{if(ee(),l(null),s(null),n(ie),ie){e("loading_profile");const re=Lt(Yt,Ln(),ie.uid);ee=Dx(re,async G=>{if(G.exists())s({id:G.id,...G.data()}),e("app_ready");else try{const z=await Na(Lt(Yt,Uo(ie.uid)));if(z.exists()){s({id:z.id,...z.data()}),e("app_ready");return}const Z=ie.providerData.some(le=>le.providerId==="password");let J;if(Z){const le=localStorage.getItem("signupDisplayName")||ie.email||"New User",Q=localStorage.getItem("signupAccountNumber")||"";localStorage.removeItem("signupDisplayName"),localStorage.removeItem("signupAccountNumber");const{role:ce,serviceType:ue}=A2(Q);J={email:ie.email||"",phoneNumber:ie.phoneNumber||"",displayName:le,accountNumber:Q,role:ce,serviceType:ue,accountStatus:"Active",photoURL:ie.photoURL||""}}else J={email:ie.email||"",phoneNumber:ie.phoneNumber||"",displayName:ie.displayName||ie.email||"New User",accountNumber:"",role:"customer",serviceType:"Residential",accountStatus:"Active",photoURL:ie.photoURL||""};const ae=await p9(Yt,ie.uid,J);if(!ae.success)throw new Error(ae.error||"Failed to auto-create user profile.")}catch(z){console.error("Profile creation/snapshot error:",z),l(`Profile Error: ${z.message}`),e("error"),s(null)}},G=>{console.error("Profile listener error:",G),l(`Profile Listener Error: ${G.message}`),e("error"),s(null)})}else e("auth_required"),S("login")});return()=>{se(),K(),ee()}},[]);const U=X.useCallback($=>{x(""),S($)},[]),P=async($,...K)=>{v(!0),x("");let ee={success:!1,error:"An unexpected error occurred."};try{ee=await $(Yh,...K),!ee.success&&ee.error&&x(ee.error)}catch(se){const ie=gc(se);x(ie),ee={success:!1,error:ie}}finally{v(!1)}return ee},k=($,K)=>P(L8,$,K),F=()=>P(F8),O=async()=>{e("initializing"),await P(U8)},C=async($,K,ee,se)=>{localStorage.setItem("signupDisplayName",ee),localStorage.setItem("signupAccountNumber",se),await P(M8,$,K)},M=async $=>{const K=await P(z8,$);return K.success&&I(K.message||"Password reset email sent!","success"),K.success},D=async $=>{const K={url:window.location.origin,handleCodeInApp:!0},ee=await P(V8,$,K);return ee.success&&I(ee.message||`Sign-in link sent to ${$}!`,"success"),ee};if(X.useEffect(()=>{(async()=>{if(!Yh)return;const K=window.location.href;if(mP(Yh,K)){let ee=window.localStorage.getItem("emailForSignIn");ee||(ee=window.prompt("Confirm your email for sign-in:")),ee?(e("initializing"),await P(B8,ee,K),window.history.replaceState(null,"",window.location.origin)):(I("Email required for link sign-in.","error"),window.history.replaceState(null,"",window.location.origin),e("auth_required"))}})()},[P,I]),r==="initializing"||r==="loading_profile"){const $=r==="initializing"?"Initializing Session...":"Loading Profile...";return c.jsx(sA,{loadingMessage:$})}if(r==="error")return c.jsx(kW,{error:o||m||"Unknown application error.",onLogout:O});if(r==="app_ready"&&t&&i)return d!=null&&d.maintenanceMode&&(i==null?void 0:i.role)!=="admin"?c.jsx(PW,{}):c.jsxs(c.Fragment,{children:[c.jsx(IW,{user:t,userData:i,setUserData:s,handleLogout:O,showNotification:I,auth:Yh,db:Yt}),c.jsx(Bx,{message:N.message,type:N.type,onClose:j})]});if(r==="auth_required"){const $=d||{maintenanceMode:!1},K={login:c.jsx(EF,{handleLoginExternal:k,handleGoogleSignIn:F,navigateTo:U,authActionLoading:g,setAuthError:x,systemSettings:$}),signup:c.jsx(SF,{handleSignupExternal:C,handleGoogleSignIn:F,navigateTo:U,authActionLoading:g,setAuthError:x,showNotification:I,systemSettings:$}),forgotPassword:c.jsx(TF,{handleForgotPasswordExternal:M,navigateTo:U,authActionLoading:g}),passwordlessLogin:c.jsx(AF,{handlePasswordlessSignInExternal:D,navigateTo:U,authActionLoading:g})};return c.jsxs(c.Fragment,{children:[c.jsx(y3,{authError:E||m,systemSettings:$,children:K[b]||K.login}),c.jsx(Bx,{message:N.message,type:N.type,onClose:j})]})}return c.jsx(sA,{loadingMessage:"Unexpected Application State"})};class RW extends ss.Component{constructor(t){super(t);nt(this,"handleRetry",()=>{this.setState({hasError:!1,error:null,errorInfo:null,errorId:Date.now()}),this.props.onRetry?this.props.onRetry():window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null,errorId:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,n){console.error("Uncaught error:",t,n),this.setState({errorInfo:n,errorId:Date.now()})}render(){var t,n;if(this.state.hasError){const{fallback:i}=this.props;return i&&typeof i=="function"?i({error:this.state.error,errorInfo:this.state.errorInfo,retry:this.handleRetry}):ss.isValidElement(i)?i:c.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen text-center p-6 bg-red-50",role:"alert",children:[c.jsx(c3,{size:48,className:"text-red-500 mb-4"}),c.jsx("h1",{className:"text-2xl font-bold text-red-700 mb-2",children:"Oops! Something went wrong."}),c.jsx("p",{className:"text-gray-700 mb-4 max-w-md",children:"We encountered an unexpected issue. Please try again. If the problem persists, contact support."}),c.jsxs("details",{className:"mb-4 p-3 bg-red-100 text-left text-xs text-red-800 rounded-md w-full max-w-2xl overflow-auto",children:[c.jsx("summary",{className:"font-semibold cursor-pointer",children:"Error Details"}),c.jsxs("pre",{className:"mt-2 whitespace-pre-wrap",children:[(t=this.state.error)==null?void 0:t.toString(),((n=this.state.errorInfo)==null?void 0:n.componentStack)&&`

Component Stack:
${this.state.errorInfo.componentStack}`]})]}),c.jsxs("button",{onClick:this.handleRetry,className:"flex items-center justify-center px-5 py-2.5 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg shadow hover:shadow-md transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50",children:[c.jsx(hF,{size:16,className:"mr-2"}),"Try Again"]}),this.props.showSupportInfo&&c.jsxs("p",{className:"text-xs text-gray-500 mt-6",children:["Error ID: ",this.state.errorId||"N/A",". Please include this ID if you contact support."]})]})}return this.props.children}}M5.createRoot(document.getElementById("root")).render(c.jsx(ss.StrictMode,{children:c.jsx(RW,{children:c.jsx(CW,{})})}));
