var VR=Object.defineProperty;var zR=(n,e,t)=>e in n?VR(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var Je=(n,e,t)=>zR(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var yp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Px(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var dv={exports:{}},_h={},hv={exports:{}},Vt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sE;function BR(){if(sE)return Vt;sE=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),y=Symbol.iterator;function g(B){return B===null||typeof B!="object"?null:(B=y&&B[y]||B["@@iterator"],typeof B=="function"?B:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,x={};function w(B,Z,te){this.props=B,this.context=Z,this.refs=x,this.updater=te||_}w.prototype.isReactComponent={},w.prototype.setState=function(B,Z){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,Z,"setState")},w.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function S(){}S.prototype=w.prototype;function N(B,Z,te){this.props=B,this.context=Z,this.refs=x,this.updater=te||_}var P=N.prototype=new S;P.constructor=N,E(P,w.prototype),P.isPureReactComponent=!0;var I=Array.isArray,R=Object.prototype.hasOwnProperty,U={current:null},j={key:!0,ref:!0,__self:!0,__source:!0};function k(B,Z,te){var se,ae={},Q=null,ce=null;if(Z!=null)for(se in Z.ref!==void 0&&(ce=Z.ref),Z.key!==void 0&&(Q=""+Z.key),Z)R.call(Z,se)&&!j.hasOwnProperty(se)&&(ae[se]=Z[se]);var me=arguments.length-2;if(me===1)ae.children=te;else if(1<me){for(var ge=Array(me),Ae=0;Ae<me;Ae++)ge[Ae]=arguments[Ae+2];ae.children=ge}if(B&&B.defaultProps)for(se in me=B.defaultProps,me)ae[se]===void 0&&(ae[se]=me[se]);return{$$typeof:n,type:B,key:Q,ref:ce,props:ae,_owner:U.current}}function F(B,Z){return{$$typeof:n,type:B.type,key:Z,ref:B.ref,props:B.props,_owner:B._owner}}function O(B){return typeof B=="object"&&B!==null&&B.$$typeof===n}function C(B){var Z={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(te){return Z[te]})}var D=/\/+/g;function M(B,Z){return typeof B=="object"&&B!==null&&B.key!=null?C(""+B.key):Z.toString(36)}function $(B,Z,te,se,ae){var Q=typeof B;(Q==="undefined"||Q==="boolean")&&(B=null);var ce=!1;if(B===null)ce=!0;else switch(Q){case"string":case"number":ce=!0;break;case"object":switch(B.$$typeof){case n:case e:ce=!0}}if(ce)return ce=B,ae=ae(ce),B=se===""?"."+M(ce,0):se,I(ae)?(te="",B!=null&&(te=B.replace(D,"$&/")+"/"),$(ae,Z,te,"",function(Ae){return Ae})):ae!=null&&(O(ae)&&(ae=F(ae,te+(!ae.key||ce&&ce.key===ae.key?"":(""+ae.key).replace(D,"$&/")+"/")+B)),Z.push(ae)),1;if(ce=0,se=se===""?".":se+":",I(B))for(var me=0;me<B.length;me++){Q=B[me];var ge=se+M(Q,me);ce+=$(Q,Z,te,ge,ae)}else if(ge=g(B),typeof ge=="function")for(B=ge.call(B),me=0;!(Q=B.next()).done;)Q=Q.value,ge=se+M(Q,me++),ce+=$(Q,Z,te,ge,ae);else if(Q==="object")throw Z=String(B),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.");return ce}function G(B,Z,te){if(B==null)return B;var se=[],ae=0;return $(B,se,"","",function(Q){return Z.call(te,Q,ae++)}),se}function re(B){if(B._status===-1){var Z=B._result;Z=Z(),Z.then(function(te){(B._status===0||B._status===-1)&&(B._status=1,B._result=te)},function(te){(B._status===0||B._status===-1)&&(B._status=2,B._result=te)}),B._status===-1&&(B._status=0,B._result=Z)}if(B._status===1)return B._result.default;throw B._result}var oe={current:null},ie={transition:null},X={ReactCurrentDispatcher:oe,ReactCurrentBatchConfig:ie,ReactCurrentOwner:U};function Y(){throw Error("act(...) is not supported in production builds of React.")}return Vt.Children={map:G,forEach:function(B,Z,te){G(B,function(){Z.apply(this,arguments)},te)},count:function(B){var Z=0;return G(B,function(){Z++}),Z},toArray:function(B){return G(B,function(Z){return Z})||[]},only:function(B){if(!O(B))throw Error("React.Children.only expected to receive a single React element child.");return B}},Vt.Component=w,Vt.Fragment=t,Vt.Profiler=i,Vt.PureComponent=N,Vt.StrictMode=r,Vt.Suspense=d,Vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=X,Vt.act=Y,Vt.cloneElement=function(B,Z,te){if(B==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+B+".");var se=E({},B.props),ae=B.key,Q=B.ref,ce=B._owner;if(Z!=null){if(Z.ref!==void 0&&(Q=Z.ref,ce=U.current),Z.key!==void 0&&(ae=""+Z.key),B.type&&B.type.defaultProps)var me=B.type.defaultProps;for(ge in Z)R.call(Z,ge)&&!j.hasOwnProperty(ge)&&(se[ge]=Z[ge]===void 0&&me!==void 0?me[ge]:Z[ge])}var ge=arguments.length-2;if(ge===1)se.children=te;else if(1<ge){me=Array(ge);for(var Ae=0;Ae<ge;Ae++)me[Ae]=arguments[Ae+2];se.children=me}return{$$typeof:n,type:B.type,key:ae,ref:Q,props:se,_owner:ce}},Vt.createContext=function(B){return B={$$typeof:o,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},B.Provider={$$typeof:s,_context:B},B.Consumer=B},Vt.createElement=k,Vt.createFactory=function(B){var Z=k.bind(null,B);return Z.type=B,Z},Vt.createRef=function(){return{current:null}},Vt.forwardRef=function(B){return{$$typeof:l,render:B}},Vt.isValidElement=O,Vt.lazy=function(B){return{$$typeof:m,_payload:{_status:-1,_result:B},_init:re}},Vt.memo=function(B,Z){return{$$typeof:f,type:B,compare:Z===void 0?null:Z}},Vt.startTransition=function(B){var Z=ie.transition;ie.transition={};try{B()}finally{ie.transition=Z}},Vt.unstable_act=Y,Vt.useCallback=function(B,Z){return oe.current.useCallback(B,Z)},Vt.useContext=function(B){return oe.current.useContext(B)},Vt.useDebugValue=function(){},Vt.useDeferredValue=function(B){return oe.current.useDeferredValue(B)},Vt.useEffect=function(B,Z){return oe.current.useEffect(B,Z)},Vt.useId=function(){return oe.current.useId()},Vt.useImperativeHandle=function(B,Z,te){return oe.current.useImperativeHandle(B,Z,te)},Vt.useInsertionEffect=function(B,Z){return oe.current.useInsertionEffect(B,Z)},Vt.useLayoutEffect=function(B,Z){return oe.current.useLayoutEffect(B,Z)},Vt.useMemo=function(B,Z){return oe.current.useMemo(B,Z)},Vt.useReducer=function(B,Z,te){return oe.current.useReducer(B,Z,te)},Vt.useRef=function(B){return oe.current.useRef(B)},Vt.useState=function(B){return oe.current.useState(B)},Vt.useSyncExternalStore=function(B,Z,te){return oe.current.useSyncExternalStore(B,Z,te)},Vt.useTransition=function(){return oe.current.useTransition()},Vt.version="18.3.1",Vt}var oE;function oy(){return oE||(oE=1,hv.exports=BR()),hv.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aE;function UR(){if(aE)return _h;aE=1;var n=oy(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,d,f){var m,y={},g=null,_=null;f!==void 0&&(g=""+f),d.key!==void 0&&(g=""+d.key),d.ref!==void 0&&(_=d.ref);for(m in d)r.call(d,m)&&!s.hasOwnProperty(m)&&(y[m]=d[m]);if(l&&l.defaultProps)for(m in d=l.defaultProps,d)y[m]===void 0&&(y[m]=d[m]);return{$$typeof:e,type:l,key:g,ref:_,props:y,_owner:i.current}}return _h.Fragment=t,_h.jsx=o,_h.jsxs=o,_h}var lE;function qR(){return lE||(lE=1,dv.exports=UR()),dv.exports}var u=qR(),ee=oy();const ts=Px(ee);var vp={},fv={exports:{}},ji={},mv={exports:{}},pv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cE;function HR(){return cE||(cE=1,function(n){function e(ie,X){var Y=ie.length;ie.push(X);e:for(;0<Y;){var B=Y-1>>>1,Z=ie[B];if(0<i(Z,X))ie[B]=X,ie[Y]=Z,Y=B;else break e}}function t(ie){return ie.length===0?null:ie[0]}function r(ie){if(ie.length===0)return null;var X=ie[0],Y=ie.pop();if(Y!==X){ie[0]=Y;e:for(var B=0,Z=ie.length,te=Z>>>1;B<te;){var se=2*(B+1)-1,ae=ie[se],Q=se+1,ce=ie[Q];if(0>i(ae,Y))Q<Z&&0>i(ce,ae)?(ie[B]=ce,ie[Q]=Y,B=Q):(ie[B]=ae,ie[se]=Y,B=se);else if(Q<Z&&0>i(ce,Y))ie[B]=ce,ie[Q]=Y,B=Q;else break e}}return X}function i(ie,X){var Y=ie.sortIndex-X.sortIndex;return Y!==0?Y:ie.id-X.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;n.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var d=[],f=[],m=1,y=null,g=3,_=!1,E=!1,x=!1,w=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function P(ie){for(var X=t(f);X!==null;){if(X.callback===null)r(f);else if(X.startTime<=ie)r(f),X.sortIndex=X.expirationTime,e(d,X);else break;X=t(f)}}function I(ie){if(x=!1,P(ie),!E)if(t(d)!==null)E=!0,re(R);else{var X=t(f);X!==null&&oe(I,X.startTime-ie)}}function R(ie,X){E=!1,x&&(x=!1,S(k),k=-1),_=!0;var Y=g;try{for(P(X),y=t(d);y!==null&&(!(y.expirationTime>X)||ie&&!C());){var B=y.callback;if(typeof B=="function"){y.callback=null,g=y.priorityLevel;var Z=B(y.expirationTime<=X);X=n.unstable_now(),typeof Z=="function"?y.callback=Z:y===t(d)&&r(d),P(X)}else r(d);y=t(d)}if(y!==null)var te=!0;else{var se=t(f);se!==null&&oe(I,se.startTime-X),te=!1}return te}finally{y=null,g=Y,_=!1}}var U=!1,j=null,k=-1,F=5,O=-1;function C(){return!(n.unstable_now()-O<F)}function D(){if(j!==null){var ie=n.unstable_now();O=ie;var X=!0;try{X=j(!0,ie)}finally{X?M():(U=!1,j=null)}}else U=!1}var M;if(typeof N=="function")M=function(){N(D)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,G=$.port2;$.port1.onmessage=D,M=function(){G.postMessage(null)}}else M=function(){w(D,0)};function re(ie){j=ie,U||(U=!0,M())}function oe(ie,X){k=w(function(){ie(n.unstable_now())},X)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(ie){ie.callback=null},n.unstable_continueExecution=function(){E||_||(E=!0,re(R))},n.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<ie?Math.floor(1e3/ie):5},n.unstable_getCurrentPriorityLevel=function(){return g},n.unstable_getFirstCallbackNode=function(){return t(d)},n.unstable_next=function(ie){switch(g){case 1:case 2:case 3:var X=3;break;default:X=g}var Y=g;g=X;try{return ie()}finally{g=Y}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(ie,X){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var Y=g;g=ie;try{return X()}finally{g=Y}},n.unstable_scheduleCallback=function(ie,X,Y){var B=n.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?B+Y:B):Y=B,ie){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=Y+Z,ie={id:m++,callback:X,priorityLevel:ie,startTime:Y,expirationTime:Z,sortIndex:-1},Y>B?(ie.sortIndex=Y,e(f,ie),t(d)===null&&ie===t(f)&&(x?(S(k),k=-1):x=!0,oe(I,Y-B))):(ie.sortIndex=Z,e(d,ie),E||_||(E=!0,re(R))),ie},n.unstable_shouldYield=C,n.unstable_wrapCallback=function(ie){var X=g;return function(){var Y=g;g=X;try{return ie.apply(this,arguments)}finally{g=Y}}}}(pv)),pv}var uE;function $R(){return uE||(uE=1,mv.exports=HR()),mv.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dE;function WR(){if(dE)return ji;dE=1;var n=oy(),e=$R();function t(a){for(var h="https://reactjs.org/docs/error-decoder.html?invariant="+a,v=1;v<arguments.length;v++)h+="&args[]="+encodeURIComponent(arguments[v]);return"Minified React error #"+a+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,i={};function s(a,h){o(a,h),o(a+"Capture",h)}function o(a,h){for(i[a]=h,a=0;a<h.length;a++)r.add(h[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},y={};function g(a){return d.call(y,a)?!0:d.call(m,a)?!1:f.test(a)?y[a]=!0:(m[a]=!0,!1)}function _(a,h,v,A){if(v!==null&&v.type===0)return!1;switch(typeof h){case"function":case"symbol":return!0;case"boolean":return A?!1:v!==null?!v.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function E(a,h,v,A){if(h===null||typeof h>"u"||_(a,h,v,A))return!0;if(A)return!1;if(v!==null)switch(v.type){case 3:return!h;case 4:return h===!1;case 5:return isNaN(h);case 6:return isNaN(h)||1>h}return!1}function x(a,h,v,A,z,H,J){this.acceptsBooleans=h===2||h===3||h===4,this.attributeName=A,this.attributeNamespace=z,this.mustUseProperty=v,this.propertyName=a,this.type=h,this.sanitizeURL=H,this.removeEmptyString=J}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){w[a]=new x(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var h=a[0];w[h]=new x(h,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){w[a]=new x(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){w[a]=new x(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){w[a]=new x(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){w[a]=new x(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){w[a]=new x(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){w[a]=new x(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){w[a]=new x(a,5,!1,a.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function N(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var h=a.replace(S,N);w[h]=new x(h,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var h=a.replace(S,N);w[h]=new x(h,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var h=a.replace(S,N);w[h]=new x(h,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){w[a]=new x(a,1,!1,a.toLowerCase(),null,!1,!1)}),w.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){w[a]=new x(a,1,!1,a.toLowerCase(),null,!0,!0)});function P(a,h,v,A){var z=w.hasOwnProperty(h)?w[h]:null;(z!==null?z.type!==0:A||!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(E(h,v,z,A)&&(v=null),A||z===null?g(h)&&(v===null?a.removeAttribute(h):a.setAttribute(h,""+v)):z.mustUseProperty?a[z.propertyName]=v===null?z.type===3?!1:"":v:(h=z.attributeName,A=z.attributeNamespace,v===null?a.removeAttribute(h):(z=z.type,v=z===3||z===4&&v===!0?"":""+v,A?a.setAttributeNS(A,h,v):a.setAttribute(h,v))))}var I=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,R=Symbol.for("react.element"),U=Symbol.for("react.portal"),j=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),C=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),$=Symbol.for("react.suspense_list"),G=Symbol.for("react.memo"),re=Symbol.for("react.lazy"),oe=Symbol.for("react.offscreen"),ie=Symbol.iterator;function X(a){return a===null||typeof a!="object"?null:(a=ie&&a[ie]||a["@@iterator"],typeof a=="function"?a:null)}var Y=Object.assign,B;function Z(a){if(B===void 0)try{throw Error()}catch(v){var h=v.stack.trim().match(/\n( *(at )?)/);B=h&&h[1]||""}return`
`+B+a}var te=!1;function se(a,h){if(!a||te)return"";te=!0;var v=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(h)if(h=function(){throw Error()},Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(Ee){var A=Ee}Reflect.construct(a,[],h)}else{try{h.call()}catch(Ee){A=Ee}a.call(h.prototype)}else{try{throw Error()}catch(Ee){A=Ee}a()}}catch(Ee){if(Ee&&A&&typeof Ee.stack=="string"){for(var z=Ee.stack.split(`
`),H=A.stack.split(`
`),J=z.length-1,ue=H.length-1;1<=J&&0<=ue&&z[J]!==H[ue];)ue--;for(;1<=J&&0<=ue;J--,ue--)if(z[J]!==H[ue]){if(J!==1||ue!==1)do if(J--,ue--,0>ue||z[J]!==H[ue]){var he=`
`+z[J].replace(" at new "," at ");return a.displayName&&he.includes("<anonymous>")&&(he=he.replace("<anonymous>",a.displayName)),he}while(1<=J&&0<=ue);break}}}finally{te=!1,Error.prepareStackTrace=v}return(a=a?a.displayName||a.name:"")?Z(a):""}function ae(a){switch(a.tag){case 5:return Z(a.type);case 16:return Z("Lazy");case 13:return Z("Suspense");case 19:return Z("SuspenseList");case 0:case 2:case 15:return a=se(a.type,!1),a;case 11:return a=se(a.type.render,!1),a;case 1:return a=se(a.type,!0),a;default:return""}}function Q(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case j:return"Fragment";case U:return"Portal";case F:return"Profiler";case k:return"StrictMode";case M:return"Suspense";case $:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case C:return(a.displayName||"Context")+".Consumer";case O:return(a._context.displayName||"Context")+".Provider";case D:var h=a.render;return a=a.displayName,a||(a=h.displayName||h.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case G:return h=a.displayName||null,h!==null?h:Q(a.type)||"Memo";case re:h=a._payload,a=a._init;try{return Q(a(h))}catch{}}return null}function ce(a){var h=a.type;switch(a.tag){case 24:return"Cache";case 9:return(h.displayName||"Context")+".Consumer";case 10:return(h._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=h.render,a=a.displayName||a.name||"",h.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return h;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Q(h);case 8:return h===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h}return null}function me(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function ge(a){var h=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function Ae(a){var h=ge(a)?"checked":"value",v=Object.getOwnPropertyDescriptor(a.constructor.prototype,h),A=""+a[h];if(!a.hasOwnProperty(h)&&typeof v<"u"&&typeof v.get=="function"&&typeof v.set=="function"){var z=v.get,H=v.set;return Object.defineProperty(a,h,{configurable:!0,get:function(){return z.call(this)},set:function(J){A=""+J,H.call(this,J)}}),Object.defineProperty(a,h,{enumerable:v.enumerable}),{getValue:function(){return A},setValue:function(J){A=""+J},stopTracking:function(){a._valueTracker=null,delete a[h]}}}}function Ve(a){a._valueTracker||(a._valueTracker=Ae(a))}function Ye(a){if(!a)return!1;var h=a._valueTracker;if(!h)return!0;var v=h.getValue(),A="";return a&&(A=ge(a)?a.checked?"true":"false":a.value),a=A,a!==v?(h.setValue(a),!0):!1}function Ge(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function ot(a,h){var v=h.checked;return Y({},h,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:v??a._wrapperState.initialChecked})}function nt(a,h){var v=h.defaultValue==null?"":h.defaultValue,A=h.checked!=null?h.checked:h.defaultChecked;v=me(h.value!=null?h.value:v),a._wrapperState={initialChecked:A,initialValue:v,controlled:h.type==="checkbox"||h.type==="radio"?h.checked!=null:h.value!=null}}function It(a,h){h=h.checked,h!=null&&P(a,"checked",h,!1)}function Gt(a,h){It(a,h);var v=me(h.value),A=h.type;if(v!=null)A==="number"?(v===0&&a.value===""||a.value!=v)&&(a.value=""+v):a.value!==""+v&&(a.value=""+v);else if(A==="submit"||A==="reset"){a.removeAttribute("value");return}h.hasOwnProperty("value")?Ne(a,h.type,v):h.hasOwnProperty("defaultValue")&&Ne(a,h.type,me(h.defaultValue)),h.checked==null&&h.defaultChecked!=null&&(a.defaultChecked=!!h.defaultChecked)}function Se(a,h,v){if(h.hasOwnProperty("value")||h.hasOwnProperty("defaultValue")){var A=h.type;if(!(A!=="submit"&&A!=="reset"||h.value!==void 0&&h.value!==null))return;h=""+a._wrapperState.initialValue,v||h===a.value||(a.value=h),a.defaultValue=h}v=a.name,v!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,v!==""&&(a.name=v)}function Ne(a,h,v){(h!=="number"||Ge(a.ownerDocument)!==a)&&(v==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+v&&(a.defaultValue=""+v))}var De=Array.isArray;function ze(a,h,v,A){if(a=a.options,h){h={};for(var z=0;z<v.length;z++)h["$"+v[z]]=!0;for(v=0;v<a.length;v++)z=h.hasOwnProperty("$"+a[v].value),a[v].selected!==z&&(a[v].selected=z),z&&A&&(a[v].defaultSelected=!0)}else{for(v=""+me(v),h=null,z=0;z<a.length;z++){if(a[z].value===v){a[z].selected=!0,A&&(a[z].defaultSelected=!0);return}h!==null||a[z].disabled||(h=a[z])}h!==null&&(h.selected=!0)}}function ke(a,h){if(h.dangerouslySetInnerHTML!=null)throw Error(t(91));return Y({},h,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function gt(a,h){var v=h.value;if(v==null){if(v=h.children,h=h.defaultValue,v!=null){if(h!=null)throw Error(t(92));if(De(v)){if(1<v.length)throw Error(t(93));v=v[0]}h=v}h==null&&(h=""),v=h}a._wrapperState={initialValue:me(v)}}function mt(a,h){var v=me(h.value),A=me(h.defaultValue);v!=null&&(v=""+v,v!==a.value&&(a.value=v),h.defaultValue==null&&a.defaultValue!==v&&(a.defaultValue=v)),A!=null&&(a.defaultValue=""+A)}function pt(a){var h=a.textContent;h===a._wrapperState.initialValue&&h!==""&&h!==null&&(a.value=h)}function Ct(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Mt(a,h){return a==null||a==="http://www.w3.org/1999/xhtml"?Ct(h):a==="http://www.w3.org/2000/svg"&&h==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var Dt,rs=function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(h,v,A,z){MSApp.execUnsafeLocalFunction(function(){return a(h,v,A,z)})}:a}(function(a,h){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=h;else{for(Dt=Dt||document.createElement("div"),Dt.innerHTML="<svg>"+h.valueOf().toString()+"</svg>",h=Dt.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;h.firstChild;)a.appendChild(h.firstChild)}});function Ht(a,h){if(h){var v=a.firstChild;if(v&&v===a.lastChild&&v.nodeType===3){v.nodeValue=h;return}}a.textContent=h}var On={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},is=["Webkit","ms","Moz","O"];Object.keys(On).forEach(function(a){is.forEach(function(h){h=h+a.charAt(0).toUpperCase()+a.substring(1),On[h]=On[a]})});function Vi(a,h,v){return h==null||typeof h=="boolean"||h===""?"":v||typeof h!="number"||h===0||On.hasOwnProperty(a)&&On[a]?(""+h).trim():h+"px"}function pi(a,h){a=a.style;for(var v in h)if(h.hasOwnProperty(v)){var A=v.indexOf("--")===0,z=Vi(v,h[v],A);v==="float"&&(v="cssFloat"),A?a.setProperty(v,z):a[v]=z}}var pr=Y({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gi(a,h){if(h){if(pr[a]&&(h.children!=null||h.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(h.dangerouslySetInnerHTML!=null){if(h.children!=null)throw Error(t(60));if(typeof h.dangerouslySetInnerHTML!="object"||!("__html"in h.dangerouslySetInnerHTML))throw Error(t(61))}if(h.style!=null&&typeof h.style!="object")throw Error(t(62))}}function ei(a,h){if(a.indexOf("-")===-1)return typeof h.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var zi=null;function ao(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var yi=null,Yn=null,ti=null;function vi(a){if(a=ta(a)){if(typeof yi!="function")throw Error(t(280));var h=a.stateNode;h&&(h=Pu(h),yi(a.stateNode,a.type,h))}}function _i(a){Yn?ti?ti.push(a):ti=[a]:Yn=a}function Fo(){if(Yn){var a=Yn,h=ti;if(ti=Yn=null,vi(a),h)for(a=0;a<h.length;a++)vi(h[a])}}function yn(a,h){return a(h)}function xi(){}var Bi=!1;function ss(a,h,v){if(Bi)return a(h,v);Bi=!0;try{return yn(a,h,v)}finally{Bi=!1,(Yn!==null||ti!==null)&&(xi(),Fo())}}function xn(a,h){var v=a.stateNode;if(v===null)return null;var A=Pu(v);if(A===null)return null;v=A[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(A=!A.disabled)||(a=a.type,A=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!A;break e;default:a=!1}if(a)return null;if(v&&typeof v!="function")throw Error(t(231,h,typeof v));return v}var Ls=!1;if(l)try{var Mr={};Object.defineProperty(Mr,"passive",{get:function(){Ls=!0}}),window.addEventListener("test",Mr,Mr),window.removeEventListener("test",Mr,Mr)}catch{Ls=!1}function Fs(a,h,v,A,z,H,J,ue,he){var Ee=Array.prototype.slice.call(arguments,3);try{h.apply(v,Ee)}catch(Re){this.onError(Re)}}var ln=!1,$e=null,Er=!1,Vs=null,lo={onError:function(a){ln=!0,$e=a}};function os(a,h,v,A,z,H,J,ue,he){ln=!1,$e=null,Fs.apply(lo,arguments)}function gr(a,h,v,A,z,H,J,ue,he){if(os.apply(this,arguments),ln){if(ln){var Ee=$e;ln=!1,$e=null}else throw Error(t(198));Er||(Er=!0,Vs=Ee)}}function Tr(a){var h=a,v=a;if(a.alternate)for(;h.return;)h=h.return;else{a=h;do h=a,(h.flags&4098)!==0&&(v=h.return),a=h.return;while(a)}return h.tag===3?v:null}function Sr(a){if(a.tag===13){var h=a.memoizedState;if(h===null&&(a=a.alternate,a!==null&&(h=a.memoizedState)),h!==null)return h.dehydrated}return null}function Ar(a){if(Tr(a)!==a)throw Error(t(188))}function Vo(a){var h=a.alternate;if(!h){if(h=Tr(a),h===null)throw Error(t(188));return h!==a?null:a}for(var v=a,A=h;;){var z=v.return;if(z===null)break;var H=z.alternate;if(H===null){if(A=z.return,A!==null){v=A;continue}break}if(z.child===H.child){for(H=z.child;H;){if(H===v)return Ar(z),a;if(H===A)return Ar(z),h;H=H.sibling}throw Error(t(188))}if(v.return!==A.return)v=z,A=H;else{for(var J=!1,ue=z.child;ue;){if(ue===v){J=!0,v=z,A=H;break}if(ue===A){J=!0,A=z,v=H;break}ue=ue.sibling}if(!J){for(ue=H.child;ue;){if(ue===v){J=!0,v=H,A=z;break}if(ue===A){J=!0,A=H,v=z;break}ue=ue.sibling}if(!J)throw Error(t(189))}}if(v.alternate!==A)throw Error(t(190))}if(v.tag!==3)throw Error(t(188));return v.stateNode.current===v?a:h}function zo(a){return a=Vo(a),a!==null?Qe(a):null}function Qe(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var h=Qe(a);if(h!==null)return h;a=a.sibling}return null}var fe=e.unstable_scheduleCallback,je=e.unstable_cancelCallback,Ke=e.unstable_shouldYield,Kt=e.unstable_requestPaint,Nt=e.unstable_now,bn=e.unstable_getCurrentPriorityLevel,kn=e.unstable_ImmediatePriority,Zn=e.unstable_UserBlockingPriority,$n=e.unstable_NormalPriority,Ui=e.unstable_LowPriority,vn=e.unstable_IdlePriority,qi=null,sr=null;function co(a){if(sr&&typeof sr.onCommitFiberRoot=="function")try{sr.onCommitFiberRoot(qi,a,void 0,(a.current.flags&128)===128)}catch{}}var vt=Math.clz32?Math.clz32:zs,cn=Math.log,Bo=Math.LN2;function zs(a){return a>>>=0,a===0?32:31-(cn(a)/Bo|0)|0}var Hi=64,uo=4194304;function yt(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function un(a,h){var v=a.pendingLanes;if(v===0)return 0;var A=0,z=a.suspendedLanes,H=a.pingedLanes,J=v&268435455;if(J!==0){var ue=J&~z;ue!==0?A=yt(ue):(H&=J,H!==0&&(A=yt(H)))}else J=v&~z,J!==0?A=yt(J):H!==0&&(A=yt(H));if(A===0)return 0;if(h!==0&&h!==A&&(h&z)===0&&(z=A&-A,H=h&-h,z>=H||z===16&&(H&4194240)!==0))return h;if((A&4)!==0&&(A|=v&16),h=a.entangledLanes,h!==0)for(a=a.entanglements,h&=A;0<h;)v=31-vt(h),z=1<<v,A|=a[v],h&=~z;return A}function oc(a,h){switch(a){case 1:case 2:case 4:return h+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bi(a,h){for(var v=a.suspendedLanes,A=a.pingedLanes,z=a.expirationTimes,H=a.pendingLanes;0<H;){var J=31-vt(H),ue=1<<J,he=z[J];he===-1?((ue&v)===0||(ue&A)!==0)&&(z[J]=oc(ue,h)):he<=h&&(a.expiredLanes|=ue),H&=~ue}}function En(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Uo(){var a=Hi;return Hi<<=1,(Hi&4194240)===0&&(Hi=64),a}function $i(a){for(var h=[],v=0;31>v;v++)h.push(a);return h}function Dr(a,h,v){a.pendingLanes|=h,h!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,h=31-vt(h),a[h]=v}function _t(a,h){var v=a.pendingLanes&~h;a.pendingLanes=h,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=h,a.mutableReadLanes&=h,a.entangledLanes&=h,h=a.entanglements;var A=a.eventTimes;for(a=a.expirationTimes;0<v;){var z=31-vt(v),H=1<<z;h[z]=0,A[z]=-1,a[z]=-1,v&=~H}}function Lr(a,h){var v=a.entangledLanes|=h;for(a=a.entanglements;v;){var A=31-vt(v),z=1<<A;z&h|a[A]&h&&(a[A]|=h),v&=~z}}var Rt=0;function wi(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var La,as,Fa,Va,qo,Ho=!1,Ei=[],Vn=null,Ti=null,ni=null,ho=new Map,lt=new Map,Wn=[],nn="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function ac(a,h){switch(a){case"focusin":case"focusout":Vn=null;break;case"dragenter":case"dragleave":Ti=null;break;case"mouseover":case"mouseout":ni=null;break;case"pointerover":case"pointerout":ho.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":lt.delete(h.pointerId)}}function yr(a,h,v,A,z,H){return a===null||a.nativeEvent!==H?(a={blockedOn:h,domEventName:v,eventSystemFlags:A,nativeEvent:H,targetContainers:[z]},h!==null&&(h=ta(h),h!==null&&as(h)),a):(a.eventSystemFlags|=A,h=a.targetContainers,z!==null&&h.indexOf(z)===-1&&h.push(z),a)}function lc(a,h,v,A,z){switch(h){case"focusin":return Vn=yr(Vn,a,h,v,A,z),!0;case"dragenter":return Ti=yr(Ti,a,h,v,A,z),!0;case"mouseover":return ni=yr(ni,a,h,v,A,z),!0;case"pointerover":var H=z.pointerId;return ho.set(H,yr(ho.get(H)||null,a,h,v,A,z)),!0;case"gotpointercapture":return H=z.pointerId,lt.set(H,yr(lt.get(H)||null,a,h,v,A,z)),!0}return!1}function za(a){var h=ea(a.target);if(h!==null){var v=Tr(h);if(v!==null){if(h=v.tag,h===13){if(h=Sr(v),h!==null){a.blockedOn=h,qo(a.priority,function(){Fa(v)});return}}else if(h===3&&v.stateNode.current.memoizedState.isDehydrated){a.blockedOn=v.tag===3?v.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Nr(a){if(a.blockedOn!==null)return!1;for(var h=a.targetContainers;0<h.length;){var v=Go(a.domEventName,a.eventSystemFlags,h[0],a.nativeEvent);if(v===null){v=a.nativeEvent;var A=new v.constructor(v.type,v);zi=A,v.target.dispatchEvent(A),zi=null}else return h=ta(v),h!==null&&as(h),a.blockedOn=v,!1;h.shift()}return!0}function Bs(a,h,v){Nr(a)&&v.delete(h)}function fo(){Ho=!1,Vn!==null&&Nr(Vn)&&(Vn=null),Ti!==null&&Nr(Ti)&&(Ti=null),ni!==null&&Nr(ni)&&(ni=null),ho.forEach(Bs),lt.forEach(Bs)}function dn(a,h){a.blockedOn===h&&(a.blockedOn=null,Ho||(Ho=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,fo)))}function or(a){function h(z){return dn(z,a)}if(0<Ei.length){dn(Ei[0],a);for(var v=1;v<Ei.length;v++){var A=Ei[v];A.blockedOn===a&&(A.blockedOn=null)}}for(Vn!==null&&dn(Vn,a),Ti!==null&&dn(Ti,a),ni!==null&&dn(ni,a),ho.forEach(h),lt.forEach(h),v=0;v<Wn.length;v++)A=Wn[v],A.blockedOn===a&&(A.blockedOn=null);for(;0<Wn.length&&(v=Wn[0],v.blockedOn===null);)za(v),v.blockedOn===null&&Wn.shift()}var ls=I.ReactCurrentBatchConfig,Us=!0;function Tn(a,h,v,A){var z=Rt,H=ls.transition;ls.transition=null;try{Rt=1,$o(a,h,v,A)}finally{Rt=z,ls.transition=H}}function yu(a,h,v,A){var z=Rt,H=ls.transition;ls.transition=null;try{Rt=4,$o(a,h,v,A)}finally{Rt=z,ls.transition=H}}function $o(a,h,v,A){if(Us){var z=Go(a,h,v,A);if(z===null)c(a,h,A,Wo,v),ac(a,A);else if(lc(z,a,h,v,A))A.stopPropagation();else if(ac(a,A),h&4&&-1<nn.indexOf(a)){for(;z!==null;){var H=ta(z);if(H!==null&&La(H),H=Go(a,h,v,A),H===null&&c(a,h,A,Wo,v),H===z)break;z=H}z!==null&&A.stopPropagation()}else c(a,h,A,null,v)}}var Wo=null;function Go(a,h,v,A){if(Wo=null,a=ao(A),a=ea(a),a!==null)if(h=Tr(a),h===null)a=null;else if(v=h.tag,v===13){if(a=Sr(h),a!==null)return a;a=null}else if(v===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;a=null}else h!==a&&(a=null);return Wo=a,null}function jt(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(bn()){case kn:return 1;case Zn:return 4;case $n:case Ui:return 16;case vn:return 536870912;default:return 16}default:return 16}}var ri=null,vr=null,Qn=null;function Ba(){if(Qn)return Qn;var a,h=vr,v=h.length,A,z="value"in ri?ri.value:ri.textContent,H=z.length;for(a=0;a<v&&h[a]===z[a];a++);var J=v-a;for(A=1;A<=J&&h[v-A]===z[H-A];A++);return Qn=z.slice(a,1<A?1-A:void 0)}function Ua(a){var h=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&h===13&&(a=13)):a=h,a===10&&(a=13),32<=a||a===13?a:0}function Si(){return!0}function cc(){return!1}function Xn(a){function h(v,A,z,H,J){this._reactName=v,this._targetInst=z,this.type=A,this.nativeEvent=H,this.target=J,this.currentTarget=null;for(var ue in a)a.hasOwnProperty(ue)&&(v=a[ue],this[ue]=v?v(H):H[ue]);return this.isDefaultPrevented=(H.defaultPrevented!=null?H.defaultPrevented:H.returnValue===!1)?Si:cc,this.isPropagationStopped=cc,this}return Y(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var v=this.nativeEvent;v&&(v.preventDefault?v.preventDefault():typeof v.returnValue!="unknown"&&(v.returnValue=!1),this.isDefaultPrevented=Si)},stopPropagation:function(){var v=this.nativeEvent;v&&(v.stopPropagation?v.stopPropagation():typeof v.cancelBubble!="unknown"&&(v.cancelBubble=!0),this.isPropagationStopped=Si)},persist:function(){},isPersistent:Si}),h}var Wi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qa=Xn(Wi),Ai=Y({},Wi,{view:0,detail:0}),Wd=Xn(Ai),Ir,qs,Hs,Fr=Y({},Ai,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Vr,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Hs&&(Hs&&a.type==="mousemove"?(Ir=a.screenX-Hs.screenX,qs=a.screenY-Hs.screenY):qs=Ir=0,Hs=a),Ir)},movementY:function(a){return"movementY"in a?a.movementY:qs}}),Ko=Xn(Fr),Ha=Y({},Fr,{dataTransfer:0}),$a=Xn(Ha),Wa=Y({},Ai,{relatedTarget:0}),Yo=Xn(Wa),uc=Y({},Wi,{animationName:0,elapsedTime:0,pseudoElement:0}),$s=Xn(uc),vu=Y({},Wi,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Ga=Xn(vu),_u=Y({},Wi,{data:0}),Ka=Xn(_u),Zo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Jn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cs={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xu(a){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(a):(a=cs[a])?!!h[a]:!1}function Vr(){return xu}var b=Y({},Ai,{key:function(a){if(a.key){var h=Zo[a.key]||a.key;if(h!=="Unidentified")return h}return a.type==="keypress"?(a=Ua(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?Jn[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Vr,charCode:function(a){return a.type==="keypress"?Ua(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Ua(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),q=Xn(b),K=Y({},Fr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),le=Xn(K),ye=Y({},Ai,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Vr}),Te=Xn(ye),Be=Y({},Wi,{propertyName:0,elapsedTime:0,pseudoElement:0}),tn=Xn(Be),zn=Y({},Fr,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Bt=Xn(zn),rn=[9,13,27,32],wn=l&&"CompositionEvent"in window,Ni=null;l&&"documentMode"in document&&(Ni=document.documentMode);var Mn=l&&"TextEvent"in window&&!Ni,Qo=l&&(!wn||Ni&&8<Ni&&11>=Ni),Gi=" ",bm=!1;function Ya(a,h){switch(a){case"keyup":return rn.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gd(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Ws=!1;function n0(a,h){switch(a){case"compositionend":return Gd(h);case"keypress":return h.which!==32?null:(bm=!0,Gi);case"textInput":return a=h.data,a===Gi&&bm?null:a;default:return null}}function mo(a,h){if(Ws)return a==="compositionend"||!wn&&Ya(a,h)?(a=Ba(),Qn=vr=ri=null,Ws=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return Qo&&h.locale!=="ko"?null:h.data;default:return null}}var bu={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function wm(a){var h=a&&a.nodeName&&a.nodeName.toLowerCase();return h==="input"?!!bu[a.type]:h==="textarea"}function wu(a,h,v,A){_i(A),h=T(h,"onChange"),0<h.length&&(v=new qa("onChange","change",null,v,A),a.push({event:v,listeners:h}))}var dc=null,ii=null;function r0(a){nh(a,0)}function Gs(a){var h=na(a);if(Ye(h))return a}function i0(a,h){if(a==="change")return h}var us=!1;if(l){var Za;if(l){var Eu="oninput"in document;if(!Eu){var Tu=document.createElement("div");Tu.setAttribute("oninput","return;"),Eu=typeof Tu.oninput=="function"}Za=Eu}else Za=!1;us=Za&&(!document.documentMode||9<document.documentMode)}function hc(){dc&&(dc.detachEvent("onpropertychange",Su),ii=dc=null)}function Su(a){if(a.propertyName==="value"&&Gs(ii)){var h=[];wu(h,ii,a,ao(a)),ss(r0,h)}}function Au(a,h,v){a==="focusin"?(hc(),dc=h,ii=v,dc.attachEvent("onpropertychange",Su)):a==="focusout"&&hc()}function Qa(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Gs(ii)}function Nu(a,h){if(a==="click")return Gs(h)}function Kd(a,h){if(a==="input"||a==="change")return Gs(h)}function Em(a,h){return a===h&&(a!==0||1/a===1/h)||a!==a&&h!==h}var Ki=typeof Object.is=="function"?Object.is:Em;function po(a,h){if(Ki(a,h))return!0;if(typeof a!="object"||a===null||typeof h!="object"||h===null)return!1;var v=Object.keys(a),A=Object.keys(h);if(v.length!==A.length)return!1;for(A=0;A<v.length;A++){var z=v[A];if(!d.call(h,z)||!Ki(a[z],h[z]))return!1}return!0}function Tm(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function Yd(a,h){var v=Tm(a);a=0;for(var A;v;){if(v.nodeType===3){if(A=a+v.textContent.length,a<=h&&A>=h)return{node:v,offset:h-a};a=A}e:{for(;v;){if(v.nextSibling){v=v.nextSibling;break e}v=v.parentNode}v=void 0}v=Tm(v)}}function Sm(a,h){return a&&h?a===h?!0:a&&a.nodeType===3?!1:h&&h.nodeType===3?Sm(a,h.parentNode):"contains"in a?a.contains(h):a.compareDocumentPosition?!!(a.compareDocumentPosition(h)&16):!1:!1}function Zd(){for(var a=window,h=Ge();h instanceof a.HTMLIFrameElement;){try{var v=typeof h.contentWindow.location.href=="string"}catch{v=!1}if(v)a=h.contentWindow;else break;h=Ge(a.document)}return h}function Qd(a){var h=a&&a.nodeName&&a.nodeName.toLowerCase();return h&&(h==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||h==="textarea"||a.contentEditable==="true")}function ds(a){var h=Zd(),v=a.focusedElem,A=a.selectionRange;if(h!==v&&v&&v.ownerDocument&&Sm(v.ownerDocument.documentElement,v)){if(A!==null&&Qd(v)){if(h=A.start,a=A.end,a===void 0&&(a=h),"selectionStart"in v)v.selectionStart=h,v.selectionEnd=Math.min(a,v.value.length);else if(a=(h=v.ownerDocument||document)&&h.defaultView||window,a.getSelection){a=a.getSelection();var z=v.textContent.length,H=Math.min(A.start,z);A=A.end===void 0?H:Math.min(A.end,z),!a.extend&&H>A&&(z=A,A=H,H=z),z=Yd(v,H);var J=Yd(v,A);z&&J&&(a.rangeCount!==1||a.anchorNode!==z.node||a.anchorOffset!==z.offset||a.focusNode!==J.node||a.focusOffset!==J.offset)&&(h=h.createRange(),h.setStart(z.node,z.offset),a.removeAllRanges(),H>A?(a.addRange(h),a.extend(J.node,J.offset)):(h.setEnd(J.node,J.offset),a.addRange(h)))}}for(h=[],a=v;a=a.parentNode;)a.nodeType===1&&h.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof v.focus=="function"&&v.focus(),v=0;v<h.length;v++)a=h[v],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var Iu=l&&"documentMode"in document&&11>=document.documentMode,Xa=null,Ja=null,fc=null,ku=!1;function Am(a,h,v){var A=v.window===v?v.document:v.nodeType===9?v:v.ownerDocument;ku||Xa==null||Xa!==Ge(A)||(A=Xa,"selectionStart"in A&&Qd(A)?A={start:A.selectionStart,end:A.selectionEnd}:(A=(A.ownerDocument&&A.ownerDocument.defaultView||window).getSelection(),A={anchorNode:A.anchorNode,anchorOffset:A.anchorOffset,focusNode:A.focusNode,focusOffset:A.focusOffset}),fc&&po(fc,A)||(fc=A,A=T(Ja,"onSelect"),0<A.length&&(h=new qa("onSelect","select",null,h,v),a.push({event:h,listeners:A}),h.target=Xa)))}function go(a,h){var v={};return v[a.toLowerCase()]=h.toLowerCase(),v["Webkit"+a]="webkit"+h,v["Moz"+a]="moz"+h,v}var el={animationend:go("Animation","AnimationEnd"),animationiteration:go("Animation","AnimationIteration"),animationstart:go("Animation","AnimationStart"),transitionend:go("Transition","TransitionEnd")},yo={},Xd={};l&&(Xd=document.createElement("div").style,"AnimationEvent"in window||(delete el.animationend.animation,delete el.animationiteration.animation,delete el.animationstart.animation),"TransitionEvent"in window||delete el.transitionend.transition);function mc(a){if(yo[a])return yo[a];if(!el[a])return a;var h=el[a],v;for(v in h)if(h.hasOwnProperty(v)&&v in Xd)return yo[a]=h[v];return a}var Nm=mc("animationend"),hs=mc("animationiteration"),Jd=mc("animationstart"),eh=mc("transitionend"),tl=new Map,Im="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Yi(a,h){tl.set(a,h),s(h,[a])}for(var Xo=0;Xo<Im.length;Xo++){var Cu=Im[Xo],km=Cu.toLowerCase(),s0=Cu[0].toUpperCase()+Cu.slice(1);Yi(km,"on"+s0)}Yi(Nm,"onAnimationEnd"),Yi(hs,"onAnimationIteration"),Yi(Jd,"onAnimationStart"),Yi("dblclick","onDoubleClick"),Yi("focusin","onFocus"),Yi("focusout","onBlur"),Yi(eh,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var nl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Cm=new Set("cancel close invalid load scroll toggle".split(" ").concat(nl));function th(a,h,v){var A=a.type||"unknown-event";a.currentTarget=v,gr(A,h,void 0,a),a.currentTarget=null}function nh(a,h){h=(h&4)!==0;for(var v=0;v<a.length;v++){var A=a[v],z=A.event;A=A.listeners;e:{var H=void 0;if(h)for(var J=A.length-1;0<=J;J--){var ue=A[J],he=ue.instance,Ee=ue.currentTarget;if(ue=ue.listener,he!==H&&z.isPropagationStopped())break e;th(z,ue,Ee),H=he}else for(J=0;J<A.length;J++){if(ue=A[J],he=ue.instance,Ee=ue.currentTarget,ue=ue.listener,he!==H&&z.isPropagationStopped())break e;th(z,ue,Ee),H=he}}}if(Er)throw a=Vs,Er=!1,Vs=null,a}function _n(a,h){var v=h[ol];v===void 0&&(v=h[ol]=new Set);var A=a+"__bubble";v.has(A)||(Pm(h,a,2,!1),v.add(A))}function rh(a,h,v){var A=0;h&&(A|=4),Pm(v,a,A,h)}var pc="_reactListening"+Math.random().toString(36).slice(2);function rl(a){if(!a[pc]){a[pc]=!0,r.forEach(function(v){v!=="selectionchange"&&(Cm.has(v)||rh(v,!1,a),rh(v,!0,a))});var h=a.nodeType===9?a:a.ownerDocument;h===null||h[pc]||(h[pc]=!0,rh("selectionchange",!1,h))}}function Pm(a,h,v,A){switch(jt(h)){case 1:var z=Tn;break;case 4:z=yu;break;default:z=$o}v=z.bind(null,h,v,a),z=void 0,!Ls||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(z=!0),A?z!==void 0?a.addEventListener(h,v,{capture:!0,passive:z}):a.addEventListener(h,v,!0):z!==void 0?a.addEventListener(h,v,{passive:z}):a.addEventListener(h,v,!1)}function c(a,h,v,A,z){var H=A;if((h&1)===0&&(h&2)===0&&A!==null)e:for(;;){if(A===null)return;var J=A.tag;if(J===3||J===4){var ue=A.stateNode.containerInfo;if(ue===z||ue.nodeType===8&&ue.parentNode===z)break;if(J===4)for(J=A.return;J!==null;){var he=J.tag;if((he===3||he===4)&&(he=J.stateNode.containerInfo,he===z||he.nodeType===8&&he.parentNode===z))return;J=J.return}for(;ue!==null;){if(J=ea(ue),J===null)return;if(he=J.tag,he===5||he===6){A=H=J;continue e}ue=ue.parentNode}}A=A.return}ss(function(){var Ee=H,Re=ao(v),Oe=[];e:{var Pe=tl.get(a);if(Pe!==void 0){var We=qa,Xe=a;switch(a){case"keypress":if(Ua(v)===0)break e;case"keydown":case"keyup":We=q;break;case"focusin":Xe="focus",We=Yo;break;case"focusout":Xe="blur",We=Yo;break;case"beforeblur":case"afterblur":We=Yo;break;case"click":if(v.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":We=Ko;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":We=$a;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":We=Te;break;case Nm:case hs:case Jd:We=$s;break;case eh:We=tn;break;case"scroll":We=Wd;break;case"wheel":We=Bt;break;case"copy":case"cut":case"paste":We=Ga;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":We=le}var tt=(h&4)!==0,Gn=!tt&&a==="scroll",xe=tt?Pe!==null?Pe+"Capture":null:Pe;tt=[];for(var pe=Ee,be;pe!==null;){be=pe;var Fe=be.stateNode;if(be.tag===5&&Fe!==null&&(be=Fe,xe!==null&&(Fe=xn(pe,xe),Fe!=null&&tt.push(p(pe,Fe,be)))),Gn)break;pe=pe.return}0<tt.length&&(Pe=new We(Pe,Xe,null,v,Re),Oe.push({event:Pe,listeners:tt}))}}if((h&7)===0){e:{if(Pe=a==="mouseover"||a==="pointerover",We=a==="mouseout"||a==="pointerout",Pe&&v!==zi&&(Xe=v.relatedTarget||v.fromElement)&&(ea(Xe)||Xe[sn]))break e;if((We||Pe)&&(Pe=Re.window===Re?Re:(Pe=Re.ownerDocument)?Pe.defaultView||Pe.parentWindow:window,We?(Xe=v.relatedTarget||v.toElement,We=Ee,Xe=Xe?ea(Xe):null,Xe!==null&&(Gn=Tr(Xe),Xe!==Gn||Xe.tag!==5&&Xe.tag!==6)&&(Xe=null)):(We=null,Xe=Ee),We!==Xe)){if(tt=Ko,Fe="onMouseLeave",xe="onMouseEnter",pe="mouse",(a==="pointerout"||a==="pointerover")&&(tt=le,Fe="onPointerLeave",xe="onPointerEnter",pe="pointer"),Gn=We==null?Pe:na(We),be=Xe==null?Pe:na(Xe),Pe=new tt(Fe,pe+"leave",We,v,Re),Pe.target=Gn,Pe.relatedTarget=be,Fe=null,ea(Re)===Ee&&(tt=new tt(xe,pe+"enter",Xe,v,Re),tt.target=be,tt.relatedTarget=Gn,Fe=tt),Gn=Fe,We&&Xe)t:{for(tt=We,xe=Xe,pe=0,be=tt;be;be=V(be))pe++;for(be=0,Fe=xe;Fe;Fe=V(Fe))be++;for(;0<pe-be;)tt=V(tt),pe--;for(;0<be-pe;)xe=V(xe),be--;for(;pe--;){if(tt===xe||xe!==null&&tt===xe.alternate)break t;tt=V(tt),xe=V(xe)}tt=null}else tt=null;We!==null&&W(Oe,Pe,We,tt,!1),Xe!==null&&Gn!==null&&W(Oe,Gn,Xe,tt,!0)}}e:{if(Pe=Ee?na(Ee):window,We=Pe.nodeName&&Pe.nodeName.toLowerCase(),We==="select"||We==="input"&&Pe.type==="file")var rt=i0;else if(wm(Pe))if(us)rt=Kd;else{rt=Qa;var ht=Au}else(We=Pe.nodeName)&&We.toLowerCase()==="input"&&(Pe.type==="checkbox"||Pe.type==="radio")&&(rt=Nu);if(rt&&(rt=rt(a,Ee))){wu(Oe,rt,v,Re);break e}ht&&ht(a,Pe,Ee),a==="focusout"&&(ht=Pe._wrapperState)&&ht.controlled&&Pe.type==="number"&&Ne(Pe,"number",Pe.value)}switch(ht=Ee?na(Ee):window,a){case"focusin":(wm(ht)||ht.contentEditable==="true")&&(Xa=ht,Ja=Ee,fc=null);break;case"focusout":fc=Ja=Xa=null;break;case"mousedown":ku=!0;break;case"contextmenu":case"mouseup":case"dragend":ku=!1,Am(Oe,v,Re);break;case"selectionchange":if(Iu)break;case"keydown":case"keyup":Am(Oe,v,Re)}var ft;if(wn)e:{switch(a){case"compositionstart":var Et="onCompositionStart";break e;case"compositionend":Et="onCompositionEnd";break e;case"compositionupdate":Et="onCompositionUpdate";break e}Et=void 0}else Ws?Ya(a,v)&&(Et="onCompositionEnd"):a==="keydown"&&v.keyCode===229&&(Et="onCompositionStart");Et&&(Qo&&v.locale!=="ko"&&(Ws||Et!=="onCompositionStart"?Et==="onCompositionEnd"&&Ws&&(ft=Ba()):(ri=Re,vr="value"in ri?ri.value:ri.textContent,Ws=!0)),ht=T(Ee,Et),0<ht.length&&(Et=new Ka(Et,a,null,v,Re),Oe.push({event:Et,listeners:ht}),ft?Et.data=ft:(ft=Gd(v),ft!==null&&(Et.data=ft)))),(ft=Mn?n0(a,v):mo(a,v))&&(Ee=T(Ee,"onBeforeInput"),0<Ee.length&&(Re=new Ka("onBeforeInput","beforeinput",null,v,Re),Oe.push({event:Re,listeners:Ee}),Re.data=ft))}nh(Oe,h)})}function p(a,h,v){return{instance:a,listener:h,currentTarget:v}}function T(a,h){for(var v=h+"Capture",A=[];a!==null;){var z=a,H=z.stateNode;z.tag===5&&H!==null&&(z=H,H=xn(a,v),H!=null&&A.unshift(p(a,H,z)),H=xn(a,h),H!=null&&A.push(p(a,H,z))),a=a.return}return A}function V(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function W(a,h,v,A,z){for(var H=h._reactName,J=[];v!==null&&v!==A;){var ue=v,he=ue.alternate,Ee=ue.stateNode;if(he!==null&&he===A)break;ue.tag===5&&Ee!==null&&(ue=Ee,z?(he=xn(v,H),he!=null&&J.unshift(p(v,he,ue))):z||(he=xn(v,H),he!=null&&J.push(p(v,he,ue)))),v=v.return}J.length!==0&&a.push({event:h,listeners:J})}var ne=/\r\n?/g,de=/\u0000|\uFFFD/g;function ve(a){return(typeof a=="string"?a:""+a).replace(ne,`
`).replace(de,"")}function we(a,h,v){if(h=ve(h),ve(a)!==h&&v)throw Error(t(425))}function Ce(){}var He=null,dt=null;function Pt(a,h){return a==="textarea"||a==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var ar=typeof setTimeout=="function"?setTimeout:void 0,er=typeof clearTimeout=="function"?clearTimeout:void 0,si=typeof Promise=="function"?Promise:void 0,zr=typeof queueMicrotask=="function"?queueMicrotask:typeof si<"u"?function(a){return si.resolve(null).then(a).catch(il)}:ar;function il(a){setTimeout(function(){throw a})}function ih(a,h){var v=h,A=0;do{var z=v.nextSibling;if(a.removeChild(v),z&&z.nodeType===8)if(v=z.data,v==="/$"){if(A===0){a.removeChild(z),or(h);return}A--}else v!=="$"&&v!=="$?"&&v!=="$!"||A++;v=z}while(v);or(h)}function vo(a){for(;a!=null;a=a.nextSibling){var h=a.nodeType;if(h===1||h===3)break;if(h===8){if(h=a.data,h==="$"||h==="$!"||h==="$?")break;if(h==="/$")return null}}return a}function Rm(a){a=a.previousSibling;for(var h=0;a;){if(a.nodeType===8){var v=a.data;if(v==="$"||v==="$!"||v==="$?"){if(h===0)return a;h--}else v==="/$"&&h++}a=a.previousSibling}return null}var Jo=Math.random().toString(36).slice(2),fs="__reactFiber$"+Jo,sl="__reactProps$"+Jo,sn="__reactContainer$"+Jo,ol="__reactEvents$"+Jo,o0="__reactListeners$"+Jo,a0="__reactHandles$"+Jo;function ea(a){var h=a[fs];if(h)return h;for(var v=a.parentNode;v;){if(h=v[sn]||v[fs]){if(v=h.alternate,h.child!==null||v!==null&&v.child!==null)for(a=Rm(a);a!==null;){if(v=a[fs])return v;a=Rm(a)}return h}a=v,v=a.parentNode}return null}function ta(a){return a=a[fs]||a[sn],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function na(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function Pu(a){return a[sl]||null}var l0=[],Ru=-1;function al(a){return{current:a}}function Nn(a){0>Ru||(a.current=l0[Ru],l0[Ru]=null,Ru--)}function Sn(a,h){Ru++,l0[Ru]=a.current,a.current=h}var ll={},Br=al(ll),Ii=al(!1),gc=ll;function ju(a,h){var v=a.type.contextTypes;if(!v)return ll;var A=a.stateNode;if(A&&A.__reactInternalMemoizedUnmaskedChildContext===h)return A.__reactInternalMemoizedMaskedChildContext;var z={},H;for(H in v)z[H]=h[H];return A&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=h,a.__reactInternalMemoizedMaskedChildContext=z),z}function ki(a){return a=a.childContextTypes,a!=null}function jm(){Nn(Ii),Nn(Br)}function N2(a,h,v){if(Br.current!==ll)throw Error(t(168));Sn(Br,h),Sn(Ii,v)}function I2(a,h,v){var A=a.stateNode;if(h=h.childContextTypes,typeof A.getChildContext!="function")return v;A=A.getChildContext();for(var z in A)if(!(z in h))throw Error(t(108,ce(a)||"Unknown",z));return Y({},v,A)}function Om(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||ll,gc=Br.current,Sn(Br,a),Sn(Ii,Ii.current),!0}function k2(a,h,v){var A=a.stateNode;if(!A)throw Error(t(169));v?(a=I2(a,h,gc),A.__reactInternalMemoizedMergedChildContext=a,Nn(Ii),Nn(Br),Sn(Br,a)):Nn(Ii),Sn(Ii,v)}var ra=null,Mm=!1,c0=!1;function C2(a){ra===null?ra=[a]:ra.push(a)}function iR(a){Mm=!0,C2(a)}function cl(){if(!c0&&ra!==null){c0=!0;var a=0,h=Rt;try{var v=ra;for(Rt=1;a<v.length;a++){var A=v[a];do A=A(!0);while(A!==null)}ra=null,Mm=!1}catch(z){throw ra!==null&&(ra=ra.slice(a+1)),fe(kn,cl),z}finally{Rt=h,c0=!1}}return null}var Ou=[],Mu=0,Dm=null,Lm=0,ms=[],ps=0,yc=null,ia=1,sa="";function vc(a,h){Ou[Mu++]=Lm,Ou[Mu++]=Dm,Dm=a,Lm=h}function P2(a,h,v){ms[ps++]=ia,ms[ps++]=sa,ms[ps++]=yc,yc=a;var A=ia;a=sa;var z=32-vt(A)-1;A&=~(1<<z),v+=1;var H=32-vt(h)+z;if(30<H){var J=z-z%5;H=(A&(1<<J)-1).toString(32),A>>=J,z-=J,ia=1<<32-vt(h)+z|v<<z|A,sa=H+a}else ia=1<<H|v<<z|A,sa=a}function u0(a){a.return!==null&&(vc(a,1),P2(a,1,0))}function d0(a){for(;a===Dm;)Dm=Ou[--Mu],Ou[Mu]=null,Lm=Ou[--Mu],Ou[Mu]=null;for(;a===yc;)yc=ms[--ps],ms[ps]=null,sa=ms[--ps],ms[ps]=null,ia=ms[--ps],ms[ps]=null}var Zi=null,Qi=null,Cn=!1,Ks=null;function R2(a,h){var v=_s(5,null,null,0);v.elementType="DELETED",v.stateNode=h,v.return=a,h=a.deletions,h===null?(a.deletions=[v],a.flags|=16):h.push(v)}function j2(a,h){switch(a.tag){case 5:var v=a.type;return h=h.nodeType!==1||v.toLowerCase()!==h.nodeName.toLowerCase()?null:h,h!==null?(a.stateNode=h,Zi=a,Qi=vo(h.firstChild),!0):!1;case 6:return h=a.pendingProps===""||h.nodeType!==3?null:h,h!==null?(a.stateNode=h,Zi=a,Qi=null,!0):!1;case 13:return h=h.nodeType!==8?null:h,h!==null?(v=yc!==null?{id:ia,overflow:sa}:null,a.memoizedState={dehydrated:h,treeContext:v,retryLane:1073741824},v=_s(18,null,null,0),v.stateNode=h,v.return=a,a.child=v,Zi=a,Qi=null,!0):!1;default:return!1}}function h0(a){return(a.mode&1)!==0&&(a.flags&128)===0}function f0(a){if(Cn){var h=Qi;if(h){var v=h;if(!j2(a,h)){if(h0(a))throw Error(t(418));h=vo(v.nextSibling);var A=Zi;h&&j2(a,h)?R2(A,v):(a.flags=a.flags&-4097|2,Cn=!1,Zi=a)}}else{if(h0(a))throw Error(t(418));a.flags=a.flags&-4097|2,Cn=!1,Zi=a}}}function O2(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;Zi=a}function Fm(a){if(a!==Zi)return!1;if(!Cn)return O2(a),Cn=!0,!1;var h;if((h=a.tag!==3)&&!(h=a.tag!==5)&&(h=a.type,h=h!=="head"&&h!=="body"&&!Pt(a.type,a.memoizedProps)),h&&(h=Qi)){if(h0(a))throw M2(),Error(t(418));for(;h;)R2(a,h),h=vo(h.nextSibling)}if(O2(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,h=0;a;){if(a.nodeType===8){var v=a.data;if(v==="/$"){if(h===0){Qi=vo(a.nextSibling);break e}h--}else v!=="$"&&v!=="$!"&&v!=="$?"||h++}a=a.nextSibling}Qi=null}}else Qi=Zi?vo(a.stateNode.nextSibling):null;return!0}function M2(){for(var a=Qi;a;)a=vo(a.nextSibling)}function Du(){Qi=Zi=null,Cn=!1}function m0(a){Ks===null?Ks=[a]:Ks.push(a)}var sR=I.ReactCurrentBatchConfig;function sh(a,h,v){if(a=v.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(v._owner){if(v=v._owner,v){if(v.tag!==1)throw Error(t(309));var A=v.stateNode}if(!A)throw Error(t(147,a));var z=A,H=""+a;return h!==null&&h.ref!==null&&typeof h.ref=="function"&&h.ref._stringRef===H?h.ref:(h=function(J){var ue=z.refs;J===null?delete ue[H]:ue[H]=J},h._stringRef=H,h)}if(typeof a!="string")throw Error(t(284));if(!v._owner)throw Error(t(290,a))}return a}function Vm(a,h){throw a=Object.prototype.toString.call(h),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":a))}function D2(a){var h=a._init;return h(a._payload)}function L2(a){function h(xe,pe){if(a){var be=xe.deletions;be===null?(xe.deletions=[pe],xe.flags|=16):be.push(pe)}}function v(xe,pe){if(!a)return null;for(;pe!==null;)h(xe,pe),pe=pe.sibling;return null}function A(xe,pe){for(xe=new Map;pe!==null;)pe.key!==null?xe.set(pe.key,pe):xe.set(pe.index,pe),pe=pe.sibling;return xe}function z(xe,pe){return xe=yl(xe,pe),xe.index=0,xe.sibling=null,xe}function H(xe,pe,be){return xe.index=be,a?(be=xe.alternate,be!==null?(be=be.index,be<pe?(xe.flags|=2,pe):be):(xe.flags|=2,pe)):(xe.flags|=1048576,pe)}function J(xe){return a&&xe.alternate===null&&(xe.flags|=2),xe}function ue(xe,pe,be,Fe){return pe===null||pe.tag!==6?(pe=sv(be,xe.mode,Fe),pe.return=xe,pe):(pe=z(pe,be),pe.return=xe,pe)}function he(xe,pe,be,Fe){var rt=be.type;return rt===j?Re(xe,pe,be.props.children,Fe,be.key):pe!==null&&(pe.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===re&&D2(rt)===pe.type)?(Fe=z(pe,be.props),Fe.ref=sh(xe,pe,be),Fe.return=xe,Fe):(Fe=cp(be.type,be.key,be.props,null,xe.mode,Fe),Fe.ref=sh(xe,pe,be),Fe.return=xe,Fe)}function Ee(xe,pe,be,Fe){return pe===null||pe.tag!==4||pe.stateNode.containerInfo!==be.containerInfo||pe.stateNode.implementation!==be.implementation?(pe=ov(be,xe.mode,Fe),pe.return=xe,pe):(pe=z(pe,be.children||[]),pe.return=xe,pe)}function Re(xe,pe,be,Fe,rt){return pe===null||pe.tag!==7?(pe=Ac(be,xe.mode,Fe,rt),pe.return=xe,pe):(pe=z(pe,be),pe.return=xe,pe)}function Oe(xe,pe,be){if(typeof pe=="string"&&pe!==""||typeof pe=="number")return pe=sv(""+pe,xe.mode,be),pe.return=xe,pe;if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case R:return be=cp(pe.type,pe.key,pe.props,null,xe.mode,be),be.ref=sh(xe,null,pe),be.return=xe,be;case U:return pe=ov(pe,xe.mode,be),pe.return=xe,pe;case re:var Fe=pe._init;return Oe(xe,Fe(pe._payload),be)}if(De(pe)||X(pe))return pe=Ac(pe,xe.mode,be,null),pe.return=xe,pe;Vm(xe,pe)}return null}function Pe(xe,pe,be,Fe){var rt=pe!==null?pe.key:null;if(typeof be=="string"&&be!==""||typeof be=="number")return rt!==null?null:ue(xe,pe,""+be,Fe);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case R:return be.key===rt?he(xe,pe,be,Fe):null;case U:return be.key===rt?Ee(xe,pe,be,Fe):null;case re:return rt=be._init,Pe(xe,pe,rt(be._payload),Fe)}if(De(be)||X(be))return rt!==null?null:Re(xe,pe,be,Fe,null);Vm(xe,be)}return null}function We(xe,pe,be,Fe,rt){if(typeof Fe=="string"&&Fe!==""||typeof Fe=="number")return xe=xe.get(be)||null,ue(pe,xe,""+Fe,rt);if(typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case R:return xe=xe.get(Fe.key===null?be:Fe.key)||null,he(pe,xe,Fe,rt);case U:return xe=xe.get(Fe.key===null?be:Fe.key)||null,Ee(pe,xe,Fe,rt);case re:var ht=Fe._init;return We(xe,pe,be,ht(Fe._payload),rt)}if(De(Fe)||X(Fe))return xe=xe.get(be)||null,Re(pe,xe,Fe,rt,null);Vm(pe,Fe)}return null}function Xe(xe,pe,be,Fe){for(var rt=null,ht=null,ft=pe,Et=pe=0,br=null;ft!==null&&Et<be.length;Et++){ft.index>Et?(br=ft,ft=null):br=ft.sibling;var Jt=Pe(xe,ft,be[Et],Fe);if(Jt===null){ft===null&&(ft=br);break}a&&ft&&Jt.alternate===null&&h(xe,ft),pe=H(Jt,pe,Et),ht===null?rt=Jt:ht.sibling=Jt,ht=Jt,ft=br}if(Et===be.length)return v(xe,ft),Cn&&vc(xe,Et),rt;if(ft===null){for(;Et<be.length;Et++)ft=Oe(xe,be[Et],Fe),ft!==null&&(pe=H(ft,pe,Et),ht===null?rt=ft:ht.sibling=ft,ht=ft);return Cn&&vc(xe,Et),rt}for(ft=A(xe,ft);Et<be.length;Et++)br=We(ft,xe,Et,be[Et],Fe),br!==null&&(a&&br.alternate!==null&&ft.delete(br.key===null?Et:br.key),pe=H(br,pe,Et),ht===null?rt=br:ht.sibling=br,ht=br);return a&&ft.forEach(function(vl){return h(xe,vl)}),Cn&&vc(xe,Et),rt}function tt(xe,pe,be,Fe){var rt=X(be);if(typeof rt!="function")throw Error(t(150));if(be=rt.call(be),be==null)throw Error(t(151));for(var ht=rt=null,ft=pe,Et=pe=0,br=null,Jt=be.next();ft!==null&&!Jt.done;Et++,Jt=be.next()){ft.index>Et?(br=ft,ft=null):br=ft.sibling;var vl=Pe(xe,ft,Jt.value,Fe);if(vl===null){ft===null&&(ft=br);break}a&&ft&&vl.alternate===null&&h(xe,ft),pe=H(vl,pe,Et),ht===null?rt=vl:ht.sibling=vl,ht=vl,ft=br}if(Jt.done)return v(xe,ft),Cn&&vc(xe,Et),rt;if(ft===null){for(;!Jt.done;Et++,Jt=be.next())Jt=Oe(xe,Jt.value,Fe),Jt!==null&&(pe=H(Jt,pe,Et),ht===null?rt=Jt:ht.sibling=Jt,ht=Jt);return Cn&&vc(xe,Et),rt}for(ft=A(xe,ft);!Jt.done;Et++,Jt=be.next())Jt=We(ft,xe,Et,Jt.value,Fe),Jt!==null&&(a&&Jt.alternate!==null&&ft.delete(Jt.key===null?Et:Jt.key),pe=H(Jt,pe,Et),ht===null?rt=Jt:ht.sibling=Jt,ht=Jt);return a&&ft.forEach(function(FR){return h(xe,FR)}),Cn&&vc(xe,Et),rt}function Gn(xe,pe,be,Fe){if(typeof be=="object"&&be!==null&&be.type===j&&be.key===null&&(be=be.props.children),typeof be=="object"&&be!==null){switch(be.$$typeof){case R:e:{for(var rt=be.key,ht=pe;ht!==null;){if(ht.key===rt){if(rt=be.type,rt===j){if(ht.tag===7){v(xe,ht.sibling),pe=z(ht,be.props.children),pe.return=xe,xe=pe;break e}}else if(ht.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===re&&D2(rt)===ht.type){v(xe,ht.sibling),pe=z(ht,be.props),pe.ref=sh(xe,ht,be),pe.return=xe,xe=pe;break e}v(xe,ht);break}else h(xe,ht);ht=ht.sibling}be.type===j?(pe=Ac(be.props.children,xe.mode,Fe,be.key),pe.return=xe,xe=pe):(Fe=cp(be.type,be.key,be.props,null,xe.mode,Fe),Fe.ref=sh(xe,pe,be),Fe.return=xe,xe=Fe)}return J(xe);case U:e:{for(ht=be.key;pe!==null;){if(pe.key===ht)if(pe.tag===4&&pe.stateNode.containerInfo===be.containerInfo&&pe.stateNode.implementation===be.implementation){v(xe,pe.sibling),pe=z(pe,be.children||[]),pe.return=xe,xe=pe;break e}else{v(xe,pe);break}else h(xe,pe);pe=pe.sibling}pe=ov(be,xe.mode,Fe),pe.return=xe,xe=pe}return J(xe);case re:return ht=be._init,Gn(xe,pe,ht(be._payload),Fe)}if(De(be))return Xe(xe,pe,be,Fe);if(X(be))return tt(xe,pe,be,Fe);Vm(xe,be)}return typeof be=="string"&&be!==""||typeof be=="number"?(be=""+be,pe!==null&&pe.tag===6?(v(xe,pe.sibling),pe=z(pe,be),pe.return=xe,xe=pe):(v(xe,pe),pe=sv(be,xe.mode,Fe),pe.return=xe,xe=pe),J(xe)):v(xe,pe)}return Gn}var Lu=L2(!0),F2=L2(!1),zm=al(null),Bm=null,Fu=null,p0=null;function g0(){p0=Fu=Bm=null}function y0(a){var h=zm.current;Nn(zm),a._currentValue=h}function v0(a,h,v){for(;a!==null;){var A=a.alternate;if((a.childLanes&h)!==h?(a.childLanes|=h,A!==null&&(A.childLanes|=h)):A!==null&&(A.childLanes&h)!==h&&(A.childLanes|=h),a===v)break;a=a.return}}function Vu(a,h){Bm=a,p0=Fu=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&h)!==0&&(Ci=!0),a.firstContext=null)}function gs(a){var h=a._currentValue;if(p0!==a)if(a={context:a,memoizedValue:h,next:null},Fu===null){if(Bm===null)throw Error(t(308));Fu=a,Bm.dependencies={lanes:0,firstContext:a}}else Fu=Fu.next=a;return h}var _c=null;function _0(a){_c===null?_c=[a]:_c.push(a)}function V2(a,h,v,A){var z=h.interleaved;return z===null?(v.next=v,_0(h)):(v.next=z.next,z.next=v),h.interleaved=v,oa(a,A)}function oa(a,h){a.lanes|=h;var v=a.alternate;for(v!==null&&(v.lanes|=h),v=a,a=a.return;a!==null;)a.childLanes|=h,v=a.alternate,v!==null&&(v.childLanes|=h),v=a,a=a.return;return v.tag===3?v.stateNode:null}var ul=!1;function x0(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function z2(a,h){a=a.updateQueue,h.updateQueue===a&&(h.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function aa(a,h){return{eventTime:a,lane:h,tag:0,payload:null,callback:null,next:null}}function dl(a,h,v){var A=a.updateQueue;if(A===null)return null;if(A=A.shared,(Yt&2)!==0){var z=A.pending;return z===null?h.next=h:(h.next=z.next,z.next=h),A.pending=h,oa(a,v)}return z=A.interleaved,z===null?(h.next=h,_0(A)):(h.next=z.next,z.next=h),A.interleaved=h,oa(a,v)}function Um(a,h,v){if(h=h.updateQueue,h!==null&&(h=h.shared,(v&4194240)!==0)){var A=h.lanes;A&=a.pendingLanes,v|=A,h.lanes=v,Lr(a,v)}}function B2(a,h){var v=a.updateQueue,A=a.alternate;if(A!==null&&(A=A.updateQueue,v===A)){var z=null,H=null;if(v=v.firstBaseUpdate,v!==null){do{var J={eventTime:v.eventTime,lane:v.lane,tag:v.tag,payload:v.payload,callback:v.callback,next:null};H===null?z=H=J:H=H.next=J,v=v.next}while(v!==null);H===null?z=H=h:H=H.next=h}else z=H=h;v={baseState:A.baseState,firstBaseUpdate:z,lastBaseUpdate:H,shared:A.shared,effects:A.effects},a.updateQueue=v;return}a=v.lastBaseUpdate,a===null?v.firstBaseUpdate=h:a.next=h,v.lastBaseUpdate=h}function qm(a,h,v,A){var z=a.updateQueue;ul=!1;var H=z.firstBaseUpdate,J=z.lastBaseUpdate,ue=z.shared.pending;if(ue!==null){z.shared.pending=null;var he=ue,Ee=he.next;he.next=null,J===null?H=Ee:J.next=Ee,J=he;var Re=a.alternate;Re!==null&&(Re=Re.updateQueue,ue=Re.lastBaseUpdate,ue!==J&&(ue===null?Re.firstBaseUpdate=Ee:ue.next=Ee,Re.lastBaseUpdate=he))}if(H!==null){var Oe=z.baseState;J=0,Re=Ee=he=null,ue=H;do{var Pe=ue.lane,We=ue.eventTime;if((A&Pe)===Pe){Re!==null&&(Re=Re.next={eventTime:We,lane:0,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null});e:{var Xe=a,tt=ue;switch(Pe=h,We=v,tt.tag){case 1:if(Xe=tt.payload,typeof Xe=="function"){Oe=Xe.call(We,Oe,Pe);break e}Oe=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=tt.payload,Pe=typeof Xe=="function"?Xe.call(We,Oe,Pe):Xe,Pe==null)break e;Oe=Y({},Oe,Pe);break e;case 2:ul=!0}}ue.callback!==null&&ue.lane!==0&&(a.flags|=64,Pe=z.effects,Pe===null?z.effects=[ue]:Pe.push(ue))}else We={eventTime:We,lane:Pe,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null},Re===null?(Ee=Re=We,he=Oe):Re=Re.next=We,J|=Pe;if(ue=ue.next,ue===null){if(ue=z.shared.pending,ue===null)break;Pe=ue,ue=Pe.next,Pe.next=null,z.lastBaseUpdate=Pe,z.shared.pending=null}}while(!0);if(Re===null&&(he=Oe),z.baseState=he,z.firstBaseUpdate=Ee,z.lastBaseUpdate=Re,h=z.shared.interleaved,h!==null){z=h;do J|=z.lane,z=z.next;while(z!==h)}else H===null&&(z.shared.lanes=0);wc|=J,a.lanes=J,a.memoizedState=Oe}}function U2(a,h,v){if(a=h.effects,h.effects=null,a!==null)for(h=0;h<a.length;h++){var A=a[h],z=A.callback;if(z!==null){if(A.callback=null,A=v,typeof z!="function")throw Error(t(191,z));z.call(A)}}}var oh={},_o=al(oh),ah=al(oh),lh=al(oh);function xc(a){if(a===oh)throw Error(t(174));return a}function b0(a,h){switch(Sn(lh,h),Sn(ah,a),Sn(_o,oh),a=h.nodeType,a){case 9:case 11:h=(h=h.documentElement)?h.namespaceURI:Mt(null,"");break;default:a=a===8?h.parentNode:h,h=a.namespaceURI||null,a=a.tagName,h=Mt(h,a)}Nn(_o),Sn(_o,h)}function zu(){Nn(_o),Nn(ah),Nn(lh)}function q2(a){xc(lh.current);var h=xc(_o.current),v=Mt(h,a.type);h!==v&&(Sn(ah,a),Sn(_o,v))}function w0(a){ah.current===a&&(Nn(_o),Nn(ah))}var Dn=al(0);function Hm(a){for(var h=a;h!==null;){if(h.tag===13){var v=h.memoizedState;if(v!==null&&(v=v.dehydrated,v===null||v.data==="$?"||v.data==="$!"))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var E0=[];function T0(){for(var a=0;a<E0.length;a++)E0[a]._workInProgressVersionPrimary=null;E0.length=0}var $m=I.ReactCurrentDispatcher,S0=I.ReactCurrentBatchConfig,bc=0,Ln=null,lr=null,_r=null,Wm=!1,ch=!1,uh=0,oR=0;function Ur(){throw Error(t(321))}function A0(a,h){if(h===null)return!1;for(var v=0;v<h.length&&v<a.length;v++)if(!Ki(a[v],h[v]))return!1;return!0}function N0(a,h,v,A,z,H){if(bc=H,Ln=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,$m.current=a===null||a.memoizedState===null?uR:dR,a=v(A,z),ch){H=0;do{if(ch=!1,uh=0,25<=H)throw Error(t(301));H+=1,_r=lr=null,h.updateQueue=null,$m.current=hR,a=v(A,z)}while(ch)}if($m.current=Ym,h=lr!==null&&lr.next!==null,bc=0,_r=lr=Ln=null,Wm=!1,h)throw Error(t(300));return a}function I0(){var a=uh!==0;return uh=0,a}function xo(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return _r===null?Ln.memoizedState=_r=a:_r=_r.next=a,_r}function ys(){if(lr===null){var a=Ln.alternate;a=a!==null?a.memoizedState:null}else a=lr.next;var h=_r===null?Ln.memoizedState:_r.next;if(h!==null)_r=h,lr=a;else{if(a===null)throw Error(t(310));lr=a,a={memoizedState:lr.memoizedState,baseState:lr.baseState,baseQueue:lr.baseQueue,queue:lr.queue,next:null},_r===null?Ln.memoizedState=_r=a:_r=_r.next=a}return _r}function dh(a,h){return typeof h=="function"?h(a):h}function k0(a){var h=ys(),v=h.queue;if(v===null)throw Error(t(311));v.lastRenderedReducer=a;var A=lr,z=A.baseQueue,H=v.pending;if(H!==null){if(z!==null){var J=z.next;z.next=H.next,H.next=J}A.baseQueue=z=H,v.pending=null}if(z!==null){H=z.next,A=A.baseState;var ue=J=null,he=null,Ee=H;do{var Re=Ee.lane;if((bc&Re)===Re)he!==null&&(he=he.next={lane:0,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null}),A=Ee.hasEagerState?Ee.eagerState:a(A,Ee.action);else{var Oe={lane:Re,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null};he===null?(ue=he=Oe,J=A):he=he.next=Oe,Ln.lanes|=Re,wc|=Re}Ee=Ee.next}while(Ee!==null&&Ee!==H);he===null?J=A:he.next=ue,Ki(A,h.memoizedState)||(Ci=!0),h.memoizedState=A,h.baseState=J,h.baseQueue=he,v.lastRenderedState=A}if(a=v.interleaved,a!==null){z=a;do H=z.lane,Ln.lanes|=H,wc|=H,z=z.next;while(z!==a)}else z===null&&(v.lanes=0);return[h.memoizedState,v.dispatch]}function C0(a){var h=ys(),v=h.queue;if(v===null)throw Error(t(311));v.lastRenderedReducer=a;var A=v.dispatch,z=v.pending,H=h.memoizedState;if(z!==null){v.pending=null;var J=z=z.next;do H=a(H,J.action),J=J.next;while(J!==z);Ki(H,h.memoizedState)||(Ci=!0),h.memoizedState=H,h.baseQueue===null&&(h.baseState=H),v.lastRenderedState=H}return[H,A]}function H2(){}function $2(a,h){var v=Ln,A=ys(),z=h(),H=!Ki(A.memoizedState,z);if(H&&(A.memoizedState=z,Ci=!0),A=A.queue,P0(K2.bind(null,v,A,a),[a]),A.getSnapshot!==h||H||_r!==null&&_r.memoizedState.tag&1){if(v.flags|=2048,hh(9,G2.bind(null,v,A,z,h),void 0,null),xr===null)throw Error(t(349));(bc&30)!==0||W2(v,h,z)}return z}function W2(a,h,v){a.flags|=16384,a={getSnapshot:h,value:v},h=Ln.updateQueue,h===null?(h={lastEffect:null,stores:null},Ln.updateQueue=h,h.stores=[a]):(v=h.stores,v===null?h.stores=[a]:v.push(a))}function G2(a,h,v,A){h.value=v,h.getSnapshot=A,Y2(h)&&Z2(a)}function K2(a,h,v){return v(function(){Y2(h)&&Z2(a)})}function Y2(a){var h=a.getSnapshot;a=a.value;try{var v=h();return!Ki(a,v)}catch{return!0}}function Z2(a){var h=oa(a,1);h!==null&&Xs(h,a,1,-1)}function Q2(a){var h=xo();return typeof a=="function"&&(a=a()),h.memoizedState=h.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:dh,lastRenderedState:a},h.queue=a,a=a.dispatch=cR.bind(null,Ln,a),[h.memoizedState,a]}function hh(a,h,v,A){return a={tag:a,create:h,destroy:v,deps:A,next:null},h=Ln.updateQueue,h===null?(h={lastEffect:null,stores:null},Ln.updateQueue=h,h.lastEffect=a.next=a):(v=h.lastEffect,v===null?h.lastEffect=a.next=a:(A=v.next,v.next=a,a.next=A,h.lastEffect=a)),a}function X2(){return ys().memoizedState}function Gm(a,h,v,A){var z=xo();Ln.flags|=a,z.memoizedState=hh(1|h,v,void 0,A===void 0?null:A)}function Km(a,h,v,A){var z=ys();A=A===void 0?null:A;var H=void 0;if(lr!==null){var J=lr.memoizedState;if(H=J.destroy,A!==null&&A0(A,J.deps)){z.memoizedState=hh(h,v,H,A);return}}Ln.flags|=a,z.memoizedState=hh(1|h,v,H,A)}function J2(a,h){return Gm(8390656,8,a,h)}function P0(a,h){return Km(2048,8,a,h)}function ew(a,h){return Km(4,2,a,h)}function tw(a,h){return Km(4,4,a,h)}function nw(a,h){if(typeof h=="function")return a=a(),h(a),function(){h(null)};if(h!=null)return a=a(),h.current=a,function(){h.current=null}}function rw(a,h,v){return v=v!=null?v.concat([a]):null,Km(4,4,nw.bind(null,h,a),v)}function R0(){}function iw(a,h){var v=ys();h=h===void 0?null:h;var A=v.memoizedState;return A!==null&&h!==null&&A0(h,A[1])?A[0]:(v.memoizedState=[a,h],a)}function sw(a,h){var v=ys();h=h===void 0?null:h;var A=v.memoizedState;return A!==null&&h!==null&&A0(h,A[1])?A[0]:(a=a(),v.memoizedState=[a,h],a)}function ow(a,h,v){return(bc&21)===0?(a.baseState&&(a.baseState=!1,Ci=!0),a.memoizedState=v):(Ki(v,h)||(v=Uo(),Ln.lanes|=v,wc|=v,a.baseState=!0),h)}function aR(a,h){var v=Rt;Rt=v!==0&&4>v?v:4,a(!0);var A=S0.transition;S0.transition={};try{a(!1),h()}finally{Rt=v,S0.transition=A}}function aw(){return ys().memoizedState}function lR(a,h,v){var A=pl(a);if(v={lane:A,action:v,hasEagerState:!1,eagerState:null,next:null},lw(a))cw(h,v);else if(v=V2(a,h,v,A),v!==null){var z=ai();Xs(v,a,A,z),uw(v,h,A)}}function cR(a,h,v){var A=pl(a),z={lane:A,action:v,hasEagerState:!1,eagerState:null,next:null};if(lw(a))cw(h,z);else{var H=a.alternate;if(a.lanes===0&&(H===null||H.lanes===0)&&(H=h.lastRenderedReducer,H!==null))try{var J=h.lastRenderedState,ue=H(J,v);if(z.hasEagerState=!0,z.eagerState=ue,Ki(ue,J)){var he=h.interleaved;he===null?(z.next=z,_0(h)):(z.next=he.next,he.next=z),h.interleaved=z;return}}catch{}finally{}v=V2(a,h,z,A),v!==null&&(z=ai(),Xs(v,a,A,z),uw(v,h,A))}}function lw(a){var h=a.alternate;return a===Ln||h!==null&&h===Ln}function cw(a,h){ch=Wm=!0;var v=a.pending;v===null?h.next=h:(h.next=v.next,v.next=h),a.pending=h}function uw(a,h,v){if((v&4194240)!==0){var A=h.lanes;A&=a.pendingLanes,v|=A,h.lanes=v,Lr(a,v)}}var Ym={readContext:gs,useCallback:Ur,useContext:Ur,useEffect:Ur,useImperativeHandle:Ur,useInsertionEffect:Ur,useLayoutEffect:Ur,useMemo:Ur,useReducer:Ur,useRef:Ur,useState:Ur,useDebugValue:Ur,useDeferredValue:Ur,useTransition:Ur,useMutableSource:Ur,useSyncExternalStore:Ur,useId:Ur,unstable_isNewReconciler:!1},uR={readContext:gs,useCallback:function(a,h){return xo().memoizedState=[a,h===void 0?null:h],a},useContext:gs,useEffect:J2,useImperativeHandle:function(a,h,v){return v=v!=null?v.concat([a]):null,Gm(4194308,4,nw.bind(null,h,a),v)},useLayoutEffect:function(a,h){return Gm(4194308,4,a,h)},useInsertionEffect:function(a,h){return Gm(4,2,a,h)},useMemo:function(a,h){var v=xo();return h=h===void 0?null:h,a=a(),v.memoizedState=[a,h],a},useReducer:function(a,h,v){var A=xo();return h=v!==void 0?v(h):h,A.memoizedState=A.baseState=h,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:h},A.queue=a,a=a.dispatch=lR.bind(null,Ln,a),[A.memoizedState,a]},useRef:function(a){var h=xo();return a={current:a},h.memoizedState=a},useState:Q2,useDebugValue:R0,useDeferredValue:function(a){return xo().memoizedState=a},useTransition:function(){var a=Q2(!1),h=a[0];return a=aR.bind(null,a[1]),xo().memoizedState=a,[h,a]},useMutableSource:function(){},useSyncExternalStore:function(a,h,v){var A=Ln,z=xo();if(Cn){if(v===void 0)throw Error(t(407));v=v()}else{if(v=h(),xr===null)throw Error(t(349));(bc&30)!==0||W2(A,h,v)}z.memoizedState=v;var H={value:v,getSnapshot:h};return z.queue=H,J2(K2.bind(null,A,H,a),[a]),A.flags|=2048,hh(9,G2.bind(null,A,H,v,h),void 0,null),v},useId:function(){var a=xo(),h=xr.identifierPrefix;if(Cn){var v=sa,A=ia;v=(A&~(1<<32-vt(A)-1)).toString(32)+v,h=":"+h+"R"+v,v=uh++,0<v&&(h+="H"+v.toString(32)),h+=":"}else v=oR++,h=":"+h+"r"+v.toString(32)+":";return a.memoizedState=h},unstable_isNewReconciler:!1},dR={readContext:gs,useCallback:iw,useContext:gs,useEffect:P0,useImperativeHandle:rw,useInsertionEffect:ew,useLayoutEffect:tw,useMemo:sw,useReducer:k0,useRef:X2,useState:function(){return k0(dh)},useDebugValue:R0,useDeferredValue:function(a){var h=ys();return ow(h,lr.memoizedState,a)},useTransition:function(){var a=k0(dh)[0],h=ys().memoizedState;return[a,h]},useMutableSource:H2,useSyncExternalStore:$2,useId:aw,unstable_isNewReconciler:!1},hR={readContext:gs,useCallback:iw,useContext:gs,useEffect:P0,useImperativeHandle:rw,useInsertionEffect:ew,useLayoutEffect:tw,useMemo:sw,useReducer:C0,useRef:X2,useState:function(){return C0(dh)},useDebugValue:R0,useDeferredValue:function(a){var h=ys();return lr===null?h.memoizedState=a:ow(h,lr.memoizedState,a)},useTransition:function(){var a=C0(dh)[0],h=ys().memoizedState;return[a,h]},useMutableSource:H2,useSyncExternalStore:$2,useId:aw,unstable_isNewReconciler:!1};function Ys(a,h){if(a&&a.defaultProps){h=Y({},h),a=a.defaultProps;for(var v in a)h[v]===void 0&&(h[v]=a[v]);return h}return h}function j0(a,h,v,A){h=a.memoizedState,v=v(A,h),v=v==null?h:Y({},h,v),a.memoizedState=v,a.lanes===0&&(a.updateQueue.baseState=v)}var Zm={isMounted:function(a){return(a=a._reactInternals)?Tr(a)===a:!1},enqueueSetState:function(a,h,v){a=a._reactInternals;var A=ai(),z=pl(a),H=aa(A,z);H.payload=h,v!=null&&(H.callback=v),h=dl(a,H,z),h!==null&&(Xs(h,a,z,A),Um(h,a,z))},enqueueReplaceState:function(a,h,v){a=a._reactInternals;var A=ai(),z=pl(a),H=aa(A,z);H.tag=1,H.payload=h,v!=null&&(H.callback=v),h=dl(a,H,z),h!==null&&(Xs(h,a,z,A),Um(h,a,z))},enqueueForceUpdate:function(a,h){a=a._reactInternals;var v=ai(),A=pl(a),z=aa(v,A);z.tag=2,h!=null&&(z.callback=h),h=dl(a,z,A),h!==null&&(Xs(h,a,A,v),Um(h,a,A))}};function dw(a,h,v,A,z,H,J){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(A,H,J):h.prototype&&h.prototype.isPureReactComponent?!po(v,A)||!po(z,H):!0}function hw(a,h,v){var A=!1,z=ll,H=h.contextType;return typeof H=="object"&&H!==null?H=gs(H):(z=ki(h)?gc:Br.current,A=h.contextTypes,H=(A=A!=null)?ju(a,z):ll),h=new h(v,H),a.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=Zm,a.stateNode=h,h._reactInternals=a,A&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=z,a.__reactInternalMemoizedMaskedChildContext=H),h}function fw(a,h,v,A){a=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(v,A),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(v,A),h.state!==a&&Zm.enqueueReplaceState(h,h.state,null)}function O0(a,h,v,A){var z=a.stateNode;z.props=v,z.state=a.memoizedState,z.refs={},x0(a);var H=h.contextType;typeof H=="object"&&H!==null?z.context=gs(H):(H=ki(h)?gc:Br.current,z.context=ju(a,H)),z.state=a.memoizedState,H=h.getDerivedStateFromProps,typeof H=="function"&&(j0(a,h,H,v),z.state=a.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof z.getSnapshotBeforeUpdate=="function"||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(h=z.state,typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount(),h!==z.state&&Zm.enqueueReplaceState(z,z.state,null),qm(a,v,z,A),z.state=a.memoizedState),typeof z.componentDidMount=="function"&&(a.flags|=4194308)}function Bu(a,h){try{var v="",A=h;do v+=ae(A),A=A.return;while(A);var z=v}catch(H){z=`
Error generating stack: `+H.message+`
`+H.stack}return{value:a,source:h,stack:z,digest:null}}function M0(a,h,v){return{value:a,source:null,stack:v??null,digest:h??null}}function D0(a,h){try{console.error(h.value)}catch(v){setTimeout(function(){throw v})}}var fR=typeof WeakMap=="function"?WeakMap:Map;function mw(a,h,v){v=aa(-1,v),v.tag=3,v.payload={element:null};var A=h.value;return v.callback=function(){rp||(rp=!0,Q0=A),D0(a,h)},v}function pw(a,h,v){v=aa(-1,v),v.tag=3;var A=a.type.getDerivedStateFromError;if(typeof A=="function"){var z=h.value;v.payload=function(){return A(z)},v.callback=function(){D0(a,h)}}var H=a.stateNode;return H!==null&&typeof H.componentDidCatch=="function"&&(v.callback=function(){D0(a,h),typeof A!="function"&&(fl===null?fl=new Set([this]):fl.add(this));var J=h.stack;this.componentDidCatch(h.value,{componentStack:J!==null?J:""})}),v}function gw(a,h,v){var A=a.pingCache;if(A===null){A=a.pingCache=new fR;var z=new Set;A.set(h,z)}else z=A.get(h),z===void 0&&(z=new Set,A.set(h,z));z.has(v)||(z.add(v),a=NR.bind(null,a,h,v),h.then(a,a))}function yw(a){do{var h;if((h=a.tag===13)&&(h=a.memoizedState,h=h!==null?h.dehydrated!==null:!0),h)return a;a=a.return}while(a!==null);return null}function vw(a,h,v,A,z){return(a.mode&1)===0?(a===h?a.flags|=65536:(a.flags|=128,v.flags|=131072,v.flags&=-52805,v.tag===1&&(v.alternate===null?v.tag=17:(h=aa(-1,1),h.tag=2,dl(v,h,1))),v.lanes|=1),a):(a.flags|=65536,a.lanes=z,a)}var mR=I.ReactCurrentOwner,Ci=!1;function oi(a,h,v,A){h.child=a===null?F2(h,null,v,A):Lu(h,a.child,v,A)}function _w(a,h,v,A,z){v=v.render;var H=h.ref;return Vu(h,z),A=N0(a,h,v,A,H,z),v=I0(),a!==null&&!Ci?(h.updateQueue=a.updateQueue,h.flags&=-2053,a.lanes&=~z,la(a,h,z)):(Cn&&v&&u0(h),h.flags|=1,oi(a,h,A,z),h.child)}function xw(a,h,v,A,z){if(a===null){var H=v.type;return typeof H=="function"&&!iv(H)&&H.defaultProps===void 0&&v.compare===null&&v.defaultProps===void 0?(h.tag=15,h.type=H,bw(a,h,H,A,z)):(a=cp(v.type,null,A,h,h.mode,z),a.ref=h.ref,a.return=h,h.child=a)}if(H=a.child,(a.lanes&z)===0){var J=H.memoizedProps;if(v=v.compare,v=v!==null?v:po,v(J,A)&&a.ref===h.ref)return la(a,h,z)}return h.flags|=1,a=yl(H,A),a.ref=h.ref,a.return=h,h.child=a}function bw(a,h,v,A,z){if(a!==null){var H=a.memoizedProps;if(po(H,A)&&a.ref===h.ref)if(Ci=!1,h.pendingProps=A=H,(a.lanes&z)!==0)(a.flags&131072)!==0&&(Ci=!0);else return h.lanes=a.lanes,la(a,h,z)}return L0(a,h,v,A,z)}function ww(a,h,v){var A=h.pendingProps,z=A.children,H=a!==null?a.memoizedState:null;if(A.mode==="hidden")if((h.mode&1)===0)h.memoizedState={baseLanes:0,cachePool:null,transitions:null},Sn(qu,Xi),Xi|=v;else{if((v&1073741824)===0)return a=H!==null?H.baseLanes|v:v,h.lanes=h.childLanes=1073741824,h.memoizedState={baseLanes:a,cachePool:null,transitions:null},h.updateQueue=null,Sn(qu,Xi),Xi|=a,null;h.memoizedState={baseLanes:0,cachePool:null,transitions:null},A=H!==null?H.baseLanes:v,Sn(qu,Xi),Xi|=A}else H!==null?(A=H.baseLanes|v,h.memoizedState=null):A=v,Sn(qu,Xi),Xi|=A;return oi(a,h,z,v),h.child}function Ew(a,h){var v=h.ref;(a===null&&v!==null||a!==null&&a.ref!==v)&&(h.flags|=512,h.flags|=2097152)}function L0(a,h,v,A,z){var H=ki(v)?gc:Br.current;return H=ju(h,H),Vu(h,z),v=N0(a,h,v,A,H,z),A=I0(),a!==null&&!Ci?(h.updateQueue=a.updateQueue,h.flags&=-2053,a.lanes&=~z,la(a,h,z)):(Cn&&A&&u0(h),h.flags|=1,oi(a,h,v,z),h.child)}function Tw(a,h,v,A,z){if(ki(v)){var H=!0;Om(h)}else H=!1;if(Vu(h,z),h.stateNode===null)Xm(a,h),hw(h,v,A),O0(h,v,A,z),A=!0;else if(a===null){var J=h.stateNode,ue=h.memoizedProps;J.props=ue;var he=J.context,Ee=v.contextType;typeof Ee=="object"&&Ee!==null?Ee=gs(Ee):(Ee=ki(v)?gc:Br.current,Ee=ju(h,Ee));var Re=v.getDerivedStateFromProps,Oe=typeof Re=="function"||typeof J.getSnapshotBeforeUpdate=="function";Oe||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(ue!==A||he!==Ee)&&fw(h,J,A,Ee),ul=!1;var Pe=h.memoizedState;J.state=Pe,qm(h,A,J,z),he=h.memoizedState,ue!==A||Pe!==he||Ii.current||ul?(typeof Re=="function"&&(j0(h,v,Re,A),he=h.memoizedState),(ue=ul||dw(h,v,ue,A,Pe,he,Ee))?(Oe||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount()),typeof J.componentDidMount=="function"&&(h.flags|=4194308)):(typeof J.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=A,h.memoizedState=he),J.props=A,J.state=he,J.context=Ee,A=ue):(typeof J.componentDidMount=="function"&&(h.flags|=4194308),A=!1)}else{J=h.stateNode,z2(a,h),ue=h.memoizedProps,Ee=h.type===h.elementType?ue:Ys(h.type,ue),J.props=Ee,Oe=h.pendingProps,Pe=J.context,he=v.contextType,typeof he=="object"&&he!==null?he=gs(he):(he=ki(v)?gc:Br.current,he=ju(h,he));var We=v.getDerivedStateFromProps;(Re=typeof We=="function"||typeof J.getSnapshotBeforeUpdate=="function")||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(ue!==Oe||Pe!==he)&&fw(h,J,A,he),ul=!1,Pe=h.memoizedState,J.state=Pe,qm(h,A,J,z);var Xe=h.memoizedState;ue!==Oe||Pe!==Xe||Ii.current||ul?(typeof We=="function"&&(j0(h,v,We,A),Xe=h.memoizedState),(Ee=ul||dw(h,v,Ee,A,Pe,Xe,he)||!1)?(Re||typeof J.UNSAFE_componentWillUpdate!="function"&&typeof J.componentWillUpdate!="function"||(typeof J.componentWillUpdate=="function"&&J.componentWillUpdate(A,Xe,he),typeof J.UNSAFE_componentWillUpdate=="function"&&J.UNSAFE_componentWillUpdate(A,Xe,he)),typeof J.componentDidUpdate=="function"&&(h.flags|=4),typeof J.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof J.componentDidUpdate!="function"||ue===a.memoizedProps&&Pe===a.memoizedState||(h.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||ue===a.memoizedProps&&Pe===a.memoizedState||(h.flags|=1024),h.memoizedProps=A,h.memoizedState=Xe),J.props=A,J.state=Xe,J.context=he,A=Ee):(typeof J.componentDidUpdate!="function"||ue===a.memoizedProps&&Pe===a.memoizedState||(h.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||ue===a.memoizedProps&&Pe===a.memoizedState||(h.flags|=1024),A=!1)}return F0(a,h,v,A,H,z)}function F0(a,h,v,A,z,H){Ew(a,h);var J=(h.flags&128)!==0;if(!A&&!J)return z&&k2(h,v,!1),la(a,h,H);A=h.stateNode,mR.current=h;var ue=J&&typeof v.getDerivedStateFromError!="function"?null:A.render();return h.flags|=1,a!==null&&J?(h.child=Lu(h,a.child,null,H),h.child=Lu(h,null,ue,H)):oi(a,h,ue,H),h.memoizedState=A.state,z&&k2(h,v,!0),h.child}function Sw(a){var h=a.stateNode;h.pendingContext?N2(a,h.pendingContext,h.pendingContext!==h.context):h.context&&N2(a,h.context,!1),b0(a,h.containerInfo)}function Aw(a,h,v,A,z){return Du(),m0(z),h.flags|=256,oi(a,h,v,A),h.child}var V0={dehydrated:null,treeContext:null,retryLane:0};function z0(a){return{baseLanes:a,cachePool:null,transitions:null}}function Nw(a,h,v){var A=h.pendingProps,z=Dn.current,H=!1,J=(h.flags&128)!==0,ue;if((ue=J)||(ue=a!==null&&a.memoizedState===null?!1:(z&2)!==0),ue?(H=!0,h.flags&=-129):(a===null||a.memoizedState!==null)&&(z|=1),Sn(Dn,z&1),a===null)return f0(h),a=h.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((h.mode&1)===0?h.lanes=1:a.data==="$!"?h.lanes=8:h.lanes=1073741824,null):(J=A.children,a=A.fallback,H?(A=h.mode,H=h.child,J={mode:"hidden",children:J},(A&1)===0&&H!==null?(H.childLanes=0,H.pendingProps=J):H=up(J,A,0,null),a=Ac(a,A,v,null),H.return=h,a.return=h,H.sibling=a,h.child=H,h.child.memoizedState=z0(v),h.memoizedState=V0,a):B0(h,J));if(z=a.memoizedState,z!==null&&(ue=z.dehydrated,ue!==null))return pR(a,h,J,A,ue,z,v);if(H){H=A.fallback,J=h.mode,z=a.child,ue=z.sibling;var he={mode:"hidden",children:A.children};return(J&1)===0&&h.child!==z?(A=h.child,A.childLanes=0,A.pendingProps=he,h.deletions=null):(A=yl(z,he),A.subtreeFlags=z.subtreeFlags&14680064),ue!==null?H=yl(ue,H):(H=Ac(H,J,v,null),H.flags|=2),H.return=h,A.return=h,A.sibling=H,h.child=A,A=H,H=h.child,J=a.child.memoizedState,J=J===null?z0(v):{baseLanes:J.baseLanes|v,cachePool:null,transitions:J.transitions},H.memoizedState=J,H.childLanes=a.childLanes&~v,h.memoizedState=V0,A}return H=a.child,a=H.sibling,A=yl(H,{mode:"visible",children:A.children}),(h.mode&1)===0&&(A.lanes=v),A.return=h,A.sibling=null,a!==null&&(v=h.deletions,v===null?(h.deletions=[a],h.flags|=16):v.push(a)),h.child=A,h.memoizedState=null,A}function B0(a,h){return h=up({mode:"visible",children:h},a.mode,0,null),h.return=a,a.child=h}function Qm(a,h,v,A){return A!==null&&m0(A),Lu(h,a.child,null,v),a=B0(h,h.pendingProps.children),a.flags|=2,h.memoizedState=null,a}function pR(a,h,v,A,z,H,J){if(v)return h.flags&256?(h.flags&=-257,A=M0(Error(t(422))),Qm(a,h,J,A)):h.memoizedState!==null?(h.child=a.child,h.flags|=128,null):(H=A.fallback,z=h.mode,A=up({mode:"visible",children:A.children},z,0,null),H=Ac(H,z,J,null),H.flags|=2,A.return=h,H.return=h,A.sibling=H,h.child=A,(h.mode&1)!==0&&Lu(h,a.child,null,J),h.child.memoizedState=z0(J),h.memoizedState=V0,H);if((h.mode&1)===0)return Qm(a,h,J,null);if(z.data==="$!"){if(A=z.nextSibling&&z.nextSibling.dataset,A)var ue=A.dgst;return A=ue,H=Error(t(419)),A=M0(H,A,void 0),Qm(a,h,J,A)}if(ue=(J&a.childLanes)!==0,Ci||ue){if(A=xr,A!==null){switch(J&-J){case 4:z=2;break;case 16:z=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:z=32;break;case 536870912:z=268435456;break;default:z=0}z=(z&(A.suspendedLanes|J))!==0?0:z,z!==0&&z!==H.retryLane&&(H.retryLane=z,oa(a,z),Xs(A,a,z,-1))}return rv(),A=M0(Error(t(421))),Qm(a,h,J,A)}return z.data==="$?"?(h.flags|=128,h.child=a.child,h=IR.bind(null,a),z._reactRetry=h,null):(a=H.treeContext,Qi=vo(z.nextSibling),Zi=h,Cn=!0,Ks=null,a!==null&&(ms[ps++]=ia,ms[ps++]=sa,ms[ps++]=yc,ia=a.id,sa=a.overflow,yc=h),h=B0(h,A.children),h.flags|=4096,h)}function Iw(a,h,v){a.lanes|=h;var A=a.alternate;A!==null&&(A.lanes|=h),v0(a.return,h,v)}function U0(a,h,v,A,z){var H=a.memoizedState;H===null?a.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:A,tail:v,tailMode:z}:(H.isBackwards=h,H.rendering=null,H.renderingStartTime=0,H.last=A,H.tail=v,H.tailMode=z)}function kw(a,h,v){var A=h.pendingProps,z=A.revealOrder,H=A.tail;if(oi(a,h,A.children,v),A=Dn.current,(A&2)!==0)A=A&1|2,h.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=h.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Iw(a,v,h);else if(a.tag===19)Iw(a,v,h);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===h)break e;for(;a.sibling===null;){if(a.return===null||a.return===h)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}A&=1}if(Sn(Dn,A),(h.mode&1)===0)h.memoizedState=null;else switch(z){case"forwards":for(v=h.child,z=null;v!==null;)a=v.alternate,a!==null&&Hm(a)===null&&(z=v),v=v.sibling;v=z,v===null?(z=h.child,h.child=null):(z=v.sibling,v.sibling=null),U0(h,!1,z,v,H);break;case"backwards":for(v=null,z=h.child,h.child=null;z!==null;){if(a=z.alternate,a!==null&&Hm(a)===null){h.child=z;break}a=z.sibling,z.sibling=v,v=z,z=a}U0(h,!0,v,null,H);break;case"together":U0(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function Xm(a,h){(h.mode&1)===0&&a!==null&&(a.alternate=null,h.alternate=null,h.flags|=2)}function la(a,h,v){if(a!==null&&(h.dependencies=a.dependencies),wc|=h.lanes,(v&h.childLanes)===0)return null;if(a!==null&&h.child!==a.child)throw Error(t(153));if(h.child!==null){for(a=h.child,v=yl(a,a.pendingProps),h.child=v,v.return=h;a.sibling!==null;)a=a.sibling,v=v.sibling=yl(a,a.pendingProps),v.return=h;v.sibling=null}return h.child}function gR(a,h,v){switch(h.tag){case 3:Sw(h),Du();break;case 5:q2(h);break;case 1:ki(h.type)&&Om(h);break;case 4:b0(h,h.stateNode.containerInfo);break;case 10:var A=h.type._context,z=h.memoizedProps.value;Sn(zm,A._currentValue),A._currentValue=z;break;case 13:if(A=h.memoizedState,A!==null)return A.dehydrated!==null?(Sn(Dn,Dn.current&1),h.flags|=128,null):(v&h.child.childLanes)!==0?Nw(a,h,v):(Sn(Dn,Dn.current&1),a=la(a,h,v),a!==null?a.sibling:null);Sn(Dn,Dn.current&1);break;case 19:if(A=(v&h.childLanes)!==0,(a.flags&128)!==0){if(A)return kw(a,h,v);h.flags|=128}if(z=h.memoizedState,z!==null&&(z.rendering=null,z.tail=null,z.lastEffect=null),Sn(Dn,Dn.current),A)break;return null;case 22:case 23:return h.lanes=0,ww(a,h,v)}return la(a,h,v)}var Cw,q0,Pw,Rw;Cw=function(a,h){for(var v=h.child;v!==null;){if(v.tag===5||v.tag===6)a.appendChild(v.stateNode);else if(v.tag!==4&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===h)break;for(;v.sibling===null;){if(v.return===null||v.return===h)return;v=v.return}v.sibling.return=v.return,v=v.sibling}},q0=function(){},Pw=function(a,h,v,A){var z=a.memoizedProps;if(z!==A){a=h.stateNode,xc(_o.current);var H=null;switch(v){case"input":z=ot(a,z),A=ot(a,A),H=[];break;case"select":z=Y({},z,{value:void 0}),A=Y({},A,{value:void 0}),H=[];break;case"textarea":z=ke(a,z),A=ke(a,A),H=[];break;default:typeof z.onClick!="function"&&typeof A.onClick=="function"&&(a.onclick=Ce)}gi(v,A);var J;v=null;for(Ee in z)if(!A.hasOwnProperty(Ee)&&z.hasOwnProperty(Ee)&&z[Ee]!=null)if(Ee==="style"){var ue=z[Ee];for(J in ue)ue.hasOwnProperty(J)&&(v||(v={}),v[J]="")}else Ee!=="dangerouslySetInnerHTML"&&Ee!=="children"&&Ee!=="suppressContentEditableWarning"&&Ee!=="suppressHydrationWarning"&&Ee!=="autoFocus"&&(i.hasOwnProperty(Ee)?H||(H=[]):(H=H||[]).push(Ee,null));for(Ee in A){var he=A[Ee];if(ue=z!=null?z[Ee]:void 0,A.hasOwnProperty(Ee)&&he!==ue&&(he!=null||ue!=null))if(Ee==="style")if(ue){for(J in ue)!ue.hasOwnProperty(J)||he&&he.hasOwnProperty(J)||(v||(v={}),v[J]="");for(J in he)he.hasOwnProperty(J)&&ue[J]!==he[J]&&(v||(v={}),v[J]=he[J])}else v||(H||(H=[]),H.push(Ee,v)),v=he;else Ee==="dangerouslySetInnerHTML"?(he=he?he.__html:void 0,ue=ue?ue.__html:void 0,he!=null&&ue!==he&&(H=H||[]).push(Ee,he)):Ee==="children"?typeof he!="string"&&typeof he!="number"||(H=H||[]).push(Ee,""+he):Ee!=="suppressContentEditableWarning"&&Ee!=="suppressHydrationWarning"&&(i.hasOwnProperty(Ee)?(he!=null&&Ee==="onScroll"&&_n("scroll",a),H||ue===he||(H=[])):(H=H||[]).push(Ee,he))}v&&(H=H||[]).push("style",v);var Ee=H;(h.updateQueue=Ee)&&(h.flags|=4)}},Rw=function(a,h,v,A){v!==A&&(h.flags|=4)};function fh(a,h){if(!Cn)switch(a.tailMode){case"hidden":h=a.tail;for(var v=null;h!==null;)h.alternate!==null&&(v=h),h=h.sibling;v===null?a.tail=null:v.sibling=null;break;case"collapsed":v=a.tail;for(var A=null;v!==null;)v.alternate!==null&&(A=v),v=v.sibling;A===null?h||a.tail===null?a.tail=null:a.tail.sibling=null:A.sibling=null}}function qr(a){var h=a.alternate!==null&&a.alternate.child===a.child,v=0,A=0;if(h)for(var z=a.child;z!==null;)v|=z.lanes|z.childLanes,A|=z.subtreeFlags&14680064,A|=z.flags&14680064,z.return=a,z=z.sibling;else for(z=a.child;z!==null;)v|=z.lanes|z.childLanes,A|=z.subtreeFlags,A|=z.flags,z.return=a,z=z.sibling;return a.subtreeFlags|=A,a.childLanes=v,h}function yR(a,h,v){var A=h.pendingProps;switch(d0(h),h.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return qr(h),null;case 1:return ki(h.type)&&jm(),qr(h),null;case 3:return A=h.stateNode,zu(),Nn(Ii),Nn(Br),T0(),A.pendingContext&&(A.context=A.pendingContext,A.pendingContext=null),(a===null||a.child===null)&&(Fm(h)?h.flags|=4:a===null||a.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,Ks!==null&&(ev(Ks),Ks=null))),q0(a,h),qr(h),null;case 5:w0(h);var z=xc(lh.current);if(v=h.type,a!==null&&h.stateNode!=null)Pw(a,h,v,A,z),a.ref!==h.ref&&(h.flags|=512,h.flags|=2097152);else{if(!A){if(h.stateNode===null)throw Error(t(166));return qr(h),null}if(a=xc(_o.current),Fm(h)){A=h.stateNode,v=h.type;var H=h.memoizedProps;switch(A[fs]=h,A[sl]=H,a=(h.mode&1)!==0,v){case"dialog":_n("cancel",A),_n("close",A);break;case"iframe":case"object":case"embed":_n("load",A);break;case"video":case"audio":for(z=0;z<nl.length;z++)_n(nl[z],A);break;case"source":_n("error",A);break;case"img":case"image":case"link":_n("error",A),_n("load",A);break;case"details":_n("toggle",A);break;case"input":nt(A,H),_n("invalid",A);break;case"select":A._wrapperState={wasMultiple:!!H.multiple},_n("invalid",A);break;case"textarea":gt(A,H),_n("invalid",A)}gi(v,H),z=null;for(var J in H)if(H.hasOwnProperty(J)){var ue=H[J];J==="children"?typeof ue=="string"?A.textContent!==ue&&(H.suppressHydrationWarning!==!0&&we(A.textContent,ue,a),z=["children",ue]):typeof ue=="number"&&A.textContent!==""+ue&&(H.suppressHydrationWarning!==!0&&we(A.textContent,ue,a),z=["children",""+ue]):i.hasOwnProperty(J)&&ue!=null&&J==="onScroll"&&_n("scroll",A)}switch(v){case"input":Ve(A),Se(A,H,!0);break;case"textarea":Ve(A),pt(A);break;case"select":case"option":break;default:typeof H.onClick=="function"&&(A.onclick=Ce)}A=z,h.updateQueue=A,A!==null&&(h.flags|=4)}else{J=z.nodeType===9?z:z.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=Ct(v)),a==="http://www.w3.org/1999/xhtml"?v==="script"?(a=J.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof A.is=="string"?a=J.createElement(v,{is:A.is}):(a=J.createElement(v),v==="select"&&(J=a,A.multiple?J.multiple=!0:A.size&&(J.size=A.size))):a=J.createElementNS(a,v),a[fs]=h,a[sl]=A,Cw(a,h,!1,!1),h.stateNode=a;e:{switch(J=ei(v,A),v){case"dialog":_n("cancel",a),_n("close",a),z=A;break;case"iframe":case"object":case"embed":_n("load",a),z=A;break;case"video":case"audio":for(z=0;z<nl.length;z++)_n(nl[z],a);z=A;break;case"source":_n("error",a),z=A;break;case"img":case"image":case"link":_n("error",a),_n("load",a),z=A;break;case"details":_n("toggle",a),z=A;break;case"input":nt(a,A),z=ot(a,A),_n("invalid",a);break;case"option":z=A;break;case"select":a._wrapperState={wasMultiple:!!A.multiple},z=Y({},A,{value:void 0}),_n("invalid",a);break;case"textarea":gt(a,A),z=ke(a,A),_n("invalid",a);break;default:z=A}gi(v,z),ue=z;for(H in ue)if(ue.hasOwnProperty(H)){var he=ue[H];H==="style"?pi(a,he):H==="dangerouslySetInnerHTML"?(he=he?he.__html:void 0,he!=null&&rs(a,he)):H==="children"?typeof he=="string"?(v!=="textarea"||he!=="")&&Ht(a,he):typeof he=="number"&&Ht(a,""+he):H!=="suppressContentEditableWarning"&&H!=="suppressHydrationWarning"&&H!=="autoFocus"&&(i.hasOwnProperty(H)?he!=null&&H==="onScroll"&&_n("scroll",a):he!=null&&P(a,H,he,J))}switch(v){case"input":Ve(a),Se(a,A,!1);break;case"textarea":Ve(a),pt(a);break;case"option":A.value!=null&&a.setAttribute("value",""+me(A.value));break;case"select":a.multiple=!!A.multiple,H=A.value,H!=null?ze(a,!!A.multiple,H,!1):A.defaultValue!=null&&ze(a,!!A.multiple,A.defaultValue,!0);break;default:typeof z.onClick=="function"&&(a.onclick=Ce)}switch(v){case"button":case"input":case"select":case"textarea":A=!!A.autoFocus;break e;case"img":A=!0;break e;default:A=!1}}A&&(h.flags|=4)}h.ref!==null&&(h.flags|=512,h.flags|=2097152)}return qr(h),null;case 6:if(a&&h.stateNode!=null)Rw(a,h,a.memoizedProps,A);else{if(typeof A!="string"&&h.stateNode===null)throw Error(t(166));if(v=xc(lh.current),xc(_o.current),Fm(h)){if(A=h.stateNode,v=h.memoizedProps,A[fs]=h,(H=A.nodeValue!==v)&&(a=Zi,a!==null))switch(a.tag){case 3:we(A.nodeValue,v,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&we(A.nodeValue,v,(a.mode&1)!==0)}H&&(h.flags|=4)}else A=(v.nodeType===9?v:v.ownerDocument).createTextNode(A),A[fs]=h,h.stateNode=A}return qr(h),null;case 13:if(Nn(Dn),A=h.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(Cn&&Qi!==null&&(h.mode&1)!==0&&(h.flags&128)===0)M2(),Du(),h.flags|=98560,H=!1;else if(H=Fm(h),A!==null&&A.dehydrated!==null){if(a===null){if(!H)throw Error(t(318));if(H=h.memoizedState,H=H!==null?H.dehydrated:null,!H)throw Error(t(317));H[fs]=h}else Du(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;qr(h),H=!1}else Ks!==null&&(ev(Ks),Ks=null),H=!0;if(!H)return h.flags&65536?h:null}return(h.flags&128)!==0?(h.lanes=v,h):(A=A!==null,A!==(a!==null&&a.memoizedState!==null)&&A&&(h.child.flags|=8192,(h.mode&1)!==0&&(a===null||(Dn.current&1)!==0?cr===0&&(cr=3):rv())),h.updateQueue!==null&&(h.flags|=4),qr(h),null);case 4:return zu(),q0(a,h),a===null&&rl(h.stateNode.containerInfo),qr(h),null;case 10:return y0(h.type._context),qr(h),null;case 17:return ki(h.type)&&jm(),qr(h),null;case 19:if(Nn(Dn),H=h.memoizedState,H===null)return qr(h),null;if(A=(h.flags&128)!==0,J=H.rendering,J===null)if(A)fh(H,!1);else{if(cr!==0||a!==null&&(a.flags&128)!==0)for(a=h.child;a!==null;){if(J=Hm(a),J!==null){for(h.flags|=128,fh(H,!1),A=J.updateQueue,A!==null&&(h.updateQueue=A,h.flags|=4),h.subtreeFlags=0,A=v,v=h.child;v!==null;)H=v,a=A,H.flags&=14680066,J=H.alternate,J===null?(H.childLanes=0,H.lanes=a,H.child=null,H.subtreeFlags=0,H.memoizedProps=null,H.memoizedState=null,H.updateQueue=null,H.dependencies=null,H.stateNode=null):(H.childLanes=J.childLanes,H.lanes=J.lanes,H.child=J.child,H.subtreeFlags=0,H.deletions=null,H.memoizedProps=J.memoizedProps,H.memoizedState=J.memoizedState,H.updateQueue=J.updateQueue,H.type=J.type,a=J.dependencies,H.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),v=v.sibling;return Sn(Dn,Dn.current&1|2),h.child}a=a.sibling}H.tail!==null&&Nt()>Hu&&(h.flags|=128,A=!0,fh(H,!1),h.lanes=4194304)}else{if(!A)if(a=Hm(J),a!==null){if(h.flags|=128,A=!0,v=a.updateQueue,v!==null&&(h.updateQueue=v,h.flags|=4),fh(H,!0),H.tail===null&&H.tailMode==="hidden"&&!J.alternate&&!Cn)return qr(h),null}else 2*Nt()-H.renderingStartTime>Hu&&v!==1073741824&&(h.flags|=128,A=!0,fh(H,!1),h.lanes=4194304);H.isBackwards?(J.sibling=h.child,h.child=J):(v=H.last,v!==null?v.sibling=J:h.child=J,H.last=J)}return H.tail!==null?(h=H.tail,H.rendering=h,H.tail=h.sibling,H.renderingStartTime=Nt(),h.sibling=null,v=Dn.current,Sn(Dn,A?v&1|2:v&1),h):(qr(h),null);case 22:case 23:return nv(),A=h.memoizedState!==null,a!==null&&a.memoizedState!==null!==A&&(h.flags|=8192),A&&(h.mode&1)!==0?(Xi&1073741824)!==0&&(qr(h),h.subtreeFlags&6&&(h.flags|=8192)):qr(h),null;case 24:return null;case 25:return null}throw Error(t(156,h.tag))}function vR(a,h){switch(d0(h),h.tag){case 1:return ki(h.type)&&jm(),a=h.flags,a&65536?(h.flags=a&-65537|128,h):null;case 3:return zu(),Nn(Ii),Nn(Br),T0(),a=h.flags,(a&65536)!==0&&(a&128)===0?(h.flags=a&-65537|128,h):null;case 5:return w0(h),null;case 13:if(Nn(Dn),a=h.memoizedState,a!==null&&a.dehydrated!==null){if(h.alternate===null)throw Error(t(340));Du()}return a=h.flags,a&65536?(h.flags=a&-65537|128,h):null;case 19:return Nn(Dn),null;case 4:return zu(),null;case 10:return y0(h.type._context),null;case 22:case 23:return nv(),null;case 24:return null;default:return null}}var Jm=!1,Hr=!1,_R=typeof WeakSet=="function"?WeakSet:Set,Ze=null;function Uu(a,h){var v=a.ref;if(v!==null)if(typeof v=="function")try{v(null)}catch(A){Bn(a,h,A)}else v.current=null}function H0(a,h,v){try{v()}catch(A){Bn(a,h,A)}}var jw=!1;function xR(a,h){if(He=Us,a=Zd(),Qd(a)){if("selectionStart"in a)var v={start:a.selectionStart,end:a.selectionEnd};else e:{v=(v=a.ownerDocument)&&v.defaultView||window;var A=v.getSelection&&v.getSelection();if(A&&A.rangeCount!==0){v=A.anchorNode;var z=A.anchorOffset,H=A.focusNode;A=A.focusOffset;try{v.nodeType,H.nodeType}catch{v=null;break e}var J=0,ue=-1,he=-1,Ee=0,Re=0,Oe=a,Pe=null;t:for(;;){for(var We;Oe!==v||z!==0&&Oe.nodeType!==3||(ue=J+z),Oe!==H||A!==0&&Oe.nodeType!==3||(he=J+A),Oe.nodeType===3&&(J+=Oe.nodeValue.length),(We=Oe.firstChild)!==null;)Pe=Oe,Oe=We;for(;;){if(Oe===a)break t;if(Pe===v&&++Ee===z&&(ue=J),Pe===H&&++Re===A&&(he=J),(We=Oe.nextSibling)!==null)break;Oe=Pe,Pe=Oe.parentNode}Oe=We}v=ue===-1||he===-1?null:{start:ue,end:he}}else v=null}v=v||{start:0,end:0}}else v=null;for(dt={focusedElem:a,selectionRange:v},Us=!1,Ze=h;Ze!==null;)if(h=Ze,a=h.child,(h.subtreeFlags&1028)!==0&&a!==null)a.return=h,Ze=a;else for(;Ze!==null;){h=Ze;try{var Xe=h.alternate;if((h.flags&1024)!==0)switch(h.tag){case 0:case 11:case 15:break;case 1:if(Xe!==null){var tt=Xe.memoizedProps,Gn=Xe.memoizedState,xe=h.stateNode,pe=xe.getSnapshotBeforeUpdate(h.elementType===h.type?tt:Ys(h.type,tt),Gn);xe.__reactInternalSnapshotBeforeUpdate=pe}break;case 3:var be=h.stateNode.containerInfo;be.nodeType===1?be.textContent="":be.nodeType===9&&be.documentElement&&be.removeChild(be.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Fe){Bn(h,h.return,Fe)}if(a=h.sibling,a!==null){a.return=h.return,Ze=a;break}Ze=h.return}return Xe=jw,jw=!1,Xe}function mh(a,h,v){var A=h.updateQueue;if(A=A!==null?A.lastEffect:null,A!==null){var z=A=A.next;do{if((z.tag&a)===a){var H=z.destroy;z.destroy=void 0,H!==void 0&&H0(h,v,H)}z=z.next}while(z!==A)}}function ep(a,h){if(h=h.updateQueue,h=h!==null?h.lastEffect:null,h!==null){var v=h=h.next;do{if((v.tag&a)===a){var A=v.create;v.destroy=A()}v=v.next}while(v!==h)}}function $0(a){var h=a.ref;if(h!==null){var v=a.stateNode;switch(a.tag){case 5:a=v;break;default:a=v}typeof h=="function"?h(a):h.current=a}}function Ow(a){var h=a.alternate;h!==null&&(a.alternate=null,Ow(h)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(h=a.stateNode,h!==null&&(delete h[fs],delete h[sl],delete h[ol],delete h[o0],delete h[a0])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function Mw(a){return a.tag===5||a.tag===3||a.tag===4}function Dw(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||Mw(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function W0(a,h,v){var A=a.tag;if(A===5||A===6)a=a.stateNode,h?v.nodeType===8?v.parentNode.insertBefore(a,h):v.insertBefore(a,h):(v.nodeType===8?(h=v.parentNode,h.insertBefore(a,v)):(h=v,h.appendChild(a)),v=v._reactRootContainer,v!=null||h.onclick!==null||(h.onclick=Ce));else if(A!==4&&(a=a.child,a!==null))for(W0(a,h,v),a=a.sibling;a!==null;)W0(a,h,v),a=a.sibling}function G0(a,h,v){var A=a.tag;if(A===5||A===6)a=a.stateNode,h?v.insertBefore(a,h):v.appendChild(a);else if(A!==4&&(a=a.child,a!==null))for(G0(a,h,v),a=a.sibling;a!==null;)G0(a,h,v),a=a.sibling}var kr=null,Zs=!1;function hl(a,h,v){for(v=v.child;v!==null;)Lw(a,h,v),v=v.sibling}function Lw(a,h,v){if(sr&&typeof sr.onCommitFiberUnmount=="function")try{sr.onCommitFiberUnmount(qi,v)}catch{}switch(v.tag){case 5:Hr||Uu(v,h);case 6:var A=kr,z=Zs;kr=null,hl(a,h,v),kr=A,Zs=z,kr!==null&&(Zs?(a=kr,v=v.stateNode,a.nodeType===8?a.parentNode.removeChild(v):a.removeChild(v)):kr.removeChild(v.stateNode));break;case 18:kr!==null&&(Zs?(a=kr,v=v.stateNode,a.nodeType===8?ih(a.parentNode,v):a.nodeType===1&&ih(a,v),or(a)):ih(kr,v.stateNode));break;case 4:A=kr,z=Zs,kr=v.stateNode.containerInfo,Zs=!0,hl(a,h,v),kr=A,Zs=z;break;case 0:case 11:case 14:case 15:if(!Hr&&(A=v.updateQueue,A!==null&&(A=A.lastEffect,A!==null))){z=A=A.next;do{var H=z,J=H.destroy;H=H.tag,J!==void 0&&((H&2)!==0||(H&4)!==0)&&H0(v,h,J),z=z.next}while(z!==A)}hl(a,h,v);break;case 1:if(!Hr&&(Uu(v,h),A=v.stateNode,typeof A.componentWillUnmount=="function"))try{A.props=v.memoizedProps,A.state=v.memoizedState,A.componentWillUnmount()}catch(ue){Bn(v,h,ue)}hl(a,h,v);break;case 21:hl(a,h,v);break;case 22:v.mode&1?(Hr=(A=Hr)||v.memoizedState!==null,hl(a,h,v),Hr=A):hl(a,h,v);break;default:hl(a,h,v)}}function Fw(a){var h=a.updateQueue;if(h!==null){a.updateQueue=null;var v=a.stateNode;v===null&&(v=a.stateNode=new _R),h.forEach(function(A){var z=kR.bind(null,a,A);v.has(A)||(v.add(A),A.then(z,z))})}}function Qs(a,h){var v=h.deletions;if(v!==null)for(var A=0;A<v.length;A++){var z=v[A];try{var H=a,J=h,ue=J;e:for(;ue!==null;){switch(ue.tag){case 5:kr=ue.stateNode,Zs=!1;break e;case 3:kr=ue.stateNode.containerInfo,Zs=!0;break e;case 4:kr=ue.stateNode.containerInfo,Zs=!0;break e}ue=ue.return}if(kr===null)throw Error(t(160));Lw(H,J,z),kr=null,Zs=!1;var he=z.alternate;he!==null&&(he.return=null),z.return=null}catch(Ee){Bn(z,h,Ee)}}if(h.subtreeFlags&12854)for(h=h.child;h!==null;)Vw(h,a),h=h.sibling}function Vw(a,h){var v=a.alternate,A=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(Qs(h,a),bo(a),A&4){try{mh(3,a,a.return),ep(3,a)}catch(tt){Bn(a,a.return,tt)}try{mh(5,a,a.return)}catch(tt){Bn(a,a.return,tt)}}break;case 1:Qs(h,a),bo(a),A&512&&v!==null&&Uu(v,v.return);break;case 5:if(Qs(h,a),bo(a),A&512&&v!==null&&Uu(v,v.return),a.flags&32){var z=a.stateNode;try{Ht(z,"")}catch(tt){Bn(a,a.return,tt)}}if(A&4&&(z=a.stateNode,z!=null)){var H=a.memoizedProps,J=v!==null?v.memoizedProps:H,ue=a.type,he=a.updateQueue;if(a.updateQueue=null,he!==null)try{ue==="input"&&H.type==="radio"&&H.name!=null&&It(z,H),ei(ue,J);var Ee=ei(ue,H);for(J=0;J<he.length;J+=2){var Re=he[J],Oe=he[J+1];Re==="style"?pi(z,Oe):Re==="dangerouslySetInnerHTML"?rs(z,Oe):Re==="children"?Ht(z,Oe):P(z,Re,Oe,Ee)}switch(ue){case"input":Gt(z,H);break;case"textarea":mt(z,H);break;case"select":var Pe=z._wrapperState.wasMultiple;z._wrapperState.wasMultiple=!!H.multiple;var We=H.value;We!=null?ze(z,!!H.multiple,We,!1):Pe!==!!H.multiple&&(H.defaultValue!=null?ze(z,!!H.multiple,H.defaultValue,!0):ze(z,!!H.multiple,H.multiple?[]:"",!1))}z[sl]=H}catch(tt){Bn(a,a.return,tt)}}break;case 6:if(Qs(h,a),bo(a),A&4){if(a.stateNode===null)throw Error(t(162));z=a.stateNode,H=a.memoizedProps;try{z.nodeValue=H}catch(tt){Bn(a,a.return,tt)}}break;case 3:if(Qs(h,a),bo(a),A&4&&v!==null&&v.memoizedState.isDehydrated)try{or(h.containerInfo)}catch(tt){Bn(a,a.return,tt)}break;case 4:Qs(h,a),bo(a);break;case 13:Qs(h,a),bo(a),z=a.child,z.flags&8192&&(H=z.memoizedState!==null,z.stateNode.isHidden=H,!H||z.alternate!==null&&z.alternate.memoizedState!==null||(Z0=Nt())),A&4&&Fw(a);break;case 22:if(Re=v!==null&&v.memoizedState!==null,a.mode&1?(Hr=(Ee=Hr)||Re,Qs(h,a),Hr=Ee):Qs(h,a),bo(a),A&8192){if(Ee=a.memoizedState!==null,(a.stateNode.isHidden=Ee)&&!Re&&(a.mode&1)!==0)for(Ze=a,Re=a.child;Re!==null;){for(Oe=Ze=Re;Ze!==null;){switch(Pe=Ze,We=Pe.child,Pe.tag){case 0:case 11:case 14:case 15:mh(4,Pe,Pe.return);break;case 1:Uu(Pe,Pe.return);var Xe=Pe.stateNode;if(typeof Xe.componentWillUnmount=="function"){A=Pe,v=Pe.return;try{h=A,Xe.props=h.memoizedProps,Xe.state=h.memoizedState,Xe.componentWillUnmount()}catch(tt){Bn(A,v,tt)}}break;case 5:Uu(Pe,Pe.return);break;case 22:if(Pe.memoizedState!==null){Uw(Oe);continue}}We!==null?(We.return=Pe,Ze=We):Uw(Oe)}Re=Re.sibling}e:for(Re=null,Oe=a;;){if(Oe.tag===5){if(Re===null){Re=Oe;try{z=Oe.stateNode,Ee?(H=z.style,typeof H.setProperty=="function"?H.setProperty("display","none","important"):H.display="none"):(ue=Oe.stateNode,he=Oe.memoizedProps.style,J=he!=null&&he.hasOwnProperty("display")?he.display:null,ue.style.display=Vi("display",J))}catch(tt){Bn(a,a.return,tt)}}}else if(Oe.tag===6){if(Re===null)try{Oe.stateNode.nodeValue=Ee?"":Oe.memoizedProps}catch(tt){Bn(a,a.return,tt)}}else if((Oe.tag!==22&&Oe.tag!==23||Oe.memoizedState===null||Oe===a)&&Oe.child!==null){Oe.child.return=Oe,Oe=Oe.child;continue}if(Oe===a)break e;for(;Oe.sibling===null;){if(Oe.return===null||Oe.return===a)break e;Re===Oe&&(Re=null),Oe=Oe.return}Re===Oe&&(Re=null),Oe.sibling.return=Oe.return,Oe=Oe.sibling}}break;case 19:Qs(h,a),bo(a),A&4&&Fw(a);break;case 21:break;default:Qs(h,a),bo(a)}}function bo(a){var h=a.flags;if(h&2){try{e:{for(var v=a.return;v!==null;){if(Mw(v)){var A=v;break e}v=v.return}throw Error(t(160))}switch(A.tag){case 5:var z=A.stateNode;A.flags&32&&(Ht(z,""),A.flags&=-33);var H=Dw(a);G0(a,H,z);break;case 3:case 4:var J=A.stateNode.containerInfo,ue=Dw(a);W0(a,ue,J);break;default:throw Error(t(161))}}catch(he){Bn(a,a.return,he)}a.flags&=-3}h&4096&&(a.flags&=-4097)}function bR(a,h,v){Ze=a,zw(a)}function zw(a,h,v){for(var A=(a.mode&1)!==0;Ze!==null;){var z=Ze,H=z.child;if(z.tag===22&&A){var J=z.memoizedState!==null||Jm;if(!J){var ue=z.alternate,he=ue!==null&&ue.memoizedState!==null||Hr;ue=Jm;var Ee=Hr;if(Jm=J,(Hr=he)&&!Ee)for(Ze=z;Ze!==null;)J=Ze,he=J.child,J.tag===22&&J.memoizedState!==null?qw(z):he!==null?(he.return=J,Ze=he):qw(z);for(;H!==null;)Ze=H,zw(H),H=H.sibling;Ze=z,Jm=ue,Hr=Ee}Bw(a)}else(z.subtreeFlags&8772)!==0&&H!==null?(H.return=z,Ze=H):Bw(a)}}function Bw(a){for(;Ze!==null;){var h=Ze;if((h.flags&8772)!==0){var v=h.alternate;try{if((h.flags&8772)!==0)switch(h.tag){case 0:case 11:case 15:Hr||ep(5,h);break;case 1:var A=h.stateNode;if(h.flags&4&&!Hr)if(v===null)A.componentDidMount();else{var z=h.elementType===h.type?v.memoizedProps:Ys(h.type,v.memoizedProps);A.componentDidUpdate(z,v.memoizedState,A.__reactInternalSnapshotBeforeUpdate)}var H=h.updateQueue;H!==null&&U2(h,H,A);break;case 3:var J=h.updateQueue;if(J!==null){if(v=null,h.child!==null)switch(h.child.tag){case 5:v=h.child.stateNode;break;case 1:v=h.child.stateNode}U2(h,J,v)}break;case 5:var ue=h.stateNode;if(v===null&&h.flags&4){v=ue;var he=h.memoizedProps;switch(h.type){case"button":case"input":case"select":case"textarea":he.autoFocus&&v.focus();break;case"img":he.src&&(v.src=he.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(h.memoizedState===null){var Ee=h.alternate;if(Ee!==null){var Re=Ee.memoizedState;if(Re!==null){var Oe=Re.dehydrated;Oe!==null&&or(Oe)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Hr||h.flags&512&&$0(h)}catch(Pe){Bn(h,h.return,Pe)}}if(h===a){Ze=null;break}if(v=h.sibling,v!==null){v.return=h.return,Ze=v;break}Ze=h.return}}function Uw(a){for(;Ze!==null;){var h=Ze;if(h===a){Ze=null;break}var v=h.sibling;if(v!==null){v.return=h.return,Ze=v;break}Ze=h.return}}function qw(a){for(;Ze!==null;){var h=Ze;try{switch(h.tag){case 0:case 11:case 15:var v=h.return;try{ep(4,h)}catch(he){Bn(h,v,he)}break;case 1:var A=h.stateNode;if(typeof A.componentDidMount=="function"){var z=h.return;try{A.componentDidMount()}catch(he){Bn(h,z,he)}}var H=h.return;try{$0(h)}catch(he){Bn(h,H,he)}break;case 5:var J=h.return;try{$0(h)}catch(he){Bn(h,J,he)}}}catch(he){Bn(h,h.return,he)}if(h===a){Ze=null;break}var ue=h.sibling;if(ue!==null){ue.return=h.return,Ze=ue;break}Ze=h.return}}var wR=Math.ceil,tp=I.ReactCurrentDispatcher,K0=I.ReactCurrentOwner,vs=I.ReactCurrentBatchConfig,Yt=0,xr=null,tr=null,Cr=0,Xi=0,qu=al(0),cr=0,ph=null,wc=0,np=0,Y0=0,gh=null,Pi=null,Z0=0,Hu=1/0,ca=null,rp=!1,Q0=null,fl=null,ip=!1,ml=null,sp=0,yh=0,X0=null,op=-1,ap=0;function ai(){return(Yt&6)!==0?Nt():op!==-1?op:op=Nt()}function pl(a){return(a.mode&1)===0?1:(Yt&2)!==0&&Cr!==0?Cr&-Cr:sR.transition!==null?(ap===0&&(ap=Uo()),ap):(a=Rt,a!==0||(a=window.event,a=a===void 0?16:jt(a.type)),a)}function Xs(a,h,v,A){if(50<yh)throw yh=0,X0=null,Error(t(185));Dr(a,v,A),((Yt&2)===0||a!==xr)&&(a===xr&&((Yt&2)===0&&(np|=v),cr===4&&gl(a,Cr)),Ri(a,A),v===1&&Yt===0&&(h.mode&1)===0&&(Hu=Nt()+500,Mm&&cl()))}function Ri(a,h){var v=a.callbackNode;bi(a,h);var A=un(a,a===xr?Cr:0);if(A===0)v!==null&&je(v),a.callbackNode=null,a.callbackPriority=0;else if(h=A&-A,a.callbackPriority!==h){if(v!=null&&je(v),h===1)a.tag===0?iR($w.bind(null,a)):C2($w.bind(null,a)),zr(function(){(Yt&6)===0&&cl()}),v=null;else{switch(wi(A)){case 1:v=kn;break;case 4:v=Zn;break;case 16:v=$n;break;case 536870912:v=vn;break;default:v=$n}v=Jw(v,Hw.bind(null,a))}a.callbackPriority=h,a.callbackNode=v}}function Hw(a,h){if(op=-1,ap=0,(Yt&6)!==0)throw Error(t(327));var v=a.callbackNode;if($u()&&a.callbackNode!==v)return null;var A=un(a,a===xr?Cr:0);if(A===0)return null;if((A&30)!==0||(A&a.expiredLanes)!==0||h)h=lp(a,A);else{h=A;var z=Yt;Yt|=2;var H=Gw();(xr!==a||Cr!==h)&&(ca=null,Hu=Nt()+500,Tc(a,h));do try{SR();break}catch(ue){Ww(a,ue)}while(!0);g0(),tp.current=H,Yt=z,tr!==null?h=0:(xr=null,Cr=0,h=cr)}if(h!==0){if(h===2&&(z=En(a),z!==0&&(A=z,h=J0(a,z))),h===1)throw v=ph,Tc(a,0),gl(a,A),Ri(a,Nt()),v;if(h===6)gl(a,A);else{if(z=a.current.alternate,(A&30)===0&&!ER(z)&&(h=lp(a,A),h===2&&(H=En(a),H!==0&&(A=H,h=J0(a,H))),h===1))throw v=ph,Tc(a,0),gl(a,A),Ri(a,Nt()),v;switch(a.finishedWork=z,a.finishedLanes=A,h){case 0:case 1:throw Error(t(345));case 2:Sc(a,Pi,ca);break;case 3:if(gl(a,A),(A&130023424)===A&&(h=Z0+500-Nt(),10<h)){if(un(a,0)!==0)break;if(z=a.suspendedLanes,(z&A)!==A){ai(),a.pingedLanes|=a.suspendedLanes&z;break}a.timeoutHandle=ar(Sc.bind(null,a,Pi,ca),h);break}Sc(a,Pi,ca);break;case 4:if(gl(a,A),(A&4194240)===A)break;for(h=a.eventTimes,z=-1;0<A;){var J=31-vt(A);H=1<<J,J=h[J],J>z&&(z=J),A&=~H}if(A=z,A=Nt()-A,A=(120>A?120:480>A?480:1080>A?1080:1920>A?1920:3e3>A?3e3:4320>A?4320:1960*wR(A/1960))-A,10<A){a.timeoutHandle=ar(Sc.bind(null,a,Pi,ca),A);break}Sc(a,Pi,ca);break;case 5:Sc(a,Pi,ca);break;default:throw Error(t(329))}}}return Ri(a,Nt()),a.callbackNode===v?Hw.bind(null,a):null}function J0(a,h){var v=gh;return a.current.memoizedState.isDehydrated&&(Tc(a,h).flags|=256),a=lp(a,h),a!==2&&(h=Pi,Pi=v,h!==null&&ev(h)),a}function ev(a){Pi===null?Pi=a:Pi.push.apply(Pi,a)}function ER(a){for(var h=a;;){if(h.flags&16384){var v=h.updateQueue;if(v!==null&&(v=v.stores,v!==null))for(var A=0;A<v.length;A++){var z=v[A],H=z.getSnapshot;z=z.value;try{if(!Ki(H(),z))return!1}catch{return!1}}}if(v=h.child,h.subtreeFlags&16384&&v!==null)v.return=h,h=v;else{if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function gl(a,h){for(h&=~Y0,h&=~np,a.suspendedLanes|=h,a.pingedLanes&=~h,a=a.expirationTimes;0<h;){var v=31-vt(h),A=1<<v;a[v]=-1,h&=~A}}function $w(a){if((Yt&6)!==0)throw Error(t(327));$u();var h=un(a,0);if((h&1)===0)return Ri(a,Nt()),null;var v=lp(a,h);if(a.tag!==0&&v===2){var A=En(a);A!==0&&(h=A,v=J0(a,A))}if(v===1)throw v=ph,Tc(a,0),gl(a,h),Ri(a,Nt()),v;if(v===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=h,Sc(a,Pi,ca),Ri(a,Nt()),null}function tv(a,h){var v=Yt;Yt|=1;try{return a(h)}finally{Yt=v,Yt===0&&(Hu=Nt()+500,Mm&&cl())}}function Ec(a){ml!==null&&ml.tag===0&&(Yt&6)===0&&$u();var h=Yt;Yt|=1;var v=vs.transition,A=Rt;try{if(vs.transition=null,Rt=1,a)return a()}finally{Rt=A,vs.transition=v,Yt=h,(Yt&6)===0&&cl()}}function nv(){Xi=qu.current,Nn(qu)}function Tc(a,h){a.finishedWork=null,a.finishedLanes=0;var v=a.timeoutHandle;if(v!==-1&&(a.timeoutHandle=-1,er(v)),tr!==null)for(v=tr.return;v!==null;){var A=v;switch(d0(A),A.tag){case 1:A=A.type.childContextTypes,A!=null&&jm();break;case 3:zu(),Nn(Ii),Nn(Br),T0();break;case 5:w0(A);break;case 4:zu();break;case 13:Nn(Dn);break;case 19:Nn(Dn);break;case 10:y0(A.type._context);break;case 22:case 23:nv()}v=v.return}if(xr=a,tr=a=yl(a.current,null),Cr=Xi=h,cr=0,ph=null,Y0=np=wc=0,Pi=gh=null,_c!==null){for(h=0;h<_c.length;h++)if(v=_c[h],A=v.interleaved,A!==null){v.interleaved=null;var z=A.next,H=v.pending;if(H!==null){var J=H.next;H.next=z,A.next=J}v.pending=A}_c=null}return a}function Ww(a,h){do{var v=tr;try{if(g0(),$m.current=Ym,Wm){for(var A=Ln.memoizedState;A!==null;){var z=A.queue;z!==null&&(z.pending=null),A=A.next}Wm=!1}if(bc=0,_r=lr=Ln=null,ch=!1,uh=0,K0.current=null,v===null||v.return===null){cr=1,ph=h,tr=null;break}e:{var H=a,J=v.return,ue=v,he=h;if(h=Cr,ue.flags|=32768,he!==null&&typeof he=="object"&&typeof he.then=="function"){var Ee=he,Re=ue,Oe=Re.tag;if((Re.mode&1)===0&&(Oe===0||Oe===11||Oe===15)){var Pe=Re.alternate;Pe?(Re.updateQueue=Pe.updateQueue,Re.memoizedState=Pe.memoizedState,Re.lanes=Pe.lanes):(Re.updateQueue=null,Re.memoizedState=null)}var We=yw(J);if(We!==null){We.flags&=-257,vw(We,J,ue,H,h),We.mode&1&&gw(H,Ee,h),h=We,he=Ee;var Xe=h.updateQueue;if(Xe===null){var tt=new Set;tt.add(he),h.updateQueue=tt}else Xe.add(he);break e}else{if((h&1)===0){gw(H,Ee,h),rv();break e}he=Error(t(426))}}else if(Cn&&ue.mode&1){var Gn=yw(J);if(Gn!==null){(Gn.flags&65536)===0&&(Gn.flags|=256),vw(Gn,J,ue,H,h),m0(Bu(he,ue));break e}}H=he=Bu(he,ue),cr!==4&&(cr=2),gh===null?gh=[H]:gh.push(H),H=J;do{switch(H.tag){case 3:H.flags|=65536,h&=-h,H.lanes|=h;var xe=mw(H,he,h);B2(H,xe);break e;case 1:ue=he;var pe=H.type,be=H.stateNode;if((H.flags&128)===0&&(typeof pe.getDerivedStateFromError=="function"||be!==null&&typeof be.componentDidCatch=="function"&&(fl===null||!fl.has(be)))){H.flags|=65536,h&=-h,H.lanes|=h;var Fe=pw(H,ue,h);B2(H,Fe);break e}}H=H.return}while(H!==null)}Yw(v)}catch(rt){h=rt,tr===v&&v!==null&&(tr=v=v.return);continue}break}while(!0)}function Gw(){var a=tp.current;return tp.current=Ym,a===null?Ym:a}function rv(){(cr===0||cr===3||cr===2)&&(cr=4),xr===null||(wc&268435455)===0&&(np&268435455)===0||gl(xr,Cr)}function lp(a,h){var v=Yt;Yt|=2;var A=Gw();(xr!==a||Cr!==h)&&(ca=null,Tc(a,h));do try{TR();break}catch(z){Ww(a,z)}while(!0);if(g0(),Yt=v,tp.current=A,tr!==null)throw Error(t(261));return xr=null,Cr=0,cr}function TR(){for(;tr!==null;)Kw(tr)}function SR(){for(;tr!==null&&!Ke();)Kw(tr)}function Kw(a){var h=Xw(a.alternate,a,Xi);a.memoizedProps=a.pendingProps,h===null?Yw(a):tr=h,K0.current=null}function Yw(a){var h=a;do{var v=h.alternate;if(a=h.return,(h.flags&32768)===0){if(v=yR(v,h,Xi),v!==null){tr=v;return}}else{if(v=vR(v,h),v!==null){v.flags&=32767,tr=v;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{cr=6,tr=null;return}}if(h=h.sibling,h!==null){tr=h;return}tr=h=a}while(h!==null);cr===0&&(cr=5)}function Sc(a,h,v){var A=Rt,z=vs.transition;try{vs.transition=null,Rt=1,AR(a,h,v,A)}finally{vs.transition=z,Rt=A}return null}function AR(a,h,v,A){do $u();while(ml!==null);if((Yt&6)!==0)throw Error(t(327));v=a.finishedWork;var z=a.finishedLanes;if(v===null)return null;if(a.finishedWork=null,a.finishedLanes=0,v===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var H=v.lanes|v.childLanes;if(_t(a,H),a===xr&&(tr=xr=null,Cr=0),(v.subtreeFlags&2064)===0&&(v.flags&2064)===0||ip||(ip=!0,Jw($n,function(){return $u(),null})),H=(v.flags&15990)!==0,(v.subtreeFlags&15990)!==0||H){H=vs.transition,vs.transition=null;var J=Rt;Rt=1;var ue=Yt;Yt|=4,K0.current=null,xR(a,v),Vw(v,a),ds(dt),Us=!!He,dt=He=null,a.current=v,bR(v),Kt(),Yt=ue,Rt=J,vs.transition=H}else a.current=v;if(ip&&(ip=!1,ml=a,sp=z),H=a.pendingLanes,H===0&&(fl=null),co(v.stateNode),Ri(a,Nt()),h!==null)for(A=a.onRecoverableError,v=0;v<h.length;v++)z=h[v],A(z.value,{componentStack:z.stack,digest:z.digest});if(rp)throw rp=!1,a=Q0,Q0=null,a;return(sp&1)!==0&&a.tag!==0&&$u(),H=a.pendingLanes,(H&1)!==0?a===X0?yh++:(yh=0,X0=a):yh=0,cl(),null}function $u(){if(ml!==null){var a=wi(sp),h=vs.transition,v=Rt;try{if(vs.transition=null,Rt=16>a?16:a,ml===null)var A=!1;else{if(a=ml,ml=null,sp=0,(Yt&6)!==0)throw Error(t(331));var z=Yt;for(Yt|=4,Ze=a.current;Ze!==null;){var H=Ze,J=H.child;if((Ze.flags&16)!==0){var ue=H.deletions;if(ue!==null){for(var he=0;he<ue.length;he++){var Ee=ue[he];for(Ze=Ee;Ze!==null;){var Re=Ze;switch(Re.tag){case 0:case 11:case 15:mh(8,Re,H)}var Oe=Re.child;if(Oe!==null)Oe.return=Re,Ze=Oe;else for(;Ze!==null;){Re=Ze;var Pe=Re.sibling,We=Re.return;if(Ow(Re),Re===Ee){Ze=null;break}if(Pe!==null){Pe.return=We,Ze=Pe;break}Ze=We}}}var Xe=H.alternate;if(Xe!==null){var tt=Xe.child;if(tt!==null){Xe.child=null;do{var Gn=tt.sibling;tt.sibling=null,tt=Gn}while(tt!==null)}}Ze=H}}if((H.subtreeFlags&2064)!==0&&J!==null)J.return=H,Ze=J;else e:for(;Ze!==null;){if(H=Ze,(H.flags&2048)!==0)switch(H.tag){case 0:case 11:case 15:mh(9,H,H.return)}var xe=H.sibling;if(xe!==null){xe.return=H.return,Ze=xe;break e}Ze=H.return}}var pe=a.current;for(Ze=pe;Ze!==null;){J=Ze;var be=J.child;if((J.subtreeFlags&2064)!==0&&be!==null)be.return=J,Ze=be;else e:for(J=pe;Ze!==null;){if(ue=Ze,(ue.flags&2048)!==0)try{switch(ue.tag){case 0:case 11:case 15:ep(9,ue)}}catch(rt){Bn(ue,ue.return,rt)}if(ue===J){Ze=null;break e}var Fe=ue.sibling;if(Fe!==null){Fe.return=ue.return,Ze=Fe;break e}Ze=ue.return}}if(Yt=z,cl(),sr&&typeof sr.onPostCommitFiberRoot=="function")try{sr.onPostCommitFiberRoot(qi,a)}catch{}A=!0}return A}finally{Rt=v,vs.transition=h}}return!1}function Zw(a,h,v){h=Bu(v,h),h=mw(a,h,1),a=dl(a,h,1),h=ai(),a!==null&&(Dr(a,1,h),Ri(a,h))}function Bn(a,h,v){if(a.tag===3)Zw(a,a,v);else for(;h!==null;){if(h.tag===3){Zw(h,a,v);break}else if(h.tag===1){var A=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof A.componentDidCatch=="function"&&(fl===null||!fl.has(A))){a=Bu(v,a),a=pw(h,a,1),h=dl(h,a,1),a=ai(),h!==null&&(Dr(h,1,a),Ri(h,a));break}}h=h.return}}function NR(a,h,v){var A=a.pingCache;A!==null&&A.delete(h),h=ai(),a.pingedLanes|=a.suspendedLanes&v,xr===a&&(Cr&v)===v&&(cr===4||cr===3&&(Cr&130023424)===Cr&&500>Nt()-Z0?Tc(a,0):Y0|=v),Ri(a,h)}function Qw(a,h){h===0&&((a.mode&1)===0?h=1:(h=uo,uo<<=1,(uo&130023424)===0&&(uo=4194304)));var v=ai();a=oa(a,h),a!==null&&(Dr(a,h,v),Ri(a,v))}function IR(a){var h=a.memoizedState,v=0;h!==null&&(v=h.retryLane),Qw(a,v)}function kR(a,h){var v=0;switch(a.tag){case 13:var A=a.stateNode,z=a.memoizedState;z!==null&&(v=z.retryLane);break;case 19:A=a.stateNode;break;default:throw Error(t(314))}A!==null&&A.delete(h),Qw(a,v)}var Xw;Xw=function(a,h,v){if(a!==null)if(a.memoizedProps!==h.pendingProps||Ii.current)Ci=!0;else{if((a.lanes&v)===0&&(h.flags&128)===0)return Ci=!1,gR(a,h,v);Ci=(a.flags&131072)!==0}else Ci=!1,Cn&&(h.flags&1048576)!==0&&P2(h,Lm,h.index);switch(h.lanes=0,h.tag){case 2:var A=h.type;Xm(a,h),a=h.pendingProps;var z=ju(h,Br.current);Vu(h,v),z=N0(null,h,A,a,z,v);var H=I0();return h.flags|=1,typeof z=="object"&&z!==null&&typeof z.render=="function"&&z.$$typeof===void 0?(h.tag=1,h.memoizedState=null,h.updateQueue=null,ki(A)?(H=!0,Om(h)):H=!1,h.memoizedState=z.state!==null&&z.state!==void 0?z.state:null,x0(h),z.updater=Zm,h.stateNode=z,z._reactInternals=h,O0(h,A,a,v),h=F0(null,h,A,!0,H,v)):(h.tag=0,Cn&&H&&u0(h),oi(null,h,z,v),h=h.child),h;case 16:A=h.elementType;e:{switch(Xm(a,h),a=h.pendingProps,z=A._init,A=z(A._payload),h.type=A,z=h.tag=PR(A),a=Ys(A,a),z){case 0:h=L0(null,h,A,a,v);break e;case 1:h=Tw(null,h,A,a,v);break e;case 11:h=_w(null,h,A,a,v);break e;case 14:h=xw(null,h,A,Ys(A.type,a),v);break e}throw Error(t(306,A,""))}return h;case 0:return A=h.type,z=h.pendingProps,z=h.elementType===A?z:Ys(A,z),L0(a,h,A,z,v);case 1:return A=h.type,z=h.pendingProps,z=h.elementType===A?z:Ys(A,z),Tw(a,h,A,z,v);case 3:e:{if(Sw(h),a===null)throw Error(t(387));A=h.pendingProps,H=h.memoizedState,z=H.element,z2(a,h),qm(h,A,null,v);var J=h.memoizedState;if(A=J.element,H.isDehydrated)if(H={element:A,isDehydrated:!1,cache:J.cache,pendingSuspenseBoundaries:J.pendingSuspenseBoundaries,transitions:J.transitions},h.updateQueue.baseState=H,h.memoizedState=H,h.flags&256){z=Bu(Error(t(423)),h),h=Aw(a,h,A,v,z);break e}else if(A!==z){z=Bu(Error(t(424)),h),h=Aw(a,h,A,v,z);break e}else for(Qi=vo(h.stateNode.containerInfo.firstChild),Zi=h,Cn=!0,Ks=null,v=F2(h,null,A,v),h.child=v;v;)v.flags=v.flags&-3|4096,v=v.sibling;else{if(Du(),A===z){h=la(a,h,v);break e}oi(a,h,A,v)}h=h.child}return h;case 5:return q2(h),a===null&&f0(h),A=h.type,z=h.pendingProps,H=a!==null?a.memoizedProps:null,J=z.children,Pt(A,z)?J=null:H!==null&&Pt(A,H)&&(h.flags|=32),Ew(a,h),oi(a,h,J,v),h.child;case 6:return a===null&&f0(h),null;case 13:return Nw(a,h,v);case 4:return b0(h,h.stateNode.containerInfo),A=h.pendingProps,a===null?h.child=Lu(h,null,A,v):oi(a,h,A,v),h.child;case 11:return A=h.type,z=h.pendingProps,z=h.elementType===A?z:Ys(A,z),_w(a,h,A,z,v);case 7:return oi(a,h,h.pendingProps,v),h.child;case 8:return oi(a,h,h.pendingProps.children,v),h.child;case 12:return oi(a,h,h.pendingProps.children,v),h.child;case 10:e:{if(A=h.type._context,z=h.pendingProps,H=h.memoizedProps,J=z.value,Sn(zm,A._currentValue),A._currentValue=J,H!==null)if(Ki(H.value,J)){if(H.children===z.children&&!Ii.current){h=la(a,h,v);break e}}else for(H=h.child,H!==null&&(H.return=h);H!==null;){var ue=H.dependencies;if(ue!==null){J=H.child;for(var he=ue.firstContext;he!==null;){if(he.context===A){if(H.tag===1){he=aa(-1,v&-v),he.tag=2;var Ee=H.updateQueue;if(Ee!==null){Ee=Ee.shared;var Re=Ee.pending;Re===null?he.next=he:(he.next=Re.next,Re.next=he),Ee.pending=he}}H.lanes|=v,he=H.alternate,he!==null&&(he.lanes|=v),v0(H.return,v,h),ue.lanes|=v;break}he=he.next}}else if(H.tag===10)J=H.type===h.type?null:H.child;else if(H.tag===18){if(J=H.return,J===null)throw Error(t(341));J.lanes|=v,ue=J.alternate,ue!==null&&(ue.lanes|=v),v0(J,v,h),J=H.sibling}else J=H.child;if(J!==null)J.return=H;else for(J=H;J!==null;){if(J===h){J=null;break}if(H=J.sibling,H!==null){H.return=J.return,J=H;break}J=J.return}H=J}oi(a,h,z.children,v),h=h.child}return h;case 9:return z=h.type,A=h.pendingProps.children,Vu(h,v),z=gs(z),A=A(z),h.flags|=1,oi(a,h,A,v),h.child;case 14:return A=h.type,z=Ys(A,h.pendingProps),z=Ys(A.type,z),xw(a,h,A,z,v);case 15:return bw(a,h,h.type,h.pendingProps,v);case 17:return A=h.type,z=h.pendingProps,z=h.elementType===A?z:Ys(A,z),Xm(a,h),h.tag=1,ki(A)?(a=!0,Om(h)):a=!1,Vu(h,v),hw(h,A,z),O0(h,A,z,v),F0(null,h,A,!0,a,v);case 19:return kw(a,h,v);case 22:return ww(a,h,v)}throw Error(t(156,h.tag))};function Jw(a,h){return fe(a,h)}function CR(a,h,v,A){this.tag=a,this.key=v,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=A,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function _s(a,h,v,A){return new CR(a,h,v,A)}function iv(a){return a=a.prototype,!(!a||!a.isReactComponent)}function PR(a){if(typeof a=="function")return iv(a)?1:0;if(a!=null){if(a=a.$$typeof,a===D)return 11;if(a===G)return 14}return 2}function yl(a,h){var v=a.alternate;return v===null?(v=_s(a.tag,h,a.key,a.mode),v.elementType=a.elementType,v.type=a.type,v.stateNode=a.stateNode,v.alternate=a,a.alternate=v):(v.pendingProps=h,v.type=a.type,v.flags=0,v.subtreeFlags=0,v.deletions=null),v.flags=a.flags&14680064,v.childLanes=a.childLanes,v.lanes=a.lanes,v.child=a.child,v.memoizedProps=a.memoizedProps,v.memoizedState=a.memoizedState,v.updateQueue=a.updateQueue,h=a.dependencies,v.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},v.sibling=a.sibling,v.index=a.index,v.ref=a.ref,v}function cp(a,h,v,A,z,H){var J=2;if(A=a,typeof a=="function")iv(a)&&(J=1);else if(typeof a=="string")J=5;else e:switch(a){case j:return Ac(v.children,z,H,h);case k:J=8,z|=8;break;case F:return a=_s(12,v,h,z|2),a.elementType=F,a.lanes=H,a;case M:return a=_s(13,v,h,z),a.elementType=M,a.lanes=H,a;case $:return a=_s(19,v,h,z),a.elementType=$,a.lanes=H,a;case oe:return up(v,z,H,h);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case O:J=10;break e;case C:J=9;break e;case D:J=11;break e;case G:J=14;break e;case re:J=16,A=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return h=_s(J,v,h,z),h.elementType=a,h.type=A,h.lanes=H,h}function Ac(a,h,v,A){return a=_s(7,a,A,h),a.lanes=v,a}function up(a,h,v,A){return a=_s(22,a,A,h),a.elementType=oe,a.lanes=v,a.stateNode={isHidden:!1},a}function sv(a,h,v){return a=_s(6,a,null,h),a.lanes=v,a}function ov(a,h,v){return h=_s(4,a.children!==null?a.children:[],a.key,h),h.lanes=v,h.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},h}function RR(a,h,v,A,z){this.tag=h,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=$i(0),this.expirationTimes=$i(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=$i(0),this.identifierPrefix=A,this.onRecoverableError=z,this.mutableSourceEagerHydrationData=null}function av(a,h,v,A,z,H,J,ue,he){return a=new RR(a,h,v,ue,he),h===1?(h=1,H===!0&&(h|=8)):h=0,H=_s(3,null,null,h),a.current=H,H.stateNode=a,H.memoizedState={element:A,isDehydrated:v,cache:null,transitions:null,pendingSuspenseBoundaries:null},x0(H),a}function jR(a,h,v){var A=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U,key:A==null?null:""+A,children:a,containerInfo:h,implementation:v}}function eE(a){if(!a)return ll;a=a._reactInternals;e:{if(Tr(a)!==a||a.tag!==1)throw Error(t(170));var h=a;do{switch(h.tag){case 3:h=h.stateNode.context;break e;case 1:if(ki(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break e}}h=h.return}while(h!==null);throw Error(t(171))}if(a.tag===1){var v=a.type;if(ki(v))return I2(a,v,h)}return h}function tE(a,h,v,A,z,H,J,ue,he){return a=av(v,A,!0,a,z,H,J,ue,he),a.context=eE(null),v=a.current,A=ai(),z=pl(v),H=aa(A,z),H.callback=h??null,dl(v,H,z),a.current.lanes=z,Dr(a,z,A),Ri(a,A),a}function dp(a,h,v,A){var z=h.current,H=ai(),J=pl(z);return v=eE(v),h.context===null?h.context=v:h.pendingContext=v,h=aa(H,J),h.payload={element:a},A=A===void 0?null:A,A!==null&&(h.callback=A),a=dl(z,h,J),a!==null&&(Xs(a,z,J,H),Um(a,z,J)),J}function hp(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function nE(a,h){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var v=a.retryLane;a.retryLane=v!==0&&v<h?v:h}}function lv(a,h){nE(a,h),(a=a.alternate)&&nE(a,h)}function OR(){return null}var rE=typeof reportError=="function"?reportError:function(a){console.error(a)};function cv(a){this._internalRoot=a}fp.prototype.render=cv.prototype.render=function(a){var h=this._internalRoot;if(h===null)throw Error(t(409));dp(a,h,null,null)},fp.prototype.unmount=cv.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var h=a.containerInfo;Ec(function(){dp(null,a,null,null)}),h[sn]=null}};function fp(a){this._internalRoot=a}fp.prototype.unstable_scheduleHydration=function(a){if(a){var h=Va();a={blockedOn:null,target:a,priority:h};for(var v=0;v<Wn.length&&h!==0&&h<Wn[v].priority;v++);Wn.splice(v,0,a),v===0&&za(a)}};function uv(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function mp(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function iE(){}function MR(a,h,v,A,z){if(z){if(typeof A=="function"){var H=A;A=function(){var Ee=hp(J);H.call(Ee)}}var J=tE(h,A,a,0,null,!1,!1,"",iE);return a._reactRootContainer=J,a[sn]=J.current,rl(a.nodeType===8?a.parentNode:a),Ec(),J}for(;z=a.lastChild;)a.removeChild(z);if(typeof A=="function"){var ue=A;A=function(){var Ee=hp(he);ue.call(Ee)}}var he=av(a,0,!1,null,null,!1,!1,"",iE);return a._reactRootContainer=he,a[sn]=he.current,rl(a.nodeType===8?a.parentNode:a),Ec(function(){dp(h,he,v,A)}),he}function pp(a,h,v,A,z){var H=v._reactRootContainer;if(H){var J=H;if(typeof z=="function"){var ue=z;z=function(){var he=hp(J);ue.call(he)}}dp(h,J,a,z)}else J=MR(v,h,a,z,A);return hp(J)}La=function(a){switch(a.tag){case 3:var h=a.stateNode;if(h.current.memoizedState.isDehydrated){var v=yt(h.pendingLanes);v!==0&&(Lr(h,v|1),Ri(h,Nt()),(Yt&6)===0&&(Hu=Nt()+500,cl()))}break;case 13:Ec(function(){var A=oa(a,1);if(A!==null){var z=ai();Xs(A,a,1,z)}}),lv(a,1)}},as=function(a){if(a.tag===13){var h=oa(a,134217728);if(h!==null){var v=ai();Xs(h,a,134217728,v)}lv(a,134217728)}},Fa=function(a){if(a.tag===13){var h=pl(a),v=oa(a,h);if(v!==null){var A=ai();Xs(v,a,h,A)}lv(a,h)}},Va=function(){return Rt},qo=function(a,h){var v=Rt;try{return Rt=a,h()}finally{Rt=v}},yi=function(a,h,v){switch(h){case"input":if(Gt(a,v),h=v.name,v.type==="radio"&&h!=null){for(v=a;v.parentNode;)v=v.parentNode;for(v=v.querySelectorAll("input[name="+JSON.stringify(""+h)+'][type="radio"]'),h=0;h<v.length;h++){var A=v[h];if(A!==a&&A.form===a.form){var z=Pu(A);if(!z)throw Error(t(90));Ye(A),Gt(A,z)}}}break;case"textarea":mt(a,v);break;case"select":h=v.value,h!=null&&ze(a,!!v.multiple,h,!1)}},yn=tv,xi=Ec;var DR={usingClientEntryPoint:!1,Events:[ta,na,Pu,_i,Fo,tv]},vh={findFiberByHostInstance:ea,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},LR={bundleType:vh.bundleType,version:vh.version,rendererPackageName:vh.rendererPackageName,rendererConfig:vh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:I.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=zo(a),a===null?null:a.stateNode},findFiberByHostInstance:vh.findFiberByHostInstance||OR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var gp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!gp.isDisabled&&gp.supportsFiber)try{qi=gp.inject(LR),sr=gp}catch{}}return ji.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DR,ji.createPortal=function(a,h){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!uv(h))throw Error(t(200));return jR(a,h,null,v)},ji.createRoot=function(a,h){if(!uv(a))throw Error(t(299));var v=!1,A="",z=rE;return h!=null&&(h.unstable_strictMode===!0&&(v=!0),h.identifierPrefix!==void 0&&(A=h.identifierPrefix),h.onRecoverableError!==void 0&&(z=h.onRecoverableError)),h=av(a,1,!1,null,null,v,!1,A,z),a[sn]=h.current,rl(a.nodeType===8?a.parentNode:a),new cv(h)},ji.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var h=a._reactInternals;if(h===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=zo(h),a=a===null?null:a.stateNode,a},ji.flushSync=function(a){return Ec(a)},ji.hydrate=function(a,h,v){if(!mp(h))throw Error(t(200));return pp(null,a,h,!0,v)},ji.hydrateRoot=function(a,h,v){if(!uv(a))throw Error(t(405));var A=v!=null&&v.hydratedSources||null,z=!1,H="",J=rE;if(v!=null&&(v.unstable_strictMode===!0&&(z=!0),v.identifierPrefix!==void 0&&(H=v.identifierPrefix),v.onRecoverableError!==void 0&&(J=v.onRecoverableError)),h=tE(h,null,a,1,v??null,z,!1,H,J),a[sn]=h.current,rl(a),A)for(a=0;a<A.length;a++)v=A[a],z=v._getVersion,z=z(v._source),h.mutableSourceEagerHydrationData==null?h.mutableSourceEagerHydrationData=[v,z]:h.mutableSourceEagerHydrationData.push(v,z);return new fp(h)},ji.render=function(a,h,v){if(!mp(h))throw Error(t(200));return pp(null,a,h,!1,v)},ji.unmountComponentAtNode=function(a){if(!mp(a))throw Error(t(40));return a._reactRootContainer?(Ec(function(){pp(null,null,a,!1,function(){a._reactRootContainer=null,a[sn]=null})}),!0):!1},ji.unstable_batchedUpdates=tv,ji.unstable_renderSubtreeIntoContainer=function(a,h,v,A){if(!mp(v))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return pp(a,h,v,!1,A)},ji.version="18.3.1-next-f1338f8080-20240426",ji}var hE;function Rx(){if(hE)return fv.exports;hE=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),fv.exports=WR(),fv.exports}var fE;function GR(){if(fE)return vp;fE=1;var n=Rx();return vp.createRoot=n.createRoot,vp.hydrateRoot=n.hydrateRoot,vp}var KR=GR();const YR=Px(KR),ZR=()=>{};var mE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BI=function(n){const e=[];let t=0;for(let r=0;r<n.length;r++){let i=n.charCodeAt(r);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&r+1<n.length&&(n.charCodeAt(r+1)&64512)===56320?(i=65536+((i&1023)<<10)+(n.charCodeAt(++r)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},QR=function(n){const e=[];let t=0,r=0;for(;t<n.length;){const i=n[t++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=n[t++];e[r++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=n[t++],o=n[t++],l=n[t++],d=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(d>>10)),e[r++]=String.fromCharCode(56320+(d&1023))}else{const s=n[t++],o=n[t++];e[r++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},UI={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(n,e){if(!Array.isArray(n))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<n.length;i+=3){const s=n[i],o=i+1<n.length,l=o?n[i+1]:0,d=i+2<n.length,f=d?n[i+2]:0,m=s>>2,y=(s&3)<<4|l>>4;let g=(l&15)<<2|f>>6,_=f&63;d||(_=64,o||(g=64)),r.push(t[m],t[y],t[g],t[_])}return r.join("")},encodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(n):this.encodeByteArray(BI(n),e)},decodeString(n,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(n):QR(this.decodeStringToByteArray(n,e))},decodeStringToByteArray(n,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<n.length;){const s=t[n.charAt(i++)],l=i<n.length?t[n.charAt(i)]:0;++i;const f=i<n.length?t[n.charAt(i)]:64;++i;const y=i<n.length?t[n.charAt(i)]:64;if(++i,s==null||l==null||f==null||y==null)throw new XR;const g=s<<2|l>>4;if(r.push(g),f!==64){const _=l<<4&240|f>>2;if(r.push(_),y!==64){const E=f<<6&192|y;r.push(E)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let n=0;n<this.ENCODED_VALS.length;n++)this.byteToCharMap_[n]=this.ENCODED_VALS.charAt(n),this.charToByteMap_[this.byteToCharMap_[n]]=n,this.byteToCharMapWebSafe_[n]=this.ENCODED_VALS_WEBSAFE.charAt(n),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[n]]=n,n>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(n)]=n,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(n)]=n)}}};class XR extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const JR=function(n){const e=BI(n);return UI.encodeByteArray(e,!0)},yg=function(n){return JR(n).replace(/\./g,"")},qI=function(n){try{return UI.decodeString(n,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HI(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const e5=()=>HI().__FIREBASE_DEFAULTS__,t5=()=>{if(typeof process>"u"||typeof mE>"u")return;const n=mE.__FIREBASE_DEFAULTS__;if(n)return JSON.parse(n)},n5=()=>{if(typeof document>"u")return;let n;try{n=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=n&&qI(n[1]);return e&&JSON.parse(e)},ay=()=>{try{return ZR()||e5()||t5()||n5()}catch(n){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${n}`);return}},$I=n=>{var e,t;return(t=(e=ay())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[n]},WI=n=>{const e=$I(n);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),r]:[e.substring(0,t),r]},GI=()=>{var n;return(n=ay())===null||n===void 0?void 0:n.config},KI=n=>{var e;return(e=ay())===null||e===void 0?void 0:e[`_${n}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uu(n){return n.endsWith(".cloudworkstations.dev")}async function jx(n){return(await fetch(n,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function i5(n,e){if(n.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},r=e||"demo-project",i=n.iat||0,s=n.sub||n.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},n);return[yg(JSON.stringify(t)),yg(JSON.stringify(o)),""].join(".")}const of={};function s5(){const n={prod:[],emulator:[]};for(const e of Object.keys(of))of[e]?n.emulator.push(e):n.prod.push(e);return n}function o5(n){let e=document.getElementById(n),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",n),t=!0),{created:t,element:e}}let pE=!1;function Ox(n,e){if(typeof window>"u"||typeof document>"u"||!uu(window.location.host)||of[n]===e||of[n]||pE)return;of[n]=e;function t(g){return`__firebase__banner__${g}`}const r="__firebase__banner",s=s5().prod.length>0;function o(){const g=document.getElementById(r);g&&g.remove()}function l(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function d(g,_){g.setAttribute("width","24"),g.setAttribute("id",_),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function f(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{pE=!0,o()},g}function m(g,_){g.setAttribute("id",_),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function y(){const g=o5(r),_=t("text"),E=document.getElementById(_)||document.createElement("span"),x=t("learnmore"),w=document.getElementById(x)||document.createElement("a"),S=t("preprendIcon"),N=document.getElementById(S)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const P=g.element;l(P),m(w,x);const I=f();d(N,S),P.append(N,E,w,I),document.body.appendChild(P)}s?(E.innerText="Preview backend disconnected.",N.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(N.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function a5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(fr())}function YI(){var n;const e=(n=ay())===null||n===void 0?void 0:n.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function l5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function c5(){const n=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof n=="object"&&n.id!==void 0}function u5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function d5(){const n=fr();return n.indexOf("MSIE ")>=0||n.indexOf("Trident/")>=0}function ZI(){return!YI()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function QI(){return!YI()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function XI(){try{return typeof indexedDB=="object"}catch{return!1}}function h5(){return new Promise((n,e)=>{try{let t=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(r),n(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f5="FirebaseError";class Na extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=f5,Object.setPrototypeOf(this,Na.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qf.prototype.create)}}class Qf{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){const r=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?m5(s,r):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new Na(i,l,r)}}function m5(n,e){return n.replace(p5,(t,r)=>{const i=e[r];return i!=null?String(i):`<${r}?>`})}const p5=/\{\$([^}]+)}/g;function g5(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}function zl(n,e){if(n===e)return!0;const t=Object.keys(n),r=Object.keys(e);for(const i of t){if(!r.includes(i))return!1;const s=n[i],o=e[i];if(gE(s)&&gE(o)){if(!zl(s,o))return!1}else if(s!==o)return!1}for(const i of r)if(!t.includes(i))return!1;return!0}function gE(n){return n!==null&&typeof n=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xf(n){const e=[];for(const[t,r]of Object.entries(n))Array.isArray(r)?r.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function qh(n){const e={};return n.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[i,s]=r.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function Hh(n){const e=n.indexOf("?");if(!e)return"";const t=n.indexOf("#",e);return n.substring(e,t>0?t:void 0)}function y5(n,e){const t=new v5(n,e);return t.subscribe.bind(t)}class v5{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,r){let i;if(e===void 0&&t===void 0&&r===void 0)throw new Error("Missing Observer.");_5(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:r},i.next===void 0&&(i.next=gv),i.error===void 0&&(i.error=gv),i.complete===void 0&&(i.complete=gv);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function _5(n,e){if(typeof n!="object"||n===null)return!1;for(const t of e)if(t in n&&typeof n[t]=="function")return!0;return!1}function gv(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rn(n){return n&&n._delegate?n._delegate:n}class Bl{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Pc="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x5{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const r=new r5;if(this.instancesDeferred.set(t,r),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&r.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(w5(e))try{this.getOrInitializeService({instanceIdentifier:Pc})}catch{}for(const[t,r]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});r.resolve(s)}catch{}}}}clearInstance(e=Pc){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Pc){return this.instances.has(e)}getOptions(e=Pc){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);r===l&&o.resolve(i)}return i}onInit(e,t){var r;const i=this.normalizeInstanceIdentifier(t),s=(r=this.onInitCallbacks.get(i))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const r=this.onInitCallbacks.get(t);if(r)for(const i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:b5(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Pc){return this.component?this.component.multipleInstances?e:Pc:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function b5(n){return n===Pc?void 0:n}function w5(n){return n.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E5{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new x5(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ut;(function(n){n[n.DEBUG=0]="DEBUG",n[n.VERBOSE=1]="VERBOSE",n[n.INFO=2]="INFO",n[n.WARN=3]="WARN",n[n.ERROR=4]="ERROR",n[n.SILENT=5]="SILENT"})(Ut||(Ut={}));const T5={debug:Ut.DEBUG,verbose:Ut.VERBOSE,info:Ut.INFO,warn:Ut.WARN,error:Ut.ERROR,silent:Ut.SILENT},S5=Ut.INFO,A5={[Ut.DEBUG]:"log",[Ut.VERBOSE]:"log",[Ut.INFO]:"info",[Ut.WARN]:"warn",[Ut.ERROR]:"error"},N5=(n,e,...t)=>{if(e<n.logLevel)return;const r=new Date().toISOString(),i=A5[e];if(i)console[i](`[${r}]  ${n.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Mx{constructor(e){this.name=e,this._logLevel=S5,this._logHandler=N5,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ut))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?T5[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ut.DEBUG,...e),this._logHandler(this,Ut.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ut.VERBOSE,...e),this._logHandler(this,Ut.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ut.INFO,...e),this._logHandler(this,Ut.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ut.WARN,...e),this._logHandler(this,Ut.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ut.ERROR,...e),this._logHandler(this,Ut.ERROR,...e)}}const I5=(n,e)=>e.some(t=>n instanceof t);let yE,vE;function k5(){return yE||(yE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function C5(){return vE||(vE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const JI=new WeakMap,O_=new WeakMap,e4=new WeakMap,yv=new WeakMap,Dx=new WeakMap;function P5(n){const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("success",s),n.removeEventListener("error",o)},s=()=>{t(Ol(n.result)),i()},o=()=>{r(n.error),i()};n.addEventListener("success",s),n.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&JI.set(t,n)}).catch(()=>{}),Dx.set(e,n),e}function R5(n){if(O_.has(n))return;const e=new Promise((t,r)=>{const i=()=>{n.removeEventListener("complete",s),n.removeEventListener("error",o),n.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{r(n.error||new DOMException("AbortError","AbortError")),i()};n.addEventListener("complete",s),n.addEventListener("error",o),n.addEventListener("abort",o)});O_.set(n,e)}let M_={get(n,e,t){if(n instanceof IDBTransaction){if(e==="done")return O_.get(n);if(e==="objectStoreNames")return n.objectStoreNames||e4.get(n);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ol(n[e])},set(n,e,t){return n[e]=t,!0},has(n,e){return n instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in n}};function j5(n){M_=n(M_)}function O5(n){return n===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const r=n.call(vv(this),e,...t);return e4.set(r,e.sort?e.sort():[e]),Ol(r)}:C5().includes(n)?function(...e){return n.apply(vv(this),e),Ol(JI.get(this))}:function(...e){return Ol(n.apply(vv(this),e))}}function M5(n){return typeof n=="function"?O5(n):(n instanceof IDBTransaction&&R5(n),I5(n,k5())?new Proxy(n,M_):n)}function Ol(n){if(n instanceof IDBRequest)return P5(n);if(yv.has(n))return yv.get(n);const e=M5(n);return e!==n&&(yv.set(n,e),Dx.set(e,n)),e}const vv=n=>Dx.get(n);function D5(n,e,{blocked:t,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(n,e),l=Ol(o);return r&&o.addEventListener("upgradeneeded",d=>{r(Ol(o.result),d.oldVersion,d.newVersion,Ol(o.transaction),d)}),t&&o.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),l.then(d=>{s&&d.addEventListener("close",()=>s()),i&&d.addEventListener("versionchange",f=>i(f.oldVersion,f.newVersion,f))}).catch(()=>{}),l}const L5=["get","getKey","getAll","getAllKeys","count"],F5=["put","add","delete","clear"],_v=new Map;function _E(n,e){if(!(n instanceof IDBDatabase&&!(e in n)&&typeof e=="string"))return;if(_v.get(e))return _v.get(e);const t=e.replace(/FromIndex$/,""),r=e!==t,i=F5.includes(t);if(!(t in(r?IDBIndex:IDBObjectStore).prototype)||!(i||L5.includes(t)))return;const s=async function(o,...l){const d=this.transaction(o,i?"readwrite":"readonly");let f=d.store;return r&&(f=f.index(l.shift())),(await Promise.all([f[t](...l),i&&d.done]))[0]};return _v.set(e,s),s}j5(n=>({...n,get:(e,t,r)=>_E(e,t)||n.get(e,t,r),has:(e,t)=>!!_E(e,t)||n.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V5{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(z5(t)){const r=t.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(t=>t).join(" ")}}function z5(n){const e=n.getComponent();return(e==null?void 0:e.type)==="VERSION"}const D_="@firebase/app",xE="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ba=new Mx("@firebase/app"),B5="@firebase/app-compat",U5="@firebase/analytics-compat",q5="@firebase/analytics",H5="@firebase/app-check-compat",$5="@firebase/app-check",W5="@firebase/auth",G5="@firebase/auth-compat",K5="@firebase/database",Y5="@firebase/data-connect",Z5="@firebase/database-compat",Q5="@firebase/functions",X5="@firebase/functions-compat",J5="@firebase/installations",e7="@firebase/installations-compat",t7="@firebase/messaging",n7="@firebase/messaging-compat",r7="@firebase/performance",i7="@firebase/performance-compat",s7="@firebase/remote-config",o7="@firebase/remote-config-compat",a7="@firebase/storage",l7="@firebase/storage-compat",c7="@firebase/firestore",u7="@firebase/ai",d7="@firebase/firestore-compat",h7="firebase",f7="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const L_="[DEFAULT]",m7={[D_]:"fire-core",[B5]:"fire-core-compat",[q5]:"fire-analytics",[U5]:"fire-analytics-compat",[$5]:"fire-app-check",[H5]:"fire-app-check-compat",[W5]:"fire-auth",[G5]:"fire-auth-compat",[K5]:"fire-rtdb",[Y5]:"fire-data-connect",[Z5]:"fire-rtdb-compat",[Q5]:"fire-fn",[X5]:"fire-fn-compat",[J5]:"fire-iid",[e7]:"fire-iid-compat",[t7]:"fire-fcm",[n7]:"fire-fcm-compat",[r7]:"fire-perf",[i7]:"fire-perf-compat",[s7]:"fire-rc",[o7]:"fire-rc-compat",[a7]:"fire-gcs",[l7]:"fire-gcs-compat",[c7]:"fire-fst",[d7]:"fire-fst-compat",[u7]:"fire-vertex","fire-js":"fire-js",[h7]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bf=new Map,p7=new Map,F_=new Map;function bE(n,e){try{n.container.addComponent(e)}catch(t){ba.debug(`Component ${e.name} failed to register with FirebaseApp ${n.name}`,t)}}function Kc(n){const e=n.name;if(F_.has(e))return ba.debug(`There were multiple attempts to register component ${e}.`),!1;F_.set(e,n);for(const t of bf.values())bE(t,n);for(const t of p7.values())bE(t,n);return!0}function ly(n,e){const t=n.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),n.container.getProvider(e)}function ci(n){return n==null?!1:n.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ml=new Qf("app","Firebase",g7);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y7{constructor(e,t,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Bl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ml.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rd=f7;function t4(n,e={}){let t=n;typeof e!="object"&&(e={name:e});const r=Object.assign({name:L_,automaticDataCollectionEnabled:!0},e),i=r.name;if(typeof i!="string"||!i)throw Ml.create("bad-app-name",{appName:String(i)});if(t||(t=GI()),!t)throw Ml.create("no-options");const s=bf.get(i);if(s){if(zl(t,s.options)&&zl(r,s.config))return s;throw Ml.create("duplicate-app",{appName:i})}const o=new E5(i);for(const d of F_.values())o.addComponent(d);const l=new y7(t,r,o);return bf.set(i,l),l}function cy(n=L_){const e=bf.get(n);if(!e&&n===L_&&GI())return t4();if(!e)throw Ml.create("no-app",{appName:n});return e}function v7(){return Array.from(bf.values())}function ko(n,e,t){var r;let i=(r=m7[n])!==null&&r!==void 0?r:n;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),ba.warn(l.join(" "));return}Kc(new Bl(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _7="firebase-heartbeat-database",x7=1,wf="firebase-heartbeat-store";let xv=null;function n4(){return xv||(xv=D5(_7,x7,{upgrade:(n,e)=>{switch(e){case 0:try{n.createObjectStore(wf)}catch(t){console.warn(t)}}}}).catch(n=>{throw Ml.create("idb-open",{originalErrorMessage:n.message})})),xv}async function b7(n){try{const t=(await n4()).transaction(wf),r=await t.objectStore(wf).get(r4(n));return await t.done,r}catch(e){if(e instanceof Na)ba.warn(e.message);else{const t=Ml.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});ba.warn(t.message)}}}async function wE(n,e){try{const r=(await n4()).transaction(wf,"readwrite");await r.objectStore(wf).put(e,r4(n)),await r.done}catch(t){if(t instanceof Na)ba.warn(t.message);else{const r=Ml.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});ba.warn(r.message)}}}function r4(n){return`${n.name}!${n.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w7=1024,E7=30;class T7{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new A7(t),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=EE();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>E7){const o=N7(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){ba.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=EE(),{heartbeatsToSend:r,unsentEntries:i}=S7(this._heartbeatsCache.heartbeats),s=yg(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return ba.warn(t),""}}}function EE(){return new Date().toISOString().substring(0,10)}function S7(n,e=w7){const t=[];let r=n.slice();for(const i of n){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),TE(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),TE(t)>e){t.pop();break}r=r.slice(1)}return{heartbeatsToSend:t,unsentEntries:r}}class A7{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return XI()?h5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await b7(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return wE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return wE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function TE(n){return yg(JSON.stringify({version:2,heartbeats:n})).length}function N7(n){if(n.length===0)return-1;let e=0,t=n[0].date;for(let r=1;r<n.length;r++)n[r].date<t&&(t=n[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I7(n){Kc(new Bl("platform-logger",e=>new V5(e),"PRIVATE")),Kc(new Bl("heartbeat",e=>new T7(e),"PRIVATE")),ko(D_,xE,n),ko(D_,xE,"esm2017"),ko("fire-js","")}I7("");function Lx(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,r=Object.getOwnPropertySymbols(n);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(n,r[i])&&(t[r[i]]=n[r[i]]);return t}function i4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const k7=i4,s4=new Qf("auth","Firebase",i4());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vg=new Mx("@firebase/auth");function C7(n,...e){vg.logLevel<=Ut.WARN&&vg.warn(`Auth (${Rd}): ${n}`,...e)}function Kp(n,...e){vg.logLevel<=Ut.ERROR&&vg.error(`Auth (${Rd}): ${n}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function As(n,...e){throw Vx(n,...e)}function so(n,...e){return Vx(n,...e)}function Fx(n,e,t){const r=Object.assign(Object.assign({},k7()),{[e]:t});return new Qf("auth","Firebase",r).create(e,{appName:n.name})}function Co(n){return Fx(n,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function P7(n,e,t){const r=t;if(!(e instanceof r))throw r.name!==e.constructor.name&&As(n,"argument-error"),Fx(n,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Vx(n,...e){if(typeof n!="string"){const t=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=n.name),n._errorFactory.create(t,...r)}return s4.create(n,...e)}function at(n,e,...t){if(!n)throw Vx(e,...t)}function ga(n){const e="INTERNAL ASSERTION FAILED: "+n;throw Kp(e),new Error(e)}function wa(n,e){n||ga(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _g(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.href)||""}function R7(){return SE()==="http:"||SE()==="https:"}function SE(){var n;return typeof self<"u"&&((n=self.location)===null||n===void 0?void 0:n.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j7(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(R7()||c5()||"connection"in navigator)?navigator.onLine:!0}function O7(){if(typeof navigator>"u")return null;const n=navigator;return n.languages&&n.languages[0]||n.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jf{constructor(e,t){this.shortDelay=e,this.longDelay=t,wa(t>e,"Short delay should be less than long delay!"),this.isMobile=a5()||u5()}get(){return j7()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zx(n,e){wa(n.emulator,"Emulator should always be set here");const{url:t}=n.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o4{static initialize(e,t,r){this.fetchImpl=e,t&&(this.headersImpl=t),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ga("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ga("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ga("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M7={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D7=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],L7=new Jf(3e4,6e4);function Ia(n,e){return n.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:n.tenantId}):e}async function ka(n,e,t,r,i={}){return a4(n,i,async()=>{let s={},o={};r&&(e==="GET"?o=r:s={body:JSON.stringify(r)});const l=Xf(Object.assign({key:n.config.apiKey},o)).slice(1),d=await n._getAdditionalHeaders();d["Content-Type"]="application/json",n.languageCode&&(d["X-Firebase-Locale"]=n.languageCode);const f=Object.assign({method:e,headers:d},s);return l5()||(f.referrerPolicy="no-referrer"),n.emulatorConfig&&uu(n.emulatorConfig.host)&&(f.credentials="include"),o4.fetch()(await l4(n,n.config.apiHost,t,l),f)})}async function a4(n,e,t){n._canInitEmulator=!1;const r=Object.assign(Object.assign({},M7),e);try{const i=new V7(n),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw _p(n,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[d,f]=l.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw _p(n,"credential-already-in-use",o);if(d==="EMAIL_EXISTS")throw _p(n,"email-already-in-use",o);if(d==="USER_DISABLED")throw _p(n,"user-disabled",o);const m=r[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw Fx(n,m,f);As(n,m)}}catch(i){if(i instanceof Na)throw i;As(n,"network-request-failed",{message:String(i)})}}async function em(n,e,t,r,i={}){const s=await ka(n,e,t,r,i);return"mfaPendingCredential"in s&&As(n,"multi-factor-auth-required",{_serverResponse:s}),s}async function l4(n,e,t,r){const i=`${e}${t}?${r}`,s=n,o=s.config.emulator?zx(n.config,i):`${n.config.apiScheme}://${i}`;return D7.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function F7(n){switch(n){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class V7{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,r)=>{this.timer=setTimeout(()=>r(so(this.auth,"network-request-failed")),L7.get())})}}function _p(n,e,t){const r={appName:n.name};t.email&&(r.email=t.email),t.phoneNumber&&(r.phoneNumber=t.phoneNumber);const i=so(n,e,r);return i.customData._tokenResponse=t,i}function AE(n){return n!==void 0&&n.enterprise!==void 0}class z7{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return F7(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function B7(n,e){return ka(n,"GET","/v2/recaptchaConfig",Ia(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function U7(n,e){return ka(n,"POST","/v1/accounts:delete",e)}async function xg(n,e){return ka(n,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function af(n){if(n)try{const e=new Date(Number(n));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function q7(n,e=!1){const t=Rn(n),r=await t.getIdToken(e),i=Bx(r);at(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:af(bv(i.auth_time)),issuedAtTime:af(bv(i.iat)),expirationTime:af(bv(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function bv(n){return Number(n)*1e3}function Bx(n){const[e,t,r]=n.split(".");if(e===void 0||t===void 0||r===void 0)return Kp("JWT malformed, contained fewer than 3 sections"),null;try{const i=qI(t);return i?JSON.parse(i):(Kp("Failed to decode base64 JWT payload"),null)}catch(i){return Kp("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function NE(n){const e=Bx(n);return at(e,"internal-error"),at(typeof e.exp<"u","internal-error"),at(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ef(n,e,t=!1){if(t)return e;try{return await e}catch(r){throw r instanceof Na&&H7(r)&&n.auth.currentUser===n&&await n.auth.signOut(),r}}function H7({code:n}){return n==="auth/user-disabled"||n==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $7{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V_{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=af(this.lastLoginAt),this.creationTime=af(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bg(n){var e;const t=n.auth,r=await n.getIdToken(),i=await Ef(n,xg(t,{idToken:r}));at(i==null?void 0:i.users.length,t,"internal-error");const s=i.users[0];n._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?c4(s.providerUserInfo):[],l=G7(n.providerData,o),d=n.isAnonymous,f=!(n.email&&s.passwordHash)&&!(l!=null&&l.length),m=d?f:!1,y={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new V_(s.createdAt,s.lastLoginAt),isAnonymous:m};Object.assign(n,y)}async function W7(n){const e=Rn(n);await bg(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function G7(n,e){return[...n.filter(r=>!e.some(i=>i.providerId===r.providerId)),...e]}function c4(n){return n.map(e=>{var{providerId:t}=e,r=Lx(e,["providerId"]);return{providerId:t,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function K7(n,e){const t=await a4(n,{},async()=>{const r=Xf({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=n.config,o=await l4(n,i,"/v1/token",`key=${s}`),l=await n._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:l,body:r};return n.emulatorConfig&&uu(n.emulatorConfig.host)&&(d.credentials="include"),o4.fetch()(o,d)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Y7(n,e){return ka(n,"POST","/v2/accounts:revokeToken",Ia(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){at(e.idToken,"internal-error"),at(typeof e.idToken<"u","internal-error"),at(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):NE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){at(e.length!==0,"internal-error");const t=NE(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(at(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:r,refreshToken:i,expiresIn:s}=await K7(e,t);this.updateTokensAndExpiration(r,i,Number(s))}updateTokensAndExpiration(e,t,r){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,t){const{refreshToken:r,accessToken:i,expirationTime:s}=t,o=new ld;return r&&(at(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),i&&(at(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(at(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new ld,this.toJSON())}_performRefresh(){return ga("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _l(n,e){at(typeof n=="string"||typeof n>"u","internal-error",{appName:e})}class io{constructor(e){var{uid:t,auth:r,stsTokenManager:i}=e,s=Lx(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new $7(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=r,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new V_(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Ef(this,this.stsTokenManager.getToken(this.auth,e));return at(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return q7(this,e)}reload(){return W7(this)}_assign(e){this!==e&&(at(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new io(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){at(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),t&&await bg(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ci(this.auth.app))return Promise.reject(Co(this.auth));const e=await this.getIdToken();return await Ef(this,U7(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var r,i,s,o,l,d,f,m;const y=(r=t.displayName)!==null&&r!==void 0?r:void 0,g=(i=t.email)!==null&&i!==void 0?i:void 0,_=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,E=(o=t.photoURL)!==null&&o!==void 0?o:void 0,x=(l=t.tenantId)!==null&&l!==void 0?l:void 0,w=(d=t._redirectEventId)!==null&&d!==void 0?d:void 0,S=(f=t.createdAt)!==null&&f!==void 0?f:void 0,N=(m=t.lastLoginAt)!==null&&m!==void 0?m:void 0,{uid:P,emailVerified:I,isAnonymous:R,providerData:U,stsTokenManager:j}=t;at(P&&j,e,"internal-error");const k=ld.fromJSON(this.name,j);at(typeof P=="string",e,"internal-error"),_l(y,e.name),_l(g,e.name),at(typeof I=="boolean",e,"internal-error"),at(typeof R=="boolean",e,"internal-error"),_l(_,e.name),_l(E,e.name),_l(x,e.name),_l(w,e.name),_l(S,e.name),_l(N,e.name);const F=new io({uid:P,auth:e,email:g,emailVerified:I,displayName:y,isAnonymous:R,photoURL:E,phoneNumber:_,tenantId:x,stsTokenManager:k,createdAt:S,lastLoginAt:N});return U&&Array.isArray(U)&&(F.providerData=U.map(O=>Object.assign({},O))),w&&(F._redirectEventId=w),F}static async _fromIdTokenResponse(e,t,r=!1){const i=new ld;i.updateFromServerResponse(t);const s=new io({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:r});return await bg(s),s}static async _fromGetAccountInfoResponse(e,t,r){const i=t.users[0];at(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?c4(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),l=new ld;l.updateFromIdToken(r);const d=new io({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:o}),f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new V_(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(d,f),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IE=new Map;function ya(n){wa(n instanceof Function,"Expected a class definition");let e=IE.get(n);return e?(wa(e instanceof n,"Instance stored in cache mismatched with class"),e):(e=new n,IE.set(n,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}u4.type="NONE";const kE=u4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yp(n,e,t){return`firebase:${n}:${e}:${t}`}class cd{constructor(e,t,r){this.persistence=e,this.auth=t,this.userKey=r;const{config:i,name:s}=this.auth;this.fullUserKey=Yp(this.userKey,i.apiKey,s),this.fullPersistenceKey=Yp("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await xg(this.auth,{idToken:e}).catch(()=>{});return t?io._fromGetAccountInfoResponse(this.auth,t,e):null}return io._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,r="authUser"){if(!t.length)return new cd(ya(kE),e,r);const i=(await Promise.all(t.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f);let s=i[0]||ya(kE);const o=Yp(r,e.config.apiKey,e.name);let l=null;for(const f of t)try{const m=await f._get(o);if(m){let y;if(typeof m=="string"){const g=await xg(e,{idToken:m}).catch(()=>{});if(!g)break;y=await io._fromGetAccountInfoResponse(e,g,m)}else y=io._fromJSON(e,m);f!==s&&(l=y),s=f;break}}catch{}const d=i.filter(f=>f._shouldAllowMigration);return!s._shouldAllowMigration||!d.length?new cd(s,e,r):(s=d[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async f=>{if(f!==s)try{await f._remove(o)}catch{}})),new cd(s,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CE(n){const e=n.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(m4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(d4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(g4(e))return"Blackberry";if(y4(e))return"Webos";if(h4(e))return"Safari";if((e.includes("chrome/")||f4(e))&&!e.includes("edge/"))return"Chrome";if(p4(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=n.match(t);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function d4(n=fr()){return/firefox\//i.test(n)}function h4(n=fr()){const e=n.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function f4(n=fr()){return/crios\//i.test(n)}function m4(n=fr()){return/iemobile/i.test(n)}function p4(n=fr()){return/android/i.test(n)}function g4(n=fr()){return/blackberry/i.test(n)}function y4(n=fr()){return/webos/i.test(n)}function Ux(n=fr()){return/iphone|ipad|ipod/i.test(n)||/macintosh/i.test(n)&&/mobile/i.test(n)}function Z7(n=fr()){var e;return Ux(n)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Q7(){return d5()&&document.documentMode===10}function v4(n=fr()){return Ux(n)||p4(n)||y4(n)||g4(n)||/windows phone/i.test(n)||m4(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _4(n,e=[]){let t;switch(n){case"Browser":t=CE(fr());break;case"Worker":t=`${CE(fr())}-${n}`;break;default:t=n}const r=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Rd}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X7{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const r=s=>new Promise((o,l)=>{try{const d=e(s);o(d)}catch(d){l(d)}});r.onAbort=t,this.queue.push(r);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const r of this.queue)await r(e),r.onAbort&&t.push(r.onAbort)}catch(r){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function J7(n,e={}){return ka(n,"GET","/v2/passwordPolicy",Ia(n,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ej=6;class tj{constructor(e){var t,r,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:ej,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,r,i,s,o,l;const d={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,d),this.validatePasswordCharacterOptions(e,d),d.isValid&&(d.isValid=(t=d.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),d.isValid&&(d.isValid=(r=d.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),d.isValid&&(d.isValid=(i=d.containsLowercaseLetter)!==null&&i!==void 0?i:!0),d.isValid&&(d.isValid=(s=d.containsUppercaseLetter)!==null&&s!==void 0?s:!0),d.isValid&&(d.isValid=(o=d.containsNumericCharacter)!==null&&o!==void 0?o:!0),d.isValid&&(d.isValid=(l=d.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),d}validatePasswordLengthOptions(e,t){const r=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;r&&(t.meetsMinPasswordLength=e.length>=r),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let r;for(let i=0;i<e.length;i++)r=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,t,r,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nj{constructor(e,t,r,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=r,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new PE(this),this.idTokenSubscription=new PE(this),this.beforeStateQueue=new X7(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=s4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ya(t)),this._initializationPromise=this.queue(async()=>{var r,i,s;if(!this._deleted&&(this.persistenceManager=await cd.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await xg(this,{idToken:e}),r=await io._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(r)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(ci(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let i=r,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,l=i==null?void 0:i._redirectEventId,d=await this.tryRedirectSignIn(e);(!o||o===l)&&(d!=null&&d.user)&&(i=d.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return at(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await bg(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=O7()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ci(this.app))return Promise.reject(Co(this));const t=e?Rn(e):null;return t&&at(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&at(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ci(this.app)?Promise.reject(Co(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ci(this.app)?Promise.reject(Co(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ya(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await J7(this),t=new tj(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Qf("auth","Firebase",e())}onAuthStateChanged(e,t,r){return this.registerStateListener(this.authStateSubscription,e,t,r)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,r){return this.registerStateListener(this.idTokenSubscription,e,t,r)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(r.tenantId=this.tenantId),await Y7(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const r=await this.getOrInitRedirectPersistenceManager(t);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ya(e)||this._popupRedirectResolver;at(t,this,"argument-error"),this.redirectPersistenceManager=await cd.create(this,[ya(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,r;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,r,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(at(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const d=e.addObserver(t,r,i);return()=>{o=!0,d()}}else{const d=e.addObserver(t);return()=>{o=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return at(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=_4(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(t["X-Firebase-Client"]=r);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;if(ci(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&C7(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Do(n){return Rn(n)}class PE{constructor(e){this.auth=e,this.observer=null,this.addObserver=y5(t=>this.observer=t)}get next(){return at(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uy={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function rj(n){uy=n}function x4(n){return uy.loadJS(n)}function ij(){return uy.recaptchaEnterpriseScript}function sj(){return uy.gapiScript}function oj(n){return`__${n}${Math.floor(Math.random()*1e6)}`}class aj{constructor(){this.enterprise=new lj}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class lj{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const cj="recaptcha-enterprise",b4="NO_RECAPTCHA";class uj{constructor(e){this.type=cj,this.auth=Do(e)}async verify(e="verify",t=!1){async function r(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,l)=>{B7(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const f=new z7(d);return s.tenantId==null?s._agentRecaptchaConfig=f:s._tenantRecaptchaConfigs[s.tenantId]=f,o(f.siteKey)}}).catch(d=>{l(d)})})}function i(s,o,l){const d=window.grecaptcha;AE(d)?d.enterprise.ready(()=>{d.enterprise.execute(s,{action:e}).then(f=>{o(f)}).catch(()=>{o(b4)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new aj().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{r(this.auth).then(l=>{if(!t&&AE(window.grecaptcha))i(l,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let d=ij();d.length!==0&&(d+=l),x4(d).then(()=>{i(l,s,o)}).catch(f=>{o(f)})}}).catch(l=>{o(l)})})}}async function RE(n,e,t,r=!1,i=!1){const s=new uj(n);let o;if(i)o=b4;else try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}const l=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const d=l.phoneEnrollmentInfo.phoneNumber,f=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:d,recaptchaToken:f,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const d=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function Tf(n,e,t,r,i){var s;if(!((s=n._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await RE(n,e,t,t==="getOobCode");return r(n,o)}else return r(n,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await RE(n,e,t,t==="getOobCode");return r(n,l)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dj(n,e){const t=ly(n,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(zl(s,e??{}))return i;As(i,"already-initialized")}return t.initialize({options:e})}function hj(n,e){const t=(e==null?void 0:e.persistence)||[],r=(Array.isArray(t)?t:[t]).map(ya);e!=null&&e.errorMap&&n._updateErrorMap(e.errorMap),n._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function fj(n,e,t){const r=Do(n);at(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const i=!1,s=w4(e),{host:o,port:l}=mj(e),d=l===null?"":`:${l}`,f={url:`${s}//${o}${d}/`},m=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!r._canInitEmulator){at(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),at(zl(f,r.config.emulator)&&zl(m,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=f,r.emulatorConfig=m,r.settings.appVerificationDisabledForTesting=!0,uu(o)?(jx(`${s}//${o}${d}`),Ox("Auth",!0)):pj()}function w4(n){const e=n.indexOf(":");return e<0?"":n.substr(0,e+1)}function mj(n){const e=w4(n),t=/(\/\/)?([^?#/]+)/.exec(n.substr(e.length));if(!t)return{host:"",port:null};const r=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const s=i[1];return{host:s,port:jE(r.substr(s.length+1))}}else{const[s,o]=r.split(":");return{host:s,port:jE(o)}}}function jE(n){if(!n)return null;const e=Number(n);return isNaN(e)?null:e}function pj(){function n(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",n):n())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qx{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return ga("not implemented")}_getIdTokenResponse(e){return ga("not implemented")}_linkToIdToken(e,t){return ga("not implemented")}_getReauthenticationResolver(e){return ga("not implemented")}}async function gj(n,e){return ka(n,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yj(n,e){return em(n,"POST","/v1/accounts:signInWithPassword",Ia(n,e))}async function E4(n,e){return ka(n,"POST","/v1/accounts:sendOobCode",Ia(n,e))}async function vj(n,e){return E4(n,e)}async function _j(n,e){return E4(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xj(n,e){return em(n,"POST","/v1/accounts:signInWithEmailLink",Ia(n,e))}async function bj(n,e){return em(n,"POST","/v1/accounts:signInWithEmailLink",Ia(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sf extends qx{constructor(e,t,r,i=null){super("password",r),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Sf(e,t,"password")}static _fromEmailAndCode(e,t,r=null){return new Sf(e,t,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Tf(e,t,"signInWithPassword",yj);case"emailLink":return xj(e,{email:this._email,oobCode:this._password});default:As(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const r={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Tf(e,r,"signUpPassword",gj);case"emailLink":return bj(e,{idToken:t,email:this._email,oobCode:this._password});default:As(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ud(n,e){return em(n,"POST","/v1/accounts:signInWithIdp",Ia(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wj="http://localhost";class Yc extends qx{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Yc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):As("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:i}=t,s=Lx(t,["providerId","signInMethod"]);if(!r||!i)return null;const o=new Yc(r,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return ud(e,t)}_linkToIdToken(e,t){const r=this.buildRequest();return r.idToken=t,ud(e,r)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,ud(e,t)}buildRequest(){const e={requestUri:wj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=Xf(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ej(n){switch(n){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Tj(n){const e=qh(Hh(n)).link,t=e?qh(Hh(e)).deep_link_id:null,r=qh(Hh(n)).deep_link_id;return(r?qh(Hh(r)).link:null)||r||t||e||n}class dy{constructor(e){var t,r,i,s,o,l;const d=qh(Hh(e)),f=(t=d.apiKey)!==null&&t!==void 0?t:null,m=(r=d.oobCode)!==null&&r!==void 0?r:null,y=Ej((i=d.mode)!==null&&i!==void 0?i:null);at(f&&m&&y,"argument-error"),this.apiKey=f,this.operation=y,this.code=m,this.continueUrl=(s=d.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=d.lang)!==null&&o!==void 0?o:null,this.tenantId=(l=d.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const t=Tj(e);try{return new dy(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class du{constructor(){this.providerId=du.PROVIDER_ID}static credential(e,t){return Sf._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const r=dy.parseLink(t);return at(r,"argument-error"),Sf._fromEmailAndCode(e,r.code,r.tenantId)}}du.PROVIDER_ID="password";du.EMAIL_PASSWORD_SIGN_IN_METHOD="password";du.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hx{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tm extends Hx{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tl extends tm{constructor(){super("facebook.com")}static credential(e){return Yc._fromParams({providerId:Tl.PROVIDER_ID,signInMethod:Tl.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Tl.credentialFromTaggedObject(e)}static credentialFromError(e){return Tl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Tl.credential(e.oauthAccessToken)}catch{return null}}}Tl.FACEBOOK_SIGN_IN_METHOD="facebook.com";Tl.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pa extends tm{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Yc._fromParams({providerId:pa.PROVIDER_ID,signInMethod:pa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return pa.credentialFromTaggedObject(e)}static credentialFromError(e){return pa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:r}=e;if(!t&&!r)return null;try{return pa.credential(t,r)}catch{return null}}}pa.GOOGLE_SIGN_IN_METHOD="google.com";pa.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sl extends tm{constructor(){super("github.com")}static credential(e){return Yc._fromParams({providerId:Sl.PROVIDER_ID,signInMethod:Sl.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Sl.credentialFromTaggedObject(e)}static credentialFromError(e){return Sl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Sl.credential(e.oauthAccessToken)}catch{return null}}}Sl.GITHUB_SIGN_IN_METHOD="github.com";Sl.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al extends tm{constructor(){super("twitter.com")}static credential(e,t){return Yc._fromParams({providerId:Al.PROVIDER_ID,signInMethod:Al.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Al.credentialFromTaggedObject(e)}static credentialFromError(e){return Al.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:r}=e;if(!t||!r)return null;try{return Al.credential(t,r)}catch{return null}}}Al.TWITTER_SIGN_IN_METHOD="twitter.com";Al.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sj(n,e){return em(n,"POST","/v1/accounts:signUp",Ia(n,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zc{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,r,i=!1){const s=await io._fromIdTokenResponse(e,r,i),o=OE(r);return new Zc({user:s,providerId:o,_tokenResponse:r,operationType:t})}static async _forOperation(e,t,r){await e._updateTokensIfNecessary(r,!0);const i=OE(r);return new Zc({user:e,providerId:i,_tokenResponse:r,operationType:t})}}function OE(n){return n.providerId?n.providerId:"phoneNumber"in n?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wg extends Na{constructor(e,t,r,i){var s;super(t.code,t.message),this.operationType=r,this.user=i,Object.setPrototypeOf(this,wg.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,t,r,i){return new wg(e,t,r,i)}}function T4(n,e,t,r){return(e==="reauthenticate"?t._getReauthenticationResolver(n):t._getIdTokenResponse(n)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?wg._fromErrorAndOperation(n,s,e,r):s})}async function Aj(n,e,t=!1){const r=await Ef(n,e._linkToIdToken(n.auth,await n.getIdToken()),t);return Zc._forOperation(n,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nj(n,e,t=!1){const{auth:r}=n;if(ci(r.app))return Promise.reject(Co(r));const i="reauthenticate";try{const s=await Ef(n,T4(r,i,e,n),t);at(s.idToken,r,"internal-error");const o=Bx(s.idToken);at(o,r,"internal-error");const{sub:l}=o;return at(n.uid===l,r,"user-mismatch"),Zc._forOperation(n,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&As(r,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function S4(n,e,t=!1){if(ci(n.app))return Promise.reject(Co(n));const r="signIn",i=await T4(n,r,e),s=await Zc._fromIdTokenResponse(n,r,i);return t||await n._updateCurrentUser(s.user),s}async function A4(n,e){return S4(Do(n),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ij(n,e,t){var r;at(((r=t.url)===null||r===void 0?void 0:r.length)>0,n,"invalid-continue-uri"),at(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,n,"invalid-dynamic-link-domain"),at(typeof t.linkDomain>"u"||t.linkDomain.length>0,n,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(at(t.iOS.bundleId.length>0,n,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(at(t.android.packageName.length>0,n,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N4(n){const e=Do(n);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function kj(n,e,t){const r=Do(n);await Tf(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",vj)}async function Cj(n,e,t){if(ci(n.app))return Promise.reject(Co(n));const r=Do(n),o=await Tf(r,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Sj).catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&N4(n),d}),l=await Zc._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function Pj(n,e,t){return ci(n.app)?Promise.reject(Co(n)):A4(Rn(n),du.credential(e,t)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&N4(n),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rj(n,e,t){const r=Do(n),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,l){at(l.handleCodeInApp,r,"argument-error"),l&&Ij(r,o,l)}s(i,t),await Tf(r,i,"getOobCode",_j)}function I4(n,e){const t=dy.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function jj(n,e,t){if(ci(n.app))return Promise.reject(Co(n));const r=Rn(n),i=du.credentialWithLink(e,t||_g());return at(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),A4(r,i)}function Oj(n,e,t,r){return Rn(n).onIdTokenChanged(e,t,r)}function Mj(n,e,t){return Rn(n).beforeAuthStateChanged(e,t)}function Dj(n,e,t,r){return Rn(n).onAuthStateChanged(e,t,r)}function Lj(n){return Rn(n).signOut()}const Eg="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class k4{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Eg,"1"),this.storage.removeItem(Eg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fj=1e3,Vj=10;class C4 extends k4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=v4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const r=this.storage.getItem(t),i=this.localCache[t];r!==i&&e(t,i,r)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,d)=>{this.notifyListeners(o,d)});return}const r=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(r);!t&&this.localCache[r]===o||this.notifyListeners(r,o)},s=this.storage.getItem(r);Q7()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,Vj):i()}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:r}),!0)})},Fj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}C4.type="LOCAL";const zj=C4;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P4 extends k4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}P4.type="SESSION";const R4=P4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bj(n){return Promise.all(n.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hy{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const r=new hy(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:r,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:r,eventType:i});const l=Array.from(o).map(async f=>f(t.origin,s)),d=await Bj(l);t.ports[0].postMessage({status:"done",eventId:r,eventType:i,response:d})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}hy.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $x(n="",e=10){let t="";for(let r=0;r<e;r++)t+=Math.floor(Math.random()*10);return n+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,r=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((l,d)=>{const f=$x("",20);i.port1.start();const m=setTimeout(()=>{d(new Error("unsupported_event"))},r);o={messageChannel:i,onMessage(y){const g=y;if(g.data.eventId===f)switch(g.data.status){case"ack":clearTimeout(m),s=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(g.data.response);break;default:clearTimeout(m),clearTimeout(s),d(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:f,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Po(){return window}function qj(n){Po().location.href=n}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j4(){return typeof Po().WorkerGlobalScope<"u"&&typeof Po().importScripts=="function"}async function Hj(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function $j(){var n;return((n=navigator==null?void 0:navigator.serviceWorker)===null||n===void 0?void 0:n.controller)||null}function Wj(){return j4()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const O4="firebaseLocalStorageDb",Gj=1,Tg="firebaseLocalStorage",M4="fbase_key";class nm{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function fy(n,e){return n.transaction([Tg],e?"readwrite":"readonly").objectStore(Tg)}function Kj(){const n=indexedDB.deleteDatabase(O4);return new nm(n).toPromise()}function z_(){const n=indexedDB.open(O4,Gj);return new Promise((e,t)=>{n.addEventListener("error",()=>{t(n.error)}),n.addEventListener("upgradeneeded",()=>{const r=n.result;try{r.createObjectStore(Tg,{keyPath:M4})}catch(i){t(i)}}),n.addEventListener("success",async()=>{const r=n.result;r.objectStoreNames.contains(Tg)?e(r):(r.close(),await Kj(),e(await z_()))})})}async function ME(n,e,t){const r=fy(n,!0).put({[M4]:e,value:t});return new nm(r).toPromise()}async function Yj(n,e){const t=fy(n,!1).get(e),r=await new nm(t).toPromise();return r===void 0?null:r.value}function DE(n,e){const t=fy(n,!0).delete(e);return new nm(t).toPromise()}const Zj=800,Qj=3;class D4{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await z_(),this.db)}async _withRetries(e){let t=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(t++>Qj)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return j4()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=hy._getInstance(Wj()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Hj(),!this.activeServiceWorker)return;this.sender=new Uj(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((t=r[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||$j()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await z_();return await ME(e,Eg,"1"),await DE(e,Eg),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(r=>ME(r,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(r=>Yj(r,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>DE(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=fy(i,!1).getAll();return new nm(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],r=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)r.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!r.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const r=this.listeners[e];if(r)for(const i of Array.from(r))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Zj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}D4.type="LOCAL";const Xj=D4;new Jf(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function L4(n,e){return e?ya(e):(at(n._popupRedirectResolver,n,"argument-error"),n._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx extends qx{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return ud(e,this._buildIdpRequest())}_linkToIdToken(e,t){return ud(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return ud(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Jj(n){return S4(n.auth,new Wx(n),n.bypassAuthState)}function eO(n){const{auth:e,user:t}=n;return at(t,e,"internal-error"),Nj(t,new Wx(n),n.bypassAuthState)}async function tO(n){const{auth:e,user:t}=n;return at(t,e,"internal-error"),Aj(t,new Wx(n),n.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F4{constructor(e,t,r,i,s=!1){this.auth=e,this.resolver=r,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:r,postBody:i,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const d={auth:this.auth,requestUri:t,sessionId:r,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(d))}catch(f){this.reject(f)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Jj;case"linkViaPopup":case"linkViaRedirect":return tO;case"reauthViaPopup":case"reauthViaRedirect":return eO;default:As(this.auth,"internal-error")}}resolve(e){wa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){wa(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nO=new Jf(2e3,1e4);async function rO(n,e,t){if(ci(n.app))return Promise.reject(so(n,"operation-not-supported-in-this-environment"));const r=Do(n);P7(n,e,Hx);const i=L4(r,t);return new zc(r,"signInViaPopup",e,i).executeNotNull()}class zc extends F4{constructor(e,t,r,i,s){super(e,t,i,s),this.provider=r,this.authWindow=null,this.pollId=null,zc.currentPopupAction&&zc.currentPopupAction.cancel(),zc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return at(e,this.auth,"internal-error"),e}async onExecution(){wa(this.filter.length===1,"Popup operations only handle one event");const e=$x();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(so(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(so(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,zc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,r;if(!((r=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(so(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,nO.get())};e()}}zc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iO="pendingRedirect",Zp=new Map;class sO extends F4{constructor(e,t,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,r),this.eventId=null}async execute(){let e=Zp.get(this.auth._key());if(!e){try{const r=await oO(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(t){e=()=>Promise.reject(t)}Zp.set(this.auth._key(),e)}return this.bypassAuthState||Zp.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function oO(n,e){const t=cO(e),r=lO(n);if(!await r._isAvailable())return!1;const i=await r._get(t)==="true";return await r._remove(t),i}function aO(n,e){Zp.set(n._key(),e)}function lO(n){return ya(n._redirectPersistence)}function cO(n){return Yp(iO,n.config.apiKey,n.name)}async function uO(n,e,t=!1){if(ci(n.app))return Promise.reject(Co(n));const r=Do(n),i=L4(r,e),o=await new sO(r,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dO=10*60*1e3;class hO{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(t=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!fO(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var r;if(e.error&&!V4(e)){const i=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";t.onError(so(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const r=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=dO&&this.cachedEventUids.clear(),this.cachedEventUids.has(LE(e))}saveEventToCache(e){this.cachedEventUids.add(LE(e)),this.lastProcessedEventTime=Date.now()}}function LE(n){return[n.type,n.eventId,n.sessionId,n.tenantId].filter(e=>e).join("-")}function V4({type:n,error:e}){return n==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function fO(n){switch(n.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return V4(n);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function mO(n,e={}){return ka(n,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pO=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,gO=/^https?/;async function yO(n){if(n.config.emulator)return;const{authorizedDomains:e}=await mO(n);for(const t of e)try{if(vO(t))return}catch{}As(n,"unauthorized-domain")}function vO(n){const e=_g(),{protocol:t,hostname:r}=new URL(e);if(n.startsWith("chrome-extension://")){const o=new URL(n);return o.hostname===""&&r===""?t==="chrome-extension:"&&n.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===r}if(!gO.test(t))return!1;if(pO.test(n))return r===n;const i=n.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _O=new Jf(3e4,6e4);function FE(){const n=Po().___jsl;if(n!=null&&n.H){for(const e of Object.keys(n.H))if(n.H[e].r=n.H[e].r||[],n.H[e].L=n.H[e].L||[],n.H[e].r=[...n.H[e].L],n.CP)for(let t=0;t<n.CP.length;t++)n.CP[t]=null}}function xO(n){return new Promise((e,t)=>{var r,i,s;function o(){FE(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{FE(),t(so(n,"network-request-failed"))},timeout:_O.get()})}if(!((i=(r=Po().gapi)===null||r===void 0?void 0:r.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Po().gapi)===null||s===void 0)&&s.load)o();else{const l=oj("iframefcb");return Po()[l]=()=>{gapi.load?o():t(so(n,"network-request-failed"))},x4(`${sj()}?onload=${l}`).catch(d=>t(d))}}).catch(e=>{throw Qp=null,e})}let Qp=null;function bO(n){return Qp=Qp||xO(n),Qp}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wO=new Jf(5e3,15e3),EO="__/auth/iframe",TO="emulator/auth/iframe",SO={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},AO=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function NO(n){const e=n.config;at(e.authDomain,n,"auth-domain-config-required");const t=e.emulator?zx(e,TO):`https://${n.config.authDomain}/${EO}`,r={apiKey:e.apiKey,appName:n.name,v:Rd},i=AO.get(n.config.apiHost);i&&(r.eid=i);const s=n._getFrameworks();return s.length&&(r.fw=s.join(",")),`${t}?${Xf(r).slice(1)}`}async function IO(n){const e=await bO(n),t=Po().gapi;return at(t,n,"internal-error"),e.open({where:document.body,url:NO(n),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:SO,dontclear:!0},r=>new Promise(async(i,s)=>{await r.restyle({setHideOnLeave:!1});const o=so(n,"network-request-failed"),l=Po().setTimeout(()=>{s(o)},wO.get());function d(){Po().clearTimeout(l),i(r)}r.ping(d).then(d,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kO={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},CO=500,PO=600,RO="_blank",jO="http://localhost";class VE{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function OO(n,e,t,r=CO,i=PO){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const d=Object.assign(Object.assign({},kO),{width:r.toString(),height:i.toString(),top:s,left:o}),f=fr().toLowerCase();t&&(l=f4(f)?RO:t),d4(f)&&(e=e||jO,d.scrollbars="yes");const m=Object.entries(d).reduce((g,[_,E])=>`${g}${_}=${E},`,"");if(Z7(f)&&l!=="_self")return MO(e||"",l),new VE(null);const y=window.open(e||"",l,m);at(y,n,"popup-blocked");try{y.focus()}catch{}return new VE(y)}function MO(n,e){const t=document.createElement("a");t.href=n,t.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DO="__/auth/handler",LO="emulator/auth/handler",FO=encodeURIComponent("fac");async function zE(n,e,t,r,i,s){at(n.config.authDomain,n,"auth-domain-config-required"),at(n.config.apiKey,n,"invalid-api-key");const o={apiKey:n.config.apiKey,appName:n.name,authType:t,redirectUrl:r,v:Rd,eventId:i};if(e instanceof Hx){e.setDefaultLanguage(n.languageCode),o.providerId=e.providerId||"",g5(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,y]of Object.entries({}))o[m]=y}if(e instanceof tm){const m=e.getScopes().filter(y=>y!=="");m.length>0&&(o.scopes=m.join(","))}n.tenantId&&(o.tid=n.tenantId);const l=o;for(const m of Object.keys(l))l[m]===void 0&&delete l[m];const d=await n._getAppCheckToken(),f=d?`#${FO}=${encodeURIComponent(d)}`:"";return`${VO(n)}?${Xf(l).slice(1)}${f}`}function VO({config:n}){return n.emulator?zx(n,LO):`https://${n.authDomain}/${DO}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wv="webStorageSupport";class zO{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=R4,this._completeRedirectFn=uO,this._overrideRedirectResult=aO}async _openPopup(e,t,r,i){var s;wa((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await zE(e,t,r,_g(),i);return OO(e,o,$x())}async _openRedirect(e,t,r,i){await this._originValidation(e);const s=await zE(e,t,r,_g(),i);return qj(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(wa(s,"If manager is not set, promise should be"),s)}const r=this.initAndGetManager(e);return this.eventManagers[t]={promise:r},r.catch(()=>{delete this.eventManagers[t]}),r}async initAndGetManager(e){const t=await IO(e),r=new hO(e);return t.register("authEvent",i=>(at(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:r.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=t,r}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(wv,{type:wv},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[wv];o!==void 0&&t(!!o),As(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=yO(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return v4()||h4()||Ux()}}const BO=zO;var BE="@firebase/auth",UE="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UO{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){at(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qO(n){switch(n){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function HO(n){Kc(new Bl("auth",(e,{options:t})=>{const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;at(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const d={apiKey:o,authDomain:l,clientPlatform:n,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:_4(n)},f=new nj(r,i,s,d);return hj(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,r)=>{e.getProvider("auth-internal").initialize()})),Kc(new Bl("auth-internal",e=>{const t=Do(e.getProvider("auth").getImmediate());return(r=>new UO(r))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),ko(BE,UE,qO(n)),ko(BE,UE,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $O=5*60,WO=KI("authIdTokenMaxAge")||$O;let qE=null;const GO=n=>async e=>{const t=e&&await e.getIdTokenResult(),r=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(r&&r>WO)return;const i=t==null?void 0:t.token;qE!==i&&(qE=i,await fetch(n,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function z4(n=cy()){const e=ly(n,"auth");if(e.isInitialized())return e.getImmediate();const t=dj(n,{popupRedirectResolver:BO,persistence:[Xj,zj,R4]}),r=KI("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(r,location.origin);if(location.origin===s.origin){const o=GO(s.toString());Mj(t,o,()=>o(t.currentUser)),Oj(t,l=>o(l))}}const i=$I("auth");return i&&fj(t,`http://${i}`),t}function KO(){var n,e;return(e=(n=document.getElementsByTagName("head"))===null||n===void 0?void 0:n[0])!==null&&e!==void 0?e:document}rj({loadJS(n){return new Promise((e,t)=>{const r=document.createElement("script");r.setAttribute("src",n),r.onload=e,r.onerror=i=>{const s=so("internal-error");s.customData=i,t(s)},r.type="text/javascript",r.charset="UTF-8",KO().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});HO("Browser");var HE=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Dl,B4;(function(){var n;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(j,k){function F(){}F.prototype=k.prototype,j.D=k.prototype,j.prototype=new F,j.prototype.constructor=j,j.C=function(O,C,D){for(var M=Array(arguments.length-2),$=2;$<arguments.length;$++)M[$-2]=arguments[$];return k.prototype[C].apply(O,M)}}function t(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,t),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(j,k,F){F||(F=0);var O=Array(16);if(typeof k=="string")for(var C=0;16>C;++C)O[C]=k.charCodeAt(F++)|k.charCodeAt(F++)<<8|k.charCodeAt(F++)<<16|k.charCodeAt(F++)<<24;else for(C=0;16>C;++C)O[C]=k[F++]|k[F++]<<8|k[F++]<<16|k[F++]<<24;k=j.g[0],F=j.g[1],C=j.g[2];var D=j.g[3],M=k+(D^F&(C^D))+O[0]+3614090360&4294967295;k=F+(M<<7&4294967295|M>>>25),M=D+(C^k&(F^C))+O[1]+3905402710&4294967295,D=k+(M<<12&4294967295|M>>>20),M=C+(F^D&(k^F))+O[2]+606105819&4294967295,C=D+(M<<17&4294967295|M>>>15),M=F+(k^C&(D^k))+O[3]+3250441966&4294967295,F=C+(M<<22&4294967295|M>>>10),M=k+(D^F&(C^D))+O[4]+4118548399&4294967295,k=F+(M<<7&4294967295|M>>>25),M=D+(C^k&(F^C))+O[5]+1200080426&4294967295,D=k+(M<<12&4294967295|M>>>20),M=C+(F^D&(k^F))+O[6]+2821735955&4294967295,C=D+(M<<17&4294967295|M>>>15),M=F+(k^C&(D^k))+O[7]+4249261313&4294967295,F=C+(M<<22&4294967295|M>>>10),M=k+(D^F&(C^D))+O[8]+1770035416&4294967295,k=F+(M<<7&4294967295|M>>>25),M=D+(C^k&(F^C))+O[9]+2336552879&4294967295,D=k+(M<<12&4294967295|M>>>20),M=C+(F^D&(k^F))+O[10]+4294925233&4294967295,C=D+(M<<17&4294967295|M>>>15),M=F+(k^C&(D^k))+O[11]+2304563134&4294967295,F=C+(M<<22&4294967295|M>>>10),M=k+(D^F&(C^D))+O[12]+1804603682&4294967295,k=F+(M<<7&4294967295|M>>>25),M=D+(C^k&(F^C))+O[13]+4254626195&4294967295,D=k+(M<<12&4294967295|M>>>20),M=C+(F^D&(k^F))+O[14]+2792965006&4294967295,C=D+(M<<17&4294967295|M>>>15),M=F+(k^C&(D^k))+O[15]+1236535329&4294967295,F=C+(M<<22&4294967295|M>>>10),M=k+(C^D&(F^C))+O[1]+4129170786&4294967295,k=F+(M<<5&4294967295|M>>>27),M=D+(F^C&(k^F))+O[6]+3225465664&4294967295,D=k+(M<<9&4294967295|M>>>23),M=C+(k^F&(D^k))+O[11]+643717713&4294967295,C=D+(M<<14&4294967295|M>>>18),M=F+(D^k&(C^D))+O[0]+3921069994&4294967295,F=C+(M<<20&4294967295|M>>>12),M=k+(C^D&(F^C))+O[5]+3593408605&4294967295,k=F+(M<<5&4294967295|M>>>27),M=D+(F^C&(k^F))+O[10]+38016083&4294967295,D=k+(M<<9&4294967295|M>>>23),M=C+(k^F&(D^k))+O[15]+3634488961&4294967295,C=D+(M<<14&4294967295|M>>>18),M=F+(D^k&(C^D))+O[4]+3889429448&4294967295,F=C+(M<<20&4294967295|M>>>12),M=k+(C^D&(F^C))+O[9]+568446438&4294967295,k=F+(M<<5&4294967295|M>>>27),M=D+(F^C&(k^F))+O[14]+3275163606&4294967295,D=k+(M<<9&4294967295|M>>>23),M=C+(k^F&(D^k))+O[3]+4107603335&4294967295,C=D+(M<<14&4294967295|M>>>18),M=F+(D^k&(C^D))+O[8]+1163531501&4294967295,F=C+(M<<20&4294967295|M>>>12),M=k+(C^D&(F^C))+O[13]+2850285829&4294967295,k=F+(M<<5&4294967295|M>>>27),M=D+(F^C&(k^F))+O[2]+4243563512&4294967295,D=k+(M<<9&4294967295|M>>>23),M=C+(k^F&(D^k))+O[7]+1735328473&4294967295,C=D+(M<<14&4294967295|M>>>18),M=F+(D^k&(C^D))+O[12]+2368359562&4294967295,F=C+(M<<20&4294967295|M>>>12),M=k+(F^C^D)+O[5]+4294588738&4294967295,k=F+(M<<4&4294967295|M>>>28),M=D+(k^F^C)+O[8]+2272392833&4294967295,D=k+(M<<11&4294967295|M>>>21),M=C+(D^k^F)+O[11]+1839030562&4294967295,C=D+(M<<16&4294967295|M>>>16),M=F+(C^D^k)+O[14]+4259657740&4294967295,F=C+(M<<23&4294967295|M>>>9),M=k+(F^C^D)+O[1]+2763975236&4294967295,k=F+(M<<4&4294967295|M>>>28),M=D+(k^F^C)+O[4]+1272893353&4294967295,D=k+(M<<11&4294967295|M>>>21),M=C+(D^k^F)+O[7]+4139469664&4294967295,C=D+(M<<16&4294967295|M>>>16),M=F+(C^D^k)+O[10]+3200236656&4294967295,F=C+(M<<23&4294967295|M>>>9),M=k+(F^C^D)+O[13]+681279174&4294967295,k=F+(M<<4&4294967295|M>>>28),M=D+(k^F^C)+O[0]+3936430074&4294967295,D=k+(M<<11&4294967295|M>>>21),M=C+(D^k^F)+O[3]+3572445317&4294967295,C=D+(M<<16&4294967295|M>>>16),M=F+(C^D^k)+O[6]+76029189&4294967295,F=C+(M<<23&4294967295|M>>>9),M=k+(F^C^D)+O[9]+3654602809&4294967295,k=F+(M<<4&4294967295|M>>>28),M=D+(k^F^C)+O[12]+3873151461&4294967295,D=k+(M<<11&4294967295|M>>>21),M=C+(D^k^F)+O[15]+530742520&4294967295,C=D+(M<<16&4294967295|M>>>16),M=F+(C^D^k)+O[2]+3299628645&4294967295,F=C+(M<<23&4294967295|M>>>9),M=k+(C^(F|~D))+O[0]+4096336452&4294967295,k=F+(M<<6&4294967295|M>>>26),M=D+(F^(k|~C))+O[7]+1126891415&4294967295,D=k+(M<<10&4294967295|M>>>22),M=C+(k^(D|~F))+O[14]+2878612391&4294967295,C=D+(M<<15&4294967295|M>>>17),M=F+(D^(C|~k))+O[5]+4237533241&4294967295,F=C+(M<<21&4294967295|M>>>11),M=k+(C^(F|~D))+O[12]+1700485571&4294967295,k=F+(M<<6&4294967295|M>>>26),M=D+(F^(k|~C))+O[3]+2399980690&4294967295,D=k+(M<<10&4294967295|M>>>22),M=C+(k^(D|~F))+O[10]+4293915773&4294967295,C=D+(M<<15&4294967295|M>>>17),M=F+(D^(C|~k))+O[1]+2240044497&4294967295,F=C+(M<<21&4294967295|M>>>11),M=k+(C^(F|~D))+O[8]+1873313359&4294967295,k=F+(M<<6&4294967295|M>>>26),M=D+(F^(k|~C))+O[15]+4264355552&4294967295,D=k+(M<<10&4294967295|M>>>22),M=C+(k^(D|~F))+O[6]+2734768916&4294967295,C=D+(M<<15&4294967295|M>>>17),M=F+(D^(C|~k))+O[13]+1309151649&4294967295,F=C+(M<<21&4294967295|M>>>11),M=k+(C^(F|~D))+O[4]+4149444226&4294967295,k=F+(M<<6&4294967295|M>>>26),M=D+(F^(k|~C))+O[11]+3174756917&4294967295,D=k+(M<<10&4294967295|M>>>22),M=C+(k^(D|~F))+O[2]+718787259&4294967295,C=D+(M<<15&4294967295|M>>>17),M=F+(D^(C|~k))+O[9]+3951481745&4294967295,j.g[0]=j.g[0]+k&4294967295,j.g[1]=j.g[1]+(C+(M<<21&4294967295|M>>>11))&4294967295,j.g[2]=j.g[2]+C&4294967295,j.g[3]=j.g[3]+D&4294967295}r.prototype.u=function(j,k){k===void 0&&(k=j.length);for(var F=k-this.blockSize,O=this.B,C=this.h,D=0;D<k;){if(C==0)for(;D<=F;)i(this,j,D),D+=this.blockSize;if(typeof j=="string"){for(;D<k;)if(O[C++]=j.charCodeAt(D++),C==this.blockSize){i(this,O),C=0;break}}else for(;D<k;)if(O[C++]=j[D++],C==this.blockSize){i(this,O),C=0;break}}this.h=C,this.o+=k},r.prototype.v=function(){var j=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);j[0]=128;for(var k=1;k<j.length-8;++k)j[k]=0;var F=8*this.o;for(k=j.length-8;k<j.length;++k)j[k]=F&255,F/=256;for(this.u(j),j=Array(16),k=F=0;4>k;++k)for(var O=0;32>O;O+=8)j[F++]=this.g[k]>>>O&255;return j};function s(j,k){var F=l;return Object.prototype.hasOwnProperty.call(F,j)?F[j]:F[j]=k(j)}function o(j,k){this.h=k;for(var F=[],O=!0,C=j.length-1;0<=C;C--){var D=j[C]|0;O&&D==k||(F[C]=D,O=!1)}this.g=F}var l={};function d(j){return-128<=j&&128>j?s(j,function(k){return new o([k|0],0>k?-1:0)}):new o([j|0],0>j?-1:0)}function f(j){if(isNaN(j)||!isFinite(j))return y;if(0>j)return w(f(-j));for(var k=[],F=1,O=0;j>=F;O++)k[O]=j/F|0,F*=4294967296;return new o(k,0)}function m(j,k){if(j.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(j.charAt(0)=="-")return w(m(j.substring(1),k));if(0<=j.indexOf("-"))throw Error('number format error: interior "-" character');for(var F=f(Math.pow(k,8)),O=y,C=0;C<j.length;C+=8){var D=Math.min(8,j.length-C),M=parseInt(j.substring(C,C+D),k);8>D?(D=f(Math.pow(k,D)),O=O.j(D).add(f(M))):(O=O.j(F),O=O.add(f(M)))}return O}var y=d(0),g=d(1),_=d(16777216);n=o.prototype,n.m=function(){if(x(this))return-w(this).m();for(var j=0,k=1,F=0;F<this.g.length;F++){var O=this.i(F);j+=(0<=O?O:4294967296+O)*k,k*=4294967296}return j},n.toString=function(j){if(j=j||10,2>j||36<j)throw Error("radix out of range: "+j);if(E(this))return"0";if(x(this))return"-"+w(this).toString(j);for(var k=f(Math.pow(j,6)),F=this,O="";;){var C=I(F,k).g;F=S(F,C.j(k));var D=((0<F.g.length?F.g[0]:F.h)>>>0).toString(j);if(F=C,E(F))return D+O;for(;6>D.length;)D="0"+D;O=D+O}},n.i=function(j){return 0>j?0:j<this.g.length?this.g[j]:this.h};function E(j){if(j.h!=0)return!1;for(var k=0;k<j.g.length;k++)if(j.g[k]!=0)return!1;return!0}function x(j){return j.h==-1}n.l=function(j){return j=S(this,j),x(j)?-1:E(j)?0:1};function w(j){for(var k=j.g.length,F=[],O=0;O<k;O++)F[O]=~j.g[O];return new o(F,~j.h).add(g)}n.abs=function(){return x(this)?w(this):this},n.add=function(j){for(var k=Math.max(this.g.length,j.g.length),F=[],O=0,C=0;C<=k;C++){var D=O+(this.i(C)&65535)+(j.i(C)&65535),M=(D>>>16)+(this.i(C)>>>16)+(j.i(C)>>>16);O=M>>>16,D&=65535,M&=65535,F[C]=M<<16|D}return new o(F,F[F.length-1]&-2147483648?-1:0)};function S(j,k){return j.add(w(k))}n.j=function(j){if(E(this)||E(j))return y;if(x(this))return x(j)?w(this).j(w(j)):w(w(this).j(j));if(x(j))return w(this.j(w(j)));if(0>this.l(_)&&0>j.l(_))return f(this.m()*j.m());for(var k=this.g.length+j.g.length,F=[],O=0;O<2*k;O++)F[O]=0;for(O=0;O<this.g.length;O++)for(var C=0;C<j.g.length;C++){var D=this.i(O)>>>16,M=this.i(O)&65535,$=j.i(C)>>>16,G=j.i(C)&65535;F[2*O+2*C]+=M*G,N(F,2*O+2*C),F[2*O+2*C+1]+=D*G,N(F,2*O+2*C+1),F[2*O+2*C+1]+=M*$,N(F,2*O+2*C+1),F[2*O+2*C+2]+=D*$,N(F,2*O+2*C+2)}for(O=0;O<k;O++)F[O]=F[2*O+1]<<16|F[2*O];for(O=k;O<2*k;O++)F[O]=0;return new o(F,0)};function N(j,k){for(;(j[k]&65535)!=j[k];)j[k+1]+=j[k]>>>16,j[k]&=65535,k++}function P(j,k){this.g=j,this.h=k}function I(j,k){if(E(k))throw Error("division by zero");if(E(j))return new P(y,y);if(x(j))return k=I(w(j),k),new P(w(k.g),w(k.h));if(x(k))return k=I(j,w(k)),new P(w(k.g),k.h);if(30<j.g.length){if(x(j)||x(k))throw Error("slowDivide_ only works with positive integers.");for(var F=g,O=k;0>=O.l(j);)F=R(F),O=R(O);var C=U(F,1),D=U(O,1);for(O=U(O,2),F=U(F,2);!E(O);){var M=D.add(O);0>=M.l(j)&&(C=C.add(F),D=M),O=U(O,1),F=U(F,1)}return k=S(j,C.j(k)),new P(C,k)}for(C=y;0<=j.l(k);){for(F=Math.max(1,Math.floor(j.m()/k.m())),O=Math.ceil(Math.log(F)/Math.LN2),O=48>=O?1:Math.pow(2,O-48),D=f(F),M=D.j(k);x(M)||0<M.l(j);)F-=O,D=f(F),M=D.j(k);E(D)&&(D=g),C=C.add(D),j=S(j,M)}return new P(C,j)}n.A=function(j){return I(this,j).h},n.and=function(j){for(var k=Math.max(this.g.length,j.g.length),F=[],O=0;O<k;O++)F[O]=this.i(O)&j.i(O);return new o(F,this.h&j.h)},n.or=function(j){for(var k=Math.max(this.g.length,j.g.length),F=[],O=0;O<k;O++)F[O]=this.i(O)|j.i(O);return new o(F,this.h|j.h)},n.xor=function(j){for(var k=Math.max(this.g.length,j.g.length),F=[],O=0;O<k;O++)F[O]=this.i(O)^j.i(O);return new o(F,this.h^j.h)};function R(j){for(var k=j.g.length+1,F=[],O=0;O<k;O++)F[O]=j.i(O)<<1|j.i(O-1)>>>31;return new o(F,j.h)}function U(j,k){var F=k>>5;k%=32;for(var O=j.g.length-F,C=[],D=0;D<O;D++)C[D]=0<k?j.i(D+F)>>>k|j.i(D+F+1)<<32-k:j.i(D+F);return new o(C,j.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,B4=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=f,o.fromString=m,Dl=o}).apply(typeof HE<"u"?HE:typeof self<"u"?self:typeof window<"u"?window:{});var xp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var U4,$h,q4,Xp,B_,H4,$4,W4;(function(){var n,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(b,q,K){return b==Array.prototype||b==Object.prototype||(b[q]=K.value),b};function t(b){b=[typeof globalThis=="object"&&globalThis,b,typeof window=="object"&&window,typeof self=="object"&&self,typeof xp=="object"&&xp];for(var q=0;q<b.length;++q){var K=b[q];if(K&&K.Math==Math)return K}throw Error("Cannot find global object")}var r=t(this);function i(b,q){if(q)e:{var K=r;b=b.split(".");for(var le=0;le<b.length-1;le++){var ye=b[le];if(!(ye in K))break e;K=K[ye]}b=b[b.length-1],le=K[b],q=q(le),q!=le&&q!=null&&e(K,b,{configurable:!0,writable:!0,value:q})}}function s(b,q){b instanceof String&&(b+="");var K=0,le=!1,ye={next:function(){if(!le&&K<b.length){var Te=K++;return{value:q(Te,b[Te]),done:!1}}return le=!0,{done:!0,value:void 0}}};return ye[Symbol.iterator]=function(){return ye},ye}i("Array.prototype.values",function(b){return b||function(){return s(this,function(q,K){return K})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function d(b){var q=typeof b;return q=q!="object"?q:b?Array.isArray(b)?"array":q:"null",q=="array"||q=="object"&&typeof b.length=="number"}function f(b){var q=typeof b;return q=="object"&&b!=null||q=="function"}function m(b,q,K){return b.call.apply(b.bind,arguments)}function y(b,q,K){if(!b)throw Error();if(2<arguments.length){var le=Array.prototype.slice.call(arguments,2);return function(){var ye=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ye,le),b.apply(q,ye)}}return function(){return b.apply(q,arguments)}}function g(b,q,K){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:y,g.apply(null,arguments)}function _(b,q){var K=Array.prototype.slice.call(arguments,1);return function(){var le=K.slice();return le.push.apply(le,arguments),b.apply(this,le)}}function E(b,q){function K(){}K.prototype=q.prototype,b.aa=q.prototype,b.prototype=new K,b.prototype.constructor=b,b.Qb=function(le,ye,Te){for(var Be=Array(arguments.length-2),tn=2;tn<arguments.length;tn++)Be[tn-2]=arguments[tn];return q.prototype[ye].apply(le,Be)}}function x(b){const q=b.length;if(0<q){const K=Array(q);for(let le=0;le<q;le++)K[le]=b[le];return K}return[]}function w(b,q){for(let K=1;K<arguments.length;K++){const le=arguments[K];if(d(le)){const ye=b.length||0,Te=le.length||0;b.length=ye+Te;for(let Be=0;Be<Te;Be++)b[ye+Be]=le[Be]}else b.push(le)}}class S{constructor(q,K){this.i=q,this.j=K,this.h=0,this.g=null}get(){let q;return 0<this.h?(this.h--,q=this.g,this.g=q.next,q.next=null):q=this.i(),q}}function N(b){return/^[\s\xa0]*$/.test(b)}function P(){var b=l.navigator;return b&&(b=b.userAgent)?b:""}function I(b){return I[" "](b),b}I[" "]=function(){};var R=P().indexOf("Gecko")!=-1&&!(P().toLowerCase().indexOf("webkit")!=-1&&P().indexOf("Edge")==-1)&&!(P().indexOf("Trident")!=-1||P().indexOf("MSIE")!=-1)&&P().indexOf("Edge")==-1;function U(b,q,K){for(const le in b)q.call(K,b[le],le,b)}function j(b,q){for(const K in b)q.call(void 0,b[K],K,b)}function k(b){const q={};for(const K in b)q[K]=b[K];return q}const F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(b,q){let K,le;for(let ye=1;ye<arguments.length;ye++){le=arguments[ye];for(K in le)b[K]=le[K];for(let Te=0;Te<F.length;Te++)K=F[Te],Object.prototype.hasOwnProperty.call(le,K)&&(b[K]=le[K])}}function C(b){var q=1;b=b.split(":");const K=[];for(;0<q&&b.length;)K.push(b.shift()),q--;return b.length&&K.push(b.join(":")),K}function D(b){l.setTimeout(()=>{throw b},0)}function M(){var b=X;let q=null;return b.g&&(q=b.g,b.g=b.g.next,b.g||(b.h=null),q.next=null),q}class ${constructor(){this.h=this.g=null}add(q,K){const le=G.get();le.set(q,K),this.h?this.h.next=le:this.g=le,this.h=le}}var G=new S(()=>new re,b=>b.reset());class re{constructor(){this.next=this.g=this.h=null}set(q,K){this.h=q,this.g=K,this.next=null}reset(){this.next=this.g=this.h=null}}let oe,ie=!1,X=new $,Y=()=>{const b=l.Promise.resolve(void 0);oe=()=>{b.then(B)}};var B=()=>{for(var b;b=M();){try{b.h.call(b.g)}catch(K){D(K)}var q=G;q.j(b),100>q.h&&(q.h++,b.next=q.g,q.g=b)}ie=!1};function Z(){this.s=this.s,this.C=this.C}Z.prototype.s=!1,Z.prototype.ma=function(){this.s||(this.s=!0,this.N())},Z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function te(b,q){this.type=b,this.g=this.target=q,this.defaultPrevented=!1}te.prototype.h=function(){this.defaultPrevented=!0};var se=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var b=!1,q=Object.defineProperty({},"passive",{get:function(){b=!0}});try{const K=()=>{};l.addEventListener("test",K,q),l.removeEventListener("test",K,q)}catch{}return b}();function ae(b,q){if(te.call(this,b?b.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,b){var K=this.type=b.type,le=b.changedTouches&&b.changedTouches.length?b.changedTouches[0]:null;if(this.target=b.target||b.srcElement,this.g=q,q=b.relatedTarget){if(R){e:{try{I(q.nodeName);var ye=!0;break e}catch{}ye=!1}ye||(q=null)}}else K=="mouseover"?q=b.fromElement:K=="mouseout"&&(q=b.toElement);this.relatedTarget=q,le?(this.clientX=le.clientX!==void 0?le.clientX:le.pageX,this.clientY=le.clientY!==void 0?le.clientY:le.pageY,this.screenX=le.screenX||0,this.screenY=le.screenY||0):(this.clientX=b.clientX!==void 0?b.clientX:b.pageX,this.clientY=b.clientY!==void 0?b.clientY:b.pageY,this.screenX=b.screenX||0,this.screenY=b.screenY||0),this.button=b.button,this.key=b.key||"",this.ctrlKey=b.ctrlKey,this.altKey=b.altKey,this.shiftKey=b.shiftKey,this.metaKey=b.metaKey,this.pointerId=b.pointerId||0,this.pointerType=typeof b.pointerType=="string"?b.pointerType:Q[b.pointerType]||"",this.state=b.state,this.i=b,b.defaultPrevented&&ae.aa.h.call(this)}}E(ae,te);var Q={2:"touch",3:"pen",4:"mouse"};ae.prototype.h=function(){ae.aa.h.call(this);var b=this.i;b.preventDefault?b.preventDefault():b.returnValue=!1};var ce="closure_listenable_"+(1e6*Math.random()|0),me=0;function ge(b,q,K,le,ye){this.listener=b,this.proxy=null,this.src=q,this.type=K,this.capture=!!le,this.ha=ye,this.key=++me,this.da=this.fa=!1}function Ae(b){b.da=!0,b.listener=null,b.proxy=null,b.src=null,b.ha=null}function Ve(b){this.src=b,this.g={},this.h=0}Ve.prototype.add=function(b,q,K,le,ye){var Te=b.toString();b=this.g[Te],b||(b=this.g[Te]=[],this.h++);var Be=Ge(b,q,le,ye);return-1<Be?(q=b[Be],K||(q.fa=!1)):(q=new ge(q,this.src,Te,!!le,ye),q.fa=K,b.push(q)),q};function Ye(b,q){var K=q.type;if(K in b.g){var le=b.g[K],ye=Array.prototype.indexOf.call(le,q,void 0),Te;(Te=0<=ye)&&Array.prototype.splice.call(le,ye,1),Te&&(Ae(q),b.g[K].length==0&&(delete b.g[K],b.h--))}}function Ge(b,q,K,le){for(var ye=0;ye<b.length;++ye){var Te=b[ye];if(!Te.da&&Te.listener==q&&Te.capture==!!K&&Te.ha==le)return ye}return-1}var ot="closure_lm_"+(1e6*Math.random()|0),nt={};function It(b,q,K,le,ye){if(Array.isArray(q)){for(var Te=0;Te<q.length;Te++)It(b,q[Te],K,le,ye);return null}return K=pt(K),b&&b[ce]?b.K(q,K,f(le)?!!le.capture:!1,ye):Gt(b,q,K,!1,le,ye)}function Gt(b,q,K,le,ye,Te){if(!q)throw Error("Invalid event type");var Be=f(ye)?!!ye.capture:!!ye,tn=gt(b);if(tn||(b[ot]=tn=new Ve(b)),K=tn.add(q,K,le,Be,Te),K.proxy)return K;if(le=Se(),K.proxy=le,le.src=b,le.listener=K,b.addEventListener)se||(ye=Be),ye===void 0&&(ye=!1),b.addEventListener(q.toString(),le,ye);else if(b.attachEvent)b.attachEvent(ze(q.toString()),le);else if(b.addListener&&b.removeListener)b.addListener(le);else throw Error("addEventListener and attachEvent are unavailable.");return K}function Se(){function b(K){return q.call(b.src,b.listener,K)}const q=ke;return b}function Ne(b,q,K,le,ye){if(Array.isArray(q))for(var Te=0;Te<q.length;Te++)Ne(b,q[Te],K,le,ye);else le=f(le)?!!le.capture:!!le,K=pt(K),b&&b[ce]?(b=b.i,q=String(q).toString(),q in b.g&&(Te=b.g[q],K=Ge(Te,K,le,ye),-1<K&&(Ae(Te[K]),Array.prototype.splice.call(Te,K,1),Te.length==0&&(delete b.g[q],b.h--)))):b&&(b=gt(b))&&(q=b.g[q.toString()],b=-1,q&&(b=Ge(q,K,le,ye)),(K=-1<b?q[b]:null)&&De(K))}function De(b){if(typeof b!="number"&&b&&!b.da){var q=b.src;if(q&&q[ce])Ye(q.i,b);else{var K=b.type,le=b.proxy;q.removeEventListener?q.removeEventListener(K,le,b.capture):q.detachEvent?q.detachEvent(ze(K),le):q.addListener&&q.removeListener&&q.removeListener(le),(K=gt(q))?(Ye(K,b),K.h==0&&(K.src=null,q[ot]=null)):Ae(b)}}}function ze(b){return b in nt?nt[b]:nt[b]="on"+b}function ke(b,q){if(b.da)b=!0;else{q=new ae(q,this);var K=b.listener,le=b.ha||b.src;b.fa&&De(b),b=K.call(le,q)}return b}function gt(b){return b=b[ot],b instanceof Ve?b:null}var mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function pt(b){return typeof b=="function"?b:(b[mt]||(b[mt]=function(q){return b.handleEvent(q)}),b[mt])}function Ct(){Z.call(this),this.i=new Ve(this),this.M=this,this.F=null}E(Ct,Z),Ct.prototype[ce]=!0,Ct.prototype.removeEventListener=function(b,q,K,le){Ne(this,b,q,K,le)};function Mt(b,q){var K,le=b.F;if(le)for(K=[];le;le=le.F)K.push(le);if(b=b.M,le=q.type||q,typeof q=="string")q=new te(q,b);else if(q instanceof te)q.target=q.target||b;else{var ye=q;q=new te(le,b),O(q,ye)}if(ye=!0,K)for(var Te=K.length-1;0<=Te;Te--){var Be=q.g=K[Te];ye=Dt(Be,le,!0,q)&&ye}if(Be=q.g=b,ye=Dt(Be,le,!0,q)&&ye,ye=Dt(Be,le,!1,q)&&ye,K)for(Te=0;Te<K.length;Te++)Be=q.g=K[Te],ye=Dt(Be,le,!1,q)&&ye}Ct.prototype.N=function(){if(Ct.aa.N.call(this),this.i){var b=this.i,q;for(q in b.g){for(var K=b.g[q],le=0;le<K.length;le++)Ae(K[le]);delete b.g[q],b.h--}}this.F=null},Ct.prototype.K=function(b,q,K,le){return this.i.add(String(b),q,!1,K,le)},Ct.prototype.L=function(b,q,K,le){return this.i.add(String(b),q,!0,K,le)};function Dt(b,q,K,le){if(q=b.i.g[String(q)],!q)return!0;q=q.concat();for(var ye=!0,Te=0;Te<q.length;++Te){var Be=q[Te];if(Be&&!Be.da&&Be.capture==K){var tn=Be.listener,zn=Be.ha||Be.src;Be.fa&&Ye(b.i,Be),ye=tn.call(zn,le)!==!1&&ye}}return ye&&!le.defaultPrevented}function rs(b,q,K){if(typeof b=="function")K&&(b=g(b,K));else if(b&&typeof b.handleEvent=="function")b=g(b.handleEvent,b);else throw Error("Invalid listener argument");return 2147483647<Number(q)?-1:l.setTimeout(b,q||0)}function Ht(b){b.g=rs(()=>{b.g=null,b.i&&(b.i=!1,Ht(b))},b.l);const q=b.h;b.h=null,b.m.apply(null,q)}class On extends Z{constructor(q,K){super(),this.m=q,this.l=K,this.h=null,this.i=!1,this.g=null}j(q){this.h=arguments,this.g?this.i=!0:Ht(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function is(b){Z.call(this),this.h=b,this.g={}}E(is,Z);var Vi=[];function pi(b){U(b.g,function(q,K){this.g.hasOwnProperty(K)&&De(q)},b),b.g={}}is.prototype.N=function(){is.aa.N.call(this),pi(this)},is.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var pr=l.JSON.stringify,gi=l.JSON.parse,ei=class{stringify(b){return l.JSON.stringify(b,void 0)}parse(b){return l.JSON.parse(b,void 0)}};function zi(){}zi.prototype.h=null;function ao(b){return b.h||(b.h=b.i())}function yi(){}var Yn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ti(){te.call(this,"d")}E(ti,te);function vi(){te.call(this,"c")}E(vi,te);var _i={},Fo=null;function yn(){return Fo=Fo||new Ct}_i.La="serverreachability";function xi(b){te.call(this,_i.La,b)}E(xi,te);function Bi(b){const q=yn();Mt(q,new xi(q))}_i.STAT_EVENT="statevent";function ss(b,q){te.call(this,_i.STAT_EVENT,b),this.stat=q}E(ss,te);function xn(b){const q=yn();Mt(q,new ss(q,b))}_i.Ma="timingevent";function Ls(b,q){te.call(this,_i.Ma,b),this.size=q}E(Ls,te);function Mr(b,q){if(typeof b!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){b()},q)}function Fs(){this.g=!0}Fs.prototype.xa=function(){this.g=!1};function ln(b,q,K,le,ye,Te){b.info(function(){if(b.g)if(Te)for(var Be="",tn=Te.split("&"),zn=0;zn<tn.length;zn++){var Bt=tn[zn].split("=");if(1<Bt.length){var rn=Bt[0];Bt=Bt[1];var wn=rn.split("_");Be=2<=wn.length&&wn[1]=="type"?Be+(rn+"="+Bt+"&"):Be+(rn+"=redacted&")}}else Be=null;else Be=Te;return"XMLHTTP REQ ("+le+") [attempt "+ye+"]: "+q+`
`+K+`
`+Be})}function $e(b,q,K,le,ye,Te,Be){b.info(function(){return"XMLHTTP RESP ("+le+") [ attempt "+ye+"]: "+q+`
`+K+`
`+Te+" "+Be})}function Er(b,q,K,le){b.info(function(){return"XMLHTTP TEXT ("+q+"): "+lo(b,K)+(le?" "+le:"")})}function Vs(b,q){b.info(function(){return"TIMEOUT: "+q})}Fs.prototype.info=function(){};function lo(b,q){if(!b.g)return q;if(!q)return null;try{var K=JSON.parse(q);if(K){for(b=0;b<K.length;b++)if(Array.isArray(K[b])){var le=K[b];if(!(2>le.length)){var ye=le[1];if(Array.isArray(ye)&&!(1>ye.length)){var Te=ye[0];if(Te!="noop"&&Te!="stop"&&Te!="close")for(var Be=1;Be<ye.length;Be++)ye[Be]=""}}}}return pr(K)}catch{return q}}var os={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},gr={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Tr;function Sr(){}E(Sr,zi),Sr.prototype.g=function(){return new XMLHttpRequest},Sr.prototype.i=function(){return{}},Tr=new Sr;function Ar(b,q,K,le){this.j=b,this.i=q,this.l=K,this.R=le||1,this.U=new is(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Vo}function Vo(){this.i=null,this.g="",this.h=!1}var zo={},Qe={};function fe(b,q,K){b.L=1,b.v=Lr(En(q)),b.m=K,b.P=!0,je(b,null)}function je(b,q){b.F=Date.now(),Nt(b),b.A=En(b.v);var K=b.A,le=b.R;Array.isArray(le)||(le=[String(le)]),ho(K.i,"t",le),b.C=0,K=b.j.J,b.h=new Vo,b.g=_u(b.j,K?q:null,!b.m),0<b.O&&(b.M=new On(g(b.Y,b,b.g),b.O)),q=b.U,K=b.g,le=b.ca;var ye="readystatechange";Array.isArray(ye)||(ye&&(Vi[0]=ye.toString()),ye=Vi);for(var Te=0;Te<ye.length;Te++){var Be=It(K,ye[Te],le||q.handleEvent,!1,q.h||q);if(!Be)break;q.g[Be.key]=Be}q=b.H?k(b.H):{},b.m?(b.u||(b.u="POST"),q["Content-Type"]="application/x-www-form-urlencoded",b.g.ea(b.A,b.u,b.m,q)):(b.u="GET",b.g.ea(b.A,b.u,null,q)),Bi(),ln(b.i,b.u,b.A,b.l,b.R,b.m)}Ar.prototype.ca=function(b){b=b.target;const q=this.M;q&&Qn(b)==3?q.j():this.Y(b)},Ar.prototype.Y=function(b){try{if(b==this.g)e:{const wn=Qn(this.g);var q=this.g.Ba();const Ni=this.g.Z();if(!(3>wn)&&(wn!=3||this.g&&(this.h.h||this.g.oa()||Ba(this.g)))){this.J||wn!=4||q==7||(q==8||0>=Ni?Bi(3):Bi(2)),kn(this);var K=this.g.Z();this.X=K;t:if(Ke(this)){var le=Ba(this.g);b="";var ye=le.length,Te=Qn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){$n(this),Zn(this);var Be="";break t}this.h.i=new l.TextDecoder}for(q=0;q<ye;q++)this.h.h=!0,b+=this.h.i.decode(le[q],{stream:!(Te&&q==ye-1)});le.length=0,this.h.g+=b,this.C=0,Be=this.h.g}else Be=this.g.oa();if(this.o=K==200,$e(this.i,this.u,this.A,this.l,this.R,wn,K),this.o){if(this.T&&!this.K){t:{if(this.g){var tn,zn=this.g;if((tn=zn.g?zn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(tn)){var Bt=tn;break t}}Bt=null}if(K=Bt)Er(this.i,this.l,K,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Ui(this,K);else{this.o=!1,this.s=3,xn(12),$n(this),Zn(this);break e}}if(this.P){K=!0;let Mn;for(;!this.J&&this.C<Be.length;)if(Mn=Kt(this,Be),Mn==Qe){wn==4&&(this.s=4,xn(14),K=!1),Er(this.i,this.l,null,"[Incomplete Response]");break}else if(Mn==zo){this.s=4,xn(15),Er(this.i,this.l,Be,"[Invalid Chunk]"),K=!1;break}else Er(this.i,this.l,Mn,null),Ui(this,Mn);if(Ke(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),wn!=4||Be.length!=0||this.h.h||(this.s=1,xn(16),K=!1),this.o=this.o&&K,!K)Er(this.i,this.l,Be,"[Invalid Chunked Response]"),$n(this),Zn(this);else if(0<Be.length&&!this.W){this.W=!0;var rn=this.j;rn.g==this&&rn.ba&&!rn.M&&(rn.j.info("Great, no buffering proxy detected. Bytes received: "+Be.length),Ha(rn),rn.M=!0,xn(11))}}else Er(this.i,this.l,Be,null),Ui(this,Be);wn==4&&$n(this),this.o&&!this.J&&(wn==4?Yo(this.j,this):(this.o=!1,Nt(this)))}else Ua(this.g),K==400&&0<Be.indexOf("Unknown SID")?(this.s=3,xn(12)):(this.s=0,xn(13)),$n(this),Zn(this)}}}catch{}finally{}};function Ke(b){return b.g?b.u=="GET"&&b.L!=2&&b.j.Ca:!1}function Kt(b,q){var K=b.C,le=q.indexOf(`
`,K);return le==-1?Qe:(K=Number(q.substring(K,le)),isNaN(K)?zo:(le+=1,le+K>q.length?Qe:(q=q.slice(le,le+K),b.C=le+K,q)))}Ar.prototype.cancel=function(){this.J=!0,$n(this)};function Nt(b){b.S=Date.now()+b.I,bn(b,b.I)}function bn(b,q){if(b.B!=null)throw Error("WatchDog timer not null");b.B=Mr(g(b.ba,b),q)}function kn(b){b.B&&(l.clearTimeout(b.B),b.B=null)}Ar.prototype.ba=function(){this.B=null;const b=Date.now();0<=b-this.S?(Vs(this.i,this.A),this.L!=2&&(Bi(),xn(17)),$n(this),this.s=2,Zn(this)):bn(this,this.S-b)};function Zn(b){b.j.G==0||b.J||Yo(b.j,b)}function $n(b){kn(b);var q=b.M;q&&typeof q.ma=="function"&&q.ma(),b.M=null,pi(b.U),b.g&&(q=b.g,b.g=null,q.abort(),q.ma())}function Ui(b,q){try{var K=b.j;if(K.G!=0&&(K.g==b||vt(K.h,b))){if(!b.K&&vt(K.h,b)&&K.G==3){try{var le=K.Da.g.parse(q)}catch{le=null}if(Array.isArray(le)&&le.length==3){var ye=le;if(ye[0]==0){e:if(!K.u){if(K.g)if(K.g.F+3e3<b.F)Wa(K),Wi(K);else break e;Ko(K),xn(18)}}else K.za=ye[1],0<K.za-K.T&&37500>ye[2]&&K.F&&K.v==0&&!K.C&&(K.C=Mr(g(K.Za,K),6e3));if(1>=co(K.h)&&K.ca){try{K.ca()}catch{}K.ca=void 0}}else $s(K,11)}else if((b.K||K.g==b)&&Wa(K),!N(q))for(ye=K.Da.g.parse(q),q=0;q<ye.length;q++){let Bt=ye[q];if(K.T=Bt[0],Bt=Bt[1],K.G==2)if(Bt[0]=="c"){K.K=Bt[1],K.ia=Bt[2];const rn=Bt[3];rn!=null&&(K.la=rn,K.j.info("VER="+K.la));const wn=Bt[4];wn!=null&&(K.Aa=wn,K.j.info("SVER="+K.Aa));const Ni=Bt[5];Ni!=null&&typeof Ni=="number"&&0<Ni&&(le=1.5*Ni,K.L=le,K.j.info("backChannelRequestTimeoutMs_="+le)),le=K;const Mn=b.g;if(Mn){const Qo=Mn.g?Mn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Qo){var Te=le.h;Te.g||Qo.indexOf("spdy")==-1&&Qo.indexOf("quic")==-1&&Qo.indexOf("h2")==-1||(Te.j=Te.l,Te.g=new Set,Te.h&&(cn(Te,Te.h),Te.h=null))}if(le.D){const Gi=Mn.g?Mn.g.getResponseHeader("X-HTTP-Session-Id"):null;Gi&&(le.ya=Gi,_t(le.I,le.D,Gi))}}K.G=3,K.l&&K.l.ua(),K.ba&&(K.R=Date.now()-b.F,K.j.info("Handshake RTT: "+K.R+"ms")),le=K;var Be=b;if(le.qa=Ga(le,le.J?le.ia:null,le.W),Be.K){Bo(le.h,Be);var tn=Be,zn=le.L;zn&&(tn.I=zn),tn.B&&(kn(tn),Nt(tn)),le.g=Be}else Fr(le);0<K.i.length&&Ai(K)}else Bt[0]!="stop"&&Bt[0]!="close"||$s(K,7);else K.G==3&&(Bt[0]=="stop"||Bt[0]=="close"?Bt[0]=="stop"?$s(K,7):Xn(K):Bt[0]!="noop"&&K.l&&K.l.ta(Bt),K.v=0)}}Bi(4)}catch{}}var vn=class{constructor(b,q){this.g=b,this.map=q}};function qi(b){this.l=b||10,l.PerformanceNavigationTiming?(b=l.performance.getEntriesByType("navigation"),b=0<b.length&&(b[0].nextHopProtocol=="hq"||b[0].nextHopProtocol=="h2")):b=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=b?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function sr(b){return b.h?!0:b.g?b.g.size>=b.j:!1}function co(b){return b.h?1:b.g?b.g.size:0}function vt(b,q){return b.h?b.h==q:b.g?b.g.has(q):!1}function cn(b,q){b.g?b.g.add(q):b.h=q}function Bo(b,q){b.h&&b.h==q?b.h=null:b.g&&b.g.has(q)&&b.g.delete(q)}qi.prototype.cancel=function(){if(this.i=zs(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const b of this.g.values())b.cancel();this.g.clear()}};function zs(b){if(b.h!=null)return b.i.concat(b.h.D);if(b.g!=null&&b.g.size!==0){let q=b.i;for(const K of b.g.values())q=q.concat(K.D);return q}return x(b.i)}function Hi(b){if(b.V&&typeof b.V=="function")return b.V();if(typeof Map<"u"&&b instanceof Map||typeof Set<"u"&&b instanceof Set)return Array.from(b.values());if(typeof b=="string")return b.split("");if(d(b)){for(var q=[],K=b.length,le=0;le<K;le++)q.push(b[le]);return q}q=[],K=0;for(le in b)q[K++]=b[le];return q}function uo(b){if(b.na&&typeof b.na=="function")return b.na();if(!b.V||typeof b.V!="function"){if(typeof Map<"u"&&b instanceof Map)return Array.from(b.keys());if(!(typeof Set<"u"&&b instanceof Set)){if(d(b)||typeof b=="string"){var q=[];b=b.length;for(var K=0;K<b;K++)q.push(K);return q}q=[],K=0;for(const le in b)q[K++]=le;return q}}}function yt(b,q){if(b.forEach&&typeof b.forEach=="function")b.forEach(q,void 0);else if(d(b)||typeof b=="string")Array.prototype.forEach.call(b,q,void 0);else for(var K=uo(b),le=Hi(b),ye=le.length,Te=0;Te<ye;Te++)q.call(void 0,le[Te],K&&K[Te],b)}var un=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function oc(b,q){if(b){b=b.split("&");for(var K=0;K<b.length;K++){var le=b[K].indexOf("="),ye=null;if(0<=le){var Te=b[K].substring(0,le);ye=b[K].substring(le+1)}else Te=b[K];q(Te,ye?decodeURIComponent(ye.replace(/\+/g," ")):"")}}}function bi(b){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,b instanceof bi){this.h=b.h,Uo(this,b.j),this.o=b.o,this.g=b.g,$i(this,b.s),this.l=b.l;var q=b.i,K=new Ei;K.i=q.i,q.g&&(K.g=new Map(q.g),K.h=q.h),Dr(this,K),this.m=b.m}else b&&(q=String(b).match(un))?(this.h=!1,Uo(this,q[1]||"",!0),this.o=Rt(q[2]||""),this.g=Rt(q[3]||"",!0),$i(this,q[4]),this.l=Rt(q[5]||"",!0),Dr(this,q[6]||"",!0),this.m=Rt(q[7]||"")):(this.h=!1,this.i=new Ei(null,this.h))}bi.prototype.toString=function(){var b=[],q=this.j;q&&b.push(wi(q,as,!0),":");var K=this.g;return(K||q=="file")&&(b.push("//"),(q=this.o)&&b.push(wi(q,as,!0),"@"),b.push(encodeURIComponent(String(K)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),K=this.s,K!=null&&b.push(":",String(K))),(K=this.l)&&(this.g&&K.charAt(0)!="/"&&b.push("/"),b.push(wi(K,K.charAt(0)=="/"?Va:Fa,!0))),(K=this.i.toString())&&b.push("?",K),(K=this.m)&&b.push("#",wi(K,Ho)),b.join("")};function En(b){return new bi(b)}function Uo(b,q,K){b.j=K?Rt(q,!0):q,b.j&&(b.j=b.j.replace(/:$/,""))}function $i(b,q){if(q){if(q=Number(q),isNaN(q)||0>q)throw Error("Bad port number "+q);b.s=q}else b.s=null}function Dr(b,q,K){q instanceof Ei?(b.i=q,Wn(b.i,b.h)):(K||(q=wi(q,qo)),b.i=new Ei(q,b.h))}function _t(b,q,K){b.i.set(q,K)}function Lr(b){return _t(b,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),b}function Rt(b,q){return b?q?decodeURI(b.replace(/%25/g,"%2525")):decodeURIComponent(b):""}function wi(b,q,K){return typeof b=="string"?(b=encodeURI(b).replace(q,La),K&&(b=b.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b):null}function La(b){return b=b.charCodeAt(0),"%"+(b>>4&15).toString(16)+(b&15).toString(16)}var as=/[#\/\?@]/g,Fa=/[#\?:]/g,Va=/[#\?]/g,qo=/[#\?@]/g,Ho=/#/g;function Ei(b,q){this.h=this.g=null,this.i=b||null,this.j=!!q}function Vn(b){b.g||(b.g=new Map,b.h=0,b.i&&oc(b.i,function(q,K){b.add(decodeURIComponent(q.replace(/\+/g," ")),K)}))}n=Ei.prototype,n.add=function(b,q){Vn(this),this.i=null,b=lt(this,b);var K=this.g.get(b);return K||this.g.set(b,K=[]),K.push(q),this.h+=1,this};function Ti(b,q){Vn(b),q=lt(b,q),b.g.has(q)&&(b.i=null,b.h-=b.g.get(q).length,b.g.delete(q))}function ni(b,q){return Vn(b),q=lt(b,q),b.g.has(q)}n.forEach=function(b,q){Vn(this),this.g.forEach(function(K,le){K.forEach(function(ye){b.call(q,ye,le,this)},this)},this)},n.na=function(){Vn(this);const b=Array.from(this.g.values()),q=Array.from(this.g.keys()),K=[];for(let le=0;le<q.length;le++){const ye=b[le];for(let Te=0;Te<ye.length;Te++)K.push(q[le])}return K},n.V=function(b){Vn(this);let q=[];if(typeof b=="string")ni(this,b)&&(q=q.concat(this.g.get(lt(this,b))));else{b=Array.from(this.g.values());for(let K=0;K<b.length;K++)q=q.concat(b[K])}return q},n.set=function(b,q){return Vn(this),this.i=null,b=lt(this,b),ni(this,b)&&(this.h-=this.g.get(b).length),this.g.set(b,[q]),this.h+=1,this},n.get=function(b,q){return b?(b=this.V(b),0<b.length?String(b[0]):q):q};function ho(b,q,K){Ti(b,q),0<K.length&&(b.i=null,b.g.set(lt(b,q),x(K)),b.h+=K.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";const b=[],q=Array.from(this.g.keys());for(var K=0;K<q.length;K++){var le=q[K];const Te=encodeURIComponent(String(le)),Be=this.V(le);for(le=0;le<Be.length;le++){var ye=Te;Be[le]!==""&&(ye+="="+encodeURIComponent(String(Be[le]))),b.push(ye)}}return this.i=b.join("&")};function lt(b,q){return q=String(q),b.j&&(q=q.toLowerCase()),q}function Wn(b,q){q&&!b.j&&(Vn(b),b.i=null,b.g.forEach(function(K,le){var ye=le.toLowerCase();le!=ye&&(Ti(this,le),ho(this,ye,K))},b)),b.j=q}function nn(b,q){const K=new Fs;if(l.Image){const le=new Image;le.onload=_(yr,K,"TestLoadImage: loaded",!0,q,le),le.onerror=_(yr,K,"TestLoadImage: error",!1,q,le),le.onabort=_(yr,K,"TestLoadImage: abort",!1,q,le),le.ontimeout=_(yr,K,"TestLoadImage: timeout",!1,q,le),l.setTimeout(function(){le.ontimeout&&le.ontimeout()},1e4),le.src=b}else q(!1)}function ac(b,q){const K=new Fs,le=new AbortController,ye=setTimeout(()=>{le.abort(),yr(K,"TestPingServer: timeout",!1,q)},1e4);fetch(b,{signal:le.signal}).then(Te=>{clearTimeout(ye),Te.ok?yr(K,"TestPingServer: ok",!0,q):yr(K,"TestPingServer: server error",!1,q)}).catch(()=>{clearTimeout(ye),yr(K,"TestPingServer: error",!1,q)})}function yr(b,q,K,le,ye){try{ye&&(ye.onload=null,ye.onerror=null,ye.onabort=null,ye.ontimeout=null),le(K)}catch{}}function lc(){this.g=new ei}function za(b,q,K){const le=K||"";try{yt(b,function(ye,Te){let Be=ye;f(ye)&&(Be=pr(ye)),q.push(le+Te+"="+encodeURIComponent(Be))})}catch(ye){throw q.push(le+"type="+encodeURIComponent("_badmap")),ye}}function Nr(b){this.l=b.Ub||null,this.j=b.eb||!1}E(Nr,zi),Nr.prototype.g=function(){return new Bs(this.l,this.j)},Nr.prototype.i=function(b){return function(){return b}}({});function Bs(b,q){Ct.call(this),this.D=b,this.o=q,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(Bs,Ct),n=Bs.prototype,n.open=function(b,q){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=b,this.A=q,this.readyState=1,or(this)},n.send=function(b){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const q={headers:this.u,method:this.B,credentials:this.m,cache:void 0};b&&(q.body=b),(this.D||l).fetch(new Request(this.A,q)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,dn(this)),this.readyState=0},n.Sa=function(b){if(this.g&&(this.l=b,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=b.headers,this.readyState=2,or(this)),this.g&&(this.readyState=3,or(this),this.g)))if(this.responseType==="arraybuffer")b.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in b){if(this.j=b.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;fo(this)}else b.text().then(this.Ra.bind(this),this.ga.bind(this))};function fo(b){b.j.read().then(b.Pa.bind(b)).catch(b.ga.bind(b))}n.Pa=function(b){if(this.g){if(this.o&&b.value)this.response.push(b.value);else if(!this.o){var q=b.value?b.value:new Uint8Array(0);(q=this.v.decode(q,{stream:!b.done}))&&(this.response=this.responseText+=q)}b.done?dn(this):or(this),this.readyState==3&&fo(this)}},n.Ra=function(b){this.g&&(this.response=this.responseText=b,dn(this))},n.Qa=function(b){this.g&&(this.response=b,dn(this))},n.ga=function(){this.g&&dn(this)};function dn(b){b.readyState=4,b.l=null,b.j=null,b.v=null,or(b)}n.setRequestHeader=function(b,q){this.u.append(b,q)},n.getResponseHeader=function(b){return this.h&&this.h.get(b.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";const b=[],q=this.h.entries();for(var K=q.next();!K.done;)K=K.value,b.push(K[0]+": "+K[1]),K=q.next();return b.join(`\r
`)};function or(b){b.onreadystatechange&&b.onreadystatechange.call(b)}Object.defineProperty(Bs.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(b){this.m=b?"include":"same-origin"}});function ls(b){let q="";return U(b,function(K,le){q+=le,q+=":",q+=K,q+=`\r
`}),q}function Us(b,q,K){e:{for(le in K){var le=!1;break e}le=!0}le||(K=ls(K),typeof b=="string"?K!=null&&encodeURIComponent(String(K)):_t(b,q,K))}function Tn(b){Ct.call(this),this.headers=new Map,this.o=b||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(Tn,Ct);var yu=/^https?$/i,$o=["POST","PUT"];n=Tn.prototype,n.Ha=function(b){this.J=b},n.ea=function(b,q,K,le){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+b);q=q?q.toUpperCase():"GET",this.D=b,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Tr.g(),this.v=this.o?ao(this.o):ao(Tr),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(q,String(b),!0),this.B=!1}catch(Te){Wo(this,Te);return}if(b=K||"",K=new Map(this.headers),le)if(Object.getPrototypeOf(le)===Object.prototype)for(var ye in le)K.set(ye,le[ye]);else if(typeof le.keys=="function"&&typeof le.get=="function")for(const Te of le.keys())K.set(Te,le.get(Te));else throw Error("Unknown input type for opt_headers: "+String(le));le=Array.from(K.keys()).find(Te=>Te.toLowerCase()=="content-type"),ye=l.FormData&&b instanceof l.FormData,!(0<=Array.prototype.indexOf.call($o,q,void 0))||le||ye||K.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Te,Be]of K)this.g.setRequestHeader(Te,Be);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{vr(this),this.u=!0,this.g.send(b),this.u=!1}catch(Te){Wo(this,Te)}};function Wo(b,q){b.h=!1,b.g&&(b.j=!0,b.g.abort(),b.j=!1),b.l=q,b.m=5,Go(b),ri(b)}function Go(b){b.A||(b.A=!0,Mt(b,"complete"),Mt(b,"error"))}n.abort=function(b){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=b||7,Mt(this,"complete"),Mt(this,"abort"),ri(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ri(this,!0)),Tn.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?jt(this):this.bb())},n.bb=function(){jt(this)};function jt(b){if(b.h&&typeof o<"u"&&(!b.v[1]||Qn(b)!=4||b.Z()!=2)){if(b.u&&Qn(b)==4)rs(b.Ea,0,b);else if(Mt(b,"readystatechange"),Qn(b)==4){b.h=!1;try{const Be=b.Z();e:switch(Be){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var q=!0;break e;default:q=!1}var K;if(!(K=q)){var le;if(le=Be===0){var ye=String(b.D).match(un)[1]||null;!ye&&l.self&&l.self.location&&(ye=l.self.location.protocol.slice(0,-1)),le=!yu.test(ye?ye.toLowerCase():"")}K=le}if(K)Mt(b,"complete"),Mt(b,"success");else{b.m=6;try{var Te=2<Qn(b)?b.g.statusText:""}catch{Te=""}b.l=Te+" ["+b.Z()+"]",Go(b)}}finally{ri(b)}}}}function ri(b,q){if(b.g){vr(b);const K=b.g,le=b.v[0]?()=>{}:null;b.g=null,b.v=null,q||Mt(b,"ready");try{K.onreadystatechange=le}catch{}}}function vr(b){b.I&&(l.clearTimeout(b.I),b.I=null)}n.isActive=function(){return!!this.g};function Qn(b){return b.g?b.g.readyState:0}n.Z=function(){try{return 2<Qn(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(b){if(this.g){var q=this.g.responseText;return b&&q.indexOf(b)==0&&(q=q.substring(b.length)),gi(q)}};function Ba(b){try{if(!b.g)return null;if("response"in b.g)return b.g.response;switch(b.H){case"":case"text":return b.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in b.g)return b.g.mozResponseArrayBuffer}return null}catch{return null}}function Ua(b){const q={};b=(b.g&&2<=Qn(b)&&b.g.getAllResponseHeaders()||"").split(`\r
`);for(let le=0;le<b.length;le++){if(N(b[le]))continue;var K=C(b[le]);const ye=K[0];if(K=K[1],typeof K!="string")continue;K=K.trim();const Te=q[ye]||[];q[ye]=Te,Te.push(K)}j(q,function(le){return le.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Si(b,q,K){return K&&K.internalChannelParams&&K.internalChannelParams[b]||q}function cc(b){this.Aa=0,this.i=[],this.j=new Fs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Si("failFast",!1,b),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Si("baseRetryDelayMs",5e3,b),this.cb=Si("retryDelaySeedMs",1e4,b),this.Wa=Si("forwardChannelMaxRetries",2,b),this.wa=Si("forwardChannelRequestTimeoutMs",2e4,b),this.pa=b&&b.xmlHttpFactory||void 0,this.Xa=b&&b.Tb||void 0,this.Ca=b&&b.useFetchStreams||!1,this.L=void 0,this.J=b&&b.supportsCrossDomainXhr||!1,this.K="",this.h=new qi(b&&b.concurrentRequestLimit),this.Da=new lc,this.P=b&&b.fastHandshake||!1,this.O=b&&b.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=b&&b.Rb||!1,b&&b.xa&&this.j.xa(),b&&b.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&b&&b.detectBufferingProxy||!1,this.ja=void 0,b&&b.longPollingTimeout&&0<b.longPollingTimeout&&(this.ja=b.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=cc.prototype,n.la=8,n.G=1,n.connect=function(b,q,K,le){xn(0),this.W=b,this.H=q||{},K&&le!==void 0&&(this.H.OSID=K,this.H.OAID=le),this.F=this.X,this.I=Ga(this,null,this.W),Ai(this)};function Xn(b){if(qa(b),b.G==3){var q=b.U++,K=En(b.I);if(_t(K,"SID",b.K),_t(K,"RID",q),_t(K,"TYPE","terminate"),qs(b,K),q=new Ar(b,b.j,q),q.L=2,q.v=Lr(En(K)),K=!1,l.navigator&&l.navigator.sendBeacon)try{K=l.navigator.sendBeacon(q.v.toString(),"")}catch{}!K&&l.Image&&(new Image().src=q.v,K=!0),K||(q.g=_u(q.j,null),q.g.ea(q.v)),q.F=Date.now(),Nt(q)}vu(b)}function Wi(b){b.g&&(Ha(b),b.g.cancel(),b.g=null)}function qa(b){Wi(b),b.u&&(l.clearTimeout(b.u),b.u=null),Wa(b),b.h.cancel(),b.s&&(typeof b.s=="number"&&l.clearTimeout(b.s),b.s=null)}function Ai(b){if(!sr(b.h)&&!b.s){b.s=!0;var q=b.Ga;oe||Y(),ie||(oe(),ie=!0),X.add(q,b),b.B=0}}function Wd(b,q){return co(b.h)>=b.h.j-(b.s?1:0)?!1:b.s?(b.i=q.D.concat(b.i),!0):b.G==1||b.G==2||b.B>=(b.Va?0:b.Wa)?!1:(b.s=Mr(g(b.Ga,b,q),uc(b,b.B)),b.B++,!0)}n.Ga=function(b){if(this.s)if(this.s=null,this.G==1){if(!b){this.U=Math.floor(1e5*Math.random()),b=this.U++;const ye=new Ar(this,this.j,b);let Te=this.o;if(this.S&&(Te?(Te=k(Te),O(Te,this.S)):Te=this.S),this.m!==null||this.O||(ye.H=Te,Te=null),this.P)e:{for(var q=0,K=0;K<this.i.length;K++){t:{var le=this.i[K];if("__data__"in le.map&&(le=le.map.__data__,typeof le=="string")){le=le.length;break t}le=void 0}if(le===void 0)break;if(q+=le,4096<q){q=K;break e}if(q===4096||K===this.i.length-1){q=K+1;break e}}q=1e3}else q=1e3;q=Hs(this,ye,q),K=En(this.I),_t(K,"RID",b),_t(K,"CVER",22),this.D&&_t(K,"X-HTTP-Session-Id",this.D),qs(this,K),Te&&(this.O?q="headers="+encodeURIComponent(String(ls(Te)))+"&"+q:this.m&&Us(K,this.m,Te)),cn(this.h,ye),this.Ua&&_t(K,"TYPE","init"),this.P?(_t(K,"$req",q),_t(K,"SID","null"),ye.T=!0,fe(ye,K,null)):fe(ye,K,q),this.G=2}}else this.G==3&&(b?Ir(this,b):this.i.length==0||sr(this.h)||Ir(this))};function Ir(b,q){var K;q?K=q.l:K=b.U++;const le=En(b.I);_t(le,"SID",b.K),_t(le,"RID",K),_t(le,"AID",b.T),qs(b,le),b.m&&b.o&&Us(le,b.m,b.o),K=new Ar(b,b.j,K,b.B+1),b.m===null&&(K.H=b.o),q&&(b.i=q.D.concat(b.i)),q=Hs(b,K,1e3),K.I=Math.round(.5*b.wa)+Math.round(.5*b.wa*Math.random()),cn(b.h,K),fe(K,le,q)}function qs(b,q){b.H&&U(b.H,function(K,le){_t(q,le,K)}),b.l&&yt({},function(K,le){_t(q,le,K)})}function Hs(b,q,K){K=Math.min(b.i.length,K);var le=b.l?g(b.l.Na,b.l,b):null;e:{var ye=b.i;let Te=-1;for(;;){const Be=["count="+K];Te==-1?0<K?(Te=ye[0].g,Be.push("ofs="+Te)):Te=0:Be.push("ofs="+Te);let tn=!0;for(let zn=0;zn<K;zn++){let Bt=ye[zn].g;const rn=ye[zn].map;if(Bt-=Te,0>Bt)Te=Math.max(0,ye[zn].g-100),tn=!1;else try{za(rn,Be,"req"+Bt+"_")}catch{le&&le(rn)}}if(tn){le=Be.join("&");break e}}}return b=b.i.splice(0,K),q.D=b,le}function Fr(b){if(!b.g&&!b.u){b.Y=1;var q=b.Fa;oe||Y(),ie||(oe(),ie=!0),X.add(q,b),b.v=0}}function Ko(b){return b.g||b.u||3<=b.v?!1:(b.Y++,b.u=Mr(g(b.Fa,b),uc(b,b.v)),b.v++,!0)}n.Fa=function(){if(this.u=null,$a(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var b=2*this.R;this.j.info("BP detection timer enabled: "+b),this.A=Mr(g(this.ab,this),b)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,xn(10),Wi(this),$a(this))};function Ha(b){b.A!=null&&(l.clearTimeout(b.A),b.A=null)}function $a(b){b.g=new Ar(b,b.j,"rpc",b.Y),b.m===null&&(b.g.H=b.o),b.g.O=0;var q=En(b.qa);_t(q,"RID","rpc"),_t(q,"SID",b.K),_t(q,"AID",b.T),_t(q,"CI",b.F?"0":"1"),!b.F&&b.ja&&_t(q,"TO",b.ja),_t(q,"TYPE","xmlhttp"),qs(b,q),b.m&&b.o&&Us(q,b.m,b.o),b.L&&(b.g.I=b.L);var K=b.g;b=b.ia,K.L=1,K.v=Lr(En(q)),K.m=null,K.P=!0,je(K,b)}n.Za=function(){this.C!=null&&(this.C=null,Wi(this),Ko(this),xn(19))};function Wa(b){b.C!=null&&(l.clearTimeout(b.C),b.C=null)}function Yo(b,q){var K=null;if(b.g==q){Wa(b),Ha(b),b.g=null;var le=2}else if(vt(b.h,q))K=q.D,Bo(b.h,q),le=1;else return;if(b.G!=0){if(q.o)if(le==1){K=q.m?q.m.length:0,q=Date.now()-q.F;var ye=b.B;le=yn(),Mt(le,new Ls(le,K)),Ai(b)}else Fr(b);else if(ye=q.s,ye==3||ye==0&&0<q.X||!(le==1&&Wd(b,q)||le==2&&Ko(b)))switch(K&&0<K.length&&(q=b.h,q.i=q.i.concat(K)),ye){case 1:$s(b,5);break;case 4:$s(b,10);break;case 3:$s(b,6);break;default:$s(b,2)}}}function uc(b,q){let K=b.Ta+Math.floor(Math.random()*b.cb);return b.isActive()||(K*=2),K*q}function $s(b,q){if(b.j.info("Error code "+q),q==2){var K=g(b.fb,b),le=b.Xa;const ye=!le;le=new bi(le||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Uo(le,"https"),Lr(le),ye?nn(le.toString(),K):ac(le.toString(),K)}else xn(2);b.G=0,b.l&&b.l.sa(q),vu(b),qa(b)}n.fb=function(b){b?(this.j.info("Successfully pinged google.com"),xn(2)):(this.j.info("Failed to ping google.com"),xn(1))};function vu(b){if(b.G=0,b.ka=[],b.l){const q=zs(b.h);(q.length!=0||b.i.length!=0)&&(w(b.ka,q),w(b.ka,b.i),b.h.i.length=0,x(b.i),b.i.length=0),b.l.ra()}}function Ga(b,q,K){var le=K instanceof bi?En(K):new bi(K);if(le.g!="")q&&(le.g=q+"."+le.g),$i(le,le.s);else{var ye=l.location;le=ye.protocol,q=q?q+"."+ye.hostname:ye.hostname,ye=+ye.port;var Te=new bi(null);le&&Uo(Te,le),q&&(Te.g=q),ye&&$i(Te,ye),K&&(Te.l=K),le=Te}return K=b.D,q=b.ya,K&&q&&_t(le,K,q),_t(le,"VER",b.la),qs(b,le),le}function _u(b,q,K){if(q&&!b.J)throw Error("Can't create secondary domain capable XhrIo object.");return q=b.Ca&&!b.pa?new Tn(new Nr({eb:K})):new Tn(b.pa),q.Ha(b.J),q}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function Ka(){}n=Ka.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function Zo(){}Zo.prototype.g=function(b,q){return new Jn(b,q)};function Jn(b,q){Ct.call(this),this.g=new cc(q),this.l=b,this.h=q&&q.messageUrlParams||null,b=q&&q.messageHeaders||null,q&&q.clientProtocolHeaderRequired&&(b?b["X-Client-Protocol"]="webchannel":b={"X-Client-Protocol":"webchannel"}),this.g.o=b,b=q&&q.initMessageHeaders||null,q&&q.messageContentType&&(b?b["X-WebChannel-Content-Type"]=q.messageContentType:b={"X-WebChannel-Content-Type":q.messageContentType}),q&&q.va&&(b?b["X-WebChannel-Client-Profile"]=q.va:b={"X-WebChannel-Client-Profile":q.va}),this.g.S=b,(b=q&&q.Sb)&&!N(b)&&(this.g.m=b),this.v=q&&q.supportsCrossDomainXhr||!1,this.u=q&&q.sendRawJson||!1,(q=q&&q.httpSessionIdParam)&&!N(q)&&(this.g.D=q,b=this.h,b!==null&&q in b&&(b=this.h,q in b&&delete b[q])),this.j=new Vr(this)}E(Jn,Ct),Jn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Jn.prototype.close=function(){Xn(this.g)},Jn.prototype.o=function(b){var q=this.g;if(typeof b=="string"){var K={};K.__data__=b,b=K}else this.u&&(K={},K.__data__=pr(b),b=K);q.i.push(new vn(q.Ya++,b)),q.G==3&&Ai(q)},Jn.prototype.N=function(){this.g.l=null,delete this.j,Xn(this.g),delete this.g,Jn.aa.N.call(this)};function cs(b){ti.call(this),b.__headers__&&(this.headers=b.__headers__,this.statusCode=b.__status__,delete b.__headers__,delete b.__status__);var q=b.__sm__;if(q){e:{for(const K in q){b=K;break e}b=void 0}(this.i=b)&&(b=this.i,q=q!==null&&b in q?q[b]:void 0),this.data=q}else this.data=b}E(cs,ti);function xu(){vi.call(this),this.status=1}E(xu,vi);function Vr(b){this.g=b}E(Vr,Ka),Vr.prototype.ua=function(){Mt(this.g,"a")},Vr.prototype.ta=function(b){Mt(this.g,new cs(b))},Vr.prototype.sa=function(b){Mt(this.g,new xu)},Vr.prototype.ra=function(){Mt(this.g,"b")},Zo.prototype.createWebChannel=Zo.prototype.g,Jn.prototype.send=Jn.prototype.o,Jn.prototype.open=Jn.prototype.m,Jn.prototype.close=Jn.prototype.close,W4=function(){return new Zo},$4=function(){return yn()},H4=_i,B_={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},os.NO_ERROR=0,os.TIMEOUT=8,os.HTTP_ERROR=6,Xp=os,gr.COMPLETE="complete",q4=gr,yi.EventType=Yn,Yn.OPEN="a",Yn.CLOSE="b",Yn.ERROR="c",Yn.MESSAGE="d",Ct.prototype.listen=Ct.prototype.K,$h=yi,Tn.prototype.listenOnce=Tn.prototype.L,Tn.prototype.getLastError=Tn.prototype.Ka,Tn.prototype.getLastErrorCode=Tn.prototype.Ba,Tn.prototype.getStatus=Tn.prototype.Z,Tn.prototype.getResponseJson=Tn.prototype.Oa,Tn.prototype.getResponseText=Tn.prototype.oa,Tn.prototype.send=Tn.prototype.ea,Tn.prototype.setWithCredentials=Tn.prototype.Ha,U4=Tn}).apply(typeof xp<"u"?xp:typeof self<"u"?self:typeof window<"u"?window:{});const $E="@firebase/firestore",WE="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Pr=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Pr.UNAUTHENTICATED=new Pr(null),Pr.GOOGLE_CREDENTIALS=new Pr("google-credentials-uid"),Pr.FIRST_PARTY=new Pr("first-party-uid"),Pr.MOCK_USER=new Pr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jd="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qc=new Mx("@firebase/firestore");function nd(){return Qc.logLevel}function Me(n,...e){if(Qc.logLevel<=Ut.DEBUG){const t=e.map(Gx);Qc.debug(`Firestore (${jd}): ${n}`,...t)}}function ui(n,...e){if(Qc.logLevel<=Ut.ERROR){const t=e.map(Gx);Qc.error(`Firestore (${jd}): ${n}`,...t)}}function Xc(n,...e){if(Qc.logLevel<=Ut.WARN){const t=e.map(Gx);Qc.warn(`Firestore (${jd}): ${n}`,...t)}}function Gx(n){if(typeof n=="string")return n;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(n)}catch{return n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function et(n,e,t){let r="Unexpected state";typeof e=="string"?r=e:t=e,G4(n,r,t)}function G4(n,e,t){let r=`FIRESTORE (${jd}) INTERNAL ASSERTION FAILED: ${e} (ID: ${n.toString(16)})`;if(t!==void 0)try{r+=" CONTEXT: "+JSON.stringify(t)}catch{r+=" CONTEXT: "+t}throw ui(r),new Error(r)}function it(n,e,t,r){let i="Unexpected state";typeof t=="string"?i=t:r=t,n||G4(e,i,r)}function At(n,e){return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ue extends Na{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K4{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class YO{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Pr.UNAUTHENTICATED))}shutdown(){}}class ZO{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class QO{constructor(e){this.t=e,this.currentUser=Pr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){it(this.o===void 0,42304);let r=this.i;const i=d=>this.i!==r?(r=this.i,t(d)):Promise.resolve();let s=new oo;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new oo,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const d=s;e.enqueueRetryable(async()=>{await d.promise,await i(this.currentUser)})},l=d=>{Me("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(d=>l(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?l(d):(Me("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new oo)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(r=>this.i!==e?(Me("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(it(typeof r.accessToken=="string",31837,{l:r}),new K4(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return it(e===null||typeof e=="string",2055,{h:e}),new Pr(e)}}class XO{constructor(e,t,r){this.P=e,this.T=t,this.I=r,this.type="FirstParty",this.user=Pr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class JO{constructor(e,t,r){this.P=e,this.T=t,this.I=r}getToken(){return Promise.resolve(new XO(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Pr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class GE{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class eM{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ci(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){it(this.o===void 0,3512);const r=s=>{s.error!=null&&Me("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,Me("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>r(s))};const i=s=>{Me("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):Me("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new GE(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(it(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new GE(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tM(n){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(n);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let r=0;r<n;r++)t[r]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y4(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z4{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const i=tM(40);for(let s=0;s<i.length;++s)r.length<20&&i[s]<t&&(r+=e.charAt(i[s]%62))}return r}}function xt(n,e){return n<e?-1:n>e?1:0}function U_(n,e){let t=0;for(;t<n.length&&t<e.length;){const r=n.codePointAt(t),i=e.codePointAt(t);if(r!==i){if(r<128&&i<128)return xt(r,i);{const s=Y4(),o=nM(s.encode(KE(n,t)),s.encode(KE(e,t)));return o!==0?o:xt(r,i)}}t+=r>65535?2:1}return xt(n.length,e.length)}function KE(n,e){return n.codePointAt(e)>65535?n.substring(e,e+2):n.substring(e,e+1)}function nM(n,e){for(let t=0;t<n.length&&t<e.length;++t)if(n[t]!==e[t])return xt(n[t],e[t]);return xt(n.length,e.length)}function pd(n,e,t){return n.length===e.length&&n.every((r,i)=>t(r,e[i]))}function Q4(n){return n+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YE=-62135596800,ZE=1e6;class Ot{static now(){return Ot.fromMillis(Date.now())}static fromDate(e){return Ot.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*ZE);return new Ot(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ue(Ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ue(Ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<YE)throw new Ue(Ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ue(Ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ZE}_compareTo(e){return this.seconds===e.seconds?xt(this.nanoseconds,e.nanoseconds):xt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-YE;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ut{static fromTimestamp(e){return new ut(e)}static min(){return new ut(new Ot(0,0))}static max(){return new ut(new Ot(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q_="__name__";class Ao{constructor(e,t,r){t===void 0?t=0:t>e.length&&et(637,{offset:t,range:e.length}),r===void 0?r=e.length-t:r>e.length-t&&et(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return Ao.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Ao?e.forEach(r=>{t.push(r)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const r=Math.min(e.length,t.length);for(let i=0;i<r;i++){const s=Ao.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return xt(e.length,t.length)}static compareSegments(e,t){const r=Ao.isNumericId(e),i=Ao.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?Ao.extractNumericId(e).compare(Ao.extractNumericId(t)):U_(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Dl.fromString(e.substring(4,e.length-2))}}class on extends Ao{construct(e,t,r){return new on(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const r of e){if(r.indexOf("//")>=0)throw new Ue(Ie.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(i=>i.length>0))}return new on(t)}static emptyPath(){return new on([])}}const rM=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Fn extends Ao{construct(e,t,r){return new Fn(e,t,r)}static isValidIdentifier(e){return rM.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Fn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===q_}static keyField(){return new Fn([q_])}static fromServerFormat(e){const t=[];let r="",i=0;const s=()=>{if(r.length===0)throw new Ue(Ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new Ue(Ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[i+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new Ue(Ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=d,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(r+=l,i++):(s(),i++)}if(s(),o)throw new Ue(Ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Fn(t)}static emptyPath(){return new Fn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e){this.path=e}static fromPath(e){return new qe(on.fromString(e))}static fromName(e){return new qe(on.fromString(e).popFirst(5))}static empty(){return new qe(on.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&on.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return on.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new qe(new on(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Af=-1;class Sg{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function H_(n){return n.fields.find(e=>e.kind===2)}function Rc(n){return n.fields.filter(e=>e.kind!==2)}Sg.UNKNOWN_ID=-1;class Jp{constructor(e,t){this.fieldPath=e,this.kind=t}}class Nf{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Nf(0,ns.min())}}function iM(n,e){const t=n.toTimestamp().seconds,r=n.toTimestamp().nanoseconds+1,i=ut.fromTimestamp(r===1e9?new Ot(t+1,0):new Ot(t,r));return new ns(i,qe.empty(),e)}function X4(n){return new ns(n.readTime,n.key,Af)}class ns{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new ns(ut.min(),qe.empty(),Af)}static max(){return new ns(ut.max(),qe.empty(),Af)}}function Kx(n,e){let t=n.readTime.compareTo(e.readTime);return t!==0?t:(t=qe.comparator(n.documentKey,e.documentKey),t!==0?t:xt(n.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J4="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class ek{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hu(n){if(n.code!==Ie.FAILED_PRECONDITION||n.message!==J4)throw n;Me("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _e{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&et(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new _e((r,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(r,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof _e?t:_e.resolve(t)}catch(t){return _e.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):_e.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):_e.reject(t)}static resolve(e){return new _e((t,r)=>{t(e)})}static reject(e){return new _e((t,r)=>{r(e)})}static waitFor(e){return new _e((t,r)=>{let i=0,s=0,o=!1;e.forEach(l=>{++i,l.next(()=>{++s,o&&s===i&&t()},d=>r(d))}),o=!0,s===i&&t()})}static or(e){let t=_e.resolve(!1);for(const r of e)t=t.next(i=>i?_e.resolve(i):r());return t}static forEach(e,t){const r=[];return e.forEach((i,s)=>{r.push(t.call(this,i,s))}),this.waitFor(r)}static mapArray(e,t){return new _e((r,i)=>{const s=e.length,o=new Array(s);let l=0;for(let d=0;d<s;d++){const f=d;t(e[f]).next(m=>{o[f]=m,++l,l===s&&r(o)},m=>i(m))}})}static doWhile(e,t){return new _e((r,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):r()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ji="SimpleDb";class my{static open(e,t,r,i){try{return new my(t,e.transaction(i,r))}catch(s){throw new lf(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new oo,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new lf(e,t.error)):this.S.resolve()},this.transaction.onerror=r=>{const i=Yx(r.target.error);this.S.reject(new lf(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Me(Ji,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new oM(t)}}class Ll{static delete(e){return Me(Ji,"Removing database:",e),Dc(HI().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!XI())return!1;if(Ll.F())return!0;const e=fr(),t=Ll.M(e),r=0<t&&t<10,i=tk(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,t,r){this.name=e,this.version=t,this.B=r,this.L=null,Ll.M(fr())===12.2&&ui("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(Me(Ji,"Opening database:",this.name),this.db=await new Promise((t,r)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;t(o)},i.onblocked=()=>{r(new lf(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?r(new Ue(Ie.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new Ue(Ie.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new lf(e,o))},i.onupgradeneeded=s=>{Me(Ji,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;if(this.L!==null&&this.L!==s.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${s.oldVersion}, event.newVersion=${s.newVersion}, db.version=${o.version}`);this.B.q(o,i.transaction,s.oldVersion,this.version).next(()=>{Me(Ji,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",t=>{const r=t.target;this.L=r.version},{passive:!0})),this.$&&(this.db.onversionchange=t=>this.$(t)),this.db}U(e){this.$=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,r,i){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.k(e);const l=my.open(this.db,e,s?"readonly":"readwrite",r),d=i(l).next(f=>(l.v(),f)).catch(f=>(l.abort(f),_e.reject(f))).toPromise();return d.catch(()=>{}),await l.D,d}catch(l){const d=l,f=d.name!=="FirebaseError"&&o<3;if(Me(Ji,"Transaction failed with error:",d.message,"Retrying:",f),this.close(),!f)return Promise.reject(d)}}}close(){this.db&&this.db.close(),this.db=void 0}}function tk(n){const e=n.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class sM{constructor(e){this.K=e,this.W=!1,this.G=null}get isDone(){return this.W}get j(){return this.G}set cursor(e){this.K=e}done(){this.W=!0}H(e){this.G=e}delete(){return Dc(this.K.delete())}}class lf extends Ue{constructor(e,t){super(Ie.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function ec(n){return n.name==="IndexedDbTransactionError"}class oM{constructor(e){this.store=e}put(e,t){let r;return t!==void 0?(Me(Ji,"PUT",this.store.name,e,t),r=this.store.put(t,e)):(Me(Ji,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Dc(r)}add(e){return Me(Ji,"ADD",this.store.name,e,e),Dc(this.store.add(e))}get(e){return Dc(this.store.get(e)).next(t=>(t===void 0&&(t=null),Me(Ji,"GET",this.store.name,e,t),t))}delete(e){return Me(Ji,"DELETE",this.store.name,e),Dc(this.store.delete(e))}count(){return Me(Ji,"COUNT",this.store.name),Dc(this.store.count())}J(e,t){const r=this.options(e,t),i=r.index?this.store.index(r.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(r.range);return new _e((o,l)=>{s.onerror=d=>{l(d.target.error)},s.onsuccess=d=>{o(d.target.result)}})}{const s=this.cursor(r),o=[];return this.Y(s,(l,d)=>{o.push(d)}).next(()=>o)}}Z(e,t){const r=this.store.getAll(e,t===null?void 0:t);return new _e((i,s)=>{r.onerror=o=>{s(o.target.error)},r.onsuccess=o=>{i(o.target.result)}})}X(e,t){Me(Ji,"DELETE ALL",this.store.name);const r=this.options(e,t);r.ee=!1;const i=this.cursor(r);return this.Y(i,(s,o,l)=>l.delete())}te(e,t){let r;t?r=e:(r={},t=e);const i=this.cursor(r);return this.Y(i,t)}ne(e){const t=this.cursor({});return new _e((r,i)=>{t.onerror=s=>{const o=Yx(s.target.error);i(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():r()}):r()}})}Y(e,t){const r=[];return new _e((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void i();const d=new sM(l),f=t(l.primaryKey,l.value,d);if(f instanceof _e){const m=f.catch(y=>(d.done(),_e.reject(y)));r.push(m)}d.isDone?i():d.j===null?l.continue():l.continue(d.j)}}).next(()=>_e.waitFor(r))}options(e,t){let r;return e!==void 0&&(typeof e=="string"?r=e:t=e),{index:r,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const r=this.store.index(e.index);return e.ee?r.openKeyCursor(e.range,t):r.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Dc(n){return new _e((e,t)=>{n.onsuccess=r=>{const i=r.target.result;e(i)},n.onerror=r=>{const i=Yx(r.target.error);t(i)}})}let QE=!1;function Yx(n){const e=Ll.M(fr());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(t)>=0){const r=new Ue("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return QE||(QE=!0,setTimeout(()=>{throw r},0)),r}}return n}const cf="IndexBackfiller";class aM{constructor(e,t){this.asyncQueue=e,this.re=t,this.task=null}start(){this.ie(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ie(e){Me(cf,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.re.se();Me(cf,`Documents written: ${t}`)}catch(t){ec(t)?Me(cf,"Ignoring IndexedDB error during index backfill: ",t):await hu(t)}await this.ie(6e4)})}}class lM{constructor(e,t){this.localStore=e,this.persistence=t}async se(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.oe(t,e))}oe(e,t){const r=new Set;let i=t,s=!0;return _e.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return Me(cf,`Processing collection: ${o}`),this._e(e,o,i).next(l=>{i-=l,r.add(o)});s=!1})).next(()=>t-i)}_e(e,t,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,r).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ae(i,s)).next(l=>(Me(cf,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l))).next(()=>o.size)}))}ae(e,t){let r=e;return t.changes.forEach((i,s)=>{const o=X4(s);Kx(o,r)>0&&(r=o)}),new ns(r.readTime,r.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=r=>this.ue(r),this.ce=r=>t.writeSequenceNumber(r))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}ws.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qc=-1;function py(n){return n==null}function If(n){return n===0&&1/n==-1/0}function cM(n){return typeof n=="number"&&Number.isInteger(n)&&!If(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ag="";function Qr(n){let e="";for(let t=0;t<n.length;t++)e.length>0&&(e=XE(e)),e=uM(n.get(t),e);return XE(e)}function uM(n,e){let t=e;const r=n.length;for(let i=0;i<r;i++){const s=n.charAt(i);switch(s){case"\0":t+="";break;case Ag:t+="";break;default:t+=s}}return t}function XE(n){return n+Ag+""}function No(n){const e=n.length;if(it(e>=2,64408,{path:n}),e===2)return it(n.charAt(0)===Ag&&n.charAt(1)==="",56145,{path:n}),on.emptyPath();const t=e-2,r=[];let i="";for(let s=0;s<e;){const o=n.indexOf(Ag,s);switch((o<0||o>t)&&et(50515,{path:n}),n.charAt(o+1)){case"":const l=n.substring(s,o);let d;i.length===0?d=l:(i+=l,d=i,i=""),r.push(d);break;case"":i+=n.substring(s,o),i+="\0";break;case"":i+=n.substring(s,o+1);break;default:et(61167,{path:n})}s=o+2}return new on(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jc="remoteDocuments",rm="owner",Wu="owner",kf="mutationQueues",dM="userId",no="mutations",JE="batchId",Bc="userMutationsIndex",eT=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eg(n,e){return[n,Qr(e)]}function nk(n,e,t){return[n,Qr(e),t]}const hM={},gd="documentMutations",Ng="remoteDocumentsV14",fM=["prefixPath","collectionGroup","readTime","documentId"],tg="documentKeyIndex",mM=["prefixPath","collectionGroup","documentId"],rk="collectionGroupIndex",pM=["collectionGroup","readTime","prefixPath","documentId"],Cf="remoteDocumentGlobal",$_="remoteDocumentGlobalKey",yd="targets",ik="queryTargetsIndex",gM=["canonicalId","targetId"],vd="targetDocuments",yM=["targetId","path"],Zx="documentTargetsIndex",vM=["path","targetId"],Ig="targetGlobalKey",Hc="targetGlobal",Pf="collectionParents",_M=["collectionId","parent"],_d="clientMetadata",xM="clientId",gy="bundles",bM="bundleId",yy="namedQueries",wM="name",Qx="indexConfiguration",EM="indexId",W_="collectionGroupIndex",TM="collectionGroup",uf="indexState",SM=["indexId","uid"],sk="sequenceNumberIndex",AM=["uid","sequenceNumber"],df="indexEntries",NM=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],ok="documentKeyIndex",IM=["indexId","uid","orderedDocumentKey"],vy="documentOverlays",kM=["userId","collectionPath","documentId"],G_="collectionPathOverlayIndex",CM=["userId","collectionPath","largestBatchId"],ak="collectionGroupOverlayIndex",PM=["userId","collectionGroup","largestBatchId"],Xx="globals",RM="name",lk=[kf,no,gd,jc,yd,rm,Hc,vd,_d,Cf,Pf,gy,yy],jM=[...lk,vy],ck=[kf,no,gd,Ng,yd,rm,Hc,vd,_d,Cf,Pf,gy,yy,vy],uk=ck,Jx=[...uk,Qx,uf,df],OM=Jx,dk=[...Jx,Xx],MM=dk;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_ extends ek{constructor(e,t){super(),this.he=e,this.currentSequenceNumber=t}}function mr(n,e){const t=At(n);return Ll.N(t.he,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tT(n){let e=0;for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e++;return e}function tc(n,e){for(const t in n)Object.prototype.hasOwnProperty.call(n,t)&&e(t,n[t])}function DM(n,e){const t=[];for(const r in n)Object.prototype.hasOwnProperty.call(n,r)&&t.push(e(n[r],r,n));return t}function hk(n){for(const e in n)if(Object.prototype.hasOwnProperty.call(n,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jn{constructor(e,t){this.comparator=e,this.root=t||Rr.EMPTY}insert(e,t){return new jn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Rr.BLACK,null,null))}remove(e){return new jn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Rr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const r=this.comparator(e,t.key);if(r===0)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){const i=this.comparator(e,r.key);if(i===0)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){const e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new bp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new bp(this.root,e,this.comparator,!1)}getReverseIterator(){return new bp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new bp(this.root,e,this.comparator,!0)}}class bp{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?r(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Rr{constructor(e,t,r,i,s){this.key=e,this.value=t,this.color=r??Rr.RED,this.left=i??Rr.EMPTY,this.right=s??Rr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,s){return new Rr(e??this.key,t??this.value,r??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this;const s=r(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,r),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Rr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let r,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Rr.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Rr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Rr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw et(43730,{key:this.key,value:this.value});if(this.right.isRed())throw et(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw et(27949);return e+(this.isRed()?0:1)}}Rr.EMPTY=null,Rr.RED=!0,Rr.BLACK=!1;Rr.EMPTY=new class{constructor(){this.size=0}get key(){throw et(57766)}get value(){throw et(16141)}get color(){throw et(16727)}get left(){throw et(29726)}get right(){throw et(36894)}copy(e,t,r,i,s){return this}insert(e,t,r){return new Rr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e){this.comparator=e,this.data=new jn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new nT(this.data.getIterator())}getIteratorFrom(e){return new nT(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(r=>{t=t.add(r)}),t}isEqual(e){if(!(e instanceof pn)||this.size!==e.size)return!1;const t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new pn(this.comparator);return t.data=e,t}}class nT{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Gu(n){return n.hasNext()?n.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(e){this.fields=e,e.sort(Fn.comparator)}static empty(){return new Li([])}unionWith(e){let t=new pn(Fn.comparator);for(const r of this.fields)t=t.add(r);for(const r of e)t=t.add(r);return new Li(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return pd(this.fields,e.fields,(t,r)=>t.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new fk("Invalid base64 string: "+s):s}}(e);return new rr(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new rr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return xt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}rr.EMPTY_BYTE_STRING=new rr("");const LM=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ea(n){if(it(!!n,39018),typeof n=="string"){let e=0;const t=LM.exec(n);if(it(!!t,46558,{timestamp:n}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const r=new Date(n);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Pn(n.seconds),nanos:Pn(n.nanos)}}function Pn(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function Ta(n){return typeof n=="string"?rr.fromBase64String(n):rr.fromUint8Array(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mk="server_timestamp",pk="__type__",gk="__previous_value__",yk="__local_write_time__";function eb(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[pk])===null||t===void 0?void 0:t.stringValue)===mk}function _y(n){const e=n.mapValue.fields[gk];return eb(e)?_y(e):e}function Rf(n){const e=Ea(n.mapValue.fields[yk].timestampValue);return new Ot(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FM{constructor(e,t,r,i,s,o,l,d,f,m){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=d,this.useFetchStreams=f,this.isUsingEmulator=m}}const kg="(default)";class Jc{constructor(e,t){this.projectId=e,this.database=t||kg}static empty(){return new Jc("","")}get isDefaultDatabase(){return this.database===kg}isEqual(e){return e instanceof Jc&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tb="__type__",vk="__max__",kl={mapValue:{fields:{__type__:{stringValue:vk}}}},nb="__vector__",xd="value",ng={nullValue:"NULL_VALUE"};function Ul(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?eb(n)?4:_k(n)?9007199254740991:xy(n)?10:11:et(28295,{value:n})}function jo(n,e){if(n===e)return!0;const t=Ul(n);if(t!==Ul(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===e.booleanValue;case 4:return Rf(n).isEqual(Rf(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Ea(i.timestampValue),l=Ea(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(n,e);case 5:return n.stringValue===e.stringValue;case 6:return function(i,s){return Ta(i.bytesValue).isEqual(Ta(s.bytesValue))}(n,e);case 7:return n.referenceValue===e.referenceValue;case 8:return function(i,s){return Pn(i.geoPointValue.latitude)===Pn(s.geoPointValue.latitude)&&Pn(i.geoPointValue.longitude)===Pn(s.geoPointValue.longitude)}(n,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Pn(i.integerValue)===Pn(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Pn(i.doubleValue),l=Pn(s.doubleValue);return o===l?If(o)===If(l):isNaN(o)&&isNaN(l)}return!1}(n,e);case 9:return pd(n.arrayValue.values||[],e.arrayValue.values||[],jo);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(tT(o)!==tT(l))return!1;for(const d in o)if(o.hasOwnProperty(d)&&(l[d]===void 0||!jo(o[d],l[d])))return!1;return!0}(n,e);default:return et(52216,{left:n})}}function jf(n,e){return(n.values||[]).find(t=>jo(t,e))!==void 0}function ql(n,e){if(n===e)return 0;const t=Ul(n),r=Ul(e);if(t!==r)return xt(t,r);switch(t){case 0:case 9007199254740991:return 0;case 1:return xt(n.booleanValue,e.booleanValue);case 2:return function(s,o){const l=Pn(s.integerValue||s.doubleValue),d=Pn(o.integerValue||o.doubleValue);return l<d?-1:l>d?1:l===d?0:isNaN(l)?isNaN(d)?0:-1:1}(n,e);case 3:return rT(n.timestampValue,e.timestampValue);case 4:return rT(Rf(n),Rf(e));case 5:return U_(n.stringValue,e.stringValue);case 6:return function(s,o){const l=Ta(s),d=Ta(o);return l.compareTo(d)}(n.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),d=o.split("/");for(let f=0;f<l.length&&f<d.length;f++){const m=xt(l[f],d[f]);if(m!==0)return m}return xt(l.length,d.length)}(n.referenceValue,e.referenceValue);case 8:return function(s,o){const l=xt(Pn(s.latitude),Pn(o.latitude));return l!==0?l:xt(Pn(s.longitude),Pn(o.longitude))}(n.geoPointValue,e.geoPointValue);case 9:return iT(n.arrayValue,e.arrayValue);case 10:return function(s,o){var l,d,f,m;const y=s.fields||{},g=o.fields||{},_=(l=y[xd])===null||l===void 0?void 0:l.arrayValue,E=(d=g[xd])===null||d===void 0?void 0:d.arrayValue,x=xt(((f=_==null?void 0:_.values)===null||f===void 0?void 0:f.length)||0,((m=E==null?void 0:E.values)===null||m===void 0?void 0:m.length)||0);return x!==0?x:iT(_,E)}(n.mapValue,e.mapValue);case 11:return function(s,o){if(s===kl.mapValue&&o===kl.mapValue)return 0;if(s===kl.mapValue)return 1;if(o===kl.mapValue)return-1;const l=s.fields||{},d=Object.keys(l),f=o.fields||{},m=Object.keys(f);d.sort(),m.sort();for(let y=0;y<d.length&&y<m.length;++y){const g=U_(d[y],m[y]);if(g!==0)return g;const _=ql(l[d[y]],f[m[y]]);if(_!==0)return _}return xt(d.length,m.length)}(n.mapValue,e.mapValue);default:throw et(23264,{Pe:t})}}function rT(n,e){if(typeof n=="string"&&typeof e=="string"&&n.length===e.length)return xt(n,e);const t=Ea(n),r=Ea(e),i=xt(t.seconds,r.seconds);return i!==0?i:xt(t.nanos,r.nanos)}function iT(n,e){const t=n.values||[],r=e.values||[];for(let i=0;i<t.length&&i<r.length;++i){const s=ql(t[i],r[i]);if(s)return s}return xt(t.length,r.length)}function bd(n){return Y_(n)}function Y_(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(t){const r=Ea(t);return`time(${r.seconds},${r.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(t){return Ta(t).toBase64()}(n.bytesValue):"referenceValue"in n?function(t){return qe.fromName(t).toString()}(n.referenceValue):"geoPointValue"in n?function(t){return`geo(${t.latitude},${t.longitude})`}(n.geoPointValue):"arrayValue"in n?function(t){let r="[",i=!0;for(const s of t.values||[])i?i=!1:r+=",",r+=Y_(s);return r+"]"}(n.arrayValue):"mapValue"in n?function(t){const r=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of r)s?s=!1:i+=",",i+=`${o}:${Y_(t.fields[o])}`;return i+"}"}(n.mapValue):et(61005,{value:n})}function rg(n){switch(Ul(n)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=_y(n);return e?16+rg(e):16;case 5:return 2*n.stringValue.length;case 6:return Ta(n.bytesValue).approximateByteSize();case 7:return n.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((i,s)=>i+rg(s),0)}(n.arrayValue);case 10:case 11:return function(r){let i=0;return tc(r.fields,(s,o)=>{i+=s.length+rg(o)}),i}(n.mapValue);default:throw et(13486,{value:n})}}function Of(n,e){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${e.path.canonicalString()}`}}function Z_(n){return!!n&&"integerValue"in n}function Mf(n){return!!n&&"arrayValue"in n}function sT(n){return!!n&&"nullValue"in n}function oT(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function ig(n){return!!n&&"mapValue"in n}function xy(n){var e,t;return((t=(((e=n==null?void 0:n.mapValue)===null||e===void 0?void 0:e.fields)||{})[tb])===null||t===void 0?void 0:t.stringValue)===nb}function hf(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){const e={mapValue:{fields:{}}};return tc(n.mapValue.fields,(t,r)=>e.mapValue.fields[t]=hf(r)),e}if(n.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(n.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=hf(n.arrayValue.values[t]);return e}return Object.assign({},n)}function _k(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue===vk}const xk={mapValue:{fields:{[tb]:{stringValue:nb},[xd]:{arrayValue:{}}}}};function VM(n){return"nullValue"in n?ng:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?Of(Jc.empty(),qe.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?xy(n)?xk:{mapValue:{}}:et(35942,{value:n})}function zM(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?Of(Jc.empty(),qe.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?xk:"mapValue"in n?xy(n)?{mapValue:{}}:kl:et(61959,{value:n})}function aT(n,e){const t=ql(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?-1:!n.inclusive&&e.inclusive?1:0}function lT(n,e){const t=ql(n.value,e.value);return t!==0?t:n.inclusive&&!e.inclusive?1:!n.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kr{constructor(e){this.value=e}static empty(){return new Kr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(t=(t.mapValue.fields||{})[e.get(r)],!ig(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=hf(t)}setAll(e){let t=Fn.emptyPath(),r={},i=[];e.forEach((o,l)=>{if(!t.isImmediateParentOf(l)){const d=this.getFieldsMap(t);this.applyChanges(d,r,i),r={},i=[],t=l.popLast()}o?r[l.lastSegment()]=hf(o):i.push(l.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,r,i)}delete(e){const t=this.field(e.popLast());ig(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return jo(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];ig(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){tc(t,(i,s)=>e[i]=s);for(const i of r)delete e[i]}clone(){return new Kr(hf(this.value))}}function bk(n){const e=[];return tc(n.fields,(t,r)=>{const i=new Fn([t]);if(ig(r)){const s=bk(r.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Li(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e,t,r,i,s,o,l){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Un(e,0,ut.min(),ut.min(),ut.min(),Kr.empty(),0)}static newFoundDocument(e,t,r,i){return new Un(e,1,t,ut.min(),r,i,0)}static newNoDocument(e,t){return new Un(e,2,t,ut.min(),ut.min(),Kr.empty(),0)}static newUnknownDocument(e,t){return new Un(e,3,t,ut.min(),ut.min(),Kr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ut.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Kr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Kr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ut.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Un&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Un(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wd{constructor(e,t){this.position=e,this.inclusive=t}}function cT(n,e,t){let r=0;for(let i=0;i<n.position.length;i++){const s=e[i],o=n.position[i];if(s.field.isKeyField()?r=qe.comparator(qe.fromName(o.referenceValue),t.key):r=ql(o,t.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return r}function uT(n,e){if(n===null)return e===null;if(e===null||n.inclusive!==e.inclusive||n.position.length!==e.position.length)return!1;for(let t=0;t<n.position.length;t++)if(!jo(n.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Df{constructor(e,t="asc"){this.field=e,this.dir=t}}function BM(n,e){return n.dir===e.dir&&n.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wk=class{};class qt extends wk{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,r):new UM(e,t,r):t==="array-contains"?new $M(e,r):t==="in"?new Ik(e,r):t==="not-in"?new WM(e,r):t==="array-contains-any"?new GM(e,r):new qt(e,t,r)}static createKeyFieldInFilter(e,t,r){return t==="in"?new qM(e,r):new HM(e,r)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(ql(t,this.value)):t!==null&&Ul(this.value)===Ul(t)&&this.matchesComparison(ql(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return et(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class mn extends wk{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new mn(e,t)}matches(e){return Ed(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function Ed(n){return n.op==="and"}function Q_(n){return n.op==="or"}function rb(n){return Ek(n)&&Ed(n)}function Ek(n){for(const e of n.filters)if(e instanceof mn)return!1;return!0}function X_(n){if(n instanceof qt)return n.field.canonicalString()+n.op.toString()+bd(n.value);if(rb(n))return n.filters.map(e=>X_(e)).join(",");{const e=n.filters.map(t=>X_(t)).join(",");return`${n.op}(${e})`}}function Tk(n,e){return n instanceof qt?function(r,i){return i instanceof qt&&r.op===i.op&&r.field.isEqual(i.field)&&jo(r.value,i.value)}(n,e):n instanceof mn?function(r,i){return i instanceof mn&&r.op===i.op&&r.filters.length===i.filters.length?r.filters.reduce((s,o,l)=>s&&Tk(o,i.filters[l]),!0):!1}(n,e):void et(19439)}function Sk(n,e){const t=n.filters.concat(e);return mn.create(t,n.op)}function Ak(n){return n instanceof qt?function(t){return`${t.field.canonicalString()} ${t.op} ${bd(t.value)}`}(n):n instanceof mn?function(t){return t.op.toString()+" {"+t.getFilters().map(Ak).join(" ,")+"}"}(n):"Filter"}class UM extends qt{constructor(e,t,r){super(e,t,r),this.key=qe.fromName(r.referenceValue)}matches(e){const t=qe.comparator(e.key,this.key);return this.matchesComparison(t)}}class qM extends qt{constructor(e,t){super(e,"in",t),this.keys=Nk("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class HM extends qt{constructor(e,t){super(e,"not-in",t),this.keys=Nk("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Nk(n,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(r=>qe.fromName(r.referenceValue))}class $M extends qt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Mf(t)&&jf(t.arrayValue,this.value)}}class Ik extends qt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&jf(this.value.arrayValue,t)}}class WM extends qt{constructor(e,t){super(e,"not-in",t)}matches(e){if(jf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!jf(this.value.arrayValue,t)}}class GM extends qt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Mf(t)||!t.arrayValue.values)&&t.arrayValue.values.some(r=>jf(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KM{constructor(e,t=null,r=[],i=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.Ie=null}}function J_(n,e=null,t=[],r=[],i=null,s=null,o=null){return new KM(n,e,t,r,i,s,o)}function eu(n){const e=At(n);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(r=>X_(r)).join(","),t+="|ob:",t+=e.orderBy.map(r=>function(s){return s.field.canonicalString()+s.dir}(r)).join(","),py(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(r=>bd(r)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(r=>bd(r)).join(",")),e.Ie=t}return e.Ie}function im(n,e){if(n.limit!==e.limit||n.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<n.orderBy.length;t++)if(!BM(n.orderBy[t],e.orderBy[t]))return!1;if(n.filters.length!==e.filters.length)return!1;for(let t=0;t<n.filters.length;t++)if(!Tk(n.filters[t],e.filters[t]))return!1;return n.collectionGroup===e.collectionGroup&&!!n.path.isEqual(e.path)&&!!uT(n.startAt,e.startAt)&&uT(n.endAt,e.endAt)}function Cg(n){return qe.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function Pg(n,e){return n.filters.filter(t=>t instanceof qt&&t.field.isEqual(e))}function dT(n,e,t){let r=ng,i=!0;for(const s of Pg(n,e)){let o=ng,l=!0;switch(s.op){case"<":case"<=":o=VM(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=ng}aT({value:r,inclusive:i},{value:o,inclusive:l})<0&&(r=o,i=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];aT({value:r,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}function hT(n,e,t){let r=kl,i=!0;for(const s of Pg(n,e)){let o=kl,l=!0;switch(s.op){case">=":case">":o=zM(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=kl}lT({value:r,inclusive:i},{value:o,inclusive:l})>0&&(r=o,i=l)}if(t!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(e)){const o=t.position[s];lT({value:r,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(r=o,i=t.inclusive);break}}return{value:r,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(e,t=null,r=[],i=[],s=null,o="F",l=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=d,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function YM(n,e,t,r,i,s,o,l){return new Od(n,e,t,r,i,s,o,l)}function sm(n){return new Od(n)}function fT(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function kk(n){return n.collectionGroup!==null}function ff(n){const e=At(n);if(e.Ee===null){e.Ee=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ee.push(s),t.add(s.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new pn(Fn.comparator);return o.filters.forEach(d=>{d.getFlattenedFilters().forEach(f=>{f.isInequality()&&(l=l.add(f.field))})}),l})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ee.push(new Df(s,r))}),t.has(Fn.keyField().canonicalString())||e.Ee.push(new Df(Fn.keyField(),r))}return e.Ee}function Ts(n){const e=At(n);return e.de||(e.de=Ck(e,ff(n))),e.de}function ZM(n){const e=At(n);return e.Ae||(e.Ae=Ck(e,n.explicitOrderBy)),e.Ae}function Ck(n,e){if(n.limitType==="F")return J_(n.path,n.collectionGroup,e,n.filters,n.limit,n.startAt,n.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Df(i.field,s)});const t=n.endAt?new wd(n.endAt.position,n.endAt.inclusive):null,r=n.startAt?new wd(n.startAt.position,n.startAt.inclusive):null;return J_(n.path,n.collectionGroup,e,n.filters,n.limit,t,r)}}function ex(n,e){const t=n.filters.concat([e]);return new Od(n.path,n.collectionGroup,n.explicitOrderBy.slice(),t,n.limit,n.limitType,n.startAt,n.endAt)}function Rg(n,e,t){return new Od(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),e,t,n.startAt,n.endAt)}function by(n,e){return im(Ts(n),Ts(e))&&n.limitType===e.limitType}function Pk(n){return`${eu(Ts(n))}|lt:${n.limitType}`}function rd(n){return`Query(target=${function(t){let r=t.path.canonicalString();return t.collectionGroup!==null&&(r+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(r+=`, filters: [${t.filters.map(i=>Ak(i)).join(", ")}]`),py(t.limit)||(r+=", limit: "+t.limit),t.orderBy.length>0&&(r+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(r+=", startAt: ",r+=t.startAt.inclusive?"b:":"a:",r+=t.startAt.position.map(i=>bd(i)).join(",")),t.endAt&&(r+=", endAt: ",r+=t.endAt.inclusive?"a:":"b:",r+=t.endAt.position.map(i=>bd(i)).join(",")),`Target(${r})`}(Ts(n))}; limitType=${n.limitType})`}function om(n,e){return e.isFoundDocument()&&function(r,i){const s=i.key.path;return r.collectionGroup!==null?i.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(s):qe.isDocumentKey(r.path)?r.path.isEqual(s):r.path.isImmediateParentOf(s)}(n,e)&&function(r,i){for(const s of ff(r))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(n,e)&&function(r,i){for(const s of r.filters)if(!s.matches(i))return!1;return!0}(n,e)&&function(r,i){return!(r.startAt&&!function(o,l,d){const f=cT(o,l,d);return o.inclusive?f<=0:f<0}(r.startAt,ff(r),i)||r.endAt&&!function(o,l,d){const f=cT(o,l,d);return o.inclusive?f>=0:f>0}(r.endAt,ff(r),i))}(n,e)}function QM(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Rk(n){return(e,t)=>{let r=!1;for(const i of ff(n)){const s=XM(i,e,t);if(s!==0)return s;r=r||i.field.isKeyField()}return 0}}function XM(n,e,t){const r=n.field.isKeyField()?qe.comparator(e.key,t.key):function(s,o,l){const d=o.data.field(s),f=l.data.field(s);return d!==null&&f!==null?ql(d,f):et(42886)}(n.field,e,t);switch(n.dir){case"asc":return r;case"desc":return-1*r;default:return et(19790,{direction:n.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ca{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r!==void 0){for(const[i,s]of r)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const r=this.mapKeyFn(e),i=this.inner[r];if(i===void 0)return this.inner[r]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),r=this.inner[t];if(r===void 0)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return r.length===1?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){tc(this.inner,(t,r)=>{for(const[i,s]of r)e(i,s)})}isEmpty(){return hk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JM=new jn(qe.comparator);function es(){return JM}const jk=new jn(qe.comparator);function Wh(...n){let e=jk;for(const t of n)e=e.insert(t.key,t);return e}function Ok(n){let e=jk;return n.forEach((t,r)=>e=e.insert(t,r.overlayedDocument)),e}function Io(){return mf()}function Mk(){return mf()}function mf(){return new Ca(n=>n.toString(),(n,e)=>n.isEqual(e))}const e6=new jn(qe.comparator),t6=new pn(qe.comparator);function Ft(...n){let e=t6;for(const t of n)e=e.add(t);return e}const n6=new pn(xt);function r6(){return n6}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ib(n,e){if(n.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:If(e)?"-0":e}}function Dk(n){return{integerValue:""+n}}function i6(n,e){return cM(e)?Dk(e):ib(n,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wy{constructor(){this._=void 0}}function s6(n,e,t){return n instanceof Td?function(i,s){const o={fields:{[pk]:{stringValue:mk},[yk]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&eb(s)&&(s=_y(s)),s&&(o.fields[gk]=s),{mapValue:o}}(t,e):n instanceof tu?Fk(n,e):n instanceof Sd?Vk(n,e):function(i,s){const o=Lk(i,s),l=mT(o)+mT(i.Re);return Z_(o)&&Z_(i.Re)?Dk(l):ib(i.serializer,l)}(n,e)}function o6(n,e,t){return n instanceof tu?Fk(n,e):n instanceof Sd?Vk(n,e):t}function Lk(n,e){return n instanceof Lf?function(r){return Z_(r)||function(s){return!!s&&"doubleValue"in s}(r)}(e)?e:{integerValue:0}:null}class Td extends wy{}class tu extends wy{constructor(e){super(),this.elements=e}}function Fk(n,e){const t=zk(e);for(const r of n.elements)t.some(i=>jo(i,r))||t.push(r);return{arrayValue:{values:t}}}class Sd extends wy{constructor(e){super(),this.elements=e}}function Vk(n,e){let t=zk(e);for(const r of n.elements)t=t.filter(i=>!jo(i,r));return{arrayValue:{values:t}}}class Lf extends wy{constructor(e,t){super(),this.serializer=e,this.Re=t}}function mT(n){return Pn(n.integerValue||n.doubleValue)}function zk(n){return Mf(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sb{constructor(e,t){this.field=e,this.transform=t}}function a6(n,e){return n.field.isEqual(e.field)&&function(r,i){return r instanceof tu&&i instanceof tu||r instanceof Sd&&i instanceof Sd?pd(r.elements,i.elements,jo):r instanceof Lf&&i instanceof Lf?jo(r.Re,i.Re):r instanceof Td&&i instanceof Td}(n.transform,e.transform)}class l6{constructor(e,t){this.version=e,this.transformResults=t}}class dr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new dr}static exists(e){return new dr(void 0,e)}static updateTime(e){return new dr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function sg(n,e){return n.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(n.updateTime):n.exists===void 0||n.exists===e.isFoundDocument()}class Ey{}function Bk(n,e){if(!n.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return n.isNoDocument()?new am(n.key,dr.none()):new Md(n.key,n.data,dr.none());{const t=n.data,r=Kr.empty();let i=new pn(Fn.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?r.delete(s):r.set(s,o),i=i.add(s)}return new Pa(n.key,r,new Li(i.toArray()),dr.none())}}function c6(n,e,t){n instanceof Md?function(i,s,o){const l=i.value.clone(),d=gT(i.fieldTransforms,s,o.transformResults);l.setAll(d),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(n,e,t):n instanceof Pa?function(i,s,o){if(!sg(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=gT(i.fieldTransforms,s,o.transformResults),d=s.data;d.setAll(Uk(i)),d.setAll(l),s.convertToFoundDocument(o.version,d).setHasCommittedMutations()}(n,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function pf(n,e,t,r){return n instanceof Md?function(s,o,l,d){if(!sg(s.precondition,o))return l;const f=s.value.clone(),m=yT(s.fieldTransforms,d,o);return f.setAll(m),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),null}(n,e,t,r):n instanceof Pa?function(s,o,l,d){if(!sg(s.precondition,o))return l;const f=yT(s.fieldTransforms,d,o),m=o.data;return m.setAll(Uk(s)),m.setAll(f),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(y=>y.field))}(n,e,t,r):function(s,o,l){return sg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(n,e,t)}function u6(n,e){let t=null;for(const r of n.fieldTransforms){const i=e.data.field(r.field),s=Lk(r.transform,i||null);s!=null&&(t===null&&(t=Kr.empty()),t.set(r.field,s))}return t||null}function pT(n,e){return n.type===e.type&&!!n.key.isEqual(e.key)&&!!n.precondition.isEqual(e.precondition)&&!!function(r,i){return r===void 0&&i===void 0||!(!r||!i)&&pd(r,i,(s,o)=>a6(s,o))}(n.fieldTransforms,e.fieldTransforms)&&(n.type===0?n.value.isEqual(e.value):n.type!==1||n.data.isEqual(e.data)&&n.fieldMask.isEqual(e.fieldMask))}class Md extends Ey{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Pa extends Ey{constructor(e,t,r,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function Uk(n){const e=new Map;return n.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const r=n.data.field(t);e.set(t,r)}}),e}function gT(n,e,t){const r=new Map;it(n.length===t.length,32656,{Ve:t.length,me:n.length});for(let i=0;i<t.length;i++){const s=n[i],o=s.transform,l=e.data.field(s.field);r.set(s.field,o6(o,l,t[i]))}return r}function yT(n,e,t){const r=new Map;for(const i of n){const s=i.transform,o=t.data.field(i.field);r.set(i.field,s6(s,o,e))}return r}class am extends Ey{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class qk extends Ey{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ob{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){const r=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&c6(s,e,r[i])}}applyToLocalView(e,t){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(t=pf(r,e,t,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(t=pf(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const r=Mk();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(i.key)?null:l;const d=Bk(o,l);d!==null&&r.set(i.key,d),o.isValidDocument()||o.convertToNoDocument(ut.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Ft())}isEqual(e){return this.batchId===e.batchId&&pd(this.mutations,e.mutations,(t,r)=>pT(t,r))&&pd(this.baseMutations,e.baseMutations,(t,r)=>pT(t,r))}}class ab{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){it(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let i=function(){return e6}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,r[o].version);return new ab(e,t,r,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lb{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class d6{constructor(e,t,r){this.alias=e,this.aggregateType=t,this.fieldPath=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h6{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nr,$t;function f6(n){switch(n){case Ie.OK:return et(64938);case Ie.CANCELLED:case Ie.UNKNOWN:case Ie.DEADLINE_EXCEEDED:case Ie.RESOURCE_EXHAUSTED:case Ie.INTERNAL:case Ie.UNAVAILABLE:case Ie.UNAUTHENTICATED:return!1;case Ie.INVALID_ARGUMENT:case Ie.NOT_FOUND:case Ie.ALREADY_EXISTS:case Ie.PERMISSION_DENIED:case Ie.FAILED_PRECONDITION:case Ie.ABORTED:case Ie.OUT_OF_RANGE:case Ie.UNIMPLEMENTED:case Ie.DATA_LOSS:return!0;default:return et(15467,{code:n})}}function Hk(n){if(n===void 0)return ui("GRPC error has no .code"),Ie.UNKNOWN;switch(n){case nr.OK:return Ie.OK;case nr.CANCELLED:return Ie.CANCELLED;case nr.UNKNOWN:return Ie.UNKNOWN;case nr.DEADLINE_EXCEEDED:return Ie.DEADLINE_EXCEEDED;case nr.RESOURCE_EXHAUSTED:return Ie.RESOURCE_EXHAUSTED;case nr.INTERNAL:return Ie.INTERNAL;case nr.UNAVAILABLE:return Ie.UNAVAILABLE;case nr.UNAUTHENTICATED:return Ie.UNAUTHENTICATED;case nr.INVALID_ARGUMENT:return Ie.INVALID_ARGUMENT;case nr.NOT_FOUND:return Ie.NOT_FOUND;case nr.ALREADY_EXISTS:return Ie.ALREADY_EXISTS;case nr.PERMISSION_DENIED:return Ie.PERMISSION_DENIED;case nr.FAILED_PRECONDITION:return Ie.FAILED_PRECONDITION;case nr.ABORTED:return Ie.ABORTED;case nr.OUT_OF_RANGE:return Ie.OUT_OF_RANGE;case nr.UNIMPLEMENTED:return Ie.UNIMPLEMENTED;case nr.DATA_LOSS:return Ie.DATA_LOSS;default:return et(39323,{code:n})}}($t=nr||(nr={}))[$t.OK=0]="OK",$t[$t.CANCELLED=1]="CANCELLED",$t[$t.UNKNOWN=2]="UNKNOWN",$t[$t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",$t[$t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",$t[$t.NOT_FOUND=5]="NOT_FOUND",$t[$t.ALREADY_EXISTS=6]="ALREADY_EXISTS",$t[$t.PERMISSION_DENIED=7]="PERMISSION_DENIED",$t[$t.UNAUTHENTICATED=16]="UNAUTHENTICATED",$t[$t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",$t[$t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",$t[$t.ABORTED=10]="ABORTED",$t[$t.OUT_OF_RANGE=11]="OUT_OF_RANGE",$t[$t.UNIMPLEMENTED=12]="UNIMPLEMENTED",$t[$t.INTERNAL=13]="INTERNAL",$t[$t.UNAVAILABLE=14]="UNAVAILABLE",$t[$t.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m6=new Dl([4294967295,4294967295],0);function vT(n){const e=Y4().encode(n),t=new B4;return t.update(e),new Uint8Array(t.digest())}function _T(n){const e=new DataView(n.buffer),t=e.getUint32(0,!0),r=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Dl([t,r],0),new Dl([i,s],0)]}class cb{constructor(e,t,r){if(this.bitmap=e,this.padding=t,this.hashCount=r,t<0||t>=8)throw new Gh(`Invalid padding: ${t}`);if(r<0)throw new Gh(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Gh(`Invalid hash count: ${r}`);if(e.length===0&&t!==0)throw new Gh(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=Dl.fromNumber(this.pe)}we(e,t,r){let i=e.add(t.multiply(Dl.fromNumber(r)));return i.compare(m6)===1&&(i=new Dl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=vT(e),[r,i]=_T(t);for(let s=0;s<this.hashCount;s++){const o=this.we(r,i,s);if(!this.be(o))return!1}return!0}static create(e,t,r){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new cb(s,i,t);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.pe===0)return;const t=vT(e),[r,i]=_T(t);for(let s=0;s<this.hashCount;s++){const o=this.we(r,i,s);this.Se(o)}}Se(e){const t=Math.floor(e/8),r=e%8;this.bitmap[t]|=1<<r}}class Gh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ty{constructor(e,t,r,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=r,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,r){const i=new Map;return i.set(e,lm.createSynthesizedTargetChangeForCurrentChange(e,t,r)),new Ty(ut.min(),i,new jn(xt),es(),Ft())}}class lm{constructor(e,t,r,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=r,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,r){return new lm(r,t,Ft(),Ft(),Ft())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class og{constructor(e,t,r,i){this.De=e,this.removedTargetIds=t,this.key=r,this.ve=i}}class $k{constructor(e,t){this.targetId=e,this.Ce=t}}class Wk{constructor(e,t,r=rr.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=r,this.cause=i}}class xT{constructor(){this.Fe=0,this.Me=bT(),this.xe=rr.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Ft(),t=Ft(),r=Ft();return this.Me.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:r=r.add(i);break;default:et(38017,{changeType:s})}}),new lm(this.xe,this.Oe,e,t,r)}Qe(){this.Ne=!1,this.Me=bT()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,it(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class p6{constructor(e){this.ze=e,this.je=new Map,this.He=es(),this.Je=wp(),this.Ye=wp(),this.Ze=new jn(xt)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const r=this.rt(t);switch(e.state){case 0:this.it(t)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(t);break;case 3:this.it(t)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),r.ke(e.resumeToken));break;default:et(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((r,i)=>{this.it(i)&&t(i)})}ot(e){const t=e.targetId,r=e.Ce.count,i=this._t(t);if(i){const s=i.target;if(Cg(s))if(r===0){const o=new qe(s.path);this.tt(t,o,Un.newNoDocument(o,ut.min()))}else it(r===1,20013,{expectedCount:r});else{const o=this.ut(t);if(o!==r){const l=this.ct(e),d=l?this.lt(l,e,o):1;if(d!==0){this.st(t);const f=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,f)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:r="",padding:i=0},hashCount:s=0}=t;let o,l;try{o=Ta(r).toUint8Array()}catch(d){if(d instanceof fk)return Xc("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{l=new cb(o,i,s)}catch(d){return Xc(d instanceof Gh?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return l.pe===0?null:l}lt(e,t,r){return t.Ce.count===r-this.Tt(e,t.targetId)?0:2}Tt(e,t){const r=this.ze.getRemoteKeysForTarget(t);let i=0;return r.forEach(s=>{const o=this.ze.Pt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.tt(t,s,null),i++)}),i}It(e){const t=new Map;this.je.forEach((s,o)=>{const l=this._t(o);if(l){if(s.current&&Cg(l.target)){const d=new qe(l.target.path);this.Et(d).has(o)||this.dt(o,d)||this.tt(o,d,Un.newNoDocument(d,e))}s.Le&&(t.set(o,s.qe()),s.Qe())}});let r=Ft();this.Ye.forEach((s,o)=>{let l=!0;o.forEachWhile(d=>{const f=this._t(d);return!f||f.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(s))}),this.He.forEach((s,o)=>o.setReadTime(e));const i=new Ty(e,t,this.Ze,this.He,r);return this.He=es(),this.Je=wp(),this.Ye=wp(),this.Ze=new jn(xt),i}et(e,t){if(!this.it(e))return;const r=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,r),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,r){if(!this.it(e))return;const i=this.rt(e);this.dt(e,t)?i.$e(t,1):i.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),r&&(this.He=this.He.insert(t,r))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new xT,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new pn(xt),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new pn(xt),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||Me("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new xT),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function wp(){return new jn(qe.comparator)}function bT(){return new jn(qe.comparator)}const g6={asc:"ASCENDING",desc:"DESCENDING"},y6={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},v6={and:"AND",or:"OR"};class _6{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function tx(n,e){return n.useProto3Json||py(e)?e:{value:e}}function Ad(n,e){return n.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Gk(n,e){return n.useProto3Json?e.toBase64():e.toUint8Array()}function x6(n,e){return Ad(n,e.toTimestamp())}function hi(n){return it(!!n,49232),ut.fromTimestamp(function(t){const r=Ea(t);return new Ot(r.seconds,r.nanos)}(n))}function ub(n,e){return nx(n,e).canonicalString()}function nx(n,e){const t=function(i){return new on(["projects",i.projectId,"databases",i.database])}(n).child("documents");return e===void 0?t:t.child(e)}function Kk(n){const e=on.fromString(n);return it(nC(e),10190,{key:e.toString()}),e}function jg(n,e){return ub(n.databaseId,e.path)}function $c(n,e){const t=Kk(e);if(t.get(1)!==n.databaseId.projectId)throw new Ue(Ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+n.databaseId.projectId);if(t.get(3)!==n.databaseId.database)throw new Ue(Ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+n.databaseId.database);return new qe(Qk(t))}function Yk(n,e){return ub(n.databaseId,e)}function Zk(n){const e=Kk(n);return e.length===4?on.emptyPath():Qk(e)}function rx(n){return new on(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function Qk(n){return it(n.length>4&&n.get(4)==="documents",29091,{key:n.toString()}),n.popFirst(5)}function wT(n,e,t){return{name:jg(n,e),fields:t.value.mapValue.fields}}function b6(n,e,t){const r=$c(n,e.name),i=hi(e.updateTime),s=e.createTime?hi(e.createTime):ut.min(),o=new Kr({mapValue:{fields:e.fields}}),l=Un.newFoundDocument(r,i,s,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function w6(n,e){let t;if("targetChange"in e){e.targetChange;const r=function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:et(39313,{state:f})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(f,m){return f.useProto3Json?(it(m===void 0||typeof m=="string",58123),rr.fromBase64String(m||"")):(it(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),rr.fromUint8Array(m||new Uint8Array))}(n,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(f){const m=f.code===void 0?Ie.UNKNOWN:Hk(f.code);return new Ue(m,f.message||"")}(o);t=new Wk(r,i,s,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const i=$c(n,r.document.name),s=hi(r.document.updateTime),o=r.document.createTime?hi(r.document.createTime):ut.min(),l=new Kr({mapValue:{fields:r.document.fields}}),d=Un.newFoundDocument(i,s,o,l),f=r.targetIds||[],m=r.removedTargetIds||[];t=new og(f,m,d.key,d)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const i=$c(n,r.document),s=r.readTime?hi(r.readTime):ut.min(),o=Un.newNoDocument(i,s),l=r.removedTargetIds||[];t=new og([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const i=$c(n,r.document),s=r.removedTargetIds||[];t=new og([],s,i,null)}else{if(!("filter"in e))return et(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:i=0,unchangedNames:s}=r,o=new h6(i,s),l=r.targetId;t=new $k(l,o)}}return t}function Og(n,e){let t;if(e instanceof Md)t={update:wT(n,e.key,e.value)};else if(e instanceof am)t={delete:jg(n,e.key)};else if(e instanceof Pa)t={update:wT(n,e.key,e.data),updateMask:k6(e.fieldMask)};else{if(!(e instanceof qk))return et(16599,{ft:e.type});t={verify:jg(n,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(r=>function(s,o){const l=o.transform;if(l instanceof Td)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof tu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Sd)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Lf)return{fieldPath:o.field.canonicalString(),increment:l.Re};throw et(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:x6(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:et(27497)}(n,e.precondition)),t}function ix(n,e){const t=e.currentDocument?function(s){return s.updateTime!==void 0?dr.updateTime(hi(s.updateTime)):s.exists!==void 0?dr.exists(s.exists):dr.none()}(e.currentDocument):dr.none(),r=e.updateTransforms?e.updateTransforms.map(i=>function(o,l){let d=null;if("setToServerValue"in l)it(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),d=new Td;else if("appendMissingElements"in l){const m=l.appendMissingElements.values||[];d=new tu(m)}else if("removeAllFromArray"in l){const m=l.removeAllFromArray.values||[];d=new Sd(m)}else"increment"in l?d=new Lf(o,l.increment):et(16584,{proto:l});const f=Fn.fromServerFormat(l.fieldPath);return new sb(f,d)}(n,i)):[];if(e.update){e.update.name;const i=$c(n,e.update.name),s=new Kr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(d){const f=d.fieldPaths||[];return new Li(f.map(m=>Fn.fromServerFormat(m)))}(e.updateMask);return new Pa(i,s,o,t,r)}return new Md(i,s,t,r)}if(e.delete){const i=$c(n,e.delete);return new am(i,t)}if(e.verify){const i=$c(n,e.verify);return new qk(i,t)}return et(1463,{proto:e})}function E6(n,e){return n&&n.length>0?(it(e!==void 0,14353),n.map(t=>function(i,s){let o=i.updateTime?hi(i.updateTime):hi(s);return o.isEqual(ut.min())&&(o=hi(s)),new l6(o,i.transformResults||[])}(t,e))):[]}function Xk(n,e){return{documents:[Yk(n,e.path)]}}function db(n,e){const t={structuredQuery:{}},r=e.path;let i;e.collectionGroup!==null?(i=r,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=r.popLast(),t.structuredQuery.from=[{collectionId:r.lastSegment()}]),t.parent=Yk(n,i);const s=function(f){if(f.length!==0)return tC(mn.create(f,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(f){if(f.length!==0)return f.map(m=>function(g){return{field:Nl(g.field),direction:A6(g.dir)}}(m))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=tx(n,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(f){return{before:f.inclusive,values:f.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(f){return{before:!f.inclusive,values:f.position}}(e.endAt)),{gt:t,parent:i}}function T6(n,e,t,r){const{gt:i,parent:s}=db(n,e),o={},l=[];let d=0;return t.forEach(f=>{const m="aggregate_"+d++;o[m]=f.alias,f.aggregateType==="count"?l.push({alias:m,count:{}}):f.aggregateType==="avg"?l.push({alias:m,avg:{field:Nl(f.fieldPath)}}):f.aggregateType==="sum"&&l.push({alias:m,sum:{field:Nl(f.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:l,structuredQuery:i.structuredQuery},parent:i.parent},yt:o,parent:s}}function Jk(n){let e=Zk(n.parent);const t=n.structuredQuery,r=t.from?t.from.length:0;let i=null;if(r>0){it(r===1,65062);const m=t.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let s=[];t.where&&(s=function(y){const g=eC(y);return g instanceof mn&&rb(g)?g.getFilters():[g]}(t.where));let o=[];t.orderBy&&(o=function(y){return y.map(g=>function(E){return new Df(id(E.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(g))}(t.orderBy));let l=null;t.limit&&(l=function(y){let g;return g=typeof y=="object"?y.value:y,py(g)?null:g}(t.limit));let d=null;t.startAt&&(d=function(y){const g=!!y.before,_=y.values||[];return new wd(_,g)}(t.startAt));let f=null;return t.endAt&&(f=function(y){const g=!y.before,_=y.values||[];return new wd(_,g)}(t.endAt)),YM(e,i,o,s,l,"F",d,f)}function S6(n,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return et(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function eC(n){return n.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const r=id(t.unaryFilter.field);return qt.create(r,"==",{doubleValue:NaN});case"IS_NULL":const i=id(t.unaryFilter.field);return qt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=id(t.unaryFilter.field);return qt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=id(t.unaryFilter.field);return qt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return et(61313);default:return et(60726)}}(n):n.fieldFilter!==void 0?function(t){return qt.create(id(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return et(58110);default:return et(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(t){return mn.create(t.compositeFilter.filters.map(r=>eC(r)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return et(1026)}}(t.compositeFilter.op))}(n):et(30097,{filter:n})}function A6(n){return g6[n]}function N6(n){return y6[n]}function I6(n){return v6[n]}function Nl(n){return{fieldPath:n.canonicalString()}}function id(n){return Fn.fromServerFormat(n.fieldPath)}function tC(n){return n instanceof qt?function(t){if(t.op==="=="){if(oT(t.value))return{unaryFilter:{field:Nl(t.field),op:"IS_NAN"}};if(sT(t.value))return{unaryFilter:{field:Nl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(oT(t.value))return{unaryFilter:{field:Nl(t.field),op:"IS_NOT_NAN"}};if(sT(t.value))return{unaryFilter:{field:Nl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Nl(t.field),op:N6(t.op),value:t.value}}}(n):n instanceof mn?function(t){const r=t.getFilters().map(i=>tC(i));return r.length===1?r[0]:{compositeFilter:{op:I6(t.op),filters:r}}}(n):et(54877,{filter:n})}function k6(n){const e=[];return n.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function nC(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class va{constructor(e,t,r,i,s=ut.min(),o=ut.min(),l=rr.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=r,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=d}withSequenceNumber(e){return new va(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new va(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new va(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new va(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{constructor(e){this.wt=e}}function C6(n,e){let t;if(e.document)t=b6(n.wt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=qe.fromSegments(e.noDocument.path),i=ru(e.noDocument.readTime);t=Un.newNoDocument(r,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return et(56709);{const r=qe.fromSegments(e.unknownDocument.path),i=ru(e.unknownDocument.version);t=Un.newUnknownDocument(r,i)}}return e.readTime&&t.setReadTime(function(i){const s=new Ot(i[0],i[1]);return ut.fromTimestamp(s)}(e.readTime)),t}function ET(n,e){const t=e.key,r={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Mg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(s,o){return{name:jg(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Ad(s,o.version.toTimestamp()),createTime:Ad(s,o.createTime.toTimestamp())}}(n.wt,e);else if(e.isNoDocument())r.noDocument={path:t.path.toArray(),readTime:nu(e.version)};else{if(!e.isUnknownDocument())return et(57904,{document:e});r.unknownDocument={path:t.path.toArray(),version:nu(e.version)}}return r}function Mg(n){const e=n.toTimestamp();return[e.seconds,e.nanoseconds]}function nu(n){const e=n.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function ru(n){const e=new Ot(n.seconds,n.nanoseconds);return ut.fromTimestamp(e)}function Lc(n,e){const t=(e.baseMutations||[]).map(s=>ix(n.wt,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const r=e.mutations.map(s=>ix(n.wt,s)),i=Ot.fromMillis(e.localWriteTimeMs);return new ob(e.batchId,i,t,r)}function Kh(n){const e=ru(n.readTime),t=n.lastLimboFreeSnapshotVersion!==void 0?ru(n.lastLimboFreeSnapshotVersion):ut.min();let r;return r=function(s){return s.documents!==void 0}(n.query)?function(s){const o=s.documents.length;return it(o===1,1966,{count:o}),Ts(sm(Zk(s.documents[0])))}(n.query):function(s){return Ts(Jk(s))}(n.query),new va(r,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,e,t,rr.fromBase64String(n.resumeToken))}function iC(n,e){const t=nu(e.snapshotVersion),r=nu(e.lastLimboFreeSnapshotVersion);let i;i=Cg(e.target)?Xk(n.wt,e.target):db(n.wt,e.target).gt;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:eu(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function sC(n){const e=Jk({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?Rg(e,e.limit,"L"):e}function Ev(n,e){return new lb(e.largestBatchId,ix(n.wt,e.overlayMutation))}function TT(n,e){const t=e.path.lastSegment();return[n,Qr(e.path.popLast()),t]}function ST(n,e,t,r){return{indexId:n,uid:e,sequenceNumber:t,readTime:nu(r.readTime),documentKey:Qr(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P6{getBundleMetadata(e,t){return AT(e).get(t).next(r=>{if(r)return function(s){return{id:s.bundleId,createTime:ru(s.createTime),version:s.version}}(r)})}saveBundleMetadata(e,t){return AT(e).put(function(i){return{bundleId:i.id,createTime:nu(hi(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return NT(e).get(t).next(r=>{if(r)return function(s){return{name:s.name,query:sC(s.bundledQuery),readTime:ru(s.readTime)}}(r)})}saveNamedQuery(e,t){return NT(e).put(function(i){return{name:i.name,readTime:nu(hi(i.readTime)),bundledQuery:i.bundledQuery}}(t))}}function AT(n){return mr(n,gy)}function NT(n){return mr(n,yy)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sy{constructor(e,t){this.serializer=e,this.userId=t}static bt(e,t){const r=t.uid||"";return new Sy(e,r)}getOverlay(e,t){return xh(e).get(TT(this.userId,t)).next(r=>r?Ev(this.serializer,r):null)}getOverlays(e,t){const r=Io();return _e.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){const i=[];return r.forEach((s,o)=>{const l=new lb(t,o);i.push(this.St(e,l))}),_e.waitFor(i)}removeOverlaysForBatchId(e,t,r){const i=new Set;t.forEach(o=>i.add(Qr(o.getCollectionPath())));const s=[];return i.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);s.push(xh(e).X(G_,l))}),_e.waitFor(s)}getOverlaysForCollection(e,t,r){const i=Io(),s=Qr(t),o=IDBKeyRange.bound([this.userId,s,r],[this.userId,s,Number.POSITIVE_INFINITY],!0);return xh(e).J(G_,o).next(l=>{for(const d of l){const f=Ev(this.serializer,d);i.set(f.getKey(),f)}return i})}getOverlaysForCollectionGroup(e,t,r,i){const s=Io();let o;const l=IDBKeyRange.bound([this.userId,t,r],[this.userId,t,Number.POSITIVE_INFINITY],!0);return xh(e).te({index:ak,range:l},(d,f,m)=>{const y=Ev(this.serializer,f);s.size()<i||y.largestBatchId===o?(s.set(y.getKey(),y),o=y.largestBatchId):m.done()}).next(()=>s)}St(e,t){return xh(e).put(function(i,s,o){const[l,d,f]=TT(s,o.mutation.key);return{userId:s,collectionPath:d,documentId:f,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Og(i.wt,o.mutation)}}(this.serializer,this.userId,t))}}function xh(n){return mr(n,vy)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R6{Dt(e){return mr(e,Xx)}getSessionToken(e){return this.Dt(e).get("sessionToken").next(t=>{const r=t==null?void 0:t.value;return r?rr.fromUint8Array(r):rr.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Dt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fc{constructor(){}vt(e,t){this.Ct(e,t),t.Ft()}Ct(e,t){if("nullValue"in e)this.Mt(t,5);else if("booleanValue"in e)this.Mt(t,10),t.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(t,15),t.xt(Pn(e.integerValue));else if("doubleValue"in e){const r=Pn(e.doubleValue);isNaN(r)?this.Mt(t,13):(this.Mt(t,15),If(r)?t.xt(0):t.xt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Mt(t,20),typeof r=="string"&&(r=Ea(r)),t.Ot(`${r.seconds||""}`),t.xt(r.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,t),this.Bt(t);else if("bytesValue"in e)this.Mt(t,30),t.Lt(Ta(e.bytesValue)),this.Bt(t);else if("referenceValue"in e)this.kt(e.referenceValue,t);else if("geoPointValue"in e){const r=e.geoPointValue;this.Mt(t,45),t.xt(r.latitude||0),t.xt(r.longitude||0)}else"mapValue"in e?_k(e)?this.Mt(t,Number.MAX_SAFE_INTEGER):xy(e)?this.qt(e.mapValue,t):(this.Qt(e.mapValue,t),this.Bt(t)):"arrayValue"in e?(this.$t(e.arrayValue,t),this.Bt(t)):et(19022,{Ut:e})}Nt(e,t){this.Mt(t,25),this.Kt(e,t)}Kt(e,t){t.Ot(e)}Qt(e,t){const r=e.fields||{};this.Mt(t,55);for(const i of Object.keys(r))this.Nt(i,t),this.Ct(r[i],t)}qt(e,t){var r,i;const s=e.fields||{};this.Mt(t,53);const o=xd,l=((i=(r=s[o].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.length)||0;this.Mt(t,15),t.xt(Pn(l)),this.Nt(o,t),this.Ct(s[o],t)}$t(e,t){const r=e.values||[];this.Mt(t,50);for(const i of r)this.Ct(i,t)}kt(e,t){this.Mt(t,37),qe.fromName(e).path.forEach(r=>{this.Mt(t,60),this.Kt(r,t)})}Mt(e,t){e.xt(t)}Bt(e){e.xt(2)}}Fc.Wt=new Fc;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ku=255;function j6(n){if(n===0)return 8;let e=0;return n>>4||(e+=4,n<<=4),n>>6||(e+=2,n<<=2),n>>7||(e+=1),e}function IT(n){const e=64-function(r){let i=0;for(let s=0;s<8;++s){const o=j6(255&r[s]);if(i+=o,o!==8)break}return i}(n);return Math.ceil(e/8)}class O6{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Gt(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.zt(r.value),r=t.next();this.jt()}Ht(e){const t=e[Symbol.iterator]();let r=t.next();for(;!r.done;)this.Jt(r.value),r=t.next();this.Yt()}Zt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.zt(r);else if(r<2048)this.zt(960|r>>>6),this.zt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.zt(480|r>>>12),this.zt(128|63&r>>>6),this.zt(128|63&r);else{const i=t.codePointAt(0);this.zt(240|i>>>18),this.zt(128|63&i>>>12),this.zt(128|63&i>>>6),this.zt(128|63&i)}}this.jt()}Xt(e){for(const t of e){const r=t.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Yt()}en(e){const t=this.tn(e),r=IT(t);this.nn(1+r),this.buffer[this.position++]=255&r;for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=255&t[i]}rn(e){const t=this.tn(e),r=IT(t);this.nn(1+r),this.buffer[this.position++]=~(255&r);for(let i=t.length-r;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}sn(){this._n(Ku),this._n(255)}an(){this.un(Ku),this.un(255)}reset(){this.position=0}seed(e){this.nn(e.length),this.buffer.set(e,this.position),this.position+=e.length}cn(){return this.buffer.slice(0,this.position)}tn(e){const t=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),r=!!(128&t[0]);t[0]^=r?255:128;for(let i=1;i<t.length;++i)t[i]^=r?255:0;return t}zt(e){const t=255&e;t===0?(this._n(0),this._n(255)):t===Ku?(this._n(Ku),this._n(0)):this._n(t)}Jt(e){const t=255&e;t===0?(this.un(0),this.un(255)):t===Ku?(this.un(Ku),this.un(0)):this.un(e)}jt(){this._n(0),this._n(1)}Yt(){this.un(0),this.un(1)}_n(e){this.nn(1),this.buffer[this.position++]=e}un(e){this.nn(1),this.buffer[this.position++]=~e}nn(e){const t=e+this.position;if(t<=this.buffer.length)return;let r=2*this.buffer.length;r<t&&(r=t);const i=new Uint8Array(r);i.set(this.buffer),this.buffer=i}}class M6{constructor(e){this.ln=e}Lt(e){this.ln.Gt(e)}Ot(e){this.ln.Zt(e)}xt(e){this.ln.en(e)}Ft(){this.ln.sn()}}class D6{constructor(e){this.ln=e}Lt(e){this.ln.Ht(e)}Ot(e){this.ln.Xt(e)}xt(e){this.ln.rn(e)}Ft(){this.ln.an()}}class bh{constructor(){this.ln=new O6,this.hn=new M6(this.ln),this.Pn=new D6(this.ln)}seed(e){this.ln.seed(e)}Tn(e){return e===0?this.hn:this.Pn}cn(){return this.ln.cn()}reset(){this.ln.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vc{constructor(e,t,r,i){this.In=e,this.En=t,this.dn=r,this.An=i}Rn(){const e=this.An.length,t=e===0||this.An[e-1]===255?e+1:e,r=new Uint8Array(t);return r.set(this.An,0),t!==e?r.set([0],this.An.length):++r[r.length-1],new Vc(this.In,this.En,this.dn,r)}Vn(e,t,r){return{indexId:this.In,uid:e,arrayValue:ag(this.dn),directionalValue:ag(this.An),orderedDocumentKey:ag(t),documentKey:r.path.toArray()}}mn(e,t,r){const i=this.Vn(e,t,r);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function xl(n,e){let t=n.In-e.In;return t!==0?t:(t=kT(n.dn,e.dn),t!==0?t:(t=kT(n.An,e.An),t!==0?t:qe.comparator(n.En,e.En)))}function kT(n,e){for(let t=0;t<n.length&&t<e.length;++t){const r=n[t]-e[t];if(r!==0)return r}return n.length-e.length}function ag(n){return QI()?function(t){let r="";for(let i=0;i<t.length;i++)r+=String.fromCharCode(t[i]);return r}(n):n}function CT(n){return typeof n!="string"?n:function(t){const r=new Uint8Array(t.length);for(let i=0;i<t.length;i++)r[i]=t.charCodeAt(i);return r}(n)}class PT{constructor(e){this.fn=new pn((t,r)=>Fn.comparator(t.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.gn=e.orderBy,this.pn=[];for(const t of e.filters){const r=t;r.isInequality()?this.fn=this.fn.add(r):this.pn.push(r)}}get yn(){return this.fn.size>1}wn(e){if(it(e.collectionGroup===this.collectionId,49279),this.yn)return!1;const t=H_(e);if(t!==void 0&&!this.bn(t))return!1;const r=Rc(e);let i=new Set,s=0,o=0;for(;s<r.length&&this.bn(r[s]);++s)i=i.add(r[s].fieldPath.canonicalString());if(s===r.length)return!0;if(this.fn.size>0){const l=this.fn.getIterator().getNext();if(!i.has(l.field.canonicalString())){const d=r[s];if(!this.Sn(l,d)||!this.Dn(this.gn[o++],d))return!1}++s}for(;s<r.length;++s){const l=r[s];if(o>=this.gn.length||!this.Dn(this.gn[o++],l))return!1}return!0}vn(){if(this.yn)return null;let e=new pn(Fn.comparator);const t=[];for(const r of this.pn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")t.push(new Jp(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),t.push(new Jp(r.field,0))}for(const r of this.gn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),t.push(new Jp(r.field,r.dir==="asc"?0:1)));return new Sg(Sg.UNKNOWN_ID,this.collectionId,t,Nf.empty())}bn(e){for(const t of this.pn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===r}Dn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oC(n){var e,t;if(it(n instanceof qt||n instanceof mn,20012),n instanceof qt){if(n instanceof Ik){const i=((t=(e=n.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>qt.create(n.field,"==",s)))||[];return mn.create(i,"or")}return n}const r=n.filters.map(i=>oC(i));return mn.create(r,n.op)}function L6(n){if(n.getFilters().length===0)return[];const e=ax(oC(n));return it(aC(e),7391),sx(e)||ox(e)?[e]:e.getFilters()}function sx(n){return n instanceof qt}function ox(n){return n instanceof mn&&rb(n)}function aC(n){return sx(n)||ox(n)||function(t){if(t instanceof mn&&Q_(t)){for(const r of t.getFilters())if(!sx(r)&&!ox(r))return!1;return!0}return!1}(n)}function ax(n){if(it(n instanceof qt||n instanceof mn,34018),n instanceof qt)return n;if(n.filters.length===1)return ax(n.filters[0]);const e=n.filters.map(r=>ax(r));let t=mn.create(e,n.op);return t=Dg(t),aC(t)?t:(it(t instanceof mn,64498),it(Ed(t),40251),it(t.filters.length>1,57927),t.filters.reduce((r,i)=>hb(r,i)))}function hb(n,e){let t;return it(n instanceof qt||n instanceof mn,38388),it(e instanceof qt||e instanceof mn,25473),t=n instanceof qt?e instanceof qt?function(i,s){return mn.create([i,s],"and")}(n,e):RT(n,e):e instanceof qt?RT(e,n):function(i,s){if(it(i.filters.length>0&&s.filters.length>0,48005),Ed(i)&&Ed(s))return Sk(i,s.getFilters());const o=Q_(i)?i:s,l=Q_(i)?s:i,d=o.filters.map(f=>hb(f,l));return mn.create(d,"or")}(n,e),Dg(t)}function RT(n,e){if(Ed(e))return Sk(e,n.getFilters());{const t=e.filters.map(r=>hb(n,r));return mn.create(t,"or")}}function Dg(n){if(it(n instanceof qt||n instanceof mn,11850),n instanceof qt)return n;const e=n.getFilters();if(e.length===1)return Dg(e[0]);if(Ek(n))return n;const t=e.map(i=>Dg(i)),r=[];return t.forEach(i=>{i instanceof qt?r.push(i):i instanceof mn&&(i.op===n.op?r.push(...i.filters):r.push(i))}),r.length===1?r[0]:mn.create(r,n.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F6{constructor(){this.Cn=new fb}addToCollectionParentIndex(e,t){return this.Cn.add(t),_e.resolve()}getCollectionParents(e,t){return _e.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return _e.resolve()}deleteFieldIndex(e,t){return _e.resolve()}deleteAllFieldIndexes(e){return _e.resolve()}createTargetIndexes(e,t){return _e.resolve()}getDocumentsMatchingTarget(e,t){return _e.resolve(null)}getIndexType(e,t){return _e.resolve(0)}getFieldIndexes(e,t){return _e.resolve([])}getNextCollectionGroupToUpdate(e){return _e.resolve(null)}getMinOffset(e,t){return _e.resolve(ns.min())}getMinOffsetFromCollectionGroup(e,t){return _e.resolve(ns.min())}updateCollectionGroup(e,t,r){return _e.resolve()}updateIndexEntries(e,t){return _e.resolve()}}class fb{constructor(){this.index={}}add(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new pn(on.comparator),s=!i.has(r);return this.index[t]=i.add(r),s}has(e){const t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new pn(on.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jT="IndexedDbIndexManager",Ep=new Uint8Array(0);class V6{constructor(e,t){this.databaseId=t,this.Fn=new fb,this.Mn=new Ca(r=>eu(r),(r,i)=>im(r,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Fn.has(t)){const r=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.Fn.add(t)});const s={collectionId:r,parent:Qr(i)};return OT(e).put(s)}return _e.resolve()}getCollectionParents(e,t){const r=[],i=IDBKeyRange.bound([t,""],[Q4(t),""],!1,!0);return OT(e).J(i).next(s=>{for(const o of s){if(o.collectionId!==t)break;r.push(No(o.parent))}return r})}addFieldIndex(e,t){const r=wh(e),i=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(d=>[d.fieldPath.canonicalString(),d.kind])}}(t);delete i.indexId;const s=r.add(i);if(t.indexState){const o=Zu(e);return s.next(l=>{o.put(ST(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const r=wh(e),i=Zu(e),s=Yu(e);return r.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=wh(e),r=Yu(e),i=Zu(e);return t.X().next(()=>r.X()).next(()=>i.X())}createTargetIndexes(e,t){return _e.forEach(this.xn(t),r=>this.getIndexType(e,r).next(i=>{if(i===0||i===1){const s=new PT(r).vn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const r=Yu(e);let i=!0;const s=new Map;return _e.forEach(this.xn(t),o=>this.On(e,o).next(l=>{i&&(i=!!l),s.set(o,l)})).next(()=>{if(i){let o=Ft();const l=[];return _e.forEach(s,(d,f)=>{Me(jT,`Using index ${function(P){return`id=${P.indexId}|cg=${P.collectionGroup}|f=${P.fields.map(I=>`${I.fieldPath}:${I.kind}`).join(",")}`}(d)} to execute ${eu(t)}`);const m=function(P,I){const R=H_(I);if(R===void 0)return null;for(const U of Pg(P,R.fieldPath))switch(U.op){case"array-contains-any":return U.value.arrayValue.values||[];case"array-contains":return[U.value]}return null}(f,d),y=function(P,I){const R=new Map;for(const U of Rc(I))for(const j of Pg(P,U.fieldPath))switch(j.op){case"==":case"in":R.set(U.fieldPath.canonicalString(),j.value);break;case"not-in":case"!=":return R.set(U.fieldPath.canonicalString(),j.value),Array.from(R.values())}return null}(f,d),g=function(P,I){const R=[];let U=!0;for(const j of Rc(I)){const k=j.kind===0?dT(P,j.fieldPath,P.startAt):hT(P,j.fieldPath,P.startAt);R.push(k.value),U&&(U=k.inclusive)}return new wd(R,U)}(f,d),_=function(P,I){const R=[];let U=!0;for(const j of Rc(I)){const k=j.kind===0?hT(P,j.fieldPath,P.endAt):dT(P,j.fieldPath,P.endAt);R.push(k.value),U&&(U=k.inclusive)}return new wd(R,U)}(f,d),E=this.Nn(d,f,g),x=this.Nn(d,f,_),w=this.Bn(d,f,y),S=this.Ln(d.indexId,m,E,g.inclusive,x,_.inclusive,w);return _e.forEach(S,N=>r.Z(N,t.limit).next(P=>{P.forEach(I=>{const R=qe.fromSegments(I.documentKey);o.has(R)||(o=o.add(R),l.push(R))})}))}).next(()=>l)}return _e.resolve(null)})}xn(e){let t=this.Mn.get(e);return t||(e.filters.length===0?t=[e]:t=L6(mn.create(e.filters,"and")).map(r=>J_(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Mn.set(e,t),t)}Ln(e,t,r,i,s,o,l){const d=(t!=null?t.length:1)*Math.max(r.length,s.length),f=d/(t!=null?t.length:1),m=[];for(let y=0;y<d;++y){const g=t?this.kn(t[y/f]):Ep,_=this.qn(e,g,r[y%f],i),E=this.Qn(e,g,s[y%f],o),x=l.map(w=>this.qn(e,g,w,!0));m.push(...this.createRange(_,E,x))}return m}qn(e,t,r,i){const s=new Vc(e,qe.empty(),t,r);return i?s:s.Rn()}Qn(e,t,r,i){const s=new Vc(e,qe.empty(),t,r);return i?s.Rn():s}On(e,t){const r=new PT(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const l of s)r.wn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,t){let r=2;const i=this.xn(t);return _e.forEach(i,s=>this.On(e,s).next(o=>{o?r!==0&&o.fields.length<function(d){let f=new pn(Fn.comparator),m=!1;for(const y of d.filters)for(const g of y.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?m=!0:f=f.add(g.field));for(const y of d.orderBy)y.field.isKeyField()||(f=f.add(y.field));return f.size+(m?1:0)}(s)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&r===2?1:r)}$n(e,t){const r=new bh;for(const i of Rc(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const o=r.Tn(i.kind);Fc.Wt.vt(s,o)}return r.cn()}kn(e){const t=new bh;return Fc.Wt.vt(e,t.Tn(0)),t.cn()}Un(e,t){const r=new bh;return Fc.Wt.vt(Of(this.databaseId,t),r.Tn(function(s){const o=Rc(s);return o.length===0?0:o[o.length-1].kind}(e))),r.cn()}Bn(e,t,r){if(r===null)return[];let i=[];i.push(new bh);let s=0;for(const o of Rc(e)){const l=r[s++];for(const d of i)if(this.Kn(t,o.fieldPath)&&Mf(l))i=this.Wn(i,o,l);else{const f=d.Tn(o.kind);Fc.Wt.vt(l,f)}}return this.Gn(i)}Nn(e,t,r){return this.Bn(e,t,r.position)}Gn(e){const t=[];for(let r=0;r<e.length;++r)t[r]=e[r].cn();return t}Wn(e,t,r){const i=[...e],s=[];for(const o of r.arrayValue.values||[])for(const l of i){const d=new bh;d.seed(l.cn()),Fc.Wt.vt(o,d.Tn(t.kind)),s.push(d)}return s}Kn(e,t){return!!e.filters.find(r=>r instanceof qt&&r.field.isEqual(t)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,t){const r=wh(e),i=Zu(e);return(t?r.J(W_,IDBKeyRange.bound(t,t)):r.J()).next(s=>{const o=[];return _e.forEach(s,l=>i.get([l.indexId,this.uid]).next(d=>{o.push(function(m,y){const g=y?new Nf(y.sequenceNumber,new ns(ru(y.readTime),new qe(No(y.documentKey)),y.largestBatchId)):Nf.empty(),_=m.fields.map(([E,x])=>new Jp(Fn.fromServerFormat(E),x));return new Sg(m.indexId,m.collectionGroup,_,g)}(l,d))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((r,i)=>{const s=r.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:xt(r.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,r){const i=wh(e),s=Zu(e);return this.zn(e).next(o=>i.J(W_,IDBKeyRange.bound(t,t)).next(l=>_e.forEach(l,d=>s.put(ST(d.indexId,this.uid,o,r)))))}updateIndexEntries(e,t){const r=new Map;return _e.forEach(t,(i,s)=>{const o=r.get(i.collectionGroup);return(o?_e.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(l=>(r.set(i.collectionGroup,l),_e.forEach(l,d=>this.jn(e,i,d).next(f=>{const m=this.Hn(s,d);return f.isEqual(m)?_e.resolve():this.Jn(e,s,d,f,m)}))))})}Yn(e,t,r,i){return Yu(e).put(i.Vn(this.uid,this.Un(r,t.key),t.key))}Zn(e,t,r,i){return Yu(e).delete(i.mn(this.uid,this.Un(r,t.key),t.key))}jn(e,t,r){const i=Yu(e);let s=new pn(xl);return i.te({index:ok,range:IDBKeyRange.only([r.indexId,this.uid,ag(this.Un(r,t))])},(o,l)=>{s=s.add(new Vc(r.indexId,t,CT(l.arrayValue),CT(l.directionalValue)))}).next(()=>s)}Hn(e,t){let r=new pn(xl);const i=this.$n(t,e);if(i==null)return r;const s=H_(t);if(s!=null){const o=e.data.field(s.fieldPath);if(Mf(o))for(const l of o.arrayValue.values||[])r=r.add(new Vc(t.indexId,e.key,this.kn(l),i))}else r=r.add(new Vc(t.indexId,e.key,Ep,i));return r}Jn(e,t,r,i,s){Me(jT,"Updating index entries for document '%s'",t.key);const o=[];return function(d,f,m,y,g){const _=d.getIterator(),E=f.getIterator();let x=Gu(_),w=Gu(E);for(;x||w;){let S=!1,N=!1;if(x&&w){const P=m(x,w);P<0?N=!0:P>0&&(S=!0)}else x!=null?N=!0:S=!0;S?(y(w),w=Gu(E)):N?(g(x),x=Gu(_)):(x=Gu(_),w=Gu(E))}}(i,s,xl,l=>{o.push(this.Yn(e,t,r,l))},l=>{o.push(this.Zn(e,t,r,l))}),_e.waitFor(o)}zn(e){let t=1;return Zu(e).te({index:sk,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,r){r=r.sort((o,l)=>xl(o,l)).filter((o,l,d)=>!l||xl(o,d[l-1])!==0);const i=[];i.push(e);for(const o of r){const l=xl(o,e),d=xl(o,t);if(l===0)i[0]=e.Rn();else if(l>0&&d<0)i.push(o),i.push(o.Rn());else if(d>0)break}i.push(t);const s=[];for(let o=0;o<i.length;o+=2){if(this.Xn(i[o],i[o+1]))return[];const l=i[o].mn(this.uid,Ep,qe.empty()),d=i[o+1].mn(this.uid,Ep,qe.empty());s.push(IDBKeyRange.bound(l,d))}return s}Xn(e,t){return xl(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(MT)}getMinOffset(e,t){return _e.mapArray(this.xn(t),r=>this.On(e,r).next(i=>i||et(44426))).next(MT)}}function OT(n){return mr(n,Pf)}function Yu(n){return mr(n,df)}function wh(n){return mr(n,Qx)}function Zu(n){return mr(n,uf)}function MT(n){it(n.length!==0,28825);let e=n[0].indexState.offset,t=e.largestBatchId;for(let r=1;r<n.length;r++){const i=n[r].indexState.offset;Kx(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new ns(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},lC=41943040;class Gr{static withCacheSize(e){return new Gr(e,Gr.DEFAULT_COLLECTION_PERCENTILE,Gr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cC(n,e,t){const r=n.store(no),i=n.store(gd),s=[],o=IDBKeyRange.only(t.batchId);let l=0;const d=r.te({range:o},(m,y,g)=>(l++,g.delete()));s.push(d.next(()=>{it(l===1,47070,{batchId:t.batchId})}));const f=[];for(const m of t.mutations){const y=nk(e,m.key.path,t.batchId);s.push(i.delete(y)),f.push(m.key)}return _e.waitFor(s).next(()=>f)}function Lg(n){if(!n)return 0;let e;if(n.document)e=n.document;else if(n.unknownDocument)e=n.unknownDocument;else{if(!n.noDocument)throw et(14731);e=n.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Gr.DEFAULT_COLLECTION_PERCENTILE=10,Gr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Gr.DEFAULT=new Gr(lC,Gr.DEFAULT_COLLECTION_PERCENTILE,Gr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Gr.DISABLED=new Gr(-1,0,0);class Ay{constructor(e,t,r,i){this.userId=e,this.serializer=t,this.indexManager=r,this.referenceDelegate=i,this.er={}}static bt(e,t,r,i){it(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new Ay(s,t,r,i)}checkEmpty(e){let t=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return bl(e).te({index:Bc,range:r},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,r,i){const s=sd(e),o=bl(e);return o.add({}).next(l=>{it(typeof l=="number",49019);const d=new ob(l,t,r,i),f=function(_,E,x){const w=x.baseMutations.map(N=>Og(_.wt,N)),S=x.mutations.map(N=>Og(_.wt,N));return{userId:E,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:w,mutations:S}}(this.serializer,this.userId,d),m=[];let y=new pn((g,_)=>xt(g.canonicalString(),_.canonicalString()));for(const g of i){const _=nk(this.userId,g.key.path,l);y=y.add(g.key.path.popLast()),m.push(o.put(f)),m.push(s.put(_,hM))}return y.forEach(g=>{m.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.er[l]=d.keys()}),_e.waitFor(m).next(()=>d)})}lookupMutationBatch(e,t){return bl(e).get(t).next(r=>r?(it(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:t}),Lc(this.serializer,r)):null)}tr(e,t){return this.er[t]?_e.resolve(this.er[t]):this.lookupMutationBatch(e,t).next(r=>{if(r){const i=r.keys();return this.er[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=IDBKeyRange.lowerBound([this.userId,r]);let s=null;return bl(e).te({index:Bc,range:i},(o,l,d)=>{l.userId===this.userId&&(it(l.batchId>=r,47524,{nr:r}),s=Lc(this.serializer,l)),d.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=qc;return bl(e).te({index:Bc,range:t,reverse:!0},(i,s,o)=>{r=s.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,qc],[this.userId,Number.POSITIVE_INFINITY]);return bl(e).J(Bc,t).next(r=>r.map(i=>Lc(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const r=eg(this.userId,t.path),i=IDBKeyRange.lowerBound(r),s=[];return sd(e).te({range:i},(o,l,d)=>{const[f,m,y]=o,g=No(m);if(f===this.userId&&t.path.isEqual(g))return bl(e).get(y).next(_=>{if(!_)throw et(61480,{rr:o,batchId:y});it(_.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:_.userId,batchId:y}),s.push(Lc(this.serializer,_))});d.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new pn(xt);const i=[];return t.forEach(s=>{const o=eg(this.userId,s.path),l=IDBKeyRange.lowerBound(o),d=sd(e).te({range:l},(f,m,y)=>{const[g,_,E]=f,x=No(_);g===this.userId&&s.path.isEqual(x)?r=r.add(E):y.done()});i.push(d)}),_e.waitFor(i).next(()=>this.ir(e,r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1,s=eg(this.userId,r),o=IDBKeyRange.lowerBound(s);let l=new pn(xt);return sd(e).te({range:o},(d,f,m)=>{const[y,g,_]=d,E=No(g);y===this.userId&&r.isPrefixOf(E)?E.length===i&&(l=l.add(_)):m.done()}).next(()=>this.ir(e,l))}ir(e,t){const r=[],i=[];return t.forEach(s=>{i.push(bl(e).get(s).next(o=>{if(o===null)throw et(35274,{batchId:s});it(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),r.push(Lc(this.serializer,o))}))}),_e.waitFor(i).next(()=>r)}removeMutationBatch(e,t){return cC(e.he,this.userId,t).next(r=>(e.addOnCommittedListener(()=>{this.sr(t.batchId)}),_e.forEach(r,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}sr(e){delete this.er[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return _e.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return sd(e).te({range:r},(s,o,l)=>{if(s[0]===this.userId){const d=No(s[1]);i.push(d)}else l.done()}).next(()=>{it(i.length===0,56720,{_r:i.map(s=>s.canonicalString())})})})}containsKey(e,t){return uC(e,this.userId,t)}ar(e){return dC(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:qc,lastStreamToken:""})}}function uC(n,e,t){const r=eg(e,t.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return sd(n).te({range:s,ee:!0},(l,d,f)=>{const[m,y,g]=l;m===e&&y===i&&(o=!0),f.done()}).next(()=>o)}function bl(n){return mr(n,no)}function sd(n){return mr(n,gd)}function dC(n){return mr(n,kf)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new iu(0)}static lr(){return new iu(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z6{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.hr(e).next(t=>{const r=new iu(t.highestTargetId);return t.highestTargetId=r.next(),this.Pr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.hr(e).next(t=>ut.fromTimestamp(new Ot(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.hr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,r){return this.hr(e).next(i=>(i.highestListenSequenceNumber=t,r&&(i.lastRemoteSnapshotVersion=r.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Pr(e,i)))}addTargetData(e,t){return this.Tr(e,t).next(()=>this.hr(e).next(r=>(r.targetCount+=1,this.Ir(t,r),this.Pr(e,r))))}updateTargetData(e,t){return this.Tr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>Qu(e).delete(t.targetId)).next(()=>this.hr(e)).next(r=>(it(r.targetCount>0,8065),r.targetCount-=1,this.Pr(e,r)))}removeTargets(e,t,r){let i=0;const s=[];return Qu(e).te((o,l)=>{const d=Kh(l);d.sequenceNumber<=t&&r.get(d.targetId)===null&&(i++,s.push(this.removeTargetData(e,d)))}).next(()=>_e.waitFor(s)).next(()=>i)}forEachTarget(e,t){return Qu(e).te((r,i)=>{const s=Kh(i);t(s)})}hr(e){return LT(e).get(Ig).next(t=>(it(t!==null,2888),t))}Pr(e,t){return LT(e).put(Ig,t)}Tr(e,t){return Qu(e).put(iC(this.serializer,t))}Ir(e,t){let r=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,r=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.hr(e).next(t=>t.targetCount)}getTargetData(e,t){const r=eu(t),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let s=null;return Qu(e).te({range:i,index:ik},(o,l,d)=>{const f=Kh(l);im(t,f.target)&&(s=f,d.done())}).next(()=>s)}addMatchingKeys(e,t,r){const i=[],s=Il(e);return t.forEach(o=>{const l=Qr(o.path);i.push(s.put({targetId:r,path:l})),i.push(this.referenceDelegate.addReference(e,r,o))}),_e.waitFor(i)}removeMatchingKeys(e,t,r){const i=Il(e);return _e.forEach(t,s=>{const o=Qr(s.path);return _e.waitFor([i.delete([r,o]),this.referenceDelegate.removeReference(e,r,s)])})}removeMatchingKeysForTargetId(e,t){const r=Il(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return r.delete(i)}getMatchingKeysForTargetId(e,t){const r=IDBKeyRange.bound([t],[t+1],!1,!0),i=Il(e);let s=Ft();return i.te({range:r,ee:!0},(o,l,d)=>{const f=No(o[1]),m=new qe(f);s=s.add(m)}).next(()=>s)}containsKey(e,t){const r=Qr(t.path),i=IDBKeyRange.bound([r],[Q4(r)],!1,!0);let s=0;return Il(e).te({index:Zx,ee:!0,range:i},([o,l],d,f)=>{o!==0&&(s++,f.done())}).next(()=>s>0)}Rt(e,t){return Qu(e).get(t).next(r=>r?Kh(r):null)}}function Qu(n){return mr(n,yd)}function LT(n){return mr(n,Hc)}function Il(n){return mr(n,vd)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FT="LruGarbageCollector",B6=1048576;function VT([n,e],[t,r]){const i=xt(n,t);return i===0?xt(e,r):i}class U6{constructor(e){this.Er=e,this.buffer=new pn(VT),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const r=this.buffer.last();VT(t,r)<0&&(this.buffer=this.buffer.delete(r).add(t))}}get maxValue(){return this.buffer.last()[0]}}class hC{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){Me(FT,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){ec(t)?Me(FT,"Ignoring IndexedDB error during garbage collection: ",t):await hu(t)}await this.mr(3e5)})}}class q6{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(r=>Math.floor(t/100*r))}nthSequenceNumber(e,t){if(t===0)return _e.resolve(ws.le);const r=new U6(t);return this.gr.forEachTarget(e,i=>r.Rr(i.sequenceNumber)).next(()=>this.gr.yr(e,i=>r.Rr(i))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.gr.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Me("LruGarbageCollector","Garbage collection skipped; disabled"),_e.resolve(DT)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Me("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),DT):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let r,i,s,o,l,d,f;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(Me("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),i=this.params.maximumSequenceNumbersToCollect):i=y,o=Date.now(),this.nthSequenceNumber(e,i))).next(y=>(r=y,l=Date.now(),this.removeTargets(e,r,t))).next(y=>(s=y,d=Date.now(),this.removeOrphanedDocuments(e,r))).next(y=>(f=Date.now(),nd()<=Ut.DEBUG&&Me("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-m}ms
	Determined least recently used ${i} in `+(l-o)+`ms
	Removed ${s} targets in `+(d-l)+`ms
	Removed ${y} documents in `+(f-d)+`ms
Total Duration: ${f-m}ms`),_e.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:y})))}}function fC(n,e){return new q6(n,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H6{constructor(e,t){this.db=e,this.garbageCollector=fC(this,t)}pr(e){const t=this.br(e);return this.db.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}br(e){let t=0;return this.yr(e,r=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}yr(e,t){return this.Sr(e,(r,i)=>t(i))}addReference(e,t,r){return Tp(e,r)}removeReference(e,t,r){return Tp(e,r)}removeTargets(e,t,r){return this.db.getTargetCache().removeTargets(e,t,r)}markPotentiallyOrphaned(e,t){return Tp(e,t)}Dr(e,t){return function(i,s){let o=!1;return dC(i).ne(l=>uC(i,l,s).next(d=>(d&&(o=!0),_e.resolve(!d)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,(o,l)=>{if(l<=t){const d=this.Dr(e,o).next(f=>{if(!f)return s++,r.getEntry(e,o).next(()=>(r.removeEntry(o,ut.min()),Il(e).delete(function(y){return[0,Qr(y.path)]}(o))))});i.push(d)}}).next(()=>_e.waitFor(i)).next(()=>r.apply(e)).next(()=>s)}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,t){return Tp(e,t)}Sr(e,t){const r=Il(e);let i,s=ws.le;return r.te({index:Zx},([o,l],{path:d,sequenceNumber:f})=>{o===0?(s!==ws.le&&t(new qe(No(i)),s),s=f,i=d):s=ws.le}).next(()=>{s!==ws.le&&t(new qe(No(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Tp(n,e){return Il(n).put(function(r,i){return{targetId:0,path:Qr(r.path),sequenceNumber:i}}(e,n.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(){this.changes=new Ca(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Un.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const r=this.changes.get(t);return r!==void 0?_e.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $6{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,r){return Nc(e).put(r)}removeEntry(e,t,r){return Nc(e).delete(function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Mg(o),l[l.length-1]]}(t,r))}updateMetadata(e,t){return this.getMetadata(e).next(r=>(r.byteSize+=t,this.vr(e,r)))}getEntry(e,t){let r=Un.newInvalidDocument(t);return Nc(e).te({index:tg,range:IDBKeyRange.only(Eh(t))},(i,s)=>{r=this.Cr(t,s)}).next(()=>r)}Fr(e,t){let r={size:0,document:Un.newInvalidDocument(t)};return Nc(e).te({index:tg,range:IDBKeyRange.only(Eh(t))},(i,s)=>{r={document:this.Cr(t,s),size:Lg(s)}}).next(()=>r)}getEntries(e,t){let r=es();return this.Mr(e,t,(i,s)=>{const o=this.Cr(i,s);r=r.insert(i,o)}).next(()=>r)}Or(e,t){let r=es(),i=new jn(qe.comparator);return this.Mr(e,t,(s,o)=>{const l=this.Cr(s,o);r=r.insert(s,l),i=i.insert(s,Lg(o))}).next(()=>({documents:r,Nr:i}))}Mr(e,t,r){if(t.isEmpty())return _e.resolve();let i=new pn(UT);t.forEach(d=>i=i.add(d));const s=IDBKeyRange.bound(Eh(i.first()),Eh(i.last())),o=i.getIterator();let l=o.getNext();return Nc(e).te({index:tg,range:s},(d,f,m)=>{const y=qe.fromSegments([...f.prefixPath,f.collectionGroup,f.documentId]);for(;l&&UT(l,y)<0;)r(l,null),l=o.getNext();l&&l.isEqual(y)&&(r(l,f),l=o.hasNext()?o.getNext():null),l?m.H(Eh(l)):m.done()}).next(()=>{for(;l;)r(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,r,i,s){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),Mg(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],d=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Nc(e).J(IDBKeyRange.bound(l,d,!0)).next(f=>{s==null||s.incrementDocumentReadCount(f.length);let m=es();for(const y of f){const g=this.Cr(qe.fromSegments(y.prefixPath.concat(y.collectionGroup,y.documentId)),y);g.isFoundDocument()&&(om(t,g)||i.has(g.key))&&(m=m.insert(g.key,g))}return m})}getAllFromCollectionGroup(e,t,r,i){let s=es();const o=BT(t,r),l=BT(t,ns.max());return Nc(e).te({index:rk,range:IDBKeyRange.bound(o,l,!0)},(d,f,m)=>{const y=this.Cr(qe.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);s=s.insert(y.key,y),s.size===i&&m.done()}).next(()=>s)}newChangeBuffer(e){return new W6(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return zT(e).get($_).next(t=>(it(!!t,20021),t))}vr(e,t){return zT(e).put($_,t)}Cr(e,t){if(t){const r=C6(this.serializer,t);if(!(r.isNoDocument()&&r.version.isEqual(ut.min())))return r}return Un.newInvalidDocument(e)}}function pC(n){return new $6(n)}class W6 extends mC{constructor(e,t){super(),this.Br=e,this.trackRemovals=t,this.Lr=new Ca(r=>r.toString(),(r,i)=>r.isEqual(i))}applyChanges(e){const t=[];let r=0,i=new pn((s,o)=>xt(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const l=this.Lr.get(s);if(t.push(this.Br.removeEntry(e,s,l.readTime)),o.isValidDocument()){const d=ET(this.Br.serializer,o);i=i.add(s.path.popLast());const f=Lg(d);r+=f-l.size,t.push(this.Br.addEntry(e,s,d))}else if(r-=l.size,this.trackRemovals){const d=ET(this.Br.serializer,o.convertToNoDocument(ut.min()));t.push(this.Br.addEntry(e,s,d))}}),i.forEach(s=>{t.push(this.Br.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.Br.updateMetadata(e,r)),_e.waitFor(t)}getFromCache(e,t){return this.Br.Fr(e,t).next(r=>(this.Lr.set(t,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,t){return this.Br.Or(e,t).next(({documents:r,Nr:i})=>(i.forEach((s,o)=>{this.Lr.set(s,{size:o,readTime:r.get(s).readTime})}),r))}}function zT(n){return mr(n,Cf)}function Nc(n){return mr(n,Ng)}function Eh(n){const e=n.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function BT(n,e){const t=e.documentKey.path.toArray();return[n,Mg(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function UT(n,e){const t=n.path.toArray(),r=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<r.length-2;++s)if(i=xt(t[s],r[s]),i)return i;return i=xt(t.length,r.length),i||(i=xt(t[t.length-2],r[r.length-2]),i||xt(t[t.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class G6{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(r!==null&&pf(r.mutation,i,Li.empty(),Ot.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.getLocalViewOfDocuments(e,r,Ft()).next(()=>r))}getLocalViewOfDocuments(e,t,r=Ft()){const i=Io();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(s=>{let o=Wh();return s.forEach((l,d)=>{o=o.insert(l,d.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const r=Io();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,Ft()))}populateOverlays(e,t,r){const i=[];return r.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,l)=>{t.set(o,l)})})}computeViews(e,t,r,i){let s=es();const o=mf(),l=function(){return mf()}();return t.forEach((d,f)=>{const m=r.get(f.key);i.has(f.key)&&(m===void 0||m.mutation instanceof Pa)?s=s.insert(f.key,f):m!==void 0?(o.set(f.key,m.mutation.getFieldMask()),pf(m.mutation,f,m.mutation.getFieldMask(),Ot.now())):o.set(f.key,Li.empty())}),this.recalculateAndSaveOverlays(e,s).next(d=>(d.forEach((f,m)=>o.set(f,m)),t.forEach((f,m)=>{var y;return l.set(f,new G6(m,(y=o.get(f))!==null&&y!==void 0?y:null))}),l))}recalculateAndSaveOverlays(e,t){const r=mf();let i=new jn((o,l)=>o-l),s=Ft();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const l of o)l.keys().forEach(d=>{const f=t.get(d);if(f===null)return;let m=r.get(d)||Li.empty();m=l.applyToLocalView(f,m),r.set(d,m);const y=(i.get(l.batchId)||Ft()).add(d);i=i.insert(l.batchId,y)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const d=l.getNext(),f=d.key,m=d.value,y=Mk();m.forEach(g=>{if(!s.has(g)){const _=Bk(t.get(g),r.get(g));_!==null&&y.set(g,_),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,f,y))}return _e.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,t,r,i){return function(o){return qe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):kk(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-s.size):_e.resolve(Io());let l=Af,d=s;return o.next(f=>_e.forEach(f,(m,y)=>(l<y.largestBatchId&&(l=y.largestBatchId),s.get(m)?_e.resolve():this.remoteDocumentCache.getEntry(e,m).next(g=>{d=d.insert(m,g)}))).next(()=>this.populateOverlays(e,f,s)).next(()=>this.computeViews(e,d,f,Ft())).next(m=>({batchId:l,changes:Ok(m)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new qe(t)).next(r=>{let i=Wh();return r.isFoundDocument()&&(i=i.insert(r.key,r)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){const s=t.collectionGroup;let o=Wh();return this.indexManager.getCollectionParents(e,s).next(l=>_e.forEach(l,d=>{const f=function(y,g){return new Od(g,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(t,d.child(s));return this.getDocumentsMatchingCollectionQuery(e,f,r,i).next(m=>{m.forEach((y,g)=>{o=o.insert(y,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,r,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,s,i))).next(o=>{s.forEach((d,f)=>{const m=f.getKey();o.get(m)===null&&(o=o.insert(m,Un.newInvalidDocument(m)))});let l=Wh();return o.forEach((d,f)=>{const m=s.get(d);m!==void 0&&pf(m.mutation,f,Li.empty(),Ot.now()),om(t,f)&&(l=l.insert(d,f))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K6{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return _e.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:hi(i.createTime)}}(t)),_e.resolve()}getNamedQuery(e,t){return _e.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(i){return{name:i.name,query:sC(i.bundledQuery),readTime:hi(i.readTime)}}(t)),_e.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y6{constructor(){this.overlays=new jn(qe.comparator),this.Qr=new Map}getOverlay(e,t){return _e.resolve(this.overlays.get(t))}getOverlays(e,t){const r=Io();return _e.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&r.set(i,s)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((i,s)=>{this.St(e,t,s)}),_e.resolve()}removeOverlaysForBatchId(e,t,r){const i=this.Qr.get(r);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Qr.delete(r)),_e.resolve()}getOverlaysForCollection(e,t,r){const i=Io(),s=t.length+1,o=new qe(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const d=l.getNext().value,f=d.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===s&&d.largestBatchId>r&&i.set(d.getKey(),d)}return _e.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let s=new jn((f,m)=>f-m);const o=this.overlays.getIterator();for(;o.hasNext();){const f=o.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>r){let m=s.get(f.largestBatchId);m===null&&(m=Io(),s=s.insert(f.largestBatchId,m)),m.set(f.getKey(),f)}}const l=Io(),d=s.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((f,m)=>l.set(f,m)),!(l.size()>=i)););return _e.resolve(l)}St(e,t,r){const i=this.overlays.get(r.key);if(i!==null){const o=this.Qr.get(i.largestBatchId).delete(r.key);this.Qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new lb(t,r));let s=this.Qr.get(t);s===void 0&&(s=Ft(),this.Qr.set(t,s)),this.Qr.set(t,s.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z6{constructor(){this.sessionToken=rr.EMPTY_BYTE_STRING}getSessionToken(e){return _e.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,_e.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mb{constructor(){this.$r=new pn(wr.Ur),this.Kr=new pn(wr.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const r=new wr(e,t);this.$r=this.$r.add(r),this.Kr=this.Kr.add(r)}Gr(e,t){e.forEach(r=>this.addReference(r,t))}removeReference(e,t){this.zr(new wr(e,t))}jr(e,t){e.forEach(r=>this.removeReference(r,t))}Hr(e){const t=new qe(new on([])),r=new wr(t,e),i=new wr(t,e+1),s=[];return this.Kr.forEachInRange([r,i],o=>{this.zr(o),s.push(o.key)}),s}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new qe(new on([])),r=new wr(t,e),i=new wr(t,e+1);let s=Ft();return this.Kr.forEachInRange([r,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new wr(e,0),r=this.$r.firstAfterOrEqual(t);return r!==null&&e.isEqual(r.key)}}class wr{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return qe.comparator(e.key,t.key)||xt(e.Zr,t.Zr)}static Wr(e,t){return xt(e.Zr,t.Zr)||qe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new pn(wr.Ur)}checkEmpty(e){return _e.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,r,i){const s=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new ob(s,t,r,i);this.mutationQueue.push(o);for(const l of i)this.Xr=this.Xr.add(new wr(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return _e.resolve(o)}lookupMutationBatch(e,t){return _e.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const r=t+1,i=this.ti(r),s=i<0?0:i;return _e.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return _e.resolve(this.mutationQueue.length===0?qc:this.nr-1)}getAllMutationBatches(e){return _e.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const r=new wr(t,0),i=new wr(t,Number.POSITIVE_INFINITY),s=[];return this.Xr.forEachInRange([r,i],o=>{const l=this.ei(o.Zr);s.push(l)}),_e.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new pn(xt);return t.forEach(i=>{const s=new wr(i,0),o=new wr(i,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([s,o],l=>{r=r.add(l.Zr)})}),_e.resolve(this.ni(r))}getAllMutationBatchesAffectingQuery(e,t){const r=t.path,i=r.length+1;let s=r;qe.isDocumentKey(s)||(s=s.child(""));const o=new wr(new qe(s),0);let l=new pn(xt);return this.Xr.forEachWhile(d=>{const f=d.key.path;return!!r.isPrefixOf(f)&&(f.length===i&&(l=l.add(d.Zr)),!0)},o),_e.resolve(this.ni(l))}ni(e){const t=[];return e.forEach(r=>{const i=this.ei(r);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){it(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Xr;return _e.forEach(t.mutations,i=>{const s=new wr(i.key,t.batchId);return r=r.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Xr=r})}sr(e){}containsKey(e,t){const r=new wr(t,0),i=this.Xr.firstAfterOrEqual(r);return _e.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,_e.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X6{constructor(e){this.ii=e,this.docs=function(){return new jn(qe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const r=t.key,i=this.docs.get(r),s=i?i.size:0,o=this.ii(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const r=this.docs.get(t);return _e.resolve(r?r.document.mutableCopy():Un.newInvalidDocument(t))}getEntries(e,t){let r=es();return t.forEach(i=>{const s=this.docs.get(i);r=r.insert(i,s?s.document.mutableCopy():Un.newInvalidDocument(i))}),_e.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let s=es();const o=t.path,l=new qe(o.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(l);for(;d.hasNext();){const{key:f,value:{document:m}}=d.getNext();if(!o.isPrefixOf(f.path))break;f.path.length>o.length+1||Kx(X4(m),r)<=0||(i.has(m.key)||om(t,m))&&(s=s.insert(m.key,m.mutableCopy()))}return _e.resolve(s)}getAllFromCollectionGroup(e,t,r,i){et(9500)}si(e,t){return _e.forEach(this.docs,r=>t(r))}newChangeBuffer(e){return new J6(this)}getSize(e){return _e.resolve(this.size)}}class J6 extends mC{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.Br.addEntry(e,i)):this.Br.removeEntry(r)}),_e.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eD{constructor(e){this.persistence=e,this.oi=new Ca(t=>eu(t),im),this.lastRemoteSnapshotVersion=ut.min(),this.highestTargetId=0,this._i=0,this.ai=new mb,this.targetCount=0,this.ui=iu.cr()}forEachTarget(e,t){return this.oi.forEach((r,i)=>t(i)),_e.resolve()}getLastRemoteSnapshotVersion(e){return _e.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return _e.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),_e.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this._i&&(this._i=t),_e.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new iu(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,_e.resolve()}updateTargetData(e,t){return this.Tr(t),_e.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,_e.resolve()}removeTargets(e,t,r){let i=0;const s=[];return this.oi.forEach((o,l)=>{l.sequenceNumber<=t&&r.get(l.targetId)===null&&(this.oi.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),_e.waitFor(s).next(()=>i)}getTargetCount(e){return _e.resolve(this.targetCount)}getTargetData(e,t){const r=this.oi.get(t)||null;return _e.resolve(r)}addMatchingKeys(e,t,r){return this.ai.Gr(t,r),_e.resolve()}removeMatchingKeys(e,t,r){this.ai.jr(t,r);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),_e.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),_e.resolve()}getMatchingKeysForTargetId(e,t){const r=this.ai.Yr(t);return _e.resolve(r)}containsKey(e,t){return _e.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pb{constructor(e,t){this.ci={},this.overlays={},this.li=new ws(0),this.hi=!1,this.hi=!0,this.Pi=new Z6,this.referenceDelegate=e(this),this.Ti=new eD(this),this.indexManager=new F6,this.remoteDocumentCache=function(i){return new X6(i)}(r=>this.referenceDelegate.Ii(r)),this.serializer=new rC(t),this.Ei=new K6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Y6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.ci[e.toKey()];return r||(r=new Q6(t,this.referenceDelegate),this.ci[e.toKey()]=r),r}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,r){Me("MemoryPersistence","Starting transaction:",e);const i=new tD(this.li.next());return this.referenceDelegate.di(),r(i).next(s=>this.referenceDelegate.Ai(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ri(e,t){return _e.or(Object.values(this.ci).map(r=>()=>r.containsKey(e,t)))}}class tD extends ek{constructor(e){super(),this.currentSequenceNumber=e}}class Ny{constructor(e){this.persistence=e,this.Vi=new mb,this.mi=null}static fi(e){return new Ny(e)}get gi(){if(this.mi)return this.mi;throw et(60996)}addReference(e,t,r){return this.Vi.addReference(r,t),this.gi.delete(r.toString()),_e.resolve()}removeReference(e,t,r){return this.Vi.removeReference(r,t),this.gi.add(r.toString()),_e.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),_e.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(i=>this.gi.add(i.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.gi.add(s.toString()))}).next(()=>r.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return _e.forEach(this.gi,r=>{const i=qe.fromPath(r);return this.pi(e,i).next(s=>{s||t.removeEntry(i,ut.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(r=>{r?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return _e.or([()=>_e.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class Fg{constructor(e,t){this.persistence=e,this.yi=new Ca(r=>Qr(r.path),(r,i)=>r.isEqual(i)),this.garbageCollector=fC(this,t)}static fi(e,t){return new Fg(e,t)}di(){}Ai(e){return _e.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>t.next(i=>r+i))}br(e){let t=0;return this.yr(e,r=>{t++}).next(()=>t)}yr(e,t){return _e.forEach(this.yi,(r,i)=>this.Dr(e,r,i).next(s=>s?_e.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.si(e,o=>this.Dr(e,o,t).next(l=>{l||(r++,s.removeEntry(o,ut.min()))})).next(()=>s.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),_e.resolve()}removeTarget(e,t){const r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.yi.set(r,e.currentSequenceNumber),_e.resolve()}removeReference(e,t,r){return this.yi.set(r,e.currentSequenceNumber),_e.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),_e.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=rg(e.data.value)),t}Dr(e,t,r){return _e.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.yi.get(t);return _e.resolve(i!==void 0&&i>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nD{constructor(e){this.serializer=e}q(e,t,r,i){const s=new my("createOrUpgrade",t);r<1&&i>=1&&(function(d){d.createObjectStore(rm)}(e),function(d){d.createObjectStore(kf,{keyPath:dM}),d.createObjectStore(no,{keyPath:JE,autoIncrement:!0}).createIndex(Bc,eT,{unique:!0}),d.createObjectStore(gd)}(e),qT(e),function(d){d.createObjectStore(jc)}(e));let o=_e.resolve();return r<3&&i>=3&&(r!==0&&(function(d){d.deleteObjectStore(vd),d.deleteObjectStore(yd),d.deleteObjectStore(Hc)}(e),qT(e)),o=o.next(()=>function(d){const f=d.store(Hc),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ut.min().toTimestamp(),targetCount:0};return f.put(Ig,m)}(s))),r<4&&i>=4&&(r!==0&&(o=o.next(()=>function(d,f){return f.store(no).J().next(y=>{d.deleteObjectStore(no),d.createObjectStore(no,{keyPath:JE,autoIncrement:!0}).createIndex(Bc,eT,{unique:!0});const g=f.store(no),_=y.map(E=>g.put(E));return _e.waitFor(_)})}(e,s))),o=o.next(()=>{(function(d){d.createObjectStore(_d,{keyPath:xM})})(e)})),r<5&&i>=5&&(o=o.next(()=>this.wi(s))),r<6&&i>=6&&(o=o.next(()=>(function(d){d.createObjectStore(Cf)}(e),this.bi(s)))),r<7&&i>=7&&(o=o.next(()=>this.Si(s))),r<8&&i>=8&&(o=o.next(()=>this.Di(e,s))),r<9&&i>=9&&(o=o.next(()=>{(function(d){d.objectStoreNames.contains("remoteDocumentChanges")&&d.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&i>=10&&(o=o.next(()=>this.Ci(s))),r<11&&i>=11&&(o=o.next(()=>{(function(d){d.createObjectStore(gy,{keyPath:bM})})(e),function(d){d.createObjectStore(yy,{keyPath:wM})}(e)})),r<12&&i>=12&&(o=o.next(()=>{(function(d){const f=d.createObjectStore(vy,{keyPath:kM});f.createIndex(G_,CM,{unique:!1}),f.createIndex(ak,PM,{unique:!1})})(e)})),r<13&&i>=13&&(o=o.next(()=>function(d){const f=d.createObjectStore(Ng,{keyPath:fM});f.createIndex(tg,mM),f.createIndex(rk,pM)}(e)).next(()=>this.Fi(e,s)).next(()=>e.deleteObjectStore(jc))),r<14&&i>=14&&(o=o.next(()=>this.Mi(e,s))),r<15&&i>=15&&(o=o.next(()=>function(d){d.createObjectStore(Qx,{keyPath:EM,autoIncrement:!0}).createIndex(W_,TM,{unique:!1}),d.createObjectStore(uf,{keyPath:SM}).createIndex(sk,AM,{unique:!1}),d.createObjectStore(df,{keyPath:NM}).createIndex(ok,IM,{unique:!1})}(e))),r<16&&i>=16&&(o=o.next(()=>{t.objectStore(uf).clear()}).next(()=>{t.objectStore(df).clear()})),r<17&&i>=17&&(o=o.next(()=>{(function(d){d.createObjectStore(Xx,{keyPath:RM})})(e)})),r<18&&i>=18&&QI()&&(o=o.next(()=>{t.objectStore(uf).clear()}).next(()=>{t.objectStore(df).clear()})),o}bi(e){let t=0;return e.store(jc).te((r,i)=>{t+=Lg(i)}).next(()=>{const r={byteSize:t};return e.store(Cf).put($_,r)})}wi(e){const t=e.store(kf),r=e.store(no);return t.J().next(i=>_e.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,qc],[s.userId,s.lastAcknowledgedBatchId]);return r.J(Bc,o).next(l=>_e.forEach(l,d=>{it(d.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:d.batchId});const f=Lc(this.serializer,d);return cC(e,s.userId,f).next(()=>{})}))}))}Si(e){const t=e.store(vd),r=e.store(jc);return e.store(Hc).get(Ig).next(i=>{const s=[];return r.te((o,l)=>{const d=new on(o),f=function(y){return[0,Qr(y)]}(d);s.push(t.get(f).next(m=>m?_e.resolve():(y=>t.put({targetId:0,path:Qr(y),sequenceNumber:i.highestListenSequenceNumber}))(d)))}).next(()=>_e.waitFor(s))})}Di(e,t){e.createObjectStore(Pf,{keyPath:_M});const r=t.store(Pf),i=new fb,s=o=>{if(i.add(o)){const l=o.lastSegment(),d=o.popLast();return r.put({collectionId:l,parent:Qr(d)})}};return t.store(jc).te({ee:!0},(o,l)=>{const d=new on(o);return s(d.popLast())}).next(()=>t.store(gd).te({ee:!0},([o,l,d],f)=>{const m=No(l);return s(m.popLast())}))}Ci(e){const t=e.store(yd);return t.te((r,i)=>{const s=Kh(i),o=iC(this.serializer,s);return t.put(o)})}Fi(e,t){const r=t.store(jc),i=[];return r.te((s,o)=>{const l=t.store(Ng),d=function(y){return y.document?new qe(on.fromString(y.document.name).popFirst(5)):y.noDocument?qe.fromSegments(y.noDocument.path):y.unknownDocument?qe.fromSegments(y.unknownDocument.path):et(36783)}(o).path.toArray(),f={prefixPath:d.slice(0,d.length-2),collectionGroup:d[d.length-2],documentId:d[d.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(l.put(f))}).next(()=>_e.waitFor(i))}Mi(e,t){const r=t.store(no),i=pC(this.serializer),s=new pb(Ny.fi,this.serializer.wt);return r.J().next(o=>{const l=new Map;return o.forEach(d=>{var f;let m=(f=l.get(d.userId))!==null&&f!==void 0?f:Ft();Lc(this.serializer,d).keys().forEach(y=>m=m.add(y)),l.set(d.userId,m)}),_e.forEach(l,(d,f)=>{const m=new Pr(f),y=Sy.bt(this.serializer,m),g=s.getIndexManager(m),_=Ay.bt(m,this.serializer,g,s.referenceDelegate);return new gC(i,_,y,g).recalculateAndSaveOverlaysForDocumentKeys(new K_(t,ws.le),d).next()})})}}function qT(n){n.createObjectStore(vd,{keyPath:yM}).createIndex(Zx,vM,{unique:!0}),n.createObjectStore(yd,{keyPath:"targetId"}).createIndex(ik,gM,{unique:!0}),n.createObjectStore(Hc)}const wl="IndexedDbPersistence",Tv=18e5,Sv=5e3,Av="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",rD="main";class gb{constructor(e,t,r,i,s,o,l,d,f,m,y=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=r,this.xi=s,this.window=o,this.document=l,this.Oi=f,this.Ni=m,this.Bi=y,this.li=null,this.hi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Li=null,this.inForeground=!1,this.ki=null,this.qi=null,this.Qi=Number.NEGATIVE_INFINITY,this.$i=g=>Promise.resolve(),!gb.C())throw new Ue(Ie.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new H6(this,i),this.Ui=t+rD,this.serializer=new rC(d),this.Ki=new Ll(this.Ui,this.Bi,new nD(this.serializer)),this.Pi=new R6,this.Ti=new z6(this.referenceDelegate,this.serializer),this.remoteDocumentCache=pC(this.serializer),this.Ei=new P6,this.window&&this.window.localStorage?this.Wi=this.window.localStorage:(this.Wi=null,m===!1&&ui(wl,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Gi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ue(Ie.FAILED_PRECONDITION,Av);return this.zi(),this.ji(),this.Hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ti.getHighestSequenceNumber(e))}).then(e=>{this.li=new ws(e,this.Oi)}).then(()=>{this.hi=!0}).catch(e=>(this.Ki&&this.Ki.close(),Promise.reject(e)))}Ji(e){return this.$i=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ki.U(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.xi.enqueueAndForget(async()=>{this.started&&await this.Gi()}))}Gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Sp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Yi(e).next(t=>{t||(this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)))})}).next(()=>this.Zi(e)).next(t=>this.isPrimary&&!t?this.Xi(e).next(()=>!1):!!t&&this.es(e).next(()=>!0))).catch(e=>{if(ec(e))return Me(wl,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Me(wl,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.xi.enqueueRetryable(()=>this.$i(e)),this.isPrimary=e})}Yi(e){return Th(e).get(Wu).next(t=>_e.resolve(this.ts(t)))}ns(e){return Sp(e).delete(this.clientId)}async rs(){if(this.isPrimary&&!this.ss(this.Qi,Tv)){this.Qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const r=mr(t,_d);return r.J().next(i=>{const s=this._s(i,Tv),o=i.filter(l=>s.indexOf(l)===-1);return _e.forEach(o,l=>r.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Wi)for(const t of e)this.Wi.removeItem(this.us(t.clientId))}}Hi(){this.qi=this.xi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Gi().then(()=>this.rs()).then(()=>this.Hi()))}ts(e){return!!e&&e.ownerId===this.clientId}Zi(e){return this.Ni?_e.resolve(!0):Th(e).get(Wu).next(t=>{if(t!==null&&this.ss(t.leaseTimestampMs,Sv)&&!this.cs(t.ownerId)){if(this.ts(t)&&this.networkEnabled)return!0;if(!this.ts(t)){if(!t.allowTabSynchronization)throw new Ue(Ie.FAILED_PRECONDITION,Av);return!1}}return!(!this.networkEnabled||!this.inForeground)||Sp(e).J().next(r=>this._s(r,Sv).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,l=this.networkEnabled===i.networkEnabled;if(s||o&&l)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&Me(wl,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.hi=!1,this.ls(),this.qi&&(this.qi.cancel(),this.qi=null),this.hs(),this.Ps(),await this.Ki.runTransaction("shutdown","readwrite",[rm,_d],e=>{const t=new K_(e,ws.le);return this.Xi(t).next(()=>this.ns(t))}),this.Ki.close(),this.Ts()}_s(e,t){return e.filter(r=>this.ss(r.updateTimeMs,t)&&!this.cs(r.clientId))}Is(){return this.runTransaction("getActiveClients","readonly",e=>Sp(e).J().next(t=>this._s(t,Tv).map(r=>r.clientId)))}get started(){return this.hi}getGlobalsCache(){return this.Pi}getMutationQueue(e,t){return Ay.bt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new V6(e,this.serializer.wt.databaseId)}getDocumentOverlayCache(e){return Sy.bt(this.serializer,e)}getBundleCache(){return this.Ei}runTransaction(e,t,r){Me(wl,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=function(d){return d===18?MM:d===17?dk:d===16?OM:d===15?Jx:d===14?uk:d===13?ck:d===12?jM:d===11?lk:void et(60245)}(this.Bi);let o;return this.Ki.runTransaction(e,i,s,l=>(o=new K_(l,this.li?this.li.next():ws.le),t==="readwrite-primary"?this.Yi(o).next(d=>!!d||this.Zi(o)).next(d=>{if(!d)throw ui(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)),new Ue(Ie.FAILED_PRECONDITION,J4);return r(o)}).next(d=>this.es(o).next(()=>d)):this.Es(o).next(()=>r(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Es(e){return Th(e).get(Wu).next(t=>{if(t!==null&&this.ss(t.leaseTimestampMs,Sv)&&!this.cs(t.ownerId)&&!this.ts(t)&&!(this.Ni||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ue(Ie.FAILED_PRECONDITION,Av)})}es(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Th(e).put(Wu,t)}static C(){return Ll.C()}Xi(e){const t=Th(e);return t.get(Wu).next(r=>this.ts(r)?(Me(wl,"Releasing primary lease."),t.delete(Wu)):_e.resolve())}ss(e,t){const r=Date.now();return!(e<r-t)&&(!(e>r)||(ui(`Detected an update time that is in the future: ${e} > ${r}`),!1))}zi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ki=()=>{this.xi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Gi()))},this.document.addEventListener("visibilitychange",this.ki),this.inForeground=this.document.visibilityState==="visible")}hs(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)}ji(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Li=()=>{this.ls();const t=/(?:Version|Mobile)\/1[456]/;ZI()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.xi.enterRestrictedMode(!0),this.xi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Li))}Ps(){this.Li&&(this.window.removeEventListener("pagehide",this.Li),this.Li=null)}cs(e){var t;try{const r=((t=this.Wi)===null||t===void 0?void 0:t.getItem(this.us(e)))!==null;return Me(wl,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return ui(wl,"Failed to get zombied client id.",r),!1}}ls(){if(this.Wi)try{this.Wi.setItem(this.us(this.clientId),String(Date.now()))}catch(e){ui("Failed to set zombie client id.",e)}}Ts(){if(this.Wi)try{this.Wi.removeItem(this.us(this.clientId))}catch{}}us(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Th(n){return mr(n,rm)}function Sp(n){return mr(n,_d)}function iD(n,e){let t=n.projectId;return n.isDefaultDatabase||(t+="."+n.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yb{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.ds=r,this.As=i}static Rs(e,t){let r=Ft(),i=Ft();for(const s of t.docChanges)switch(s.type){case 0:r=r.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new yb(e,t.fromCache,r,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sD{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return ZI()?8:tk(fr())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,r,i){const s={result:null};return this.ws(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.bs(e,t,i,r).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new sD;return this.Ss(e,t,o).next(l=>{if(s.result=l,this.fs)return this.Ds(e,t,o,l.size)})}).next(()=>s.result)}Ds(e,t,r,i){return r.documentReadCount<this.gs?(nd()<=Ut.DEBUG&&Me("QueryEngine","SDK will not create cache indexes for query:",rd(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),_e.resolve()):(nd()<=Ut.DEBUG&&Me("QueryEngine","Query:",rd(t),"scans",r.documentReadCount,"local documents and returns",i,"documents as results."),r.documentReadCount>this.ps*i?(nd()<=Ut.DEBUG&&Me("QueryEngine","The SDK decides to create cache indexes for query:",rd(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ts(t))):_e.resolve())}ws(e,t){if(fT(t))return _e.resolve(null);let r=Ts(t);return this.indexManager.getIndexType(e,r).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Rg(t,null,"F"),r=Ts(t)),this.indexManager.getDocumentsMatchingTarget(e,r).next(s=>{const o=Ft(...s);return this.ys.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(d=>{const f=this.vs(t,l);return this.Cs(t,f,o,d.readTime)?this.ws(e,Rg(t,null,"F")):this.Fs(e,f,t,d)}))})))}bs(e,t,r,i){return fT(t)||i.isEqual(ut.min())?_e.resolve(null):this.ys.getDocuments(e,r).next(s=>{const o=this.vs(t,s);return this.Cs(t,o,r,i)?_e.resolve(null):(nd()<=Ut.DEBUG&&Me("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),rd(t)),this.Fs(e,o,t,iM(i,Af)).next(l=>l))})}vs(e,t){let r=new pn(Rk(e));return t.forEach((i,s)=>{om(e,s)&&(r=r.add(s))}),r}Cs(e,t,r,i){if(e.limit===null)return!1;if(r.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,r){return nd()<=Ut.DEBUG&&Me("QueryEngine","Using full collection scan to execute query:",rd(t)),this.ys.getDocumentsMatchingQuery(e,t,ns.min(),r)}Fs(e,t,r,i){return this.ys.getDocumentsMatchingQuery(e,r,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vb="LocalStore",oD=3e8;class aD{constructor(e,t,r,i){this.persistence=e,this.Ms=t,this.serializer=i,this.xs=new jn(xt),this.Os=new Ca(s=>eu(s),im),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(r)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new gC(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function vC(n,e,t,r){return new aD(n,e,t,r)}async function _C(n,e){const t=At(n);return await t.persistence.runTransaction("Handle user change","readonly",r=>{let i;return t.mutationQueue.getAllMutationBatches(r).next(s=>(i=s,t.Ls(e),t.mutationQueue.getAllMutationBatches(r))).next(s=>{const o=[],l=[];let d=Ft();for(const f of i){o.push(f.batchId);for(const m of f.mutations)d=d.add(m.key)}for(const f of s){l.push(f.batchId);for(const m of f.mutations)d=d.add(m.key)}return t.localDocuments.getDocuments(r,d).next(f=>({ks:f,removedBatchIds:o,addedBatchIds:l}))})})}function lD(n,e){const t=At(n);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const i=e.batch.keys(),s=t.Bs.newChangeBuffer({trackRemovals:!0});return function(l,d,f,m){const y=f.batch,g=y.keys();let _=_e.resolve();return g.forEach(E=>{_=_.next(()=>m.getEntry(d,E)).next(x=>{const w=f.docVersions.get(E);it(w!==null,48541),x.version.compareTo(w)<0&&(y.applyToRemoteDocument(x,f),x.isValidDocument()&&(x.setReadTime(f.commitVersion),m.addEntry(x)))})}),_.next(()=>l.mutationQueue.removeMutationBatch(d,y))}(t,r,e,s).next(()=>s.apply(r)).next(()=>t.mutationQueue.performConsistencyCheck(r)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(r,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let d=Ft();for(let f=0;f<l.mutationResults.length;++f)l.mutationResults[f].transformResults.length>0&&(d=d.add(l.batch.mutations[f].key));return d}(e))).next(()=>t.localDocuments.getDocuments(r,i))})}function xC(n){const e=At(n);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function cD(n,e){const t=At(n),r=e.snapshotVersion;let i=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.Bs.newChangeBuffer({trackRemovals:!0});i=t.xs;const l=[];e.targetChanges.forEach((m,y)=>{const g=i.get(y);if(!g)return;l.push(t.Ti.removeMatchingKeys(s,m.removedDocuments,y).next(()=>t.Ti.addMatchingKeys(s,m.addedDocuments,y)));let _=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(y)!==null?_=_.withResumeToken(rr.EMPTY_BYTE_STRING,ut.min()).withLastLimboFreeSnapshotVersion(ut.min()):m.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(m.resumeToken,r)),i=i.insert(y,_),function(x,w,S){return x.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=oD?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(g,_,m)&&l.push(t.Ti.updateTargetData(s,_))});let d=es(),f=Ft();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(s,m))}),l.push(uD(s,o,e.documentUpdates).next(m=>{d=m.qs,f=m.Qs})),!r.isEqual(ut.min())){const m=t.Ti.getLastRemoteSnapshotVersion(s).next(y=>t.Ti.setTargetsMetadata(s,s.currentSequenceNumber,r));l.push(m)}return _e.waitFor(l).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,d,f)).next(()=>d)}).then(s=>(t.xs=i,s))}function uD(n,e,t){let r=Ft(),i=Ft();return t.forEach(s=>r=r.add(s)),e.getEntries(n,r).next(s=>{let o=es();return t.forEach((l,d)=>{const f=s.get(l);d.isFoundDocument()!==f.isFoundDocument()&&(i=i.add(l)),d.isNoDocument()&&d.version.isEqual(ut.min())?(e.removeEntry(l,d.readTime),o=o.insert(l,d)):!f.isValidDocument()||d.version.compareTo(f.version)>0||d.version.compareTo(f.version)===0&&f.hasPendingWrites?(e.addEntry(d),o=o.insert(l,d)):Me(vb,"Ignoring outdated watch update for ",l,". Current version:",f.version," Watch version:",d.version)}),{qs:o,Qs:i}})}function dD(n,e){const t=At(n);return t.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=qc),t.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function hD(n,e){const t=At(n);return t.persistence.runTransaction("Allocate target","readwrite",r=>{let i;return t.Ti.getTargetData(r,e).next(s=>s?(i=s,_e.resolve(i)):t.Ti.allocateTargetId(r).next(o=>(i=new va(e,o,"TargetPurposeListen",r.currentSequenceNumber),t.Ti.addTargetData(r,i).next(()=>i))))}).then(r=>{const i=t.xs.get(r.targetId);return(i===null||r.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.xs=t.xs.insert(r.targetId,r),t.Os.set(e,r.targetId)),r})}async function lx(n,e,t){const r=At(n),i=r.xs.get(e),s=t?"readwrite":"readwrite-primary";try{t||await r.persistence.runTransaction("Release target",s,o=>r.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!ec(o))throw o;Me(vb,`Failed to update sequence numbers for target ${e}: ${o}`)}r.xs=r.xs.remove(e),r.Os.delete(i.target)}function HT(n,e,t){const r=At(n);let i=ut.min(),s=Ft();return r.persistence.runTransaction("Execute query","readwrite",o=>function(d,f,m){const y=At(d),g=y.Os.get(m);return g!==void 0?_e.resolve(y.xs.get(g)):y.Ti.getTargetData(f,m)}(r,o,Ts(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,r.Ti.getMatchingKeysForTargetId(o,l.targetId).next(d=>{s=d})}).next(()=>r.Ms.getDocumentsMatchingQuery(o,e,t?i:ut.min(),t?s:Ft())).next(l=>(fD(r,QM(e),l),{documents:l,$s:s})))}function fD(n,e,t){let r=n.Ns.get(e)||ut.min();t.forEach((i,s)=>{s.readTime.compareTo(r)>0&&(r=s.readTime)}),n.Ns.set(e,r)}class $T{constructor(){this.activeTargetIds=r6()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class bC{constructor(){this.xo=new $T,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,r){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new $T,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mD{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WT="ConnectivityMonitor";class GT{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){Me(WT,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){Me(WT,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ap=null;function cx(){return Ap===null?Ap=function(){return 268435456+Math.round(2147483648*Math.random())}():Ap++,"0x"+Ap.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nv="RestConnection",pD={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class gD{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${r}/databases/${i}`,this.Go=this.databaseId.database===kg?`project_id=${r}`:`project_id=${r}&database_id=${i}`}zo(e,t,r,i,s){const o=cx(),l=this.jo(e,t.toUriEncodedString());Me(Nv,`Sending RPC '${e}' ${o}:`,l,r);const d={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(d,i,s);const{host:f}=new URL(l),m=uu(f);return this.Jo(e,l,d,r,m).then(y=>(Me(Nv,`Received RPC '${e}' ${o}: `,y),y),y=>{throw Xc(Nv,`RPC '${e}' ${o} failed with error: `,y,"url: ",l,"request:",r),y})}Yo(e,t,r,i,s,o){return this.zo(e,t,r,i,s)}Ho(e,t,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+jd}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),r&&r.headers.forEach((i,s)=>e[s]=i)}jo(e,t){const r=pD[e];return`${this.Ko}/v1/${t}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yD{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $r="WebChannelConnection";class vD extends gD{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,r,i,s){const o=cx();return new Promise((l,d)=>{const f=new U4;f.setWithCredentials(!0),f.listenOnce(q4.COMPLETE,()=>{try{switch(f.getLastErrorCode()){case Xp.NO_ERROR:const y=f.getResponseJson();Me($r,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(y)),l(y);break;case Xp.TIMEOUT:Me($r,`RPC '${e}' ${o} timed out`),d(new Ue(Ie.DEADLINE_EXCEEDED,"Request time out"));break;case Xp.HTTP_ERROR:const g=f.getStatus();if(Me($r,`RPC '${e}' ${o} failed with status:`,g,"response text:",f.getResponseText()),g>0){let _=f.getResponseJson();Array.isArray(_)&&(_=_[0]);const E=_==null?void 0:_.error;if(E&&E.status&&E.message){const x=function(S){const N=S.toLowerCase().replace(/_/g,"-");return Object.values(Ie).indexOf(N)>=0?N:Ie.UNKNOWN}(E.status);d(new Ue(x,E.message))}else d(new Ue(Ie.UNKNOWN,"Server responded with status "+f.getStatus()))}else d(new Ue(Ie.UNAVAILABLE,"Connection failed."));break;default:et(9055,{h_:e,streamId:o,P_:f.getLastErrorCode(),T_:f.getLastError()})}}finally{Me($r,`RPC '${e}' ${o} completed.`)}});const m=JSON.stringify(i);Me($r,`RPC '${e}' ${o} sending request:`,i),f.send(t,"POST",m,r,15)})}I_(e,t,r){const i=cx(),s=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=W4(),l=$4(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(d.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Ho(d.initMessageHeaders,t,r),d.encodeInitMessageHeaders=!0;const m=s.join("");Me($r,`Creating RPC '${e}' stream ${i}: ${m}`,d);const y=o.createWebChannel(m,d);this.E_(y);let g=!1,_=!1;const E=new yD({Zo:w=>{_?Me($r,`Not sending because RPC '${e}' stream ${i} is closed:`,w):(g||(Me($r,`Opening RPC '${e}' stream ${i} transport.`),y.open(),g=!0),Me($r,`RPC '${e}' stream ${i} sending:`,w),y.send(w))},Xo:()=>y.close()}),x=(w,S,N)=>{w.listen(S,P=>{try{N(P)}catch(I){setTimeout(()=>{throw I},0)}})};return x(y,$h.EventType.OPEN,()=>{_||(Me($r,`RPC '${e}' stream ${i} transport opened.`),E.__())}),x(y,$h.EventType.CLOSE,()=>{_||(_=!0,Me($r,`RPC '${e}' stream ${i} transport closed`),E.u_(),this.d_(y))}),x(y,$h.EventType.ERROR,w=>{_||(_=!0,Xc($r,`RPC '${e}' stream ${i} transport errored. Name:`,w.name,"Message:",w.message),E.u_(new Ue(Ie.UNAVAILABLE,"The operation could not be completed")))}),x(y,$h.EventType.MESSAGE,w=>{var S;if(!_){const N=w.data[0];it(!!N,16349);const P=N,I=(P==null?void 0:P.error)||((S=P[0])===null||S===void 0?void 0:S.error);if(I){Me($r,`RPC '${e}' stream ${i} received error:`,I);const R=I.status;let U=function(F){const O=nr[F];if(O!==void 0)return Hk(O)}(R),j=I.message;U===void 0&&(U=Ie.INTERNAL,j="Unknown error status: "+R+" with message "+I.message),_=!0,E.u_(new Ue(U,j)),y.close()}else Me($r,`RPC '${e}' stream ${i} received:`,N),E.c_(N)}}),x(l,H4.STAT_EVENT,w=>{w.stat===B_.PROXY?Me($r,`RPC '${e}' stream ${i} detected buffering proxy`):w.stat===B_.NOPROXY&&Me($r,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.a_()},0),E}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _D(){return typeof window<"u"?window:null}function lg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iy(n){return new _6(n,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wC{constructor(e,t,r=1e3,i=1.5,s=6e4){this.xi=e,this.timerId=t,this.A_=r,this.R_=i,this.V_=s,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),r=Math.max(0,Date.now()-this.g_),i=Math.max(0,t-r);i>0&&Me("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,i,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KT="PersistentStream";class EC{constructor(e,t,r,i,s,o,l,d){this.xi=e,this.S_=r,this.D_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=d,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new wC(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===Ie.RESOURCE_EXHAUSTED?(ui(t.toString()),ui("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===Ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,i])=>{this.v_===t&&this.z_(r,i)},r=>{e(()=>{const i=new Ue(Ie.UNKNOWN,"Fetching auth token failed: "+r.message);return this.j_(i)})})}z_(e,t){const r=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{r(()=>this.listener.e_())}),this.stream.n_(()=>{r(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(i=>{r(()=>this.j_(i))}),this.stream.onMessage(i=>{r(()=>++this.M_==1?this.J_(i):this.onNext(i))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return Me(KT,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(Me(KT,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class xD extends EC{constructor(e,t,r,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=w6(this.serializer,e),r=function(s){if(!("targetChange"in s))return ut.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?ut.min():o.readTime?hi(o.readTime):ut.min()}(e);return this.listener.Y_(t,r)}Z_(e){const t={};t.database=rx(this.serializer),t.addTarget=function(s,o){let l;const d=o.target;if(l=Cg(d)?{documents:Xk(s,d)}:{query:db(s,d).gt},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=Gk(s,o.resumeToken);const f=tx(s,o.expectedCount);f!==null&&(l.expectedCount=f)}else if(o.snapshotVersion.compareTo(ut.min())>0){l.readTime=Ad(s,o.snapshotVersion.toTimestamp());const f=tx(s,o.expectedCount);f!==null&&(l.expectedCount=f)}return l}(this.serializer,e);const r=S6(this.serializer,e);r&&(t.labels=r),this.Q_(t)}X_(e){const t={};t.database=rx(this.serializer),t.removeTarget=e,this.Q_(t)}}class bD extends EC{constructor(e,t,r,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,o),this.serializer=s}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return it(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,it(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){it(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=E6(e.writeResults,e.commitTime),r=hi(e.commitTime);return this.listener.ra(r,t)}ia(){const e={};e.database=rx(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(r=>Og(this.serializer,r))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wD{}class ED extends wD{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.sa=!1}oa(){if(this.sa)throw new Ue(Ie.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,r,i){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.zo(e,nx(t,r),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ue(Ie.UNKNOWN,s.toString())})}Yo(e,t,r,i,s){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Yo(e,nx(t,r),i,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ue(Ie.UNKNOWN,o.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class TD{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(ui(t),this.ua=!1):Me("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const su="RemoteStore";class SD{constructor(e,t,r,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=s,this.Ra.No(o=>{r.enqueueAndForget(async()=>{fu(this)&&(Me(su,"Restarting streams for network reachability change."),await async function(d){const f=At(d);f.da.add(4),await cm(f),f.Va.set("Unknown"),f.da.delete(4),await ky(f)}(this))})}),this.Va=new TD(r,i)}}async function ky(n){if(fu(n))for(const e of n.Aa)await e(!0)}async function cm(n){for(const e of n.Aa)await e(!1)}function TC(n,e){const t=At(n);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),wb(t)?bb(t):Dd(t).N_()&&xb(t,e))}function _b(n,e){const t=At(n),r=Dd(t);t.Ea.delete(e),r.N_()&&SC(t,e),t.Ea.size===0&&(r.N_()?r.k_():fu(t)&&t.Va.set("Unknown"))}function xb(n,e){if(n.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ut.min())>0){const t=n.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Dd(n).Z_(e)}function SC(n,e){n.ma.Ke(e),Dd(n).X_(e)}function bb(n){n.ma=new p6({getRemoteKeysForTarget:e=>n.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>n.Ea.get(e)||null,Pt:()=>n.datastore.serializer.databaseId}),Dd(n).start(),n.Va.ca()}function wb(n){return fu(n)&&!Dd(n).O_()&&n.Ea.size>0}function fu(n){return At(n).da.size===0}function AC(n){n.ma=void 0}async function AD(n){n.Va.set("Online")}async function ND(n){n.Ea.forEach((e,t)=>{xb(n,e)})}async function ID(n,e){AC(n),wb(n)?(n.Va.Pa(e),bb(n)):n.Va.set("Unknown")}async function kD(n,e,t){if(n.Va.set("Online"),e instanceof Wk&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const l of s.targetIds)i.Ea.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.Ea.delete(l),i.ma.removeTarget(l))}(n,e)}catch(r){Me(su,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Vg(n,r)}else if(e instanceof og?n.ma.Xe(e):e instanceof $k?n.ma.ot(e):n.ma.nt(e),!t.isEqual(ut.min()))try{const r=await xC(n.localStore);t.compareTo(r)>=0&&await function(s,o){const l=s.ma.It(o);return l.targetChanges.forEach((d,f)=>{if(d.resumeToken.approximateByteSize()>0){const m=s.Ea.get(f);m&&s.Ea.set(f,m.withResumeToken(d.resumeToken,o))}}),l.targetMismatches.forEach((d,f)=>{const m=s.Ea.get(d);if(!m)return;s.Ea.set(d,m.withResumeToken(rr.EMPTY_BYTE_STRING,m.snapshotVersion)),SC(s,d);const y=new va(m.target,d,f,m.sequenceNumber);xb(s,y)}),s.remoteSyncer.applyRemoteEvent(l)}(n,t)}catch(r){Me(su,"Failed to raise snapshot:",r),await Vg(n,r)}}async function Vg(n,e,t){if(!ec(e))throw e;n.da.add(1),await cm(n),n.Va.set("Offline"),t||(t=()=>xC(n.localStore)),n.asyncQueue.enqueueRetryable(async()=>{Me(su,"Retrying IndexedDB access"),await t(),n.da.delete(1),await ky(n)})}function NC(n,e){return e().catch(t=>Vg(n,t,e))}async function um(n){const e=At(n),t=Hl(e);let r=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:qc;for(;CD(e);)try{const i=await dD(e.localStore,r);if(i===null){e.Ia.length===0&&t.k_();break}r=i.batchId,PD(e,i)}catch(i){await Vg(e,i)}IC(e)&&kC(e)}function CD(n){return fu(n)&&n.Ia.length<10}function PD(n,e){n.Ia.push(e);const t=Hl(n);t.N_()&&t.ea&&t.ta(e.mutations)}function IC(n){return fu(n)&&!Hl(n).O_()&&n.Ia.length>0}function kC(n){Hl(n).start()}async function RD(n){Hl(n).ia()}async function jD(n){const e=Hl(n);for(const t of n.Ia)e.ta(t.mutations)}async function OD(n,e,t){const r=n.Ia.shift(),i=ab.from(r,e,t);await NC(n,()=>n.remoteSyncer.applySuccessfulWrite(i)),await um(n)}async function MD(n,e){e&&Hl(n).ea&&await async function(r,i){if(function(o){return f6(o)&&o!==Ie.ABORTED}(i.code)){const s=r.Ia.shift();Hl(r).L_(),await NC(r,()=>r.remoteSyncer.rejectFailedWrite(s.batchId,i)),await um(r)}}(n,e),IC(n)&&kC(n)}async function YT(n,e){const t=At(n);t.asyncQueue.verifyOperationInProgress(),Me(su,"RemoteStore received new credentials");const r=fu(t);t.da.add(3),await cm(t),r&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await ky(t)}async function DD(n,e){const t=At(n);e?(t.da.delete(2),await ky(t)):e||(t.da.add(2),await cm(t),t.Va.set("Unknown"))}function Dd(n){return n.fa||(n.fa=function(t,r,i){const s=At(t);return s.oa(),new xD(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{e_:AD.bind(null,n),n_:ND.bind(null,n),i_:ID.bind(null,n),Y_:kD.bind(null,n)}),n.Aa.push(async e=>{e?(n.fa.L_(),wb(n)?bb(n):n.Va.set("Unknown")):(await n.fa.stop(),AC(n))})),n.fa}function Hl(n){return n.ga||(n.ga=function(t,r,i){const s=At(t);return s.oa(),new bD(r,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(n.datastore,n.asyncQueue,{e_:()=>Promise.resolve(),n_:RD.bind(null,n),i_:MD.bind(null,n),na:jD.bind(null,n),ra:OD.bind(null,n)}),n.Aa.push(async e=>{e?(n.ga.L_(),await um(n)):(await n.ga.stop(),n.Ia.length>0&&(Me(su,`Stopping write stream with ${n.Ia.length} pending writes`),n.Ia=[]))})),n.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eb{constructor(e,t,r,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=s,this.deferred=new oo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,s){const o=Date.now()+r,l=new Eb(e,t,o,i,s);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ue(Ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Tb(n,e){if(ui("AsyncQueue",`${e}: ${n}`),ec(n))return new Ue(Ie.UNAVAILABLE,`${e}: ${n}`);throw n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dd{static emptySet(e){return new dd(e.comparator)}constructor(e){this.comparator=e?(t,r)=>e(t,r)||qe.comparator(t.key,r.key):(t,r)=>qe.comparator(t.key,r.key),this.keyedMap=Wh(),this.sortedSet=new jn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,r)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof dd)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=r.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const r=new dd;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=t,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZT{constructor(){this.pa=new jn(qe.comparator)}track(e){const t=e.doc.key,r=this.pa.get(t);r?e.type!==0&&r.type===3?this.pa=this.pa.insert(t,e):e.type===3&&r.type!==1?this.pa=this.pa.insert(t,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.pa=this.pa.remove(t):e.type===1&&r.type===2?this.pa=this.pa.insert(t,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):et(63341,{Vt:e,ya:r}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,r)=>{e.push(r)}),e}}class Nd{constructor(e,t,r,i,s,o,l,d,f){this.query=e,this.docs=t,this.oldDocs=r,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=d,this.hasCachedResults=f}static fromInitialDocuments(e,t,r,i,s){const o=[];return t.forEach(l=>{o.push({type:0,doc:l})}),new Nd(e,t,dd.emptySet(t),o,r,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&by(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,r=e.docChanges;if(t.length!==r.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==r[i].type||!t[i].doc.isEqual(r[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LD{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class FD{constructor(){this.queries=QT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,r){const i=At(t),s=i.queries;i.queries=QT(),s.forEach((o,l)=>{for(const d of l.Sa)d.onError(r)})})(this,new Ue(Ie.ABORTED,"Firestore shutting down"))}}function QT(){return new Ca(n=>Pk(n),by)}async function Sb(n,e){const t=At(n);let r=3;const i=e.query;let s=t.queries.get(i);s?!s.Da()&&e.va()&&(r=2):(s=new LD,r=e.va()?0:1);try{switch(r){case 0:s.ba=await t.onListen(i,!0);break;case 1:s.ba=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const l=Tb(o,`Initialization of query '${rd(e.query)}' failed`);return void e.onError(l)}t.queries.set(i,s),s.Sa.push(e),e.Fa(t.onlineState),s.ba&&e.Ma(s.ba)&&Nb(t)}async function Ab(n,e){const t=At(n),r=e.query;let i=3;const s=t.queries.get(r);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.va()?0:1:!s.Da()&&e.va()&&(i=2))}switch(i){case 0:return t.queries.delete(r),t.onUnlisten(r,!0);case 1:return t.queries.delete(r),t.onUnlisten(r,!1);case 2:return t.onLastRemoteStoreUnlisten(r);default:return}}function VD(n,e){const t=At(n);let r=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const l of o.Sa)l.Ma(i)&&(r=!0);o.ba=i}}r&&Nb(t)}function zD(n,e,t){const r=At(n),i=r.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);r.queries.delete(e)}function Nb(n){n.Ca.forEach(e=>{e.next()})}var ux,XT;(XT=ux||(ux={})).xa="default",XT.Cache="cache";class Ib{constructor(e,t,r){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=r||{}}Ma(e){if(!this.options.includeMetadataChanges){const r=[];for(const i of e.docChanges)i.type!==3&&r.push(i);e=new Nd(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const r=t!=="Offline";return(!this.options.Qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=Nd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==ux.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CC{constructor(e){this.key=e}}class PC{constructor(e){this.key=e}}class BD{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Ft(),this.mutatedKeys=Ft(),this.Za=Rk(e),this.Xa=new dd(this.Za)}get eu(){return this.Ha}tu(e,t){const r=t?t.nu:new ZT,i=t?t.Xa:this.Xa;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,l=!1;const d=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,f=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((m,y)=>{const g=i.get(m),_=om(this.query,y)?y:null,E=!!g&&this.mutatedKeys.has(g.key),x=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let w=!1;g&&_?g.data.isEqual(_.data)?E!==x&&(r.track({type:3,doc:_}),w=!0):this.ru(g,_)||(r.track({type:2,doc:_}),w=!0,(d&&this.Za(_,d)>0||f&&this.Za(_,f)<0)&&(l=!0)):!g&&_?(r.track({type:0,doc:_}),w=!0):g&&!_&&(r.track({type:1,doc:g}),w=!0,(d||f)&&(l=!0)),w&&(_?(o=o.add(_),s=x?s.add(m):s.delete(m)):(o=o.delete(m),s=s.delete(m)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const m=this.query.limitType==="F"?o.last():o.first();o=o.delete(m.key),s=s.delete(m.key),r.track({type:1,doc:m})}return{Xa:o,nu:r,Cs:l,mutatedKeys:s}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,r,i){const s=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const o=e.nu.wa();o.sort((m,y)=>function(_,E){const x=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return et(20277,{Vt:w})}};return x(_)-x(E)}(m.type,y.type)||this.Za(m.doc,y.doc)),this.iu(r),i=i!=null&&i;const l=t&&!i?this.su():[],d=this.Ya.size===0&&this.current&&!i?1:0,f=d!==this.Ja;return this.Ja=d,o.length!==0||f?{snapshot:new Nd(this.query,e.Xa,s,o,e.mutatedKeys,d===0,f,!1,!!r&&r.resumeToken.approximateByteSize()>0),ou:l}:{ou:l}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new ZT,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=Ft(),this.Xa.forEach(r=>{this._u(r.key)&&(this.Ya=this.Ya.add(r.key))});const t=[];return e.forEach(r=>{this.Ya.has(r)||t.push(new PC(r))}),this.Ya.forEach(r=>{e.has(r)||t.push(new CC(r))}),t}au(e){this.Ha=e.$s,this.Ya=Ft();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return Nd.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const kb="SyncEngine";class UD{constructor(e,t,r){this.query=e,this.targetId=t,this.view=r}}class qD{constructor(e){this.key=e,this.cu=!1}}class HD{constructor(e,t,r,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.lu={},this.hu=new Ca(l=>Pk(l),by),this.Pu=new Map,this.Tu=new Set,this.Iu=new jn(qe.comparator),this.Eu=new Map,this.du=new mb,this.Au={},this.Ru=new Map,this.Vu=iu.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function $D(n,e,t=!0){const r=LC(n);let i;const s=r.hu.get(e);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.uu()):i=await RC(r,e,t,!0),i}async function WD(n,e){const t=LC(n);await RC(t,e,!0,!1)}async function RC(n,e,t,r){const i=await hD(n.localStore,Ts(e)),s=i.targetId,o=n.sharedClientState.addLocalQueryTarget(s,t);let l;return r&&(l=await GD(n,e,s,o==="current",i.resumeToken)),n.isPrimaryClient&&t&&TC(n.remoteStore,i),l}async function GD(n,e,t,r,i){n.fu=(y,g,_)=>async function(x,w,S,N){let P=w.view.tu(S);P.Cs&&(P=await HT(x.localStore,w.query,!1).then(({documents:j})=>w.view.tu(j,P)));const I=N&&N.targetChanges.get(w.targetId),R=N&&N.targetMismatches.get(w.targetId)!=null,U=w.view.applyChanges(P,x.isPrimaryClient,I,R);return eS(x,w.targetId,U.ou),U.snapshot}(n,y,g,_);const s=await HT(n.localStore,e,!0),o=new BD(e,s.$s),l=o.tu(s.documents),d=lm.createSynthesizedTargetChangeForCurrentChange(t,r&&n.onlineState!=="Offline",i),f=o.applyChanges(l,n.isPrimaryClient,d);eS(n,t,f.ou);const m=new UD(e,t,o);return n.hu.set(e,m),n.Pu.has(t)?n.Pu.get(t).push(e):n.Pu.set(t,[e]),f.snapshot}async function KD(n,e,t){const r=At(n),i=r.hu.get(e),s=r.Pu.get(i.targetId);if(s.length>1)return r.Pu.set(i.targetId,s.filter(o=>!by(o,e))),void r.hu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await lx(r.localStore,i.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(i.targetId),t&&_b(r.remoteStore,i.targetId),dx(r,i.targetId)}).catch(hu)):(dx(r,i.targetId),await lx(r.localStore,i.targetId,!0))}async function YD(n,e){const t=At(n),r=t.hu.get(e),i=t.Pu.get(r.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(r.targetId),_b(t.remoteStore,r.targetId))}async function ZD(n,e,t){const r=FC(n);try{const i=await function(o,l){const d=At(o),f=Ot.now(),m=l.reduce((_,E)=>_.add(E.key),Ft());let y,g;return d.persistence.runTransaction("Locally write mutations","readwrite",_=>{let E=es(),x=Ft();return d.Bs.getEntries(_,m).next(w=>{E=w,E.forEach((S,N)=>{N.isValidDocument()||(x=x.add(S))})}).next(()=>d.localDocuments.getOverlayedDocuments(_,E)).next(w=>{y=w;const S=[];for(const N of l){const P=u6(N,y.get(N.key).overlayedDocument);P!=null&&S.push(new Pa(N.key,P,bk(P.value.mapValue),dr.exists(!0)))}return d.mutationQueue.addMutationBatch(_,f,S,l)}).next(w=>{g=w;const S=w.applyToLocalDocumentSet(y,x);return d.documentOverlayCache.saveOverlays(_,w.batchId,S)})}).then(()=>({batchId:g.batchId,changes:Ok(y)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(i.batchId),function(o,l,d){let f=o.Au[o.currentUser.toKey()];f||(f=new jn(xt)),f=f.insert(l,d),o.Au[o.currentUser.toKey()]=f}(r,i.batchId,t),await dm(r,i.changes),await um(r.remoteStore)}catch(i){const s=Tb(i,"Failed to persist write");t.reject(s)}}async function jC(n,e){const t=At(n);try{const r=await cD(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.Eu.get(s);o&&(it(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.cu=!0:i.modifiedDocuments.size>0?it(o.cu,14607):i.removedDocuments.size>0&&(it(o.cu,42227),o.cu=!1))}),await dm(t,r,e)}catch(r){await hu(r)}}function JT(n,e,t){const r=At(n);if(r.isPrimaryClient&&t===0||!r.isPrimaryClient&&t===1){const i=[];r.hu.forEach((s,o)=>{const l=o.view.Fa(e);l.snapshot&&i.push(l.snapshot)}),function(o,l){const d=At(o);d.onlineState=l;let f=!1;d.queries.forEach((m,y)=>{for(const g of y.Sa)g.Fa(l)&&(f=!0)}),f&&Nb(d)}(r.eventManager,e),i.length&&r.lu.Y_(i),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function QD(n,e,t){const r=At(n);r.sharedClientState.updateQueryState(e,"rejected",t);const i=r.Eu.get(e),s=i&&i.key;if(s){let o=new jn(qe.comparator);o=o.insert(s,Un.newNoDocument(s,ut.min()));const l=Ft().add(s),d=new Ty(ut.min(),new Map,new jn(xt),o,l);await jC(r,d),r.Iu=r.Iu.remove(s),r.Eu.delete(e),Cb(r)}else await lx(r.localStore,e,!1).then(()=>dx(r,e,t)).catch(hu)}async function XD(n,e){const t=At(n),r=e.batch.batchId;try{const i=await lD(t.localStore,e);MC(t,r,null),OC(t,r),t.sharedClientState.updateMutationState(r,"acknowledged"),await dm(t,i)}catch(i){await hu(i)}}async function JD(n,e,t){const r=At(n);try{const i=await function(o,l){const d=At(o);return d.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let m;return d.mutationQueue.lookupMutationBatch(f,l).next(y=>(it(y!==null,37113),m=y.keys(),d.mutationQueue.removeMutationBatch(f,y))).next(()=>d.mutationQueue.performConsistencyCheck(f)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(f,m,l)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,m)).next(()=>d.localDocuments.getDocuments(f,m))})}(r.localStore,e);MC(r,e,t),OC(r,e),r.sharedClientState.updateMutationState(e,"rejected",t),await dm(r,i)}catch(i){await hu(i)}}function OC(n,e){(n.Ru.get(e)||[]).forEach(t=>{t.resolve()}),n.Ru.delete(e)}function MC(n,e,t){const r=At(n);let i=r.Au[r.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),r.Au[r.currentUser.toKey()]=i}}function dx(n,e,t=null){n.sharedClientState.removeLocalQueryTarget(e);for(const r of n.Pu.get(e))n.hu.delete(r),t&&n.lu.gu(r,t);n.Pu.delete(e),n.isPrimaryClient&&n.du.Hr(e).forEach(r=>{n.du.containsKey(r)||DC(n,r)})}function DC(n,e){n.Tu.delete(e.path.canonicalString());const t=n.Iu.get(e);t!==null&&(_b(n.remoteStore,t),n.Iu=n.Iu.remove(e),n.Eu.delete(t),Cb(n))}function eS(n,e,t){for(const r of t)r instanceof CC?(n.du.addReference(r.key,e),eL(n,r)):r instanceof PC?(Me(kb,"Document no longer in limbo: "+r.key),n.du.removeReference(r.key,e),n.du.containsKey(r.key)||DC(n,r.key)):et(19791,{pu:r})}function eL(n,e){const t=e.key,r=t.path.canonicalString();n.Iu.get(t)||n.Tu.has(r)||(Me(kb,"New document in limbo: "+t),n.Tu.add(r),Cb(n))}function Cb(n){for(;n.Tu.size>0&&n.Iu.size<n.maxConcurrentLimboResolutions;){const e=n.Tu.values().next().value;n.Tu.delete(e);const t=new qe(on.fromString(e)),r=n.Vu.next();n.Eu.set(r,new qD(t)),n.Iu=n.Iu.insert(t,r),TC(n.remoteStore,new va(Ts(sm(t.path)),r,"TargetPurposeLimboResolution",ws.le))}}async function dm(n,e,t){const r=At(n),i=[],s=[],o=[];r.hu.isEmpty()||(r.hu.forEach((l,d)=>{o.push(r.fu(d,e,t).then(f=>{var m;if((f||t)&&r.isPrimaryClient){const y=f?!f.fromCache:(m=t==null?void 0:t.targetChanges.get(d.targetId))===null||m===void 0?void 0:m.current;r.sharedClientState.updateQueryState(d.targetId,y?"current":"not-current")}if(f){i.push(f);const y=yb.Rs(d.targetId,f);s.push(y)}}))}),await Promise.all(o),r.lu.Y_(i),await async function(d,f){const m=At(d);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>_e.forEach(f,g=>_e.forEach(g.ds,_=>m.persistence.referenceDelegate.addReference(y,g.targetId,_)).next(()=>_e.forEach(g.As,_=>m.persistence.referenceDelegate.removeReference(y,g.targetId,_)))))}catch(y){if(!ec(y))throw y;Me(vb,"Failed to update sequence numbers: "+y)}for(const y of f){const g=y.targetId;if(!y.fromCache){const _=m.xs.get(g),E=_.snapshotVersion,x=_.withLastLimboFreeSnapshotVersion(E);m.xs=m.xs.insert(g,x)}}}(r.localStore,s))}async function tL(n,e){const t=At(n);if(!t.currentUser.isEqual(e)){Me(kb,"User change. New user:",e.toKey());const r=await _C(t.localStore,e);t.currentUser=e,function(s,o){s.Ru.forEach(l=>{l.forEach(d=>{d.reject(new Ue(Ie.CANCELLED,o))})}),s.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await dm(t,r.ks)}}function nL(n,e){const t=At(n),r=t.Eu.get(e);if(r&&r.cu)return Ft().add(r.key);{let i=Ft();const s=t.Pu.get(e);if(!s)return i;for(const o of s){const l=t.hu.get(o);i=i.unionWith(l.view.eu)}return i}}function LC(n){const e=At(n);return e.remoteStore.remoteSyncer.applyRemoteEvent=jC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=nL.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=QD.bind(null,e),e.lu.Y_=VD.bind(null,e.eventManager),e.lu.gu=zD.bind(null,e.eventManager),e}function FC(n){const e=At(n);return e.remoteStore.remoteSyncer.applySuccessfulWrite=XD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=JD.bind(null,e),e}class Ff{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Iy(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return vC(this.persistence,new yC,e.initialUser,this.serializer)}Su(e){return new pb(Ny.fi,this.serializer)}bu(e){return new bC}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Ff.provider={build:()=>new Ff};class rL extends Ff{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){it(this.persistence.referenceDelegate instanceof Fg,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new hC(r,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?Gr.withCacheSize(this.cacheSizeBytes):Gr.DEFAULT;return new pb(r=>Fg.fi(r,t),this.serializer)}}class iL extends Ff{constructor(e,t,r){super(),this.Fu=e,this.cacheSizeBytes=t,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Fu.initialize(this,e),await FC(this.Fu.syncEngine),await um(this.Fu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}Du(e){return vC(this.persistence,new yC,e.initialUser,this.serializer)}vu(e,t){const r=this.persistence.referenceDelegate.garbageCollector;return new hC(r,e.asyncQueue,t)}Cu(e,t){const r=new lM(t,this.persistence);return new aM(e.asyncQueue,r)}Su(e){const t=iD(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Gr.withCacheSize(this.cacheSizeBytes):Gr.DEFAULT;return new gb(this.synchronizeTabs,t,e.clientId,r,e.asyncQueue,_D(),lg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}bu(e){return new bC}}class zg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>JT(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=tL.bind(null,this.syncEngine),await DD(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new FD}()}createDatastore(e){const t=Iy(e.databaseInfo.databaseId),r=function(s){return new vD(s)}(e.databaseInfo);return function(s,o,l,d){return new ED(s,o,l,d)}(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return function(r,i,s,o,l){return new SD(r,i,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,t=>JT(this.syncEngine,t,0),function(){return GT.C()?new GT:new mD}())}createSyncEngine(e,t){return function(i,s,o,l,d,f,m){const y=new HD(i,s,o,l,d,f);return m&&(y.mu=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=At(i);Me(su,"RemoteStore shutting down."),s.da.add(5),await cm(s),s.Ra.shutdown(),s.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}zg.provider={build:()=>new zg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):ui("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $l="FirestoreClient";class sL{constructor(e,t,r,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=Pr.UNAUTHENTICATED,this.clientId=Z4.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(r,async o=>{Me($l,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Me($l,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new oo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const r=Tb(t,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Iv(n,e){n.asyncQueue.verifyOperationInProgress(),Me($l,"Initializing OfflineComponentProvider");const t=n.configuration;await e.initialize(t);let r=t.initialUser;n.setCredentialChangeListener(async i=>{r.isEqual(i)||(await _C(e.localStore,i),r=i)}),e.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=e}async function tS(n,e){n.asyncQueue.verifyOperationInProgress();const t=await oL(n);Me($l,"Initializing OnlineComponentProvider"),await e.initialize(t,n.configuration),n.setCredentialChangeListener(r=>YT(e.remoteStore,r)),n.setAppCheckTokenChangeListener((r,i)=>YT(e.remoteStore,i)),n._onlineComponents=e}async function oL(n){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){Me($l,"Using user provided OfflineComponentProvider");try{await Iv(n,n._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===Ie.FAILED_PRECONDITION||i.code===Ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;Xc("Error using user provided cache. Falling back to memory cache: "+t),await Iv(n,new Ff)}}else Me($l,"Using default OfflineComponentProvider"),await Iv(n,new rL(void 0));return n._offlineComponents}async function Rb(n){return n._onlineComponents||(n._uninitializedComponentsProvider?(Me($l,"Using user provided OnlineComponentProvider"),await tS(n,n._uninitializedComponentsProvider._online)):(Me($l,"Using default OnlineComponentProvider"),await tS(n,new zg))),n._onlineComponents}function aL(n){return Rb(n).then(e=>e.syncEngine)}function lL(n){return Rb(n).then(e=>e.datastore)}async function Bg(n){const e=await Rb(n),t=e.eventManager;return t.onListen=$D.bind(null,e.syncEngine),t.onUnlisten=KD.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=WD.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=YD.bind(null,e.syncEngine),t}function cL(n,e,t={}){const r=new oo;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,l,d,f){const m=new Pb({next:g=>{m.xu(),o.enqueueAndForget(()=>Ab(s,y));const _=g.docs.has(l);!_&&g.fromCache?f.reject(new Ue(Ie.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&g.fromCache&&d&&d.source==="server"?f.reject(new Ue(Ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(g)},error:g=>f.reject(g)}),y=new Ib(sm(l.path),m,{includeMetadataChanges:!0,Qa:!0});return Sb(s,y)}(await Bg(n),n.asyncQueue,e,t,r)),r.promise}function uL(n,e,t={}){const r=new oo;return n.asyncQueue.enqueueAndForget(async()=>function(s,o,l,d,f){const m=new Pb({next:g=>{m.xu(),o.enqueueAndForget(()=>Ab(s,y)),g.fromCache&&d.source==="server"?f.reject(new Ue(Ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(g)},error:g=>f.reject(g)}),y=new Ib(l,m,{includeMetadataChanges:!0,Qa:!0});return Sb(s,y)}(await Bg(n),n.asyncQueue,e,t,r)),r.promise}function dL(n,e,t){const r=new oo;return n.asyncQueue.enqueueAndForget(async()=>{try{const i=await lL(n);r.resolve(async function(o,l,d){var f;const m=At(o),{request:y,yt:g,parent:_}=T6(m.serializer,ZM(l),d);m.connection.Uo||delete y.parent;const E=(await m.Yo("RunAggregationQuery",m.serializer.databaseId,_,y,1)).filter(w=>!!w.result);it(E.length===1,64727);const x=(f=E[0].result)===null||f===void 0?void 0:f.aggregateFields;return Object.keys(x).reduce((w,S)=>(w[g[S]]=x[S],w),{})}(i,e,t))}catch(i){r.reject(i)}}),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VC(n){const e={};return n.timeoutSeconds!==void 0&&(e.timeoutSeconds=n.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nS=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zC(n,e,t){if(!t)throw new Ue(Ie.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${e}.`)}function hL(n,e,t,r){if(e===!0&&r===!0)throw new Ue(Ie.INVALID_ARGUMENT,`${n} and ${t} cannot be used together.`)}function rS(n){if(!qe.isDocumentKey(n))throw new Ue(Ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function iS(n){if(qe.isDocumentKey(n))throw new Ue(Ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Cy(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(n);return e?`a custom ${e} object`:"an object"}}return typeof n=="function"?"a function":et(12329,{type:typeof n})}function jr(n,e){if("_delegate"in n&&(n=n._delegate),!(n instanceof e)){if(e.name===n.constructor.name)throw new Ue(Ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=Cy(n);throw new Ue(Ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return n}function fL(n,e){if(e<=0)throw new Ue(Ie.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BC="firestore.googleapis.com",sS=!0;class oS{constructor(e){var t,r;if(e.host===void 0){if(e.ssl!==void 0)throw new Ue(Ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=BC,this.ssl=sS}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:sS;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=lC;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<B6)throw new Ue(Ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}hL("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=VC((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Ue(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Ue(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Ue(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,i){return r.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Py{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new oS({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ue(Ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ue(Ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new oS(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new YO;switch(r.type){case"firstParty":return new JO(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new Ue(Ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const r=nS.get(t);r&&(Me("ComponentProvider","Removing Datastore"),nS.delete(t),r.terminate())}(this),Promise.resolve()}}function mL(n,e,t,r={}){var i;n=jr(n,Py);const s=uu(e),o=n._getSettings(),l=Object.assign(Object.assign({},o),{emulatorOptions:n._getEmulatorOptions()}),d=`${e}:${t}`;s&&(jx(`https://${d}`),Ox("Firestore",!0)),o.host!==BC&&o.host!==d&&Xc("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f=Object.assign(Object.assign({},o),{host:d,ssl:s,emulatorOptions:r});if(!zl(f,l)&&(n._setSettings(f),r.mockUserToken)){let m,y;if(typeof r.mockUserToken=="string")m=r.mockUserToken,y=Pr.MOCK_USER;else{m=i5(r.mockUserToken,(i=n._app)===null||i===void 0?void 0:i.options.projectId);const g=r.mockUserToken.sub||r.mockUserToken.user_id;if(!g)throw new Ue(Ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new Pr(g)}n._authCredentials=new ZO(new K4(m,y))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ra(this.firestore,e,this._query)}}class Xr{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Fl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Xr(this.firestore,e,this._key)}}class Fl extends Ra{constructor(e,t,r){super(e,t,sm(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Xr(this.firestore,null,new qe(e))}withConverter(e){return new Fl(this.firestore,e,this._path)}}function ct(n,e,...t){if(n=Rn(n),zC("collection","path",e),n instanceof Py){const r=on.fromString(e,...t);return iS(r),new Fl(n,null,r)}{if(!(n instanceof Xr||n instanceof Fl))throw new Ue(Ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(on.fromString(e,...t));return iS(r),new Fl(n.firestore,null,r)}}function Wt(n,e,...t){if(n=Rn(n),arguments.length===1&&(e=Z4.newId()),zC("doc","path",e),n instanceof Py){const r=on.fromString(e,...t);return rS(r),new Xr(n,null,new qe(r))}{if(!(n instanceof Xr||n instanceof Fl))throw new Ue(Ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=n._path.child(on.fromString(e,...t));return rS(r),new Xr(n.firestore,n instanceof Fl?n.converter:null,new qe(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aS="AsyncQueue";class lS{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new wC(this,"async_queue_retry"),this.rc=()=>{const r=lg();r&&Me(aS,"Visibility state changed to "+r.visibilityState),this.x_.b_()},this.sc=e;const t=lg();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=lg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new oo;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!ec(e))throw e;Me(aS,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(r=>{throw this.Xu=r,this.ec=!1,ui("INTERNAL UNHANDLED ERROR: ",cS(r)),r}).then(r=>(this.ec=!1,r))));return this.sc=t,t}enqueueAfterDelay(e,t,r){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const i=Eb.createAndSchedule(this,e,t,r,s=>this.uc(s));return this.Zu.push(i),i}oc(){this.Xu&&et(47125,{cc:cS(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,r)=>t.targetTimeMs-r.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function cS(n){let e=n.message||"";return n.stack&&(e=n.stack.includes(n.message)?n.stack:n.message+`
`+n.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uS(n){return function(t,r){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of r)if(s in i&&typeof i[s]=="function")return!0;return!1}(n,["next","error","complete"])}class Ns extends Py{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new lS,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new lS(e),this._firestoreClient=void 0,await e}}}function pL(n,e){const t=typeof n=="object"?n:cy(),r=typeof n=="string"?n:kg,i=ly(t,"firestore").getImmediate({identifier:r});if(!i._initialized){const s=WI("firestore");s&&mL(i,...s)}return i}function Ld(n){if(n._terminated)throw new Ue(Ie.FAILED_PRECONDITION,"The client has already been terminated.");return n._firestoreClient||UC(n),n._firestoreClient}function UC(n){var e,t,r;const i=n._freezeSettings(),s=function(l,d,f,m){return new FM(l,d,f,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,VC(m.experimentalLongPollingOptions),m.useFetchStreams,m.isUsingEmulator)}(n._databaseId,((e=n._app)===null||e===void 0?void 0:e.options.appId)||"",n._persistenceKey,i);n._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((r=i.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(n._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),n._firestoreClient=new sL(n._authCredentials,n._appCheckCredentials,n._queue,s,n._componentsProvider&&function(l){const d=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(d),_online:d}}(n._componentsProvider))}function gL(n,e){Xc("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=n._freezeSettings();return yL(n,zg.provider,{build:r=>new iL(r,t.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function yL(n,e,t){if((n=jr(n,Ns))._firestoreClient||n._terminated)throw new Ue(Ie.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(n._componentsProvider||n._getSettings().localCache)throw new Ue(Ie.FAILED_PRECONDITION,"SDK cache is already specified.");n._componentsProvider={_online:e,_offline:t},UC(n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vL{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class _L{constructor(e,t,r){this._userDataWriter=t,this._data=r,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Id(rr.fromBase64String(e))}catch(t){throw new Ue(Ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Id(rr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fd{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ue(Ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Fn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function xL(){return new Fd(q_)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ue(Ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ue(Ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return xt(this._lat,e._lat)||xt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ob{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,i){if(r.length!==i.length)return!1;for(let s=0;s<r.length;++s)if(r[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bL=/^__.*__$/;class wL{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return this.fieldMask!==null?new Pa(e,this.data,this.fieldMask,t,this.fieldTransforms):new Md(e,this.data,t,this.fieldTransforms)}}class qC{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return new Pa(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function HC(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw et(40011,{Ic:n})}}class Ry{constructor(e,t,r,i,s,o){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,s===void 0&&this.Ec(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new Ry(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.dc({path:r,Rc:!1});return i.Vc(e),i}mc(e){var t;const r=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.dc({path:r,Rc:!1});return i.Ec(),i}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return Ug(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(HC(this.Ic)&&bL.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class EL{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||Iy(e)}bc(e,t,r,i=!1){return new Ry({Ic:e,methodName:t,wc:r,path:Fn.emptyPath(),Rc:!1,yc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function fm(n){const e=n._freezeSettings(),t=Iy(n._databaseId);return new EL(n._databaseId,!!e.ignoreUndefinedProperties,t)}function Mb(n,e,t,r,i,s={}){const o=n.bc(s.merge||s.mergeFields?2:0,e,t,i);Fb("Data must be an object, but it was:",o,r);const l=GC(r,o);let d,f;if(s.merge)d=new Li(o.fieldMask),f=o.fieldTransforms;else if(s.mergeFields){const m=[];for(const y of s.mergeFields){const g=hx(e,y,t);if(!o.contains(g))throw new Ue(Ie.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);YC(m,g)||m.push(g)}d=new Li(m),f=o.fieldTransforms.filter(y=>d.covers(y.field))}else d=null,f=o.fieldTransforms;return new wL(new Kr(l),d,f)}class jy extends hm{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof jy}}function TL(n,e,t){return new Ry({Ic:3,wc:e.settings.wc,methodName:n._methodName,Rc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class Db extends hm{_toFieldTransform(e){return new sb(e.path,new Td)}isEqual(e){return e instanceof Db}}class Lb extends hm{constructor(e,t){super(e),this.Sc=t}_toFieldTransform(e){const t=TL(this,e,!0),r=this.Sc.map(s=>Vd(s,t)),i=new tu(r);return new sb(e.path,i)}isEqual(e){return e instanceof Lb&&zl(this.Sc,e.Sc)}}function $C(n,e,t,r){const i=n.bc(1,e,t);Fb("Data must be an object, but it was:",i,r);const s=[],o=Kr.empty();tc(r,(d,f)=>{const m=Vb(e,d,t);f=Rn(f);const y=i.mc(m);if(f instanceof jy)s.push(m);else{const g=Vd(f,y);g!=null&&(s.push(m),o.set(m,g))}});const l=new Li(s);return new qC(o,l,i.fieldTransforms)}function WC(n,e,t,r,i,s){const o=n.bc(1,e,t),l=[hx(e,r,t)],d=[i];if(s.length%2!=0)throw new Ue(Ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)l.push(hx(e,s[g])),d.push(s[g+1]);const f=[],m=Kr.empty();for(let g=l.length-1;g>=0;--g)if(!YC(f,l[g])){const _=l[g];let E=d[g];E=Rn(E);const x=o.mc(_);if(E instanceof jy)f.push(_);else{const w=Vd(E,x);w!=null&&(f.push(_),m.set(_,w))}}const y=new Li(f);return new qC(m,y,o.fieldTransforms)}function SL(n,e,t,r=!1){return Vd(t,n.bc(r?4:3,e))}function Vd(n,e){if(KC(n=Rn(n)))return Fb("Unsupported field value:",e,n),GC(n,e);if(n instanceof hm)return function(r,i){if(!HC(i.Ic))throw i.gc(`${r._methodName}() can only be used with update() and set()`);if(!i.path)throw i.gc(`${r._methodName}() is not currently supported inside arrays`);const s=r._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(n,e),null;if(n===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),n instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(r,i){const s=[];let o=0;for(const l of r){let d=Vd(l,i.fc(o));d==null&&(d={nullValue:"NULL_VALUE"}),s.push(d),o++}return{arrayValue:{values:s}}}(n,e)}return function(r,i){if((r=Rn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return i6(i.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const s=Ot.fromDate(r);return{timestampValue:Ad(i.serializer,s)}}if(r instanceof Ot){const s=new Ot(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Ad(i.serializer,s)}}if(r instanceof jb)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Id)return{bytesValue:Gk(i.serializer,r._byteString)};if(r instanceof Xr){const s=i.databaseId,o=r.firestore._databaseId;if(!o.isEqual(s))throw i.gc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:ub(r.firestore._databaseId||i.databaseId,r._key.path)}}if(r instanceof Ob)return function(o,l){return{mapValue:{fields:{[tb]:{stringValue:nb},[xd]:{arrayValue:{values:o.toArray().map(f=>{if(typeof f!="number")throw l.gc("VectorValues must only contain numeric values.");return ib(l.serializer,f)})}}}}}}(r,i);throw i.gc(`Unsupported field value: ${Cy(r)}`)}(n,e)}function GC(n,e){const t={};return hk(n)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):tc(n,(r,i)=>{const s=Vd(i,e.Ac(r));s!=null&&(t[r]=s)}),{mapValue:{fields:t}}}function KC(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ot||n instanceof jb||n instanceof Id||n instanceof Xr||n instanceof hm||n instanceof Ob)}function Fb(n,e,t){if(!KC(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const r=Cy(t);throw r==="an object"?e.gc(n+" a custom object"):e.gc(n+" "+r)}}function hx(n,e,t){if((e=Rn(e))instanceof Fd)return e._internalPath;if(typeof e=="string")return Vb(n,e);throw Ug("Field path arguments must be of type string or ",n,!1,void 0,t)}const AL=new RegExp("[~\\*/\\[\\]]");function Vb(n,e,t){if(e.search(AL)>=0)throw Ug(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,t);try{return new Fd(...e.split("."))._internalPath}catch{throw Ug(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,t)}}function Ug(n,e,t,r,i){const s=r&&!r.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let d="";return(s||o)&&(d+=" (found",s&&(d+=` in field ${r}`),o&&(d+=` in document ${i}`),d+=")"),new Ue(Ie.INVALID_ARGUMENT,l+n+d)}function YC(n,e){return n.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZC{constructor(e,t,r,i,s){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Xr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new NL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Oy("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class NL extends ZC{data(){return super.data()}}function Oy(n,e){return typeof e=="string"?Vb(n,e):e instanceof Fd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QC(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new Ue(Ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class zb{}class Bb extends zb{}function wt(n,e,...t){let r=[];e instanceof zb&&r.push(e),r=r.concat(t),function(s){const o=s.filter(d=>d instanceof Ub).length,l=s.filter(d=>d instanceof My).length;if(o>1||o>0&&l>0)throw new Ue(Ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)n=i._apply(n);return n}class My extends Bb{constructor(e,t,r){super(),this._field=e,this._op=t,this._value=r,this.type="where"}static _create(e,t,r){return new My(e,t,r)}_apply(e){const t=this._parse(e);return XC(e._query,t),new Ra(e.firestore,e.converter,ex(e._query,t))}_parse(e){const t=fm(e.firestore);return function(s,o,l,d,f,m,y){let g;if(f.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new Ue(Ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){hS(y,m);const E=[];for(const x of y)E.push(dS(d,s,x));g={arrayValue:{values:E}}}else g=dS(d,s,y)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||hS(y,m),g=SL(l,o,y,m==="in"||m==="not-in");return qt.create(f,m,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function bt(n,e,t){const r=e,i=Oy("where",n);return My._create(i,r,t)}class Ub extends zb{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Ub(e,t)}_parse(e){const t=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return t.length===1?t[0]:mn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i;const l=s.getFlattenedFilters();for(const d of l)XC(o,d),o=ex(o,d)}(e._query,t),new Ra(e.firestore,e.converter,ex(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class qb extends Bb{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new qb(e,t)}_apply(e){const t=function(i,s,o){if(i.startAt!==null)throw new Ue(Ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Ue(Ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Df(s,o)}(e._query,this._field,this._direction);return new Ra(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Od(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function Jr(n,e="asc"){const t=e,r=Oy("orderBy",n);return qb._create(r,t)}class Hb extends Bb{constructor(e,t,r){super(),this.type=e,this._limit=t,this._limitType=r}static _create(e,t,r){return new Hb(e,t,r)}_apply(e){return new Ra(e.firestore,e.converter,Rg(e._query,this._limit,this._limitType))}}function Vf(n){return fL("limit",n),Hb._create("limit",n,"F")}function dS(n,e,t){if(typeof(t=Rn(t))=="string"){if(t==="")throw new Ue(Ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!kk(e)&&t.indexOf("/")!==-1)throw new Ue(Ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const r=e.path.child(on.fromString(t));if(!qe.isDocumentKey(r))throw new Ue(Ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Of(n,new qe(r))}if(t instanceof Xr)return Of(n,t._key);throw new Ue(Ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Cy(t)}.`)}function hS(n,e){if(!Array.isArray(n)||n.length===0)throw new Ue(Ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function XC(n,e){const t=function(i,s){for(const o of i)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(n.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new Ue(Ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ue(Ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class IL{convertValue(e,t="none"){switch(Ul(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Pn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Ta(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw et(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const r={};return tc(e,(i,s)=>{r[i]=this.convertValue(s,t)}),r}convertVectorValue(e){var t,r,i;const s=(i=(r=(t=e.fields)===null||t===void 0?void 0:t[xd].arrayValue)===null||r===void 0?void 0:r.values)===null||i===void 0?void 0:i.map(o=>Pn(o.doubleValue));return new Ob(s)}convertGeoPoint(e){return new jb(Pn(e.latitude),Pn(e.longitude))}convertArray(e,t){return(e.values||[]).map(r=>this.convertValue(r,t))}convertServerTimestamp(e,t){switch(t){case"previous":const r=_y(e);return r==null?null:this.convertValue(r,t);case"estimate":return this.convertTimestamp(Rf(e));default:return null}}convertTimestamp(e){const t=Ea(e);return new Ot(t.seconds,t.nanos)}convertDocumentKey(e,t){const r=on.fromString(e);it(nC(r),9688,{name:e});const i=new Jc(r.get(1),r.get(3)),s=new qe(r.popFirst(5));return i.isEqual(t)||ui(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $b(n,e,t){let r;return r=n?t&&(t.merge||t.mergeFields)?n.toFirestore(e,t):n.toFirestore(e):e,r}function kL(){return new vL("count")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yh{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class JC extends ZC{constructor(e,t,r,i,s,o){super(e,t,r,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new cg(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const r=this._document.data.field(Oy("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}}class cg extends JC{data(e={}){return super.data(e)}}class eP{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new Yh(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new cg(this._firestore,this._userDataWriter,r.key,r,new Yh(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ue(Ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const d=new cg(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Yh(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:d,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const d=new cg(i._firestore,i._userDataWriter,l.doc.key,l.doc,new Yh(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let f=-1,m=-1;return l.type!==0&&(f=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),m=o.indexOf(l.doc.key)),{type:CL(l.type),doc:d,oldIndex:f,newIndex:m}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function CL(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return et(61501,{type:n})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ou(n){n=jr(n,Xr);const e=jr(n.firestore,Ns);return cL(Ld(e),n._key).then(t=>nP(e,n,t))}class Dy extends IL{constructor(e){super(),this.firestore=e}convertBytes(e){return new Id(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Xr(this.firestore,null,t)}}function Tt(n){n=jr(n,Ra);const e=jr(n.firestore,Ns),t=Ld(e),r=new Dy(e);return QC(n._query),uL(t,n._query).then(i=>new eP(e,r,n,i))}function PL(n,e,t){n=jr(n,Xr);const r=jr(n.firestore,Ns),i=$b(n.converter,e,t);return pm(r,[Mb(fm(r),"setDoc",n._key,i,n.converter!==null,t).toMutation(n._key,dr.none())])}function Ds(n,e,t,...r){n=jr(n,Xr);const i=jr(n.firestore,Ns),s=fm(i);let o;return o=typeof(e=Rn(e))=="string"||e instanceof Fd?WC(s,"updateDoc",n._key,e,t,r):$C(s,"updateDoc",n._key,e),pm(i,[o.toMutation(n._key,dr.exists(!0))])}function mm(n){return pm(jr(n.firestore,Ns),[new am(n._key,dr.none())])}function zd(n,e){const t=jr(n.firestore,Ns),r=Wt(n),i=$b(n.converter,e);return pm(t,[Mb(fm(n.firestore),"addDoc",r._key,i,n.converter!==null,{}).toMutation(r._key,dr.exists(!1))]).then(()=>r)}function tP(n,...e){var t,r,i;n=Rn(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||uS(e[o])||(s=e[o],o++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(uS(e[o])){const y=e[o];e[o]=(t=y.next)===null||t===void 0?void 0:t.bind(y),e[o+1]=(r=y.error)===null||r===void 0?void 0:r.bind(y),e[o+2]=(i=y.complete)===null||i===void 0?void 0:i.bind(y)}let d,f,m;if(n instanceof Xr)f=jr(n.firestore,Ns),m=sm(n._key.path),d={next:y=>{e[o]&&e[o](nP(f,n,y))},error:e[o+1],complete:e[o+2]};else{const y=jr(n,Ra);f=jr(y.firestore,Ns),m=y._query;const g=new Dy(f);d={next:_=>{e[o]&&e[o](new eP(f,g,y,_))},error:e[o+1],complete:e[o+2]},QC(n._query)}return function(g,_,E,x){const w=new Pb(x),S=new Ib(_,w,E);return g.asyncQueue.enqueueAndForget(async()=>Sb(await Bg(g),S)),()=>{w.xu(),g.asyncQueue.enqueueAndForget(async()=>Ab(await Bg(g),S))}}(Ld(f),m,l,d)}function pm(n,e){return function(r,i){const s=new oo;return r.asyncQueue.enqueueAndForget(async()=>ZD(await aL(r),i,s)),s.promise}(Ld(n),e)}function nP(n,e,t){const r=t.docs.get(e._key),i=new Dy(n);return new JC(n,i,e._key,r,new Yh(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qg(n){return RL(n,{count:kL()})}function RL(n,e){const t=jr(n.firestore,Ns),r=Ld(t),i=DM(e,(s,o)=>new d6(o,s.aggregateType,s._internalFieldPath));return dL(r,n._query,i).then(s=>function(l,d,f){const m=new Dy(l);return new _L(d,m,f)}(t,n,s))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jL{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=fm(e)}set(e,t,r){this._verifyNotCommitted();const i=kv(e,this._firestore),s=$b(i.converter,t,r),o=Mb(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,r);return this._mutations.push(o.toMutation(i._key,dr.none())),this}update(e,t,r,...i){this._verifyNotCommitted();const s=kv(e,this._firestore);let o;return o=typeof(t=Rn(t))=="string"||t instanceof Fd?WC(this._dataReader,"WriteBatch.update",s._key,t,r,i):$C(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,dr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=kv(e,this._firestore);return this._mutations=this._mutations.concat(new am(t._key,dr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ue(Ie.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function kv(n,e){if((n=Rn(n)).firestore!==e)throw new Ue(Ie.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}function Hn(){return new Db("serverTimestamp")}function OL(...n){return new Lb("arrayUnion",n)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nc(n){return Ld(n=jr(n,Ns)),new jL(n,e=>pm(n,e))}(function(e,t=!0){(function(i){jd=i})(Rd),Kc(new Bl("firestore",(r,{instanceIdentifier:i,options:s})=>{const o=r.getProvider("app").getImmediate(),l=new Ns(new QO(r.getProvider("auth-internal")),new eM(o,r.getProvider("app-check-internal")),function(f,m){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new Ue(Ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Jc(f.options.projectId,m)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),ko($E,WE,e),ko($E,WE,"esm2017")})();var ML="firebase",DL="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ko(ML,DL,"app");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rP="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LL{constructor(e,t,r,i){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,ci(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||t.get().then(s=>this.auth=s,()=>{}),this.messaging||r.get().then(s=>this.messaging=s,()=>{}),this.appCheck||i==null||i.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),r=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:t,messagingToken:r,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fx="us-central1";class FL{constructor(e,t,r,i,s=fx,o=(...l)=>fetch(...l)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new LL(e,t,r,i),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(s);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=fx}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function VL(n,e,t){const r=uu(e);n.emulatorOrigin=`http${r?"s":""}://${e}:${t}`,r&&(jx(n.emulatorOrigin),Ox("Functions",!0))}const fS="@firebase/functions",mS="0.12.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zL="auth-internal",BL="app-check-internal",UL="messaging-internal";function qL(n){const e=(t,{instanceIdentifier:r})=>{const i=t.getProvider("app").getImmediate(),s=t.getProvider(zL),o=t.getProvider(UL),l=t.getProvider(BL);return new FL(i,s,o,l,r)};Kc(new Bl(rP,e,"PUBLIC").setMultipleInstances(!0)),ko(fS,mS,n),ko(fS,mS,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HL(n=cy(),e=fx){const r=ly(Rn(n),rP).getImmediate({identifier:e}),i=WI("functions");return i&&$L(r,...i),r}function $L(n,e,t){VL(Rn(n),e,t)}qL();const WL={apiKey:"",authDomain:"",projectId:"agwa-wsi",storageBucket:"",messagingSenderId:"",appId:"",measurementId:""};let zf;v7().length?zf=cy():zf=t4(WL);const Sh=z4(zf),en=pL(zf);HL(zf);console.log(" Connecting to Production Firebase Services ");gL(en,{}).then(()=>{console.log("Firestore offline persistence enabled for multiple tabs.")}).catch(n=>{n.code==="failed-precondition"?console.warn("Firestore offline persistence failed: Multiple tabs open or other issues."):n.code==="unimplemented"?console.warn("Firestore offline persistence failed: Browser does not support all features."):console.warn("Firestore persistence error:",n.message)});const GL=()=>"users",mu=n=>`${GL()}/${n}/profile/data`,rc=()=>"public/data",ir=()=>`${rc()}/profiles`,ic=()=>`${rc()}/support_tickets`,Ly=n=>`${ic()}/${n}`,gm=()=>`${rc()}/announcements`,iP=n=>`${gm()}/${n}`,ym=()=>`${rc()}/system_config/settings`,Fi=()=>`${rc()}/all_bills`,pS=n=>`${Fi()}/${n}`,Lo=()=>`${rc()}/all_meter_readings`,sP=n=>`${Lo()}/${n}`,Wl=()=>`${rc()}/meter_routes`,pu=()=>`${rc()}/service_interruptions`,oP=n=>`${pu()}/${n}`,sc=n=>{let e=n.message||"An unknown authentication error occurred.";return n.code&&(e=n.code.replace("auth/","").replace(/-/g," "),e=e.charAt(0).toUpperCase()+e.slice(1)+".",(n.code==="auth/invalid-credential"||n.code==="auth/wrong-password"||n.code==="auth/user-not-found")&&(e="Invalid credentials. Please check your email and password."),n.code==="auth/email-already-in-use"&&(e="This email address is already registered. Please try logging in.")),console.error("Auth Service Error:",n.code,n.message),e},KL=async(n,e,t)=>{try{return{success:!0,userCredential:await Cj(n,e,t)}}catch(r){return{success:!1,error:sc(r)}}},YL=async(n,e,t)=>{try{return{success:!0,userCredential:await Pj(n,e,t)}}catch(r){return{success:!1,error:sc(r)}}},ZL=async n=>{try{const e=new pa;return{success:!0,userCredential:await rO(n,e)}}catch(e){return{success:!1,error:sc(e)}}},QL=async(n,e,t)=>{try{return await Rj(n,e,t),window.localStorage.setItem("emailForSignIn",e),{success:!0,message:`Sign-in link sent to ${e}!`}}catch(r){return{success:!1,error:sc(r)}}},XL=async(n,e,t)=>{if(I4(n,t))try{const r=await jj(n,e,t);return window.localStorage.removeItem("emailForSignIn"),{success:!0,userCredential:r}}catch(r){return{success:!1,error:sc(r)}}return{success:!1,error:"Not a valid sign-in-with-email-link request."}},JL=async(n,e)=>{try{return await kj(n,e),{success:!0,message:"Password reset email sent!"}}catch(t){return{success:!1,error:sc(t)}}},e8=async n=>{try{return await Lj(n),{success:!0,message:"Logged out successfully."}}catch(e){return{success:!1,error:sc(e)}}},aP=(n,e,t='1/2"',r={})=>{let i=0,s=0,o=0,l=0,d=0,f=0,m=0,y=0;const g=parseFloat(n)||0,_={fcdaPercentage:1.29,environmentalChargePercentage:25,sewerageChargePercentageCommercial:32.85,governmentTaxPercentage:2,vatPercentage:12},E={..._,...r},x=(E.fcdaPercentage||_.fcdaPercentage)/100,w=(E.environmentalChargePercentage||_.environmentalChargePercentage)/100,S=(E.sewerageChargePercentageCommercial||_.sewerageChargePercentageCommercial)/100,N=(E.governmentTaxPercentage||_.governmentTaxPercentage)/100,P=(E.vatPercentage||_.vatPercentage)/100,I=String(t).replace(/["]/g,"").trim();if(I==="1/2"||I==="15mm"?d=1.5:I==="3/4"||I==="20mm"?d=2:I==="1"||I==="25mm"?d=3:I==="1 1/4"||I==="40mm"||I==="1 1/2"||I==="32mm"?d=4:I==="2"||I==="50mm"?d=6:I==="3"||I==="75mm"?d=10:I==="4"||I==="100mm"?d=20:I==="6"||I==="150mm"?d=35:I==="8"||I==="200mm"?d=50:d=1.5,e==="Residential Low-Income")if(g<=10)i=70.07;else if(g<=20)i=70.07+(g-10)*14.29;else{i=70.07+10*14.29;let k=g-20;k>0&&(k<=10?i+=k*23.82:k<=20?i+=10*23.82+(k-10)*45.17:i+=10*23.82+10*45.17+(k-20)*59.54)}else if(e==="Residential")g<=10?i=195.49:g<=20?i=195.49+(g-10)*23.82:g<=30?i=195.49+10*23.82+(g-20)*45.17:g<=50?i=195.49+10*23.82+10*45.17+(g-30)*59.54:g<=70?i=195.49+10*23.82+10*45.17+20*59.54+(g-50)*69.52:g<=90?i=195.49+10*23.82+10*45.17+20*59.54+20*69.52+(g-70)*72.89:g<=140?i=195.49+10*23.82+10*45.17+20*59.54+20*69.52+20*72.89+(g-90)*76.14:g<=200?i=195.49+10*23.82+10*45.17+20*59.54+20*69.52+20*72.89+50*76.14+(g-140)*79.42:i=195.49+10*23.82+10*45.17+20*59.54+20*69.52+20*72.89+50*76.14+60*79.42+(g-200)*82.67;else if(e==="Semi-Business")if(g<=10)i=195.49;else{i=195.49;let k=g-10;k<=10?i+=k*39.9:k<=30?i+=10*39.9+(k-10)*49.22:k<=50?i+=10*39.9+20*49.22+(k-30)*62.55:k<=70?i+=10*39.9+20*49.22+20*62.55+(k-50)*72.88:k<=120?i+=10*39.9+20*49.22+20*62.55+20*72.88+(k-70)*76.14:k<=170?i+=10*39.9+20*49.22+20*62.55+20*72.88+50*76.14+(k-120)*79.42:i+=10*39.9+20*49.22+20*62.55+20*72.88+50*76.14+50*79.42+(k-170)*82.67}else if(e==="Commercial"||e==="Admin"){const k=[{limit:10,rate:0,fixed:512.3},{limit:20,rate:53.61},{limit:40,rate:58.98},{limit:60,rate:64.33},{limit:80,rate:69.69},{limit:100,rate:72.88},{limit:150,rate:76.14},{limit:200,rate:79.42},{limit:1/0,rate:82.67}];let F=g;i=0,F>0&&k[0].fixed&&(i+=k[0].fixed,F-=k[0].limit);for(let O=1;O<k.length&&!(F<=0);O++){const C=k[O-1].limit,D=k[O].limit-C,M=Math.min(F,D);i+=M*k[O].rate,F-=M}}else e==="Industrial"||e==="Meter Reading Personnel"?i=g*72.68:g<=10?i=195.49:i=195.49+(g-10)*23.82;s=i*x,y=i+s,o=y*w,e==="Commercial"||e==="Industrial"||e==="Admin"||e==="Meter Reading Personnel"?l=y*S:l=0;const R=y+o+l+d;f=R*N;const U=R;m=U*P;const j=U+f+m;return{consumption:g,serviceType:e,meterSize:I,basicCharge:parseFloat(i.toFixed(2)),fcda:parseFloat(s.toFixed(2)),waterCharge:parseFloat(y.toFixed(2)),environmentalCharge:parseFloat(o.toFixed(2)),sewerageCharge:parseFloat(l.toFixed(2)),maintenanceServiceCharge:parseFloat(d.toFixed(2)),subTotalBeforeTaxes:parseFloat(U.toFixed(2)),governmentTaxes:parseFloat(f.toFixed(2)),vatableSales:parseFloat(U.toFixed(2)),vat:parseFloat(m.toFixed(2)),totalCalculatedCharges:parseFloat(j.toFixed(2))}},Wb=n=>{if(!n||typeof n!="string")return{serviceType:"Residential",role:"customer"};const e=n.toUpperCase().trim();return e.startsWith("ADM")?{serviceType:"Admin",role:"admin"}:e.startsWith("PER")?{serviceType:"Meter Reading Personnel",role:"meter_reader"}:e.startsWith("CLE")?{serviceType:"Clerk Operations",role:"clerk_cashier"}:e.startsWith("RES-LI")?{serviceType:"Residential Low-Income",role:"customer"}:e.startsWith("RES")?{serviceType:"Residential",role:"customer"}:e.startsWith("COM")?{serviceType:"Commercial",role:"customer"}:e.startsWith("IND")?{serviceType:"Industrial",role:"customer"}:{serviceType:"Residential",role:"customer"}},t8=n=>`https://placehold.co/100x100/3b82f6/FFFFFF?text=${n?n.charAt(0).toUpperCase():"A"}`,Zt=(n,e={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})=>{if(!n)return"N/A";let t;if(n.toDate&&typeof n.toDate=="function")t=n.toDate();else if(n instanceof Date)t=n;else if(typeof n=="string"||typeof n=="number")t=new Date(n);else return"Invalid Date";if(isNaN(t.getTime()))return"Invalid Date";try{return new Intl.DateTimeFormat("en-US",e).format(t)}catch{return"Invalid Date"}},st=(n,e)=>{console.error(`Firestore Error [${n}]:`,e.code,e.message,e.stack);let t=`An error occurred while ${n.replace(/([A-Z])/g," $1").toLowerCase()}. Code: ${e.code}.`;return e.code==="failed-precondition"?t=`Query failed: ${e.message}. This almost always means you are missing a Firestore index. Check the console logs (on your server or browser) for a link to create the required index.`:e.code==="permission-denied"?t+=" You don't have permission for this action. Check Firestore rules.":t+=" Please check your connection or contact support if the issue persists.",{success:!1,error:t}},n8=async(n,e,t)=>{if(!e||e.length===0)return{success:!0};try{const r=nc(n);return e.forEach(i=>{const s=Wt(n,Ly(i));r.update(s,{status:t,lastUpdatedAt:Hn()})}),await r.commit(),{success:!0,count:e.length}}catch(r){return st("batch updating ticket status",r)}},r8=async(n,e)=>{if(!e)return{success:!1,error:"User ID is required."};try{const t=nc(n),r=Wt(n,ir(),e),i=Wt(n,mu(e));return t.delete(r),t.delete(i),await t.commit(),{success:!0}}catch(t){return st(`deleting user profile ${e}`,t)}},Bd=async(n,e)=>{try{const t=await Tt(wt(ct(n,e),Vf(500)));if(t.empty)return{success:!0,count:0};let r=0,i=t;for(;!i.empty;){const s=nc(n);if(i.docs.forEach(o=>{s.delete(o.ref)}),await s.commit(),r+=i.size,i.size<500)break;i=await Tt(wt(ct(n,e),Vf(500)))}return{success:!0,count:r}}catch(t){return st(`deleting all from ${e}`,t)}},i8=n=>Bd(n,ic()),s8=n=>Bd(n,Fi()),o8=n=>Bd(n,Lo()),a8=n=>Bd(n,gm()),l8=n=>Bd(n,pu()),c8=n=>Bd(n,Wl()),u8=async n=>{try{const e=await Tt(wt(ct(n,ir())));if(e.empty)return{success:!0,count:0};const t=nc(n);return e.docs.forEach(r=>{t.delete(Wt(n,ir(),r.id)),t.delete(Wt(n,mu(r.id)))}),await t.commit(),{success:!0,count:e.size}}catch(e){return st("deleting all users",e)}},d8=async(n,e,t)=>{if(!t||!e)return{success:!1,error:"User ID and Account Number required."};const r=t.trim().toUpperCase();if(!r)return{success:!1,error:"Account Number cannot be empty."};try{const i=ct(n,ir()),s=wt(i,bt("accountNumber","==",r)),o=await Tt(s);if(o.empty)return{success:!1,error:`Account Number "${r}" not found.`};const l=o.docs[0],d=l.data(),f=l.id;if(f===e)return{success:!0};if(d.uid&&d.uid!==e)return{success:!1,error:"Account already linked to another user."};const{role:m,serviceType:y}=Wb(r),g={uid:e,accountNumber:r,role:m,serviceType:y,meterSerialNumber:d.meterSerialNumber||"",meterSize:d.meterSize||'1/2"',serviceAddress:d.serviceAddress||{}},_=nc(n);return _.update(Wt(n,ir(),f),g),_.update(Wt(n,mu(e)),g),await _.commit(),{success:!0}}catch(i){return st("linking account number",i)}},h8=async n=>{try{const e=ct(n,ir()),t=await Tt(e),r=new Set;return t.docs.forEach(i=>{var o;const s=(o=i.data().serviceAddress)==null?void 0:o.barangay;s&&r.add(s)}),{success:!0,data:Array.from(r).sort()}}catch(e){return st("getting unique service locations",e)}},f8=async(n,e)=>{if(!e)return{success:!0,data:[]};try{const t=ct(n,ir()),r=wt(t,bt("serviceAddress.barangay","==",e));return{success:!0,data:(await Tt(r)).docs.map(o=>o.data().accountNumber).filter(Boolean)}}catch(t){return st(`getting accounts in ${e}`,t)}},m8=async(n,e,t=null)=>{try{const r={...e,updatedAt:Hn()};return t?await Ds(Wt(n,Wl(),t),r):(r.createdAt=Hn(),await zd(ct(n,Wl()),r)),{success:!0}}catch(r){return st("saving meter route",r)}},p8=async n=>{try{const e=wt(ct(n,Wl()),Jr("name","asc"));return{success:!0,data:(await Tt(e)).docs.map(r=>({id:r.id,...r.data()}))}}catch(e){return st("getting all meter routes",e)}},g8=async(n,e)=>{try{return await mm(Wt(n,Wl(),e)),{success:!0}}catch(t){return st("deleting meter route",t)}},y8=async n=>{try{const e=wt(ct(n,ir()),bt("role","==","meter_reader"),Jr("displayName","asc"));return{success:!0,data:(await Tt(e)).docs.map(r=>({id:r.id,...r.data()}))}}catch(e){return st("getting all meter readers",e)}},v8=async n=>{try{const e=wt(ct(n,Fi()),bt("status","==","Paid")),t=await Tt(e),r={};t.forEach(s=>{var f;const o=s.data(),l=(f=o.paymentDate)!=null&&f.toDate?o.paymentDate.toDate():null;if(!l)return;const d=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`;r[d]=(r[d]||0)+(o.amountPaid||0)});const i=Object.entries(r).sort(([s],[o])=>s.localeCompare(o)).slice(-12);return{success:!0,data:Object.fromEntries(i)}}catch(e){return st("getting revenue stats",e)}},_8=async n=>{try{const e=wt(ct(n,Fi()),bt("status","==","Paid")),t=await Tt(e);if(t.empty)return{success:!0,data:{}};const r={},i=[...new Set(t.docs.map(o=>o.data().userId).filter(Boolean))],s={};for(let o=0;o<i.length;o+=30){const l=i.slice(o,o+30);if(l.length===0)continue;const d=wt(ct(n,ir()),bt(xL(),"in",l));(await Tt(d)).forEach(m=>s[m.id]=m.data())}return t.forEach(o=>{var m;const l=o.data(),d=s[l.userId];if(!d)return;const f=((m=d.serviceAddress)==null?void 0:m.barangay)||"Unknown Barangay";r[f]=(r[f]||0)+(l.amountPaid||0)}),{success:!0,data:r}}catch(e){return st("getting revenue by location",e)}},x8=async n=>{try{const e=wt(ct(n,Fi()),bt("status","==","Unpaid")),t=await Tt(e);let r=0;return t.forEach(i=>{r+=i.data().amount||0}),{success:!0,data:{totalOutstanding:r}}}catch(e){return st("getting outstanding balance",e)}},b8=async(n,e,t)=>{try{const r=wt(ct(n,Lo()),bt("readerId","==",e),bt("readingDateString","==",t));return{success:!0,data:{count:(await qg(r)).data().count}}}catch(r){return st("getting readings count by reader",r)}},w8=async(n,e)=>{const t=e==null?void 0:e.accountNumbers;if(!Array.isArray(t)||t.length===0)return{success:!0,data:[]};try{const r=ct(n,ir()),i=[];for(let s=0;s<t.length;s+=30){const o=t.slice(s,s+30);if(o.length===0)continue;const l=wt(r,bt("accountNumber","in",o));(await Tt(l)).forEach(f=>i.push({id:f.id,...f.data()}))}return{success:!0,data:i}}catch(r){return st("getting accounts in route",r)}},Hg=async(n,e)=>{if(!e)return{success:!1,error:"User ID required."};try{const t=Wt(n,ir(),e),r=await ou(t);if(r.exists())return{success:!0,data:{id:r.id,...r.data()}};{const i=Wt(n,mu(e)),s=await ou(i);return s.exists()?{success:!0,data:{id:s.id,...s.data()}}:{success:!1,error:"User profile not found."}}}catch(t){return st(`getting user profile ${e}`,t)}},Fy=async(n,e)=>{const t=e==null?void 0:e.trim().toLowerCase();if(!t)return{success:!1,error:"Search term required."};const r=e.trim().toUpperCase();try{const i=ct(n,ir()),s=[wt(i,bt("accountNumber","==",r)),wt(i,bt("email","==",t)),wt(i,bt("meterSerialNumber","==",r)),wt(i,Jr("displayNameLower"),bt("displayNameLower",">=",t),bt("displayNameLower","<=",t+""))],o=await Promise.allSettled(s.map(d=>Tt(d))),l=new Map;return o.forEach(d=>{d.status==="fulfilled"?d.value.forEach(f=>{l.has(f.id)||l.set(f.id,{id:f.id,...f.data()})}):console.error("Search query failed:",d.reason)}),{success:!0,data:Array.from(l.values())}}catch(i){return st("searching user profiles",i)}},lP=async(n,e,t)=>{if(!e||!t)return{success:!1,error:"User ID and profile required."};try{const r=wt(ct(n,Lo()),bt("userId","==",e),Jr("readingDate","desc"),Vf(2)),i=await Tt(r);if(i.docs.length<2)return{success:!1,error:"At least two readings needed."};const s=i.docs[0],o=i.docs[1],l=s.data(),d=o.data(),f=l.readingValue-d.readingValue;if(f<0)return{success:!1,error:"Latest reading is lower than previous."};const m=l.readingDate.toDate(),y=m.toLocaleString("en-US",{month:"long",year:"numeric"}),g=wt(ct(n,Fi()),bt("userId","==",e),bt("monthYear","==",y));if(!(await Tt(g)).empty)return{success:!1,error:`Bill for ${y} already exists.`};const E=await Gb(n),x=E.success?E.data:{},w=aP(f,t.serviceType,t.meterSize,x),S=new Date(m);S.setDate(S.getDate()+(x.latePaymentPenaltyDelayDays||15));const N={userId:e,accountNumber:t.accountNumber,userName:t.displayName,billingPeriod:`${gS(d.readingDate.toDate())} - ${gS(l.readingDate.toDate())}`,monthYear:y,billDate:Ot.fromDate(m),dueDate:Ot.fromDate(S),previousReading:d.readingValue,currentReading:l.readingValue,consumption:f,...w,amount:w.totalCalculatedCharges||0,previousUnpaidAmount:0,seniorCitizenDiscount:0,totalAmountDue:w.totalCalculatedCharges||0,status:"Unpaid",createdAt:Hn(),previousReadingId:o.id,currentReadingId:s.id},P=await zd(ct(n,Fi()),N);return await Ds(P,{billId:P.id}),{success:!0,message:`Bill for ${y} generated.`,billId:P.id}}catch(r){return st(`generating bill for ${t==null?void 0:t.accountNumber}`,r)}},gS=n=>n?n.toLocaleDateString("en-CA"):"N/A",E8=async(n,e)=>{if(!e)return{success:!1,error:"Location required."};try{const t=ct(n,pu()),r=wt(t,bt("affectedAreas","array-contains",e),bt("status","in",["Scheduled","Ongoing"]),bt("isBillingPaused","==",!0));if(!(await Tt(r)).empty)return{success:!0,data:[]};const s=wt(ct(n,ir()),bt("serviceAddress.barangay","==",e)),o=await Tt(s);if(o.empty)return{success:!0,data:[]};const l=[],d=new Date;d.setDate(d.getDate()-30);for(const f of o.docs){const m={id:f.id,...f.data()};if(!m.accountNumber)continue;const y=wt(ct(n,Lo()),bt("userId","==",m.id),Jr("readingDate","desc"),Vf(2)),g=await Tt(y);if(g.docs.length<2)continue;const E=g.docs[0].data().readingDate.toDate().toLocaleString("default",{month:"long",year:"numeric"}),x=wt(ct(n,Fi()),bt("userId","==",m.id),bt("monthYear","==",E),Vf(1));(await Tt(x)).empty&&l.push(m)}return{success:!0,data:l}}catch(t){return st(`getting billable accounts in ${e}`,t)}},T8=async(n,e)=>{const t=[];let r=0,i=0;for(const s of e){const o=await lP(n,s.id,s);t.push({success:o.success,message:`${o.success?"SUCCESS":"FAILED"} [${s.accountNumber}]: ${o.message||o.error}`}),o.success?r++:i++}return{logs:t,successCount:r,failCount:i}},S8=async(n,e,t)=>{if(!e)return{success:!1,error:"User ID required."};try{const r=nc(n),i={...t,accountNumber:t.accountNumber?t.accountNumber.toUpperCase():"",uid:e,createdAt:Hn(),lastLoginAt:Hn(),displayNameLower:t.displayName?t.displayName.toLowerCase():"",rebatePoints:0,rebateTier:"Bronze"};return r.set(Wt(n,mu(e)),i),r.set(Wt(n,ir(),e),i),await r.commit(),{success:!0}}catch(r){return st("creating user profile",r)}},Zh=async(n,e,t)=>{if(!e)return{success:!1,error:"User ID required."};try{const r=nc(n),i={...t,updatedAt:Hn()};return i.accountNumber&&(i.accountNumber=i.accountNumber.toUpperCase()),i.displayName&&(i.displayNameLower=i.displayName.toLowerCase()),r.update(Wt(n,mu(e)),i),r.update(Wt(n,ir(),e),i),await r.commit(),{success:!0}}catch(r){return st(`updating user profile ${e}`,r)}},A8=async n=>{try{return{success:!0,data:(await Tt(wt(ct(n,ir()),Jr("displayNameLower","asc")))).docs.map(t=>({id:t.id,...t.data()}))}}catch(e){return st("getting all users profiles",e)}},N8=async(n,e)=>{try{const t=await zd(ct(n,ic()),{...e,status:"Open",submittedAt:Hn(),lastUpdatedAt:Hn(),conversation:[]});return await Ds(t,{ticketId:t.id}),{success:!0,id:t.id}}catch(t){return st("creating support ticket",t)}},I8=async(n,e)=>{try{return await mm(Wt(n,Ly(e))),{success:!0}}catch(t){return st("deleting support ticket",t)}},cP=async(n,e,t)=>{var r;if(!e||!(t!=null&&t.text))return{success:!1,error:"Ticket ID and reply text required."};try{const i=Wt(n,Ly(e)),s={conversation:OL(t),lastUpdatedAt:Hn()},l=(r=(await ou(i)).data())==null?void 0:r.status;return t.authorRole!=="admin"&&(l==="Resolved"||l==="Closed")?s.status="Open":(t.authorRole==="admin"&&l==="Open"||t.authorRole!=="admin"&&l==="Awaiting Customer")&&(s.status="In Progress"),await Ds(i,s),{success:!0}}catch(i){return st("adding ticket reply",i)}},yS=async n=>{try{const e=wt(ct(n,ic()),Jr("lastUpdatedAt","desc"));return{success:!0,data:(await Tt(e)).docs.map(r=>({id:r.id,...r.data()}))}}catch(e){return st("getting all support tickets",e)}},uP=async(n,e)=>{try{const t=wt(ct(n,ic()),bt("userId","==",e),Jr("lastUpdatedAt","desc"));return{success:!0,data:(await Tt(t)).docs.map(i=>({id:i.id,...i.data()}))}}catch(t){return st("getting tickets by reporter",t)}},k8=async(n,e,t)=>{try{return await Ds(Wt(n,Ly(e)),{...t,lastUpdatedAt:Hn()}),{success:!0}}catch(r){return st("updating support ticket",r)}},C8=async(n,e)=>{try{const t=await zd(ct(n,gm()),{...e,createdAt:Hn(),updatedAt:Hn()});return await Ds(t,{announcementId:t.id}),{success:!0,id:t.id}}catch(t){return st("creating announcement",t)}},P8=async(n,e=!1)=>{try{const t=e?[bt("status","==","active"),Jr("startDate","desc")]:[Jr("createdAt","desc")],r=wt(ct(n,gm()),...t);return{success:!0,data:(await Tt(r)).docs.map(s=>({id:s.id,...s.data()}))}}catch(t){return st("getting announcements",t)}},vS=async(n,e,t)=>{try{return await Ds(Wt(n,iP(e)),{...t,updatedAt:Hn()}),{success:!0}}catch(r){return st("updating announcement",r)}},R8=async(n,e)=>{try{return await mm(Wt(n,iP(e))),{success:!0}}catch(t){return st("deleting announcement",t)}},Gb=async n=>{try{const e=await ou(Wt(n,ym()));return{success:!0,data:e.exists()?e.data():null}}catch(e){return st("getting system settings",e)}},j8=async(n,e)=>{try{return await PL(Wt(n,ym()),e,{merge:!0}),{success:!0}}catch(t){return st("updating system settings",t)}},vm=async(n,e)=>{try{const t=wt(ct(n,Fi()),bt("userId","==",e),Jr("billDate","desc"));return{success:!0,data:(await Tt(t)).docs.map(s=>({id:s.id,...s.data()}))}}catch(t){return st("getting bills for user",t)}},O8=async(n,e,t,r,i)=>{var s,o;if(!(i!=null&&i.isRebateProgramEnabled)||!e){console.log("dataService: Rebate program disabled or no user ID. Skipping points.");return}try{const l=parseFloat(i.pointsPerPeso)||0,d=parseInt(i.earlyPaymentDaysThreshold,10)||7,f=parseInt(i.earlyPaymentBonusPoints,10)||10;let m=r*l;const y=(s=t.dueDate)!=null&&s.toDate?t.dueDate.toDate():(o=t.dueDate)!=null&&o.seconds?new Date(t.dueDate.seconds*1e3):null,g=new Date;y&&(y.getTime()-g.getTime())/864e5>=d&&(m+=f,console.log(`dataService: Awarding ${f} early payment bonus.`));const _=Math.round(m);if(_<=0){console.log(`dataService: No points to award (rounded to ${_}).`);return}const E=Wt(n,ir(),e),x=await ou(E);if(!x.exists()){console.error(`dataService: User profile ${e} not found. Cannot award points.`);return}const S=(x.data().rebatePoints||0)+_;let N="Bronze";S>=3e3?N="Platinum":S>=1500?N="Gold":S>=500&&(N="Silver");const P={rebatePoints:S,rebateTier:N},I=nc(n);I.update(E,P),I.update(Wt(n,mu(e)),P),await I.commit(),console.log(`dataService: Awarded ${_} points to ${e}. New total: ${S}`)}catch(l){console.error("dataService: Failed to award rebate points:",l)}},M8=async(n,e,t)=>{try{if(await Ds(Wt(n,pS(e)),{...t,lastUpdatedAt:Hn()}),t.status==="Paid"&&t.amountPaid&&(t.paymentTimestamp||t.paymentDate)){const r=await ou(Wt(n,pS(e)));if(r.exists()){const i=r.data();if(i.userId){const s=await ou(Wt(n,ym())),o=s.exists()?s.data():{};await O8(n,i.userId,i,t.amountPaid,o)}}}return{success:!0}}catch(r){return st("updating bill",r)}},dP=async(n,e)=>{try{const t=new Date(e.readingDate);if(isNaN(t))throw new Error("Invalid reading date format.");const r={...e,readingValue:parseFloat(e.readingValue)||0,readingDate:Ot.fromDate(t),readingDateString:e.readingDate,recordedAt:Hn()},i=await zd(ct(n,Lo()),r);return await Ds(i,{readingId:i.id}),{success:!0,id:i.id}}catch(t){return st("adding meter reading",t)}},D8=async(n,e,t)=>{try{const r=Wt(n,sP(e)),i={...t,lastUpdatedAt:Hn()};if(i.readingDate&&typeof i.readingDate=="string"){const s=new Date(i.readingDate);isNaN(s)?(delete i.readingDate,delete i.readingDateString):(i.readingDate=Ot.fromDate(s),i.readingDateString=i.readingDate)}return i.readingValue!==void 0&&(i.readingValue=parseFloat(i.readingValue)||0),await Ds(r,i),{success:!0}}catch(r){return st("updating meter reading",r)}},L8=async(n,e)=>{try{return await mm(Wt(n,sP(e))),{success:!0}}catch(t){return st("deleting meter reading",t)}},F8=async(n,e)=>{try{const t=wt(ct(n,Lo()),bt("accountNumber","==",e),Jr("readingDate","desc"));return{success:!0,data:(await Tt(t)).docs.map(i=>({id:i.id,...i.data()}))}}catch(t){return st("getting meter readings for account",t)}},hP=async(n,e)=>{try{const t=wt(ct(n,Wl()),bt("assignedReaderId","==",e),Jr("name"));return{success:!0,data:(await Tt(t)).docs.map(i=>({id:i.id,...i.data()}))}}catch(t){return st("getting routes for reader",t)}},V8=async(n,e,t=[])=>{try{const r=wt(ct(n,e),...t);return{success:!0,data:(await Tt(r)).docs.map(s=>({id:s.id,...s.data()}))}}catch(r){return st(`getting documents from ${e.split("/").pop()}`,r)}},fP=async n=>{try{const e=ct(n,ir()),t=await qg(e),i=(await Tt(e)).docs.reduce((s,o)=>{const l=o.data().role||"unknown";return s[l]=(s[l]||0)+1,s},{});return{success:!0,data:{total:t.data().count,byRole:i}}}catch(e){return st("getting users stats",e)}},mP=async n=>{try{const e=ct(n,ic()),t=await Tt(e);let r=0;const i={total:t.size,byStatus:{},byType:{}};return t.forEach(s=>{const o=s.data(),l=o.status||"Unknown",d=o.issueType||"Other Concern";i.byStatus[l]=(i.byStatus[l]||0)+1,i.byType[d]=(i.byType[d]||0)+1,l!=="Closed"&&l!=="Resolved"&&r++}),i.openCount=r,{success:!0,data:i}}catch(e){return st("getting tickets stats",e)}},z8=async n=>{try{const e=ct(n,gm()),t=await qg(e),r=wt(e,bt("status","==","active")),i=await qg(r);return{success:!0,data:{total:t.data().count,active:i.data().count}}}catch(e){return st("getting announcements stats",e)}},B8=async(n,e)=>{if(!e)return{success:!1,error:"Clerk ID required."};try{const t=new Date;t.setHours(0,0,0,0);const r=new Date;r.setHours(23,59,59,999);const i=Ot.fromDate(t),s=Ot.fromDate(r),o=wt(ct(n,Fi()),bt("processedByClerkId","==",e),bt("paymentTimestamp",">=",i),bt("paymentTimestamp","<=",s)),l=await Tt(o);let d=0;const f=l.docs.map(m=>{const y=m.data();return d+=y.amountPaid||0,{id:m.id,...y}});return{success:!0,data:{paymentsTodayCount:l.size,totalCollectedToday:d,transactions:f.sort((m,y)=>y.paymentTimestamp.toDate()-m.paymentTimestamp.toDate())}}}catch(t){return st("getting payments by clerk for today",t)}},U8=async(n,e)=>{try{const t=await zd(ct(n,pu()),{...e,startDate:Ot.fromDate(new Date(e.startDate)),estimatedEndDate:e.estimatedEndDate?Ot.fromDate(new Date(e.estimatedEndDate)):null,isBillingPaused:e.isBillingPaused||!1,createdAt:Hn(),updatedAt:Hn()});return await Ds(t,{interruptionId:t.id}),{success:!0,id:t.id}}catch(t){return st("creating service interruption",t)}},q8=async(n,e,t)=>{try{const r={...t,updatedAt:Hn()};return r.startDate&&typeof r.startDate=="string"&&(r.startDate=Ot.fromDate(new Date(r.startDate))),r.estimatedEndDate&&typeof r.estimatedEndDate=="string"&&(r.estimatedEndDate=Ot.fromDate(new Date(r.estimatedEndDate))),r.status==="Resolved"&&!r.resolvedAt&&(r.resolvedAt=Hn()),await Ds(Wt(n,oP(e)),r),{success:!0}}catch(r){return st("updating service interruption",r)}},H8=async(n,e)=>{try{return await mm(Wt(n,oP(e))),{success:!0}}catch(t){return st("deleting service interruption",t)}},pP=async n=>{try{const e=Ot.now(),t=wt(ct(n,pu()),bt("status","in",["Ongoing","Scheduled"]),Jr("startDate","desc"));return{success:!0,data:(await Tt(t)).docs.map(s=>({id:s.id,...s.data()})).filter(s=>s.status==="Scheduled"&&s.startDate.toMillis()>e.toMillis()?!0:s.status==="Ongoing"?s.estimatedEndDate?s.estimatedEndDate.toMillis()>e.toMillis():!0:s.status!=="Resolved"&&s.startDate.toMillis()<=e.toMillis()&&(!s.estimatedEndDate||s.estimatedEndDate.toMillis()>e.toMillis()))}}catch(e){return st("getting active service interruptions",e)}},$8=async n=>{try{const e=wt(ct(n,pu()),Jr("createdAt","desc"));return{success:!0,data:(await Tt(e)).docs.map(r=>({id:r.id,...r.data()}))}}catch(e){return st("getting all service interruptions",e)}},W8=async n=>{try{const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),r=Ot.fromDate(t),[i,s,o]=await Promise.all([Tt(wt(ct(n,ic()),bt("submittedAt",">=",r))),Tt(wt(ct(n,Lo()),bt("recordedAt",">=",r))),Tt(wt(ct(n,Fi()),bt("paymentTimestamp",">=",r)))]),l=Array(24).fill(0).map(()=>({tickets:0,readings:0,payments:0}));return i.forEach(d=>{const f=d.data().submittedAt.toDate().getHours();l[f].tickets++}),s.forEach(d=>{const f=d.data().recordedAt.toDate().getHours();l[f].payments++}),o.forEach(d=>{const f=d.data().paymentTimestamp.toDate().getHours();l[f].payments++}),{success:!0,data:l}}catch(e){return st("getting hourly activity stats",e)}},G8=async n=>{try{const e=new Date;e.setHours(0,0,0,0);const t=Ot.fromDate(e),[r,i,s]=await Promise.all([Tt(wt(ct(n,Lo()),bt("recordedAt",">=",t))),Tt(wt(ct(n,Fi()),bt("paymentTimestamp",">=",t),bt("processedByClerkId","!=",null))),Tt(wt(ct(n,ic()),bt("lastUpdatedAt",">=",t)))]),o=r.docs.reduce((f,m)=>{const y=m.data().readBy||"Unknown Reader";return f[y]=(f[y]||0)+1,f},{}),l=i.docs.reduce((f,m)=>{const y=m.data().processedByClerkName||"Unknown Clerk";return f[y]=(f[y]||0)+1,f},{}),d=s.docs.reduce((f,m)=>{const y=m.data();if(y.status==="Resolved"||y.status==="Closed"){const g=y.lastUpdatedByAdminName||"Unknown Admin";f[g]=(f[g]||0)+1}return f},{});return{success:!0,data:{readerActivity:o,clerkActivity:l,adminActivity:d}}}catch(e){return st("getting staff activity stats",e)}},K8=async n=>{try{const[e,t,r]=await Promise.all([Tt(ct(n,Wl())),Tt(wt(ct(n,pu()),bt("status","in",["Scheduled","Ongoing"]))),Tt(wt(ct(n,Wl()),bt("assignedReaderId","==","")))]),i=e.size,s=e.docs.reduce((d,f)=>{var m;return d+(((m=f.data().accountNumbers)==null?void 0:m.length)||0)},0),o=t.size,l=r.size;return{success:!0,data:{totalRoutes:i,totalAccounts:s,activeInterrupts:o,unassignedRoutes:l}}}catch(e){return st("getting technical stats",e)}},Y8=async n=>{try{const e=wt(ct(n,Fi())),t=await Tt(e),r={};t.forEach(s=>{var f;const o=s.data(),l=(f=o.billDate)!=null&&f.toDate?o.billDate.toDate():null;if(!l||typeof o.consumption!="number")return;const d=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`;r[d]=(r[d]||0)+(o.consumption||0)});const i=Object.entries(r).sort(([s],[o])=>s.localeCompare(o)).slice(-12);return{success:!0,data:Object.fromEntries(i)}}catch(e){return st("getting consumption stats",e)}},Z8=async n=>{try{const e=wt(ct(n,Fi()),bt("status","==","Paid")),t=await Tt(e),r={};return t.forEach(i=>{const s=i.data().paymentMethod||"Unknown";r[s]=(r[s]||0)+1}),{success:!0,data:r}}catch(e){return st("getting payment method stats",e)}},Q8=async n=>{try{const e=wt(ct(n,ir()),bt("createdAt","!=",null)),t=await Tt(e),r={};t.forEach(s=>{var f;const o=s.data(),l=(f=o.createdAt)!=null&&f.toDate?o.createdAt.toDate():null;if(!l)return;const d=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`;r[d]=(r[d]||0)+1});const i=Object.entries(r).sort(([s],[o])=>s.localeCompare(o)).slice(-12);return{success:!0,data:Object.fromEntries(i)}}catch(e){return st("getting user growth stats",e)}};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X8=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),gP=(...n)=>n.filter((e,t,r)=>!!e&&r.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var J8={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e9=ee.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:o,...l},d)=>ee.createElement("svg",{ref:d,...J8,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:gP("lucide",i),...l},[...o.map(([f,m])=>ee.createElement(f,m)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=(n,e)=>{const t=ee.forwardRef(({className:r,...i},s)=>ee.createElement(e9,{ref:s,iconNode:e,className:gP(`lucide-${X8(n)}`,r),...i}));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $g=Le("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t9=Le("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wg=Le("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n9=Le("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kb=Le("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mx=Le("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yP=Le("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const au=Le("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vP=Le("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yb=Le("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r9=Le("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Is=Le("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zb=Le("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i9=Le("CirclePause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s9=Le("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vy=Le("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=Le("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o9=Le("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a9=Le("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qb=Le("ClipboardPen",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",key:"1oijnt"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-5.5",key:"cereej"}],["path",{d:"M4 13.5V6a2 2 0 0 1 2-2h2",key:"5ua5vh"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=Le("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l9=Le("Compass",[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _P=Le("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const px=Le("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c9=Le("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u9=Le("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gg=Le("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gl=Le("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d9=Le("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h9=Le("FilePlus",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xb=Le("FileSearch",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4.268 21a2 2 0 0 0 1.727 1H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"ms7g94"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}],["circle",{cx:"5",cy:"14",r:"3",key:"ufru5t"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kl=Le("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f9=Le("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yl=Le("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jb=Le("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m9=Le("HardHat",[["path",{d:"M2 18a1 1 0 0 0 1 1h18a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v2z",key:"1dej2m"}],["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6",key:"9ciidu"}],["path",{d:"M14 6a6 6 0 0 1 6 6v3",key:"1hnv84"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=Le("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e2=Le("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const An=Le("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const p9=Le("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kg=Le("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t2=Le("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xP=Le("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const g9=Le("ListFilter",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y9=Le("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=Le("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zy=Le("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sa=Le("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oo=Le("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zl=Le("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hd=Le("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v9=Le("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _9=Le("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Aa=Le("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bP=Le("OctagonAlert",[["polygon",{points:"7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2",key:"h1p8hx"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n2=Le("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x9=Le("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ah=Le("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wP=Le("PhoneCall",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b9=Le("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r2=Le("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w9=Le("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=Le("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=Le("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=Le("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const By=Le("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uy=Le("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ud=Le("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E9=Le("ShieldQuestion",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=Le("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T9=Le("SquareCheckBig",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bf=Le("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S9=Le("SquareX",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const od=Le("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A9=Le("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N9=Le("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qd=Le("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EP=Le("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xt=Le("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I9=Le("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TP=Le("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SP=Le("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AP=Le("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cv=Le("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k9=Le("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C9=Le("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=Le("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _S=Le("Wind",[["path",{d:"M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2",key:"1k4u03"}],["path",{d:"M9.6 4.6A2 2 0 1 1 11 8H2",key:"b7d0fd"}],["path",{d:"M12.6 19.4A2 2 0 1 0 14 16H2",key:"1p5cb3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qy=Le("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NP=Le("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),gx=ts.memo(({message:n,type:e,onClose:t})=>{if(ee.useEffect(()=>{if(!n)return;const s=setTimeout(()=>{t()},5e3);return()=>clearTimeout(s)},[t,n,e]),!n)return null;let r="bg-red-500",i=Xt;return e==="success"?(r="bg-green-500",i=Is):e==="warning"?(r="bg-yellow-500",i=Xt):e==="info"&&(r="bg-blue-500",i=Xt),u.jsxs("div",{className:`fixed top-5 right-5 ${r} text-white p-4 rounded-lg shadow-xl flex items-center space-x-3 z-[200] animate-slide-in-right`,role:"alert",children:[u.jsx(i,{size:24,"aria-hidden":"true"}),u.jsx("span",{className:"text-sm font-medium",children:n}),u.jsx("button",{onClick:t,className:"ml-auto p-1 rounded-full hover:bg-white/20 transition-colors","aria-label":"Close notification",children:u.jsx(qy,{size:18})}),u.jsx("style",{children:`
        @keyframes slide-in-right {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }
        .animate-slide-in-right {
          animation: slide-in-right 0.5s cubic-bezier(0.25, 0.8, 0.25, 1) forwards;
        }
      `})]})});gx.displayName="Notification";const xS=({message:n="Loading..."})=>u.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-700 to-indigo-800 flex flex-col justify-center items-center p-4 font-inter text-white selection:bg-blue-300 selection:text-blue-900",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("h1",{className:"text-6xl font-bold tracking-tight mb-2 animate-pulse",children:"AGWA"}),u.jsx("p",{className:"text-blue-200 text-lg italic mb-8",children:"Ensuring Clarity, Sustaining Life."}),u.jsx(St,{className:"h-12 w-12 mx-auto animate-spin text-blue-300"}),u.jsx("p",{className:"text-blue-300 text-sm mt-4",children:n})]}),u.jsxs("p",{className:"text-center text-xs text-blue-400 mt-12 absolute bottom-6",children:[" ",new Date().getFullYear()," AGWA Water Services, Inc."]})]}),Or=ts.memo(({isOpen:n,onClose:e,title:t="",children:r,size:i="md",hideCloseButton:s=!1,modalDialogClassName:o="",contentClassName:l=""})=>{const d=ee.useCallback(y=>{y.key==="Escape"&&e()},[e]);if(ee.useEffect(()=>(n?(window.addEventListener("keydown",d),document.body.style.overflow="hidden"):(window.removeEventListener("keydown",d),document.body.style.overflow="unset"),()=>{window.removeEventListener("keydown",d),document.body.style.overflow="unset"}),[n,d]),!n)return null;const f={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl","2xl":"max-w-2xl","3xl":"max-w-3xl","4xl":"max-w-4xl","5xl":"max-w-5xl",full:"max-w-full h-full sm:h-auto sm:max-h-[95vh]"},m=`bg-white rounded-xl shadow-2xl w-full ${f[i]||f.md} transform transition-all duration-300 ease-out scale-95 opacity-0 animate-modal-appear flex flex-col max-h-[90vh] ${o}`;return u.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex justify-center items-center z-[100] p-4 overflow-y-auto animate-fadeIn",onClick:s?void 0:e,role:"dialog","aria-modal":"true","aria-labelledby":t?"modal-title":void 0,children:[u.jsxs("div",{className:m,onClick:y=>y.stopPropagation(),role:"document",children:[t&&u.jsxs("div",{className:"flex justify-between items-center p-4 sm:p-5 border-b border-gray-200 sticky top-0 bg-white z-10 rounded-t-xl",children:[u.jsx("h3",{id:"modal-title",className:"text-lg sm:text-xl font-semibold text-gray-800",children:t}),!s&&u.jsx("button",{type:"button",onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors p-1 rounded-full hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Close modal",children:u.jsx(qy,{size:24})})]}),u.jsx("div",{className:`p-4 sm:p-6 flex-grow overflow-y-auto ${l}`,children:r})]}),u.jsx("style",{children:`
                @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
                .animate-fadeIn { animation: fadeIn 0.2s ease-out forwards; }
                @keyframes modal-appear { 0% { transform: scale(0.95) translateY(10px); opacity: 0; } 100% { transform: scale(1) translateY(0); opacity: 1; } }
                .animate-modal-appear { animation: modal-appear 0.25s cubic-bezier(0.25, 0.8, 0.25, 1) forwards; }
                `})]})});Or.displayName="Modal";const P9=({isOpen:n,onClose:e})=>u.jsx(Or,{isOpen:n,onClose:e,title:"Terms of Service",size:"3xl",children:u.jsxs("div",{className:"prose prose-sm max-w-none max-h-[70vh] overflow-y-auto pr-2",children:[u.jsx("p",{children:u.jsx("strong",{children:"Last Updated: October 31, 2025"})}),u.jsx("p",{children:'Please read these Terms of Service ("Terms", "Terms of Service") carefully before using the AGWA Water Services, Inc. ("AGWA", "us", "we", or "our") customer portal (the "Service").'}),u.jsx("p",{children:"Your access to and use of the Service is conditioned on your acceptance of and compliance with these Terms. These Terms apply to all visitors, users, and others who access or use the Service."}),u.jsx("h4",{children:"1. Account Registration and Security"}),u.jsxs("ul",{children:[u.jsx("li",{children:"To use this Service, you must be a registered customer of AGWA Water Services, Inc. You agree to provide information that is accurate, complete, and current at all times. Failure to do so constitutes a breach of the Terms, which may result in immediate termination of your account on our Service."}),u.jsx("li",{children:"You are responsible for safeguarding the password that you use to access the Service and for any activities or actions under your password."}),u.jsx("li",{children:"You agree not to disclose your password to any third party. You must notify us immediately upon becoming aware of any breach of security or unauthorized use of your account."})]}),u.jsx("h4",{children:"2. Use of the Service"}),u.jsx("p",{children:"You agree to use the Service only for lawful purposes. You are responsible for all of your activity in connection with the Service. You shall not (and shall not permit any third party to):"}),u.jsxs("ul",{children:[u.jsx("li",{children:"Take any action that imposes or may impose (as determined by us in our sole discretion) an unreasonable or disproportionately large load on our infrastructure."}),u.jsx("li",{children:"Interfere or attempt to interfere with the proper working of the Service or any activities conducted on the Service."}),u.jsx("li",{children:"Bypass any measures we may use to prevent or restrict access to the Service."})]}),u.jsx("h4",{children:"3. Online Payments"}),u.jsxs("ul",{children:[u.jsx("li",{children:"The Service provides a platform to facilitate payments for your water bills using third-party payment gateways (e.g., Stripe)."}),u.jsx("li",{children:"AGWA is not a bank or financial institution. All payment transactions are processed by our third-party payment partners. You agree to abide by the terms and conditions of these partners."}),u.jsx("li",{children:"You are responsible for ensuring that your payment information is correct and that you have sufficient funds to cover your payment."})]}),u.jsx("h4",{children:"4. Disclaimers"}),u.jsx("p",{children:'The Service is provided on an "AS IS" and "AS AVAILABLE" basis. Your use of the Service is at your sole risk.'}),u.jsx("p",{children:"AGWA does not warrant that (a) the Service will function uninterrupted, secure, or available at any particular time or location; (b) any errors or defects will be corrected; (c) the Service is free of viruses or other harmful components."}),u.jsx("p",{children:"All data presented in the Portal (including consumption, billing amounts, and payment status) is provided for convenience. In the event of any discrepancy, the official records held by AGWA Water Services, Inc. shall be deemed correct."}),u.jsx("h4",{children:"5. Limitation of Liability"}),u.jsx("p",{children:"In no event shall AGWA, nor its directors, employees, partners, or agents, be liable for any indirect, incidental, special, consequential, or punitive damages, including without limitation, loss of profits, data, use, goodwill, or other intangible losses, resulting from your access to or use of or inability to access or use the Service."}),u.jsx("h4",{children:"6. Governing Law"}),u.jsx("p",{children:"These Terms shall be governed and construed in accordance with the laws of the Republic of the Philippines, without regard to its conflict of law provisions."}),u.jsx("h4",{children:"7. Changes to Terms"}),u.jsx("p",{children:"We reserve the right, at our sole discretion, to modify or replace these Terms at any time. We will provide notice of any changes by posting the new Terms on this page. Your continued use of the Service after any such changes constitutes your acceptance of the new Terms."}),u.jsx("h4",{children:"8. Contact Us"}),u.jsx("p",{children:'If you have any questions about these Terms, please contact us through the "Contact Us" page available after logging in.'})]})}),R9=({isOpen:n,onClose:e})=>u.jsx(Or,{isOpen:n,onClose:e,title:"Data Privacy Notice",size:"3xl",children:u.jsxs("div",{className:"prose prose-sm max-w-none max-h-[70vh] overflow-y-auto pr-2",children:[u.jsx("p",{children:u.jsx("strong",{children:"Last Updated: October 31, 2025"})}),u.jsx("h4",{children:"Our Commitment to Privacy"}),u.jsx("p",{children:'AGWA Water Services, Inc. ("AGWA") is committed to protecting your privacy in accordance with Republic Act No. 10173, also known as the Data Privacy Act of 2012 (DPA), its Implementing Rules and Regulations (IRR), and other relevant data privacy laws.'}),u.jsx("h4",{children:"1. What Personal Information We Collect"}),u.jsx("p",{children:"We collect, store, and process your personal information when you register for an account, use our services, pay your bills, or interact with our customer support. This information may include:"}),u.jsxs("ul",{children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Personal Identification Data:"})," Full name, email address, phone number, and service address."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Account and Service Data:"})," AGWA Account Number, meter serial number, service type, account status, and account creation date."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Financial and Transaction Data:"})," Billing history, payment history, consumption data, payment method details (which are securely processed by our third-party payment partners), and rebate point information."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Communication Data:"})," Records of your correspondence with us, such as support tickets, chat logs, and issue reports."]})]}),u.jsx("h4",{children:"2. How We Use Your Information"}),u.jsx("p",{children:"Your personal data is used for the following legitimate business purposes:"}),u.jsxs("ul",{children:[u.jsx("li",{children:"To create, maintain, and secure your AGWA Portal account."}),u.jsx("li",{children:"To provide and manage your water services, including meter reading, billing, and maintenance."}),u.jsx("li",{children:"To process your bill payments and manage your account transactions."}),u.jsx("li",{children:"To respond to your inquiries, concerns, and support tickets, and to provide customer support."}),u.jsx("li",{children:"To send you essential service advisories, billing reminders, and other system notifications."}),u.jsx("li",{children:"To manage your participation in programs such as the AGWA Rewards Program."}),u.jsx("li",{children:"To analyze portal and service usage to improve our operations, services, and user experience."}),u.jsx("li",{children:"To comply with our legal and regulatory obligations as a public utility."})]}),u.jsx("h4",{children:"3. Data Sharing and Disclosure"}),u.jsx("p",{children:"We do not sell or rent your personal information. We may share your data in the following limited circumstances:"}),u.jsxs("ul",{children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Third-Party Service Providers:"})," With trusted partners who perform services on our behalf, such as payment gateways (e.g., Stripe) and data hosting (e.g., Firebase). These partners are contractually bound to protect your data and use it only for the purposes we specify."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Legal and Regulatory Requirements:"})," When required by law, such as in response to a subpoena, court order, or formal request from government authorities."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Emergency:"})," To protect the vital interests of any individual, such as during emergencies or service-related safety incidents."]})]}),u.jsx("h4",{children:"4. Data Security and Retention"}),u.jsx("p",{children:"We implement robust technical, physical, and organizational security measures to protect your personal information from unauthorized access, use, alteration, or disclosure. This includes data encryption, access controls, and secure server environments."}),u.jsx("p",{children:"We retain your personal data only for as long as your account is active or as necessary to fulfill the purposes outlined in this notice, and as required by law for auditing and regulatory record-keeping."}),u.jsx("h4",{children:"5. Your Rights as a Data Subject"}),u.jsx("p",{children:"In accordance with the Data Privacy Act, you have the right to:"}),u.jsxs("ul",{children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Be Informed"})," that your personal data will be, are being, or were processed."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Access"})," your personal information we hold."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Rectify"})," any inaccuracies or errors in your data."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Erase or Block"})," your data from our systems, subject to legal and contractual limitations."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Object"})," to the processing of your personal data."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Data Portability"})," to obtain a copy of your data in a machine-readable format."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Lodge a Complaint"})," with the National Privacy Commission (NPC) if you feel your data privacy rights have been violated."]})]}),u.jsx("h4",{children:"6. Contacting Us"}),u.jsx("p",{children:"To exercise any of these rights or if you have any questions about this privacy notice, please contact our Data Privacy Officer at:"}),u.jsxs("p",{children:[u.jsx("strong",{children:"Email:"})," ",u.jsx("a",{href:"mailto:dpo@agwa-waterservices.com.ph",children:"dpo@agwa-waterservices.com.ph"}),u.jsx("br",{}),u.jsx("strong",{children:"Hotline:"})," 1627-AGWA (Attn: Data Privacy Officer)"]}),u.jsx("h4",{children:"7. Changes to This Notice"}),u.jsx("p",{children:'We may update this Data Privacy Notice from time to time. We will notify you of any significant changes by posting the new notice on this page and updating the "Last Updated" date.'})]})}),IP=ts.memo(({children:n,authError:e,appIdForPaths:t,systemSettings:r={}})=>{const[i,s]=ee.useState(!1),[o,l]=ee.useState(!1);return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-700 to-indigo-800 flex flex-col justify-center items-center p-4 font-sans selection:bg-blue-300 selection:text-blue-900",children:[u.jsxs("div",{className:"bg-white p-8 sm:p-10 md:p-12 rounded-xl shadow-2xl w-full max-w-md transform transition-all duration-500 ease-out animate-fadeInUp",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("h1",{className:"text-5xl font-bold text-blue-600 tracking-tight",children:"AGWA"}),u.jsx("p",{className:"text-sm text-gray-500 mt-1 italic",children:"Ensuring Clarity, Sustaining Life."})]}),e&&u.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 text-red-700 rounded-lg text-sm text-center animate-shake",role:"alert",children:e}),ts.cloneElement(n,{systemSettings:r}),u.jsxs("p",{className:"text-xs text-gray-400 text-center mt-6",children:["By continuing, you agree to our ",u.jsx("br",{}),u.jsx("button",{type:"button",onClick:()=>s(!0),className:"font-medium text-blue-600 hover:underline",children:"Terms of Service"})," ","and"," ",u.jsx("button",{type:"button",onClick:()=>l(!0),className:"font-medium text-blue-600 hover:underline",children:"Data Privacy Notice"}),"."]})]}),t&&u.jsxs("p",{className:"text-center text-xs text-blue-200 mt-8",children:["App ID (DB): ",u.jsx("span",{className:"font-semibold opacity-80",children:t})]}),u.jsxs("p",{className:"text-center text-xs text-blue-300 mt-2",children:[" ",new Date().getFullYear()," AGWA Water Services, Inc."]}),u.jsx("div",{id:"recaptcha-container",className:"my-2 mx-auto"}),u.jsx("style",{children:`
          @keyframes fadeInUp {
            from {
              opacity: 0;
              transform: translateY(20px);
            }
            to {
              opacity: 1;
              transform: translateY(0);
            }
          }
          .animate-fadeInUp {
            animation: fadeInUp 0.6s ease-out forwards;
          }

          @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
          }
          .animate-shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
          }
        `})]}),u.jsx(P9,{isOpen:i,onClose:()=>s(!1)}),u.jsx(R9,{isOpen:o,onClose:()=>l(!1)})]})});IP.displayName="AuthFormContainer";function kP(n){var e,t,r="";if(typeof n=="string"||typeof n=="number")r+=n;else if(typeof n=="object")if(Array.isArray(n)){var i=n.length;for(e=0;e<i;e++)n[e]&&(t=kP(n[e]))&&(r&&(r+=" "),r+=t)}else for(t in n)n[t]&&(r&&(r+=" "),r+=t);return r}function i2(){for(var n,e,t=0,r="",i=arguments.length;t<i;t++)(n=arguments[t])&&(e=kP(n))&&(r&&(r+=" "),r+=e);return r}const Mi="w-full px-4 py-3 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 focus:outline-none transition duration-200 text-gray-900 placeholder-gray-400 disabled:bg-gray-200 disabled:cursor-not-allowed",Uf=n=>i2("w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 active:scale-95 flex items-center justify-center",{"opacity-60 cursor-not-allowed":n}),CP=n=>i2("w-full bg-white hover:bg-gray-100 text-gray-700 font-semibold py-3 px-4 rounded-lg border border-gray-300 shadow-sm hover:shadow transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-opacity-50 flex items-center justify-center space-x-2 active:scale-95",{"opacity-50 cursor-not-allowed":n}),PP=n=>i2("w-full bg-teal-500 hover:bg-teal-600 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-teal-400 focus:ring-opacity-50 flex items-center justify-center space-x-2 active:scale-95",{"opacity-50 cursor-not-allowed":n}),j9=({navigateTo:n,authActionLoading:e,handleLoginExternal:t,handleGoogleSignIn:r,setAuthError:i,systemSettings:s={}})=>{const[o,l]=ee.useState(""),[d,f]=ee.useState(""),[m,y]=ee.useState(!1),g=async S=>{if(S.preventDefault(),!o||!d){i&&i("Please enter both email and password.");return}i&&i(""),await t(o,d)},_=async()=>{i&&i(""),await r()},{isGoogleLoginEnabled:E=!0,isPasswordlessLoginEnabled:x=!0,isSignupEnabled:w=!0}=s;return u.jsxs("form",{onSubmit:g,className:"space-y-5",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Sa,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"email",placeholder:"Email Address *",value:o,onChange:S=>l(S.target.value),className:`${Mi} pl-11`,required:!0,disabled:e,"aria-label":"Email Address"})]}),u.jsxs("div",{className:"relative",children:[u.jsx(Kg,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:m?"text":"password",placeholder:"Password *",value:d,onChange:S=>f(S.target.value),className:`${Mi} pl-11`,required:!0,disabled:e,"aria-label":"Password"}),u.jsx("button",{type:"button",onClick:()=>y(!m),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 p-1 focus:outline-none","aria-label":m?"Hide password":"Show password",disabled:e,children:m?u.jsx(Gg,{size:20}):u.jsx(Gl,{size:20})})]}),u.jsxs("button",{type:"submit",className:Uf(e),disabled:e,children:[e&&u.jsx(St,{className:"animate-spin inline mr-2",size:18}),e?"Logging In...":"Login"]}),(E||x)&&u.jsxs("div",{className:"relative my-4",children:[u.jsx("div",{className:"absolute inset-0 flex items-center",children:u.jsx("div",{className:"w-full border-t border-gray-300"})}),u.jsx("div",{className:"relative flex justify-center text-sm",children:u.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with"})})]}),E&&u.jsxs("button",{type:"button",onClick:_,className:CP(e),disabled:e,children:[u.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",className:"h-5 w-5",onError:S=>S.target.style.display="none"}),u.jsx("span",{children:"Sign in with Google"})]}),x&&u.jsxs("button",{type:"button",onClick:()=>n("passwordlessLogin"),className:PP(e),disabled:e,children:[u.jsx(t2,{size:18,className:"mr-2"}),u.jsx("span",{children:"Sign in with Email Link"})]}),u.jsxs("div",{className:"text-sm text-center mt-5 space-y-1.5",children:[w&&u.jsxs("p",{className:"text-gray-600",children:["Don't have an account?"," ",u.jsx("button",{type:"button",onClick:()=>n("signup"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-70",disabled:e,children:"Sign Up"})]}),u.jsx("p",{className:"text-gray-600",children:u.jsx("button",{type:"button",onClick:()=>n("forgotPassword"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-70",disabled:e,children:"Forgot Password?"})})]})]})},O9=({navigateTo:n,authActionLoading:e,handleSignupExternal:t,handleGoogleSignIn:r,setAuthError:i,showNotification:s,systemSettings:o={}})=>{const[l,d]=ee.useState(""),[f,m]=ee.useState(""),[y,g]=ee.useState(""),[_,E]=ee.useState(""),[x,w]=ee.useState(""),[S,N]=ee.useState(!1),[P,I]=ee.useState(!1),R=async k=>{if(k.preventDefault(),i(""),!_.trim()){i("Full Name is required."),s("Full Name is required.","warning");return}if(!x.trim()){i("AGWA Account Number is required (e.g., RES-12345, ADM-001)."),s("AGWA Account Number is required.","warning");return}if(f.length<6){i("Password must be at least 6 characters long."),s("Password too short (min. 6 chars).","warning");return}if(f!==y){i("Passwords do not match."),s("Passwords don't match.","warning");return}await t(l,f,_,x)},U=async()=>{await r()},{isGoogleLoginEnabled:j=!0}=o;return u.jsxs("form",{onSubmit:R,className:"space-y-5",children:[u.jsxs("div",{className:"relative",children:[u.jsx(ks,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Full Name *",value:_,onChange:k=>E(k.target.value),className:`${Mi} pl-11`,required:!0,disabled:e,"aria-label":"Full Name"})]}),u.jsxs("div",{className:"relative",children:[u.jsx(Cs,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"AGWA Account Number (e.g., RES-12345) *",value:x,onChange:k=>w(k.target.value),className:`${Mi} pl-11`,required:!0,disabled:e,"aria-label":"AGWA Account Number"})]}),u.jsxs("div",{className:"relative",children:[u.jsx(Sa,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"email",placeholder:"Email Address *",value:l,onChange:k=>d(k.target.value),className:`${Mi} pl-11`,required:!0,disabled:e,"aria-label":"Email Address"})]}),u.jsxs("div",{className:"relative",children:[u.jsx(Kg,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:S?"text":"password",placeholder:"Password (min. 6 chars) *",value:f,onChange:k=>m(k.target.value),className:`${Mi} pl-11`,required:!0,disabled:e,"aria-label":"Password"}),u.jsx("button",{type:"button",onClick:()=>N(!S),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 p-1 focus:outline-none","aria-label":S?"Hide password":"Show password",disabled:e,children:S?u.jsx(Gg,{size:20}):u.jsx(Gl,{size:20})})]}),u.jsxs("div",{className:"relative",children:[u.jsx(Kg,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:P?"text":"password",placeholder:"Confirm Password *",value:y,onChange:k=>g(k.target.value),className:`${Mi} pl-11`,required:!0,disabled:e,"aria-label":"Confirm Password"}),u.jsx("button",{type:"button",onClick:()=>I(!P),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 p-1 focus:outline-none","aria-label":P?"Hide confirm password":"Show confirm password",disabled:e,children:P?u.jsx(Gg,{size:20}):u.jsx(Gl,{size:20})})]}),u.jsxs("button",{type:"submit",className:Uf(e),disabled:e,children:[e&&u.jsx(St,{className:"animate-spin inline mr-2",size:18}),e?"Creating Account...":"Create My Account"]}),j&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"relative my-4",children:[u.jsx("div",{className:"absolute inset-0 flex items-center",children:u.jsx("div",{className:"w-full border-t border-gray-300"})}),u.jsx("div",{className:"relative flex justify-center text-sm",children:u.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or sign up with"})})]}),u.jsxs("button",{type:"button",onClick:U,className:CP(e),disabled:e,children:[u.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",className:"h-5 w-5",onError:k=>k.target.style.display="none"}),u.jsx("span",{children:"Sign up with Google"})]})]}),u.jsxs("p",{className:"text-sm text-center text-gray-600 mt-5",children:["Already have an account?"," ",u.jsx("button",{type:"button",onClick:()=>n("login"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-70",disabled:e,children:"Login"})]})]})},M9=({handleForgotPasswordExternal:n,navigateTo:e,authActionLoading:t})=>{const[r,i]=ee.useState(""),[s,o]=ee.useState(!1),l=async d=>{if(d.preventDefault(),!r.trim()){alert("Please enter your email address.");return}await n(r)&&o(!0)};return s?u.jsxs("div",{className:"space-y-5 text-center",children:[u.jsx(Sa,{size:48,className:"mx-auto text-green-500 mb-3"}),u.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Password Reset Email Sent"}),u.jsxs("p",{className:"text-sm text-gray-600",children:["If an account exists for ",u.jsx("strong",{children:r}),", you will receive an email with instructions to reset your password. Please check your inbox (and spam folder)."]}),u.jsxs("button",{type:"button",onClick:()=>e("login"),className:`${Uf(!1)} bg-green-600 hover:bg-green-700 focus:ring-green-500 mt-4`,children:[u.jsx($g,{size:18,className:"mr-2"})," Back to Login"]})]}):u.jsxs("form",{onSubmit:l,className:"space-y-5",children:[u.jsx("p",{className:"text-sm text-gray-600 mb-4 text-center",children:"Enter your email address below, and we'll send you a link to reset your password."}),u.jsxs("div",{className:"relative",children:[u.jsx(Sa,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"email",placeholder:"Enter your Email Address",value:r,onChange:d=>i(d.target.value),className:`${Mi} pl-11`,required:!0,disabled:t,"aria-label":"Email for password reset"})]}),u.jsxs("button",{type:"submit",className:Uf(t||!r.trim()),disabled:t||!r.trim(),children:[t?u.jsx(St,{className:"animate-spin mr-2",size:20}):null,t?"Sending Link...":"Send Password Reset Link"]}),u.jsx("div",{className:"text-sm text-center mt-6",children:u.jsxs("button",{type:"button",onClick:()=>e("login"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-50",disabled:t,children:[u.jsx($g,{size:16,className:"inline mr-1"})," Remembered your password? Login"]})})]})},D9=({handlePasswordlessSignInExternal:n,navigateTo:e,authActionLoading:t})=>{const[r,i]=ee.useState(""),[s,o]=ee.useState(!1),l=async d=>{if(d.preventDefault(),!r.trim()){alert("Please enter your email address.");return}const f=await n(r);f&&f.success&&o(!0)};return s?u.jsxs("div",{className:"space-y-5 text-center",children:[u.jsx(Is,{size:48,className:"mx-auto text-green-500 mb-3"}),u.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Sign-in Link Sent!"}),u.jsxs("p",{className:"text-sm text-gray-600",children:["A magic sign-in link has been sent to ",u.jsx("strong",{children:r}),". Please check your email and click the link to sign in. The link is valid for a limited time."]}),u.jsxs("button",{type:"button",onClick:()=>e("login"),className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 flex items-center justify-center mt-4",children:[u.jsx($g,{size:18,className:"mr-2"})," Okay, Got It!"]})]}):u.jsxs("form",{onSubmit:l,className:"space-y-5",children:[u.jsx("p",{className:"text-sm text-gray-600 mb-4 text-center",children:"Enter your email address, and we'll send you a magic link to sign in instantly. No password needed!"}),u.jsxs("div",{className:"relative",children:[u.jsx(Sa,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"email",placeholder:"Enter your Email Address",value:r,onChange:d=>i(d.target.value),className:`${Mi} pl-11`,required:!0,disabled:t,"aria-label":"Email for passwordless sign-in"})]}),u.jsxs("button",{type:"submit",className:PP(t||!r.trim()),disabled:t||!r.trim(),children:[t?u.jsx(St,{className:"animate-spin mr-2",size:20}):u.jsx(t2,{size:20,className:"mr-2"}),t?"Sending Link...":"Send Sign-in Link"]}),u.jsx("div",{className:"text-sm text-center mt-6",children:u.jsxs("button",{type:"button",onClick:()=>e("login"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-50",disabled:t,children:[u.jsx($g,{size:16,className:"inline mr-1"})," Prefer a password? Login"]})})]})},L9={Home:e2,UserCog:AP,FileText:Kl,AlertTriangle:Xt,Users:xa,MessageSquare:Aa,Settings:Uy,HelpCircle:Zb,Info:An,PhoneCall:wP,LogOut:zy,ShieldCheck:Ud,Megaphone:hd,BarChart3:Kb,Edit:Bf,Gauge:Yl,Map:Zl,ClipboardEdit:Qb,Search:Ps,Banknote:Wg,FileSearch:Xb,TrendingUp:EP,Gift:Jb,AlertIcon:Xt,EditIcon:Bf,Eye:Gl},F9=({userData:n,navItems:e,activeSection:t,onNavigate:r,onLogout:i,isMobileOpen:s,setMobileOpen:o})=>{var y;const l=`https://placehold.co/40x40/FFFFFF/3B82F6?text=${((n==null?void 0:n.displayName)||(n==null?void 0:n.email)||"U").charAt(0).toUpperCase()}`,d=e.reduce((g,_)=>{const E=_.group||"General";return g[E]||(g[E]=[]),g[E].push(_),g},{}),f=["Main","Account","Operations","Administration","Support","Information","Help & Info"],m=u.jsxs("div",{className:"h-full flex flex-col bg-gradient-to-b from-blue-700 to-blue-900 text-white shadow-2xl",children:[u.jsxs("div",{className:"p-5 pt-6 text-center border-b border-blue-600",children:[u.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-white tracking-tight",children:"AGWA"}),u.jsx("p",{className:"text-xs text-blue-200 font-light mt-0.5 italic",children:"Ensuring Clarity, Sustaining Life."})]}),u.jsx("nav",{className:"flex-grow p-3 space-y-1.5 overflow-y-auto scrollbar-thin scrollbar-thumb-blue-500 scrollbar-track-blue-800",children:f.map(g=>{const _=d[g];return _?u.jsxs("div",{className:"space-y-1.5",children:[f.length>1&&u.jsx("h3",{className:"px-3.5 pt-3 pb-1 text-xs font-semibold text-blue-300 uppercase tracking-wider",children:g}),_.map(E=>{const x=L9[E.iconName]||Zb,w=t===E.section;return u.jsxs("button",{onClick:()=>{r(E.section),o&&o(!1)},className:`w-full flex items-center space-x-3 px-3.5 py-2.5 rounded-lg transition-all duration-200 ease-in-out text-sm font-medium focus:outline-none focus:ring-2 focus:ring-opacity-50 focus:ring-sky-300 group
                                            ${w?"bg-sky-500 text-white shadow-md transform scale-105 font-semibold":"text-blue-100 hover:bg-blue-600/70 hover:text-white hover:translate-x-1"}`,title:E.name,children:[u.jsx(x,{size:20,className:`${w?"text-white":"text-blue-300 group-hover:text-white transition-colors"}`}),u.jsx("span",{className:"truncate",children:E.name})]},E.section||E.name)})]},g):null})}),u.jsxs("div",{className:"p-4 border-t border-blue-600",children:[n&&u.jsxs("div",{className:"flex items-center mb-3 p-2.5 bg-blue-800/50 rounded-lg shadow-inner",children:[u.jsx("img",{src:n.photoURL||l,alt:"User",className:"h-10 w-10 rounded-full border-2 border-blue-400 object-cover bg-gray-200 flex-shrink-0",onError:g=>{g.target.onerror=null,g.target.src=l}}),u.jsxs("div",{className:"ml-3 overflow-hidden",children:[u.jsx("p",{className:"text-sm font-semibold leading-tight truncate text-white",title:n.displayName||n.email,children:n.displayName||n.email}),u.jsxs("p",{className:"text-xs text-blue-200 leading-tight capitalize truncate",title:`Role: ${n.role}`,children:["Role: ",((y=n.role)==null?void 0:y.replace("_"," "))||"N/A"]}),n.role==="customer"&&u.jsxs("p",{className:"text-xs text-blue-300 leading-tight truncate",title:`Account: ${n.accountNumber||"N/A"}`,children:["Acc: ",n.accountNumber||"N/A"]})]})]}),u.jsxs("button",{onClick:i,className:"w-full flex items-center justify-center space-x-2 bg-red-600 hover:bg-red-700 text-white font-semibold py-2.5 px-4 rounded-lg transition-all duration-150 active:scale-95 focus:outline-none focus:ring-2 focus:ring-red-400 ring-offset-2 ring-offset-blue-800",children:[u.jsx(zy,{size:20}),u.jsx("span",{children:"Logout"})]})]})]});return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-60 z-40 lg:hidden transition-opacity duration-300 ${s?"opacity-100":"opacity-0 pointer-events-none"} no-print`,onClick:()=>o(!1),"aria-hidden":"true"}),u.jsx("aside",{className:`fixed top-0 left-0 h-full w-64 z-50 transform transition-transform duration-300 ease-in-out lg:translate-x-0 ${s?"translate-x-0 shadow-xl":"-translate-x-full"} no-print`,children:m}),u.jsx("style",{children:`
                .scrollbar-thin { scrollbar-width: thin; scrollbar-color: #3b82f6 #1e40af; }
                .scrollbar-thin::-webkit-scrollbar { width: 6px; height: 6px; }
                .scrollbar-thin::-webkit-scrollbar-track { background: #1e40af; border-radius: 3px;}
                .scrollbar-thin::-webkit-scrollbar-thumb { background-color: #3b82f6; border-radius: 3px; border: 1px solid #1e40af; }
                .scrollbar-thin::-webkit-scrollbar-thumb:hover { background-color: #2563eb; }
             `})]})},V9=({title:n,value:e,icon:t,iconColor:r="text-blue-600",borderColor:i="border-blue-600",subtext:s,onClick:o,className:l=""})=>{const d="bg-white p-5 rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 ease-in-out flex items-start space-x-4 border-l-4",f=o?"cursor-pointer":"";return u.jsxs("div",{className:`${d} ${i} ${f} ${l}`,onClick:o,role:o?"button":"figure",tabIndex:o?0:-1,onKeyDown:o?m=>{(m.key==="Enter"||m.key===" ")&&o()}:void 0,children:[t&&u.jsx("div",{className:"p-2 bg-gray-100 rounded-full",children:u.jsx(t,{className:`w-7 h-7 ${r}`,"aria-hidden":"true"})}),u.jsxs("div",{className:"flex-1 overflow-hidden",children:[u.jsx("p",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider truncate",title:n,children:n}),u.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-gray-800 truncate",title:String(e),children:e}),s&&u.jsx("p",{className:"text-xs text-gray-500 mt-1 truncate",title:s,children:s})]})]})},di=ts.memo(V9),gn=({size:n="h-8 w-8",color:e="text-blue-600",className:t="",message:r="",messageClassName:i="text-sm text-gray-500 mt-2"})=>u.jsxs("div",{className:`flex flex-col items-center justify-center ${t}`,children:[u.jsx(St,{className:`animate-spin ${n} ${e}`}),r&&u.jsx("p",{className:i,children:r})]}),Ql=async(n,e="llama-3.1-8b-instant")=>{throw new Error("Groq API key is missing. Please check your .env file for VITE_GROQ_API_KEY.")},z9=async(n,e)=>{const t=n.map(i=>({role:i.role==="assistant"?"assistant":"user",content:i.text})),r=[{role:"system",content:e},...t];return Ql(r,"llama-3.1-8b-instant")},B9=async({title:n,reason:e,area:t,time:r})=>Ql(),RP=async({ticketDescription:n,conversationHistory:e,draftReply:t,customerName:r})=>Ql(),U9=async({billDetails:n,charges:e,customerName:t,serviceType:r})=>(`${t}${n.monthYear}${n.amount.toFixed(2)}${Zt(n.dueDate)}${n.consumption}${n.monthYear}${e.basicCharge.toFixed(2)}${n.consumption}${r}${e.fcda.toFixed(2)}${e.environmentalCharge.toFixed(2)}${e.maintenanceServiceCharge.toFixed(2)}`,e.sewerageCharge>0&&`${e.sewerageCharge.toFixed(2)}`,`${e.vat.toFixed(2)}`,n.previousUnpaidAmount>0&&`${(n.previousUnpaidAmount||0).toFixed(2)}`,n.seniorCitizenDiscount>0&&`${(n.seniorCitizenDiscount||0).toFixed(2)}`,`${n.amount.toFixed(2)}${Zt(n.dueDate)}`,Ql()),q9=({user:n,userData:e,db:t,showNotification:r,setActiveSection:i,billingService:s})=>{const[o,l]=ee.useState([]),[d,f]=ee.useState(!0),[m,y]=ee.useState(""),[g,_]=ee.useState(0),[E,x]=ee.useState(""),[w,S]=ee.useState(""),[N,P]=ee.useState(!1),[I,R]=ee.useState(!1),U=ee.useCallback(async()=>{if(!n||!n.uid||!e||!s){f(!1),y("User data or essential services are unavailable.");return}f(!0),y("");try{const D=await vm(t,n.uid);if(D.success){const M=D.data.map(G=>{var ie;const re=s(G.consumption,e.serviceType,e.meterSize,e.systemSettings||{}),oe=re.totalCalculatedCharges+(G.previousUnpaidAmount||0)-(G.seniorCitizenDiscount||0);return{...G,amount:oe,calculatedCharges:re,billDateTimestamp:(ie=G.billDate)!=null&&ie.toDate?G.billDate.toDate():new Date(G.billDate)}}).sort((G,re)=>re.billDateTimestamp-G.billDateTimestamp);l(M.slice(0,3));const $=M.filter(G=>G.status==="Unpaid");if($.length>0){const re=$.sort((oe,ie)=>{var X,Y;return new Date(((X=oe.dueDate)==null?void 0:X.toDate())||0)-new Date(((Y=ie.dueDate)==null?void 0:Y.toDate())||0)})[0];_(re.amount),x(re.dueDate)}else _(0),x("")}else y(D.error||"Failed to fetch recent bills."),r(D.error||"Failed to fetch recent bills.","error")}catch(D){console.error("Error fetching customer dashboard data:",D);const M="An error occurred while loading your dashboard information.";y(M),r(M,"error")}f(!1)},[n,e,t,r,s]);ee.useEffect(()=>{U()},[U]);const j=async()=>{P(!0),R(!0),S("");try{const D=e.serviceAddress&&e.serviceAddress.barangay?`for a household in ${e.serviceAddress.barangay}`:"for a household",G=await Ql([{role:"user",content:"You are Agie, a friendly and knowledgeable water conservation expert from AGWA. Provide a mix of 8-10 engaging items for a customer. Include practical water-saving tips, surprising water trivia/facts, and at least one local-context tip for the Philippines. Format them as a fun, easy-to-read list using markdown (e.g., using emojis like  or , and bolding for emphasis)."}]);S(G)}catch(D){const M=(D==null?void 0:D.message)||"Could not fetch water saving tips at the moment.";r(M,"error"),S("Sorry, couldn't fetch tips right now. Try checking online for general water conservation advice!")}finally{P(!1)}},k=`${g.toFixed(2)}`,F=g>0&&E?`Next Due: ${Zt(E,{month:"short",day:"numeric",year:"numeric"})}`:g===0?"All bills settled!":"",O="p-5 bg-white rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 ease-in-out text-left focus:outline-none focus:ring-2 focus:ring-opacity-75 flex flex-col items-start",C=()=>u.jsx("span",{className:"font-bold",children:""});return u.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5",children:[u.jsx(di,{title:"Account Status",value:d&&!e.accountStatus?u.jsx(St,{className:"animate-spin h-5 w-5"}):e.accountStatus||"Active",icon:Ud,borderColor:"border-green-500",iconColor:"text-green-500"}),u.jsx(di,{title:"Current Balance",value:d&&g===0&&E===""?u.jsx(St,{className:"animate-spin h-5 w-5"}):k,subtext:F,icon:C,borderColor:g>0?"border-red-500":"border-green-500",iconColor:g>0?"text-red-500":"text-green-500"}),u.jsx(di,{title:"Account Number",value:e.accountNumber||"N/A",icon:ks,borderColor:"border-blue-500",iconColor:"text-blue-500"}),u.jsx(di,{title:"Service Type",value:e.serviceType||"Residential",icon:e2,borderColor:"border-purple-500",iconColor:"text-purple-500"})]}),m&&u.jsxs("div",{className:"p-4 bg-red-50 text-red-700 border border-red-200 rounded-lg text-sm flex items-center justify-center",children:[u.jsx(Xt,{size:20,className:"mr-2"})," ",m]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[u.jsxs("div",{className:"lg:col-span-2 bg-white p-5 rounded-xl shadow-lg",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-3 flex items-center",children:[u.jsx(Kl,{size:22,className:"mr-2 text-gray-500"}),"Recent Bills Summary"]}),d?u.jsx(gn,{message:"Loading recent bills..."}):o.length>0?u.jsxs("div",{className:"space-y-3",children:[o.map(D=>{var M;return u.jsxs("div",{className:`flex flex-col sm:flex-row justify-between items-start sm:items-center p-3.5 border rounded-lg hover:bg-gray-50/70 transition-colors duration-150 ${D.status==="Paid"?"border-green-200 bg-green-50/50":"border-yellow-200 bg-yellow-50/30"}`,children:[u.jsxs("div",{children:[u.jsxs("p",{className:"font-medium text-gray-800 text-sm",children:[D.monthYear||D.billingPeriod," - ",u.jsxs("span",{className:"font-bold",children:["",(M=D.amount)==null?void 0:M.toFixed(2)]})]}),u.jsxs("p",{className:`text-xs mt-0.5 font-semibold ${D.status==="Paid"?"text-green-600":"text-orange-600"}`,children:["Status: ",D.status," ",D.status==="Unpaid"&&`(Due: ${Zt(D.dueDate,{month:"short",day:"numeric"})})`]})]}),u.jsxs("div",{className:"flex gap-2 mt-2 sm:mt-0",children:[D.status==="Unpaid"&&u.jsx("button",{onClick:()=>i("myBills"),className:"text-xs bg-red-500 hover:bg-red-600 text-white py-1.5 px-3 rounded-md transition-all active:scale-95 font-medium",children:"Pay Now"}),u.jsx("button",{onClick:()=>i("myBills"),className:"text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 py-1.5 px-3 rounded-md transition-all font-medium",children:"View Details"})]})]},D.id)}),u.jsx("button",{onClick:()=>i("myBills"),className:"mt-3 text-sm text-blue-600 hover:text-blue-800 font-medium hover:underline",children:"View All Bills & Payment History "})]}):u.jsxs("div",{className:"text-sm text-gray-500 py-4 text-center",children:[u.jsx(An,{size:24,className:"mx-auto mb-1 text-gray-400"}),"No recent bills to display. All up to date!"]})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("button",{onClick:()=>i("myBills"),className:`${O} focus:ring-green-500 border-l-4 border-green-500`,children:[u.jsx(_P,{size:26,className:"mb-2 text-green-500"}),u.jsx("h4",{className:"font-semibold text-green-700 text-md",children:"Pay My Bill"}),u.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"View outstanding bills and make (simulated) payments."})]}),u.jsxs("button",{onClick:()=>i("reportIssue"),className:`${O} focus:ring-orange-500 border-l-4 border-orange-500`,children:[u.jsx(Xt,{size:26,className:"mb-2 text-orange-500"}),u.jsx("h4",{className:"font-semibold text-orange-700 text-md",children:"Report an Issue"}),u.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Report leaks, service interruptions, or other concerns."})]}),u.jsxs("button",{onClick:j,className:`${O} focus:ring-teal-500 border-l-4 border-teal-500`,disabled:N,children:[u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsx(Rs,{size:26,className:"mb-2 text-teal-500"}),N&&u.jsx(St,{className:"animate-spin text-teal-500",size:20})]}),u.jsx("h4",{className:"font-semibold text-teal-700 text-md",children:N?"Getting Tips...":" Get Water Saving Tips"}),u.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Discover ways to conserve water and save money."})]})]})]}),u.jsx(Or,{isOpen:I,onClose:()=>R(!1),title:" Water Saving Tips by Agie",size:"lg",children:N?u.jsx("div",{className:"flex justify-center items-center h-40",children:u.jsx(gn,{message:"Agie is thinking of the best tips for you..."})}):u.jsx("div",{className:"prose prose-sm sm:prose max-w-none whitespace-pre-line p-2 leading-relaxed text-gray-700",children:w||"No tips available at the moment. Please try again!"})})]})};var jP="clover",H9=function(e){return e===3?"v3":e},OP="https://js.stripe.com",$9="".concat(OP,"/").concat(jP,"/stripe.js"),W9=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,G9=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var K9=function(e){return W9.test(e)||G9.test(e)},Y9=function(){for(var e=document.querySelectorAll('script[src^="'.concat(OP,'"]')),t=0;t<e.length;t++){var r=e[t];if(K9(r.src))return r}return null},bS=function(e){var t="",r=document.createElement("script");r.src="".concat($9).concat(t);var i=document.head||document.body;if(!i)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return i.appendChild(r),r},Z9=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"8.2.0",startTime:t})},Nh=null,Np=null,Ip=null,Q9=function(e){return function(t){e(new Error("Failed to load Stripe.js",{cause:t}))}},X9=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},J9=function(e){return Nh!==null?Nh:(Nh=new Promise(function(t,r){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe){t(window.Stripe);return}try{var i=Y9();if(!(i&&e)){if(!i)i=bS(e);else if(i&&Ip!==null&&Np!==null){var s;i.removeEventListener("load",Ip),i.removeEventListener("error",Np),(s=i.parentNode)===null||s===void 0||s.removeChild(i),i=bS(e)}}Ip=X9(t,r),Np=Q9(r),i.addEventListener("load",Ip),i.addEventListener("error",Np)}catch(o){r(o);return}}),Nh.catch(function(t){return Nh=null,Promise.reject(t)}))},eF=function(e,t,r){if(e===null)return null;var i=t[0],s=i.match(/^pk_test/),o=H9(e.version),l=jP;s&&o!==l&&console.warn("Stripe.js@".concat(o," was loaded on the page, but @stripe/stripe-js@").concat("8.2.0"," expected Stripe.js@").concat(l,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var d=e.apply(void 0,t);return Z9(d,r),d},Ih,MP=!1,DP=function(){return Ih||(Ih=J9(null).catch(function(e){return Ih=null,Promise.reject(e)}),Ih)};Promise.resolve().then(function(){return DP()}).catch(function(n){MP||console.warn(n)});var tF=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];MP=!0;var i=Date.now();return DP().then(function(s){return eF(s,t,i)})};const nF=tF(void 0),rF=()=>nF,iF=async(n,e,t,r,i)=>{try{const o=z4().currentUser;if(!o)throw new Error("User not authenticated.");const l=await o.getIdToken(),d=Math.round(e*100),f=await fetch("/api/createStripeCheckoutSession",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({billId:n,amount:d,userEmail:t,userId:r,accountNumber:i,successUrl:`${window.location.origin}/dashboard?payment=success&session_id={CHECKOUT_SESSION_ID}`,cancelUrl:`${window.location.origin}/dashboard?payment=cancel`})});if(!f.ok){let y=`API Error: ${f.statusText}`;try{y=(await f.json()).error||"Failed to create session from API"}catch{y=`API route returned an invalid or empty response. Status: ${f.status}.`}throw new Error(y)}const m=await f.json();if(!m||!m.sessionUrl)throw new Error("Invalid response from checkout session API. Missing sessionUrl.");return m.sessionUrl}catch(s){throw console.error("Error creating checkout session:",s),new Error(s.message||"Could not connect to payment service.")}},sF=({isOpen:n,onClose:e,billToPay:t,userData:r,showNotification:i,stripePromise:s})=>{var y;const[o,l]=ee.useState(!1),[d,f]=ee.useState(""),m=async()=>{if(l(!0),f(""),!s||!t||!r){f("Payment system is not initialized."),l(!1);return}try{const g=await iF(t.id,t.amount,r.email,r.uid,r.accountNumber);if(g)window.location.href=g;else throw new Error("Did not receive a valid session URL.")}catch(g){const _="Failed to create payment session. This could be a temporary network issue or a problem with the payment service. Please try again in a moment. (Error: "+(g.message||"Unknown")+")";f(_),i("Failed to create payment session. Please try again.","error"),l(!1)}};return n?u.jsx(Or,{isOpen:n,onClose:e,title:"Secure Payment with Stripe",size:"md",children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg text-center",children:[u.jsx("p",{className:"text-sm text-blue-700",children:"You are paying for bill:"}),u.jsx("p",{className:"font-bold text-lg text-blue-800",children:t.monthYear}),u.jsxs("div",{className:"mt-2 text-3xl font-bold text-gray-800",children:["",((y=t.amount)==null?void 0:y.toFixed(2))||"0.00"]})]}),d&&u.jsxs("div",{className:"p-3 bg-red-100 border border-red-300 text-red-700 rounded-lg text-sm flex items-center gap-2",children:[u.jsx(Xt,{size:18}),u.jsx("span",{children:d})]}),u.jsxs("div",{className:"pt-6 border-t border-gray-200",children:[u.jsx("button",{onClick:m,className:"w-full flex items-center justify-center py-3 px-4 bg-blue-600 text-white font-bold rounded-lg text-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors",disabled:o,children:o?u.jsxs(u.Fragment,{children:[u.jsx(St,{className:"animate-spin mr-2"})," Processing..."]}):u.jsxs(u.Fragment,{children:[" ",u.jsx(_P,{className:"mr-2",size:20})," Proceed to Secure Checkout"]})}),u.jsx("p",{className:"text-xs text-center text-gray-500 mt-2",children:"You will be redirected to Stripe to complete your payment."})]})]})}):null},LP=({value:n})=>{if(!n)return null;const e=r=>{const i={0:"1101100",1:"1100110",2:"1001101",3:"1011001",4:"1010011",5:"1100101",6:"1000111",7:"1011100",8:"1110100",9:"1110010","-":"1001011"},s="11010010000",o="1100011101011";let l=s;for(const d of r)i[d]&&(l+=i[d]);return l+=o,l.split("").map((d,f)=>u.jsx("div",{className:`h-full ${d==="1"?"bg-black":"bg-transparent"}`,style:{width:"2px"}},f))},t=n.replace(/[^0-9-]/g,"");return u.jsxs("div",{className:"flex flex-col items-center justify-center",children:[u.jsx("div",{className:"flex h-16 items-stretch","aria-label":`Barcode for ${t}`,children:e(t)}),u.jsx("p",{className:"tracking-widest text-xs font-mono mt-1",children:t})]})};/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:FP,setPrototypeOf:wS,isFrozen:oF,getPrototypeOf:aF,getOwnPropertyDescriptor:lF}=Object;let{freeze:fi,seal:js,create:yx}=Object,{apply:vx,construct:_x}=typeof Reflect<"u"&&Reflect;fi||(fi=function(e){return e});js||(js=function(e){return e});vx||(vx=function(e,t){for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];return e.apply(t,i)});_x||(_x=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return new e(...r)});const kp=mi(Array.prototype.forEach),cF=mi(Array.prototype.lastIndexOf),ES=mi(Array.prototype.pop),kh=mi(Array.prototype.push),uF=mi(Array.prototype.splice),ug=mi(String.prototype.toLowerCase),Pv=mi(String.prototype.toString),Rv=mi(String.prototype.match),Ch=mi(String.prototype.replace),dF=mi(String.prototype.indexOf),hF=mi(String.prototype.trim),to=mi(Object.prototype.hasOwnProperty),li=mi(RegExp.prototype.test),Ph=fF(TypeError);function mi(n){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return vx(n,e,r)}}function fF(n){return function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return _x(n,t)}}function zt(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:ug;wS&&wS(n,null);let r=e.length;for(;r--;){let i=e[r];if(typeof i=="string"){const s=t(i);s!==i&&(oF(e)||(e[r]=s),i=s)}n[i]=!0}return n}function mF(n){for(let e=0;e<n.length;e++)to(n,e)||(n[e]=null);return n}function da(n){const e=yx(null);for(const[t,r]of FP(n))to(n,t)&&(Array.isArray(r)?e[t]=mF(r):r&&typeof r=="object"&&r.constructor===Object?e[t]=da(r):e[t]=r);return e}function Rh(n,e){for(;n!==null;){const r=lF(n,e);if(r){if(r.get)return mi(r.get);if(typeof r.value=="function")return mi(r.value)}n=aF(n)}function t(){return null}return t}const TS=fi(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),jv=fi(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Ov=fi(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),pF=fi(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Mv=fi(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),gF=fi(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),SS=fi(["#text"]),AS=fi(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Dv=fi(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),NS=fi(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),Cp=fi(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),yF=js(/\{\{[\w\W]*|[\w\W]*\}\}/gm),vF=js(/<%[\w\W]*|[\w\W]*%>/gm),_F=js(/\$\{[\w\W]*/gm),xF=js(/^data-[\-\w.\u00B7-\uFFFF]+$/),bF=js(/^aria-[\-\w]+$/),VP=js(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),wF=js(/^(?:\w+script|data):/i),EF=js(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),zP=js(/^html$/i),TF=js(/^[a-z][.\w]*(-[.\w]+)+$/i);var IS=Object.freeze({__proto__:null,ARIA_ATTR:bF,ATTR_WHITESPACE:EF,CUSTOM_ELEMENT:TF,DATA_ATTR:xF,DOCTYPE_NAME:zP,ERB_EXPR:vF,IS_ALLOWED_URI:VP,IS_SCRIPT_OR_DATA:wF,MUSTACHE_EXPR:yF,TMPLIT_EXPR:_F});const jh={element:1,text:3,progressingInstruction:7,comment:8,document:9},SF=function(){return typeof window>"u"?null:window},AF=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let r=null;const i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(r=t.getAttribute(i));const s="dompurify"+(r?"#"+r:"");try{return e.createPolicy(s,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},kS=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function BP(){let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:SF();const e=Qe=>BP(Qe);if(e.version="3.3.0",e.removed=[],!n||!n.document||n.document.nodeType!==jh.document||!n.Element)return e.isSupported=!1,e;let{document:t}=n;const r=t,i=r.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:l,Element:d,NodeFilter:f,NamedNodeMap:m=n.NamedNodeMap||n.MozNamedAttrMap,HTMLFormElement:y,DOMParser:g,trustedTypes:_}=n,E=d.prototype,x=Rh(E,"cloneNode"),w=Rh(E,"remove"),S=Rh(E,"nextSibling"),N=Rh(E,"childNodes"),P=Rh(E,"parentNode");if(typeof o=="function"){const Qe=t.createElement("template");Qe.content&&Qe.content.ownerDocument&&(t=Qe.content.ownerDocument)}let I,R="";const{implementation:U,createNodeIterator:j,createDocumentFragment:k,getElementsByTagName:F}=t,{importNode:O}=r;let C=kS();e.isSupported=typeof FP=="function"&&typeof P=="function"&&U&&U.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:D,ERB_EXPR:M,TMPLIT_EXPR:$,DATA_ATTR:G,ARIA_ATTR:re,IS_SCRIPT_OR_DATA:oe,ATTR_WHITESPACE:ie,CUSTOM_ELEMENT:X}=IS;let{IS_ALLOWED_URI:Y}=IS,B=null;const Z=zt({},[...TS,...jv,...Ov,...Mv,...SS]);let te=null;const se=zt({},[...AS,...Dv,...NS,...Cp]);let ae=Object.seal(yx(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Q=null,ce=null;const me=Object.seal(yx(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let ge=!0,Ae=!0,Ve=!1,Ye=!0,Ge=!1,ot=!0,nt=!1,It=!1,Gt=!1,Se=!1,Ne=!1,De=!1,ze=!0,ke=!1;const gt="user-content-";let mt=!0,pt=!1,Ct={},Mt=null;const Dt=zt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let rs=null;const Ht=zt({},["audio","video","img","source","image","track"]);let On=null;const is=zt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Vi="http://www.w3.org/1998/Math/MathML",pi="http://www.w3.org/2000/svg",pr="http://www.w3.org/1999/xhtml";let gi=pr,ei=!1,zi=null;const ao=zt({},[Vi,pi,pr],Pv);let yi=zt({},["mi","mo","mn","ms","mtext"]),Yn=zt({},["annotation-xml"]);const ti=zt({},["title","style","font","a","script"]);let vi=null;const _i=["application/xhtml+xml","text/html"],Fo="text/html";let yn=null,xi=null;const Bi=t.createElement("form"),ss=function(fe){return fe instanceof RegExp||fe instanceof Function},xn=function(){let fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(xi&&xi===fe)){if((!fe||typeof fe!="object")&&(fe={}),fe=da(fe),vi=_i.indexOf(fe.PARSER_MEDIA_TYPE)===-1?Fo:fe.PARSER_MEDIA_TYPE,yn=vi==="application/xhtml+xml"?Pv:ug,B=to(fe,"ALLOWED_TAGS")?zt({},fe.ALLOWED_TAGS,yn):Z,te=to(fe,"ALLOWED_ATTR")?zt({},fe.ALLOWED_ATTR,yn):se,zi=to(fe,"ALLOWED_NAMESPACES")?zt({},fe.ALLOWED_NAMESPACES,Pv):ao,On=to(fe,"ADD_URI_SAFE_ATTR")?zt(da(is),fe.ADD_URI_SAFE_ATTR,yn):is,rs=to(fe,"ADD_DATA_URI_TAGS")?zt(da(Ht),fe.ADD_DATA_URI_TAGS,yn):Ht,Mt=to(fe,"FORBID_CONTENTS")?zt({},fe.FORBID_CONTENTS,yn):Dt,Q=to(fe,"FORBID_TAGS")?zt({},fe.FORBID_TAGS,yn):da({}),ce=to(fe,"FORBID_ATTR")?zt({},fe.FORBID_ATTR,yn):da({}),Ct=to(fe,"USE_PROFILES")?fe.USE_PROFILES:!1,ge=fe.ALLOW_ARIA_ATTR!==!1,Ae=fe.ALLOW_DATA_ATTR!==!1,Ve=fe.ALLOW_UNKNOWN_PROTOCOLS||!1,Ye=fe.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Ge=fe.SAFE_FOR_TEMPLATES||!1,ot=fe.SAFE_FOR_XML!==!1,nt=fe.WHOLE_DOCUMENT||!1,Se=fe.RETURN_DOM||!1,Ne=fe.RETURN_DOM_FRAGMENT||!1,De=fe.RETURN_TRUSTED_TYPE||!1,Gt=fe.FORCE_BODY||!1,ze=fe.SANITIZE_DOM!==!1,ke=fe.SANITIZE_NAMED_PROPS||!1,mt=fe.KEEP_CONTENT!==!1,pt=fe.IN_PLACE||!1,Y=fe.ALLOWED_URI_REGEXP||VP,gi=fe.NAMESPACE||pr,yi=fe.MATHML_TEXT_INTEGRATION_POINTS||yi,Yn=fe.HTML_INTEGRATION_POINTS||Yn,ae=fe.CUSTOM_ELEMENT_HANDLING||{},fe.CUSTOM_ELEMENT_HANDLING&&ss(fe.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(ae.tagNameCheck=fe.CUSTOM_ELEMENT_HANDLING.tagNameCheck),fe.CUSTOM_ELEMENT_HANDLING&&ss(fe.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(ae.attributeNameCheck=fe.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),fe.CUSTOM_ELEMENT_HANDLING&&typeof fe.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(ae.allowCustomizedBuiltInElements=fe.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Ge&&(Ae=!1),Ne&&(Se=!0),Ct&&(B=zt({},SS),te=[],Ct.html===!0&&(zt(B,TS),zt(te,AS)),Ct.svg===!0&&(zt(B,jv),zt(te,Dv),zt(te,Cp)),Ct.svgFilters===!0&&(zt(B,Ov),zt(te,Dv),zt(te,Cp)),Ct.mathMl===!0&&(zt(B,Mv),zt(te,NS),zt(te,Cp))),fe.ADD_TAGS&&(typeof fe.ADD_TAGS=="function"?me.tagCheck=fe.ADD_TAGS:(B===Z&&(B=da(B)),zt(B,fe.ADD_TAGS,yn))),fe.ADD_ATTR&&(typeof fe.ADD_ATTR=="function"?me.attributeCheck=fe.ADD_ATTR:(te===se&&(te=da(te)),zt(te,fe.ADD_ATTR,yn))),fe.ADD_URI_SAFE_ATTR&&zt(On,fe.ADD_URI_SAFE_ATTR,yn),fe.FORBID_CONTENTS&&(Mt===Dt&&(Mt=da(Mt)),zt(Mt,fe.FORBID_CONTENTS,yn)),mt&&(B["#text"]=!0),nt&&zt(B,["html","head","body"]),B.table&&(zt(B,["tbody"]),delete Q.tbody),fe.TRUSTED_TYPES_POLICY){if(typeof fe.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ph('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof fe.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ph('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');I=fe.TRUSTED_TYPES_POLICY,R=I.createHTML("")}else I===void 0&&(I=AF(_,i)),I!==null&&typeof R=="string"&&(R=I.createHTML(""));fi&&fi(fe),xi=fe}},Ls=zt({},[...jv,...Ov,...pF]),Mr=zt({},[...Mv,...gF]),Fs=function(fe){let je=P(fe);(!je||!je.tagName)&&(je={namespaceURI:gi,tagName:"template"});const Ke=ug(fe.tagName),Kt=ug(je.tagName);return zi[fe.namespaceURI]?fe.namespaceURI===pi?je.namespaceURI===pr?Ke==="svg":je.namespaceURI===Vi?Ke==="svg"&&(Kt==="annotation-xml"||yi[Kt]):!!Ls[Ke]:fe.namespaceURI===Vi?je.namespaceURI===pr?Ke==="math":je.namespaceURI===pi?Ke==="math"&&Yn[Kt]:!!Mr[Ke]:fe.namespaceURI===pr?je.namespaceURI===pi&&!Yn[Kt]||je.namespaceURI===Vi&&!yi[Kt]?!1:!Mr[Ke]&&(ti[Ke]||!Ls[Ke]):!!(vi==="application/xhtml+xml"&&zi[fe.namespaceURI]):!1},ln=function(fe){kh(e.removed,{element:fe});try{P(fe).removeChild(fe)}catch{w(fe)}},$e=function(fe,je){try{kh(e.removed,{attribute:je.getAttributeNode(fe),from:je})}catch{kh(e.removed,{attribute:null,from:je})}if(je.removeAttribute(fe),fe==="is")if(Se||Ne)try{ln(je)}catch{}else try{je.setAttribute(fe,"")}catch{}},Er=function(fe){let je=null,Ke=null;if(Gt)fe="<remove></remove>"+fe;else{const bn=Rv(fe,/^[\r\n\t ]+/);Ke=bn&&bn[0]}vi==="application/xhtml+xml"&&gi===pr&&(fe='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+fe+"</body></html>");const Kt=I?I.createHTML(fe):fe;if(gi===pr)try{je=new g().parseFromString(Kt,vi)}catch{}if(!je||!je.documentElement){je=U.createDocument(gi,"template",null);try{je.documentElement.innerHTML=ei?R:Kt}catch{}}const Nt=je.body||je.documentElement;return fe&&Ke&&Nt.insertBefore(t.createTextNode(Ke),Nt.childNodes[0]||null),gi===pr?F.call(je,nt?"html":"body")[0]:nt?je.documentElement:Nt},Vs=function(fe){return j.call(fe.ownerDocument||fe,fe,f.SHOW_ELEMENT|f.SHOW_COMMENT|f.SHOW_TEXT|f.SHOW_PROCESSING_INSTRUCTION|f.SHOW_CDATA_SECTION,null)},lo=function(fe){return fe instanceof y&&(typeof fe.nodeName!="string"||typeof fe.textContent!="string"||typeof fe.removeChild!="function"||!(fe.attributes instanceof m)||typeof fe.removeAttribute!="function"||typeof fe.setAttribute!="function"||typeof fe.namespaceURI!="string"||typeof fe.insertBefore!="function"||typeof fe.hasChildNodes!="function")},os=function(fe){return typeof l=="function"&&fe instanceof l};function gr(Qe,fe,je){kp(Qe,Ke=>{Ke.call(e,fe,je,xi)})}const Tr=function(fe){let je=null;if(gr(C.beforeSanitizeElements,fe,null),lo(fe))return ln(fe),!0;const Ke=yn(fe.nodeName);if(gr(C.uponSanitizeElement,fe,{tagName:Ke,allowedTags:B}),ot&&fe.hasChildNodes()&&!os(fe.firstElementChild)&&li(/<[/\w!]/g,fe.innerHTML)&&li(/<[/\w!]/g,fe.textContent)||fe.nodeType===jh.progressingInstruction||ot&&fe.nodeType===jh.comment&&li(/<[/\w]/g,fe.data))return ln(fe),!0;if(!(me.tagCheck instanceof Function&&me.tagCheck(Ke))&&(!B[Ke]||Q[Ke])){if(!Q[Ke]&&Ar(Ke)&&(ae.tagNameCheck instanceof RegExp&&li(ae.tagNameCheck,Ke)||ae.tagNameCheck instanceof Function&&ae.tagNameCheck(Ke)))return!1;if(mt&&!Mt[Ke]){const Kt=P(fe)||fe.parentNode,Nt=N(fe)||fe.childNodes;if(Nt&&Kt){const bn=Nt.length;for(let kn=bn-1;kn>=0;--kn){const Zn=x(Nt[kn],!0);Zn.__removalCount=(fe.__removalCount||0)+1,Kt.insertBefore(Zn,S(fe))}}}return ln(fe),!0}return fe instanceof d&&!Fs(fe)||(Ke==="noscript"||Ke==="noembed"||Ke==="noframes")&&li(/<\/no(script|embed|frames)/i,fe.innerHTML)?(ln(fe),!0):(Ge&&fe.nodeType===jh.text&&(je=fe.textContent,kp([D,M,$],Kt=>{je=Ch(je,Kt," ")}),fe.textContent!==je&&(kh(e.removed,{element:fe.cloneNode()}),fe.textContent=je)),gr(C.afterSanitizeElements,fe,null),!1)},Sr=function(fe,je,Ke){if(ze&&(je==="id"||je==="name")&&(Ke in t||Ke in Bi))return!1;if(!(Ae&&!ce[je]&&li(G,je))){if(!(ge&&li(re,je))){if(!(me.attributeCheck instanceof Function&&me.attributeCheck(je,fe))){if(!te[je]||ce[je]){if(!(Ar(fe)&&(ae.tagNameCheck instanceof RegExp&&li(ae.tagNameCheck,fe)||ae.tagNameCheck instanceof Function&&ae.tagNameCheck(fe))&&(ae.attributeNameCheck instanceof RegExp&&li(ae.attributeNameCheck,je)||ae.attributeNameCheck instanceof Function&&ae.attributeNameCheck(je,fe))||je==="is"&&ae.allowCustomizedBuiltInElements&&(ae.tagNameCheck instanceof RegExp&&li(ae.tagNameCheck,Ke)||ae.tagNameCheck instanceof Function&&ae.tagNameCheck(Ke))))return!1}else if(!On[je]){if(!li(Y,Ch(Ke,ie,""))){if(!((je==="src"||je==="xlink:href"||je==="href")&&fe!=="script"&&dF(Ke,"data:")===0&&rs[fe])){if(!(Ve&&!li(oe,Ch(Ke,ie,"")))){if(Ke)return!1}}}}}}}return!0},Ar=function(fe){return fe!=="annotation-xml"&&Rv(fe,X)},Vo=function(fe){gr(C.beforeSanitizeAttributes,fe,null);const{attributes:je}=fe;if(!je||lo(fe))return;const Ke={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:te,forceKeepAttr:void 0};let Kt=je.length;for(;Kt--;){const Nt=je[Kt],{name:bn,namespaceURI:kn,value:Zn}=Nt,$n=yn(bn),Ui=Zn;let vn=bn==="value"?Ui:hF(Ui);if(Ke.attrName=$n,Ke.attrValue=vn,Ke.keepAttr=!0,Ke.forceKeepAttr=void 0,gr(C.uponSanitizeAttribute,fe,Ke),vn=Ke.attrValue,ke&&($n==="id"||$n==="name")&&($e(bn,fe),vn=gt+vn),ot&&li(/((--!?|])>)|<\/(style|title|textarea)/i,vn)){$e(bn,fe);continue}if($n==="attributename"&&Rv(vn,"href")){$e(bn,fe);continue}if(Ke.forceKeepAttr)continue;if(!Ke.keepAttr){$e(bn,fe);continue}if(!Ye&&li(/\/>/i,vn)){$e(bn,fe);continue}Ge&&kp([D,M,$],sr=>{vn=Ch(vn,sr," ")});const qi=yn(fe.nodeName);if(!Sr(qi,$n,vn)){$e(bn,fe);continue}if(I&&typeof _=="object"&&typeof _.getAttributeType=="function"&&!kn)switch(_.getAttributeType(qi,$n)){case"TrustedHTML":{vn=I.createHTML(vn);break}case"TrustedScriptURL":{vn=I.createScriptURL(vn);break}}if(vn!==Ui)try{kn?fe.setAttributeNS(kn,bn,vn):fe.setAttribute(bn,vn),lo(fe)?ln(fe):ES(e.removed)}catch{$e(bn,fe)}}gr(C.afterSanitizeAttributes,fe,null)},zo=function Qe(fe){let je=null;const Ke=Vs(fe);for(gr(C.beforeSanitizeShadowDOM,fe,null);je=Ke.nextNode();)gr(C.uponSanitizeShadowNode,je,null),Tr(je),Vo(je),je.content instanceof s&&Qe(je.content);gr(C.afterSanitizeShadowDOM,fe,null)};return e.sanitize=function(Qe){let fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},je=null,Ke=null,Kt=null,Nt=null;if(ei=!Qe,ei&&(Qe="<!-->"),typeof Qe!="string"&&!os(Qe))if(typeof Qe.toString=="function"){if(Qe=Qe.toString(),typeof Qe!="string")throw Ph("dirty is not a string, aborting")}else throw Ph("toString is not a function");if(!e.isSupported)return Qe;if(It||xn(fe),e.removed=[],typeof Qe=="string"&&(pt=!1),pt){if(Qe.nodeName){const Zn=yn(Qe.nodeName);if(!B[Zn]||Q[Zn])throw Ph("root node is forbidden and cannot be sanitized in-place")}}else if(Qe instanceof l)je=Er("<!---->"),Ke=je.ownerDocument.importNode(Qe,!0),Ke.nodeType===jh.element&&Ke.nodeName==="BODY"||Ke.nodeName==="HTML"?je=Ke:je.appendChild(Ke);else{if(!Se&&!Ge&&!nt&&Qe.indexOf("<")===-1)return I&&De?I.createHTML(Qe):Qe;if(je=Er(Qe),!je)return Se?null:De?R:""}je&&Gt&&ln(je.firstChild);const bn=Vs(pt?Qe:je);for(;Kt=bn.nextNode();)Tr(Kt),Vo(Kt),Kt.content instanceof s&&zo(Kt.content);if(pt)return Qe;if(Se){if(Ne)for(Nt=k.call(je.ownerDocument);je.firstChild;)Nt.appendChild(je.firstChild);else Nt=je;return(te.shadowroot||te.shadowrootmode)&&(Nt=O.call(r,Nt,!0)),Nt}let kn=nt?je.outerHTML:je.innerHTML;return nt&&B["!doctype"]&&je.ownerDocument&&je.ownerDocument.doctype&&je.ownerDocument.doctype.name&&li(zP,je.ownerDocument.doctype.name)&&(kn="<!DOCTYPE "+je.ownerDocument.doctype.name+`>
`+kn),Ge&&kp([D,M,$],Zn=>{kn=Ch(kn,Zn," ")}),I&&De?I.createHTML(kn):kn},e.setConfig=function(){let Qe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};xn(Qe),It=!0},e.clearConfig=function(){xi=null,It=!1},e.isValidAttribute=function(Qe,fe,je){xi||xn({});const Ke=yn(Qe),Kt=yn(fe);return Sr(Ke,Kt,je)},e.addHook=function(Qe,fe){typeof fe=="function"&&kh(C[Qe],fe)},e.removeHook=function(Qe,fe){if(fe!==void 0){const je=cF(C[Qe],fe);return je===-1?void 0:uF(C[Qe],je,1)[0]}return ES(C[Qe])},e.removeHooks=function(Qe){C[Qe]=[]},e.removeAllHooks=function(){C=kS()},e}var Mo=BP();const UP=({isOpen:n,onClose:e,bill:t,userData:r,calculateBillDetails:i,showNotification:s})=>{var x,w,S,N,P,I,R,U,j,k,F,O,C,D;if(!n||!t||!r)return null;const o=t.calculatedCharges||i(t.consumption,r.serviceType,r.meterSize||'1/2"'),l=(o.totalCalculatedCharges+(t.previousUnpaidAmount||0)-(t.seniorCitizenDiscount||0)).toFixed(2),d=(x=t.billDate)!=null&&x.toDate?t.billDate.toDate():null,f=d?`${d.getFullYear()}${String(d.getMonth()+1).padStart(2,"0")}${String(d.getDate()).padStart(2,"0")}`:Date.now().toString().slice(-6),m=t.invoiceNumber||`AGWA-${(w=t.id)==null?void 0:w.slice(0,4).toUpperCase()}-${f}`,y=M=>!M||typeof M!="object"?M||"N/A":[M.street,M.barangay,M.district,"Naic, Cavite"].filter(G=>G&&G.trim()).join(", "),g=()=>{const M=document.getElementById("invoice-content-to-print-modal-fullscreen");if(M){const $=Mo.sanitize(M.innerHTML),G=window.open("","_blank","height=800,width=1000,scrollbars=yes");G.document.write("<html><head><title>AGWA Water Services - Invoice</title>"),G.document.write('<script src="https://cdn.tailwindcss.com"><\/script>'),G.document.write(`
                <style>
                    body { font-family: 'Inter', sans-serif; margin: 0; padding: 15px; font-size: 9.5pt; line-height: 1.45; color: #2d3748; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                    .invoice-container-print { max-width: 820px; margin: auto; padding: 20px; background-color: #fff; position: relative; }
                    .paid-stamp {
                        position: absolute;
                        top: 40%;
                        left: 50%;
                        transform: translate(-50%, -50%) rotate(-20deg);
                        color: #e53e3e;
                        border: 5px double #e53e3e;
                        padding: 12px 30px;
                        border-radius: 6px;
                        font-family: 'Courier New', Courier, monospace;
                        text-align: center;
                        opacity: 0.6;
                        z-index: 1000;
                        pointer-events: none;
                        filter: blur(0.5px) grayscale(10%) sepia(50%) brightness(90%) contrast(120%);
                    }
                    .paid-stamp-main { font-size: 3rem; font-weight: bold; letter-spacing: 5px; line-height: 1; text-shadow: 1px 1px 0 rgba(0,0,0,0.1); }
                    .paid-stamp-date { font-size: 0.9rem; font-weight: 600; margin-top: 8px; display: block; }
                    table { width: 100%; border-collapse: collapse; margin-bottom: 10px; position: relative; z-index: 1; }
                    td, th { border: 1px solid #e2e8f0; padding: 5px 7px; text-align: left; font-size: 9pt; vertical-align: top; }
                    th { background-color: #f7fafc; font-weight: 600; color: #4a5568; }
                    .header-logo-print { font-size: 24pt; font-weight: bold; color: #2b6cb0; margin-bottom: 0px; }
                    .header-tagline-print { font-size: 8pt; color: #4299e1; margin-top: -2px; }
                    .invoice-title-print { font-size: 20pt; font-weight: bold; text-align: center; margin-bottom: 12px; margin-top: 8px; text-transform: uppercase; color: #1a202c; }
                    .section-title-print { font-weight: bold; margin-top: 12px; margin-bottom: 4px; font-size: 11pt; border-bottom: 2px solid #4a5568; padding-bottom: 3px; color: #2c5282;}
                    .text-right-print { text-align: right; }
                    .font-bold-print { font-weight: bold; }
                    .total-due-print { font-size: 14pt; font-weight: bold; color: #c53030; }
                    hr.dashed-print { border: none; border-top: 1px dashed #a0aec0; margin: 10px 0; }
                    .footer-notes-print { font-size: 8pt; text-align: center; margin-top: 20px; padding-top: 12px; border-top: 1px solid #e2e8f0; color: #4a5568; }
                    .payment-stub-print { margin-top: 20px; padding: 12px; border: 1px dashed #718096; background-color: #f8f9fa; }
                    .no-print-in-iframe { display: none !important; }
                    @media print {
                        body { margin: 0; font-size: 9.5pt; background-color: #fff; }
                        .no-print-in-iframe { display: none !important; }
                        .invoice-container-print { border: none; box-shadow: none; padding: 0;}
                        .paid-stamp { color: #e53e3e !important; border-color: #e53e3e !important; filter: blur(0.3px) grayscale(5%) sepia(40%) brightness(90%) contrast(120%); }
                        table td, table th {font-size: 8.5pt;}
                    }
                </style>
            `),G.document.write('</head><body><div class="invoice-container-print">'),G.document.write($),G.document.write("</div></body></html>"),G.document.close(),setTimeout(()=>{G.print()},700)}else s&&s("Invoice content element not found for printing.","error")},_=({label:M,value:$,valueClass:G="text-gray-800",labelWidth:re="w-2/5 sm:w-1/3",valueWidth:oe="w-3/5 sm:w-2/3"})=>u.jsxs("div",{className:"flex justify-between py-1.5 text-sm border-b border-gray-100 last:border-b-0 hover:bg-gray-50/50 px-1 -mx-1 rounded-sm",children:[u.jsxs("span",{className:`text-gray-500 ${re} pr-2`,children:[M,":"]}),u.jsx("span",{className:`${oe} text-right font-medium ${G}`,children:$})]}),E=({label:M,value:$,valueClass:G="text-gray-800",isBold:re=!1,isTotal:oe=!1})=>u.jsxs("tr",{className:`${oe?"bg-gray-100 font-semibold":"hover:bg-gray-50/50"}`,children:[u.jsx("td",{className:`py-2 px-2 ${re?"font-semibold":""}`,children:M}),u.jsx("td",{className:`py-2 px-2 text-right ${G} ${re?"font-semibold":""}`,children:$})]});return u.jsxs(Or,{isOpen:n,onClose:e,title:"",size:"full",modalDialogClassName:"sm:max-w-4xl md:max-w-5xl lg:max-w-6xl xl:max-w-7xl w-[95vw] h-[95vh]",contentClassName:"p-0",children:[u.jsx("style",{children:`
                    .paid-stamp {
                        position: absolute;
                        top: 40%;
                        left: 50%;
                        transform: translate(-50%, -50%) rotate(-20deg);
                        color: #e53e3e;
                        border: 5px double #e53e3e;
                        padding: 12px 30px;
                        border-radius: 6px;
                        font-family: 'Courier New', Courier, monospace;
                        text-align: center;
                        opacity: 0.6;
                        z-index: 1000;
                        pointer-events: none;
                        filter: blur(0.5px) grayscale(10%) sepia(50%) brightness(90%) contrast(120%);
                    }
                    .paid-stamp-main { font-size: 3rem; font-weight: bold; letter-spacing: 5px; line-height: 1; text-shadow: 1px 1px 0 rgba(0,0,0,0.1); }
                    .paid-stamp-date { font-size: 0.9rem; font-weight: 600; margin-top: 8px; display: block; }
                `}),u.jsxs("div",{className:"flex justify-between items-center p-3 sm:p-4 border-b border-gray-200 bg-slate-50 rounded-t-xl sticky top-0 z-20",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(Kl,{size:22,className:"mr-2.5 text-blue-600"}),u.jsxs("h3",{className:"text-md sm:text-lg font-semibold text-slate-800 truncate",title:m,children:["Invoice: ",m]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsxs("button",{onClick:g,className:"p-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors flex items-center focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50",title:"Print/Download Invoice",children:[u.jsx(c9,{size:16,className:"mr-0 sm:mr-1.5"})," ",u.jsx("span",{className:"hidden sm:inline",children:"Print/Save"})]}),u.jsx("button",{onClick:e,className:"p-2 text-gray-500 hover:text-gray-700 bg-gray-200 hover:bg-gray-300 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500",title:"Close Invoice View",children:u.jsx(qy,{size:18})})]})]}),u.jsx("div",{className:"overflow-y-auto flex-grow p-1",children:u.jsxs("div",{id:"invoice-content-to-print-modal-fullscreen",className:"p-3 sm:p-5 font-sans text-gray-700 text-xs sm:text-sm bg-white shadow-lg rounded-lg max-w-4xl mx-auto my-2 relative",children:[((S=t.status)==null?void 0:S.toLowerCase())==="paid"&&u.jsxs("div",{className:"paid-stamp",children:[u.jsx("div",{className:"paid-stamp-main",children:"PAID"}),u.jsx("div",{className:"paid-stamp-date",children:Zt(t.paymentDate,{year:"numeric",month:"short",day:"numeric"})})]}),u.jsxs("div",{className:"relative z-0",children:[u.jsxs("div",{className:"flex justify-between items-start mb-5 pb-4 border-b-2 border-blue-700",children:[u.jsxs("div",{children:[u.jsx("div",{className:"header-logo-print text-3xl font-bold text-blue-700",children:"AGWA"}),u.jsx("div",{className:"header-tagline-print text-xs text-blue-600 italic",children:"Ensuring Clarity, Sustaining Life."})]}),u.jsxs("div",{className:"text-right text-xs",children:[u.jsx("div",{className:"font-semibold",children:"AGWA Water Services, Inc."}),u.jsx("div",{children:"123 Aqua Drive, Hydro Business Park"}),u.jsx("div",{children:"Naic, Cavite, Philippines 4110"}),u.jsx("div",{children:"VAT Reg. TIN: 000-123-456-789"}),u.jsx("div",{className:"no-print-in-iframe",children:"Machine Serial No.: AGWAMSN001"})]})]}),u.jsx("div",{className:"invoice-title-print text-2xl font-bold text-center mb-2 text-gray-800",children:"STATEMENT OF ACCOUNT"}),u.jsxs("div",{className:"text-center text-sm mb-5",children:["Invoice No.: ",m]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 mb-5 text-xs",children:[u.jsxs("div",{className:"border border-gray-200 p-3.5 rounded-lg bg-slate-50/60 shadow-sm",children:[u.jsx("h5",{className:"font-semibold text-slate-600 mb-2 text-sm border-b pb-1.5",children:"SERVICE INFORMATION"}),u.jsx(_,{label:"Contract Acct No.",value:r.accountNumber,valueClass:"font-bold text-slate-900"}),u.jsx(_,{label:"Account Name",value:r.displayName||r.email,valueClass:"font-bold text-slate-900"}),u.jsx(_,{label:"Service Address",value:y(r.serviceAddress)}),u.jsx(_,{label:"Meter Serial No.",value:r.meterSerialNumber||"N/A"}),u.jsx(_,{label:"Rate Class",value:r.serviceType||"Residential"})]}),u.jsxs("div",{className:"border border-gray-200 p-3.5 rounded-lg bg-slate-50/60 mt-3 md:mt-0 shadow-sm",children:[u.jsx("h5",{className:"font-semibold text-slate-600 mb-2 text-sm border-b pb-1.5",children:"BILLING SUMMARY"}),u.jsx(_,{label:"Bill Date",value:Zt(t.billDate,{year:"numeric",month:"long",day:"numeric"})||"N/A"}),u.jsx(_,{label:"Billing Period",value:t.billingPeriod||t.monthYear}),u.jsx(_,{label:"Current Reading",value:`${t.currentReading??"N/A"} m`}),u.jsx(_,{label:"Previous Reading",value:`${t.prevReading??"N/A"} m`}),u.jsx(_,{label:"Consumption",value:`${o.consumption??"N/A"} m`,valueClass:"font-bold text-slate-900"})]})]}),u.jsx("hr",{className:"my-4 border-gray-300 dashed-print"}),u.jsx("div",{className:"section-title-print text-sm font-semibold text-slate-700 mb-1.5",children:"CHARGES BREAKDOWN"}),u.jsxs("table",{className:"w-full text-xs mb-4",children:[u.jsx("thead",{className:"bg-slate-100",children:u.jsxs("tr",{children:[u.jsx("th",{className:"py-2 px-2.5 text-left",children:"Description"}),u.jsx("th",{className:"py-2 px-2.5 text-right",children:"Amount (PHP)"})]})}),u.jsxs("tbody",{children:[u.jsx(E,{label:"Basic Charge",value:(N=o.basicCharge)==null?void 0:N.toFixed(2)}),u.jsx(E,{label:"Foreign Currency Differential Adj. (FCDA)",value:(P=o.fcda)==null?void 0:P.toFixed(2)}),u.jsx(E,{label:"Water Charge (Basic + FCDA)",value:(I=o.waterCharge)==null?void 0:I.toFixed(2),isBold:!0}),u.jsx(E,{label:"Environmental Charge (EC)",value:(R=o.environmentalCharge)==null?void 0:R.toFixed(2)}),u.jsx(E,{label:"Sewerage Charge (SC)",value:(U=o.sewerageCharge)==null?void 0:U.toFixed(2)}),u.jsx(E,{label:"Maintenance Service Charge",value:(j=o.maintenanceServiceCharge)==null?void 0:j.toFixed(2)}),t.seniorCitizenDiscount>0&&u.jsx(E,{label:"Senior Citizen Discount",value:`(${parseFloat(t.seniorCitizenDiscount).toFixed(2)})`,valueClass:"text-green-600"}),u.jsx(E,{label:"SUB-TOTAL (Water & Other Charges)",value:(k=o.subTotalBeforeTaxes)==null?void 0:k.toFixed(2),isTotal:!0}),u.jsx(E,{label:"Government Taxes (Local Franchise Tax)",value:(F=o.governmentTaxes)==null?void 0:F.toFixed(2)}),u.jsx(E,{label:"VATable Sales",value:(O=o.vatableSales)==null?void 0:O.toFixed(2),isTotal:!0}),u.jsx(E,{label:"VAT (12%)",value:(C=o.vat)==null?void 0:C.toFixed(2)})]})]}),u.jsx("hr",{className:"my-4 border-gray-300 dashed-print"}),u.jsxs("div",{className:"text-xs space-y-1.5 mt-1",children:[u.jsx(_,{label:"Total Current Charges",value:`PHP ${(D=o.totalCalculatedCharges)==null?void 0:D.toFixed(2)}`,valueClass:"font-bold text-slate-900 text-sm"}),u.jsx(_,{label:"Previous Unpaid Amount",value:`PHP ${(t.previousUnpaidAmount||0).toFixed(2)}`,valueClass:`font-semibold text-sm ${(t.previousUnpaidAmount||0)>0?"text-red-600":"text-slate-800"}`}),u.jsxs("div",{className:"flex justify-between items-center py-2.5 text-lg sm:text-xl border-t-2 border-b-2 border-black my-2.5 px-1",children:[u.jsx("span",{className:"font-bold text-slate-900",children:"TOTAL AMOUNT DUE"}),u.jsxs("span",{className:"font-bold text-red-600 total-due-print",children:["",l]})]}),u.jsx(_,{label:"Payment Due Date",value:Zt(t.dueDate,{weekday:"long",year:"numeric",month:"long",day:"numeric"})||"N/A",valueClass:"font-bold text-red-700 text-sm"})]}),u.jsx("hr",{className:"my-4 border-gray-300 dashed-print"}),t.paymentHistory&&t.paymentHistory.length>0&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"section-title-print text-sm font-semibold text-slate-700 mb-1.5 mt-4",children:"PAYMENT HISTORY (This Bill)"}),u.jsxs("table",{className:"w-full text-xs mb-4",children:[u.jsx("thead",{className:"bg-slate-100",children:u.jsxs("tr",{children:[u.jsx("th",{className:"py-2 px-2.5",children:"Date"}),u.jsx("th",{className:"py-2 px-2.5",children:"Ref. No."}),u.jsx("th",{className:"py-2 px-2.5 text-right",children:"Amount Paid"})]})}),u.jsx("tbody",{children:t.paymentHistory.map((M,$)=>u.jsxs("tr",{className:"hover:bg-gray-50/50",children:[u.jsx("td",{className:"py-1.5 px-2.5",children:Zt(M.postingDate)}),u.jsx("td",{className:"py-1.5 px-2.5",children:M.referenceNo}),u.jsx("td",{className:"py-1.5 px-2.5 text-right",children:parseFloat(M.amount).toFixed(2)})]},$))})]}),u.jsx("hr",{className:"my-4 border-gray-300 dashed-print"})]}),u.jsxs("div",{className:"footer-notes-print text-xs text-center my-4 space-y-1 text-gray-600",children:[u.jsx("p",{className:"no-print-in-iframe",children:"BIR Permit No. AGWA-001-012025-000001 | Date Issued: 01/01/2025"}),u.jsx("p",{children:"Please settle your account on or before the due date to avoid disconnection and late payment penalties."}),u.jsx("p",{className:"font-semibold",children:"CUSTOMER SERVICE: 1627-AGWA | support@agwa-waterservices.com.ph"})]}),u.jsxs("div",{className:"payment-stub-print mt-5 p-3.5 border-t-2 border-dashed border-gray-500 text-xs no-print-in-iframe",children:[u.jsx("h5",{className:"font-bold text-center mb-2 text-slate-700 text-sm",children:"PAYMENT STUB (For Accredited Centers)"}),u.jsx(_,{label:"Acct. No.",value:r.accountNumber,valueClass:"font-bold"}),u.jsx(_,{label:"Acct. Name",value:r.displayName||r.email}),u.jsx(_,{label:"Invoice No.",value:m}),u.jsx(_,{label:"Amount Due",value:`${l}`,valueClass:"font-bold text-lg"}),u.jsx(_,{label:"Due Date",value:Zt(t.dueDate,{month:"long",day:"numeric",year:"numeric"}),valueClass:"font-bold"}),u.jsx("div",{className:"py-2",children:u.jsx(LP,{value:m})})]})]})]})})]})},NF=({user:n,userData:e,db:t,showNotification:r,billingService:i,systemSettings:s={}})=>{const[o,l]=ee.useState([]),[d,f]=ee.useState(!0),[m,y]=ee.useState(""),[g,_]=ee.useState(null),[E,x]=ee.useState(!1),[w,S]=ee.useState(null),[N,P]=ee.useState(""),[I,R]=ee.useState(!1),[U,j]=ee.useState(null),[k,F]=ee.useState(!1),{isOnlinePaymentsEnabled:O=!0}=s,C=rF(),D=JSON.stringify(s),M=JSON.stringify(e),$=ee.useCallback(async()=>{f(!0),y("");const X=JSON.parse(M);if(!(n!=null&&n.uid)||!(X!=null&&X.serviceType)){y("Missing user data for fetching bills."),f(!1);return}const Y=await vm(t,n.uid);if(Y.success){const B=JSON.parse(D),te=Y.data.sort((se,ae)=>{var me,ge;const Q=(me=se.billDate)!=null&&me.toDate?se.billDate.toDate():new Date(0);return((ge=ae.billDate)!=null&&ge.toDate?ae.billDate.toDate():new Date(0))-Q}).map(se=>{const ae=i(se.consumption??0,X.serviceType,X.meterSize,B),Q=(ae.totalCalculatedCharges||0)+(se.previousUnpaidAmount||0)-(se.seniorCitizenDiscount||0);return{...se,amount:Q,calculatedCharges:ae}}).filter(se=>se.amount!==void 0);l(te)}else y(Y.error||"Failed to fetch your bills."),r(Y.error||"Failed to fetch bills.","error");f(!1)},[t,n==null?void 0:n.uid,r,i,M,D]);ee.useEffect(()=>{$()},[$]),ee.useEffect(()=>{const X=new URLSearchParams(window.location.search);if(X.get("payment")==="success"){r("Payment successful! Your bill is being updated.","success"),$();const Y=window.location.pathname;window.history.replaceState({},document.title,Y)}if(X.get("payment")==="cancel"){r("Payment was cancelled. Your bill remains unpaid.","warning");const Y=window.location.pathname;window.history.replaceState({},document.title,Y)}},[$,r]);const G=X=>{_(X),x(!0)},re=async X=>{if(!X||!X.calculatedCharges){r("Bill details unavailable for explanation.","warning");return}S(X),P(""),R(!0);try{const Y=await U9({billDetails:X,charges:X.calculatedCharges,customerName:e.displayName||"Valued Customer",serviceType:e.serviceType||"Residential"});P(Y)}catch(Y){const B=(Y==null?void 0:Y.message)||"AI explanation failed.";P("<p>Sorry, an error occurred while generating the explanation. Please view the detailed invoice instead.</p>"),r(B,"error")}finally{R(!1)}},oe=X=>{j(X),F(!0)},ie=X=>{var Z,te;if(X.invoiceNumber)return X.invoiceNumber;const Y=(Z=X.billDate)!=null&&Z.toDate?X.billDate.toDate():null,B=Y?`${Y.getFullYear()}${String(Y.getMonth()+1).padStart(2,"0")}${String(Y.getDate()).padStart(2,"0")}`:Date.now().toString().slice(-6);return`AGWA-${(te=X.id)==null?void 0:te.slice(0,4).toUpperCase()}-${B}`};return d?u.jsx(gn,{message:"Loading your bills..."}):u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center mb-6 pb-4 border-b border-gray-200",children:[u.jsx(Kl,{size:30,className:"mr-3 text-blue-600"})," My Bills & Payment History"]}),m&&u.jsx("div",{className:"text-red-500 bg-red-50 p-3 rounded-md text-center",children:m}),o.length===0&&!m&&u.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner",children:[u.jsx(An,{size:48,className:"mx-auto text-gray-400 mb-4"}),u.jsx("p",{className:"text-gray-600 text-lg",children:"No billing history found."})]}),u.jsx("div",{className:"space-y-4",children:o.map(X=>{var B;const Y=ie(X);return u.jsxs("div",{className:`p-4 rounded-lg shadow-md border-l-4 ${X.status==="Paid"?"bg-green-50 border-green-400":"bg-yellow-50 border-yellow-400"}`,children:[u.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-2",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:X.monthYear||X.billingPeriod||"N/A"}),u.jsxs("p",{className:"text-sm text-gray-600",children:["Due: ",Zt(X.dueDate,{month:"long",day:"numeric"})]}),u.jsxs("p",{className:"text-xs text-gray-500 mt-1",title:Y,children:["Invoice No: ",Y]})]}),u.jsxs("div",{className:"text-right",children:[u.jsxs("p",{className:"text-2xl font-bold text-gray-700",children:["",((B=X.amount)==null?void 0:B.toFixed(2))??"0.00"]}),u.jsx("p",{className:`text-sm font-semibold ${X.status==="Paid"?"text-green-600":"text-red-600"}`,children:X.status||"Unknown"})]})]}),u.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200/80 flex flex-wrap gap-2 justify-end",children:[u.jsxs("button",{onClick:()=>oe(X),className:"text-xs font-medium bg-blue-100 text-blue-700 hover:bg-blue-200 px-3 py-1.5 rounded-md transition flex items-center",children:[u.jsx(Gl,{size:14,className:"mr-1"}),"View Invoice"]}),u.jsxs("button",{onClick:()=>re(X),className:"text-xs font-medium bg-purple-100 text-purple-700 hover:bg-purple-200 px-3 py-1.5 rounded-md transition flex items-center",disabled:I&&(w==null?void 0:w.id)===X.id,children:[I&&(w==null?void 0:w.id)===X.id?u.jsx(St,{size:14,className:"animate-spin mr-1"}):u.jsx(Rs,{size:14,className:"mr-1"})," Explain Bill (AI)"]}),X.status==="Unpaid"&&O&&u.jsxs("button",{onClick:()=>G(X),className:"text-xs font-bold bg-green-500 text-white hover:bg-green-600 px-4 py-1.5 rounded-md transition flex items-center",children:[u.jsx("span",{className:"mr-1 font-bold",children:""})," Pay Now"]})]})]},X.id)})}),u.jsx(Or,{isOpen:!!w,onClose:()=>S(null),title:` AI Explanation for ${(w==null?void 0:w.monthYear)||"Bill"}`,size:"lg",children:I?u.jsx(gn,{message:"Agie is analyzing your bill..."}):u.jsx("div",{className:"prose prose-sm max-w-none leading-relaxed p-2",dangerouslySetInnerHTML:{__html:Mo.sanitize(N||"")}})}),E&&g&&u.jsx(sF,{isOpen:E,onClose:()=>x(!1),billToPay:g,userData:e,showNotification:r,stripePromise:C}),k&&U&&u.jsx(UP,{isOpen:k,onClose:()=>F(!1),bill:U,userData:e,calculateBillDetails:i,showNotification:r})]})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function _m(n){return n+.5|0}const Cl=(n,e,t)=>Math.max(Math.min(n,t),e);function Qh(n){return Cl(_m(n*2.55),0,255)}function Vl(n){return Cl(_m(n*255),0,255)}function ma(n){return Cl(_m(n/2.55)/100,0,1)}function CS(n){return Cl(_m(n*100),0,100)}const xs={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},xx=[..."0123456789ABCDEF"],IF=n=>xx[n&15],kF=n=>xx[(n&240)>>4]+xx[n&15],Pp=n=>(n&240)>>4===(n&15),CF=n=>Pp(n.r)&&Pp(n.g)&&Pp(n.b)&&Pp(n.a);function PF(n){var e=n.length,t;return n[0]==="#"&&(e===4||e===5?t={r:255&xs[n[1]]*17,g:255&xs[n[2]]*17,b:255&xs[n[3]]*17,a:e===5?xs[n[4]]*17:255}:(e===7||e===9)&&(t={r:xs[n[1]]<<4|xs[n[2]],g:xs[n[3]]<<4|xs[n[4]],b:xs[n[5]]<<4|xs[n[6]],a:e===9?xs[n[7]]<<4|xs[n[8]]:255})),t}const RF=(n,e)=>n<255?e(n):"";function jF(n){var e=CF(n)?IF:kF;return n?"#"+e(n.r)+e(n.g)+e(n.b)+RF(n.a,e):void 0}const OF=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function qP(n,e,t){const r=e*Math.min(t,1-t),i=(s,o=(s+n/30)%12)=>t-r*Math.max(Math.min(o-3,9-o,1),-1);return[i(0),i(8),i(4)]}function MF(n,e,t){const r=(i,s=(i+n/60)%6)=>t-t*e*Math.max(Math.min(s,4-s,1),0);return[r(5),r(3),r(1)]}function DF(n,e,t){const r=qP(n,1,.5);let i;for(e+t>1&&(i=1/(e+t),e*=i,t*=i),i=0;i<3;i++)r[i]*=1-e-t,r[i]+=e;return r}function LF(n,e,t,r,i){return n===i?(e-t)/r+(e<t?6:0):e===i?(t-n)/r+2:(n-e)/r+4}function s2(n){const t=n.r/255,r=n.g/255,i=n.b/255,s=Math.max(t,r,i),o=Math.min(t,r,i),l=(s+o)/2;let d,f,m;return s!==o&&(m=s-o,f=l>.5?m/(2-s-o):m/(s+o),d=LF(t,r,i,m,s),d=d*60+.5),[d|0,f||0,l]}function o2(n,e,t,r){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,r)).map(Vl)}function a2(n,e,t){return o2(qP,n,e,t)}function FF(n,e,t){return o2(DF,n,e,t)}function VF(n,e,t){return o2(MF,n,e,t)}function HP(n){return(n%360+360)%360}function zF(n){const e=OF.exec(n);let t=255,r;if(!e)return;e[5]!==r&&(t=e[6]?Qh(+e[5]):Vl(+e[5]));const i=HP(+e[2]),s=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?r=FF(i,s,o):e[1]==="hsv"?r=VF(i,s,o):r=a2(i,s,o),{r:r[0],g:r[1],b:r[2],a:t}}function BF(n,e){var t=s2(n);t[0]=HP(t[0]+e),t=a2(t),n.r=t[0],n.g=t[1],n.b=t[2]}function UF(n){if(!n)return;const e=s2(n),t=e[0],r=CS(e[1]),i=CS(e[2]);return n.a<255?`hsla(${t}, ${r}%, ${i}%, ${ma(n.a)})`:`hsl(${t}, ${r}%, ${i}%)`}const PS={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},RS={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function qF(){const n={},e=Object.keys(RS),t=Object.keys(PS);let r,i,s,o,l;for(r=0;r<e.length;r++){for(o=l=e[r],i=0;i<t.length;i++)s=t[i],l=l.replace(s,PS[s]);s=parseInt(RS[o],16),n[l]=[s>>16&255,s>>8&255,s&255]}return n}let Rp;function HF(n){Rp||(Rp=qF(),Rp.transparent=[0,0,0,0]);const e=Rp[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const $F=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function WF(n){const e=$F.exec(n);let t=255,r,i,s;if(e){if(e[7]!==r){const o=+e[7];t=e[8]?Qh(o):Cl(o*255,0,255)}return r=+e[1],i=+e[3],s=+e[5],r=255&(e[2]?Qh(r):Cl(r,0,255)),i=255&(e[4]?Qh(i):Cl(i,0,255)),s=255&(e[6]?Qh(s):Cl(s,0,255)),{r,g:i,b:s,a:t}}}function GF(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${ma(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const Lv=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,Xu=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function KF(n,e,t){const r=Xu(ma(n.r)),i=Xu(ma(n.g)),s=Xu(ma(n.b));return{r:Vl(Lv(r+t*(Xu(ma(e.r))-r))),g:Vl(Lv(i+t*(Xu(ma(e.g))-i))),b:Vl(Lv(s+t*(Xu(ma(e.b))-s))),a:n.a+t*(e.a-n.a)}}function jp(n,e,t){if(n){let r=s2(n);r[e]=Math.max(0,Math.min(r[e]+r[e]*t,e===0?360:1)),r=a2(r),n.r=r[0],n.g=r[1],n.b=r[2]}}function $P(n,e){return n&&Object.assign(e||{},n)}function jS(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=Vl(n[3]))):(e=$P(n,{r:0,g:0,b:0,a:1}),e.a=Vl(e.a)),e}function YF(n){return n.charAt(0)==="r"?WF(n):zF(n)}class qf{constructor(e){if(e instanceof qf)return e;const t=typeof e;let r;t==="object"?r=jS(e):t==="string"&&(r=PF(e)||HF(e)||YF(e)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var e=$P(this._rgb);return e&&(e.a=ma(e.a)),e}set rgb(e){this._rgb=jS(e)}rgbString(){return this._valid?GF(this._rgb):void 0}hexString(){return this._valid?jF(this._rgb):void 0}hslString(){return this._valid?UF(this._rgb):void 0}mix(e,t){if(e){const r=this.rgb,i=e.rgb;let s;const o=t===s?.5:t,l=2*o-1,d=r.a-i.a,f=((l*d===-1?l:(l+d)/(1+l*d))+1)/2;s=1-f,r.r=255&f*r.r+s*i.r+.5,r.g=255&f*r.g+s*i.g+.5,r.b=255&f*r.b+s*i.b+.5,r.a=o*r.a+(1-o)*i.a,this.rgb=r}return this}interpolate(e,t){return e&&(this._rgb=KF(this._rgb,e._rgb,t)),this}clone(){return new qf(this.rgb)}alpha(e){return this._rgb.a=Vl(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=_m(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return jp(this._rgb,2,e),this}darken(e){return jp(this._rgb,2,-e),this}saturate(e){return jp(this._rgb,1,e),this}desaturate(e){return jp(this._rgb,1,-e),this}rotate(e){return BF(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function ua(){}const ZF=(()=>{let n=0;return()=>n++})();function an(n){return n==null}function ur(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Qt(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function Os(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function wo(n,e){return Os(n)?n:e}function Lt(n,e){return typeof n>"u"?e:n}const QF=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,WP=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function In(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function hn(n,e,t,r){let i,s,o;if(ur(n))for(s=n.length,i=0;i<s;i++)e.call(t,n[i],i);else if(Qt(n))for(o=Object.keys(n),s=o.length,i=0;i<s;i++)e.call(t,n[o[i]],o[i])}function Yg(n,e){let t,r,i,s;if(!n||!e||n.length!==e.length)return!1;for(t=0,r=n.length;t<r;++t)if(i=n[t],s=e[t],i.datasetIndex!==s.datasetIndex||i.index!==s.index)return!1;return!0}function Zg(n){if(ur(n))return n.map(Zg);if(Qt(n)){const e=Object.create(null),t=Object.keys(n),r=t.length;let i=0;for(;i<r;++i)e[t[i]]=Zg(n[t[i]]);return e}return n}function GP(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function XF(n,e,t,r){if(!GP(n))return;const i=e[n],s=t[n];Qt(i)&&Qt(s)?Hf(i,s,r):e[n]=Zg(s)}function Hf(n,e,t){const r=ur(e)?e:[e],i=r.length;if(!Qt(n))return n;t=t||{};const s=t.merger||XF;let o;for(let l=0;l<i;++l){if(o=r[l],!Qt(o))continue;const d=Object.keys(o);for(let f=0,m=d.length;f<m;++f)s(d[f],n,o,t)}return n}function gf(n,e){return Hf(n,e,{merger:JF})}function JF(n,e,t){if(!GP(n))return;const r=e[n],i=t[n];Qt(r)&&Qt(i)?gf(r,i):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=Zg(i))}const OS={"":n=>n,x:n=>n.x,y:n=>n.y};function eV(n){const e=n.split("."),t=[];let r="";for(const i of e)r+=i,r.endsWith("\\")?r=r.slice(0,-1)+".":(t.push(r),r="");return t}function tV(n){const e=eV(n);return t=>{for(const r of e){if(r==="")break;t=t&&t[r]}return t}}function lu(n,e){return(OS[e]||(OS[e]=tV(e)))(n)}function l2(n){return n.charAt(0).toUpperCase()+n.slice(1)}const $f=n=>typeof n<"u",Xl=n=>typeof n=="function",MS=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function nV(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const fn=Math.PI,qn=2*fn,rV=qn+fn,Qg=Number.POSITIVE_INFINITY,iV=fn/180,hr=fn/2,Ic=fn/4,DS=fn*2/3,KP=Math.log10,Ro=Math.sign;function yf(n,e,t){return Math.abs(n-e)<t}function LS(n){const e=Math.round(n);n=yf(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(KP(n))),r=n/t;return(r<=1?1:r<=2?2:r<=5?5:10)*t}function sV(n){const e=[],t=Math.sqrt(n);let r;for(r=1;r<t;r++)n%r===0&&(e.push(r),e.push(n/r));return t===(t|0)&&e.push(t),e.sort((i,s)=>i-s).pop(),e}function oV(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function Wf(n){return!oV(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function aV(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function lV(n,e,t){let r,i,s;for(r=0,i=n.length;r<i;r++)s=n[r][t],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function _a(n){return n*(fn/180)}function cV(n){return n*(180/fn)}function FS(n){if(!Os(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function YP(n,e){const t=e.x-n.x,r=e.y-n.y,i=Math.sqrt(t*t+r*r);let s=Math.atan2(r,t);return s<-.5*fn&&(s+=qn),{angle:s,distance:i}}function bx(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function uV(n,e){return(n-e+rV)%qn-fn}function ro(n){return(n%qn+qn)%qn}function Gf(n,e,t,r){const i=ro(n),s=ro(e),o=ro(t),l=ro(s-i),d=ro(o-i),f=ro(i-s),m=ro(i-o);return i===s||i===o||r&&s===o||l>d&&f<m}function Yr(n,e,t){return Math.max(e,Math.min(t,n))}function dV(n){return Yr(n,-32768,32767)}function Pl(n,e,t,r=1e-6){return n>=Math.min(e,t)-r&&n<=Math.max(e,t)+r}function c2(n,e,t){t=t||(o=>n[o]<e);let r=n.length-1,i=0,s;for(;r-i>1;)s=i+r>>1,t(s)?i=s:r=s;return{lo:i,hi:r}}const Uc=(n,e,t,r)=>c2(n,t,r?i=>{const s=n[i][e];return s<t||s===t&&n[i+1][e]===t}:i=>n[i][e]<t),hV=(n,e,t)=>c2(n,t,r=>n[r][e]>=t);function fV(n,e,t){let r=0,i=n.length;for(;r<i&&n[r]<e;)r++;for(;i>r&&n[i-1]>t;)i--;return r>0||i<n.length?n.slice(r,i):n}const ZP=["push","pop","shift","splice","unshift"];function mV(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),ZP.forEach(t=>{const r="_onData"+l2(t),i=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...s){const o=i.apply(this,s);return n._chartjs.listeners.forEach(l=>{typeof l[r]=="function"&&l[r](...s)}),o}})})}function VS(n,e){const t=n._chartjs;if(!t)return;const r=t.listeners,i=r.indexOf(e);i!==-1&&r.splice(i,1),!(r.length>0)&&(ZP.forEach(s=>{delete n[s]}),delete n._chartjs)}function QP(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const XP=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function JP(n,e){let t=[],r=!1;return function(...i){t=i,r||(r=!0,XP.call(window,()=>{r=!1,n.apply(e,t)}))}}function pV(n,e){let t;return function(...r){return e?(clearTimeout(t),t=setTimeout(n,e,r)):n.apply(this,r),e}}const u2=n=>n==="start"?"left":n==="end"?"right":"center",Wr=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,gV=(n,e,t,r)=>n===(r?"left":"right")?t:n==="center"?(e+t)/2:e;function yV(n,e,t){const r=e.length;let i=0,s=r;if(n._sorted){const{iScale:o,vScale:l,_parsed:d}=n,f=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,m=o.axis,{min:y,max:g,minDefined:_,maxDefined:E}=o.getUserBounds();if(_){if(i=Math.min(Uc(d,m,y).lo,t?r:Uc(e,m,o.getPixelForValue(y)).lo),f){const x=d.slice(0,i+1).reverse().findIndex(w=>!an(w[l.axis]));i-=Math.max(0,x)}i=Yr(i,0,r-1)}if(E){let x=Math.max(Uc(d,o.axis,g,!0).hi+1,t?0:Uc(e,m,o.getPixelForValue(g),!0).hi+1);if(f){const w=d.slice(x-1).findIndex(S=>!an(S[l.axis]));x+=Math.max(0,w)}s=Yr(x,i,r)-i}else s=r-i}return{start:i,count:s}}function vV(n){const{xScale:e,yScale:t,_scaleRanges:r}=n,i={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!r)return n._scaleRanges=i,!0;const s=r.xmin!==e.min||r.xmax!==e.max||r.ymin!==t.min||r.ymax!==t.max;return Object.assign(r,i),s}const Op=n=>n===0||n===1,zS=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*qn/t)),BS=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*qn/t)+1,vf={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*hr)+1,easeOutSine:n=>Math.sin(n*hr),easeInOutSine:n=>-.5*(Math.cos(fn*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>Op(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>Op(n)?n:zS(n,.075,.3),easeOutElastic:n=>Op(n)?n:BS(n,.075,.3),easeInOutElastic(n){return Op(n)?n:n<.5?.5*zS(n*2,.1125,.45):.5+.5*BS(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-vf.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?vf.easeInBounce(n*2)*.5:vf.easeOutBounce(n*2-1)*.5+.5};function d2(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function US(n){return d2(n)?n:new qf(n)}function Fv(n){return d2(n)?n:new qf(n).saturate(.5).darken(.1).hexString()}const _V=["x","y","borderWidth","radius","tension"],xV=["color","borderColor","backgroundColor"];function bV(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:xV},numbers:{type:"number",properties:_V}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function wV(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const qS=new Map;function EV(n,e){e=e||{};const t=n+JSON.stringify(e);let r=qS.get(t);return r||(r=new Intl.NumberFormat(n,e),qS.set(t,r)),r}function h2(n,e,t){return EV(e,t).format(n)}const TV={values(n){return ur(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const r=this.chart.options.locale;let i,s=n;if(t.length>1){const f=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(f<1e-4||f>1e15)&&(i="scientific"),s=SV(n,t)}const o=KP(Math.abs(s)),l=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),d={notation:i,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(d,this.options.ticks.format),h2(n,r,d)}};function SV(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var e3={formatters:TV};function AV(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:e3.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const cu=Object.create(null),wx=Object.create(null);function _f(n,e){if(!e)return n;const t=e.split(".");for(let r=0,i=t.length;r<i;++r){const s=t[r];n=n[s]||(n[s]=Object.create(null))}return n}function Vv(n,e,t){return typeof e=="string"?Hf(_f(n,e),t):Hf(_f(n,""),e)}class NV{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,i)=>Fv(i.backgroundColor),this.hoverBorderColor=(r,i)=>Fv(i.borderColor),this.hoverColor=(r,i)=>Fv(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return Vv(this,e,t)}get(e){return _f(this,e)}describe(e,t){return Vv(wx,e,t)}override(e,t){return Vv(cu,e,t)}route(e,t,r,i){const s=_f(this,e),o=_f(this,r),l="_"+t;Object.defineProperties(s,{[l]:{value:s[t],writable:!0},[t]:{enumerable:!0,get(){const d=this[l],f=o[i];return Qt(d)?Object.assign({},f,d):Lt(d,f)},set(d){this[l]=d}}})}apply(e){e.forEach(t=>t(this))}}var Kn=new NV({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[bV,wV,AV]);function IV(n){return!n||an(n.size)||an(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function HS(n,e,t,r,i){let s=e[i];return s||(s=e[i]=n.measureText(i).width,t.push(i)),s>r&&(r=s),r}function kc(n,e,t){const r=n.currentDevicePixelRatio,i=t!==0?Math.max(t/2,.5):0;return Math.round((e-i)*r)/r+i}function $S(n,e){!e&&!n||(e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore())}function Ex(n,e,t,r){t3(n,e,t,r,null)}function t3(n,e,t,r,i){let s,o,l,d,f,m,y,g;const _=e.pointStyle,E=e.rotation,x=e.radius;let w=(E||0)*iV;if(_&&typeof _=="object"&&(s=_.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){n.save(),n.translate(t,r),n.rotate(w),n.drawImage(_,-_.width/2,-_.height/2,_.width,_.height),n.restore();return}if(!(isNaN(x)||x<=0)){switch(n.beginPath(),_){default:i?n.ellipse(t,r,i/2,x,0,0,qn):n.arc(t,r,x,0,qn),n.closePath();break;case"triangle":m=i?i/2:x,n.moveTo(t+Math.sin(w)*m,r-Math.cos(w)*x),w+=DS,n.lineTo(t+Math.sin(w)*m,r-Math.cos(w)*x),w+=DS,n.lineTo(t+Math.sin(w)*m,r-Math.cos(w)*x),n.closePath();break;case"rectRounded":f=x*.516,d=x-f,o=Math.cos(w+Ic)*d,y=Math.cos(w+Ic)*(i?i/2-f:d),l=Math.sin(w+Ic)*d,g=Math.sin(w+Ic)*(i?i/2-f:d),n.arc(t-y,r-l,f,w-fn,w-hr),n.arc(t+g,r-o,f,w-hr,w),n.arc(t+y,r+l,f,w,w+hr),n.arc(t-g,r+o,f,w+hr,w+fn),n.closePath();break;case"rect":if(!E){d=Math.SQRT1_2*x,m=i?i/2:d,n.rect(t-m,r-d,2*m,2*d);break}w+=Ic;case"rectRot":y=Math.cos(w)*(i?i/2:x),o=Math.cos(w)*x,l=Math.sin(w)*x,g=Math.sin(w)*(i?i/2:x),n.moveTo(t-y,r-l),n.lineTo(t+g,r-o),n.lineTo(t+y,r+l),n.lineTo(t-g,r+o),n.closePath();break;case"crossRot":w+=Ic;case"cross":y=Math.cos(w)*(i?i/2:x),o=Math.cos(w)*x,l=Math.sin(w)*x,g=Math.sin(w)*(i?i/2:x),n.moveTo(t-y,r-l),n.lineTo(t+y,r+l),n.moveTo(t+g,r-o),n.lineTo(t-g,r+o);break;case"star":y=Math.cos(w)*(i?i/2:x),o=Math.cos(w)*x,l=Math.sin(w)*x,g=Math.sin(w)*(i?i/2:x),n.moveTo(t-y,r-l),n.lineTo(t+y,r+l),n.moveTo(t+g,r-o),n.lineTo(t-g,r+o),w+=Ic,y=Math.cos(w)*(i?i/2:x),o=Math.cos(w)*x,l=Math.sin(w)*x,g=Math.sin(w)*(i?i/2:x),n.moveTo(t-y,r-l),n.lineTo(t+y,r+l),n.moveTo(t+g,r-o),n.lineTo(t-g,r+o);break;case"line":o=i?i/2:Math.cos(w)*x,l=Math.sin(w)*x,n.moveTo(t-o,r-l),n.lineTo(t+o,r+l);break;case"dash":n.moveTo(t,r),n.lineTo(t+Math.cos(w)*(i?i/2:x),r+Math.sin(w)*x);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function Kf(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function f2(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function m2(n){n.restore()}function kV(n,e,t,r,i){if(!e)return n.lineTo(t.x,t.y);if(i==="middle"){const s=(e.x+t.x)/2;n.lineTo(s,e.y),n.lineTo(s,t.y)}else i==="after"!=!!r?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function CV(n,e,t,r){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(r?e.cp1x:e.cp2x,r?e.cp1y:e.cp2y,r?t.cp2x:t.cp1x,r?t.cp2y:t.cp1y,t.x,t.y)}function PV(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),an(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function RV(n,e,t,r,i){if(i.strikethrough||i.underline){const s=n.measureText(r),o=e-s.actualBoundingBoxLeft,l=e+s.actualBoundingBoxRight,d=t-s.actualBoundingBoxAscent,f=t+s.actualBoundingBoxDescent,m=i.strikethrough?(d+f)/2:f;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=i.decorationWidth||2,n.moveTo(o,m),n.lineTo(l,m),n.stroke()}}function jV(n,e){const t=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=t}function Yf(n,e,t,r,i,s={}){const o=ur(e)?e:[e],l=s.strokeWidth>0&&s.strokeColor!=="";let d,f;for(n.save(),n.font=i.string,PV(n,s),d=0;d<o.length;++d)f=o[d],s.backdrop&&jV(n,s.backdrop),l&&(s.strokeColor&&(n.strokeStyle=s.strokeColor),an(s.strokeWidth)||(n.lineWidth=s.strokeWidth),n.strokeText(f,t,r,s.maxWidth)),n.fillText(f,t,r,s.maxWidth),RV(n,t,r,f,s),r+=Number(i.lineHeight);n.restore()}function Xg(n,e){const{x:t,y:r,w:i,h:s,radius:o}=e;n.arc(t+o.topLeft,r+o.topLeft,o.topLeft,1.5*fn,fn,!0),n.lineTo(t,r+s-o.bottomLeft),n.arc(t+o.bottomLeft,r+s-o.bottomLeft,o.bottomLeft,fn,hr,!0),n.lineTo(t+i-o.bottomRight,r+s),n.arc(t+i-o.bottomRight,r+s-o.bottomRight,o.bottomRight,hr,0,!0),n.lineTo(t+i,r+o.topRight),n.arc(t+i-o.topRight,r+o.topRight,o.topRight,0,-hr,!0),n.lineTo(t+o.topLeft,r)}const OV=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,MV=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function DV(n,e){const t=(""+n).match(OV);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const LV=n=>+n||0;function p2(n,e){const t={},r=Qt(e),i=r?Object.keys(e):e,s=Qt(n)?r?o=>Lt(n[o],n[e[o]]):o=>n[o]:()=>n;for(const o of i)t[o]=LV(s(o));return t}function n3(n){return p2(n,{top:"y",right:"x",bottom:"y",left:"x"})}function fd(n){return p2(n,["topLeft","topRight","bottomLeft","bottomRight"])}function Ms(n){const e=n3(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Zr(n,e){n=n||{},e=e||Kn.font;let t=Lt(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let r=Lt(n.style,e.style);r&&!(""+r).match(MV)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const i={family:Lt(n.family,e.family),lineHeight:DV(Lt(n.lineHeight,e.lineHeight),t),size:t,style:r,weight:Lt(n.weight,e.weight),string:""};return i.string=IV(i),i}function Mp(n,e,t,r){let i,s,o;for(i=0,s=n.length;i<s;++i)if(o=n[i],o!==void 0&&o!==void 0)return o}function FV(n,e,t){const{min:r,max:i}=n,s=WP(e,(i-r)/2),o=(l,d)=>t&&l===0?0:l+d;return{min:o(r,-Math.abs(s)),max:o(i,s)}}function gu(n,e){return Object.assign(Object.create(n),e)}function g2(n,e=[""],t,r,i=()=>n[0]){const s=t||n;typeof r>"u"&&(r=o3("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:s,_fallback:r,_getTarget:i,override:l=>g2([l,...n],e,s,r)};return new Proxy(o,{deleteProperty(l,d){return delete l[d],delete l._keys,delete n[0][d],!0},get(l,d){return i3(l,d,()=>WV(d,e,n,l))},getOwnPropertyDescriptor(l,d){return Reflect.getOwnPropertyDescriptor(l._scopes[0],d)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(l,d){return GS(l).includes(d)},ownKeys(l){return GS(l)},set(l,d,f){const m=l._storage||(l._storage=i());return l[d]=m[d]=f,delete l._keys,!0}})}function kd(n,e,t,r){const i={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:r3(n,r),setContext:s=>kd(n,s,t,r),override:s=>kd(n.override(s),e,t,r)};return new Proxy(i,{deleteProperty(s,o){return delete s[o],delete n[o],!0},get(s,o,l){return i3(s,o,()=>zV(s,o,l))},getOwnPropertyDescriptor(s,o){return s._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(s,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(s,o,l){return n[o]=l,delete s[o],!0}})}function r3(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:r=e.indexable,_allKeys:i=e.allKeys}=n;return{allKeys:i,scriptable:t,indexable:r,isScriptable:Xl(t)?t:()=>t,isIndexable:Xl(r)?r:()=>r}}const VV=(n,e)=>n?n+l2(e):e,y2=(n,e)=>Qt(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function i3(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e)||e==="constructor")return n[e];const r=t();return n[e]=r,r}function zV(n,e,t){const{_proxy:r,_context:i,_subProxy:s,_descriptors:o}=n;let l=r[e];return Xl(l)&&o.isScriptable(e)&&(l=BV(e,l,n,t)),ur(l)&&l.length&&(l=UV(e,l,n,o.isIndexable)),y2(e,l)&&(l=kd(l,i,s&&s[e],o)),l}function BV(n,e,t,r){const{_proxy:i,_context:s,_subProxy:o,_stack:l}=t;if(l.has(n))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+n);l.add(n);let d=e(s,o||r);return l.delete(n),y2(n,d)&&(d=v2(i._scopes,i,n,d)),d}function UV(n,e,t,r){const{_proxy:i,_context:s,_subProxy:o,_descriptors:l}=t;if(typeof s.index<"u"&&r(n))return e[s.index%e.length];if(Qt(e[0])){const d=e,f=i._scopes.filter(m=>m!==d);e=[];for(const m of d){const y=v2(f,i,n,m);e.push(kd(y,s,o&&o[n],l))}}return e}function s3(n,e,t){return Xl(n)?n(e,t):n}const qV=(n,e)=>n===!0?e:typeof n=="string"?lu(e,n):void 0;function HV(n,e,t,r,i){for(const s of e){const o=qV(t,s);if(o){n.add(o);const l=s3(o._fallback,t,i);if(typeof l<"u"&&l!==t&&l!==r)return l}else if(o===!1&&typeof r<"u"&&t!==r)return null}return!1}function v2(n,e,t,r){const i=e._rootScopes,s=s3(e._fallback,t,r),o=[...n,...i],l=new Set;l.add(r);let d=WS(l,o,t,s||t,r);return d===null||typeof s<"u"&&s!==t&&(d=WS(l,o,s,d,r),d===null)?!1:g2(Array.from(l),[""],i,s,()=>$V(e,t,r))}function WS(n,e,t,r,i){for(;t;)t=HV(n,e,t,r,i);return t}function $V(n,e,t){const r=n._getTarget();e in r||(r[e]={});const i=r[e];return ur(i)&&Qt(t)?t:i||{}}function WV(n,e,t,r){let i;for(const s of e)if(i=o3(VV(s,n),t),typeof i<"u")return y2(n,i)?v2(t,r,n,i):i}function o3(n,e){for(const t of e){if(!t)continue;const r=t[n];if(typeof r<"u")return r}}function GS(n){let e=n._keys;return e||(e=n._keys=GV(n._scopes)),e}function GV(n){const e=new Set;for(const t of n)for(const r of Object.keys(t).filter(i=>!i.startsWith("_")))e.add(r);return Array.from(e)}const KV=Number.EPSILON||1e-14,Cd=(n,e)=>e<n.length&&!n[e].skip&&n[e],a3=n=>n==="x"?"y":"x";function YV(n,e,t,r){const i=n.skip?e:n,s=e,o=t.skip?e:t,l=bx(s,i),d=bx(o,s);let f=l/(l+d),m=d/(l+d);f=isNaN(f)?0:f,m=isNaN(m)?0:m;const y=r*f,g=r*m;return{previous:{x:s.x-y*(o.x-i.x),y:s.y-y*(o.y-i.y)},next:{x:s.x+g*(o.x-i.x),y:s.y+g*(o.y-i.y)}}}function ZV(n,e,t){const r=n.length;let i,s,o,l,d,f=Cd(n,0);for(let m=0;m<r-1;++m)if(d=f,f=Cd(n,m+1),!(!d||!f)){if(yf(e[m],0,KV)){t[m]=t[m+1]=0;continue}i=t[m]/e[m],s=t[m+1]/e[m],l=Math.pow(i,2)+Math.pow(s,2),!(l<=9)&&(o=3/Math.sqrt(l),t[m]=i*o*e[m],t[m+1]=s*o*e[m])}}function QV(n,e,t="x"){const r=a3(t),i=n.length;let s,o,l,d=Cd(n,0);for(let f=0;f<i;++f){if(o=l,l=d,d=Cd(n,f+1),!l)continue;const m=l[t],y=l[r];o&&(s=(m-o[t])/3,l[`cp1${t}`]=m-s,l[`cp1${r}`]=y-s*e[f]),d&&(s=(d[t]-m)/3,l[`cp2${t}`]=m+s,l[`cp2${r}`]=y+s*e[f])}}function XV(n,e="x"){const t=a3(e),r=n.length,i=Array(r).fill(0),s=Array(r);let o,l,d,f=Cd(n,0);for(o=0;o<r;++o)if(l=d,d=f,f=Cd(n,o+1),!!d){if(f){const m=f[e]-d[e];i[o]=m!==0?(f[t]-d[t])/m:0}s[o]=l?f?Ro(i[o-1])!==Ro(i[o])?0:(i[o-1]+i[o])/2:i[o-1]:i[o]}ZV(n,i,s),QV(n,s,e)}function Dp(n,e,t){return Math.max(Math.min(n,t),e)}function JV(n,e){let t,r,i,s,o,l=Kf(n[0],e);for(t=0,r=n.length;t<r;++t)o=s,s=l,l=t<r-1&&Kf(n[t+1],e),s&&(i=n[t],o&&(i.cp1x=Dp(i.cp1x,e.left,e.right),i.cp1y=Dp(i.cp1y,e.top,e.bottom)),l&&(i.cp2x=Dp(i.cp2x,e.left,e.right),i.cp2y=Dp(i.cp2y,e.top,e.bottom)))}function ez(n,e,t,r,i){let s,o,l,d;if(e.spanGaps&&(n=n.filter(f=>!f.skip)),e.cubicInterpolationMode==="monotone")XV(n,i);else{let f=r?n[n.length-1]:n[0];for(s=0,o=n.length;s<o;++s)l=n[s],d=YV(f,l,n[Math.min(s+1,o-(r?0:1))%o],e.tension),l.cp1x=d.previous.x,l.cp1y=d.previous.y,l.cp2x=d.next.x,l.cp2y=d.next.y,f=l}e.capBezierPoints&&JV(n,t)}function _2(){return typeof window<"u"&&typeof document<"u"}function x2(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Jg(n,e,t){let r;return typeof n=="string"?(r=parseInt(n,10),n.indexOf("%")!==-1&&(r=r/100*e.parentNode[t])):r=n,r}const Hy=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function tz(n,e){return Hy(n).getPropertyValue(e)}const nz=["top","right","bottom","left"];function Wc(n,e,t){const r={};t=t?"-"+t:"";for(let i=0;i<4;i++){const s=nz[i];r[s]=parseFloat(n[e+"-"+s+t])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const rz=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function iz(n,e){const t=n.touches,r=t&&t.length?t[0]:n,{offsetX:i,offsetY:s}=r;let o=!1,l,d;if(rz(i,s,n.target))l=i,d=s;else{const f=e.getBoundingClientRect();l=r.clientX-f.left,d=r.clientY-f.top,o=!0}return{x:l,y:d,box:o}}function Oc(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:r}=e,i=Hy(t),s=i.boxSizing==="border-box",o=Wc(i,"padding"),l=Wc(i,"border","width"),{x:d,y:f,box:m}=iz(n,t),y=o.left+(m&&l.left),g=o.top+(m&&l.top);let{width:_,height:E}=e;return s&&(_-=o.width+l.width,E-=o.height+l.height),{x:Math.round((d-y)/_*t.width/r),y:Math.round((f-g)/E*t.height/r)}}function sz(n,e,t){let r,i;if(e===void 0||t===void 0){const s=n&&x2(n);if(!s)e=n.clientWidth,t=n.clientHeight;else{const o=s.getBoundingClientRect(),l=Hy(s),d=Wc(l,"border","width"),f=Wc(l,"padding");e=o.width-f.width-d.width,t=o.height-f.height-d.height,r=Jg(l.maxWidth,s,"clientWidth"),i=Jg(l.maxHeight,s,"clientHeight")}}return{width:e,height:t,maxWidth:r||Qg,maxHeight:i||Qg}}const Rl=n=>Math.round(n*10)/10;function oz(n,e,t,r){const i=Hy(n),s=Wc(i,"margin"),o=Jg(i.maxWidth,n,"clientWidth")||Qg,l=Jg(i.maxHeight,n,"clientHeight")||Qg,d=sz(n,e,t);let{width:f,height:m}=d;if(i.boxSizing==="content-box"){const g=Wc(i,"border","width"),_=Wc(i,"padding");f-=_.width+g.width,m-=_.height+g.height}return f=Math.max(0,f-s.width),m=Math.max(0,r?f/r:m-s.height),f=Rl(Math.min(f,o,d.maxWidth)),m=Rl(Math.min(m,l,d.maxHeight)),f&&!m&&(m=Rl(f/2)),(e!==void 0||t!==void 0)&&r&&d.height&&m>d.height&&(m=d.height,f=Rl(Math.floor(m*r))),{width:f,height:m}}function KS(n,e,t){const r=e||1,i=Rl(n.height*r),s=Rl(n.width*r);n.height=Rl(n.height),n.width=Rl(n.width);const o=n.canvas;return o.style&&(t||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),n.currentDevicePixelRatio!==r||o.height!==i||o.width!==s?(n.currentDevicePixelRatio=r,o.height=i,o.width=s,n.ctx.setTransform(r,0,0,r,0,0),!0):!1}const az=function(){let n=!1;try{const e={get passive(){return n=!0,!1}};_2()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return n}();function YS(n,e){const t=tz(n,e),r=t&&t.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function Mc(n,e,t,r){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function lz(n,e,t,r){return{x:n.x+t*(e.x-n.x),y:r==="middle"?t<.5?n.y:e.y:r==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function cz(n,e,t,r){const i={x:n.cp2x,y:n.cp2y},s={x:e.cp1x,y:e.cp1y},o=Mc(n,i,t),l=Mc(i,s,t),d=Mc(s,e,t),f=Mc(o,l,t),m=Mc(l,d,t);return Mc(f,m,t)}const uz=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,r){return t-r},leftForLtr(t,r){return t-r}}},dz=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function md(n,e,t){return n?uz(e,t):dz()}function l3(n,e){let t,r;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,r=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=r)}function c3(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function u3(n){return n==="angle"?{between:Gf,compare:uV,normalize:ro}:{between:Pl,compare:(e,t)=>e-t,normalize:e=>e}}function ZS({start:n,end:e,count:t,loop:r,style:i}){return{start:n%t,end:e%t,loop:r&&(e-n+1)%t===0,style:i}}function hz(n,e,t){const{property:r,start:i,end:s}=t,{between:o,normalize:l}=u3(r),d=e.length;let{start:f,end:m,loop:y}=n,g,_;if(y){for(f+=d,m+=d,g=0,_=d;g<_&&o(l(e[f%d][r]),i,s);++g)f--,m--;f%=d,m%=d}return m<f&&(m+=d),{start:f,end:m,loop:y,style:n.style}}function fz(n,e,t){if(!t)return[n];const{property:r,start:i,end:s}=t,o=e.length,{compare:l,between:d,normalize:f}=u3(r),{start:m,end:y,loop:g,style:_}=hz(n,e,t),E=[];let x=!1,w=null,S,N,P;const I=()=>d(i,P,S)&&l(i,P)!==0,R=()=>l(s,S)===0||d(s,P,S),U=()=>x||I(),j=()=>!x||R();for(let k=m,F=m;k<=y;++k)N=e[k%o],!N.skip&&(S=f(N[r]),S!==P&&(x=d(S,i,s),w===null&&U()&&(w=l(S,i)===0?k:F),w!==null&&j()&&(E.push(ZS({start:w,end:k,loop:g,count:o,style:_})),w=null),F=k,P=S));return w!==null&&E.push(ZS({start:w,end:y,loop:g,count:o,style:_})),E}function mz(n,e){const t=[],r=n.segments;for(let i=0;i<r.length;i++){const s=fz(r[i],n.points,e);s.length&&t.push(...s)}return t}function pz(n,e,t,r){let i=0,s=e-1;if(t&&!r)for(;i<e&&!n[i].skip;)i++;for(;i<e&&n[i].skip;)i++;for(i%=e,t&&(s+=i);s>i&&n[s%e].skip;)s--;return s%=e,{start:i,end:s}}function gz(n,e,t,r){const i=n.length,s=[];let o=e,l=n[e],d;for(d=e+1;d<=t;++d){const f=n[d%i];f.skip||f.stop?l.skip||(r=!1,s.push({start:e%i,end:(d-1)%i,loop:r}),e=o=f.stop?d:null):(o=d,l.skip&&(e=d)),l=f}return o!==null&&s.push({start:e%i,end:o%i,loop:r}),s}function yz(n,e){const t=n.points,r=n.options.spanGaps,i=t.length;if(!i)return[];const s=!!n._loop,{start:o,end:l}=pz(t,i,s,r);if(r===!0)return QS(n,[{start:o,end:l,loop:s}],t,e);const d=l<o?l+i:l,f=!!n._fullLoop&&o===0&&l===i-1;return QS(n,gz(t,o,d,f),t,e)}function QS(n,e,t,r){return!r||!r.setContext||!t?e:vz(n,e,t,r)}function vz(n,e,t,r){const i=n._chart.getContext(),s=XS(n.options),{_datasetIndex:o,options:{spanGaps:l}}=n,d=t.length,f=[];let m=s,y=e[0].start,g=y;function _(E,x,w,S){const N=l?-1:1;if(E!==x){for(E+=d;t[E%d].skip;)E-=N;for(;t[x%d].skip;)x+=N;E%d!==x%d&&(f.push({start:E%d,end:x%d,loop:w,style:S}),m=S,y=x%d)}}for(const E of e){y=l?y:E.start;let x=t[y%d],w;for(g=y+1;g<=E.end;g++){const S=t[g%d];w=XS(r.setContext(gu(i,{type:"segment",p0:x,p1:S,p0DataIndex:(g-1)%d,p1DataIndex:g%d,datasetIndex:o}))),_z(w,m)&&_(y,g-1,E.loop,m),x=S,m=w}y<g-1&&_(y,g-1,E.loop,m)}return f}function XS(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function _z(n,e){if(!e)return!1;const t=[],r=function(i,s){return d2(s)?(t.includes(s)||t.push(s),t.indexOf(s)):s};return JSON.stringify(n,r)!==JSON.stringify(e,r)}function Lp(n,e,t){return n.options.clip?n[t]:e[t]}function xz(n,e){const{xScale:t,yScale:r}=n;return t&&r?{left:Lp(t,e,"left"),right:Lp(t,e,"right"),top:Lp(r,e,"top"),bottom:Lp(r,e,"bottom")}:e}function bz(n,e){const t=e._clip;if(t.disabled)return!1;const r=xz(e,n.chartArea);return{left:t.left===!1?0:r.left-(t.left===!0?0:t.left),right:t.right===!1?n.width:r.right+(t.right===!0?0:t.right),top:t.top===!1?0:r.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?n.height:r.bottom+(t.bottom===!0?0:t.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class wz{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,r,i){const s=t.listeners[i],o=t.duration;s.forEach(l=>l({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(r-t.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=XP.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((r,i)=>{if(!r.running||!r.items.length)return;const s=r.items;let o=s.length-1,l=!1,d;for(;o>=0;--o)d=s[o],d._active?(d._total>r.duration&&(r.duration=d._total),d.tick(e),l=!0):(s[o]=s[s.length-1],s.pop());l&&(i.draw(),this._notify(i,r,e,"progress")),s.length||(r.running=!1,this._notify(i,r,e,"complete"),r.initial=!1),t+=s.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let r=t.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,r)),r}listen(e,t,r){this._getAnims(e).listeners[t].push(r)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((r,i)=>Math.max(r,i._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const r=t.items;let i=r.length-1;for(;i>=0;--i)r[i].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var ha=new wz;const JS="transparent",Ez={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const r=US(n||JS),i=r.valid&&US(e||JS);return i&&i.valid?i.mix(r,t).hexString():e},number(n,e,t){return n+(e-n)*t}};class Tz{constructor(e,t,r,i){const s=t[r];i=Mp([e.to,i,s,e.from]);const o=Mp([e.from,s,i]);this._active=!0,this._fn=e.fn||Ez[e.type||typeof o],this._easing=vf[e.easing]||vf.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=r,this._from=o,this._to=i,this._promises=void 0}active(){return this._active}update(e,t,r){if(this._active){this._notify(!1);const i=this._target[this._prop],s=r-this._start,o=this._duration-s;this._start=r,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=Mp([e.to,t,i,e.from]),this._from=Mp([e.from,i,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,r=this._duration,i=this._prop,s=this._from,o=this._loop,l=this._to;let d;if(this._active=s!==l&&(o||t<r),!this._active){this._target[i]=l,this._notify(!0);return}if(t<0){this._target[i]=s;return}d=t/r%2,d=o&&d>1?2-d:d,d=this._easing(Math.min(1,Math.max(0,d))),this._target[i]=this._fn(s,l,d)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,r)=>{e.push({res:t,rej:r})})}_notify(e){const t=e?"res":"rej",r=this._promises||[];for(let i=0;i<r.length;i++)r[i][t]()}}class d3{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!Qt(e))return;const t=Object.keys(Kn.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(i=>{const s=e[i];if(!Qt(s))return;const o={};for(const l of t)o[l]=s[l];(ur(s.properties)&&s.properties||[i]).forEach(l=>{(l===i||!r.has(l))&&r.set(l,o)})})}_animateOptions(e,t){const r=t.options,i=Az(e,r);if(!i)return[];const s=this._createAnimations(i,r);return r.$shared&&Sz(e.options.$animations,r).then(()=>{e.options=r},()=>{}),s}_createAnimations(e,t){const r=this._properties,i=[],s=e.$animations||(e.$animations={}),o=Object.keys(t),l=Date.now();let d;for(d=o.length-1;d>=0;--d){const f=o[d];if(f.charAt(0)==="$")continue;if(f==="options"){i.push(...this._animateOptions(e,t));continue}const m=t[f];let y=s[f];const g=r.get(f);if(y)if(g&&y.active()){y.update(g,m,l);continue}else y.cancel();if(!g||!g.duration){e[f]=m;continue}s[f]=y=new Tz(g,e,f,m),i.push(y)}return i}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const r=this._createAnimations(e,t);if(r.length)return ha.add(this._chart,r),!0}}function Sz(n,e){const t=[],r=Object.keys(e);for(let i=0;i<r.length;i++){const s=n[r[i]];s&&s.active()&&t.push(s.wait())}return Promise.all(t)}function Az(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function eA(n,e){const t=n&&n.options||{},r=t.reverse,i=t.min===void 0?e:0,s=t.max===void 0?e:0;return{start:r?s:i,end:r?i:s}}function Nz(n,e,t){if(t===!1)return!1;const r=eA(n,t),i=eA(e,t);return{top:i.end,right:r.end,bottom:i.start,left:r.start}}function Iz(n){let e,t,r,i;return Qt(n)?(e=n.top,t=n.right,r=n.bottom,i=n.left):e=t=r=i=n,{top:e,right:t,bottom:r,left:i,disabled:n===!1}}function h3(n,e){const t=[],r=n._getSortedDatasetMetas(e);let i,s;for(i=0,s=r.length;i<s;++i)t.push(r[i].index);return t}function tA(n,e,t,r={}){const i=n.keys,s=r.mode==="single";let o,l,d,f;if(e===null)return;let m=!1;for(o=0,l=i.length;o<l;++o){if(d=+i[o],d===t){if(m=!0,r.all)continue;break}f=n.values[d],Os(f)&&(s||e===0||Ro(e)===Ro(f))&&(e+=f)}return!m&&!r.all?0:e}function kz(n,e){const{iScale:t,vScale:r}=e,i=t.axis==="x"?"x":"y",s=r.axis==="x"?"x":"y",o=Object.keys(n),l=new Array(o.length);let d,f,m;for(d=0,f=o.length;d<f;++d)m=o[d],l[d]={[i]:m,[s]:n[m]};return l}function zv(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function Cz(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}function Pz(n){const{min:e,max:t,minDefined:r,maxDefined:i}=n.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:i?t:Number.POSITIVE_INFINITY}}function Rz(n,e,t){const r=n[e]||(n[e]={});return r[t]||(r[t]={})}function nA(n,e,t,r){for(const i of e.getMatchingVisibleMetas(r).reverse()){const s=n[i.index];if(t&&s>0||!t&&s<0)return i.index}return null}function rA(n,e){const{chart:t,_cachedMeta:r}=n,i=t._stacks||(t._stacks={}),{iScale:s,vScale:o,index:l}=r,d=s.axis,f=o.axis,m=Cz(s,o,r),y=e.length;let g;for(let _=0;_<y;++_){const E=e[_],{[d]:x,[f]:w}=E,S=E._stacks||(E._stacks={});g=S[f]=Rz(i,m,x),g[l]=w,g._top=nA(g,o,!0,r.type),g._bottom=nA(g,o,!1,r.type);const N=g._visualValues||(g._visualValues={});N[l]=w}}function Bv(n,e){const t=n.scales;return Object.keys(t).filter(r=>t[r].axis===e).shift()}function jz(n,e){return gu(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function Oz(n,e,t){return gu(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function Oh(n,e){const t=n.controller.index,r=n.vScale&&n.vScale.axis;if(r){e=e||n._parsed;for(const i of e){const s=i._stacks;if(!s||s[r]===void 0||s[r][t]===void 0)return;delete s[r][t],s[r]._visualValues!==void 0&&s[r]._visualValues[t]!==void 0&&delete s[r]._visualValues[t]}}}const Uv=n=>n==="reset"||n==="none",iA=(n,e)=>e?n:Object.assign({},n),Mz=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:h3(t,!0),values:null};class Gc{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=zv(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Oh(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,r=this.getDataset(),i=(y,g,_,E)=>y==="x"?g:y==="r"?E:_,s=t.xAxisID=Lt(r.xAxisID,Bv(e,"x")),o=t.yAxisID=Lt(r.yAxisID,Bv(e,"y")),l=t.rAxisID=Lt(r.rAxisID,Bv(e,"r")),d=t.indexAxis,f=t.iAxisID=i(d,s,o,l),m=t.vAxisID=i(d,o,s,l);t.xScale=this.getScaleForId(s),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(l),t.iScale=this.getScaleForId(f),t.vScale=this.getScaleForId(m)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&VS(this._data,this),e._stacked&&Oh(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),r=this._data;if(Qt(t)){const i=this._cachedMeta;this._data=kz(t,i)}else if(r!==t){if(r){VS(r,this);const i=this._cachedMeta;Oh(i),i._parsed=[]}t&&Object.isExtensible(t)&&mV(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,r=this.getDataset();let i=!1;this._dataCheck();const s=t._stacked;t._stacked=zv(t.vScale,t),t.stack!==r.stack&&(i=!0,Oh(t),t.stack=r.stack),this._resyncElements(e),(i||s!==t._stacked)&&(rA(this,t._parsed),t._stacked=zv(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:r,_data:i}=this,{iScale:s,_stacked:o}=r,l=s.axis;let d=e===0&&t===i.length?!0:r._sorted,f=e>0&&r._parsed[e-1],m,y,g;if(this._parsing===!1)r._parsed=i,r._sorted=!0,g=i;else{ur(i[e])?g=this.parseArrayData(r,i,e,t):Qt(i[e])?g=this.parseObjectData(r,i,e,t):g=this.parsePrimitiveData(r,i,e,t);const _=()=>y[l]===null||f&&y[l]<f[l];for(m=0;m<t;++m)r._parsed[m+e]=y=g[m],d&&(_()&&(d=!1),f=y);r._sorted=d}o&&rA(this,g)}parsePrimitiveData(e,t,r,i){const{iScale:s,vScale:o}=e,l=s.axis,d=o.axis,f=s.getLabels(),m=s===o,y=new Array(i);let g,_,E;for(g=0,_=i;g<_;++g)E=g+r,y[g]={[l]:m||s.parse(f[E],E),[d]:o.parse(t[E],E)};return y}parseArrayData(e,t,r,i){const{xScale:s,yScale:o}=e,l=new Array(i);let d,f,m,y;for(d=0,f=i;d<f;++d)m=d+r,y=t[m],l[d]={x:s.parse(y[0],m),y:o.parse(y[1],m)};return l}parseObjectData(e,t,r,i){const{xScale:s,yScale:o}=e,{xAxisKey:l="x",yAxisKey:d="y"}=this._parsing,f=new Array(i);let m,y,g,_;for(m=0,y=i;m<y;++m)g=m+r,_=t[g],f[m]={x:s.parse(lu(_,l),g),y:o.parse(lu(_,d),g)};return f}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,r){const i=this.chart,s=this._cachedMeta,o=t[e.axis],l={keys:h3(i,!0),values:t._stacks[e.axis]._visualValues};return tA(l,o,s.index,{mode:r})}updateRangeFromParsed(e,t,r,i){const s=r[t.axis];let o=s===null?NaN:s;const l=i&&r._stacks[t.axis];i&&l&&(i.values=l,o=tA(i,s,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const r=this._cachedMeta,i=r._parsed,s=r._sorted&&e===r.iScale,o=i.length,l=this._getOtherScale(e),d=Mz(t,r,this.chart),f={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:m,max:y}=Pz(l);let g,_;function E(){_=i[g];const x=_[l.axis];return!Os(_[e.axis])||m>x||y<x}for(g=0;g<o&&!(!E()&&(this.updateRangeFromParsed(f,e,_,d),s));++g);if(s){for(g=o-1;g>=0;--g)if(!E()){this.updateRangeFromParsed(f,e,_,d);break}}return f}getAllParsedValues(e){const t=this._cachedMeta._parsed,r=[];let i,s,o;for(i=0,s=t.length;i<s;++i)o=t[i][e.axis],Os(o)&&r.push(o);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,r=t.iScale,i=t.vScale,s=this.getParsed(e);return{label:r?""+r.getLabelForValue(s[r.axis]):"",value:i?""+i.getLabelForValue(s[i.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=Iz(Lt(this.options.clip,Nz(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,r=this._cachedMeta,i=r.data||[],s=t.chartArea,o=[],l=this._drawStart||0,d=this._drawCount||i.length-l,f=this.options.drawActiveElementsOnTop;let m;for(r.dataset&&r.dataset.draw(e,s,l,d),m=l;m<l+d;++m){const y=i[m];y.hidden||(y.active&&f?o.push(y):y.draw(e,s))}for(m=0;m<o.length;++m)o[m].draw(e,s)}getStyle(e,t){const r=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,t,r){const i=this.getDataset();let s;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];s=o.$context||(o.$context=Oz(this.getContext(),e,o)),s.parsed=this.getParsed(e),s.raw=i.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=jz(this.chart.getContext(),this.index)),s.dataset=i,s.index=s.datasetIndex=this.index;return s.active=!!t,s.mode=r,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",r){const i=t==="active",s=this._cachedDataOpts,o=e+"-"+t,l=s[o],d=this.enableOptionSharing&&$f(r);if(l)return iA(l,d);const f=this.chart.config,m=f.datasetElementScopeKeys(this._type,e),y=i?[`${e}Hover`,"hover",e,""]:[e,""],g=f.getOptionScopes(this.getDataset(),m),_=Object.keys(Kn.elements[e]),E=()=>this.getContext(r,i,t),x=f.resolveNamedOptions(g,_,E,y);return x.$shared&&(x.$shared=d,s[o]=Object.freeze(iA(x,d))),x}_resolveAnimations(e,t,r){const i=this.chart,s=this._cachedDataOpts,o=`animation-${t}`,l=s[o];if(l)return l;let d;if(i.options.animation!==!1){const m=this.chart.config,y=m.datasetAnimationScopeKeys(this._type,t),g=m.getOptionScopes(this.getDataset(),y);d=m.createResolver(g,this.getContext(e,r,t))}const f=new d3(i,d&&d.animations);return d&&d._cacheable&&(s[o]=Object.freeze(f)),f}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||Uv(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const r=this.resolveDataElementOptions(e,t),i=this._sharedOptions,s=this.getSharedOptions(r),o=this.includeOptions(t,s)||s!==i;return this.updateSharedOptions(s,t,r),{sharedOptions:s,includeOptions:o}}updateElement(e,t,r,i){Uv(i)?Object.assign(e,r):this._resolveAnimations(t,i).update(e,r)}updateSharedOptions(e,t,r){e&&!Uv(t)&&this._resolveAnimations(void 0,t).update(e,r)}_setStyle(e,t,r,i){e.active=i;const s=this.getStyle(t,i);this._resolveAnimations(t,r,i).update(e,{options:!i&&this.getSharedOptions(s)||s})}removeHoverStyle(e,t,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,t,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,r=this._cachedMeta.data;for(const[l,d,f]of this._syncList)this[l](d,f);this._syncList=[];const i=r.length,s=t.length,o=Math.min(s,i);o&&this.parse(0,o),s>i?this._insertElements(i,s-i,e):s<i&&this._removeElements(s,i-s)}_insertElements(e,t,r=!0){const i=this._cachedMeta,s=i.data,o=e+t;let l;const d=f=>{for(f.length+=t,l=f.length-1;l>=o;l--)f[l]=f[l-t]};for(d(s),l=e;l<o;++l)s[l]=new this.dataElementType;this._parsing&&d(i._parsed),this.parse(e,t),r&&this.updateElements(s,e,t,"reset")}updateElements(e,t,r,i){}_removeElements(e,t){const r=this._cachedMeta;if(this._parsing){const i=r._parsed.splice(e,t);r._stacked&&Oh(r,i)}r.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,r,i]=e;this[t](r,i)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Je(Gc,"defaults",{}),Je(Gc,"datasetElementType",null),Je(Gc,"dataElementType",null);function Dz(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let r=[];for(let i=0,s=t.length;i<s;i++)r=r.concat(t[i].controller.getAllParsedValues(n));n._cache.$bar=QP(r.sort((i,s)=>i-s))}return n._cache.$bar}function Lz(n){const e=n.iScale,t=Dz(e,n.type);let r=e._length,i,s,o,l;const d=()=>{o===32767||o===-32768||($f(l)&&(r=Math.min(r,Math.abs(o-l)||r)),l=o)};for(i=0,s=t.length;i<s;++i)o=e.getPixelForValue(t[i]),d();for(l=void 0,i=0,s=e.ticks.length;i<s;++i)o=e.getPixelForTick(i),d();return r}function Fz(n,e,t,r){const i=t.barThickness;let s,o;return an(i)?(s=e.min*t.categoryPercentage,o=t.barPercentage):(s=i*r,o=1),{chunk:s/r,ratio:o,start:e.pixels[n]-s/2}}function Vz(n,e,t,r){const i=e.pixels,s=i[n];let o=n>0?i[n-1]:null,l=n<i.length-1?i[n+1]:null;const d=t.categoryPercentage;o===null&&(o=s-(l===null?e.end-e.start:l-s)),l===null&&(l=s+s-o);const f=s-(s-Math.min(o,l))/2*d;return{chunk:Math.abs(l-o)/2*d/r,ratio:t.barPercentage,start:f}}function zz(n,e,t,r){const i=t.parse(n[0],r),s=t.parse(n[1],r),o=Math.min(i,s),l=Math.max(i,s);let d=o,f=l;Math.abs(o)>Math.abs(l)&&(d=l,f=o),e[t.axis]=f,e._custom={barStart:d,barEnd:f,start:i,end:s,min:o,max:l}}function f3(n,e,t,r){return ur(n)?zz(n,e,t,r):e[t.axis]=t.parse(n,r),e}function sA(n,e,t,r){const i=n.iScale,s=n.vScale,o=i.getLabels(),l=i===s,d=[];let f,m,y,g;for(f=t,m=t+r;f<m;++f)g=e[f],y={},y[i.axis]=l||i.parse(o[f],f),d.push(f3(g,y,s,f));return d}function qv(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function Bz(n,e,t){return n!==0?Ro(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function Uz(n){let e,t,r,i,s;return n.horizontal?(e=n.base>n.x,t="left",r="right"):(e=n.base<n.y,t="bottom",r="top"),e?(i="end",s="start"):(i="start",s="end"),{start:t,end:r,reverse:e,top:i,bottom:s}}function qz(n,e,t,r){let i=e.borderSkipped;const s={};if(!i){n.borderSkipped=s;return}if(i===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:l,reverse:d,top:f,bottom:m}=Uz(n);i==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===r?i=f:(t._bottom||0)===r?i=m:(s[oA(m,o,l,d)]=!0,i=f)),s[oA(i,o,l,d)]=!0,n.borderSkipped=s}function oA(n,e,t,r){return r?(n=Hz(n,e,t),n=aA(n,t,e)):n=aA(n,e,t),n}function Hz(n,e,t){return n===e?t:n===t?e:n}function aA(n,e,t){return n==="start"?e:n==="end"?t:n}function $z(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class dg extends Gc{parsePrimitiveData(e,t,r,i){return sA(e,t,r,i)}parseArrayData(e,t,r,i){return sA(e,t,r,i)}parseObjectData(e,t,r,i){const{iScale:s,vScale:o}=e,{xAxisKey:l="x",yAxisKey:d="y"}=this._parsing,f=s.axis==="x"?l:d,m=o.axis==="x"?l:d,y=[];let g,_,E,x;for(g=r,_=r+i;g<_;++g)x=t[g],E={},E[s.axis]=s.parse(lu(x,f),g),y.push(f3(lu(x,m),E,o,g));return y}updateRangeFromParsed(e,t,r,i){super.updateRangeFromParsed(e,t,r,i);const s=r._custom;s&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,s.min),e.max=Math.max(e.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:r,vScale:i}=t,s=this.getParsed(e),o=s._custom,l=qv(o)?"["+o.start+", "+o.end+"]":""+i.getLabelForValue(s[i.axis]);return{label:""+r.getLabelForValue(s[r.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,r,i){const s=i==="reset",{index:o,_cachedMeta:{vScale:l}}=this,d=l.getBasePixel(),f=l.isHorizontal(),m=this._getRuler(),{sharedOptions:y,includeOptions:g}=this._getSharedOptions(t,i);for(let _=t;_<t+r;_++){const E=this.getParsed(_),x=s||an(E[l.axis])?{base:d,head:d}:this._calculateBarValuePixels(_),w=this._calculateBarIndexPixels(_,m),S=(E._stacks||{})[l.axis],N={horizontal:f,base:x.base,enableBorderRadius:!S||qv(E._custom)||o===S._top||o===S._bottom,x:f?x.head:w.center,y:f?w.center:x.head,height:f?w.size:Math.abs(x.size),width:f?Math.abs(x.size):w.size};g&&(N.options=y||this.resolveDataElementOptions(_,e[_].active?"active":i));const P=N.options||e[_].options;qz(N,P,S,o),$z(N,P,m.ratio),this.updateElement(e[_],_,N,i)}}_getStacks(e,t){const{iScale:r}=this._cachedMeta,i=r.getMatchingVisibleMetas(this._type).filter(m=>m.controller.options.grouped),s=r.options.stacked,o=[],l=this._cachedMeta.controller.getParsed(t),d=l&&l[r.axis],f=m=>{const y=m._parsed.find(_=>_[r.axis]===d),g=y&&y[m.vScale.axis];if(an(g)||isNaN(g))return!0};for(const m of i)if(!(t!==void 0&&f(m))&&((s===!1||o.indexOf(m.stack)===-1||s===void 0&&m.stack===void 0)&&o.push(m.stack),m.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(r=>e[r].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const r of this.chart.data.datasets)e[Lt(this.chart.options.indexAxis==="x"?r.xAxisID:r.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,r){const i=this._getStacks(e,r),s=t!==void 0?i.indexOf(t):-1;return s===-1?i.length-1:s}_getRuler(){const e=this.options,t=this._cachedMeta,r=t.iScale,i=[];let s,o;for(s=0,o=t.data.length;s<o;++s)i.push(r.getPixelForValue(this.getParsed(s)[r.axis],s));const l=e.barThickness;return{min:l||Lz(t),pixels:i,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:l?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:r,index:i},options:{base:s,minBarLength:o}}=this,l=s||0,d=this.getParsed(e),f=d._custom,m=qv(f);let y=d[t.axis],g=0,_=r?this.applyStack(t,d,r):y,E,x;_!==y&&(g=_-y,_=y),m&&(y=f.barStart,_=f.barEnd-f.barStart,y!==0&&Ro(y)!==Ro(f.barEnd)&&(g=0),g+=y);const w=!an(s)&&!m?s:g;let S=t.getPixelForValue(w);if(this.chart.getDataVisibility(e)?E=t.getPixelForValue(g+_):E=S,x=E-S,Math.abs(x)<o){x=Bz(x,t,l)*o,y===l&&(S-=x/2);const N=t.getPixelForDecimal(0),P=t.getPixelForDecimal(1),I=Math.min(N,P),R=Math.max(N,P);S=Math.max(Math.min(S,R),I),E=S+x,r&&!m&&(d._stacks[t.axis]._visualValues[i]=t.getValueForPixel(E)-t.getValueForPixel(S))}if(S===t.getPixelForValue(l)){const N=Ro(x)*t.getLineWidthForValue(l)/2;S+=N,x-=N}return{size:x,base:S,head:E,center:E+x/2}}_calculateBarIndexPixels(e,t){const r=t.scale,i=this.options,s=i.skipNull,o=Lt(i.maxBarThickness,1/0);let l,d;const f=this._getAxisCount();if(t.grouped){const m=s?this._getStackCount(e):t.stackCount,y=i.barThickness==="flex"?Vz(e,t,i,m*f):Fz(e,t,i,m*f),g=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,_=this._getAxis().indexOf(Lt(g,this.getFirstScaleIdForIndexAxis())),E=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0)+_;l=y.start+y.chunk*E+y.chunk/2,d=Math.min(o,y.chunk*y.ratio)}else l=r.getPixelForValue(this.getParsed(e)[r.axis],e),d=Math.min(o,t.min*t.ratio);return{base:l-d/2,head:l+d/2,center:l,size:d}}draw(){const e=this._cachedMeta,t=e.vScale,r=e.data,i=r.length;let s=0;for(;s<i;++s)this.getParsed(s)[t.axis]!==null&&!r[s].hidden&&r[s].draw(this._ctx)}}Je(dg,"id","bar"),Je(dg,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Je(dg,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function Wz(n,e,t){let r=1,i=1,s=0,o=0;if(e<qn){const l=n,d=l+e,f=Math.cos(l),m=Math.sin(l),y=Math.cos(d),g=Math.sin(d),_=(P,I,R)=>Gf(P,l,d,!0)?1:Math.max(I,I*t,R,R*t),E=(P,I,R)=>Gf(P,l,d,!0)?-1:Math.min(I,I*t,R,R*t),x=_(0,f,y),w=_(hr,m,g),S=E(fn,f,y),N=E(fn+hr,m,g);r=(x-S)/2,i=(w-N)/2,s=-(x+S)/2,o=-(w+N)/2}return{ratioX:r,ratioY:i,offsetX:s,offsetY:o}}class ad extends Gc{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const r=this.getDataset().data,i=this._cachedMeta;if(this._parsing===!1)i._parsed=r;else{let s=d=>+r[d];if(Qt(r[e])){const{key:d="value"}=this._parsing;s=f=>+lu(r[f],d)}let o,l;for(o=e,l=e+t;o<l;++o)i._parsed[o]=s(o)}}_getRotation(){return _a(this.options.rotation-90)}_getCircumference(){return _a(this.options.circumference)}_getRotationExtents(){let e=qn,t=-qn;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const i=this.chart.getDatasetMeta(r).controller,s=i._getRotation(),o=i._getCircumference();e=Math.min(e,s),t=Math.max(t,s+o)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:r}=t,i=this._cachedMeta,s=i.data,o=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,l=Math.max((Math.min(r.width,r.height)-o)/2,0),d=Math.min(QF(this.options.cutout,l),1),f=this._getRingWeight(this.index),{circumference:m,rotation:y}=this._getRotationExtents(),{ratioX:g,ratioY:_,offsetX:E,offsetY:x}=Wz(y,m,d),w=(r.width-o)/g,S=(r.height-o)/_,N=Math.max(Math.min(w,S)/2,0),P=WP(this.options.radius,N),I=Math.max(P*d,0),R=(P-I)/this._getVisibleDatasetWeightTotal();this.offsetX=E*P,this.offsetY=x*P,i.total=this.calculateTotal(),this.outerRadius=P-R*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-R*f,0),this.updateElements(s,0,s.length,e)}_circumference(e,t){const r=this.options,i=this._cachedMeta,s=this._getCircumference();return t&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||i._parsed[e]===null||i.data[e].hidden?0:this.calculateCircumference(i._parsed[e]*s/qn)}updateElements(e,t,r,i){const s=i==="reset",o=this.chart,l=o.chartArea,f=o.options.animation,m=(l.left+l.right)/2,y=(l.top+l.bottom)/2,g=s&&f.animateScale,_=g?0:this.innerRadius,E=g?0:this.outerRadius,{sharedOptions:x,includeOptions:w}=this._getSharedOptions(t,i);let S=this._getRotation(),N;for(N=0;N<t;++N)S+=this._circumference(N,s);for(N=t;N<t+r;++N){const P=this._circumference(N,s),I=e[N],R={x:m+this.offsetX,y:y+this.offsetY,startAngle:S,endAngle:S+P,circumference:P,outerRadius:E,innerRadius:_};w&&(R.options=x||this.resolveDataElementOptions(N,I.active?"active":i)),S+=P,this.updateElement(I,N,R,i)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let r=0,i;for(i=0;i<t.length;i++){const s=e._parsed[i];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(i)&&!t[i].hidden&&(r+=Math.abs(s))}return r}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?qn*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,r=this.chart,i=r.data.labels||[],s=h2(t._parsed[e],r.options.locale);return{label:i[e]||"",value:s}}getMaxBorderWidth(e){let t=0;const r=this.chart;let i,s,o,l,d;if(!e){for(i=0,s=r.data.datasets.length;i<s;++i)if(r.isDatasetVisible(i)){o=r.getDatasetMeta(i),e=o.data,l=o.controller;break}}if(!e)return 0;for(i=0,s=e.length;i<s;++i)d=l.resolveDataElementOptions(i),d.borderAlign!=="inner"&&(t=Math.max(t,d.borderWidth||0,d.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let r=0,i=e.length;r<i;++r){const s=this.resolveDataElementOptions(r);t=Math.max(t,s.offset||0,s.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(t+=this._getRingWeight(r));return t}_getRingWeight(e){return Math.max(Lt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Je(ad,"id","doughnut"),Je(ad,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Je(ad,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),Je(ad,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data,{labels:{pointStyle:r,textAlign:i,color:s,useBorderRadius:o,borderRadius:l}}=e.legend.options;return t.labels.length&&t.datasets.length?t.labels.map((d,f)=>{const y=e.getDatasetMeta(0).controller.getStyle(f);return{text:d,fillStyle:y.backgroundColor,fontColor:s,hidden:!e.getDataVisibility(f),lineDash:y.borderDash,lineDashOffset:y.borderDashOffset,lineJoin:y.borderJoinStyle,lineWidth:y.borderWidth,strokeStyle:y.borderColor,textAlign:i,pointStyle:r,borderRadius:o&&(l||y.borderRadius),index:f}}):[]}},onClick(e,t,r){r.chart.toggleDataVisibility(t.index),r.chart.update()}}}});class hg extends Gc{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:r,data:i=[],_dataset:s}=t,o=this.chart._animationsDisabled;let{start:l,count:d}=yV(t,i,o);this._drawStart=l,this._drawCount=d,vV(t)&&(l=0,d=i.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!s._decimated,r.points=i;const f=this.resolveDatasetElementOptions(e);this.options.showLine||(f.borderWidth=0),f.segment=this.options.segment,this.updateElement(r,void 0,{animated:!o,options:f},e),this.updateElements(i,l,d,e)}updateElements(e,t,r,i){const s=i==="reset",{iScale:o,vScale:l,_stacked:d,_dataset:f}=this._cachedMeta,{sharedOptions:m,includeOptions:y}=this._getSharedOptions(t,i),g=o.axis,_=l.axis,{spanGaps:E,segment:x}=this.options,w=Wf(E)?E:Number.POSITIVE_INFINITY,S=this.chart._animationsDisabled||s||i==="none",N=t+r,P=e.length;let I=t>0&&this.getParsed(t-1);for(let R=0;R<P;++R){const U=e[R],j=S?U:{};if(R<t||R>=N){j.skip=!0;continue}const k=this.getParsed(R),F=an(k[_]),O=j[g]=o.getPixelForValue(k[g],R),C=j[_]=s||F?l.getBasePixel():l.getPixelForValue(d?this.applyStack(l,k,d):k[_],R);j.skip=isNaN(O)||isNaN(C)||F,j.stop=R>0&&Math.abs(k[g]-I[g])>w,x&&(j.parsed=k,j.raw=f.data[R]),y&&(j.options=m||this.resolveDataElementOptions(R,U.active?"active":i)),S||this.updateElement(U,R,j,i),I=k}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,r=t.options&&t.options.borderWidth||0,i=e.data||[];if(!i.length)return r;const s=i[0].size(this.resolveDataElementOptions(0)),o=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(r,s,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}Je(hg,"id","line"),Je(hg,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Je(hg,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class Tx extends ad{}Je(Tx,"id","pie"),Je(Tx,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});function Cc(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class b2{constructor(e){Je(this,"options");this.options=e||{}}static override(e){Object.assign(b2.prototype,e)}init(){}formats(){return Cc()}parse(){return Cc()}format(){return Cc()}add(){return Cc()}diff(){return Cc()}startOf(){return Cc()}endOf(){return Cc()}}var Gz={_date:b2};function Kz(n,e,t,r){const{controller:i,data:s,_sorted:o}=n,l=i._cachedMeta.iScale,d=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(l&&e===l.axis&&e!=="r"&&o&&s.length){const f=l._reversePixels?hV:Uc;if(r){if(i._sharedOptions){const m=s[0],y=typeof m.getRange=="function"&&m.getRange(e);if(y){const g=f(s,e,t-y),_=f(s,e,t+y);return{lo:g.lo,hi:_.hi}}}}else{const m=f(s,e,t);if(d){const{vScale:y}=i._cachedMeta,{_parsed:g}=n,_=g.slice(0,m.lo+1).reverse().findIndex(x=>!an(x[y.axis]));m.lo-=Math.max(0,_);const E=g.slice(m.hi).findIndex(x=>!an(x[y.axis]));m.hi+=Math.max(0,E)}return m}}return{lo:0,hi:s.length-1}}function $y(n,e,t,r,i){const s=n.getSortedVisibleDatasetMetas(),o=t[e];for(let l=0,d=s.length;l<d;++l){const{index:f,data:m}=s[l],{lo:y,hi:g}=Kz(s[l],e,o,i);for(let _=y;_<=g;++_){const E=m[_];E.skip||r(E,f,_)}}}function Yz(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(r,i){const s=e?Math.abs(r.x-i.x):0,o=t?Math.abs(r.y-i.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(o,2))}}function Hv(n,e,t,r,i){const s=[];return!i&&!n.isPointInArea(e)||$y(n,t,e,function(l,d,f){!i&&!Kf(l,n.chartArea,0)||l.inRange(e.x,e.y,r)&&s.push({element:l,datasetIndex:d,index:f})},!0),s}function Zz(n,e,t,r){let i=[];function s(o,l,d){const{startAngle:f,endAngle:m}=o.getProps(["startAngle","endAngle"],r),{angle:y}=YP(o,{x:e.x,y:e.y});Gf(y,f,m)&&i.push({element:o,datasetIndex:l,index:d})}return $y(n,t,e,s),i}function Qz(n,e,t,r,i,s){let o=[];const l=Yz(t);let d=Number.POSITIVE_INFINITY;function f(m,y,g){const _=m.inRange(e.x,e.y,i);if(r&&!_)return;const E=m.getCenterPoint(i);if(!(!!s||n.isPointInArea(E))&&!_)return;const w=l(e,E);w<d?(o=[{element:m,datasetIndex:y,index:g}],d=w):w===d&&o.push({element:m,datasetIndex:y,index:g})}return $y(n,t,e,f),o}function $v(n,e,t,r,i,s){return!s&&!n.isPointInArea(e)?[]:t==="r"&&!r?Zz(n,e,t,i):Qz(n,e,t,r,i,s)}function lA(n,e,t,r,i){const s=[],o=t==="x"?"inXRange":"inYRange";let l=!1;return $y(n,t,e,(d,f,m)=>{d[o]&&d[o](e[t],i)&&(s.push({element:d,datasetIndex:f,index:m}),l=l||d.inRange(e.x,e.y,i))}),r&&!l?[]:s}var Xz={modes:{index(n,e,t,r){const i=Oc(e,n),s=t.axis||"x",o=t.includeInvisible||!1,l=t.intersect?Hv(n,i,s,r,o):$v(n,i,s,!1,r,o),d=[];return l.length?(n.getSortedVisibleDatasetMetas().forEach(f=>{const m=l[0].index,y=f.data[m];y&&!y.skip&&d.push({element:y,datasetIndex:f.index,index:m})}),d):[]},dataset(n,e,t,r){const i=Oc(e,n),s=t.axis||"xy",o=t.includeInvisible||!1;let l=t.intersect?Hv(n,i,s,r,o):$v(n,i,s,!1,r,o);if(l.length>0){const d=l[0].datasetIndex,f=n.getDatasetMeta(d).data;l=[];for(let m=0;m<f.length;++m)l.push({element:f[m],datasetIndex:d,index:m})}return l},point(n,e,t,r){const i=Oc(e,n),s=t.axis||"xy",o=t.includeInvisible||!1;return Hv(n,i,s,r,o)},nearest(n,e,t,r){const i=Oc(e,n),s=t.axis||"xy",o=t.includeInvisible||!1;return $v(n,i,s,t.intersect,r,o)},x(n,e,t,r){const i=Oc(e,n);return lA(n,i,"x",t.intersect,r)},y(n,e,t,r){const i=Oc(e,n);return lA(n,i,"y",t.intersect,r)}}};const m3=["left","top","right","bottom"];function Mh(n,e){return n.filter(t=>t.pos===e)}function cA(n,e){return n.filter(t=>m3.indexOf(t.pos)===-1&&t.box.axis===e)}function Dh(n,e){return n.sort((t,r)=>{const i=e?r:t,s=e?t:r;return i.weight===s.weight?i.index-s.index:i.weight-s.weight})}function Jz(n){const e=[];let t,r,i,s,o,l;for(t=0,r=(n||[]).length;t<r;++t)i=n[t],{position:s,options:{stack:o,stackWeight:l=1}}=i,e.push({index:t,box:i,pos:s,horizontal:i.isHorizontal(),weight:i.weight,stack:o&&s+o,stackWeight:l});return e}function eB(n){const e={};for(const t of n){const{stack:r,pos:i,stackWeight:s}=t;if(!r||!m3.includes(i))continue;const o=e[r]||(e[r]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=s}return e}function tB(n,e){const t=eB(n),{vBoxMaxWidth:r,hBoxMaxHeight:i}=e;let s,o,l;for(s=0,o=n.length;s<o;++s){l=n[s];const{fullSize:d}=l.box,f=t[l.stack],m=f&&l.stackWeight/f.weight;l.horizontal?(l.width=m?m*r:d&&e.availableWidth,l.height=i):(l.width=r,l.height=m?m*i:d&&e.availableHeight)}return t}function nB(n){const e=Jz(n),t=Dh(e.filter(f=>f.box.fullSize),!0),r=Dh(Mh(e,"left"),!0),i=Dh(Mh(e,"right")),s=Dh(Mh(e,"top"),!0),o=Dh(Mh(e,"bottom")),l=cA(e,"x"),d=cA(e,"y");return{fullSize:t,leftAndTop:r.concat(s),rightAndBottom:i.concat(d).concat(o).concat(l),chartArea:Mh(e,"chartArea"),vertical:r.concat(i).concat(d),horizontal:s.concat(o).concat(l)}}function uA(n,e,t,r){return Math.max(n[t],e[t])+Math.max(n[r],e[r])}function p3(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function rB(n,e,t,r){const{pos:i,box:s}=t,o=n.maxPadding;if(!Qt(i)){t.size&&(n[i]-=t.size);const y=r[t.stack]||{size:0,count:1};y.size=Math.max(y.size,t.horizontal?s.height:s.width),t.size=y.size/y.count,n[i]+=t.size}s.getPadding&&p3(o,s.getPadding());const l=Math.max(0,e.outerWidth-uA(o,n,"left","right")),d=Math.max(0,e.outerHeight-uA(o,n,"top","bottom")),f=l!==n.w,m=d!==n.h;return n.w=l,n.h=d,t.horizontal?{same:f,other:m}:{same:m,other:f}}function iB(n){const e=n.maxPadding;function t(r){const i=Math.max(e[r]-n[r],0);return n[r]+=i,i}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function sB(n,e){const t=e.maxPadding;function r(i){const s={left:0,top:0,right:0,bottom:0};return i.forEach(o=>{s[o]=Math.max(e[o],t[o])}),s}return r(n?["left","right"]:["top","bottom"])}function Xh(n,e,t,r){const i=[];let s,o,l,d,f,m;for(s=0,o=n.length,f=0;s<o;++s){l=n[s],d=l.box,d.update(l.width||e.w,l.height||e.h,sB(l.horizontal,e));const{same:y,other:g}=rB(e,t,l,r);f|=y&&i.length,m=m||g,d.fullSize||i.push(l)}return f&&Xh(i,e,t,r)||m}function Fp(n,e,t,r,i){n.top=t,n.left=e,n.right=e+r,n.bottom=t+i,n.width=r,n.height=i}function dA(n,e,t,r){const i=t.padding;let{x:s,y:o}=e;for(const l of n){const d=l.box,f=r[l.stack]||{placed:0,weight:1},m=l.stackWeight/f.weight||1;if(l.horizontal){const y=e.w*m,g=f.size||d.height;$f(f.start)&&(o=f.start),d.fullSize?Fp(d,i.left,o,t.outerWidth-i.right-i.left,g):Fp(d,e.left+f.placed,o,y,g),f.start=o,f.placed+=y,o=d.bottom}else{const y=e.h*m,g=f.size||d.width;$f(f.start)&&(s=f.start),d.fullSize?Fp(d,s,i.top,g,t.outerHeight-i.bottom-i.top):Fp(d,s,e.top+f.placed,g,y),f.start=s,f.placed+=y,s=d.right}}e.x=s,e.y=o}var Es={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,r){if(!n)return;const i=Ms(n.options.layout.padding),s=Math.max(e-i.width,0),o=Math.max(t-i.height,0),l=nB(n.boxes),d=l.vertical,f=l.horizontal;hn(n.boxes,x=>{typeof x.beforeLayout=="function"&&x.beforeLayout()});const m=d.reduce((x,w)=>w.box.options&&w.box.options.display===!1?x:x+1,0)||1,y=Object.freeze({outerWidth:e,outerHeight:t,padding:i,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/m,hBoxMaxHeight:o/2}),g=Object.assign({},i);p3(g,Ms(r));const _=Object.assign({maxPadding:g,w:s,h:o,x:i.left,y:i.top},i),E=tB(d.concat(f),y);Xh(l.fullSize,_,y,E),Xh(d,_,y,E),Xh(f,_,y,E)&&Xh(d,_,y,E),iB(_),dA(l.leftAndTop,_,y,E),_.x+=_.w,_.y+=_.h,dA(l.rightAndBottom,_,y,E),n.chartArea={left:_.left,top:_.top,right:_.left+_.w,bottom:_.top+_.h,height:_.h,width:_.w},hn(l.chartArea,x=>{const w=x.box;Object.assign(w,n.chartArea),w.update(_.w,_.h,{left:0,top:0,right:0,bottom:0})})}};class g3{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,r){}removeEventListener(e,t,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,r,i){return t=Math.max(0,t||e.width),r=r||e.height,{width:t,height:Math.max(0,i?Math.floor(t/i):r)}}isAttached(e){return!0}updateConfig(e){}}class oB extends g3{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const fg="$chartjs",aB={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},hA=n=>n===null||n==="";function lB(n,e){const t=n.style,r=n.getAttribute("height"),i=n.getAttribute("width");if(n[fg]={initial:{height:r,width:i,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",hA(i)){const s=YS(n,"width");s!==void 0&&(n.width=s)}if(hA(r))if(n.style.height==="")n.height=n.width/(e||2);else{const s=YS(n,"height");s!==void 0&&(n.height=s)}return n}const y3=az?{passive:!0}:!1;function cB(n,e,t){n&&n.addEventListener(e,t,y3)}function uB(n,e,t){n&&n.canvas&&n.canvas.removeEventListener(e,t,y3)}function dB(n,e){const t=aB[n.type]||n.type,{x:r,y:i}=Oc(n,e);return{type:t,chart:e,native:n,x:r!==void 0?r:null,y:i!==void 0?i:null}}function ey(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function hB(n,e,t){const r=n.canvas,i=new MutationObserver(s=>{let o=!1;for(const l of s)o=o||ey(l.addedNodes,r),o=o&&!ey(l.removedNodes,r);o&&t()});return i.observe(document,{childList:!0,subtree:!0}),i}function fB(n,e,t){const r=n.canvas,i=new MutationObserver(s=>{let o=!1;for(const l of s)o=o||ey(l.removedNodes,r),o=o&&!ey(l.addedNodes,r);o&&t()});return i.observe(document,{childList:!0,subtree:!0}),i}const Zf=new Map;let fA=0;function v3(){const n=window.devicePixelRatio;n!==fA&&(fA=n,Zf.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function mB(n,e){Zf.size||window.addEventListener("resize",v3),Zf.set(n,e)}function pB(n){Zf.delete(n),Zf.size||window.removeEventListener("resize",v3)}function gB(n,e,t){const r=n.canvas,i=r&&x2(r);if(!i)return;const s=JP((l,d)=>{const f=i.clientWidth;t(l,d),f<i.clientWidth&&t()},window),o=new ResizeObserver(l=>{const d=l[0],f=d.contentRect.width,m=d.contentRect.height;f===0&&m===0||s(f,m)});return o.observe(i),mB(n,s),o}function Wv(n,e,t){t&&t.disconnect(),e==="resize"&&pB(n)}function yB(n,e,t){const r=n.canvas,i=JP(s=>{n.ctx!==null&&t(dB(s,n))},n);return cB(r,e,i),i}class vB extends g3{acquireContext(e,t){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(lB(e,t),r):null}releaseContext(e){const t=e.canvas;if(!t[fg])return!1;const r=t[fg].initial;["height","width"].forEach(s=>{const o=r[s];an(o)?t.removeAttribute(s):t.setAttribute(s,o)});const i=r.style||{};return Object.keys(i).forEach(s=>{t.style[s]=i[s]}),t.width=t.width,delete t[fg],!0}addEventListener(e,t,r){this.removeEventListener(e,t);const i=e.$proxies||(e.$proxies={}),o={attach:hB,detach:fB,resize:gB}[t]||yB;i[t]=o(e,t,r)}removeEventListener(e,t){const r=e.$proxies||(e.$proxies={}),i=r[t];if(!i)return;({attach:Wv,detach:Wv,resize:Wv}[t]||uB)(e,t,i),r[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,r,i){return oz(e,t,r,i)}isAttached(e){const t=e&&x2(e);return!!(t&&t.isConnected)}}function _B(n){return!_2()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?oB:vB}var Gp;let Ma=(Gp=class{constructor(){Je(this,"x");Je(this,"y");Je(this,"active",!1);Je(this,"options");Je(this,"$animations")}tooltipPosition(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}hasValue(){return Wf(this.x)&&Wf(this.y)}getProps(e,t){const r=this.$animations;if(!t||!r)return this;const i={};return e.forEach(s=>{i[s]=r[s]&&r[s].active()?r[s]._to:this[s]}),i}},Je(Gp,"defaults",{}),Je(Gp,"defaultRoutes"),Gp);function xB(n,e){const t=n.options.ticks,r=bB(n),i=Math.min(t.maxTicksLimit||r,r),s=t.major.enabled?EB(e):[],o=s.length,l=s[0],d=s[o-1],f=[];if(o>i)return TB(e,f,s,o/i),f;const m=wB(s,e,i);if(o>0){let y,g;const _=o>1?Math.round((d-l)/(o-1)):null;for(Vp(e,f,m,an(_)?0:l-_,l),y=0,g=o-1;y<g;y++)Vp(e,f,m,s[y],s[y+1]);return Vp(e,f,m,d,an(_)?e.length:d+_),f}return Vp(e,f,m),f}function bB(n){const e=n.options.offset,t=n._tickSize(),r=n._length/t+(e?0:1),i=n._maxLength/t;return Math.floor(Math.min(r,i))}function wB(n,e,t){const r=SB(n),i=e.length/t;if(!r)return Math.max(i,1);const s=sV(r);for(let o=0,l=s.length-1;o<l;o++){const d=s[o];if(d>i)return d}return Math.max(i,1)}function EB(n){const e=[];let t,r;for(t=0,r=n.length;t<r;t++)n[t].major&&e.push(t);return e}function TB(n,e,t,r){let i=0,s=t[0],o;for(r=Math.ceil(r),o=0;o<n.length;o++)o===s&&(e.push(n[o]),i++,s=t[i*r])}function Vp(n,e,t,r,i){const s=Lt(r,0),o=Math.min(Lt(i,n.length),n.length);let l=0,d,f,m;for(t=Math.ceil(t),i&&(d=i-r,t=d/Math.floor(d/t)),m=s;m<0;)l++,m=Math.round(s+l*t);for(f=Math.max(s,0);f<o;f++)f===m&&(e.push(n[f]),l++,m=Math.round(s+l*t))}function SB(n){const e=n.length;let t,r;if(e<2)return!1;for(r=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==r)return!1;return r}const AB=n=>n==="left"?"right":n==="right"?"left":n,mA=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t,pA=(n,e)=>Math.min(e||n,n);function gA(n,e){const t=[],r=n.length/e,i=n.length;let s=0;for(;s<i;s+=r)t.push(n[Math.floor(s)]);return t}function NB(n,e,t){const r=n.ticks.length,i=Math.min(e,r-1),s=n._startPixel,o=n._endPixel,l=1e-6;let d=n.getPixelForTick(i),f;if(!(t&&(r===1?f=Math.max(d-s,o-d):e===0?f=(n.getPixelForTick(1)-d)/2:f=(d-n.getPixelForTick(i-1))/2,d+=i<e?f:-f,d<s-l||d>o+l)))return d}function IB(n,e){hn(n,t=>{const r=t.gc,i=r.length/2;let s;if(i>e){for(s=0;s<i;++s)delete t.data[r[s]];r.splice(0,i)}})}function Lh(n){return n.drawTicks?n.tickLength:0}function yA(n,e){if(!n.display)return 0;const t=Zr(n.font,e),r=Ms(n.padding);return(ur(n.text)?n.text.length:1)*t.lineHeight+r.height}function kB(n,e){return gu(n,{scale:e,type:"scale"})}function CB(n,e,t){return gu(n,{tick:t,index:e,type:"tick"})}function PB(n,e,t){let r=u2(n);return(t&&e!=="right"||!t&&e==="right")&&(r=AB(r)),r}function RB(n,e,t,r){const{top:i,left:s,bottom:o,right:l,chart:d}=n,{chartArea:f,scales:m}=d;let y=0,g,_,E;const x=o-i,w=l-s;if(n.isHorizontal()){if(_=Wr(r,s,l),Qt(t)){const S=Object.keys(t)[0],N=t[S];E=m[S].getPixelForValue(N)+x-e}else t==="center"?E=(f.bottom+f.top)/2+x-e:E=mA(n,t,e);g=l-s}else{if(Qt(t)){const S=Object.keys(t)[0],N=t[S];_=m[S].getPixelForValue(N)-w+e}else t==="center"?_=(f.left+f.right)/2-w+e:_=mA(n,t,e);E=Wr(r,o,i),y=t==="left"?-hr:hr}return{titleX:_,titleY:E,maxWidth:g,rotation:y}}class Hd extends Ma{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:r,_suggestedMax:i}=this;return e=wo(e,Number.POSITIVE_INFINITY),t=wo(t,Number.NEGATIVE_INFINITY),r=wo(r,Number.POSITIVE_INFINITY),i=wo(i,Number.NEGATIVE_INFINITY),{min:wo(e,r),max:wo(t,i),minDefined:Os(e),maxDefined:Os(t)}}getMinMax(e){let{min:t,max:r,minDefined:i,maxDefined:s}=this.getUserBounds(),o;if(i&&s)return{min:t,max:r};const l=this.getMatchingVisibleMetas();for(let d=0,f=l.length;d<f;++d)o=l[d].controller.getMinMax(this,e),i||(t=Math.min(t,o.min)),s||(r=Math.max(r,o.max));return t=s&&t>r?r:t,r=i&&t>r?t:r,{min:wo(t,wo(r,t)),max:wo(r,wo(t,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){In(this.options.beforeUpdate,[this])}update(e,t,r){const{beginAtZero:i,grace:s,ticks:o}=this.options,l=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=FV(this,s,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const d=l<this.ticks.length;this._convertTicksToLabels(d?gA(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=xB(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),d&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,r;this.isHorizontal()?(t=this.left,r=this.right):(t=this.top,r=this.bottom,e=!e),this._startPixel=t,this._endPixel=r,this._reversePixels=e,this._length=r-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){In(this.options.afterUpdate,[this])}beforeSetDimensions(){In(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){In(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),In(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){In(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let r,i,s;for(r=0,i=e.length;r<i;r++)s=e[r],s.label=In(t.callback,[s.value,r,e],this)}afterTickToLabelConversion(){In(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){In(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,r=pA(this.ticks.length,e.ticks.maxTicksLimit),i=t.minRotation||0,s=t.maxRotation;let o=i,l,d,f;if(!this._isVisible()||!t.display||i>=s||r<=1||!this.isHorizontal()){this.labelRotation=i;return}const m=this._getLabelSizes(),y=m.widest.width,g=m.highest.height,_=Yr(this.chart.width-y,0,this.maxWidth);l=e.offset?this.maxWidth/r:_/(r-1),y+6>l&&(l=_/(r-(e.offset?.5:1)),d=this.maxHeight-Lh(e.grid)-t.padding-yA(e.title,this.chart.options.font),f=Math.sqrt(y*y+g*g),o=cV(Math.min(Math.asin(Yr((m.highest.height+6)/l,-1,1)),Math.asin(Yr(d/f,-1,1))-Math.asin(Yr(g/f,-1,1)))),o=Math.max(i,Math.min(s,o))),this.labelRotation=o}afterCalculateLabelRotation(){In(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){In(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:r,title:i,grid:s}}=this,o=this._isVisible(),l=this.isHorizontal();if(o){const d=yA(i,t.options.font);if(l?(e.width=this.maxWidth,e.height=Lh(s)+d):(e.height=this.maxHeight,e.width=Lh(s)+d),r.display&&this.ticks.length){const{first:f,last:m,widest:y,highest:g}=this._getLabelSizes(),_=r.padding*2,E=_a(this.labelRotation),x=Math.cos(E),w=Math.sin(E);if(l){const S=r.mirror?0:w*y.width+x*g.height;e.height=Math.min(this.maxHeight,e.height+S+_)}else{const S=r.mirror?0:x*y.width+w*g.height;e.width=Math.min(this.maxWidth,e.width+S+_)}this._calculatePadding(f,m,w,x)}}this._handleMargins(),l?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,r,i){const{ticks:{align:s,padding:o},position:l}=this.options,d=this.labelRotation!==0,f=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const m=this.getPixelForTick(0)-this.left,y=this.right-this.getPixelForTick(this.ticks.length-1);let g=0,_=0;d?f?(g=i*e.width,_=r*t.height):(g=r*e.height,_=i*t.width):s==="start"?_=t.width:s==="end"?g=e.width:s!=="inner"&&(g=e.width/2,_=t.width/2),this.paddingLeft=Math.max((g-m+o)*this.width/(this.width-m),0),this.paddingRight=Math.max((_-y+o)*this.width/(this.width-y),0)}else{let m=t.height/2,y=e.height/2;s==="start"?(m=0,y=e.height):s==="end"&&(m=t.height,y=0),this.paddingTop=m+o,this.paddingBottom=y+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){In(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,r;for(t=0,r=e.length;t<r;t++)an(e[t].label)&&(e.splice(t,1),r--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let r=this.ticks;t<r.length&&(r=gA(r,t)),this._labelSizes=e=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,r){const{ctx:i,_longestTextCache:s}=this,o=[],l=[],d=Math.floor(t/pA(t,r));let f=0,m=0,y,g,_,E,x,w,S,N,P,I,R;for(y=0;y<t;y+=d){if(E=e[y].label,x=this._resolveTickFontOptions(y),i.font=w=x.string,S=s[w]=s[w]||{data:{},gc:[]},N=x.lineHeight,P=I=0,!an(E)&&!ur(E))P=HS(i,S.data,S.gc,P,E),I=N;else if(ur(E))for(g=0,_=E.length;g<_;++g)R=E[g],!an(R)&&!ur(R)&&(P=HS(i,S.data,S.gc,P,R),I+=N);o.push(P),l.push(I),f=Math.max(P,f),m=Math.max(I,m)}IB(s,t);const U=o.indexOf(f),j=l.indexOf(m),k=F=>({width:o[F]||0,height:l[F]||0});return{first:k(0),last:k(t-1),widest:k(U),highest:k(j),widths:o,heights:l}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return dV(this._alignToPixels?kc(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const r=t[e];return r.$context||(r.$context=CB(this.getContext(),e,r))}return this.$context||(this.$context=kB(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=_a(this.labelRotation),r=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t)),s=this._getLabelSizes(),o=e.autoSkipPadding||0,l=s?s.widest.width+o:0,d=s?s.highest.height+o:0;return this.isHorizontal()?d*r>l*i?l/r:d/i:d*i<l*r?d/r:l/i}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,r=this.chart,i=this.options,{grid:s,position:o,border:l}=i,d=s.offset,f=this.isHorizontal(),y=this.ticks.length+(d?1:0),g=Lh(s),_=[],E=l.setContext(this.getContext()),x=E.display?E.width:0,w=x/2,S=function(re){return kc(r,re,x)};let N,P,I,R,U,j,k,F,O,C,D,M;if(o==="top")N=S(this.bottom),j=this.bottom-g,F=N-w,C=S(e.top)+w,M=e.bottom;else if(o==="bottom")N=S(this.top),C=e.top,M=S(e.bottom)-w,j=N+w,F=this.top+g;else if(o==="left")N=S(this.right),U=this.right-g,k=N-w,O=S(e.left)+w,D=e.right;else if(o==="right")N=S(this.left),O=e.left,D=S(e.right)-w,U=N+w,k=this.left+g;else if(t==="x"){if(o==="center")N=S((e.top+e.bottom)/2+.5);else if(Qt(o)){const re=Object.keys(o)[0],oe=o[re];N=S(this.chart.scales[re].getPixelForValue(oe))}C=e.top,M=e.bottom,j=N+w,F=j+g}else if(t==="y"){if(o==="center")N=S((e.left+e.right)/2);else if(Qt(o)){const re=Object.keys(o)[0],oe=o[re];N=S(this.chart.scales[re].getPixelForValue(oe))}U=N-w,k=U-g,O=e.left,D=e.right}const $=Lt(i.ticks.maxTicksLimit,y),G=Math.max(1,Math.ceil(y/$));for(P=0;P<y;P+=G){const re=this.getContext(P),oe=s.setContext(re),ie=l.setContext(re),X=oe.lineWidth,Y=oe.color,B=ie.dash||[],Z=ie.dashOffset,te=oe.tickWidth,se=oe.tickColor,ae=oe.tickBorderDash||[],Q=oe.tickBorderDashOffset;I=NB(this,P,d),I!==void 0&&(R=kc(r,I,X),f?U=k=O=D=R:j=F=C=M=R,_.push({tx1:U,ty1:j,tx2:k,ty2:F,x1:O,y1:C,x2:D,y2:M,width:X,color:Y,borderDash:B,borderDashOffset:Z,tickWidth:te,tickColor:se,tickBorderDash:ae,tickBorderDashOffset:Q}))}return this._ticksLength=y,this._borderValue=N,_}_computeLabelItems(e){const t=this.axis,r=this.options,{position:i,ticks:s}=r,o=this.isHorizontal(),l=this.ticks,{align:d,crossAlign:f,padding:m,mirror:y}=s,g=Lh(r.grid),_=g+m,E=y?-m:_,x=-_a(this.labelRotation),w=[];let S,N,P,I,R,U,j,k,F,O,C,D,M="middle";if(i==="top")U=this.bottom-E,j=this._getXAxisLabelAlignment();else if(i==="bottom")U=this.top+E,j=this._getXAxisLabelAlignment();else if(i==="left"){const G=this._getYAxisLabelAlignment(g);j=G.textAlign,R=G.x}else if(i==="right"){const G=this._getYAxisLabelAlignment(g);j=G.textAlign,R=G.x}else if(t==="x"){if(i==="center")U=(e.top+e.bottom)/2+_;else if(Qt(i)){const G=Object.keys(i)[0],re=i[G];U=this.chart.scales[G].getPixelForValue(re)+_}j=this._getXAxisLabelAlignment()}else if(t==="y"){if(i==="center")R=(e.left+e.right)/2-_;else if(Qt(i)){const G=Object.keys(i)[0],re=i[G];R=this.chart.scales[G].getPixelForValue(re)}j=this._getYAxisLabelAlignment(g).textAlign}t==="y"&&(d==="start"?M="top":d==="end"&&(M="bottom"));const $=this._getLabelSizes();for(S=0,N=l.length;S<N;++S){P=l[S],I=P.label;const G=s.setContext(this.getContext(S));k=this.getPixelForTick(S)+s.labelOffset,F=this._resolveTickFontOptions(S),O=F.lineHeight,C=ur(I)?I.length:1;const re=C/2,oe=G.color,ie=G.textStrokeColor,X=G.textStrokeWidth;let Y=j;o?(R=k,j==="inner"&&(S===N-1?Y=this.options.reverse?"left":"right":S===0?Y=this.options.reverse?"right":"left":Y="center"),i==="top"?f==="near"||x!==0?D=-C*O+O/2:f==="center"?D=-$.highest.height/2-re*O+O:D=-$.highest.height+O/2:f==="near"||x!==0?D=O/2:f==="center"?D=$.highest.height/2-re*O:D=$.highest.height-C*O,y&&(D*=-1),x!==0&&!G.showLabelBackdrop&&(R+=O/2*Math.sin(x))):(U=k,D=(1-C)*O/2);let B;if(G.showLabelBackdrop){const Z=Ms(G.backdropPadding),te=$.heights[S],se=$.widths[S];let ae=D-Z.top,Q=0-Z.left;switch(M){case"middle":ae-=te/2;break;case"bottom":ae-=te;break}switch(j){case"center":Q-=se/2;break;case"right":Q-=se;break;case"inner":S===N-1?Q-=se:S>0&&(Q-=se/2);break}B={left:Q,top:ae,width:se+Z.width,height:te+Z.height,color:G.backdropColor}}w.push({label:I,font:F,textOffset:D,options:{rotation:x,color:oe,strokeColor:ie,strokeWidth:X,textAlign:Y,textBaseline:M,translation:[R,U],backdrop:B}})}return w}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-_a(this.labelRotation))return e==="top"?"left":"right";let i="center";return t.align==="start"?i="left":t.align==="end"?i="right":t.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:r,mirror:i,padding:s}}=this.options,o=this._getLabelSizes(),l=e+s,d=o.widest.width;let f,m;return t==="left"?i?(m=this.right+s,r==="near"?f="left":r==="center"?(f="center",m+=d/2):(f="right",m+=d)):(m=this.right-l,r==="near"?f="right":r==="center"?(f="center",m-=d/2):(f="left",m=this.left)):t==="right"?i?(m=this.left+s,r==="near"?f="right":r==="center"?(f="center",m-=d/2):(f="left",m-=d)):(m=this.left+l,r==="near"?f="left":r==="center"?(f="center",m+=d/2):(f="right",m=this.right)):f="right",{textAlign:f,x:m}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:r,top:i,width:s,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(r,i,s,o),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const i=this.ticks.findIndex(s=>s.value===e);return i>=0?t.setContext(this.getContext(i)).lineWidth:0}drawGrid(e){const t=this.options.grid,r=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let s,o;const l=(d,f,m)=>{!m.width||!m.color||(r.save(),r.lineWidth=m.width,r.strokeStyle=m.color,r.setLineDash(m.borderDash||[]),r.lineDashOffset=m.borderDashOffset,r.beginPath(),r.moveTo(d.x,d.y),r.lineTo(f.x,f.y),r.stroke(),r.restore())};if(t.display)for(s=0,o=i.length;s<o;++s){const d=i[s];t.drawOnChartArea&&l({x:d.x1,y:d.y1},{x:d.x2,y:d.y2},d),t.drawTicks&&l({x:d.tx1,y:d.ty1},{x:d.tx2,y:d.ty2},{color:d.tickColor,width:d.tickWidth,borderDash:d.tickBorderDash,borderDashOffset:d.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:r,grid:i}}=this,s=r.setContext(this.getContext()),o=r.display?s.width:0;if(!o)return;const l=i.setContext(this.getContext(0)).lineWidth,d=this._borderValue;let f,m,y,g;this.isHorizontal()?(f=kc(e,this.left,o)-o/2,m=kc(e,this.right,l)+l/2,y=g=d):(y=kc(e,this.top,o)-o/2,g=kc(e,this.bottom,l)+l/2,f=m=d),t.save(),t.lineWidth=s.width,t.strokeStyle=s.color,t.beginPath(),t.moveTo(f,y),t.lineTo(m,g),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const r=this.ctx,i=this._computeLabelArea();i&&f2(r,i);const s=this.getLabelItems(e);for(const o of s){const l=o.options,d=o.font,f=o.label,m=o.textOffset;Yf(r,f,0,m,d,l)}i&&m2(r)}drawTitle(){const{ctx:e,options:{position:t,title:r,reverse:i}}=this;if(!r.display)return;const s=Zr(r.font),o=Ms(r.padding),l=r.align;let d=s.lineHeight/2;t==="bottom"||t==="center"||Qt(t)?(d+=o.bottom,ur(r.text)&&(d+=s.lineHeight*(r.text.length-1))):d+=o.top;const{titleX:f,titleY:m,maxWidth:y,rotation:g}=RB(this,d,t,l);Yf(e,r.text,0,0,s,{color:r.color,maxWidth:y,rotation:g,textAlign:PB(l,t,i),textBaseline:"middle",translation:[f,m]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,r=Lt(e.grid&&e.grid.z,-1),i=Lt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Hd.prototype.draw?[{z:t,draw:s=>{this.draw(s)}}]:[{z:r,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:t,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",i=[];let s,o;for(s=0,o=t.length;s<o;++s){const l=t[s];l[r]===this.id&&(!e||l.type===e)&&i.push(l)}return i}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return Zr(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class zp{constructor(e,t,r){this.type=e,this.scope=t,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let r;MB(t)&&(r=this.register(t));const i=this.items,s=e.id,o=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in i||(i[s]=e,jB(e,o,r),this.override&&Kn.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,r=e.id,i=this.scope;r in t&&delete t[r],i&&r in Kn[i]&&(delete Kn[i][r],this.override&&delete cu[r])}}function jB(n,e,t){const r=Hf(Object.create(null),[t?Kn.get(t):{},Kn.get(e),n.defaults]);Kn.set(e,r),n.defaultRoutes&&OB(e,n.defaultRoutes),n.descriptors&&Kn.describe(e,n.descriptors)}function OB(n,e){Object.keys(e).forEach(t=>{const r=t.split("."),i=r.pop(),s=[n].concat(r).join("."),o=e[t].split("."),l=o.pop(),d=o.join(".");Kn.route(s,i,d,l)})}function MB(n){return"id"in n&&"defaults"in n}class DB{constructor(){this.controllers=new zp(Gc,"datasets",!0),this.elements=new zp(Ma,"elements"),this.plugins=new zp(Object,"plugins"),this.scales=new zp(Hd,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,r){[...t].forEach(i=>{const s=r||this._getRegistryForType(i);r||s.isForType(i)||s===this.plugins&&i.id?this._exec(e,s,i):hn(i,o=>{const l=r||this._getRegistryForType(o);this._exec(e,l,o)})})}_exec(e,t,r){const i=l2(e);In(r["before"+i],[],r),t[e](r),In(r["after"+i],[],r)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const r=this._typedRegistries[t];if(r.isForType(e))return r}return this.plugins}_get(e,t,r){const i=t.get(e);if(i===void 0)throw new Error('"'+e+'" is not a registered '+r+".");return i}}var So=new DB;class LB{constructor(){this._init=void 0}notify(e,t,r,i){if(t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const s=i?this._descriptors(e).filter(i):this._descriptors(e),o=this._notify(s,e,t,r);return t==="afterDestroy"&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),o}_notify(e,t,r,i){i=i||{};for(const s of e){const o=s.plugin,l=o[r],d=[t,i,s.options];if(In(l,d,o)===!1&&i.cancelable)return!1}return!0}invalidate(){an(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const r=e&&e.config,i=Lt(r.options&&r.options.plugins,{}),s=FB(r);return i===!1&&!t?[]:zB(e,s,i,t)}_notifyStateChanges(e){const t=this._oldCache||[],r=this._cache,i=(s,o)=>s.filter(l=>!o.some(d=>l.plugin.id===d.plugin.id));this._notify(i(t,r),e,"stop"),this._notify(i(r,t),e,"start")}}function FB(n){const e={},t=[],r=Object.keys(So.plugins.items);for(let s=0;s<r.length;s++)t.push(So.getPlugin(r[s]));const i=n.plugins||[];for(let s=0;s<i.length;s++){const o=i[s];t.indexOf(o)===-1&&(t.push(o),e[o.id]=!0)}return{plugins:t,localIds:e}}function VB(n,e){return!e&&n===!1?null:n===!0?{}:n}function zB(n,{plugins:e,localIds:t},r,i){const s=[],o=n.getContext();for(const l of e){const d=l.id,f=VB(r[d],i);f!==null&&s.push({plugin:l,options:BB(n.config,{plugin:l,local:t[d]},f,o)})}return s}function BB(n,{plugin:e,local:t},r,i){const s=n.pluginScopeKeys(e),o=n.getOptionScopes(r,s);return t&&e.defaults&&o.push(e.defaults),n.createResolver(o,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function Sx(n,e){const t=Kn.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function UB(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function qB(n,e){return n===e?"_index_":"_value_"}function vA(n){if(n==="x"||n==="y"||n==="r")return n}function HB(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function Ax(n,...e){if(vA(n))return n;for(const t of e){const r=t.axis||HB(t.position)||n.length>1&&vA(n[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function _A(n,e,t){if(t[e+"AxisID"]===n)return{axis:e}}function $B(n,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(r=>r.xAxisID===n||r.yAxisID===n);if(t.length)return _A(n,"x",t[0])||_A(n,"y",t[0])}return{}}function WB(n,e){const t=cu[n.type]||{scales:{}},r=e.scales||{},i=Sx(n.type,e),s=Object.create(null);return Object.keys(r).forEach(o=>{const l=r[o];if(!Qt(l))return console.error(`Invalid scale configuration for scale: ${o}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const d=Ax(o,l,$B(o,n),Kn.scales[l.type]),f=qB(d,i),m=t.scales||{};s[o]=gf(Object.create(null),[{axis:d},l,m[d],m[f]])}),n.data.datasets.forEach(o=>{const l=o.type||n.type,d=o.indexAxis||Sx(l,e),m=(cu[l]||{}).scales||{};Object.keys(m).forEach(y=>{const g=UB(y,d),_=o[g+"AxisID"]||g;s[_]=s[_]||Object.create(null),gf(s[_],[{axis:g},r[_],m[y]])})}),Object.keys(s).forEach(o=>{const l=s[o];gf(l,[Kn.scales[l.type],Kn.scale])}),s}function _3(n){const e=n.options||(n.options={});e.plugins=Lt(e.plugins,{}),e.scales=WB(n,e)}function x3(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function GB(n){return n=n||{},n.data=x3(n.data),_3(n),n}const xA=new Map,b3=new Set;function Bp(n,e){let t=xA.get(n);return t||(t=e(),xA.set(n,t),b3.add(t)),t}const Fh=(n,e,t)=>{const r=lu(e,t);r!==void 0&&n.add(r)};class KB{constructor(e){this._config=GB(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=x3(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),_3(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Bp(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return Bp(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return Bp(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,r=this.type;return Bp(`${r}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const r=this._scopeCache;let i=r.get(e);return(!i||t)&&(i=new Map,r.set(e,i)),i}getOptionScopes(e,t,r){const{options:i,type:s}=this,o=this._cachedScopes(e,r),l=o.get(t);if(l)return l;const d=new Set;t.forEach(m=>{e&&(d.add(e),m.forEach(y=>Fh(d,e,y))),m.forEach(y=>Fh(d,i,y)),m.forEach(y=>Fh(d,cu[s]||{},y)),m.forEach(y=>Fh(d,Kn,y)),m.forEach(y=>Fh(d,wx,y))});const f=Array.from(d);return f.length===0&&f.push(Object.create(null)),b3.has(t)&&o.set(t,f),f}chartOptionScopes(){const{options:e,type:t}=this;return[e,cu[t]||{},Kn.datasets[t]||{},{type:t},Kn,wx]}resolveNamedOptions(e,t,r,i=[""]){const s={$shared:!0},{resolver:o,subPrefixes:l}=bA(this._resolverCache,e,i);let d=o;if(ZB(o,t)){s.$shared=!1,r=Xl(r)?r():r;const f=this.createResolver(e,r,l);d=kd(o,r,f)}for(const f of t)s[f]=d[f];return s}createResolver(e,t,r=[""],i){const{resolver:s}=bA(this._resolverCache,e,r);return Qt(t)?kd(s,t,void 0,i):s}}function bA(n,e,t){let r=n.get(e);r||(r=new Map,n.set(e,r));const i=t.join();let s=r.get(i);return s||(s={resolver:g2(e,t),subPrefixes:t.filter(l=>!l.toLowerCase().includes("hover"))},r.set(i,s)),s}const YB=n=>Qt(n)&&Object.getOwnPropertyNames(n).some(e=>Xl(n[e]));function ZB(n,e){const{isScriptable:t,isIndexable:r}=r3(n);for(const i of e){const s=t(i),o=r(i),l=(o||s)&&n[i];if(s&&(Xl(l)||YB(l))||o&&ur(l))return!0}return!1}var QB="4.5.1";const XB=["top","bottom","left","right","chartArea"];function wA(n,e){return n==="top"||n==="bottom"||XB.indexOf(n)===-1&&e==="x"}function EA(n,e){return function(t,r){return t[n]===r[n]?t[e]-r[e]:t[n]-r[n]}}function TA(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),In(t&&t.onComplete,[n],e)}function JB(n){const e=n.chart,t=e.options.animation;In(t&&t.onProgress,[n],e)}function w3(n){return _2()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const mg={},SA=n=>{const e=w3(n);return Object.values(mg).filter(t=>t.canvas===e).pop()};function eU(n,e,t){const r=Object.keys(n);for(const i of r){const s=+i;if(s>=e){const o=n[i];delete n[i],(t>0||s>e)&&(n[s+t]=o)}}}function tU(n,e,t,r){return!t||n.type==="mouseout"?null:r?e:n}var El;let xm=(El=class{static register(...e){So.add(...e),AA()}static unregister(...e){So.remove(...e),AA()}constructor(e,t){const r=this.config=new KB(t),i=w3(e),s=SA(i);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const o=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||_B(i)),this.platform.updateConfig(r);const l=this.platform.acquireContext(i,o.aspectRatio),d=l&&l.canvas,f=d&&d.height,m=d&&d.width;if(this.id=ZF(),this.ctx=l,this.canvas=d,this.width=m,this.height=f,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new LB,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=pV(y=>this.update(y),o.resizeDelay||0),this._dataChanges=[],mg[this.id]=this,!l||!d){console.error("Failed to create chart: can't acquire context from the given item");return}ha.listen(this,"complete",TA),ha.listen(this,"progress",JB),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:r,height:i,_aspectRatio:s}=this;return an(e)?t&&s?s:i?r/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return So}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():KS(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return $S(this.canvas,this.ctx),this}stop(){return ha.stop(this),this}resize(e,t){ha.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const r=this.options,i=this.canvas,s=r.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(i,e,t,s),l=r.devicePixelRatio||this.platform.getDevicePixelRatio(),d=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,KS(this,l,!0)&&(this.notifyPlugins("resize",{size:o}),In(r.onResize,[this,o],this),this.attached&&this._doResize(d)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};hn(t,(r,i)=>{r.id=i})}buildOrUpdateScales(){const e=this.options,t=e.scales,r=this.scales,i=Object.keys(r).reduce((o,l)=>(o[l]=!1,o),{});let s=[];t&&(s=s.concat(Object.keys(t).map(o=>{const l=t[o],d=Ax(o,l),f=d==="r",m=d==="x";return{options:l,dposition:f?"chartArea":m?"bottom":"left",dtype:f?"radialLinear":m?"category":"linear"}}))),hn(s,o=>{const l=o.options,d=l.id,f=Ax(d,l),m=Lt(l.type,o.dtype);(l.position===void 0||wA(l.position,f)!==wA(o.dposition))&&(l.position=o.dposition),i[d]=!0;let y=null;if(d in r&&r[d].type===m)y=r[d];else{const g=So.getScale(m);y=new g({id:d,type:m,ctx:this.ctx,chart:this}),r[y.id]=y}y.init(l,e)}),hn(i,(o,l)=>{o||delete r[l]}),hn(r,o=>{Es.configure(this,o,o.options),Es.addBox(this,o)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,r=e.length;if(e.sort((i,s)=>i.index-s.index),r>t){for(let i=t;i<r;++i)this._destroyDatasetMeta(i);e.splice(t,r-t)}this._sortedMetasets=e.slice(0).sort(EA("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((r,i)=>{t.filter(s=>s===r._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let r,i;for(this._removeUnreferencedMetasets(),r=0,i=t.length;r<i;r++){const s=t[r];let o=this.getDatasetMeta(r);const l=s.type||this.config.type;if(o.type&&o.type!==l&&(this._destroyDatasetMeta(r),o=this.getDatasetMeta(r)),o.type=l,o.indexAxis=s.indexAxis||Sx(l,this.options),o.order=s.order||0,o.index=r,o.label=""+s.label,o.visible=this.isDatasetVisible(r),o.controller)o.controller.updateIndex(r),o.controller.linkScales();else{const d=So.getController(l),{datasetElementType:f,dataElementType:m}=Kn.datasets[l];Object.assign(d,{dataElementType:So.getElement(m),datasetElementType:f&&So.getElement(f)}),o.controller=new d(this,r),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){hn(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const r=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let f=0,m=this.data.datasets.length;f<m;f++){const{controller:y}=this.getDatasetMeta(f),g=!i&&s.indexOf(y)===-1;y.buildOrUpdateElements(g),o=Math.max(+y.getMaxOverflow(),o)}o=this._minPadding=r.layout.autoPadding?o:0,this._updateLayout(o),i||hn(s,f=>{f.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(EA("z","_idx"));const{_active:l,_lastEvent:d}=this;d?this._eventHandler(d,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){hn(this.scales,e=>{Es.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!MS(t,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:r,start:i,count:s}of t){const o=r==="_removeElements"?-s:s;eU(e,i,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,r=s=>new Set(e.filter(o=>o[0]===s).map((o,l)=>l+","+o.splice(1).join(","))),i=r(0);for(let s=1;s<t;s++)if(!MS(i,r(s)))return;return Array.from(i).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Es.update(this,this.width,this.height,e);const t=this.chartArea,r=t.width<=0||t.height<=0;this._layers=[],hn(this.boxes,i=>{r&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,s)=>{i._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,r=this.data.datasets.length;t<r;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,r=this.data.datasets.length;t<r;++t)this._updateDataset(t,Xl(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const r=this.getDatasetMeta(e),i={meta:r,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(r.controller._update(t),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(ha.has(this)?this.attached&&!ha.running(this)&&ha.start(this):(this.draw(),TA({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,r=[];let i,s;for(i=0,s=t.length;i<s;++i){const o=t[i];(!e||o.visible)&&r.push(o)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,r={meta:e,index:e.index,cancelable:!0},i=bz(this,e);this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(i&&f2(t,i),e.controller.draw(),i&&m2(t),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(e){return Kf(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,r,i){const s=Xz.modes[t];return typeof s=="function"?s(this,e,r,i):[]}getDatasetMeta(e){const t=this.data.datasets[e],r=this._metasets;let i=r.filter(s=>s&&s._dataset===t).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},r.push(i)),i}getContext(){return this.$context||(this.$context=gu(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!t.hidden}setDatasetVisibility(e,t){const r=this.getDatasetMeta(e);r.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,r){const i=r?"show":"hide",s=this.getDatasetMeta(e),o=s.controller._resolveAnimations(void 0,i);$f(t)?(s.data[t].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),o.update(s,{visible:r}),this.update(l=>l.datasetIndex===e?i:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),ha.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),$S(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete mg[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,r=(s,o)=>{t.addEventListener(this,s,o),e[s]=o},i=(s,o,l)=>{s.offsetX=o,s.offsetY=l,this._eventHandler(s)};hn(this.options.events,s=>r(s,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,r=(d,f)=>{t.addEventListener(this,d,f),e[d]=f},i=(d,f)=>{e[d]&&(t.removeEventListener(this,d,f),delete e[d])},s=(d,f)=>{this.canvas&&this.resize(d,f)};let o;const l=()=>{i("attach",l),this.attached=!0,this.resize(),r("resize",s),r("detach",o)};o=()=>{this.attached=!1,i("resize",s),this._stop(),this._resize(0,0),r("attach",l)},t.isAttached(this.canvas)?l():o()}unbindEvents(){hn(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},hn(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,r){const i=r?"set":"remove";let s,o,l,d;for(t==="dataset"&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+i+"DatasetHoverStyle"]()),l=0,d=e.length;l<d;++l){o=e[l];const f=o&&this.getDatasetMeta(o.datasetIndex).controller;f&&f[i+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],r=e.map(({datasetIndex:s,index:o})=>{const l=this.getDatasetMeta(s);if(!l)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:l.data[o],index:o}});!Yg(r,t)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,t))}notifyPlugins(e,t,r){return this._plugins.notify(this,e,t,r)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,r){const i=this.options.hover,s=(d,f)=>d.filter(m=>!f.some(y=>m.datasetIndex===y.datasetIndex&&m.index===y.index)),o=s(t,e),l=r?e:s(e,t);o.length&&this.updateHoverStyle(o,i.mode,!1),l.length&&i.mode&&this.updateHoverStyle(l,i.mode,!0)}_eventHandler(e,t){const r={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},i=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,i)===!1)return;const s=this._handleEvent(e,t,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,i),(s||r.changed)&&this.render(),this}_handleEvent(e,t,r){const{_active:i=[],options:s}=this,o=t,l=this._getActiveElements(e,i,r,o),d=nV(e),f=tU(e,this._lastEvent,r,d);r&&(this._lastEvent=null,In(s.onHover,[e,l,this],this),d&&In(s.onClick,[e,l,this],this));const m=!Yg(l,i);return(m||t)&&(this._active=l,this._updateHoverStyles(l,i,t)),this._lastEvent=f,m}_getActiveElements(e,t,r,i){if(e.type==="mouseout")return[];if(!r)return t;const s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,i)}},Je(El,"defaults",Kn),Je(El,"instances",mg),Je(El,"overrides",cu),Je(El,"registry",So),Je(El,"version",QB),Je(El,"getChart",SA),El);function AA(){return hn(xm.instances,n=>n._plugins.invalidate())}function nU(n,e,t){const{startAngle:r,x:i,y:s,outerRadius:o,innerRadius:l,options:d}=e,{borderWidth:f,borderJoinStyle:m}=d,y=Math.min(f/o,ro(r-t));if(n.beginPath(),n.arc(i,s,o-f/2,r+y/2,t-y/2),l>0){const g=Math.min(f/l,ro(r-t));n.arc(i,s,l+f/2,t-g/2,r+g/2,!0)}else{const g=Math.min(f/2,o*ro(r-t));if(m==="round")n.arc(i,s,g,t-fn/2,r+fn/2,!0);else if(m==="bevel"){const _=2*g*g,E=-_*Math.cos(t+fn/2)+i,x=-_*Math.sin(t+fn/2)+s,w=_*Math.cos(r+fn/2)+i,S=_*Math.sin(r+fn/2)+s;n.lineTo(E,x),n.lineTo(w,S)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}function rU(n,e,t){const{startAngle:r,pixelMargin:i,x:s,y:o,outerRadius:l,innerRadius:d}=e;let f=i/l;n.beginPath(),n.arc(s,o,l,r-f,t+f),d>i?(f=i/d,n.arc(s,o,d,t+f,r-f,!0)):n.arc(s,o,i,t+hr,r-hr),n.closePath(),n.clip()}function iU(n){return p2(n,["outerStart","outerEnd","innerStart","innerEnd"])}function sU(n,e,t,r){const i=iU(n.options.borderRadius),s=(t-e)/2,o=Math.min(s,r*e/2),l=d=>{const f=(t-Math.min(s,d))*r/2;return Yr(d,0,Math.min(s,f))};return{outerStart:l(i.outerStart),outerEnd:l(i.outerEnd),innerStart:Yr(i.innerStart,0,o),innerEnd:Yr(i.innerEnd,0,o)}}function Ju(n,e,t,r){return{x:t+n*Math.cos(e),y:r+n*Math.sin(e)}}function ty(n,e,t,r,i,s){const{x:o,y:l,startAngle:d,pixelMargin:f,innerRadius:m}=e,y=Math.max(e.outerRadius+r+t-f,0),g=m>0?m+r+t+f:0;let _=0;const E=i-d;if(r){const G=m>0?m-r:0,re=y>0?y-r:0,oe=(G+re)/2,ie=oe!==0?E*oe/(oe+r):E;_=(E-ie)/2}const x=Math.max(.001,E*y-t/fn)/y,w=(E-x)/2,S=d+w+_,N=i-w-_,{outerStart:P,outerEnd:I,innerStart:R,innerEnd:U}=sU(e,g,y,N-S),j=y-P,k=y-I,F=S+P/j,O=N-I/k,C=g+R,D=g+U,M=S+R/C,$=N-U/D;if(n.beginPath(),s){const G=(F+O)/2;if(n.arc(o,l,y,F,G),n.arc(o,l,y,G,O),I>0){const X=Ju(k,O,o,l);n.arc(X.x,X.y,I,O,N+hr)}const re=Ju(D,N,o,l);if(n.lineTo(re.x,re.y),U>0){const X=Ju(D,$,o,l);n.arc(X.x,X.y,U,N+hr,$+Math.PI)}const oe=(N-U/g+(S+R/g))/2;if(n.arc(o,l,g,N-U/g,oe,!0),n.arc(o,l,g,oe,S+R/g,!0),R>0){const X=Ju(C,M,o,l);n.arc(X.x,X.y,R,M+Math.PI,S-hr)}const ie=Ju(j,S,o,l);if(n.lineTo(ie.x,ie.y),P>0){const X=Ju(j,F,o,l);n.arc(X.x,X.y,P,S-hr,F)}}else{n.moveTo(o,l);const G=Math.cos(F)*y+o,re=Math.sin(F)*y+l;n.lineTo(G,re);const oe=Math.cos(O)*y+o,ie=Math.sin(O)*y+l;n.lineTo(oe,ie)}n.closePath()}function oU(n,e,t,r,i){const{fullCircles:s,startAngle:o,circumference:l}=e;let d=e.endAngle;if(s){ty(n,e,t,r,d,i);for(let f=0;f<s;++f)n.fill();isNaN(l)||(d=o+(l%qn||qn))}return ty(n,e,t,r,d,i),n.fill(),d}function aU(n,e,t,r,i){const{fullCircles:s,startAngle:o,circumference:l,options:d}=e,{borderWidth:f,borderJoinStyle:m,borderDash:y,borderDashOffset:g,borderRadius:_}=d,E=d.borderAlign==="inner";if(!f)return;n.setLineDash(y||[]),n.lineDashOffset=g,E?(n.lineWidth=f*2,n.lineJoin=m||"round"):(n.lineWidth=f,n.lineJoin=m||"bevel");let x=e.endAngle;if(s){ty(n,e,t,r,x,i);for(let w=0;w<s;++w)n.stroke();isNaN(l)||(x=o+(l%qn||qn))}E&&rU(n,e,x),d.selfJoin&&x-o>=fn&&_===0&&m!=="miter"&&nU(n,e,x),s||(ty(n,e,t,r,x,i),n.stroke())}class Jh extends Ma{constructor(t){super();Je(this,"circumference");Je(this,"endAngle");Je(this,"fullCircles");Je(this,"innerRadius");Je(this,"outerRadius");Je(this,"pixelMargin");Je(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,r,i){const s=this.getProps(["x","y"],i),{angle:o,distance:l}=YP(s,{x:t,y:r}),{startAngle:d,endAngle:f,innerRadius:m,outerRadius:y,circumference:g}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),_=(this.options.spacing+this.options.borderWidth)/2,E=Lt(g,f-d),x=Gf(o,d,f)&&d!==f,w=E>=qn||x,S=Pl(l,m+_,y+_);return w&&S}getCenterPoint(t){const{x:r,y:i,startAngle:s,endAngle:o,innerRadius:l,outerRadius:d}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:f,spacing:m}=this.options,y=(s+o)/2,g=(l+d+m+f)/2;return{x:r+Math.cos(y)*g,y:i+Math.sin(y)*g}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:r,circumference:i}=this,s=(r.offset||0)/4,o=(r.spacing||0)/2,l=r.circular;if(this.pixelMargin=r.borderAlign==="inner"?.33:0,this.fullCircles=i>qn?Math.floor(i/qn):0,i===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const d=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(d)*s,Math.sin(d)*s);const f=1-Math.sin(Math.min(fn,i||0)),m=s*f;t.fillStyle=r.backgroundColor,t.strokeStyle=r.borderColor,oU(t,this,m,o,l),aU(t,this,m,o,l),t.restore()}}Je(Jh,"id","arc"),Je(Jh,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),Je(Jh,"defaultRoutes",{backgroundColor:"backgroundColor"}),Je(Jh,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"});function E3(n,e,t=e){n.lineCap=Lt(t.borderCapStyle,e.borderCapStyle),n.setLineDash(Lt(t.borderDash,e.borderDash)),n.lineDashOffset=Lt(t.borderDashOffset,e.borderDashOffset),n.lineJoin=Lt(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=Lt(t.borderWidth,e.borderWidth),n.strokeStyle=Lt(t.borderColor,e.borderColor)}function lU(n,e,t){n.lineTo(t.x,t.y)}function cU(n){return n.stepped?kV:n.tension||n.cubicInterpolationMode==="monotone"?CV:lU}function T3(n,e,t={}){const r=n.length,{start:i=0,end:s=r-1}=t,{start:o,end:l}=e,d=Math.max(i,o),f=Math.min(s,l),m=i<o&&s<o||i>l&&s>l;return{count:r,start:d,loop:e.loop,ilen:f<d&&!m?r+f-d:f-d}}function uU(n,e,t,r){const{points:i,options:s}=e,{count:o,start:l,loop:d,ilen:f}=T3(i,t,r),m=cU(s);let{move:y=!0,reverse:g}=r||{},_,E,x;for(_=0;_<=f;++_)E=i[(l+(g?f-_:_))%o],!E.skip&&(y?(n.moveTo(E.x,E.y),y=!1):m(n,x,E,g,s.stepped),x=E);return d&&(E=i[(l+(g?f:0))%o],m(n,x,E,g,s.stepped)),!!d}function dU(n,e,t,r){const i=e.points,{count:s,start:o,ilen:l}=T3(i,t,r),{move:d=!0,reverse:f}=r||{};let m=0,y=0,g,_,E,x,w,S;const N=I=>(o+(f?l-I:I))%s,P=()=>{x!==w&&(n.lineTo(m,w),n.lineTo(m,x),n.lineTo(m,S))};for(d&&(_=i[N(0)],n.moveTo(_.x,_.y)),g=0;g<=l;++g){if(_=i[N(g)],_.skip)continue;const I=_.x,R=_.y,U=I|0;U===E?(R<x?x=R:R>w&&(w=R),m=(y*m+I)/++y):(P(),n.lineTo(I,R),E=U,y=0,x=w=R),S=R}P()}function Nx(n){const e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?dU:uU}function hU(n){return n.stepped?lz:n.tension||n.cubicInterpolationMode==="monotone"?cz:Mc}function fU(n,e,t,r){let i=e._path;i||(i=e._path=new Path2D,e.path(i,t,r)&&i.closePath()),E3(n,e.options),n.stroke(i)}function mU(n,e,t,r){const{segments:i,options:s}=e,o=Nx(e);for(const l of i)E3(n,s,l.style),n.beginPath(),o(n,e,l,{start:t,end:t+r-1})&&n.closePath(),n.stroke()}const pU=typeof Path2D=="function";function gU(n,e,t,r){pU&&!e.options.segment?fU(n,e,t,r):mU(n,e,t,r)}class ef extends Ma{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){const i=r.spanGaps?this._loop:this._fullLoop;ez(this._points,r,e,i,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=yz(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,r=e.length;return r&&t[e[r-1].end]}interpolate(e,t){const r=this.options,i=e[t],s=this.points,o=mz(this,{property:t,start:i,end:i});if(!o.length)return;const l=[],d=hU(r);let f,m;for(f=0,m=o.length;f<m;++f){const{start:y,end:g}=o[f],_=s[y],E=s[g];if(_===E){l.push(_);continue}const x=Math.abs((i-_[t])/(E[t]-_[t])),w=d(_,E,x,r.stepped);w[t]=e[t],l.push(w)}return l.length===1?l[0]:l}pathSegment(e,t,r){return Nx(this)(e,this,t,r)}path(e,t,r){const i=this.segments,s=Nx(this);let o=this._loop;t=t||0,r=r||this.points.length-t;for(const l of i)o&=s(e,this,l,{start:t,end:t+r-1});return!!o}draw(e,t,r,i){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),gU(e,this,r,i),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Je(ef,"id","line"),Je(ef,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Je(ef,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Je(ef,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function NA(n,e,t,r){const i=n.options,{[t]:s}=n.getProps([t],r);return Math.abs(e-s)<i.radius+i.hitRadius}class pg extends Ma{constructor(t){super();Je(this,"parsed");Je(this,"skip");Je(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,r,i){const s=this.options,{x:o,y:l}=this.getProps(["x","y"],i);return Math.pow(t-o,2)+Math.pow(r-l,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(t,r){return NA(this,t,"x",r)}inYRange(t,r){return NA(this,t,"y",r)}getCenterPoint(t){const{x:r,y:i}=this.getProps(["x","y"],t);return{x:r,y:i}}size(t){t=t||this.options||{};let r=t.radius||0;r=Math.max(r,r&&t.hoverRadius||0);const i=r&&t.borderWidth||0;return(r+i)*2}draw(t,r){const i=this.options;this.skip||i.radius<.1||!Kf(this,r,this.size(i)/2)||(t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.fillStyle=i.backgroundColor,Ex(t,i,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}Je(pg,"id","point"),Je(pg,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Je(pg,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function S3(n,e){const{x:t,y:r,base:i,width:s,height:o}=n.getProps(["x","y","base","width","height"],e);let l,d,f,m,y;return n.horizontal?(y=o/2,l=Math.min(t,i),d=Math.max(t,i),f=r-y,m=r+y):(y=s/2,l=t-y,d=t+y,f=Math.min(r,i),m=Math.max(r,i)),{left:l,top:f,right:d,bottom:m}}function jl(n,e,t,r){return n?0:Yr(e,t,r)}function yU(n,e,t){const r=n.options.borderWidth,i=n.borderSkipped,s=n3(r);return{t:jl(i.top,s.top,0,t),r:jl(i.right,s.right,0,e),b:jl(i.bottom,s.bottom,0,t),l:jl(i.left,s.left,0,e)}}function vU(n,e,t){const{enableBorderRadius:r}=n.getProps(["enableBorderRadius"]),i=n.options.borderRadius,s=fd(i),o=Math.min(e,t),l=n.borderSkipped,d=r||Qt(i);return{topLeft:jl(!d||l.top||l.left,s.topLeft,0,o),topRight:jl(!d||l.top||l.right,s.topRight,0,o),bottomLeft:jl(!d||l.bottom||l.left,s.bottomLeft,0,o),bottomRight:jl(!d||l.bottom||l.right,s.bottomRight,0,o)}}function _U(n){const e=S3(n),t=e.right-e.left,r=e.bottom-e.top,i=yU(n,t/2,r/2),s=vU(n,t/2,r/2);return{outer:{x:e.left,y:e.top,w:t,h:r,radius:s},inner:{x:e.left+i.l,y:e.top+i.t,w:t-i.l-i.r,h:r-i.t-i.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,s.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(i.b,i.r))}}}}function Gv(n,e,t,r){const i=e===null,s=t===null,l=n&&!(i&&s)&&S3(n,r);return l&&(i||Pl(e,l.left,l.right))&&(s||Pl(t,l.top,l.bottom))}function xU(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function bU(n,e){n.rect(e.x,e.y,e.w,e.h)}function Kv(n,e,t={}){const r=n.x!==t.x?-e:0,i=n.y!==t.y?-e:0,s=(n.x+n.w!==t.x+t.w?e:0)-r,o=(n.y+n.h!==t.y+t.h?e:0)-i;return{x:n.x+r,y:n.y+i,w:n.w+s,h:n.h+o,radius:n.radius}}class xf extends Ma{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:r,backgroundColor:i}}=this,{inner:s,outer:o}=_U(this),l=xU(o.radius)?Xg:bU;e.save(),(o.w!==s.w||o.h!==s.h)&&(e.beginPath(),l(e,Kv(o,t,s)),e.clip(),l(e,Kv(s,-t,o)),e.fillStyle=r,e.fill("evenodd")),e.beginPath(),l(e,Kv(s,t)),e.fillStyle=i,e.fill(),e.restore()}inRange(e,t,r){return Gv(this,e,t,r)}inXRange(e,t){return Gv(this,e,null,t)}inYRange(e,t){return Gv(this,null,e,t)}getCenterPoint(e){const{x:t,y:r,base:i,horizontal:s}=this.getProps(["x","y","base","horizontal"],e);return{x:s?(t+i)/2:t,y:s?r:(r+i)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}Je(xf,"id","bar"),Je(xf,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Je(xf,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const IA=(n,e)=>{let{boxHeight:t=e,boxWidth:r=e}=n;return n.usePointStyle&&(t=Math.min(t,e),r=n.pointStyleWidth||Math.min(r,e)),{boxWidth:r,boxHeight:t,itemHeight:Math.max(e,t)}},wU=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class kA extends Ma{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,r){this.maxWidth=e,this.maxHeight=t,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=In(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(r=>e.filter(r,this.chart.data))),e.sort&&(t=t.sort((r,i)=>e.sort(r,i,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const r=e.labels,i=Zr(r.font),s=i.size,o=this._computeTitleHeight(),{boxWidth:l,itemHeight:d}=IA(r,s);let f,m;t.font=i.string,this.isHorizontal()?(f=this.maxWidth,m=this._fitRows(o,s,l,d)+10):(m=this.maxHeight,f=this._fitCols(o,i,l,d)+10),this.width=Math.min(f,e.maxWidth||this.maxWidth),this.height=Math.min(m,e.maxHeight||this.maxHeight)}_fitRows(e,t,r,i){const{ctx:s,maxWidth:o,options:{labels:{padding:l}}}=this,d=this.legendHitBoxes=[],f=this.lineWidths=[0],m=i+l;let y=e;s.textAlign="left",s.textBaseline="middle";let g=-1,_=-m;return this.legendItems.forEach((E,x)=>{const w=r+t/2+s.measureText(E.text).width;(x===0||f[f.length-1]+w+2*l>o)&&(y+=m,f[f.length-(x>0?0:1)]=0,_+=m,g++),d[x]={left:0,top:_,row:g,width:w,height:i},f[f.length-1]+=w+l}),y}_fitCols(e,t,r,i){const{ctx:s,maxHeight:o,options:{labels:{padding:l}}}=this,d=this.legendHitBoxes=[],f=this.columnSizes=[],m=o-e;let y=l,g=0,_=0,E=0,x=0;return this.legendItems.forEach((w,S)=>{const{itemWidth:N,itemHeight:P}=EU(r,t,s,w,i);S>0&&_+P+2*l>m&&(y+=g+l,f.push({width:g,height:_}),E+=g+l,x++,g=_=0),d[S]={left:E,top:_,col:x,width:N,height:P},g=Math.max(g,N),_+=P+l}),y+=g,f.push({width:g,height:_}),y}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:r,labels:{padding:i},rtl:s}}=this,o=md(s,this.left,this.width);if(this.isHorizontal()){let l=0,d=Wr(r,this.left+i,this.right-this.lineWidths[l]);for(const f of t)l!==f.row&&(l=f.row,d=Wr(r,this.left+i,this.right-this.lineWidths[l])),f.top+=this.top+e+i,f.left=o.leftForLtr(o.x(d),f.width),d+=f.width+i}else{let l=0,d=Wr(r,this.top+e+i,this.bottom-this.columnSizes[l].height);for(const f of t)f.col!==l&&(l=f.col,d=Wr(r,this.top+e+i,this.bottom-this.columnSizes[l].height)),f.top=d,f.left+=this.left+i,f.left=o.leftForLtr(o.x(f.left),f.width),d+=f.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;f2(e,this),this._draw(),m2(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:r,ctx:i}=this,{align:s,labels:o}=e,l=Kn.color,d=md(e.rtl,this.left,this.width),f=Zr(o.font),{padding:m}=o,y=f.size,g=y/2;let _;this.drawTitle(),i.textAlign=d.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=f.string;const{boxWidth:E,boxHeight:x,itemHeight:w}=IA(o,y),S=function(U,j,k){if(isNaN(E)||E<=0||isNaN(x)||x<0)return;i.save();const F=Lt(k.lineWidth,1);if(i.fillStyle=Lt(k.fillStyle,l),i.lineCap=Lt(k.lineCap,"butt"),i.lineDashOffset=Lt(k.lineDashOffset,0),i.lineJoin=Lt(k.lineJoin,"miter"),i.lineWidth=F,i.strokeStyle=Lt(k.strokeStyle,l),i.setLineDash(Lt(k.lineDash,[])),o.usePointStyle){const O={radius:x*Math.SQRT2/2,pointStyle:k.pointStyle,rotation:k.rotation,borderWidth:F},C=d.xPlus(U,E/2),D=j+g;t3(i,O,C,D,o.pointStyleWidth&&E)}else{const O=j+Math.max((y-x)/2,0),C=d.leftForLtr(U,E),D=fd(k.borderRadius);i.beginPath(),Object.values(D).some(M=>M!==0)?Xg(i,{x:C,y:O,w:E,h:x,radius:D}):i.rect(C,O,E,x),i.fill(),F!==0&&i.stroke()}i.restore()},N=function(U,j,k){Yf(i,k.text,U,j+w/2,f,{strikethrough:k.hidden,textAlign:d.textAlign(k.textAlign)})},P=this.isHorizontal(),I=this._computeTitleHeight();P?_={x:Wr(s,this.left+m,this.right-r[0]),y:this.top+m+I,line:0}:_={x:this.left+m,y:Wr(s,this.top+I+m,this.bottom-t[0].height),line:0},l3(this.ctx,e.textDirection);const R=w+m;this.legendItems.forEach((U,j)=>{i.strokeStyle=U.fontColor,i.fillStyle=U.fontColor;const k=i.measureText(U.text).width,F=d.textAlign(U.textAlign||(U.textAlign=o.textAlign)),O=E+g+k;let C=_.x,D=_.y;d.setWidth(this.width),P?j>0&&C+O+m>this.right&&(D=_.y+=R,_.line++,C=_.x=Wr(s,this.left+m,this.right-r[_.line])):j>0&&D+R>this.bottom&&(C=_.x=C+t[_.line].width+m,_.line++,D=_.y=Wr(s,this.top+I+m,this.bottom-t[_.line].height));const M=d.x(C);if(S(M,D,U),C=gV(F,C+E+g,P?C+O:this.right,e.rtl),N(d.x(C),D,U),P)_.x+=O+m;else if(typeof U.text!="string"){const $=f.lineHeight;_.y+=A3(U,$)+m}else _.y+=R}),c3(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,r=Zr(t.font),i=Ms(t.padding);if(!t.display)return;const s=md(e.rtl,this.left,this.width),o=this.ctx,l=t.position,d=r.size/2,f=i.top+d;let m,y=this.left,g=this.width;if(this.isHorizontal())g=Math.max(...this.lineWidths),m=this.top+f,y=Wr(e.align,y,this.right-g);else{const E=this.columnSizes.reduce((x,w)=>Math.max(x,w.height),0);m=f+Wr(e.align,this.top,this.bottom-E-e.labels.padding-this._computeTitleHeight())}const _=Wr(l,y,y+g);o.textAlign=s.textAlign(u2(l)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=r.string,Yf(o,t.text,_,m,r)}_computeTitleHeight(){const e=this.options.title,t=Zr(e.font),r=Ms(e.padding);return e.display?t.lineHeight+r.height:0}_getLegendItemAt(e,t){let r,i,s;if(Pl(e,this.left,this.right)&&Pl(t,this.top,this.bottom)){for(s=this.legendHitBoxes,r=0;r<s.length;++r)if(i=s[r],Pl(e,i.left,i.left+i.width)&&Pl(t,i.top,i.top+i.height))return this.legendItems[r]}return null}handleEvent(e){const t=this.options;if(!AU(e.type,t))return;const r=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const i=this._hoveredItem,s=wU(i,r);i&&!s&&In(t.onLeave,[e,i,this],this),this._hoveredItem=r,r&&!s&&In(t.onHover,[e,r,this],this)}else r&&In(t.onClick,[e,r,this],this)}}function EU(n,e,t,r,i){const s=TU(r,n,e,t),o=SU(i,r,e.lineHeight);return{itemWidth:s,itemHeight:o}}function TU(n,e,t,r){let i=n.text;return i&&typeof i!="string"&&(i=i.reduce((s,o)=>s.length>o.length?s:o)),e+t.size/2+r.measureText(i).width}function SU(n,e,t){let r=n;return typeof e.text!="string"&&(r=A3(e,t)),r}function A3(n,e){const t=n.text?n.text.length:0;return e*t}function AU(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var N3={id:"legend",_element:kA,start(n,e,t){const r=n.legend=new kA({ctx:n.ctx,options:t,chart:n});Es.configure(n,r,t),Es.addBox(n,r)},stop(n){Es.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const r=n.legend;Es.configure(n,r,t),r.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const r=e.datasetIndex,i=t.chart;i.isDatasetVisible(r)?(i.hide(r),e.hidden=!0):(i.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:r,textAlign:i,color:s,useBorderRadius:o,borderRadius:l}}=n.legend.options;return n._getSortedDatasetMetas().map(d=>{const f=d.controller.getStyle(t?0:void 0),m=Ms(f.borderWidth);return{text:e[d.index].label,fillStyle:f.backgroundColor,fontColor:s,hidden:!d.visible,lineCap:f.borderCapStyle,lineDash:f.borderDash,lineDashOffset:f.borderDashOffset,lineJoin:f.borderJoinStyle,lineWidth:(m.width+m.height)/4,strokeStyle:f.borderColor,pointStyle:r||f.pointStyle,rotation:f.rotation,textAlign:i||f.textAlign,borderRadius:o&&(l||f.borderRadius),datasetIndex:d.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};class I3 extends Ma{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const r=this.options;if(this.left=0,this.top=0,!r.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const i=ur(r.text)?r.text.length:1;this._padding=Ms(r.padding);const s=i*Zr(r.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:r,bottom:i,right:s,options:o}=this,l=o.align;let d=0,f,m,y;return this.isHorizontal()?(m=Wr(l,r,s),y=t+e,f=s-r):(o.position==="left"?(m=r+e,y=Wr(l,i,t),d=fn*-.5):(m=s-e,y=Wr(l,t,i),d=fn*.5),f=i-t),{titleX:m,titleY:y,maxWidth:f,rotation:d}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const r=Zr(t.font),s=r.lineHeight/2+this._padding.top,{titleX:o,titleY:l,maxWidth:d,rotation:f}=this._drawArgs(s);Yf(e,t.text,0,0,r,{color:t.color,maxWidth:d,rotation:f,textAlign:u2(t.align),textBaseline:"middle",translation:[o,l]})}}function NU(n,e){const t=new I3({ctx:n.ctx,options:e,chart:n});Es.configure(n,t,e),Es.addBox(n,t),n.titleBlock=t}var k3={id:"title",_element:I3,start(n,e,t){NU(n,t)},stop(n){const e=n.titleBlock;Es.removeBox(n,e),delete n.titleBlock},beforeUpdate(n,e,t){const r=n.titleBlock;Es.configure(n,r,t),r.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const tf={average(n){if(!n.length)return!1;let e,t,r=new Set,i=0,s=0;for(e=0,t=n.length;e<t;++e){const l=n[e].element;if(l&&l.hasValue()){const d=l.tooltipPosition();r.add(d.x),i+=d.y,++s}}return s===0||r.size===0?!1:{x:[...r].reduce((l,d)=>l+d)/r.size,y:i/s}},nearest(n,e){if(!n.length)return!1;let t=e.x,r=e.y,i=Number.POSITIVE_INFINITY,s,o,l;for(s=0,o=n.length;s<o;++s){const d=n[s].element;if(d&&d.hasValue()){const f=d.getCenterPoint(),m=bx(e,f);m<i&&(i=m,l=d)}}if(l){const d=l.tooltipPosition();t=d.x,r=d.y}return{x:t,y:r}}};function To(n,e){return e&&(ur(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function fa(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function IU(n,e){const{element:t,datasetIndex:r,index:i}=e,s=n.getDatasetMeta(r).controller,{label:o,value:l}=s.getLabelAndValue(i);return{chart:n,label:o,parsed:s.getParsed(i),raw:n.data.datasets[r].data[i],formattedValue:l,dataset:s.getDataset(),dataIndex:i,datasetIndex:r,element:t}}function CA(n,e){const t=n.chart.ctx,{body:r,footer:i,title:s}=n,{boxWidth:o,boxHeight:l}=e,d=Zr(e.bodyFont),f=Zr(e.titleFont),m=Zr(e.footerFont),y=s.length,g=i.length,_=r.length,E=Ms(e.padding);let x=E.height,w=0,S=r.reduce((I,R)=>I+R.before.length+R.lines.length+R.after.length,0);if(S+=n.beforeBody.length+n.afterBody.length,y&&(x+=y*f.lineHeight+(y-1)*e.titleSpacing+e.titleMarginBottom),S){const I=e.displayColors?Math.max(l,d.lineHeight):d.lineHeight;x+=_*I+(S-_)*d.lineHeight+(S-1)*e.bodySpacing}g&&(x+=e.footerMarginTop+g*m.lineHeight+(g-1)*e.footerSpacing);let N=0;const P=function(I){w=Math.max(w,t.measureText(I).width+N)};return t.save(),t.font=f.string,hn(n.title,P),t.font=d.string,hn(n.beforeBody.concat(n.afterBody),P),N=e.displayColors?o+2+e.boxPadding:0,hn(r,I=>{hn(I.before,P),hn(I.lines,P),hn(I.after,P)}),N=0,t.font=m.string,hn(n.footer,P),t.restore(),w+=E.width,{width:w,height:x}}function kU(n,e){const{y:t,height:r}=e;return t<r/2?"top":t>n.height-r/2?"bottom":"center"}function CU(n,e,t,r){const{x:i,width:s}=r,o=t.caretSize+t.caretPadding;if(n==="left"&&i+s+o>e.width||n==="right"&&i-s-o<0)return!0}function PU(n,e,t,r){const{x:i,width:s}=t,{width:o,chartArea:{left:l,right:d}}=n;let f="center";return r==="center"?f=i<=(l+d)/2?"left":"right":i<=s/2?f="left":i>=o-s/2&&(f="right"),CU(f,n,e,t)&&(f="center"),f}function PA(n,e,t){const r=t.yAlign||e.yAlign||kU(n,t);return{xAlign:t.xAlign||e.xAlign||PU(n,e,t,r),yAlign:r}}function RU(n,e){let{x:t,width:r}=n;return e==="right"?t-=r:e==="center"&&(t-=r/2),t}function jU(n,e,t){let{y:r,height:i}=n;return e==="top"?r+=t:e==="bottom"?r-=i+t:r-=i/2,r}function RA(n,e,t,r){const{caretSize:i,caretPadding:s,cornerRadius:o}=n,{xAlign:l,yAlign:d}=t,f=i+s,{topLeft:m,topRight:y,bottomLeft:g,bottomRight:_}=fd(o);let E=RU(e,l);const x=jU(e,d,f);return d==="center"?l==="left"?E+=f:l==="right"&&(E-=f):l==="left"?E-=Math.max(m,g)+i:l==="right"&&(E+=Math.max(y,_)+i),{x:Yr(E,0,r.width-e.width),y:Yr(x,0,r.height-e.height)}}function Up(n,e,t){const r=Ms(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-r.right:n.x+r.left}function jA(n){return To([],fa(n))}function OU(n,e,t){return gu(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function OA(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}const C3={beforeTitle:ua,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,r=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return t[e.dataIndex]}return""},afterTitle:ua,beforeBody:ua,beforeLabel:ua,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return an(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:ua,afterBody:ua,beforeFooter:ua,footer:ua,afterFooter:ua};function Oi(n,e,t,r){const i=n[e].call(t,r);return typeof i>"u"?C3[e].call(t,r):i}var j_;let MA=(j_=class extends Ma{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,r=this.options.setContext(this.getContext()),i=r.enabled&&t.options.animation&&r.animations,s=new d3(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=OU(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:r}=t,i=Oi(r,"beforeTitle",this,e),s=Oi(r,"title",this,e),o=Oi(r,"afterTitle",this,e);let l=[];return l=To(l,fa(i)),l=To(l,fa(s)),l=To(l,fa(o)),l}getBeforeBody(e,t){return jA(Oi(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:r}=t,i=[];return hn(e,s=>{const o={before:[],lines:[],after:[]},l=OA(r,s);To(o.before,fa(Oi(l,"beforeLabel",this,s))),To(o.lines,Oi(l,"label",this,s)),To(o.after,fa(Oi(l,"afterLabel",this,s))),i.push(o)}),i}getAfterBody(e,t){return jA(Oi(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:r}=t,i=Oi(r,"beforeFooter",this,e),s=Oi(r,"footer",this,e),o=Oi(r,"afterFooter",this,e);let l=[];return l=To(l,fa(i)),l=To(l,fa(s)),l=To(l,fa(o)),l}_createItems(e){const t=this._active,r=this.chart.data,i=[],s=[],o=[];let l=[],d,f;for(d=0,f=t.length;d<f;++d)l.push(IU(this.chart,t[d]));return e.filter&&(l=l.filter((m,y,g)=>e.filter(m,y,g,r))),e.itemSort&&(l=l.sort((m,y)=>e.itemSort(m,y,r))),hn(l,m=>{const y=OA(e.callbacks,m);i.push(Oi(y,"labelColor",this,m)),s.push(Oi(y,"labelPointStyle",this,m)),o.push(Oi(y,"labelTextColor",this,m))}),this.labelColors=i,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=l,l}update(e,t){const r=this.options.setContext(this.getContext()),i=this._active;let s,o=[];if(!i.length)this.opacity!==0&&(s={opacity:0});else{const l=tf[r.position].call(this,i,this._eventPosition);o=this._createItems(r),this.title=this.getTitle(o,r),this.beforeBody=this.getBeforeBody(o,r),this.body=this.getBody(o,r),this.afterBody=this.getAfterBody(o,r),this.footer=this.getFooter(o,r);const d=this._size=CA(this,r),f=Object.assign({},l,d),m=PA(this.chart,r,f),y=RA(r,f,m,this.chart);this.xAlign=m.xAlign,this.yAlign=m.yAlign,s={opacity:1,x:y.x,y:y.y,width:d.width,height:d.height,caretX:l.x,caretY:l.y}}this._tooltipItems=o,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,r,i){const s=this.getCaretPosition(e,r,i);t.lineTo(s.x1,s.y1),t.lineTo(s.x2,s.y2),t.lineTo(s.x3,s.y3)}getCaretPosition(e,t,r){const{xAlign:i,yAlign:s}=this,{caretSize:o,cornerRadius:l}=r,{topLeft:d,topRight:f,bottomLeft:m,bottomRight:y}=fd(l),{x:g,y:_}=e,{width:E,height:x}=t;let w,S,N,P,I,R;return s==="center"?(I=_+x/2,i==="left"?(w=g,S=w-o,P=I+o,R=I-o):(w=g+E,S=w+o,P=I-o,R=I+o),N=w):(i==="left"?S=g+Math.max(d,m)+o:i==="right"?S=g+E-Math.max(f,y)-o:S=this.caretX,s==="top"?(P=_,I=P-o,w=S-o,N=S+o):(P=_+x,I=P+o,w=S+o,N=S-o),R=P),{x1:w,x2:S,x3:N,y1:P,y2:I,y3:R}}drawTitle(e,t,r){const i=this.title,s=i.length;let o,l,d;if(s){const f=md(r.rtl,this.x,this.width);for(e.x=Up(this,r.titleAlign,r),t.textAlign=f.textAlign(r.titleAlign),t.textBaseline="middle",o=Zr(r.titleFont),l=r.titleSpacing,t.fillStyle=r.titleColor,t.font=o.string,d=0;d<s;++d)t.fillText(i[d],f.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+l,d+1===s&&(e.y+=r.titleMarginBottom-l)}}_drawColorBox(e,t,r,i,s){const o=this.labelColors[r],l=this.labelPointStyles[r],{boxHeight:d,boxWidth:f}=s,m=Zr(s.bodyFont),y=Up(this,"left",s),g=i.x(y),_=d<m.lineHeight?(m.lineHeight-d)/2:0,E=t.y+_;if(s.usePointStyle){const x={radius:Math.min(f,d)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},w=i.leftForLtr(g,f)+f/2,S=E+d/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,Ex(e,x,w,S),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,Ex(e,x,w,S)}else{e.lineWidth=Qt(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const x=i.leftForLtr(g,f),w=i.leftForLtr(i.xPlus(g,1),f-2),S=fd(o.borderRadius);Object.values(S).some(N=>N!==0)?(e.beginPath(),e.fillStyle=s.multiKeyBackground,Xg(e,{x,y:E,w:f,h:d,radius:S}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),Xg(e,{x:w,y:E+1,w:f-2,h:d-2,radius:S}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(x,E,f,d),e.strokeRect(x,E,f,d),e.fillStyle=o.backgroundColor,e.fillRect(w,E+1,f-2,d-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,t,r){const{body:i}=this,{bodySpacing:s,bodyAlign:o,displayColors:l,boxHeight:d,boxWidth:f,boxPadding:m}=r,y=Zr(r.bodyFont);let g=y.lineHeight,_=0;const E=md(r.rtl,this.x,this.width),x=function(k){t.fillText(k,E.x(e.x+_),e.y+g/2),e.y+=g+s},w=E.textAlign(o);let S,N,P,I,R,U,j;for(t.textAlign=o,t.textBaseline="middle",t.font=y.string,e.x=Up(this,w,r),t.fillStyle=r.bodyColor,hn(this.beforeBody,x),_=l&&w!=="right"?o==="center"?f/2+m:f+2+m:0,I=0,U=i.length;I<U;++I){for(S=i[I],N=this.labelTextColors[I],t.fillStyle=N,hn(S.before,x),P=S.lines,l&&P.length&&(this._drawColorBox(t,e,I,E,r),g=Math.max(y.lineHeight,d)),R=0,j=P.length;R<j;++R)x(P[R]),g=y.lineHeight;hn(S.after,x)}_=0,g=y.lineHeight,hn(this.afterBody,x),e.y-=s}drawFooter(e,t,r){const i=this.footer,s=i.length;let o,l;if(s){const d=md(r.rtl,this.x,this.width);for(e.x=Up(this,r.footerAlign,r),e.y+=r.footerMarginTop,t.textAlign=d.textAlign(r.footerAlign),t.textBaseline="middle",o=Zr(r.footerFont),t.fillStyle=r.footerColor,t.font=o.string,l=0;l<s;++l)t.fillText(i[l],d.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+r.footerSpacing}}drawBackground(e,t,r,i){const{xAlign:s,yAlign:o}=this,{x:l,y:d}=e,{width:f,height:m}=r,{topLeft:y,topRight:g,bottomLeft:_,bottomRight:E}=fd(i.cornerRadius);t.fillStyle=i.backgroundColor,t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.beginPath(),t.moveTo(l+y,d),o==="top"&&this.drawCaret(e,t,r,i),t.lineTo(l+f-g,d),t.quadraticCurveTo(l+f,d,l+f,d+g),o==="center"&&s==="right"&&this.drawCaret(e,t,r,i),t.lineTo(l+f,d+m-E),t.quadraticCurveTo(l+f,d+m,l+f-E,d+m),o==="bottom"&&this.drawCaret(e,t,r,i),t.lineTo(l+_,d+m),t.quadraticCurveTo(l,d+m,l,d+m-_),o==="center"&&s==="left"&&this.drawCaret(e,t,r,i),t.lineTo(l,d+y),t.quadraticCurveTo(l,d,l+y,d),t.closePath(),t.fill(),i.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,r=this.$animations,i=r&&r.x,s=r&&r.y;if(i||s){const o=tf[e.position].call(this,this._active,this._eventPosition);if(!o)return;const l=this._size=CA(this,e),d=Object.assign({},o,this._size),f=PA(t,e,d),m=RA(e,d,f,t);(i._to!==m.x||s._to!==m.y)&&(this.xAlign=f.xAlign,this.yAlign=f.yAlign,this.width=l.width,this.height=l.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,m))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(t);const i={width:this.width,height:this.height},s={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const o=Ms(t.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&l&&(e.save(),e.globalAlpha=r,this.drawBackground(s,e,i,t),l3(e,t.textDirection),s.y+=o.top,this.drawTitle(s,e,t),this.drawBody(s,e,t),this.drawFooter(s,e,t),c3(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const r=this._active,i=e.map(({datasetIndex:l,index:d})=>{const f=this.chart.getDatasetMeta(l);if(!f)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:f.data[d],index:d}}),s=!Yg(r,i),o=this._positionChanged(i,t);(s||o)&&(this._active=i,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,r=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,s=this._active||[],o=this._getActiveElements(e,s,t,r),l=this._positionChanged(o,e),d=t||!Yg(o,s)||l;return d&&(this._active=o,(i.enabled||i.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),d}_getActiveElements(e,t,r,i){const s=this.options;if(e.type==="mouseout")return[];if(!i)return t.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,s.mode,s,r);return s.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:r,caretY:i,options:s}=this,o=tf[s.position].call(this,e,t);return o!==!1&&(r!==o.x||i!==o.y)}},Je(j_,"positioners",tf),j_);var P3={id:"tooltip",_element:MA,positioners:tf,afterInit(n,e,t){t&&(n.tooltip=new MA({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:C3},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const MU=(n,e,t,r)=>(typeof e=="string"?(t=n.push(e)-1,r.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function DU(n,e,t,r){const i=n.indexOf(e);if(i===-1)return MU(n,e,t,r);const s=n.lastIndexOf(e);return i!==s?t:i}const LU=(n,e)=>n===null?null:Yr(Math.round(n),0,e);function DA(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class ny extends Hd{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const r=this.getLabels();for(const{index:i,label:s}of t)r[i]===s&&r.splice(i,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(an(e))return null;const r=this.getLabels();return t=isFinite(t)&&r[t]===e?t:DU(r,e,Lt(t,e),this._addedLabels),LU(t,r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:r,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),t||(i=this.getLabels().length-1)),this.min=r,this.max=i}buildTicks(){const e=this.min,t=this.max,r=this.options.offset,i=[];let s=this.getLabels();s=e===0&&t===s.length-1?s:s.slice(e,t+1),this._valueRange=Math.max(s.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let o=e;o<=t;o++)i.push({value:o});return i}getLabelForValue(e){return DA.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}Je(ny,"id","category"),Je(ny,"defaults",{ticks:{callback:DA}});function FU(n,e){const t=[],{bounds:i,step:s,min:o,max:l,precision:d,count:f,maxTicks:m,maxDigits:y,includeBounds:g}=n,_=s||1,E=m-1,{min:x,max:w}=e,S=!an(o),N=!an(l),P=!an(f),I=(w-x)/(y+1);let R=LS((w-x)/E/_)*_,U,j,k,F;if(R<1e-14&&!S&&!N)return[{value:x},{value:w}];F=Math.ceil(w/R)-Math.floor(x/R),F>E&&(R=LS(F*R/E/_)*_),an(d)||(U=Math.pow(10,d),R=Math.ceil(R*U)/U),i==="ticks"?(j=Math.floor(x/R)*R,k=Math.ceil(w/R)*R):(j=x,k=w),S&&N&&s&&aV((l-o)/s,R/1e3)?(F=Math.round(Math.min((l-o)/R,m)),R=(l-o)/F,j=o,k=l):P?(j=S?o:j,k=N?l:k,F=f-1,R=(k-j)/F):(F=(k-j)/R,yf(F,Math.round(F),R/1e3)?F=Math.round(F):F=Math.ceil(F));const O=Math.max(FS(R),FS(j));U=Math.pow(10,an(d)?O:d),j=Math.round(j*U)/U,k=Math.round(k*U)/U;let C=0;for(S&&(g&&j!==o?(t.push({value:o}),j<o&&C++,yf(Math.round((j+C*R)*U)/U,o,LA(o,I,n))&&C++):j<o&&C++);C<F;++C){const D=Math.round((j+C*R)*U)/U;if(N&&D>l)break;t.push({value:D})}return N&&g&&k!==l?t.length&&yf(t[t.length-1].value,l,LA(l,I,n))?t[t.length-1].value=l:t.push({value:l}):(!N||k===l)&&t.push({value:k}),t}function LA(n,e,{horizontal:t,minRotation:r}){const i=_a(r),s=(t?Math.sin(i):Math.cos(i))||.001,o=.75*e*(""+n).length;return Math.min(e/s,o)}class VU extends Hd{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return an(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:r}=this.getUserBounds();let{min:i,max:s}=this;const o=d=>i=t?i:d,l=d=>s=r?s:d;if(e){const d=Ro(i),f=Ro(s);d<0&&f<0?l(0):d>0&&f>0&&o(0)}if(i===s){let d=s===0?1:Math.abs(s*.05);l(s+d),e||o(i-d)}this.min=i,this.max=s}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:r}=e,i;return r?(i=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),t=t||11),t&&(i=Math.min(t,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const i={maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},s=this._range||this,o=FU(i,s);return e.bounds==="ticks"&&lV(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let t=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const i=(r-t)/Math.max(e.length-1,1)/2;t-=i,r+=i}this._startValue=t,this._endValue=r,this._valueRange=r-t}getLabelForValue(e){return h2(e,this.chart.options.locale,this.options.ticks.format)}}class ry extends VU{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=Os(e)?e:0,this.max=Os(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,r=_a(this.options.ticks.minRotation),i=(e?Math.sin(r):Math.cos(r))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,s.lineHeight/i))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}Je(ry,"id","linear"),Je(ry,"defaults",{ticks:{callback:e3.formatters.numeric}});const Wy={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Di=Object.keys(Wy);function FA(n,e){return n-e}function VA(n,e){if(an(e))return null;const t=n._adapter,{parser:r,round:i,isoWeekday:s}=n._parseOpts;let o=e;return typeof r=="function"&&(o=r(o)),Os(o)||(o=typeof r=="string"?t.parse(o,r):t.parse(o)),o===null?null:(i&&(o=i==="week"&&(Wf(s)||s===!0)?t.startOf(o,"isoWeek",s):t.startOf(o,i)),+o)}function zA(n,e,t,r){const i=Di.length;for(let s=Di.indexOf(n);s<i-1;++s){const o=Wy[Di[s]],l=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((t-e)/(l*o.size))<=r)return Di[s]}return Di[i-1]}function zU(n,e,t,r,i){for(let s=Di.length-1;s>=Di.indexOf(t);s--){const o=Di[s];if(Wy[o].common&&n._adapter.diff(i,r,o)>=e-1)return o}return Di[t?Di.indexOf(t):0]}function BU(n){for(let e=Di.indexOf(n)+1,t=Di.length;e<t;++e)if(Wy[Di[e]].common)return Di[e]}function BA(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:r,hi:i}=c2(t,e),s=t[r]>=e?t[r]:t[i];n[s]=!0}}function UU(n,e,t,r){const i=n._adapter,s=+i.startOf(e[0].value,r),o=e[e.length-1].value;let l,d;for(l=s;l<=o;l=+i.add(l,1,r))d=t[l],d>=0&&(e[d].major=!0);return e}function UA(n,e,t){const r=[],i={},s=e.length;let o,l;for(o=0;o<s;++o)l=e[o],i[l]=o,r.push({value:l,major:!1});return s===0||!t?r:UU(n,r,i,t)}class iy extends Hd{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const r=e.time||(e.time={}),i=this._adapter=new Gz._date(e.adapters.date);i.init(t),gf(r.displayFormats,i.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:VA(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,r=e.time.unit||"day";let{min:i,max:s,minDefined:o,maxDefined:l}=this.getUserBounds();function d(f){!o&&!isNaN(f.min)&&(i=Math.min(i,f.min)),!l&&!isNaN(f.max)&&(s=Math.max(s,f.max))}(!o||!l)&&(d(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&d(this.getMinMax(!1))),i=Os(i)&&!isNaN(i)?i:+t.startOf(Date.now(),r),s=Os(s)&&!isNaN(s)?s:+t.endOf(Date.now(),r)+1,this.min=Math.min(i,s-1),this.max=Math.max(i+1,s)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],r=e[e.length-1]),{min:t,max:r}}buildTicks(){const e=this.options,t=e.time,r=e.ticks,i=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const s=this.min,o=this.max,l=fV(i,s,o);return this._unit=t.unit||(r.autoSkip?zA(t.minUnit,this.min,this.max,this._getLabelCapacity(s)):zU(this,l.length,t.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:BU(this._unit),this.initOffsets(i),e.reverse&&l.reverse(),UA(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,r=0,i,s;this.options.offset&&e.length&&(i=this.getDecimalForValue(e[0]),e.length===1?t=1-i:t=(this.getDecimalForValue(e[1])-i)/2,s=this.getDecimalForValue(e[e.length-1]),e.length===1?r=s:r=(s-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;t=Yr(t,0,o),r=Yr(r,0,o),this._offsets={start:t,end:r,factor:1/(t+1+r)}}_generate(){const e=this._adapter,t=this.min,r=this.max,i=this.options,s=i.time,o=s.unit||zA(s.minUnit,t,r,this._getLabelCapacity(t)),l=Lt(i.ticks.stepSize,1),d=o==="week"?s.isoWeekday:!1,f=Wf(d)||d===!0,m={};let y=t,g,_;if(f&&(y=+e.startOf(y,"isoWeek",d)),y=+e.startOf(y,f?"day":o),e.diff(r,t,o)>1e5*l)throw new Error(t+" and "+r+" are too far apart with stepSize of "+l+" "+o);const E=i.ticks.source==="data"&&this.getDataTimestamps();for(g=y,_=0;g<r;g=+e.add(g,l,o),_++)BA(m,g,E);return(g===r||i.bounds==="ticks"||_===1)&&BA(m,g,E),Object.keys(m).sort(FA).map(x=>+x)}getLabelForValue(e){const t=this._adapter,r=this.options.time;return r.tooltipFormat?t.format(e,r.tooltipFormat):t.format(e,r.displayFormats.datetime)}format(e,t){const i=this.options.time.displayFormats,s=this._unit,o=t||i[s];return this._adapter.format(e,o)}_tickFormatFunction(e,t,r,i){const s=this.options,o=s.ticks.callback;if(o)return In(o,[e,t,r],this);const l=s.time.displayFormats,d=this._unit,f=this._majorUnit,m=d&&l[d],y=f&&l[f],g=r[t],_=f&&y&&g&&g.major;return this._adapter.format(e,i||(_?y:m))}generateTickLabels(e){let t,r,i;for(t=0,r=e.length;t<r;++t)i=e[t],i.label=this._tickFormatFunction(i.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+r)*t.factor)}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,r=this.ctx.measureText(e).width,i=_a(this.isHorizontal()?t.maxRotation:t.minRotation),s=Math.cos(i),o=Math.sin(i),l=this._resolveTickFontOptions(0).size;return{w:r*s+l*o,h:r*o+l*s}}_getLabelCapacity(e){const t=this.options.time,r=t.displayFormats,i=r[t.unit]||r.millisecond,s=this._tickFormatFunction(e,0,UA(this,[e],this._majorUnit),i),o=this._getLabelSize(s),l=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return l>0?l:1}getDataTimestamps(){let e=this._cache.data||[],t,r;if(e.length)return e;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(t=0,r=i.length;t<r;++t)e=e.concat(i[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,r;if(e.length)return e;const i=this.getLabels();for(t=0,r=i.length;t<r;++t)e.push(VA(this,i[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return QP(e.sort(FA))}}Je(iy,"id","time"),Je(iy,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function qp(n,e,t){let r=0,i=n.length-1,s,o,l,d;t?(e>=n[r].pos&&e<=n[i].pos&&({lo:r,hi:i}=Uc(n,"pos",e)),{pos:s,time:l}=n[r],{pos:o,time:d}=n[i]):(e>=n[r].time&&e<=n[i].time&&({lo:r,hi:i}=Uc(n,"time",e)),{time:s,pos:l}=n[r],{time:o,pos:d}=n[i]);const f=o-s;return f?l+(d-l)*(e-s)/f:l}class qA extends iy{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=qp(t,this.min),this._tableRange=qp(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:r}=this,i=[],s=[];let o,l,d,f,m;for(o=0,l=e.length;o<l;++o)f=e[o],f>=t&&f<=r&&i.push(f);if(i.length<2)return[{time:t,pos:0},{time:r,pos:1}];for(o=0,l=i.length;o<l;++o)m=i[o+1],d=i[o-1],f=i[o],Math.round((m+d)/2)!==f&&s.push({time:f,pos:o/(l-1)});return s}_generate(){const e=this.min,t=this.max;let r=super.getDataTimestamps();return(!r.includes(e)||!r.length)&&r.splice(0,0,e),(!r.includes(t)||r.length===1)&&r.push(t),r.sort((i,s)=>i-s)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),r=this.getLabelTimestamps();return t.length&&r.length?e=this.normalize(t.concat(r)):e=t.length?t:r,e=this._cache.all=e,e}getDecimalForValue(e){return(qp(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return qp(this._table,r*this._tableRange+this._minPos,!0)}}Je(qA,"id","timeseries"),Je(qA,"defaults",iy.defaults);const R3="label";function HA(n,e){typeof n=="function"?n(e):n&&(n.current=e)}function qU(n,e){const t=n.options;t&&e&&Object.assign(t,e)}function j3(n,e){n.labels=e}function O3(n,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:R3;const r=[];n.datasets=e.map(i=>{const s=n.datasets.find(o=>o[t]===i[t]);return!s||!i.data||r.includes(s)?{...i}:(r.push(s),Object.assign(s,i),s)})}function HU(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:R3;const t={labels:[],datasets:[]};return j3(t,n.labels),O3(t,n.datasets,e),t}function $U(n,e){const{height:t=150,width:r=300,redraw:i=!1,datasetIdKey:s,type:o,data:l,options:d,plugins:f=[],fallbackContent:m,updateMode:y,...g}=n,_=ee.useRef(null),E=ee.useRef(null),x=()=>{_.current&&(E.current=new xm(_.current,{type:o,data:HU(l,s),options:d&&{...d},plugins:f}),HA(e,E.current))},w=()=>{HA(e,null),E.current&&(E.current.destroy(),E.current=null)};return ee.useEffect(()=>{!i&&E.current&&d&&qU(E.current,d)},[i,d]),ee.useEffect(()=>{!i&&E.current&&j3(E.current.config.data,l.labels)},[i,l.labels]),ee.useEffect(()=>{!i&&E.current&&l.datasets&&O3(E.current.config.data,l.datasets,s)},[i,l.datasets]),ee.useEffect(()=>{E.current&&(i?(w(),setTimeout(x)):E.current.update(y))},[i,d,l.labels,l.datasets,y]),ee.useEffect(()=>{E.current&&(w(),setTimeout(x))},[o]),ee.useEffect(()=>(x(),()=>w()),[]),ts.createElement("canvas",{ref:_,role:"img",height:t,width:r,...g},m)}const WU=ee.forwardRef($U);function Gy(n,e){return xm.register(e),ee.forwardRef((t,r)=>ts.createElement(WU,{...t,ref:r,type:n}))}const GU=Gy("line",hg),M3=Gy("bar",dg),KU=Gy("doughnut",ad),YU=Gy("pie",Tx);xm.register(ny,ry,xf,k3,P3,N3);const ZU=()=>{const n=new Date;return n.setMonth(n.getMonth()-6),n.toISOString().split("T")[0]},$A=()=>new Date().toISOString().split("T")[0],QU=({user:n,userData:e,db:t,showNotification:r})=>{const[i,s]=ee.useState([]),[o,l]=ee.useState("monthly"),[d,f]=ee.useState(ZU()),[m,y]=ee.useState($A()),[g,_]=ee.useState(!0),[E,x]=ee.useState(""),w=ee.useCallback(async()=>{if(!n||!n.uid){x("User data not available."),_(!1);return}_(!0),x("");try{const j=await vm(t,n.uid);if(j.success){const k=j.data.filter(F=>{var O;return((O=F.billDate)==null?void 0:O.toDate)&&typeof F.consumption=="number"&&F.consumption>=0}).sort((F,O)=>F.billDate.toDate()-O.billDate.toDate());s(k)}else throw new Error(j.error||"Failed to fetch billing data.")}catch(j){x(j.message||"An unexpected error occurred fetching data."),r(j.message||"Could not load consumption data.","error")}finally{_(!1)}},[t,n,r]);ee.useEffect(()=>{w()},[w]);const N=((j,k,F,O)=>{const C={},D=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],M=new Date(F).getTime(),$=new Date(O).getTime()+(24*60*60*1e3-1);return j.filter(oe=>{const ie=oe.billDate.toDate().getTime();return ie>=M&&ie<=$}).forEach(oe=>{const ie=oe.billDate.toDate(),X=ie.getFullYear(),Y=ie.getMonth();let B;switch(k){case"yearly":B=`${X}`;break;case"daily":B=`${X}-${String(Y+1).padStart(2,"0")}-${String(ie.getDate()).padStart(2,"0")}`;break;case"monthly":default:B=`${X}-${String(Y+1).padStart(2,"0")}`;break}C[B]=(C[B]||0)+(oe.consumption||0)}),Object.keys(C).sort().reduce((oe,ie)=>{let X=ie;if(k==="monthly"){const[Y,B]=ie.split("-");B&&D[parseInt(B)-1]&&(X=`${D[parseInt(B)-1]} '${Y.slice(-2)}`)}else if(k==="daily"){const[Y,B,Z]=ie.split("-");B&&Z&&(X=`${D[parseInt(B)-1]} ${Z}, '${Y.slice(-2)}`)}return oe[X]=C[ie],oe},{})})(i,o,d,m),P={labels:Object.keys(N),datasets:[{label:"Consumption (m)",data:Object.values(N),backgroundColor:"rgba(59, 130, 246, 0.7)",borderColor:"rgba(37, 99, 235, 1)",borderWidth:1,borderRadius:4,hoverBackgroundColor:"rgba(37, 99, 235, 0.8)"}]},I={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:`Water Consumption Trend (${o.charAt(0).toUpperCase()+o.slice(1)})`,font:{size:16},color:"#374151",padding:{bottom:15}},tooltip:{backgroundColor:"#1F2937",titleColor:"#E5E7EB",bodyColor:"#D1D5DB",borderColor:"#4B5563",borderWidth:1,padding:10,callbacks:{label:function(j){return` Consumption: ${j.parsed.y.toFixed(2)} m`}}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Consumption (m)",color:"#4B5563"},grid:{color:"#E5E7EB"},ticks:{color:"#6B7280"}},x:{title:{display:!0,text:"Period",color:"#4B5563"},grid:{display:!1},ticks:{color:"#6B7280"}}}},R=i.length>0?i.reduce((j,k)=>j+(k.consumption||0),0)/i.length:0,U=j=>{const k=Object.values(j),F=Object.keys(j);if(k.length<2)return"Not enough data for comparison in the selected range.";const O=k[k.length-1],C=k[k.length-2],D=F[k.length-1],M=O-C,$=C!==0?M/C*100:O>0?1/0:0;let G=`Consumption in ${D} was ${O.toFixed(2)} m. `;return $===1/0?G+="This is up from 0 in the previous period.":M>0?(G+=`This is ${$>=.1?"+":""}${$.toFixed(1)}% (${M>=0?"+":""}${M.toFixed(2)} m) compared to the previous period.`,$>25&&(G+=" Consider checking for potential leaks or reviewing usage patterns.")):M<0?G+=`This is a ${Math.abs($).toFixed(1)}% decrease (${M.toFixed(2)} m) compared to the previous period.`:G+="Consumption remained stable compared to the previous period.",G};return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200 gap-4",children:[u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(EP,{size:30,className:"mr-3 text-blue-600"})," Water Consumption Analytics"]}),u.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3 w-full sm:w-auto",children:[u.jsxs("div",{className:"flex items-center gap-2 w-full",children:[u.jsx(n9,{size:18,className:"text-gray-500"}),u.jsxs("select",{value:o,onChange:j=>l(j.target.value),className:"p-2 border rounded-md text-sm bg-gray-50 focus:ring-blue-500 focus:border-blue-500 w-full",disabled:g,children:[u.jsx("option",{value:"daily",children:"Group by Day"}),u.jsx("option",{value:"monthly",children:"Group by Month"}),u.jsx("option",{value:"yearly",children:"Group by Year"})]})]}),u.jsxs("div",{className:"flex items-center gap-2 w-full",children:[u.jsx(vP,{size:18,className:"text-gray-500"}),u.jsx("input",{type:"date",value:d,onChange:j=>f(j.target.value),className:"p-2 border rounded-md text-sm bg-gray-50 focus:ring-blue-500 focus:border-blue-500 w-full",disabled:g,max:m}),u.jsx("span",{className:"text-gray-500",children:"-"}),u.jsx("input",{type:"date",value:m,onChange:j=>y(j.target.value),className:"p-2 border rounded-md text-sm bg-gray-50 focus:ring-blue-500 focus:border-blue-500 w-full",disabled:g,min:d,max:$A()})]})]})]}),g&&u.jsx(gn,{message:"Loading consumption data..."}),E&&!g&&u.jsxs("div",{className:"text-center py-10 bg-red-50 p-4 rounded-lg",children:[u.jsx(Xt,{size:48,className:"mx-auto text-red-400 mb-3"}),u.jsx("p",{className:"text-red-600 text-lg font-semibold",children:"Error Loading Data"}),u.jsx("p",{className:"text-sm text-red-500 mt-1",children:E})]}),!g&&!E&&i.length===0&&u.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner",children:[u.jsx(An,{size:48,className:"mx-auto text-gray-400 mb-4"}),u.jsx("p",{className:"text-gray-600 text-lg",children:"No consumption data found yet."}),u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Analytics will appear after your first few bills."})]}),!g&&!E&&i.length>0&&Object.keys(N).length>0&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"text-sm text-center text-gray-700 bg-blue-50 p-3 rounded-md border border-blue-200 shadow-sm",children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Insight:"})," ",U(N)]}),u.jsxs("p",{className:"mt-1",children:["Average monthly use (all data): ",u.jsxs("strong",{children:[R.toFixed(2)," m"]}),"."]})]}),u.jsx("div",{className:"h-64 md:h-80 lg:h-96 w-full p-4 border rounded-lg bg-gray-50 shadow-inner",children:u.jsx(M3,{options:I,data:P})})]}),!g&&!E&&i.length>0&&Object.keys(N).length===0&&u.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner",children:[u.jsx(An,{size:48,className:"mx-auto text-gray-400 mb-4"}),u.jsx("p",{className:"text-gray-600 text-lg",children:"No data found for the selected date range and grouping."}),u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Try expanding your date range or changing the grouping."})]})]})},ed={Bronze:{points:0,color:"text-yellow-700",iconColor:"#cd7f32",benefits:["Standard Support Access","Basic Portal Features","Regular Service Updates"]},Silver:{points:500,color:"text-gray-600",iconColor:"#c0c0c0",benefits:["Priority Support Queue","Eligibility for 1% Annual Bill Rebate*","Early Access to Water Saving Tips","+ Bronze Benefits"]},Gold:{points:1500,color:"text-amber-500",iconColor:"#ffd700",benefits:["Dedicated Support Agent Option","Eligibility for 2.5% Annual Bill Rebate*","Exclusive Conservation Workshop Invites","+ Silver Benefits"]},Platinum:{points:3e3,color:"text-blue-700",iconColor:"#e5e4e2",benefits:["Highest Priority Support Escalation","Eligibility for 5% Annual Bill Rebate*","Free Annual Water Audit Consultation (On Request)","+ Gold Benefits"]}},XU=({userData:n,systemSettings:e={}})=>{const t=(n==null?void 0:n.rebatePoints)||0,i=(x=>x>=ed.Platinum.points?"Platinum":x>=ed.Gold.points?"Gold":x>=ed.Silver.points?"Silver":"Bronze")(t),s=ed[i],l=(x=>{const w=Object.keys(ed),S=w.indexOf(x);if(S>=0&&S<w.length-1){const N=w[S+1];return{name:N,...ed[N]}}return null})(i),d=l?l.points-t:0,f=l?Math.max(0,Math.min(100,t/l.points*100)):100,{isRebateProgramEnabled:m=!1,pointsPerPeso:y=.01,earlyPaymentBonusPoints:g=10,earlyPaymentDaysThreshold:_=7}=e,E=y*100;return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(Jb,{size:30,className:"mr-3 text-amber-500"})," AGWA Rewards Program"]})}),u.jsxs("section",{className:"mb-8 p-6 bg-gradient-to-r from-blue-600 to-indigo-700 text-white rounded-lg shadow-xl text-center",children:[u.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Your Rewards Status"}),u.jsxs("div",{className:"text-4xl font-bold mb-1 flex items-center justify-center gap-2",children:[u.jsx(od,{size:36,fill:s.iconColor,stroke:s.iconColor}),u.jsxs("span",{style:{color:s.iconColor},children:[i," Tier"]})]}),u.jsxs("p",{className:"text-2xl font-semibold text-blue-100 mb-3",children:[t.toLocaleString()," Points"]}),l&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"w-full max-w-md mx-auto bg-blue-400 rounded-full h-3 mb-1 overflow-hidden shadow-inner",children:u.jsx("div",{className:"bg-yellow-400 h-3 rounded-full transition-all duration-500 ease-out",style:{width:`${f}%`}})}),u.jsx("p",{className:"text-xs text-blue-100",children:d>0?`${d.toLocaleString()} points needed for ${l.name} tier (${l.points.toLocaleString()} total).`:`You've reached the ${l.name} tier!`})]}),i==="Platinum"&&u.jsx("p",{className:"text-sm text-yellow-300 font-semibold mt-2",children:" You are a Platinum member! Enjoy the highest rewards."})]}),u.jsxs("section",{className:"mb-8",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:["Benefits for ",i," Tier"]}),u.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50 shadow-inner",children:[u.jsx("ul",{className:"list-disc list-inside space-y-1.5 text-sm text-gray-700 pl-4",children:s.benefits.map((x,w)=>u.jsx("li",{children:x.replace("*","")},w))}),u.jsx("p",{className:"text-xs text-gray-500 mt-3",children:"*Annual Bill Rebate eligibility requires 12 consecutive months of good standing within the tier. Rebate applied as bill credit. See terms."})]})]}),u.jsxs("section",{className:"mb-8 p-4 bg-blue-50 border border-blue-200 rounded-lg shadow-sm",children:[u.jsxs("h3",{className:"text-lg font-semibold text-blue-800 mb-3 flex items-center",children:[u.jsx(Zb,{size:20,className:"mr-2"})," How to Earn Points (Mechanics)"]}),m?u.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[u.jsx("p",{children:"Earning points is simple! Points are awarded automatically for diligent payments:"}),u.jsxs("ul",{className:"list-none space-y-2 pl-2",children:[u.jsxs("li",{className:"flex items-start",children:[u.jsx(od,{size:16,className:"text-yellow-500 mr-2 mt-0.5 flex-shrink-0"}),u.jsxs("div",{children:[u.jsx("strong",{children:"Pay Your Bill:"})," Earn ",u.jsxs("strong",{children:[E.toLocaleString()," point",E!==1?"s":""]})," for every ",u.jsx("strong",{children:"100.00"})," paid on your water bill."]})]}),u.jsxs("li",{className:"flex items-start",children:[u.jsx(od,{size:16,className:"text-yellow-500 mr-2 mt-0.5 flex-shrink-0"}),u.jsxs("div",{children:[u.jsx("strong",{children:"Pay Early:"})," Earn a ",u.jsxs("strong",{children:[g," point bonus"]})," when you pay your bill in full at least ",u.jsxs("strong",{children:[_," day",_!==1?"s":""]})," before your due date."]})]}),u.jsxs("li",{className:"flex items-start",children:[u.jsx(od,{size:16,className:"text-gray-400 mr-2 mt-0.5 flex-shrink-0"}),u.jsxs("div",{children:[u.jsx("strong",{children:"Stay Tuned:"})," Look out for special promotions and events to earn even more bonus points!"]})]})]}),u.jsx("p",{className:"text-xs text-gray-500",children:"Points are automatically credited to your account after your payment is successfully posted (usually within 24-48 hours)."})]}):u.jsx("p",{className:"text-sm text-gray-700",children:"The AGWA Rewards Program is not currently active."})]}),u.jsxs("section",{children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-3 flex items-center",children:[u.jsx(Ud,{size:20,className:"mr-2 text-gray-500"})," Program Terms & Conditions"]}),u.jsxs("details",{className:"text-xs text-gray-500 space-y-2 border p-3 rounded bg-gray-50 cursor-pointer group hover:bg-gray-100 transition-colors",children:[u.jsxs("summary",{className:"font-medium text-gray-700 group-hover:text-blue-600 list-none flex justify-between items-center",children:["Click to view Terms & Conditions",u.jsx("span",{className:"transition-transform duration-200 group-open:rotate-180",children:""})]}),u.jsxs("div",{className:"mt-2 space-y-1.5 max-h-0 overflow-hidden group-open:max-h-[500px] transition-all duration-500 ease-in-out pt-2 border-t",children:[u.jsxs("p",{children:[u.jsx("strong",{children:"1. Eligibility:"}),' All AGWA Water Services, Inc. customers with an active residential or commercial account in good standing are eligible to participate in the AGWA Rewards Program ("Program").']}),u.jsxs("p",{children:[u.jsx("strong",{children:"2. Earning Points:"}),' Points are earned based on (a) the total amount paid for water bills and (b) bonuses for early payments, as specified in the "How to Earn Points" section. Earning rates are determined by AGWA and may be subject to change based on system settings.']}),u.jsxs("p",{children:[u.jsx("strong",{children:"3. Point Crediting:"})," Points will be credited to the customer's account after a payment is successfully processed and posted. This may take up to 48 hours."]}),u.jsxs("p",{children:[u.jsx("strong",{children:"4. Tiers and Benefits:"})," Tier status (Bronze, Silver, Gold, Platinum) is determined by the total accumulated points. Benefits are associated with each tier and are non-transferable. AGWA reserves the right to modify, add, or remove benefits at any time."]}),u.jsxs("p",{children:[u.jsx("strong",{children:"5. Annual Bill Rebate:"}),' Rebates mentioned in tier benefits (e.g., "Eligibility for 1% Annual Bill Rebate") are not automatic. To qualify, a customer must maintain their tier status (Silver or higher) and remain in good standing (no service disconnections due to non-payment) for 12 consecutive months. The rebate is calculated on the total basic charges paid within that 12-month period and will be applied as a credit to a future bill, not as a cash payout.']}),u.jsxs("p",{children:[u.jsx("strong",{children:"6. Point Expiration:"})," Points do not expire as long as the customer's account remains active. If an account is closed or becomes inactive for a period of 24 consecutive months, all accumulated points may be forfeited."]}),u.jsxs("p",{children:[u.jsx("strong",{children:"7. No Cash Value:"})," Points have no cash value, are non-transferable, and cannot be sold, bartered, or redeemed for cash."]}),u.jsxs("p",{children:[u.jsx("strong",{children:"8. Program Modification/Termination:"})," AGWA Water Services, Inc. reserves the right to modify, suspend, or terminate the AGWA Rewards Program, its rules, tiers, benefits, or earning mechanics at any time, with or without prior notice."]}),u.jsxs("p",{children:[u.jsx("strong",{children:"9. Account Status:"})," Customers must be in good standing to enjoy tier benefits. Accounts that are suspended or disconnected may have their benefits temporarily revoked."]}),u.jsxs("p",{children:[u.jsx("strong",{children:"10. Disputes:"})," Any discrepancies in point calculation must be reported to AGWA customer service within 60 days of the payment date. AGWA's decision on point disputes is final."]}),u.jsxs("p",{children:[u.jsx("strong",{children:"11. Acceptance of Terms:"})," Continued participation in the Program, including earning and redeeming benefits, constitutes acceptance of these Terms & Conditions."]})]})]})]})]})},D3={Poblacion:["Capt. C. Nazareno","Gombalza","Kanluran","Ibayo Silangan","Humbac","Balsahan"],"Baybayin Bayan-Hilaga":["Timalan Balsahan","Timalan Concepcion","Munting Mapino","Ibayo Estacion","Latoria","Bucana Sasahan"],"Baybayin Timog":["Bagong Kalsada","Bucana Malaki","Bancaan","Mabulo","Labac","Sapa"],"Ilayang Hilaga":["Calubcob","Halang","Palangue Central","Palangue 2&3","Sabang","Makina"],"Ilayang Timog":["Muzon","Malainen Bago","Malainen Luma","Molino","San Roque","Santulan"]},Ky=()=>Object.keys(D3),Pd=n=>D3[n]||[],Js="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",Vh="bg-gray-200 cursor-not-allowed text-gray-500",JU=({user:n,userData:e,setUserData:t,auth:r,db:i,showNotification:s})=>{var C;const[o,l]=ee.useState(!1),[d,f]=ee.useState({}),[m,y]=ee.useState({district:"",barangay:"",street:"",landmark:""}),[g,_]=ee.useState(!1),[E,x]=ee.useState(""),[w,S]=ee.useState([]),[N,P]=ee.useState([]),I=(e==null?void 0:e.role)==="customer";ee.useEffect(()=>{if(S(Ky()),e)if(f({...e}),I&&e.serviceAddress&&typeof e.serviceAddress=="object"){const D=e.serviceAddress.district||"";y(e.serviceAddress),D&&P(Pd(D))}else y({district:"",barangay:"",street:"",landmark:""})},[e,I]);const R=D=>!D||typeof D!="object"?"N/A":[D.street,D.barangay,D.district,"Naic, Cavite"].filter($=>$&&$.trim()).join(", "),U=D=>{const{name:M,value:$}=D.target;y(G=>{const re={...G,[M]:$};return M==="district"&&(re.barangay="",P(Pd($))),re})},j=D=>{const{name:M,value:$}=D.target;f(G=>({...G,[M]:$}))},k=async D=>{var G,re;if(D.preventDefault(),x(""),!((G=d.displayName)!=null&&G.trim())){x("Display Name cannot be empty.");return}_(!0);const M={displayName:d.displayName.trim(),photoURL:((re=d.photoURL)==null?void 0:re.trim())||"",serviceAddress:I?m:e.serviceAddress||{}},$=await Zh(i,n.uid,M);if(!$.success){s($.error||"Failed to update profile in database.","error"),_(!1);return}t(oe=>({...oe,...M})),s("Profile updated successfully!","success"),l(!1),_(!1)},F=()=>{l(!1),x(""),I&&e.serviceAddress&&typeof e.serviceAddress=="object"&&y(e.serviceAddress)};if(!e)return u.jsx(gn,{message:"Loading profile..."});const O=d.photoURL||t8(d.displayName);return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[u.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center",children:[u.jsx(AP,{size:30,className:"mr-3 text-blue-600"})," My Profile"]}),!o&&u.jsxs("button",{onClick:()=>l(!0),className:"flex items-center bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg",children:[u.jsx(n2,{size:18,className:"mr-2"})," Edit Profile"]})]}),E&&u.jsxs("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg text-sm flex items-center",children:[u.jsx(Xt,{size:20,className:"mr-2"})," ",E]}),u.jsxs("form",{onSubmit:k,className:"space-y-5",children:[u.jsxs("div",{className:"text-center space-y-3",children:[u.jsx("img",{src:O,alt:"Profile",className:"h-28 w-28 rounded-full object-cover border-4 border-blue-200 shadow-md bg-gray-200 mx-auto"}),o&&u.jsx("input",{type:"url",name:"photoURL",value:d.photoURL||"",onChange:j,className:`${Js} max-w-sm mx-auto text-center`,placeholder:"Image URL"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"text-xs font-medium text-gray-600 mb-1 flex items-center",children:[u.jsx(ks,{size:14,className:"mr-1.5"}),"Full Name"]}),o?u.jsx("input",{type:"text",name:"displayName",value:d.displayName||"",onChange:j,className:Js}):u.jsx("p",{className:`${Js} ${Vh}`,children:d.displayName})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"text-xs font-medium text-gray-600 mb-1 flex items-center",children:[u.jsx(Sa,{size:14,className:"mr-1.5"}),"Email Address"]}),u.jsx("p",{className:`${Js} ${Vh}`,children:d.email})]}),I&&u.jsxs("div",{children:[u.jsxs("label",{className:"text-xs font-medium text-gray-600 mb-1 flex items-center",children:[u.jsx(Cs,{size:14,className:"mr-1.5"}),"Account Number"]}),u.jsx("p",{className:`${Js} ${Vh}`,children:d.accountNumber})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"text-xs font-medium text-gray-600 mb-1 flex items-center",children:[u.jsx(mx,{size:14,className:"mr-1.5"}),"User Role"]}),u.jsx("p",{className:`${Js} ${Vh} capitalize`,children:(C=d.role)==null?void 0:C.replace("_"," ")})]})]}),I&&u.jsxs("div",{className:"pt-4 mt-4 border-t",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Service Address"}),o?u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1",children:"District"}),u.jsxs("select",{name:"district",value:m.district,onChange:U,className:Js,children:[u.jsx("option",{value:"",children:"Select District"}),w.map(D=>u.jsx("option",{value:D,children:D},D))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1",children:"Barangay"}),u.jsxs("select",{name:"barangay",value:m.barangay,onChange:U,className:Js,disabled:!m.district,children:[u.jsx("option",{value:"",children:"Select Barangay"}),N.map(D=>u.jsx("option",{value:D,children:D},D))]})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1",children:"Street Name, Building, House No."}),u.jsx("input",{type:"text",name:"street",value:m.street,onChange:U,className:Js})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1",children:"Landmark"}),u.jsx("input",{type:"text",name:"landmark",value:m.landmark,onChange:U,className:Js})]})]}):u.jsx("p",{className:`${Js} ${Vh}`,children:R(d.serviceAddress)})]}),o&&u.jsxs("div",{className:"flex justify-end space-x-4 pt-5",children:[u.jsx("button",{type:"button",onClick:F,className:"px-6 py-2.5 text-sm font-medium bg-gray-100 rounded-lg",disabled:g,children:"Cancel"}),u.jsxs("button",{type:"submit",className:"px-6 py-2.5 text-sm font-medium text-white bg-green-600 rounded-lg flex items-center",disabled:g,children:[g?u.jsx(St,{size:18,className:"animate-spin mr-2"}):u.jsx(Oa,{size:18,className:"mr-2"}),g?"Saving...":"Save Changes"]})]})]})]})};function eq(n,e,t){const[r,i]=ee.useState(n),[s,o]=ee.useState({}),[l,d]=ee.useState(!1),[f,m]=ee.useState(!1),y=ee.useCallback(x=>{const{name:w,value:S,type:N,checked:P}=x.target;i(I=>({...I,[w]:N==="checkbox"?P:S})),s[w]&&o(I=>({...I,[w]:void 0}))},[s]),g=ee.useCallback((x,w)=>{i(S=>({...S,[x]:w})),s[x]&&o(S=>({...S,[x]:void 0}))},[s]),_=ee.useCallback(()=>{i(n),o({}),d(!1),m(!1)},[n]);return{values:r,setValues:i,setFieldValue:g,errors:s,setErrors:o,isLoading:l,handleChange:y,handleSubmit:async x=>{if(x&&x.preventDefault(),f)return;m(!0),d(!0),o({});let w={};if(e&&(w=e(r),o(w)),Object.keys(w).length===0)try{t&&await t(r,_)}catch(S){console.error("Form submission error:",S),o(N=>({...N,submit:S.message||"An unexpected error occurred during submission."}))}d(!1),m(!1)},resetForm:_}}const sy=({children:n,text:e,position:t="top",className:r="",delay:i=100})=>{const[s,o]=ee.useState(!1),[l,d]=ee.useState(null),f=()=>{const _=setTimeout(()=>{o(!0)},i);d(_)},m=()=>{l&&(clearTimeout(l),d(null)),o(!1)},y={top:"bottom-full left-1/2 -translate-x-1/2 mb-2",bottom:"top-full left-1/2 -translate-x-1/2 mt-2",left:"right-full top-1/2 -translate-y-1/2 mr-2",right:"left-full top-1/2 -translate-y-1/2 ml-2"},g={top:"absolute left-1/2 -translate-x-1/2 top-full h-0 w-0 border-x-4 border-x-transparent border-t-4 border-t-gray-800",bottom:"absolute left-1/2 -translate-x-1/2 bottom-full h-0 w-0 border-x-4 border-x-transparent border-b-4 border-b-gray-800",left:"absolute top-1/2 -translate-y-1/2 left-full h-0 w-0 border-y-4 border-y-transparent border-l-4 border-l-gray-800",right:"absolute top-1/2 -translate-y-1/2 right-full h-0 w-0 border-y-4 border-y-transparent border-r-4 border-r-gray-800"};return e?u.jsxs("div",{className:"relative inline-flex",onMouseEnter:f,onMouseLeave:m,onFocus:f,onBlur:m,tabIndex:0,children:[n,s&&u.jsxs("div",{role:"tooltip",className:`absolute z-50 whitespace-nowrap px-3 py-1.5 text-xs font-medium text-white bg-gray-800 rounded-md shadow-lg transition-opacity duration-150 ease-in-out opacity-100 ${y[t]} ${r}`,children:[e,u.jsx("div",{className:g[t]})]})]}):u.jsx(u.Fragment,{children:n})},Yv="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",Zv="flex items-center justify-center px-5 py-2.5 rounded-lg font-semibold transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95 text-sm",tq=n=>!n||typeof n!="object"?"":[n.street,n.barangay,n.district].filter(t=>t&&t.trim()).join(", "),nq=({user:n,userData:e,db:t,auth:r,showNotification:i})=>{const s=()=>e!=null&&e.serviceAddress&&typeof e.serviceAddress=="object"?tq(e.serviceAddress):(e==null?void 0:e.accountNumber)||"",o={issueType:"",description:"",issueAddress:s()},[l,d]=ee.useState(!1),[f,m]=ee.useState(!1),y=C=>{const D={};return C.issueType||(D.issueType="Please select an issue type."),C.description.trim()||(D.description="Description cannot be empty."),C.issueAddress.trim()||(D.issueAddress="Please specify the location of the issue."),D},g=async(C,D)=>{const M={...C,userId:n.uid,userName:e.displayName,userEmail:e.email,accountNumber:e.accountNumber||"N/A"},$=await N8(t,M);$.success?(i("Support ticket submitted successfully!","success"),D()):i($.error||"Failed to submit ticket.","error")},{values:_,errors:E,isLoading:x,handleChange:w,handleSubmit:S,setFieldValue:N}=eq(o,y,g),P=["Billing Discrepancy or Inquiry","Water Leak (Before Meter)","Water Leak (After Meter - Your Property)","No Water Supply / Low Pressure","Water Quality Issue (Color, Odor, Taste)","Meter Problem (Damaged, Stuck, Inaccurate)","Online Portal Issue / Account Access","Request for Service (Disconnection/Reconnection)","Chatbot Assistance Follow-up","Other Concern"],I=["Unable to Access Meter","Damaged or Tampered Meter Found","Suspected Illegal Connection","Route Data Inaccuracy","Safety Concern on Route","Device or App Problem","Customer Inquiry on Field","Other Field Report"],R=["Payment Posting Issue","Customer Account Inquiry","Bill Printing Problem","System Access/Login Issue","Other Office Concern"],U=["User Role/Permission Change Request","Data Correction Request","System Bug Report","Feature Request","Urgent System Alert"],[j,k]=ee.useState(P);ee.useEffect(()=>{switch(e==null?void 0:e.role){case"meter_reader":k(I);break;case"clerk_cashier":k(R);break;case"admin":k(U);break;default:k(P)}N("issueType","")},[e.role,N]),ee.useEffect(()=>{N("issueAddress",s())},[e,N]);const F=async()=>{if(!_.description.trim()){i("Please describe your issue first before using the AI categorizer.","warning");return}d(!0);try{const M=[{role:"user",content:`Based on the following user complaint, which of these categories does it best fit into? Categories: [${j.join(", ")}]. Respond with only the exact category name from the list and nothing else. Complaint: "${_.description}"`}];let $=await Ql(M);$=$.replace(/["'.*]/g,"").trim(),j.includes($)?(N("issueType",$),i(`AI suggested category: "${$}"`,"success")):i("AI could not determine a matching category. Please select one manually.","info")}catch(C){const D=(C==null?void 0:C.message)||"AI categorization failed.";i(D,"error")}finally{d(!1)}},O=async()=>{if(!_.description.trim()){i("Please provide some keywords or a brief description for the AI to expand upon.","warning");return}m(!0);try{const D=[{role:"user",content:`You are helping a user report an issue to AGWA Water Services. Elaborate on the following user-provided details to create a clear, detailed, and formal issue description. Be polite and include any relevant questions the user might need to answer. Do not add any extra commentary, just provide the refined description.

User's input: "${_.description}"`}],M=await Ql(D);N("description",M),i("AI has helped draft your issue description!","success")}catch(C){const D=(C==null?void 0:C.message)||"AI assistance failed.";i(D,"error")}finally{m(!1)}};return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(Xt,{size:30,className:"mr-3 text-orange-500"})," Report an Issue or Concern"]})}),u.jsxs("form",{onSubmit:S,className:"space-y-6",children:[u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"issueType",className:"text-sm font-medium text-gray-700 mb-1 flex items-center",children:[u.jsx(xP,{size:16,className:"mr-1.5 text-gray-500"})," Issue Type / Category *"]}),u.jsxs("div",{className:"flex gap-2 items-center",children:[u.jsxs("select",{id:"issueType",name:"issueType",value:_.issueType,onChange:w,className:`${Yv} ${E.issueType?"border-red-500":""}`,children:[u.jsx("option",{value:"",disabled:!0,children:"Select the type of issue..."}),j.map(C=>u.jsx("option",{value:C,children:C},C))]}),u.jsx(sy,{text:"Let AI suggest a category based on your description below.",children:u.jsx("button",{type:"button",onClick:F,className:`${Zv} w-auto bg-blue-100 text-blue-700 hover:bg-blue-200 focus:ring-blue-300 px-3`,disabled:l||x,children:l?u.jsx(St,{size:16,className:"animate-spin"}):u.jsx(Rs,{size:16})})})]}),E.issueType&&u.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.issueType})]}),u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"issueAddress",className:"text-sm font-medium text-gray-700 mb-1 flex items-center",children:[u.jsx(Oo,{size:16,className:"mr-1.5 text-gray-500"})," Address / Location of Issue *"]}),u.jsx("input",{type:"text",id:"issueAddress",name:"issueAddress",value:_.issueAddress,onChange:w,className:`${Yv} ${E.issueAddress?"border-red-500":""}`,placeholder:"E.g., Your service address, specific street, or account number if general"}),E.issueAddress&&u.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.issueAddress})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex justify-between items-center mb-1",children:[u.jsxs("label",{htmlFor:"description",className:"text-sm font-medium text-gray-700 flex items-center",children:[u.jsx(_9,{size:16,className:"mr-1.5 text-gray-500"})," Detailed Description of Issue *"]}),u.jsx(sy,{text:_.description.trim()?"Use AI to help draft or refine your description.":"Write a description first to enable AI Assist",children:u.jsxs("button",{type:"button",onClick:O,className:`${Zv} text-xs bg-purple-100 text-purple-700 hover:bg-purple-200 focus:ring-purple-300 py-1.5 px-3`,disabled:f||x||!_.description.trim(),children:[f?u.jsx(St,{size:16,className:"animate-spin mr-1.5"}):u.jsx(Rs,{size:16,className:"mr-1.5"}),f?"Drafting...":"AI Assist"]})})]}),u.jsx("textarea",{id:"description",name:"description",value:_.description,onChange:w,rows:"6",className:`${Yv} ${E.description?"border-red-500":""}`,placeholder:"Please provide as much detail as possible: What is the problem? When did it start? Any specific error messages or observations?"}),E.description&&u.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.description})]}),u.jsx("div",{className:"pt-3",children:u.jsxs("button",{type:"submit",className:`${Zv} w-full bg-orange-500 hover:bg-orange-600 text-white focus:ring-orange-400`,disabled:x||f||l,children:[x?u.jsx(St,{size:20,className:"animate-spin mr-2"}):u.jsx(By,{size:18,className:"mr-2"}),x?"Submitting Report...":"Submit Issue Report"]})})]})]})},rq=[{q:"How do I register for an online account?",a:"Click 'Sign Up' on the login page. Provide your full name, AGWA account number (e.g., RES-12345), a valid email address, and create a password of at least 6 characters."},{q:"I forgot my password. How can I reset it?",a:"On the login page, click the 'Forgot Password?' link. Enter the email address associated with your AGWA account, and we'll send you a link to reset your password."},{q:"How can I pay my water bill through this portal?",a:"Once logged in, navigate to 'My Bills'. Select an unpaid bill, click 'Pay Now', and choose a simulated payment option (e.g., GCash, Maya, Bank Transfer, Credit Card). Please note that payments in this portal are for demonstration purposes only. For actual payments, please use AGWA's officially accredited payment channels."},{q:"How is my water consumption calculated?",a:"Your consumption is the difference between your current meter reading and your previous meter reading, measured in cubic meters (m). This consumption is then used with the tariff rates applicable to your service type to calculate your water bill charges."},{q:"What are the different charges on my bill?",a:"Your bill typically includes a Basic Charge (based on consumption and service type), Foreign Currency Differential Adjustment (FCDA), Environmental Charge (EC), Sewerage Charge (SC, if applicable), Maintenance Service Charge (based on your meter size), Government Taxes, and Value Added Tax (VAT). You can use the ' Explain Bill' feature in the 'My Bills' section for a personalized breakdown of a specific bill."},{q:"How can I view my past bills and payment history?",a:"Navigate to the 'My Bills' section after logging in. You'll find a history of your past bills, their status (Paid/Unpaid), and payment details if paid via the portal (simulated). You can also view a detailed invoice for each bill."},{q:"What should I do if I suspect a water leak at my premises?",a:"If it's safe to do so, try to identify the source of the leak and turn off your main water shut-off valve (usually located near your meter). Immediately report the suspected leak to AGWA via the 'Report Issue' section in the portal or by calling our 24/7 emergency hotline: 1627-AGWA (1627-2492)."},{q:"My water supply is interrupted. What should I do?",a:"First, check for any service advisories on our official AGWA website or social media channels. If there are no posted advisories for your area, please report the interruption via the 'Report Issue' section in the portal or call our customer service hotline with your account details."},{q:"Can I change my registered email address or other profile details?",a:"You can update your Display Name, Photo URL, Service Address, and Meter Size in the 'My Profile' section. For changes to critical information like your registered email address (if it's your primary login ID), account number, or assigned role, please contact AGWA customer support for assistance and verification."},{q:"What is FCDA (Foreign Currency Differential Adjustment)?",a:"FCDA is a tariff mechanism approved by regulatory bodies that allows water utilities like AGWA to recover or pass on to customers the gains or losses arising from fluctuations in foreign exchange rates. These fluctuations affect the cost of foreign currency-denominated loans and expenses used for service improvements and operational needs."},{q:"Why is there an Environmental Charge (EC) on my bill?",a:"The Environmental Charge (EC) is a fee collected to fund projects and initiatives related to wastewater treatment, septage management, and other environmental protection programs. This helps ensure that water resources are used sustainably and that wastewater is treated properly before being discharged back into the environment."},{q:"What if I think my water meter is malfunctioning or inaccurate?",a:"If you suspect your water meter is not recording your consumption accurately, please report it immediately. You can do this through the 'Report Issue' section of the portal (select 'Meter Problem') or by contacting AGWA customer service. We will arrange for an inspection and testing of your meter."},{q:"How often are water meters read?",a:"Water meters are typically read on a monthly cycle. The specific reading schedule can vary by area. Your billing statement will indicate the period covered by the meter reading (e.g., 'Billing Period: 01 Jan 2025 to 31 Jan 2025')."},{q:"Are there discounts for senior citizens or Persons with Disabilities (PWDs)?",a:"Yes, AGWA Water Services adheres to Republic Act No. 9994 (Expanded Senior Citizens Act) and Republic Act No. 10754 (Act Expanding the Benefits and Privileges of Persons with Disability). Qualified senior citizens and PWDs are entitled to a discount on their water consumption, subject to certain conditions (e.g., the account must be registered in their name, consumption limits). Please update your details in 'My Profile' or contact customer service with the necessary identification to apply for these discounts."},{q:"How do I update my contact number or service address on file with AGWA?",a:"You can update your Service Address directly in the 'My Profile' section of this portal. For changes to your primary contact number, especially if it's used for OTPs or critical alerts, it's best to contact AGWA customer service or visit one of our business offices to ensure your records are accurately updated and verified."},{q:"What are the accepted payment methods for my water bill?",a:"This portal simulates payments via various methods for demonstration. For actual payments, AGWA accepts payments through a wide range of accredited channels, including: AGWA Business Offices, Bayad Centers, 7-Eleven, SM Bills Payment, selected banks (over-the-counter and online banking), and mobile wallets like GCash and Maya. Please refer to the official AGWA website or your bill statement for a complete list of authorized payment partners."},{q:"How can I get an official receipt (OR) after making a payment?",a:"For payments made through this portal (which are simulated), a transaction reference is provided. For actual payments made via AGWA's accredited channels, an official receipt or proof of payment will be issued by that specific channel (e.g., a bank validation slip, a payment center receipt, a digital receipt from an e-wallet). AGWA is continuously working on enhancing digital services, including the future provision of consolidated digital ORs through the portal."},{q:"What is a 'meter deposit' for new service connections?",a:"A meter deposit is a one-time charge collected from customers upon application for a new water service connection. This deposit serves as a security against potential unpaid bills or damages to the water meter. It is refundable, with interest (if applicable by law), upon termination of the service contract, provided all outstanding obligations to AGWA have been settled."},{q:"How do I report a damaged, leaking, or stolen water meter?",a:"Report any instance of a damaged, leaking, or stolen water meter to AGWA immediately. You can use the 'Report Issue' section in this portal (select 'Meter Problem') or call our emergency hotline. Tampering with or unauthorized removal of water meters is illegal and may result in penalties."},{q:"Can I request for a temporary disconnection of my water service if I'll be away for an extended period?",a:"Yes, you can request a temporary or voluntary disconnection of your water service. To do this, please visit any AGWA business office to file your formal request. There might be applicable fees for the disconnection and subsequent reconnection process. Please inquire about the specific requirements and charges."}],iq=()=>u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(E9,{size:30,className:"mr-3 text-blue-600"}),"Frequently Asked Questions"]})}),u.jsx("div",{className:"space-y-4",children:rq.map((n,e)=>u.jsxs("details",{className:"group bg-gray-50 hover:bg-gray-100 p-4 rounded-lg shadow-sm hover:shadow-md transition-all duration-200 ease-in-out",children:[u.jsxs("summary",{className:"flex justify-between items-center font-medium cursor-pointer list-none text-gray-900 text-sm sm:text-base",children:[u.jsx("span",{className:"group-open:text-blue-700 group-open:font-semibold",children:n.q}),u.jsx("span",{className:"transition-transform duration-300 transform group-open:rotate-180 text-blue-600 group-open:text-blue-700",children:u.jsx(Yb,{size:24})})]}),u.jsx("div",{className:"text-gray-600 mt-3 prose prose-sm max-w-none grid grid-rows-[0fr] group-open:grid-rows-[1fr] transition-all duration-500 ease-in-out",children:u.jsx("div",{className:"overflow-hidden",children:u.jsx("p",{className:"pb-2",children:n.a})})})]},e))})]}),sq=()=>{const n=[{letter:"C",word:"Customer-Centricity",desc:"Our customers are at the heart of every decision and action we take, ensuring their needs are met with utmost priority and care.",icon:ks},{letter:"R",word:"Responsibility",desc:"We hold ourselves accountable for our impact on the communities we serve and the environment, operating with integrity and a commitment to social good.",icon:Ud},{letter:"E",word:"Excellence",desc:"We relentlessly pursue the highest standards in all aspects of our service, operations, and innovation, striving for continuous improvement.",icon:Rs},{letter:"S",word:"Sustainability",desc:"We are dedicated to the long-term health and viability of our precious water resources and the planet, implementing eco-friendly practices.",icon:Yl},{letter:"T",word:"Teamwork & Integrity",desc:"We foster a collaborative environment built on mutual respect, honesty, and transparency, working together to achieve our common goals.",icon:xa}],e=[{title:"Deliver Quality",description:"Consistently provide safe, reliable, and affordable water and wastewater services that exceed customer expectations and meet stringent regulatory standards."},{title:"Innovate & Adapt",description:"Embrace technological advancements and innovative practices to enhance operational efficiency, service delivery, and resource management in an ever-changing world."},{title:"Customer First",description:"Cultivate a culture of exceptional customer care through responsive, transparent, fair, and easily accessible service channels, including this advanced digital portal."},{title:"Protect Resources",description:"Champion water conservation, actively work to reduce non-revenue water, and promote environmental protection through sustainable practices and robust community engagement."},{title:"Empower People",description:"Invest in the growth, professional development, and overall well-being of our employees, fostering a skilled, motivated, diverse, and safety-conscious workforce."},{title:"Community Partnership",description:"Actively contribute to the socio-economic development, health, and resilience of the communities we serve through targeted corporate social responsibility programs and collaborative partnerships."}];return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn leading-relaxed text-gray-700",children:[u.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(An,{size:30,className:"mr-3 text-blue-600"}),"About AGWA Water Services, Inc."]})}),u.jsxs("section",{className:"mb-8",children:[u.jsxs("h3",{className:"text-xl font-semibold text-blue-700 mb-2 flex items-center",children:[u.jsx(yP,{size:22,className:"mr-2.5 text-blue-600/80"})," Our Genesis & Enduring Commitment"]}),u.jsx("p",{children:"AGWA Water Services, Inc. was established in 2005 with a singular, profound vision: to ensure every Filipino has access to clean, safe, and sustainable water. Recognizing water as the cornerstone of life, health, and economic progress, AGWA embarked on a mission to become a leading force in the Philippine water utility sector. From humble beginnings, we have grown through unwavering dedication, strategic investments in infrastructure and technology, and a deep-rooted commitment to the communities we are privileged to serve. Our journey has been one of continuous learning, adaptation, and an ever-stronger resolve to meet the evolving water needs of a dynamic nation."})]}),u.jsxs("section",{className:"mb-8",children:[u.jsxs("h3",{className:"text-xl font-semibold text-blue-700 mb-2 flex items-center",children:[u.jsx(Rs,{size:22,className:"mr-2.5 text-blue-600/80"})," Operational Excellence & Innovation"]}),u.jsx("p",{children:"At the heart of AGWA lies a relentless pursuit of excellence. We employ state-of-the-art water sourcing techniques, advanced multi-stage treatment processes, and smart distribution networks, all managed by a team of highly skilled engineers, certified technicians, and dedicated customer service professionals. Our operations strictly adhere to, and often exceed, national and international quality standards (PNSDW, WHO guidelines), ensuring that the water reaching your taps is not just potable but of the highest purity and reliability. We continuously invest in research and development to innovate and improve our services, from leak detection technologies and pressure management systems to digital customer interfaces and data-driven resource planning."})]}),u.jsxs("section",{className:"mb-8",children:[u.jsxs("h3",{className:"text-xl font-semibold text-blue-700 mb-2 flex items-center",children:[u.jsx(Yl,{size:22,className:"mr-2.5 text-blue-600/80"})," Sustainability and Environmental Stewardship: Our Pledge"]}),u.jsx("p",{children:"AGWA is profoundly aware of its responsibility as a steward of one of Earth's most precious resources. Sustainability is not just a buzzword for us; it's integrated into every facet of our operations. This includes responsible water abstraction from diverse sources, active participation in watershed protection and reforestation programs, and the implementation of advanced wastewater treatment and water recycling initiatives to minimize our environmental footprint. We actively promote water conservation education among our consumers and invest in projects that enhance climate resilience and mitigate environmental impact, ensuring that future generations can also enjoy the gift of clean water."})]}),u.jsxs("div",{className:"my-10 p-6 bg-gradient-to-r from-blue-600 to-indigo-700 text-white rounded-xl shadow-xl text-center",children:[u.jsx(Gl,{size:36,className:"mx-auto mb-3 text-blue-200"}),u.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Our Vision"}),u.jsx("p",{className:"italic text-lg text-blue-100 leading-relaxed max-w-3xl mx-auto",children:`"To be the Philippines' most trusted and innovative water solutions provider, empowering communities with sustainable access to life-enhancing water services and championing environmental stewardship for a resilient future."`})]}),u.jsxs("div",{className:"my-10",children:[u.jsxs("h3",{className:"text-2xl font-bold text-blue-700 mb-6 text-center flex items-center justify-center",children:[u.jsx(N9,{size:28,className:"mr-3 text-blue-600"})," Our Mission"]}),u.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-5",children:e.map((t,r)=>u.jsxs("div",{className:"bg-blue-50 p-5 rounded-lg shadow-md hover:shadow-lg transition-shadow h-full flex flex-col",children:[u.jsx("strong",{className:"text-blue-700 block text-md mb-1.5",children:t.title}),u.jsx("p",{className:"text-sm text-gray-600 leading-normal flex-grow",children:t.description})]},r))})]}),u.jsxs("div",{className:"my-12 pt-8 border-t border-gray-200",children:[u.jsx("h3",{className:"text-2xl font-bold text-blue-700 mb-8 text-center",children:"Our Core Values: The AGWA C.R.E.S.T."}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-5",children:n.map(t=>{const r=t.icon;return u.jsxs("div",{className:"p-5 border border-blue-100 rounded-xl bg-white shadow-lg hover:shadow-2xl transition-all duration-300 flex flex-col items-center text-center h-full hover:border-blue-300 transform hover:-translate-y-1",children:[u.jsx("div",{className:"p-3 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 text-white mb-3 shadow-md",children:u.jsx(r,{className:"",size:32})}),u.jsx("p",{className:"text-4xl font-bold text-blue-600 mb-1",children:t.letter}),u.jsx("strong",{className:"text-blue-700 block text-md mb-1.5",children:t.word}),u.jsx("p",{className:"text-xs text-gray-600 mt-1 leading-snug flex-grow",children:t.desc})]},t.letter)})})]}),u.jsx("p",{className:"pt-8 mt-8 text-gray-800 font-medium text-center text-lg border-t border-gray-200",children:"AGWA Water Services, Inc.  Ensuring Clarity, Sustaining Life."})]})},oq=({type:n,href:e})=>{let t,r="hover:text-blue-700";switch(n){case"Facebook":t=d9,r="hover:text-blue-600";break;case"Twitter":t=I9,r="hover:text-sky-500";break;case"Instagram":t=p9,r="hover:text-pink-600";break;default:return null}return u.jsx("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:`text-gray-500 transition-colors duration-200 ${r}`,title:n,children:u.jsx(t,{size:28})})},aq=({systemSettings:n={}})=>{const{supportHotline:e="1627-AGWA (24/7 Emergency)",supportEmail:t="support@agwa-waterservices.com.ph"}=n,r=[{icon:wP,title:"Customer Service Hotlines",lines:[{text:e,valueClass:"text-2xl font-semibold text-blue-700 tracking-tight"},{text:"(+63 2) 8162-2492 (Outside Metro Manila / Standard Hours)",valueClass:"text-lg text-gray-700"}],note:"Emergency reports are handled 24/7. General inquiries: Mon - Fri, 8 AM - 5 PM PHT.",bgColor:"bg-blue-50",iconColor:"text-blue-600"},{icon:Sa,title:"Email Support",lines:[{text:t,valueClass:"text-lg text-green-700 hover:underline"}],note:"For general inquiries, billing concerns, feedback, and non-urgent requests. Expect a response within 1-2 business days.",href:`mailto:${t}`,bgColor:"bg-green-50",iconColor:"text-green-600"}],i={title:"AGWA Head Office",addressLines:["AGWA Water Services Tower","123 Aqua Drive, Hydro Business Park","Naic, Cavite, Philippines 4110"],hours:"Mon - Fri, 8:00 AM - 5:00 PM PHT (Closed on weekends & public holidays)",note:"Walk-ins are welcome for payments and specific services. For complex concerns, an appointment is recommended to ensure specialist availability.",mapLink:"https://maps.google.com/?q=AGWA+Water+Services+Tower,Quezon+City",bgColor:"bg-gray-100",iconColor:"text-gray-600"},s=[{type:"Facebook",href:"https://facebook.com/AGWAwaterservices"},{type:"Twitter",href:"https://twitter.com/AGWAwaterserv"},{type:"Instagram",href:"https://instagram.com/AGWAwater"}];return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(Aa,{size:30,className:"mr-3 text-blue-600"}),"Get In Touch With AGWA"]})}),u.jsx("p",{className:"text-gray-700 mb-8 leading-relaxed text-sm sm:text-base",children:"We value your feedback and are dedicated to assisting you with your water service needs. For immediate assistance, especially during emergencies like major leaks or widespread service interruptions, please use our 24/7 hotline. For other inquiries, choose the most convenient channel below."}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:r.map((o,l)=>{const d=o.icon;return u.jsxs("div",{className:`p-5 rounded-xl shadow-lg hover:shadow-xl transition-shadow ${o.bgColor} border border-gray-200`,children:[u.jsxs("div",{className:"flex items-start mb-3",children:[u.jsx(d,{size:28,className:`mr-4 mt-1 flex-shrink-0 ${o.iconColor}`}),u.jsxs("div",{children:[u.jsx("h3",{className:`text-lg font-semibold ${o.iconColor}`,children:o.title}),o.lines.map((f,m)=>o.href&&m===0?u.jsx("a",{href:o.href,className:f.valueClass,children:f.text},m):u.jsx("p",{className:f.valueClass,children:f.text},m))]})]}),u.jsx("p",{className:"text-xs text-gray-500 leading-normal",children:o.note})]},l)})}),u.jsxs("div",{className:`p-5 rounded-xl shadow-lg hover:shadow-xl transition-shadow mb-8 ${i.bgColor} border border-gray-200`,children:[u.jsxs("div",{className:"flex items-start mb-3",children:[u.jsx(yP,{size:28,className:`mr-4 mt-1 flex-shrink-0 ${i.iconColor}`}),u.jsxs("div",{children:[u.jsx("h3",{className:`text-lg font-semibold ${i.iconColor}`,children:i.title}),i.addressLines.map((o,l)=>u.jsx("p",{className:"text-sm text-gray-700 leading-snug",children:o},l))]})]}),u.jsxs("div",{className:"text-sm text-gray-600 space-y-1 mt-2",children:[u.jsxs("p",{className:"flex items-center",children:[u.jsx(Ss,{size:14,className:"mr-2 text-gray-500"}),u.jsx("strong",{children:"Hours:"})," ",i.hours]}),u.jsxs("p",{className:"flex items-start",children:[u.jsx(Oo,{size:14,className:"mr-2 mt-0.5 text-gray-500 flex-shrink-0"}),u.jsx("strong",{children:"Location Note:"})," ",i.note]})]}),u.jsxs("a",{href:i.mapLink,target:"_blank",rel:"noopener noreferrer",className:"mt-3 inline-flex items-center text-xs text-blue-600 hover:text-blue-800 hover:underline font-medium",children:["View on Map ",u.jsx(Oo,{size:12,className:"ml-1"})]})]}),u.jsxs("div",{className:"mt-10 text-center border-t border-gray-200 pt-8",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"Stay Connected"}),u.jsx("p",{className:"text-sm text-gray-600 mb-5 max-w-md mx-auto",children:"Follow us on our official social media channels for the latest news, service advisories, water conservation tips, and community program updates."}),u.jsx("div",{className:"flex justify-center space-x-6 sm:space-x-8",children:s.map(o=>u.jsx(oq,{type:o.type,href:o.href},o.type))}),u.jsxs("p",{className:"mt-8 text-xs text-gray-500",children:["For online self-service options, please ",u.jsx("button",{onClick:()=>{alert("Please log in to access self-service options.")},className:"text-blue-600 hover:underline font-medium",children:"log in"})," to your account. ",u.jsx("br",{}),"General information is also available on our official website: ",u.jsx("a",{href:"https://www.agwa-waterservices.com.ph",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline font-medium",children:"www.agwa-waterservices.com.ph"})]})]})]})},lq=({user:n,userData:e,db:t,showNotification:r,setActiveSection:i})=>{const[s,o]=ee.useState({totalUsers:0,openTickets:0,activeAnnouncements:0,systemStatus:"Operational"}),[l,d]=ee.useState(!0),[f,m]=ee.useState(""),y=ee.useCallback(async()=>{d(!0),m("");try{const _=await Promise.allSettled([fP(t),mP(t),z8(t)]),[E,x,w]=_,S={systemStatus:"Operational"};let N="";E.status==="fulfilled"&&E.value.success?S.totalUsers=E.value.data.total:N+="Users data unavailable. ",x.status==="fulfilled"&&x.value.success?S.openTickets=x.value.data.openCount||0:N+="Tickets data unavailable. ",w.status==="fulfilled"&&w.value.success?S.activeAnnouncements=w.value.data.active:N+="Announcements data unavailable. ",o(P=>({...P,...S})),N.trim()&&(m(N.trim()),r(`Partial data load: ${N}`,"warning"))}catch{const E="A critical error occurred while fetching dashboard statistics.";m(E),r(E,"error"),o(x=>({...x,systemStatus:"Error"}))}finally{d(!1)}},[t,r]);ee.useEffect(()=>{y()},[y]);const g=[{title:"User Management",icon:xa,section:"userManagement",description:"View, edit, and manage all user accounts.",color:"blue"},{title:"Support Tickets",icon:Aa,section:"supportTickets",description:"Address and manage user-submitted issues.",color:"purple"},{title:"Announcements",icon:hd,section:"manageAnnouncements",description:"Create and publish portal-wide announcements.",color:"teal"},{title:"System Analytics",icon:Kb,section:"systemAnalytics",description:"View key metrics and system performance data.",color:"orange"},{title:"Meter Readings Mgt.",icon:Yl,section:"editMeterReadingsAdmin",description:"Oversee and manage meter reading entries.",color:"sky"},{title:"System Settings",icon:Uy,section:"systemSettings",description:"Configure application parameters and settings.",color:"gray"}];return l?u.jsx(gn,{message:"Loading admin dashboard statistics...",className:"mt-10 h-48"}):u.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[u.jsx("div",{className:"p-6 bg-gradient-to-r from-slate-700 to-slate-900 text-white rounded-xl shadow-2xl",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl sm:text-3xl font-bold",children:"Administrator Dashboard"}),u.jsxs("p",{className:"mt-1 text-slate-300",children:["Welcome, ",(e==null?void 0:e.displayName)||"Admin",". Oversee portal operations."]})]}),u.jsxs("button",{onClick:y,className:"text-sm flex items-center bg-slate-600 hover:bg-slate-500 text-white font-medium py-2 px-3 rounded-lg transition-colors disabled:opacity-70",disabled:l,title:"Refresh Statistics",children:[l?u.jsx(St,{size:16,className:"animate-spin"}):u.jsx(ja,{size:16}),u.jsx("span",{className:"ml-2 hidden sm:inline",children:"Refresh"})]})]})}),f&&u.jsxs("p",{className:"text-sm text-yellow-600 bg-yellow-50 p-3 rounded-md text-center flex items-center justify-center gap-2",children:[u.jsx(An,{size:16})," ",f]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5",children:[u.jsx(di,{title:"Total Users",value:s.totalUsers??"N/A",icon:xa,borderColor:"border-blue-500",iconColor:"text-blue-500",onClick:()=>i("userManagement")}),u.jsx(di,{title:"Open Support Tickets",value:s.openTickets,icon:Xt,borderColor:"border-red-500",iconColor:"text-red-500",onClick:()=>i("supportTickets")}),u.jsx(di,{title:"Active Announcements",value:s.activeAnnouncements??"N/A",icon:hd,borderColor:"border-teal-500",iconColor:"text-teal-500",onClick:()=>i("viewAnnouncements")}),u.jsx(di,{title:"System Status",value:s.systemStatus,icon:Ud,borderColor:s.systemStatus==="Error"?"border-red-500":"border-green-500",iconColor:s.systemStatus==="Error"?"text-red-500":"text-green-500"})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-5 mt-8 pt-5 border-t border-gray-200",children:"Administrative Tools"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(_=>u.jsxs("button",{onClick:()=>i(_.section),className:`p-6 bg-white rounded-xl shadow-lg hover:shadow-2xl transform hover:-translate-y-1.5 transition-all duration-300 ease-in-out text-left focus:outline-none focus:ring-2 focus:ring-${_.color}-500 focus:ring-opacity-75 group h-full flex flex-col`,children:[u.jsx("div",{className:`p-3 bg-${_.color}-100 rounded-full inline-block mb-3 self-start group-hover:scale-110 transition-transform`,children:u.jsx(_.icon,{size:28,className:`text-${_.color}-600`})}),u.jsx("h4",{className:`text-lg font-semibold text-gray-800 group-hover:text-${_.color}-700 transition-colors`,children:_.title}),u.jsx("p",{className:"text-sm text-gray-500 mt-1 leading-normal flex-grow",children:_.description})]},_.section))})]})]})},bs="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",WA="bg-gray-200 cursor-not-allowed text-gray-500",cq=({user:n,isOpen:e,onClose:t,onSave:r,isSaving:i,determineServiceTypeAndRole:s})=>{const[o,l]=ee.useState({displayName:"",email:"",accountNumber:"",accountStatus:"Active",role:"customer",serviceType:"Residential",meterSerialNumber:"",meterSize:'1/2"'}),[d,f]=ee.useState({district:"",barangay:"",street:"",landmark:""}),[m,y]=ee.useState([]),[g,_]=ee.useState([]),E=o.role==="customer";ee.useEffect(()=>{if(y(Ky()),n){const N=n.role||"customer",P=N==="customer";if(l({displayName:n.displayName||"",email:n.email||"",accountNumber:n.accountNumber||"",accountStatus:n.accountStatus||"Active",role:N,serviceType:n.serviceType||"Residential",meterSerialNumber:n.meterSerialNumber||"",meterSize:n.meterSize||'1/2"'}),P&&n.serviceAddress&&typeof n.serviceAddress=="object"){const I=n.serviceAddress.district||"";f({district:n.serviceAddress.district||"",barangay:n.serviceAddress.barangay||"",street:n.serviceAddress.street||"",landmark:n.serviceAddress.landmark||""}),I&&_(Pd(I))}else f({district:"",barangay:"",street:"",landmark:""})}},[n]);const x=N=>{const{name:P,value:I}=N.target;f(R=>{const U={...R,[P]:I};return P==="district"&&(U.barangay="",_(Pd(I))),U})},w=N=>{const{name:P,value:I}=N.target;let R={...o,[P]:I};if(P==="accountNumber"&&s){const{role:U,serviceType:j}=s(I);R={...R,role:U,serviceType:j}}if(P==="role"&&I!=="customer"){R.accountNumber="",R.meterSerialNumber="",R.meterSize="";const{serviceType:U}=s("");R.serviceType=U,f({district:"",barangay:"",street:"",landmark:""})}l(R)},S=N=>{N.preventDefault();const P={...o,serviceAddress:E?d:{}};E||(delete P.meterSerialNumber,delete P.meterSize,delete P.serviceAddress),r(P)};return u.jsx(Or,{isOpen:e,onClose:t,title:`Edit User: ${n.displayName||n.email}`,size:"3xl",children:u.jsxs("form",{onSubmit:S,className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsx("input",{type:"text",name:"displayName",value:o.displayName,onChange:w,className:bs,placeholder:"Full Name"}),u.jsx("input",{type:"email",name:"email",value:o.email,className:`${bs} ${WA}`,disabled:!0}),u.jsx("select",{name:"role",value:o.role,onChange:w,className:`${bs} capitalize`,children:["customer","admin","meter_reader","clerk_cashier"].map(N=>u.jsx("option",{value:N,children:N.replace("_"," ")},N))}),u.jsxs("select",{name:"accountStatus",value:o.accountStatus,onChange:w,className:bs,children:[u.jsx("option",{value:"Active",children:"Active"}),u.jsx("option",{value:"Inactive",children:"Inactive"}),u.jsx("option",{value:"Suspended",children:"Suspended"})]}),u.jsx("input",{type:"text",name:"accountNumber",value:o.accountNumber,onChange:w,className:bs,placeholder:"Account Number",disabled:!E}),u.jsx("input",{type:"text",name:"serviceType",value:o.serviceType,className:`${bs} ${WA}`,disabled:!0}),E&&u.jsxs(u.Fragment,{children:[u.jsx("input",{type:"text",name:"meterSerialNumber",value:o.meterSerialNumber,onChange:w,className:bs,placeholder:"Meter Serial Number"}),u.jsx("input",{type:"text",name:"meterSize",value:o.meterSize,onChange:w,className:bs,placeholder:"Meter Size"})]})]}),E&&u.jsxs("div",{className:"pt-4 mt-4 border-t",children:[u.jsx("h3",{className:"text-md font-semibold text-gray-700 mb-2",children:"Service Address"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("select",{name:"district",value:d.district,onChange:x,className:bs,children:[u.jsx("option",{value:"",children:"Select District"}),m.map(N=>u.jsx("option",{value:N,children:N},N))]}),u.jsxs("select",{name:"barangay",value:d.barangay,onChange:x,className:bs,disabled:!d.district,children:[u.jsx("option",{value:"",children:"Select Barangay"}),g.map(N=>u.jsx("option",{value:N,children:N},N))]}),u.jsx("div",{className:"md:col-span-2",children:u.jsx("input",{type:"text",name:"street",value:d.street,onChange:x,className:bs,placeholder:"Street Name, Building, House No."})}),u.jsx("div",{className:"md:col-span-2",children:u.jsx("input",{type:"text",name:"landmark",value:d.landmark,onChange:x,className:bs,placeholder:"Landmark"})})]})]}),u.jsxs("div",{className:"pt-4 flex justify-end space-x-3",children:[u.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg border",disabled:i,children:"Cancel"}),u.jsxs("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg flex items-center",disabled:i,children:[i?u.jsx(St,{size:18,className:"animate-spin mr-2"}):u.jsx(Oa,{size:18,className:"mr-2"}),i?"Saving...":"Save Changes"]})]})]})})},Jl=({isOpen:n,onClose:e,onConfirm:t,title:r,children:i,confirmText:s="Confirm",cancelText:o="Cancel",confirmButtonClass:l="bg-red-600 hover:bg-red-700 focus:ring-red-500",cancelButtonClass:d="bg-gray-200 hover:bg-gray-300 text-gray-700 focus:ring-gray-400",iconType:f="warning",isConfirming:m=!1})=>{if(!n)return null;let y,g="";switch(f){case"success":y=Is,g="text-green-500";break;case"danger":y=o9,g="text-red-500";break;case"warning":default:y=Xt,g="text-yellow-500";break}return u.jsxs(Or,{isOpen:n,onClose:e,title:r,size:"md",children:[u.jsxs("div",{className:"text-center",children:[y&&u.jsx("div",{className:`mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-${f==="warning"?"yellow":f==="success"?"green":"red"}-100 mb-4`,children:u.jsx(y,{className:`h-6 w-6 ${g}`,"aria-hidden":"true"})}),u.jsx("div",{className:"text-sm text-gray-600 mb-6",children:i})]}),u.jsxs("div",{className:"mt-5 sm:mt-6 flex flex-col sm:flex-row-reverse gap-3",children:[u.jsxs("button",{type:"button",className:`w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 text-base font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 sm:text-sm ${l} ${m?"opacity-50 cursor-not-allowed":""}`,onClick:t,disabled:m,children:[m?u.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):null,m?"Processing...":s]}),u.jsx("button",{type:"button",className:`w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 text-base font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 sm:text-sm ${d}`,onClick:e,disabled:m,children:o})]})]})};function Ix(){return Ix=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)({}).hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Ix.apply(null,arguments)}function GA(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function kx(n,e){return kx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,r){return t.__proto__=r,t},kx(n,e)}function uq(n,e){n.prototype=Object.create(e.prototype),n.prototype.constructor=n,kx(n,e)}var KA=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function dq(n,e){return!!(n===e||KA(n)&&KA(e))}function hq(n,e){if(n.length!==e.length)return!1;for(var t=0;t<n.length;t++)if(!dq(n[t],e[t]))return!1;return!0}function Qv(n,e){e===void 0&&(e=hq);var t,r=[],i,s=!1;function o(){for(var l=[],d=0;d<arguments.length;d++)l[d]=arguments[d];return s&&t===this&&e(l,r)||(i=n.apply(this,l),s=!0,t=this,r=l),i}return o}var fq=typeof performance=="object"&&typeof performance.now=="function",YA=fq?function(){return performance.now()}:function(){return Date.now()};function ZA(n){cancelAnimationFrame(n.id)}function mq(n,e){var t=YA();function r(){YA()-t>=e?n.call(null):i.id=requestAnimationFrame(r)}var i={id:requestAnimationFrame(r)};return i}var Xv=-1;function QA(n){if(n===void 0&&(n=!1),Xv===-1||n){var e=document.createElement("div"),t=e.style;t.width="50px",t.height="50px",t.overflow="scroll",document.body.appendChild(e),Xv=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return Xv}var td=null;function XA(n){if(n===void 0&&(n=!1),td===null||n){var e=document.createElement("div"),t=e.style;t.width="50px",t.height="50px",t.overflow="scroll",t.direction="rtl";var r=document.createElement("div"),i=r.style;return i.width="100px",i.height="100px",e.appendChild(r),document.body.appendChild(e),e.scrollLeft>0?td="positive-descending":(e.scrollLeft=1,e.scrollLeft===0?td="negative":td="positive-ascending"),document.body.removeChild(e),td}return td}var pq=150,gq=function(e,t){return e};function yq(n){var e,t=n.getItemOffset,r=n.getEstimatedTotalSize,i=n.getItemSize,s=n.getOffsetForIndexAndAlignment,o=n.getStartIndexForOffset,l=n.getStopIndexForStartIndex,d=n.initInstanceProps,f=n.shouldResetStyleCacheOnItemSizeChange,m=n.validateProps;return e=function(y){uq(g,y);function g(E){var x;return x=y.call(this,E)||this,x._instanceProps=d(x.props,GA(x)),x._outerRef=void 0,x._resetIsScrollingTimeoutId=null,x.state={instance:GA(x),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof x.props.initialScrollOffset=="number"?x.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},x._callOnItemsRendered=void 0,x._callOnItemsRendered=Qv(function(w,S,N,P){return x.props.onItemsRendered({overscanStartIndex:w,overscanStopIndex:S,visibleStartIndex:N,visibleStopIndex:P})}),x._callOnScroll=void 0,x._callOnScroll=Qv(function(w,S,N){return x.props.onScroll({scrollDirection:w,scrollOffset:S,scrollUpdateWasRequested:N})}),x._getItemStyle=void 0,x._getItemStyle=function(w){var S=x.props,N=S.direction,P=S.itemSize,I=S.layout,R=x._getItemStyleCache(f&&P,f&&I,f&&N),U;if(R.hasOwnProperty(w))U=R[w];else{var j=t(x.props,w,x._instanceProps),k=i(x.props,w,x._instanceProps),F=N==="horizontal"||I==="horizontal",O=N==="rtl",C=F?j:0;R[w]=U={position:"absolute",left:O?void 0:C,right:O?C:void 0,top:F?0:j,height:F?"100%":k,width:F?k:"100%"}}return U},x._getItemStyleCache=void 0,x._getItemStyleCache=Qv(function(w,S,N){return{}}),x._onScrollHorizontal=function(w){var S=w.currentTarget,N=S.clientWidth,P=S.scrollLeft,I=S.scrollWidth;x.setState(function(R){if(R.scrollOffset===P)return null;var U=x.props.direction,j=P;if(U==="rtl")switch(XA()){case"negative":j=-P;break;case"positive-descending":j=I-N-P;break}return j=Math.max(0,Math.min(j,I-N)),{isScrolling:!0,scrollDirection:R.scrollOffset<j?"forward":"backward",scrollOffset:j,scrollUpdateWasRequested:!1}},x._resetIsScrollingDebounced)},x._onScrollVertical=function(w){var S=w.currentTarget,N=S.clientHeight,P=S.scrollHeight,I=S.scrollTop;x.setState(function(R){if(R.scrollOffset===I)return null;var U=Math.max(0,Math.min(I,P-N));return{isScrolling:!0,scrollDirection:R.scrollOffset<U?"forward":"backward",scrollOffset:U,scrollUpdateWasRequested:!1}},x._resetIsScrollingDebounced)},x._outerRefSetter=function(w){var S=x.props.outerRef;x._outerRef=w,typeof S=="function"?S(w):S!=null&&typeof S=="object"&&S.hasOwnProperty("current")&&(S.current=w)},x._resetIsScrollingDebounced=function(){x._resetIsScrollingTimeoutId!==null&&ZA(x._resetIsScrollingTimeoutId),x._resetIsScrollingTimeoutId=mq(x._resetIsScrolling,pq)},x._resetIsScrolling=function(){x._resetIsScrollingTimeoutId=null,x.setState({isScrolling:!1},function(){x._getItemStyleCache(-1,null)})},x}g.getDerivedStateFromProps=function(x,w){return vq(x,w),m(x),null};var _=g.prototype;return _.scrollTo=function(x){x=Math.max(0,x),this.setState(function(w){return w.scrollOffset===x?null:{scrollDirection:w.scrollOffset<x?"forward":"backward",scrollOffset:x,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},_.scrollToItem=function(x,w){w===void 0&&(w="auto");var S=this.props,N=S.itemCount,P=S.layout,I=this.state.scrollOffset;x=Math.max(0,Math.min(x,N-1));var R=0;if(this._outerRef){var U=this._outerRef;P==="vertical"?R=U.scrollWidth>U.clientWidth?QA():0:R=U.scrollHeight>U.clientHeight?QA():0}this.scrollTo(s(this.props,x,w,I,this._instanceProps,R))},_.componentDidMount=function(){var x=this.props,w=x.direction,S=x.initialScrollOffset,N=x.layout;if(typeof S=="number"&&this._outerRef!=null){var P=this._outerRef;w==="horizontal"||N==="horizontal"?P.scrollLeft=S:P.scrollTop=S}this._callPropsCallbacks()},_.componentDidUpdate=function(){var x=this.props,w=x.direction,S=x.layout,N=this.state,P=N.scrollOffset,I=N.scrollUpdateWasRequested;if(I&&this._outerRef!=null){var R=this._outerRef;if(w==="horizontal"||S==="horizontal")if(w==="rtl")switch(XA()){case"negative":R.scrollLeft=-P;break;case"positive-ascending":R.scrollLeft=P;break;default:var U=R.clientWidth,j=R.scrollWidth;R.scrollLeft=j-U-P;break}else R.scrollLeft=P;else R.scrollTop=P}this._callPropsCallbacks()},_.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&ZA(this._resetIsScrollingTimeoutId)},_.render=function(){var x=this.props,w=x.children,S=x.className,N=x.direction,P=x.height,I=x.innerRef,R=x.innerElementType,U=x.innerTagName,j=x.itemCount,k=x.itemData,F=x.itemKey,O=F===void 0?gq:F,C=x.layout,D=x.outerElementType,M=x.outerTagName,$=x.style,G=x.useIsScrolling,re=x.width,oe=this.state.isScrolling,ie=N==="horizontal"||C==="horizontal",X=ie?this._onScrollHorizontal:this._onScrollVertical,Y=this._getRangeToRender(),B=Y[0],Z=Y[1],te=[];if(j>0)for(var se=B;se<=Z;se++)te.push(ee.createElement(w,{data:k,key:O(se,k),index:se,isScrolling:G?oe:void 0,style:this._getItemStyle(se)}));var ae=r(this.props,this._instanceProps);return ee.createElement(D||M||"div",{className:S,onScroll:X,ref:this._outerRefSetter,style:Ix({position:"relative",height:P,width:re,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:N},$)},ee.createElement(R||U||"div",{children:te,ref:I,style:{height:ie?"100%":ae,pointerEvents:oe?"none":void 0,width:ie?ae:"100%"}}))},_._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var x=this.props.itemCount;if(x>0){var w=this._getRangeToRender(),S=w[0],N=w[1],P=w[2],I=w[3];this._callOnItemsRendered(S,N,P,I)}}if(typeof this.props.onScroll=="function"){var R=this.state,U=R.scrollDirection,j=R.scrollOffset,k=R.scrollUpdateWasRequested;this._callOnScroll(U,j,k)}},_._getRangeToRender=function(){var x=this.props,w=x.itemCount,S=x.overscanCount,N=this.state,P=N.isScrolling,I=N.scrollDirection,R=N.scrollOffset;if(w===0)return[0,0,0,0];var U=o(this.props,R,this._instanceProps),j=l(this.props,U,R,this._instanceProps),k=!P||I==="backward"?Math.max(1,S):1,F=!P||I==="forward"?Math.max(1,S):1;return[Math.max(0,U-k),Math.max(0,Math.min(w-1,j+F)),U,j]},g}(ee.PureComponent),e.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},e}var vq=function(e,t){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,t.instance},_q=yq({getItemOffset:function(e,t){var r=e.itemSize;return t*r},getItemSize:function(e,t){var r=e.itemSize;return r},getEstimatedTotalSize:function(e){var t=e.itemCount,r=e.itemSize;return r*t},getOffsetForIndexAndAlignment:function(e,t,r,i,s,o){var l=e.direction,d=e.height,f=e.itemCount,m=e.itemSize,y=e.layout,g=e.width,_=l==="horizontal"||y==="horizontal",E=_?g:d,x=Math.max(0,f*m-E),w=Math.min(x,t*m),S=Math.max(0,t*m-E+m+o);switch(r==="smart"&&(i>=S-E&&i<=w+E?r="auto":r="center"),r){case"start":return w;case"end":return S;case"center":{var N=Math.round(S+(w-S)/2);return N<Math.ceil(E/2)?0:N>x+Math.floor(E/2)?x:N}case"auto":default:return i>=S&&i<=w?i:i<S?S:w}},getStartIndexForOffset:function(e,t){var r=e.itemCount,i=e.itemSize;return Math.max(0,Math.min(r-1,Math.floor(t/i)))},getStopIndexForStartIndex:function(e,t,r){var i=e.direction,s=e.height,o=e.itemCount,l=e.itemSize,d=e.layout,f=e.width,m=i==="horizontal"||d==="horizontal",y=t*l,g=m?f:s,_=Math.ceil((g+r-y)/l);return Math.max(0,Math.min(o-1,t+_-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.itemSize}});const Jv="w-full px-3 py-2 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",xq=({db:n,showNotification:e,determineServiceTypeAndRole:t,userData:r})=>{const[i,s]=ee.useState([]),[o,l]=ee.useState(!0),[d,f]=ee.useState(null),[m,y]=ee.useState(null),[g,_]=ee.useState(""),[E,x]=ee.useState(!1),[w,S]=ee.useState(!1),[N,P]=ee.useState(""),[I,R]=ee.useState(""),[U,j]=ee.useState(""),[k,F]=ee.useState(!1),[O,C]=ee.useState(""),D=ee.useCallback(async()=>{l(!0),C("");const se=await A8(n);if(se.success)s(se.data.sort((ae,Q)=>(ae.displayName||ae.email||"").localeCompare(Q.displayName||Q.email||"")));else{const ae=se.error||"Failed to fetch user list. Please try again.";C(ae)}l(!1)},[n]);ee.useEffect(()=>{D()},[D]);const M=se=>f(se),$=()=>f(null),G=async se=>{if(!d)return;F(!0);const ae=await Zh(n,d.id,se);ae.success?(e("User profile updated successfully!","success"),$(),D()):e(ae.error||"Failed to update user profile.","error"),F(!1)},re=(se,ae)=>{y(se),_(ae),x(!0)},oe=async()=>{!m||!g||(F(!0),await Zh(n,m.id,{accountStatus:g}),e(`User account status changed to ${g}.`,"success"),D(),x(!1),y(null),_(""),F(!1))},ie=se=>{y(se),S(!0)},X=async()=>{if(!m)return;F(!0),await Zh(n,m.id,{accountStatus:"Suspended"});const se=await r8(n,m.id);se.success?(e(`User ${m.displayName} has been permanently deleted.`,"success"),D()):(e(se.error||"Failed to delete user profile.","error"),await Zh(n,m.id,{accountStatus:m.accountStatus})),S(!1),y(null),F(!1)},Y=i.filter(se=>{var Q,ce,me;const ae=N.toLowerCase();return(((Q=se.displayName)==null?void 0:Q.toLowerCase().includes(ae))||((ce=se.email)==null?void 0:ce.toLowerCase().includes(ae))||((me=se.accountNumber)==null?void 0:me.toLowerCase().includes(ae)))&&(I?se.role===I:!0)&&(U?se.accountStatus===U:!0)}),B={admin:"bg-purple-100 text-purple-700",customer:"bg-blue-100 text-blue-700",meter_reader:"bg-teal-100 text-teal-700",clerk_cashier:"bg-indigo-100 text-indigo-700",unknown:"bg-gray-100 text-gray-700"},Z={Active:"bg-green-100 text-green-700",Inactive:"bg-gray-200 text-gray-600",Suspended:"bg-red-100 text-red-700","Profile Missing":"bg-yellow-100 text-yellow-700",Unknown:"bg-gray-100 text-gray-600"},te=({index:se,style:ae})=>{var ce;const Q=Y[se];return u.jsxs("div",{style:ae,className:"flex items-center border-b border-gray-200 text-sm",children:[u.jsx("div",{className:"px-4 py-2 whitespace-nowrap text-gray-800 font-medium flex-1",children:Q.displayName||"N/A"}),u.jsx("div",{className:"px-4 py-2 whitespace-nowrap text-gray-500 truncate flex-1",title:Q.email||Q.phoneNumber,children:Q.email||Q.phoneNumber||"N/A"}),u.jsx("div",{className:"px-4 py-2 flex-1",children:u.jsx("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full capitalize ${B[Q.role||"unknown"]}`,children:((ce=Q.role)==null?void 0:ce.replace("_"," "))||"Unknown"})}),u.jsx("div",{className:"px-4 py-2 whitespace-nowrap text-gray-500 font-mono text-xs flex-1",children:Q.accountNumber||"N/A"}),u.jsx("div",{className:"px-4 py-2 flex-1",children:u.jsx("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full ${Z[Q.accountStatus||"Unknown"]}`,children:Q.accountStatus||"Unknown"})}),u.jsx("div",{className:"px-4 py-2 whitespace-nowrap text-gray-500 flex-1",children:Q.createdAt?Zt(Q.createdAt,{year:"numeric",month:"short",day:"numeric"}):"N/A"}),u.jsxs("div",{className:"px-4 py-2 whitespace-nowrap text-sm text-center space-x-1.5 flex-1",children:[u.jsx("button",{onClick:()=>M(Q),className:"text-blue-600 hover:text-blue-800 p-1 hover:bg-blue-100 rounded-md",title:"Edit User",children:u.jsx(n2,{size:16})}),Q.accountStatus!=="Suspended"&&u.jsx("button",{onClick:()=>re(Q,"Suspended"),className:"text-orange-500 hover:text-orange-700 p-1 hover:bg-orange-100 rounded-md",title:"Suspend User",children:u.jsx(k9,{size:16})}),(Q.accountStatus==="Suspended"||Q.accountStatus==="Inactive")&&u.jsx("button",{onClick:()=>re(Q,"Active"),className:"text-green-500 hover:text-green-700 p-1 hover:bg-green-100 rounded-md",title:"Activate User",children:u.jsx(SP,{size:16})}),(r==null?void 0:r.uid)!==Q.id&&u.jsx("button",{onClick:()=>ie(Q),className:"text-red-600 hover:text-red-800 p-1 hover:bg-red-100 rounded-md",title:"Delete User",children:u.jsx(qd,{size:16})})]})]})};return o?u.jsx(gn,{message:"Loading user accounts...",className:"mt-10 h-64"}):u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(xa,{size:30,className:"mr-3 text-blue-600"})," User Account Management"]}),u.jsxs("button",{onClick:D,className:"mt-3 sm:mt-0 text-sm flex items-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-3 rounded-lg border border-gray-300 transition-colors",disabled:o,title:"Refresh User List",children:[o?u.jsx(St,{size:16,className:"animate-spin mr-1.5"}):u.jsx(ja,{size:16,className:"mr-1.5"})," Refresh List"]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 p-4 bg-gray-50 rounded-lg shadow-sm",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"userMgmtSearchTerm",className:"block text-xs font-medium text-gray-600 mb-1",children:"Search Users"}),u.jsxs("div",{className:"relative",children:[u.jsx(Ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsx("input",{type:"text",id:"userMgmtSearchTerm",placeholder:"Name, Email, Account No...",className:`${Jv} pl-9`,value:N,onChange:se=>P(se.target.value)})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"userMgmtFilterRole",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Role"}),u.jsxs("div",{className:"relative",children:[u.jsx(f9,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsxs("select",{id:"userMgmtFilterRole",className:`${Jv} pl-9`,value:I,onChange:se=>R(se.target.value),children:[u.jsx("option",{value:"",children:"All Roles"}),u.jsx("option",{value:"customer",children:"Customer"}),u.jsx("option",{value:"admin",children:"Admin"}),u.jsx("option",{value:"meter_reader",children:"Meter Reader"}),u.jsx("option",{value:"clerk_cashier",children:"Clerk/Cashier"})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"userMgmtFilterStatus",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Status"}),u.jsxs("div",{className:"relative",children:[u.jsx(Ud,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsxs("select",{id:"userMgmtFilterStatus",className:`${Jv} pl-9`,value:U,onChange:se=>j(se.target.value),children:[u.jsx("option",{value:"",children:"All Statuses"}),u.jsx("option",{value:"Active",children:"Active"}),u.jsx("option",{value:"Inactive",children:"Inactive"}),u.jsx("option",{value:"Suspended",children:"Suspended"}),u.jsx("option",{value:"Profile Missing",children:"Profile Missing"})]})]})]})]}),!o&&Y.length===0&&u.jsxs("div",{className:"text-center py-10",children:[u.jsx(An,{size:48,className:"mx-auto text-gray-400 mb-3"}),u.jsx("p",{className:"text-gray-500 text-lg",children:i.length===0&&!O?"No users found.":"No users match your filters."})]}),!o&&Y.length>0&&u.jsxs("div",{className:"overflow-x-auto shadow-md rounded-lg border border-gray-200",children:[u.jsxs("div",{className:"flex bg-gray-100 text-xs font-medium text-gray-500 uppercase tracking-wider",children:[u.jsx("div",{className:"px-4 py-3 flex-1",children:"Name"}),u.jsx("div",{className:"px-4 py-3 flex-1",children:"Email / Contact"}),u.jsx("div",{className:"px-4 py-3 flex-1",children:"Role"}),u.jsx("div",{className:"px-4 py-3 flex-1",children:"Account No."}),u.jsx("div",{className:"px-4 py-3 flex-1",children:"Status"}),u.jsx("div",{className:"px-4 py-3 flex-1",children:"Joined"}),u.jsx("div",{className:"px-4 py-3 text-center flex-1",children:"Actions"})]}),u.jsx(_q,{height:400,itemCount:Y.length,itemSize:60,width:"100%",children:te})]}),d&&u.jsx(cq,{user:d,isOpen:!!d,onClose:$,onSave:G,isSaving:k,determineServiceTypeAndRole:t,showNotification:e}),E&&m&&u.jsx(Jl,{isOpen:E,onClose:()=>x(!1),onConfirm:oe,title:"Confirm Status Change",confirmText:k?"Updating...":`Set to ${g}`,isConfirming:k,iconType:g==="Active"?"success":"danger",confirmButtonClass:g==="Active"?"bg-green-600 hover:bg-green-700 focus:ring-green-500":"bg-red-600 hover:bg-red-700 focus:ring-red-500",children:u.jsxs("p",{children:["Change status for ",u.jsx("strong",{children:m.displayName||m.email})," to ",u.jsx("strong",{className:g==="Active"?"text-green-600":"text-red-600",children:g}),"?"]})}),w&&m&&u.jsxs(Jl,{isOpen:w,onClose:()=>S(!1),onConfirm:X,title:"Confirm User Deletion",confirmText:"Yes, Permanently Delete",isConfirming:k,iconType:"danger",children:[u.jsxs("p",{children:["Are you sure you want to delete ",u.jsx("strong",{children:m.displayName||m.email}),"?"]}),u.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"This will permanently delete the user's profile and data. Their authentication account will be disabled. This action cannot be undone."})]})]})};var e1,JA;function bq(){if(JA)return e1;JA=1;function n(){this.__data__=[],this.size=0}return e1=n,e1}var t1,eN;function L3(){if(eN)return t1;eN=1;function n(e,t){return e===t||e!==e&&t!==t}return t1=n,t1}var n1,tN;function Yy(){if(tN)return n1;tN=1;var n=L3();function e(t,r){for(var i=t.length;i--;)if(n(t[i][0],r))return i;return-1}return n1=e,n1}var r1,nN;function wq(){if(nN)return r1;nN=1;var n=Yy(),e=Array.prototype,t=e.splice;function r(i){var s=this.__data__,o=n(s,i);if(o<0)return!1;var l=s.length-1;return o==l?s.pop():t.call(s,o,1),--this.size,!0}return r1=r,r1}var i1,rN;function Eq(){if(rN)return i1;rN=1;var n=Yy();function e(t){var r=this.__data__,i=n(r,t);return i<0?void 0:r[i][1]}return i1=e,i1}var s1,iN;function Tq(){if(iN)return s1;iN=1;var n=Yy();function e(t){return n(this.__data__,t)>-1}return s1=e,s1}var o1,sN;function Sq(){if(sN)return o1;sN=1;var n=Yy();function e(t,r){var i=this.__data__,s=n(i,t);return s<0?(++this.size,i.push([t,r])):i[s][1]=r,this}return o1=e,o1}var a1,oN;function Zy(){if(oN)return a1;oN=1;var n=bq(),e=wq(),t=Eq(),r=Tq(),i=Sq();function s(o){var l=-1,d=o==null?0:o.length;for(this.clear();++l<d;){var f=o[l];this.set(f[0],f[1])}}return s.prototype.clear=n,s.prototype.delete=e,s.prototype.get=t,s.prototype.has=r,s.prototype.set=i,a1=s,a1}var l1,aN;function Aq(){if(aN)return l1;aN=1;var n=Zy();function e(){this.__data__=new n,this.size=0}return l1=e,l1}var c1,lN;function Nq(){if(lN)return c1;lN=1;function n(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}return c1=n,c1}var u1,cN;function Iq(){if(cN)return u1;cN=1;function n(e){return this.__data__.get(e)}return u1=n,u1}var d1,uN;function kq(){if(uN)return d1;uN=1;function n(e){return this.__data__.has(e)}return d1=n,d1}var h1,dN;function F3(){if(dN)return h1;dN=1;var n=typeof yp=="object"&&yp&&yp.Object===Object&&yp;return h1=n,h1}var f1,hN;function Da(){if(hN)return f1;hN=1;var n=F3(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=n||e||Function("return this")();return f1=t,f1}var m1,fN;function w2(){if(fN)return m1;fN=1;var n=Da(),e=n.Symbol;return m1=e,m1}var p1,mN;function Cq(){if(mN)return p1;mN=1;var n=w2(),e=Object.prototype,t=e.hasOwnProperty,r=e.toString,i=n?n.toStringTag:void 0;function s(o){var l=t.call(o,i),d=o[i];try{o[i]=void 0;var f=!0}catch{}var m=r.call(o);return f&&(l?o[i]=d:delete o[i]),m}return p1=s,p1}var g1,pN;function Pq(){if(pN)return g1;pN=1;var n=Object.prototype,e=n.toString;function t(r){return e.call(r)}return g1=t,g1}var y1,gN;function Qy(){if(gN)return y1;gN=1;var n=w2(),e=Cq(),t=Pq(),r="[object Null]",i="[object Undefined]",s=n?n.toStringTag:void 0;function o(l){return l==null?l===void 0?i:r:s&&s in Object(l)?e(l):t(l)}return y1=o,y1}var v1,yN;function V3(){if(yN)return v1;yN=1;function n(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return v1=n,v1}var _1,vN;function z3(){if(vN)return _1;vN=1;var n=Qy(),e=V3(),t="[object AsyncFunction]",r="[object Function]",i="[object GeneratorFunction]",s="[object Proxy]";function o(l){if(!e(l))return!1;var d=n(l);return d==r||d==i||d==t||d==s}return _1=o,_1}var x1,_N;function Rq(){if(_N)return x1;_N=1;var n=Da(),e=n["__core-js_shared__"];return x1=e,x1}var b1,xN;function jq(){if(xN)return b1;xN=1;var n=Rq(),e=function(){var r=/[^.]+$/.exec(n&&n.keys&&n.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}();function t(r){return!!e&&e in r}return b1=t,b1}var w1,bN;function B3(){if(bN)return w1;bN=1;var n=Function.prototype,e=n.toString;function t(r){if(r!=null){try{return e.call(r)}catch{}try{return r+""}catch{}}return""}return w1=t,w1}var E1,wN;function Oq(){if(wN)return E1;wN=1;var n=z3(),e=jq(),t=V3(),r=B3(),i=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,o=Function.prototype,l=Object.prototype,d=o.toString,f=l.hasOwnProperty,m=RegExp("^"+d.call(f).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function y(g){if(!t(g)||e(g))return!1;var _=n(g)?m:s;return _.test(r(g))}return E1=y,E1}var T1,EN;function Mq(){if(EN)return T1;EN=1;function n(e,t){return e==null?void 0:e[t]}return T1=n,T1}var S1,TN;function $d(){if(TN)return S1;TN=1;var n=Oq(),e=Mq();function t(r,i){var s=e(r,i);return n(s)?s:void 0}return S1=t,S1}var A1,SN;function E2(){if(SN)return A1;SN=1;var n=$d(),e=Da(),t=n(e,"Map");return A1=t,A1}var N1,AN;function Xy(){if(AN)return N1;AN=1;var n=$d(),e=n(Object,"create");return N1=e,N1}var I1,NN;function Dq(){if(NN)return I1;NN=1;var n=Xy();function e(){this.__data__=n?n(null):{},this.size=0}return I1=e,I1}var k1,IN;function Lq(){if(IN)return k1;IN=1;function n(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}return k1=n,k1}var C1,kN;function Fq(){if(kN)return C1;kN=1;var n=Xy(),e="__lodash_hash_undefined__",t=Object.prototype,r=t.hasOwnProperty;function i(s){var o=this.__data__;if(n){var l=o[s];return l===e?void 0:l}return r.call(o,s)?o[s]:void 0}return C1=i,C1}var P1,CN;function Vq(){if(CN)return P1;CN=1;var n=Xy(),e=Object.prototype,t=e.hasOwnProperty;function r(i){var s=this.__data__;return n?s[i]!==void 0:t.call(s,i)}return P1=r,P1}var R1,PN;function zq(){if(PN)return R1;PN=1;var n=Xy(),e="__lodash_hash_undefined__";function t(r,i){var s=this.__data__;return this.size+=this.has(r)?0:1,s[r]=n&&i===void 0?e:i,this}return R1=t,R1}var j1,RN;function Bq(){if(RN)return j1;RN=1;var n=Dq(),e=Lq(),t=Fq(),r=Vq(),i=zq();function s(o){var l=-1,d=o==null?0:o.length;for(this.clear();++l<d;){var f=o[l];this.set(f[0],f[1])}}return s.prototype.clear=n,s.prototype.delete=e,s.prototype.get=t,s.prototype.has=r,s.prototype.set=i,j1=s,j1}var O1,jN;function Uq(){if(jN)return O1;jN=1;var n=Bq(),e=Zy(),t=E2();function r(){this.size=0,this.__data__={hash:new n,map:new(t||e),string:new n}}return O1=r,O1}var M1,ON;function qq(){if(ON)return M1;ON=1;function n(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}return M1=n,M1}var D1,MN;function Jy(){if(MN)return D1;MN=1;var n=qq();function e(t,r){var i=t.__data__;return n(r)?i[typeof r=="string"?"string":"hash"]:i.map}return D1=e,D1}var L1,DN;function Hq(){if(DN)return L1;DN=1;var n=Jy();function e(t){var r=n(this,t).delete(t);return this.size-=r?1:0,r}return L1=e,L1}var F1,LN;function $q(){if(LN)return F1;LN=1;var n=Jy();function e(t){return n(this,t).get(t)}return F1=e,F1}var V1,FN;function Wq(){if(FN)return V1;FN=1;var n=Jy();function e(t){return n(this,t).has(t)}return V1=e,V1}var z1,VN;function Gq(){if(VN)return z1;VN=1;var n=Jy();function e(t,r){var i=n(this,t),s=i.size;return i.set(t,r),this.size+=i.size==s?0:1,this}return z1=e,z1}var B1,zN;function U3(){if(zN)return B1;zN=1;var n=Uq(),e=Hq(),t=$q(),r=Wq(),i=Gq();function s(o){var l=-1,d=o==null?0:o.length;for(this.clear();++l<d;){var f=o[l];this.set(f[0],f[1])}}return s.prototype.clear=n,s.prototype.delete=e,s.prototype.get=t,s.prototype.has=r,s.prototype.set=i,B1=s,B1}var U1,BN;function Kq(){if(BN)return U1;BN=1;var n=Zy(),e=E2(),t=U3(),r=200;function i(s,o){var l=this.__data__;if(l instanceof n){var d=l.__data__;if(!e||d.length<r-1)return d.push([s,o]),this.size=++l.size,this;l=this.__data__=new t(d)}return l.set(s,o),this.size=l.size,this}return U1=i,U1}var q1,UN;function Yq(){if(UN)return q1;UN=1;var n=Zy(),e=Aq(),t=Nq(),r=Iq(),i=kq(),s=Kq();function o(l){var d=this.__data__=new n(l);this.size=d.size}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=r,o.prototype.has=i,o.prototype.set=s,q1=o,q1}var H1,qN;function Zq(){if(qN)return H1;qN=1;var n="__lodash_hash_undefined__";function e(t){return this.__data__.set(t,n),this}return H1=e,H1}var $1,HN;function Qq(){if(HN)return $1;HN=1;function n(e){return this.__data__.has(e)}return $1=n,$1}var W1,$N;function Xq(){if($N)return W1;$N=1;var n=U3(),e=Zq(),t=Qq();function r(i){var s=-1,o=i==null?0:i.length;for(this.__data__=new n;++s<o;)this.add(i[s])}return r.prototype.add=r.prototype.push=e,r.prototype.has=t,W1=r,W1}var G1,WN;function Jq(){if(WN)return G1;WN=1;function n(e,t){for(var r=-1,i=e==null?0:e.length;++r<i;)if(t(e[r],r,e))return!0;return!1}return G1=n,G1}var K1,GN;function eH(){if(GN)return K1;GN=1;function n(e,t){return e.has(t)}return K1=n,K1}var Y1,KN;function q3(){if(KN)return Y1;KN=1;var n=Xq(),e=Jq(),t=eH(),r=1,i=2;function s(o,l,d,f,m,y){var g=d&r,_=o.length,E=l.length;if(_!=E&&!(g&&E>_))return!1;var x=y.get(o),w=y.get(l);if(x&&w)return x==l&&w==o;var S=-1,N=!0,P=d&i?new n:void 0;for(y.set(o,l),y.set(l,o);++S<_;){var I=o[S],R=l[S];if(f)var U=g?f(R,I,S,l,o,y):f(I,R,S,o,l,y);if(U!==void 0){if(U)continue;N=!1;break}if(P){if(!e(l,function(j,k){if(!t(P,k)&&(I===j||m(I,j,d,f,y)))return P.push(k)})){N=!1;break}}else if(!(I===R||m(I,R,d,f,y))){N=!1;break}}return y.delete(o),y.delete(l),N}return Y1=s,Y1}var Z1,YN;function tH(){if(YN)return Z1;YN=1;var n=Da(),e=n.Uint8Array;return Z1=e,Z1}var Q1,ZN;function nH(){if(ZN)return Q1;ZN=1;function n(e){var t=-1,r=Array(e.size);return e.forEach(function(i,s){r[++t]=[s,i]}),r}return Q1=n,Q1}var X1,QN;function rH(){if(QN)return X1;QN=1;function n(e){var t=-1,r=Array(e.size);return e.forEach(function(i){r[++t]=i}),r}return X1=n,X1}var J1,XN;function iH(){if(XN)return J1;XN=1;var n=w2(),e=tH(),t=L3(),r=q3(),i=nH(),s=rH(),o=1,l=2,d="[object Boolean]",f="[object Date]",m="[object Error]",y="[object Map]",g="[object Number]",_="[object RegExp]",E="[object Set]",x="[object String]",w="[object Symbol]",S="[object ArrayBuffer]",N="[object DataView]",P=n?n.prototype:void 0,I=P?P.valueOf:void 0;function R(U,j,k,F,O,C,D){switch(k){case N:if(U.byteLength!=j.byteLength||U.byteOffset!=j.byteOffset)return!1;U=U.buffer,j=j.buffer;case S:return!(U.byteLength!=j.byteLength||!C(new e(U),new e(j)));case d:case f:case g:return t(+U,+j);case m:return U.name==j.name&&U.message==j.message;case _:case x:return U==j+"";case y:var M=i;case E:var $=F&o;if(M||(M=s),U.size!=j.size&&!$)return!1;var G=D.get(U);if(G)return G==j;F|=l,D.set(U,j);var re=r(M(U),M(j),F,O,C,D);return D.delete(U),re;case w:if(I)return I.call(U)==I.call(j)}return!1}return J1=R,J1}var e_,JN;function sH(){if(JN)return e_;JN=1;function n(e,t){for(var r=-1,i=t.length,s=e.length;++r<i;)e[s+r]=t[r];return e}return e_=n,e_}var t_,eI;function T2(){if(eI)return t_;eI=1;var n=Array.isArray;return t_=n,t_}var n_,tI;function oH(){if(tI)return n_;tI=1;var n=sH(),e=T2();function t(r,i,s){var o=i(r);return e(r)?o:n(o,s(r))}return n_=t,n_}var r_,nI;function aH(){if(nI)return r_;nI=1;function n(e,t){for(var r=-1,i=e==null?0:e.length,s=0,o=[];++r<i;){var l=e[r];t(l,r,e)&&(o[s++]=l)}return o}return r_=n,r_}var i_,rI;function lH(){if(rI)return i_;rI=1;function n(){return[]}return i_=n,i_}var s_,iI;function cH(){if(iI)return s_;iI=1;var n=aH(),e=lH(),t=Object.prototype,r=t.propertyIsEnumerable,i=Object.getOwnPropertySymbols,s=i?function(o){return o==null?[]:(o=Object(o),n(i(o),function(l){return r.call(o,l)}))}:e;return s_=s,s_}var o_,sI;function uH(){if(sI)return o_;sI=1;function n(e,t){for(var r=-1,i=Array(e);++r<e;)i[r]=t(r);return i}return o_=n,o_}var a_,oI;function e0(){if(oI)return a_;oI=1;function n(e){return e!=null&&typeof e=="object"}return a_=n,a_}var l_,aI;function dH(){if(aI)return l_;aI=1;var n=Qy(),e=e0(),t="[object Arguments]";function r(i){return e(i)&&n(i)==t}return l_=r,l_}var c_,lI;function hH(){if(lI)return c_;lI=1;var n=dH(),e=e0(),t=Object.prototype,r=t.hasOwnProperty,i=t.propertyIsEnumerable,s=n(function(){return arguments}())?n:function(o){return e(o)&&r.call(o,"callee")&&!i.call(o,"callee")};return c_=s,c_}var nf={exports:{}},u_,cI;function fH(){if(cI)return u_;cI=1;function n(){return!1}return u_=n,u_}nf.exports;var uI;function H3(){return uI||(uI=1,function(n,e){var t=Da(),r=fH(),i=e&&!e.nodeType&&e,s=i&&!0&&n&&!n.nodeType&&n,o=s&&s.exports===i,l=o?t.Buffer:void 0,d=l?l.isBuffer:void 0,f=d||r;n.exports=f}(nf,nf.exports)),nf.exports}var d_,dI;function mH(){if(dI)return d_;dI=1;var n=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function t(r,i){var s=typeof r;return i=i??n,!!i&&(s=="number"||s!="symbol"&&e.test(r))&&r>-1&&r%1==0&&r<i}return d_=t,d_}var h_,hI;function $3(){if(hI)return h_;hI=1;var n=9007199254740991;function e(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=n}return h_=e,h_}var f_,fI;function pH(){if(fI)return f_;fI=1;var n=Qy(),e=$3(),t=e0(),r="[object Arguments]",i="[object Array]",s="[object Boolean]",o="[object Date]",l="[object Error]",d="[object Function]",f="[object Map]",m="[object Number]",y="[object Object]",g="[object RegExp]",_="[object Set]",E="[object String]",x="[object WeakMap]",w="[object ArrayBuffer]",S="[object DataView]",N="[object Float32Array]",P="[object Float64Array]",I="[object Int8Array]",R="[object Int16Array]",U="[object Int32Array]",j="[object Uint8Array]",k="[object Uint8ClampedArray]",F="[object Uint16Array]",O="[object Uint32Array]",C={};C[N]=C[P]=C[I]=C[R]=C[U]=C[j]=C[k]=C[F]=C[O]=!0,C[r]=C[i]=C[w]=C[s]=C[S]=C[o]=C[l]=C[d]=C[f]=C[m]=C[y]=C[g]=C[_]=C[E]=C[x]=!1;function D(M){return t(M)&&e(M.length)&&!!C[n(M)]}return f_=D,f_}var m_,mI;function gH(){if(mI)return m_;mI=1;function n(e){return function(t){return e(t)}}return m_=n,m_}var rf={exports:{}};rf.exports;var pI;function yH(){return pI||(pI=1,function(n,e){var t=F3(),r=e&&!e.nodeType&&e,i=r&&!0&&n&&!n.nodeType&&n,s=i&&i.exports===r,o=s&&t.process,l=function(){try{var d=i&&i.require&&i.require("util").types;return d||o&&o.binding&&o.binding("util")}catch{}}();n.exports=l}(rf,rf.exports)),rf.exports}var p_,gI;function W3(){if(gI)return p_;gI=1;var n=pH(),e=gH(),t=yH(),r=t&&t.isTypedArray,i=r?e(r):n;return p_=i,p_}var g_,yI;function vH(){if(yI)return g_;yI=1;var n=uH(),e=hH(),t=T2(),r=H3(),i=mH(),s=W3(),o=Object.prototype,l=o.hasOwnProperty;function d(f,m){var y=t(f),g=!y&&e(f),_=!y&&!g&&r(f),E=!y&&!g&&!_&&s(f),x=y||g||_||E,w=x?n(f.length,String):[],S=w.length;for(var N in f)(m||l.call(f,N))&&!(x&&(N=="length"||_&&(N=="offset"||N=="parent")||E&&(N=="buffer"||N=="byteLength"||N=="byteOffset")||i(N,S)))&&w.push(N);return w}return g_=d,g_}var y_,vI;function _H(){if(vI)return y_;vI=1;var n=Object.prototype;function e(t){var r=t&&t.constructor,i=typeof r=="function"&&r.prototype||n;return t===i}return y_=e,y_}var v_,_I;function xH(){if(_I)return v_;_I=1;function n(e,t){return function(r){return e(t(r))}}return v_=n,v_}var __,xI;function bH(){if(xI)return __;xI=1;var n=xH(),e=n(Object.keys,Object);return __=e,__}var x_,bI;function wH(){if(bI)return x_;bI=1;var n=_H(),e=bH(),t=Object.prototype,r=t.hasOwnProperty;function i(s){if(!n(s))return e(s);var o=[];for(var l in Object(s))r.call(s,l)&&l!="constructor"&&o.push(l);return o}return x_=i,x_}var b_,wI;function EH(){if(wI)return b_;wI=1;var n=z3(),e=$3();function t(r){return r!=null&&e(r.length)&&!n(r)}return b_=t,b_}var w_,EI;function TH(){if(EI)return w_;EI=1;var n=vH(),e=wH(),t=EH();function r(i){return t(i)?n(i):e(i)}return w_=r,w_}var E_,TI;function SH(){if(TI)return E_;TI=1;var n=oH(),e=cH(),t=TH();function r(i){return n(i,t,e)}return E_=r,E_}var T_,SI;function AH(){if(SI)return T_;SI=1;var n=SH(),e=1,t=Object.prototype,r=t.hasOwnProperty;function i(s,o,l,d,f,m){var y=l&e,g=n(s),_=g.length,E=n(o),x=E.length;if(_!=x&&!y)return!1;for(var w=_;w--;){var S=g[w];if(!(y?S in o:r.call(o,S)))return!1}var N=m.get(s),P=m.get(o);if(N&&P)return N==o&&P==s;var I=!0;m.set(s,o),m.set(o,s);for(var R=y;++w<_;){S=g[w];var U=s[S],j=o[S];if(d)var k=y?d(j,U,S,o,s,m):d(U,j,S,s,o,m);if(!(k===void 0?U===j||f(U,j,l,d,m):k)){I=!1;break}R||(R=S=="constructor")}if(I&&!R){var F=s.constructor,O=o.constructor;F!=O&&"constructor"in s&&"constructor"in o&&!(typeof F=="function"&&F instanceof F&&typeof O=="function"&&O instanceof O)&&(I=!1)}return m.delete(s),m.delete(o),I}return T_=i,T_}var S_,AI;function NH(){if(AI)return S_;AI=1;var n=$d(),e=Da(),t=n(e,"DataView");return S_=t,S_}var A_,NI;function IH(){if(NI)return A_;NI=1;var n=$d(),e=Da(),t=n(e,"Promise");return A_=t,A_}var N_,II;function kH(){if(II)return N_;II=1;var n=$d(),e=Da(),t=n(e,"Set");return N_=t,N_}var I_,kI;function CH(){if(kI)return I_;kI=1;var n=$d(),e=Da(),t=n(e,"WeakMap");return I_=t,I_}var k_,CI;function PH(){if(CI)return k_;CI=1;var n=NH(),e=E2(),t=IH(),r=kH(),i=CH(),s=Qy(),o=B3(),l="[object Map]",d="[object Object]",f="[object Promise]",m="[object Set]",y="[object WeakMap]",g="[object DataView]",_=o(n),E=o(e),x=o(t),w=o(r),S=o(i),N=s;return(n&&N(new n(new ArrayBuffer(1)))!=g||e&&N(new e)!=l||t&&N(t.resolve())!=f||r&&N(new r)!=m||i&&N(new i)!=y)&&(N=function(P){var I=s(P),R=I==d?P.constructor:void 0,U=R?o(R):"";if(U)switch(U){case _:return g;case E:return l;case x:return f;case w:return m;case S:return y}return I}),k_=N,k_}var C_,PI;function RH(){if(PI)return C_;PI=1;var n=Yq(),e=q3(),t=iH(),r=AH(),i=PH(),s=T2(),o=H3(),l=W3(),d=1,f="[object Arguments]",m="[object Array]",y="[object Object]",g=Object.prototype,_=g.hasOwnProperty;function E(x,w,S,N,P,I){var R=s(x),U=s(w),j=R?m:i(x),k=U?m:i(w);j=j==f?y:j,k=k==f?y:k;var F=j==y,O=k==y,C=j==k;if(C&&o(x)){if(!o(w))return!1;R=!0,F=!1}if(C&&!F)return I||(I=new n),R||l(x)?e(x,w,S,N,P,I):t(x,w,j,S,N,P,I);if(!(S&d)){var D=F&&_.call(x,"__wrapped__"),M=O&&_.call(w,"__wrapped__");if(D||M){var $=D?x.value():x,G=M?w.value():w;return I||(I=new n),P($,G,S,N,I)}}return C?(I||(I=new n),r(x,w,S,N,P,I)):!1}return C_=E,C_}var P_,RI;function jH(){if(RI)return P_;RI=1;var n=RH(),e=e0();function t(r,i,s,o,l){return r===i?!0:r==null||i==null||!e(r)&&!e(i)?r!==r&&i!==i:n(r,i,s,o,t,l)}return P_=t,P_}var R_,jI;function OH(){if(jI)return R_;jI=1;var n=jH();function e(t,r){return n(t,r)}return R_=e,R_}var gg={exports:{}};/*!
 * Quill Editor v1.3.7
 * https://quilljs.com/
 * Copyright (c) 2014, Jason Chen
 * Copyright (c) 2013, salesforce.com
 */var MH=gg.exports,OI;function DH(){return OI||(OI=1,function(n,e){(function(r,i){n.exports=i()})(typeof self<"u"?self:MH,function(){return function(t){var r={};function i(s){if(r[s])return r[s].exports;var o=r[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=r,i.d=function(s,o,l){i.o(s,o)||Object.defineProperty(s,o,{configurable:!1,enumerable:!0,get:l})},i.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return i.d(o,"a",o),o},i.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},i.p="",i(i.s=109)}([function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=i(17),o=i(18),l=i(19),d=i(45),f=i(46),m=i(47),y=i(48),g=i(49),_=i(12),E=i(32),x=i(33),w=i(31),S=i(1),N={Scope:S.Scope,create:S.create,find:S.find,query:S.query,register:S.register,Container:s.default,Format:o.default,Leaf:l.default,Embed:y.default,Scroll:d.default,Block:m.default,Inline:f.default,Text:g.default,Attributor:{Attribute:_.default,Class:E.default,Style:x.default,Store:w.default}};r.default=N},function(t,r,i){var s=this&&this.__extends||function(){var w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(S,N){S.__proto__=N}||function(S,N){for(var P in N)N.hasOwnProperty(P)&&(S[P]=N[P])};return function(S,N){w(S,N);function P(){this.constructor=S}S.prototype=N===null?Object.create(N):(P.prototype=N.prototype,new P)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=function(w){s(S,w);function S(N){var P=this;return N="[Parchment] "+N,P=w.call(this,N)||this,P.message=N,P.name=P.constructor.name,P}return S}(Error);r.ParchmentError=o;var l={},d={},f={},m={};r.DATA_KEY="__blot";var y;(function(w){w[w.TYPE=3]="TYPE",w[w.LEVEL=12]="LEVEL",w[w.ATTRIBUTE=13]="ATTRIBUTE",w[w.BLOT=14]="BLOT",w[w.INLINE=7]="INLINE",w[w.BLOCK=11]="BLOCK",w[w.BLOCK_BLOT=10]="BLOCK_BLOT",w[w.INLINE_BLOT=6]="INLINE_BLOT",w[w.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",w[w.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",w[w.ANY=15]="ANY"})(y=r.Scope||(r.Scope={}));function g(w,S){var N=E(w);if(N==null)throw new o("Unable to create "+w+" blot");var P=N,I=w instanceof Node||w.nodeType===Node.TEXT_NODE?w:P.create(S);return new P(I,S)}r.create=g;function _(w,S){return S===void 0&&(S=!1),w==null?null:w[r.DATA_KEY]!=null?w[r.DATA_KEY].blot:S?_(w.parentNode,S):null}r.find=_;function E(w,S){S===void 0&&(S=y.ANY);var N;if(typeof w=="string")N=m[w]||l[w];else if(w instanceof Text||w.nodeType===Node.TEXT_NODE)N=m.text;else if(typeof w=="number")w&y.LEVEL&y.BLOCK?N=m.block:w&y.LEVEL&y.INLINE&&(N=m.inline);else if(w instanceof HTMLElement){var P=(w.getAttribute("class")||"").split(/\s+/);for(var I in P)if(N=d[P[I]],N)break;N=N||f[w.tagName]}return N==null?null:S&y.LEVEL&N.scope&&S&y.TYPE&N.scope?N:null}r.query=E;function x(){for(var w=[],S=0;S<arguments.length;S++)w[S]=arguments[S];if(w.length>1)return w.map(function(I){return x(I)});var N=w[0];if(typeof N.blotName!="string"&&typeof N.attrName!="string")throw new o("Invalid definition");if(N.blotName==="abstract")throw new o("Cannot register abstract class");if(m[N.blotName||N.attrName]=N,typeof N.keyName=="string")l[N.keyName]=N;else if(N.className!=null&&(d[N.className]=N),N.tagName!=null){Array.isArray(N.tagName)?N.tagName=N.tagName.map(function(I){return I.toUpperCase()}):N.tagName=N.tagName.toUpperCase();var P=Array.isArray(N.tagName)?N.tagName:[N.tagName];P.forEach(function(I){(f[I]==null||N.className==null)&&(f[I]=N)})}return N}r.register=x},function(t,r,i){var s=i(51),o=i(11),l=i(3),d=i(20),f="\0",m=function(y){Array.isArray(y)?this.ops=y:y!=null&&Array.isArray(y.ops)?this.ops=y.ops:this.ops=[]};m.prototype.insert=function(y,g){var _={};return y.length===0?this:(_.insert=y,g!=null&&typeof g=="object"&&Object.keys(g).length>0&&(_.attributes=g),this.push(_))},m.prototype.delete=function(y){return y<=0?this:this.push({delete:y})},m.prototype.retain=function(y,g){if(y<=0)return this;var _={retain:y};return g!=null&&typeof g=="object"&&Object.keys(g).length>0&&(_.attributes=g),this.push(_)},m.prototype.push=function(y){var g=this.ops.length,_=this.ops[g-1];if(y=l(!0,{},y),typeof _=="object"){if(typeof y.delete=="number"&&typeof _.delete=="number")return this.ops[g-1]={delete:_.delete+y.delete},this;if(typeof _.delete=="number"&&y.insert!=null&&(g-=1,_=this.ops[g-1],typeof _!="object"))return this.ops.unshift(y),this;if(o(y.attributes,_.attributes)){if(typeof y.insert=="string"&&typeof _.insert=="string")return this.ops[g-1]={insert:_.insert+y.insert},typeof y.attributes=="object"&&(this.ops[g-1].attributes=y.attributes),this;if(typeof y.retain=="number"&&typeof _.retain=="number")return this.ops[g-1]={retain:_.retain+y.retain},typeof y.attributes=="object"&&(this.ops[g-1].attributes=y.attributes),this}}return g===this.ops.length?this.ops.push(y):this.ops.splice(g,0,y),this},m.prototype.chop=function(){var y=this.ops[this.ops.length-1];return y&&y.retain&&!y.attributes&&this.ops.pop(),this},m.prototype.filter=function(y){return this.ops.filter(y)},m.prototype.forEach=function(y){this.ops.forEach(y)},m.prototype.map=function(y){return this.ops.map(y)},m.prototype.partition=function(y){var g=[],_=[];return this.forEach(function(E){var x=y(E)?g:_;x.push(E)}),[g,_]},m.prototype.reduce=function(y,g){return this.ops.reduce(y,g)},m.prototype.changeLength=function(){return this.reduce(function(y,g){return g.insert?y+d.length(g):g.delete?y-g.delete:y},0)},m.prototype.length=function(){return this.reduce(function(y,g){return y+d.length(g)},0)},m.prototype.slice=function(y,g){y=y||0,typeof g!="number"&&(g=1/0);for(var _=[],E=d.iterator(this.ops),x=0;x<g&&E.hasNext();){var w;x<y?w=E.next(y-x):(w=E.next(g-x),_.push(w)),x+=d.length(w)}return new m(_)},m.prototype.compose=function(y){var g=d.iterator(this.ops),_=d.iterator(y.ops),E=[],x=_.peek();if(x!=null&&typeof x.retain=="number"&&x.attributes==null){for(var w=x.retain;g.peekType()==="insert"&&g.peekLength()<=w;)w-=g.peekLength(),E.push(g.next());x.retain-w>0&&_.next(x.retain-w)}for(var S=new m(E);g.hasNext()||_.hasNext();)if(_.peekType()==="insert")S.push(_.next());else if(g.peekType()==="delete")S.push(g.next());else{var N=Math.min(g.peekLength(),_.peekLength()),P=g.next(N),I=_.next(N);if(typeof I.retain=="number"){var R={};typeof P.retain=="number"?R.retain=N:R.insert=P.insert;var U=d.attributes.compose(P.attributes,I.attributes,typeof P.retain=="number");if(U&&(R.attributes=U),S.push(R),!_.hasNext()&&o(S.ops[S.ops.length-1],R)){var j=new m(g.rest());return S.concat(j).chop()}}else typeof I.delete=="number"&&typeof P.retain=="number"&&S.push(I)}return S.chop()},m.prototype.concat=function(y){var g=new m(this.ops.slice());return y.ops.length>0&&(g.push(y.ops[0]),g.ops=g.ops.concat(y.ops.slice(1))),g},m.prototype.diff=function(y,g){if(this.ops===y.ops)return new m;var _=[this,y].map(function(N){return N.map(function(P){if(P.insert!=null)return typeof P.insert=="string"?P.insert:f;var I=N===y?"on":"with";throw new Error("diff() called "+I+" non-document")}).join("")}),E=new m,x=s(_[0],_[1],g),w=d.iterator(this.ops),S=d.iterator(y.ops);return x.forEach(function(N){for(var P=N[1].length;P>0;){var I=0;switch(N[0]){case s.INSERT:I=Math.min(S.peekLength(),P),E.push(S.next(I));break;case s.DELETE:I=Math.min(P,w.peekLength()),w.next(I),E.delete(I);break;case s.EQUAL:I=Math.min(w.peekLength(),S.peekLength(),P);var R=w.next(I),U=S.next(I);o(R.insert,U.insert)?E.retain(I,d.attributes.diff(R.attributes,U.attributes)):E.push(U).delete(I);break}P-=I}}),E.chop()},m.prototype.eachLine=function(y,g){g=g||`
`;for(var _=d.iterator(this.ops),E=new m,x=0;_.hasNext();){if(_.peekType()!=="insert")return;var w=_.peek(),S=d.length(w)-_.peekLength(),N=typeof w.insert=="string"?w.insert.indexOf(g,S)-S:-1;if(N<0)E.push(_.next());else if(N>0)E.push(_.next(N));else{if(y(E,_.next(1).attributes||{},x)===!1)return;x+=1,E=new m}}E.length()>0&&y(E,{},x)},m.prototype.transform=function(y,g){if(g=!!g,typeof y=="number")return this.transformPosition(y,g);for(var _=d.iterator(this.ops),E=d.iterator(y.ops),x=new m;_.hasNext()||E.hasNext();)if(_.peekType()==="insert"&&(g||E.peekType()!=="insert"))x.retain(d.length(_.next()));else if(E.peekType()==="insert")x.push(E.next());else{var w=Math.min(_.peekLength(),E.peekLength()),S=_.next(w),N=E.next(w);if(S.delete)continue;N.delete?x.push(N):x.retain(w,d.attributes.transform(S.attributes,N.attributes,g))}return x.chop()},m.prototype.transformPosition=function(y,g){g=!!g;for(var _=d.iterator(this.ops),E=0;_.hasNext()&&E<=y;){var x=_.peekLength(),w=_.peekType();if(_.next(),w==="delete"){y-=Math.min(x,y-E);continue}else w==="insert"&&(E<y||!g)&&(y+=x);E+=x}return y},t.exports=m},function(t,r){var i=Object.prototype.hasOwnProperty,s=Object.prototype.toString,o=Object.defineProperty,l=Object.getOwnPropertyDescriptor,d=function(_){return typeof Array.isArray=="function"?Array.isArray(_):s.call(_)==="[object Array]"},f=function(_){if(!_||s.call(_)!=="[object Object]")return!1;var E=i.call(_,"constructor"),x=_.constructor&&_.constructor.prototype&&i.call(_.constructor.prototype,"isPrototypeOf");if(_.constructor&&!E&&!x)return!1;var w;for(w in _);return typeof w>"u"||i.call(_,w)},m=function(_,E){o&&E.name==="__proto__"?o(_,E.name,{enumerable:!0,configurable:!0,value:E.newValue,writable:!0}):_[E.name]=E.newValue},y=function(_,E){if(E==="__proto__")if(i.call(_,E)){if(l)return l(_,E).value}else return;return _[E]};t.exports=function g(){var _,E,x,w,S,N,P=arguments[0],I=1,R=arguments.length,U=!1;for(typeof P=="boolean"&&(U=P,P=arguments[1]||{},I=2),(P==null||typeof P!="object"&&typeof P!="function")&&(P={});I<R;++I)if(_=arguments[I],_!=null)for(E in _)x=y(P,E),w=y(_,E),P!==w&&(U&&w&&(f(w)||(S=d(w)))?(S?(S=!1,N=x&&d(x)?x:[]):N=x&&f(x)?x:{},m(P,{name:E,newValue:g(U,N,w)})):typeof w<"u"&&m(P,{name:E,newValue:w}));return P}},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.BlockEmbed=r.bubbleFormats=void 0;var s=function(){function C(D,M){for(var $=0;$<M.length;$++){var G=M[$];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(D,G.key,G)}}return function(D,M,$){return M&&C(D.prototype,M),$&&C(D,$),D}}(),o=function C(D,M,$){D===null&&(D=Function.prototype);var G=Object.getOwnPropertyDescriptor(D,M);if(G===void 0){var re=Object.getPrototypeOf(D);return re===null?void 0:C(re,M,$)}else{if("value"in G)return G.value;var oe=G.get;return oe===void 0?void 0:oe.call($)}},l=i(3),d=P(l),f=i(2),m=P(f),y=i(0),g=P(y),_=i(16),E=P(_),x=i(6),w=P(x),S=i(7),N=P(S);function P(C){return C&&C.__esModule?C:{default:C}}function I(C,D){if(!(C instanceof D))throw new TypeError("Cannot call a class as a function")}function R(C,D){if(!C)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D&&(typeof D=="object"||typeof D=="function")?D:C}function U(C,D){if(typeof D!="function"&&D!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof D);C.prototype=Object.create(D&&D.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),D&&(Object.setPrototypeOf?Object.setPrototypeOf(C,D):C.__proto__=D)}var j=1,k=function(C){U(D,C);function D(){return I(this,D),R(this,(D.__proto__||Object.getPrototypeOf(D)).apply(this,arguments))}return s(D,[{key:"attach",value:function(){o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"attach",this).call(this),this.attributes=new g.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return new m.default().insert(this.value(),(0,d.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function($,G){var re=g.default.query($,g.default.Scope.BLOCK_ATTRIBUTE);re!=null&&this.attributes.attribute(re,G)}},{key:"formatAt",value:function($,G,re,oe){this.format(re,oe)}},{key:"insertAt",value:function($,G,re){if(typeof G=="string"&&G.endsWith(`
`)){var oe=g.default.create(F.blotName);this.parent.insertBefore(oe,$===0?this:this.next),oe.insertAt(0,G.slice(0,-1))}else o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"insertAt",this).call(this,$,G,re)}}]),D}(g.default.Embed);k.scope=g.default.Scope.BLOCK_BLOT;var F=function(C){U(D,C);function D(M){I(this,D);var $=R(this,(D.__proto__||Object.getPrototypeOf(D)).call(this,M));return $.cache={},$}return s(D,[{key:"delta",value:function(){return this.cache.delta==null&&(this.cache.delta=this.descendants(g.default.Leaf).reduce(function($,G){return G.length()===0?$:$.insert(G.value(),O(G))},new m.default).insert(`
`,O(this))),this.cache.delta}},{key:"deleteAt",value:function($,G){o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"deleteAt",this).call(this,$,G),this.cache={}}},{key:"formatAt",value:function($,G,re,oe){G<=0||(g.default.query(re,g.default.Scope.BLOCK)?$+G===this.length()&&this.format(re,oe):o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"formatAt",this).call(this,$,Math.min(G,this.length()-$-1),re,oe),this.cache={})}},{key:"insertAt",value:function($,G,re){if(re!=null)return o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"insertAt",this).call(this,$,G,re);if(G.length!==0){var oe=G.split(`
`),ie=oe.shift();ie.length>0&&($<this.length()-1||this.children.tail==null?o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"insertAt",this).call(this,Math.min($,this.length()-1),ie):this.children.tail.insertAt(this.children.tail.length(),ie),this.cache={});var X=this;oe.reduce(function(Y,B){return X=X.split(Y,!0),X.insertAt(0,B),B.length},$+ie.length)}}},{key:"insertBefore",value:function($,G){var re=this.children.head;o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"insertBefore",this).call(this,$,G),re instanceof E.default&&re.remove(),this.cache={}}},{key:"length",value:function(){return this.cache.length==null&&(this.cache.length=o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"length",this).call(this)+j),this.cache.length}},{key:"moveChildren",value:function($,G){o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"moveChildren",this).call(this,$,G),this.cache={}}},{key:"optimize",value:function($){o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"optimize",this).call(this,$),this.cache={}}},{key:"path",value:function($){return o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"path",this).call(this,$,!0)}},{key:"removeChild",value:function($){o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"removeChild",this).call(this,$),this.cache={}}},{key:"split",value:function($){var G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(G&&($===0||$>=this.length()-j)){var re=this.clone();return $===0?(this.parent.insertBefore(re,this),this):(this.parent.insertBefore(re,this.next),re)}else{var oe=o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"split",this).call(this,$,G);return this.cache={},oe}}}]),D}(g.default.Block);F.blotName="block",F.tagName="P",F.defaultChild="break",F.allowedChildren=[w.default,g.default.Embed,N.default];function O(C){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return C==null||(typeof C.formats=="function"&&(D=(0,d.default)(D,C.formats())),C.parent==null||C.parent.blotName=="scroll"||C.parent.statics.scope!==C.statics.scope)?D:O(C.parent,D)}r.bubbleFormats=O,r.BlockEmbed=k,r.default=F},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.overload=r.expandConfig=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(X){return typeof X}:function(X){return X&&typeof Symbol=="function"&&X.constructor===Symbol&&X!==Symbol.prototype?"symbol":typeof X},o=function(){function X(Y,B){var Z=[],te=!0,se=!1,ae=void 0;try{for(var Q=Y[Symbol.iterator](),ce;!(te=(ce=Q.next()).done)&&(Z.push(ce.value),!(B&&Z.length===B));te=!0);}catch(me){se=!0,ae=me}finally{try{!te&&Q.return&&Q.return()}finally{if(se)throw ae}}return Z}return function(Y,B){if(Array.isArray(Y))return Y;if(Symbol.iterator in Object(Y))return X(Y,B);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function X(Y,B){for(var Z=0;Z<B.length;Z++){var te=B[Z];te.enumerable=te.enumerable||!1,te.configurable=!0,"value"in te&&(te.writable=!0),Object.defineProperty(Y,te.key,te)}}return function(Y,B,Z){return B&&X(Y.prototype,B),Z&&X(Y,Z),Y}}();i(50);var d=i(2),f=O(d),m=i(14),y=O(m),g=i(8),_=O(g),E=i(9),x=O(E),w=i(0),S=O(w),N=i(15),P=O(N),I=i(3),R=O(I),U=i(10),j=O(U),k=i(34),F=O(k);function O(X){return X&&X.__esModule?X:{default:X}}function C(X,Y,B){return Y in X?Object.defineProperty(X,Y,{value:B,enumerable:!0,configurable:!0,writable:!0}):X[Y]=B,X}function D(X,Y){if(!(X instanceof Y))throw new TypeError("Cannot call a class as a function")}var M=(0,j.default)("quill"),$=function(){l(X,null,[{key:"debug",value:function(B){B===!0&&(B="log"),j.default.level(B)}},{key:"find",value:function(B){return B.__quill||S.default.find(B)}},{key:"import",value:function(B){return this.imports[B]==null&&M.error("Cannot import "+B+". Are you sure it was registered?"),this.imports[B]}},{key:"register",value:function(B,Z){var te=this,se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof B!="string"){var ae=B.attrName||B.blotName;typeof ae=="string"?this.register("formats/"+ae,B,Z):Object.keys(B).forEach(function(Q){te.register(Q,B[Q],Z)})}else this.imports[B]!=null&&!se&&M.warn("Overwriting "+B+" with",Z),this.imports[B]=Z,(B.startsWith("blots/")||B.startsWith("formats/"))&&Z.blotName!=="abstract"?S.default.register(Z):B.startsWith("modules")&&typeof Z.register=="function"&&Z.register()}}]);function X(Y){var B=this,Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(D(this,X),this.options=G(Y,Z),this.container=this.options.container,this.container==null)return M.error("Invalid Quill container",Y);this.options.debug&&X.debug(this.options.debug);var te=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new _.default,this.scroll=S.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new y.default(this.scroll),this.selection=new P.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(_.default.events.EDITOR_CHANGE,function(ae){ae===_.default.events.TEXT_CHANGE&&B.root.classList.toggle("ql-blank",B.editor.isBlank())}),this.emitter.on(_.default.events.SCROLL_UPDATE,function(ae,Q){var ce=B.selection.lastRange,me=ce&&ce.length===0?ce.index:void 0;re.call(B,function(){return B.editor.update(null,Q,me)},ae)});var se=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">`+te+"<p><br></p></div>");this.setContents(se),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return l(X,[{key:"addContainer",value:function(B){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof B=="string"){var te=B;B=document.createElement("div"),B.classList.add(te)}return this.container.insertBefore(B,Z),B}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(B,Z,te){var se=this,ae=oe(B,Z,te),Q=o(ae,4);return B=Q[0],Z=Q[1],te=Q[3],re.call(this,function(){return se.editor.deleteText(B,Z)},te,B,-1*Z)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(B),this.container.classList.toggle("ql-disabled",!B)}},{key:"focus",value:function(){var B=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=B,this.scrollIntoView()}},{key:"format",value:function(B,Z){var te=this,se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_.default.sources.API;return re.call(this,function(){var ae=te.getSelection(!0),Q=new f.default;if(ae==null)return Q;if(S.default.query(B,S.default.Scope.BLOCK))Q=te.editor.formatLine(ae.index,ae.length,C({},B,Z));else{if(ae.length===0)return te.selection.format(B,Z),Q;Q=te.editor.formatText(ae.index,ae.length,C({},B,Z))}return te.setSelection(ae,_.default.sources.SILENT),Q},se)}},{key:"formatLine",value:function(B,Z,te,se,ae){var Q=this,ce=void 0,me=oe(B,Z,te,se,ae),ge=o(me,4);return B=ge[0],Z=ge[1],ce=ge[2],ae=ge[3],re.call(this,function(){return Q.editor.formatLine(B,Z,ce)},ae,B,0)}},{key:"formatText",value:function(B,Z,te,se,ae){var Q=this,ce=void 0,me=oe(B,Z,te,se,ae),ge=o(me,4);return B=ge[0],Z=ge[1],ce=ge[2],ae=ge[3],re.call(this,function(){return Q.editor.formatText(B,Z,ce)},ae,B,0)}},{key:"getBounds",value:function(B){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,te=void 0;typeof B=="number"?te=this.selection.getBounds(B,Z):te=this.selection.getBounds(B.index,B.length);var se=this.container.getBoundingClientRect();return{bottom:te.bottom-se.top,height:te.height,left:te.left-se.left,right:te.right-se.left,top:te.top-se.top,width:te.width}}},{key:"getContents",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-B,te=oe(B,Z),se=o(te,2);return B=se[0],Z=se[1],this.editor.getContents(B,Z)}},{key:"getFormat",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof B=="number"?this.editor.getFormat(B,Z):this.editor.getFormat(B.index,B.length)}},{key:"getIndex",value:function(B){return B.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(B){return this.scroll.leaf(B)}},{key:"getLine",value:function(B){return this.scroll.line(B)}},{key:"getLines",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof B!="number"?this.scroll.lines(B.index,B.length):this.scroll.lines(B,Z)}},{key:"getModule",value:function(B){return this.theme.modules[B]}},{key:"getSelection",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return B&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-B,te=oe(B,Z),se=o(te,2);return B=se[0],Z=se[1],this.editor.getText(B,Z)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(B,Z,te){var se=this,ae=arguments.length>3&&arguments[3]!==void 0?arguments[3]:X.sources.API;return re.call(this,function(){return se.editor.insertEmbed(B,Z,te)},ae,B)}},{key:"insertText",value:function(B,Z,te,se,ae){var Q=this,ce=void 0,me=oe(B,0,te,se,ae),ge=o(me,4);return B=ge[0],ce=ge[2],ae=ge[3],re.call(this,function(){return Q.editor.insertText(B,Z,ce)},ae,B,Z.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(B,Z,te){this.clipboard.dangerouslyPasteHTML(B,Z,te)}},{key:"removeFormat",value:function(B,Z,te){var se=this,ae=oe(B,Z,te),Q=o(ae,4);return B=Q[0],Z=Q[1],te=Q[3],re.call(this,function(){return se.editor.removeFormat(B,Z)},te,B)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(B){var Z=this,te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.default.sources.API;return re.call(this,function(){B=new f.default(B);var se=Z.getLength(),ae=Z.editor.deleteText(0,se),Q=Z.editor.applyDelta(B),ce=Q.ops[Q.ops.length-1];ce!=null&&typeof ce.insert=="string"&&ce.insert[ce.insert.length-1]===`
`&&(Z.editor.deleteText(Z.getLength()-1,1),Q.delete(1));var me=ae.compose(Q);return me},te)}},{key:"setSelection",value:function(B,Z,te){if(B==null)this.selection.setRange(null,Z||X.sources.API);else{var se=oe(B,Z,te),ae=o(se,4);B=ae[0],Z=ae[1],te=ae[3],this.selection.setRange(new N.Range(B,Z),te),te!==_.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(B){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.default.sources.API,te=new f.default().insert(B);return this.setContents(te,Z)}},{key:"update",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_.default.sources.USER,Z=this.scroll.update(B);return this.selection.update(B),Z}},{key:"updateContents",value:function(B){var Z=this,te=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.default.sources.API;return re.call(this,function(){return B=new f.default(B),Z.editor.applyDelta(B,te)},te,!0)}}]),X}();$.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},$.events=_.default.events,$.sources=_.default.sources,$.version="1.3.7",$.imports={delta:f.default,parchment:S.default,"core/module":x.default,"core/theme":F.default};function G(X,Y){if(Y=(0,R.default)(!0,{container:X,modules:{clipboard:!0,keyboard:!0,history:!0}},Y),!Y.theme||Y.theme===$.DEFAULTS.theme)Y.theme=F.default;else if(Y.theme=$.import("themes/"+Y.theme),Y.theme==null)throw new Error("Invalid theme "+Y.theme+". Did you register it?");var B=(0,R.default)(!0,{},Y.theme.DEFAULTS);[B,Y].forEach(function(se){se.modules=se.modules||{},Object.keys(se.modules).forEach(function(ae){se.modules[ae]===!0&&(se.modules[ae]={})})});var Z=Object.keys(B.modules).concat(Object.keys(Y.modules)),te=Z.reduce(function(se,ae){var Q=$.import("modules/"+ae);return Q==null?M.error("Cannot load "+ae+" module. Are you sure you registered it?"):se[ae]=Q.DEFAULTS||{},se},{});return Y.modules!=null&&Y.modules.toolbar&&Y.modules.toolbar.constructor!==Object&&(Y.modules.toolbar={container:Y.modules.toolbar}),Y=(0,R.default)(!0,{},$.DEFAULTS,{modules:te},B,Y),["bounds","container","scrollingContainer"].forEach(function(se){typeof Y[se]=="string"&&(Y[se]=document.querySelector(Y[se]))}),Y.modules=Object.keys(Y.modules).reduce(function(se,ae){return Y.modules[ae]&&(se[ae]=Y.modules[ae]),se},{}),Y}function re(X,Y,B,Z){if(this.options.strict&&!this.isEnabled()&&Y===_.default.sources.USER)return new f.default;var te=B==null?null:this.getSelection(),se=this.editor.delta,ae=X();if(te!=null&&(B===!0&&(B=te.index),Z==null?te=ie(te,ae,Y):Z!==0&&(te=ie(te,B,Z,Y)),this.setSelection(te,_.default.sources.SILENT)),ae.length()>0){var Q,ce=[_.default.events.TEXT_CHANGE,ae,se,Y];if((Q=this.emitter).emit.apply(Q,[_.default.events.EDITOR_CHANGE].concat(ce)),Y!==_.default.sources.SILENT){var me;(me=this.emitter).emit.apply(me,ce)}}return ae}function oe(X,Y,B,Z,te){var se={};return typeof X.index=="number"&&typeof X.length=="number"?typeof Y!="number"?(te=Z,Z=B,B=Y,Y=X.length,X=X.index):(Y=X.length,X=X.index):typeof Y!="number"&&(te=Z,Z=B,B=Y,Y=0),(typeof B>"u"?"undefined":s(B))==="object"?(se=B,te=Z):typeof B=="string"&&(Z!=null?se[B]=Z:te=B),te=te||_.default.sources.API,[X,Y,se,te]}function ie(X,Y,B,Z){if(X==null)return null;var te=void 0,se=void 0;if(Y instanceof f.default){var ae=[X.index,X.index+X.length].map(function(ge){return Y.transformPosition(ge,Z!==_.default.sources.USER)}),Q=o(ae,2);te=Q[0],se=Q[1]}else{var ce=[X.index,X.index+X.length].map(function(ge){return ge<Y||ge===Y&&Z===_.default.sources.USER?ge:B>=0?ge+B:Math.max(Y,ge+B)}),me=o(ce,2);te=me[0],se=me[1]}return new N.Range(te,se-te)}r.expandConfig=G,r.overload=oe,r.default=$},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function w(S,N){for(var P=0;P<N.length;P++){var I=N[P];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(S,I.key,I)}}return function(S,N,P){return N&&w(S.prototype,N),P&&w(S,P),S}}(),o=function w(S,N,P){S===null&&(S=Function.prototype);var I=Object.getOwnPropertyDescriptor(S,N);if(I===void 0){var R=Object.getPrototypeOf(S);return R===null?void 0:w(R,N,P)}else{if("value"in I)return I.value;var U=I.get;return U===void 0?void 0:U.call(P)}},l=i(7),d=y(l),f=i(0),m=y(f);function y(w){return w&&w.__esModule?w:{default:w}}function g(w,S){if(!(w instanceof S))throw new TypeError("Cannot call a class as a function")}function _(w,S){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:w}function E(w,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);w.prototype=Object.create(S&&S.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(w,S):w.__proto__=S)}var x=function(w){E(S,w);function S(){return g(this,S),_(this,(S.__proto__||Object.getPrototypeOf(S)).apply(this,arguments))}return s(S,[{key:"formatAt",value:function(P,I,R,U){if(S.compare(this.statics.blotName,R)<0&&m.default.query(R,m.default.Scope.BLOT)){var j=this.isolate(P,I);U&&j.wrap(R,U)}else o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"formatAt",this).call(this,P,I,R,U)}},{key:"optimize",value:function(P){if(o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"optimize",this).call(this,P),this.parent instanceof S&&S.compare(this.statics.blotName,this.parent.statics.blotName)>0){var I=this.parent.isolate(this.offset(),this.length());this.moveChildren(I),I.wrap(this)}}}],[{key:"compare",value:function(P,I){var R=S.order.indexOf(P),U=S.order.indexOf(I);return R>=0||U>=0?R-U:P===I?0:P<I?-1:1}}]),S}(m.default.Inline);x.allowedChildren=[x,m.default.Embed,d.default],x.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],r.default=x},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=i(0),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}function d(g,_){if(!(g instanceof _))throw new TypeError("Cannot call a class as a function")}function f(g,_){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:g}function m(g,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);g.prototype=Object.create(_&&_.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(g,_):g.__proto__=_)}var y=function(g){m(_,g);function _(){return d(this,_),f(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return _}(o.default.Text);r.default=y},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function N(P,I){for(var R=0;R<I.length;R++){var U=I[R];U.enumerable=U.enumerable||!1,U.configurable=!0,"value"in U&&(U.writable=!0),Object.defineProperty(P,U.key,U)}}return function(P,I,R){return I&&N(P.prototype,I),R&&N(P,R),P}}(),o=function N(P,I,R){P===null&&(P=Function.prototype);var U=Object.getOwnPropertyDescriptor(P,I);if(U===void 0){var j=Object.getPrototypeOf(P);return j===null?void 0:N(j,I,R)}else{if("value"in U)return U.value;var k=U.get;return k===void 0?void 0:k.call(R)}},l=i(54),d=y(l),f=i(10),m=y(f);function y(N){return N&&N.__esModule?N:{default:N}}function g(N,P){if(!(N instanceof P))throw new TypeError("Cannot call a class as a function")}function _(N,P){if(!N)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P&&(typeof P=="object"||typeof P=="function")?P:N}function E(N,P){if(typeof P!="function"&&P!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof P);N.prototype=Object.create(P&&P.prototype,{constructor:{value:N,enumerable:!1,writable:!0,configurable:!0}}),P&&(Object.setPrototypeOf?Object.setPrototypeOf(N,P):N.__proto__=P)}var x=(0,m.default)("quill:events"),w=["selectionchange","mousedown","mouseup","click"];w.forEach(function(N){document.addEventListener(N,function(){for(var P=arguments.length,I=Array(P),R=0;R<P;R++)I[R]=arguments[R];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(U){if(U.__quill&&U.__quill.emitter){var j;(j=U.__quill.emitter).handleDOM.apply(j,I)}})})});var S=function(N){E(P,N);function P(){g(this,P);var I=_(this,(P.__proto__||Object.getPrototypeOf(P)).call(this));return I.listeners={},I.on("error",x.error),I}return s(P,[{key:"emit",value:function(){x.log.apply(x,arguments),o(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(R){for(var U=arguments.length,j=Array(U>1?U-1:0),k=1;k<U;k++)j[k-1]=arguments[k];(this.listeners[R.type]||[]).forEach(function(F){var O=F.node,C=F.handler;(R.target===O||O.contains(R.target))&&C.apply(void 0,[R].concat(j))})}},{key:"listenDOM",value:function(R,U,j){this.listeners[R]||(this.listeners[R]=[]),this.listeners[R].push({node:U,handler:j})}}]),P}(d.default);S.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},S.sources={API:"api",SILENT:"silent",USER:"user"},r.default=S},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});function s(l,d){if(!(l instanceof d))throw new TypeError("Cannot call a class as a function")}var o=function l(d){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};s(this,l),this.quill=d,this.options=f};o.DEFAULTS={},r.default=o},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=["error","warn","log","info"],o="warn";function l(f){if(s.indexOf(f)<=s.indexOf(o)){for(var m,y=arguments.length,g=Array(y>1?y-1:0),_=1;_<y;_++)g[_-1]=arguments[_];(m=console)[f].apply(m,g)}}function d(f){return s.reduce(function(m,y){return m[y]=l.bind(console,y,f),m},{})}l.level=d.level=function(f){o=f},r.default=d},function(t,r,i){var s=Array.prototype.slice,o=i(52),l=i(53),d=t.exports=function(g,_,E){return E||(E={}),g===_?!0:g instanceof Date&&_ instanceof Date?g.getTime()===_.getTime():!g||!_||typeof g!="object"&&typeof _!="object"?E.strict?g===_:g==_:y(g,_,E)};function f(g){return g==null}function m(g){return!(!g||typeof g!="object"||typeof g.length!="number"||typeof g.copy!="function"||typeof g.slice!="function"||g.length>0&&typeof g[0]!="number")}function y(g,_,E){var x,w;if(f(g)||f(_)||g.prototype!==_.prototype)return!1;if(l(g))return l(_)?(g=s.call(g),_=s.call(_),d(g,_,E)):!1;if(m(g)){if(!m(_)||g.length!==_.length)return!1;for(x=0;x<g.length;x++)if(g[x]!==_[x])return!1;return!0}try{var S=o(g),N=o(_)}catch{return!1}if(S.length!=N.length)return!1;for(S.sort(),N.sort(),x=S.length-1;x>=0;x--)if(S[x]!=N[x])return!1;for(x=S.length-1;x>=0;x--)if(w=S[x],!d(g[w],_[w],E))return!1;return typeof g==typeof _}},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=i(1),o=function(){function l(d,f,m){m===void 0&&(m={}),this.attrName=d,this.keyName=f;var y=s.Scope.TYPE&s.Scope.ATTRIBUTE;m.scope!=null?this.scope=m.scope&s.Scope.LEVEL|y:this.scope=s.Scope.ATTRIBUTE,m.whitelist!=null&&(this.whitelist=m.whitelist)}return l.keys=function(d){return[].map.call(d.attributes,function(f){return f.name})},l.prototype.add=function(d,f){return this.canAdd(d,f)?(d.setAttribute(this.keyName,f),!0):!1},l.prototype.canAdd=function(d,f){var m=s.query(d,s.Scope.BLOT&(this.scope|s.Scope.TYPE));return m==null?!1:this.whitelist==null?!0:typeof f=="string"?this.whitelist.indexOf(f.replace(/["']/g,""))>-1:this.whitelist.indexOf(f)>-1},l.prototype.remove=function(d){d.removeAttribute(this.keyName)},l.prototype.value=function(d){var f=d.getAttribute(this.keyName);return this.canAdd(d,f)&&f?f:""},l}();r.default=o},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.Code=void 0;var s=function(){function k(F,O){var C=[],D=!0,M=!1,$=void 0;try{for(var G=F[Symbol.iterator](),re;!(D=(re=G.next()).done)&&(C.push(re.value),!(O&&C.length===O));D=!0);}catch(oe){M=!0,$=oe}finally{try{!D&&G.return&&G.return()}finally{if(M)throw $}}return C}return function(F,O){if(Array.isArray(F))return F;if(Symbol.iterator in Object(F))return k(F,O);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function k(F,O){for(var C=0;C<O.length;C++){var D=O[C];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(F,D.key,D)}}return function(F,O,C){return O&&k(F.prototype,O),C&&k(F,C),F}}(),l=function k(F,O,C){F===null&&(F=Function.prototype);var D=Object.getOwnPropertyDescriptor(F,O);if(D===void 0){var M=Object.getPrototypeOf(F);return M===null?void 0:k(M,O,C)}else{if("value"in D)return D.value;var $=D.get;return $===void 0?void 0:$.call(C)}},d=i(2),f=N(d),m=i(0),y=N(m),g=i(4),_=N(g),E=i(6),x=N(E),w=i(7),S=N(w);function N(k){return k&&k.__esModule?k:{default:k}}function P(k,F){if(!(k instanceof F))throw new TypeError("Cannot call a class as a function")}function I(k,F){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F&&(typeof F=="object"||typeof F=="function")?F:k}function R(k,F){if(typeof F!="function"&&F!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof F);k.prototype=Object.create(F&&F.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),F&&(Object.setPrototypeOf?Object.setPrototypeOf(k,F):k.__proto__=F)}var U=function(k){R(F,k);function F(){return P(this,F),I(this,(F.__proto__||Object.getPrototypeOf(F)).apply(this,arguments))}return F}(x.default);U.blotName="code",U.tagName="CODE";var j=function(k){R(F,k);function F(){return P(this,F),I(this,(F.__proto__||Object.getPrototypeOf(F)).apply(this,arguments))}return o(F,[{key:"delta",value:function(){var C=this,D=this.domNode.textContent;return D.endsWith(`
`)&&(D=D.slice(0,-1)),D.split(`
`).reduce(function(M,$){return M.insert($).insert(`
`,C.formats())},new f.default)}},{key:"format",value:function(C,D){if(!(C===this.statics.blotName&&D)){var M=this.descendant(S.default,this.length()-1),$=s(M,1),G=$[0];G!=null&&G.deleteAt(G.length()-1,1),l(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"format",this).call(this,C,D)}}},{key:"formatAt",value:function(C,D,M,$){if(D!==0&&!(y.default.query(M,y.default.Scope.BLOCK)==null||M===this.statics.blotName&&$===this.statics.formats(this.domNode))){var G=this.newlineIndex(C);if(!(G<0||G>=C+D)){var re=this.newlineIndex(C,!0)+1,oe=G-re+1,ie=this.isolate(re,oe),X=ie.next;ie.format(M,$),X instanceof F&&X.formatAt(0,C-re+D-oe,M,$)}}}},{key:"insertAt",value:function(C,D,M){if(M==null){var $=this.descendant(S.default,C),G=s($,2),re=G[0],oe=G[1];re.insertAt(oe,D)}}},{key:"length",value:function(){var C=this.domNode.textContent.length;return this.domNode.textContent.endsWith(`
`)?C:C+1}},{key:"newlineIndex",value:function(C){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(D)return this.domNode.textContent.slice(0,C).lastIndexOf(`
`);var M=this.domNode.textContent.slice(C).indexOf(`
`);return M>-1?C+M:-1}},{key:"optimize",value:function(C){this.domNode.textContent.endsWith(`
`)||this.appendChild(y.default.create("text",`
`)),l(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"optimize",this).call(this,C);var D=this.next;D!=null&&D.prev===this&&D.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===D.statics.formats(D.domNode)&&(D.optimize(C),D.moveChildren(this),D.remove())}},{key:"replace",value:function(C){l(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"replace",this).call(this,C),[].slice.call(this.domNode.querySelectorAll("*")).forEach(function(D){var M=y.default.find(D);M==null?D.parentNode.removeChild(D):M instanceof y.default.Embed?M.remove():M.unwrap()})}}],[{key:"create",value:function(C){var D=l(F.__proto__||Object.getPrototypeOf(F),"create",this).call(this,C);return D.setAttribute("spellcheck",!1),D}},{key:"formats",value:function(){return!0}}]),F}(_.default);j.blotName="code-block",j.tagName="PRE",j.TAB="  ",r.Code=U,r.default=j},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(X){return typeof X}:function(X){return X&&typeof Symbol=="function"&&X.constructor===Symbol&&X!==Symbol.prototype?"symbol":typeof X},o=function(){function X(Y,B){var Z=[],te=!0,se=!1,ae=void 0;try{for(var Q=Y[Symbol.iterator](),ce;!(te=(ce=Q.next()).done)&&(Z.push(ce.value),!(B&&Z.length===B));te=!0);}catch(me){se=!0,ae=me}finally{try{!te&&Q.return&&Q.return()}finally{if(se)throw ae}}return Z}return function(Y,B){if(Array.isArray(Y))return Y;if(Symbol.iterator in Object(Y))return X(Y,B);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function X(Y,B){for(var Z=0;Z<B.length;Z++){var te=B[Z];te.enumerable=te.enumerable||!1,te.configurable=!0,"value"in te&&(te.writable=!0),Object.defineProperty(Y,te.key,te)}}return function(Y,B,Z){return B&&X(Y.prototype,B),Z&&X(Y,Z),Y}}(),d=i(2),f=D(d),m=i(20),y=D(m),g=i(0),_=D(g),E=i(13),x=D(E),w=i(24),S=D(w),N=i(4),P=D(N),I=i(16),R=D(I),U=i(21),j=D(U),k=i(11),F=D(k),O=i(3),C=D(O);function D(X){return X&&X.__esModule?X:{default:X}}function M(X,Y,B){return Y in X?Object.defineProperty(X,Y,{value:B,enumerable:!0,configurable:!0,writable:!0}):X[Y]=B,X}function $(X,Y){if(!(X instanceof Y))throw new TypeError("Cannot call a class as a function")}var G=/^[ -~]*$/,re=function(){function X(Y){$(this,X),this.scroll=Y,this.delta=this.getDelta()}return l(X,[{key:"applyDelta",value:function(B){var Z=this,te=!1;this.scroll.update();var se=this.scroll.length();return this.scroll.batchStart(),B=ie(B),B.reduce(function(ae,Q){var ce=Q.retain||Q.delete||Q.insert.length||1,me=Q.attributes||{};if(Q.insert!=null){if(typeof Q.insert=="string"){var ge=Q.insert;ge.endsWith(`
`)&&te&&(te=!1,ge=ge.slice(0,-1)),ae>=se&&!ge.endsWith(`
`)&&(te=!0),Z.scroll.insertAt(ae,ge);var Ae=Z.scroll.line(ae),Ve=o(Ae,2),Ye=Ve[0],Ge=Ve[1],ot=(0,C.default)({},(0,N.bubbleFormats)(Ye));if(Ye instanceof P.default){var nt=Ye.descendant(_.default.Leaf,Ge),It=o(nt,1),Gt=It[0];ot=(0,C.default)(ot,(0,N.bubbleFormats)(Gt))}me=y.default.attributes.diff(ot,me)||{}}else if(s(Q.insert)==="object"){var Se=Object.keys(Q.insert)[0];if(Se==null)return ae;Z.scroll.insertAt(ae,Se,Q.insert[Se])}se+=ce}return Object.keys(me).forEach(function(Ne){Z.scroll.formatAt(ae,ce,Ne,me[Ne])}),ae+ce},0),B.reduce(function(ae,Q){return typeof Q.delete=="number"?(Z.scroll.deleteAt(ae,Q.delete),ae):ae+(Q.retain||Q.insert.length||1)},0),this.scroll.batchEnd(),this.update(B)}},{key:"deleteText",value:function(B,Z){return this.scroll.deleteAt(B,Z),this.update(new f.default().retain(B).delete(Z))}},{key:"formatLine",value:function(B,Z){var te=this,se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.scroll.update(),Object.keys(se).forEach(function(ae){if(!(te.scroll.whitelist!=null&&!te.scroll.whitelist[ae])){var Q=te.scroll.lines(B,Math.max(Z,1)),ce=Z;Q.forEach(function(me){var ge=me.length();if(!(me instanceof x.default))me.format(ae,se[ae]);else{var Ae=B-me.offset(te.scroll),Ve=me.newlineIndex(Ae+ce)-Ae+1;me.formatAt(Ae,Ve,ae,se[ae])}ce-=ge})}}),this.scroll.optimize(),this.update(new f.default().retain(B).retain(Z,(0,j.default)(se)))}},{key:"formatText",value:function(B,Z){var te=this,se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Object.keys(se).forEach(function(ae){te.scroll.formatAt(B,Z,ae,se[ae])}),this.update(new f.default().retain(B).retain(Z,(0,j.default)(se)))}},{key:"getContents",value:function(B,Z){return this.delta.slice(B,B+Z)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce(function(B,Z){return B.concat(Z.delta())},new f.default)}},{key:"getFormat",value:function(B){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,te=[],se=[];Z===0?this.scroll.path(B).forEach(function(Q){var ce=o(Q,1),me=ce[0];me instanceof P.default?te.push(me):me instanceof _.default.Leaf&&se.push(me)}):(te=this.scroll.lines(B,Z),se=this.scroll.descendants(_.default.Leaf,B,Z));var ae=[te,se].map(function(Q){if(Q.length===0)return{};for(var ce=(0,N.bubbleFormats)(Q.shift());Object.keys(ce).length>0;){var me=Q.shift();if(me==null)return ce;ce=oe((0,N.bubbleFormats)(me),ce)}return ce});return C.default.apply(C.default,ae)}},{key:"getText",value:function(B,Z){return this.getContents(B,Z).filter(function(te){return typeof te.insert=="string"}).map(function(te){return te.insert}).join("")}},{key:"insertEmbed",value:function(B,Z,te){return this.scroll.insertAt(B,Z,te),this.update(new f.default().retain(B).insert(M({},Z,te)))}},{key:"insertText",value:function(B,Z){var te=this,se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Z=Z.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(B,Z),Object.keys(se).forEach(function(ae){te.scroll.formatAt(B,Z.length,ae,se[ae])}),this.update(new f.default().retain(B).insert(Z,(0,j.default)(se)))}},{key:"isBlank",value:function(){if(this.scroll.children.length==0)return!0;if(this.scroll.children.length>1)return!1;var B=this.scroll.children.head;return B.statics.blotName!==P.default.blotName||B.children.length>1?!1:B.children.head instanceof R.default}},{key:"removeFormat",value:function(B,Z){var te=this.getText(B,Z),se=this.scroll.line(B+Z),ae=o(se,2),Q=ae[0],ce=ae[1],me=0,ge=new f.default;Q!=null&&(Q instanceof x.default?me=Q.newlineIndex(ce)-ce+1:me=Q.length()-ce,ge=Q.delta().slice(ce,ce+me-1).insert(`
`));var Ae=this.getContents(B,Z+me),Ve=Ae.diff(new f.default().insert(te).concat(ge)),Ye=new f.default().retain(B).concat(Ve);return this.applyDelta(Ye)}},{key:"update",value:function(B){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],te=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,se=this.delta;if(Z.length===1&&Z[0].type==="characterData"&&Z[0].target.data.match(G)&&_.default.find(Z[0].target)){var ae=_.default.find(Z[0].target),Q=(0,N.bubbleFormats)(ae),ce=ae.offset(this.scroll),me=Z[0].oldValue.replace(S.default.CONTENTS,""),ge=new f.default().insert(me),Ae=new f.default().insert(ae.value()),Ve=new f.default().retain(ce).concat(ge.diff(Ae,te));B=Ve.reduce(function(Ye,Ge){return Ge.insert?Ye.insert(Ge.insert,Q):Ye.push(Ge)},new f.default),this.delta=se.compose(B)}else this.delta=this.getDelta(),(!B||!(0,F.default)(se.compose(B),this.delta))&&(B=se.diff(this.delta,te));return B}}]),X}();function oe(X,Y){return Object.keys(Y).reduce(function(B,Z){return X[Z]==null||(Y[Z]===X[Z]?B[Z]=Y[Z]:Array.isArray(Y[Z])?Y[Z].indexOf(X[Z])<0&&(B[Z]=Y[Z].concat([X[Z]])):B[Z]=[Y[Z],X[Z]]),B},{})}function ie(X){return X.reduce(function(Y,B){if(B.insert===1){var Z=(0,j.default)(B.attributes);return delete Z.image,Y.insert({image:B.attributes.image},Z)}if(B.attributes!=null&&(B.attributes.list===!0||B.attributes.bullet===!0)&&(B=(0,j.default)(B),B.attributes.list?B.attributes.list="ordered":(B.attributes.list="bullet",delete B.attributes.bullet)),typeof B.insert=="string"){var te=B.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return Y.insert(te,B.attributes)}return Y.push(B)},new f.default)}r.default=re},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.Range=void 0;var s=function(){function k(F,O){var C=[],D=!0,M=!1,$=void 0;try{for(var G=F[Symbol.iterator](),re;!(D=(re=G.next()).done)&&(C.push(re.value),!(O&&C.length===O));D=!0);}catch(oe){M=!0,$=oe}finally{try{!D&&G.return&&G.return()}finally{if(M)throw $}}return C}return function(F,O){if(Array.isArray(F))return F;if(Symbol.iterator in Object(F))return k(F,O);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function k(F,O){for(var C=0;C<O.length;C++){var D=O[C];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(F,D.key,D)}}return function(F,O,C){return O&&k(F.prototype,O),C&&k(F,C),F}}(),l=i(0),d=S(l),f=i(21),m=S(f),y=i(11),g=S(y),_=i(8),E=S(_),x=i(10),w=S(x);function S(k){return k&&k.__esModule?k:{default:k}}function N(k){if(Array.isArray(k)){for(var F=0,O=Array(k.length);F<k.length;F++)O[F]=k[F];return O}else return Array.from(k)}function P(k,F){if(!(k instanceof F))throw new TypeError("Cannot call a class as a function")}var I=(0,w.default)("quill:selection"),R=function k(F){var O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;P(this,k),this.index=F,this.length=O},U=function(){function k(F,O){var C=this;P(this,k),this.emitter=O,this.scroll=F,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=d.default.create("cursor",this),this.lastRange=this.savedRange=new R(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){C.mouseDown||setTimeout(C.update.bind(C,E.default.sources.USER),1)}),this.emitter.on(E.default.events.EDITOR_CHANGE,function(D,M){D===E.default.events.TEXT_CHANGE&&M.length()>0&&C.update(E.default.sources.SILENT)}),this.emitter.on(E.default.events.SCROLL_BEFORE_UPDATE,function(){if(C.hasFocus()){var D=C.getNativeRange();D!=null&&D.start.node!==C.cursor.textNode&&C.emitter.once(E.default.events.SCROLL_UPDATE,function(){try{C.setNativeRange(D.start.node,D.start.offset,D.end.node,D.end.offset)}catch{}})}}),this.emitter.on(E.default.events.SCROLL_OPTIMIZE,function(D,M){if(M.range){var $=M.range,G=$.startNode,re=$.startOffset,oe=$.endNode,ie=$.endOffset;C.setNativeRange(G,re,oe,ie)}}),this.update(E.default.sources.SILENT)}return o(k,[{key:"handleComposition",value:function(){var O=this;this.root.addEventListener("compositionstart",function(){O.composing=!0}),this.root.addEventListener("compositionend",function(){if(O.composing=!1,O.cursor.parent){var C=O.cursor.restore();if(!C)return;setTimeout(function(){O.setNativeRange(C.startNode,C.startOffset,C.endNode,C.endOffset)},1)}})}},{key:"handleDragging",value:function(){var O=this;this.emitter.listenDOM("mousedown",document.body,function(){O.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){O.mouseDown=!1,O.update(E.default.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(O,C){if(!(this.scroll.whitelist!=null&&!this.scroll.whitelist[O])){this.scroll.update();var D=this.getNativeRange();if(!(D==null||!D.native.collapsed||d.default.query(O,d.default.Scope.BLOCK))){if(D.start.node!==this.cursor.textNode){var M=d.default.find(D.start.node,!1);if(M==null)return;if(M instanceof d.default.Leaf){var $=M.split(D.start.offset);M.parent.insertBefore(this.cursor,$)}else M.insertBefore(this.cursor,D.start.node);this.cursor.attach()}this.cursor.format(O,C),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(O){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,D=this.scroll.length();O=Math.min(O,D-1),C=Math.min(O+C,D-1)-O;var M=void 0,$=this.scroll.leaf(O),G=s($,2),re=G[0],oe=G[1];if(re==null)return null;var ie=re.position(oe,!0),X=s(ie,2);M=X[0],oe=X[1];var Y=document.createRange();if(C>0){Y.setStart(M,oe);var B=this.scroll.leaf(O+C),Z=s(B,2);if(re=Z[0],oe=Z[1],re==null)return null;var te=re.position(oe,!0),se=s(te,2);return M=se[0],oe=se[1],Y.setEnd(M,oe),Y.getBoundingClientRect()}else{var ae="left",Q=void 0;return M instanceof Text?(oe<M.data.length?(Y.setStart(M,oe),Y.setEnd(M,oe+1)):(Y.setStart(M,oe-1),Y.setEnd(M,oe),ae="right"),Q=Y.getBoundingClientRect()):(Q=re.domNode.getBoundingClientRect(),oe>0&&(ae="right")),{bottom:Q.top+Q.height,height:Q.height,left:Q[ae],right:Q[ae],top:Q.top,width:0}}}},{key:"getNativeRange",value:function(){var O=document.getSelection();if(O==null||O.rangeCount<=0)return null;var C=O.getRangeAt(0);if(C==null)return null;var D=this.normalizeNative(C);return I.info("getNativeRange",D),D}},{key:"getRange",value:function(){var O=this.getNativeRange();if(O==null)return[null,null];var C=this.normalizedToRange(O);return[C,O]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(O){var C=this,D=[[O.start.node,O.start.offset]];O.native.collapsed||D.push([O.end.node,O.end.offset]);var M=D.map(function(re){var oe=s(re,2),ie=oe[0],X=oe[1],Y=d.default.find(ie,!0),B=Y.offset(C.scroll);return X===0?B:Y instanceof d.default.Container?B+Y.length():B+Y.index(ie,X)}),$=Math.min(Math.max.apply(Math,N(M)),this.scroll.length()-1),G=Math.min.apply(Math,[$].concat(N(M)));return new R(G,$-G)}},{key:"normalizeNative",value:function(O){if(!j(this.root,O.startContainer)||!O.collapsed&&!j(this.root,O.endContainer))return null;var C={start:{node:O.startContainer,offset:O.startOffset},end:{node:O.endContainer,offset:O.endOffset},native:O};return[C.start,C.end].forEach(function(D){for(var M=D.node,$=D.offset;!(M instanceof Text)&&M.childNodes.length>0;)if(M.childNodes.length>$)M=M.childNodes[$],$=0;else if(M.childNodes.length===$)M=M.lastChild,$=M instanceof Text?M.data.length:M.childNodes.length+1;else break;D.node=M,D.offset=$}),C}},{key:"rangeToNative",value:function(O){var C=this,D=O.collapsed?[O.index]:[O.index,O.index+O.length],M=[],$=this.scroll.length();return D.forEach(function(G,re){G=Math.min($-1,G);var oe=void 0,ie=C.scroll.leaf(G),X=s(ie,2),Y=X[0],B=X[1],Z=Y.position(B,re!==0),te=s(Z,2);oe=te[0],B=te[1],M.push(oe,B)}),M.length<2&&(M=M.concat(M)),M}},{key:"scrollIntoView",value:function(O){var C=this.lastRange;if(C!=null){var D=this.getBounds(C.index,C.length);if(D!=null){var M=this.scroll.length()-1,$=this.scroll.line(Math.min(C.index,M)),G=s($,1),re=G[0],oe=re;if(C.length>0){var ie=this.scroll.line(Math.min(C.index+C.length,M)),X=s(ie,1);oe=X[0]}if(!(re==null||oe==null)){var Y=O.getBoundingClientRect();D.top<Y.top?O.scrollTop-=Y.top-D.top:D.bottom>Y.bottom&&(O.scrollTop+=D.bottom-Y.bottom)}}}}},{key:"setNativeRange",value:function(O,C){var D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:O,M=arguments.length>3&&arguments[3]!==void 0?arguments[3]:C,$=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(I.info("setNativeRange",O,C,D,M),!(O!=null&&(this.root.parentNode==null||O.parentNode==null||D.parentNode==null))){var G=document.getSelection();if(G!=null)if(O!=null){this.hasFocus()||this.root.focus();var re=(this.getNativeRange()||{}).native;if(re==null||$||O!==re.startContainer||C!==re.startOffset||D!==re.endContainer||M!==re.endOffset){O.tagName=="BR"&&(C=[].indexOf.call(O.parentNode.childNodes,O),O=O.parentNode),D.tagName=="BR"&&(M=[].indexOf.call(D.parentNode.childNodes,D),D=D.parentNode);var oe=document.createRange();oe.setStart(O,C),oe.setEnd(D,M),G.removeAllRanges(),G.addRange(oe)}}else G.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(O){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:E.default.sources.API;if(typeof C=="string"&&(D=C,C=!1),I.info("setRange",O),O!=null){var M=this.rangeToNative(O);this.setNativeRange.apply(this,N(M).concat([C]))}else this.setNativeRange(null);this.update(D)}},{key:"update",value:function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:E.default.sources.USER,C=this.lastRange,D=this.getRange(),M=s(D,2),$=M[0],G=M[1];if(this.lastRange=$,this.lastRange!=null&&(this.savedRange=this.lastRange),!(0,g.default)(C,this.lastRange)){var re;!this.composing&&G!=null&&G.native.collapsed&&G.start.node!==this.cursor.textNode&&this.cursor.restore();var oe=[E.default.events.SELECTION_CHANGE,(0,m.default)(this.lastRange),(0,m.default)(C),O];if((re=this.emitter).emit.apply(re,[E.default.events.EDITOR_CHANGE].concat(oe)),O!==E.default.sources.SILENT){var ie;(ie=this.emitter).emit.apply(ie,oe)}}}}]),k}();function j(k,F){try{F.parentNode}catch{return!1}return F instanceof Text&&(F=F.parentNode),k.contains(F)}r.Range=R,r.default=U},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function E(x,w){for(var S=0;S<w.length;S++){var N=w[S];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(x,N.key,N)}}return function(x,w,S){return w&&E(x.prototype,w),S&&E(x,S),x}}(),o=function E(x,w,S){x===null&&(x=Function.prototype);var N=Object.getOwnPropertyDescriptor(x,w);if(N===void 0){var P=Object.getPrototypeOf(x);return P===null?void 0:E(P,w,S)}else{if("value"in N)return N.value;var I=N.get;return I===void 0?void 0:I.call(S)}},l=i(0),d=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function y(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var _=function(E){g(x,E);function x(){return m(this,x),y(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return s(x,[{key:"insertInto",value:function(S,N){S.children.length===0?o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"insertInto",this).call(this,S,N):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),x}(d.default.Embed);_.blotName="break",_.tagName="BR",r.default=_},function(t,r,i){var s=this&&this.__extends||function(){var y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,_){g.__proto__=_}||function(g,_){for(var E in _)_.hasOwnProperty(E)&&(g[E]=_[E])};return function(g,_){y(g,_);function E(){this.constructor=g}g.prototype=_===null?Object.create(_):(E.prototype=_.prototype,new E)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=i(44),l=i(30),d=i(1),f=function(y){s(g,y);function g(_){var E=y.call(this,_)||this;return E.build(),E}return g.prototype.appendChild=function(_){this.insertBefore(_)},g.prototype.attach=function(){y.prototype.attach.call(this),this.children.forEach(function(_){_.attach()})},g.prototype.build=function(){var _=this;this.children=new o.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(E){try{var x=m(E);_.insertBefore(x,_.children.head||void 0)}catch(w){if(w instanceof d.ParchmentError)return;throw w}})},g.prototype.deleteAt=function(_,E){if(_===0&&E===this.length())return this.remove();this.children.forEachAt(_,E,function(x,w,S){x.deleteAt(w,S)})},g.prototype.descendant=function(_,E){var x=this.children.find(E),w=x[0],S=x[1];return _.blotName==null&&_(w)||_.blotName!=null&&w instanceof _?[w,S]:w instanceof g?w.descendant(_,S):[null,-1]},g.prototype.descendants=function(_,E,x){E===void 0&&(E=0),x===void 0&&(x=Number.MAX_VALUE);var w=[],S=x;return this.children.forEachAt(E,x,function(N,P,I){(_.blotName==null&&_(N)||_.blotName!=null&&N instanceof _)&&w.push(N),N instanceof g&&(w=w.concat(N.descendants(_,P,S))),S-=I}),w},g.prototype.detach=function(){this.children.forEach(function(_){_.detach()}),y.prototype.detach.call(this)},g.prototype.formatAt=function(_,E,x,w){this.children.forEachAt(_,E,function(S,N,P){S.formatAt(N,P,x,w)})},g.prototype.insertAt=function(_,E,x){var w=this.children.find(_),S=w[0],N=w[1];if(S)S.insertAt(N,E,x);else{var P=x==null?d.create("text",E):d.create(E,x);this.appendChild(P)}},g.prototype.insertBefore=function(_,E){if(this.statics.allowedChildren!=null&&!this.statics.allowedChildren.some(function(x){return _ instanceof x}))throw new d.ParchmentError("Cannot insert "+_.statics.blotName+" into "+this.statics.blotName);_.insertInto(this,E)},g.prototype.length=function(){return this.children.reduce(function(_,E){return _+E.length()},0)},g.prototype.moveChildren=function(_,E){this.children.forEach(function(x){_.insertBefore(x,E)})},g.prototype.optimize=function(_){if(y.prototype.optimize.call(this,_),this.children.length===0)if(this.statics.defaultChild!=null){var E=d.create(this.statics.defaultChild);this.appendChild(E),E.optimize(_)}else this.remove()},g.prototype.path=function(_,E){E===void 0&&(E=!1);var x=this.children.find(_,E),w=x[0],S=x[1],N=[[this,_]];return w instanceof g?N.concat(w.path(S,E)):(w!=null&&N.push([w,S]),N)},g.prototype.removeChild=function(_){this.children.remove(_)},g.prototype.replace=function(_){_ instanceof g&&_.moveChildren(this),y.prototype.replace.call(this,_)},g.prototype.split=function(_,E){if(E===void 0&&(E=!1),!E){if(_===0)return this;if(_===this.length())return this.next}var x=this.clone();return this.parent.insertBefore(x,this.next),this.children.forEachAt(_,this.length(),function(w,S,N){w=w.split(S,E),x.appendChild(w)}),x},g.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},g.prototype.update=function(_,E){var x=this,w=[],S=[];_.forEach(function(N){N.target===x.domNode&&N.type==="childList"&&(w.push.apply(w,N.addedNodes),S.push.apply(S,N.removedNodes))}),S.forEach(function(N){if(!(N.parentNode!=null&&N.tagName!=="IFRAME"&&document.body.compareDocumentPosition(N)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var P=d.find(N);P!=null&&(P.domNode.parentNode==null||P.domNode.parentNode===x.domNode)&&P.detach()}}),w.filter(function(N){return N.parentNode==x.domNode}).sort(function(N,P){return N===P?0:N.compareDocumentPosition(P)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(N){var P=null;N.nextSibling!=null&&(P=d.find(N.nextSibling));var I=m(N);(I.next!=P||I.next==null)&&(I.parent!=null&&I.parent.removeChild(x),x.insertBefore(I,P||void 0))})},g}(l.default);function m(y){var g=d.find(y);if(g==null)try{g=d.create(y)}catch{g=d.create(d.Scope.INLINE),[].slice.call(y.childNodes).forEach(function(E){g.domNode.appendChild(E)}),y.parentNode&&y.parentNode.replaceChild(g.domNode,y),g.attach()}return g}r.default=f},function(t,r,i){var s=this&&this.__extends||function(){var y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,_){g.__proto__=_}||function(g,_){for(var E in _)_.hasOwnProperty(E)&&(g[E]=_[E])};return function(g,_){y(g,_);function E(){this.constructor=g}g.prototype=_===null?Object.create(_):(E.prototype=_.prototype,new E)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=i(12),l=i(31),d=i(17),f=i(1),m=function(y){s(g,y);function g(_){var E=y.call(this,_)||this;return E.attributes=new l.default(E.domNode),E}return g.formats=function(_){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return _.tagName.toLowerCase()},g.prototype.format=function(_,E){var x=f.query(_);x instanceof o.default?this.attributes.attribute(x,E):E&&x!=null&&(_!==this.statics.blotName||this.formats()[_]!==E)&&this.replaceWith(_,E)},g.prototype.formats=function(){var _=this.attributes.values(),E=this.statics.formats(this.domNode);return E!=null&&(_[this.statics.blotName]=E),_},g.prototype.replaceWith=function(_,E){var x=y.prototype.replaceWith.call(this,_,E);return this.attributes.copy(x),x},g.prototype.update=function(_,E){var x=this;y.prototype.update.call(this,_,E),_.some(function(w){return w.target===x.domNode&&w.type==="attributes"})&&this.attributes.build()},g.prototype.wrap=function(_,E){var x=y.prototype.wrap.call(this,_,E);return x instanceof g&&x.statics.scope===this.statics.scope&&this.attributes.move(x),x},g}(d.default);r.default=m},function(t,r,i){var s=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var g in y)y.hasOwnProperty(g)&&(m[g]=y[g])};return function(m,y){f(m,y);function g(){this.constructor=m}m.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=i(30),l=i(1),d=function(f){s(m,f);function m(){return f!==null&&f.apply(this,arguments)||this}return m.value=function(y){return!0},m.prototype.index=function(y,g){return this.domNode===y||this.domNode.compareDocumentPosition(y)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(g,1):-1},m.prototype.position=function(y,g){var _=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return y>0&&(_+=1),[this.parent.domNode,_]},m.prototype.value=function(){var y;return y={},y[this.statics.blotName]=this.statics.value(this.domNode)||!0,y},m.scope=l.Scope.INLINE_BLOT,m}(o.default);r.default=d},function(t,r,i){var s=i(11),o=i(3),l={attributes:{compose:function(f,m,y){typeof f!="object"&&(f={}),typeof m!="object"&&(m={});var g=o(!0,{},m);y||(g=Object.keys(g).reduce(function(E,x){return g[x]!=null&&(E[x]=g[x]),E},{}));for(var _ in f)f[_]!==void 0&&m[_]===void 0&&(g[_]=f[_]);return Object.keys(g).length>0?g:void 0},diff:function(f,m){typeof f!="object"&&(f={}),typeof m!="object"&&(m={});var y=Object.keys(f).concat(Object.keys(m)).reduce(function(g,_){return s(f[_],m[_])||(g[_]=m[_]===void 0?null:m[_]),g},{});return Object.keys(y).length>0?y:void 0},transform:function(f,m,y){if(typeof f!="object")return m;if(typeof m=="object"){if(!y)return m;var g=Object.keys(m).reduce(function(_,E){return f[E]===void 0&&(_[E]=m[E]),_},{});return Object.keys(g).length>0?g:void 0}}},iterator:function(f){return new d(f)},length:function(f){return typeof f.delete=="number"?f.delete:typeof f.retain=="number"?f.retain:typeof f.insert=="string"?f.insert.length:1}};function d(f){this.ops=f,this.index=0,this.offset=0}d.prototype.hasNext=function(){return this.peekLength()<1/0},d.prototype.next=function(f){f||(f=1/0);var m=this.ops[this.index];if(m){var y=this.offset,g=l.length(m);if(f>=g-y?(f=g-y,this.index+=1,this.offset=0):this.offset+=f,typeof m.delete=="number")return{delete:f};var _={};return m.attributes&&(_.attributes=m.attributes),typeof m.retain=="number"?_.retain=f:typeof m.insert=="string"?_.insert=m.insert.substr(y,f):_.insert=m.insert,_}else return{retain:1/0}},d.prototype.peek=function(){return this.ops[this.index]},d.prototype.peekLength=function(){return this.ops[this.index]?l.length(this.ops[this.index])-this.offset:1/0},d.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},d.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var f=this.offset,m=this.index,y=this.next(),g=this.ops.slice(this.index);return this.offset=f,this.index=m,[y].concat(g)}else return[]},t.exports=l},function(t,r){var i=function(){function s(x,w){return w!=null&&x instanceof w}var o;try{o=Map}catch{o=function(){}}var l;try{l=Set}catch{l=function(){}}var d;try{d=Promise}catch{d=function(){}}function f(x,w,S,N,P){typeof w=="object"&&(S=w.depth,N=w.prototype,P=w.includeNonEnumerable,w=w.circular);var I=[],R=[],U=typeof Buffer<"u";typeof w>"u"&&(w=!0),typeof S>"u"&&(S=1/0);function j(k,F){if(k===null)return null;if(F===0)return k;var O,C;if(typeof k!="object")return k;if(s(k,o))O=new o;else if(s(k,l))O=new l;else if(s(k,d))O=new d(function(Y,B){k.then(function(Z){Y(j(Z,F-1))},function(Z){B(j(Z,F-1))})});else if(f.__isArray(k))O=[];else if(f.__isRegExp(k))O=new RegExp(k.source,E(k)),k.lastIndex&&(O.lastIndex=k.lastIndex);else if(f.__isDate(k))O=new Date(k.getTime());else{if(U&&Buffer.isBuffer(k))return Buffer.allocUnsafe?O=Buffer.allocUnsafe(k.length):O=new Buffer(k.length),k.copy(O),O;s(k,Error)?O=Object.create(k):typeof N>"u"?(C=Object.getPrototypeOf(k),O=Object.create(C)):(O=Object.create(N),C=N)}if(w){var D=I.indexOf(k);if(D!=-1)return R[D];I.push(k),R.push(O)}s(k,o)&&k.forEach(function(Y,B){var Z=j(B,F-1),te=j(Y,F-1);O.set(Z,te)}),s(k,l)&&k.forEach(function(Y){var B=j(Y,F-1);O.add(B)});for(var M in k){var $;C&&($=Object.getOwnPropertyDescriptor(C,M)),!($&&$.set==null)&&(O[M]=j(k[M],F-1))}if(Object.getOwnPropertySymbols)for(var G=Object.getOwnPropertySymbols(k),M=0;M<G.length;M++){var re=G[M],oe=Object.getOwnPropertyDescriptor(k,re);oe&&!oe.enumerable&&!P||(O[re]=j(k[re],F-1),oe.enumerable||Object.defineProperty(O,re,{enumerable:!1}))}if(P)for(var ie=Object.getOwnPropertyNames(k),M=0;M<ie.length;M++){var X=ie[M],oe=Object.getOwnPropertyDescriptor(k,X);oe&&oe.enumerable||(O[X]=j(k[X],F-1),Object.defineProperty(O,X,{enumerable:!1}))}return O}return j(x,S)}f.clonePrototype=function(w){if(w===null)return null;var S=function(){};return S.prototype=w,new S};function m(x){return Object.prototype.toString.call(x)}f.__objToStr=m;function y(x){return typeof x=="object"&&m(x)==="[object Date]"}f.__isDate=y;function g(x){return typeof x=="object"&&m(x)==="[object Array]"}f.__isArray=g;function _(x){return typeof x=="object"&&m(x)==="[object RegExp]"}f.__isRegExp=_;function E(x){var w="";return x.global&&(w+="g"),x.ignoreCase&&(w+="i"),x.multiline&&(w+="m"),w}return f.__getRegExpFlags=E,f}();typeof t=="object"&&t.exports&&(t.exports=i)},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function O(C,D){var M=[],$=!0,G=!1,re=void 0;try{for(var oe=C[Symbol.iterator](),ie;!($=(ie=oe.next()).done)&&(M.push(ie.value),!(D&&M.length===D));$=!0);}catch(X){G=!0,re=X}finally{try{!$&&oe.return&&oe.return()}finally{if(G)throw re}}return M}return function(C,D){if(Array.isArray(C))return C;if(Symbol.iterator in Object(C))return O(C,D);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function O(C,D){for(var M=0;M<D.length;M++){var $=D[M];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(C,$.key,$)}}return function(C,D,M){return D&&O(C.prototype,D),M&&O(C,M),C}}(),l=function O(C,D,M){C===null&&(C=Function.prototype);var $=Object.getOwnPropertyDescriptor(C,D);if($===void 0){var G=Object.getPrototypeOf(C);return G===null?void 0:O(G,D,M)}else{if("value"in $)return $.value;var re=$.get;return re===void 0?void 0:re.call(M)}},d=i(0),f=I(d),m=i(8),y=I(m),g=i(4),_=I(g),E=i(16),x=I(E),w=i(13),S=I(w),N=i(25),P=I(N);function I(O){return O&&O.__esModule?O:{default:O}}function R(O,C){if(!(O instanceof C))throw new TypeError("Cannot call a class as a function")}function U(O,C){if(!O)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C&&(typeof C=="object"||typeof C=="function")?C:O}function j(O,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof C);O.prototype=Object.create(C&&C.prototype,{constructor:{value:O,enumerable:!1,writable:!0,configurable:!0}}),C&&(Object.setPrototypeOf?Object.setPrototypeOf(O,C):O.__proto__=C)}function k(O){return O instanceof _.default||O instanceof g.BlockEmbed}var F=function(O){j(C,O);function C(D,M){R(this,C);var $=U(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,D));return $.emitter=M.emitter,Array.isArray(M.whitelist)&&($.whitelist=M.whitelist.reduce(function(G,re){return G[re]=!0,G},{})),$.domNode.addEventListener("DOMNodeInserted",function(){}),$.optimize(),$.enable(),$}return o(C,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(M,$){var G=this.line(M),re=s(G,2),oe=re[0],ie=re[1],X=this.line(M+$),Y=s(X,1),B=Y[0];if(l(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"deleteAt",this).call(this,M,$),B!=null&&oe!==B&&ie>0){if(oe instanceof g.BlockEmbed||B instanceof g.BlockEmbed){this.optimize();return}if(oe instanceof S.default){var Z=oe.newlineIndex(oe.length(),!0);if(Z>-1&&(oe=oe.split(Z+1),oe===B)){this.optimize();return}}else if(B instanceof S.default){var te=B.newlineIndex(0);te>-1&&B.split(te+1)}var se=B.children.head instanceof x.default?null:B.children.head;oe.moveChildren(B,se),oe.remove()}this.optimize()}},{key:"enable",value:function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",M)}},{key:"formatAt",value:function(M,$,G,re){this.whitelist!=null&&!this.whitelist[G]||(l(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"formatAt",this).call(this,M,$,G,re),this.optimize())}},{key:"insertAt",value:function(M,$,G){if(!(G!=null&&this.whitelist!=null&&!this.whitelist[$])){if(M>=this.length())if(G==null||f.default.query($,f.default.Scope.BLOCK)==null){var re=f.default.create(this.statics.defaultChild);this.appendChild(re),G==null&&$.endsWith(`
`)&&($=$.slice(0,-1)),re.insertAt(0,$,G)}else{var oe=f.default.create($,G);this.appendChild(oe)}else l(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"insertAt",this).call(this,M,$,G);this.optimize()}}},{key:"insertBefore",value:function(M,$){if(M.statics.scope===f.default.Scope.INLINE_BLOT){var G=f.default.create(this.statics.defaultChild);G.appendChild(M),M=G}l(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"insertBefore",this).call(this,M,$)}},{key:"leaf",value:function(M){return this.path(M).pop()||[null,-1]}},{key:"line",value:function(M){return M===this.length()?this.line(M-1):this.descendant(k,M)}},{key:"lines",value:function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,G=function re(oe,ie,X){var Y=[],B=X;return oe.children.forEachAt(ie,X,function(Z,te,se){k(Z)?Y.push(Z):Z instanceof f.default.Container&&(Y=Y.concat(re(Z,te,B))),B-=se}),Y};return G(this,M,$)}},{key:"optimize",value:function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch!==!0&&(l(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"optimize",this).call(this,M,$),M.length>0&&this.emitter.emit(y.default.events.SCROLL_OPTIMIZE,M,$))}},{key:"path",value:function(M){return l(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"path",this).call(this,M).slice(1)}},{key:"update",value:function(M){if(this.batch!==!0){var $=y.default.sources.USER;typeof M=="string"&&($=M),Array.isArray(M)||(M=this.observer.takeRecords()),M.length>0&&this.emitter.emit(y.default.events.SCROLL_BEFORE_UPDATE,$,M),l(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"update",this).call(this,M.concat([])),M.length>0&&this.emitter.emit(y.default.events.SCROLL_UPDATE,$,M)}}}]),C}(f.default.Scroll);F.blotName="scroll",F.className="ql-editor",F.tagName="DIV",F.defaultChild="block",F.allowedChildren=[_.default,g.BlockEmbed,P.default],r.default=F},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.SHORTKEY=r.default=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Q){return typeof Q}:function(Q){return Q&&typeof Symbol=="function"&&Q.constructor===Symbol&&Q!==Symbol.prototype?"symbol":typeof Q},o=function(){function Q(ce,me){var ge=[],Ae=!0,Ve=!1,Ye=void 0;try{for(var Ge=ce[Symbol.iterator](),ot;!(Ae=(ot=Ge.next()).done)&&(ge.push(ot.value),!(me&&ge.length===me));Ae=!0);}catch(nt){Ve=!0,Ye=nt}finally{try{!Ae&&Ge.return&&Ge.return()}finally{if(Ve)throw Ye}}return ge}return function(ce,me){if(Array.isArray(ce))return ce;if(Symbol.iterator in Object(ce))return Q(ce,me);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function Q(ce,me){for(var ge=0;ge<me.length;ge++){var Ae=me[ge];Ae.enumerable=Ae.enumerable||!1,Ae.configurable=!0,"value"in Ae&&(Ae.writable=!0),Object.defineProperty(ce,Ae.key,Ae)}}return function(ce,me,ge){return me&&Q(ce.prototype,me),ge&&Q(ce,ge),ce}}(),d=i(21),f=O(d),m=i(11),y=O(m),g=i(3),_=O(g),E=i(2),x=O(E),w=i(20),S=O(w),N=i(0),P=O(N),I=i(5),R=O(I),U=i(10),j=O(U),k=i(9),F=O(k);function O(Q){return Q&&Q.__esModule?Q:{default:Q}}function C(Q,ce,me){return ce in Q?Object.defineProperty(Q,ce,{value:me,enumerable:!0,configurable:!0,writable:!0}):Q[ce]=me,Q}function D(Q,ce){if(!(Q instanceof ce))throw new TypeError("Cannot call a class as a function")}function M(Q,ce){if(!Q)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ce&&(typeof ce=="object"||typeof ce=="function")?ce:Q}function $(Q,ce){if(typeof ce!="function"&&ce!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ce);Q.prototype=Object.create(ce&&ce.prototype,{constructor:{value:Q,enumerable:!1,writable:!0,configurable:!0}}),ce&&(Object.setPrototypeOf?Object.setPrototypeOf(Q,ce):Q.__proto__=ce)}var G=(0,j.default)("quill:keyboard"),re=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",oe=function(Q){$(ce,Q),l(ce,null,[{key:"match",value:function(ge,Ae){return Ae=ae(Ae),["altKey","ctrlKey","metaKey","shiftKey"].some(function(Ve){return!!Ae[Ve]!==ge[Ve]&&Ae[Ve]!==null})?!1:Ae.key===(ge.which||ge.keyCode)}}]);function ce(me,ge){D(this,ce);var Ae=M(this,(ce.__proto__||Object.getPrototypeOf(ce)).call(this,me,ge));return Ae.bindings={},Object.keys(Ae.options.bindings).forEach(function(Ve){Ve==="list autofill"&&me.scroll.whitelist!=null&&!me.scroll.whitelist.list||Ae.options.bindings[Ve]&&Ae.addBinding(Ae.options.bindings[Ve])}),Ae.addBinding({key:ce.keys.ENTER,shiftKey:null},Z),Ae.addBinding({key:ce.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},function(){}),/Firefox/i.test(navigator.userAgent)?(Ae.addBinding({key:ce.keys.BACKSPACE},{collapsed:!0},X),Ae.addBinding({key:ce.keys.DELETE},{collapsed:!0},Y)):(Ae.addBinding({key:ce.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},X),Ae.addBinding({key:ce.keys.DELETE},{collapsed:!0,suffix:/^.?$/},Y)),Ae.addBinding({key:ce.keys.BACKSPACE},{collapsed:!1},B),Ae.addBinding({key:ce.keys.DELETE},{collapsed:!1},B),Ae.addBinding({key:ce.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},X),Ae.listen(),Ae}return l(ce,[{key:"addBinding",value:function(ge){var Ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ve=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},Ye=ae(ge);if(Ye==null||Ye.key==null)return G.warn("Attempted to add invalid keyboard binding",Ye);typeof Ae=="function"&&(Ae={handler:Ae}),typeof Ve=="function"&&(Ve={handler:Ve}),Ye=(0,_.default)(Ye,Ae,Ve),this.bindings[Ye.key]=this.bindings[Ye.key]||[],this.bindings[Ye.key].push(Ye)}},{key:"listen",value:function(){var ge=this;this.quill.root.addEventListener("keydown",function(Ae){if(!Ae.defaultPrevented){var Ve=Ae.which||Ae.keyCode,Ye=(ge.bindings[Ve]||[]).filter(function(Ht){return ce.match(Ae,Ht)});if(Ye.length!==0){var Ge=ge.quill.getSelection();if(!(Ge==null||!ge.quill.hasFocus())){var ot=ge.quill.getLine(Ge.index),nt=o(ot,2),It=nt[0],Gt=nt[1],Se=ge.quill.getLeaf(Ge.index),Ne=o(Se,2),De=Ne[0],ze=Ne[1],ke=Ge.length===0?[De,ze]:ge.quill.getLeaf(Ge.index+Ge.length),gt=o(ke,2),mt=gt[0],pt=gt[1],Ct=De instanceof P.default.Text?De.value().slice(0,ze):"",Mt=mt instanceof P.default.Text?mt.value().slice(pt):"",Dt={collapsed:Ge.length===0,empty:Ge.length===0&&It.length()<=1,format:ge.quill.getFormat(Ge),offset:Gt,prefix:Ct,suffix:Mt},rs=Ye.some(function(Ht){if(Ht.collapsed!=null&&Ht.collapsed!==Dt.collapsed||Ht.empty!=null&&Ht.empty!==Dt.empty||Ht.offset!=null&&Ht.offset!==Dt.offset)return!1;if(Array.isArray(Ht.format)){if(Ht.format.every(function(On){return Dt.format[On]==null}))return!1}else if(s(Ht.format)==="object"&&!Object.keys(Ht.format).every(function(On){return Ht.format[On]===!0?Dt.format[On]!=null:Ht.format[On]===!1?Dt.format[On]==null:(0,y.default)(Ht.format[On],Dt.format[On])}))return!1;return Ht.prefix!=null&&!Ht.prefix.test(Dt.prefix)||Ht.suffix!=null&&!Ht.suffix.test(Dt.suffix)?!1:Ht.handler.call(ge,Ge,Dt)!==!0});rs&&Ae.preventDefault()}}}})}}]),ce}(F.default);oe.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},oe.DEFAULTS={bindings:{bold:se("bold"),italic:se("italic"),underline:se("underline"),indent:{key:oe.keys.TAB,format:["blockquote","indent","list"],handler:function(ce,me){if(me.collapsed&&me.offset!==0)return!0;this.quill.format("indent","+1",R.default.sources.USER)}},outdent:{key:oe.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(ce,me){if(me.collapsed&&me.offset!==0)return!0;this.quill.format("indent","-1",R.default.sources.USER)}},"outdent backspace":{key:oe.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(ce,me){me.format.indent!=null?this.quill.format("indent","-1",R.default.sources.USER):me.format.list!=null&&this.quill.format("list",!1,R.default.sources.USER)}},"indent code-block":te(!0),"outdent code-block":te(!1),"remove tab":{key:oe.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(ce){this.quill.deleteText(ce.index-1,1,R.default.sources.USER)}},tab:{key:oe.keys.TAB,handler:function(ce){this.quill.history.cutoff();var me=new x.default().retain(ce.index).delete(ce.length).insert("	");this.quill.updateContents(me,R.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(ce.index+1,R.default.sources.SILENT)}},"list empty enter":{key:oe.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(ce,me){this.quill.format("list",!1,R.default.sources.USER),me.format.indent&&this.quill.format("indent",!1,R.default.sources.USER)}},"checklist enter":{key:oe.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(ce){var me=this.quill.getLine(ce.index),ge=o(me,2),Ae=ge[0],Ve=ge[1],Ye=(0,_.default)({},Ae.formats(),{list:"checked"}),Ge=new x.default().retain(ce.index).insert(`
`,Ye).retain(Ae.length()-Ve-1).retain(1,{list:"unchecked"});this.quill.updateContents(Ge,R.default.sources.USER),this.quill.setSelection(ce.index+1,R.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:oe.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(ce,me){var ge=this.quill.getLine(ce.index),Ae=o(ge,2),Ve=Ae[0],Ye=Ae[1],Ge=new x.default().retain(ce.index).insert(`
`,me.format).retain(Ve.length()-Ye-1).retain(1,{header:null});this.quill.updateContents(Ge,R.default.sources.USER),this.quill.setSelection(ce.index+1,R.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(ce,me){var ge=me.prefix.length,Ae=this.quill.getLine(ce.index),Ve=o(Ae,2),Ye=Ve[0],Ge=Ve[1];if(Ge>ge)return!0;var ot=void 0;switch(me.prefix.trim()){case"[]":case"[ ]":ot="unchecked";break;case"[x]":ot="checked";break;case"-":case"*":ot="bullet";break;default:ot="ordered"}this.quill.insertText(ce.index," ",R.default.sources.USER),this.quill.history.cutoff();var nt=new x.default().retain(ce.index-Ge).delete(ge+1).retain(Ye.length()-2-Ge).retain(1,{list:ot});this.quill.updateContents(nt,R.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(ce.index-ge,R.default.sources.SILENT)}},"code exit":{key:oe.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(ce){var me=this.quill.getLine(ce.index),ge=o(me,2),Ae=ge[0],Ve=ge[1],Ye=new x.default().retain(ce.index+Ae.length()-Ve-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(Ye,R.default.sources.USER)}},"embed left":ie(oe.keys.LEFT,!1),"embed left shift":ie(oe.keys.LEFT,!0),"embed right":ie(oe.keys.RIGHT,!1),"embed right shift":ie(oe.keys.RIGHT,!0)}};function ie(Q,ce){var me,ge=Q===oe.keys.LEFT?"prefix":"suffix";return me={key:Q,shiftKey:ce,altKey:null},C(me,ge,/^$/),C(me,"handler",function(Ve){var Ye=Ve.index;Q===oe.keys.RIGHT&&(Ye+=Ve.length+1);var Ge=this.quill.getLeaf(Ye),ot=o(Ge,1),nt=ot[0];return nt instanceof P.default.Embed?(Q===oe.keys.LEFT?ce?this.quill.setSelection(Ve.index-1,Ve.length+1,R.default.sources.USER):this.quill.setSelection(Ve.index-1,R.default.sources.USER):ce?this.quill.setSelection(Ve.index,Ve.length+1,R.default.sources.USER):this.quill.setSelection(Ve.index+Ve.length+1,R.default.sources.USER),!1):!0}),me}function X(Q,ce){if(!(Q.index===0||this.quill.getLength()<=1)){var me=this.quill.getLine(Q.index),ge=o(me,1),Ae=ge[0],Ve={};if(ce.offset===0){var Ye=this.quill.getLine(Q.index-1),Ge=o(Ye,1),ot=Ge[0];if(ot!=null&&ot.length()>1){var nt=Ae.formats(),It=this.quill.getFormat(Q.index-1,1);Ve=S.default.attributes.diff(nt,It)||{}}}var Gt=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(ce.prefix)?2:1;this.quill.deleteText(Q.index-Gt,Gt,R.default.sources.USER),Object.keys(Ve).length>0&&this.quill.formatLine(Q.index-Gt,Gt,Ve,R.default.sources.USER),this.quill.focus()}}function Y(Q,ce){var me=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(ce.suffix)?2:1;if(!(Q.index>=this.quill.getLength()-me)){var ge={},Ae=0,Ve=this.quill.getLine(Q.index),Ye=o(Ve,1),Ge=Ye[0];if(ce.offset>=Ge.length()-1){var ot=this.quill.getLine(Q.index+1),nt=o(ot,1),It=nt[0];if(It){var Gt=Ge.formats(),Se=this.quill.getFormat(Q.index,1);ge=S.default.attributes.diff(Gt,Se)||{},Ae=It.length()}}this.quill.deleteText(Q.index,me,R.default.sources.USER),Object.keys(ge).length>0&&this.quill.formatLine(Q.index+Ae-1,me,ge,R.default.sources.USER)}}function B(Q){var ce=this.quill.getLines(Q),me={};if(ce.length>1){var ge=ce[0].formats(),Ae=ce[ce.length-1].formats();me=S.default.attributes.diff(Ae,ge)||{}}this.quill.deleteText(Q,R.default.sources.USER),Object.keys(me).length>0&&this.quill.formatLine(Q.index,1,me,R.default.sources.USER),this.quill.setSelection(Q.index,R.default.sources.SILENT),this.quill.focus()}function Z(Q,ce){var me=this;Q.length>0&&this.quill.scroll.deleteAt(Q.index,Q.length);var ge=Object.keys(ce.format).reduce(function(Ae,Ve){return P.default.query(Ve,P.default.Scope.BLOCK)&&!Array.isArray(ce.format[Ve])&&(Ae[Ve]=ce.format[Ve]),Ae},{});this.quill.insertText(Q.index,`
`,ge,R.default.sources.USER),this.quill.setSelection(Q.index+1,R.default.sources.SILENT),this.quill.focus(),Object.keys(ce.format).forEach(function(Ae){ge[Ae]==null&&(Array.isArray(ce.format[Ae])||Ae!=="link"&&me.quill.format(Ae,ce.format[Ae],R.default.sources.USER))})}function te(Q){return{key:oe.keys.TAB,shiftKey:!Q,format:{"code-block":!0},handler:function(me){var ge=P.default.query("code-block"),Ae=me.index,Ve=me.length,Ye=this.quill.scroll.descendant(ge,Ae),Ge=o(Ye,2),ot=Ge[0],nt=Ge[1];if(ot!=null){var It=this.quill.getIndex(ot),Gt=ot.newlineIndex(nt,!0)+1,Se=ot.newlineIndex(It+nt+Ve),Ne=ot.domNode.textContent.slice(Gt,Se).split(`
`);nt=0,Ne.forEach(function(De,ze){Q?(ot.insertAt(Gt+nt,ge.TAB),nt+=ge.TAB.length,ze===0?Ae+=ge.TAB.length:Ve+=ge.TAB.length):De.startsWith(ge.TAB)&&(ot.deleteAt(Gt+nt,ge.TAB.length),nt-=ge.TAB.length,ze===0?Ae-=ge.TAB.length:Ve-=ge.TAB.length),nt+=De.length+1}),this.quill.update(R.default.sources.USER),this.quill.setSelection(Ae,Ve,R.default.sources.SILENT)}}}}function se(Q){return{key:Q[0].toUpperCase(),shortKey:!0,handler:function(me,ge){this.quill.format(Q,!ge.format[Q],R.default.sources.USER)}}}function ae(Q){if(typeof Q=="string"||typeof Q=="number")return ae({key:Q});if((typeof Q>"u"?"undefined":s(Q))==="object"&&(Q=(0,f.default)(Q,!1)),typeof Q.key=="string")if(oe.keys[Q.key.toUpperCase()]!=null)Q.key=oe.keys[Q.key.toUpperCase()];else if(Q.key.length===1)Q.key=Q.key.toUpperCase().charCodeAt(0);else return null;return Q.shortKey&&(Q[re]=Q.shortKey,delete Q.shortKey),Q}r.default=oe,r.SHORTKEY=re},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function S(N,P){var I=[],R=!0,U=!1,j=void 0;try{for(var k=N[Symbol.iterator](),F;!(R=(F=k.next()).done)&&(I.push(F.value),!(P&&I.length===P));R=!0);}catch(O){U=!0,j=O}finally{try{!R&&k.return&&k.return()}finally{if(U)throw j}}return I}return function(N,P){if(Array.isArray(N))return N;if(Symbol.iterator in Object(N))return S(N,P);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function S(N,P,I){N===null&&(N=Function.prototype);var R=Object.getOwnPropertyDescriptor(N,P);if(R===void 0){var U=Object.getPrototypeOf(N);return U===null?void 0:S(U,P,I)}else{if("value"in R)return R.value;var j=R.get;return j===void 0?void 0:j.call(I)}},l=function(){function S(N,P){for(var I=0;I<P.length;I++){var R=P[I];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(N,R.key,R)}}return function(N,P,I){return P&&S(N.prototype,P),I&&S(N,I),N}}(),d=i(0),f=g(d),m=i(7),y=g(m);function g(S){return S&&S.__esModule?S:{default:S}}function _(S,N){if(!(S instanceof N))throw new TypeError("Cannot call a class as a function")}function E(S,N){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:S}function x(S,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);S.prototype=Object.create(N&&N.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(S,N):S.__proto__=N)}var w=function(S){x(N,S),l(N,null,[{key:"value",value:function(){}}]);function N(P,I){_(this,N);var R=E(this,(N.__proto__||Object.getPrototypeOf(N)).call(this,P));return R.selection=I,R.textNode=document.createTextNode(N.CONTENTS),R.domNode.appendChild(R.textNode),R._length=0,R}return l(N,[{key:"detach",value:function(){this.parent!=null&&this.parent.removeChild(this)}},{key:"format",value:function(I,R){if(this._length!==0)return o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"format",this).call(this,I,R);for(var U=this,j=0;U!=null&&U.statics.scope!==f.default.Scope.BLOCK_BLOT;)j+=U.offset(U.parent),U=U.parent;U!=null&&(this._length=N.CONTENTS.length,U.optimize(),U.formatAt(j,N.CONTENTS.length,I,R),this._length=0)}},{key:"index",value:function(I,R){return I===this.textNode?0:o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"index",this).call(this,I,R)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!(this.selection.composing||this.parent==null)){var I=this.textNode,R=this.selection.getNativeRange(),U=void 0,j=void 0,k=void 0;if(R!=null&&R.start.node===I&&R.end.node===I){var F=[I,R.start.offset,R.end.offset];U=F[0],j=F[1],k=F[2]}for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==N.CONTENTS){var O=this.textNode.data.split(N.CONTENTS).join("");this.next instanceof y.default?(U=this.next.domNode,this.next.insertAt(0,O),this.textNode.data=N.CONTENTS):(this.textNode.data=O,this.parent.insertBefore(f.default.create(this.textNode),this),this.textNode=document.createTextNode(N.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),j!=null){var C=[j,k].map(function(M){return Math.max(0,Math.min(U.data.length,M-1))}),D=s(C,2);return j=D[0],k=D[1],{startNode:U,startOffset:j,endNode:U,endOffset:k}}}}},{key:"update",value:function(I,R){var U=this;if(I.some(function(k){return k.type==="characterData"&&k.target===U.textNode})){var j=this.restore();j&&(R.range=j)}}},{key:"value",value:function(){return""}}]),N}(f.default.Embed);w.blotName="cursor",w.className="ql-cursor",w.tagName="span",w.CONTENTS="\uFEFF",r.default=w},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=i(0),o=f(s),l=i(4),d=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function y(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var _=function(E){g(x,E);function x(){return m(this,x),y(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return x}(o.default.Container);_.allowedChildren=[d.default,l.BlockEmbed,_],r.default=_},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.ColorStyle=r.ColorClass=r.ColorAttributor=void 0;var s=function(){function w(S,N){for(var P=0;P<N.length;P++){var I=N[P];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(S,I.key,I)}}return function(S,N,P){return N&&w(S.prototype,N),P&&w(S,P),S}}(),o=function w(S,N,P){S===null&&(S=Function.prototype);var I=Object.getOwnPropertyDescriptor(S,N);if(I===void 0){var R=Object.getPrototypeOf(S);return R===null?void 0:w(R,N,P)}else{if("value"in I)return I.value;var U=I.get;return U===void 0?void 0:U.call(P)}},l=i(0),d=f(l);function f(w){return w&&w.__esModule?w:{default:w}}function m(w,S){if(!(w instanceof S))throw new TypeError("Cannot call a class as a function")}function y(w,S){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:w}function g(w,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);w.prototype=Object.create(S&&S.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(w,S):w.__proto__=S)}var _=function(w){g(S,w);function S(){return m(this,S),y(this,(S.__proto__||Object.getPrototypeOf(S)).apply(this,arguments))}return s(S,[{key:"value",value:function(P){var I=o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"value",this).call(this,P);return I.startsWith("rgb(")?(I=I.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+I.split(",").map(function(R){return("00"+parseInt(R).toString(16)).slice(-2)}).join("")):I}}]),S}(d.default.Attributor.Style),E=new d.default.Attributor.Class("color","ql-color",{scope:d.default.Scope.INLINE}),x=new _("color","color",{scope:d.default.Scope.INLINE});r.ColorAttributor=_,r.ColorClass=E,r.ColorStyle=x},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.sanitize=r.default=void 0;var s=function(){function x(w,S){for(var N=0;N<S.length;N++){var P=S[N];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(w,P.key,P)}}return function(w,S,N){return S&&x(w.prototype,S),N&&x(w,N),w}}(),o=function x(w,S,N){w===null&&(w=Function.prototype);var P=Object.getOwnPropertyDescriptor(w,S);if(P===void 0){var I=Object.getPrototypeOf(w);return I===null?void 0:x(I,S,N)}else{if("value"in P)return P.value;var R=P.get;return R===void 0?void 0:R.call(N)}},l=i(6),d=f(l);function f(x){return x&&x.__esModule?x:{default:x}}function m(x,w){if(!(x instanceof w))throw new TypeError("Cannot call a class as a function")}function y(x,w){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:x}function g(x,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);x.prototype=Object.create(w&&w.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(x,w):x.__proto__=w)}var _=function(x){g(w,x);function w(){return m(this,w),y(this,(w.__proto__||Object.getPrototypeOf(w)).apply(this,arguments))}return s(w,[{key:"format",value:function(N,P){if(N!==this.statics.blotName||!P)return o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"format",this).call(this,N,P);P=this.constructor.sanitize(P),this.domNode.setAttribute("href",P)}}],[{key:"create",value:function(N){var P=o(w.__proto__||Object.getPrototypeOf(w),"create",this).call(this,N);return N=this.sanitize(N),P.setAttribute("href",N),P.setAttribute("rel","noopener noreferrer"),P.setAttribute("target","_blank"),P}},{key:"formats",value:function(N){return N.getAttribute("href")}},{key:"sanitize",value:function(N){return E(N,this.PROTOCOL_WHITELIST)?N:this.SANITIZED_URL}}]),w}(d.default);_.blotName="link",_.tagName="A",_.SANITIZED_URL="about:blank",_.PROTOCOL_WHITELIST=["http","https","mailto","tel"];function E(x,w){var S=document.createElement("a");S.href=x;var N=S.href.slice(0,S.href.indexOf(":"));return w.indexOf(N)>-1}r.default=_,r.sanitize=E},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w},o=function(){function w(S,N){for(var P=0;P<N.length;P++){var I=N[P];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(S,I.key,I)}}return function(S,N,P){return N&&w(S.prototype,N),P&&w(S,P),S}}(),l=i(23),d=y(l),f=i(107),m=y(f);function y(w){return w&&w.__esModule?w:{default:w}}function g(w,S){if(!(w instanceof S))throw new TypeError("Cannot call a class as a function")}var _=0;function E(w,S){w.setAttribute(S,w.getAttribute(S)!=="true")}var x=function(){function w(S){var N=this;g(this,w),this.select=S,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",function(){N.togglePicker()}),this.label.addEventListener("keydown",function(P){switch(P.keyCode){case d.default.keys.ENTER:N.togglePicker();break;case d.default.keys.ESCAPE:N.escape(),P.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}return o(w,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),E(this.label,"aria-expanded"),E(this.options,"aria-hidden")}},{key:"buildItem",value:function(N){var P=this,I=document.createElement("span");return I.tabIndex="0",I.setAttribute("role","button"),I.classList.add("ql-picker-item"),N.hasAttribute("value")&&I.setAttribute("data-value",N.getAttribute("value")),N.textContent&&I.setAttribute("data-label",N.textContent),I.addEventListener("click",function(){P.selectItem(I,!0)}),I.addEventListener("keydown",function(R){switch(R.keyCode){case d.default.keys.ENTER:P.selectItem(I,!0),R.preventDefault();break;case d.default.keys.ESCAPE:P.escape(),R.preventDefault();break}}),I}},{key:"buildLabel",value:function(){var N=document.createElement("span");return N.classList.add("ql-picker-label"),N.innerHTML=m.default,N.tabIndex="0",N.setAttribute("role","button"),N.setAttribute("aria-expanded","false"),this.container.appendChild(N),N}},{key:"buildOptions",value:function(){var N=this,P=document.createElement("span");P.classList.add("ql-picker-options"),P.setAttribute("aria-hidden","true"),P.tabIndex="-1",P.id="ql-picker-options-"+_,_+=1,this.label.setAttribute("aria-controls",P.id),this.options=P,[].slice.call(this.select.options).forEach(function(I){var R=N.buildItem(I);P.appendChild(R),I.selected===!0&&N.selectItem(R)}),this.container.appendChild(P)}},{key:"buildPicker",value:function(){var N=this;[].slice.call(this.select.attributes).forEach(function(P){N.container.setAttribute(P.name,P.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var N=this;this.close(),setTimeout(function(){return N.label.focus()},1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(N){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,I=this.container.querySelector(".ql-selected");if(N!==I&&(I!=null&&I.classList.remove("ql-selected"),N!=null&&(N.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(N.parentNode.children,N),N.hasAttribute("data-value")?this.label.setAttribute("data-value",N.getAttribute("data-value")):this.label.removeAttribute("data-value"),N.hasAttribute("data-label")?this.label.setAttribute("data-label",N.getAttribute("data-label")):this.label.removeAttribute("data-label"),P))){if(typeof Event=="function")this.select.dispatchEvent(new Event("change"));else if((typeof Event>"u"?"undefined":s(Event))==="object"){var R=document.createEvent("Event");R.initEvent("change",!0,!0),this.select.dispatchEvent(R)}this.close()}}},{key:"update",value:function(){var N=void 0;if(this.select.selectedIndex>-1){var P=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];N=this.select.options[this.select.selectedIndex],this.selectItem(P)}else this.selectItem(null);var I=N!=null&&N!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",I)}}]),w}();r.default=x},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=i(0),o=G(s),l=i(5),d=G(l),f=i(4),m=G(f),y=i(16),g=G(y),_=i(25),E=G(_),x=i(24),w=G(x),S=i(35),N=G(S),P=i(6),I=G(P),R=i(22),U=G(R),j=i(7),k=G(j),F=i(55),O=G(F),C=i(42),D=G(C),M=i(23),$=G(M);function G(re){return re&&re.__esModule?re:{default:re}}d.default.register({"blots/block":m.default,"blots/block/embed":f.BlockEmbed,"blots/break":g.default,"blots/container":E.default,"blots/cursor":w.default,"blots/embed":N.default,"blots/inline":I.default,"blots/scroll":U.default,"blots/text":k.default,"modules/clipboard":O.default,"modules/history":D.default,"modules/keyboard":$.default}),o.default.register(m.default,g.default,w.default,I.default,U.default,k.default),r.default=d.default},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=i(1),o=function(){function l(d){this.domNode=d,this.domNode[s.DATA_KEY]={blot:this}}return Object.defineProperty(l.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),l.create=function(d){if(this.tagName==null)throw new s.ParchmentError("Blot definition missing tagName");var f;return Array.isArray(this.tagName)?(typeof d=="string"&&(d=d.toUpperCase(),parseInt(d).toString()===d&&(d=parseInt(d))),typeof d=="number"?f=document.createElement(this.tagName[d-1]):this.tagName.indexOf(d)>-1?f=document.createElement(d):f=document.createElement(this.tagName[0])):f=document.createElement(this.tagName),this.className&&f.classList.add(this.className),f},l.prototype.attach=function(){this.parent!=null&&(this.scroll=this.parent.scroll)},l.prototype.clone=function(){var d=this.domNode.cloneNode(!1);return s.create(d)},l.prototype.detach=function(){this.parent!=null&&this.parent.removeChild(this),delete this.domNode[s.DATA_KEY]},l.prototype.deleteAt=function(d,f){var m=this.isolate(d,f);m.remove()},l.prototype.formatAt=function(d,f,m,y){var g=this.isolate(d,f);if(s.query(m,s.Scope.BLOT)!=null&&y)g.wrap(m,y);else if(s.query(m,s.Scope.ATTRIBUTE)!=null){var _=s.create(this.statics.scope);g.wrap(_),_.format(m,y)}},l.prototype.insertAt=function(d,f,m){var y=m==null?s.create("text",f):s.create(f,m),g=this.split(d);this.parent.insertBefore(y,g)},l.prototype.insertInto=function(d,f){f===void 0&&(f=null),this.parent!=null&&this.parent.children.remove(this);var m=null;d.children.insertBefore(this,f),f!=null&&(m=f.domNode),(this.domNode.parentNode!=d.domNode||this.domNode.nextSibling!=m)&&d.domNode.insertBefore(this.domNode,m),this.parent=d,this.attach()},l.prototype.isolate=function(d,f){var m=this.split(d);return m.split(f),m},l.prototype.length=function(){return 1},l.prototype.offset=function(d){return d===void 0&&(d=this.parent),this.parent==null||this==d?0:this.parent.children.offset(this)+this.parent.offset(d)},l.prototype.optimize=function(d){this.domNode[s.DATA_KEY]!=null&&delete this.domNode[s.DATA_KEY].mutations},l.prototype.remove=function(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},l.prototype.replace=function(d){d.parent!=null&&(d.parent.insertBefore(this,d.next),d.remove())},l.prototype.replaceWith=function(d,f){var m=typeof d=="string"?s.create(d,f):d;return m.replace(this),m},l.prototype.split=function(d,f){return d===0?this:this.next},l.prototype.update=function(d,f){},l.prototype.wrap=function(d,f){var m=typeof d=="string"?s.create(d,f):d;return this.parent!=null&&this.parent.insertBefore(m,this.next),m.appendChild(this),m},l.blotName="abstract",l}();r.default=o},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=i(12),o=i(32),l=i(33),d=i(1),f=function(){function m(y){this.attributes={},this.domNode=y,this.build()}return m.prototype.attribute=function(y,g){g?y.add(this.domNode,g)&&(y.value(this.domNode)!=null?this.attributes[y.attrName]=y:delete this.attributes[y.attrName]):(y.remove(this.domNode),delete this.attributes[y.attrName])},m.prototype.build=function(){var y=this;this.attributes={};var g=s.default.keys(this.domNode),_=o.default.keys(this.domNode),E=l.default.keys(this.domNode);g.concat(_).concat(E).forEach(function(x){var w=d.query(x,d.Scope.ATTRIBUTE);w instanceof s.default&&(y.attributes[w.attrName]=w)})},m.prototype.copy=function(y){var g=this;Object.keys(this.attributes).forEach(function(_){var E=g.attributes[_].value(g.domNode);y.format(_,E)})},m.prototype.move=function(y){var g=this;this.copy(y),Object.keys(this.attributes).forEach(function(_){g.attributes[_].remove(g.domNode)}),this.attributes={}},m.prototype.values=function(){var y=this;return Object.keys(this.attributes).reduce(function(g,_){return g[_]=y.attributes[_].value(y.domNode),g},{})},m}();r.default=f},function(t,r,i){var s=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var g in y)y.hasOwnProperty(g)&&(m[g]=y[g])};return function(m,y){f(m,y);function g(){this.constructor=m}m.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=i(12);function l(f,m){var y=f.getAttribute("class")||"";return y.split(/\s+/).filter(function(g){return g.indexOf(m+"-")===0})}var d=function(f){s(m,f);function m(){return f!==null&&f.apply(this,arguments)||this}return m.keys=function(y){return(y.getAttribute("class")||"").split(/\s+/).map(function(g){return g.split("-").slice(0,-1).join("-")})},m.prototype.add=function(y,g){return this.canAdd(y,g)?(this.remove(y),y.classList.add(this.keyName+"-"+g),!0):!1},m.prototype.remove=function(y){var g=l(y,this.keyName);g.forEach(function(_){y.classList.remove(_)}),y.classList.length===0&&y.removeAttribute("class")},m.prototype.value=function(y){var g=l(y,this.keyName)[0]||"",_=g.slice(this.keyName.length+1);return this.canAdd(y,_)?_:""},m}(o.default);r.default=d},function(t,r,i){var s=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var g in y)y.hasOwnProperty(g)&&(m[g]=y[g])};return function(m,y){f(m,y);function g(){this.constructor=m}m.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=i(12);function l(f){var m=f.split("-"),y=m.slice(1).map(function(g){return g[0].toUpperCase()+g.slice(1)}).join("");return m[0]+y}var d=function(f){s(m,f);function m(){return f!==null&&f.apply(this,arguments)||this}return m.keys=function(y){return(y.getAttribute("style")||"").split(";").map(function(g){var _=g.split(":");return _[0].trim()})},m.prototype.add=function(y,g){return this.canAdd(y,g)?(y.style[l(this.keyName)]=g,!0):!1},m.prototype.remove=function(y){y.style[l(this.keyName)]="",y.getAttribute("style")||y.removeAttribute("style")},m.prototype.value=function(y){var g=y.style[l(this.keyName)];return this.canAdd(y,g)?g:""},m}(o.default);r.default=d},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function d(f,m){for(var y=0;y<m.length;y++){var g=m[y];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(f,m,y){return m&&d(f.prototype,m),y&&d(f,y),f}}();function o(d,f){if(!(d instanceof f))throw new TypeError("Cannot call a class as a function")}var l=function(){function d(f,m){o(this,d),this.quill=f,this.options=m,this.modules={}}return s(d,[{key:"init",value:function(){var m=this;Object.keys(this.options.modules).forEach(function(y){m.modules[y]==null&&m.addModule(y)})}},{key:"addModule",value:function(m){var y=this.quill.constructor.import("modules/"+m);return this.modules[m]=new y(this.quill,this.options.modules[m]||{}),this.modules[m]}}]),d}();l.DEFAULTS={modules:{}},l.themes={default:l},r.default=l},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function S(N,P){for(var I=0;I<P.length;I++){var R=P[I];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(N,R.key,R)}}return function(N,P,I){return P&&S(N.prototype,P),I&&S(N,I),N}}(),o=function S(N,P,I){N===null&&(N=Function.prototype);var R=Object.getOwnPropertyDescriptor(N,P);if(R===void 0){var U=Object.getPrototypeOf(N);return U===null?void 0:S(U,P,I)}else{if("value"in R)return R.value;var j=R.get;return j===void 0?void 0:j.call(I)}},l=i(0),d=y(l),f=i(7),m=y(f);function y(S){return S&&S.__esModule?S:{default:S}}function g(S,N){if(!(S instanceof N))throw new TypeError("Cannot call a class as a function")}function _(S,N){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:S}function E(S,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);S.prototype=Object.create(N&&N.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(S,N):S.__proto__=N)}var x="\uFEFF",w=function(S){E(N,S);function N(P){g(this,N);var I=_(this,(N.__proto__||Object.getPrototypeOf(N)).call(this,P));return I.contentNode=document.createElement("span"),I.contentNode.setAttribute("contenteditable",!1),[].slice.call(I.domNode.childNodes).forEach(function(R){I.contentNode.appendChild(R)}),I.leftGuard=document.createTextNode(x),I.rightGuard=document.createTextNode(x),I.domNode.appendChild(I.leftGuard),I.domNode.appendChild(I.contentNode),I.domNode.appendChild(I.rightGuard),I}return s(N,[{key:"index",value:function(I,R){return I===this.leftGuard?0:I===this.rightGuard?1:o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"index",this).call(this,I,R)}},{key:"restore",value:function(I){var R=void 0,U=void 0,j=I.data.split(x).join("");if(I===this.leftGuard)if(this.prev instanceof m.default){var k=this.prev.length();this.prev.insertAt(k,j),R={startNode:this.prev.domNode,startOffset:k+j.length}}else U=document.createTextNode(j),this.parent.insertBefore(d.default.create(U),this),R={startNode:U,startOffset:j.length};else I===this.rightGuard&&(this.next instanceof m.default?(this.next.insertAt(0,j),R={startNode:this.next.domNode,startOffset:j.length}):(U=document.createTextNode(j),this.parent.insertBefore(d.default.create(U),this.next),R={startNode:U,startOffset:j.length}));return I.data=x,R}},{key:"update",value:function(I,R){var U=this;I.forEach(function(j){if(j.type==="characterData"&&(j.target===U.leftGuard||j.target===U.rightGuard)){var k=U.restore(j.target);k&&(R.range=k)}})}}]),N}(d.default.Embed);r.default=w},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.AlignStyle=r.AlignClass=r.AlignAttribute=void 0;var s=i(0),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}var d={scope:o.default.Scope.BLOCK,whitelist:["right","center","justify"]},f=new o.default.Attributor.Attribute("align","align",d),m=new o.default.Attributor.Class("align","ql-align",d),y=new o.default.Attributor.Style("align","text-align",d);r.AlignAttribute=f,r.AlignClass=m,r.AlignStyle=y},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.BackgroundStyle=r.BackgroundClass=void 0;var s=i(0),o=d(s),l=i(26);function d(y){return y&&y.__esModule?y:{default:y}}var f=new o.default.Attributor.Class("background","ql-bg",{scope:o.default.Scope.INLINE}),m=new l.ColorAttributor("background","background-color",{scope:o.default.Scope.INLINE});r.BackgroundClass=f,r.BackgroundStyle=m},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.DirectionStyle=r.DirectionClass=r.DirectionAttribute=void 0;var s=i(0),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}var d={scope:o.default.Scope.BLOCK,whitelist:["rtl"]},f=new o.default.Attributor.Attribute("direction","dir",d),m=new o.default.Attributor.Class("direction","ql-direction",d),y=new o.default.Attributor.Style("direction","direction",d);r.DirectionAttribute=f,r.DirectionClass=m,r.DirectionStyle=y},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.FontClass=r.FontStyle=void 0;var s=function(){function S(N,P){for(var I=0;I<P.length;I++){var R=P[I];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(N,R.key,R)}}return function(N,P,I){return P&&S(N.prototype,P),I&&S(N,I),N}}(),o=function S(N,P,I){N===null&&(N=Function.prototype);var R=Object.getOwnPropertyDescriptor(N,P);if(R===void 0){var U=Object.getPrototypeOf(N);return U===null?void 0:S(U,P,I)}else{if("value"in R)return R.value;var j=R.get;return j===void 0?void 0:j.call(I)}},l=i(0),d=f(l);function f(S){return S&&S.__esModule?S:{default:S}}function m(S,N){if(!(S instanceof N))throw new TypeError("Cannot call a class as a function")}function y(S,N){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:S}function g(S,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);S.prototype=Object.create(N&&N.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(S,N):S.__proto__=N)}var _={scope:d.default.Scope.INLINE,whitelist:["serif","monospace"]},E=new d.default.Attributor.Class("font","ql-font",_),x=function(S){g(N,S);function N(){return m(this,N),y(this,(N.__proto__||Object.getPrototypeOf(N)).apply(this,arguments))}return s(N,[{key:"value",value:function(I){return o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"value",this).call(this,I).replace(/["']/g,"")}}]),N}(d.default.Attributor.Style),w=new x("font","font-family",_);r.FontStyle=w,r.FontClass=E},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.SizeStyle=r.SizeClass=void 0;var s=i(0),o=l(s);function l(m){return m&&m.__esModule?m:{default:m}}var d=new o.default.Attributor.Class("size","ql-size",{scope:o.default.Scope.INLINE,whitelist:["small","large","huge"]}),f=new o.default.Attributor.Style("size","font-size",{scope:o.default.Scope.INLINE,whitelist:["10px","18px","32px"]});r.SizeClass=d,r.SizeStyle=f},function(t,r,i){t.exports={align:{"":i(76),center:i(77),right:i(78),justify:i(79)},background:i(80),blockquote:i(81),bold:i(82),clean:i(83),code:i(58),"code-block":i(58),color:i(84),direction:{"":i(85),rtl:i(86)},float:{center:i(87),full:i(88),left:i(89),right:i(90)},formula:i(91),header:{1:i(92),2:i(93)},italic:i(94),image:i(95),indent:{"+1":i(96),"-1":i(97)},link:i(98),list:{ordered:i(99),bullet:i(100),check:i(101)},script:{sub:i(102),super:i(103)},strike:i(104),underline:i(105),video:i(106)}},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.getLastChangeIndex=r.default=void 0;var s=function(){function P(I,R){for(var U=0;U<R.length;U++){var j=R[U];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(I,j.key,j)}}return function(I,R,U){return R&&P(I.prototype,R),U&&P(I,U),I}}(),o=i(0),l=g(o),d=i(5),f=g(d),m=i(9),y=g(m);function g(P){return P&&P.__esModule?P:{default:P}}function _(P,I){if(!(P instanceof I))throw new TypeError("Cannot call a class as a function")}function E(P,I){if(!P)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I&&(typeof I=="object"||typeof I=="function")?I:P}function x(P,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof I);P.prototype=Object.create(I&&I.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),I&&(Object.setPrototypeOf?Object.setPrototypeOf(P,I):P.__proto__=I)}var w=function(P){x(I,P);function I(R,U){_(this,I);var j=E(this,(I.__proto__||Object.getPrototypeOf(I)).call(this,R,U));return j.lastRecorded=0,j.ignoreChange=!1,j.clear(),j.quill.on(f.default.events.EDITOR_CHANGE,function(k,F,O,C){k!==f.default.events.TEXT_CHANGE||j.ignoreChange||(!j.options.userOnly||C===f.default.sources.USER?j.record(F,O):j.transform(F))}),j.quill.keyboard.addBinding({key:"Z",shortKey:!0},j.undo.bind(j)),j.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},j.redo.bind(j)),/Win/i.test(navigator.platform)&&j.quill.keyboard.addBinding({key:"Y",shortKey:!0},j.redo.bind(j)),j}return s(I,[{key:"change",value:function(U,j){if(this.stack[U].length!==0){var k=this.stack[U].pop();this.stack[j].push(k),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(k[U],f.default.sources.USER),this.ignoreChange=!1;var F=N(k[U]);this.quill.setSelection(F)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(U,j){if(U.ops.length!==0){this.stack.redo=[];var k=this.quill.getContents().diff(j),F=Date.now();if(this.lastRecorded+this.options.delay>F&&this.stack.undo.length>0){var O=this.stack.undo.pop();k=k.compose(O.undo),U=O.redo.compose(U)}else this.lastRecorded=F;this.stack.undo.push({redo:U,undo:k}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(U){this.stack.undo.forEach(function(j){j.undo=U.transform(j.undo,!0),j.redo=U.transform(j.redo,!0)}),this.stack.redo.forEach(function(j){j.undo=U.transform(j.undo,!0),j.redo=U.transform(j.redo,!0)})}},{key:"undo",value:function(){this.change("undo","redo")}}]),I}(y.default);w.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};function S(P){var I=P.ops[P.ops.length-1];return I==null?!1:I.insert!=null?typeof I.insert=="string"&&I.insert.endsWith(`
`):I.attributes!=null?Object.keys(I.attributes).some(function(R){return l.default.query(R,l.default.Scope.BLOCK)!=null}):!1}function N(P){var I=P.reduce(function(U,j){return U+=j.delete||0,U},0),R=P.length()-I;return S(P)&&(R-=1),R}r.default=w,r.getLastChangeIndex=N},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.BaseTooltip=void 0;var s=function(){function Z(te,se){for(var ae=0;ae<se.length;ae++){var Q=se[ae];Q.enumerable=Q.enumerable||!1,Q.configurable=!0,"value"in Q&&(Q.writable=!0),Object.defineProperty(te,Q.key,Q)}}return function(te,se,ae){return se&&Z(te.prototype,se),ae&&Z(te,ae),te}}(),o=function Z(te,se,ae){te===null&&(te=Function.prototype);var Q=Object.getOwnPropertyDescriptor(te,se);if(Q===void 0){var ce=Object.getPrototypeOf(te);return ce===null?void 0:Z(ce,se,ae)}else{if("value"in Q)return Q.value;var me=Q.get;return me===void 0?void 0:me.call(ae)}},l=i(3),d=F(l),f=i(2),m=F(f),y=i(8),g=F(y),_=i(23),E=F(_),x=i(34),w=F(x),S=i(59),N=F(S),P=i(60),I=F(P),R=i(28),U=F(R),j=i(61),k=F(j);function F(Z){return Z&&Z.__esModule?Z:{default:Z}}function O(Z,te){if(!(Z instanceof te))throw new TypeError("Cannot call a class as a function")}function C(Z,te){if(!Z)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return te&&(typeof te=="object"||typeof te=="function")?te:Z}function D(Z,te){if(typeof te!="function"&&te!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof te);Z.prototype=Object.create(te&&te.prototype,{constructor:{value:Z,enumerable:!1,writable:!0,configurable:!0}}),te&&(Object.setPrototypeOf?Object.setPrototypeOf(Z,te):Z.__proto__=te)}var M=[!1,"center","right","justify"],$=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],G=[!1,"serif","monospace"],re=["1","2","3",!1],oe=["small",!1,"large","huge"],ie=function(Z){D(te,Z);function te(se,ae){O(this,te);var Q=C(this,(te.__proto__||Object.getPrototypeOf(te)).call(this,se,ae)),ce=function me(ge){if(!document.body.contains(se.root))return document.body.removeEventListener("click",me);Q.tooltip!=null&&!Q.tooltip.root.contains(ge.target)&&document.activeElement!==Q.tooltip.textbox&&!Q.quill.hasFocus()&&Q.tooltip.hide(),Q.pickers!=null&&Q.pickers.forEach(function(Ae){Ae.container.contains(ge.target)||Ae.close()})};return se.emitter.listenDOM("click",document.body,ce),Q}return s(te,[{key:"addModule",value:function(ae){var Q=o(te.prototype.__proto__||Object.getPrototypeOf(te.prototype),"addModule",this).call(this,ae);return ae==="toolbar"&&this.extendToolbar(Q),Q}},{key:"buildButtons",value:function(ae,Q){ae.forEach(function(ce){var me=ce.getAttribute("class")||"";me.split(/\s+/).forEach(function(ge){if(ge.startsWith("ql-")&&(ge=ge.slice(3),Q[ge]!=null))if(ge==="direction")ce.innerHTML=Q[ge][""]+Q[ge].rtl;else if(typeof Q[ge]=="string")ce.innerHTML=Q[ge];else{var Ae=ce.value||"";Ae!=null&&Q[ge][Ae]&&(ce.innerHTML=Q[ge][Ae])}})})}},{key:"buildPickers",value:function(ae,Q){var ce=this;this.pickers=ae.map(function(ge){if(ge.classList.contains("ql-align"))return ge.querySelector("option")==null&&B(ge,M),new I.default(ge,Q.align);if(ge.classList.contains("ql-background")||ge.classList.contains("ql-color")){var Ae=ge.classList.contains("ql-background")?"background":"color";return ge.querySelector("option")==null&&B(ge,$,Ae==="background"?"#ffffff":"#000000"),new N.default(ge,Q[Ae])}else return ge.querySelector("option")==null&&(ge.classList.contains("ql-font")?B(ge,G):ge.classList.contains("ql-header")?B(ge,re):ge.classList.contains("ql-size")&&B(ge,oe)),new U.default(ge)});var me=function(){ce.pickers.forEach(function(Ae){Ae.update()})};this.quill.on(g.default.events.EDITOR_CHANGE,me)}}]),te}(w.default);ie.DEFAULTS=(0,d.default)(!0,{},w.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var te=this,se=this.container.querySelector("input.ql-image[type=file]");se==null&&(se=document.createElement("input"),se.setAttribute("type","file"),se.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),se.classList.add("ql-image"),se.addEventListener("change",function(){if(se.files!=null&&se.files[0]!=null){var ae=new FileReader;ae.onload=function(Q){var ce=te.quill.getSelection(!0);te.quill.updateContents(new m.default().retain(ce.index).delete(ce.length).insert({image:Q.target.result}),g.default.sources.USER),te.quill.setSelection(ce.index+1,g.default.sources.SILENT),se.value=""},ae.readAsDataURL(se.files[0])}}),this.container.appendChild(se)),se.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var X=function(Z){D(te,Z);function te(se,ae){O(this,te);var Q=C(this,(te.__proto__||Object.getPrototypeOf(te)).call(this,se,ae));return Q.textbox=Q.root.querySelector('input[type="text"]'),Q.listen(),Q}return s(te,[{key:"listen",value:function(){var ae=this;this.textbox.addEventListener("keydown",function(Q){E.default.match(Q,"enter")?(ae.save(),Q.preventDefault()):E.default.match(Q,"escape")&&(ae.cancel(),Q.preventDefault())})}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var ae=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),Q!=null?this.textbox.value=Q:ae!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+ae)||""),this.root.setAttribute("data-mode",ae)}},{key:"restoreFocus",value:function(){var ae=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=ae}},{key:"save",value:function(){var ae=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":{var Q=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",ae,g.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",ae,g.default.sources.USER)),this.quill.root.scrollTop=Q;break}case"video":ae=Y(ae);case"formula":{if(!ae)break;var ce=this.quill.getSelection(!0);if(ce!=null){var me=ce.index+ce.length;this.quill.insertEmbed(me,this.root.getAttribute("data-mode"),ae,g.default.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(me+1," ",g.default.sources.USER),this.quill.setSelection(me+2,g.default.sources.USER)}break}}this.textbox.value="",this.hide()}}]),te}(k.default);function Y(Z){var te=Z.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||Z.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return te?(te[1]||"https")+"://www.youtube.com/embed/"+te[2]+"?showinfo=0":(te=Z.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?(te[1]||"https")+"://player.vimeo.com/video/"+te[2]+"/":Z}function B(Z,te){var se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;te.forEach(function(ae){var Q=document.createElement("option");ae===se?Q.setAttribute("selected","selected"):Q.setAttribute("value",ae),Z.appendChild(Q)})}r.BaseTooltip=X,r.default=ie},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function o(){this.head=this.tail=null,this.length=0}return o.prototype.append=function(){for(var l=[],d=0;d<arguments.length;d++)l[d]=arguments[d];this.insertBefore(l[0],null),l.length>1&&this.append.apply(this,l.slice(1))},o.prototype.contains=function(l){for(var d,f=this.iterator();d=f();)if(d===l)return!0;return!1},o.prototype.insertBefore=function(l,d){l&&(l.next=d,d!=null?(l.prev=d.prev,d.prev!=null&&(d.prev.next=l),d.prev=l,d===this.head&&(this.head=l)):this.tail!=null?(this.tail.next=l,l.prev=this.tail,this.tail=l):(l.prev=null,this.head=this.tail=l),this.length+=1)},o.prototype.offset=function(l){for(var d=0,f=this.head;f!=null;){if(f===l)return d;d+=f.length(),f=f.next}return-1},o.prototype.remove=function(l){this.contains(l)&&(l.prev!=null&&(l.prev.next=l.next),l.next!=null&&(l.next.prev=l.prev),l===this.head&&(this.head=l.next),l===this.tail&&(this.tail=l.prev),this.length-=1)},o.prototype.iterator=function(l){return l===void 0&&(l=this.head),function(){var d=l;return l!=null&&(l=l.next),d}},o.prototype.find=function(l,d){d===void 0&&(d=!1);for(var f,m=this.iterator();f=m();){var y=f.length();if(l<y||d&&l===y&&(f.next==null||f.next.length()!==0))return[f,l];l-=y}return[null,0]},o.prototype.forEach=function(l){for(var d,f=this.iterator();d=f();)l(d)},o.prototype.forEachAt=function(l,d,f){if(!(d<=0))for(var m=this.find(l),y=m[0],g=m[1],_,E=l-g,x=this.iterator(y);(_=x())&&E<l+d;){var w=_.length();l>E?f(_,l-E,Math.min(d,E+w-l)):f(_,0,Math.min(w,l+d-E)),E+=w}},o.prototype.map=function(l){return this.reduce(function(d,f){return d.push(l(f)),d},[])},o.prototype.reduce=function(l,d){for(var f,m=this.iterator();f=m();)d=l(d,f);return d},o}();r.default=s},function(t,r,i){var s=this&&this.__extends||function(){var y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,_){g.__proto__=_}||function(g,_){for(var E in _)_.hasOwnProperty(E)&&(g[E]=_[E])};return function(g,_){y(g,_);function E(){this.constructor=g}g.prototype=_===null?Object.create(_):(E.prototype=_.prototype,new E)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=i(17),l=i(1),d={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},f=100,m=function(y){s(g,y);function g(_){var E=y.call(this,_)||this;return E.scroll=E,E.observer=new MutationObserver(function(x){E.update(x)}),E.observer.observe(E.domNode,d),E.attach(),E}return g.prototype.detach=function(){y.prototype.detach.call(this),this.observer.disconnect()},g.prototype.deleteAt=function(_,E){this.update(),_===0&&E===this.length()?this.children.forEach(function(x){x.remove()}):y.prototype.deleteAt.call(this,_,E)},g.prototype.formatAt=function(_,E,x,w){this.update(),y.prototype.formatAt.call(this,_,E,x,w)},g.prototype.insertAt=function(_,E,x){this.update(),y.prototype.insertAt.call(this,_,E,x)},g.prototype.optimize=function(_,E){var x=this;_===void 0&&(_=[]),E===void 0&&(E={}),y.prototype.optimize.call(this,E);for(var w=[].slice.call(this.observer.takeRecords());w.length>0;)_.push(w.pop());for(var S=function(R,U){U===void 0&&(U=!0),!(R==null||R===x)&&R.domNode.parentNode!=null&&(R.domNode[l.DATA_KEY].mutations==null&&(R.domNode[l.DATA_KEY].mutations=[]),U&&S(R.parent))},N=function(R){R.domNode[l.DATA_KEY]==null||R.domNode[l.DATA_KEY].mutations==null||(R instanceof o.default&&R.children.forEach(N),R.optimize(E))},P=_,I=0;P.length>0;I+=1){if(I>=f)throw new Error("[Parchment] Maximum optimize iterations reached");for(P.forEach(function(R){var U=l.find(R.target,!0);U!=null&&(U.domNode===R.target&&(R.type==="childList"?(S(l.find(R.previousSibling,!1)),[].forEach.call(R.addedNodes,function(j){var k=l.find(j,!1);S(k,!1),k instanceof o.default&&k.children.forEach(function(F){S(F,!1)})})):R.type==="attributes"&&S(U.prev)),S(U))}),this.children.forEach(N),P=[].slice.call(this.observer.takeRecords()),w=P.slice();w.length>0;)_.push(w.pop())}},g.prototype.update=function(_,E){var x=this;E===void 0&&(E={}),_=_||this.observer.takeRecords(),_.map(function(w){var S=l.find(w.target,!0);return S==null?null:S.domNode[l.DATA_KEY].mutations==null?(S.domNode[l.DATA_KEY].mutations=[w],S):(S.domNode[l.DATA_KEY].mutations.push(w),null)}).forEach(function(w){w==null||w===x||w.domNode[l.DATA_KEY]==null||w.update(w.domNode[l.DATA_KEY].mutations||[],E)}),this.domNode[l.DATA_KEY].mutations!=null&&y.prototype.update.call(this,this.domNode[l.DATA_KEY].mutations,E),this.optimize(_,E)},g.blotName="scroll",g.defaultChild="block",g.scope=l.Scope.BLOCK_BLOT,g.tagName="DIV",g}(o.default);r.default=m},function(t,r,i){var s=this&&this.__extends||function(){var m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,g){y.__proto__=g}||function(y,g){for(var _ in g)g.hasOwnProperty(_)&&(y[_]=g[_])};return function(y,g){m(y,g);function _(){this.constructor=y}y.prototype=g===null?Object.create(g):(_.prototype=g.prototype,new _)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=i(18),l=i(1);function d(m,y){if(Object.keys(m).length!==Object.keys(y).length)return!1;for(var g in m)if(m[g]!==y[g])return!1;return!0}var f=function(m){s(y,m);function y(){return m!==null&&m.apply(this,arguments)||this}return y.formats=function(g){if(g.tagName!==y.tagName)return m.formats.call(this,g)},y.prototype.format=function(g,_){var E=this;g===this.statics.blotName&&!_?(this.children.forEach(function(x){x instanceof o.default||(x=x.wrap(y.blotName,!0)),E.attributes.copy(x)}),this.unwrap()):m.prototype.format.call(this,g,_)},y.prototype.formatAt=function(g,_,E,x){if(this.formats()[E]!=null||l.query(E,l.Scope.ATTRIBUTE)){var w=this.isolate(g,_);w.format(E,x)}else m.prototype.formatAt.call(this,g,_,E,x)},y.prototype.optimize=function(g){m.prototype.optimize.call(this,g);var _=this.formats();if(Object.keys(_).length===0)return this.unwrap();var E=this.next;E instanceof y&&E.prev===this&&d(_,E.formats())&&(E.moveChildren(this),E.remove())},y.blotName="inline",y.scope=l.Scope.INLINE_BLOT,y.tagName="SPAN",y}(o.default);r.default=f},function(t,r,i){var s=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var g in y)y.hasOwnProperty(g)&&(m[g]=y[g])};return function(m,y){f(m,y);function g(){this.constructor=m}m.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=i(18),l=i(1),d=function(f){s(m,f);function m(){return f!==null&&f.apply(this,arguments)||this}return m.formats=function(y){var g=l.query(m.blotName).tagName;if(y.tagName!==g)return f.formats.call(this,y)},m.prototype.format=function(y,g){l.query(y,l.Scope.BLOCK)!=null&&(y===this.statics.blotName&&!g?this.replaceWith(m.blotName):f.prototype.format.call(this,y,g))},m.prototype.formatAt=function(y,g,_,E){l.query(_,l.Scope.BLOCK)!=null?this.format(_,E):f.prototype.formatAt.call(this,y,g,_,E)},m.prototype.insertAt=function(y,g,_){if(_==null||l.query(g,l.Scope.INLINE)!=null)f.prototype.insertAt.call(this,y,g,_);else{var E=this.split(y),x=l.create(g,_);E.parent.insertBefore(x,E)}},m.prototype.update=function(y,g){navigator.userAgent.match(/Trident/)?this.build():f.prototype.update.call(this,y,g)},m.blotName="block",m.scope=l.Scope.BLOCK_BLOT,m.tagName="P",m}(o.default);r.default=d},function(t,r,i){var s=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,m){f.__proto__=m}||function(f,m){for(var y in m)m.hasOwnProperty(y)&&(f[y]=m[y])};return function(f,m){d(f,m);function y(){this.constructor=f}f.prototype=m===null?Object.create(m):(y.prototype=m.prototype,new y)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=i(19),l=function(d){s(f,d);function f(){return d!==null&&d.apply(this,arguments)||this}return f.formats=function(m){},f.prototype.format=function(m,y){d.prototype.formatAt.call(this,0,this.length(),m,y)},f.prototype.formatAt=function(m,y,g,_){m===0&&y===this.length()?this.format(g,_):d.prototype.formatAt.call(this,m,y,g,_)},f.prototype.formats=function(){return this.statics.formats(this.domNode)},f}(o.default);r.default=l},function(t,r,i){var s=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var g in y)y.hasOwnProperty(g)&&(m[g]=y[g])};return function(m,y){f(m,y);function g(){this.constructor=m}m.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)}}();Object.defineProperty(r,"__esModule",{value:!0});var o=i(19),l=i(1),d=function(f){s(m,f);function m(y){var g=f.call(this,y)||this;return g.text=g.statics.value(g.domNode),g}return m.create=function(y){return document.createTextNode(y)},m.value=function(y){var g=y.data;return g.normalize&&(g=g.normalize()),g},m.prototype.deleteAt=function(y,g){this.domNode.data=this.text=this.text.slice(0,y)+this.text.slice(y+g)},m.prototype.index=function(y,g){return this.domNode===y?g:-1},m.prototype.insertAt=function(y,g,_){_==null?(this.text=this.text.slice(0,y)+g+this.text.slice(y),this.domNode.data=this.text):f.prototype.insertAt.call(this,y,g,_)},m.prototype.length=function(){return this.text.length},m.prototype.optimize=function(y){f.prototype.optimize.call(this,y),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof m&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},m.prototype.position=function(y,g){return[this.domNode,y]},m.prototype.split=function(y,g){if(g===void 0&&(g=!1),!g){if(y===0)return this;if(y===this.length())return this.next}var _=l.create(this.domNode.splitText(y));return this.parent.insertBefore(_,this.next),this.text=this.statics.value(this.domNode),_},m.prototype.update=function(y,g){var _=this;y.some(function(E){return E.type==="characterData"&&E.target===_.domNode})&&(this.text=this.statics.value(this.domNode))},m.prototype.value=function(){return this.text},m.blotName="text",m.scope=l.Scope.INLINE_BLOT,m}(o.default);r.default=d},function(t,r,i){var s=document.createElement("div");if(s.classList.toggle("test-class",!1),s.classList.contains("test-class")){var o=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(l,d){return arguments.length>1&&!this.contains(l)==!d?d:o.call(this,l)}}String.prototype.startsWith||(String.prototype.startsWith=function(l,d){return d=d||0,this.substr(d,l.length)===l}),String.prototype.endsWith||(String.prototype.endsWith=function(l,d){var f=this.toString();(typeof d!="number"||!isFinite(d)||Math.floor(d)!==d||d>f.length)&&(d=f.length),d-=l.length;var m=f.indexOf(l,d);return m!==-1&&m===d}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(d){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof d!="function")throw new TypeError("predicate must be a function");for(var f=Object(this),m=f.length>>>0,y=arguments[1],g,_=0;_<m;_++)if(g=f[_],d.call(y,g,_,f))return g}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})},function(t,r){var i=-1,s=1,o=0;function l(I,R,U){if(I==R)return I?[[o,I]]:[];(U<0||I.length<U)&&(U=null);var j=y(I,R),k=I.substring(0,j);I=I.substring(j),R=R.substring(j),j=g(I,R);var F=I.substring(I.length-j);I=I.substring(0,I.length-j),R=R.substring(0,R.length-j);var O=d(I,R);return k&&O.unshift([o,k]),F&&O.push([o,F]),E(O),U!=null&&(O=S(O,U)),O=N(O),O}function d(I,R){var U;if(!I)return[[s,R]];if(!R)return[[i,I]];var j=I.length>R.length?I:R,k=I.length>R.length?R:I,F=j.indexOf(k);if(F!=-1)return U=[[s,j.substring(0,F)],[o,k],[s,j.substring(F+k.length)]],I.length>R.length&&(U[0][0]=U[2][0]=i),U;if(k.length==1)return[[i,I],[s,R]];var O=_(I,R);if(O){var C=O[0],D=O[1],M=O[2],$=O[3],G=O[4],re=l(C,M),oe=l(D,$);return re.concat([[o,G]],oe)}return f(I,R)}function f(I,R){for(var U=I.length,j=R.length,k=Math.ceil((U+j)/2),F=k,O=2*k,C=new Array(O),D=new Array(O),M=0;M<O;M++)C[M]=-1,D[M]=-1;C[F+1]=0,D[F+1]=0;for(var $=U-j,G=$%2!=0,re=0,oe=0,ie=0,X=0,Y=0;Y<k;Y++){for(var B=-Y+re;B<=Y-oe;B+=2){var Z=F+B,te;B==-Y||B!=Y&&C[Z-1]<C[Z+1]?te=C[Z+1]:te=C[Z-1]+1;for(var se=te-B;te<U&&se<j&&I.charAt(te)==R.charAt(se);)te++,se++;if(C[Z]=te,te>U)oe+=2;else if(se>j)re+=2;else if(G){var ae=F+$-B;if(ae>=0&&ae<O&&D[ae]!=-1){var Q=U-D[ae];if(te>=Q)return m(I,R,te,se)}}}for(var ce=-Y+ie;ce<=Y-X;ce+=2){var ae=F+ce,Q;ce==-Y||ce!=Y&&D[ae-1]<D[ae+1]?Q=D[ae+1]:Q=D[ae-1]+1;for(var me=Q-ce;Q<U&&me<j&&I.charAt(U-Q-1)==R.charAt(j-me-1);)Q++,me++;if(D[ae]=Q,Q>U)X+=2;else if(me>j)ie+=2;else if(!G){var Z=F+$-ce;if(Z>=0&&Z<O&&C[Z]!=-1){var te=C[Z],se=F+te-Z;if(Q=U-Q,te>=Q)return m(I,R,te,se)}}}}return[[i,I],[s,R]]}function m(I,R,U,j){var k=I.substring(0,U),F=R.substring(0,j),O=I.substring(U),C=R.substring(j),D=l(k,F),M=l(O,C);return D.concat(M)}function y(I,R){if(!I||!R||I.charAt(0)!=R.charAt(0))return 0;for(var U=0,j=Math.min(I.length,R.length),k=j,F=0;U<k;)I.substring(F,k)==R.substring(F,k)?(U=k,F=U):j=k,k=Math.floor((j-U)/2+U);return k}function g(I,R){if(!I||!R||I.charAt(I.length-1)!=R.charAt(R.length-1))return 0;for(var U=0,j=Math.min(I.length,R.length),k=j,F=0;U<k;)I.substring(I.length-k,I.length-F)==R.substring(R.length-k,R.length-F)?(U=k,F=U):j=k,k=Math.floor((j-U)/2+U);return k}function _(I,R){var U=I.length>R.length?I:R,j=I.length>R.length?R:I;if(U.length<4||j.length*2<U.length)return null;function k(oe,ie,X){for(var Y=oe.substring(X,X+Math.floor(oe.length/4)),B=-1,Z="",te,se,ae,Q;(B=ie.indexOf(Y,B+1))!=-1;){var ce=y(oe.substring(X),ie.substring(B)),me=g(oe.substring(0,X),ie.substring(0,B));Z.length<me+ce&&(Z=ie.substring(B-me,B)+ie.substring(B,B+ce),te=oe.substring(0,X-me),se=oe.substring(X+ce),ae=ie.substring(0,B-me),Q=ie.substring(B+ce))}return Z.length*2>=oe.length?[te,se,ae,Q,Z]:null}var F=k(U,j,Math.ceil(U.length/4)),O=k(U,j,Math.ceil(U.length/2)),C;if(!F&&!O)return null;O?F?C=F[4].length>O[4].length?F:O:C=O:C=F;var D,M,$,G;I.length>R.length?(D=C[0],M=C[1],$=C[2],G=C[3]):($=C[0],G=C[1],D=C[2],M=C[3]);var re=C[4];return[D,M,$,G,re]}function E(I){I.push([o,""]);for(var R=0,U=0,j=0,k="",F="",O;R<I.length;)switch(I[R][0]){case s:j++,F+=I[R][1],R++;break;case i:U++,k+=I[R][1],R++;break;case o:U+j>1?(U!==0&&j!==0&&(O=y(F,k),O!==0&&(R-U-j>0&&I[R-U-j-1][0]==o?I[R-U-j-1][1]+=F.substring(0,O):(I.splice(0,0,[o,F.substring(0,O)]),R++),F=F.substring(O),k=k.substring(O)),O=g(F,k),O!==0&&(I[R][1]=F.substring(F.length-O)+I[R][1],F=F.substring(0,F.length-O),k=k.substring(0,k.length-O))),U===0?I.splice(R-j,U+j,[s,F]):j===0?I.splice(R-U,U+j,[i,k]):I.splice(R-U-j,U+j,[i,k],[s,F]),R=R-U-j+(U?1:0)+(j?1:0)+1):R!==0&&I[R-1][0]==o?(I[R-1][1]+=I[R][1],I.splice(R,1)):R++,j=0,U=0,k="",F="";break}I[I.length-1][1]===""&&I.pop();var C=!1;for(R=1;R<I.length-1;)I[R-1][0]==o&&I[R+1][0]==o&&(I[R][1].substring(I[R][1].length-I[R-1][1].length)==I[R-1][1]?(I[R][1]=I[R-1][1]+I[R][1].substring(0,I[R][1].length-I[R-1][1].length),I[R+1][1]=I[R-1][1]+I[R+1][1],I.splice(R-1,1),C=!0):I[R][1].substring(0,I[R+1][1].length)==I[R+1][1]&&(I[R-1][1]+=I[R+1][1],I[R][1]=I[R][1].substring(I[R+1][1].length)+I[R+1][1],I.splice(R+1,1),C=!0)),R++;C&&E(I)}var x=l;x.INSERT=s,x.DELETE=i,x.EQUAL=o,t.exports=x;function w(I,R){if(R===0)return[o,I];for(var U=0,j=0;j<I.length;j++){var k=I[j];if(k[0]===i||k[0]===o){var F=U+k[1].length;if(R===F)return[j+1,I];if(R<F){I=I.slice();var O=R-U,C=[k[0],k[1].slice(0,O)],D=[k[0],k[1].slice(O)];return I.splice(j,1,C,D),[j+1,I]}else U=F}}throw new Error("cursor_pos is out of bounds!")}function S(I,R){var U=w(I,R),j=U[1],k=U[0],F=j[k],O=j[k+1];if(F==null)return I;if(F[0]!==o)return I;if(O!=null&&F[1]+O[1]===O[1]+F[1])return j.splice(k,2,O,F),P(j,k,2);if(O!=null&&O[1].indexOf(F[1])===0){j.splice(k,2,[O[0],F[1]],[0,F[1]]);var C=O[1].slice(F[1].length);return C.length>0&&j.splice(k+2,0,[O[0],C]),P(j,k,3)}else return I}function N(I){for(var R=!1,U=function(O){return O.charCodeAt(0)>=56320&&O.charCodeAt(0)<=57343},j=function(O){return O.charCodeAt(O.length-1)>=55296&&O.charCodeAt(O.length-1)<=56319},k=2;k<I.length;k+=1)I[k-2][0]===o&&j(I[k-2][1])&&I[k-1][0]===i&&U(I[k-1][1])&&I[k][0]===s&&U(I[k][1])&&(R=!0,I[k-1][1]=I[k-2][1].slice(-1)+I[k-1][1],I[k][1]=I[k-2][1].slice(-1)+I[k][1],I[k-2][1]=I[k-2][1].slice(0,-1));if(!R)return I;for(var F=[],k=0;k<I.length;k+=1)I[k][1].length>0&&F.push(I[k]);return F}function P(I,R,U){for(var j=R+U-1;j>=0&&j>=R-1;j--)if(j+1<I.length){var k=I[j],F=I[j+1];k[0]===F[1]&&I.splice(j,2,[k[0],k[1]+F[1]])}return I}},function(t,r){r=t.exports=typeof Object.keys=="function"?Object.keys:i,r.shim=i;function i(s){var o=[];for(var l in s)o.push(l);return o}},function(t,r){var i=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";r=t.exports=i?s:o,r.supported=s;function s(l){return Object.prototype.toString.call(l)=="[object Arguments]"}r.unsupported=o;function o(l){return l&&typeof l=="object"&&typeof l.length=="number"&&Object.prototype.hasOwnProperty.call(l,"callee")&&!Object.prototype.propertyIsEnumerable.call(l,"callee")||!1}},function(t,r){var i=Object.prototype.hasOwnProperty,s="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(s=!1));function l(f,m,y){this.fn=f,this.context=m,this.once=y||!1}function d(){this._events=new o,this._eventsCount=0}d.prototype.eventNames=function(){var m=[],y,g;if(this._eventsCount===0)return m;for(g in y=this._events)i.call(y,g)&&m.push(s?g.slice(1):g);return Object.getOwnPropertySymbols?m.concat(Object.getOwnPropertySymbols(y)):m},d.prototype.listeners=function(m,y){var g=s?s+m:m,_=this._events[g];if(y)return!!_;if(!_)return[];if(_.fn)return[_.fn];for(var E=0,x=_.length,w=new Array(x);E<x;E++)w[E]=_[E].fn;return w},d.prototype.emit=function(m,y,g,_,E,x){var w=s?s+m:m;if(!this._events[w])return!1;var S=this._events[w],N=arguments.length,P,I;if(S.fn){switch(S.once&&this.removeListener(m,S.fn,void 0,!0),N){case 1:return S.fn.call(S.context),!0;case 2:return S.fn.call(S.context,y),!0;case 3:return S.fn.call(S.context,y,g),!0;case 4:return S.fn.call(S.context,y,g,_),!0;case 5:return S.fn.call(S.context,y,g,_,E),!0;case 6:return S.fn.call(S.context,y,g,_,E,x),!0}for(I=1,P=new Array(N-1);I<N;I++)P[I-1]=arguments[I];S.fn.apply(S.context,P)}else{var R=S.length,U;for(I=0;I<R;I++)switch(S[I].once&&this.removeListener(m,S[I].fn,void 0,!0),N){case 1:S[I].fn.call(S[I].context);break;case 2:S[I].fn.call(S[I].context,y);break;case 3:S[I].fn.call(S[I].context,y,g);break;case 4:S[I].fn.call(S[I].context,y,g,_);break;default:if(!P)for(U=1,P=new Array(N-1);U<N;U++)P[U-1]=arguments[U];S[I].fn.apply(S[I].context,P)}}return!0},d.prototype.on=function(m,y,g){var _=new l(y,g||this),E=s?s+m:m;return this._events[E]?this._events[E].fn?this._events[E]=[this._events[E],_]:this._events[E].push(_):(this._events[E]=_,this._eventsCount++),this},d.prototype.once=function(m,y,g){var _=new l(y,g||this,!0),E=s?s+m:m;return this._events[E]?this._events[E].fn?this._events[E]=[this._events[E],_]:this._events[E].push(_):(this._events[E]=_,this._eventsCount++),this},d.prototype.removeListener=function(m,y,g,_){var E=s?s+m:m;if(!this._events[E])return this;if(!y)return--this._eventsCount===0?this._events=new o:delete this._events[E],this;var x=this._events[E];if(x.fn)x.fn===y&&(!_||x.once)&&(!g||x.context===g)&&(--this._eventsCount===0?this._events=new o:delete this._events[E]);else{for(var w=0,S=[],N=x.length;w<N;w++)(x[w].fn!==y||_&&!x[w].once||g&&x[w].context!==g)&&S.push(x[w]);S.length?this._events[E]=S.length===1?S[0]:S:--this._eventsCount===0?this._events=new o:delete this._events[E]}return this},d.prototype.removeAllListeners=function(m){var y;return m?(y=s?s+m:m,this._events[y]&&(--this._eventsCount===0?this._events=new o:delete this._events[y])):(this._events=new o,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prototype.setMaxListeners=function(){return this},d.prefixed=s,d.EventEmitter=d,typeof t<"u"&&(t.exports=d)},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.matchText=r.matchSpacing=r.matchNewline=r.matchBlot=r.matchAttributor=r.default=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Se){return typeof Se}:function(Se){return Se&&typeof Symbol=="function"&&Se.constructor===Symbol&&Se!==Symbol.prototype?"symbol":typeof Se},o=function(){function Se(Ne,De){var ze=[],ke=!0,gt=!1,mt=void 0;try{for(var pt=Ne[Symbol.iterator](),Ct;!(ke=(Ct=pt.next()).done)&&(ze.push(Ct.value),!(De&&ze.length===De));ke=!0);}catch(Mt){gt=!0,mt=Mt}finally{try{!ke&&pt.return&&pt.return()}finally{if(gt)throw mt}}return ze}return function(Ne,De){if(Array.isArray(Ne))return Ne;if(Symbol.iterator in Object(Ne))return Se(Ne,De);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function Se(Ne,De){for(var ze=0;ze<De.length;ze++){var ke=De[ze];ke.enumerable=ke.enumerable||!1,ke.configurable=!0,"value"in ke&&(ke.writable=!0),Object.defineProperty(Ne,ke.key,ke)}}return function(Ne,De,ze){return De&&Se(Ne.prototype,De),ze&&Se(Ne,ze),Ne}}(),d=i(3),f=D(d),m=i(2),y=D(m),g=i(0),_=D(g),E=i(5),x=D(E),w=i(10),S=D(w),N=i(9),P=D(N),I=i(36),R=i(37),U=i(13),j=D(U),k=i(26),F=i(38),O=i(39),C=i(40);function D(Se){return Se&&Se.__esModule?Se:{default:Se}}function M(Se,Ne,De){return Ne in Se?Object.defineProperty(Se,Ne,{value:De,enumerable:!0,configurable:!0,writable:!0}):Se[Ne]=De,Se}function $(Se,Ne){if(!(Se instanceof Ne))throw new TypeError("Cannot call a class as a function")}function G(Se,Ne){if(!Se)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Ne&&(typeof Ne=="object"||typeof Ne=="function")?Ne:Se}function re(Se,Ne){if(typeof Ne!="function"&&Ne!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Ne);Se.prototype=Object.create(Ne&&Ne.prototype,{constructor:{value:Se,enumerable:!1,writable:!0,configurable:!0}}),Ne&&(Object.setPrototypeOf?Object.setPrototypeOf(Se,Ne):Se.__proto__=Ne)}var oe=(0,S.default)("quill:clipboard"),ie="__ql-matcher",X=[[Node.TEXT_NODE,Gt],[Node.TEXT_NODE,ot],["br",Ve],[Node.ELEMENT_NODE,ot],[Node.ELEMENT_NODE,Ae],[Node.ELEMENT_NODE,nt],[Node.ELEMENT_NODE,ge],[Node.ELEMENT_NODE,It],["li",Ge],["b",me.bind(me,"bold")],["i",me.bind(me,"italic")],["style",Ye]],Y=[I.AlignAttribute,F.DirectionAttribute].reduce(function(Se,Ne){return Se[Ne.keyName]=Ne,Se},{}),B=[I.AlignStyle,R.BackgroundStyle,k.ColorStyle,F.DirectionStyle,O.FontStyle,C.SizeStyle].reduce(function(Se,Ne){return Se[Ne.keyName]=Ne,Se},{}),Z=function(Se){re(Ne,Se);function Ne(De,ze){$(this,Ne);var ke=G(this,(Ne.__proto__||Object.getPrototypeOf(Ne)).call(this,De,ze));return ke.quill.root.addEventListener("paste",ke.onPaste.bind(ke)),ke.container=ke.quill.addContainer("ql-clipboard"),ke.container.setAttribute("contenteditable",!0),ke.container.setAttribute("tabindex",-1),ke.matchers=[],X.concat(ke.options.matchers).forEach(function(gt){var mt=o(gt,2),pt=mt[0],Ct=mt[1];!ze.matchVisual&&Ct===nt||ke.addMatcher(pt,Ct)}),ke}return l(Ne,[{key:"addMatcher",value:function(ze,ke){this.matchers.push([ze,ke])}},{key:"convert",value:function(ze){if(typeof ze=="string")return this.container.innerHTML=ze.replace(/\>\r?\n +\</g,"><"),this.convert();var ke=this.quill.getFormat(this.quill.selection.savedRange.index);if(ke[j.default.blotName]){var gt=this.container.innerText;return this.container.innerHTML="",new y.default().insert(gt,M({},j.default.blotName,ke[j.default.blotName]))}var mt=this.prepareMatching(),pt=o(mt,2),Ct=pt[0],Mt=pt[1],Dt=ce(this.container,Ct,Mt);return ae(Dt,`
`)&&Dt.ops[Dt.ops.length-1].attributes==null&&(Dt=Dt.compose(new y.default().retain(Dt.length()-1).delete(1))),oe.log("convert",this.container.innerHTML,Dt),this.container.innerHTML="",Dt}},{key:"dangerouslyPasteHTML",value:function(ze,ke){var gt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:x.default.sources.API;if(typeof ze=="string")this.quill.setContents(this.convert(ze),ke),this.quill.setSelection(0,x.default.sources.SILENT);else{var mt=this.convert(ke);this.quill.updateContents(new y.default().retain(ze).concat(mt),gt),this.quill.setSelection(ze+mt.length(),x.default.sources.SILENT)}}},{key:"onPaste",value:function(ze){var ke=this;if(!(ze.defaultPrevented||!this.quill.isEnabled())){var gt=this.quill.getSelection(),mt=new y.default().retain(gt.index),pt=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(x.default.sources.SILENT),setTimeout(function(){mt=mt.concat(ke.convert()).delete(gt.length),ke.quill.updateContents(mt,x.default.sources.USER),ke.quill.setSelection(mt.length()-gt.length,x.default.sources.SILENT),ke.quill.scrollingContainer.scrollTop=pt,ke.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var ze=this,ke=[],gt=[];return this.matchers.forEach(function(mt){var pt=o(mt,2),Ct=pt[0],Mt=pt[1];switch(Ct){case Node.TEXT_NODE:gt.push(Mt);break;case Node.ELEMENT_NODE:ke.push(Mt);break;default:[].forEach.call(ze.container.querySelectorAll(Ct),function(Dt){Dt[ie]=Dt[ie]||[],Dt[ie].push(Mt)});break}}),[ke,gt]}}]),Ne}(P.default);Z.DEFAULTS={matchers:[],matchVisual:!0};function te(Se,Ne,De){return(typeof Ne>"u"?"undefined":s(Ne))==="object"?Object.keys(Ne).reduce(function(ze,ke){return te(ze,ke,Ne[ke])},Se):Se.reduce(function(ze,ke){return ke.attributes&&ke.attributes[Ne]?ze.push(ke):ze.insert(ke.insert,(0,f.default)({},M({},Ne,De),ke.attributes))},new y.default)}function se(Se){if(Se.nodeType!==Node.ELEMENT_NODE)return{};var Ne="__ql-computed-style";return Se[Ne]||(Se[Ne]=window.getComputedStyle(Se))}function ae(Se,Ne){for(var De="",ze=Se.ops.length-1;ze>=0&&De.length<Ne.length;--ze){var ke=Se.ops[ze];if(typeof ke.insert!="string")break;De=ke.insert+De}return De.slice(-1*Ne.length)===Ne}function Q(Se){if(Se.childNodes.length===0)return!1;var Ne=se(Se);return["block","list-item"].indexOf(Ne.display)>-1}function ce(Se,Ne,De){return Se.nodeType===Se.TEXT_NODE?De.reduce(function(ze,ke){return ke(Se,ze)},new y.default):Se.nodeType===Se.ELEMENT_NODE?[].reduce.call(Se.childNodes||[],function(ze,ke){var gt=ce(ke,Ne,De);return ke.nodeType===Se.ELEMENT_NODE&&(gt=Ne.reduce(function(mt,pt){return pt(ke,mt)},gt),gt=(ke[ie]||[]).reduce(function(mt,pt){return pt(ke,mt)},gt)),ze.concat(gt)},new y.default):new y.default}function me(Se,Ne,De){return te(De,Se,!0)}function ge(Se,Ne){var De=_.default.Attributor.Attribute.keys(Se),ze=_.default.Attributor.Class.keys(Se),ke=_.default.Attributor.Style.keys(Se),gt={};return De.concat(ze).concat(ke).forEach(function(mt){var pt=_.default.query(mt,_.default.Scope.ATTRIBUTE);pt!=null&&(gt[pt.attrName]=pt.value(Se),gt[pt.attrName])||(pt=Y[mt],pt!=null&&(pt.attrName===mt||pt.keyName===mt)&&(gt[pt.attrName]=pt.value(Se)||void 0),pt=B[mt],pt!=null&&(pt.attrName===mt||pt.keyName===mt)&&(pt=B[mt],gt[pt.attrName]=pt.value(Se)||void 0))}),Object.keys(gt).length>0&&(Ne=te(Ne,gt)),Ne}function Ae(Se,Ne){var De=_.default.query(Se);if(De==null)return Ne;if(De.prototype instanceof _.default.Embed){var ze={},ke=De.value(Se);ke!=null&&(ze[De.blotName]=ke,Ne=new y.default().insert(ze,De.formats(Se)))}else typeof De.formats=="function"&&(Ne=te(Ne,De.blotName,De.formats(Se)));return Ne}function Ve(Se,Ne){return ae(Ne,`
`)||Ne.insert(`
`),Ne}function Ye(){return new y.default}function Ge(Se,Ne){var De=_.default.query(Se);if(De==null||De.blotName!=="list-item"||!ae(Ne,`
`))return Ne;for(var ze=-1,ke=Se.parentNode;!ke.classList.contains("ql-clipboard");)(_.default.query(ke)||{}).blotName==="list"&&(ze+=1),ke=ke.parentNode;return ze<=0?Ne:Ne.compose(new y.default().retain(Ne.length()-1).retain(1,{indent:ze}))}function ot(Se,Ne){return ae(Ne,`
`)||(Q(Se)||Ne.length()>0&&Se.nextSibling&&Q(Se.nextSibling))&&Ne.insert(`
`),Ne}function nt(Se,Ne){if(Q(Se)&&Se.nextElementSibling!=null&&!ae(Ne,`

`)){var De=Se.offsetHeight+parseFloat(se(Se).marginTop)+parseFloat(se(Se).marginBottom);Se.nextElementSibling.offsetTop>Se.offsetTop+De*1.5&&Ne.insert(`
`)}return Ne}function It(Se,Ne){var De={},ze=Se.style||{};return ze.fontStyle&&se(Se).fontStyle==="italic"&&(De.italic=!0),ze.fontWeight&&(se(Se).fontWeight.startsWith("bold")||parseInt(se(Se).fontWeight)>=700)&&(De.bold=!0),Object.keys(De).length>0&&(Ne=te(Ne,De)),parseFloat(ze.textIndent||0)>0&&(Ne=new y.default().insert("	").concat(Ne)),Ne}function Gt(Se,Ne){var De=Se.data;if(Se.parentNode.tagName==="O:P")return Ne.insert(De.trim());if(De.trim().length===0&&Se.parentNode.classList.contains("ql-clipboard"))return Ne;if(!se(Se.parentNode).whiteSpace.startsWith("pre")){var ze=function(gt,mt){return mt=mt.replace(/[^\u00a0]/g,""),mt.length<1&&gt?" ":mt};De=De.replace(/\r\n/g," ").replace(/\n/g," "),De=De.replace(/\s\s+/g,ze.bind(ze,!0)),(Se.previousSibling==null&&Q(Se.parentNode)||Se.previousSibling!=null&&Q(Se.previousSibling))&&(De=De.replace(/^\s+/,ze.bind(ze,!1))),(Se.nextSibling==null&&Q(Se.parentNode)||Se.nextSibling!=null&&Q(Se.nextSibling))&&(De=De.replace(/\s+$/,ze.bind(ze,!1)))}return Ne.insert(De)}r.default=Z,r.matchAttributor=ge,r.matchBlot=Ae,r.matchNewline=ot,r.matchSpacing=nt,r.matchText=Gt},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function E(x,w){for(var S=0;S<w.length;S++){var N=w[S];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(x,N.key,N)}}return function(x,w,S){return w&&E(x.prototype,w),S&&E(x,S),x}}(),o=function E(x,w,S){x===null&&(x=Function.prototype);var N=Object.getOwnPropertyDescriptor(x,w);if(N===void 0){var P=Object.getPrototypeOf(x);return P===null?void 0:E(P,w,S)}else{if("value"in N)return N.value;var I=N.get;return I===void 0?void 0:I.call(S)}},l=i(6),d=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function y(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var _=function(E){g(x,E);function x(){return m(this,x),y(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return s(x,[{key:"optimize",value:function(S){o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"optimize",this).call(this,S),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return o(x.__proto__||Object.getPrototypeOf(x),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),x}(d.default);_.blotName="bold",_.tagName=["STRONG","B"],r.default=_},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.addControls=r.default=void 0;var s=function(){function C(D,M){var $=[],G=!0,re=!1,oe=void 0;try{for(var ie=D[Symbol.iterator](),X;!(G=(X=ie.next()).done)&&($.push(X.value),!(M&&$.length===M));G=!0);}catch(Y){re=!0,oe=Y}finally{try{!G&&ie.return&&ie.return()}finally{if(re)throw oe}}return $}return function(D,M){if(Array.isArray(D))return D;if(Symbol.iterator in Object(D))return C(D,M);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function C(D,M){for(var $=0;$<M.length;$++){var G=M[$];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(D,G.key,G)}}return function(D,M,$){return M&&C(D.prototype,M),$&&C(D,$),D}}(),l=i(2),d=S(l),f=i(0),m=S(f),y=i(5),g=S(y),_=i(10),E=S(_),x=i(9),w=S(x);function S(C){return C&&C.__esModule?C:{default:C}}function N(C,D,M){return D in C?Object.defineProperty(C,D,{value:M,enumerable:!0,configurable:!0,writable:!0}):C[D]=M,C}function P(C,D){if(!(C instanceof D))throw new TypeError("Cannot call a class as a function")}function I(C,D){if(!C)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D&&(typeof D=="object"||typeof D=="function")?D:C}function R(C,D){if(typeof D!="function"&&D!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof D);C.prototype=Object.create(D&&D.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),D&&(Object.setPrototypeOf?Object.setPrototypeOf(C,D):C.__proto__=D)}var U=(0,E.default)("quill:toolbar"),j=function(C){R(D,C);function D(M,$){P(this,D);var G=I(this,(D.__proto__||Object.getPrototypeOf(D)).call(this,M,$));if(Array.isArray(G.options.container)){var re=document.createElement("div");F(re,G.options.container),M.container.parentNode.insertBefore(re,M.container),G.container=re}else typeof G.options.container=="string"?G.container=document.querySelector(G.options.container):G.container=G.options.container;if(!(G.container instanceof HTMLElement)){var oe;return oe=U.error("Container required for toolbar",G.options),I(G,oe)}return G.container.classList.add("ql-toolbar"),G.controls=[],G.handlers={},Object.keys(G.options.handlers).forEach(function(ie){G.addHandler(ie,G.options.handlers[ie])}),[].forEach.call(G.container.querySelectorAll("button, select"),function(ie){G.attach(ie)}),G.quill.on(g.default.events.EDITOR_CHANGE,function(ie,X){ie===g.default.events.SELECTION_CHANGE&&G.update(X)}),G.quill.on(g.default.events.SCROLL_OPTIMIZE,function(){var ie=G.quill.selection.getRange(),X=s(ie,1),Y=X[0];G.update(Y)}),G}return o(D,[{key:"addHandler",value:function($,G){this.handlers[$]=G}},{key:"attach",value:function($){var G=this,re=[].find.call($.classList,function(ie){return ie.indexOf("ql-")===0});if(re){if(re=re.slice(3),$.tagName==="BUTTON"&&$.setAttribute("type","button"),this.handlers[re]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[re]==null){U.warn("ignoring attaching to disabled format",re,$);return}if(m.default.query(re)==null){U.warn("ignoring attaching to nonexistent format",re,$);return}}var oe=$.tagName==="SELECT"?"change":"click";$.addEventListener(oe,function(ie){var X=void 0;if($.tagName==="SELECT"){if($.selectedIndex<0)return;var Y=$.options[$.selectedIndex];Y.hasAttribute("selected")?X=!1:X=Y.value||!1}else $.classList.contains("ql-active")?X=!1:X=$.value||!$.hasAttribute("value"),ie.preventDefault();G.quill.focus();var B=G.quill.selection.getRange(),Z=s(B,1),te=Z[0];if(G.handlers[re]!=null)G.handlers[re].call(G,X);else if(m.default.query(re).prototype instanceof m.default.Embed){if(X=prompt("Enter "+re),!X)return;G.quill.updateContents(new d.default().retain(te.index).delete(te.length).insert(N({},re,X)),g.default.sources.USER)}else G.quill.format(re,X,g.default.sources.USER);G.update(te)}),this.controls.push([re,$])}}},{key:"update",value:function($){var G=$==null?{}:this.quill.getFormat($);this.controls.forEach(function(re){var oe=s(re,2),ie=oe[0],X=oe[1];if(X.tagName==="SELECT"){var Y=void 0;if($==null)Y=null;else if(G[ie]==null)Y=X.querySelector("option[selected]");else if(!Array.isArray(G[ie])){var B=G[ie];typeof B=="string"&&(B=B.replace(/\"/g,'\\"')),Y=X.querySelector('option[value="'+B+'"]')}Y==null?(X.value="",X.selectedIndex=-1):Y.selected=!0}else if($==null)X.classList.remove("ql-active");else if(X.hasAttribute("value")){var Z=G[ie]===X.getAttribute("value")||G[ie]!=null&&G[ie].toString()===X.getAttribute("value")||G[ie]==null&&!X.getAttribute("value");X.classList.toggle("ql-active",Z)}else X.classList.toggle("ql-active",G[ie]!=null)})}}]),D}(w.default);j.DEFAULTS={};function k(C,D,M){var $=document.createElement("button");$.setAttribute("type","button"),$.classList.add("ql-"+D),M!=null&&($.value=M),C.appendChild($)}function F(C,D){Array.isArray(D[0])||(D=[D]),D.forEach(function(M){var $=document.createElement("span");$.classList.add("ql-formats"),M.forEach(function(G){if(typeof G=="string")k($,G);else{var re=Object.keys(G)[0],oe=G[re];Array.isArray(oe)?O($,re,oe):k($,re,oe)}}),C.appendChild($)})}function O(C,D,M){var $=document.createElement("select");$.classList.add("ql-"+D),M.forEach(function(G){var re=document.createElement("option");G!==!1?re.setAttribute("value",G):re.setAttribute("selected","selected"),$.appendChild(re)}),C.appendChild($)}j.DEFAULTS={container:null,handlers:{clean:function(){var D=this,M=this.quill.getSelection();if(M!=null)if(M.length==0){var $=this.quill.getFormat();Object.keys($).forEach(function(G){m.default.query(G,m.default.Scope.INLINE)!=null&&D.quill.format(G,!1)})}else this.quill.removeFormat(M,g.default.sources.USER)},direction:function(D){var M=this.quill.getFormat().align;D==="rtl"&&M==null?this.quill.format("align","right",g.default.sources.USER):!D&&M==="right"&&this.quill.format("align",!1,g.default.sources.USER),this.quill.format("direction",D,g.default.sources.USER)},indent:function(D){var M=this.quill.getSelection(),$=this.quill.getFormat(M),G=parseInt($.indent||0);if(D==="+1"||D==="-1"){var re=D==="+1"?1:-1;$.direction==="rtl"&&(re*=-1),this.quill.format("indent",G+re,g.default.sources.USER)}},link:function(D){D===!0&&(D=prompt("Enter link URL:")),this.quill.format("link",D,g.default.sources.USER)},list:function(D){var M=this.quill.getSelection(),$=this.quill.getFormat(M);D==="check"?$.list==="checked"||$.list==="unchecked"?this.quill.format("list",!1,g.default.sources.USER):this.quill.format("list","unchecked",g.default.sources.USER):this.quill.format("list",D,g.default.sources.USER)}}},r.default=j,r.addControls=F},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function E(x,w){for(var S=0;S<w.length;S++){var N=w[S];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(x,N.key,N)}}return function(x,w,S){return w&&E(x.prototype,w),S&&E(x,S),x}}(),o=function E(x,w,S){x===null&&(x=Function.prototype);var N=Object.getOwnPropertyDescriptor(x,w);if(N===void 0){var P=Object.getPrototypeOf(x);return P===null?void 0:E(P,w,S)}else{if("value"in N)return N.value;var I=N.get;return I===void 0?void 0:I.call(S)}},l=i(28),d=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function y(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var _=function(E){g(x,E);function x(w,S){m(this,x);var N=y(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,w));return N.label.innerHTML=S,N.container.classList.add("ql-color-picker"),[].slice.call(N.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(P){P.classList.add("ql-primary")}),N}return s(x,[{key:"buildItem",value:function(S){var N=o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"buildItem",this).call(this,S);return N.style.backgroundColor=S.getAttribute("value")||"",N}},{key:"selectItem",value:function(S,N){o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"selectItem",this).call(this,S,N);var P=this.label.querySelector(".ql-color-label"),I=S&&S.getAttribute("data-value")||"";P&&(P.tagName==="line"?P.style.stroke=I:P.style.fill=I)}}]),x}(d.default);r.default=_},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function E(x,w){for(var S=0;S<w.length;S++){var N=w[S];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(x,N.key,N)}}return function(x,w,S){return w&&E(x.prototype,w),S&&E(x,S),x}}(),o=function E(x,w,S){x===null&&(x=Function.prototype);var N=Object.getOwnPropertyDescriptor(x,w);if(N===void 0){var P=Object.getPrototypeOf(x);return P===null?void 0:E(P,w,S)}else{if("value"in N)return N.value;var I=N.get;return I===void 0?void 0:I.call(S)}},l=i(28),d=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function y(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var _=function(E){g(x,E);function x(w,S){m(this,x);var N=y(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,w));return N.container.classList.add("ql-icon-picker"),[].forEach.call(N.container.querySelectorAll(".ql-picker-item"),function(P){P.innerHTML=S[P.getAttribute("data-value")||""]}),N.defaultItem=N.container.querySelector(".ql-selected"),N.selectItem(N.defaultItem),N}return s(x,[{key:"selectItem",value:function(S,N){o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"selectItem",this).call(this,S,N),S=S||this.defaultItem,this.label.innerHTML=S.innerHTML}}]),x}(d.default);r.default=_},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function d(f,m){for(var y=0;y<m.length;y++){var g=m[y];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(f,m,y){return m&&d(f.prototype,m),y&&d(f,y),f}}();function o(d,f){if(!(d instanceof f))throw new TypeError("Cannot call a class as a function")}var l=function(){function d(f,m){var y=this;o(this,d),this.quill=f,this.boundsContainer=m||document.body,this.root=f.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){y.root.style.marginTop=-1*y.quill.root.scrollTop+"px"}),this.hide()}return s(d,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(m){var y=m.left+m.width/2-this.root.offsetWidth/2,g=m.bottom+this.quill.root.scrollTop;this.root.style.left=y+"px",this.root.style.top=g+"px",this.root.classList.remove("ql-flip");var _=this.boundsContainer.getBoundingClientRect(),E=this.root.getBoundingClientRect(),x=0;if(E.right>_.right&&(x=_.right-E.right,this.root.style.left=y+x+"px"),E.left<_.left&&(x=_.left-E.left,this.root.style.left=y+x+"px"),E.bottom>_.bottom){var w=E.bottom-E.top,S=m.bottom-m.top+w;this.root.style.top=g-S+"px",this.root.classList.add("ql-flip")}return x}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),d}();r.default=l},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function O(C,D){var M=[],$=!0,G=!1,re=void 0;try{for(var oe=C[Symbol.iterator](),ie;!($=(ie=oe.next()).done)&&(M.push(ie.value),!(D&&M.length===D));$=!0);}catch(X){G=!0,re=X}finally{try{!$&&oe.return&&oe.return()}finally{if(G)throw re}}return M}return function(C,D){if(Array.isArray(C))return C;if(Symbol.iterator in Object(C))return O(C,D);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function O(C,D,M){C===null&&(C=Function.prototype);var $=Object.getOwnPropertyDescriptor(C,D);if($===void 0){var G=Object.getPrototypeOf(C);return G===null?void 0:O(G,D,M)}else{if("value"in $)return $.value;var re=$.get;return re===void 0?void 0:re.call(M)}},l=function(){function O(C,D){for(var M=0;M<D.length;M++){var $=D[M];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(C,$.key,$)}}return function(C,D,M){return D&&O(C.prototype,D),M&&O(C,M),C}}(),d=i(3),f=P(d),m=i(8),y=P(m),g=i(43),_=P(g),E=i(27),x=P(E),w=i(15),S=i(41),N=P(S);function P(O){return O&&O.__esModule?O:{default:O}}function I(O,C){if(!(O instanceof C))throw new TypeError("Cannot call a class as a function")}function R(O,C){if(!O)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C&&(typeof C=="object"||typeof C=="function")?C:O}function U(O,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof C);O.prototype=Object.create(C&&C.prototype,{constructor:{value:O,enumerable:!1,writable:!0,configurable:!0}}),C&&(Object.setPrototypeOf?Object.setPrototypeOf(O,C):O.__proto__=C)}var j=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],k=function(O){U(C,O);function C(D,M){I(this,C),M.modules.toolbar!=null&&M.modules.toolbar.container==null&&(M.modules.toolbar.container=j);var $=R(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,D,M));return $.quill.container.classList.add("ql-snow"),$}return l(C,[{key:"extendToolbar",value:function(M){M.container.classList.add("ql-snow"),this.buildButtons([].slice.call(M.container.querySelectorAll("button")),N.default),this.buildPickers([].slice.call(M.container.querySelectorAll("select")),N.default),this.tooltip=new F(this.quill,this.options.bounds),M.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function($,G){M.handlers.link.call(M,!G.format.link)})}}]),C}(_.default);k.DEFAULTS=(0,f.default)(!0,{},_.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(C){if(C){var D=this.quill.getSelection();if(D==null||D.length==0)return;var M=this.quill.getText(D);/^\S+@\S+\.\S+$/.test(M)&&M.indexOf("mailto:")!==0&&(M="mailto:"+M);var $=this.quill.theme.tooltip;$.edit("link",M)}else this.quill.format("link",!1)}}}}});var F=function(O){U(C,O);function C(D,M){I(this,C);var $=R(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,D,M));return $.preview=$.root.querySelector("a.ql-preview"),$}return l(C,[{key:"listen",value:function(){var M=this;o(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function($){M.root.classList.contains("ql-editing")?M.save():M.edit("link",M.preview.textContent),$.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function($){if(M.linkRange!=null){var G=M.linkRange;M.restoreFocus(),M.quill.formatText(G,"link",!1,y.default.sources.USER),delete M.linkRange}$.preventDefault(),M.hide()}),this.quill.on(y.default.events.SELECTION_CHANGE,function($,G,re){if($!=null){if($.length===0&&re===y.default.sources.USER){var oe=M.quill.scroll.descendant(x.default,$.index),ie=s(oe,2),X=ie[0],Y=ie[1];if(X!=null){M.linkRange=new w.Range($.index-Y,X.length());var B=x.default.formats(X.domNode);M.preview.textContent=B,M.preview.setAttribute("href",B),M.show(),M.position(M.quill.getBounds(M.linkRange));return}}else delete M.linkRange;M.hide()}})}},{key:"show",value:function(){o(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),C}(g.BaseTooltip);F.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),r.default=k},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=i(29),o=ke(s),l=i(36),d=i(38),f=i(64),m=i(65),y=ke(m),g=i(66),_=ke(g),E=i(67),x=ke(E),w=i(37),S=i(26),N=i(39),P=i(40),I=i(56),R=ke(I),U=i(68),j=ke(U),k=i(27),F=ke(k),O=i(69),C=ke(O),D=i(70),M=ke(D),$=i(71),G=ke($),re=i(72),oe=ke(re),ie=i(73),X=ke(ie),Y=i(13),B=ke(Y),Z=i(74),te=ke(Z),se=i(75),ae=ke(se),Q=i(57),ce=ke(Q),me=i(41),ge=ke(me),Ae=i(28),Ve=ke(Ae),Ye=i(59),Ge=ke(Ye),ot=i(60),nt=ke(ot),It=i(61),Gt=ke(It),Se=i(108),Ne=ke(Se),De=i(62),ze=ke(De);function ke(gt){return gt&&gt.__esModule?gt:{default:gt}}o.default.register({"attributors/attribute/direction":d.DirectionAttribute,"attributors/class/align":l.AlignClass,"attributors/class/background":w.BackgroundClass,"attributors/class/color":S.ColorClass,"attributors/class/direction":d.DirectionClass,"attributors/class/font":N.FontClass,"attributors/class/size":P.SizeClass,"attributors/style/align":l.AlignStyle,"attributors/style/background":w.BackgroundStyle,"attributors/style/color":S.ColorStyle,"attributors/style/direction":d.DirectionStyle,"attributors/style/font":N.FontStyle,"attributors/style/size":P.SizeStyle},!0),o.default.register({"formats/align":l.AlignClass,"formats/direction":d.DirectionClass,"formats/indent":f.IndentClass,"formats/background":w.BackgroundStyle,"formats/color":S.ColorStyle,"formats/font":N.FontClass,"formats/size":P.SizeClass,"formats/blockquote":y.default,"formats/code-block":B.default,"formats/header":_.default,"formats/list":x.default,"formats/bold":R.default,"formats/code":Y.Code,"formats/italic":j.default,"formats/link":F.default,"formats/script":C.default,"formats/strike":M.default,"formats/underline":G.default,"formats/image":oe.default,"formats/video":X.default,"formats/list/item":E.ListItem,"modules/formula":te.default,"modules/syntax":ae.default,"modules/toolbar":ce.default,"themes/bubble":Ne.default,"themes/snow":ze.default,"ui/icons":ge.default,"ui/picker":Ve.default,"ui/icon-picker":nt.default,"ui/color-picker":Ge.default,"ui/tooltip":Gt.default},!0),r.default=o.default},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.IndentClass=void 0;var s=function(){function x(w,S){for(var N=0;N<S.length;N++){var P=S[N];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(w,P.key,P)}}return function(w,S,N){return S&&x(w.prototype,S),N&&x(w,N),w}}(),o=function x(w,S,N){w===null&&(w=Function.prototype);var P=Object.getOwnPropertyDescriptor(w,S);if(P===void 0){var I=Object.getPrototypeOf(w);return I===null?void 0:x(I,S,N)}else{if("value"in P)return P.value;var R=P.get;return R===void 0?void 0:R.call(N)}},l=i(0),d=f(l);function f(x){return x&&x.__esModule?x:{default:x}}function m(x,w){if(!(x instanceof w))throw new TypeError("Cannot call a class as a function")}function y(x,w){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:x}function g(x,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);x.prototype=Object.create(w&&w.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(x,w):x.__proto__=w)}var _=function(x){g(w,x);function w(){return m(this,w),y(this,(w.__proto__||Object.getPrototypeOf(w)).apply(this,arguments))}return s(w,[{key:"add",value:function(N,P){if(P==="+1"||P==="-1"){var I=this.value(N)||0;P=P==="+1"?I+1:I-1}return P===0?(this.remove(N),!0):o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"add",this).call(this,N,P)}},{key:"canAdd",value:function(N,P){return o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"canAdd",this).call(this,N,P)||o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"canAdd",this).call(this,N,parseInt(P))}},{key:"value",value:function(N){return parseInt(o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"value",this).call(this,N))||void 0}}]),w}(d.default.Attributor.Class),E=new _("indent","ql-indent",{scope:d.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});r.IndentClass=E},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=i(4),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}function d(g,_){if(!(g instanceof _))throw new TypeError("Cannot call a class as a function")}function f(g,_){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:g}function m(g,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);g.prototype=Object.create(_&&_.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(g,_):g.__proto__=_)}var y=function(g){m(_,g);function _(){return d(this,_),f(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return _}(o.default);y.blotName="blockquote",y.tagName="blockquote",r.default=y},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function _(E,x){for(var w=0;w<x.length;w++){var S=x[w];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(E,S.key,S)}}return function(E,x,w){return x&&_(E.prototype,x),w&&_(E,w),E}}(),o=i(4),l=d(o);function d(_){return _&&_.__esModule?_:{default:_}}function f(_,E){if(!(_ instanceof E))throw new TypeError("Cannot call a class as a function")}function m(_,E){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&(typeof E=="object"||typeof E=="function")?E:_}function y(_,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);_.prototype=Object.create(E&&E.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(_,E):_.__proto__=E)}var g=function(_){y(E,_);function E(){return f(this,E),m(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return s(E,null,[{key:"formats",value:function(w){return this.tagName.indexOf(w.tagName)+1}}]),E}(l.default);g.blotName="header",g.tagName=["H1","H2","H3","H4","H5","H6"],r.default=g},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.ListItem=void 0;var s=function(){function I(R,U){for(var j=0;j<U.length;j++){var k=U[j];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(R,k.key,k)}}return function(R,U,j){return U&&I(R.prototype,U),j&&I(R,j),R}}(),o=function I(R,U,j){R===null&&(R=Function.prototype);var k=Object.getOwnPropertyDescriptor(R,U);if(k===void 0){var F=Object.getPrototypeOf(R);return F===null?void 0:I(F,U,j)}else{if("value"in k)return k.value;var O=k.get;return O===void 0?void 0:O.call(j)}},l=i(0),d=_(l),f=i(4),m=_(f),y=i(25),g=_(y);function _(I){return I&&I.__esModule?I:{default:I}}function E(I,R,U){return R in I?Object.defineProperty(I,R,{value:U,enumerable:!0,configurable:!0,writable:!0}):I[R]=U,I}function x(I,R){if(!(I instanceof R))throw new TypeError("Cannot call a class as a function")}function w(I,R){if(!I)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R&&(typeof R=="object"||typeof R=="function")?R:I}function S(I,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof R);I.prototype=Object.create(R&&R.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}),R&&(Object.setPrototypeOf?Object.setPrototypeOf(I,R):I.__proto__=R)}var N=function(I){S(R,I);function R(){return x(this,R),w(this,(R.__proto__||Object.getPrototypeOf(R)).apply(this,arguments))}return s(R,[{key:"format",value:function(j,k){j===P.blotName&&!k?this.replaceWith(d.default.create(this.statics.scope)):o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"format",this).call(this,j,k)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(j,k){return this.parent.isolate(this.offset(this.parent),this.length()),j===this.parent.statics.blotName?(this.parent.replaceWith(j,k),this):(this.parent.unwrap(),o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"replaceWith",this).call(this,j,k))}}],[{key:"formats",value:function(j){return j.tagName===this.tagName?void 0:o(R.__proto__||Object.getPrototypeOf(R),"formats",this).call(this,j)}}]),R}(m.default);N.blotName="list-item",N.tagName="LI";var P=function(I){S(R,I),s(R,null,[{key:"create",value:function(j){var k=j==="ordered"?"OL":"UL",F=o(R.__proto__||Object.getPrototypeOf(R),"create",this).call(this,k);return(j==="checked"||j==="unchecked")&&F.setAttribute("data-checked",j==="checked"),F}},{key:"formats",value:function(j){if(j.tagName==="OL")return"ordered";if(j.tagName==="UL")return j.hasAttribute("data-checked")?j.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function R(U){x(this,R);var j=w(this,(R.__proto__||Object.getPrototypeOf(R)).call(this,U)),k=function(O){if(O.target.parentNode===U){var C=j.statics.formats(U),D=d.default.find(O.target);C==="checked"?D.format("list","unchecked"):C==="unchecked"&&D.format("list","checked")}};return U.addEventListener("touchstart",k),U.addEventListener("mousedown",k),j}return s(R,[{key:"format",value:function(j,k){this.children.length>0&&this.children.tail.format(j,k)}},{key:"formats",value:function(){return E({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(j,k){if(j instanceof N)o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"insertBefore",this).call(this,j,k);else{var F=k==null?this.length():k.offset(this),O=this.split(F);O.parent.insertBefore(j,O)}}},{key:"optimize",value:function(j){o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"optimize",this).call(this,j);var k=this.next;k!=null&&k.prev===this&&k.statics.blotName===this.statics.blotName&&k.domNode.tagName===this.domNode.tagName&&k.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(k.moveChildren(this),k.remove())}},{key:"replace",value:function(j){if(j.statics.blotName!==this.statics.blotName){var k=d.default.create(this.statics.defaultChild);j.moveChildren(k),this.appendChild(k)}o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"replace",this).call(this,j)}}]),R}(g.default);P.blotName="list",P.scope=d.default.Scope.BLOCK_BLOT,P.tagName=["OL","UL"],P.defaultChild="list-item",P.allowedChildren=[N],r.ListItem=N,r.default=P},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=i(56),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}function d(g,_){if(!(g instanceof _))throw new TypeError("Cannot call a class as a function")}function f(g,_){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:g}function m(g,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);g.prototype=Object.create(_&&_.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(g,_):g.__proto__=_)}var y=function(g){m(_,g);function _(){return d(this,_),f(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return _}(o.default);y.blotName="italic",y.tagName=["EM","I"],r.default=y},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function E(x,w){for(var S=0;S<w.length;S++){var N=w[S];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(x,N.key,N)}}return function(x,w,S){return w&&E(x.prototype,w),S&&E(x,S),x}}(),o=function E(x,w,S){x===null&&(x=Function.prototype);var N=Object.getOwnPropertyDescriptor(x,w);if(N===void 0){var P=Object.getPrototypeOf(x);return P===null?void 0:E(P,w,S)}else{if("value"in N)return N.value;var I=N.get;return I===void 0?void 0:I.call(S)}},l=i(6),d=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function y(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var _=function(E){g(x,E);function x(){return m(this,x),y(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return s(x,null,[{key:"create",value:function(S){return S==="super"?document.createElement("sup"):S==="sub"?document.createElement("sub"):o(x.__proto__||Object.getPrototypeOf(x),"create",this).call(this,S)}},{key:"formats",value:function(S){if(S.tagName==="SUB")return"sub";if(S.tagName==="SUP")return"super"}}]),x}(d.default);_.blotName="script",_.tagName=["SUB","SUP"],r.default=_},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=i(6),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}function d(g,_){if(!(g instanceof _))throw new TypeError("Cannot call a class as a function")}function f(g,_){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:g}function m(g,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);g.prototype=Object.create(_&&_.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(g,_):g.__proto__=_)}var y=function(g){m(_,g);function _(){return d(this,_),f(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return _}(o.default);y.blotName="strike",y.tagName="S",r.default=y},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=i(6),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}function d(g,_){if(!(g instanceof _))throw new TypeError("Cannot call a class as a function")}function f(g,_){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:g}function m(g,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);g.prototype=Object.create(_&&_.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(g,_):g.__proto__=_)}var y=function(g){m(_,g);function _(){return d(this,_),f(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return _}(o.default);y.blotName="underline",y.tagName="U",r.default=y},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function w(S,N){for(var P=0;P<N.length;P++){var I=N[P];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(S,I.key,I)}}return function(S,N,P){return N&&w(S.prototype,N),P&&w(S,P),S}}(),o=function w(S,N,P){S===null&&(S=Function.prototype);var I=Object.getOwnPropertyDescriptor(S,N);if(I===void 0){var R=Object.getPrototypeOf(S);return R===null?void 0:w(R,N,P)}else{if("value"in I)return I.value;var U=I.get;return U===void 0?void 0:U.call(P)}},l=i(0),d=m(l),f=i(27);function m(w){return w&&w.__esModule?w:{default:w}}function y(w,S){if(!(w instanceof S))throw new TypeError("Cannot call a class as a function")}function g(w,S){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:w}function _(w,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);w.prototype=Object.create(S&&S.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(w,S):w.__proto__=S)}var E=["alt","height","width"],x=function(w){_(S,w);function S(){return y(this,S),g(this,(S.__proto__||Object.getPrototypeOf(S)).apply(this,arguments))}return s(S,[{key:"format",value:function(P,I){E.indexOf(P)>-1?I?this.domNode.setAttribute(P,I):this.domNode.removeAttribute(P):o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"format",this).call(this,P,I)}}],[{key:"create",value:function(P){var I=o(S.__proto__||Object.getPrototypeOf(S),"create",this).call(this,P);return typeof P=="string"&&I.setAttribute("src",this.sanitize(P)),I}},{key:"formats",value:function(P){return E.reduce(function(I,R){return P.hasAttribute(R)&&(I[R]=P.getAttribute(R)),I},{})}},{key:"match",value:function(P){return/\.(jpe?g|gif|png)$/.test(P)||/^data:image\/.+;base64/.test(P)}},{key:"sanitize",value:function(P){return(0,f.sanitize)(P,["http","https","data"])?P:"//:0"}},{key:"value",value:function(P){return P.getAttribute("src")}}]),S}(d.default.Embed);x.blotName="image",x.tagName="IMG",r.default=x},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0});var s=function(){function w(S,N){for(var P=0;P<N.length;P++){var I=N[P];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(S,I.key,I)}}return function(S,N,P){return N&&w(S.prototype,N),P&&w(S,P),S}}(),o=function w(S,N,P){S===null&&(S=Function.prototype);var I=Object.getOwnPropertyDescriptor(S,N);if(I===void 0){var R=Object.getPrototypeOf(S);return R===null?void 0:w(R,N,P)}else{if("value"in I)return I.value;var U=I.get;return U===void 0?void 0:U.call(P)}},l=i(4),d=i(27),f=m(d);function m(w){return w&&w.__esModule?w:{default:w}}function y(w,S){if(!(w instanceof S))throw new TypeError("Cannot call a class as a function")}function g(w,S){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:w}function _(w,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);w.prototype=Object.create(S&&S.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(w,S):w.__proto__=S)}var E=["height","width"],x=function(w){_(S,w);function S(){return y(this,S),g(this,(S.__proto__||Object.getPrototypeOf(S)).apply(this,arguments))}return s(S,[{key:"format",value:function(P,I){E.indexOf(P)>-1?I?this.domNode.setAttribute(P,I):this.domNode.removeAttribute(P):o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"format",this).call(this,P,I)}}],[{key:"create",value:function(P){var I=o(S.__proto__||Object.getPrototypeOf(S),"create",this).call(this,P);return I.setAttribute("frameborder","0"),I.setAttribute("allowfullscreen",!0),I.setAttribute("src",this.sanitize(P)),I}},{key:"formats",value:function(P){return E.reduce(function(I,R){return P.hasAttribute(R)&&(I[R]=P.getAttribute(R)),I},{})}},{key:"sanitize",value:function(P){return f.default.sanitize(P)}},{key:"value",value:function(P){return P.getAttribute("src")}}]),S}(l.BlockEmbed);x.blotName="video",x.className="ql-video",x.tagName="IFRAME",r.default=x},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.FormulaBlot=void 0;var s=function(){function P(I,R){for(var U=0;U<R.length;U++){var j=R[U];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(I,j.key,j)}}return function(I,R,U){return R&&P(I.prototype,R),U&&P(I,U),I}}(),o=function P(I,R,U){I===null&&(I=Function.prototype);var j=Object.getOwnPropertyDescriptor(I,R);if(j===void 0){var k=Object.getPrototypeOf(I);return k===null?void 0:P(k,R,U)}else{if("value"in j)return j.value;var F=j.get;return F===void 0?void 0:F.call(U)}},l=i(35),d=_(l),f=i(5),m=_(f),y=i(9),g=_(y);function _(P){return P&&P.__esModule?P:{default:P}}function E(P,I){if(!(P instanceof I))throw new TypeError("Cannot call a class as a function")}function x(P,I){if(!P)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I&&(typeof I=="object"||typeof I=="function")?I:P}function w(P,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof I);P.prototype=Object.create(I&&I.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),I&&(Object.setPrototypeOf?Object.setPrototypeOf(P,I):P.__proto__=I)}var S=function(P){w(I,P);function I(){return E(this,I),x(this,(I.__proto__||Object.getPrototypeOf(I)).apply(this,arguments))}return s(I,null,[{key:"create",value:function(U){var j=o(I.__proto__||Object.getPrototypeOf(I),"create",this).call(this,U);return typeof U=="string"&&(window.katex.render(U,j,{throwOnError:!1,errorColor:"#f00"}),j.setAttribute("data-value",U)),j}},{key:"value",value:function(U){return U.getAttribute("data-value")}}]),I}(d.default);S.blotName="formula",S.className="ql-formula",S.tagName="SPAN";var N=function(P){w(I,P),s(I,null,[{key:"register",value:function(){m.default.register(S,!0)}}]);function I(){E(this,I);var R=x(this,(I.__proto__||Object.getPrototypeOf(I)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return R}return I}(g.default);r.FormulaBlot=S,r.default=N},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.CodeToken=r.CodeBlock=void 0;var s=function(){function U(j,k){for(var F=0;F<k.length;F++){var O=k[F];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(j,O.key,O)}}return function(j,k,F){return k&&U(j.prototype,k),F&&U(j,F),j}}(),o=function U(j,k,F){j===null&&(j=Function.prototype);var O=Object.getOwnPropertyDescriptor(j,k);if(O===void 0){var C=Object.getPrototypeOf(j);return C===null?void 0:U(C,k,F)}else{if("value"in O)return O.value;var D=O.get;return D===void 0?void 0:D.call(F)}},l=i(0),d=x(l),f=i(5),m=x(f),y=i(9),g=x(y),_=i(13),E=x(_);function x(U){return U&&U.__esModule?U:{default:U}}function w(U,j){if(!(U instanceof j))throw new TypeError("Cannot call a class as a function")}function S(U,j){if(!U)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return j&&(typeof j=="object"||typeof j=="function")?j:U}function N(U,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof j);U.prototype=Object.create(j&&j.prototype,{constructor:{value:U,enumerable:!1,writable:!0,configurable:!0}}),j&&(Object.setPrototypeOf?Object.setPrototypeOf(U,j):U.__proto__=j)}var P=function(U){N(j,U);function j(){return w(this,j),S(this,(j.__proto__||Object.getPrototypeOf(j)).apply(this,arguments))}return s(j,[{key:"replaceWith",value:function(F){this.domNode.textContent=this.domNode.textContent,this.attach(),o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"replaceWith",this).call(this,F)}},{key:"highlight",value:function(F){var O=this.domNode.textContent;this.cachedText!==O&&((O.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=F(O),this.domNode.normalize(),this.attach()),this.cachedText=O)}}]),j}(E.default);P.className="ql-syntax";var I=new d.default.Attributor.Class("token","hljs",{scope:d.default.Scope.INLINE}),R=function(U){N(j,U),s(j,null,[{key:"register",value:function(){m.default.register(I,!0),m.default.register(P,!0)}}]);function j(k,F){w(this,j);var O=S(this,(j.__proto__||Object.getPrototypeOf(j)).call(this,k,F));if(typeof O.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var C=null;return O.quill.on(m.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(C),C=setTimeout(function(){O.highlight(),C=null},O.options.interval)}),O.highlight(),O}return s(j,[{key:"highlight",value:function(){var F=this;if(!this.quill.selection.composing){this.quill.update(m.default.sources.USER);var O=this.quill.getSelection();this.quill.scroll.descendants(P).forEach(function(C){C.highlight(F.options.highlight)}),this.quill.update(m.default.sources.SILENT),O!=null&&this.quill.setSelection(O,m.default.sources.SILENT)}}}]),j}(g.default);R.DEFAULTS={highlight:function(){return window.hljs==null?null:function(U){var j=window.hljs.highlightAuto(U);return j.value}}(),interval:1e3},r.CodeBlock=P,r.CodeToken=I,r.default=R},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(t,r){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(t,r){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(t,r){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(t,r){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(t,r){t.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(t,r,i){Object.defineProperty(r,"__esModule",{value:!0}),r.default=r.BubbleTooltip=void 0;var s=function j(k,F,O){k===null&&(k=Function.prototype);var C=Object.getOwnPropertyDescriptor(k,F);if(C===void 0){var D=Object.getPrototypeOf(k);return D===null?void 0:j(D,F,O)}else{if("value"in C)return C.value;var M=C.get;return M===void 0?void 0:M.call(O)}},o=function(){function j(k,F){for(var O=0;O<F.length;O++){var C=F[O];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(k,C.key,C)}}return function(k,F,O){return F&&j(k.prototype,F),O&&j(k,O),k}}(),l=i(3),d=w(l),f=i(8),m=w(f),y=i(43),g=w(y),_=i(15),E=i(41),x=w(E);function w(j){return j&&j.__esModule?j:{default:j}}function S(j,k){if(!(j instanceof k))throw new TypeError("Cannot call a class as a function")}function N(j,k){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k&&(typeof k=="object"||typeof k=="function")?k:j}function P(j,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof k);j.prototype=Object.create(k&&k.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),k&&(Object.setPrototypeOf?Object.setPrototypeOf(j,k):j.__proto__=k)}var I=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],R=function(j){P(k,j);function k(F,O){S(this,k),O.modules.toolbar!=null&&O.modules.toolbar.container==null&&(O.modules.toolbar.container=I);var C=N(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,F,O));return C.quill.container.classList.add("ql-bubble"),C}return o(k,[{key:"extendToolbar",value:function(O){this.tooltip=new U(this.quill,this.options.bounds),this.tooltip.root.appendChild(O.container),this.buildButtons([].slice.call(O.container.querySelectorAll("button")),x.default),this.buildPickers([].slice.call(O.container.querySelectorAll("select")),x.default)}}]),k}(g.default);R.DEFAULTS=(0,d.default)(!0,{},g.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(k){k?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var U=function(j){P(k,j);function k(F,O){S(this,k);var C=N(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,F,O));return C.quill.on(m.default.events.EDITOR_CHANGE,function(D,M,$,G){if(D===m.default.events.SELECTION_CHANGE)if(M!=null&&M.length>0&&G===m.default.sources.USER){C.show(),C.root.style.left="0px",C.root.style.width="",C.root.style.width=C.root.offsetWidth+"px";var re=C.quill.getLines(M.index,M.length);if(re.length===1)C.position(C.quill.getBounds(M));else{var oe=re[re.length-1],ie=C.quill.getIndex(oe),X=Math.min(oe.length()-1,M.index+M.length-ie),Y=C.quill.getBounds(new _.Range(ie,X));C.position(Y)}}else document.activeElement!==C.textbox&&C.quill.hasFocus()&&C.hide()}),C}return o(k,[{key:"listen",value:function(){var O=this;s(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){O.root.classList.remove("ql-editing")}),this.quill.on(m.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!O.root.classList.contains("ql-hidden")){var C=O.quill.getSelection();C!=null&&O.position(O.quill.getBounds(C))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(O){var C=s(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"position",this).call(this,O),D=this.root.querySelector(".ql-tooltip-arrow");if(D.style.marginLeft="",C===0)return C;D.style.marginLeft=-1*C-D.offsetWidth/2+"px"}}]),k}(y.BaseTooltip);U.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),r.BubbleTooltip=U,r.default=R},function(t,r,i){t.exports=i(63)}]).default})}(gg)),gg.exports}var eo,MI;function LH(){if(MI)return eo;MI=1;var n=eo&&eo.__extends||function(){var m=function(y,g){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,E){_.__proto__=E}||function(_,E){for(var x in E)E.hasOwnProperty(x)&&(_[x]=E[x])},m(y,g)};return function(y,g){m(y,g);function _(){this.constructor=y}y.prototype=g===null?Object.create(g):(_.prototype=g.prototype,new _)}}(),e=eo&&eo.__assign||function(){return e=Object.assign||function(m){for(var y,g=1,_=arguments.length;g<_;g++){y=arguments[g];for(var E in y)Object.prototype.hasOwnProperty.call(y,E)&&(m[E]=y[E])}return m},e.apply(this,arguments)},t=eo&&eo.__spreadArrays||function(){for(var m=0,y=0,g=arguments.length;y<g;y++)m+=arguments[y].length;for(var _=Array(m),E=0,y=0;y<g;y++)for(var x=arguments[y],w=0,S=x.length;w<S;w++,E++)_[E]=x[w];return _},r=eo&&eo.__importDefault||function(m){return m&&m.__esModule?m:{default:m}},i=r(oy()),s=r(Rx()),o=r(OH()),l=r(DH()),d=function(m){n(y,m);function y(g){var _=m.call(this,g)||this;_.dirtyProps=["modules","formats","bounds","theme","children"],_.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],_.state={generation:0},_.selection=null,_.onEditorChange=function(x,w,S,N){var P,I,R,U;x==="text-change"?(I=(P=_).onEditorChangeText)===null||I===void 0||I.call(P,_.editor.root.innerHTML,w,N,_.unprivilegedEditor):x==="selection-change"&&((U=(R=_).onEditorChangeSelection)===null||U===void 0||U.call(R,w,N,_.unprivilegedEditor))};var E=_.isControlled()?g.value:g.defaultValue;return _.value=E??"",_}return y.prototype.validateProps=function(g){var _;if(i.default.Children.count(g.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(i.default.Children.count(g.children)){var E=i.default.Children.only(g.children);if(((_=E)===null||_===void 0?void 0:_.type)==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.")}if(this.lastDeltaChangeSet&&g.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")},y.prototype.shouldComponentUpdate=function(g,_){var E=this,x;if(this.validateProps(g),!this.editor||this.state.generation!==_.generation)return!0;if("value"in g){var w=this.getEditorContents(),S=(x=g.value,x??"");this.isEqualValue(S,w)||this.setEditorContents(this.editor,S)}return g.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,g.readOnly),t(this.cleanProps,this.dirtyProps).some(function(N){return!o.default(g[N],E.props[N])})},y.prototype.shouldComponentRegenerate=function(g){var _=this;return this.dirtyProps.some(function(E){return!o.default(g[E],_.props[E])})},y.prototype.componentDidMount=function(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())},y.prototype.componentWillUnmount=function(){this.destroyEditor()},y.prototype.componentDidUpdate=function(g,_){var E=this;if(this.editor&&this.shouldComponentRegenerate(g)){var x=this.editor.getContents(),w=this.editor.getSelection();this.regenerationSnapshot={delta:x,selection:w},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.state.generation!==_.generation){var S=this.regenerationSnapshot,x=S.delta,N=S.selection;delete this.regenerationSnapshot,this.instantiateEditor();var P=this.editor;P.setContents(x),f(function(){return E.setEditorSelection(P,N)})}},y.prototype.instantiateEditor=function(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())},y.prototype.destroyEditor=function(){this.editor&&this.unhookEditor(this.editor)},y.prototype.isControlled=function(){return"value"in this.props},y.prototype.getEditorConfig=function(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,scrollingContainer:this.props.scrollingContainer,tabIndex:this.props.tabIndex,theme:this.props.theme}},y.prototype.getEditor=function(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor},y.prototype.createEditor=function(g,_){var E=new l.default(g,_);return _.tabIndex!=null&&this.setEditorTabIndex(E,_.tabIndex),this.hookEditor(E),E},y.prototype.hookEditor=function(g){this.unprivilegedEditor=this.makeUnprivilegedEditor(g),g.on("editor-change",this.onEditorChange)},y.prototype.unhookEditor=function(g){g.off("editor-change",this.onEditorChange)},y.prototype.getEditorContents=function(){return this.value},y.prototype.getEditorSelection=function(){return this.selection},y.prototype.isDelta=function(g){return g&&g.ops},y.prototype.isEqualValue=function(g,_){return this.isDelta(g)&&this.isDelta(_)?o.default(g.ops,_.ops):o.default(g,_)},y.prototype.setEditorContents=function(g,_){var E=this;this.value=_;var x=this.getEditorSelection();typeof _=="string"?g.setContents(g.clipboard.convert(_)):g.setContents(_),f(function(){return E.setEditorSelection(g,x)})},y.prototype.setEditorSelection=function(g,_){if(this.selection=_,_){var E=g.getLength();_.index=Math.max(0,Math.min(_.index,E-1)),_.length=Math.max(0,Math.min(_.length,E-1-_.index)),g.setSelection(_)}},y.prototype.setEditorTabIndex=function(g,_){var E,x;!((x=(E=g)===null||E===void 0?void 0:E.scroll)===null||x===void 0)&&x.domNode&&(g.scroll.domNode.tabIndex=_)},y.prototype.setEditorReadOnly=function(g,_){_?g.disable():g.enable()},y.prototype.makeUnprivilegedEditor=function(g){var _=g;return{getHTML:function(){return _.root.innerHTML},getLength:_.getLength.bind(_),getText:_.getText.bind(_),getContents:_.getContents.bind(_),getSelection:_.getSelection.bind(_),getBounds:_.getBounds.bind(_)}},y.prototype.getEditingArea=function(){if(!this.editingArea)throw new Error("Instantiating on missing editing area");var g=s.default.findDOMNode(this.editingArea);if(!g)throw new Error("Cannot find element for editing area");if(g.nodeType===3)throw new Error("Editing area cannot be a text node");return g},y.prototype.renderEditingArea=function(){var g=this,_=this.props,E=_.children,x=_.preserveWhitespace,w=this.state.generation,S={key:w,ref:function(N){g.editingArea=N}};return i.default.Children.count(E)?i.default.cloneElement(i.default.Children.only(E),S):x?i.default.createElement("pre",e({},S)):i.default.createElement("div",e({},S))},y.prototype.render=function(){var g;return i.default.createElement("div",{id:this.props.id,style:this.props.style,key:this.state.generation,className:"quill "+(g=this.props.className,g??""),onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())},y.prototype.onEditorChangeText=function(g,_,E,x){var w,S;if(this.editor){var N=this.isDelta(this.value)?x.getContents():x.getHTML();N!==this.getEditorContents()&&(this.lastDeltaChangeSet=_,this.value=N,(S=(w=this.props).onChange)===null||S===void 0||S.call(w,g,_,E,x))}},y.prototype.onEditorChangeSelection=function(g,_,E){var x,w,S,N,P,I;if(this.editor){var R=this.getEditorSelection(),U=!R&&g,j=R&&!g;o.default(g,R)||(this.selection=g,(w=(x=this.props).onChangeSelection)===null||w===void 0||w.call(x,g,_,E),U?(N=(S=this.props).onFocus)===null||N===void 0||N.call(S,g,_,E):j&&((I=(P=this.props).onBlur)===null||I===void 0||I.call(P,R,_,E)))}},y.prototype.focus=function(){this.editor&&this.editor.focus()},y.prototype.blur=function(){this.editor&&(this.selection=null,this.editor.blur())},y.displayName="React Quill",y.Quill=l.default,y.defaultProps={theme:"snow",modules:{},readOnly:!1},y}(i.default.Component);function f(m){Promise.resolve().then(m)}return eo=d,eo}var FH=LH();const VH=Px(FH),zH={toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["link"],[{color:[]},{background:[]}],[{align:[]}],["clean"]]},BH=["header","bold","italic","underline","strike","list","bullet","link","color","background","align"],t0=({value:n,onChange:e,placeholder:t,readOnly:r=!1,theme:i="snow",className:s=""})=>u.jsx(VH,{theme:i,value:n||"",onChange:e,modules:zH,formats:BH,placeholder:t,readOnly:r,className:s}),UH=({isOpen:n,onClose:e,ticket:t,db:r,adminUserData:i,showNotification:s,onTicketUpdate:o})=>{const[l,d]=ee.useState(null),[f,m]=ee.useState(""),[y,g]=ee.useState(""),[_,E]=ee.useState(!1),[x,w]=ee.useState(!1),[S,N]=ee.useState(!1),P=ee.useRef(null);if(ee.useEffect(()=>{t?(d(t),m(t.status||"Open"),g("")):d(null)},[t]),ee.useEffect(()=>{var M;(M=P.current)==null||M.scrollIntoView({behavior:"smooth",block:"end"})},[l==null?void 0:l.conversation]),!n||!l)return null;const I="w-full px-3 py-2 rounded-md bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm",R="flex items-center justify-center px-4 py-2 rounded-md font-semibold text-sm transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95",U=async()=>{if(!f||f===l.status){s("Status is unchanged or invalid.","info");return}E(!0);const M={status:f,lastUpdatedByAdminName:i.displayName||"Admin",lastUpdatedByAdminId:i.uid},$=await k8(r,l.id,M);if($.success){s("Ticket status updated!","success");const G={...l,...M,status:f,lastUpdatedAt:Ot.now()};d(G),o&&o(G)}else s($.error||"Failed to update status.","error");E(!1)},j=M=>{g(M)},k=async()=>{if(!y.replace(/<[^>]*>?/gm,"").trim()){s("Reply cannot be empty.","warning");return}w(!0);const G={text:Mo.sanitize(y),authorId:i.uid,authorName:i.displayName||"Admin",authorRole:i.role||"admin",timestamp:Ot.now()},re=await cP(r,l.id,G);if(re.success){s("Reply sent!","success");const oe=[...l.conversation||[],G],ie=f==="Open"||f==="Awaiting Customer"?"In Progress":f,X={...l,conversation:oe,lastUpdatedAt:Ot.now(),status:ie};ie!==f&&m(ie),d(X),o&&o(X),g("")}else s(re.error||"Failed to send reply.","error");w(!1)},F=async()=>{const M=y.replace(/<[^>]*>?/gm,"").trim();if(!M){s("Write a draft or keywords first.","warning");return}N(!0);try{const $=(l.conversation||[]).map(re=>`${re.authorRole==="admin"?"Support":"Customer"}: ${re.text.replace(/<[^>]*>?/gm,"")}`).join(`

`),G=await RP({ticketDescription:l.description,conversationHistory:$,draftReply:M,customerName:l.userName});g(G),s("AI refined your reply.","success")}catch($){const G=($==null?void 0:$.message)||"AI assistance failed.";s(G,"error")}finally{N(!1)}},O=({label:M,value:$,icon:G,valueClass:re="text-gray-700"})=>u.jsxs("div",{className:"flex items-start py-2 border-b border-slate-100 last:border-b-0",children:[u.jsxs("span",{className:"text-xs font-semibold text-slate-500 w-32 flex items-center shrink-0",children:[G&&u.jsx(G,{size:14,className:"mr-2 text-slate-400"}),M,":"]}),u.jsx("span",{className:`text-sm ${re} flex-1 break-words`,children:$||"N/A"})]}),C=M=>{switch(M){case"Open":return"bg-red-100 text-red-700";case"In Progress":return"bg-yellow-100 text-yellow-700";case"Resolved":return"bg-green-100 text-green-700";case"Closed":return"bg-purple-100 text-purple-700";case"Awaiting Customer":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-600"}},D=["Open","In Progress","Awaiting Customer","Resolved","Closed"];return u.jsxs(Or,{isOpen:n,onClose:e,title:"Ticket Details",size:"full",modalDialogClassName:"sm:max-w-4xl w-[95vw] h-[95vh]",contentClassName:"p-0 flex flex-col",children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 bg-slate-50 rounded-t-xl sticky top-0 z-10",children:[u.jsxs("h3",{className:"text-lg font-semibold text-slate-800 truncate",title:l.issueType,children:[l.issueType," - ID: ",l.id.substring(0,8),"..."]}),u.jsx("button",{onClick:e,className:"p-2 text-gray-500 hover:text-gray-700 rounded-lg",children:u.jsx(qy,{size:18})})]}),u.jsxs("div",{className:"overflow-y-auto flex-grow p-4 space-y-4",children:[u.jsx("div",{className:"p-4 border rounded-lg bg-slate-50/70",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4",children:[u.jsx(O,{label:"User",value:`${l.userName} (${l.userEmail||"N/A"})`,icon:ks}),u.jsx(O,{label:"Account No",value:l.accountNumber||"N/A",icon:Cs}),u.jsx(O,{label:"Submitted",value:Zt(l.submittedAt),icon:au}),u.jsx(O,{label:"Last Update",value:Zt(l.lastUpdatedAt),icon:Ss}),u.jsx(O,{label:"Status",value:u.jsx("span",{className:`px-2 py-0.5 text-xs font-semibold rounded-full ${C(l.status)}`,children:l.status}),icon:Xt}),u.jsx(O,{label:"Ticket ID",value:l.id,icon:Cs,valueClass:"font-mono text-xs"})]})}),u.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[u.jsx("h4",{className:"text-sm font-semibold text-slate-600 mb-1",children:"Initial Description:"}),u.jsx("div",{className:"p-3 bg-slate-100 rounded-md text-sm text-slate-800 whitespace-pre-line prose prose-sm max-w-none",children:l.description})]}),u.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[u.jsx("h4",{className:"text-sm font-semibold text-slate-600 mb-2",children:"Conversation History"}),u.jsxs("div",{className:"max-h-60 overflow-y-auto space-y-3 p-3 bg-slate-50 border rounded-md",children:[l.conversation&&l.conversation.length>0?l.conversation.map((M,$)=>u.jsxs("div",{className:`p-2.5 rounded-lg ${M.authorRole==="admin"?"bg-blue-100":"bg-green-50"}`,children:[u.jsxs("p",{className:"text-xs font-bold text-gray-800",children:[M.authorName," (",M.authorRole,")"]}),u.jsx("div",{className:"text-sm text-gray-700 prose prose-sm max-w-none break-words",dangerouslySetInnerHTML:{__html:Mo.sanitize(M.text||"")}}),u.jsx("p",{className:"text-right text-xs text-gray-500 mt-1",children:Zt(M.timestamp)})]},$)):u.jsx("p",{className:"text-sm text-center text-gray-500 py-4",children:"No replies yet."}),u.jsx("div",{ref:P})]})]}),u.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[u.jsx("h4",{className:"text-sm font-semibold text-slate-600 mb-2",children:"Send Reply"}),u.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[u.jsx(t0,{value:y,onChange:j,placeholder:"Type your reply...",className:"flex-grow bg-white rounded-lg border border-gray-300 min-h-[120px]",readOnly:x||S}),u.jsx("button",{onClick:F,className:`${R} bg-purple-100 text-purple-700 hover:bg-purple-200 self-start p-2`,disabled:S||!y.replace(/<[^>]*>?/gm,"").trim(),title:"Refine reply with AI",children:S?u.jsx(St,{size:18,className:"animate-spin"}):u.jsx(Rs,{size:18})})]}),u.jsxs("button",{onClick:k,className:`${R} bg-blue-600 hover:bg-blue-700 text-white`,disabled:x||!y.replace(/<[^>]*>?/gm,"").trim(),children:[x?u.jsx(St,{size:18,className:"animate-spin mr-2"}):u.jsx(By,{size:16,className:"mr-2"}),"Send Reply"]})]}),u.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[u.jsx("label",{htmlFor:"ticketStatusUpdate",className:"block text-sm font-semibold text-slate-600 mb-1.5",children:"Update Ticket Status:"}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("select",{id:"ticketStatusUpdate",value:f,onChange:M=>m(M.target.value),className:`${I} flex-grow`,disabled:_,children:D.map(M=>u.jsx("option",{value:M,children:M},M))}),u.jsxs("button",{onClick:U,className:`${R} bg-green-600 hover:bg-green-700 text-white`,disabled:_||f===l.status,children:[_?u.jsx(St,{size:18,className:"animate-spin mr-2"}):u.jsx(Oa,{size:18,className:"mr-2"}),"Update Status"]})]})]})]})]})},qH=({db:n,appId:e,userData:t,showNotification:r})=>{const[i,s]=ee.useState([]),[o,l]=ee.useState(!0),[d,f]=ee.useState(null),[m,y]=ee.useState(null),[g,_]=ee.useState(!1),[E,x]=ee.useState(""),[w,S]=ee.useState(""),[N,P]=ee.useState(""),I="w-full sm:w-auto text-sm px-3 py-2 rounded-md bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150",R=`${I} placeholder-gray-400`,U=ee.useCallback(async(G,re)=>{const oe=re==null?void 0:re.autoCloseTicketsDays;if(!oe||isNaN(oe)||oe<=0)return;const ie=new Date,X=[];if(G.forEach(Y=>{var B;if(Y.status==="Resolved"){const Z=(B=Y.lastUpdatedAt)!=null&&B.toDate?Y.lastUpdatedAt.toDate():new Date(0);(ie-Z)/(1e3*60*60*24)>oe&&X.push(Y.id)}}),X.length>0){const Y=await n8(n,X,"Closed");Y.success?r(`Successfully auto-closed ${X.length} inactive ticket(s).`,"success"):r(`Failed to auto-close tickets: ${Y.error}`,"error")}},[n,r]),j=ee.useCallback(async()=>{l(!0);const[G,re]=await Promise.all([yS(n),Gb(n)]);if(G.success){if(s(G.data),re.success&&re.data&&(await U(G.data,re.data),G.data.some(oe=>oe.status==="Resolved"))){const oe=await yS(n);oe.success&&s(oe.data)}}else r(G.error||"Failed to fetch support tickets.","error"),s([]);l(!1)},[n,r,U]);ee.useEffect(()=>{j()},[j]);const k=G=>{f(G)},F=()=>{f(null)},O=G=>{s(re=>re.map(oe=>oe.id===G.id?G:oe))},C=async()=>{if(!m)return;_(!0);const G=await I8(n,m.id);G.success?(r("Support ticket deleted successfully.","success"),j()):r(G.error||"Failed to delete ticket.","error"),_(!1),y(null)},D=G=>{switch(G){case"Open":return"bg-red-100 text-red-700";case"In Progress":return"bg-yellow-100 text-yellow-700";case"On Hold":return"bg-gray-200 text-gray-700";case"Awaiting Customer":return"bg-blue-100 text-blue-700";case"Resolved":return"bg-green-100 text-green-700";case"Closed":return"bg-purple-100 text-purple-700";default:return"bg-gray-100 text-gray-600"}},M=i.filter(G=>{var Y,B,Z,te,se;const re=N.toLowerCase(),oe=N?((Y=G.id)==null?void 0:Y.toLowerCase().includes(re))||((B=G.userName)==null?void 0:B.toLowerCase().includes(re))||((Z=G.userEmail)==null?void 0:Z.toLowerCase().includes(re))||((te=G.accountNumber)==null?void 0:te.toLowerCase().includes(re))||((se=G.description)==null?void 0:se.toLowerCase().includes(re)):!0,ie=E?G.status===E:!0,X=w?G.issueType===w:!0;return oe&&ie&&X}),$=Array.from(new Set(i.map(G=>G.issueType))).sort();return o&&i.length===0?u.jsx(gn,{message:"Loading support tickets...",className:"mt-10 h-64"}):u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(Aa,{size:30,className:"mr-3 text-purple-600"})," Support Ticket Management"]}),u.jsxs("button",{onClick:j,className:"mt-3 sm:mt-0 text-sm flex items-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-3 rounded-lg border border-gray-300 transition-colors",disabled:o,title:"Refresh Ticket List",children:[o?u.jsx(St,{size:16,className:"animate-spin mr-1.5"}):u.jsx(ja,{size:16,className:"mr-1.5"}),"Refresh"]})]}),u.jsxs("div",{className:"mb-5 p-4 bg-gray-50 rounded-lg shadow-sm grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 items-end",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"searchTerm",className:"block text-xs font-medium text-gray-600 mb-1",children:"Search Tickets"}),u.jsx("input",{type:"text",id:"searchTerm",placeholder:"ID, Name, Email, Account#, Keyword...",value:N,onChange:G=>P(G.target.value),className:R})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"filterStatus",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Status"}),u.jsxs("select",{id:"filterStatus",value:E,onChange:G=>x(G.target.value),className:I,children:[u.jsx("option",{value:"",children:"All Statuses"}),["Open","In Progress","On Hold","Awaiting Customer","Resolved","Closed"].map(G=>u.jsx("option",{value:G,children:G},G))]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"filterIssueType",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Issue Type"}),u.jsxs("select",{id:"filterIssueType",value:w,onChange:G=>S(G.target.value),className:I,children:[u.jsx("option",{value:"",children:"All Issue Types"}),$.map(G=>u.jsx("option",{value:G,children:G},G))]})]})]}),!o&&M.length===0&&u.jsxs("div",{className:"text-center py-10",children:[u.jsx(An,{size:48,className:"mx-auto text-gray-400 mb-3"}),u.jsx("p",{className:"text-gray-500 text-lg",children:i.length===0?"No support tickets found in the system.":"No tickets match your current filters."})]}),M.length>0&&u.jsx("div",{className:"overflow-x-auto shadow-md rounded-lg border border-gray-200",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[u.jsx("thead",{className:"bg-gray-100",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ticket ID"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Submitted"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Issue Type"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Update"}),u.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:M.map(G=>u.jsxs("tr",{className:"hover:bg-gray-50/80 transition-colors duration-100",children:[u.jsxs("td",{className:"px-4 py-3 whitespace-nowrap font-mono text-xs text-gray-600",title:G.id,children:[G.id.substring(0,8),"..."]}),u.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-500",children:Zt(G.submittedAt,{month:"short",day:"numeric",year:"2-digit"})}),u.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-800 font-medium truncate max-w-[150px]",title:G.userName||G.userEmail,children:G.userName||G.userEmail}),u.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-600 truncate max-w-[180px]",title:G.issueType,children:G.issueType}),u.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:u.jsx("span",{className:`px-2.5 py-1 inline-flex text-xs leading-tight font-semibold rounded-full ${D(G.status)}`,children:G.status})}),u.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-500",children:Zt(G.lastUpdatedAt||G.lastUpdatedByAdmin||G.submittedAt,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),u.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-center space-x-2",children:[u.jsx("button",{onClick:()=>k(G),className:"text-indigo-600 hover:text-indigo-800 p-1.5 rounded-md hover:bg-indigo-50 transition-colors",title:"View & Manage Ticket",children:u.jsx(Gl,{size:18})}),u.jsx("button",{onClick:()=>y(G),className:"text-red-600 hover:text-red-800 p-1.5 rounded-md hover:bg-red-50 transition-colors",title:"Delete Ticket",children:u.jsx(qd,{size:18})})]})]},G.id))})]})}),d&&t&&u.jsx(UH,{isOpen:!!d,onClose:F,ticket:d,db:n,appId:e,adminUserData:t,showNotification:r,onTicketUpdate:O}),m&&u.jsxs(Jl,{isOpen:!!m,onClose:()=>y(null),onConfirm:C,title:"Confirm Ticket Deletion",confirmText:"Yes, Delete Ticket",isConfirming:g,iconType:"danger",children:[u.jsxs("p",{children:["Are you sure you want to permanently delete ticket ",u.jsxs("strong",{children:[m.id.substring(0,8),"..."]}),"?"]}),u.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"This action cannot be undone."})]})]})},DI="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",HH="flex items-center justify-center px-5 py-2.5 rounded-lg font-semibold text-sm transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95",zh=({field:n,settings:e,handleChange:t})=>{const r=n.icon;return u.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50/50",children:[u.jsxs("label",{className:`block text-sm font-medium text-gray-700 mb-1.5 ${n.type!=="checkbox"?"flex items-center":""}`,children:[r&&u.jsx(r,{size:16,className:"mr-2 text-gray-500"}),n.label]}),n.type==="textarea"?u.jsx("textarea",{name:n.name,rows:n.rows||3,value:e[n.name]||"",onChange:t,className:DI,placeholder:n.placeholder}):n.type==="checkbox"?u.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-2",children:[u.jsx("input",{type:"checkbox",name:n.name,checked:!!e[n.name],onChange:t,className:"h-5 w-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),u.jsx("span",{className:"text-sm text-gray-600 select-none",children:n.description||"Enable/Disable"})]}):u.jsx("input",{type:n.type,name:n.name,value:e[n.name]??"",onChange:t,className:DI,step:"0.01",placeholder:n.placeholder})]},n.name)},$H=({showNotification:n=console.log})=>{const[e,t]=ee.useState({portalAnnouncement:"",isBannerEnabled:!1,latePaymentPenaltyPercentage:2,latePaymentPenaltyDelayDays:15,reconnectionFee:500,fcdaPercentage:1.29,environmentalChargePercentage:25,sewerageChargePercentageCommercial:32.85,governmentTaxPercentage:2,vatPercentage:12,maintenanceMode:!1,isSignupEnabled:!0,isGoogleLoginEnabled:!0,isPasswordlessLoginEnabled:!0,isOnlinePaymentsEnabled:!0,isChatbotEnabled:!0,supportHotline:"1627-AGWA",supportEmail:"support@agos-waterservices.com.ph",autoCloseTicketsDays:14,isRebateProgramEnabled:!1,pointsPerPeso:.01,earlyPaymentBonusPoints:10,earlyPaymentDaysThreshold:7}),[r,i]=ee.useState(!0),[s,o]=ee.useState(!1),[l,d]=ee.useState(""),[f,m]=ee.useState(null),[y,g]=ee.useState(!1),_=ee.useCallback(async()=>{i(!0),d("");const k=await Gb(en);k.success&&k.data?t(F=>({...F,...k.data})):d("Could not load existing settings. Default values are shown. Click 'Save' to create the settings document."),i(!1)},[]);ee.useEffect(()=>{_()},[_]);const E=k=>{const{name:F,value:O,type:C,checked:D}=k.target;t(M=>({...M,[F]:C==="checkbox"?D:C==="number"&&O!==""?parseFloat(O):O}))},x=async k=>{k.preventDefault(),o(!0),d("");const F=await j8(en,e);F.success?n("System settings updated successfully!","success"):(d(F.error||"Failed to save system settings."),n(F.error||"Failed to save system settings.","error")),o(!1)},w=async()=>{if(!f)return;g(!0);let k,F=f;try{switch(F){case"tickets":k=await i8(en);break;case"bills":k=await s8(en);break;case"readings":k=await o8(en);break;case"announcements":k=await a8(en);break;case"interruptions":k=await l8(en);break;case"routes":k=await c8(en);break;case"users":k=await u8(en);break;default:k={success:!1,error:"Unknown data type."}}k.success?n(`Successfully deleted ${k.count} ${F}.`,"success"):n(k.error||`Failed to delete ${F}.`,"error")}catch(O){n(O.message||`An error occurred deleting ${F}.`,"error")}g(!1),m(null)},S=[{name:"portalAnnouncement",label:"Portal-Wide Announcement Banner Text",type:"textarea",icon:hd,rows:3},{name:"isBannerEnabled",label:"Enable Announcement Banner",type:"checkbox",icon:hd},{name:"maintenanceMode",label:"Enable Portal Maintenance Mode",type:"checkbox",icon:Xt,description:"If enabled, only Admins can log in."}],N=[{name:"latePaymentPenaltyPercentage",label:"Late Payment Penalty (%)",type:"number",icon:Ah},{name:"latePaymentPenaltyDelayDays",label:"Late Payment Grace Period (Days)",type:"number",icon:Ss},{name:"reconnectionFee",label:"Reconnection Fee (PHP)",type:"number",icon:Kg},{name:"fcdaPercentage",label:"FCDA (%)",type:"number",icon:Ah},{name:"environmentalChargePercentage",label:"Environmental Charge (%)",type:"number",icon:_S},{name:"sewerageChargePercentageCommercial",label:"Sewerage Charge (Comm. %)",type:"number",icon:Ah},{name:"governmentTaxPercentage",label:"Government Taxes (%)",type:"number",icon:Ah},{name:"vatPercentage",label:"VAT (%)",type:"number",icon:Ah}],P=[{name:"isOnlinePaymentsEnabled",label:"Enable Online Payments",type:"checkbox",icon:mx},{name:"isSignupEnabled",label:"Enable New User Sign-ups",type:"checkbox",icon:Cv},{name:"isGoogleLoginEnabled",label:"Enable Sign-in with Google",type:"checkbox",icon:Cv},{name:"isPasswordlessLoginEnabled",label:"Enable Passwordless (Email Link) Sign-in",type:"checkbox",icon:Cv},{name:"isChatbotEnabled",label:"Enable Chatbot",type:"checkbox",icon:Aa}],I=[{name:"isRebateProgramEnabled",label:"Enable Rebate Program",type:"checkbox",icon:Jb,description:"Enable the customer rewards program."},{name:"pointsPerPeso",label:"Points Awarded per 1.00 Paid",type:"number",icon:od,placeholder:"e.g., 0.01 for 1pt per 100"},{name:"earlyPaymentBonusPoints",label:"Early Payment Bonus (Points)",type:"number",icon:od,placeholder:"e.g., 10"},{name:"earlyPaymentDaysThreshold",label:"Early Payment Threshold (Days)",type:"number",icon:vP,placeholder:"e.g., 7 days before due date"}],R=[{name:"supportHotline",label:"Support Hotline Number",type:"text",icon:b9,placeholder:"e.g., 1627-AGOS"},{name:"supportEmail",label:"Support Email Address",type:"email",icon:t9,placeholder:"e.g., support@agos.com"},{name:"autoCloseTicketsDays",label:"Auto-close Resolved Tickets After (Days)",type:"number",icon:Ss}],U=[{label:"Clear All Support Tickets",action:"tickets",icon:Aa},{label:"Clear All Bills",action:"bills",icon:mx},{label:"Clear All Meter Readings",action:"readings",icon:_S},{label:"Clear All Announcements",action:"announcements",icon:hd},{label:"Clear All Interruptions",action:"interruptions",icon:Xt},{label:"Clear All Meter Routes",action:"routes",icon:Zl}],j={label:"Clear All User Profiles",action:"users",icon:xa};return r?u.jsx(gn,{message:"Loading system settings...",className:"mt-10 h-64"}):u.jsxs("form",{onSubmit:x,className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(Uy,{size:30,className:"mr-3 text-gray-600"})," System Configuration"]}),u.jsxs("button",{type:"submit",className:`${HH} bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500 w-auto mt-4 sm:mt-0`,disabled:s||r,children:[s?u.jsx(St,{size:18,className:"animate-spin mr-2"}):u.jsx(Oa,{size:18,className:"mr-2"}),s?"Saving...":"Save All Settings"]})]}),l&&u.jsxs("div",{className:"mb-4 p-3 bg-yellow-100 border border-yellow-400 text-yellow-800 rounded-lg text-sm flex items-center",children:[u.jsx(Xt,{size:20,className:"mr-2"})," ",l]}),u.jsxs("div",{className:"space-y-8",children:[u.jsxs("section",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"General & Maintenance"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:S.map(k=>u.jsx(zh,{field:k,settings:e,handleChange:E},k.name))})]}),u.jsxs("section",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"Billing & Financial"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:N.map(k=>u.jsx(zh,{field:k,settings:e,handleChange:E},k.name))})]}),u.jsxs("section",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"Portal Features & Authentication"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:P.map(k=>u.jsx(zh,{field:k,settings:e,handleChange:E},k.name))})]}),u.jsxs("section",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"Rewards Program"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:I.map(k=>u.jsx(zh,{field:k,settings:e,handleChange:E},k.name))})]}),u.jsxs("section",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"Communication & Support"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:R.map(k=>u.jsx(zh,{field:k,settings:e,handleChange:E},k.name))})]})]}),u.jsxs("div",{className:"mt-12 pt-6 border-t-2 border-red-300",children:[u.jsxs("h3",{className:"text-xl font-bold text-red-700 flex items-center",children:[u.jsx(Xt,{size:24,className:"mr-2"})," Danger Zone"]}),u.jsx("p",{className:"text-sm text-gray-600 mt-1 mb-4",children:"These actions are destructive and cannot be undone. This will permanently delete transactional data from the database, effectively resetting parts of your system."}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:U.map(k=>{const F=k.icon;return u.jsxs("button",{type:"button",onClick:()=>m(k.action),className:"p-4 border border-red-200 rounded-lg bg-red-50 hover:bg-red-100 hover:border-red-400 transition-colors text-left",children:[u.jsxs("p",{className:"font-semibold text-red-800 flex items-center",children:[u.jsx(F,{size:16,className:"mr-2"}),k.label]}),u.jsxs("p",{className:"text-xs text-red-600 mt-1",children:["Permanently delete all ",k.action," from the database."]})]},k.action)})}),u.jsx("div",{className:"mt-4",children:u.jsxs("button",{type:"button",onClick:()=>m(j.action),className:"p-4 border border-red-300 w-full rounded-lg bg-red-100 hover:bg-red-200 hover:border-red-500 transition-colors text-left",children:[u.jsxs("p",{className:"font-semibold text-red-900 flex items-center",children:[u.jsx(j.icon,{size:16,className:"mr-2"}),j.label]}),u.jsx("p",{className:"text-xs text-red-700 mt-1",children:"Permanently delete all user profiles. This is the most destructive action and will force all users to sign up again."})]},j.action)})]}),f&&u.jsx(Jl,{isOpen:!!f,onClose:()=>m(null),onConfirm:w,title:`Confirm Deletion of All ${f.charAt(0).toUpperCase()+f.slice(1)}`,confirmText:`Yes, delete all ${f}`,isConfirming:y,iconType:"danger",children:u.jsxs("p",{children:["Are you absolutely sure you want to proceed? All ",u.jsx("strong",{children:f})," data will be permanently erased. This action cannot be undone."]})})]})},WH=({initialData:n=null,onSubmit:e,onCancel:t,isSaving:r,showNotification:i})=>{const[s,o]=ee.useState(""),[l,d]=ee.useState(""),[f,m]=ee.useState("info"),[y,g]=ee.useState("active"),[_,E]=ee.useState(""),[x,w]=ee.useState(""),[S,N]=ee.useState(["all"]),[P,I]=ee.useState(""),[R,U]=ee.useState(!1),[j,k]=ee.useState("");ee.useEffect(()=>{var $,G;if(n)o(n.title||""),d(n.content||""),m(n.type||"info"),g(n.status||"active"),E(($=n.startDate)!=null&&$.toDate?n.startDate.toDate().toISOString().split("T")[0]:""),w((G=n.endDate)!=null&&G.toDate?n.endDate.toDate().toISOString().split("T")[0]:""),N(n.targetRoles||["all"]);else{const re=new Date().toISOString().split("T")[0];E(re),g("active"),o(""),d(""),m("info"),w(""),N(["all"]),I("")}},[n]);const F=$=>{d($),j&&$.replace(/<[^>]*>?/gm,"").trim()&&k("")},O=async()=>{const $=l.replace(/<[^>]*>?/gm,"").trim();if(P.trim()){U(!0);try{const G=await B9({title:s||P,reason:P,area:"",time:""});d(G),!s.trim()&&P.trim()&&o(P.trim()),i("AI generated a new draft!","success")}catch(G){const re=(G==null?void 0:G.message)||"AI generation failed.";i(re,"error")}finally{U(!1)}}else if($){U(!0);try{const re=[{role:"user",content:`Refine this announcement draft for AGWA Water Services. Make it clear, professional, concise, using simple HTML (<p>, <strong>, <ul>, <li>). Announcement Type: ${f}. Title: "${s}". Original Content (may contain HTML): "${l}". Respond only with the refined HTML content.`}],oe=await Ql(re);d(oe),i("AI has refined your content!","success")}catch(G){const re=(G==null?void 0:G.message)||"AI assistance failed.";i(re,"error")}finally{U(!1)}}else i("Please provide a prompt or write some content for the AI to assist with.","warning")},C=$=>{$.preventDefault(),k("");const G=l.replace(/<[^>]*>?/gm,"").trim();if(!s.trim()||!G||!_){k("Title, Content, and Start Date are required.");return}if(x&&new Date(x)<new Date(_)){k("End date cannot be before start date.");return}const re=Mo.sanitize(l),oe={title:s.trim(),content:re,type:f,status:y,startDate:new Date(_),endDate:x?new Date(x):null,targetRoles:S.length===0||S.includes("all")?["all"]:S};e(oe)},D="w-full px-4 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 focus:outline-none transition duration-200 text-gray-900",M="flex items-center justify-center px-4 py-2.5 rounded-lg font-semibold transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95";return u.jsx("div",{className:"p-1",children:u.jsxs("form",{onSubmit:C,className:"space-y-6",id:"announcementForm",children:[j&&u.jsxs("div",{className:"p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg text-sm flex items-center",children:[u.jsx(r9,{size:20,className:"mr-2"})," ",j]}),u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"announcementTitle",className:"block text-sm font-medium text-gray-700 mb-1",children:[u.jsx(TP,{size:16,className:"inline mr-1.5"}),"Title *"]}),u.jsx("input",{type:"text",id:"announcementTitle",value:s,onChange:$=>o($.target.value),className:D,placeholder:"E.g., Scheduled Maintenance in Poblacion",required:!0})]}),u.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg space-y-3",children:[u.jsxs("label",{htmlFor:"aiPrompt",className:"block text-sm font-medium text-blue-800",children:[u.jsx(Rs,{size:16,className:"inline mr-1.5"}),"AI Assistant"]}),u.jsx("input",{type:"text",id:"aiPrompt",value:P,onChange:$=>I($.target.value),className:D,placeholder:"Type a prompt to generate new content (e.g., 'Emergency repair in Muzon')"}),u.jsxs("button",{type:"button",onClick:O,className:`${M} text-sm bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-300 py-2 px-4`,disabled:R||r,children:[R?u.jsx(St,{size:16,className:"animate-spin mr-1.5"}):u.jsx(Rs,{size:16,className:"mr-1.5"}),P.trim()?"Generate Content":"Refine Existing Content"]}),u.jsx("p",{className:"text-xs text-gray-500",children:"If the prompt is filled, AI will generate new content. If the prompt is empty and the editor has content, AI will refine it."})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Content *"}),u.jsx(t0,{value:l,onChange:F,placeholder:"Describe the announcement, or use the AI Assistant above to generate content.",className:"bg-white rounded-lg border border-gray-300 min-h-[250px]"}),j&&!l.replace(/<[^>]*>?/gm,"").trim()&&u.jsx("p",{className:"text-red-500 text-xs mt-1",children:"Content is required."})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"announcementType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),u.jsxs("select",{id:"announcementType",value:f,onChange:$=>m($.target.value),className:D,children:[u.jsx("option",{value:"info",children:"Info"}),u.jsx("option",{value:"warning",children:"Warning"}),u.jsx("option",{value:"critical",children:"Critical"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),u.jsxs("button",{type:"button",onClick:()=>g(y==="active"?"archived":"active"),className:`${M} w-full ${y==="active"?"bg-green-500 hover:bg-green-600 text-white focus:ring-green-400":"bg-gray-200 hover:bg-gray-300 text-gray-700 focus:ring-gray-300"}`,children:[y==="active"?u.jsx(T9,{size:18,className:"mr-2"}):u.jsx(S9,{size:18,className:"mr-2"}),y==="active"?"Active":"Archived"]})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700 mb-1",children:[u.jsx(au,{size:16,className:"inline mr-1.5"}),"Start Date *"]}),u.jsx("input",{type:"date",id:"startDate",value:_,onChange:$=>E($.target.value),className:D,required:!0})]}),u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700 mb-1",children:[u.jsx(au,{size:16,className:"inline mr-1.5"}),"End Date (Optional)"]}),u.jsx("input",{type:"date",id:"endDate",value:x,onChange:$=>w($.target.value),className:D,min:_})]})]}),u.jsxs("div",{className:"pt-6 border-t mt-6 flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-4",children:[u.jsx("button",{type:"button",onClick:t,className:`${M} bg-gray-100 hover:bg-gray-200 text-gray-700 border border-gray-300 focus:ring-gray-300 w-full sm:w-auto order-2 sm:order-1`,disabled:r||R,children:"Cancel"}),u.jsxs("button",{type:"submit",form:"announcementForm",className:`${M} bg-green-600 hover:bg-green-700 text-white focus:ring-green-500 w-full sm:w-auto order-1 sm:order-2`,disabled:r||R||!s.trim()||!l.replace(/<[^>]*>?/gm,"").trim(),children:[r?u.jsx(St,{size:20,className:"animate-spin mr-2"}):u.jsx(Oa,{size:20,className:"mr-2"}),r?"Saving...":n?"Update Announcement":"Create Announcement"]})]})]})})},GH=({announcements:n,onEdit:e,onDelete:t,onToggleStatus:r,actionLoadingId:i,viewOnly:s=!1})=>{const o=l=>{if(!l)return"N/A";let d;try{if(l.toDate&&typeof l.toDate=="function")d=l.toDate();else if(l instanceof Date)d=l;else if(typeof l=="string"||typeof l=="number")d=new Date(l);else return"Invalid Date";return isNaN(d.getTime())?"Invalid Date":d.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Invalid Date"}};return!n||n.length===0?u.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner border border-gray-200",children:[u.jsx(An,{size:48,className:"mx-auto text-gray-400 mb-4"}),u.jsx("p",{className:"text-gray-600 text-lg",children:"No announcements found."}),!s&&u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Create one using the 'New Announcement' button."})]}):u.jsx("div",{className:"space-y-4",children:n.map(l=>{var f,m;const d=Mo.sanitize(l.content||"");return u.jsxs("div",{className:`p-4 rounded-lg shadow-md border-l-4 transition-opacity ${l.status==="active"?"border-green-500 bg-white hover:shadow-lg":"border-gray-400 bg-gray-50 opacity-80 hover:opacity-100 hover:shadow-md"}`,children:[u.jsxs("div",{className:"flex justify-between items-start gap-3",children:[u.jsxs("div",{className:"flex-grow pr-4",children:[u.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:l.title}),u.jsxs("div",{className:"flex items-center flex-wrap gap-2 text-xs mt-1",children:[u.jsx("span",{className:`px-2 py-0.5 font-semibold uppercase tracking-wider rounded-full ${l.status==="active"?"bg-green-100 text-green-800":"bg-gray-200 text-gray-600"}`,children:l.status}),u.jsx("span",{className:`px-2 py-0.5 font-semibold uppercase tracking-wider rounded-full ${l.type==="critical"?"bg-red-100 text-red-800":l.type==="warning"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:l.type}),u.jsxs("span",{className:"text-gray-400 font-mono flex items-center",children:[u.jsx(Cs,{size:12,className:"mr-0.5"}),l.id.substring(0,8),"..."]})]})]}),!s&&u.jsx("div",{className:"flex space-x-2 items-center flex-shrink-0",children:i===l.id?u.jsx(St,{className:"animate-spin text-gray-500"}):u.jsxs(u.Fragment,{children:[r&&u.jsx("button",{onClick:()=>r(l),className:`p-1.5 rounded-md hover:bg-opacity-20 transition-colors ${l.status==="active"?"text-yellow-600 hover:bg-yellow-100":"text-green-600 hover:bg-green-100"}`,title:l.status==="active"?"Archive":"Activate",children:l.status==="active"?u.jsx(Gg,{size:18}):u.jsx(Gl,{size:18})}),e&&u.jsx("button",{onClick:()=>e(l),className:"text-blue-600 hover:text-blue-800 p-1.5 rounded-md hover:bg-blue-100 transition-colors",title:"Edit",children:u.jsx(x9,{size:18})}),t&&u.jsx("button",{onClick:()=>t(l.id),className:"text-red-600 hover:text-red-800 p-1.5 rounded-md hover:bg-red-100 transition-colors",title:"Delete",children:u.jsx(qd,{size:18})})]})})]}),u.jsx("div",{className:"prose prose-sm max-w-none text-gray-700 mt-3 pt-3 border-t border-gray-200/80 leading-relaxed",dangerouslySetInnerHTML:{__html:d}}),u.jsxs("div",{className:"text-xs text-gray-500 mt-3 pt-2 border-t border-gray-200/80",children:[u.jsxs("p",{children:["Author: ",l.authorName||"Admin"]}),u.jsxs("p",{children:["Created: ",o(l.createdAt)]}),l.updatedAt&&((f=l.updatedAt)==null?void 0:f.seconds)!==((m=l.createdAt)==null?void 0:m.seconds)&&u.jsxs("p",{children:["Updated: ",o(l.updatedAt)]}),u.jsxs("p",{children:["Display: ",o(l.startDate)," to ",l.endDate?o(l.endDate):"Ongoing"]})]})]},l.id)})})},LI=({db:n,userData:e,showNotification:t,viewOnly:r=!1})=>{const[i,s]=ee.useState([]),[o,l]=ee.useState(!0),[d,f]=ee.useState(!1),[m,y]=ee.useState(null),[g,_]=ee.useState(!1),[E,x]=ee.useState(null),[w,S]=ee.useState(!1),[N,P]=ee.useState(null),I=ee.useCallback(async()=>{l(!0);try{const C=await P8(n,r);if(C.success)s(C.data||[]);else throw new Error(C.error)}catch{t("Failed to load announcements.","error")}finally{l(!1)}},[n,t,r]);ee.useEffect(()=>{I()},[I]);const R=()=>{y(null),f(!0)},U=C=>{y(C),f(!0)},j=async C=>{_(!0);const M=await(m?vS(n,m.id,{...C,updatedBy:e.uid}):C8(n,{...C,createdBy:e.uid,authorName:e.displayName}));M.success?(t(`Announcement ${m?"updated":"created"} successfully!`,"success"),I(),f(!1)):t(`Failed to save announcement: ${M.error}`,"error"),_(!1)},k=C=>{P(C),S(!0)},F=async()=>{if(!N)return;x(N);const C=await R8(n,N);C.success?(t("Announcement deleted successfully!","success"),I()):t(`Failed to delete announcement: ${C.error}`,"error"),S(!1),P(null),x(null)},O=async C=>{x(C.id);const D=C.status==="active"?"archived":"active",M=await vS(n,C.id,{status:D,updatedBy:e.uid});M.success?(t(`Announcement status changed to ${D}.`,"success"),I()):t("Failed to update status: "+M.error,"error"),x(null)};return u.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-xl",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[u.jsx("h3",{className:"text-2xl font-semibold",children:r?"Company Announcements":"Manage Announcements"}),!r&&u.jsxs("button",{onClick:R,className:"bg-blue-600 text-white font-medium py-2 px-4 rounded-lg flex items-center",children:[u.jsx(Vy,{size:18,className:"mr-2"})," New Announcement"]})]}),o?u.jsx(gn,{message:"Loading Announcements..."}):u.jsx(GH,{announcements:i,onEdit:r?void 0:U,onDelete:r?void 0:k,onToggleStatus:r?void 0:O,actionLoadingId:E,viewOnly:r}),!r&&d&&u.jsx(Or,{isOpen:d,onClose:()=>f(!1),title:m?"Edit Announcement":"Create Announcement",size:"full",children:u.jsx(WH,{initialData:m,onSubmit:j,onCancel:()=>f(!1),isSaving:g,showNotification:t})}),!r&&w&&u.jsx(Jl,{isOpen:w,onClose:()=>S(!1),onConfirm:F,title:"Confirm Deletion",isConfirming:!!E,children:"Are you sure you want to delete this announcement? This action cannot be undone."})]})},KH=({initialData:n=null,onSubmit:e,onCancel:t,isSaving:r,showNotification:i})=>{const[s,o]=ee.useState(""),[l,d]=ee.useState(""),[f,m]=ee.useState("Maintenance"),[y,g]=ee.useState("Scheduled"),[_,E]=ee.useState(""),[x,w]=ee.useState("08:00"),[S,N]=ee.useState(""),[P,I]=ee.useState("17:00"),[R,U]=ee.useState([]),[j,k]=ee.useState(!1),[F,O]=ee.useState(""),[C,D]=ee.useState({}),[M,$]=ee.useState([]);ee.useEffect(()=>{const se=Ky(),ae=[],Q=se.reduce((ce,me)=>{const ge=Pd(me).sort();return ce[me]=ge,ae.push(...ge),ce},{});D(Q),$(ae.sort())},[]),ee.useEffect(()=>{var se,ae;if(n){o(n.title||""),d(n.description||""),m(n.type||"Maintenance"),g(n.status||"Scheduled"),U(n.affectedAreas||[]),k(n.isBillingPaused||!1);const Q=(se=n.startDate)!=null&&se.toDate?n.startDate.toDate():null,ce=(ae=n.estimatedEndDate)!=null&&ae.toDate?n.estimatedEndDate.toDate():null;E(Q?Q.toISOString().split("T")[0]:""),w(Q?`${String(Q.getHours()).padStart(2,"0")}:${String(Q.getMinutes()).padStart(2,"0")}`:"08:00"),N(ce?ce.toISOString().split("T")[0]:""),I(ce?`${String(ce.getHours()).padStart(2,"0")}:${String(ce.getMinutes()).padStart(2,"0")}`:"17:00")}else{const ce=new Date().toISOString().split("T")[0];o(""),d(""),m("Maintenance"),g("Scheduled"),E(ce),w("08:00"),N(ce),I("17:00"),U([]),k(!1)}},[n]);const G=se=>{d(se),F&&se.replace(/<[^>]*>?/gm,"").trim()&&O("")},re=se=>{U(ae=>ae.includes(se)?ae.filter(Q=>Q!==se):[...ae,se]),F&&R.length>0&&O("")},oe=()=>{R.length===M.length?U([]):(U([...M]),F&&O(""))},ie=(se,ae)=>{const Q=ae.every(ce=>R.includes(ce));U(Q?ce=>ce.filter(me=>!ae.includes(me)):ce=>[...new Set([...ce,...ae])])},X=se=>{se.preventDefault(),O("");const ae=l.replace(/<[^>]*>?/gm,"").trim();if(!s.trim()||!ae||!_||!x||R.length===0){O("Title, Description, Affected Area(s), Start Date/Time are required.");return}const Q=new Date(`${_}T${x}`);if(isNaN(Q)){O("Invalid Start Date or Time.");return}let ce=null;if(S&&P){if(ce=new Date(`${S}T${P}`),isNaN(ce)){O("Invalid Estimated End Date or Time.");return}if(ce<=Q){O("Estimated End must be after Start.");return}}const me=Mo.sanitize(l),ge={title:s.trim(),description:me,type:f,status:y,startDate:Q,estimatedEndDate:ce,affectedAreas:R.sort(),isBillingPaused:j};e(ge)},Y="w-full px-4 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm text-gray-900",B="flex items-center justify-center px-4 py-2.5 rounded-lg font-semibold transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95 text-sm",Z=["Maintenance","Emergency Repair","System Upgrade","Leak Detection","Other"],te=["Scheduled","Ongoing","Resolved"];return u.jsxs("form",{onSubmit:X,className:"space-y-6 p-1",children:[F&&u.jsxs("div",{className:"p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg text-sm flex items-center",children:[u.jsx(Xt,{size:20,className:"mr-2"})," ",F]}),u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"interruptionTitle",className:"block text-sm font-medium text-gray-700 mb-1",children:[u.jsx(TP,{size:16,className:"inline mr-1.5"}),"Title *"]}),u.jsx("input",{type:"text",id:"interruptionTitle",value:s,onChange:se=>o(se.target.value),className:Y,placeholder:"E.g., Water Interruption in Brgy. Muzon",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),u.jsx(t0,{value:l,onChange:G,placeholder:"Provide details...",className:"bg-white rounded-lg border border-gray-300 min-h-[150px]"}),F&&!l.replace(/<[^>]*>?/gm,"").trim()&&u.jsx("p",{className:"text-red-500 text-xs mt-1",children:"Description is required."})]}),u.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50 max-h-72 overflow-y-auto scrollbar-thin",children:[u.jsxs("div",{className:"flex justify-between items-center mb-2 sticky top-0 bg-gray-50 py-1 -mt-1 border-b border-gray-200",children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[u.jsx(Oo,{size:16,className:"inline mr-1.5"}),"Affected Area(s) *"]}),u.jsx("button",{type:"button",onClick:oe,className:"text-xs font-medium text-blue-600 hover:underline",children:R.length===M.length?"Deselect All":`Select All (${M.length})`})]}),u.jsx("div",{className:"space-y-2",children:Object.entries(C).map(([se,ae])=>u.jsxs("details",{className:"group bg-white border rounded-md",children:[u.jsxs("summary",{className:"flex justify-between items-center p-2 cursor-pointer list-none",children:[u.jsx("span",{className:"font-semibold text-sm text-blue-700",children:se}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("button",{type:"button",onClick:Q=>{Q.preventDefault(),ie(se,ae)},className:"text-xs text-blue-600 hover:underline mr-2",children:"Toggle District"}),u.jsx(Yb,{size:18,className:"text-gray-500 group-open:rotate-180 transition-transform"})]})]}),u.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 p-3 border-t border-gray-100",children:ae.map(Q=>u.jsxs("label",{className:"flex items-center space-x-2 p-1.5 rounded bg-gray-50 border border-gray-200 hover:bg-blue-50 cursor-pointer text-xs has-[:checked]:bg-blue-100 has-[:checked]:border-blue-300",children:[u.jsx("input",{type:"checkbox",checked:R.includes(Q),onChange:()=>re(Q),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 shrink-0"}),u.jsx("span",{className:"truncate",title:Q,children:Q})]},Q))})]},se))}),F&&R.length===0&&u.jsx("p",{className:"text-red-500 text-xs mt-2",children:"Select at least one area."})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"interruptionType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Type *"}),u.jsx("select",{id:"interruptionType",value:f,onChange:se=>m(se.target.value),className:Y,required:!0,children:Z.map(se=>u.jsx("option",{value:se,children:se},se))})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"interruptionStatus",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status *"}),u.jsx("select",{id:"interruptionStatus",value:y,onChange:se=>g(se.target.value),className:Y,required:!0,children:te.map(se=>u.jsx("option",{value:se,children:se},se))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),u.jsxs("label",{className:"flex items-center space-x-2 p-2.5 rounded-lg bg-yellow-50 border border-yellow-200 cursor-pointer hover:bg-yellow-100",children:[u.jsx("input",{type:"checkbox",checked:j,onChange:se=>k(se.target.checked),className:"h-4 w-4 text-yellow-600 border-gray-300 rounded focus:ring-yellow-500"}),u.jsxs("span",{className:"text-sm font-medium text-yellow-800 flex items-center",children:[u.jsx(i9,{size:16,className:"mr-1.5"})," Pause Billing"]})]})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[u.jsx(au,{size:16,className:"inline mr-1.5"}),"Start Date & Time *"]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"date",id:"startDate",value:_,onChange:se=>E(se.target.value),className:Y,required:!0}),u.jsx("input",{type:"time",id:"startTime",value:x,onChange:se=>w(se.target.value),className:Y,required:!0})]})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[u.jsx(Ss,{size:16,className:"inline mr-1.5"}),"Estimated End Date & Time"]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"date",id:"estimatedEndDate",value:S,onChange:se=>N(se.target.value),className:Y,min:_}),u.jsx("input",{type:"time",id:"estimatedEndTime",value:P,onChange:se=>I(se.target.value),className:Y})]}),F.includes("End Date/Time")&&u.jsx("p",{className:"text-red-500 text-xs mt-1",children:F})]})]}),u.jsxs("div",{className:"pt-6 border-t mt-6 flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-4",children:[u.jsx("button",{type:"button",onClick:t,className:`${B} bg-gray-100 hover:bg-gray-200 text-gray-700 border border-gray-300 focus:ring-gray-300 w-full sm:w-auto order-2 sm:order-1`,disabled:r,children:"Cancel"}),u.jsxs("button",{type:"submit",className:`${B} bg-green-600 hover:bg-green-700 text-white focus:ring-green-500 w-full sm:w-auto order-1 sm:order-2`,disabled:r,children:[r?u.jsx(St,{size:20,className:"animate-spin mr-2"}):u.jsx(Oa,{size:20,className:"mr-2"}),r?"Saving...":n?"Update Advisory":"Create Advisory"]})]}),u.jsx("style",{children:`
                .scrollbar-thin { scrollbar-width: thin; scrollbar-color: #9ca3af #f3f4f6; }
                .scrollbar-thin::-webkit-scrollbar { width: 6px; height: 6px;}
                .scrollbar-thin::-webkit-scrollbar-track { background: #f3f4f6; border-radius:3px; }
                .scrollbar-thin::-webkit-scrollbar-thumb { background-color: #9ca3af; border-radius: 3px; border: 1px solid #f3f4f6;}
                .scrollbar-thin::-webkit-scrollbar-thumb:hover { background-color: #6b7280; }
             `})]})},YH=({db:n,userData:e,showNotification:t})=>{const[r,i]=ee.useState([]),[s,o]=ee.useState(!0),[l,d]=ee.useState(!1),[f,m]=ee.useState(null),[y,g]=ee.useState(!1),[_,E]=ee.useState(null),[x,w]=ee.useState(!1),[S,N]=ee.useState(null),P=ee.useCallback(async()=>{o(!0);try{const O=await $8(n);if(O.success)i(O.data||[]);else throw new Error(O.error)}catch(O){t(O.message||"Failed to load interruptions.","error")}finally{o(!1)}},[n,t]);ee.useEffect(()=>{P()},[P]);const I=()=>{m(null),d(!0)},R=O=>{m(O),d(!0)},U=async O=>{g(!0);const D=await(f?q8(n,f.id,O):U8(n,O));D.success?(t(`Advisory ${f?"updated":"created"} successfully!`,"success"),P(),d(!1)):t(D.error||"Failed to save advisory.","error"),g(!1)},j=O=>{N(O),w(!0)},k=async()=>{if(!S)return;E(S.id);const O=await H8(n,S.id);O.success?(t("Advisory deleted successfully!","success"),P()):t(O.error||"Failed to delete advisory.","error"),w(!1),N(null),E(null)},F=(O,C)=>{if((C==="Emergency Repair"||C==="Leak Detection")&&O!=="Resolved")return{icon:NP,color:"text-red-700",bgColor:"bg-red-100",label:"Emergency"};switch(O){case"Ongoing":return{icon:Xt,color:"text-orange-600",bgColor:"bg-orange-100",label:"Ongoing"};case"Scheduled":return{icon:Ss,color:"text-blue-600",bgColor:"bg-blue-100",label:"Scheduled"};case"Resolved":return{icon:Is,color:"text-green-600",bgColor:"bg-green-100",label:"Resolved"};default:return{icon:An,color:"text-gray-500",bgColor:"bg-gray-100",label:O||"Unknown"}}};return u.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-xl",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[u.jsxs("h3",{className:"text-2xl font-semibold flex items-center",children:[u.jsx(Xt,{className:"mr-3 text-orange-500"})," Manage Service Advisories"]}),u.jsxs("button",{onClick:I,className:"bg-blue-600 text-white font-medium py-2 px-4 rounded-lg flex items-center text-sm",children:[u.jsx(Vy,{size:16,className:"mr-2"})," New Advisory"]})]}),s?u.jsx(gn,{message:"Loading Advisories..."}):u.jsxs("div",{className:"space-y-3",children:[r.length===0&&u.jsxs("div",{className:"text-center py-10 bg-gray-50 rounded-lg",children:[u.jsx(An,{size:32,className:"mx-auto text-gray-400 mb-2"}),u.jsx("p",{className:"text-gray-500",children:"No advisories found."})]}),r.map(O=>{var M,$,G;const C=F(O.status,O.type),D=C.icon;return u.jsxs("div",{className:`p-4 rounded-lg shadow border-l-4 flex justify-between items-start gap-4 ${C.bgColor.replace("bg-","border-")}`,children:[u.jsxs("div",{className:"flex-grow",children:[u.jsx("h4",{className:"font-semibold text-gray-800",children:O.title}),u.jsxs("div",{className:"text-xs text-gray-600 mt-1 space-y-0.5",children:[u.jsxs("p",{className:"flex items-center",children:[u.jsx(Oo,{size:12,className:"mr-1.5"})," Areas: ",(M=O.affectedAreas)==null?void 0:M.slice(0,3).join(", "),(($=O.affectedAreas)==null?void 0:$.length)>3?"...":""," (",((G=O.affectedAreas)==null?void 0:G.length)||0,")"]}),u.jsxs("p",{className:"flex items-center",children:[u.jsx(Ss,{size:12,className:"mr-1.5"})," Start: ",Zt(O.startDate)]}),O.estimatedEndDate&&u.jsxs("p",{className:"flex items-center",children:[u.jsx(Ss,{size:12,className:"mr-1.5"})," End: ",Zt(O.estimatedEndDate)]}),u.jsxs("p",{className:"text-gray-400",children:["ID: ",O.id.substring(0,8),"..."]})]})]}),u.jsxs("div",{className:"flex flex-col items-end gap-2 shrink-0",children:[u.jsxs("span",{className:`px-2 py-0.5 text-xs font-semibold rounded-full flex items-center ${C.bgColor} ${C.color}`,children:[u.jsx(D,{size:12,className:"mr-1"})," ",C.label]}),u.jsxs("div",{className:"flex space-x-1",children:[u.jsx("button",{onClick:()=>R(O),className:"p-1.5 text-blue-600 hover:bg-blue-100 rounded-md disabled:opacity-50",disabled:_===O.id,children:u.jsx(Bf,{size:16})}),u.jsx("button",{onClick:()=>j(O),className:"p-1.5 text-red-600 hover:bg-red-100 rounded-md disabled:opacity-50",disabled:_===O.id,children:_===O.id?u.jsx(St,{className:"animate-spin",size:16}):u.jsx(qd,{size:16})})]})]})]},O.id)})]}),l&&u.jsx(Or,{isOpen:l,onClose:()=>d(!1),title:f?"Edit Advisory":"Create New Advisory",size:"2xl",children:u.jsx(KH,{initialData:f,onSubmit:U,onCancel:()=>d(!1),isSaving:y,showNotification:t})}),x&&S&&u.jsxs(Jl,{isOpen:x,onClose:()=>w(!1),onConfirm:k,title:"Confirm Deletion",isConfirming:!!_,confirmText:"Yes, Delete",iconType:"danger",children:['Delete advisory "',S.title,'"? This cannot be undone.']})]})};xm.register(ny,ry,xf,ef,pg,Jh,k3,P3,N3);const kt={blue:"rgba(59, 130, 246, 0.6)",blueBorder:"rgba(59, 130, 246, 1)",green:"rgba(16, 185, 129, 0.6)",greenBorder:"rgba(16, 185, 129, 1)",purple:"rgba(139, 92, 246, 0.6)",purpleBorder:"rgba(139, 92, 246, 1)",red:"rgba(239, 68, 68, 0.6)",redBorder:"rgba(239, 68, 68, 1)",orange:"rgba(249, 115, 22, 0.6)",orangeBorder:"rgba(249, 115, 22, 1)",teal:"rgba(20, 184, 166, 0.6)",tealBorder:"rgba(20, 184, 166, 1)",sky:"rgba(14, 165, 233, 0.6)",skyBorder:"rgba(14, 165, 233, 1)",pink:"rgba(236, 72, 153, 0.6)",yellow:"rgba(234, 179, 8, 0.6)"},G3=n=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"bottom"},title:{display:!0,text:n,font:{size:16},color:"#374151",padding:{bottom:15}},tooltip:{backgroundColor:"#1F2937",titleColor:"#E5E7EB",bodyColor:"#D1D5DB",borderColor:"#4B5563",borderWidth:1,padding:10,boxPadding:3}},scales:{y:{beginAtZero:!0,grid:{color:"#E5E7EB"},ticks:{color:"#6B7280"}},x:{grid:{display:!1},ticks:{color:"#6B7280"}}}}),Hp=({data:n,title:e,label:t,color:r,borderColor:i})=>{if(!n||Object.keys(n).length===0)return u.jsxs("p",{className:"text-sm text-gray-500 text-center py-10",children:["No data available for ",e,"."]});const s={labels:Object.keys(n),datasets:[{label:t,data:Object.values(n),backgroundColor:r,borderColor:i,borderWidth:1,borderRadius:4}]};return u.jsx("div",{className:"h-72 w-full",children:u.jsx(M3,{options:G3(e),data:s})})},FI=({data:n,title:e,datasets:t})=>{if(!n||Array.isArray(n)&&n.length===0||typeof n=="object"&&Object.keys(n).length===0)return u.jsxs("p",{className:"text-sm text-gray-500 text-center py-10",children:["No data available for ",e,"."]});let r;return t?r={labels:Object.keys(n),datasets:t.map(i=>({...i,data:Object.values(n).map(s=>s[i.key]||s||0)}))}:r={labels:Array.from({length:24},(s,o)=>`${o}:00`),datasets:[{label:"Tickets",data:n.map(s=>s.tickets),borderColor:kt.blueBorder,backgroundColor:kt.blue,tension:.1},{label:"Readings",data:n.map(s=>s.readings),borderColor:kt.greenBorder,backgroundColor:kt.green,tension:.1},{label:"Payments",data:n.map(s=>s.payments),borderColor:kt.purpleBorder,backgroundColor:kt.purple,tension:.1}]},u.jsx("div",{className:"h-72 w-full",children:u.jsx(GU,{options:G3(e),data:r})})},$p=({data:n,title:e})=>{if(!n||Object.keys(n).length===0)return u.jsxs("p",{className:"text-sm text-gray-500 text-center py-10",children:["No data for ",e,"."]});const t={labels:Object.keys(n),datasets:[{data:Object.values(n),backgroundColor:[kt.blue,kt.green,kt.purple,kt.orange,kt.red,kt.teal,kt.sky,kt.pink,kt.yellow],borderColor:"#FFFFFF",borderWidth:2}]},r={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"bottom",labels:{boxWidth:12,padding:15}},title:{display:!0,text:e,font:{size:16},color:"#374151",padding:{bottom:15}},tooltip:{backgroundColor:"#1F2937",titleColor:"#E5E7EB",bodyColor:"#D1D5DB",borderColor:"#4B5563",borderWidth:1,padding:10,boxPadding:3}}};return u.jsx("div",{className:"h-72 w-full",children:u.jsx(KU,{options:r,data:t})})},ZH=({data:n,title:e})=>{if(!n||Object.keys(n).length===0)return u.jsxs("p",{className:"text-sm text-gray-500 text-center py-10",children:["No data for ",e,"."]});const t={labels:Object.keys(n),datasets:[{data:Object.values(n),backgroundColor:[kt.teal,kt.orange,kt.pink,kt.yellow,kt.sky,kt.blue,kt.green,kt.purple,kt.red],borderColor:"#FFFFFF",borderWidth:2}]},r={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"bottom",labels:{boxWidth:12,padding:15}},title:{display:!0,text:e,font:{size:16},color:"#374151",padding:{bottom:15}},tooltip:{backgroundColor:"#1F2937",titleColor:"#E5E7EB",bodyColor:"#D1D5DB",borderColor:"#4B5563",borderWidth:1,padding:10,boxPadding:3}}};return u.jsx("div",{className:"h-72 w-full",children:u.jsx(YU,{options:r,data:t})})},Eo=({title:n,value:e,icon:t,color:r})=>u.jsx("div",{className:"bg-gray-50 p-4 rounded-lg shadow border-l-4",style:{borderColor:r},children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"p-2 rounded-full mr-3",style:{backgroundColor:`${r}20`},children:u.jsx(t,{size:20,style:{color:r}})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase",children:n}),u.jsx("p",{className:"text-xl font-bold text-gray-800",children:e})]})]})}),QH=({showNotification:n=console.log})=>{var y,g,_,E,x,w;const[e,t]=ee.useState(null),[r,i]=ee.useState(!0),[s,o]=ee.useState(""),l=ee.useCallback(async()=>{var S,N,P,I,R,U,j,k,F,O,C,D,M,$,G,re,oe,ie,X,Y,B,Z;i(!0),o("");try{const te=await Promise.allSettled([fP(en),mP(en),v8(en),W8(en),G8(en),K8(en),_8(en),x8(en),Y8(en),Z8(en),Q8(en)]),[se,ae,Q,ce,me,ge,Ae,Ve,Ye,Ge,ot]=te;let nt="";const It={};se.status==="fulfilled"&&se.value.success?(It.usersByRole=se.value.data.byRole,It.totalUsers=se.value.data.total):nt+=`User stats failed. ${((S=se.reason)==null?void 0:S.message)||((N=se.value)==null?void 0:N.error)||""} | `,ae.status==="fulfilled"&&ae.value.success?(It.ticketStats=ae.value.data.byStatus,It.ticketsByType=ae.value.data.byType,It.totalTickets=ae.value.data.total,It.openTickets=ae.value.data.openCount):nt+=`Ticket stats failed. ${((P=ae.reason)==null?void 0:P.message)||((I=ae.value)==null?void 0:I.error)||""} | `,Q.status==="fulfilled"&&Q.value.success?It.monthlyRevenue=Q.value.data:nt+=`Monthly revenue failed. ${((R=Q.reason)==null?void 0:R.message)||((U=Q.value)==null?void 0:U.error)||""} | `,ce.status==="fulfilled"&&ce.value.success?It.hourlyActivity=ce.value.data:nt+=`Hourly activity failed. ${((j=ce.reason)==null?void 0:j.message)||((k=ce.value)==null?void 0:k.error)||""} | `,me.status==="fulfilled"&&me.value.success?It.staffActivity=me.value.data:nt+=`Staff activity failed. ${((F=me.reason)==null?void 0:F.message)||((O=me.value)==null?void 0:O.error)||""} | `,ge.status==="fulfilled"&&ge.value.success?It.techStats=ge.value.data:nt+=`Technical stats failed. ${((C=ge.reason)==null?void 0:C.message)||((D=ge.value)==null?void 0:D.error)||""} | `,Ae.status==="fulfilled"&&Ae.value.success?It.revenueByLocation=Ae.value.data:nt+=`Location revenue failed. ${((M=Ae.reason)==null?void 0:M.message)||(($=Ae.value)==null?void 0:$.error)||""} | `,Ve.status==="fulfilled"&&Ve.value.success?It.outstandingBalance=Ve.value.data.totalOutstanding:nt+=`Outstanding balance failed. ${((G=Ve.reason)==null?void 0:G.message)||((re=Ve.value)==null?void 0:re.error)||""} | `,Ye.status==="fulfilled"&&Ye.value.success?It.monthlyConsumption=Ye.value.data:nt+=`Consumption stats failed. ${((oe=Ye.reason)==null?void 0:oe.message)||((ie=Ye.value)==null?void 0:ie.error)||""} | `,Ge.status==="fulfilled"&&Ge.value.success?It.paymentMethods=Ge.value.data:nt+=`Payment methods failed. ${((X=Ge.reason)==null?void 0:X.message)||((Y=Ge.value)==null?void 0:Y.error)||""} | `,ot.status==="fulfilled"&&ot.value.success?It.userGrowth=ot.value.data:nt+=`User growth failed. ${((B=ot.reason)==null?void 0:B.message)||((Z=ot.value)==null?void 0:Z.error)||""} | `,nt&&o(nt.trim().slice(0,-1)),t(It)}catch(te){o("Critical error fetching statistics."),console.error("fetchStatistics error:",te)}finally{i(!1)}},[n]);ee.useEffect(()=>{l()},[l]);const d=()=>{window.print()},f=ee.useMemo(()=>e!=null&&e.monthlyRevenue?Object.values(e.monthlyRevenue).reduce((S,N)=>S+N,0):0,[e==null?void 0:e.monthlyRevenue]),m=ee.useMemo(()=>e!=null&&e.monthlyConsumption?Object.values(e.monthlyConsumption).reduce((S,N)=>S+N,0):0,[e==null?void 0:e.monthlyConsumption]);return r?u.jsx(gn,{message:"Loading system analytics...",className:"mt-10 h-64"}):u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-200 no-print",children:[u.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center",children:[u.jsx(Kb,{size:30,className:"mr-3 text-orange-600"})," System Analytics"]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("button",{onClick:l,disabled:r,className:"flex items-center text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-3 rounded-lg border border-gray-300",children:[r?u.jsx(St,{size:16,className:"animate-spin mr-2"}):u.jsx(ja,{size:16,className:"mr-2"}),"Refresh"]}),u.jsxs("button",{onClick:d,className:"flex items-center text-sm bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-3 rounded-lg",children:[u.jsx(r2,{size:16,className:"mr-2"})," Print Report"]})]})]}),s&&u.jsxs("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 p-4 my-4 flex items-start no-print",role:"alert",children:[u.jsx(An,{size:20,className:"mr-3 mt-1 flex-shrink-0"}),u.jsxs("p",{className:"text-sm",children:["Could not load all statistics: ",u.jsx("span",{className:"font-mono text-xs break-all",children:s})]})]}),u.jsxs("div",{id:"stats-print-area",children:[u.jsxs("header",{className:"hidden print:block text-center mb-8",children:[u.jsx("h1",{className:"text-3xl font-bold text-blue-700",children:"AGWA System Analytics Report"}),u.jsxs("p",{className:"text-sm text-gray-500",children:["Generated: ",new Date().toLocaleString()]})]}),u.jsxs("div",{className:"space-y-8",children:[u.jsxs("section",{className:"print-section",children:[u.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[u.jsx(px,{size:22,className:"mr-2 text-green-600"}),"Business Analytics"]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[u.jsx(Eo,{title:"Total Revenue (12 Mo.)",value:`${f.toLocaleString("en-US",{minimumFractionDigits:0})}`,icon:px,color:kt.greenBorder}),u.jsx(Eo,{title:"Total Outstanding",value:`${((e==null?void 0:e.outstandingBalance)??0).toLocaleString("en-US",{minimumFractionDigits:0})}`,icon:bP,color:kt.redBorder}),u.jsx(Eo,{title:"Total Consumption (12 Mo.)",value:`${m.toLocaleString("en-US")} m`,icon:u9,color:kt.blueBorder})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:u.jsx(Hp,{data:(e==null?void 0:e.monthlyRevenue)||{},title:"Monthly Collected Revenue (Last 12 Months)",label:"Revenue",color:kt.green,borderColor:kt.greenBorder})}),u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:u.jsx(Hp,{data:(e==null?void 0:e.monthlyConsumption)||{},title:"Monthly Water Consumption (Last 12 Months)",label:"Consumption (m)",color:kt.blue,borderColor:kt.blueBorder})}),u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:u.jsx($p,{data:e==null?void 0:e.revenueByLocation,title:"Revenue by Location"})}),u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:u.jsx($p,{data:e==null?void 0:e.paymentMethods,title:"Payments by Method"})})]})]}),u.jsxs("section",{className:"print-section pt-6 border-t",children:[u.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[u.jsx(xa,{size:22,className:"mr-2 text-purple-600"}),"User & Support Analytics"]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[u.jsx(Eo,{title:"Total Users",value:(e==null?void 0:e.totalUsers)??"N/A",icon:xa,color:kt.purpleBorder}),u.jsx(Eo,{title:"Total Tickets",value:(e==null?void 0:e.totalTickets)??"N/A",icon:Aa,color:kt.orangeBorder}),u.jsx(Eo,{title:"Open Tickets",value:(e==null?void 0:e.openTickets)??"0",icon:Xt,color:kt.redBorder})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:u.jsx(FI,{data:(e==null?void 0:e.userGrowth)||{},title:"New User Signups (Last 12 Months)",datasets:[{label:"New Users",key:"users",borderColor:kt.purpleBorder,backgroundColor:kt.purple,tension:.1}]})}),u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:u.jsx($p,{data:e==null?void 0:e.usersByRole,title:"Users by Role"})}),u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:u.jsx(ZH,{data:e==null?void 0:e.ticketsByType,title:"Tickets by Type"})}),u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:u.jsx($p,{data:e==null?void 0:e.ticketStats,title:"Support Tickets by Status"})})]})]}),u.jsxs("section",{className:"print-section pt-6 border-t",children:[u.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[u.jsx(SP,{size:22,className:"mr-2 text-sky-600"}),"Staff & Technical Analytics"]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[u.jsx(Eo,{title:"Total Routes",value:((y=e==null?void 0:e.techStats)==null?void 0:y.totalRoutes)??"N/A",icon:Oo,color:kt.tealBorder}),u.jsx(Eo,{title:"Total Accounts",value:((g=e==null?void 0:e.techStats)==null?void 0:g.totalAccounts)??"N/A",icon:xa,color:kt.tealBorder}),u.jsx(Eo,{title:"Active Interruptions",value:((_=e==null?void 0:e.techStats)==null?void 0:_.activeInterrupts)??"N/A",icon:Xt,color:kt.redBorder}),u.jsx(Eo,{title:"Unassigned Routes",value:((E=e==null?void 0:e.techStats)==null?void 0:E.unassignedRoutes)??"N/A",icon:Uy,color:kt.orangeBorder})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:u.jsx(Hp,{data:((x=e==null?void 0:e.staffActivity)==null?void 0:x.readerActivity)||{},title:"Readings Submitted Today (by Staff)",label:"Readings",color:kt.sky,borderColor:kt.skyBorder})}),u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:u.jsx(Hp,{data:((w=e==null?void 0:e.staffActivity)==null?void 0:w.clerkActivity)||{},title:"Payments Processed Today (by Staff)",label:"Payments",color:kt.purple,borderColor:kt.purpleBorder})}),u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:u.jsx(FI,{data:(e==null?void 0:e.hourlyActivity)||[],title:"Hourly Portal Activity (Today)"})})]})]})]})]}),u.jsx("style",{children:`
                @media print {
                    .no-print { display: none !important; }
                    .print-section { 
                        page-break-inside: avoid; 
                        margin-bottom: 2rem; 
                        border-top: 1px solid #eee !important; 
                        padding-top: 1rem !important;
                    }
                    body, .bg-white { background-color: #FFFFFF !important; }
                    .shadow-xl, .shadow-md, .shadow-lg, .border { border: none !important; box-shadow: none !imporant; }
                    .bg-gray-50 { background-color: #F9FAFB !important; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
                    
                    div.lg\\:pl-64 {
                        padding-left: 0 !important;
                    }
                    main.print\\:p-4 {
                        padding: 1rem !important;
                    }
                }
                `})]})},XH=({isOpen:n,onClose:e,onSave:t,reading:r,isSaving:i,accountNumber:s})=>{const[o,l]=ee.useState({});ee.useEffect(()=>{var f;if(r){const m=(f=r.readingDate)!=null&&f.toDate?r.readingDate.toDate():new Date(r.readingDate),y=m.getFullYear(),g=String(m.getMonth()+1).padStart(2,"0"),_=String(m.getDate()).padStart(2,"0");l({readingValue:r.readingValue||"",readingDate:`${y}-${g}-${_}`,readingType:r.readingType||"Actual",notes:r.notes||""})}else l({readingValue:"",readingDate:new Date().toISOString().split("T")[0],readingType:"Actual",notes:""})},[r]);const d=f=>{f.preventDefault(),t(r==null?void 0:r.id,o)};return n?u.jsx(Or,{isOpen:n,onClose:e,title:r?`Edit Reading for ${r.accountNumber}`:`Create New Reading for ${s}`,children:u.jsxs("form",{onSubmit:d,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"readingValue",className:"text-sm font-medium text-gray-700 flex items-center mb-1",children:[u.jsx(Yl,{size:14,className:"mr-1.5"}),"Reading Value (m)"]}),u.jsx("input",{type:"number",name:"readingValue",value:o.readingValue,onChange:f=>l({...o,readingValue:f.target.value}),className:Mi,step:"0.01",required:!0})]}),u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"readingDate",className:"text-sm font-medium text-gray-700 flex items-center mb-1",children:[u.jsx(au,{size:14,className:"mr-1.5"}),"Reading Date"]}),u.jsx("input",{type:"date",name:"readingDate",value:o.readingDate,onChange:f=>l({...o,readingDate:f.target.value}),className:Mi,required:!0})]}),u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"readingType",className:"text-sm font-medium text-gray-700 flex items-center mb-1",children:[u.jsx(a9,{size:14,className:"mr-1.5"}),"Reading Type"]}),u.jsxs("select",{name:"readingType",value:o.readingType,onChange:f=>l({...o,readingType:f.target.value}),className:Mi,children:[u.jsx("option",{value:"Actual",children:"Actual"}),u.jsx("option",{value:"Estimated",children:"Estimated"}),u.jsx("option",{value:"No Reading",children:"No Reading"})]})]}),u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"notes",className:"text-sm font-medium text-gray-700 flex items-center mb-1",children:[u.jsx(A9,{size:14,className:"mr-1.5"}),"Notes"]}),u.jsx("textarea",{name:"notes",rows:"3",value:o.notes,onChange:f=>l({...o,notes:f.target.value}),className:Mi})]}),u.jsxs("div",{className:"pt-4 flex justify-end space-x-3",children:[u.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg border",disabled:i,children:"Cancel"}),u.jsxs("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg flex items-center",disabled:i,children:[i?u.jsx(St,{size:18,className:"animate-spin mr-2"}):u.jsx(Oa,{size:18,className:"mr-2"}),i?"Saving...":"Save Changes"]})]})]})}):null},JH=({showNotification:n,userData:e})=>{var re,oe,ie;const[t,r]=ee.useState(""),[i,s]=ee.useState(null),[o,l]=ee.useState(!1),[d,f]=ee.useState(""),[m,y]=ee.useState(!1),[g,_]=ee.useState(null),[E,x]=ee.useState(!1),[w,S]=ee.useState(null),[N,P]=ee.useState(!1),[I,R]=ee.useState(!1),U=async X=>{if(X.preventDefault(),!t.trim()){f("Please enter an account number.");return}l(!0),f(""),y(!0),s(null);try{const Y=ct(en,ir()),B=wt(Y,bt("accountNumber","==",t.trim().toUpperCase())),Z=await Tt(B);if(Z.empty){f("No user found with the provided account number."),l(!1);return}const te=Z.docs[0];await j({id:te.id,...te.data()})}catch(Y){console.error("Error searching for user or readings:",Y),f("An error occurred during the search. Check Firestore rules and indexes."),l(!1)}},j=async X=>{const Y=ct(en,Lo()),B=wt(Y,bt("userId","==",X.id),Jr("readingDate","desc")),te=(await Tt(B)).docs.map(se=>({id:se.id,...se.data()}));s({user:X,readings:te}),l(!1)},k=X=>{x(!1),_(X)},F=()=>{if(!(i!=null&&i.user)){n("Please search for a user first before creating a reading.","warning");return}_(null),x(!0)},O=()=>{_(null),x(!1)},C=async(X,Y)=>{P(!0);const B=await D8(en,X,Y);B.success?(n("Meter reading updated successfully!","success"),await j(i.user),O()):n(B.error||"Failed to update reading.","error"),P(!1)},D=async(X,Y)=>{P(!0);const B={...Y,userId:i.user.id,accountNumber:i.user.accountNumber,meterSerialNumber:i.user.meterSerialNumber||"N/A",readBy:e.displayName||"Admin",readerId:e.uid},Z=await dP(en,B);Z.success?(n("New meter reading created successfully!","success"),await j(i.user),O()):n(Z.error||"Failed to create reading.","error"),P(!1)},M=async()=>{if(!(i!=null&&i.user)){n("Please search for a user first.","error");return}R(!0);const X=await lP(en,i.user.id,i.user);X.success?n(X.message,"success"):n(X.error,"error"),R(!1)},$=X=>{S(X)},G=async()=>{if(!w)return;P(!0);const X=await L8(en,w);X.success?(n("Meter reading deleted successfully!","success"),await j(i.user)):n(X.error||"Failed to delete reading.","error"),S(null),P(!1)};return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl",children:[u.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Meter Reading & Billing"}),u.jsxs("form",{onSubmit:U,className:"mb-6 flex flex-col sm:flex-row gap-2 items-center bg-gray-50 p-4 rounded-lg shadow-sm",children:[u.jsx("input",{type:"text",value:t,onChange:X=>r(X.target.value),placeholder:"Enter user account number...",className:"w-full p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500"}),u.jsxs("button",{type:"submit",disabled:o,className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 disabled:bg-blue-400 flex items-center justify-center w-full sm:w-auto",children:[o?u.jsx(St,{className:"animate-spin mr-2"}):u.jsx(Ps,{className:"mr-2",size:18}),o?"Searching...":"Search"]})]}),d&&u.jsx("p",{className:"text-red-500 text-center mb-4",children:d}),o&&u.jsx(gn,{message:"Fetching data..."}),(i==null?void 0:i.user)&&u.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-lg shadow-md mt-6 border border-gray-200",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-3",children:[u.jsxs("h2",{className:"text-xl font-semibold",children:["Data for ",i.user.displayName," (",i.user.accountNumber,")"]}),u.jsxs("div",{className:"flex gap-2 flex-wrap",children:[u.jsxs("button",{onClick:F,className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 flex items-center text-sm",children:[u.jsx(Vy,{size:16,className:"mr-2"})," Create Reading"]}),u.jsxs("button",{onClick:M,className:"bg-cyan-600 text-white px-4 py-2 rounded-md hover:bg-cyan-700 flex items-center text-sm disabled:bg-gray-400",disabled:I||i.readings.length<2,title:i.readings.length<2?"At least 2 readings are required to generate a bill":"Generate bill from latest reading",children:[I?u.jsx(St,{size:16,className:"animate-spin mr-2"}):u.jsx(Kl,{size:16,className:"mr-2"}),I?"Generating...":"Generate Bill"]})]})]}),u.jsxs("div",{className:"overflow-x-auto",children:[u.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reading (m)"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reader"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),u.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(re=i.readings)==null?void 0:re.map(X=>u.jsxs("tr",{children:[u.jsx("td",{className:"px-4 py-4 whitespace-nowrap font-medium",children:X.readingValue}),u.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:Zt(X.readingDate,{year:"numeric",month:"short",day:"numeric"})}),u.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:X.readBy||"N/A"}),u.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:X.readingType||"N/A"}),u.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-center space-x-2",children:[u.jsx("button",{onClick:()=>k(X),className:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded-md transition-colors",title:"Edit Reading",children:u.jsx(Bf,{size:16})}),u.jsx("button",{onClick:()=>$(X.id),className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-100 rounded-md transition-colors",title:"Delete Reading",children:u.jsx(qd,{size:16})})]})]},X.id))})]}),((oe=i.readings)==null?void 0:oe.length)<2&&u.jsx("p",{className:"text-xs text-center text-yellow-600 bg-yellow-50 p-2 mt-2 rounded-md",children:"Note: At least two readings are needed before a bill can be generated."})]})]}),(g||E)&&u.jsx(XH,{isOpen:!0,onClose:O,onSave:E?D:C,reading:g,isSaving:N,accountNumber:(ie=i==null?void 0:i.user)==null?void 0:ie.accountNumber}),w&&u.jsx(Jl,{isOpen:!!w,onClose:()=>S(null),onConfirm:G,title:"Confirm Deletion",confirmText:"Yes, Delete",isConfirming:N,iconType:"danger",children:"Are you sure you want to permanently delete this meter reading? This action cannot be undone."})]})},Wp="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition-150 text-sm",e$=({isOpen:n,onClose:e,onSave:t,route:r,readers:i,isSaving:s,db:o})=>{const[l,d]=ee.useState({name:"",areaCode:"",description:"",assignedReaderId:""}),[f,m]=ee.useState([]),[y,g]=ee.useState([]),[_,E]=ee.useState({}),[x,w]=ee.useState([]),[S,N]=ee.useState(!1);ee.useEffect(()=>{const C=Ky(),D=[],M=C.reduce(($,G)=>{const re=Pd(G).sort();return $[G]=re,D.push(...re),$},{});E(M),w(D.sort())},[]),ee.useEffect(()=>{if(n)if(r){d({name:r.name||"",areaCode:r.areaCode||"",description:r.description||"",assignedReaderId:r.assignedReaderId||""});const C=Array.isArray(r.barangays)?r.barangays:r.barangay?[r.barangay]:[];m(C),g(r.accountNumbers||[])}else d({name:"",areaCode:"",description:"",assignedReaderId:""}),m([]),g([])},[r,n]);const P=ee.useCallback(async C=>{if(!C||C.length===0){g([]);return}N(!0);let D=[];for(const M of C){const $=await f8(o,M);$.success&&(D=[...D,...$.data])}g([...new Set(D)]),N(!1)},[o]);ee.useEffect(()=>{P(f)},[f,P]);const I=C=>{m(D=>D.includes(C)?D.filter(M=>M!==C):[...D,C])},R=()=>{f.length===x.length?m([]):m([...x])},U=(C,D)=>{const M=D.every($=>f.includes($));m(M?$=>$.filter(G=>!D.includes(G)):$=>[...new Set([...$,...D])])},j=C=>C?C.split(" ").map(D=>D[0]).join("").toUpperCase():"",k=C=>{const D=C.target.value;d(M=>({...M,name:D,areaCode:j(D)}))},F=C=>{const{name:D,value:M}=C.target;d($=>({...$,[D]:M}))},O=C=>{C.preventDefault(),t({name:l.name,areaCode:l.areaCode,description:l.description,assignedReaderId:l.assignedReaderId,barangays:f,accountNumbers:y})};return u.jsxs(Or,{isOpen:n,onClose:e,title:r?"Edit Meter Route":"Create New Meter Route",size:"2xl",children:[u.jsxs("form",{onSubmit:O,className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"name",className:"block text-sm font-medium mb-1",children:"Route Name"}),u.jsx("input",{type:"text",name:"name",value:l.name,onChange:k,className:Wp,required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"areaCode",className:"block text-sm font-medium mb-1",children:"Generated Area Code"}),u.jsx("input",{type:"text",name:"areaCode",value:l.areaCode,className:`${Wp} bg-gray-200`,readOnly:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"assignedReaderId",className:"block text-sm font-medium mb-1",children:"Assign to Meter Reader"}),u.jsxs("select",{name:"assignedReaderId",value:l.assignedReaderId,onChange:F,className:Wp,children:[u.jsx("option",{value:"",children:"Unassigned"}),i.map(C=>u.jsxs("option",{value:C.id,children:[C.displayName," (",C.email,")"]},C.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"description",className:"block text-sm font-medium mb-1",children:"Description"}),u.jsx("textarea",{name:"description",value:l.description,onChange:F,rows:"2",className:Wp})]}),u.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50 max-h-72 overflow-y-auto scrollbar-thin",children:[u.jsxs("div",{className:"flex justify-between items-center mb-2 sticky top-0 bg-gray-50 py-1 -mt-1 border-b border-gray-200",children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[u.jsx(Oo,{size:16,className:"inline mr-1.5"}),"Assigned Area(s) *"]}),u.jsx("button",{type:"button",onClick:R,className:"text-xs font-medium text-blue-600 hover:underline",children:f.length===x.length?"Deselect All":`Select All (${x.length})`})]}),u.jsx("div",{className:"space-y-2",children:Object.entries(_).map(([C,D])=>u.jsxs("details",{className:"group bg-white border rounded-md",children:[u.jsxs("summary",{className:"flex justify-between items-center p-2 cursor-pointer list-none",children:[u.jsx("span",{className:"font-semibold text-sm text-blue-700",children:C}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("button",{type:"button",onClick:M=>{M.preventDefault(),U(C,D)},className:"text-xs text-blue-600 hover:underline mr-2",children:"Toggle District"}),u.jsx(Yb,{size:18,className:"text-gray-500 group-open:rotate-180 transition-transform"})]})]}),u.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 p-3 border-t border-gray-100",children:D.map(M=>u.jsxs("label",{className:"flex items-center space-x-2 p-1.5 rounded bg-gray-50 border border-gray-200 hover:bg-blue-50 cursor-pointer text-xs has-[:checked]:bg-blue-100 has-[:checked]:border-blue-300",children:[u.jsx("input",{type:"checkbox",checked:f.includes(M),onChange:()=>I(M),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 shrink-0"}),u.jsx("span",{className:"truncate",title:M,children:M})]},M))})]},C))})]}),u.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[u.jsxs("p",{className:"text-sm font-medium text-blue-800 flex items-center",children:[u.jsx(y9,{size:16,className:"mr-2"}),"Auto-Assigned Accounts"]}),S?u.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[u.jsx(St,{className:"animate-spin h-4 w-4 mr-2"}),"Searching for accounts..."]}):f.length>0&&y.length>0?u.jsxs("p",{className:"text-sm text-gray-700",children:[y.length," total accounts found in ",f.length," selected area(s)."]}):f.length>0&&y.length===0?u.jsxs("p",{className:"text-sm text-orange-700 bg-orange-100 p-2 rounded-md flex items-center",children:[u.jsx(An,{size:14,className:"mr-2"}),"No accounts found for this location. You cannot save an empty route."]}):u.jsx("p",{className:"text-xs text-gray-500",children:"Select at least one area to find and assign accounts."})]}),u.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[u.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium bg-gray-200 rounded-lg",disabled:s,children:"Cancel"}),u.jsxs("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg flex items-center disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:s||S||y.length===0,children:[s?u.jsx(St,{size:18,className:"animate-spin mr-2"}):u.jsx(Oa,{size:18,className:"mr-2"}),s?"Saving...":"Save Route"]})]})]}),u.jsx("style",{children:`
                .scrollbar-thin { scrollbar-width: thin; scrollbar-color: #9ca3af #f3f4f6; }
                .scrollbar-thin::-webkit-scrollbar { width: 6px; height: 6px;}
                .scrollbar-thin::-webkit-scrollbar-track { background: #f3f4f6; border-radius:3px; }
                .scrollbar-thin::-webkit-scrollbar-thumb { background-color: #9ca3af; border-radius: 3px; border: 1px solid #f3f4f6;}
                .scrollbar-thin::-webkit-scrollbar-thumb:hover { background-color: #6b7280; }
             `})]})},t$=({db:n,showNotification:e})=>{const[t,r]=ee.useState([]),[i,s]=ee.useState([]),[o,l]=ee.useState(!0),[d,f]=ee.useState(""),[m,y]=ee.useState(!1),[g,_]=ee.useState(null),[E,x]=ee.useState(!1),[w,S]=ee.useState(null),N=ee.useCallback(async()=>{l(!0),f("");try{const[k,F]=await Promise.all([p8(n),y8(n)]);k.success?r(k.data):f(k.error||"Failed to load routes."),F.success?s(F.data):f(O=>O+(F.error||" Failed to load meter readers."))}catch{f("An unexpected error occurred while fetching data.")}l(!1)},[n]);ee.useEffect(()=>{N()},[N]);const P=(k=null)=>{_(k),y(!0)},I=()=>{_(null),y(!1)},R=async k=>{x(!0);const F=await m8(n,k,g==null?void 0:g.id);F.success?(e(`Route ${g?"updated":"created"} successfully!`,"success"),N(),I()):e(F.error||"Failed to save route.","error"),x(!1)},U=async()=>{if(!w)return;x(!0);const k=await g8(n,w.id);k.success?(e("Route deleted successfully!","success"),S(null),N()):e(k.error||"Failed to delete route.","error"),x(!1)},j=k=>{var F;return((F=i.find(O=>O.id===k))==null?void 0:F.displayName)||"Unassigned"};return o?u.jsx(gn,{message:"Loading route data..."}):u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[u.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center",children:[u.jsx(Zl,{size:30,className:"mr-3 text-blue-600"})," Meter Route Management"]}),u.jsxs("button",{onClick:()=>P(),className:"bg-blue-600 text-white font-medium py-2 px-4 rounded-lg flex items-center",children:[u.jsx(Vy,{size:18,className:"mr-2"})," Add New Route"]})]}),d&&u.jsx("p",{className:"text-red-500 mb-4",children:d}),u.jsx("div",{className:"space-y-3",children:t.length>0?t.map(k=>{var F;return u.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"font-bold text-gray-800",children:[k.name," ",u.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["(",k.areaCode,")"]})]}),u.jsxs("p",{className:"text-xs text-gray-600 flex items-center mt-1",children:[u.jsx(C9,{size:12,className:"mr-1.5"}),"Assigned to: ",u.jsx("span",{className:"font-medium ml-1",children:j(k.assignedReaderId)})]}),u.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Accounts: ",((F=k.accountNumbers)==null?void 0:F.length)||0]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("button",{onClick:()=>P(k),className:"p-2 text-blue-600 hover:bg-blue-100 rounded-full",children:u.jsx(Bf,{size:18})}),u.jsx("button",{onClick:()=>S(k),className:"p-2 text-red-600 hover:bg-red-100 rounded-full",children:u.jsx(qd,{size:18})})]})]},k.id)}):u.jsxs("div",{className:"text-center py-10",children:[u.jsx(An,{size:48,className:"mx-auto text-gray-400 mb-3"}),u.jsx("p",{className:"text-gray-500",children:"No routes found. Click 'Add New Route' to create one."})]})}),m&&u.jsx(e$,{isOpen:m,onClose:I,onSave:R,route:g,readers:i,isSaving:E,db:n}),w&&u.jsxs(Jl,{isOpen:!!w,onClose:()=>S(null),onConfirm:U,title:"Confirm Route Deletion",isConfirming:E,children:['Are you sure you want to delete the route "',w.name,'"? This action cannot be undone.']})]})},n$=({db:n,showNotification:e})=>{const[t,r]=ee.useState([]),[i,s]=ee.useState(""),[o,l]=ee.useState([]),[d,f]=ee.useState(!1),[m,y]=ee.useState(!1),[g,_]=ee.useState([]);ee.useEffect(()=>{(async()=>{const S=await h8(n);S.success?r(S.data):e(S.error,"error")})()},[n,e]);const E=async w=>{if(s(w),!w){l([]);return}f(!0),l([]);const S=await E8(n,w);S.success?l(S.data):e(S.error,"error"),f(!1)},x=async()=>{if(o.length===0){e("No billable accounts in the selected area.","warning");return}y(!0),_([]);const w=await T8(n,o);_(w),y(!1),e("Batch billing process completed. Check logs for details.","success"),E(i)};return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl",children:[u.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center mb-4",children:[u.jsx(Kl,{size:30,className:"mr-3 text-green-600"})," Batch Bill Generation"]}),u.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Select a service area to find eligible accounts and generate bills in bulk. An account is eligible if it has a new reading that has not yet been billed."}),u.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border",children:[u.jsx("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Service Area (Barangay)"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[u.jsxs("select",{id:"location",value:i,onChange:w=>E(w.target.value),className:"w-full p-2 border rounded-md bg-white",children:[u.jsx("option",{value:"",children:"-- Select an Area --"}),t.map(w=>u.jsx("option",{value:w,children:w},w))]}),u.jsxs("button",{onClick:x,className:"bg-green-600 text-white px-5 py-2 rounded-md flex items-center justify-center whitespace-nowrap disabled:bg-gray-400",disabled:d||m||o.length===0,children:[m?u.jsx(St,{size:18,className:"animate-spin mr-2"}):u.jsx(s9,{size:18,className:"mr-2"}),m?"Processing...":`Generate ${o.length} Bills`]})]})]}),u.jsxs("div",{className:"mt-6",children:[u.jsxs("h3",{className:"font-semibold",children:["Eligible Accounts in ",i||"..."]}),d&&u.jsx(gn,{message:"Finding billable accounts..."}),!d&&i&&o.length===0&&u.jsxs("div",{className:"text-center py-6 bg-gray-50 mt-2 rounded-md",children:[u.jsx(An,{size:32,className:"mx-auto text-gray-400 mb-2"}),u.jsx("p",{className:"text-gray-600",children:"No new readings eligible for billing in this area."})]}),!d&&o.length>0&&u.jsxs("p",{className:"text-green-700 font-medium my-2",children:[o.length," accounts ready for billing."]})]}),g.length>0&&u.jsxs("div",{className:"mt-6 pt-4 border-t",children:[u.jsx("h3",{className:"font-semibold mb-2",children:"Processing Log"}),u.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto bg-gray-900 text-white font-mono text-xs p-4 rounded-md",children:g.map((w,S)=>u.jsxs("div",{className:`flex items-start ${w.success?"text-green-400":"text-red-400"}`,children:[w.success?u.jsx(Is,{size:14,className:"mr-2 mt-0.5 flex-shrink-0"}):u.jsx(Xt,{size:14,className:"mr-2 mt-0.5 flex-shrink-0"}),u.jsx("span",{children:w.message})]},S))})]})]})},r$=({userData:n,db:e,showNotification:t,setActiveSection:r})=>{const[i,s]=ee.useState({assignedRoutesCount:0,totalAccountsInRoutes:0,pendingReadingsInRoutes:0,readingsCompletedToday:0,issuesReportedByMe:0}),[o,l]=ee.useState(!0),[d,f]=ee.useState(""),m=ee.useCallback(async()=>{if(!n||!n.uid){t("Meter reader data not available.","error"),l(!1);return}l(!0),f("");try{const g={};let _="";const E=await hP(e,n.uid);E.success&&E.data?(g.assignedRoutesCount=E.data.length,g.totalAccountsInRoutes=E.data.reduce((N,P)=>{var I;return N+(P.accountCount||((I=P.accountNumbers)==null?void 0:I.length)||0)},0),g.pendingReadingsInRoutes=E.data.reduce((N,P)=>N+(P.pendingCount||0),0)):_+="Route data unavailable. ";const x=new Date().toISOString().split("T")[0],w=await b8(e,n.uid,x);w.success?g.readingsCompletedToday=w.data.count:_+="Today's readings data unavailable. ";const S=await uP(e,n.uid);S.success&&(g.issuesReportedByMe=S.data.length),s(N=>({...N,...g})),_&&(f(_.trim()),t("Some dashboard statistics could not be loaded.","warning"))}catch{const _="Could not load meter reader dashboard statistics. Please try refreshing.";f(_),t(_,"error")}finally{l(!1)}},[e,n,t]);ee.useEffect(()=>{m()},[m]);const y=[{title:"View Assigned Routes",icon:Zl,section:"assignedRoutes",description:"Check your daily routes and assigned accounts for reading.",color:"blue"},{title:"Manual Reading Entry",icon:Qb,section:"searchAndSubmitReading",description:"Submit a reading for an account not on your immediate list.",color:"green"},{title:"Search Customer Info",icon:Ps,section:"searchCustomerMeterReader",description:"Look up customer or meter details for verification.",color:"teal"},{title:"Report Field Issue",icon:Xt,section:"reportIssue",description:"Log issues like meter damage, leaks, or access problems.",color:"orange"}];return o?u.jsx(gn,{message:"Loading your dashboard...",className:"mt-10 h-48"}):u.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[u.jsx("div",{className:"p-6 bg-gradient-to-r from-sky-600 to-cyan-700 text-white rounded-xl shadow-xl",children:u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl sm:text-3xl font-bold",children:"Meter Reader Dashboard"}),u.jsxs("p",{className:"mt-1 text-sky-100",children:["Welcome, ",n.displayName||"Meter Reader","! Your tasks and tools are below."]})]}),u.jsxs("button",{onClick:m,className:"mt-3 sm:mt-0 text-sm flex items-center bg-sky-500 hover:bg-sky-400 text-white font-medium py-2 px-3 rounded-lg transition-colors disabled:opacity-70 self-start sm:self-center",disabled:o,title:"Refresh Statistics",children:[o?u.jsx(St,{size:16,className:"animate-spin"}):u.jsx(ja,{size:16}),u.jsx("span",{className:"ml-2 hidden sm:inline",children:"Refresh"})]})]})}),d&&u.jsxs("p",{className:"text-sm text-yellow-600 bg-yellow-50 p-3 rounded-md text-center my-4 flex items-center justify-center gap-2",children:[u.jsx(An,{size:16})," ",d]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5",children:[u.jsx(di,{title:"Assigned Routes",value:i.assignedRoutesCount,icon:Zl,borderColor:"border-blue-500",iconColor:"text-blue-500",onClick:()=>r("assignedRoutes")}),u.jsx(di,{title:"Pending Readings",value:i.pendingReadingsInRoutes,icon:g9,borderColor:"border-orange-500",iconColor:"text-orange-500",subtext:`Across ${i.totalAccountsInRoutes} total accounts`,onClick:()=>r("assignedRoutes")}),u.jsx(di,{title:"Readings Done Today",value:i.readingsCompletedToday,icon:Is,borderColor:"border-green-500",iconColor:"text-green-500"}),u.jsx(di,{title:"My Reported Issues",value:i.issuesReportedByMe,icon:Xt,borderColor:"border-red-500",iconColor:"text-red-500",onClick:()=>r("myTickets")})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-5 mt-8 pt-5 border-t border-gray-200",children:"Your Tools & Actions"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:y.map(g=>u.jsxs("button",{onClick:()=>r(g.section),className:`p-6 bg-white rounded-xl shadow-lg hover:shadow-2xl transform hover:-translate-y-1.5 transition-all duration-300 ease-in-out text-left focus:outline-none focus:ring-2 focus:ring-${g.color}-500 focus:ring-opacity-75 group h-full flex flex-col`,children:[u.jsx("div",{className:`p-3 bg-${g.color}-100 rounded-full inline-block mb-3 self-start group-hover:scale-110 transition-transform`,children:u.jsx(g.icon,{size:28,className:`text-${g.color}-600`})}),u.jsx("h4",{className:`text-lg font-semibold text-gray-800 group-hover:text-${g.color}-700 transition-colors`,children:g.title}),u.jsx("p",{className:"text-sm text-gray-500 mt-1 leading-normal flex-grow",children:g.description})]},g.section))})]}),u.jsxs("div",{className:"mt-8 p-5 bg-gray-50 rounded-xl shadow",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-3 flex items-center",children:[u.jsx(Xt,{size:20,className:"mr-2 text-yellow-500"})," Important Notices / Route Highlights"]}),u.jsx("p",{className:"text-sm text-gray-500",children:"No specific system notices for your routes today. Please ensure all readings are accurate and submitted on time. Report any discrepancies or issues immediately. Stay safe and hydrated!"})]})]})},Bh="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",K3=({db:n,userData:e,showNotification:t,customerToRead:r,onReadingSubmitted:i,isModalMode:s=!1,onCloseModal:o})=>{const[l,d]=ee.useState(""),[f,m]=ee.useState(!1),[y,g]=ee.useState(""),[_,E]=ee.useState(r||null),[x,w]=ee.useState(""),[S,N]=ee.useState(new Date().toISOString().split("T")[0]),[P,I]=ee.useState("Actual"),[R,U]=ee.useState(""),[j,k]=ee.useState(!1),F=async D=>{if(D.preventDefault(),!l.trim()){t("Please enter a search term.","warning");return}m(!0),g(""),E(null);const M=await Fy(n,l);M.success&&M.data.length>0?E(M.data[0]):M.success?g(`No customer found matching "${l}".`):g(M.error||"Failed to execute user search."),m(!1)},O=async D=>{if(D.preventDefault(),!_){t("No customer selected. Please search for a customer first.","error");return}if(!x||isNaN(parseFloat(x))||parseFloat(x)<0){t("Meter reading must be a valid, non-negative number.","warning");return}k(!0);const M={userId:_.id,accountNumber:_.accountNumber,meterSerialNumber:_.meterSerialNumber||"N/A",readingValue:parseFloat(x),readingDate:S,readingDateString:S,readingType:P,notes:R.trim(),readBy:e.displayName||e.email,readerId:e.uid},$=await dP(n,M);$.success?s&&i?i($.id,M):(t(`Reading for ${_.accountNumber} submitted successfully!`,"success"),d(""),E(null),w(""),U(""),I("Actual")):t($.error||"Failed to submit meter reading.","error"),k(!1)},C=["Actual","Estimated","No Reading","Customer Refused","Unable to Access Meter"];return u.jsxs("div",{className:s?"":"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[!s&&u.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(Qb,{size:30,className:"mr-3 text-blue-600"})," Search & Submit Reading"]})}),!_&&!s&&u.jsxs("form",{onSubmit:F,className:"mb-6 p-4 bg-gray-50 rounded-lg shadow-sm",children:[u.jsx("label",{htmlFor:"customerSearchTerm",className:"block text-sm font-medium text-gray-700 mb-1",children:"Find Customer to Read"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[u.jsxs("div",{className:"relative flex-grow",children:[u.jsx(Ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsx("input",{type:"text",id:"customerSearchTerm",value:l,onChange:D=>d(D.target.value),className:`${Bh} pl-9`,placeholder:"Search by Account No, Name, or Meter No...",disabled:f})]}),u.jsxs("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2.5 px-6 rounded-lg flex items-center justify-center",disabled:f,children:[f?u.jsx(St,{size:18,className:"animate-spin mr-2"}):u.jsx(Ps,{size:18,className:"mr-2"}),"Find"]})]}),y&&u.jsx("p",{className:"text-red-500 text-xs mt-2",children:y})]}),f&&u.jsx(gn,{message:"Searching..."}),_&&u.jsxs("form",{onSubmit:O,className:"space-y-5 p-4 border-t-4 border-blue-500 bg-blue-50 rounded-lg shadow-md animate-fadeIn",children:[u.jsxs("div",{className:"p-3 border border-blue-200 bg-white rounded-md text-sm space-y-1",children:[u.jsxs("p",{className:"font-semibold text-blue-800 flex items-center",children:[u.jsx(ks,{size:16,className:"mr-2"}),_.displayName]}),u.jsxs("p",{className:"text-gray-600 flex items-center",children:[u.jsx(Cs,{size:14,className:"mr-2"}),"Account No: ",_.accountNumber]}),u.jsxs("p",{className:"text-gray-600 flex items-center",children:[u.jsx(Yl,{size:14,className:"mr-2"}),"Meter No: ",_.meterSerialNumber||"N/A"]})]}),u.jsxs("fieldset",{disabled:j,className:"space-y-5",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"readingValue",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Meter Reading (m)*"}),u.jsx("input",{type:"number",id:"readingValue",value:x,onChange:D=>w(D.target.value),className:Bh,step:"0.01",required:!0})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"readingDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Reading Date*"}),u.jsx("input",{type:"date",id:"readingDate",value:S,onChange:D=>N(D.target.value),className:Bh,required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"readingType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Reading Type*"}),u.jsx("select",{id:"readingType",value:P,onChange:D=>I(D.target.value),className:Bh,required:!0,children:C.map(D=>u.jsx("option",{value:D,children:D},D))})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes / Remarks"}),u.jsx("textarea",{id:"notes",value:R,onChange:D=>U(D.target.value),rows:"3",className:Bh,placeholder:"e.g., Meter obstructed, Dog on premises..."})]})]}),u.jsxs("div",{className:"flex gap-3",children:[s&&u.jsx("button",{type:"button",onClick:o,className:"w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2.5 px-6 rounded-lg",disabled:j,children:"Cancel"}),u.jsxs("button",{type:"submit",className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-2.5 px-6 rounded-lg flex items-center justify-center disabled:opacity-60",disabled:j,children:[j?u.jsx(St,{size:20,className:"animate-spin mr-2"}):u.jsx(Oa,{size:20,className:"mr-2"}),j?"Submitting...":"Submit Reading"]})]})]})]})},i$="w-full px-3 py-2 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",s$=({db:n,userData:e,showNotification:t})=>{const[r,i]=ee.useState([]),[s,o]=ee.useState(null),[l,d]=ee.useState([]),[f,m]=ee.useState(!0),[y,g]=ee.useState(!1),[_,E]=ee.useState(""),[x,w]=ee.useState(""),[S,N]=ee.useState(null),[P,I]=ee.useState(!1),[R,U]=ee.useState(""),j=ee.useCallback(async($=!0)=>{if(!e||!e.uid){E("Meter reader ID not available. Cannot fetch routes."),m(!1);return}$&&m(!0),E("");const G=await hP(n,e.uid);if(G.success){const re=G.data.map(oe=>{var ie,X,Y;return{...oe,accountCount:oe.accountCount||((ie=oe.accountNumbers)==null?void 0:ie.length)||((X=oe.accountIds)==null?void 0:X.length)||0,completedCount:oe.completedReadingsToday||0,pendingCount:Math.max(0,(oe.accountCount||((Y=oe.accountNumbers)==null?void 0:Y.length)||0)-(oe.completedReadingsToday||0))}});i(re.sort((oe,ie)=>(oe.name||"").localeCompare(ie.name||"")))}else{const re=G.error||"Failed to fetch assigned routes.";E(re),i([])}$&&m(!1)},[n,e]);ee.useEffect(()=>{j()},[j]);const k=ee.useCallback(async $=>{if(!$)return;g(!0),w("");const G=await w8(n,$);if(G.success){const re=new Date().toISOString().split("T")[0],oe=await Promise.all(G.data.map(async ie=>{var Z;let X={readingValue:"N/A",readingDate:null},Y=!1;const B=await F8(n,ie.accountNumber);if(B.success&&B.data.length>0){const te=B.data[0];X.readingValue=te.readingValue,X.readingDate=(Z=te.readingDate)!=null&&Z.toDate?te.readingDate.toDate():new Date(te.readingDate),te.readingDate.toDate().toISOString().split("T")[0]===re&&(Y=!0)}return{...ie,lastReading:X.readingValue,lastReadingDateDisplay:X.readingDate?Zt(X.readingDate,{month:"short",day:"numeric"}):"N/A",readingStatus:Y?"Completed Today":"Pending"}}));d(oe.sort((ie,X)=>{var Y,B;return(((Y=ie.serviceAddress)==null?void 0:Y.street)||"").localeCompare(((B=X.serviceAddress)==null?void 0:B.street)||"")}))}else{const re=G.error||`Failed to fetch accounts for route ${$.name}.`;w(re),d([])}g(!1)},[n]),F=$=>{(s==null?void 0:s.id)!==($==null?void 0:$.id)&&(o($),U(""),d([]),$&&k($))},O=$=>{N($),I(!0)},C=($,G)=>{if(t(`Reading for ${G.accountNumber} submitted successfully.`,"success"),d(re=>re.map(oe=>oe.accountNumber===G.accountNumber?{...oe,readingStatus:"Completed Today",lastReading:G.readingValue,lastReadingDateDisplay:Zt(new Date,{month:"short",day:"numeric"})}:oe)),s){const re=r.map(ie=>{if(ie.id===s.id){const X=(ie.completedCount||0)+1;return{...ie,completedCount:X,pendingCount:Math.max(0,ie.accountCount-X)}}return ie});i(re);const oe=re.find(ie=>ie.id===s.id);oe&&o(oe)}I(!1),N(null)},D=$=>!$||typeof $!="object"?"N/A":[$.street,$.barangay,$.district].filter(re=>re&&re.trim()).join(", "),M=l.filter($=>{var oe,ie,X;const G=R.toLowerCase(),re=D($.serviceAddress).toLowerCase();return((oe=$.displayName)==null?void 0:oe.toLowerCase().includes(G))||((ie=$.accountNumber)==null?void 0:ie.toLowerCase().includes(G))||re.includes(G)||((X=$.meterSerialNumber)==null?void 0:X.toLowerCase().includes(G))});return f?u.jsx(gn,{message:"Loading your assigned routes...",className:"mt-10 h-64"}):_&&r.length===0?u.jsxs("div",{className:"text-center py-10 bg-red-50 p-4 rounded-lg",children:[u.jsx(Xt,{size:48,className:"mx-auto text-red-400 mb-3"}),u.jsx("p",{className:"text-red-600 text-lg font-semibold",children:"Error Loading Routes"}),u.jsx("p",{className:"text-sm text-red-500 mt-1",children:_})]}):u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(Zl,{size:30,className:"mr-3 text-blue-600"})," Assigned Routes & Meter Reading"]}),u.jsxs("button",{onClick:()=>j(!1),className:"mt-3 sm:mt-0 text-sm flex items-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-3 rounded-lg border border-gray-300 transition-colors",disabled:f||y,title:"Refresh Route List",children:[u.jsx(ja,{size:16,className:`mr-1.5 ${f?"animate-spin":""}`}),"Refresh Routes"]})]}),r.length===0&&!f&&!_&&u.jsxs("div",{className:"text-center py-10 bg-gray-50 rounded-lg p-4",children:[u.jsx(An,{size:48,className:"mx-auto text-gray-400 mb-3"}),u.jsx("p",{className:"text-gray-500 text-lg",children:"No routes are currently assigned to you."})]}),r.length>0&&u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[u.jsxs("div",{className:"lg:col-span-1 bg-slate-50 p-3.5 rounded-lg shadow-md max-h-[75vh] overflow-y-auto",children:[u.jsxs("h3",{className:"text-md font-semibold text-slate-700 mb-3 sticky top-0 bg-slate-50 py-2 z-10 border-b border-slate-200",children:["My Routes (",r.length,")"]}),u.jsx("div",{className:"space-y-2.5",children:r.map($=>u.jsxs("button",{onClick:()=>F($),className:`w-full text-left p-3 rounded-lg border-2 transition-all duration-200 transform hover:scale-[1.02] focus:outline-none focus:ring-2 focus:ring-offset-1
                                        ${(s==null?void 0:s.id)===$.id?"bg-blue-600 text-white shadow-lg border-blue-700 ring-blue-500":"bg-white hover:bg-blue-50 border-gray-200 hover:border-blue-400"}`,children:[u.jsx("p",{className:`font-semibold text-sm ${(s==null?void 0:s.id)===$.id?"text-white":"text-blue-700"}`,children:$.name}),u.jsxs("p",{className:`text-xs mt-0.5 ${(s==null?void 0:s.id)===$.id?"text-blue-100":"text-gray-500"}`,children:["Area: ",$.areaCode||"N/A"]}),u.jsxs("div",{className:"mt-1.5 text-xs",children:[u.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-white text-[10px] ${($.pendingCount||0)>0?"bg-orange-500":"bg-green-500"}`,children:($.pendingCount||0)===0&&$.accountCount>0?"All Read":`${$.pendingCount} Pending`}),u.jsxs("span",{className:`ml-1.5 ${(s==null?void 0:s.id)===$.id?"text-blue-200":"text-gray-400"}`,children:["(",$.completedCount||0," / ",$.accountCount||0,")"]})]})]},$.id))})]}),u.jsxs("div",{className:"lg:col-span-3",children:[!s&&!y&&u.jsxs("div",{className:"p-6 text-center text-gray-400 bg-slate-50 rounded-lg shadow-inner h-full flex flex-col justify-center items-center min-h-[300px]",children:[u.jsx(xP,{size:48,className:"mb-3 opacity-70"}),u.jsx("p",{className:"text-lg",children:"Please select a route to view accounts."})]}),s&&y&&u.jsx(gn,{message:`Loading accounts for ${s.name}...`,className:"min-h-[300px]"}),s&&!y&&u.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg shadow-md",children:[u.jsxs("div",{className:"pb-2 mb-3 border-b border-slate-200",children:[u.jsxs("h3",{className:"text-lg font-semibold text-slate-700",children:["Accounts in: ",s.name]}),u.jsx("p",{className:"text-xs text-slate-500",children:s.description||"No route description provided."})]}),u.jsxs("div",{className:"relative mb-4",children:[u.jsx(Ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"}),u.jsx("input",{type:"text",placeholder:"Search by Name, Account No, Address...",value:R,onChange:$=>U($.target.value),className:`${i$} pl-9`})]}),x&&u.jsx("p",{className:"text-sm text-red-500 text-center py-3 bg-red-50 rounded-md",children:x}),u.jsx("div",{className:"space-y-3 max-h-[65vh] overflow-y-auto pr-1 pb-2",children:M.length>0?M.map($=>u.jsxs("div",{className:`p-3.5 border rounded-lg flex flex-col sm:flex-row justify-between items-start sm:items-center transition-shadow hover:shadow-md 
                                            ${$.readingStatus==="Completed Today"?"bg-green-50 border-green-300":"bg-white border-gray-200 hover:border-blue-400"}`,children:[u.jsxs("div",{className:"flex-grow mb-2 sm:mb-0",children:[u.jsxs("p",{className:"font-medium text-slate-800 text-sm",children:[$.displayName," ",u.jsxs("span",{className:"text-xs text-slate-500 font-mono",children:["(",$.accountNumber,")"]})]}),u.jsx("p",{className:"text-xs text-slate-600 mt-0.5",children:D($.serviceAddress)}),u.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:["Meter: ",$.meterSerialNumber," | Last Reading: ",$.lastReading||"N/A"," on ",$.lastReadingDateDisplay]}),u.jsxs("p",{className:`text-xs font-semibold mt-1 ${$.readingStatus==="Completed Today"?"text-green-600":"text-orange-600"}`,children:["Status: ",$.readingStatus]})]}),u.jsxs("button",{onClick:()=>O($),className:`text-xs font-medium py-1.5 px-3.5 rounded-md flex items-center transition-colors active:scale-95 whitespace-nowrap
                                                    ${$.readingStatus==="Completed Today"?"bg-yellow-500 hover:bg-yellow-600 text-white":"bg-blue-600 hover:bg-blue-700 text-white"}`,title:$.readingStatus==="Completed Today"?"Review or Edit Reading":"Submit New Reading",children:[u.jsx(n2,{size:13,className:"mr-1.5"})," ",$.readingStatus==="Completed Today"?"Edit":"Enter Reading"]})]},$.id||$.accountNumber)):u.jsxs("div",{className:"py-6 text-center text-gray-500",children:[u.jsx(ks,{size:36,className:"mx-auto mb-2 text-gray-400"}),"No accounts ",R?"match your search.":"found for this route."]})})]})]})]}),P&&S&&u.jsx(Or,{isOpen:P,onClose:()=>{I(!1),N(null)},title:`Meter Reading: ${S.displayName} (${S.accountNumber})`,size:"lg",children:u.jsx(K3,{db:n,userData:e,showNotification:t,customerToRead:S,onReadingSubmitted:C,isModalMode:!0,onCloseModal:()=>{I(!1),N(null)}})})]})},o$="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",a$=({db:n,showNotification:e})=>{const[t,r]=ee.useState(""),[i,s]=ee.useState(null),[o,l]=ee.useState(!1),[d,f]=ee.useState(""),m=async _=>{if(_.preventDefault(),!t.trim()){e("Please enter a search term (Account No., Name, or Meter No.).","warning");return}l(!0),f(""),s(null);try{const E=await Fy(n,t);E.success&&E.data.length>0?s(E.data[0]):E.success?f(`No customer found matching "${t}".`):f(E.error||"Failed to search for users.")}catch{f("An error occurred during the search.")}l(!1)},y=_=>!_||typeof _!="object"?_||"N/A":[_.street,_.barangay,_.district,"Naic, Cavite"].filter(x=>x&&x.trim()).join(", "),g=({label:_,value:E,icon:x})=>u.jsxs("div",{className:"flex items-start py-2 border-b border-gray-100",children:[x&&u.jsx(x,{size:16,className:"mr-2.5 text-blue-500 flex-shrink-0 mt-0.5"}),u.jsxs("span",{className:"text-xs font-medium text-gray-500 w-32 sm:w-40",children:[_,":"]}),u.jsx("span",{className:"text-sm text-gray-800 flex-1 break-words",children:E||"N/A"})]});return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(Ps,{size:30,className:"mr-3 text-blue-600"})," Search Customer Profile"]})}),u.jsxs("form",{onSubmit:m,className:"mb-8 p-4 bg-gray-50 rounded-lg shadow",children:[u.jsx("label",{htmlFor:"customerSearchTerm",className:"block text-sm font-medium text-gray-700 mb-1",children:"Find Customer"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[u.jsxs("div",{className:"relative flex-grow",children:[u.jsx(ks,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsx("input",{type:"text",id:"customerSearchTerm",value:t,onChange:_=>r(_.target.value),className:`${o$} pl-9`,placeholder:"Account No, Name, or Meter No."})]}),u.jsxs("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2.5 px-6 rounded-lg flex items-center justify-center sm:w-auto w-full",disabled:o,children:[o?u.jsx(St,{size:18,className:"animate-spin mr-2"}):u.jsx(Ps,{size:18,className:"mr-2"}),"Search Customer"]})]}),d&&u.jsx("p",{className:"text-red-600 text-xs mt-2",children:d})]}),o&&u.jsx(gn,{message:"Searching for customer..."}),!o&&i&&u.jsxs("div",{className:"mt-6 p-5 border border-blue-200 bg-blue-50 rounded-lg shadow-md animate-fadeIn",children:[u.jsx("h3",{className:"text-xl font-semibold text-blue-700 mb-4 border-b border-blue-200 pb-2",children:"Customer Details"}),u.jsxs("div",{className:"space-y-1",children:[u.jsx(g,{label:"Account Name",value:i.displayName,icon:ks}),u.jsx(g,{label:"Account Number",value:i.accountNumber,icon:Cs}),u.jsx(g,{label:"Email Address",value:i.email,icon:Sa}),u.jsx(g,{label:"Service Address",value:y(i.serviceAddress),icon:Oo}),u.jsx(g,{label:"Meter Serial No.",value:i.meterSerialNumber,icon:Yl}),u.jsx(g,{label:"Meter Size",value:i.meterSize,icon:Yl}),u.jsx(g,{label:"Service Type",value:i.serviceType,icon:An}),u.jsx(g,{label:"Account Status",value:i.accountStatus,icon:i.accountStatus==="Active"?Is:Xt})]})]})]})},l$=({userData:n,showNotification:e,setActiveSection:t,db:r})=>{const[i,s]=ee.useState({paymentsTodayCount:0,totalCollectedToday:0,avgPaymentAmount:0}),[o,l]=ee.useState([]),[d,f]=ee.useState(!0),[m,y]=ee.useState(""),g=ee.useCallback(async()=>{if(!n||!n.uid){f(!1),y("Clerk user data is not available.");return}f(!0),y("");try{const w=await B8(r,n.uid);if(w.success&&w.data){const{paymentsTodayCount:S,totalCollectedToday:N,transactions:P}=w.data,I=P.reduce((R,U)=>{const j=U.paymentMethod||"Other";return R[j]=(R[j]||0)+(U.amountPaid||0),R},{});s({paymentsTodayCount:S,totalCollectedToday:N,avgPaymentAmount:S>0?N/S:0,paymentMethodSummary:I}),l(P)}else y(w.error||"Today's payment data unavailable.")}catch{y("Could not load clerk dashboard statistics. Please try refreshing.")}finally{f(!1)}},[n,r]);ee.useEffect(()=>{g()},[g]);const _=()=>{const w=document.getElementById("eod-report-content");if(w){const S=window.open("","","height=800,width=1000");S.document.write("<html><head><title>Cashier Daily Collection Report</title>"),S.document.write('<script src="https://cdn.tailwindcss.com"><\/script>'),S.document.write(`
                <style>
                    body { 
                        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; 
                        -webkit-print-color-adjust: exact !important; 
                        print-color-adjust: exact !important; 
                        color: #1a202c;
                        font-size: 10pt;
                    }
                    .printable-area { 
                        max-width: 800px; 
                        margin: auto; 
                        padding: 2.5rem; 
                    }
                    .report-header { 
                        text-align: center; 
                        border-bottom: 2px solid #2d3748; 
                        padding-bottom: 1rem; 
                    }
                    .report-header .logo { 
                        font-size: 2.25rem; 
                        font-weight: 700; 
                        color: #2b6cb0 !important; 
                        margin: 0; 
                    }
                    .report-header .tagline { 
                        font-size: 0.875rem; 
                        color: #4299e1 !important; 
                        font-style: italic; 
                    }
                    .report-header h1.report-title { 
                        font-size: 1.5rem; 
                        font-weight: 600; 
                        color: #1a202c !important; 
                        margin-top: 0.5rem; 
                        margin-bottom: 0; 
                    }
                    .report-section { 
                        margin-top: 1.5rem; 
                        page-break-inside: avoid;
                    }
                    .report-section h2 { 
                        font-size: 1.25rem; 
                        font-weight: 600; 
                        border-bottom: 1px solid #718096; 
                        padding-bottom: 0.25rem; 
                        margin-bottom: 1rem; 
                        color: #2d3748 !important;
                    }
                    .info-table { 
                        width: 100%; 
                        font-size: 10pt;
                    }
                    .info-table td { 
                        padding: 4px 0; 
                        vertical-align: top;
                    }
                    .info-table td:nth-child(odd) { 
                        font-weight: 600; 
                        color: #4a5568 !important; 
                        width: auto; 
                        white-space: nowrap; 
                        padding-right: 1rem; 
                    }
                    .summary-grid { 
                        display: grid; 
                        grid-template-columns: repeat(3, 1fr); 
                        gap: 1.5rem; 
                    }
                    .summary-card { 
                        background-color: #f7fafc !important; 
                        border: 1px solid #e2e8f0; 
                        padding: 1.25rem; 
                        border-radius: 0.5rem; 
                        text-align: center; 
                    }
                    .summary-card p { 
                        margin: 0; 
                        font-size: 0.875rem; 
                        font-weight: 500;
                        text-transform: uppercase; 
                        color: #4a5568 !important; 
                    }
                    .summary-card span { 
                        font-size: 1.875rem; 
                        font-weight: 700; 
                        color: #1a202c !important; 
                        display: block; 
                        margin-top: 0.25rem;
                    }
                    table.data-table { 
                        width: 100%; 
                        border-collapse: collapse; 
                        margin-top: 1rem; 
                        font-size: 9.5pt;
                    }
                    .data-table th, .data-table td { 
                        border: 1px solid #e2e8f0; 
                        padding: 0.5rem 0.75rem; 
                        text-align: left; 
                    }
                    .data-table th { 
                        background-color: #f7fafc !important; 
                        font-weight: 600; 
                        text-transform: uppercase;
                        font-size: 0.75rem;
                        color: #4a5568 !important;
                    }
                    .data-table .text-right { text-align: right; }
                    .data-table .font-mono { font-family: "Courier New", Courier, monospace; }
                    .data-table .font-semibold { font-weight: 600; }
                    .data-table .total-row td {
                        font-weight: 700;
                        font-size: 1.125rem;
                        background-color: #f7fafc !important;
                        border-top: 2px solid #718096;
                    }
                    .report-footer { 
                        margin-top: 4rem; 
                        padding-top: 2rem; 
                        border-top: 1px solid #9ca3af; 
                    }
                    .signature-line { 
                        width: 60%; 
                        margin: 2rem auto 0 auto; 
                        border-top: 1px solid #333; 
                        padding-top: 8px; 
                        text-align: center; 
                    }
                    @media print {
                        .no-print { display: none !important; }
                        body { margin: 0; font-size: 10pt; }
                        .printable-area { padding: 0.5rem; }
                        .summary-grid { grid-template-columns: repeat(3, 1fr); }
                    }
                </style>
            `),S.document.write('</head><body><div class="printable-area">'),S.document.write(w.innerHTML),S.document.write("</div></body></html>"),S.document.close(),setTimeout(()=>S.print(),500)}},E=[{title:"Process Walk-in Payment",icon:Wg,section:"walkInPayments",description:"Record payments for customers paying in person at the counter.",color:"blue"},{title:"Search Account / Bill",icon:Xb,section:"searchAccountOrBill",description:"Look up customer account details, outstanding bills, or payment history.",color:"teal"}],x=()=>u.jsx("span",{className:"font-bold",children:""});return d?u.jsx(gn,{message:"Loading clerk dashboard...",className:"mt-10 h-48"}):u.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[u.jsx("div",{className:"p-6 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl shadow-xl no-print",children:u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl sm:text-3xl font-bold",children:"Clerk / Cashier Dashboard"}),u.jsxs("p",{className:"mt-1 text-indigo-100",children:["Welcome, ",n.displayName||"Clerk","! Manage payments and customer inquiries."]})]}),u.jsxs("button",{onClick:g,className:"mt-3 sm:mt-0 text-sm flex items-center bg-indigo-400 hover:bg-indigo-300 text-white font-medium py-2 px-3 rounded-lg transition-colors disabled:opacity-70 self-start sm:self-center",disabled:d,title:"Refresh Statistics",children:[d?u.jsx(St,{size:16,className:"animate-spin"}):u.jsx(ja,{size:16}),u.jsx("span",{className:"ml-2 hidden sm:inline",children:"Refresh"})]})]})}),m&&u.jsxs("p",{className:"text-sm text-yellow-600 bg-yellow-50 p-3 rounded-md text-center my-4 flex items-center justify-center gap-2 no-print",children:[u.jsx(An,{size:16})," ",m]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 no-print",children:[u.jsx(di,{title:"Payments Today",value:i.paymentsTodayCount,icon:Wg,borderColor:"border-green-500",iconColor:"text-green-500",onClick:()=>{var w;return(w=document.getElementById("eod-report-wrapper"))==null?void 0:w.scrollIntoView({behavior:"smooth"})}}),u.jsx(di,{title:"Total Collected Today",value:`${i.totalCollectedToday.toLocaleString("en-US",{minimumFractionDigits:2})}`,icon:x,borderColor:"border-emerald-500",iconColor:"text-emerald-500"}),u.jsx(di,{title:"Avg. Payment Today",value:`${i.avgPaymentAmount.toLocaleString("en-US",{minimumFractionDigits:2})}`,icon:x,borderColor:"border-teal-500",iconColor:"text-teal-500"})]}),u.jsxs("div",{className:"no-print",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-5 mt-8 pt-5 border-t border-gray-200",children:"Primary Tasks"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:E.map(w=>u.jsxs("button",{onClick:()=>t(w.section),className:`p-6 bg-white rounded-xl shadow-lg hover:shadow-2xl transform hover:-translate-y-1.5 transition-all duration-300 ease-in-out text-left focus:outline-none focus:ring-2 focus:ring-${w.color}-500 focus:ring-opacity-75 group h-full flex flex-col`,children:[u.jsx("div",{className:`p-3 bg-${w.color}-100 rounded-full inline-block mb-3 self-start group-hover:scale-110 transition-transform`,children:u.jsx(w.icon,{size:28,className:`text-${w.color}-600`})}),u.jsx("h4",{className:`text-lg font-semibold text-gray-800 group-hover:text-${w.color}-700 transition-colors`,children:w.title}),u.jsx("p",{className:"text-sm text-gray-500 mt-1 leading-normal flex-grow",children:w.description})]},w.section))})]}),u.jsxs("div",{id:"eod-report-wrapper",className:"mt-8 p-3 sm:p-5 bg-gray-50 rounded-xl shadow",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4 no-print",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-700 flex items-center",children:[u.jsx(Ss,{size:20,className:"mr-2 text-gray-500"})," Shift Summary / End-of-Day Report"]}),u.jsxs("button",{onClick:_,className:"flex items-center bg-blue-500 text-white text-xs font-semibold px-3 py-1.5 rounded-lg hover:bg-blue-600 transition-colors",children:[u.jsx(r2,{size:14,className:"mr-1.5"})," Print Report"]})]}),u.jsxs("div",{id:"eod-report-content",className:"bg-white p-6 sm:p-10 rounded-lg border border-gray-200 text-gray-800 text-[10pt] leading-normal printable-area",children:[u.jsxs("div",{className:"report-header text-center border-b-2 border-gray-700 pb-4",children:[u.jsx("h1",{className:"logo text-3xl font-bold text-blue-700",children:"AGWA"}),u.jsx("p",{className:"tagline text-sm text-blue-600 italic",children:"Ensuring Clarity, Sustaining Life."}),u.jsx("h1",{className:"report-title text-2xl font-semibold text-gray-800 mt-2",children:"CASHIER'S DAILY COLLECTION REPORT"})]}),u.jsx("div",{className:"report-section mt-6",children:u.jsx("table",{className:"info-table w-full",children:u.jsxs("tbody",{children:[u.jsxs("tr",{className:"!border-none",children:[u.jsx("td",{className:"font-semibold text-gray-600 !pr-4 !border-none !p-1",children:"Cashier Name:"}),u.jsx("td",{className:"font-medium !border-none !p-1",children:n.displayName}),u.jsx("td",{className:"font-semibold text-gray-600 !pr-4 !border-none !p-1",children:"Report Date:"}),u.jsx("td",{className:"font-medium !border-none !p-1",children:Zt(new Date,{year:"numeric",month:"long",day:"numeric"})})]}),u.jsxs("tr",{className:"!border-none",children:[u.jsx("td",{className:"font-semibold text-gray-600 !pr-4 !border-none !p-1",children:"Cashier ID:"}),u.jsx("td",{className:"font-mono !border-none !p-1",children:n.accountNumber||n.uid.substring(0,10)}),u.jsx("td",{className:"font-semibold text-gray-600 !pr-4 !border-none !p-1",children:"Time Generated:"}),u.jsx("td",{className:"font-medium !border-none !p-1",children:Zt(new Date,{hour:"2-digit",minute:"2-digit",hour12:!0})})]})]})})}),u.jsxs("section",{className:"report-section mt-8",children:[u.jsx("h2",{className:"text-lg font-semibold border-b border-gray-300 pb-2 mb-4 text-gray-700",children:"Collection Summary"}),u.jsxs("div",{className:"summary-grid grid grid-cols-1 sm:grid-cols-3 gap-4",children:[u.jsxs("div",{className:"summary-card bg-gray-50 border border-gray-200 p-4 rounded-lg text-center",children:[u.jsx("p",{className:"text-sm font-medium text-gray-500 uppercase",children:"Total Collected"}),u.jsxs("span",{className:"text-2xl font-bold text-gray-800",children:["",i.totalCollectedToday.toLocaleString("en-US",{minimumFractionDigits:2})]})]}),u.jsxs("div",{className:"summary-card bg-gray-50 border border-gray-200 p-4 rounded-lg text-center",children:[u.jsx("p",{className:"text-sm font-medium text-gray-500 uppercase",children:"Total Transactions"}),u.jsx("span",{className:"text-2xl font-bold text-gray-800",children:i.paymentsTodayCount})]}),u.jsxs("div",{className:"summary-card bg-gray-50 border border-gray-200 p-4 rounded-lg text-center",children:[u.jsx("p",{className:"text-sm font-medium text-gray-500 uppercase",children:"Average Transaction"}),u.jsxs("span",{className:"text-2xl font-bold text-gray-800",children:["",i.avgPaymentAmount.toLocaleString("en-US",{minimumFractionDigits:2})]})]})]})]}),i.paymentMethodSummary&&Object.keys(i.paymentMethodSummary).length>0&&u.jsxs("section",{className:"report-section mt-8",children:[u.jsx("h2",{className:"text-lg font-semibold border-b border-gray-300 pb-2 mb-4 text-gray-700",children:"Breakdown by Payment Method"}),u.jsxs("table",{className:"data-table w-full border-collapse text-sm",children:[u.jsx("thead",{className:"bg-gray-100",children:u.jsxs("tr",{children:[u.jsx("th",{className:"border p-2 text-left text-xs font-semibold text-gray-600 uppercase",children:"Payment Method"}),u.jsx("th",{className:"border p-2 text-right text-xs font-semibold text-gray-600 uppercase",children:"Total Amount (PHP)"})]})}),u.jsxs("tbody",{children:[Object.entries(i.paymentMethodSummary).map(([w,S])=>u.jsxs("tr",{className:"border-b",children:[u.jsx("td",{className:"border p-2.5",children:w}),u.jsxs("td",{className:"border p-2.5 text-right font-semibold",children:["",S.toLocaleString("en-US",{minimumFractionDigits:2})]})]},w)),u.jsxs("tr",{className:"total-row bg-gray-100",children:[u.jsx("td",{className:"border p-3 font-bold text-base",children:"GRAND TOTAL"}),u.jsxs("td",{className:"border p-3 text-right font-bold text-base",children:["",i.totalCollectedToday.toLocaleString("en-US",{minimumFractionDigits:2})]})]})]})]})]}),u.jsxs("section",{className:"report-section mt-8",children:[u.jsx("h2",{className:"text-lg font-semibold border-b border-gray-300 pb-2 mb-4 text-gray-700",children:"Transaction Log (Today)"}),o.length>0?u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"data-table w-full border-collapse text-sm",children:[u.jsx("thead",{className:"bg-gray-100",children:u.jsxs("tr",{children:[u.jsx("th",{className:"border p-2 text-left text-xs font-semibold text-gray-600 uppercase",children:"Time"}),u.jsx("th",{className:"border p-2 text-left text-xs font-semibold text-gray-600 uppercase",children:"Account #"}),u.jsx("th",{className:"border p-2 text-left text-xs font-semibold text-gray-600 uppercase",children:"Reference #"}),u.jsx("th",{className:"border p-2 text-right text-xs font-semibold text-gray-600 uppercase",children:"Amount (PHP)"})]})}),u.jsx("tbody",{children:o.map(w=>{var S,N;return u.jsxs("tr",{className:"border-b",children:[u.jsx("td",{className:"border p-2.5 whitespace-nowrap",children:Zt((S=w.paymentTimestamp)==null?void 0:S.toDate(),{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})}),u.jsx("td",{className:"border p-2.5 whitespace-nowrap font-mono",children:w.accountNumber}),u.jsx("td",{className:"border p-2.5 whitespace-nowrap font-mono",children:w.paymentReference}),u.jsxs("td",{className:"border p-2.5 whitespace-nowrap text-right font-semibold",children:["",(N=w.amountPaid)==null?void 0:N.toFixed(2)]})]},w.id)})})]})}):u.jsxs("div",{className:"text-center py-10 bg-gray-50 rounded-md border",children:[u.jsx(An,{size:32,className:"mx-auto text-gray-400 mb-2"}),u.jsx("p",{className:"text-gray-500",children:"No payments have been processed yet today."})]})]}),u.jsx("footer",{className:"report-footer mt-16 pt-8 border-t border-gray-400",children:u.jsxs("div",{className:"signature-line w-3/5 mx-auto border-t border-gray-700 pt-2 text-center",children:[u.jsx("p",{className:"text-sm font-semibold",children:n.displayName}),u.jsx("p",{className:"text-xs text-gray-600",children:"Cashier's Signature Over Printed Name"})]})})]})]}),u.jsx("style",{children:`
                    .printable-area { 
                        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; 
                        color: #1a202c;
                    }
                    .report-header { 
                        text-align: center; 
                        border-bottom: 2px solid #2d3748; 
                        padding-bottom: 1rem; 
                    }
                    .report-header .logo { 
                        font-size: 2.25rem; 
                        font-weight: 700; 
                        color: #2b6cb0; 
                        margin: 0; 
                    }
                    .report-header .tagline { 
                        font-size: 0.875rem; 
                        color: #4299e1; 
                        font-style: italic; 
                    }
                    .report-header .report-title { 
                        font-size: 1.5rem; 
                        font-weight: 600; 
                        color: #1a202c; 
                        margin-top: 0.5rem; 
                        margin-bottom: 0; 
                    }
                    .report-section { 
                        margin-top: 1.5rem; 
                    }
                    .report-section h2 { 
                        font-size: 1.25rem; 
                        font-weight: 600; 
                        border-bottom: 1px solid #718096; 
                        padding-bottom: 0.25rem; 
                        margin-bottom: 1rem; 
                        color: #2d3748;
                    }
                    .info-table { 
                        width: 100%; 
                    }
                    .info-table td { 
                        padding: 4px 0; 
                        vertical-align: top;
                    }
                    .info-table td:nth-child(odd) { 
                        font-weight: 600; 
                        color: #4a5568; 
                        width: auto; 
                        white-space: nowrap; 
                        padding-right: 1rem; 
                    }
                    .summary-grid { 
                        display: grid; 
                        grid-template-columns: repeat(1, 1fr);
                    }
                    @media (min-width: 640px) {
                        .summary-grid { 
                            grid-template-columns: repeat(3, 1fr); 
                        }
                    }
                    .summary-card { 
                        background-color: #f7fafc; 
                        border: 1px solid #e2e8f0; 
                        padding: 1.25rem; 
                        border-radius: 0.5rem; 
                        text-align: center; 
                    }
                    .summary-card p { 
                        margin: 0; 
                        font-size: 0.875rem; 
                        font-weight: 500;
                        text-transform: uppercase; 
                        color: #4a5568; 
                    }
                    .summary-card span { 
                        font-size: 1.875rem; 
                        font-weight: 700; 
                        color: #1a202c; 
                        display: block; 
                        margin-top: 0.25rem;
                    }
                    table.data-table { 
                        width: 100%; 
                        border-collapse: collapse; 
                        margin-top: 1rem; 
                    }
                    .data-table th, .data-table td { 
                        border: 1px solid #e2e8f0; 
                        padding: 0.5rem 0.75rem; 
                        text-align: left; 
                    }
                    .data-table th { 
                        background-color: #f7fafc; 
                        font-weight: 600; 
                        text-transform: uppercase;
                        font-size: 0.75rem;
                        color: #4a5568;
                    }
                    .data-table .text-right { text-align: right; }
                    .data-table .font-mono { font-family: "Courier New", Courier, monospace; }
                    .data-table .font-semibold { font-weight: 600; }
                    .data-table .total-row td {
                        font-weight: 700;
                        font-size: 1.125rem;
                        background-color: #f7fafc;
                        border-top: 2px solid #718096;
                    }
                    .report-footer { 
                        margin-top: 4rem; 
                        padding-top: 2rem; 
                        border-top: 1px solid #9ca3af; 
                    }
                    .signature-line { 
                        width: 60%; 
                        margin: 2rem auto 0 auto; 
                        border-top: 1px solid #333; 
                        padding-top: 8px; 
                        text-align: center; 
                    }
                `})]})},Uh="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",c$=({db:n,userData:e,showNotification:t,billingService:r})=>{const[i,s]=ee.useState(""),[o,l]=ee.useState(null),[d,f]=ee.useState([]),[m,y]=ee.useState(null),[g,_]=ee.useState(""),[E,x]=ee.useState("Cash"),[w,S]=ee.useState(""),[N,P]=ee.useState(!1),[I,R]=ee.useState(!1),[U,j]=ee.useState(!1),[k,F]=ee.useState(null),[O,C]=ee.useState(""),D=async ie=>{if(ie&&ie.preventDefault(),!i.trim()){t("Please enter an Account Number to search.","warning");return}P(!0),C(""),l(null),f([]),y(null),_(""),F(null);try{const X=await Fy(n,i.trim());if(X.success&&X.data.length>0){const Y=X.data.find(B=>B.accountNumber.toLowerCase()===i.trim().toLowerCase());Y?(l(Y),M(Y.id,Y.accountNumber)):C(`No customer found with Account Number: "${i}".`)}else C(`No customer found with Account Number: "${i}".`)}catch{C("An error occurred during customer search.")}P(!1)},M=async(ie,X)=>{R(!0);const Y=await vm(n,ie);if(Y.success){const B=Y.data.filter(Z=>Z.status==="Unpaid").sort((Z,te)=>{var se,ae;return new Date(((se=Z.dueDate)==null?void 0:se.toDate())||0)-new Date(((ae=te.dueDate)==null?void 0:ae.toDate())||0)});f(B),B.length===0&&t(`No unpaid bills found for Account #${X}.`,"info")}else t(Y.error||"Failed to fetch customer bills.","error");R(!1)};ee.useEffect(()=>{var ie;if(m)_(((ie=m.amount)==null?void 0:ie.toFixed(2))||"");else if(d.length===0)_("");else if(d.length>0&&!d.find(X=>X.id===(m==null?void 0:m.id))){const X=d.reduce((Y,B)=>Y+(B.amount||0),0);_(X>0?X.toFixed(2):"")}},[m,d]);const $=async ie=>{if(ie.preventDefault(),!m&&d.length===0){t("No bill selected or available for payment.","warning");return}const X=parseFloat(g);if(isNaN(X)||X<=0){t("Please enter a valid payment amount.","warning");return}if(E!=="Cash"&&!w.trim()){t("Reference number is required for this payment method.","warning");return}j(!0),F(null);const Y=m||d.find(B=>B.status==="Unpaid");if(!Y){t("Cannot determine which bill to pay. Please select a bill.","warning"),j(!1);return}try{const B=Hn(),Z=new Date,te=await M8(n,Y.id,{status:"Paid",paymentDate:Z,paymentTimestamp:B,amountPaid:X,paymentMethod:E,paymentReference:w.trim()||`CASH-${Date.now().toString().slice(-8)}`,processedByClerkId:e.uid,processedByClerkName:e.displayName});if(!te.success)throw new Error(te.error||"Failed to update bill status.");const se={customerName:o.displayName,accountNumber:o.accountNumber,serviceAddress:o.serviceAddress,billId:Y.id,billMonthYear:Y.monthYear||Y.billingPeriod,amountPaid:X,paymentDate:Z,paymentMethod:E,referenceNumber:w.trim()||`CASH-${Date.now().toString().slice(-8)}`,processedBy:e.displayName,receiptId:`OR-${Date.now()}`};F(se),t(`Payment of ${X.toFixed(2)} processed successfully!`,"success"),_(""),S(""),y(null),M(o.id,o.accountNumber)}catch(B){t(B.message||"An error occurred while processing the payment.","error")}j(!1)},G=()=>{const ie=document.getElementById("payment-receipt-content");if(ie){const X=window.open("","_blank","height=800,width=1000");X.document.write("<html><head><title>AGWA Payment Receipt</title>"),X.document.write('<script src="https://cdn.tailwindcss.com"><\/script>'),X.document.write(`
                <style>
                    body { font-family: 'Inter', sans-serif; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                    .paid-stamp {
                        position: absolute;
                        top: 50%;
                        left: 50%;
                        transform: translate(-50%, -50%) rotate(-30deg);
                        font-size: 4rem;
                        font-weight: bold;
                        color: rgba(0, 128, 0, 0.15);
                        z-index: -1;
                        letter-spacing: 0.1em;
                        border: 8px solid rgba(0, 128, 0, 0.15);
                        padding: 0.5em 1em;
                        border-radius: 10px;
                        text-transform: uppercase;
                    }
                    .no-print { display: none; }
                </style>
            `),X.document.write('</head><body class="bg-gray-100 p-4">'),X.document.write(ie.innerHTML),X.document.write("</body></html>"),X.document.close(),setTimeout(()=>X.print(),700)}},re=["Cash","Check","Card (Debit/Credit)","E-wallet (GCash/Maya)"],oe=({label:ie,value:X})=>u.jsxs("div",{className:"flex justify-between py-1.5 text-sm border-b border-gray-200 last:border-b-0",children:[u.jsxs("span",{className:"text-gray-500",children:[ie,":"]}),u.jsx("span",{className:"font-medium text-gray-800 text-right",children:X})]});return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[!k&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(Wg,{size:30,className:"mr-3 text-green-600"})," Process Walk-in Payment"]})}),u.jsxs("form",{onSubmit:D,className:"mb-6 p-4 bg-gray-50 rounded-lg shadow",children:[u.jsx("label",{htmlFor:"accountNumberSearch",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Customer by Account Number"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[u.jsxs("div",{className:"relative flex-grow",children:[u.jsx(Cs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsx("input",{type:"text",id:"accountNumberSearch",value:i,onChange:ie=>s(ie.target.value),className:`${Uh} pl-9`,placeholder:"Enter Account Number"})]}),u.jsxs("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2.5 px-5 rounded-lg flex items-center justify-center sm:w-auto w-full",disabled:N,children:[N?u.jsx(St,{size:18,className:"animate-spin mr-2"}):u.jsx(Ps,{size:18,className:"mr-2"})," Find Customer"]})]}),O&&!N&&u.jsx("p",{className:"text-red-500 text-xs mt-2",children:O})]})]}),N&&u.jsx(gn,{message:"Searching for customer..."}),o&&!k&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"mb-6 p-4 border border-blue-200 bg-blue-50 rounded-lg shadow",children:[u.jsxs("h3",{className:"text-lg font-semibold text-blue-700 mb-2 flex items-center",children:[u.jsx(ks,{size:20,className:"mr-2"})," ",o.displayName,u.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["(",o.accountNumber,")"]})]}),I&&u.jsx(gn,{message:"Loading bills..."}),!I&&d.length===0&&u.jsx("p",{className:"text-sm text-green-600 mt-2",children:"No unpaid bills found for this customer."}),!I&&d.length>0&&u.jsxs("div",{className:"mt-3",children:[u.jsx("label",{htmlFor:"selectBill",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Bill to Pay (or pay total outstanding):"}),u.jsxs("select",{id:"selectBill",className:Uh,value:m?m.id:"",onChange:ie=>{const X=d.find(Y=>Y.id===ie.target.value);y(X||null)},children:[u.jsx("option",{value:"",children:"Pay Total Unpaid / Select Specific Bill"}),d.map(ie=>{var X,Y;return u.jsxs("option",{value:ie.id,children:[ie.monthYear||ie.billingPeriod," - ",(X=ie.amount)==null?void 0:X.toFixed(2)," (Due: ",Zt((Y=ie.dueDate)==null?void 0:Y.toDate(),{month:"short",day:"numeric"}),")"]},ie.id)})]})]})]}),(d.length>0||m)&&u.jsxs("form",{onSubmit:$,className:"space-y-5 p-4 border border-gray-200 rounded-lg",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-1",children:"Payment Details"}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"paymentAmount",className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount to Pay (PHP) *"}),u.jsxs("div",{className:"relative",children:[u.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:""}),u.jsx("input",{type:"number",id:"paymentAmount",value:g,onChange:ie=>_(ie.target.value),className:`${Uh} pl-7`,step:"0.01",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"paymentMethod",className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),u.jsx("select",{id:"paymentMethod",value:E,onChange:ie=>x(ie.target.value),className:Uh,required:!0,children:re.map(ie=>u.jsx("option",{value:ie,children:ie},ie))})]}),E!=="Cash"&&u.jsxs("div",{children:[u.jsx("label",{htmlFor:"referenceNumber",className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference / Transaction No. *"}),u.jsx("input",{type:"text",id:"referenceNumber",value:w,onChange:ie=>S(ie.target.value),className:Uh,placeholder:"e.g., Check No., Card Approval Code",required:!0})]}),u.jsxs("button",{type:"submit",className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-2.5 px-5 rounded-lg flex items-center justify-center transition-colors active:scale-95",disabled:U||!g||parseFloat(g)<=0,children:[U?u.jsx(St,{size:20,className:"animate-spin mr-2"}):u.jsx(Is,{size:20,className:"mr-2"}),U?"Processing...":"Process Payment"]})]})]}),k&&u.jsxs("div",{className:"mt-6 p-6 bg-green-50 rounded-lg",children:[u.jsxs("div",{className:"text-center mb-5",children:[u.jsx(Is,{size:48,className:"mx-auto text-green-500 mb-2"}),u.jsx("h3",{className:"text-2xl font-semibold text-green-800",children:"Payment Successful!"}),u.jsx("p",{className:"text-sm text-gray-600",children:"Official Receipt has been generated."})]}),u.jsxs("div",{id:"payment-receipt-content",className:"p-6 bg-white rounded-lg shadow-lg max-w-2xl mx-auto font-sans relative overflow-hidden",children:[u.jsx("div",{className:"paid-stamp",children:"PAID"}),u.jsxs("div",{className:"flex justify-between items-start mb-5 pb-4 border-b-2 border-blue-700",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-3xl font-bold text-blue-700",children:"AGWA"}),u.jsx("div",{className:"text-xs text-blue-600 italic",children:"Ensuring Clarity, Sustaining Life."})]}),u.jsxs("div",{className:"text-right text-xs",children:[u.jsx("p",{className:"font-semibold",children:"AGWA Water Services, Inc."}),u.jsx("p",{children:"123 Aqua Drive, Hydro Business Park"}),u.jsx("p",{children:"Naic, Cavite, Philippines 4110"})]})]}),u.jsxs("div",{className:"text-center mb-6",children:[u.jsx("h4",{className:"text-xl font-bold text-gray-800",children:"OFFICIAL RECEIPT"}),u.jsxs("p",{className:"text-sm text-gray-500",children:["Receipt No: ",k.receiptId]})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx(oe,{label:"Received From",value:k.customerName}),u.jsx(oe,{label:"Account Number",value:k.accountNumber})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx(oe,{label:"Payment For",value:`Water Bill - ${k.billMonthYear}`}),u.jsx(oe,{label:"Payment Date",value:Zt(k.paymentDate,{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})}),u.jsx(oe,{label:"Payment Method",value:k.paymentMethod}),k.referenceNumber&&!k.referenceNumber.startsWith("CASH-")&&u.jsx(oe,{label:"Reference No.",value:k.referenceNumber})]}),u.jsxs("div",{className:"mt-4 p-3 bg-gray-100 rounded-lg flex justify-between items-center",children:[u.jsx("span",{className:"text-lg font-semibold text-gray-800",children:"AMOUNT PAID"}),u.jsxs("span",{className:"text-2xl font-bold text-green-600",children:["",k.amountPaid.toFixed(2)]})]}),u.jsx("div",{className:"mt-4 pt-4 border-t border-dashed",children:u.jsx(LP,{value:k.receiptId})}),u.jsxs("div",{className:"text-xs text-gray-500 mt-4",children:[u.jsxs("p",{children:["Cashier: ",k.processedBy]}),u.jsx("p",{children:"This is a system-generated receipt. Thank you for your payment."})]})]}),u.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-3 mt-6 no-print",children:[u.jsxs("button",{onClick:G,className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg flex items-center justify-center",children:[u.jsx(r2,{size:18,className:"mr-2"})," Print Receipt"]}),u.jsx("button",{onClick:()=>{F(null),s(""),l(null),f([]),y(null)},className:"bg-gray-600 hover:bg-gray-700 text-white font-medium py-2 px-4 rounded-lg flex items-center justify-center",children:"Process Another Payment"})]})]})]})},u$=({db:n,showNotification:e,billingService:t})=>{var k;const[r,i]=ee.useState("account"),[s,o]=ee.useState(""),[l,d]=ee.useState(null),[f,m]=ee.useState([]),[y,g]=ee.useState(!1),[_,E]=ee.useState(""),[x,w]=ee.useState(null),[S,N]=ee.useState(null),P="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition-150 text-sm placeholder-gray-400",I=async F=>{if(F.preventDefault(),!s.trim()){e("Please enter a search term.","warning");return}g(!0),E(""),d(null),m([]),w(null),N(null);try{if(r==="account"){const O=await Fy(n,s.trim());if(O.success&&O.data.length>0){const C=O.data[0];d(C);const D=await vm(n,C.id);D.success?m(D.data.sort((M,$)=>{var G,re;return(((G=$.billDate)==null?void 0:G.toDate())||0)-(((re=M.billDate)==null?void 0:re.toDate())||0)})):e("Could not fetch bills for the user.","warning")}else O.success?E(`No account found matching "${s}".`):E(O.error||"Failed to search accounts.")}else{const O=await V8(n,(void 0)(),[where("id","==",s.trim())]);if(O.success&&O.data.length>0){const C=O.data[0];if(d(C),C.userId){const D=await Hg(n,C.userId);D.success&&N(D.data)}}else O.success?E(`No bill found matching invoice/bill ID "${s}".`):E(O.error||"Failed to search bills.")}}catch{E("An error occurred during the search.")}g(!1)},R=(F,O)=>{w(F),N(O||(l&&r==="account"?l:null))},U=F=>!F||typeof F!="object"?F||"N/A":[F.street,F.barangay,F.district,"Naic, Cavite"].filter(C=>C&&C.trim()).join(", "),j=({label:F,value:O,icon:C,valueClass:D="text-gray-800"})=>u.jsxs("div",{className:"flex items-start py-1.5",children:[C&&u.jsx(C,{size:16,className:"mr-2.5 text-blue-500 flex-shrink-0 mt-0.5"}),u.jsxs("span",{className:"text-xs font-medium text-gray-500 w-32 sm:w-40",children:[F,":"]}),u.jsx("span",{className:`text-sm ${D} flex-1 break-words`,children:O||"N/A"})]});return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(Xb,{size:30,className:"mr-3 text-indigo-600"})," Search Account / Bill"]})}),u.jsxs("form",{onSubmit:I,className:"mb-6 p-4 bg-gray-50 rounded-lg shadow",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-end",children:[u.jsxs("div",{className:"flex-grow",children:[u.jsx("label",{htmlFor:"searchType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search For"}),u.jsxs("select",{id:"searchType",value:r,onChange:F=>{i(F.target.value),o(""),d(null),m([]),E("")},className:P,children:[u.jsx("option",{value:"account",children:"Customer Account"}),u.jsx("option",{value:"bill",children:"Specific Bill (Invoice #)"})]})]}),u.jsxs("div",{className:"flex-grow-[2]",children:[u.jsx("label",{htmlFor:"searchTerm",className:"block text-sm font-medium text-gray-700 mb-1",children:r==="account"?"Account No, Name, or Email":"Invoice Number or Bill ID"}),u.jsxs("div",{className:"relative",children:[u.jsx(Ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsx("input",{type:"text",id:"searchTerm",value:s,onChange:F=>o(F.target.value),className:`${P} pl-9`,placeholder:`Enter ${r==="account"?"details...":"invoice #..."}`})]})]}),u.jsxs("button",{type:"submit",className:"bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2.5 px-6 rounded-lg flex items-center justify-center sm:w-auto w-full transition-colors",disabled:y,children:[y?u.jsx(St,{size:18,className:"animate-spin mr-2"}):u.jsx(Ps,{size:18,className:"mr-2"}),"Search"]})]}),_&&!y&&u.jsx("p",{className:"text-red-500 text-xs mt-2",children:_})]}),y&&u.jsx(gn,{message:"Searching..."}),!y&&l&&u.jsxs("div",{className:"mt-6 p-5 border border-indigo-200 bg-indigo-50 rounded-lg shadow-md animate-fadeIn",children:[r==="account"&&u.jsxs(u.Fragment,{children:[u.jsx("h3",{className:"text-xl font-semibold text-indigo-700 mb-3 border-b border-indigo-200 pb-2",children:"Account Details"}),u.jsxs("div",{className:"space-y-1 mb-4",children:[u.jsx(j,{label:"Name",value:l.displayName,icon:ks}),u.jsx(j,{label:"Account No",value:l.accountNumber,icon:Cs,valueClass:"font-mono"}),u.jsx(j,{label:"Email",value:l.email,icon:Sa}),u.jsx(j,{label:"Status",value:l.accountStatus,icon:An,valueClass:`font-semibold ${l.accountStatus==="Active"?"text-green-600":"text-red-600"}`}),u.jsx(j,{label:"Service Address",value:U(l.serviceAddress),icon:Oo})]}),u.jsxs("h4",{className:"text-md font-semibold text-indigo-600 mt-4 mb-2",children:["Recent Bills (",f.length,")"]}),f.length>0?u.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 pr-2",children:f.map(F=>{var O;return u.jsxs("div",{className:`p-2.5 border rounded-md flex justify-between items-center text-xs ${F.status==="Paid"?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[u.jsxs("div",{children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Period:"})," ",F.monthYear||F.billingPeriod]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Amount:"})," ",(O=F.amount)==null?void 0:O.toFixed(2)]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Due:"})," ",Zt(F.dueDate,{month:"short",day:"numeric",year:"numeric"})]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Status:"})," ",u.jsx("span",{className:`font-semibold ${F.status==="Paid"?"text-green-700":"text-red-700"}`,children:F.status})]})]}),u.jsxs("button",{onClick:()=>R(F,l),className:"text-indigo-600 hover:text-indigo-800 hover:bg-indigo-100 p-1.5 rounded-md text-xs",children:[u.jsx(Kl,{size:16,className:"inline mr-1"}),"View Invoice"]})]},F.id)})}):u.jsx("p",{className:"text-sm text-gray-500",children:"No bills found for this account."})]}),r==="bill"&&u.jsxs(u.Fragment,{children:[u.jsxs("h3",{className:"text-xl font-semibold text-indigo-700 mb-3 border-b border-indigo-200 pb-2",children:["Bill Details (Invoice: ",l.invoiceNumber||l.id,")"]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx(j,{label:"Account No",value:l.accountNumber,icon:Cs,valueClass:"font-mono"}),S&&u.jsx(j,{label:"Customer Name",value:S.displayName,icon:ks}),u.jsx(j,{label:"Bill Period",value:l.monthYear||l.billingPeriod,icon:au}),u.jsx(j,{label:"Amount Due",value:`${(k=l.amount)==null?void 0:k.toFixed(2)}`,icon:px,valueClass:"font-bold"}),u.jsx(j,{label:"Due Date",value:Zt(l.dueDate,{month:"long",day:"numeric",year:"numeric"}),icon:au}),u.jsx(j,{label:"Status",value:l.status,icon:An,valueClass:`font-semibold ${l.status==="Paid"?"text-green-600":"text-red-600"}`}),l.status==="Paid"&&u.jsx(j,{label:"Paid Date",value:Zt(l.paymentDate),icon:Is})]}),u.jsxs("button",{onClick:()=>R(l,S),className:"mt-4 bg-indigo-500 hover:bg-indigo-600 text-white font-medium py-2 px-4 rounded-lg flex items-center text-sm",children:[u.jsx(Kl,{size:16,className:"mr-2"})," View Full Invoice"]})]})]}),!y&&!l&&s&&!_&&u.jsxs("div",{className:"mt-6 p-5 text-center text-gray-500 bg-gray-50 rounded-lg",children:[u.jsx(An,{size:32,className:"mx-auto mb-2 text-gray-400"}),'No results found for "',s,'". Please refine your search.']}),x&&S&&u.jsx(UP,{isOpen:!!x,onClose:()=>{w(null)},bill:x,userData:S,calculateBillDetails:t})]})},d$=({db:n,user:e,userData:t,showNotification:r})=>{const[i,s]=ee.useState([]),[o,l]=ee.useState(!0),[d,f]=ee.useState(""),[m,y]=ee.useState({}),[g,_]=ee.useState(null),[E,x]=ee.useState(null),w=ee.useCallback(async()=>{l(!0),f("");const R=await uP(n,e.uid);R.success?s(R.data):(f(R.error||"Failed fetching tickets."),r(R.error||"Failed fetching tickets.","error")),l(!1)},[n,e.uid,r]);ee.useEffect(()=>{w()},[w]);const S=(R,U)=>{y(j=>({...j,[R]:U}))},N=async R=>{const U=m[R]||"";if(!U.replace(/<[^>]*>?/gm,"").trim()){r("Reply cannot be empty.","warning");return}_(R);const F={text:Mo.sanitize(U),authorId:e.uid,authorName:t.displayName||"Customer",authorRole:t.role||"customer",timestamp:Ot.now()},O=await cP(n,R,F);O.success?(r("Reply sent!","success"),y(C=>({...C,[R]:""})),w()):r(O.error||"Failed to send reply.","error"),_(null)},P=async R=>{const j=(m[R]||"").replace(/<[^>]*>?/gm,"").trim();if(!j){r("Write a draft or keywords first.","warning");return}x(R);const k=i.find(F=>F.id===R);if(!k){x(null);return}try{const F=(k.conversation||[]).map(C=>`${C.authorRole==="admin"?"Support":"You"}: ${C.text.replace(/<[^>]*>?/gm,"")}`).join(`

`),O=await RP({ticketDescription:k.description,conversationHistory:F,draftReply:j,customerName:t.displayName});S(R,O),r("AI refined your reply.","success")}catch(F){const O=(F==null?void 0:F.message)||"AI assistance failed.";r(O,"error")}finally{x(null)}},I=R=>{switch(R){case"Open":return"bg-red-100 text-red-700";case"In Progress":return"bg-yellow-100 text-yellow-700";case"Awaiting Customer":return"bg-blue-100 text-blue-700";case"Resolved":case"Closed":return"bg-green-100 text-green-700";default:return"bg-gray-100 text-gray-600"}};return o?u.jsx(gn,{message:"Loading your support tickets..."}):u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(Aa,{size:30,className:"mr-3 text-purple-600"})," My Support Tickets"]}),u.jsxs("button",{onClick:w,disabled:o,className:"flex items-center text-sm p-2 bg-gray-100 rounded-lg hover:bg-gray-200 border border-gray-300",children:[u.jsx(ja,{size:16,className:o?"animate-spin":""}),u.jsx("span",{className:"ml-1.5 hidden sm:inline",children:"Refresh"})]})]}),d&&u.jsx("div",{className:"text-red-500 bg-red-50 p-3 rounded-md text-center border border-red-200",children:d}),i.length===0&&!d&&u.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner border border-gray-200",children:[u.jsx(An,{size:48,className:"mx-auto text-gray-400 mb-4"}),u.jsx("p",{className:"text-gray-600 text-lg",children:"No support tickets found."}),u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Use 'Report an Issue' to create one."})]}),u.jsx("div",{className:"space-y-4",children:i.map(R=>u.jsxs("details",{className:"p-4 rounded-lg shadow-md border-l-4 bg-gray-50 border-purple-400 group hover:shadow-lg transition-shadow",children:[u.jsxs("summary",{className:"flex flex-wrap justify-between items-center gap-2 cursor-pointer list-none",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-md font-semibold text-gray-800",children:R.issueType||"Support Ticket"}),u.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["Submitted: ",Zt(R.submittedAt,{month:"short",day:"numeric",year:"2-digit"})]}),u.jsx(sy,{text:`Ticket ID: ${R.id}`,position:"bottom",children:u.jsxs("p",{className:"text-xs text-gray-400 font-mono mt-0.5 flex items-center",children:[u.jsx(Cs,{size:12,className:"mr-1"}),R.id.substring(0,8),"..."]})})]}),u.jsx("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full ${I(R.status)} shrink-0`,children:R.status||"Unknown"}),u.jsx("span",{className:"ml-auto transition-transform duration-300 transform group-open:rotate-180 text-purple-600",children:""})]}),u.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200 text-sm text-gray-700 space-y-4 grid grid-rows-[0fr] group-open:grid-rows-[1fr] transition-all duration-500 ease-in-out",children:u.jsxs("div",{className:"overflow-hidden space-y-4",children:[u.jsxs("div",{children:[u.jsx("strong",{className:"text-xs text-gray-500 block mb-1",children:"Your Initial Report:"}),u.jsx("div",{className:"p-2 bg-white border rounded-md whitespace-pre-line text-xs prose prose-xs max-w-none",children:R.description})]}),R.conversation&&R.conversation.length>0&&u.jsxs("div",{className:"space-y-2",children:[u.jsx("strong",{className:"text-xs text-gray-500 block mb-1",children:"Conversation:"}),u.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 border bg-white p-2 rounded-md scrollbar-thin",children:R.conversation.map((U,j)=>u.jsxs("div",{className:`p-2 rounded-lg text-xs ${U.authorRole==="admin"?"bg-blue-50":"bg-green-50"}`,children:[u.jsxs("p",{className:"font-bold text-gray-800",children:[U.authorName," (",U.authorRole,"):"]}),u.jsx("div",{className:"text-gray-700 prose prose-xs max-w-none break-words",dangerouslySetInnerHTML:{__html:Mo.sanitize(U.text||"")}}),u.jsx("p",{className:"text-right text-gray-500 mt-1",children:Zt(U.timestamp)})]},j))})]}),R.status!=="Resolved"&&R.status!=="Closed"&&u.jsxs("div",{className:"pt-2",children:[u.jsx("label",{className:"text-xs font-semibold text-gray-600 block mb-1",children:"Send a Reply:"}),u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx(t0,{value:m[R.id]||"",onChange:U=>S(R.id,U),placeholder:"Type your reply...",className:"flex-grow bg-white rounded-lg border border-gray-300 min-h-[100px]",readOnly:g===R.id||E===R.id}),u.jsx(sy,{text:"Refine draft with AI",children:u.jsx("button",{onClick:()=>P(R.id),className:"p-2 bg-purple-100 text-purple-700 rounded-md hover:bg-purple-200 disabled:opacity-50 disabled:cursor-not-allowed",disabled:E===R.id||!(m[R.id]||"").replace(/<[^>]*>?/gm,"").trim(),children:E===R.id?u.jsx(St,{size:20,className:"animate-spin"}):u.jsx(Rs,{size:20})})})]}),u.jsxs("button",{onClick:()=>N(R.id),className:"mt-2 w-full sm:w-auto flex items-center justify-center bg-blue-600 text-white font-semibold py-2 px-4 rounded-md text-xs hover:bg-blue-700 disabled:opacity-60",disabled:g===R.id||!(m[R.id]||"").replace(/<[^>]*>?/gm,"").trim(),children:[g===R.id?u.jsx(St,{size:14,className:"animate-spin mr-2"}):u.jsx(By,{size:14,className:"mr-2"}),"Send Reply"]})]}),R.status==="Resolved"&&u.jsx("p",{className:"text-xs text-green-700 bg-green-50 p-2 rounded border border-green-200",children:"This ticket is marked as resolved. Replying will reopen it."}),R.status==="Closed"&&u.jsx("p",{className:"text-xs text-purple-700 bg-purple-50 p-2 rounded border border-purple-200",children:"This ticket is closed. Please create a new ticket if you need further assistance."})]})})]},R.id))})]})};function h$(n,e){const t=ee.useRef(e);ee.useEffect(function(){e!==t.current&&n.attributionControl!=null&&(t.current!=null&&n.attributionControl.removeAttribution(t.current),e!=null&&n.attributionControl.addAttribution(e)),t.current=e},[n,e])}Rx();const f$=1;function m$(n){return Object.freeze({__version:f$,map:n})}function p$(n,e){return Object.freeze({...n,...e})}const Y3=ee.createContext(null),Z3=Y3.Provider;function Q3(){const n=ee.useContext(Y3);if(n==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return n}function g$(n){function e(t,r){const{instance:i,context:s}=n(t).current;return ee.useImperativeHandle(r,()=>i),t.children==null?null:ts.createElement(Z3,{value:s},t.children)}return ee.forwardRef(e)}function y$(n){function e(t,r){const{instance:i}=n(t).current;return ee.useImperativeHandle(r,()=>i),null}return ee.forwardRef(e)}function X3(n,e){const t=ee.useRef();ee.useEffect(function(){return e!=null&&n.instance.on(e),t.current=e,function(){t.current!=null&&n.instance.off(t.current),t.current=null}},[n,e])}function S2(n,e){const t=n.pane??e.pane;return t?{...n,pane:t}:n}var sf={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var v$=sf.exports,VI;function _$(){return VI||(VI=1,function(n,e){(function(t,r){r(e)})(v$,function(t){var r="1.9.4";function i(c){var p,T,V,W;for(T=1,V=arguments.length;T<V;T++){W=arguments[T];for(p in W)c[p]=W[p]}return c}var s=Object.create||function(){function c(){}return function(p){return c.prototype=p,new c}}();function o(c,p){var T=Array.prototype.slice;if(c.bind)return c.bind.apply(c,T.call(arguments,1));var V=T.call(arguments,2);return function(){return c.apply(p,V.length?V.concat(T.call(arguments)):arguments)}}var l=0;function d(c){return"_leaflet_id"in c||(c._leaflet_id=++l),c._leaflet_id}function f(c,p,T){var V,W,ne,de;return de=function(){V=!1,W&&(ne.apply(T,W),W=!1)},ne=function(){V?W=arguments:(c.apply(T,arguments),setTimeout(de,p),V=!0)},ne}function m(c,p,T){var V=p[1],W=p[0],ne=V-W;return c===V&&T?c:((c-W)%ne+ne)%ne+W}function y(){return!1}function g(c,p){if(p===!1)return c;var T=Math.pow(10,p===void 0?6:p);return Math.round(c*T)/T}function _(c){return c.trim?c.trim():c.replace(/^\s+|\s+$/g,"")}function E(c){return _(c).split(/\s+/)}function x(c,p){Object.prototype.hasOwnProperty.call(c,"options")||(c.options=c.options?s(c.options):{});for(var T in p)c.options[T]=p[T];return c.options}function w(c,p,T){var V=[];for(var W in c)V.push(encodeURIComponent(T?W.toUpperCase():W)+"="+encodeURIComponent(c[W]));return(!p||p.indexOf("?")===-1?"?":"&")+V.join("&")}var S=/\{ *([\w_ -]+) *\}/g;function N(c,p){return c.replace(S,function(T,V){var W=p[V];if(W===void 0)throw new Error("No value provided for variable "+T);return typeof W=="function"&&(W=W(p)),W})}var P=Array.isArray||function(c){return Object.prototype.toString.call(c)==="[object Array]"};function I(c,p){for(var T=0;T<c.length;T++)if(c[T]===p)return T;return-1}var R="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function U(c){return window["webkit"+c]||window["moz"+c]||window["ms"+c]}var j=0;function k(c){var p=+new Date,T=Math.max(0,16-(p-j));return j=p+T,window.setTimeout(c,T)}var F=window.requestAnimationFrame||U("RequestAnimationFrame")||k,O=window.cancelAnimationFrame||U("CancelAnimationFrame")||U("CancelRequestAnimationFrame")||function(c){window.clearTimeout(c)};function C(c,p,T){if(T&&F===k)c.call(p);else return F.call(window,o(c,p))}function D(c){c&&O.call(window,c)}var M={__proto__:null,extend:i,create:s,bind:o,get lastId(){return l},stamp:d,throttle:f,wrapNum:m,falseFn:y,formatNum:g,trim:_,splitWords:E,setOptions:x,getParamString:w,template:N,isArray:P,indexOf:I,emptyImageUrl:R,requestFn:F,cancelFn:O,requestAnimFrame:C,cancelAnimFrame:D};function $(){}$.extend=function(c){var p=function(){x(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},T=p.__super__=this.prototype,V=s(T);V.constructor=p,p.prototype=V;for(var W in this)Object.prototype.hasOwnProperty.call(this,W)&&W!=="prototype"&&W!=="__super__"&&(p[W]=this[W]);return c.statics&&i(p,c.statics),c.includes&&(G(c.includes),i.apply(null,[V].concat(c.includes))),i(V,c),delete V.statics,delete V.includes,V.options&&(V.options=T.options?s(T.options):{},i(V.options,c.options)),V._initHooks=[],V.callInitHooks=function(){if(!this._initHooksCalled){T.callInitHooks&&T.callInitHooks.call(this),this._initHooksCalled=!0;for(var ne=0,de=V._initHooks.length;ne<de;ne++)V._initHooks[ne].call(this)}},p},$.include=function(c){var p=this.prototype.options;return i(this.prototype,c),c.options&&(this.prototype.options=p,this.mergeOptions(c.options)),this},$.mergeOptions=function(c){return i(this.prototype.options,c),this},$.addInitHook=function(c){var p=Array.prototype.slice.call(arguments,1),T=typeof c=="function"?c:function(){this[c].apply(this,p)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(T),this};function G(c){if(!(typeof L>"u"||!L||!L.Mixin)){c=P(c)?c:[c];for(var p=0;p<c.length;p++)c[p]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var re={on:function(c,p,T){if(typeof c=="object")for(var V in c)this._on(V,c[V],p);else{c=E(c);for(var W=0,ne=c.length;W<ne;W++)this._on(c[W],p,T)}return this},off:function(c,p,T){if(!arguments.length)delete this._events;else if(typeof c=="object")for(var V in c)this._off(V,c[V],p);else{c=E(c);for(var W=arguments.length===1,ne=0,de=c.length;ne<de;ne++)W?this._off(c[ne]):this._off(c[ne],p,T)}return this},_on:function(c,p,T,V){if(typeof p!="function"){console.warn("wrong listener type: "+typeof p);return}if(this._listens(c,p,T)===!1){T===this&&(T=void 0);var W={fn:p,ctx:T};V&&(W.once=!0),this._events=this._events||{},this._events[c]=this._events[c]||[],this._events[c].push(W)}},_off:function(c,p,T){var V,W,ne;if(this._events&&(V=this._events[c],!!V)){if(arguments.length===1){if(this._firingCount)for(W=0,ne=V.length;W<ne;W++)V[W].fn=y;delete this._events[c];return}if(typeof p!="function"){console.warn("wrong listener type: "+typeof p);return}var de=this._listens(c,p,T);if(de!==!1){var ve=V[de];this._firingCount&&(ve.fn=y,this._events[c]=V=V.slice()),V.splice(de,1)}}},fire:function(c,p,T){if(!this.listens(c,T))return this;var V=i({},p,{type:c,target:this,sourceTarget:p&&p.sourceTarget||this});if(this._events){var W=this._events[c];if(W){this._firingCount=this._firingCount+1||1;for(var ne=0,de=W.length;ne<de;ne++){var ve=W[ne],we=ve.fn;ve.once&&this.off(c,we,ve.ctx),we.call(ve.ctx||this,V)}this._firingCount--}}return T&&this._propagateEvent(V),this},listens:function(c,p,T,V){typeof c!="string"&&console.warn('"string" type argument expected');var W=p;typeof p!="function"&&(V=!!p,W=void 0,T=void 0);var ne=this._events&&this._events[c];if(ne&&ne.length&&this._listens(c,W,T)!==!1)return!0;if(V){for(var de in this._eventParents)if(this._eventParents[de].listens(c,p,T,V))return!0}return!1},_listens:function(c,p,T){if(!this._events)return!1;var V=this._events[c]||[];if(!p)return!!V.length;T===this&&(T=void 0);for(var W=0,ne=V.length;W<ne;W++)if(V[W].fn===p&&V[W].ctx===T)return W;return!1},once:function(c,p,T){if(typeof c=="object")for(var V in c)this._on(V,c[V],p,!0);else{c=E(c);for(var W=0,ne=c.length;W<ne;W++)this._on(c[W],p,T,!0)}return this},addEventParent:function(c){return this._eventParents=this._eventParents||{},this._eventParents[d(c)]=c,this},removeEventParent:function(c){return this._eventParents&&delete this._eventParents[d(c)],this},_propagateEvent:function(c){for(var p in this._eventParents)this._eventParents[p].fire(c.type,i({layer:c.target,propagatedFrom:c.target},c),!0)}};re.addEventListener=re.on,re.removeEventListener=re.clearAllEventListeners=re.off,re.addOneTimeEventListener=re.once,re.fireEvent=re.fire,re.hasEventListeners=re.listens;var oe=$.extend(re);function ie(c,p,T){this.x=T?Math.round(c):c,this.y=T?Math.round(p):p}var X=Math.trunc||function(c){return c>0?Math.floor(c):Math.ceil(c)};ie.prototype={clone:function(){return new ie(this.x,this.y)},add:function(c){return this.clone()._add(Y(c))},_add:function(c){return this.x+=c.x,this.y+=c.y,this},subtract:function(c){return this.clone()._subtract(Y(c))},_subtract:function(c){return this.x-=c.x,this.y-=c.y,this},divideBy:function(c){return this.clone()._divideBy(c)},_divideBy:function(c){return this.x/=c,this.y/=c,this},multiplyBy:function(c){return this.clone()._multiplyBy(c)},_multiplyBy:function(c){return this.x*=c,this.y*=c,this},scaleBy:function(c){return new ie(this.x*c.x,this.y*c.y)},unscaleBy:function(c){return new ie(this.x/c.x,this.y/c.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=X(this.x),this.y=X(this.y),this},distanceTo:function(c){c=Y(c);var p=c.x-this.x,T=c.y-this.y;return Math.sqrt(p*p+T*T)},equals:function(c){return c=Y(c),c.x===this.x&&c.y===this.y},contains:function(c){return c=Y(c),Math.abs(c.x)<=Math.abs(this.x)&&Math.abs(c.y)<=Math.abs(this.y)},toString:function(){return"Point("+g(this.x)+", "+g(this.y)+")"}};function Y(c,p,T){return c instanceof ie?c:P(c)?new ie(c[0],c[1]):c==null?c:typeof c=="object"&&"x"in c&&"y"in c?new ie(c.x,c.y):new ie(c,p,T)}function B(c,p){if(c)for(var T=p?[c,p]:c,V=0,W=T.length;V<W;V++)this.extend(T[V])}B.prototype={extend:function(c){var p,T;if(!c)return this;if(c instanceof ie||typeof c[0]=="number"||"x"in c)p=T=Y(c);else if(c=Z(c),p=c.min,T=c.max,!p||!T)return this;return!this.min&&!this.max?(this.min=p.clone(),this.max=T.clone()):(this.min.x=Math.min(p.x,this.min.x),this.max.x=Math.max(T.x,this.max.x),this.min.y=Math.min(p.y,this.min.y),this.max.y=Math.max(T.y,this.max.y)),this},getCenter:function(c){return Y((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,c)},getBottomLeft:function(){return Y(this.min.x,this.max.y)},getTopRight:function(){return Y(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(c){var p,T;return typeof c[0]=="number"||c instanceof ie?c=Y(c):c=Z(c),c instanceof B?(p=c.min,T=c.max):p=T=c,p.x>=this.min.x&&T.x<=this.max.x&&p.y>=this.min.y&&T.y<=this.max.y},intersects:function(c){c=Z(c);var p=this.min,T=this.max,V=c.min,W=c.max,ne=W.x>=p.x&&V.x<=T.x,de=W.y>=p.y&&V.y<=T.y;return ne&&de},overlaps:function(c){c=Z(c);var p=this.min,T=this.max,V=c.min,W=c.max,ne=W.x>p.x&&V.x<T.x,de=W.y>p.y&&V.y<T.y;return ne&&de},isValid:function(){return!!(this.min&&this.max)},pad:function(c){var p=this.min,T=this.max,V=Math.abs(p.x-T.x)*c,W=Math.abs(p.y-T.y)*c;return Z(Y(p.x-V,p.y-W),Y(T.x+V,T.y+W))},equals:function(c){return c?(c=Z(c),this.min.equals(c.getTopLeft())&&this.max.equals(c.getBottomRight())):!1}};function Z(c,p){return!c||c instanceof B?c:new B(c,p)}function te(c,p){if(c)for(var T=p?[c,p]:c,V=0,W=T.length;V<W;V++)this.extend(T[V])}te.prototype={extend:function(c){var p=this._southWest,T=this._northEast,V,W;if(c instanceof ae)V=c,W=c;else if(c instanceof te){if(V=c._southWest,W=c._northEast,!V||!W)return this}else return c?this.extend(Q(c)||se(c)):this;return!p&&!T?(this._southWest=new ae(V.lat,V.lng),this._northEast=new ae(W.lat,W.lng)):(p.lat=Math.min(V.lat,p.lat),p.lng=Math.min(V.lng,p.lng),T.lat=Math.max(W.lat,T.lat),T.lng=Math.max(W.lng,T.lng)),this},pad:function(c){var p=this._southWest,T=this._northEast,V=Math.abs(p.lat-T.lat)*c,W=Math.abs(p.lng-T.lng)*c;return new te(new ae(p.lat-V,p.lng-W),new ae(T.lat+V,T.lng+W))},getCenter:function(){return new ae((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new ae(this.getNorth(),this.getWest())},getSouthEast:function(){return new ae(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(c){typeof c[0]=="number"||c instanceof ae||"lat"in c?c=Q(c):c=se(c);var p=this._southWest,T=this._northEast,V,W;return c instanceof te?(V=c.getSouthWest(),W=c.getNorthEast()):V=W=c,V.lat>=p.lat&&W.lat<=T.lat&&V.lng>=p.lng&&W.lng<=T.lng},intersects:function(c){c=se(c);var p=this._southWest,T=this._northEast,V=c.getSouthWest(),W=c.getNorthEast(),ne=W.lat>=p.lat&&V.lat<=T.lat,de=W.lng>=p.lng&&V.lng<=T.lng;return ne&&de},overlaps:function(c){c=se(c);var p=this._southWest,T=this._northEast,V=c.getSouthWest(),W=c.getNorthEast(),ne=W.lat>p.lat&&V.lat<T.lat,de=W.lng>p.lng&&V.lng<T.lng;return ne&&de},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(c,p){return c?(c=se(c),this._southWest.equals(c.getSouthWest(),p)&&this._northEast.equals(c.getNorthEast(),p)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function se(c,p){return c instanceof te?c:new te(c,p)}function ae(c,p,T){if(isNaN(c)||isNaN(p))throw new Error("Invalid LatLng object: ("+c+", "+p+")");this.lat=+c,this.lng=+p,T!==void 0&&(this.alt=+T)}ae.prototype={equals:function(c,p){if(!c)return!1;c=Q(c);var T=Math.max(Math.abs(this.lat-c.lat),Math.abs(this.lng-c.lng));return T<=(p===void 0?1e-9:p)},toString:function(c){return"LatLng("+g(this.lat,c)+", "+g(this.lng,c)+")"},distanceTo:function(c){return me.distance(this,Q(c))},wrap:function(){return me.wrapLatLng(this)},toBounds:function(c){var p=180*c/40075017,T=p/Math.cos(Math.PI/180*this.lat);return se([this.lat-p,this.lng-T],[this.lat+p,this.lng+T])},clone:function(){return new ae(this.lat,this.lng,this.alt)}};function Q(c,p,T){return c instanceof ae?c:P(c)&&typeof c[0]!="object"?c.length===3?new ae(c[0],c[1],c[2]):c.length===2?new ae(c[0],c[1]):null:c==null?c:typeof c=="object"&&"lat"in c?new ae(c.lat,"lng"in c?c.lng:c.lon,c.alt):p===void 0?null:new ae(c,p,T)}var ce={latLngToPoint:function(c,p){var T=this.projection.project(c),V=this.scale(p);return this.transformation._transform(T,V)},pointToLatLng:function(c,p){var T=this.scale(p),V=this.transformation.untransform(c,T);return this.projection.unproject(V)},project:function(c){return this.projection.project(c)},unproject:function(c){return this.projection.unproject(c)},scale:function(c){return 256*Math.pow(2,c)},zoom:function(c){return Math.log(c/256)/Math.LN2},getProjectedBounds:function(c){if(this.infinite)return null;var p=this.projection.bounds,T=this.scale(c),V=this.transformation.transform(p.min,T),W=this.transformation.transform(p.max,T);return new B(V,W)},infinite:!1,wrapLatLng:function(c){var p=this.wrapLng?m(c.lng,this.wrapLng,!0):c.lng,T=this.wrapLat?m(c.lat,this.wrapLat,!0):c.lat,V=c.alt;return new ae(T,p,V)},wrapLatLngBounds:function(c){var p=c.getCenter(),T=this.wrapLatLng(p),V=p.lat-T.lat,W=p.lng-T.lng;if(V===0&&W===0)return c;var ne=c.getSouthWest(),de=c.getNorthEast(),ve=new ae(ne.lat-V,ne.lng-W),we=new ae(de.lat-V,de.lng-W);return new te(ve,we)}},me=i({},ce,{wrapLng:[-180,180],R:6371e3,distance:function(c,p){var T=Math.PI/180,V=c.lat*T,W=p.lat*T,ne=Math.sin((p.lat-c.lat)*T/2),de=Math.sin((p.lng-c.lng)*T/2),ve=ne*ne+Math.cos(V)*Math.cos(W)*de*de,we=2*Math.atan2(Math.sqrt(ve),Math.sqrt(1-ve));return this.R*we}}),ge=6378137,Ae={R:ge,MAX_LATITUDE:85.0511287798,project:function(c){var p=Math.PI/180,T=this.MAX_LATITUDE,V=Math.max(Math.min(T,c.lat),-T),W=Math.sin(V*p);return new ie(this.R*c.lng*p,this.R*Math.log((1+W)/(1-W))/2)},unproject:function(c){var p=180/Math.PI;return new ae((2*Math.atan(Math.exp(c.y/this.R))-Math.PI/2)*p,c.x*p/this.R)},bounds:function(){var c=ge*Math.PI;return new B([-c,-c],[c,c])}()};function Ve(c,p,T,V){if(P(c)){this._a=c[0],this._b=c[1],this._c=c[2],this._d=c[3];return}this._a=c,this._b=p,this._c=T,this._d=V}Ve.prototype={transform:function(c,p){return this._transform(c.clone(),p)},_transform:function(c,p){return p=p||1,c.x=p*(this._a*c.x+this._b),c.y=p*(this._c*c.y+this._d),c},untransform:function(c,p){return p=p||1,new ie((c.x/p-this._b)/this._a,(c.y/p-this._d)/this._c)}};function Ye(c,p,T,V){return new Ve(c,p,T,V)}var Ge=i({},me,{code:"EPSG:3857",projection:Ae,transformation:function(){var c=.5/(Math.PI*Ae.R);return Ye(c,.5,-c,.5)}()}),ot=i({},Ge,{code:"EPSG:900913"});function nt(c){return document.createElementNS("http://www.w3.org/2000/svg",c)}function It(c,p){var T="",V,W,ne,de,ve,we;for(V=0,ne=c.length;V<ne;V++){for(ve=c[V],W=0,de=ve.length;W<de;W++)we=ve[W],T+=(W?"L":"M")+we.x+" "+we.y;T+=p?$e.svg?"z":"x":""}return T||"M0 0"}var Gt=document.documentElement.style,Se="ActiveXObject"in window,Ne=Se&&!document.addEventListener,De="msLaunchUri"in navigator&&!("documentMode"in document),ze=ln("webkit"),ke=ln("android"),gt=ln("android 2")||ln("android 3"),mt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),pt=ke&&ln("Google")&&mt<537&&!("AudioNode"in window),Ct=!!window.opera,Mt=!De&&ln("chrome"),Dt=ln("gecko")&&!ze&&!Ct&&!Se,rs=!Mt&&ln("safari"),Ht=ln("phantom"),On="OTransition"in Gt,is=navigator.platform.indexOf("Win")===0,Vi=Se&&"transition"in Gt,pi="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!gt,pr="MozPerspective"in Gt,gi=!window.L_DISABLE_3D&&(Vi||pi||pr)&&!On&&!Ht,ei=typeof orientation<"u"||ln("mobile"),zi=ei&&ze,ao=ei&&pi,yi=!window.PointerEvent&&window.MSPointerEvent,Yn=!!(window.PointerEvent||yi),ti="ontouchstart"in window||!!window.TouchEvent,vi=!window.L_NO_TOUCH&&(ti||Yn),_i=ei&&Ct,Fo=ei&&Dt,yn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,xi=function(){var c=!1;try{var p=Object.defineProperty({},"passive",{get:function(){c=!0}});window.addEventListener("testPassiveEventSupport",y,p),window.removeEventListener("testPassiveEventSupport",y,p)}catch{}return c}(),Bi=function(){return!!document.createElement("canvas").getContext}(),ss=!!(document.createElementNS&&nt("svg").createSVGRect),xn=!!ss&&function(){var c=document.createElement("div");return c.innerHTML="<svg/>",(c.firstChild&&c.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Ls=!ss&&function(){try{var c=document.createElement("div");c.innerHTML='<v:shape adj="1"/>';var p=c.firstChild;return p.style.behavior="url(#default#VML)",p&&typeof p.adj=="object"}catch{return!1}}(),Mr=navigator.platform.indexOf("Mac")===0,Fs=navigator.platform.indexOf("Linux")===0;function ln(c){return navigator.userAgent.toLowerCase().indexOf(c)>=0}var $e={ie:Se,ielt9:Ne,edge:De,webkit:ze,android:ke,android23:gt,androidStock:pt,opera:Ct,chrome:Mt,gecko:Dt,safari:rs,phantom:Ht,opera12:On,win:is,ie3d:Vi,webkit3d:pi,gecko3d:pr,any3d:gi,mobile:ei,mobileWebkit:zi,mobileWebkit3d:ao,msPointer:yi,pointer:Yn,touch:vi,touchNative:ti,mobileOpera:_i,mobileGecko:Fo,retina:yn,passiveEvents:xi,canvas:Bi,svg:ss,vml:Ls,inlineSvg:xn,mac:Mr,linux:Fs},Er=$e.msPointer?"MSPointerDown":"pointerdown",Vs=$e.msPointer?"MSPointerMove":"pointermove",lo=$e.msPointer?"MSPointerUp":"pointerup",os=$e.msPointer?"MSPointerCancel":"pointercancel",gr={touchstart:Er,touchmove:Vs,touchend:lo,touchcancel:os},Tr={touchstart:Nt,touchmove:Kt,touchend:Kt,touchcancel:Kt},Sr={},Ar=!1;function Vo(c,p,T){return p==="touchstart"&&Ke(),Tr[p]?(T=Tr[p].bind(this,T),c.addEventListener(gr[p],T,!1),T):(console.warn("wrong event specified:",p),y)}function zo(c,p,T){if(!gr[p]){console.warn("wrong event specified:",p);return}c.removeEventListener(gr[p],T,!1)}function Qe(c){Sr[c.pointerId]=c}function fe(c){Sr[c.pointerId]&&(Sr[c.pointerId]=c)}function je(c){delete Sr[c.pointerId]}function Ke(){Ar||(document.addEventListener(Er,Qe,!0),document.addEventListener(Vs,fe,!0),document.addEventListener(lo,je,!0),document.addEventListener(os,je,!0),Ar=!0)}function Kt(c,p){if(p.pointerType!==(p.MSPOINTER_TYPE_MOUSE||"mouse")){p.touches=[];for(var T in Sr)p.touches.push(Sr[T]);p.changedTouches=[p],c(p)}}function Nt(c,p){p.MSPOINTER_TYPE_TOUCH&&p.pointerType===p.MSPOINTER_TYPE_TOUCH&&dn(p),Kt(c,p)}function bn(c){var p={},T,V;for(V in c)T=c[V],p[V]=T&&T.bind?T.bind(c):T;return c=p,p.type="dblclick",p.detail=2,p.isTrusted=!1,p._simulated=!0,p}var kn=200;function Zn(c,p){c.addEventListener("dblclick",p);var T=0,V;function W(ne){if(ne.detail!==1){V=ne.detail;return}if(!(ne.pointerType==="mouse"||ne.sourceCapabilities&&!ne.sourceCapabilities.firesTouchEvents)){var de=ls(ne);if(!(de.some(function(we){return we instanceof HTMLLabelElement&&we.attributes.for})&&!de.some(function(we){return we instanceof HTMLInputElement||we instanceof HTMLSelectElement}))){var ve=Date.now();ve-T<=kn?(V++,V===2&&p(bn(ne))):V=1,T=ve}}}return c.addEventListener("click",W),{dblclick:p,simDblclick:W}}function $n(c,p){c.removeEventListener("dblclick",p.dblclick),c.removeEventListener("click",p.simDblclick)}var Ui=$i(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),vn=$i(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),qi=vn==="webkitTransition"||vn==="OTransition"?vn+"End":"transitionend";function sr(c){return typeof c=="string"?document.getElementById(c):c}function co(c,p){var T=c.style[p]||c.currentStyle&&c.currentStyle[p];if((!T||T==="auto")&&document.defaultView){var V=document.defaultView.getComputedStyle(c,null);T=V?V[p]:null}return T==="auto"?null:T}function vt(c,p,T){var V=document.createElement(c);return V.className=p||"",T&&T.appendChild(V),V}function cn(c){var p=c.parentNode;p&&p.removeChild(c)}function Bo(c){for(;c.firstChild;)c.removeChild(c.firstChild)}function zs(c){var p=c.parentNode;p&&p.lastChild!==c&&p.appendChild(c)}function Hi(c){var p=c.parentNode;p&&p.firstChild!==c&&p.insertBefore(c,p.firstChild)}function uo(c,p){if(c.classList!==void 0)return c.classList.contains(p);var T=bi(c);return T.length>0&&new RegExp("(^|\\s)"+p+"(\\s|$)").test(T)}function yt(c,p){if(c.classList!==void 0)for(var T=E(p),V=0,W=T.length;V<W;V++)c.classList.add(T[V]);else if(!uo(c,p)){var ne=bi(c);oc(c,(ne?ne+" ":"")+p)}}function un(c,p){c.classList!==void 0?c.classList.remove(p):oc(c,_((" "+bi(c)+" ").replace(" "+p+" "," ")))}function oc(c,p){c.className.baseVal===void 0?c.className=p:c.className.baseVal=p}function bi(c){return c.correspondingElement&&(c=c.correspondingElement),c.className.baseVal===void 0?c.className:c.className.baseVal}function En(c,p){"opacity"in c.style?c.style.opacity=p:"filter"in c.style&&Uo(c,p)}function Uo(c,p){var T=!1,V="DXImageTransform.Microsoft.Alpha";try{T=c.filters.item(V)}catch{if(p===1)return}p=Math.round(p*100),T?(T.Enabled=p!==100,T.Opacity=p):c.style.filter+=" progid:"+V+"(opacity="+p+")"}function $i(c){for(var p=document.documentElement.style,T=0;T<c.length;T++)if(c[T]in p)return c[T];return!1}function Dr(c,p,T){var V=p||new ie(0,0);c.style[Ui]=($e.ie3d?"translate("+V.x+"px,"+V.y+"px)":"translate3d("+V.x+"px,"+V.y+"px,0)")+(T?" scale("+T+")":"")}function _t(c,p){c._leaflet_pos=p,$e.any3d?Dr(c,p):(c.style.left=p.x+"px",c.style.top=p.y+"px")}function Lr(c){return c._leaflet_pos||new ie(0,0)}var Rt,wi,La;if("onselectstart"in document)Rt=function(){lt(window,"selectstart",dn)},wi=function(){nn(window,"selectstart",dn)};else{var as=$i(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Rt=function(){if(as){var c=document.documentElement.style;La=c[as],c[as]="none"}},wi=function(){as&&(document.documentElement.style[as]=La,La=void 0)}}function Fa(){lt(window,"dragstart",dn)}function Va(){nn(window,"dragstart",dn)}var qo,Ho;function Ei(c){for(;c.tabIndex===-1;)c=c.parentNode;c.style&&(Vn(),qo=c,Ho=c.style.outlineStyle,c.style.outlineStyle="none",lt(window,"keydown",Vn))}function Vn(){qo&&(qo.style.outlineStyle=Ho,qo=void 0,Ho=void 0,nn(window,"keydown",Vn))}function Ti(c){do c=c.parentNode;while((!c.offsetWidth||!c.offsetHeight)&&c!==document.body);return c}function ni(c){var p=c.getBoundingClientRect();return{x:p.width/c.offsetWidth||1,y:p.height/c.offsetHeight||1,boundingClientRect:p}}var ho={__proto__:null,TRANSFORM:Ui,TRANSITION:vn,TRANSITION_END:qi,get:sr,getStyle:co,create:vt,remove:cn,empty:Bo,toFront:zs,toBack:Hi,hasClass:uo,addClass:yt,removeClass:un,setClass:oc,getClass:bi,setOpacity:En,testProp:$i,setTransform:Dr,setPosition:_t,getPosition:Lr,get disableTextSelection(){return Rt},get enableTextSelection(){return wi},disableImageDrag:Fa,enableImageDrag:Va,preventOutline:Ei,restoreOutline:Vn,getSizedParentNode:Ti,getScale:ni};function lt(c,p,T,V){if(p&&typeof p=="object")for(var W in p)lc(c,W,p[W],T);else{p=E(p);for(var ne=0,de=p.length;ne<de;ne++)lc(c,p[ne],T,V)}return this}var Wn="_leaflet_events";function nn(c,p,T,V){if(arguments.length===1)ac(c),delete c[Wn];else if(p&&typeof p=="object")for(var W in p)za(c,W,p[W],T);else if(p=E(p),arguments.length===2)ac(c,function(ve){return I(p,ve)!==-1});else for(var ne=0,de=p.length;ne<de;ne++)za(c,p[ne],T,V);return this}function ac(c,p){for(var T in c[Wn]){var V=T.split(/\d/)[0];(!p||p(V))&&za(c,V,null,null,T)}}var yr={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function lc(c,p,T,V){var W=p+d(T)+(V?"_"+d(V):"");if(c[Wn]&&c[Wn][W])return this;var ne=function(ve){return T.call(V||c,ve||window.event)},de=ne;!$e.touchNative&&$e.pointer&&p.indexOf("touch")===0?ne=Vo(c,p,ne):$e.touch&&p==="dblclick"?ne=Zn(c,ne):"addEventListener"in c?p==="touchstart"||p==="touchmove"||p==="wheel"||p==="mousewheel"?c.addEventListener(yr[p]||p,ne,$e.passiveEvents?{passive:!1}:!1):p==="mouseenter"||p==="mouseleave"?(ne=function(ve){ve=ve||window.event,$o(c,ve)&&de(ve)},c.addEventListener(yr[p],ne,!1)):c.addEventListener(p,de,!1):c.attachEvent("on"+p,ne),c[Wn]=c[Wn]||{},c[Wn][W]=ne}function za(c,p,T,V,W){W=W||p+d(T)+(V?"_"+d(V):"");var ne=c[Wn]&&c[Wn][W];if(!ne)return this;!$e.touchNative&&$e.pointer&&p.indexOf("touch")===0?zo(c,p,ne):$e.touch&&p==="dblclick"?$n(c,ne):"removeEventListener"in c?c.removeEventListener(yr[p]||p,ne,!1):c.detachEvent("on"+p,ne),c[Wn][W]=null}function Nr(c){return c.stopPropagation?c.stopPropagation():c.originalEvent?c.originalEvent._stopped=!0:c.cancelBubble=!0,this}function Bs(c){return lc(c,"wheel",Nr),this}function fo(c){return lt(c,"mousedown touchstart dblclick contextmenu",Nr),c._leaflet_disable_click=!0,this}function dn(c){return c.preventDefault?c.preventDefault():c.returnValue=!1,this}function or(c){return dn(c),Nr(c),this}function ls(c){if(c.composedPath)return c.composedPath();for(var p=[],T=c.target;T;)p.push(T),T=T.parentNode;return p}function Us(c,p){if(!p)return new ie(c.clientX,c.clientY);var T=ni(p),V=T.boundingClientRect;return new ie((c.clientX-V.left)/T.x-p.clientLeft,(c.clientY-V.top)/T.y-p.clientTop)}var Tn=$e.linux&&$e.chrome?window.devicePixelRatio:$e.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function yu(c){return $e.edge?c.wheelDeltaY/2:c.deltaY&&c.deltaMode===0?-c.deltaY/Tn:c.deltaY&&c.deltaMode===1?-c.deltaY*20:c.deltaY&&c.deltaMode===2?-c.deltaY*60:c.deltaX||c.deltaZ?0:c.wheelDelta?(c.wheelDeltaY||c.wheelDelta)/2:c.detail&&Math.abs(c.detail)<32765?-c.detail*20:c.detail?c.detail/-32765*60:0}function $o(c,p){var T=p.relatedTarget;if(!T)return!0;try{for(;T&&T!==c;)T=T.parentNode}catch{return!1}return T!==c}var Wo={__proto__:null,on:lt,off:nn,stopPropagation:Nr,disableScrollPropagation:Bs,disableClickPropagation:fo,preventDefault:dn,stop:or,getPropagationPath:ls,getMousePosition:Us,getWheelDelta:yu,isExternalTarget:$o,addListener:lt,removeListener:nn},Go=oe.extend({run:function(c,p,T,V){this.stop(),this._el=c,this._inProgress=!0,this._duration=T||.25,this._easeOutPower=1/Math.max(V||.5,.2),this._startPos=Lr(c),this._offset=p.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=C(this._animate,this),this._step()},_step:function(c){var p=+new Date-this._startTime,T=this._duration*1e3;p<T?this._runFrame(this._easeOut(p/T),c):(this._runFrame(1),this._complete())},_runFrame:function(c,p){var T=this._startPos.add(this._offset.multiplyBy(c));p&&T._round(),_t(this._el,T),this.fire("step")},_complete:function(){D(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(c){return 1-Math.pow(1-c,this._easeOutPower)}}),jt=oe.extend({options:{crs:Ge,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(c,p){p=x(this,p),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(c),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),p.maxBounds&&this.setMaxBounds(p.maxBounds),p.zoom!==void 0&&(this._zoom=this._limitZoom(p.zoom)),p.center&&p.zoom!==void 0&&this.setView(Q(p.center),p.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=vn&&$e.any3d&&!$e.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),lt(this._proxy,qi,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(c,p,T){if(p=p===void 0?this._zoom:this._limitZoom(p),c=this._limitCenter(Q(c),p,this.options.maxBounds),T=T||{},this._stop(),this._loaded&&!T.reset&&T!==!0){T.animate!==void 0&&(T.zoom=i({animate:T.animate},T.zoom),T.pan=i({animate:T.animate,duration:T.duration},T.pan));var V=this._zoom!==p?this._tryAnimatedZoom&&this._tryAnimatedZoom(c,p,T.zoom):this._tryAnimatedPan(c,T.pan);if(V)return clearTimeout(this._sizeTimer),this}return this._resetView(c,p,T.pan&&T.pan.noMoveStart),this},setZoom:function(c,p){return this._loaded?this.setView(this.getCenter(),c,{zoom:p}):(this._zoom=c,this)},zoomIn:function(c,p){return c=c||($e.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+c,p)},zoomOut:function(c,p){return c=c||($e.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-c,p)},setZoomAround:function(c,p,T){var V=this.getZoomScale(p),W=this.getSize().divideBy(2),ne=c instanceof ie?c:this.latLngToContainerPoint(c),de=ne.subtract(W).multiplyBy(1-1/V),ve=this.containerPointToLatLng(W.add(de));return this.setView(ve,p,{zoom:T})},_getBoundsCenterZoom:function(c,p){p=p||{},c=c.getBounds?c.getBounds():se(c);var T=Y(p.paddingTopLeft||p.padding||[0,0]),V=Y(p.paddingBottomRight||p.padding||[0,0]),W=this.getBoundsZoom(c,!1,T.add(V));if(W=typeof p.maxZoom=="number"?Math.min(p.maxZoom,W):W,W===1/0)return{center:c.getCenter(),zoom:W};var ne=V.subtract(T).divideBy(2),de=this.project(c.getSouthWest(),W),ve=this.project(c.getNorthEast(),W),we=this.unproject(de.add(ve).divideBy(2).add(ne),W);return{center:we,zoom:W}},fitBounds:function(c,p){if(c=se(c),!c.isValid())throw new Error("Bounds are not valid.");var T=this._getBoundsCenterZoom(c,p);return this.setView(T.center,T.zoom,p)},fitWorld:function(c){return this.fitBounds([[-90,-180],[90,180]],c)},panTo:function(c,p){return this.setView(c,this._zoom,{pan:p})},panBy:function(c,p){if(c=Y(c).round(),p=p||{},!c.x&&!c.y)return this.fire("moveend");if(p.animate!==!0&&!this.getSize().contains(c))return this._resetView(this.unproject(this.project(this.getCenter()).add(c)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Go,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),p.noMoveStart||this.fire("movestart"),p.animate!==!1){yt(this._mapPane,"leaflet-pan-anim");var T=this._getMapPanePos().subtract(c).round();this._panAnim.run(this._mapPane,T,p.duration||.25,p.easeLinearity)}else this._rawPanBy(c),this.fire("move").fire("moveend");return this},flyTo:function(c,p,T){if(T=T||{},T.animate===!1||!$e.any3d)return this.setView(c,p,T);this._stop();var V=this.project(this.getCenter()),W=this.project(c),ne=this.getSize(),de=this._zoom;c=Q(c),p=p===void 0?de:p;var ve=Math.max(ne.x,ne.y),we=ve*this.getZoomScale(de,p),Ce=W.distanceTo(V)||1,He=1.42,dt=He*He;function Pt(sn){var ol=sn?-1:1,o0=sn?we:ve,a0=we*we-ve*ve+ol*dt*dt*Ce*Ce,ea=2*o0*dt*Ce,ta=a0/ea,na=Math.sqrt(ta*ta+1)-ta,Pu=na<1e-9?-18:Math.log(na);return Pu}function ar(sn){return(Math.exp(sn)-Math.exp(-sn))/2}function er(sn){return(Math.exp(sn)+Math.exp(-sn))/2}function si(sn){return ar(sn)/er(sn)}var zr=Pt(0);function il(sn){return ve*(er(zr)/er(zr+He*sn))}function ih(sn){return ve*(er(zr)*si(zr+He*sn)-ar(zr))/dt}function vo(sn){return 1-Math.pow(1-sn,1.5)}var Rm=Date.now(),Jo=(Pt(1)-zr)/He,fs=T.duration?1e3*T.duration:1e3*Jo*.8;function sl(){var sn=(Date.now()-Rm)/fs,ol=vo(sn)*Jo;sn<=1?(this._flyToFrame=C(sl,this),this._move(this.unproject(V.add(W.subtract(V).multiplyBy(ih(ol)/Ce)),de),this.getScaleZoom(ve/il(ol),de),{flyTo:!0})):this._move(c,p)._moveEnd(!0)}return this._moveStart(!0,T.noMoveStart),sl.call(this),this},flyToBounds:function(c,p){var T=this._getBoundsCenterZoom(c,p);return this.flyTo(T.center,T.zoom,p)},setMaxBounds:function(c){return c=se(c),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),c.isValid()?(this.options.maxBounds=c,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(c){var p=this.options.minZoom;return this.options.minZoom=c,this._loaded&&p!==c&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(c):this},setMaxZoom:function(c){var p=this.options.maxZoom;return this.options.maxZoom=c,this._loaded&&p!==c&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(c):this},panInsideBounds:function(c,p){this._enforcingBounds=!0;var T=this.getCenter(),V=this._limitCenter(T,this._zoom,se(c));return T.equals(V)||this.panTo(V,p),this._enforcingBounds=!1,this},panInside:function(c,p){p=p||{};var T=Y(p.paddingTopLeft||p.padding||[0,0]),V=Y(p.paddingBottomRight||p.padding||[0,0]),W=this.project(this.getCenter()),ne=this.project(c),de=this.getPixelBounds(),ve=Z([de.min.add(T),de.max.subtract(V)]),we=ve.getSize();if(!ve.contains(ne)){this._enforcingBounds=!0;var Ce=ne.subtract(ve.getCenter()),He=ve.extend(ne).getSize().subtract(we);W.x+=Ce.x<0?-He.x:He.x,W.y+=Ce.y<0?-He.y:He.y,this.panTo(this.unproject(W),p),this._enforcingBounds=!1}return this},invalidateSize:function(c){if(!this._loaded)return this;c=i({animate:!1,pan:!0},c===!0?{animate:!0}:c);var p=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var T=this.getSize(),V=p.divideBy(2).round(),W=T.divideBy(2).round(),ne=V.subtract(W);return!ne.x&&!ne.y?this:(c.animate&&c.pan?this.panBy(ne):(c.pan&&this._rawPanBy(ne),this.fire("move"),c.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:p,newSize:T}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(c){if(c=this._locateOptions=i({timeout:1e4,watch:!1},c),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var p=o(this._handleGeolocationResponse,this),T=o(this._handleGeolocationError,this);return c.watch?this._locationWatchId=navigator.geolocation.watchPosition(p,T,c):navigator.geolocation.getCurrentPosition(p,T,c),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(c){if(this._container._leaflet_id){var p=c.code,T=c.message||(p===1?"permission denied":p===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:p,message:"Geolocation error: "+T+"."})}},_handleGeolocationResponse:function(c){if(this._container._leaflet_id){var p=c.coords.latitude,T=c.coords.longitude,V=new ae(p,T),W=V.toBounds(c.coords.accuracy*2),ne=this._locateOptions;if(ne.setView){var de=this.getBoundsZoom(W);this.setView(V,ne.maxZoom?Math.min(de,ne.maxZoom):de)}var ve={latlng:V,bounds:W,timestamp:c.timestamp};for(var we in c.coords)typeof c.coords[we]=="number"&&(ve[we]=c.coords[we]);this.fire("locationfound",ve)}},addHandler:function(c,p){if(!p)return this;var T=this[c]=new p(this);return this._handlers.push(T),this.options[c]&&T.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),cn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(D(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var c;for(c in this._layers)this._layers[c].remove();for(c in this._panes)cn(this._panes[c]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(c,p){var T="leaflet-pane"+(c?" leaflet-"+c.replace("Pane","")+"-pane":""),V=vt("div",T,p||this._mapPane);return c&&(this._panes[c]=V),V},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var c=this.getPixelBounds(),p=this.unproject(c.getBottomLeft()),T=this.unproject(c.getTopRight());return new te(p,T)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(c,p,T){c=se(c),T=Y(T||[0,0]);var V=this.getZoom()||0,W=this.getMinZoom(),ne=this.getMaxZoom(),de=c.getNorthWest(),ve=c.getSouthEast(),we=this.getSize().subtract(T),Ce=Z(this.project(ve,V),this.project(de,V)).getSize(),He=$e.any3d?this.options.zoomSnap:1,dt=we.x/Ce.x,Pt=we.y/Ce.y,ar=p?Math.max(dt,Pt):Math.min(dt,Pt);return V=this.getScaleZoom(ar,V),He&&(V=Math.round(V/(He/100))*(He/100),V=p?Math.ceil(V/He)*He:Math.floor(V/He)*He),Math.max(W,Math.min(ne,V))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ie(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(c,p){var T=this._getTopLeftPoint(c,p);return new B(T,T.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(c){return this.options.crs.getProjectedBounds(c===void 0?this.getZoom():c)},getPane:function(c){return typeof c=="string"?this._panes[c]:c},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(c,p){var T=this.options.crs;return p=p===void 0?this._zoom:p,T.scale(c)/T.scale(p)},getScaleZoom:function(c,p){var T=this.options.crs;p=p===void 0?this._zoom:p;var V=T.zoom(c*T.scale(p));return isNaN(V)?1/0:V},project:function(c,p){return p=p===void 0?this._zoom:p,this.options.crs.latLngToPoint(Q(c),p)},unproject:function(c,p){return p=p===void 0?this._zoom:p,this.options.crs.pointToLatLng(Y(c),p)},layerPointToLatLng:function(c){var p=Y(c).add(this.getPixelOrigin());return this.unproject(p)},latLngToLayerPoint:function(c){var p=this.project(Q(c))._round();return p._subtract(this.getPixelOrigin())},wrapLatLng:function(c){return this.options.crs.wrapLatLng(Q(c))},wrapLatLngBounds:function(c){return this.options.crs.wrapLatLngBounds(se(c))},distance:function(c,p){return this.options.crs.distance(Q(c),Q(p))},containerPointToLayerPoint:function(c){return Y(c).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(c){return Y(c).add(this._getMapPanePos())},containerPointToLatLng:function(c){var p=this.containerPointToLayerPoint(Y(c));return this.layerPointToLatLng(p)},latLngToContainerPoint:function(c){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Q(c)))},mouseEventToContainerPoint:function(c){return Us(c,this._container)},mouseEventToLayerPoint:function(c){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(c))},mouseEventToLatLng:function(c){return this.layerPointToLatLng(this.mouseEventToLayerPoint(c))},_initContainer:function(c){var p=this._container=sr(c);if(p){if(p._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");lt(p,"scroll",this._onScroll,this),this._containerId=d(p)},_initLayout:function(){var c=this._container;this._fadeAnimated=this.options.fadeAnimation&&$e.any3d,yt(c,"leaflet-container"+($e.touch?" leaflet-touch":"")+($e.retina?" leaflet-retina":"")+($e.ielt9?" leaflet-oldie":"")+($e.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var p=co(c,"position");p!=="absolute"&&p!=="relative"&&p!=="fixed"&&p!=="sticky"&&(c.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var c=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),_t(this._mapPane,new ie(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(yt(c.markerPane,"leaflet-zoom-hide"),yt(c.shadowPane,"leaflet-zoom-hide"))},_resetView:function(c,p,T){_t(this._mapPane,new ie(0,0));var V=!this._loaded;this._loaded=!0,p=this._limitZoom(p),this.fire("viewprereset");var W=this._zoom!==p;this._moveStart(W,T)._move(c,p)._moveEnd(W),this.fire("viewreset"),V&&this.fire("load")},_moveStart:function(c,p){return c&&this.fire("zoomstart"),p||this.fire("movestart"),this},_move:function(c,p,T,V){p===void 0&&(p=this._zoom);var W=this._zoom!==p;return this._zoom=p,this._lastCenter=c,this._pixelOrigin=this._getNewPixelOrigin(c),V?T&&T.pinch&&this.fire("zoom",T):((W||T&&T.pinch)&&this.fire("zoom",T),this.fire("move",T)),this},_moveEnd:function(c){return c&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return D(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(c){_t(this._mapPane,this._getMapPanePos().subtract(c))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(c){this._targets={},this._targets[d(this._container)]=this;var p=c?nn:lt;p(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&p(window,"resize",this._onResize,this),$e.any3d&&this.options.transform3DLimit&&(c?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){D(this._resizeRequest),this._resizeRequest=C(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var c=this._getMapPanePos();Math.max(Math.abs(c.x),Math.abs(c.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(c,p){for(var T=[],V,W=p==="mouseout"||p==="mouseover",ne=c.target||c.srcElement,de=!1;ne;){if(V=this._targets[d(ne)],V&&(p==="click"||p==="preclick")&&this._draggableMoved(V)){de=!0;break}if(V&&V.listens(p,!0)&&(W&&!$o(ne,c)||(T.push(V),W))||ne===this._container)break;ne=ne.parentNode}return!T.length&&!de&&!W&&this.listens(p,!0)&&(T=[this]),T},_isClickDisabled:function(c){for(;c&&c!==this._container;){if(c._leaflet_disable_click)return!0;c=c.parentNode}},_handleDOMEvent:function(c){var p=c.target||c.srcElement;if(!(!this._loaded||p._leaflet_disable_events||c.type==="click"&&this._isClickDisabled(p))){var T=c.type;T==="mousedown"&&Ei(p),this._fireDOMEvent(c,T)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(c,p,T){if(c.type==="click"){var V=i({},c);V.type="preclick",this._fireDOMEvent(V,V.type,T)}var W=this._findEventTargets(c,p);if(T){for(var ne=[],de=0;de<T.length;de++)T[de].listens(p,!0)&&ne.push(T[de]);W=ne.concat(W)}if(W.length){p==="contextmenu"&&dn(c);var ve=W[0],we={originalEvent:c};if(c.type!=="keypress"&&c.type!=="keydown"&&c.type!=="keyup"){var Ce=ve.getLatLng&&(!ve._radius||ve._radius<=10);we.containerPoint=Ce?this.latLngToContainerPoint(ve.getLatLng()):this.mouseEventToContainerPoint(c),we.layerPoint=this.containerPointToLayerPoint(we.containerPoint),we.latlng=Ce?ve.getLatLng():this.layerPointToLatLng(we.layerPoint)}for(de=0;de<W.length;de++)if(W[de].fire(p,we,!0),we.originalEvent._stopped||W[de].options.bubblingMouseEvents===!1&&I(this._mouseEvents,p)!==-1)return}},_draggableMoved:function(c){return c=c.dragging&&c.dragging.enabled()?c:this,c.dragging&&c.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var c=0,p=this._handlers.length;c<p;c++)this._handlers[c].disable()},whenReady:function(c,p){return this._loaded?c.call(p||this,{target:this}):this.on("load",c,p),this},_getMapPanePos:function(){return Lr(this._mapPane)||new ie(0,0)},_moved:function(){var c=this._getMapPanePos();return c&&!c.equals([0,0])},_getTopLeftPoint:function(c,p){var T=c&&p!==void 0?this._getNewPixelOrigin(c,p):this.getPixelOrigin();return T.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(c,p){var T=this.getSize()._divideBy(2);return this.project(c,p)._subtract(T)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(c,p,T){var V=this._getNewPixelOrigin(T,p);return this.project(c,p)._subtract(V)},_latLngBoundsToNewLayerBounds:function(c,p,T){var V=this._getNewPixelOrigin(T,p);return Z([this.project(c.getSouthWest(),p)._subtract(V),this.project(c.getNorthWest(),p)._subtract(V),this.project(c.getSouthEast(),p)._subtract(V),this.project(c.getNorthEast(),p)._subtract(V)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(c){return this.latLngToLayerPoint(c).subtract(this._getCenterLayerPoint())},_limitCenter:function(c,p,T){if(!T)return c;var V=this.project(c,p),W=this.getSize().divideBy(2),ne=new B(V.subtract(W),V.add(W)),de=this._getBoundsOffset(ne,T,p);return Math.abs(de.x)<=1&&Math.abs(de.y)<=1?c:this.unproject(V.add(de),p)},_limitOffset:function(c,p){if(!p)return c;var T=this.getPixelBounds(),V=new B(T.min.add(c),T.max.add(c));return c.add(this._getBoundsOffset(V,p))},_getBoundsOffset:function(c,p,T){var V=Z(this.project(p.getNorthEast(),T),this.project(p.getSouthWest(),T)),W=V.min.subtract(c.min),ne=V.max.subtract(c.max),de=this._rebound(W.x,-ne.x),ve=this._rebound(W.y,-ne.y);return new ie(de,ve)},_rebound:function(c,p){return c+p>0?Math.round(c-p)/2:Math.max(0,Math.ceil(c))-Math.max(0,Math.floor(p))},_limitZoom:function(c){var p=this.getMinZoom(),T=this.getMaxZoom(),V=$e.any3d?this.options.zoomSnap:1;return V&&(c=Math.round(c/V)*V),Math.max(p,Math.min(T,c))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){un(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(c,p){var T=this._getCenterOffset(c)._trunc();return(p&&p.animate)!==!0&&!this.getSize().contains(T)?!1:(this.panBy(T,p),!0)},_createAnimProxy:function(){var c=this._proxy=vt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(c),this.on("zoomanim",function(p){var T=Ui,V=this._proxy.style[T];Dr(this._proxy,this.project(p.center,p.zoom),this.getZoomScale(p.zoom,1)),V===this._proxy.style[T]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){cn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var c=this.getCenter(),p=this.getZoom();Dr(this._proxy,this.project(c,p),this.getZoomScale(p,1))},_catchTransitionEnd:function(c){this._animatingZoom&&c.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(c,p,T){if(this._animatingZoom)return!0;if(T=T||{},!this._zoomAnimated||T.animate===!1||this._nothingToAnimate()||Math.abs(p-this._zoom)>this.options.zoomAnimationThreshold)return!1;var V=this.getZoomScale(p),W=this._getCenterOffset(c)._divideBy(1-1/V);return T.animate!==!0&&!this.getSize().contains(W)?!1:(C(function(){this._moveStart(!0,T.noMoveStart||!1)._animateZoom(c,p,!0)},this),!0)},_animateZoom:function(c,p,T,V){this._mapPane&&(T&&(this._animatingZoom=!0,this._animateToCenter=c,this._animateToZoom=p,yt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:c,zoom:p,noUpdate:V}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&un(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function ri(c,p){return new jt(c,p)}var vr=$.extend({options:{position:"topright"},initialize:function(c){x(this,c)},getPosition:function(){return this.options.position},setPosition:function(c){var p=this._map;return p&&p.removeControl(this),this.options.position=c,p&&p.addControl(this),this},getContainer:function(){return this._container},addTo:function(c){this.remove(),this._map=c;var p=this._container=this.onAdd(c),T=this.getPosition(),V=c._controlCorners[T];return yt(p,"leaflet-control"),T.indexOf("bottom")!==-1?V.insertBefore(p,V.firstChild):V.appendChild(p),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(cn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(c){this._map&&c&&c.screenX>0&&c.screenY>0&&this._map.getContainer().focus()}}),Qn=function(c){return new vr(c)};jt.include({addControl:function(c){return c.addTo(this),this},removeControl:function(c){return c.remove(),this},_initControlPos:function(){var c=this._controlCorners={},p="leaflet-",T=this._controlContainer=vt("div",p+"control-container",this._container);function V(W,ne){var de=p+W+" "+p+ne;c[W+ne]=vt("div",de,T)}V("top","left"),V("top","right"),V("bottom","left"),V("bottom","right")},_clearControlPos:function(){for(var c in this._controlCorners)cn(this._controlCorners[c]);cn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Ba=vr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(c,p,T,V){return T<V?-1:V<T?1:0}},initialize:function(c,p,T){x(this,T),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var V in c)this._addLayer(c[V],V);for(V in p)this._addLayer(p[V],V,!0)},onAdd:function(c){this._initLayout(),this._update(),this._map=c,c.on("zoomend",this._checkDisabledLayers,this);for(var p=0;p<this._layers.length;p++)this._layers[p].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(c){return vr.prototype.addTo.call(this,c),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(c,p){return this._addLayer(c,p),this._map?this._update():this},addOverlay:function(c,p){return this._addLayer(c,p,!0),this._map?this._update():this},removeLayer:function(c){c.off("add remove",this._onLayerChange,this);var p=this._getLayer(d(c));return p&&this._layers.splice(this._layers.indexOf(p),1),this._map?this._update():this},expand:function(){yt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var c=this._map.getSize().y-(this._container.offsetTop+50);return c<this._section.clientHeight?(yt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=c+"px"):un(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return un(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var c="leaflet-control-layers",p=this._container=vt("div",c),T=this.options.collapsed;p.setAttribute("aria-haspopup",!0),fo(p),Bs(p);var V=this._section=vt("section",c+"-list");T&&(this._map.on("click",this.collapse,this),lt(p,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var W=this._layersLink=vt("a",c+"-toggle",p);W.href="#",W.title="Layers",W.setAttribute("role","button"),lt(W,{keydown:function(ne){ne.keyCode===13&&this._expandSafely()},click:function(ne){dn(ne),this._expandSafely()}},this),T||this.expand(),this._baseLayersList=vt("div",c+"-base",V),this._separator=vt("div",c+"-separator",V),this._overlaysList=vt("div",c+"-overlays",V),p.appendChild(V)},_getLayer:function(c){for(var p=0;p<this._layers.length;p++)if(this._layers[p]&&d(this._layers[p].layer)===c)return this._layers[p]},_addLayer:function(c,p,T){this._map&&c.on("add remove",this._onLayerChange,this),this._layers.push({layer:c,name:p,overlay:T}),this.options.sortLayers&&this._layers.sort(o(function(V,W){return this.options.sortFunction(V.layer,W.layer,V.name,W.name)},this)),this.options.autoZIndex&&c.setZIndex&&(this._lastZIndex++,c.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Bo(this._baseLayersList),Bo(this._overlaysList),this._layerControlInputs=[];var c,p,T,V,W=0;for(T=0;T<this._layers.length;T++)V=this._layers[T],this._addItem(V),p=p||V.overlay,c=c||!V.overlay,W+=V.overlay?0:1;return this.options.hideSingleBase&&(c=c&&W>1,this._baseLayersList.style.display=c?"":"none"),this._separator.style.display=p&&c?"":"none",this},_onLayerChange:function(c){this._handlingClick||this._update();var p=this._getLayer(d(c.target)),T=p.overlay?c.type==="add"?"overlayadd":"overlayremove":c.type==="add"?"baselayerchange":null;T&&this._map.fire(T,p)},_createRadioElement:function(c,p){var T='<input type="radio" class="leaflet-control-layers-selector" name="'+c+'"'+(p?' checked="checked"':"")+"/>",V=document.createElement("div");return V.innerHTML=T,V.firstChild},_addItem:function(c){var p=document.createElement("label"),T=this._map.hasLayer(c.layer),V;c.overlay?(V=document.createElement("input"),V.type="checkbox",V.className="leaflet-control-layers-selector",V.defaultChecked=T):V=this._createRadioElement("leaflet-base-layers_"+d(this),T),this._layerControlInputs.push(V),V.layerId=d(c.layer),lt(V,"click",this._onInputClick,this);var W=document.createElement("span");W.innerHTML=" "+c.name;var ne=document.createElement("span");p.appendChild(ne),ne.appendChild(V),ne.appendChild(W);var de=c.overlay?this._overlaysList:this._baseLayersList;return de.appendChild(p),this._checkDisabledLayers(),p},_onInputClick:function(){if(!this._preventClick){var c=this._layerControlInputs,p,T,V=[],W=[];this._handlingClick=!0;for(var ne=c.length-1;ne>=0;ne--)p=c[ne],T=this._getLayer(p.layerId).layer,p.checked?V.push(T):p.checked||W.push(T);for(ne=0;ne<W.length;ne++)this._map.hasLayer(W[ne])&&this._map.removeLayer(W[ne]);for(ne=0;ne<V.length;ne++)this._map.hasLayer(V[ne])||this._map.addLayer(V[ne]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var c=this._layerControlInputs,p,T,V=this._map.getZoom(),W=c.length-1;W>=0;W--)p=c[W],T=this._getLayer(p.layerId).layer,p.disabled=T.options.minZoom!==void 0&&V<T.options.minZoom||T.options.maxZoom!==void 0&&V>T.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var c=this._section;this._preventClick=!0,lt(c,"click",dn),this.expand();var p=this;setTimeout(function(){nn(c,"click",dn),p._preventClick=!1})}}),Ua=function(c,p,T){return new Ba(c,p,T)},Si=vr.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(c){var p="leaflet-control-zoom",T=vt("div",p+" leaflet-bar"),V=this.options;return this._zoomInButton=this._createButton(V.zoomInText,V.zoomInTitle,p+"-in",T,this._zoomIn),this._zoomOutButton=this._createButton(V.zoomOutText,V.zoomOutTitle,p+"-out",T,this._zoomOut),this._updateDisabled(),c.on("zoomend zoomlevelschange",this._updateDisabled,this),T},onRemove:function(c){c.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(c){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(c.shiftKey?3:1))},_zoomOut:function(c){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(c.shiftKey?3:1))},_createButton:function(c,p,T,V,W){var ne=vt("a",T,V);return ne.innerHTML=c,ne.href="#",ne.title=p,ne.setAttribute("role","button"),ne.setAttribute("aria-label",p),fo(ne),lt(ne,"click",or),lt(ne,"click",W,this),lt(ne,"click",this._refocusOnMap,this),ne},_updateDisabled:function(){var c=this._map,p="leaflet-disabled";un(this._zoomInButton,p),un(this._zoomOutButton,p),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||c._zoom===c.getMinZoom())&&(yt(this._zoomOutButton,p),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||c._zoom===c.getMaxZoom())&&(yt(this._zoomInButton,p),this._zoomInButton.setAttribute("aria-disabled","true"))}});jt.mergeOptions({zoomControl:!0}),jt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Si,this.addControl(this.zoomControl))});var cc=function(c){return new Si(c)},Xn=vr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(c){var p="leaflet-control-scale",T=vt("div",p),V=this.options;return this._addScales(V,p+"-line",T),c.on(V.updateWhenIdle?"moveend":"move",this._update,this),c.whenReady(this._update,this),T},onRemove:function(c){c.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(c,p,T){c.metric&&(this._mScale=vt("div",p,T)),c.imperial&&(this._iScale=vt("div",p,T))},_update:function(){var c=this._map,p=c.getSize().y/2,T=c.distance(c.containerPointToLatLng([0,p]),c.containerPointToLatLng([this.options.maxWidth,p]));this._updateScales(T)},_updateScales:function(c){this.options.metric&&c&&this._updateMetric(c),this.options.imperial&&c&&this._updateImperial(c)},_updateMetric:function(c){var p=this._getRoundNum(c),T=p<1e3?p+" m":p/1e3+" km";this._updateScale(this._mScale,T,p/c)},_updateImperial:function(c){var p=c*3.2808399,T,V,W;p>5280?(T=p/5280,V=this._getRoundNum(T),this._updateScale(this._iScale,V+" mi",V/T)):(W=this._getRoundNum(p),this._updateScale(this._iScale,W+" ft",W/p))},_updateScale:function(c,p,T){c.style.width=Math.round(this.options.maxWidth*T)+"px",c.innerHTML=p},_getRoundNum:function(c){var p=Math.pow(10,(Math.floor(c)+"").length-1),T=c/p;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:1,p*T}}),Wi=function(c){return new Xn(c)},qa='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Ai=vr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+($e.inlineSvg?qa+" ":"")+"Leaflet</a>"},initialize:function(c){x(this,c),this._attributions={}},onAdd:function(c){c.attributionControl=this,this._container=vt("div","leaflet-control-attribution"),fo(this._container);for(var p in c._layers)c._layers[p].getAttribution&&this.addAttribution(c._layers[p].getAttribution());return this._update(),c.on("layeradd",this._addAttribution,this),this._container},onRemove:function(c){c.off("layeradd",this._addAttribution,this)},_addAttribution:function(c){c.layer.getAttribution&&(this.addAttribution(c.layer.getAttribution()),c.layer.once("remove",function(){this.removeAttribution(c.layer.getAttribution())},this))},setPrefix:function(c){return this.options.prefix=c,this._update(),this},addAttribution:function(c){return c?(this._attributions[c]||(this._attributions[c]=0),this._attributions[c]++,this._update(),this):this},removeAttribution:function(c){return c?(this._attributions[c]&&(this._attributions[c]--,this._update()),this):this},_update:function(){if(this._map){var c=[];for(var p in this._attributions)this._attributions[p]&&c.push(p);var T=[];this.options.prefix&&T.push(this.options.prefix),c.length&&T.push(c.join(", ")),this._container.innerHTML=T.join(' <span aria-hidden="true">|</span> ')}}});jt.mergeOptions({attributionControl:!0}),jt.addInitHook(function(){this.options.attributionControl&&new Ai().addTo(this)});var Wd=function(c){return new Ai(c)};vr.Layers=Ba,vr.Zoom=Si,vr.Scale=Xn,vr.Attribution=Ai,Qn.layers=Ua,Qn.zoom=cc,Qn.scale=Wi,Qn.attribution=Wd;var Ir=$.extend({initialize:function(c){this._map=c},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Ir.addTo=function(c,p){return c.addHandler(p,this),this};var qs={Events:re},Hs=$e.touch?"touchstart mousedown":"mousedown",Fr=oe.extend({options:{clickTolerance:3},initialize:function(c,p,T,V){x(this,V),this._element=c,this._dragStartTarget=p||c,this._preventOutline=T},enable:function(){this._enabled||(lt(this._dragStartTarget,Hs,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Fr._dragging===this&&this.finishDrag(!0),nn(this._dragStartTarget,Hs,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(c){if(this._enabled&&(this._moved=!1,!uo(this._element,"leaflet-zoom-anim"))){if(c.touches&&c.touches.length!==1){Fr._dragging===this&&this.finishDrag();return}if(!(Fr._dragging||c.shiftKey||c.which!==1&&c.button!==1&&!c.touches)&&(Fr._dragging=this,this._preventOutline&&Ei(this._element),Fa(),Rt(),!this._moving)){this.fire("down");var p=c.touches?c.touches[0]:c,T=Ti(this._element);this._startPoint=new ie(p.clientX,p.clientY),this._startPos=Lr(this._element),this._parentScale=ni(T);var V=c.type==="mousedown";lt(document,V?"mousemove":"touchmove",this._onMove,this),lt(document,V?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(c){if(this._enabled){if(c.touches&&c.touches.length>1){this._moved=!0;return}var p=c.touches&&c.touches.length===1?c.touches[0]:c,T=new ie(p.clientX,p.clientY)._subtract(this._startPoint);!T.x&&!T.y||Math.abs(T.x)+Math.abs(T.y)<this.options.clickTolerance||(T.x/=this._parentScale.x,T.y/=this._parentScale.y,dn(c),this._moved||(this.fire("dragstart"),this._moved=!0,yt(document.body,"leaflet-dragging"),this._lastTarget=c.target||c.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),yt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(T),this._moving=!0,this._lastEvent=c,this._updatePosition())}},_updatePosition:function(){var c={originalEvent:this._lastEvent};this.fire("predrag",c),_t(this._element,this._newPos),this.fire("drag",c)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(c){un(document.body,"leaflet-dragging"),this._lastTarget&&(un(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),nn(document,"mousemove touchmove",this._onMove,this),nn(document,"mouseup touchend touchcancel",this._onUp,this),Va(),wi();var p=this._moved&&this._moving;this._moving=!1,Fr._dragging=!1,p&&this.fire("dragend",{noInertia:c,distance:this._newPos.distanceTo(this._startPos)})}});function Ko(c,p,T){var V,W=[1,4,2,8],ne,de,ve,we,Ce,He,dt,Pt;for(ne=0,He=c.length;ne<He;ne++)c[ne]._code=cs(c[ne],p);for(ve=0;ve<4;ve++){for(dt=W[ve],V=[],ne=0,He=c.length,de=He-1;ne<He;de=ne++)we=c[ne],Ce=c[de],we._code&dt?Ce._code&dt||(Pt=Jn(Ce,we,dt,p,T),Pt._code=cs(Pt,p),V.push(Pt)):(Ce._code&dt&&(Pt=Jn(Ce,we,dt,p,T),Pt._code=cs(Pt,p),V.push(Pt)),V.push(we));c=V}return c}function Ha(c,p){var T,V,W,ne,de,ve,we,Ce,He;if(!c||c.length===0)throw new Error("latlngs not passed");b(c)||(console.warn("latlngs are not flat! Only the first ring will be used"),c=c[0]);var dt=Q([0,0]),Pt=se(c),ar=Pt.getNorthWest().distanceTo(Pt.getSouthWest())*Pt.getNorthEast().distanceTo(Pt.getNorthWest());ar<1700&&(dt=$a(c));var er=c.length,si=[];for(T=0;T<er;T++){var zr=Q(c[T]);si.push(p.project(Q([zr.lat-dt.lat,zr.lng-dt.lng])))}for(ve=we=Ce=0,T=0,V=er-1;T<er;V=T++)W=si[T],ne=si[V],de=W.y*ne.x-ne.y*W.x,we+=(W.x+ne.x)*de,Ce+=(W.y+ne.y)*de,ve+=de*3;ve===0?He=si[0]:He=[we/ve,Ce/ve];var il=p.unproject(Y(He));return Q([il.lat+dt.lat,il.lng+dt.lng])}function $a(c){for(var p=0,T=0,V=0,W=0;W<c.length;W++){var ne=Q(c[W]);p+=ne.lat,T+=ne.lng,V++}return Q([p/V,T/V])}var Wa={__proto__:null,clipPolygon:Ko,polygonCenter:Ha,centroid:$a};function Yo(c,p){if(!p||!c.length)return c.slice();var T=p*p;return c=_u(c,T),c=vu(c,T),c}function uc(c,p,T){return Math.sqrt(Vr(c,p,T,!0))}function $s(c,p,T){return Vr(c,p,T)}function vu(c,p){var T=c.length,V=typeof Uint8Array<"u"?Uint8Array:Array,W=new V(T);W[0]=W[T-1]=1,Ga(c,W,p,0,T-1);var ne,de=[];for(ne=0;ne<T;ne++)W[ne]&&de.push(c[ne]);return de}function Ga(c,p,T,V,W){var ne=0,de,ve,we;for(ve=V+1;ve<=W-1;ve++)we=Vr(c[ve],c[V],c[W],!0),we>ne&&(de=ve,ne=we);ne>T&&(p[de]=1,Ga(c,p,T,V,de),Ga(c,p,T,de,W))}function _u(c,p){for(var T=[c[0]],V=1,W=0,ne=c.length;V<ne;V++)xu(c[V],c[W])>p&&(T.push(c[V]),W=V);return W<ne-1&&T.push(c[ne-1]),T}var Ka;function Zo(c,p,T,V,W){var ne=V?Ka:cs(c,T),de=cs(p,T),ve,we,Ce;for(Ka=de;;){if(!(ne|de))return[c,p];if(ne&de)return!1;ve=ne||de,we=Jn(c,p,ve,T,W),Ce=cs(we,T),ve===ne?(c=we,ne=Ce):(p=we,de=Ce)}}function Jn(c,p,T,V,W){var ne=p.x-c.x,de=p.y-c.y,ve=V.min,we=V.max,Ce,He;return T&8?(Ce=c.x+ne*(we.y-c.y)/de,He=we.y):T&4?(Ce=c.x+ne*(ve.y-c.y)/de,He=ve.y):T&2?(Ce=we.x,He=c.y+de*(we.x-c.x)/ne):T&1&&(Ce=ve.x,He=c.y+de*(ve.x-c.x)/ne),new ie(Ce,He,W)}function cs(c,p){var T=0;return c.x<p.min.x?T|=1:c.x>p.max.x&&(T|=2),c.y<p.min.y?T|=4:c.y>p.max.y&&(T|=8),T}function xu(c,p){var T=p.x-c.x,V=p.y-c.y;return T*T+V*V}function Vr(c,p,T,V){var W=p.x,ne=p.y,de=T.x-W,ve=T.y-ne,we=de*de+ve*ve,Ce;return we>0&&(Ce=((c.x-W)*de+(c.y-ne)*ve)/we,Ce>1?(W=T.x,ne=T.y):Ce>0&&(W+=de*Ce,ne+=ve*Ce)),de=c.x-W,ve=c.y-ne,V?de*de+ve*ve:new ie(W,ne)}function b(c){return!P(c[0])||typeof c[0][0]!="object"&&typeof c[0][0]<"u"}function q(c){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),b(c)}function K(c,p){var T,V,W,ne,de,ve,we,Ce;if(!c||c.length===0)throw new Error("latlngs not passed");b(c)||(console.warn("latlngs are not flat! Only the first ring will be used"),c=c[0]);var He=Q([0,0]),dt=se(c),Pt=dt.getNorthWest().distanceTo(dt.getSouthWest())*dt.getNorthEast().distanceTo(dt.getNorthWest());Pt<1700&&(He=$a(c));var ar=c.length,er=[];for(T=0;T<ar;T++){var si=Q(c[T]);er.push(p.project(Q([si.lat-He.lat,si.lng-He.lng])))}for(T=0,V=0;T<ar-1;T++)V+=er[T].distanceTo(er[T+1])/2;if(V===0)Ce=er[0];else for(T=0,ne=0;T<ar-1;T++)if(de=er[T],ve=er[T+1],W=de.distanceTo(ve),ne+=W,ne>V){we=(ne-V)/W,Ce=[ve.x-we*(ve.x-de.x),ve.y-we*(ve.y-de.y)];break}var zr=p.unproject(Y(Ce));return Q([zr.lat+He.lat,zr.lng+He.lng])}var le={__proto__:null,simplify:Yo,pointToSegmentDistance:uc,closestPointOnSegment:$s,clipSegment:Zo,_getEdgeIntersection:Jn,_getBitCode:cs,_sqClosestPointOnSegment:Vr,isFlat:b,_flat:q,polylineCenter:K},ye={project:function(c){return new ie(c.lng,c.lat)},unproject:function(c){return new ae(c.y,c.x)},bounds:new B([-180,-90],[180,90])},Te={R:6378137,R_MINOR:6356752314245179e-9,bounds:new B([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(c){var p=Math.PI/180,T=this.R,V=c.lat*p,W=this.R_MINOR/T,ne=Math.sqrt(1-W*W),de=ne*Math.sin(V),ve=Math.tan(Math.PI/4-V/2)/Math.pow((1-de)/(1+de),ne/2);return V=-T*Math.log(Math.max(ve,1e-10)),new ie(c.lng*p*T,V)},unproject:function(c){for(var p=180/Math.PI,T=this.R,V=this.R_MINOR/T,W=Math.sqrt(1-V*V),ne=Math.exp(-c.y/T),de=Math.PI/2-2*Math.atan(ne),ve=0,we=.1,Ce;ve<15&&Math.abs(we)>1e-7;ve++)Ce=W*Math.sin(de),Ce=Math.pow((1-Ce)/(1+Ce),W/2),we=Math.PI/2-2*Math.atan(ne*Ce)-de,de+=we;return new ae(de*p,c.x*p/T)}},Be={__proto__:null,LonLat:ye,Mercator:Te,SphericalMercator:Ae},tn=i({},me,{code:"EPSG:3395",projection:Te,transformation:function(){var c=.5/(Math.PI*Te.R);return Ye(c,.5,-c,.5)}()}),zn=i({},me,{code:"EPSG:4326",projection:ye,transformation:Ye(1/180,1,-1/180,.5)}),Bt=i({},ce,{projection:ye,transformation:Ye(1,0,-1,0),scale:function(c){return Math.pow(2,c)},zoom:function(c){return Math.log(c)/Math.LN2},distance:function(c,p){var T=p.lng-c.lng,V=p.lat-c.lat;return Math.sqrt(T*T+V*V)},infinite:!0});ce.Earth=me,ce.EPSG3395=tn,ce.EPSG3857=Ge,ce.EPSG900913=ot,ce.EPSG4326=zn,ce.Simple=Bt;var rn=oe.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(c){return c.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(c){return c&&c.removeLayer(this),this},getPane:function(c){return this._map.getPane(c?this.options[c]||c:this.options.pane)},addInteractiveTarget:function(c){return this._map._targets[d(c)]=this,this},removeInteractiveTarget:function(c){return delete this._map._targets[d(c)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(c){var p=c.target;if(p.hasLayer(this)){if(this._map=p,this._zoomAnimated=p._zoomAnimated,this.getEvents){var T=this.getEvents();p.on(T,this),this.once("remove",function(){p.off(T,this)},this)}this.onAdd(p),this.fire("add"),p.fire("layeradd",{layer:this})}}});jt.include({addLayer:function(c){if(!c._layerAdd)throw new Error("The provided object is not a Layer.");var p=d(c);return this._layers[p]?this:(this._layers[p]=c,c._mapToAdd=this,c.beforeAdd&&c.beforeAdd(this),this.whenReady(c._layerAdd,c),this)},removeLayer:function(c){var p=d(c);return this._layers[p]?(this._loaded&&c.onRemove(this),delete this._layers[p],this._loaded&&(this.fire("layerremove",{layer:c}),c.fire("remove")),c._map=c._mapToAdd=null,this):this},hasLayer:function(c){return d(c)in this._layers},eachLayer:function(c,p){for(var T in this._layers)c.call(p,this._layers[T]);return this},_addLayers:function(c){c=c?P(c)?c:[c]:[];for(var p=0,T=c.length;p<T;p++)this.addLayer(c[p])},_addZoomLimit:function(c){(!isNaN(c.options.maxZoom)||!isNaN(c.options.minZoom))&&(this._zoomBoundLayers[d(c)]=c,this._updateZoomLevels())},_removeZoomLimit:function(c){var p=d(c);this._zoomBoundLayers[p]&&(delete this._zoomBoundLayers[p],this._updateZoomLevels())},_updateZoomLevels:function(){var c=1/0,p=-1/0,T=this._getZoomSpan();for(var V in this._zoomBoundLayers){var W=this._zoomBoundLayers[V].options;c=W.minZoom===void 0?c:Math.min(c,W.minZoom),p=W.maxZoom===void 0?p:Math.max(p,W.maxZoom)}this._layersMaxZoom=p===-1/0?void 0:p,this._layersMinZoom=c===1/0?void 0:c,T!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var wn=rn.extend({initialize:function(c,p){x(this,p),this._layers={};var T,V;if(c)for(T=0,V=c.length;T<V;T++)this.addLayer(c[T])},addLayer:function(c){var p=this.getLayerId(c);return this._layers[p]=c,this._map&&this._map.addLayer(c),this},removeLayer:function(c){var p=c in this._layers?c:this.getLayerId(c);return this._map&&this._layers[p]&&this._map.removeLayer(this._layers[p]),delete this._layers[p],this},hasLayer:function(c){var p=typeof c=="number"?c:this.getLayerId(c);return p in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(c){var p=Array.prototype.slice.call(arguments,1),T,V;for(T in this._layers)V=this._layers[T],V[c]&&V[c].apply(V,p);return this},onAdd:function(c){this.eachLayer(c.addLayer,c)},onRemove:function(c){this.eachLayer(c.removeLayer,c)},eachLayer:function(c,p){for(var T in this._layers)c.call(p,this._layers[T]);return this},getLayer:function(c){return this._layers[c]},getLayers:function(){var c=[];return this.eachLayer(c.push,c),c},setZIndex:function(c){return this.invoke("setZIndex",c)},getLayerId:function(c){return d(c)}}),Ni=function(c,p){return new wn(c,p)},Mn=wn.extend({addLayer:function(c){return this.hasLayer(c)?this:(c.addEventParent(this),wn.prototype.addLayer.call(this,c),this.fire("layeradd",{layer:c}))},removeLayer:function(c){return this.hasLayer(c)?(c in this._layers&&(c=this._layers[c]),c.removeEventParent(this),wn.prototype.removeLayer.call(this,c),this.fire("layerremove",{layer:c})):this},setStyle:function(c){return this.invoke("setStyle",c)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var c=new te;for(var p in this._layers){var T=this._layers[p];c.extend(T.getBounds?T.getBounds():T.getLatLng())}return c}}),Qo=function(c,p){return new Mn(c,p)},Gi=$.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(c){x(this,c)},createIcon:function(c){return this._createIcon("icon",c)},createShadow:function(c){return this._createIcon("shadow",c)},_createIcon:function(c,p){var T=this._getIconUrl(c);if(!T){if(c==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var V=this._createImg(T,p&&p.tagName==="IMG"?p:null);return this._setIconStyles(V,c),(this.options.crossOrigin||this.options.crossOrigin==="")&&(V.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),V},_setIconStyles:function(c,p){var T=this.options,V=T[p+"Size"];typeof V=="number"&&(V=[V,V]);var W=Y(V),ne=Y(p==="shadow"&&T.shadowAnchor||T.iconAnchor||W&&W.divideBy(2,!0));c.className="leaflet-marker-"+p+" "+(T.className||""),ne&&(c.style.marginLeft=-ne.x+"px",c.style.marginTop=-ne.y+"px"),W&&(c.style.width=W.x+"px",c.style.height=W.y+"px")},_createImg:function(c,p){return p=p||document.createElement("img"),p.src=c,p},_getIconUrl:function(c){return $e.retina&&this.options[c+"RetinaUrl"]||this.options[c+"Url"]}});function bm(c){return new Gi(c)}var Ya=Gi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(c){return typeof Ya.imagePath!="string"&&(Ya.imagePath=this._detectIconPath()),(this.options.imagePath||Ya.imagePath)+Gi.prototype._getIconUrl.call(this,c)},_stripUrl:function(c){var p=function(T,V,W){var ne=V.exec(T);return ne&&ne[W]};return c=p(c,/^url\((['"])?(.+)\1\)$/,2),c&&p(c,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var c=vt("div","leaflet-default-icon-path",document.body),p=co(c,"background-image")||co(c,"backgroundImage");if(document.body.removeChild(c),p=this._stripUrl(p),p)return p;var T=document.querySelector('link[href$="leaflet.css"]');return T?T.href.substring(0,T.href.length-11-1):""}}),Gd=Ir.extend({initialize:function(c){this._marker=c},addHooks:function(){var c=this._marker._icon;this._draggable||(this._draggable=new Fr(c,c,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),yt(c,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&un(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(c){var p=this._marker,T=p._map,V=this._marker.options.autoPanSpeed,W=this._marker.options.autoPanPadding,ne=Lr(p._icon),de=T.getPixelBounds(),ve=T.getPixelOrigin(),we=Z(de.min._subtract(ve).add(W),de.max._subtract(ve).subtract(W));if(!we.contains(ne)){var Ce=Y((Math.max(we.max.x,ne.x)-we.max.x)/(de.max.x-we.max.x)-(Math.min(we.min.x,ne.x)-we.min.x)/(de.min.x-we.min.x),(Math.max(we.max.y,ne.y)-we.max.y)/(de.max.y-we.max.y)-(Math.min(we.min.y,ne.y)-we.min.y)/(de.min.y-we.min.y)).multiplyBy(V);T.panBy(Ce,{animate:!1}),this._draggable._newPos._add(Ce),this._draggable._startPos._add(Ce),_t(p._icon,this._draggable._newPos),this._onDrag(c),this._panRequest=C(this._adjustPan.bind(this,c))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(c){this._marker.options.autoPan&&(D(this._panRequest),this._panRequest=C(this._adjustPan.bind(this,c)))},_onDrag:function(c){var p=this._marker,T=p._shadow,V=Lr(p._icon),W=p._map.layerPointToLatLng(V);T&&_t(T,V),p._latlng=W,c.latlng=W,c.oldLatLng=this._oldLatLng,p.fire("move",c).fire("drag",c)},_onDragEnd:function(c){D(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",c)}}),Ws=rn.extend({options:{icon:new Ya,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(c,p){x(this,p),this._latlng=Q(c)},onAdd:function(c){this._zoomAnimated=this._zoomAnimated&&c.options.markerZoomAnimation,this._zoomAnimated&&c.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(c){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&c.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(c){var p=this._latlng;return this._latlng=Q(c),this.update(),this.fire("move",{oldLatLng:p,latlng:this._latlng})},setZIndexOffset:function(c){return this.options.zIndexOffset=c,this.update()},getIcon:function(){return this.options.icon},setIcon:function(c){return this.options.icon=c,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var c=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(c)}return this},_initIcon:function(){var c=this.options,p="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),T=c.icon.createIcon(this._icon),V=!1;T!==this._icon&&(this._icon&&this._removeIcon(),V=!0,c.title&&(T.title=c.title),T.tagName==="IMG"&&(T.alt=c.alt||"")),yt(T,p),c.keyboard&&(T.tabIndex="0",T.setAttribute("role","button")),this._icon=T,c.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&lt(T,"focus",this._panOnFocus,this);var W=c.icon.createShadow(this._shadow),ne=!1;W!==this._shadow&&(this._removeShadow(),ne=!0),W&&(yt(W,p),W.alt=""),this._shadow=W,c.opacity<1&&this._updateOpacity(),V&&this.getPane().appendChild(this._icon),this._initInteraction(),W&&ne&&this.getPane(c.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&nn(this._icon,"focus",this._panOnFocus,this),cn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&cn(this._shadow),this._shadow=null},_setPos:function(c){this._icon&&_t(this._icon,c),this._shadow&&_t(this._shadow,c),this._zIndex=c.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(c){this._icon&&(this._icon.style.zIndex=this._zIndex+c)},_animateZoom:function(c){var p=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center).round();this._setPos(p)},_initInteraction:function(){if(this.options.interactive&&(yt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Gd)){var c=this.options.draggable;this.dragging&&(c=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Gd(this),c&&this.dragging.enable()}},setOpacity:function(c){return this.options.opacity=c,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var c=this.options.opacity;this._icon&&En(this._icon,c),this._shadow&&En(this._shadow,c)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var c=this._map;if(c){var p=this.options.icon.options,T=p.iconSize?Y(p.iconSize):Y(0,0),V=p.iconAnchor?Y(p.iconAnchor):Y(0,0);c.panInside(this._latlng,{paddingTopLeft:V,paddingBottomRight:T.subtract(V)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function n0(c,p){return new Ws(c,p)}var mo=rn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(c){this._renderer=c.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(c){return x(this,c),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&c&&Object.prototype.hasOwnProperty.call(c,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),bu=mo.extend({options:{fill:!0,radius:10},initialize:function(c,p){x(this,p),this._latlng=Q(c),this._radius=this.options.radius},setLatLng:function(c){var p=this._latlng;return this._latlng=Q(c),this.redraw(),this.fire("move",{oldLatLng:p,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(c){return this.options.radius=this._radius=c,this.redraw()},getRadius:function(){return this._radius},setStyle:function(c){var p=c&&c.radius||this._radius;return mo.prototype.setStyle.call(this,c),this.setRadius(p),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var c=this._radius,p=this._radiusY||c,T=this._clickTolerance(),V=[c+T,p+T];this._pxBounds=new B(this._point.subtract(V),this._point.add(V))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(c){return c.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function wm(c,p){return new bu(c,p)}var wu=bu.extend({initialize:function(c,p,T){if(typeof p=="number"&&(p=i({},T,{radius:p})),x(this,p),this._latlng=Q(c),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(c){return this._mRadius=c,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var c=[this._radius,this._radiusY||this._radius];return new te(this._map.layerPointToLatLng(this._point.subtract(c)),this._map.layerPointToLatLng(this._point.add(c)))},setStyle:mo.prototype.setStyle,_project:function(){var c=this._latlng.lng,p=this._latlng.lat,T=this._map,V=T.options.crs;if(V.distance===me.distance){var W=Math.PI/180,ne=this._mRadius/me.R/W,de=T.project([p+ne,c]),ve=T.project([p-ne,c]),we=de.add(ve).divideBy(2),Ce=T.unproject(we).lat,He=Math.acos((Math.cos(ne*W)-Math.sin(p*W)*Math.sin(Ce*W))/(Math.cos(p*W)*Math.cos(Ce*W)))/W;(isNaN(He)||He===0)&&(He=ne/Math.cos(Math.PI/180*p)),this._point=we.subtract(T.getPixelOrigin()),this._radius=isNaN(He)?0:we.x-T.project([Ce,c-He]).x,this._radiusY=we.y-de.y}else{var dt=V.unproject(V.project(this._latlng).subtract([this._mRadius,0]));this._point=T.latLngToLayerPoint(this._latlng),this._radius=this._point.x-T.latLngToLayerPoint(dt).x}this._updateBounds()}});function dc(c,p,T){return new wu(c,p,T)}var ii=mo.extend({options:{smoothFactor:1,noClip:!1},initialize:function(c,p){x(this,p),this._setLatLngs(c)},getLatLngs:function(){return this._latlngs},setLatLngs:function(c){return this._setLatLngs(c),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(c){for(var p=1/0,T=null,V=Vr,W,ne,de=0,ve=this._parts.length;de<ve;de++)for(var we=this._parts[de],Ce=1,He=we.length;Ce<He;Ce++){W=we[Ce-1],ne=we[Ce];var dt=V(c,W,ne,!0);dt<p&&(p=dt,T=V(c,W,ne))}return T&&(T.distance=Math.sqrt(p)),T},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return K(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(c,p){return p=p||this._defaultShape(),c=Q(c),p.push(c),this._bounds.extend(c),this.redraw()},_setLatLngs:function(c){this._bounds=new te,this._latlngs=this._convertLatLngs(c)},_defaultShape:function(){return b(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(c){for(var p=[],T=b(c),V=0,W=c.length;V<W;V++)T?(p[V]=Q(c[V]),this._bounds.extend(p[V])):p[V]=this._convertLatLngs(c[V]);return p},_project:function(){var c=new B;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,c),this._bounds.isValid()&&c.isValid()&&(this._rawPxBounds=c,this._updateBounds())},_updateBounds:function(){var c=this._clickTolerance(),p=new ie(c,c);this._rawPxBounds&&(this._pxBounds=new B([this._rawPxBounds.min.subtract(p),this._rawPxBounds.max.add(p)]))},_projectLatlngs:function(c,p,T){var V=c[0]instanceof ae,W=c.length,ne,de;if(V){for(de=[],ne=0;ne<W;ne++)de[ne]=this._map.latLngToLayerPoint(c[ne]),T.extend(de[ne]);p.push(de)}else for(ne=0;ne<W;ne++)this._projectLatlngs(c[ne],p,T)},_clipPoints:function(){var c=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(c))){if(this.options.noClip){this._parts=this._rings;return}var p=this._parts,T,V,W,ne,de,ve,we;for(T=0,W=0,ne=this._rings.length;T<ne;T++)for(we=this._rings[T],V=0,de=we.length;V<de-1;V++)ve=Zo(we[V],we[V+1],c,V,!0),ve&&(p[W]=p[W]||[],p[W].push(ve[0]),(ve[1]!==we[V+1]||V===de-2)&&(p[W].push(ve[1]),W++))}},_simplifyPoints:function(){for(var c=this._parts,p=this.options.smoothFactor,T=0,V=c.length;T<V;T++)c[T]=Yo(c[T],p)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(c,p){var T,V,W,ne,de,ve,we=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(c))return!1;for(T=0,ne=this._parts.length;T<ne;T++)for(ve=this._parts[T],V=0,de=ve.length,W=de-1;V<de;W=V++)if(!(!p&&V===0)&&uc(c,ve[W],ve[V])<=we)return!0;return!1}});function r0(c,p){return new ii(c,p)}ii._flat=q;var Gs=ii.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Ha(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(c){var p=ii.prototype._convertLatLngs.call(this,c),T=p.length;return T>=2&&p[0]instanceof ae&&p[0].equals(p[T-1])&&p.pop(),p},_setLatLngs:function(c){ii.prototype._setLatLngs.call(this,c),b(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return b(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var c=this._renderer._bounds,p=this.options.weight,T=new ie(p,p);if(c=new B(c.min.subtract(T),c.max.add(T)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(c))){if(this.options.noClip){this._parts=this._rings;return}for(var V=0,W=this._rings.length,ne;V<W;V++)ne=Ko(this._rings[V],c,!0),ne.length&&this._parts.push(ne)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(c){var p=!1,T,V,W,ne,de,ve,we,Ce;if(!this._pxBounds||!this._pxBounds.contains(c))return!1;for(ne=0,we=this._parts.length;ne<we;ne++)for(T=this._parts[ne],de=0,Ce=T.length,ve=Ce-1;de<Ce;ve=de++)V=T[de],W=T[ve],V.y>c.y!=W.y>c.y&&c.x<(W.x-V.x)*(c.y-V.y)/(W.y-V.y)+V.x&&(p=!p);return p||ii.prototype._containsPoint.call(this,c,!0)}});function i0(c,p){return new Gs(c,p)}var us=Mn.extend({initialize:function(c,p){x(this,p),this._layers={},c&&this.addData(c)},addData:function(c){var p=P(c)?c:c.features,T,V,W;if(p){for(T=0,V=p.length;T<V;T++)W=p[T],(W.geometries||W.geometry||W.features||W.coordinates)&&this.addData(W);return this}var ne=this.options;if(ne.filter&&!ne.filter(c))return this;var de=Za(c,ne);return de?(de.feature=Nu(c),de.defaultOptions=de.options,this.resetStyle(de),ne.onEachFeature&&ne.onEachFeature(c,de),this.addLayer(de)):this},resetStyle:function(c){return c===void 0?this.eachLayer(this.resetStyle,this):(c.options=i({},c.defaultOptions),this._setLayerStyle(c,this.options.style),this)},setStyle:function(c){return this.eachLayer(function(p){this._setLayerStyle(p,c)},this)},_setLayerStyle:function(c,p){c.setStyle&&(typeof p=="function"&&(p=p(c.feature)),c.setStyle(p))}});function Za(c,p){var T=c.type==="Feature"?c.geometry:c,V=T?T.coordinates:null,W=[],ne=p&&p.pointToLayer,de=p&&p.coordsToLatLng||Tu,ve,we,Ce,He;if(!V&&!T)return null;switch(T.type){case"Point":return ve=de(V),Eu(ne,c,ve,p);case"MultiPoint":for(Ce=0,He=V.length;Ce<He;Ce++)ve=de(V[Ce]),W.push(Eu(ne,c,ve,p));return new Mn(W);case"LineString":case"MultiLineString":return we=hc(V,T.type==="LineString"?0:1,de),new ii(we,p);case"Polygon":case"MultiPolygon":return we=hc(V,T.type==="Polygon"?1:2,de),new Gs(we,p);case"GeometryCollection":for(Ce=0,He=T.geometries.length;Ce<He;Ce++){var dt=Za({geometry:T.geometries[Ce],type:"Feature",properties:c.properties},p);dt&&W.push(dt)}return new Mn(W);case"FeatureCollection":for(Ce=0,He=T.features.length;Ce<He;Ce++){var Pt=Za(T.features[Ce],p);Pt&&W.push(Pt)}return new Mn(W);default:throw new Error("Invalid GeoJSON object.")}}function Eu(c,p,T,V){return c?c(p,T):new Ws(T,V&&V.markersInheritOptions&&V)}function Tu(c){return new ae(c[1],c[0],c[2])}function hc(c,p,T){for(var V=[],W=0,ne=c.length,de;W<ne;W++)de=p?hc(c[W],p-1,T):(T||Tu)(c[W]),V.push(de);return V}function Su(c,p){return c=Q(c),c.alt!==void 0?[g(c.lng,p),g(c.lat,p),g(c.alt,p)]:[g(c.lng,p),g(c.lat,p)]}function Au(c,p,T,V){for(var W=[],ne=0,de=c.length;ne<de;ne++)W.push(p?Au(c[ne],b(c[ne])?0:p-1,T,V):Su(c[ne],V));return!p&&T&&W.length>0&&W.push(W[0].slice()),W}function Qa(c,p){return c.feature?i({},c.feature,{geometry:p}):Nu(p)}function Nu(c){return c.type==="Feature"||c.type==="FeatureCollection"?c:{type:"Feature",properties:{},geometry:c}}var Kd={toGeoJSON:function(c){return Qa(this,{type:"Point",coordinates:Su(this.getLatLng(),c)})}};Ws.include(Kd),wu.include(Kd),bu.include(Kd),ii.include({toGeoJSON:function(c){var p=!b(this._latlngs),T=Au(this._latlngs,p?1:0,!1,c);return Qa(this,{type:(p?"Multi":"")+"LineString",coordinates:T})}}),Gs.include({toGeoJSON:function(c){var p=!b(this._latlngs),T=p&&!b(this._latlngs[0]),V=Au(this._latlngs,T?2:p?1:0,!0,c);return p||(V=[V]),Qa(this,{type:(T?"Multi":"")+"Polygon",coordinates:V})}}),wn.include({toMultiPoint:function(c){var p=[];return this.eachLayer(function(T){p.push(T.toGeoJSON(c).geometry.coordinates)}),Qa(this,{type:"MultiPoint",coordinates:p})},toGeoJSON:function(c){var p=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(p==="MultiPoint")return this.toMultiPoint(c);var T=p==="GeometryCollection",V=[];return this.eachLayer(function(W){if(W.toGeoJSON){var ne=W.toGeoJSON(c);if(T)V.push(ne.geometry);else{var de=Nu(ne);de.type==="FeatureCollection"?V.push.apply(V,de.features):V.push(de)}}}),T?Qa(this,{geometries:V,type:"GeometryCollection"}):{type:"FeatureCollection",features:V}}});function Em(c,p){return new us(c,p)}var Ki=Em,po=rn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(c,p,T){this._url=c,this._bounds=se(p),x(this,T)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(yt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){cn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(c){return this.options.opacity=c,this._image&&this._updateOpacity(),this},setStyle:function(c){return c.opacity&&this.setOpacity(c.opacity),this},bringToFront:function(){return this._map&&zs(this._image),this},bringToBack:function(){return this._map&&Hi(this._image),this},setUrl:function(c){return this._url=c,this._image&&(this._image.src=c),this},setBounds:function(c){return this._bounds=se(c),this._map&&this._reset(),this},getEvents:function(){var c={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},setZIndex:function(c){return this.options.zIndex=c,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var c=this._url.tagName==="IMG",p=this._image=c?this._url:vt("img");if(yt(p,"leaflet-image-layer"),this._zoomAnimated&&yt(p,"leaflet-zoom-animated"),this.options.className&&yt(p,this.options.className),p.onselectstart=y,p.onmousemove=y,p.onload=o(this.fire,this,"load"),p.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),c){this._url=p.src;return}p.src=this._url,p.alt=this.options.alt},_animateZoom:function(c){var p=this._map.getZoomScale(c.zoom),T=this._map._latLngBoundsToNewLayerBounds(this._bounds,c.zoom,c.center).min;Dr(this._image,T,p)},_reset:function(){var c=this._image,p=new B(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),T=p.getSize();_t(c,p.min),c.style.width=T.x+"px",c.style.height=T.y+"px"},_updateOpacity:function(){En(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var c=this.options.errorOverlayUrl;c&&this._url!==c&&(this._url=c,this._image.src=c)},getCenter:function(){return this._bounds.getCenter()}}),Tm=function(c,p,T){return new po(c,p,T)},Yd=po.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var c=this._url.tagName==="VIDEO",p=this._image=c?this._url:vt("video");if(yt(p,"leaflet-image-layer"),this._zoomAnimated&&yt(p,"leaflet-zoom-animated"),this.options.className&&yt(p,this.options.className),p.onselectstart=y,p.onmousemove=y,p.onloadeddata=o(this.fire,this,"load"),c){for(var T=p.getElementsByTagName("source"),V=[],W=0;W<T.length;W++)V.push(T[W].src);this._url=T.length>0?V:[p.src];return}P(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(p.style,"objectFit")&&(p.style.objectFit="fill"),p.autoplay=!!this.options.autoplay,p.loop=!!this.options.loop,p.muted=!!this.options.muted,p.playsInline=!!this.options.playsInline;for(var ne=0;ne<this._url.length;ne++){var de=vt("source");de.src=this._url[ne],p.appendChild(de)}}});function Sm(c,p,T){return new Yd(c,p,T)}var Zd=po.extend({_initImage:function(){var c=this._image=this._url;yt(c,"leaflet-image-layer"),this._zoomAnimated&&yt(c,"leaflet-zoom-animated"),this.options.className&&yt(c,this.options.className),c.onselectstart=y,c.onmousemove=y}});function Qd(c,p,T){return new Zd(c,p,T)}var ds=rn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(c,p){c&&(c instanceof ae||P(c))?(this._latlng=Q(c),x(this,p)):(x(this,c),this._source=p),this.options.content&&(this._content=this.options.content)},openOn:function(c){return c=arguments.length?c:this._source._map,c.hasLayer(this)||c.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(c){return this._map?this.close():(arguments.length?this._source=c:c=this._source,this._prepareOpen(),this.openOn(c._map)),this},onAdd:function(c){this._zoomAnimated=c._zoomAnimated,this._container||this._initLayout(),c._fadeAnimated&&En(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),c._fadeAnimated&&En(this._container,1),this.bringToFront(),this.options.interactive&&(yt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(c){c._fadeAnimated?(En(this._container,0),this._removeTimeout=setTimeout(o(cn,void 0,this._container),200)):cn(this._container),this.options.interactive&&(un(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(c){return this._latlng=Q(c),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(c){return this._content=c,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var c={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&zs(this._container),this},bringToBack:function(){return this._map&&Hi(this._container),this},_prepareOpen:function(c){var p=this._source;if(!p._map)return!1;if(p instanceof Mn){p=null;var T=this._source._layers;for(var V in T)if(T[V]._map){p=T[V];break}if(!p)return!1;this._source=p}if(!c)if(p.getCenter)c=p.getCenter();else if(p.getLatLng)c=p.getLatLng();else if(p.getBounds)c=p.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(c),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var c=this._contentNode,p=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof p=="string")c.innerHTML=p;else{for(;c.hasChildNodes();)c.removeChild(c.firstChild);c.appendChild(p)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var c=this._map.latLngToLayerPoint(this._latlng),p=Y(this.options.offset),T=this._getAnchor();this._zoomAnimated?_t(this._container,c.add(T)):p=p.add(c).add(T);var V=this._containerBottom=-p.y,W=this._containerLeft=-Math.round(this._containerWidth/2)+p.x;this._container.style.bottom=V+"px",this._container.style.left=W+"px"}},_getAnchor:function(){return[0,0]}});jt.include({_initOverlay:function(c,p,T,V){var W=p;return W instanceof c||(W=new c(V).setContent(p)),T&&W.setLatLng(T),W}}),rn.include({_initOverlay:function(c,p,T,V){var W=T;return W instanceof c?(x(W,V),W._source=this):(W=p&&!V?p:new c(V,this),W.setContent(T)),W}});var Iu=ds.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(c){return c=arguments.length?c:this._source._map,!c.hasLayer(this)&&c._popup&&c._popup.options.autoClose&&c.removeLayer(c._popup),c._popup=this,ds.prototype.openOn.call(this,c)},onAdd:function(c){ds.prototype.onAdd.call(this,c),c.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof mo||this._source.on("preclick",Nr))},onRemove:function(c){ds.prototype.onRemove.call(this,c),c.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof mo||this._source.off("preclick",Nr))},getEvents:function(){var c=ds.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(c.preclick=this.close),this.options.keepInView&&(c.moveend=this._adjustPan),c},_initLayout:function(){var c="leaflet-popup",p=this._container=vt("div",c+" "+(this.options.className||"")+" leaflet-zoom-animated"),T=this._wrapper=vt("div",c+"-content-wrapper",p);if(this._contentNode=vt("div",c+"-content",T),fo(p),Bs(this._contentNode),lt(p,"contextmenu",Nr),this._tipContainer=vt("div",c+"-tip-container",p),this._tip=vt("div",c+"-tip",this._tipContainer),this.options.closeButton){var V=this._closeButton=vt("a",c+"-close-button",p);V.setAttribute("role","button"),V.setAttribute("aria-label","Close popup"),V.href="#close",V.innerHTML='<span aria-hidden="true">&#215;</span>',lt(V,"click",function(W){dn(W),this.close()},this)}},_updateLayout:function(){var c=this._contentNode,p=c.style;p.width="",p.whiteSpace="nowrap";var T=c.offsetWidth;T=Math.min(T,this.options.maxWidth),T=Math.max(T,this.options.minWidth),p.width=T+1+"px",p.whiteSpace="",p.height="";var V=c.offsetHeight,W=this.options.maxHeight,ne="leaflet-popup-scrolled";W&&V>W?(p.height=W+"px",yt(c,ne)):un(c,ne),this._containerWidth=this._container.offsetWidth},_animateZoom:function(c){var p=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center),T=this._getAnchor();_t(this._container,p.add(T))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var c=this._map,p=parseInt(co(this._container,"marginBottom"),10)||0,T=this._container.offsetHeight+p,V=this._containerWidth,W=new ie(this._containerLeft,-T-this._containerBottom);W._add(Lr(this._container));var ne=c.layerPointToContainerPoint(W),de=Y(this.options.autoPanPadding),ve=Y(this.options.autoPanPaddingTopLeft||de),we=Y(this.options.autoPanPaddingBottomRight||de),Ce=c.getSize(),He=0,dt=0;ne.x+V+we.x>Ce.x&&(He=ne.x+V-Ce.x+we.x),ne.x-He-ve.x<0&&(He=ne.x-ve.x),ne.y+T+we.y>Ce.y&&(dt=ne.y+T-Ce.y+we.y),ne.y-dt-ve.y<0&&(dt=ne.y-ve.y),(He||dt)&&(this.options.keepInView&&(this._autopanning=!0),c.fire("autopanstart").panBy([He,dt]))}},_getAnchor:function(){return Y(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),Xa=function(c,p){return new Iu(c,p)};jt.mergeOptions({closePopupOnClick:!0}),jt.include({openPopup:function(c,p,T){return this._initOverlay(Iu,c,p,T).openOn(this),this},closePopup:function(c){return c=arguments.length?c:this._popup,c&&c.close(),this}}),rn.include({bindPopup:function(c,p){return this._popup=this._initOverlay(Iu,this._popup,c,p),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(c){return this._popup&&(this instanceof Mn||(this._popup._source=this),this._popup._prepareOpen(c||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(c){return this._popup&&this._popup.setContent(c),this},getPopup:function(){return this._popup},_openPopup:function(c){if(!(!this._popup||!this._map)){or(c);var p=c.layer||c.target;if(this._popup._source===p&&!(p instanceof mo)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(c.latlng);return}this._popup._source=p,this.openPopup(c.latlng)}},_movePopup:function(c){this._popup.setLatLng(c.latlng)},_onKeyPress:function(c){c.originalEvent.keyCode===13&&this._openPopup(c)}});var Ja=ds.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(c){ds.prototype.onAdd.call(this,c),this.setOpacity(this.options.opacity),c.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(c){ds.prototype.onRemove.call(this,c),c.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var c=ds.prototype.getEvents.call(this);return this.options.permanent||(c.preclick=this.close),c},_initLayout:function(){var c="leaflet-tooltip",p=c+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=vt("div",p),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(c){var p,T,V=this._map,W=this._container,ne=V.latLngToContainerPoint(V.getCenter()),de=V.layerPointToContainerPoint(c),ve=this.options.direction,we=W.offsetWidth,Ce=W.offsetHeight,He=Y(this.options.offset),dt=this._getAnchor();ve==="top"?(p=we/2,T=Ce):ve==="bottom"?(p=we/2,T=0):ve==="center"?(p=we/2,T=Ce/2):ve==="right"?(p=0,T=Ce/2):ve==="left"?(p=we,T=Ce/2):de.x<ne.x?(ve="right",p=0,T=Ce/2):(ve="left",p=we+(He.x+dt.x)*2,T=Ce/2),c=c.subtract(Y(p,T,!0)).add(He).add(dt),un(W,"leaflet-tooltip-right"),un(W,"leaflet-tooltip-left"),un(W,"leaflet-tooltip-top"),un(W,"leaflet-tooltip-bottom"),yt(W,"leaflet-tooltip-"+ve),_t(W,c)},_updatePosition:function(){var c=this._map.latLngToLayerPoint(this._latlng);this._setPosition(c)},setOpacity:function(c){this.options.opacity=c,this._container&&En(this._container,c)},_animateZoom:function(c){var p=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center);this._setPosition(p)},_getAnchor:function(){return Y(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),fc=function(c,p){return new Ja(c,p)};jt.include({openTooltip:function(c,p,T){return this._initOverlay(Ja,c,p,T).openOn(this),this},closeTooltip:function(c){return c.close(),this}}),rn.include({bindTooltip:function(c,p){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(Ja,this._tooltip,c,p),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(c){if(!(!c&&this._tooltipHandlersAdded)){var p=c?"off":"on",T={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?T.add=this._openTooltip:(T.mouseover=this._openTooltip,T.mouseout=this.closeTooltip,T.click=this._openTooltip,this._map?this._addFocusListeners():T.add=this._addFocusListeners),this._tooltip.options.sticky&&(T.mousemove=this._moveTooltip),this[p](T),this._tooltipHandlersAdded=!c}},openTooltip:function(c){return this._tooltip&&(this instanceof Mn||(this._tooltip._source=this),this._tooltip._prepareOpen(c)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(c){return this._tooltip&&this._tooltip.setContent(c),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(c){var p=typeof c.getElement=="function"&&c.getElement();p&&(lt(p,"focus",function(){this._tooltip._source=c,this.openTooltip()},this),lt(p,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(c){var p=typeof c.getElement=="function"&&c.getElement();p&&p.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(c){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var p=this;this._map.once("moveend",function(){p._openOnceFlag=!1,p._openTooltip(c)});return}this._tooltip._source=c.layer||c.target,this.openTooltip(this._tooltip.options.sticky?c.latlng:void 0)}},_moveTooltip:function(c){var p=c.latlng,T,V;this._tooltip.options.sticky&&c.originalEvent&&(T=this._map.mouseEventToContainerPoint(c.originalEvent),V=this._map.containerPointToLayerPoint(T),p=this._map.layerPointToLatLng(V)),this._tooltip.setLatLng(p)}});var ku=Gi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(c){var p=c&&c.tagName==="DIV"?c:document.createElement("div"),T=this.options;if(T.html instanceof Element?(Bo(p),p.appendChild(T.html)):p.innerHTML=T.html!==!1?T.html:"",T.bgPos){var V=Y(T.bgPos);p.style.backgroundPosition=-V.x+"px "+-V.y+"px"}return this._setIconStyles(p,"icon"),p},createShadow:function(){return null}});function Am(c){return new ku(c)}Gi.Default=Ya;var go=rn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:$e.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(c){x(this,c)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(c){c._addZoomLimit(this)},onRemove:function(c){this._removeAllTiles(),cn(this._container),c._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(zs(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Hi(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(c){return this.options.opacity=c,this._updateOpacity(),this},setZIndex:function(c){return this.options.zIndex=c,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var c=this._clampZoom(this._map.getZoom());c!==this._tileZoom&&(this._tileZoom=c,this._updateLevels()),this._update()}return this},getEvents:function(){var c={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),c.move=this._onMove),this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},createTile:function(){return document.createElement("div")},getTileSize:function(){var c=this.options.tileSize;return c instanceof ie?c:new ie(c,c)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(c){for(var p=this.getPane().children,T=-c(-1/0,1/0),V=0,W=p.length,ne;V<W;V++)ne=p[V].style.zIndex,p[V]!==this._container&&ne&&(T=c(T,+ne));isFinite(T)&&(this.options.zIndex=T+c(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!$e.ielt9){En(this._container,this.options.opacity);var c=+new Date,p=!1,T=!1;for(var V in this._tiles){var W=this._tiles[V];if(!(!W.current||!W.loaded)){var ne=Math.min(1,(c-W.loaded)/200);En(W.el,ne),ne<1?p=!0:(W.active?T=!0:this._onOpaqueTile(W),W.active=!0)}}T&&!this._noPrune&&this._pruneTiles(),p&&(D(this._fadeFrame),this._fadeFrame=C(this._updateOpacity,this))}},_onOpaqueTile:y,_initContainer:function(){this._container||(this._container=vt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var c=this._tileZoom,p=this.options.maxZoom;if(c!==void 0){for(var T in this._levels)T=Number(T),this._levels[T].el.children.length||T===c?(this._levels[T].el.style.zIndex=p-Math.abs(c-T),this._onUpdateLevel(T)):(cn(this._levels[T].el),this._removeTilesAtZoom(T),this._onRemoveLevel(T),delete this._levels[T]);var V=this._levels[c],W=this._map;return V||(V=this._levels[c]={},V.el=vt("div","leaflet-tile-container leaflet-zoom-animated",this._container),V.el.style.zIndex=p,V.origin=W.project(W.unproject(W.getPixelOrigin()),c).round(),V.zoom=c,this._setZoomTransform(V,W.getCenter(),W.getZoom()),y(V.el.offsetWidth),this._onCreateLevel(V)),this._level=V,V}},_onUpdateLevel:y,_onRemoveLevel:y,_onCreateLevel:y,_pruneTiles:function(){if(this._map){var c,p,T=this._map.getZoom();if(T>this.options.maxZoom||T<this.options.minZoom){this._removeAllTiles();return}for(c in this._tiles)p=this._tiles[c],p.retain=p.current;for(c in this._tiles)if(p=this._tiles[c],p.current&&!p.active){var V=p.coords;this._retainParent(V.x,V.y,V.z,V.z-5)||this._retainChildren(V.x,V.y,V.z,V.z+2)}for(c in this._tiles)this._tiles[c].retain||this._removeTile(c)}},_removeTilesAtZoom:function(c){for(var p in this._tiles)this._tiles[p].coords.z===c&&this._removeTile(p)},_removeAllTiles:function(){for(var c in this._tiles)this._removeTile(c)},_invalidateAll:function(){for(var c in this._levels)cn(this._levels[c].el),this._onRemoveLevel(Number(c)),delete this._levels[c];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(c,p,T,V){var W=Math.floor(c/2),ne=Math.floor(p/2),de=T-1,ve=new ie(+W,+ne);ve.z=+de;var we=this._tileCoordsToKey(ve),Ce=this._tiles[we];return Ce&&Ce.active?(Ce.retain=!0,!0):(Ce&&Ce.loaded&&(Ce.retain=!0),de>V?this._retainParent(W,ne,de,V):!1)},_retainChildren:function(c,p,T,V){for(var W=2*c;W<2*c+2;W++)for(var ne=2*p;ne<2*p+2;ne++){var de=new ie(W,ne);de.z=T+1;var ve=this._tileCoordsToKey(de),we=this._tiles[ve];if(we&&we.active){we.retain=!0;continue}else we&&we.loaded&&(we.retain=!0);T+1<V&&this._retainChildren(W,ne,T+1,V)}},_resetView:function(c){var p=c&&(c.pinch||c.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),p,p)},_animateZoom:function(c){this._setView(c.center,c.zoom,!0,c.noUpdate)},_clampZoom:function(c){var p=this.options;return p.minNativeZoom!==void 0&&c<p.minNativeZoom?p.minNativeZoom:p.maxNativeZoom!==void 0&&p.maxNativeZoom<c?p.maxNativeZoom:c},_setView:function(c,p,T,V){var W=Math.round(p);this.options.maxZoom!==void 0&&W>this.options.maxZoom||this.options.minZoom!==void 0&&W<this.options.minZoom?W=void 0:W=this._clampZoom(W);var ne=this.options.updateWhenZooming&&W!==this._tileZoom;(!V||ne)&&(this._tileZoom=W,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),W!==void 0&&this._update(c),T||this._pruneTiles(),this._noPrune=!!T),this._setZoomTransforms(c,p)},_setZoomTransforms:function(c,p){for(var T in this._levels)this._setZoomTransform(this._levels[T],c,p)},_setZoomTransform:function(c,p,T){var V=this._map.getZoomScale(T,c.zoom),W=c.origin.multiplyBy(V).subtract(this._map._getNewPixelOrigin(p,T)).round();$e.any3d?Dr(c.el,W,V):_t(c.el,W)},_resetGrid:function(){var c=this._map,p=c.options.crs,T=this._tileSize=this.getTileSize(),V=this._tileZoom,W=this._map.getPixelWorldBounds(this._tileZoom);W&&(this._globalTileRange=this._pxBoundsToTileRange(W)),this._wrapX=p.wrapLng&&!this.options.noWrap&&[Math.floor(c.project([0,p.wrapLng[0]],V).x/T.x),Math.ceil(c.project([0,p.wrapLng[1]],V).x/T.y)],this._wrapY=p.wrapLat&&!this.options.noWrap&&[Math.floor(c.project([p.wrapLat[0],0],V).y/T.x),Math.ceil(c.project([p.wrapLat[1],0],V).y/T.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(c){var p=this._map,T=p._animatingZoom?Math.max(p._animateToZoom,p.getZoom()):p.getZoom(),V=p.getZoomScale(T,this._tileZoom),W=p.project(c,this._tileZoom).floor(),ne=p.getSize().divideBy(V*2);return new B(W.subtract(ne),W.add(ne))},_update:function(c){var p=this._map;if(p){var T=this._clampZoom(p.getZoom());if(c===void 0&&(c=p.getCenter()),this._tileZoom!==void 0){var V=this._getTiledPixelBounds(c),W=this._pxBoundsToTileRange(V),ne=W.getCenter(),de=[],ve=this.options.keepBuffer,we=new B(W.getBottomLeft().subtract([ve,-ve]),W.getTopRight().add([ve,-ve]));if(!(isFinite(W.min.x)&&isFinite(W.min.y)&&isFinite(W.max.x)&&isFinite(W.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Ce in this._tiles){var He=this._tiles[Ce].coords;(He.z!==this._tileZoom||!we.contains(new ie(He.x,He.y)))&&(this._tiles[Ce].current=!1)}if(Math.abs(T-this._tileZoom)>1){this._setView(c,T);return}for(var dt=W.min.y;dt<=W.max.y;dt++)for(var Pt=W.min.x;Pt<=W.max.x;Pt++){var ar=new ie(Pt,dt);if(ar.z=this._tileZoom,!!this._isValidTile(ar)){var er=this._tiles[this._tileCoordsToKey(ar)];er?er.current=!0:de.push(ar)}}if(de.sort(function(zr,il){return zr.distanceTo(ne)-il.distanceTo(ne)}),de.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var si=document.createDocumentFragment();for(Pt=0;Pt<de.length;Pt++)this._addTile(de[Pt],si);this._level.el.appendChild(si)}}}},_isValidTile:function(c){var p=this._map.options.crs;if(!p.infinite){var T=this._globalTileRange;if(!p.wrapLng&&(c.x<T.min.x||c.x>T.max.x)||!p.wrapLat&&(c.y<T.min.y||c.y>T.max.y))return!1}if(!this.options.bounds)return!0;var V=this._tileCoordsToBounds(c);return se(this.options.bounds).overlaps(V)},_keyToBounds:function(c){return this._tileCoordsToBounds(this._keyToTileCoords(c))},_tileCoordsToNwSe:function(c){var p=this._map,T=this.getTileSize(),V=c.scaleBy(T),W=V.add(T),ne=p.unproject(V,c.z),de=p.unproject(W,c.z);return[ne,de]},_tileCoordsToBounds:function(c){var p=this._tileCoordsToNwSe(c),T=new te(p[0],p[1]);return this.options.noWrap||(T=this._map.wrapLatLngBounds(T)),T},_tileCoordsToKey:function(c){return c.x+":"+c.y+":"+c.z},_keyToTileCoords:function(c){var p=c.split(":"),T=new ie(+p[0],+p[1]);return T.z=+p[2],T},_removeTile:function(c){var p=this._tiles[c];p&&(cn(p.el),delete this._tiles[c],this.fire("tileunload",{tile:p.el,coords:this._keyToTileCoords(c)}))},_initTile:function(c){yt(c,"leaflet-tile");var p=this.getTileSize();c.style.width=p.x+"px",c.style.height=p.y+"px",c.onselectstart=y,c.onmousemove=y,$e.ielt9&&this.options.opacity<1&&En(c,this.options.opacity)},_addTile:function(c,p){var T=this._getTilePos(c),V=this._tileCoordsToKey(c),W=this.createTile(this._wrapCoords(c),o(this._tileReady,this,c));this._initTile(W),this.createTile.length<2&&C(o(this._tileReady,this,c,null,W)),_t(W,T),this._tiles[V]={el:W,coords:c,current:!0},p.appendChild(W),this.fire("tileloadstart",{tile:W,coords:c})},_tileReady:function(c,p,T){p&&this.fire("tileerror",{error:p,tile:T,coords:c});var V=this._tileCoordsToKey(c);T=this._tiles[V],T&&(T.loaded=+new Date,this._map._fadeAnimated?(En(T.el,0),D(this._fadeFrame),this._fadeFrame=C(this._updateOpacity,this)):(T.active=!0,this._pruneTiles()),p||(yt(T.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:T.el,coords:c})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),$e.ielt9||!this._map._fadeAnimated?C(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(c){return c.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(c){var p=new ie(this._wrapX?m(c.x,this._wrapX):c.x,this._wrapY?m(c.y,this._wrapY):c.y);return p.z=c.z,p},_pxBoundsToTileRange:function(c){var p=this.getTileSize();return new B(c.min.unscaleBy(p).floor(),c.max.unscaleBy(p).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var c in this._tiles)if(!this._tiles[c].loaded)return!1;return!0}});function el(c){return new go(c)}var yo=go.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(c,p){this._url=c,p=x(this,p),p.detectRetina&&$e.retina&&p.maxZoom>0?(p.tileSize=Math.floor(p.tileSize/2),p.zoomReverse?(p.zoomOffset--,p.minZoom=Math.min(p.maxZoom,p.minZoom+1)):(p.zoomOffset++,p.maxZoom=Math.max(p.minZoom,p.maxZoom-1)),p.minZoom=Math.max(0,p.minZoom)):p.zoomReverse?p.minZoom=Math.min(p.maxZoom,p.minZoom):p.maxZoom=Math.max(p.minZoom,p.maxZoom),typeof p.subdomains=="string"&&(p.subdomains=p.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(c,p){return this._url===c&&p===void 0&&(p=!0),this._url=c,p||this.redraw(),this},createTile:function(c,p){var T=document.createElement("img");return lt(T,"load",o(this._tileOnLoad,this,p,T)),lt(T,"error",o(this._tileOnError,this,p,T)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(T.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(T.referrerPolicy=this.options.referrerPolicy),T.alt="",T.src=this.getTileUrl(c),T},getTileUrl:function(c){var p={r:$e.retina?"@2x":"",s:this._getSubdomain(c),x:c.x,y:c.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var T=this._globalTileRange.max.y-c.y;this.options.tms&&(p.y=T),p["-y"]=T}return N(this._url,i(p,this.options))},_tileOnLoad:function(c,p){$e.ielt9?setTimeout(o(c,this,null,p),0):c(null,p)},_tileOnError:function(c,p,T){var V=this.options.errorTileUrl;V&&p.getAttribute("src")!==V&&(p.src=V),c(T,p)},_onTileRemove:function(c){c.tile.onload=null},_getZoomForUrl:function(){var c=this._tileZoom,p=this.options.maxZoom,T=this.options.zoomReverse,V=this.options.zoomOffset;return T&&(c=p-c),c+V},_getSubdomain:function(c){var p=Math.abs(c.x+c.y)%this.options.subdomains.length;return this.options.subdomains[p]},_abortLoading:function(){var c,p;for(c in this._tiles)if(this._tiles[c].coords.z!==this._tileZoom&&(p=this._tiles[c].el,p.onload=y,p.onerror=y,!p.complete)){p.src=R;var T=this._tiles[c].coords;cn(p),delete this._tiles[c],this.fire("tileabort",{tile:p,coords:T})}},_removeTile:function(c){var p=this._tiles[c];if(p)return p.el.setAttribute("src",R),go.prototype._removeTile.call(this,c)},_tileReady:function(c,p,T){if(!(!this._map||T&&T.getAttribute("src")===R))return go.prototype._tileReady.call(this,c,p,T)}});function Xd(c,p){return new yo(c,p)}var mc=yo.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(c,p){this._url=c;var T=i({},this.defaultWmsParams);for(var V in p)V in this.options||(T[V]=p[V]);p=x(this,p);var W=p.detectRetina&&$e.retina?2:1,ne=this.getTileSize();T.width=ne.x*W,T.height=ne.y*W,this.wmsParams=T},onAdd:function(c){this._crs=this.options.crs||c.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var p=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[p]=this._crs.code,yo.prototype.onAdd.call(this,c)},getTileUrl:function(c){var p=this._tileCoordsToNwSe(c),T=this._crs,V=Z(T.project(p[0]),T.project(p[1])),W=V.min,ne=V.max,de=(this._wmsVersion>=1.3&&this._crs===zn?[W.y,W.x,ne.y,ne.x]:[W.x,W.y,ne.x,ne.y]).join(","),ve=yo.prototype.getTileUrl.call(this,c);return ve+w(this.wmsParams,ve,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+de},setParams:function(c,p){return i(this.wmsParams,c),p||this.redraw(),this}});function Nm(c,p){return new mc(c,p)}yo.WMS=mc,Xd.wms=Nm;var hs=rn.extend({options:{padding:.1},initialize:function(c){x(this,c),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),yt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var c={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(c.zoomanim=this._onAnimZoom),c},_onAnimZoom:function(c){this._updateTransform(c.center,c.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(c,p){var T=this._map.getZoomScale(p,this._zoom),V=this._map.getSize().multiplyBy(.5+this.options.padding),W=this._map.project(this._center,p),ne=V.multiplyBy(-T).add(W).subtract(this._map._getNewPixelOrigin(c,p));$e.any3d?Dr(this._container,ne,T):_t(this._container,ne)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var c in this._layers)this._layers[c]._reset()},_onZoomEnd:function(){for(var c in this._layers)this._layers[c]._project()},_updatePaths:function(){for(var c in this._layers)this._layers[c]._update()},_update:function(){var c=this.options.padding,p=this._map.getSize(),T=this._map.containerPointToLayerPoint(p.multiplyBy(-c)).round();this._bounds=new B(T,T.add(p.multiplyBy(1+c*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Jd=hs.extend({options:{tolerance:0},getEvents:function(){var c=hs.prototype.getEvents.call(this);return c.viewprereset=this._onViewPreReset,c},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){hs.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var c=this._container=document.createElement("canvas");lt(c,"mousemove",this._onMouseMove,this),lt(c,"click dblclick mousedown mouseup contextmenu",this._onClick,this),lt(c,"mouseout",this._handleMouseOut,this),c._leaflet_disable_events=!0,this._ctx=c.getContext("2d")},_destroyContainer:function(){D(this._redrawRequest),delete this._ctx,cn(this._container),nn(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var c;this._redrawBounds=null;for(var p in this._layers)c=this._layers[p],c._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){hs.prototype._update.call(this);var c=this._bounds,p=this._container,T=c.getSize(),V=$e.retina?2:1;_t(p,c.min),p.width=V*T.x,p.height=V*T.y,p.style.width=T.x+"px",p.style.height=T.y+"px",$e.retina&&this._ctx.scale(2,2),this._ctx.translate(-c.min.x,-c.min.y),this.fire("update")}},_reset:function(){hs.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(c){this._updateDashArray(c),this._layers[d(c)]=c;var p=c._order={layer:c,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=p),this._drawLast=p,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(c){this._requestRedraw(c)},_removePath:function(c){var p=c._order,T=p.next,V=p.prev;T?T.prev=V:this._drawLast=V,V?V.next=T:this._drawFirst=T,delete c._order,delete this._layers[d(c)],this._requestRedraw(c)},_updatePath:function(c){this._extendRedrawBounds(c),c._project(),c._update(),this._requestRedraw(c)},_updateStyle:function(c){this._updateDashArray(c),this._requestRedraw(c)},_updateDashArray:function(c){if(typeof c.options.dashArray=="string"){var p=c.options.dashArray.split(/[, ]+/),T=[],V,W;for(W=0;W<p.length;W++){if(V=Number(p[W]),isNaN(V))return;T.push(V)}c.options._dashArray=T}else c.options._dashArray=c.options.dashArray},_requestRedraw:function(c){this._map&&(this._extendRedrawBounds(c),this._redrawRequest=this._redrawRequest||C(this._redraw,this))},_extendRedrawBounds:function(c){if(c._pxBounds){var p=(c.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new B,this._redrawBounds.extend(c._pxBounds.min.subtract([p,p])),this._redrawBounds.extend(c._pxBounds.max.add([p,p]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var c=this._redrawBounds;if(c){var p=c.getSize();this._ctx.clearRect(c.min.x,c.min.y,p.x,p.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var c,p=this._redrawBounds;if(this._ctx.save(),p){var T=p.getSize();this._ctx.beginPath(),this._ctx.rect(p.min.x,p.min.y,T.x,T.y),this._ctx.clip()}this._drawing=!0;for(var V=this._drawFirst;V;V=V.next)c=V.layer,(!p||c._pxBounds&&c._pxBounds.intersects(p))&&c._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(c,p){if(this._drawing){var T,V,W,ne,de=c._parts,ve=de.length,we=this._ctx;if(ve){for(we.beginPath(),T=0;T<ve;T++){for(V=0,W=de[T].length;V<W;V++)ne=de[T][V],we[V?"lineTo":"moveTo"](ne.x,ne.y);p&&we.closePath()}this._fillStroke(we,c)}}},_updateCircle:function(c){if(!(!this._drawing||c._empty())){var p=c._point,T=this._ctx,V=Math.max(Math.round(c._radius),1),W=(Math.max(Math.round(c._radiusY),1)||V)/V;W!==1&&(T.save(),T.scale(1,W)),T.beginPath(),T.arc(p.x,p.y/W,V,0,Math.PI*2,!1),W!==1&&T.restore(),this._fillStroke(T,c)}},_fillStroke:function(c,p){var T=p.options;T.fill&&(c.globalAlpha=T.fillOpacity,c.fillStyle=T.fillColor||T.color,c.fill(T.fillRule||"evenodd")),T.stroke&&T.weight!==0&&(c.setLineDash&&c.setLineDash(p.options&&p.options._dashArray||[]),c.globalAlpha=T.opacity,c.lineWidth=T.weight,c.strokeStyle=T.color,c.lineCap=T.lineCap,c.lineJoin=T.lineJoin,c.stroke())},_onClick:function(c){for(var p=this._map.mouseEventToLayerPoint(c),T,V,W=this._drawFirst;W;W=W.next)T=W.layer,T.options.interactive&&T._containsPoint(p)&&(!(c.type==="click"||c.type==="preclick")||!this._map._draggableMoved(T))&&(V=T);this._fireEvent(V?[V]:!1,c)},_onMouseMove:function(c){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var p=this._map.mouseEventToLayerPoint(c);this._handleMouseHover(c,p)}},_handleMouseOut:function(c){var p=this._hoveredLayer;p&&(un(this._container,"leaflet-interactive"),this._fireEvent([p],c,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(c,p){if(!this._mouseHoverThrottled){for(var T,V,W=this._drawFirst;W;W=W.next)T=W.layer,T.options.interactive&&T._containsPoint(p)&&(V=T);V!==this._hoveredLayer&&(this._handleMouseOut(c),V&&(yt(this._container,"leaflet-interactive"),this._fireEvent([V],c,"mouseover"),this._hoveredLayer=V)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,c),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(c,p,T){this._map._fireDOMEvent(p,T||p.type,c)},_bringToFront:function(c){var p=c._order;if(p){var T=p.next,V=p.prev;if(T)T.prev=V;else return;V?V.next=T:T&&(this._drawFirst=T),p.prev=this._drawLast,this._drawLast.next=p,p.next=null,this._drawLast=p,this._requestRedraw(c)}},_bringToBack:function(c){var p=c._order;if(p){var T=p.next,V=p.prev;if(V)V.next=T;else return;T?T.prev=V:V&&(this._drawLast=V),p.prev=null,p.next=this._drawFirst,this._drawFirst.prev=p,this._drawFirst=p,this._requestRedraw(c)}}});function eh(c){return $e.canvas?new Jd(c):null}var tl=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(c){return document.createElement("<lvml:"+c+' class="lvml">')}}catch{}return function(c){return document.createElement("<"+c+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Im={_initContainer:function(){this._container=vt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(hs.prototype._update.call(this),this.fire("update"))},_initPath:function(c){var p=c._container=tl("shape");yt(p,"leaflet-vml-shape "+(this.options.className||"")),p.coordsize="1 1",c._path=tl("path"),p.appendChild(c._path),this._updateStyle(c),this._layers[d(c)]=c},_addPath:function(c){var p=c._container;this._container.appendChild(p),c.options.interactive&&c.addInteractiveTarget(p)},_removePath:function(c){var p=c._container;cn(p),c.removeInteractiveTarget(p),delete this._layers[d(c)]},_updateStyle:function(c){var p=c._stroke,T=c._fill,V=c.options,W=c._container;W.stroked=!!V.stroke,W.filled=!!V.fill,V.stroke?(p||(p=c._stroke=tl("stroke")),W.appendChild(p),p.weight=V.weight+"px",p.color=V.color,p.opacity=V.opacity,V.dashArray?p.dashStyle=P(V.dashArray)?V.dashArray.join(" "):V.dashArray.replace(/( *, *)/g," "):p.dashStyle="",p.endcap=V.lineCap.replace("butt","flat"),p.joinstyle=V.lineJoin):p&&(W.removeChild(p),c._stroke=null),V.fill?(T||(T=c._fill=tl("fill")),W.appendChild(T),T.color=V.fillColor||V.color,T.opacity=V.fillOpacity):T&&(W.removeChild(T),c._fill=null)},_updateCircle:function(c){var p=c._point.round(),T=Math.round(c._radius),V=Math.round(c._radiusY||T);this._setPath(c,c._empty()?"M0 0":"AL "+p.x+","+p.y+" "+T+","+V+" 0,"+65535*360)},_setPath:function(c,p){c._path.v=p},_bringToFront:function(c){zs(c._container)},_bringToBack:function(c){Hi(c._container)}},Yi=$e.vml?tl:nt,Xo=hs.extend({_initContainer:function(){this._container=Yi("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Yi("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){cn(this._container),nn(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){hs.prototype._update.call(this);var c=this._bounds,p=c.getSize(),T=this._container;(!this._svgSize||!this._svgSize.equals(p))&&(this._svgSize=p,T.setAttribute("width",p.x),T.setAttribute("height",p.y)),_t(T,c.min),T.setAttribute("viewBox",[c.min.x,c.min.y,p.x,p.y].join(" ")),this.fire("update")}},_initPath:function(c){var p=c._path=Yi("path");c.options.className&&yt(p,c.options.className),c.options.interactive&&yt(p,"leaflet-interactive"),this._updateStyle(c),this._layers[d(c)]=c},_addPath:function(c){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(c._path),c.addInteractiveTarget(c._path)},_removePath:function(c){cn(c._path),c.removeInteractiveTarget(c._path),delete this._layers[d(c)]},_updatePath:function(c){c._project(),c._update()},_updateStyle:function(c){var p=c._path,T=c.options;p&&(T.stroke?(p.setAttribute("stroke",T.color),p.setAttribute("stroke-opacity",T.opacity),p.setAttribute("stroke-width",T.weight),p.setAttribute("stroke-linecap",T.lineCap),p.setAttribute("stroke-linejoin",T.lineJoin),T.dashArray?p.setAttribute("stroke-dasharray",T.dashArray):p.removeAttribute("stroke-dasharray"),T.dashOffset?p.setAttribute("stroke-dashoffset",T.dashOffset):p.removeAttribute("stroke-dashoffset")):p.setAttribute("stroke","none"),T.fill?(p.setAttribute("fill",T.fillColor||T.color),p.setAttribute("fill-opacity",T.fillOpacity),p.setAttribute("fill-rule",T.fillRule||"evenodd")):p.setAttribute("fill","none"))},_updatePoly:function(c,p){this._setPath(c,It(c._parts,p))},_updateCircle:function(c){var p=c._point,T=Math.max(Math.round(c._radius),1),V=Math.max(Math.round(c._radiusY),1)||T,W="a"+T+","+V+" 0 1,0 ",ne=c._empty()?"M0 0":"M"+(p.x-T)+","+p.y+W+T*2+",0 "+W+-T*2+",0 ";this._setPath(c,ne)},_setPath:function(c,p){c._path.setAttribute("d",p)},_bringToFront:function(c){zs(c._path)},_bringToBack:function(c){Hi(c._path)}});$e.vml&&Xo.include(Im);function Cu(c){return $e.svg||$e.vml?new Xo(c):null}jt.include({getRenderer:function(c){var p=c.options.renderer||this._getPaneRenderer(c.options.pane)||this.options.renderer||this._renderer;return p||(p=this._renderer=this._createRenderer()),this.hasLayer(p)||this.addLayer(p),p},_getPaneRenderer:function(c){if(c==="overlayPane"||c===void 0)return!1;var p=this._paneRenderers[c];return p===void 0&&(p=this._createRenderer({pane:c}),this._paneRenderers[c]=p),p},_createRenderer:function(c){return this.options.preferCanvas&&eh(c)||Cu(c)}});var km=Gs.extend({initialize:function(c,p){Gs.prototype.initialize.call(this,this._boundsToLatLngs(c),p)},setBounds:function(c){return this.setLatLngs(this._boundsToLatLngs(c))},_boundsToLatLngs:function(c){return c=se(c),[c.getSouthWest(),c.getNorthWest(),c.getNorthEast(),c.getSouthEast()]}});function s0(c,p){return new km(c,p)}Xo.create=Yi,Xo.pointsToPath=It,us.geometryToLayer=Za,us.coordsToLatLng=Tu,us.coordsToLatLngs=hc,us.latLngToCoords=Su,us.latLngsToCoords=Au,us.getFeature=Qa,us.asFeature=Nu,jt.mergeOptions({boxZoom:!0});var nl=Ir.extend({initialize:function(c){this._map=c,this._container=c._container,this._pane=c._panes.overlayPane,this._resetStateTimeout=0,c.on("unload",this._destroy,this)},addHooks:function(){lt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){nn(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){cn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(c){if(!c.shiftKey||c.which!==1&&c.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Rt(),Fa(),this._startPoint=this._map.mouseEventToContainerPoint(c),lt(document,{contextmenu:or,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(c){this._moved||(this._moved=!0,this._box=vt("div","leaflet-zoom-box",this._container),yt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(c);var p=new B(this._point,this._startPoint),T=p.getSize();_t(this._box,p.min),this._box.style.width=T.x+"px",this._box.style.height=T.y+"px"},_finish:function(){this._moved&&(cn(this._box),un(this._container,"leaflet-crosshair")),wi(),Va(),nn(document,{contextmenu:or,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(c){if(!(c.which!==1&&c.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var p=new te(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(p).fire("boxzoomend",{boxZoomBounds:p})}},_onKeyDown:function(c){c.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});jt.addInitHook("addHandler","boxZoom",nl),jt.mergeOptions({doubleClickZoom:!0});var Cm=Ir.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(c){var p=this._map,T=p.getZoom(),V=p.options.zoomDelta,W=c.originalEvent.shiftKey?T-V:T+V;p.options.doubleClickZoom==="center"?p.setZoom(W):p.setZoomAround(c.containerPoint,W)}});jt.addInitHook("addHandler","doubleClickZoom",Cm),jt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var th=Ir.extend({addHooks:function(){if(!this._draggable){var c=this._map;this._draggable=new Fr(c._mapPane,c._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),c.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),c.on("zoomend",this._onZoomEnd,this),c.whenReady(this._onZoomEnd,this))}yt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){un(this._map._container,"leaflet-grab"),un(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var c=this._map;if(c._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var p=se(this._map.options.maxBounds);this._offsetLimit=Z(this._map.latLngToContainerPoint(p.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(p.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;c.fire("movestart").fire("dragstart"),c.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(c){if(this._map.options.inertia){var p=this._lastTime=+new Date,T=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(T),this._times.push(p),this._prunePositions(p)}this._map.fire("move",c).fire("drag",c)},_prunePositions:function(c){for(;this._positions.length>1&&c-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var c=this._map.getSize().divideBy(2),p=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=p.subtract(c).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(c,p){return c-(c-p)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var c=this._draggable._newPos.subtract(this._draggable._startPos),p=this._offsetLimit;c.x<p.min.x&&(c.x=this._viscousLimit(c.x,p.min.x)),c.y<p.min.y&&(c.y=this._viscousLimit(c.y,p.min.y)),c.x>p.max.x&&(c.x=this._viscousLimit(c.x,p.max.x)),c.y>p.max.y&&(c.y=this._viscousLimit(c.y,p.max.y)),this._draggable._newPos=this._draggable._startPos.add(c)}},_onPreDragWrap:function(){var c=this._worldWidth,p=Math.round(c/2),T=this._initialWorldOffset,V=this._draggable._newPos.x,W=(V-p+T)%c+p-T,ne=(V+p+T)%c-p-T,de=Math.abs(W+T)<Math.abs(ne+T)?W:ne;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=de},_onDragEnd:function(c){var p=this._map,T=p.options,V=!T.inertia||c.noInertia||this._times.length<2;if(p.fire("dragend",c),V)p.fire("moveend");else{this._prunePositions(+new Date);var W=this._lastPos.subtract(this._positions[0]),ne=(this._lastTime-this._times[0])/1e3,de=T.easeLinearity,ve=W.multiplyBy(de/ne),we=ve.distanceTo([0,0]),Ce=Math.min(T.inertiaMaxSpeed,we),He=ve.multiplyBy(Ce/we),dt=Ce/(T.inertiaDeceleration*de),Pt=He.multiplyBy(-dt/2).round();!Pt.x&&!Pt.y?p.fire("moveend"):(Pt=p._limitOffset(Pt,p.options.maxBounds),C(function(){p.panBy(Pt,{duration:dt,easeLinearity:de,noMoveStart:!0,animate:!0})}))}}});jt.addInitHook("addHandler","dragging",th),jt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var nh=Ir.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(c){this._map=c,this._setPanDelta(c.options.keyboardPanDelta),this._setZoomDelta(c.options.zoomDelta)},addHooks:function(){var c=this._map._container;c.tabIndex<=0&&(c.tabIndex="0"),lt(c,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),nn(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var c=document.body,p=document.documentElement,T=c.scrollTop||p.scrollTop,V=c.scrollLeft||p.scrollLeft;this._map._container.focus(),window.scrollTo(V,T)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(c){var p=this._panKeys={},T=this.keyCodes,V,W;for(V=0,W=T.left.length;V<W;V++)p[T.left[V]]=[-1*c,0];for(V=0,W=T.right.length;V<W;V++)p[T.right[V]]=[c,0];for(V=0,W=T.down.length;V<W;V++)p[T.down[V]]=[0,c];for(V=0,W=T.up.length;V<W;V++)p[T.up[V]]=[0,-1*c]},_setZoomDelta:function(c){var p=this._zoomKeys={},T=this.keyCodes,V,W;for(V=0,W=T.zoomIn.length;V<W;V++)p[T.zoomIn[V]]=c;for(V=0,W=T.zoomOut.length;V<W;V++)p[T.zoomOut[V]]=-c},_addHooks:function(){lt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){nn(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(c){if(!(c.altKey||c.ctrlKey||c.metaKey)){var p=c.keyCode,T=this._map,V;if(p in this._panKeys){if(!T._panAnim||!T._panAnim._inProgress)if(V=this._panKeys[p],c.shiftKey&&(V=Y(V).multiplyBy(3)),T.options.maxBounds&&(V=T._limitOffset(Y(V),T.options.maxBounds)),T.options.worldCopyJump){var W=T.wrapLatLng(T.unproject(T.project(T.getCenter()).add(V)));T.panTo(W)}else T.panBy(V)}else if(p in this._zoomKeys)T.setZoom(T.getZoom()+(c.shiftKey?3:1)*this._zoomKeys[p]);else if(p===27&&T._popup&&T._popup.options.closeOnEscapeKey)T.closePopup();else return;or(c)}}});jt.addInitHook("addHandler","keyboard",nh),jt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var _n=Ir.extend({addHooks:function(){lt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){nn(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(c){var p=yu(c),T=this._map.options.wheelDebounceTime;this._delta+=p,this._lastMousePos=this._map.mouseEventToContainerPoint(c),this._startTime||(this._startTime=+new Date);var V=Math.max(T-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),V),or(c)},_performZoom:function(){var c=this._map,p=c.getZoom(),T=this._map.options.zoomSnap||0;c._stop();var V=this._delta/(this._map.options.wheelPxPerZoomLevel*4),W=4*Math.log(2/(1+Math.exp(-Math.abs(V))))/Math.LN2,ne=T?Math.ceil(W/T)*T:W,de=c._limitZoom(p+(this._delta>0?ne:-ne))-p;this._delta=0,this._startTime=null,de&&(c.options.scrollWheelZoom==="center"?c.setZoom(p+de):c.setZoomAround(this._lastMousePos,p+de))}});jt.addInitHook("addHandler","scrollWheelZoom",_n);var rh=600;jt.mergeOptions({tapHold:$e.touchNative&&$e.safari&&$e.mobile,tapTolerance:15});var pc=Ir.extend({addHooks:function(){lt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){nn(this._map._container,"touchstart",this._onDown,this)},_onDown:function(c){if(clearTimeout(this._holdTimeout),c.touches.length===1){var p=c.touches[0];this._startPos=this._newPos=new ie(p.clientX,p.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(lt(document,"touchend",dn),lt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",p))},this),rh),lt(document,"touchend touchcancel contextmenu",this._cancel,this),lt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function c(){nn(document,"touchend",dn),nn(document,"touchend touchcancel",c)},_cancel:function(){clearTimeout(this._holdTimeout),nn(document,"touchend touchcancel contextmenu",this._cancel,this),nn(document,"touchmove",this._onMove,this)},_onMove:function(c){var p=c.touches[0];this._newPos=new ie(p.clientX,p.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(c,p){var T=new MouseEvent(c,{bubbles:!0,cancelable:!0,view:window,screenX:p.screenX,screenY:p.screenY,clientX:p.clientX,clientY:p.clientY});T._simulated=!0,p.target.dispatchEvent(T)}});jt.addInitHook("addHandler","tapHold",pc),jt.mergeOptions({touchZoom:$e.touch,bounceAtZoomLimits:!0});var rl=Ir.extend({addHooks:function(){yt(this._map._container,"leaflet-touch-zoom"),lt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){un(this._map._container,"leaflet-touch-zoom"),nn(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(c){var p=this._map;if(!(!c.touches||c.touches.length!==2||p._animatingZoom||this._zooming)){var T=p.mouseEventToContainerPoint(c.touches[0]),V=p.mouseEventToContainerPoint(c.touches[1]);this._centerPoint=p.getSize()._divideBy(2),this._startLatLng=p.containerPointToLatLng(this._centerPoint),p.options.touchZoom!=="center"&&(this._pinchStartLatLng=p.containerPointToLatLng(T.add(V)._divideBy(2))),this._startDist=T.distanceTo(V),this._startZoom=p.getZoom(),this._moved=!1,this._zooming=!0,p._stop(),lt(document,"touchmove",this._onTouchMove,this),lt(document,"touchend touchcancel",this._onTouchEnd,this),dn(c)}},_onTouchMove:function(c){if(!(!c.touches||c.touches.length!==2||!this._zooming)){var p=this._map,T=p.mouseEventToContainerPoint(c.touches[0]),V=p.mouseEventToContainerPoint(c.touches[1]),W=T.distanceTo(V)/this._startDist;if(this._zoom=p.getScaleZoom(W,this._startZoom),!p.options.bounceAtZoomLimits&&(this._zoom<p.getMinZoom()&&W<1||this._zoom>p.getMaxZoom()&&W>1)&&(this._zoom=p._limitZoom(this._zoom)),p.options.touchZoom==="center"){if(this._center=this._startLatLng,W===1)return}else{var ne=T._add(V)._divideBy(2)._subtract(this._centerPoint);if(W===1&&ne.x===0&&ne.y===0)return;this._center=p.unproject(p.project(this._pinchStartLatLng,this._zoom).subtract(ne),this._zoom)}this._moved||(p._moveStart(!0,!1),this._moved=!0),D(this._animRequest);var de=o(p._move,p,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=C(de,this,!0),dn(c)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,D(this._animRequest),nn(document,"touchmove",this._onTouchMove,this),nn(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});jt.addInitHook("addHandler","touchZoom",rl),jt.BoxZoom=nl,jt.DoubleClickZoom=Cm,jt.Drag=th,jt.Keyboard=nh,jt.ScrollWheelZoom=_n,jt.TapHold=pc,jt.TouchZoom=rl,t.Bounds=B,t.Browser=$e,t.CRS=ce,t.Canvas=Jd,t.Circle=wu,t.CircleMarker=bu,t.Class=$,t.Control=vr,t.DivIcon=ku,t.DivOverlay=ds,t.DomEvent=Wo,t.DomUtil=ho,t.Draggable=Fr,t.Evented=oe,t.FeatureGroup=Mn,t.GeoJSON=us,t.GridLayer=go,t.Handler=Ir,t.Icon=Gi,t.ImageOverlay=po,t.LatLng=ae,t.LatLngBounds=te,t.Layer=rn,t.LayerGroup=wn,t.LineUtil=le,t.Map=jt,t.Marker=Ws,t.Mixin=qs,t.Path=mo,t.Point=ie,t.PolyUtil=Wa,t.Polygon=Gs,t.Polyline=ii,t.Popup=Iu,t.PosAnimation=Go,t.Projection=Be,t.Rectangle=km,t.Renderer=hs,t.SVG=Xo,t.SVGOverlay=Zd,t.TileLayer=yo,t.Tooltip=Ja,t.Transformation=Ve,t.Util=M,t.VideoOverlay=Yd,t.bind=o,t.bounds=Z,t.canvas=eh,t.circle=dc,t.circleMarker=wm,t.control=Qn,t.divIcon=Am,t.extend=i,t.featureGroup=Qo,t.geoJSON=Em,t.geoJson=Ki,t.gridLayer=el,t.icon=bm,t.imageOverlay=Tm,t.latLng=Q,t.latLngBounds=se,t.layerGroup=Ni,t.map=ri,t.marker=n0,t.point=Y,t.polygon=i0,t.polyline=r0,t.popup=Xa,t.rectangle=s0,t.setOptions=x,t.stamp=d,t.svg=Cu,t.svgOverlay=Qd,t.tileLayer=Xd,t.tooltip=fc,t.transformation=Ye,t.version=r,t.videoOverlay=Sm;var Pm=window.L;t.noConflict=function(){return window.L=Pm,this},window.L=t})}(sf,sf.exports)),sf.exports}var A2=_$();function J3(n,e,t){return Object.freeze({instance:n,context:e,container:t})}function eR(n,e){return e==null?function(r,i){const s=ee.useRef();return s.current||(s.current=n(r,i)),s}:function(r,i){const s=ee.useRef();s.current||(s.current=n(r,i));const o=ee.useRef(r),{instance:l}=s.current;return ee.useEffect(function(){o.current!==r&&(e(l,r,o.current),o.current=r)},[l,r,i]),s}}function tR(n,e){ee.useEffect(function(){return(e.layerContainer??e.map).addLayer(n.instance),function(){var s;(s=e.layerContainer)==null||s.removeLayer(n.instance),e.map.removeLayer(n.instance)}},[e,n])}function x$(n){return function(t){const r=Q3(),i=n(S2(t,r),r);return h$(r.map,t.attribution),X3(i.current,t.eventHandlers),tR(i.current,r),i}}function b$(n,e){const t=ee.useRef();ee.useEffect(function(){if(e.pathOptions!==t.current){const i=e.pathOptions??{};n.instance.setStyle(i),t.current=i}},[n,e])}function w$(n){return function(t){const r=Q3(),i=n(S2(t,r),r);return X3(i.current,t.eventHandlers),tR(i.current,r),b$(i.current,t),i}}function E$(n,e){const t=eR(n,e),r=w$(t);return g$(r)}function T$(n,e){const t=eR(n,e),r=x$(t);return y$(r)}function S$(n,e,t){const{opacity:r,zIndex:i}=e;r!=null&&r!==t.opacity&&n.setOpacity(r),i!=null&&i!==t.zIndex&&n.setZIndex(i)}const A$=E$(function({data:e,...t},r){const i=new A2.GeoJSON(e,t);return J3(i,p$(r,{overlayContainer:i}))},function(e,t,r){t.style!==r.style&&(t.style==null?e.resetStyle():e.setStyle(t.style))});function Cx(){return Cx=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},Cx.apply(this,arguments)}function N$({bounds:n,boundsOptions:e,center:t,children:r,className:i,id:s,placeholder:o,style:l,whenReady:d,zoom:f,...m},y){const[g]=ee.useState({className:i,id:s,style:l}),[_,E]=ee.useState(null);ee.useImperativeHandle(y,()=>(_==null?void 0:_.map)??null,[_]);const x=ee.useCallback(S=>{if(S!==null&&_===null){const N=new A2.Map(S,m);t!=null&&f!=null?N.setView(t,f):n!=null&&N.fitBounds(n,e),d!=null&&N.whenReady(d),E(m$(N))}},[]);ee.useEffect(()=>()=>{_==null||_.map.remove()},[_]);const w=_?ts.createElement(Z3,{value:_},r):o??null;return ts.createElement("div",Cx({},g,{ref:x}),w)}const I$=ee.forwardRef(N$),k$=T$(function({url:e,...t},r){const i=new A2.TileLayer(e,S2(t,r));return J3(i,r)},function(e,t,r){S$(e,t,r);const{url:i}=t;i!=null&&i!==r.url&&e.setUrl(i)}),nR=({geoJsonData:n,affectedAreas:e=[],mapCenter:t=[14.3207,120.7641],mapZoom:r=13,height:i="256px"})=>{const s={fillColor:"#6b7280",weight:1,opacity:1,color:"white",fillOpacity:.3},o={fillColor:"#EF4444",weight:2,opacity:1,color:"#B91C1C",fillOpacity:.7},l=m=>{var g;const y=(g=m==null?void 0:m.properties)==null?void 0:g.NAME_3;return e.includes(y)?o:s},d=(m,y)=>{var _;const g=(_=m==null?void 0:m.properties)==null?void 0:_.NAME_3;if(g){const E=e.includes(g),x=`
                <div>
                    <strong>${g}</strong>
                    <p style="color: ${E?"#B91C1C":"#374151"}; margin: 0; font-weight: bold;">
                        ${E?"AFFECTED":"Not Affected"}
                    </p>
                </div>
            `;y.bindPopup(x)}},f=JSON.stringify(e);return u.jsxs(I$,{center:t,zoom:r,scrollWheelZoom:!1,style:{height:i,width:"100%"},children:[u.jsx(k$,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),u.jsx(A$,{data:n,style:l,onEachFeature:d})]},f)},C$="FeatureCollection",P$=JSON.parse('[{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10541,"NAME_3":"Bagong Karsada","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.751953,14.32201],[120.752228,14.32222],[120.752663,14.32253],[120.753036,14.32284],[120.753357,14.32315],[120.753677,14.32344],[120.753937,14.32382],[120.754112,14.32407],[120.755127,14.32243],[120.755623,14.32164],[120.753319,14.31961],[120.753288,14.31996],[120.75325,14.32051],[120.75177,14.32179],[120.751953,14.32201]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10542,"NAME_3":"Balsahan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.757576,14.324344],[120.757652,14.32411],[120.757851,14.32374],[120.758034,14.3234],[120.758293,14.32305],[120.75853,14.32271],[120.75885,14.32232],[120.759201,14.3219],[120.759644,14.32152],[120.760017,14.32123],[120.759048,14.32047],[120.756859,14.31872],[120.756042,14.31818],[120.755547,14.31786],[120.754921,14.3172],[120.753166,14.31839],[120.753319,14.31961],[120.755623,14.32164],[120.756866,14.32269],[120.756897,14.32261],[120.757576,14.324344]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10543,"NAME_3":"Bancaan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.760017,14.32123],[120.760094,14.32119],[120.76049,14.3209],[120.760841,14.32068],[120.7612,14.32057],[120.761574,14.32058],[120.761879,14.32073],[120.762115,14.32097],[120.762291,14.31999],[120.762367,14.31954],[120.762497,14.31838],[120.763046,14.31687],[120.763611,14.31575],[120.764374,14.31534],[120.764709,14.31529],[120.760948,14.31142],[120.758423,14.30908],[120.75679,14.30764],[120.749802,14.3161],[120.749046,14.31704],[120.748451,14.31786],[120.747993,14.3185],[120.74823,14.31858],[120.748756,14.31893],[120.749207,14.31934],[120.749672,14.31971],[120.750137,14.32007],[120.750542,14.32052],[120.750763,14.32081],[120.750923,14.32101],[120.751343,14.32144],[120.75177,14.32187],[120.751953,14.32201],[120.75177,14.32179],[120.75325,14.32051],[120.753288,14.31996],[120.753319,14.31961],[120.753166,14.31839],[120.754921,14.3172],[120.755547,14.31786],[120.756042,14.31818],[120.756859,14.31872],[120.759048,14.32047],[120.760017,14.32123]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10544,"NAME_3":"Bucana Malaki","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.759468,14.32942],[120.75988,14.32972],[120.760094,14.32985],[120.760612,14.32961],[120.762527,14.32867],[120.765457,14.32651],[120.761711,14.32374],[120.762093,14.32114],[120.762115,14.32097],[120.761879,14.32073],[120.761574,14.32058],[120.7612,14.32057],[120.760841,14.32068],[120.76049,14.3209],[120.760094,14.32119],[120.760017,14.32123],[120.759644,14.32152],[120.759201,14.3219],[120.75885,14.32232],[120.75853,14.32271],[120.758293,14.32305],[120.758034,14.3234],[120.757851,14.32374],[120.757652,14.32411],[120.757576,14.324344],[120.757561,14.32441],[120.757507,14.32458],[120.757393,14.32517],[120.757378,14.32534],[120.757332,14.32586],[120.757423,14.32654],[120.757683,14.32709],[120.758034,14.32756],[120.758377,14.32805],[120.758728,14.32854],[120.759117,14.32899],[120.759468,14.32942]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10545,"NAME_3":"Bucana Sasahan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.75563,14.32561],[120.759468,14.32942],[120.759117,14.32899],[120.758728,14.32854],[120.758377,14.32805],[120.758034,14.32756],[120.757683,14.32709],[120.757423,14.32654],[120.757332,14.32586],[120.757378,14.32534],[120.757393,14.32517],[120.757507,14.32458],[120.757561,14.32441],[120.757576,14.324344],[120.756897,14.32261],[120.756866,14.32269],[120.756737,14.32314],[120.756622,14.32366],[120.756508,14.32416],[120.756378,14.32468],[120.756088,14.32519],[120.75563,14.32561]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10546,"NAME_3":"Calubcob","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.796928,14.30077],[120.795471,14.29953],[120.793137,14.29676],[120.79158,14.29506],[120.787483,14.2923],[120.786659,14.29179],[120.785629,14.29099],[120.783401,14.28984],[120.782379,14.29027],[120.782082,14.29058],[120.78141,14.29118],[120.781189,14.29207],[120.780548,14.29224],[120.780434,14.29373],[120.779984,14.29418],[120.780212,14.29477],[120.780952,14.2945],[120.780899,14.29493],[120.780457,14.29537],[120.78064,14.29603],[120.780273,14.29652],[120.779167,14.29681],[120.778511,14.29719],[120.778053,14.29832],[120.777763,14.29899],[120.777924,14.30045],[120.77832,14.30128],[120.778503,14.30227],[120.779778,14.30327],[120.783112,14.30549],[120.783958,14.30623],[120.785881,14.30723],[120.786102,14.30674],[120.787018,14.30689],[120.787827,14.30755],[120.788567,14.30743],[120.788879,14.30703],[120.78952,14.3074],[120.789886,14.30639],[120.790253,14.30608],[120.790604,14.30655],[120.791344,14.30624],[120.79174,14.30554],[120.79213,14.30448],[120.792648,14.30341],[120.793854,14.30352],[120.795471,14.30197],[120.795929,14.30115],[120.796928,14.30077]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10547,"NAME_3":"Capt. C. Nazareno","NL_NAME_3":"","VARNAME_3":"Poblacion","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.766197,14.31813],[120.763046,14.31687],[120.762497,14.31838],[120.762367,14.31954],[120.76326,14.31981],[120.763931,14.32013],[120.764572,14.32034],[120.7649,14.32048],[120.766197,14.31813]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10548,"NAME_3":"Gomez-Zamora","NL_NAME_3":"","VARNAME_3":"Poblacion","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.762115,14.32097],[120.762093,14.32114],[120.762802,14.32201],[120.763283,14.32248],[120.764091,14.3223],[120.76458,14.32184],[120.765198,14.32126],[120.766006,14.321],[120.766571,14.32094],[120.767021,14.32038],[120.767509,14.31945],[120.766197,14.31813],[120.7649,14.32048],[120.764572,14.32034],[120.763931,14.32013],[120.76326,14.31981],[120.762367,14.31954],[120.762291,14.31999],[120.762115,14.32097]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10549,"NAME_3":"Halang","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.796928,14.30077],[120.798698,14.3027],[120.800812,14.30515],[120.802559,14.3051],[120.803482,14.30436],[120.803978,14.30431],[120.805817,14.30476],[120.807091,14.3045],[120.807037,14.30409],[120.807747,14.30351],[120.808243,14.30261],[120.809677,14.30198],[120.809601,14.3011],[120.81073,14.30081],[120.811562,14.30122],[120.811897,14.30196],[120.812668,14.3024],[120.813179,14.30343],[120.814293,14.30287],[120.815407,14.3016],[120.820297,14.29734],[120.819633,14.29599],[120.819939,14.29436],[120.813843,14.29398],[120.81057,14.29228],[120.809769,14.29181],[120.806229,14.28998],[120.804901,14.28931],[120.802063,14.28757],[120.798309,14.2857],[120.792213,14.28238],[120.788612,14.2884],[120.787956,14.28963],[120.786659,14.29179],[120.787483,14.2923],[120.79158,14.29506],[120.793137,14.29676],[120.795471,14.29953],[120.796928,14.30077]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10550,"NAME_3":"Humbac","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.766197,14.31813],[120.767509,14.31945],[120.768089,14.31881],[120.769089,14.31828],[120.769676,14.31781],[120.770073,14.31745],[120.769814,14.31668],[120.769524,14.31613],[120.769234,14.31572],[120.766197,14.31813]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10551,"NAME_3":"Ibayo Estacion","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.769722,14.32933],[120.769821,14.32828],[120.770157,14.32789],[120.77076,14.32727],[120.77137,14.32683],[120.771744,14.32605],[120.772591,14.32497],[120.770638,14.32312],[120.768913,14.32191],[120.767021,14.32038],[120.766571,14.32094],[120.766006,14.321],[120.765198,14.32126],[120.76458,14.32184],[120.764091,14.3223],[120.763283,14.32248],[120.762802,14.32201],[120.762093,14.32114],[120.761711,14.32374],[120.765457,14.32651],[120.769722,14.32933]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10552,"NAME_3":"Ibayo Silangan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.773247,14.32551],[120.774567,14.32522],[120.77565,14.32507],[120.778954,14.32391],[120.781349,14.32267],[120.780998,14.32235],[120.778877,14.32059],[120.775726,14.31822],[120.773621,14.31899],[120.772987,14.31952],[120.77224,14.31976],[120.771523,14.31882],[120.771339,14.31775],[120.771278,14.31705],[120.770531,14.31729],[120.770073,14.31745],[120.769676,14.31781],[120.769089,14.31828],[120.768089,14.31881],[120.767509,14.31945],[120.767021,14.32038],[120.768913,14.32191],[120.770638,14.32312],[120.772591,14.32497],[120.773247,14.32551]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10553,"NAME_3":"Kanluran","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.763046,14.31687],[120.766197,14.31813],[120.769234,14.31572],[120.768738,14.31548],[120.767899,14.31517],[120.76712,14.31594],[120.766319,14.31657],[120.765717,14.31653],[120.765198,14.31578],[120.764709,14.31529],[120.764374,14.31534],[120.763611,14.31575],[120.763046,14.31687]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10554,"NAME_3":"Labac","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.727501,14.31074],[120.727501,14.31083],[120.728333,14.31167],[120.728333,14.31194],[120.730553,14.31417],[120.731079,14.31434],[120.731506,14.31455],[120.731941,14.31476],[120.73233,14.31499],[120.732742,14.3152],[120.7332,14.31533],[120.733643,14.31549],[120.734047,14.31551],[120.734123,14.31552],[120.734596,14.31547],[120.735077,14.31552],[120.735558,14.31549],[120.736,14.31532],[120.736488,14.31518],[120.737053,14.31506],[120.737663,14.31505],[120.738228,14.31514],[120.738731,14.31529],[120.73922,14.3154],[120.739754,14.31528],[120.739929,14.31525],[120.740311,14.31519],[120.740791,14.31544],[120.741249,14.31574],[120.741814,14.31583],[120.742416,14.31588],[120.742981,14.31611],[120.7435,14.31635],[120.744003,14.3165],[120.744476,14.31663],[120.74498,14.31673],[120.745422,14.31697],[120.745872,14.31728],[120.74633,14.31768],[120.746399,14.31705],[120.746422,14.31649],[120.746307,14.31613],[120.745743,14.31451],[120.74572,14.31392],[120.746071,14.31316],[120.7472,14.31252],[120.747627,14.31176],[120.747269,14.31077],[120.747269,14.31019],[120.747887,14.31001],[120.749023,14.31056],[120.74984,14.31044],[120.750641,14.30858],[120.751472,14.30825],[120.751663,14.30732],[120.751251,14.30685],[120.751167,14.30573],[120.75164,14.30486],[120.752296,14.30424],[120.752907,14.30395],[120.753052,14.30365],[120.746437,14.29659],[120.745796,14.29764],[120.745293,14.29806],[120.743797,14.29915],[120.742577,14.30067],[120.741898,14.3013],[120.740562,14.30152],[120.739609,14.30153],[120.739128,14.30179],[120.738258,14.30266],[120.737892,14.30344],[120.737221,14.3043],[120.736237,14.30493],[120.735184,14.3056],[120.73069,14.30862],[120.727501,14.31074]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10555,"NAME_3":"Latoria","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.760094,14.32985],[120.760246,14.32995],[120.760612,14.33011],[120.760887,14.33032],[120.761208,14.33049],[120.761642,14.33054],[120.762154,14.33055],[120.762688,14.33055],[120.763206,14.33056],[120.763702,14.33058],[120.763947,14.33063],[120.764732,14.33008],[120.765961,14.33096],[120.767014,14.33117],[120.767776,14.3311],[120.768448,14.33105],[120.769211,14.33038],[120.769722,14.32933],[120.765457,14.32651],[120.762527,14.32867],[120.760612,14.32961],[120.760094,14.32985]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10556,"NAME_3":"Mabolo","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.74633,14.31768],[120.746902,14.31804],[120.747551,14.31834],[120.747993,14.3185],[120.748451,14.31786],[120.749046,14.31704],[120.749802,14.3161],[120.75679,14.30764],[120.75473,14.30534],[120.753052,14.30365],[120.752907,14.30395],[120.752296,14.30424],[120.75164,14.30486],[120.751167,14.30573],[120.751251,14.30685],[120.751663,14.30732],[120.751472,14.30825],[120.750641,14.30858],[120.74984,14.31044],[120.749023,14.31056],[120.747887,14.31001],[120.747269,14.31019],[120.747269,14.31077],[120.747627,14.31176],[120.7472,14.31252],[120.746071,14.31316],[120.74572,14.31392],[120.745743,14.31451],[120.746307,14.31613],[120.746422,14.31649],[120.746399,14.31705],[120.74633,14.31768]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10557,"NAME_3":"Makina","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.775726,14.31822],[120.77623,14.31799],[120.776337,14.31736],[120.776016,14.31699],[120.775383,14.31703],[120.775131,14.31666],[120.775398,14.31625],[120.777046,14.31609],[120.77787,14.31627],[120.778267,14.3167],[120.779129,14.31653],[120.779984,14.31584],[120.780212,14.31507],[120.780144,14.31417],[120.780777,14.31381],[120.781914,14.31403],[120.779716,14.31219],[120.779213,14.31167],[120.778717,14.31116],[120.778137,14.31058],[120.776154,14.30884],[120.775749,14.3103],[120.774963,14.31186],[120.774757,14.3131],[120.771317,14.31285],[120.769661,14.31275],[120.768494,14.31254],[120.768318,14.31354],[120.768143,14.3146],[120.767899,14.31517],[120.768738,14.31548],[120.769234,14.31572],[120.769524,14.31613],[120.769814,14.31668],[120.770073,14.31745],[120.770531,14.31729],[120.771278,14.31705],[120.771339,14.31775],[120.771523,14.31882],[120.77224,14.31976],[120.772987,14.31952],[120.773621,14.31899],[120.775726,14.31822]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10558,"NAME_3":"Malainen Bago","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.767899,14.31517],[120.768143,14.3146],[120.768318,14.31354],[120.768494,14.31254],[120.768593,14.3121],[120.769157,14.31145],[120.769272,14.31056],[120.769203,14.30977],[120.769676,14.30846],[120.770462,14.30794],[120.771317,14.3086],[120.771599,14.30837],[120.772362,14.30716],[120.772537,14.3066],[120.773163,14.30608],[120.773613,14.30575],[120.773712,14.30503],[120.774094,14.30462],[120.774361,14.3042],[120.774208,14.30345],[120.774017,14.30235],[120.774811,14.30239],[120.775352,14.3017],[120.77562,14.30165],[120.775917,14.30212],[120.776398,14.30275],[120.777023,14.30223],[120.777603,14.30251],[120.777931,14.30307],[120.778503,14.30227],[120.77832,14.30128],[120.777924,14.30045],[120.777763,14.29899],[120.778053,14.29832],[120.778511,14.29719],[120.779167,14.29681],[120.780273,14.29652],[120.78064,14.29603],[120.780457,14.29537],[120.780899,14.29493],[120.780952,14.2945],[120.780212,14.29477],[120.779984,14.29418],[120.780434,14.29373],[120.780548,14.29224],[120.781189,14.29207],[120.78141,14.29118],[120.782082,14.29058],[120.779907,14.28971],[120.777046,14.28816],[120.775574,14.28685],[120.77198,14.28391],[120.761482,14.29684],[120.760094,14.29865],[120.75946,14.2995],[120.75473,14.30534],[120.75679,14.30764],[120.758423,14.30908],[120.760948,14.31142],[120.764709,14.31529],[120.765198,14.31578],[120.765717,14.31653],[120.766319,14.31657],[120.76712,14.31594],[120.767899,14.31517]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10559,"NAME_3":"Malainen Luma","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.794434,14.27777],[120.795692,14.27623],[120.796799,14.27539],[120.797752,14.2752],[120.798431,14.27461],[120.798401,14.27377],[120.798843,14.27331],[120.799072,14.27257],[120.798943,14.27116],[120.799187,14.27024],[120.79953,14.27012],[120.800102,14.26998],[120.800957,14.26899],[120.801849,14.26861],[120.802597,14.26735],[120.804024,14.26673],[120.804764,14.26612],[120.805527,14.26521],[120.807266,14.26317],[120.808327,14.26269],[120.809067,14.26174],[120.810127,14.26152],[120.810783,14.26001],[120.812187,14.2584],[120.81263,14.25872],[120.813477,14.25752],[120.814072,14.25646],[120.815041,14.25574],[120.816132,14.25479],[120.816208,14.25375],[120.816994,14.25316],[120.81781,14.25278],[120.818863,14.25252],[120.81945,14.25189],[120.819832,14.25076],[120.820511,14.24925],[120.826263,14.24232],[120.830116,14.23784],[120.81546,14.23471],[120.814468,14.23565],[120.813187,14.23765],[120.812798,14.23927],[120.811974,14.24012],[120.810806,14.24049],[120.809669,14.24196],[120.808357,14.24426],[120.807137,14.24588],[120.805428,14.24794],[120.802589,14.25125],[120.801048,14.25189],[120.799553,14.25132],[120.798248,14.25165],[120.797562,14.25312],[120.796822,14.25366],[120.796417,14.25413],[120.795967,14.25481],[120.795403,14.25595],[120.795319,14.2569],[120.795662,14.25829],[120.795952,14.25932],[120.795387,14.26042],[120.794853,14.26151],[120.794067,14.26296],[120.793411,14.26389],[120.792923,14.2645],[120.79171,14.26605],[120.790199,14.26781],[120.789307,14.26891],[120.788406,14.26957],[120.785469,14.27084],[120.783981,14.27122],[120.787018,14.276],[120.789368,14.27823],[120.792053,14.28081],[120.792503,14.28015],[120.793427,14.27897],[120.794434,14.27777]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10560,"NAME_3":"Molino","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.786659,14.29179],[120.787956,14.28963],[120.788612,14.2884],[120.792213,14.28238],[120.792686,14.2815],[120.792053,14.28081],[120.789368,14.27823],[120.787018,14.276],[120.783981,14.27122],[120.7817,14.2724],[120.7799,14.27285],[120.779259,14.27287],[120.778679,14.27272],[120.777924,14.2737],[120.777557,14.2741],[120.776573,14.27447],[120.775352,14.27459],[120.773949,14.27451],[120.772163,14.27538],[120.770981,14.27596],[120.769112,14.27708],[120.768066,14.27766],[120.767036,14.27842],[120.771317,14.2832],[120.77198,14.28391],[120.775574,14.28685],[120.777046,14.28816],[120.779907,14.28971],[120.782082,14.29058],[120.782379,14.29027],[120.783401,14.28984],[120.785629,14.29099],[120.786659,14.29179]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10561,"NAME_3":"Munting Mapino","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.783432,14.3349],[120.77964,14.3313],[120.77916,14.33102],[120.774933,14.32707],[120.773247,14.32551],[120.772591,14.32497],[120.771744,14.32605],[120.77137,14.32683],[120.77076,14.32727],[120.770157,14.32789],[120.769821,14.32828],[120.769722,14.32933],[120.769211,14.33038],[120.768448,14.33105],[120.767776,14.3311],[120.767014,14.33117],[120.765961,14.33096],[120.764732,14.33008],[120.763947,14.33063],[120.764137,14.33066],[120.764526,14.33078],[120.7649,14.33083],[120.765259,14.3309],[120.765602,14.33106],[120.765984,14.33118],[120.766342,14.33134],[120.766762,14.33144],[120.767151,14.33161],[120.767563,14.33169],[120.767937,14.33183],[120.76828,14.33201],[120.768578,14.33226],[120.768837,14.33259],[120.769073,14.33299],[120.769417,14.33334],[120.769791,14.33372],[120.770058,14.33416],[120.770317,14.33464],[120.77066,14.3351],[120.771019,14.33554],[120.77137,14.33595],[120.77166,14.33633],[120.771912,14.33665],[120.772141,14.33694],[120.772346,14.3372],[120.772552,14.33742],[120.772774,14.33763],[120.772972,14.33785],[120.773132,14.33811],[120.773331,14.33833],[120.773529,14.33855],[120.773697,14.33882],[120.773933,14.3391],[120.774178,14.33943],[120.774452,14.33978],[120.77475,14.34015],[120.775047,14.3405],[120.77536,14.34084],[120.775627,14.34119],[120.775887,14.34156],[120.776207,14.3419],[120.776253,14.34193],[120.783432,14.3349]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10562,"NAME_3":"Muzon","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.75473,14.30534],[120.75946,14.2995],[120.760094,14.29865],[120.761482,14.29684],[120.77198,14.28391],[120.771317,14.2832],[120.767036,14.27842],[120.765556,14.27953],[120.763527,14.28064],[120.761757,14.28257],[120.756813,14.28615],[120.752419,14.29057],[120.748428,14.29473],[120.746437,14.29659],[120.753052,14.30365],[120.75473,14.30534]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10563,"NAME_3":"Palangue 1","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.824249,14.28712],[120.824547,14.28576],[120.825531,14.2839],[120.826576,14.28211],[120.827164,14.28046],[120.827538,14.2785],[120.828331,14.27726],[120.829071,14.27591],[120.830704,14.27488],[120.832123,14.27404],[120.83358,14.2724],[120.834877,14.27046],[120.837608,14.26852],[120.84008,14.2674],[120.842598,14.26605],[120.845612,14.26456],[120.845993,14.26402],[120.846367,14.26258],[120.847366,14.26168],[120.84819,14.26081],[120.848877,14.25942],[120.850616,14.25837],[120.851151,14.25713],[120.852226,14.25636],[120.853043,14.25589],[120.85363,14.25501],[120.854843,14.25417],[120.855797,14.25342],[120.856667,14.25242],[120.857269,14.25186],[120.858932,14.25047],[120.860161,14.24863],[120.860924,14.24762],[120.860977,14.24743],[120.861153,14.24699],[120.86116,14.24634],[120.841423,14.24068],[120.840408,14.24005],[120.830116,14.23784],[120.826263,14.24232],[120.820511,14.24925],[120.819832,14.25076],[120.81945,14.25189],[120.818863,14.25252],[120.81781,14.25278],[120.816994,14.25316],[120.816208,14.25375],[120.816132,14.25479],[120.815041,14.25574],[120.814072,14.25646],[120.813477,14.25752],[120.81263,14.25872],[120.812187,14.2584],[120.810783,14.26001],[120.810127,14.26152],[120.809067,14.26174],[120.808327,14.26269],[120.807266,14.26317],[120.805527,14.26521],[120.804764,14.26612],[120.804024,14.26673],[120.802597,14.26735],[120.801849,14.26861],[120.800957,14.26899],[120.800102,14.26998],[120.79953,14.27012],[120.799187,14.27024],[120.798943,14.27116],[120.799072,14.27257],[120.798843,14.27331],[120.798401,14.27377],[120.798431,14.27461],[120.797752,14.2752],[120.796799,14.27539],[120.795692,14.27623],[120.794434,14.27777],[120.799454,14.27923],[120.806091,14.28108],[120.810387,14.28262],[120.811623,14.28306],[120.813179,14.28332],[120.814919,14.28395],[120.820442,14.28561],[120.824249,14.28712]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10564,"NAME_3":"Palangue 2 & 3","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.824249,14.28712],[120.820442,14.28561],[120.814919,14.28395],[120.813179,14.28332],[120.811623,14.28306],[120.810387,14.28262],[120.806091,14.28108],[120.799454,14.27923],[120.794434,14.27777],[120.793427,14.27897],[120.792503,14.28015],[120.792053,14.28081],[120.792686,14.2815],[120.792213,14.28238],[120.798309,14.2857],[120.802063,14.28757],[120.804901,14.28931],[120.806229,14.28998],[120.809769,14.29181],[120.81057,14.29228],[120.813843,14.29398],[120.819939,14.29436],[120.820732,14.2926],[120.821609,14.2913],[120.822838,14.28971],[120.823647,14.28833],[120.824249,14.28712]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10565,"NAME_3":"Sabang","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.788643,14.33889],[120.789307,14.33951],[120.792732,14.34074],[120.794243,14.34066],[120.7957,14.34114],[120.797279,14.34136],[120.799011,14.33994],[120.80159,14.33861],[120.803528,14.3379],[120.803902,14.33652],[120.804771,14.33587],[120.805656,14.33537],[120.806343,14.3347],[120.806549,14.33396],[120.807983,14.33238],[120.809158,14.33198],[120.810867,14.33117],[120.813759,14.32859],[120.813812,14.32728],[120.814857,14.32588],[120.815437,14.32531],[120.816597,14.32479],[120.818443,14.32394],[120.818871,14.32316],[120.819069,14.32229],[120.819817,14.32115],[120.820297,14.32056],[120.820663,14.31985],[120.821167,14.31948],[120.822182,14.31878],[120.822487,14.31704],[120.822533,14.31642],[120.822258,14.31442],[120.822929,14.31309],[120.823288,14.31146],[120.823837,14.30945],[120.82431,14.30771],[120.824966,14.30622],[120.825073,14.30456],[120.824379,14.30272],[120.823463,14.30082],[120.822388,14.29903],[120.821381,14.29831],[120.820297,14.29734],[120.815407,14.3016],[120.814293,14.30287],[120.813179,14.30343],[120.812668,14.3024],[120.811897,14.30196],[120.811562,14.30122],[120.81073,14.30081],[120.809601,14.3011],[120.809677,14.30198],[120.808243,14.30261],[120.807747,14.30351],[120.807037,14.30409],[120.807091,14.3045],[120.805817,14.30476],[120.803978,14.30431],[120.803482,14.30436],[120.802559,14.3051],[120.800812,14.30515],[120.799843,14.30533],[120.799156,14.30575],[120.798843,14.30679],[120.798538,14.30773],[120.797394,14.30863],[120.79641,14.30895],[120.795212,14.30953],[120.795059,14.3103],[120.795502,14.31064],[120.795517,14.31139],[120.794617,14.31257],[120.793159,14.31382],[120.792542,14.31418],[120.791977,14.31496],[120.790672,14.3157],[120.789467,14.31593],[120.788643,14.31569],[120.787987,14.31516],[120.787216,14.31496],[120.78614,14.31564],[120.785332,14.31589],[120.784416,14.31578],[120.783188,14.31485],[120.781914,14.31403],[120.780777,14.31381],[120.780144,14.31417],[120.780212,14.31507],[120.779984,14.31584],[120.779129,14.31653],[120.778267,14.3167],[120.77787,14.31627],[120.777046,14.31609],[120.775398,14.31625],[120.775131,14.31666],[120.775383,14.31703],[120.776016,14.31699],[120.776337,14.31736],[120.77623,14.31799],[120.775726,14.31822],[120.778877,14.32059],[120.780998,14.32235],[120.781349,14.32267],[120.778954,14.32391],[120.77565,14.32507],[120.774567,14.32522],[120.773247,14.32551],[120.774933,14.32707],[120.77916,14.33102],[120.77964,14.3313],[120.783432,14.3349],[120.784019,14.33548],[120.785622,14.33652],[120.788643,14.33889]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10566,"NAME_3":"San Roque","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.781914,14.31403],[120.783188,14.31485],[120.784416,14.31578],[120.785332,14.31589],[120.78614,14.31564],[120.787216,14.31496],[120.787987,14.31516],[120.788643,14.31569],[120.789467,14.31593],[120.790672,14.3157],[120.791977,14.31496],[120.792542,14.31418],[120.793159,14.31382],[120.794617,14.31257],[120.795517,14.31139],[120.795502,14.31064],[120.795059,14.3103],[120.795212,14.30953],[120.79641,14.30895],[120.797394,14.30863],[120.798538,14.30773],[120.798843,14.30679],[120.799156,14.30575],[120.799843,14.30533],[120.800812,14.30515],[120.798698,14.3027],[120.796928,14.30077],[120.795929,14.30115],[120.795471,14.30197],[120.793854,14.30352],[120.792648,14.30341],[120.79213,14.30448],[120.79174,14.30554],[120.791344,14.30624],[120.790604,14.30655],[120.790253,14.30608],[120.789886,14.30639],[120.78952,14.3074],[120.788879,14.30703],[120.788567,14.30743],[120.787827,14.30755],[120.787018,14.30689],[120.786102,14.30674],[120.785881,14.30723],[120.783958,14.30623],[120.783112,14.30549],[120.779778,14.30327],[120.778503,14.30227],[120.777931,14.30307],[120.777603,14.30251],[120.777023,14.30223],[120.776398,14.30275],[120.775917,14.30212],[120.77562,14.30165],[120.775352,14.3017],[120.774811,14.30239],[120.774017,14.30235],[120.774208,14.30345],[120.774361,14.3042],[120.774094,14.30462],[120.773712,14.30503],[120.773613,14.30575],[120.773163,14.30608],[120.772537,14.3066],[120.772362,14.30716],[120.773453,14.30754],[120.776154,14.30884],[120.778137,14.31058],[120.778717,14.31116],[120.779213,14.31167],[120.779716,14.31219],[120.781914,14.31403]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10567,"NAME_3":"Santulan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.768494,14.31254],[120.769661,14.31275],[120.771317,14.31285],[120.774757,14.3131],[120.774963,14.31186],[120.775749,14.3103],[120.776154,14.30884],[120.773453,14.30754],[120.772362,14.30716],[120.771599,14.30837],[120.771317,14.3086],[120.770462,14.30794],[120.769676,14.30846],[120.769203,14.30977],[120.769272,14.31056],[120.769157,14.31145],[120.768593,14.3121],[120.768494,14.31254]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10568,"NAME_3":"Sapa","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.754112,14.32407],[120.754204,14.3242],[120.754471,14.3246],[120.754807,14.32502],[120.755188,14.32543],[120.75563,14.32561],[120.756088,14.32519],[120.756378,14.32468],[120.756508,14.32416],[120.756622,14.32366],[120.756737,14.32314],[120.756866,14.32269],[120.755623,14.32164],[120.755127,14.32243],[120.754112,14.32407]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10569,"NAME_3":"Timalan Balsahan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.776253,14.34193],[120.776588,14.34224],[120.776947,14.3426],[120.777298,14.34298],[120.777634,14.34336],[120.77787,14.34373],[120.778099,14.34394],[120.778259,14.34424],[120.778481,14.34461],[120.77877,14.34497],[120.778938,14.34525],[120.779556,14.34484],[120.780693,14.34406],[120.788643,14.33889],[120.785622,14.33652],[120.784019,14.33548],[120.783432,14.3349],[120.776253,14.34193]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10570,"NAME_3":"Timalan Concepcion","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.778938,14.34525],[120.779007,14.34537],[120.77919,14.34579],[120.779373,14.34617],[120.779533,14.34659],[120.77977,14.34699],[120.780037,14.34738],[120.780357,14.34777],[120.780693,14.34819],[120.78083,14.34833],[120.780563,14.34861],[120.783401,14.34693],[120.783463,14.34691],[120.785927,14.34637],[120.786774,14.34622],[120.788094,14.34523],[120.789192,14.34419],[120.790558,14.3429],[120.792236,14.34101],[120.792732,14.34074],[120.789307,14.33951],[120.788643,14.33889],[120.780693,14.34406],[120.779556,14.34484],[120.778938,14.34525]]]}}]'),rR={type:C$,features:P$},R$=({db:n,showNotification:e})=>{const[t,r]=ee.useState([]),[i,s]=ee.useState(!0),[o,l]=ee.useState(""),d=ee.useCallback(async()=>{s(!0),l("");const m=await pP(n);m.success?r(m.data):(l(m.error||"Failed loading advisories."),e(m.error||"Failed loading advisories.","error")),s(!1)},[n,e]);ee.useEffect(()=>{d()},[d]);const f=(m,y)=>{if((y==="Emergency Repair"||y==="Leak Detection")&&m!=="Resolved")return{icon:NP,color:"text-red-700",bgColor:"bg-red-50",borderColor:"border-red-400",label:"Emergency"};switch(m){case"Ongoing":return{icon:Xt,color:"text-orange-600",bgColor:"bg-orange-50",borderColor:"border-orange-400",label:"Ongoing"};case"Scheduled":return{icon:Ss,color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-400",label:"Scheduled"};case"Resolved":return{icon:Is,color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-400",label:"Resolved"};default:return{icon:An,color:"text-gray-500",bgColor:"bg-gray-50",borderColor:"border-gray-400",label:m||"Unknown"}}};return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(Xt,{size:30,className:"mr-3 text-orange-500"})," Service Advisories"]}),u.jsxs("button",{onClick:d,disabled:i,className:"flex items-center text-sm p-2 bg-gray-100 rounded-lg hover:bg-gray-200 border border-gray-300",children:[i?u.jsx(St,{size:16,className:"animate-spin"}):u.jsx(ja,{size:16}),u.jsx("span",{className:"ml-1.5 hidden sm:inline",children:"Refresh"})]})]}),i&&u.jsx(gn,{message:"Loading advisories..."}),o&&u.jsx("div",{className:"text-red-600 bg-red-50 p-3 rounded-md text-center border border-red-200",children:o}),!i&&!o&&t.length===0&&u.jsxs("div",{className:"text-center py-10 bg-green-50 p-6 rounded-lg shadow-inner border border-green-200",children:[u.jsx(Is,{size:48,className:"mx-auto text-green-400 mb-4"}),u.jsx("p",{className:"text-gray-700 text-lg font-medium",children:"No Active Service Advisories"}),u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Water service is currently stable."})]}),!i&&!o&&t.length>0&&u.jsx("div",{className:"space-y-4",children:t.map(m=>{var E;const y=f(m.status,m.type),g=y.icon,_=Mo.sanitize(m.description||"");return u.jsxs("details",{className:`p-4 rounded-lg shadow-md border-l-4 group transition-all duration-300 ease-in-out ${y.borderColor} ${y.bgColor} hover:shadow-lg`,children:[u.jsxs("summary",{className:"flex justify-between items-center cursor-pointer list-none",children:[u.jsxs("div",{className:"flex-grow pr-4",children:[u.jsx("h3",{className:"text-md sm:text-lg font-semibold text-gray-800",children:m.title||"Service Advisory"}),u.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["ID: ",m.id.substring(0,8),"..."]})]}),u.jsxs("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full flex items-center shrink-0 ${y.bgColor==="bg-red-50"?"bg-red-100 text-red-700":y.bgColor==="bg-blue-50"?"bg-blue-100 text-blue-700":y.bgColor==="bg-orange-50"?"bg-orange-100 text-orange-700":"bg-green-100 text-green-700"}`,children:[u.jsx(g,{size:14,className:`mr-1.5 ${y.color}`})," ",y.label]}),u.jsx("span",{className:"ml-2 transition-transform duration-300 transform group-open:rotate-180 text-gray-500",children:""})]}),u.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200/80 text-sm text-gray-700 space-y-3 grid grid-rows-[0fr] group-open:grid-rows-[1fr] transition-all duration-500 ease-in-out",children:u.jsxs("div",{className:"overflow-hidden space-y-4",children:[u.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:_}}),u.jsxs("div",{children:[u.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center",children:[u.jsx(Zl,{size:16,className:"mr-2 text-gray-500"}),"Affected Area Map"]}),u.jsx(nR,{geoJsonData:rR,affectedAreas:m.affectedAreas||[]})]}),u.jsxs("div",{className:"text-xs text-gray-600 space-y-1 border-t border-gray-200/80 pt-3 mt-3",children:[u.jsxs("p",{className:"flex items-center",children:[u.jsx(Oo,{size:12,className:"mr-1.5 text-gray-400"}),u.jsx("strong",{children:"Affected:"})," ",((E=m.affectedAreas)==null?void 0:E.join(", "))||"N/A"]}),u.jsxs("p",{className:"flex items-center",children:[u.jsx(Ss,{size:12,className:"mr-1.5 text-gray-400"}),u.jsx("strong",{children:"Start:"})," ",Zt(m.startDate)]}),m.estimatedEndDate&&u.jsxs("p",{className:"flex items-center",children:[u.jsx(Ss,{size:12,className:"mr-1.5 text-gray-400"}),u.jsx("strong",{children:"Est. End:"})," ",Zt(m.estimatedEndDate)]})]})]})})]},m.id)})})]})},j$=({db:n,showNotification:e})=>{const[t,r]=ee.useState([]),[i,s]=ee.useState(!0),[o,l]=ee.useState(""),d=ee.useCallback(async()=>{s(!0),l("");const m=await pP(n);if(m.success){const y=new Set;m.data.forEach(g=>{var _;(_=g.affectedAreas)==null||_.forEach(E=>{y.add(E)})}),r(Array.from(y))}else l(m.error||"Failed loading advisory data."),e(m.error||"Failed loading advisories.","error");s(!1)},[n,e]);ee.useEffect(()=>{d()},[d]);const f=ee.useMemo(()=>rR,[]);return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn h-[calc(100vh-4rem)] flex flex-col",children:[u.jsx("div",{className:"flex justify-between items-center mb-4 pb-4 border-b border-gray-200",children:u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(Zl,{size:30,className:"mr-3 text-red-600"}),"Active Interruption Map"]})}),i&&u.jsx(gn,{message:"Loading map data..."}),o&&u.jsx("div",{className:"text-red-600 bg-red-50 p-3 rounded-md text-center border border-red-200",children:o}),!i&&!o&&u.jsxs("div",{className:"space-y-4 flex-grow flex flex-col",children:[u.jsxs("p",{className:"text-sm text-gray-600",children:["The map below highlights all areas currently affected by any active service advisory.",t.length===0?" Currently, there are no advisories reporting specific affected areas.":` A total of ${t.length} barangay(s) are affected.`]}),u.jsx("div",{className:"flex-grow w-full rounded-lg overflow-hidden border border-gray-300 shadow-inner relative z-10",children:u.jsx(nR,{geoJsonData:f,affectedAreas:t,height:"100%"})})]})]})},zI=({onNavigateHome:n})=>u.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-6 bg-gray-50 rounded-lg shadow-md m-4",children:[u.jsx(l9,{size:48,className:"text-yellow-500 mb-4"}),u.jsx("h1",{className:"text-2xl font-bold text-gray-700 mb-2",children:"404 - Page Not Found"}),u.jsx("p",{className:"text-gray-600 mb-4 max-w-md",children:"The page you are looking for does not exist or has been moved."}),n&&u.jsxs("button",{onClick:n,className:"flex items-center justify-center px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow hover:shadow-md transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50",children:[u.jsx(e2,{size:16,className:"mr-2"}),"Go to Dashboard"]})]}),O$=({isOpen:n,onClose:e,userData:t,showNotification:r,setActiveDashboardSection:i})=>{const s={role:"assistant",text:`Hello, ${(t==null?void 0:t.displayName)||"Valued Customer"}! I am Agie, your AGWA Water Services virtual assistant. How can I help you today with your account (${(t==null?void 0:t.accountNumber)||"N/A"}) or other water service inquiries?`},[o,l]=ee.useState([s]),[d,f]=ee.useState(""),[m,y]=ee.useState(!1),[g,_]=ee.useState(!1),[E,x]=ee.useState(""),w=ee.useRef(null);ee.useEffect(()=>{w.current&&(w.current.scrollTop=w.current.scrollHeight)},[o]),ee.useEffect(()=>{n&&(l([s]),f(""),y(!1),_(!1),x(""))},[n,t]);const S=async R=>{if(R.preventDefault(),!d.trim()||m)return;const U={role:"user",text:d},j=[...o,U];l(j),f(""),y(!0),_(!1),x("");try{const k=`You are Agie, the friendly and professional AI assistant for AGWA Water Services, a major water utility provider in the Philippines.
Current Customer Details:
- Name: ${t.displayName||"Valued Customer"}
- Account Number: ${t.accountNumber||"Not available"}
- Service Type: ${t.serviceType||"Not specified"}

Your primary goals are:
1.  Understand the customer's query accurately. Queries can be about billing, payments, account management, water quality, leaks, service interruptions, how to use the portal, etc.
2.  Provide clear, concise, helpful, and empathetic responses.
3.  If the query is straightforward and answerable with general knowledge or information commonly found in FAQs (e.g., "how to pay my bill?", "what is FCDA?"), provide the answer.
4.  If the query implies needing specific account data you don't have (e.g., "what was my last payment amount?", "is my meter reading correct for May?"), explain you cannot access real-time specific account details but can guide them to where they might find it in the portal (e.g., "You can check your detailed bill history under 'My Bills' section").
5.  If the customer expresses frustration, has a complex issue (like a persistent leak or no water for an extended time), or directly asks to speak to a human or create a ticket, ALWAYS offer to help them create a support ticket. In this specific scenario, and ONLY in this scenario, end your response with the exact phrase: "WOULD_YOU_LIKE_A_TICKET?".
6.  Do NOT use the phrase "WOULD_YOU_LIKE_A_TICKET?" if you are providing a direct answer or general guidance.
7.  Be polite, patient, and professional. Avoid overly technical jargon unless necessary and explain it if used.
8.  If the user's query is very vague, ask clarifying questions.
9.  Do not make up information or promise actions you cannot perform.
10. Keep responses relatively brief and to the point.

Respond to the customer's latest message based on the conversation history.`,F=await z9(j,k);if(F.includes("WOULD_YOU_LIKE_A_TICKET?")){const O=F.replace("WOULD_YOU_LIKE_A_TICKET?","").trim();l(C=>[...C,{role:"assistant",text:O}]),_(!0)}else l(O=>[...O,{role:"assistant",text:F}])}catch(k){console.error("Chatbot API error:",k);const F="I'm currently experiencing some technical difficulties and can't respond right now. Please try again in a few moments. If the issue persists, you might want to report an issue directly through the portal.";l(O=>[...O,{role:"assistant",text:F}]),x("Failed to get response from assistant.")}finally{y(!1)}},N=()=>{var j;const U=o.slice(-5).map(k=>`${k.role==="user"?t.displayName||"You":"Agie"}: ${k.text}`).join(`

`);localStorage.setItem("chatbotIssueDescription",`Issue raised via Chatbot Agie:

${U}

Initial User Query (if available):
${((j=o.find(k=>k.role==="user"))==null?void 0:j.text)||"User initiated ticket creation from chat."}`),localStorage.setItem("chatbotIssueTypeSuggestion","Chatbot Assistance Follow-up"),e(),i&&i("reportIssue"),r("Please review and submit the support ticket drafted from your chat.","success")},P=["How to pay my bill?","Report a water leak.","My water pressure is low.","What are current announcements?"],I=R=>{f(R)};return u.jsxs(Or,{isOpen:n,onClose:e,title:"Chat with Agie - Your AGWA Assistant",size:"lg",children:[u.jsx("style",{children:`
                .animate-message-appear {
                    animation: message-appear 0.3s ease-out forwards;
                }
                @keyframes message-appear {
                    from { opacity: 0; transform: translateY(10px) scale(0.98); }
                    to { opacity: 1; transform: translateY(0) scale(1); }
                }
                .chatbot-input-shadow {
                    box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
                }
            `}),u.jsxs("div",{className:"flex flex-col h-[65vh] sm:h-[70vh] bg-gray-50",children:[u.jsxs("div",{ref:w,className:"flex-grow p-4 space-y-4 overflow-y-auto",children:[o.map((R,U)=>{var j;return u.jsxs("div",{className:`flex items-end animate-message-appear ${R.role==="user"?"justify-end":"justify-start"}`,children:[R.role==="assistant"&&u.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-2",children:u.jsx(Rs,{size:18})}),u.jsx("div",{className:`max-w-[75%] p-3 rounded-2xl shadow-sm ${R.role==="user"?"bg-blue-600 text-white rounded-br-none":"bg-white text-gray-800 border border-gray-200 rounded-bl-none"}`,children:u.jsx("p",{className:"text-sm whitespace-pre-wrap",children:R.text})}),R.role==="user"&&u.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-gray-300 text-gray-600 flex items-center justify-center ml-2 uppercase",children:((j=t==null?void 0:t.displayName)==null?void 0:j.charAt(0))||"U"})]},U)}),m&&u.jsxs("div",{className:"flex items-end justify-start animate-message-appear",children:[u.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-2",children:u.jsx(Rs,{size:18})}),u.jsx("div",{className:"max-w-[75%] p-3 rounded-2xl shadow-sm bg-white text-gray-800 border border-gray-200 rounded-bl-none",children:u.jsx(gn,{size:"h-5 w-5",color:"text-blue-500",message:""})})]}),E&&u.jsxs("div",{className:"flex items-center justify-center p-3 bg-red-50 text-red-700 rounded-lg animate-message-appear",children:[u.jsx(Xt,{size:20,className:"mr-2"}),u.jsx("p",{className:"text-sm",children:E})]})]}),g&&u.jsx("div",{className:"p-3 border-t border-gray-200 bg-white",children:u.jsxs("button",{onClick:N,className:"w-full flex items-center justify-center bg-green-600 hover:bg-green-700 text-white font-semibold py-2.5 px-4 rounded-lg transition-all duration-150 active:scale-95 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50",children:[u.jsx(h9,{size:20,className:"mr-2"})," Create Support Ticket from this Chat"]})}),!g&&o.length<=1&&u.jsx("div",{className:"p-2 border-t border-gray-200 bg-white flex flex-wrap gap-2 justify-center",children:P.map(R=>u.jsx("button",{onClick:()=>I(R),className:"text-xs bg-blue-100 text-blue-700 hover:bg-blue-200 px-3 py-1.5 rounded-full transition-colors",disabled:m,children:R},R))}),u.jsxs("form",{onSubmit:S,className:"p-3 border-t border-gray-200 flex items-center space-x-3 bg-white chatbot-input-shadow",children:[u.jsx("input",{type:"text",value:d,onChange:R=>f(R.target.value),placeholder:"Type your message to Agie...",className:"flex-grow px-4 py-2.5 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-shadow focus:shadow-md text-sm",disabled:m,"aria-label":"Chat input"}),u.jsx("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-xl disabled:opacity-60 disabled:cursor-not-allowed transition-all duration-150 active:scale-90 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50",disabled:m||!d.trim(),"aria-label":"Send message",children:u.jsx(By,{size:20})})]})]})]})},M$=({isOpen:n,onLink:e,isLinking:t,error:r,onLogout:i})=>{const[s,o]=ee.useState("");ee.useEffect(()=>{n||o("")},[n]);const l=d=>{d.preventDefault(),s.trim()&&e(s.trim())};return u.jsx(Or,{isOpen:n,onClose:()=>{},title:"Link Your AGWA Account",hideCloseButton:!0,size:"md",children:u.jsxs("form",{onSubmit:l,className:"space-y-5",children:[u.jsx("p",{className:"text-sm text-center text-gray-600",children:"To access services, please link your official AGWA account number. This is a one-time step for accounts created with Google or an Email Link."}),r&&u.jsx("div",{className:"text-center p-2 bg-red-100 text-red-700 rounded-md text-sm border border-red-200",children:r}),u.jsxs("div",{className:"relative",children:[u.jsx(Cs,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"AGWA Account Number (e.g., RES-12345)",value:s,onChange:d=>o(d.target.value),className:`${Mi} pl-11`,required:!0,disabled:t,"aria-label":"AGWA Account Number",autoFocus:!0})]}),u.jsxs("button",{type:"submit",className:Uf(t||!s.trim()),disabled:t||!s.trim(),children:[t?u.jsx(St,{className:"animate-spin inline mr-2",size:18}):u.jsx(t2,{className:"inline mr-2",size:18}),t?"Linking...":"Link My Account"]}),u.jsx("div",{className:"text-center mt-4",children:u.jsxs("button",{type:"button",onClick:i,className:"text-sm font-medium text-gray-500 hover:text-red-600 hover:underline",children:[u.jsx(zy,{size:14,className:"inline mr-1"})," Not you? Logout"]})})]})})},D$=({user:n,userData:e,setUserData:t,handleLogout:r,showNotification:i,auth:s,db:o})=>{const[l,d]=ee.useState("mainDashboard"),[f,m]=ee.useState(!1),[y,g]=ee.useState(!1),[_,E]=ee.useState(!1),[x,w]=ee.useState(!1),[S,N]=ee.useState(""),[P,I]=ee.useState(null),[R,U]=ee.useState({});ee.useEffect(()=>{e&&!e.accountNumber&&e.role==="customer"?E(!0):E(!1)},[e]),ee.useEffect(()=>{if(!o)return;const M=Wt(o,ym()),$=tP(M,G=>{if(G.exists()){const re=G.data();U(re),re.isBannerEnabled&&re.portalAnnouncement?I({text:re.portalAnnouncement}):I(null)}else I(null),U({})},G=>{console.error("Error fetching system settings:",G),I(null),U({})});return()=>$()},[o]);const j=ee.useCallback(M=>{d(M),f&&m(!1)},[f]),k=async M=>{w(!0),N("");const $=await d8(o,n.uid,M);if($.success){const G=await Hg(o,n.uid);G.success?(t(G.data),E(!1),i("Account linked successfully!","success")):(N("Account linked, but failed to refresh profile. Please reload."),i("Account linked, but failed to refresh profile.","warning"))}else N($.error||"Failed linking account. Check number or contact support.");w(!1)},F={customer:[{name:"Dashboard",iconName:"Home",section:"mainDashboard",group:"Main"},{name:"My Profile",iconName:"UserCog",section:"myProfile",group:"Account"},{name:"My Bills & Payments",iconName:"FileText",section:"myBills",group:"Account"},{name:"Consumption Analytics",iconName:"TrendingUp",section:"waterAnalytics",group:"Account"},{name:"Rewards Program",iconName:"Gift",section:"rebateProgram",group:"Account"},{name:"My Support Tickets",iconName:"MessageSquare",section:"myTickets",group:"Support"},{name:"Report an Issue",iconName:"AlertTriangle",section:"reportIssue",group:"Support"},{name:"View Announcements",iconName:"Megaphone",section:"viewAnnouncements",group:"Information"},{name:"Service Advisories",iconName:"AlertIcon",section:"serviceAdvisories",group:"Information"},{name:"Interruption Map",iconName:"Map",section:"interruptionMap",group:"Information"},{name:"FAQs",iconName:"HelpCircle",section:"faqs",group:"Help & Info"},{name:"About Us",iconName:"Info",section:"aboutUs",group:"Help & Info"},{name:"Contact Us",iconName:"PhoneCall",section:"contactUs",group:"Help & Info"}],admin:[{name:"Dashboard",iconName:"Home",section:"mainDashboard",group:"Main"},{name:"System Analytics",iconName:"BarChart3",section:"systemAnalytics",group:"Main"},{name:"User Management",iconName:"Users",section:"userManagement",group:"Administration"},{name:"Support Tickets",iconName:"MessageSquare",section:"supportTickets",group:"Administration"},{name:"Manage Announcements",iconName:"Edit",section:"manageAnnouncements",group:"Administration"},{name:"Manage Interruptions",iconName:"AlertIcon",section:"manageInterruptions",group:"Administration"},{name:"System Settings",iconName:"Settings",section:"systemSettings",group:"Administration"},{name:"Batch Billing",iconName:"FileText",section:"batchBilling",group:"Operations"},{name:"Meter Reading Mgt.",iconName:"Gauge",section:"editMeterReadingsAdmin",group:"Operations"},{name:"Route Management",iconName:"Map",section:"routeManagement",group:"Operations"},{name:"My Profile",iconName:"UserCog",section:"myProfile",group:"Account"},{name:"Interruption Map",iconName:"Map",section:"interruptionMap",group:"Information"},{name:"FAQs",iconName:"HelpCircle",section:"faqs",group:"Help & Info"},{name:"About Us",iconName:"Info",section:"aboutUs",group:"Help & Info"},{name:"Contact Us",iconName:"PhoneCall",section:"contactUs",group:"Help & Info"}],meter_reader:[{name:"Dashboard",iconName:"Home",section:"mainDashboard",group:"Main"},{name:"Assigned Routes",iconName:"Map",section:"assignedRoutes",group:"Operations"},{name:"Submit Reading",iconName:"ClipboardEdit",section:"searchAndSubmitReading",group:"Operations"},{name:"Search Customer",iconName:"Search",section:"searchCustomerMeterReader",group:"Operations"},{name:"My Profile",iconName:"UserCog",section:"myProfile",group:"Account"},{name:"My Support Tickets",iconName:"MessageSquare",section:"myTickets",group:"Support"},{name:"Report an Issue",iconName:"AlertTriangle",section:"reportIssue",group:"Support"},{name:"View Announcements",iconName:"Megaphone",section:"viewAnnouncements",group:"Information"},{name:"Service Advisories",iconName:"AlertIcon",section:"serviceAdvisories",group:"Information"},{name:"Interruption Map",iconName:"Map",section:"interruptionMap",group:"Information"},{name:"FAQs",iconName:"HelpCircle",section:"faqs",group:"Help & Info"},{name:"Contact Us",iconName:"PhoneCall",section:"contactUs",group:"Help & Info"}],clerk_cashier:[{name:"Dashboard",iconName:"Home",section:"mainDashboard",group:"Main"},{name:"Process Walk-in Payment",iconName:"Banknote",section:"walkInPayments",group:"Operations"},{name:"Search Account / Bill",iconName:"FileSearch",section:"searchAccountOrBill",group:"Operations"},{name:"My Profile",iconName:"UserCog",section:"myProfile",group:"Account"},{name:"My Support Tickets",iconName:"MessageSquare",section:"myTickets",group:"Support"},{name:"Report an Issue",iconName:"AlertTriangle",section:"reportIssue",group:"Support"},{name:"View Announcements",iconName:"Megaphone",section:"viewAnnouncements",group:"Information"},{name:"Service Advisories",iconName:"AlertIcon",section:"serviceAdvisories",group:"Information"},{name:"Interruption Map",iconName:"Map",section:"interruptionMap",group:"Information"},{name:"FAQs",iconName:"HelpCircle",section:"faqs",group:"Help & Info"},{name:"Contact Us",iconName:"PhoneCall",section:"contactUs",group:"Help & Info"}]},O=F[e.role]||F.customer,C=()=>{const M={user:n,userData:e,setUserData:t,auth:s,db:o,showNotification:i,billingService:aP,determineServiceTypeAndRole:Wb,setActiveSection:j,systemSettings:R};if(!e||e.role==="customer"&&!e.accountNumber)return null;switch(l){case"mainDashboard":if(e.role==="customer")return u.jsx(q9,{...M});if(e.role==="admin")return u.jsx(lq,{...M});if(e.role==="meter_reader")return u.jsx(r$,{...M});if(e.role==="clerk_cashier")return u.jsx(l$,{...M});break;case"myProfile":return u.jsx(JU,{...M});case"reportIssue":return u.jsx(nq,{...M});case"faqs":return u.jsx(iq,{...M});case"aboutUs":return u.jsx(sq,{...M});case"contactUs":return u.jsx(aq,{...M});case"viewAnnouncements":return u.jsx(LI,{...M,viewOnly:!0});case"serviceAdvisories":return u.jsx(R$,{...M});case"interruptionMap":return u.jsx(j$,{...M});case"myBills":if(e.role==="customer")return u.jsx(NF,{...M});break;case"waterAnalytics":if(e.role==="customer")return u.jsx(QU,{...M});break;case"rebateProgram":if(e.role==="customer")return u.jsx(XU,{...M});break;case"myTickets":if(["customer","clerk_cashier","meter_reader"].includes(e.role))return u.jsx(d$,{...M});break;case"userManagement":if(e.role==="admin")return u.jsx(xq,{...M});break;case"batchBilling":if(e.role==="admin")return u.jsx(n$,{...M});break;case"routeManagement":if(e.role==="admin")return u.jsx(t$,{...M});break;case"supportTickets":if(e.role==="admin")return u.jsx(qH,{...M});break;case"manageAnnouncements":if(e.role==="admin")return u.jsx(LI,{...M,viewOnly:!1});break;case"manageInterruptions":if(e.role==="admin")return u.jsx(YH,{...M});break;case"systemAnalytics":if(e.role==="admin")return u.jsx(QH,{...M});break;case"editMeterReadingsAdmin":if(e.role==="admin")return u.jsx(JH,{...M});break;case"systemSettings":if(e.role==="admin")return u.jsx($H,{...M});break;case"assignedRoutes":if(e.role==="meter_reader")return u.jsx(s$,{...M});break;case"searchAndSubmitReading":if(e.role==="meter_reader")return u.jsx(K3,{...M});break;case"searchCustomerMeterReader":if(e.role==="meter_reader")return u.jsx(a$,{...M});break;case"walkInPayments":if(e.role==="clerk_cashier")return u.jsx(c$,{...M});break;case"searchAccountOrBill":if(e.role==="clerk_cashier")return u.jsx(u$,{...M});break;default:return u.jsx(zI,{onNavigateHome:()=>j("mainDashboard")})}return u.jsx(zI,{onNavigateHome:()=>j("mainDashboard")})},D=l==="interruptionMap"?"p-0":"p-4 sm:p-6 lg:p-8";return u.jsxs("div",{className:"bg-gray-100 font-sans min-h-screen",children:[u.jsx(F9,{userData:e,navItems:O,activeSection:l,onNavigate:j,onLogout:r,isMobileOpen:f,setMobileOpen:m}),u.jsxs("div",{className:"lg:pl-64 flex flex-col min-h-screen",children:[u.jsxs("header",{className:"sticky top-0 z-30 flex items-center justify-between bg-white/80 backdrop-blur-lg shadow-sm p-3 lg:hidden",children:[u.jsx("button",{onClick:()=>m(!0),className:"text-gray-600 hover:text-gray-900 p-1",children:u.jsx(v9,{size:28})}),u.jsx("h1",{className:"text-lg font-semibold text-blue-700",children:"AGWA Portal"}),u.jsx("div",{className:"w-8"})]}),P&&u.jsx("div",{className:"bg-yellow-400 text-center p-2 text-yellow-900 font-semibold shadow-md text-sm sticky top-[57px] z-20 lg:top-0",children:P.text}),u.jsx("main",{className:`${D} flex-grow ${P?"pt-2":""}`,children:C()})]}),e&&R.isChatbotEnabled&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>g(!0),className:"fixed bottom-6 right-6 bg-blue-600 hover:bg-blue-700 text-white rounded-full p-4 shadow-lg transform hover:scale-110 transition-transform duration-200 ease-in-out z-40 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2","aria-label":"Open Chatbot",children:u.jsx(Aa,{size:28})}),y&&u.jsx(O$,{isOpen:y,onClose:()=>g(!1),userData:e,showNotification:i,setActiveDashboardSection:j})]}),e&&e.role==="customer"&&!e.accountNumber&&u.jsx(M$,{isOpen:_,onLink:k,isLinking:x,error:S,onLogout:r})]})},L$=()=>u.jsxs("div",{className:"min-h-screen bg-gray-900 text-white flex flex-col justify-center items-center p-4 text-center",children:[u.jsx(m9,{size:64,className:"text-yellow-400 mb-4 animate-bounce"}),u.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Under Maintenance"}),u.jsx("p",{className:"text-gray-400",children:"The AGWA portal is currently undergoing maintenance."}),u.jsx("p",{className:"text-gray-400",children:"We expect to be back online shortly."})]}),F$=({error:n,onLogout:e})=>u.jsxs("div",{className:"min-h-screen bg-red-50 flex flex-col justify-center items-center p-4 text-center",children:[u.jsx(Xt,{size:48,className:"text-red-500 mb-4"}),u.jsx("h1",{className:"text-2xl font-bold text-red-700 mb-2",children:"Application Error"}),u.jsx("p",{className:"text-gray-700 mb-4 max-w-md",children:"An error occurred while loading your data:"}),u.jsx("p",{className:"text-sm text-red-600 bg-red-100 p-3 rounded mb-4 max-w-xl text-left font-mono break-words",children:n}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Please try refreshing the page. If the problem persists, contact support."}),e&&u.jsxs("button",{onClick:e,className:"mt-4 flex items-center justify-center px-5 py-2.5 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg shadow",children:[u.jsx(zy,{size:16,className:"mr-2"}),"Logout and Try Again"]})]}),V$=()=>{const[n,e]=ee.useState("initializing"),[t,r]=ee.useState(null),[i,s]=ee.useState(null),[o,l]=ee.useState(null),[d,f]=ee.useState(null),[m,y]=ee.useState(null),[g,_]=ee.useState(!1),[E,x]=ee.useState(""),[w,S]=ee.useState("login"),[N,P]=ee.useState({message:"",type:""}),I=ee.useCallback(($,G="info")=>{P({message:$,type:G}),setTimeout(()=>P({message:"",type:""}),5e3)},[]),R=ee.useCallback(()=>P({message:"",type:""}),[]);ee.useEffect(()=>{const $=Wt(en,ym()),G=tP($,oe=>{f(oe.exists()?oe.data():{maintenanceMode:!1}),y(null)},oe=>{console.error("Critical Error: Failed to fetch system settings:",oe),y(`Failed to load config: ${oe.message}. Maintenance mode assumed off.`),f({maintenanceMode:!1})}),re=Dj(Sh,async oe=>{if(l(null),s(null),r(oe),oe){e("loading_profile");try{const ie=await Hg(en,oe.uid);if(ie.success&&ie.data)s(ie.data),e("app_ready");else if(ie.error&&ie.error.includes("not found")){const X=oe.providerData.some(Z=>Z.providerId==="password");let Y;if(X){const Z=localStorage.getItem("signupDisplayName")||oe.email||"New User",te=localStorage.getItem("signupAccountNumber")||"";localStorage.removeItem("signupDisplayName"),localStorage.removeItem("signupAccountNumber");const{role:se,serviceType:ae}=Wb(te);Y={email:oe.email||"",phoneNumber:oe.phoneNumber||"",displayName:Z,accountNumber:te,role:se,serviceType:ae,accountStatus:"Active",photoURL:oe.photoURL||""}}else Y={email:oe.email||"",phoneNumber:oe.phoneNumber||"",displayName:oe.displayName||oe.email||"New User",accountNumber:"",role:"customer",serviceType:"Residential",accountStatus:"Active",photoURL:oe.photoURL||""};const B=await S8(en,oe.uid,Y);if(B.success){const Z=await Hg(en,oe.uid);if(Z.success&&Z.data)s(Z.data),e("app_ready");else throw new Error(Z.error||"Failed to fetch newly created profile.")}else throw new Error(B.error||"Failed to auto-create user profile.")}else throw new Error(ie.error||"Failed to get user profile data.")}catch(ie){console.error("Profile handling error:",ie),l(`Profile Error: ${ie.message}`),e("error"),s(null)}}else e("auth_required"),S("login")});return()=>{re(),G()}},[]);const U=ee.useCallback($=>{x(""),S($)},[]),j=async($,...G)=>{_(!0),x("");let re={success:!1,error:"An unexpected error occurred."};try{re=await $(Sh,...G),!re.success&&re.error&&x(re.error)}catch(oe){const ie=sc(oe);x(ie),re={success:!1,error:ie}}finally{_(!1)}return re},k=($,G)=>j(YL,$,G),F=()=>j(ZL),O=async()=>{e("initializing"),await j(e8)},C=async($,G,re,oe)=>{localStorage.setItem("signupDisplayName",re),localStorage.setItem("signupAccountNumber",oe),await j(KL,$,G)},D=async $=>{const G=await j(JL,$);return G.success&&I(G.message||"Password reset email sent!","success"),G.success},M=async $=>{const G={url:window.location.origin,handleCodeInApp:!0},re=await j(QL,$,G);return re.success&&I(re.message||`Sign-in link sent to ${$}!`,"success"),re};if(ee.useEffect(()=>{(async()=>{if(!Sh)return;const G=window.location.href;if(I4(Sh,G)){let re=window.localStorage.getItem("emailForSignIn");re||(re=window.prompt("Confirm your email for sign-in:")),re?(e("initializing"),await j(XL,re,G),window.history.replaceState(null,"",window.location.origin)):(I("Email required for link sign-in.","error"),window.history.replaceState(null,"",window.location.origin),e("auth_required"))}})()},[j,I]),n==="initializing"||n==="loading_profile"){const $=n==="initializing"?"Initializing Session...":"Loading Profile...";return u.jsx(xS,{loadingMessage:$})}if(n==="error")return u.jsx(F$,{error:o||m||"Unknown application error.",onLogout:O});if(n==="app_ready"&&t&&i)return d!=null&&d.maintenanceMode&&(i==null?void 0:i.role)!=="admin"?u.jsx(L$,{}):u.jsxs(u.Fragment,{children:[u.jsx(D$,{user:t,userData:i,setUserData:s,handleLogout:O,showNotification:I,auth:Sh,db:en}),u.jsx(gx,{message:N.message,type:N.type,onClose:R})]});if(n==="auth_required"){const $=d||{maintenanceMode:!1},G={login:u.jsx(j9,{handleLoginExternal:k,handleGoogleSignIn:F,navigateTo:U,authActionLoading:g,setAuthError:x,systemSettings:$}),signup:u.jsx(O9,{handleSignupExternal:C,handleGoogleSignIn:F,navigateTo:U,authActionLoading:g,setAuthError:x,showNotification:I,systemSettings:$}),forgotPassword:u.jsx(M9,{handleForgotPasswordExternal:D,navigateTo:U,authActionLoading:g}),passwordlessLogin:u.jsx(D9,{handlePasswordlessSignInExternal:M,navigateTo:U,authActionLoading:g})};return u.jsxs(u.Fragment,{children:[u.jsx(IP,{authError:E||m,systemSettings:$,children:G[w]||G.login}),u.jsx(gx,{message:N.message,type:N.type,onClose:R})]})}return u.jsx(xS,{loadingMessage:"Unexpected Application State"})};class z$ extends ts.Component{constructor(t){super(t);Je(this,"handleRetry",()=>{this.setState({hasError:!1,error:null,errorInfo:null,errorId:Date.now()}),this.props.onRetry?this.props.onRetry():window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null,errorId:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,r){console.error("Uncaught error:",t,r),this.setState({errorInfo:r,errorId:Date.now()})}render(){var t,r;if(this.state.hasError){const{fallback:i}=this.props;return i&&typeof i=="function"?i({error:this.state.error,errorInfo:this.state.errorInfo,retry:this.handleRetry}):ts.isValidElement(i)?i:u.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen text-center p-6 bg-red-50",role:"alert",children:[u.jsx(bP,{size:48,className:"text-red-500 mb-4"}),u.jsx("h1",{className:"text-2xl font-bold text-red-700 mb-2",children:"Oops! Something went wrong."}),u.jsx("p",{className:"text-gray-700 mb-4 max-w-md",children:"We encountered an unexpected issue. Please try again. If the problem persists, contact support."}),u.jsxs("details",{className:"mb-4 p-3 bg-red-100 text-left text-xs text-red-800 rounded-md w-full max-w-2xl overflow-auto",children:[u.jsx("summary",{className:"font-semibold cursor-pointer",children:"Error Details"}),u.jsxs("pre",{className:"mt-2 whitespace-pre-wrap",children:[(t=this.state.error)==null?void 0:t.toString(),((r=this.state.errorInfo)==null?void 0:r.componentStack)&&`

Component Stack:
${this.state.errorInfo.componentStack}`]})]}),u.jsxs("button",{onClick:this.handleRetry,className:"flex items-center justify-center px-5 py-2.5 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg shadow hover:shadow-md transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50",children:[u.jsx(w9,{size:16,className:"mr-2"}),"Try Again"]}),this.props.showSupportInfo&&u.jsxs("p",{className:"text-xs text-gray-500 mt-6",children:["Error ID: ",this.state.errorId||"N/A",". Please include this ID if you contact support."]})]})}return this.props.children}}YR.createRoot(document.getElementById("root")).render(u.jsx(ts.StrictMode,{children:u.jsx(z$,{children:u.jsx(V$,{})})}));
