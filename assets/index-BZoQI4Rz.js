var _5=Object.defineProperty;var x5=(r,e,t)=>e in r?_5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Xe=(r,e,t)=>x5(r,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var Ip=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Yx(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Av={exports:{}},Ch={},Iv={exports:{}},Ft={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var IE;function b5(){if(IE)return Ft;IE=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),y=Symbol.iterator;function g(q){return q===null||typeof q!="object"?null:(q=y&&q[y]||q["@@iterator"],typeof q=="function"?q:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,x={};function w(q,Z,ne){this.props=q,this.context=Z,this.refs=x,this.updater=ne||_}w.prototype.isReactComponent={},w.prototype.setState=function(q,Z){if(typeof q!="object"&&typeof q!="function"&&q!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,q,Z,"setState")},w.prototype.forceUpdate=function(q){this.updater.enqueueForceUpdate(this,q,"forceUpdate")};function S(){}S.prototype=w.prototype;function I(q,Z,ne){this.props=q,this.context=Z,this.refs=x,this.updater=ne||_}var C=I.prototype=new S;C.constructor=I,E(C,w.prototype),C.isPureReactComponent=!0;var N=Array.isArray,R=Object.prototype.hasOwnProperty,B={current:null},P={key:!0,ref:!0,__self:!0,__source:!0};function k(q,Z,ne){var se,le={},Q=null,ce=null;if(Z!=null)for(se in Z.ref!==void 0&&(ce=Z.ref),Z.key!==void 0&&(Q=""+Z.key),Z)R.call(Z,se)&&!P.hasOwnProperty(se)&&(le[se]=Z[se]);var me=arguments.length-2;if(me===1)le.children=ne;else if(1<me){for(var ge=Array(me),Ae=0;Ae<me;Ae++)ge[Ae]=arguments[Ae+2];le.children=ge}if(q&&q.defaultProps)for(se in me=q.defaultProps,me)le[se]===void 0&&(le[se]=me[se]);return{$$typeof:r,type:q,key:Q,ref:ce,props:le,_owner:B.current}}function F(q,Z){return{$$typeof:r,type:q.type,key:Z,ref:q.ref,props:q.props,_owner:q._owner}}function j(q){return typeof q=="object"&&q!==null&&q.$$typeof===r}function O(q){var Z={"=":"=0",":":"=2"};return"$"+q.replace(/[=:]/g,function(ne){return Z[ne]})}var D=/\/+/g;function M(q,Z){return typeof q=="object"&&q!==null&&q.key!=null?O(""+q.key):Z.toString(36)}function $(q,Z,ne,se,le){var Q=typeof q;(Q==="undefined"||Q==="boolean")&&(q=null);var ce=!1;if(q===null)ce=!0;else switch(Q){case"string":case"number":ce=!0;break;case"object":switch(q.$$typeof){case r:case e:ce=!0}}if(ce)return ce=q,le=le(ce),q=se===""?"."+M(ce,0):se,N(le)?(ne="",q!=null&&(ne=q.replace(D,"$&/")+"/"),$(le,Z,ne,"",function(Ae){return Ae})):le!=null&&(j(le)&&(le=F(le,ne+(!le.key||ce&&ce.key===le.key?"":(""+le.key).replace(D,"$&/")+"/")+q)),Z.push(le)),1;if(ce=0,se=se===""?".":se+":",N(q))for(var me=0;me<q.length;me++){Q=q[me];var ge=se+M(Q,me);ce+=$(Q,Z,ne,ge,le)}else if(ge=g(q),typeof ge=="function")for(q=ge.call(q),me=0;!(Q=q.next()).done;)Q=Q.value,ge=se+M(Q,me++),ce+=$(Q,Z,ne,ge,le);else if(Q==="object")throw Z=String(q),Error("Objects are not valid as a React child (found: "+(Z==="[object Object]"?"object with keys {"+Object.keys(q).join(", ")+"}":Z)+"). If you meant to render a collection of children, use an array instead.");return ce}function G(q,Z,ne){if(q==null)return q;var se=[],le=0;return $(q,se,"","",function(Q){return Z.call(ne,Q,le++)}),se}function ie(q){if(q._status===-1){var Z=q._result;Z=Z(),Z.then(function(ne){(q._status===0||q._status===-1)&&(q._status=1,q._result=ne)},function(ne){(q._status===0||q._status===-1)&&(q._status=2,q._result=ne)}),q._status===-1&&(q._status=0,q._result=Z)}if(q._status===1)return q._result.default;throw q._result}var oe={current:null},ee={transition:null},J={ReactCurrentDispatcher:oe,ReactCurrentBatchConfig:ee,ReactCurrentOwner:B};function Y(){throw Error("act(...) is not supported in production builds of React.")}return Ft.Children={map:G,forEach:function(q,Z,ne){G(q,function(){Z.apply(this,arguments)},ne)},count:function(q){var Z=0;return G(q,function(){Z++}),Z},toArray:function(q){return G(q,function(Z){return Z})||[]},only:function(q){if(!j(q))throw Error("React.Children.only expected to receive a single React element child.");return q}},Ft.Component=w,Ft.Fragment=t,Ft.Profiler=i,Ft.PureComponent=I,Ft.StrictMode=n,Ft.Suspense=u,Ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=J,Ft.act=Y,Ft.cloneElement=function(q,Z,ne){if(q==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+q+".");var se=E({},q.props),le=q.key,Q=q.ref,ce=q._owner;if(Z!=null){if(Z.ref!==void 0&&(Q=Z.ref,ce=B.current),Z.key!==void 0&&(le=""+Z.key),q.type&&q.type.defaultProps)var me=q.type.defaultProps;for(ge in Z)R.call(Z,ge)&&!P.hasOwnProperty(ge)&&(se[ge]=Z[ge]===void 0&&me!==void 0?me[ge]:Z[ge])}var ge=arguments.length-2;if(ge===1)se.children=ne;else if(1<ge){me=Array(ge);for(var Ae=0;Ae<ge;Ae++)me[Ae]=arguments[Ae+2];se.children=me}return{$$typeof:r,type:q.type,key:le,ref:Q,props:se,_owner:ce}},Ft.createContext=function(q){return q={$$typeof:o,_currentValue:q,_currentValue2:q,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},q.Provider={$$typeof:s,_context:q},q.Consumer=q},Ft.createElement=k,Ft.createFactory=function(q){var Z=k.bind(null,q);return Z.type=q,Z},Ft.createRef=function(){return{current:null}},Ft.forwardRef=function(q){return{$$typeof:l,render:q}},Ft.isValidElement=j,Ft.lazy=function(q){return{$$typeof:m,_payload:{_status:-1,_result:q},_init:ie}},Ft.memo=function(q,Z){return{$$typeof:f,type:q,compare:Z===void 0?null:Z}},Ft.startTransition=function(q){var Z=ee.transition;ee.transition={};try{q()}finally{ee.transition=Z}},Ft.unstable_act=Y,Ft.useCallback=function(q,Z){return oe.current.useCallback(q,Z)},Ft.useContext=function(q){return oe.current.useContext(q)},Ft.useDebugValue=function(){},Ft.useDeferredValue=function(q){return oe.current.useDeferredValue(q)},Ft.useEffect=function(q,Z){return oe.current.useEffect(q,Z)},Ft.useId=function(){return oe.current.useId()},Ft.useImperativeHandle=function(q,Z,ne){return oe.current.useImperativeHandle(q,Z,ne)},Ft.useInsertionEffect=function(q,Z){return oe.current.useInsertionEffect(q,Z)},Ft.useLayoutEffect=function(q,Z){return oe.current.useLayoutEffect(q,Z)},Ft.useMemo=function(q,Z){return oe.current.useMemo(q,Z)},Ft.useReducer=function(q,Z,ne){return oe.current.useReducer(q,Z,ne)},Ft.useRef=function(q){return oe.current.useRef(q)},Ft.useState=function(q){return oe.current.useState(q)},Ft.useSyncExternalStore=function(q,Z,ne){return oe.current.useSyncExternalStore(q,Z,ne)},Ft.useTransition=function(){return oe.current.useTransition()},Ft.version="18.3.1",Ft}var NE;function xy(){return NE||(NE=1,Iv.exports=b5()),Iv.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kE;function w5(){if(kE)return Ch;kE=1;var r=xy(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,u,f){var m,y={},g=null,_=null;f!==void 0&&(g=""+f),u.key!==void 0&&(g=""+u.key),u.ref!==void 0&&(_=u.ref);for(m in u)n.call(u,m)&&!s.hasOwnProperty(m)&&(y[m]=u[m]);if(l&&l.defaultProps)for(m in u=l.defaultProps,u)y[m]===void 0&&(y[m]=u[m]);return{$$typeof:e,type:l,key:g,ref:_,props:y,_owner:i.current}}return Ch.Fragment=t,Ch.jsx=o,Ch.jsxs=o,Ch}var PE;function E5(){return PE||(PE=1,Av.exports=w5()),Av.exports}var d=E5(),te=xy();const is=Yx(te);var Np={},Nv={exports:{}},Oi={},kv={exports:{}},Pv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var CE;function T5(){return CE||(CE=1,function(r){function e(ee,J){var Y=ee.length;ee.push(J);e:for(;0<Y;){var q=Y-1>>>1,Z=ee[q];if(0<i(Z,J))ee[q]=J,ee[Y]=Z,Y=q;else break e}}function t(ee){return ee.length===0?null:ee[0]}function n(ee){if(ee.length===0)return null;var J=ee[0],Y=ee.pop();if(Y!==J){ee[0]=Y;e:for(var q=0,Z=ee.length,ne=Z>>>1;q<ne;){var se=2*(q+1)-1,le=ee[se],Q=se+1,ce=ee[Q];if(0>i(le,Y))Q<Z&&0>i(ce,le)?(ee[q]=ce,ee[Q]=Y,q=Q):(ee[q]=le,ee[se]=Y,q=se);else if(Q<Z&&0>i(ce,Y))ee[q]=ce,ee[Q]=Y,q=Q;else break e}}return J}function i(ee,J){var Y=ee.sortIndex-J.sortIndex;return Y!==0?Y:ee.id-J.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();r.unstable_now=function(){return o.now()-l}}var u=[],f=[],m=1,y=null,g=3,_=!1,E=!1,x=!1,w=typeof setTimeout=="function"?setTimeout:null,S=typeof clearTimeout=="function"?clearTimeout:null,I=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(ee){for(var J=t(f);J!==null;){if(J.callback===null)n(f);else if(J.startTime<=ee)n(f),J.sortIndex=J.expirationTime,e(u,J);else break;J=t(f)}}function N(ee){if(x=!1,C(ee),!E)if(t(u)!==null)E=!0,ie(R);else{var J=t(f);J!==null&&oe(N,J.startTime-ee)}}function R(ee,J){E=!1,x&&(x=!1,S(k),k=-1),_=!0;var Y=g;try{for(C(J),y=t(u);y!==null&&(!(y.expirationTime>J)||ee&&!O());){var q=y.callback;if(typeof q=="function"){y.callback=null,g=y.priorityLevel;var Z=q(y.expirationTime<=J);J=r.unstable_now(),typeof Z=="function"?y.callback=Z:y===t(u)&&n(u),C(J)}else n(u);y=t(u)}if(y!==null)var ne=!0;else{var se=t(f);se!==null&&oe(N,se.startTime-J),ne=!1}return ne}finally{y=null,g=Y,_=!1}}var B=!1,P=null,k=-1,F=5,j=-1;function O(){return!(r.unstable_now()-j<F)}function D(){if(P!==null){var ee=r.unstable_now();j=ee;var J=!0;try{J=P(!0,ee)}finally{J?M():(B=!1,P=null)}}else B=!1}var M;if(typeof I=="function")M=function(){I(D)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,G=$.port2;$.port1.onmessage=D,M=function(){G.postMessage(null)}}else M=function(){w(D,0)};function ie(ee){P=ee,B||(B=!0,M())}function oe(ee,J){k=w(function(){ee(r.unstable_now())},J)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(ee){ee.callback=null},r.unstable_continueExecution=function(){E||_||(E=!0,ie(R))},r.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<ee?Math.floor(1e3/ee):5},r.unstable_getCurrentPriorityLevel=function(){return g},r.unstable_getFirstCallbackNode=function(){return t(u)},r.unstable_next=function(ee){switch(g){case 1:case 2:case 3:var J=3;break;default:J=g}var Y=g;g=J;try{return ee()}finally{g=Y}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(ee,J){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var Y=g;g=ee;try{return J()}finally{g=Y}},r.unstable_scheduleCallback=function(ee,J,Y){var q=r.unstable_now();switch(typeof Y=="object"&&Y!==null?(Y=Y.delay,Y=typeof Y=="number"&&0<Y?q+Y:q):Y=q,ee){case 1:var Z=-1;break;case 2:Z=250;break;case 5:Z=1073741823;break;case 4:Z=1e4;break;default:Z=5e3}return Z=Y+Z,ee={id:m++,callback:J,priorityLevel:ee,startTime:Y,expirationTime:Z,sortIndex:-1},Y>q?(ee.sortIndex=Y,e(f,ee),t(u)===null&&ee===t(f)&&(x?(S(k),k=-1):x=!0,oe(N,Y-q))):(ee.sortIndex=Z,e(u,ee),E||_||(E=!0,ie(R))),ee},r.unstable_shouldYield=O,r.unstable_wrapCallback=function(ee){var J=g;return function(){var Y=g;g=J;try{return ee.apply(this,arguments)}finally{g=Y}}}}(Pv)),Pv}var RE;function S5(){return RE||(RE=1,kv.exports=T5()),kv.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OE;function A5(){if(OE)return Oi;OE=1;var r=xy(),e=S5();function t(a){for(var h="https://reactjs.org/docs/error-decoder.html?invariant="+a,v=1;v<arguments.length;v++)h+="&args[]="+encodeURIComponent(arguments[v]);return"Minified React error #"+a+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function s(a,h){o(a,h),o(a+"Capture",h)}function o(a,h){for(i[a]=h,a=0;a<h.length;a++)n.add(h[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),u=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},y={};function g(a){return u.call(y,a)?!0:u.call(m,a)?!1:f.test(a)?y[a]=!0:(m[a]=!0,!1)}function _(a,h,v,A){if(v!==null&&v.type===0)return!1;switch(typeof h){case"function":case"symbol":return!0;case"boolean":return A?!1:v!==null?!v.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function E(a,h,v,A){if(h===null||typeof h>"u"||_(a,h,v,A))return!0;if(A)return!1;if(v!==null)switch(v.type){case 3:return!h;case 4:return h===!1;case 5:return isNaN(h);case 6:return isNaN(h)||1>h}return!1}function x(a,h,v,A,z,H,X){this.acceptsBooleans=h===2||h===3||h===4,this.attributeName=A,this.attributeNamespace=z,this.mustUseProperty=v,this.propertyName=a,this.type=h,this.sanitizeURL=H,this.removeEmptyString=X}var w={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){w[a]=new x(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var h=a[0];w[h]=new x(h,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){w[a]=new x(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){w[a]=new x(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){w[a]=new x(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){w[a]=new x(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){w[a]=new x(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){w[a]=new x(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){w[a]=new x(a,5,!1,a.toLowerCase(),null,!1,!1)});var S=/[\-:]([a-z])/g;function I(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var h=a.replace(S,I);w[h]=new x(h,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var h=a.replace(S,I);w[h]=new x(h,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var h=a.replace(S,I);w[h]=new x(h,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){w[a]=new x(a,1,!1,a.toLowerCase(),null,!1,!1)}),w.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){w[a]=new x(a,1,!1,a.toLowerCase(),null,!0,!0)});function C(a,h,v,A){var z=w.hasOwnProperty(h)?w[h]:null;(z!==null?z.type!==0:A||!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(E(h,v,z,A)&&(v=null),A||z===null?g(h)&&(v===null?a.removeAttribute(h):a.setAttribute(h,""+v)):z.mustUseProperty?a[z.propertyName]=v===null?z.type===3?!1:"":v:(h=z.attributeName,A=z.attributeNamespace,v===null?a.removeAttribute(h):(z=z.type,v=z===3||z===4&&v===!0?"":""+v,A?a.setAttributeNS(A,h,v):a.setAttribute(h,v))))}var N=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,R=Symbol.for("react.element"),B=Symbol.for("react.portal"),P=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),F=Symbol.for("react.profiler"),j=Symbol.for("react.provider"),O=Symbol.for("react.context"),D=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),$=Symbol.for("react.suspense_list"),G=Symbol.for("react.memo"),ie=Symbol.for("react.lazy"),oe=Symbol.for("react.offscreen"),ee=Symbol.iterator;function J(a){return a===null||typeof a!="object"?null:(a=ee&&a[ee]||a["@@iterator"],typeof a=="function"?a:null)}var Y=Object.assign,q;function Z(a){if(q===void 0)try{throw Error()}catch(v){var h=v.stack.trim().match(/\n( *(at )?)/);q=h&&h[1]||""}return`
`+q+a}var ne=!1;function se(a,h){if(!a||ne)return"";ne=!0;var v=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(h)if(h=function(){throw Error()},Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(Ee){var A=Ee}Reflect.construct(a,[],h)}else{try{h.call()}catch(Ee){A=Ee}a.call(h.prototype)}else{try{throw Error()}catch(Ee){A=Ee}a()}}catch(Ee){if(Ee&&A&&typeof Ee.stack=="string"){for(var z=Ee.stack.split(`
`),H=A.stack.split(`
`),X=z.length-1,ue=H.length-1;1<=X&&0<=ue&&z[X]!==H[ue];)ue--;for(;1<=X&&0<=ue;X--,ue--)if(z[X]!==H[ue]){if(X!==1||ue!==1)do if(X--,ue--,0>ue||z[X]!==H[ue]){var he=`
`+z[X].replace(" at new "," at ");return a.displayName&&he.includes("<anonymous>")&&(he=he.replace("<anonymous>",a.displayName)),he}while(1<=X&&0<=ue);break}}}finally{ne=!1,Error.prepareStackTrace=v}return(a=a?a.displayName||a.name:"")?Z(a):""}function le(a){switch(a.tag){case 5:return Z(a.type);case 16:return Z("Lazy");case 13:return Z("Suspense");case 19:return Z("SuspenseList");case 0:case 2:case 15:return a=se(a.type,!1),a;case 11:return a=se(a.type.render,!1),a;case 1:return a=se(a.type,!0),a;default:return""}}function Q(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case P:return"Fragment";case B:return"Portal";case F:return"Profiler";case k:return"StrictMode";case M:return"Suspense";case $:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case O:return(a.displayName||"Context")+".Consumer";case j:return(a._context.displayName||"Context")+".Provider";case D:var h=a.render;return a=a.displayName,a||(a=h.displayName||h.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case G:return h=a.displayName||null,h!==null?h:Q(a.type)||"Memo";case ie:h=a._payload,a=a._init;try{return Q(a(h))}catch{}}return null}function ce(a){var h=a.type;switch(a.tag){case 24:return"Cache";case 9:return(h.displayName||"Context")+".Consumer";case 10:return(h._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=h.render,a=a.displayName||a.name||"",h.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return h;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Q(h);case 8:return h===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h}return null}function me(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function ge(a){var h=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function Ae(a){var h=ge(a)?"checked":"value",v=Object.getOwnPropertyDescriptor(a.constructor.prototype,h),A=""+a[h];if(!a.hasOwnProperty(h)&&typeof v<"u"&&typeof v.get=="function"&&typeof v.set=="function"){var z=v.get,H=v.set;return Object.defineProperty(a,h,{configurable:!0,get:function(){return z.call(this)},set:function(X){A=""+X,H.call(this,X)}}),Object.defineProperty(a,h,{enumerable:v.enumerable}),{getValue:function(){return A},setValue:function(X){A=""+X},stopTracking:function(){a._valueTracker=null,delete a[h]}}}}function Ue(a){a._valueTracker||(a._valueTracker=Ae(a))}function nt(a){if(!a)return!1;var h=a._valueTracker;if(!h)return!0;var v=h.getValue(),A="";return a&&(A=ge(a)?a.checked?"true":"false":a.value),a=A,a!==v?(h.setValue(a),!0):!1}function et(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function pt(a,h){var v=h.checked;return Y({},h,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:v??a._wrapperState.initialChecked})}function Et(a,h){var v=h.defaultValue==null?"":h.defaultValue,A=h.checked!=null?h.checked:h.defaultChecked;v=me(h.value!=null?h.value:v),a._wrapperState={initialChecked:A,initialValue:v,controlled:h.type==="checkbox"||h.type==="radio"?h.checked!=null:h.value!=null}}function _n(a,h){h=h.checked,h!=null&&C(a,"checked",h,!1)}function Wt(a,h){_n(a,h);var v=me(h.value),A=h.type;if(v!=null)A==="number"?(v===0&&a.value===""||a.value!=v)&&(a.value=""+v):a.value!==""+v&&(a.value=""+v);else if(A==="submit"||A==="reset"){a.removeAttribute("value");return}h.hasOwnProperty("value")?Ie(a,h.type,v):h.hasOwnProperty("defaultValue")&&Ie(a,h.type,me(h.defaultValue)),h.checked==null&&h.defaultChecked!=null&&(a.defaultChecked=!!h.defaultChecked)}function Se(a,h,v){if(h.hasOwnProperty("value")||h.hasOwnProperty("defaultValue")){var A=h.type;if(!(A!=="submit"&&A!=="reset"||h.value!==void 0&&h.value!==null))return;h=""+a._wrapperState.initialValue,v||h===a.value||(a.value=h),a.defaultValue=h}v=a.name,v!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,v!==""&&(a.name=v)}function Ie(a,h,v){(h!=="number"||et(a.ownerDocument)!==a)&&(v==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+v&&(a.defaultValue=""+v))}var De=Array.isArray;function Ve(a,h,v,A){if(a=a.options,h){h={};for(var z=0;z<v.length;z++)h["$"+v[z]]=!0;for(v=0;v<a.length;v++)z=h.hasOwnProperty("$"+a[v].value),a[v].selected!==z&&(a[v].selected=z),z&&A&&(a[v].defaultSelected=!0)}else{for(v=""+me(v),h=null,z=0;z<a.length;z++){if(a[z].value===v){a[z].selected=!0,A&&(a[z].defaultSelected=!0);return}h!==null||a[z].disabled||(h=a[z])}h!==null&&(h.selected=!0)}}function ke(a,h){if(h.dangerouslySetInnerHTML!=null)throw Error(t(91));return Y({},h,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function gt(a,h){var v=h.value;if(v==null){if(v=h.children,h=h.defaultValue,v!=null){if(h!=null)throw Error(t(92));if(De(v)){if(1<v.length)throw Error(t(93));v=v[0]}h=v}h==null&&(h=""),v=h}a._wrapperState={initialValue:me(v)}}function ft(a,h){var v=me(h.value),A=me(h.defaultValue);v!=null&&(v=""+v,v!==a.value&&(a.value=v),h.defaultValue==null&&a.defaultValue!==v&&(a.defaultValue=v)),A!=null&&(a.defaultValue=""+A)}function mt(a){var h=a.textContent;h===a._wrapperState.initialValue&&h!==""&&h!==null&&(a.value=h)}function kt(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function jt(a,h){return a==null||a==="http://www.w3.org/1999/xhtml"?kt(h):a==="http://www.w3.org/2000/svg"&&h==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var Mt,os=function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(h,v,A,z){MSApp.execUnsafeLocalFunction(function(){return a(h,v,A,z)})}:a}(function(a,h){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=h;else{for(Mt=Mt||document.createElement("div"),Mt.innerHTML="<svg>"+h.valueOf().toString()+"</svg>",h=Mt.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;h.firstChild;)a.appendChild(h.firstChild)}});function qt(a,h){if(h){var v=a.firstChild;if(v&&v===a.lastChild&&v.nodeType===3){v.nodeValue=h;return}}a.textContent=h}var jn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},as=["Webkit","ms","Moz","O"];Object.keys(jn).forEach(function(a){as.forEach(function(h){h=h+a.charAt(0).toUpperCase()+a.substring(1),jn[h]=jn[a]})});function Bi(a,h,v){return h==null||typeof h=="boolean"||h===""?"":v||typeof h!="number"||h===0||jn.hasOwnProperty(a)&&jn[a]?(""+h).trim():h+"px"}function pi(a,h){a=a.style;for(var v in h)if(h.hasOwnProperty(v)){var A=v.indexOf("--")===0,z=Bi(v,h[v],A);v==="float"&&(v="cssFloat"),A?a.setProperty(v,z):a[v]=z}}var gr=Y({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function gi(a,h){if(h){if(gr[a]&&(h.children!=null||h.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(h.dangerouslySetInnerHTML!=null){if(h.children!=null)throw Error(t(60));if(typeof h.dangerouslySetInnerHTML!="object"||!("__html"in h.dangerouslySetInnerHTML))throw Error(t(61))}if(h.style!=null&&typeof h.style!="object")throw Error(t(62))}}function ti(a,h){if(a.indexOf("-")===-1)return typeof h.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ui=null;function lo(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var yi=null,Qn=null,ni=null;function vi(a){if(a=ra(a)){if(typeof yi!="function")throw Error(t(280));var h=a.stateNode;h&&(h=Mu(h),yi(a.stateNode,a.type,h))}}function _i(a){Qn?ni?ni.push(a):ni=[a]:Qn=a}function zo(){if(Qn){var a=Qn,h=ni;if(ni=Qn=null,vi(a),h)for(a=0;a<h.length;a++)vi(h[a])}}function gn(a,h){return a(h)}function xi(){}var qi=!1;function ls(a,h,v){if(qi)return a(h,v);qi=!0;try{return gn(a,h,v)}finally{qi=!1,(Qn!==null||ni!==null)&&(xi(),zo())}}function xn(a,h){var v=a.stateNode;if(v===null)return null;var A=Mu(v);if(A===null)return null;v=A[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(A=!A.disabled)||(a=a.type,A=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!A;break e;default:a=!1}if(a)return null;if(v&&typeof v!="function")throw Error(t(231,h,typeof v));return v}var Fs=!1;if(l)try{var Dr={};Object.defineProperty(Dr,"passive",{get:function(){Fs=!0}}),window.addEventListener("test",Dr,Dr),window.removeEventListener("test",Dr,Dr)}catch{Fs=!1}function Vs(a,h,v,A,z,H,X,ue,he){var Ee=Array.prototype.slice.call(arguments,3);try{h.apply(v,Ee)}catch(Oe){this.onError(Oe)}}var an=!1,$e=null,Sr=!1,zs=null,co={onError:function(a){an=!0,$e=a}};function cs(a,h,v,A,z,H,X,ue,he){an=!1,$e=null,Vs.apply(co,arguments)}function yr(a,h,v,A,z,H,X,ue,he){if(cs.apply(this,arguments),an){if(an){var Ee=$e;an=!1,$e=null}else throw Error(t(198));Sr||(Sr=!0,zs=Ee)}}function Ar(a){var h=a,v=a;if(a.alternate)for(;h.return;)h=h.return;else{a=h;do h=a,(h.flags&4098)!==0&&(v=h.return),a=h.return;while(a)}return h.tag===3?v:null}function Ir(a){if(a.tag===13){var h=a.memoizedState;if(h===null&&(a=a.alternate,a!==null&&(h=a.memoizedState)),h!==null)return h.dehydrated}return null}function Nr(a){if(Ar(a)!==a)throw Error(t(188))}function Bo(a){var h=a.alternate;if(!h){if(h=Ar(a),h===null)throw Error(t(188));return h!==a?null:a}for(var v=a,A=h;;){var z=v.return;if(z===null)break;var H=z.alternate;if(H===null){if(A=z.return,A!==null){v=A;continue}break}if(z.child===H.child){for(H=z.child;H;){if(H===v)return Nr(z),a;if(H===A)return Nr(z),h;H=H.sibling}throw Error(t(188))}if(v.return!==A.return)v=z,A=H;else{for(var X=!1,ue=z.child;ue;){if(ue===v){X=!0,v=z,A=H;break}if(ue===A){X=!0,A=z,v=H;break}ue=ue.sibling}if(!X){for(ue=H.child;ue;){if(ue===v){X=!0,v=H,A=z;break}if(ue===A){X=!0,A=H,v=z;break}ue=ue.sibling}if(!X)throw Error(t(189))}}if(v.alternate!==A)throw Error(t(190))}if(v.tag!==3)throw Error(t(188));return v.stateNode.current===v?a:h}function Uo(a){return a=Bo(a),a!==null?Ze(a):null}function Ze(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var h=Ze(a);if(h!==null)return h;a=a.sibling}return null}var fe=e.unstable_scheduleCallback,je=e.unstable_cancelCallback,Ge=e.unstable_shouldYield,Gt=e.unstable_requestPaint,It=e.unstable_now,bn=e.unstable_getCurrentPriorityLevel,Cn=e.unstable_ImmediatePriority,Xn=e.unstable_UserBlockingPriority,$n=e.unstable_NormalPriority,Hi=e.unstable_LowPriority,yn=e.unstable_IdlePriority,$i=null,or=null;function uo(a){if(or&&typeof or.onCommitFiberRoot=="function")try{or.onCommitFiberRoot($i,a,void 0,(a.current.flags&128)===128)}catch{}}var _t=Math.clz32?Math.clz32:Bs,ln=Math.log,qo=Math.LN2;function Bs(a){return a>>>=0,a===0?32:31-(ln(a)/qo|0)|0}var Wi=64,ho=4194304;function yt(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function cn(a,h){var v=a.pendingLanes;if(v===0)return 0;var A=0,z=a.suspendedLanes,H=a.pingedLanes,X=v&268435455;if(X!==0){var ue=X&~z;ue!==0?A=yt(ue):(H&=X,H!==0&&(A=yt(H)))}else X=v&~z,X!==0?A=yt(X):H!==0&&(A=yt(H));if(A===0)return 0;if(h!==0&&h!==A&&(h&z)===0&&(z=A&-A,H=h&-h,z>=H||z===16&&(H&4194240)!==0))return h;if((A&4)!==0&&(A|=v&16),h=a.entangledLanes,h!==0)for(a=a.entanglements,h&=A;0<h;)v=31-_t(h),z=1<<v,A|=a[v],h&=~z;return A}function uc(a,h){switch(a){case 1:case 2:case 4:return h+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function bi(a,h){for(var v=a.suspendedLanes,A=a.pingedLanes,z=a.expirationTimes,H=a.pendingLanes;0<H;){var X=31-_t(H),ue=1<<X,he=z[X];he===-1?((ue&v)===0||(ue&A)!==0)&&(z[X]=uc(ue,h)):he<=h&&(a.expiredLanes|=ue),H&=~ue}}function En(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function Ho(){var a=Wi;return Wi<<=1,(Wi&4194240)===0&&(Wi=64),a}function Gi(a){for(var h=[],v=0;31>v;v++)h.push(a);return h}function Lr(a,h,v){a.pendingLanes|=h,h!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,h=31-_t(h),a[h]=v}function xt(a,h){var v=a.pendingLanes&~h;a.pendingLanes=h,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=h,a.mutableReadLanes&=h,a.entangledLanes&=h,h=a.entanglements;var A=a.eventTimes;for(a=a.expirationTimes;0<v;){var z=31-_t(v),H=1<<z;h[z]=0,A[z]=-1,a[z]=-1,v&=~H}}function Fr(a,h){var v=a.entangledLanes|=h;for(a=a.entanglements;v;){var A=31-_t(v),z=1<<A;z&h|a[A]&h&&(a[A]|=h),v&=~z}}var Ct=0;function wi(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var Va,us,za,Ba,$o,Wo=!1,Ei=[],Vn=null,Ti=null,ri=null,fo=new Map,at=new Map,Wn=[],tn="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function dc(a,h){switch(a){case"focusin":case"focusout":Vn=null;break;case"dragenter":case"dragleave":Ti=null;break;case"mouseover":case"mouseout":ri=null;break;case"pointerover":case"pointerout":fo.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":at.delete(h.pointerId)}}function vr(a,h,v,A,z,H){return a===null||a.nativeEvent!==H?(a={blockedOn:h,domEventName:v,eventSystemFlags:A,nativeEvent:H,targetContainers:[z]},h!==null&&(h=ra(h),h!==null&&us(h)),a):(a.eventSystemFlags|=A,h=a.targetContainers,z!==null&&h.indexOf(z)===-1&&h.push(z),a)}function hc(a,h,v,A,z){switch(h){case"focusin":return Vn=vr(Vn,a,h,v,A,z),!0;case"dragenter":return Ti=vr(Ti,a,h,v,A,z),!0;case"mouseover":return ri=vr(ri,a,h,v,A,z),!0;case"pointerover":var H=z.pointerId;return fo.set(H,vr(fo.get(H)||null,a,h,v,A,z)),!0;case"gotpointercapture":return H=z.pointerId,at.set(H,vr(at.get(H)||null,a,h,v,A,z)),!0}return!1}function Ua(a){var h=na(a.target);if(h!==null){var v=Ar(h);if(v!==null){if(h=v.tag,h===13){if(h=Ir(v),h!==null){a.blockedOn=h,$o(a.priority,function(){za(v)});return}}else if(h===3&&v.stateNode.current.memoizedState.isDehydrated){a.blockedOn=v.tag===3?v.stateNode.containerInfo:null;return}}}a.blockedOn=null}function kr(a){if(a.blockedOn!==null)return!1;for(var h=a.targetContainers;0<h.length;){var v=Yo(a.domEventName,a.eventSystemFlags,h[0],a.nativeEvent);if(v===null){v=a.nativeEvent;var A=new v.constructor(v.type,v);Ui=A,v.target.dispatchEvent(A),Ui=null}else return h=ra(v),h!==null&&us(h),a.blockedOn=v,!1;h.shift()}return!0}function Us(a,h,v){kr(a)&&v.delete(h)}function mo(){Wo=!1,Vn!==null&&kr(Vn)&&(Vn=null),Ti!==null&&kr(Ti)&&(Ti=null),ri!==null&&kr(ri)&&(ri=null),fo.forEach(Us),at.forEach(Us)}function un(a,h){a.blockedOn===h&&(a.blockedOn=null,Wo||(Wo=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,mo)))}function ar(a){function h(z){return un(z,a)}if(0<Ei.length){un(Ei[0],a);for(var v=1;v<Ei.length;v++){var A=Ei[v];A.blockedOn===a&&(A.blockedOn=null)}}for(Vn!==null&&un(Vn,a),Ti!==null&&un(Ti,a),ri!==null&&un(ri,a),fo.forEach(h),at.forEach(h),v=0;v<Wn.length;v++)A=Wn[v],A.blockedOn===a&&(A.blockedOn=null);for(;0<Wn.length&&(v=Wn[0],v.blockedOn===null);)Ua(v),v.blockedOn===null&&Wn.shift()}var ds=N.ReactCurrentBatchConfig,qs=!0;function Tn(a,h,v,A){var z=Ct,H=ds.transition;ds.transition=null;try{Ct=1,Go(a,h,v,A)}finally{Ct=z,ds.transition=H}}function bu(a,h,v,A){var z=Ct,H=ds.transition;ds.transition=null;try{Ct=4,Go(a,h,v,A)}finally{Ct=z,ds.transition=H}}function Go(a,h,v,A){if(qs){var z=Yo(a,h,v,A);if(z===null)c(a,h,A,Ko,v),dc(a,A);else if(hc(z,a,h,v,A))A.stopPropagation();else if(dc(a,A),h&4&&-1<tn.indexOf(a)){for(;z!==null;){var H=ra(z);if(H!==null&&Va(H),H=Yo(a,h,v,A),H===null&&c(a,h,A,Ko,v),H===z)break;z=H}z!==null&&A.stopPropagation()}else c(a,h,A,null,v)}}var Ko=null;function Yo(a,h,v,A){if(Ko=null,a=lo(A),a=na(a),a!==null)if(h=Ar(a),h===null)a=null;else if(v=h.tag,v===13){if(a=Ir(h),a!==null)return a;a=null}else if(v===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;a=null}else h!==a&&(a=null);return Ko=a,null}function Rt(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(bn()){case Cn:return 1;case Xn:return 4;case $n:case Hi:return 16;case yn:return 536870912;default:return 16}default:return 16}}var ii=null,_r=null,Jn=null;function qa(){if(Jn)return Jn;var a,h=_r,v=h.length,A,z="value"in ii?ii.value:ii.textContent,H=z.length;for(a=0;a<v&&h[a]===z[a];a++);var X=v-a;for(A=1;A<=X&&h[v-A]===z[H-A];A++);return Jn=z.slice(a,1<A?1-A:void 0)}function Ha(a){var h=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&h===13&&(a=13)):a=h,a===10&&(a=13),32<=a||a===13?a:0}function Si(){return!0}function fc(){return!1}function er(a){function h(v,A,z,H,X){this._reactName=v,this._targetInst=z,this.type=A,this.nativeEvent=H,this.target=X,this.currentTarget=null;for(var ue in a)a.hasOwnProperty(ue)&&(v=a[ue],this[ue]=v?v(H):H[ue]);return this.isDefaultPrevented=(H.defaultPrevented!=null?H.defaultPrevented:H.returnValue===!1)?Si:fc,this.isPropagationStopped=fc,this}return Y(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var v=this.nativeEvent;v&&(v.preventDefault?v.preventDefault():typeof v.returnValue!="unknown"&&(v.returnValue=!1),this.isDefaultPrevented=Si)},stopPropagation:function(){var v=this.nativeEvent;v&&(v.stopPropagation?v.stopPropagation():typeof v.cancelBubble!="unknown"&&(v.cancelBubble=!0),this.isPropagationStopped=Si)},persist:function(){},isPersistent:Si}),h}var Ki={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},$a=er(Ki),Ai=Y({},Ki,{view:0,detail:0}),ih=er(Ai),Pr,Hs,$s,Vr=Y({},Ai,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zr,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==$s&&($s&&a.type==="mousemove"?(Pr=a.screenX-$s.screenX,Hs=a.screenY-$s.screenY):Hs=Pr=0,$s=a),Pr)},movementY:function(a){return"movementY"in a?a.movementY:Hs}}),Zo=er(Vr),Wa=Y({},Vr,{dataTransfer:0}),Ga=er(Wa),Ka=Y({},Ai,{relatedTarget:0}),Qo=er(Ka),mc=Y({},Ki,{animationName:0,elapsedTime:0,pseudoElement:0}),Ws=er(mc),wu=Y({},Ki,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),Ya=er(wu),Eu=Y({},Ki,{data:0}),Za=er(Eu),Xo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},tr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},hs={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tu(a){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(a):(a=hs[a])?!!h[a]:!1}function zr(){return Tu}var b=Y({},Ai,{key:function(a){if(a.key){var h=Xo[a.key]||a.key;if(h!=="Unidentified")return h}return a.type==="keypress"?(a=Ha(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?tr[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zr,charCode:function(a){return a.type==="keypress"?Ha(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Ha(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),U=er(b),K=Y({},Vr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ae=er(K),ye=Y({},Ai,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zr}),Te=er(ye),ze=Y({},Ki,{propertyName:0,elapsedTime:0,pseudoElement:0}),en=er(ze),zn=Y({},Vr,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),zt=er(zn),nn=[9,13,27,32],wn=l&&"CompositionEvent"in window,Ii=null;l&&"documentMode"in document&&(Ii=document.documentMode);var Mn=l&&"TextEvent"in window&&!Ii,Jo=l&&(!wn||Ii&&8<Ii&&11>=Ii),Yi=" ",Cm=!1;function Qa(a,h){switch(a){case"keyup":return nn.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sh(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Gs=!1;function y0(a,h){switch(a){case"compositionend":return sh(h);case"keypress":return h.which!==32?null:(Cm=!0,Yi);case"textInput":return a=h.data,a===Yi&&Cm?null:a;default:return null}}function po(a,h){if(Gs)return a==="compositionend"||!wn&&Qa(a,h)?(a=qa(),Jn=_r=ii=null,Gs=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return Jo&&h.locale!=="ko"?null:h.data;default:return null}}var Su={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rm(a){var h=a&&a.nodeName&&a.nodeName.toLowerCase();return h==="input"?!!Su[a.type]:h==="textarea"}function Au(a,h,v,A){_i(A),h=T(h,"onChange"),0<h.length&&(v=new $a("onChange","change",null,v,A),a.push({event:v,listeners:h}))}var pc=null,si=null;function v0(a){mh(a,0)}function Ks(a){var h=ia(a);if(nt(h))return a}function _0(a,h){if(a==="change")return h}var fs=!1;if(l){var Xa;if(l){var Iu="oninput"in document;if(!Iu){var Nu=document.createElement("div");Nu.setAttribute("oninput","return;"),Iu=typeof Nu.oninput=="function"}Xa=Iu}else Xa=!1;fs=Xa&&(!document.documentMode||9<document.documentMode)}function gc(){pc&&(pc.detachEvent("onpropertychange",ku),si=pc=null)}function ku(a){if(a.propertyName==="value"&&Ks(si)){var h=[];Au(h,si,a,lo(a)),ls(v0,h)}}function Pu(a,h,v){a==="focusin"?(gc(),pc=h,si=v,pc.attachEvent("onpropertychange",ku)):a==="focusout"&&gc()}function Ja(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Ks(si)}function Cu(a,h){if(a==="click")return Ks(h)}function oh(a,h){if(a==="input"||a==="change")return Ks(h)}function Om(a,h){return a===h&&(a!==0||1/a===1/h)||a!==a&&h!==h}var Zi=typeof Object.is=="function"?Object.is:Om;function go(a,h){if(Zi(a,h))return!0;if(typeof a!="object"||a===null||typeof h!="object"||h===null)return!1;var v=Object.keys(a),A=Object.keys(h);if(v.length!==A.length)return!1;for(A=0;A<v.length;A++){var z=v[A];if(!u.call(h,z)||!Zi(a[z],h[z]))return!1}return!0}function jm(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function ah(a,h){var v=jm(a);a=0;for(var A;v;){if(v.nodeType===3){if(A=a+v.textContent.length,a<=h&&A>=h)return{node:v,offset:h-a};a=A}e:{for(;v;){if(v.nextSibling){v=v.nextSibling;break e}v=v.parentNode}v=void 0}v=jm(v)}}function Mm(a,h){return a&&h?a===h?!0:a&&a.nodeType===3?!1:h&&h.nodeType===3?Mm(a,h.parentNode):"contains"in a?a.contains(h):a.compareDocumentPosition?!!(a.compareDocumentPosition(h)&16):!1:!1}function lh(){for(var a=window,h=et();h instanceof a.HTMLIFrameElement;){try{var v=typeof h.contentWindow.location.href=="string"}catch{v=!1}if(v)a=h.contentWindow;else break;h=et(a.document)}return h}function ch(a){var h=a&&a.nodeName&&a.nodeName.toLowerCase();return h&&(h==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||h==="textarea"||a.contentEditable==="true")}function ms(a){var h=lh(),v=a.focusedElem,A=a.selectionRange;if(h!==v&&v&&v.ownerDocument&&Mm(v.ownerDocument.documentElement,v)){if(A!==null&&ch(v)){if(h=A.start,a=A.end,a===void 0&&(a=h),"selectionStart"in v)v.selectionStart=h,v.selectionEnd=Math.min(a,v.value.length);else if(a=(h=v.ownerDocument||document)&&h.defaultView||window,a.getSelection){a=a.getSelection();var z=v.textContent.length,H=Math.min(A.start,z);A=A.end===void 0?H:Math.min(A.end,z),!a.extend&&H>A&&(z=A,A=H,H=z),z=ah(v,H);var X=ah(v,A);z&&X&&(a.rangeCount!==1||a.anchorNode!==z.node||a.anchorOffset!==z.offset||a.focusNode!==X.node||a.focusOffset!==X.offset)&&(h=h.createRange(),h.setStart(z.node,z.offset),a.removeAllRanges(),H>A?(a.addRange(h),a.extend(X.node,X.offset)):(h.setEnd(X.node,X.offset),a.addRange(h)))}}for(h=[],a=v;a=a.parentNode;)a.nodeType===1&&h.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof v.focus=="function"&&v.focus(),v=0;v<h.length;v++)a=h[v],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var Ru=l&&"documentMode"in document&&11>=document.documentMode,el=null,tl=null,yc=null,Ou=!1;function Dm(a,h,v){var A=v.window===v?v.document:v.nodeType===9?v:v.ownerDocument;Ou||el==null||el!==et(A)||(A=el,"selectionStart"in A&&ch(A)?A={start:A.selectionStart,end:A.selectionEnd}:(A=(A.ownerDocument&&A.ownerDocument.defaultView||window).getSelection(),A={anchorNode:A.anchorNode,anchorOffset:A.anchorOffset,focusNode:A.focusNode,focusOffset:A.focusOffset}),yc&&go(yc,A)||(yc=A,A=T(tl,"onSelect"),0<A.length&&(h=new $a("onSelect","select",null,h,v),a.push({event:h,listeners:A}),h.target=el)))}function yo(a,h){var v={};return v[a.toLowerCase()]=h.toLowerCase(),v["Webkit"+a]="webkit"+h,v["Moz"+a]="moz"+h,v}var nl={animationend:yo("Animation","AnimationEnd"),animationiteration:yo("Animation","AnimationIteration"),animationstart:yo("Animation","AnimationStart"),transitionend:yo("Transition","TransitionEnd")},vo={},uh={};l&&(uh=document.createElement("div").style,"AnimationEvent"in window||(delete nl.animationend.animation,delete nl.animationiteration.animation,delete nl.animationstart.animation),"TransitionEvent"in window||delete nl.transitionend.transition);function vc(a){if(vo[a])return vo[a];if(!nl[a])return a;var h=nl[a],v;for(v in h)if(h.hasOwnProperty(v)&&v in uh)return vo[a]=h[v];return a}var Lm=vc("animationend"),ps=vc("animationiteration"),dh=vc("animationstart"),hh=vc("transitionend"),rl=new Map,Fm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Qi(a,h){rl.set(a,h),s(h,[a])}for(var ea=0;ea<Fm.length;ea++){var ju=Fm[ea],Vm=ju.toLowerCase(),x0=ju[0].toUpperCase()+ju.slice(1);Qi(Vm,"on"+x0)}Qi(Lm,"onAnimationEnd"),Qi(ps,"onAnimationIteration"),Qi(dh,"onAnimationStart"),Qi("dblclick","onDoubleClick"),Qi("focusin","onFocus"),Qi("focusout","onBlur"),Qi(hh,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var il="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zm=new Set("cancel close invalid load scroll toggle".split(" ").concat(il));function fh(a,h,v){var A=a.type||"unknown-event";a.currentTarget=v,yr(A,h,void 0,a),a.currentTarget=null}function mh(a,h){h=(h&4)!==0;for(var v=0;v<a.length;v++){var A=a[v],z=A.event;A=A.listeners;e:{var H=void 0;if(h)for(var X=A.length-1;0<=X;X--){var ue=A[X],he=ue.instance,Ee=ue.currentTarget;if(ue=ue.listener,he!==H&&z.isPropagationStopped())break e;fh(z,ue,Ee),H=he}else for(X=0;X<A.length;X++){if(ue=A[X],he=ue.instance,Ee=ue.currentTarget,ue=ue.listener,he!==H&&z.isPropagationStopped())break e;fh(z,ue,Ee),H=he}}}if(Sr)throw a=zs,Sr=!1,zs=null,a}function vn(a,h){var v=h[ll];v===void 0&&(v=h[ll]=new Set);var A=a+"__bubble";v.has(A)||(Bm(h,a,2,!1),v.add(A))}function ph(a,h,v){var A=0;h&&(A|=4),Bm(v,a,A,h)}var _c="_reactListening"+Math.random().toString(36).slice(2);function sl(a){if(!a[_c]){a[_c]=!0,n.forEach(function(v){v!=="selectionchange"&&(zm.has(v)||ph(v,!1,a),ph(v,!0,a))});var h=a.nodeType===9?a:a.ownerDocument;h===null||h[_c]||(h[_c]=!0,ph("selectionchange",!1,h))}}function Bm(a,h,v,A){switch(Rt(h)){case 1:var z=Tn;break;case 4:z=bu;break;default:z=Go}v=z.bind(null,h,v,a),z=void 0,!Fs||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(z=!0),A?z!==void 0?a.addEventListener(h,v,{capture:!0,passive:z}):a.addEventListener(h,v,!0):z!==void 0?a.addEventListener(h,v,{passive:z}):a.addEventListener(h,v,!1)}function c(a,h,v,A,z){var H=A;if((h&1)===0&&(h&2)===0&&A!==null)e:for(;;){if(A===null)return;var X=A.tag;if(X===3||X===4){var ue=A.stateNode.containerInfo;if(ue===z||ue.nodeType===8&&ue.parentNode===z)break;if(X===4)for(X=A.return;X!==null;){var he=X.tag;if((he===3||he===4)&&(he=X.stateNode.containerInfo,he===z||he.nodeType===8&&he.parentNode===z))return;X=X.return}for(;ue!==null;){if(X=na(ue),X===null)return;if(he=X.tag,he===5||he===6){A=H=X;continue e}ue=ue.parentNode}}A=A.return}ls(function(){var Ee=H,Oe=lo(v),Me=[];e:{var Ce=rl.get(a);if(Ce!==void 0){var We=$a,Qe=a;switch(a){case"keypress":if(Ha(v)===0)break e;case"keydown":case"keyup":We=U;break;case"focusin":Qe="focus",We=Qo;break;case"focusout":Qe="blur",We=Qo;break;case"beforeblur":case"afterblur":We=Qo;break;case"click":if(v.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":We=Zo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":We=Ga;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":We=Te;break;case Lm:case ps:case dh:We=Ws;break;case hh:We=en;break;case"scroll":We=ih;break;case"wheel":We=zt;break;case"copy":case"cut":case"paste":We=Ya;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":We=ae}var tt=(h&4)!==0,Gn=!tt&&a==="scroll",xe=tt?Ce!==null?Ce+"Capture":null:Ce;tt=[];for(var pe=Ee,be;pe!==null;){be=pe;var Fe=be.stateNode;if(be.tag===5&&Fe!==null&&(be=Fe,xe!==null&&(Fe=xn(pe,xe),Fe!=null&&tt.push(p(pe,Fe,be)))),Gn)break;pe=pe.return}0<tt.length&&(Ce=new We(Ce,Qe,null,v,Oe),Me.push({event:Ce,listeners:tt}))}}if((h&7)===0){e:{if(Ce=a==="mouseover"||a==="pointerover",We=a==="mouseout"||a==="pointerout",Ce&&v!==Ui&&(Qe=v.relatedTarget||v.fromElement)&&(na(Qe)||Qe[rn]))break e;if((We||Ce)&&(Ce=Oe.window===Oe?Oe:(Ce=Oe.ownerDocument)?Ce.defaultView||Ce.parentWindow:window,We?(Qe=v.relatedTarget||v.toElement,We=Ee,Qe=Qe?na(Qe):null,Qe!==null&&(Gn=Ar(Qe),Qe!==Gn||Qe.tag!==5&&Qe.tag!==6)&&(Qe=null)):(We=null,Qe=Ee),We!==Qe)){if(tt=Zo,Fe="onMouseLeave",xe="onMouseEnter",pe="mouse",(a==="pointerout"||a==="pointerover")&&(tt=ae,Fe="onPointerLeave",xe="onPointerEnter",pe="pointer"),Gn=We==null?Ce:ia(We),be=Qe==null?Ce:ia(Qe),Ce=new tt(Fe,pe+"leave",We,v,Oe),Ce.target=Gn,Ce.relatedTarget=be,Fe=null,na(Oe)===Ee&&(tt=new tt(xe,pe+"enter",Qe,v,Oe),tt.target=be,tt.relatedTarget=Gn,Fe=tt),Gn=Fe,We&&Qe)t:{for(tt=We,xe=Qe,pe=0,be=tt;be;be=V(be))pe++;for(be=0,Fe=xe;Fe;Fe=V(Fe))be++;for(;0<pe-be;)tt=V(tt),pe--;for(;0<be-pe;)xe=V(xe),be--;for(;pe--;){if(tt===xe||xe!==null&&tt===xe.alternate)break t;tt=V(tt),xe=V(xe)}tt=null}else tt=null;We!==null&&W(Me,Ce,We,tt,!1),Qe!==null&&Gn!==null&&W(Me,Gn,Qe,tt,!0)}}e:{if(Ce=Ee?ia(Ee):window,We=Ce.nodeName&&Ce.nodeName.toLowerCase(),We==="select"||We==="input"&&Ce.type==="file")var rt=_0;else if(Rm(Ce))if(fs)rt=oh;else{rt=Ja;var dt=Pu}else(We=Ce.nodeName)&&We.toLowerCase()==="input"&&(Ce.type==="checkbox"||Ce.type==="radio")&&(rt=Cu);if(rt&&(rt=rt(a,Ee))){Au(Me,rt,v,Oe);break e}dt&&dt(a,Ce,Ee),a==="focusout"&&(dt=Ce._wrapperState)&&dt.controlled&&Ce.type==="number"&&Ie(Ce,"number",Ce.value)}switch(dt=Ee?ia(Ee):window,a){case"focusin":(Rm(dt)||dt.contentEditable==="true")&&(el=dt,tl=Ee,yc=null);break;case"focusout":yc=tl=el=null;break;case"mousedown":Ou=!0;break;case"contextmenu":case"mouseup":case"dragend":Ou=!1,Dm(Me,v,Oe);break;case"selectionchange":if(Ru)break;case"keydown":case"keyup":Dm(Me,v,Oe)}var ht;if(wn)e:{switch(a){case"compositionstart":var Tt="onCompositionStart";break e;case"compositionend":Tt="onCompositionEnd";break e;case"compositionupdate":Tt="onCompositionUpdate";break e}Tt=void 0}else Gs?Qa(a,v)&&(Tt="onCompositionEnd"):a==="keydown"&&v.keyCode===229&&(Tt="onCompositionStart");Tt&&(Jo&&v.locale!=="ko"&&(Gs||Tt!=="onCompositionStart"?Tt==="onCompositionEnd"&&Gs&&(ht=qa()):(ii=Oe,_r="value"in ii?ii.value:ii.textContent,Gs=!0)),dt=T(Ee,Tt),0<dt.length&&(Tt=new Za(Tt,a,null,v,Oe),Me.push({event:Tt,listeners:dt}),ht?Tt.data=ht:(ht=sh(v),ht!==null&&(Tt.data=ht)))),(ht=Mn?y0(a,v):po(a,v))&&(Ee=T(Ee,"onBeforeInput"),0<Ee.length&&(Oe=new Za("onBeforeInput","beforeinput",null,v,Oe),Me.push({event:Oe,listeners:Ee}),Oe.data=ht))}mh(Me,h)})}function p(a,h,v){return{instance:a,listener:h,currentTarget:v}}function T(a,h){for(var v=h+"Capture",A=[];a!==null;){var z=a,H=z.stateNode;z.tag===5&&H!==null&&(z=H,H=xn(a,v),H!=null&&A.unshift(p(a,H,z)),H=xn(a,h),H!=null&&A.push(p(a,H,z))),a=a.return}return A}function V(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function W(a,h,v,A,z){for(var H=h._reactName,X=[];v!==null&&v!==A;){var ue=v,he=ue.alternate,Ee=ue.stateNode;if(he!==null&&he===A)break;ue.tag===5&&Ee!==null&&(ue=Ee,z?(he=xn(v,H),he!=null&&X.unshift(p(v,he,ue))):z||(he=xn(v,H),he!=null&&X.push(p(v,he,ue)))),v=v.return}X.length!==0&&a.push({event:h,listeners:X})}var re=/\r\n?/g,de=/\u0000|\uFFFD/g;function _e(a){return(typeof a=="string"?a:""+a).replace(re,`
`).replace(de,"")}function we(a,h,v){if(h=_e(h),_e(a)!==h&&v)throw Error(t(425))}function Pe(){}var He=null,ut=null;function Pt(a,h){return a==="textarea"||a==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var lr=typeof setTimeout=="function"?setTimeout:void 0,nr=typeof clearTimeout=="function"?clearTimeout:void 0,oi=typeof Promise=="function"?Promise:void 0,Br=typeof queueMicrotask=="function"?queueMicrotask:typeof oi<"u"?function(a){return oi.resolve(null).then(a).catch(ol)}:lr;function ol(a){setTimeout(function(){throw a})}function gh(a,h){var v=h,A=0;do{var z=v.nextSibling;if(a.removeChild(v),z&&z.nodeType===8)if(v=z.data,v==="/$"){if(A===0){a.removeChild(z),ar(h);return}A--}else v!=="$"&&v!=="$?"&&v!=="$!"||A++;v=z}while(v);ar(h)}function _o(a){for(;a!=null;a=a.nextSibling){var h=a.nodeType;if(h===1||h===3)break;if(h===8){if(h=a.data,h==="$"||h==="$!"||h==="$?")break;if(h==="/$")return null}}return a}function Um(a){a=a.previousSibling;for(var h=0;a;){if(a.nodeType===8){var v=a.data;if(v==="$"||v==="$!"||v==="$?"){if(h===0)return a;h--}else v==="/$"&&h++}a=a.previousSibling}return null}var ta=Math.random().toString(36).slice(2),gs="__reactFiber$"+ta,al="__reactProps$"+ta,rn="__reactContainer$"+ta,ll="__reactEvents$"+ta,b0="__reactListeners$"+ta,w0="__reactHandles$"+ta;function na(a){var h=a[gs];if(h)return h;for(var v=a.parentNode;v;){if(h=v[rn]||v[gs]){if(v=h.alternate,h.child!==null||v!==null&&v.child!==null)for(a=Um(a);a!==null;){if(v=a[gs])return v;a=Um(a)}return h}a=v,v=a.parentNode}return null}function ra(a){return a=a[gs]||a[rn],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function ia(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function Mu(a){return a[al]||null}var E0=[],Du=-1;function cl(a){return{current:a}}function In(a){0>Du||(a.current=E0[Du],E0[Du]=null,Du--)}function Sn(a,h){Du++,E0[Du]=a.current,a.current=h}var ul={},Ur=cl(ul),Ni=cl(!1),xc=ul;function Lu(a,h){var v=a.type.contextTypes;if(!v)return ul;var A=a.stateNode;if(A&&A.__reactInternalMemoizedUnmaskedChildContext===h)return A.__reactInternalMemoizedMaskedChildContext;var z={},H;for(H in v)z[H]=h[H];return A&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=h,a.__reactInternalMemoizedMaskedChildContext=z),z}function ki(a){return a=a.childContextTypes,a!=null}function qm(){In(Ni),In(Ur)}function Y2(a,h,v){if(Ur.current!==ul)throw Error(t(168));Sn(Ur,h),Sn(Ni,v)}function Z2(a,h,v){var A=a.stateNode;if(h=h.childContextTypes,typeof A.getChildContext!="function")return v;A=A.getChildContext();for(var z in A)if(!(z in h))throw Error(t(108,ce(a)||"Unknown",z));return Y({},v,A)}function Hm(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||ul,xc=Ur.current,Sn(Ur,a),Sn(Ni,Ni.current),!0}function Q2(a,h,v){var A=a.stateNode;if(!A)throw Error(t(169));v?(a=Z2(a,h,xc),A.__reactInternalMemoizedMergedChildContext=a,In(Ni),In(Ur),Sn(Ur,a)):In(Ni),Sn(Ni,v)}var sa=null,$m=!1,T0=!1;function X2(a){sa===null?sa=[a]:sa.push(a)}function FR(a){$m=!0,X2(a)}function dl(){if(!T0&&sa!==null){T0=!0;var a=0,h=Ct;try{var v=sa;for(Ct=1;a<v.length;a++){var A=v[a];do A=A(!0);while(A!==null)}sa=null,$m=!1}catch(z){throw sa!==null&&(sa=sa.slice(a+1)),fe(Cn,dl),z}finally{Ct=h,T0=!1}}return null}var Fu=[],Vu=0,Wm=null,Gm=0,ys=[],vs=0,bc=null,oa=1,aa="";function wc(a,h){Fu[Vu++]=Gm,Fu[Vu++]=Wm,Wm=a,Gm=h}function J2(a,h,v){ys[vs++]=oa,ys[vs++]=aa,ys[vs++]=bc,bc=a;var A=oa;a=aa;var z=32-_t(A)-1;A&=~(1<<z),v+=1;var H=32-_t(h)+z;if(30<H){var X=z-z%5;H=(A&(1<<X)-1).toString(32),A>>=X,z-=X,oa=1<<32-_t(h)+z|v<<z|A,aa=H+a}else oa=1<<H|v<<z|A,aa=a}function S0(a){a.return!==null&&(wc(a,1),J2(a,1,0))}function A0(a){for(;a===Wm;)Wm=Fu[--Vu],Fu[Vu]=null,Gm=Fu[--Vu],Fu[Vu]=null;for(;a===bc;)bc=ys[--vs],ys[vs]=null,aa=ys[--vs],ys[vs]=null,oa=ys[--vs],ys[vs]=null}var Xi=null,Ji=null,Rn=!1,Ys=null;function ew(a,h){var v=ws(5,null,null,0);v.elementType="DELETED",v.stateNode=h,v.return=a,h=a.deletions,h===null?(a.deletions=[v],a.flags|=16):h.push(v)}function tw(a,h){switch(a.tag){case 5:var v=a.type;return h=h.nodeType!==1||v.toLowerCase()!==h.nodeName.toLowerCase()?null:h,h!==null?(a.stateNode=h,Xi=a,Ji=_o(h.firstChild),!0):!1;case 6:return h=a.pendingProps===""||h.nodeType!==3?null:h,h!==null?(a.stateNode=h,Xi=a,Ji=null,!0):!1;case 13:return h=h.nodeType!==8?null:h,h!==null?(v=bc!==null?{id:oa,overflow:aa}:null,a.memoizedState={dehydrated:h,treeContext:v,retryLane:1073741824},v=ws(18,null,null,0),v.stateNode=h,v.return=a,a.child=v,Xi=a,Ji=null,!0):!1;default:return!1}}function I0(a){return(a.mode&1)!==0&&(a.flags&128)===0}function N0(a){if(Rn){var h=Ji;if(h){var v=h;if(!tw(a,h)){if(I0(a))throw Error(t(418));h=_o(v.nextSibling);var A=Xi;h&&tw(a,h)?ew(A,v):(a.flags=a.flags&-4097|2,Rn=!1,Xi=a)}}else{if(I0(a))throw Error(t(418));a.flags=a.flags&-4097|2,Rn=!1,Xi=a}}}function nw(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;Xi=a}function Km(a){if(a!==Xi)return!1;if(!Rn)return nw(a),Rn=!0,!1;var h;if((h=a.tag!==3)&&!(h=a.tag!==5)&&(h=a.type,h=h!=="head"&&h!=="body"&&!Pt(a.type,a.memoizedProps)),h&&(h=Ji)){if(I0(a))throw rw(),Error(t(418));for(;h;)ew(a,h),h=_o(h.nextSibling)}if(nw(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,h=0;a;){if(a.nodeType===8){var v=a.data;if(v==="/$"){if(h===0){Ji=_o(a.nextSibling);break e}h--}else v!=="$"&&v!=="$!"&&v!=="$?"||h++}a=a.nextSibling}Ji=null}}else Ji=Xi?_o(a.stateNode.nextSibling):null;return!0}function rw(){for(var a=Ji;a;)a=_o(a.nextSibling)}function zu(){Ji=Xi=null,Rn=!1}function k0(a){Ys===null?Ys=[a]:Ys.push(a)}var VR=N.ReactCurrentBatchConfig;function yh(a,h,v){if(a=v.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(v._owner){if(v=v._owner,v){if(v.tag!==1)throw Error(t(309));var A=v.stateNode}if(!A)throw Error(t(147,a));var z=A,H=""+a;return h!==null&&h.ref!==null&&typeof h.ref=="function"&&h.ref._stringRef===H?h.ref:(h=function(X){var ue=z.refs;X===null?delete ue[H]:ue[H]=X},h._stringRef=H,h)}if(typeof a!="string")throw Error(t(284));if(!v._owner)throw Error(t(290,a))}return a}function Ym(a,h){throw a=Object.prototype.toString.call(h),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":a))}function iw(a){var h=a._init;return h(a._payload)}function sw(a){function h(xe,pe){if(a){var be=xe.deletions;be===null?(xe.deletions=[pe],xe.flags|=16):be.push(pe)}}function v(xe,pe){if(!a)return null;for(;pe!==null;)h(xe,pe),pe=pe.sibling;return null}function A(xe,pe){for(xe=new Map;pe!==null;)pe.key!==null?xe.set(pe.key,pe):xe.set(pe.index,pe),pe=pe.sibling;return xe}function z(xe,pe){return xe=_l(xe,pe),xe.index=0,xe.sibling=null,xe}function H(xe,pe,be){return xe.index=be,a?(be=xe.alternate,be!==null?(be=be.index,be<pe?(xe.flags|=2,pe):be):(xe.flags|=2,pe)):(xe.flags|=1048576,pe)}function X(xe){return a&&xe.alternate===null&&(xe.flags|=2),xe}function ue(xe,pe,be,Fe){return pe===null||pe.tag!==6?(pe=xv(be,xe.mode,Fe),pe.return=xe,pe):(pe=z(pe,be),pe.return=xe,pe)}function he(xe,pe,be,Fe){var rt=be.type;return rt===P?Oe(xe,pe,be.props.children,Fe,be.key):pe!==null&&(pe.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===ie&&iw(rt)===pe.type)?(Fe=z(pe,be.props),Fe.ref=yh(xe,pe,be),Fe.return=xe,Fe):(Fe=_p(be.type,be.key,be.props,null,xe.mode,Fe),Fe.ref=yh(xe,pe,be),Fe.return=xe,Fe)}function Ee(xe,pe,be,Fe){return pe===null||pe.tag!==4||pe.stateNode.containerInfo!==be.containerInfo||pe.stateNode.implementation!==be.implementation?(pe=bv(be,xe.mode,Fe),pe.return=xe,pe):(pe=z(pe,be.children||[]),pe.return=xe,pe)}function Oe(xe,pe,be,Fe,rt){return pe===null||pe.tag!==7?(pe=Pc(be,xe.mode,Fe,rt),pe.return=xe,pe):(pe=z(pe,be),pe.return=xe,pe)}function Me(xe,pe,be){if(typeof pe=="string"&&pe!==""||typeof pe=="number")return pe=xv(""+pe,xe.mode,be),pe.return=xe,pe;if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case R:return be=_p(pe.type,pe.key,pe.props,null,xe.mode,be),be.ref=yh(xe,null,pe),be.return=xe,be;case B:return pe=bv(pe,xe.mode,be),pe.return=xe,pe;case ie:var Fe=pe._init;return Me(xe,Fe(pe._payload),be)}if(De(pe)||J(pe))return pe=Pc(pe,xe.mode,be,null),pe.return=xe,pe;Ym(xe,pe)}return null}function Ce(xe,pe,be,Fe){var rt=pe!==null?pe.key:null;if(typeof be=="string"&&be!==""||typeof be=="number")return rt!==null?null:ue(xe,pe,""+be,Fe);if(typeof be=="object"&&be!==null){switch(be.$$typeof){case R:return be.key===rt?he(xe,pe,be,Fe):null;case B:return be.key===rt?Ee(xe,pe,be,Fe):null;case ie:return rt=be._init,Ce(xe,pe,rt(be._payload),Fe)}if(De(be)||J(be))return rt!==null?null:Oe(xe,pe,be,Fe,null);Ym(xe,be)}return null}function We(xe,pe,be,Fe,rt){if(typeof Fe=="string"&&Fe!==""||typeof Fe=="number")return xe=xe.get(be)||null,ue(pe,xe,""+Fe,rt);if(typeof Fe=="object"&&Fe!==null){switch(Fe.$$typeof){case R:return xe=xe.get(Fe.key===null?be:Fe.key)||null,he(pe,xe,Fe,rt);case B:return xe=xe.get(Fe.key===null?be:Fe.key)||null,Ee(pe,xe,Fe,rt);case ie:var dt=Fe._init;return We(xe,pe,be,dt(Fe._payload),rt)}if(De(Fe)||J(Fe))return xe=xe.get(be)||null,Oe(pe,xe,Fe,rt,null);Ym(pe,Fe)}return null}function Qe(xe,pe,be,Fe){for(var rt=null,dt=null,ht=pe,Tt=pe=0,wr=null;ht!==null&&Tt<be.length;Tt++){ht.index>Tt?(wr=ht,ht=null):wr=ht.sibling;var Xt=Ce(xe,ht,be[Tt],Fe);if(Xt===null){ht===null&&(ht=wr);break}a&&ht&&Xt.alternate===null&&h(xe,ht),pe=H(Xt,pe,Tt),dt===null?rt=Xt:dt.sibling=Xt,dt=Xt,ht=wr}if(Tt===be.length)return v(xe,ht),Rn&&wc(xe,Tt),rt;if(ht===null){for(;Tt<be.length;Tt++)ht=Me(xe,be[Tt],Fe),ht!==null&&(pe=H(ht,pe,Tt),dt===null?rt=ht:dt.sibling=ht,dt=ht);return Rn&&wc(xe,Tt),rt}for(ht=A(xe,ht);Tt<be.length;Tt++)wr=We(ht,xe,Tt,be[Tt],Fe),wr!==null&&(a&&wr.alternate!==null&&ht.delete(wr.key===null?Tt:wr.key),pe=H(wr,pe,Tt),dt===null?rt=wr:dt.sibling=wr,dt=wr);return a&&ht.forEach(function(xl){return h(xe,xl)}),Rn&&wc(xe,Tt),rt}function tt(xe,pe,be,Fe){var rt=J(be);if(typeof rt!="function")throw Error(t(150));if(be=rt.call(be),be==null)throw Error(t(151));for(var dt=rt=null,ht=pe,Tt=pe=0,wr=null,Xt=be.next();ht!==null&&!Xt.done;Tt++,Xt=be.next()){ht.index>Tt?(wr=ht,ht=null):wr=ht.sibling;var xl=Ce(xe,ht,Xt.value,Fe);if(xl===null){ht===null&&(ht=wr);break}a&&ht&&xl.alternate===null&&h(xe,ht),pe=H(xl,pe,Tt),dt===null?rt=xl:dt.sibling=xl,dt=xl,ht=wr}if(Xt.done)return v(xe,ht),Rn&&wc(xe,Tt),rt;if(ht===null){for(;!Xt.done;Tt++,Xt=be.next())Xt=Me(xe,Xt.value,Fe),Xt!==null&&(pe=H(Xt,pe,Tt),dt===null?rt=Xt:dt.sibling=Xt,dt=Xt);return Rn&&wc(xe,Tt),rt}for(ht=A(xe,ht);!Xt.done;Tt++,Xt=be.next())Xt=We(ht,xe,Tt,Xt.value,Fe),Xt!==null&&(a&&Xt.alternate!==null&&ht.delete(Xt.key===null?Tt:Xt.key),pe=H(Xt,pe,Tt),dt===null?rt=Xt:dt.sibling=Xt,dt=Xt);return a&&ht.forEach(function(v5){return h(xe,v5)}),Rn&&wc(xe,Tt),rt}function Gn(xe,pe,be,Fe){if(typeof be=="object"&&be!==null&&be.type===P&&be.key===null&&(be=be.props.children),typeof be=="object"&&be!==null){switch(be.$$typeof){case R:e:{for(var rt=be.key,dt=pe;dt!==null;){if(dt.key===rt){if(rt=be.type,rt===P){if(dt.tag===7){v(xe,dt.sibling),pe=z(dt,be.props.children),pe.return=xe,xe=pe;break e}}else if(dt.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===ie&&iw(rt)===dt.type){v(xe,dt.sibling),pe=z(dt,be.props),pe.ref=yh(xe,dt,be),pe.return=xe,xe=pe;break e}v(xe,dt);break}else h(xe,dt);dt=dt.sibling}be.type===P?(pe=Pc(be.props.children,xe.mode,Fe,be.key),pe.return=xe,xe=pe):(Fe=_p(be.type,be.key,be.props,null,xe.mode,Fe),Fe.ref=yh(xe,pe,be),Fe.return=xe,xe=Fe)}return X(xe);case B:e:{for(dt=be.key;pe!==null;){if(pe.key===dt)if(pe.tag===4&&pe.stateNode.containerInfo===be.containerInfo&&pe.stateNode.implementation===be.implementation){v(xe,pe.sibling),pe=z(pe,be.children||[]),pe.return=xe,xe=pe;break e}else{v(xe,pe);break}else h(xe,pe);pe=pe.sibling}pe=bv(be,xe.mode,Fe),pe.return=xe,xe=pe}return X(xe);case ie:return dt=be._init,Gn(xe,pe,dt(be._payload),Fe)}if(De(be))return Qe(xe,pe,be,Fe);if(J(be))return tt(xe,pe,be,Fe);Ym(xe,be)}return typeof be=="string"&&be!==""||typeof be=="number"?(be=""+be,pe!==null&&pe.tag===6?(v(xe,pe.sibling),pe=z(pe,be),pe.return=xe,xe=pe):(v(xe,pe),pe=xv(be,xe.mode,Fe),pe.return=xe,xe=pe),X(xe)):v(xe,pe)}return Gn}var Bu=sw(!0),ow=sw(!1),Zm=cl(null),Qm=null,Uu=null,P0=null;function C0(){P0=Uu=Qm=null}function R0(a){var h=Zm.current;In(Zm),a._currentValue=h}function O0(a,h,v){for(;a!==null;){var A=a.alternate;if((a.childLanes&h)!==h?(a.childLanes|=h,A!==null&&(A.childLanes|=h)):A!==null&&(A.childLanes&h)!==h&&(A.childLanes|=h),a===v)break;a=a.return}}function qu(a,h){Qm=a,P0=Uu=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&h)!==0&&(Pi=!0),a.firstContext=null)}function _s(a){var h=a._currentValue;if(P0!==a)if(a={context:a,memoizedValue:h,next:null},Uu===null){if(Qm===null)throw Error(t(308));Uu=a,Qm.dependencies={lanes:0,firstContext:a}}else Uu=Uu.next=a;return h}var Ec=null;function j0(a){Ec===null?Ec=[a]:Ec.push(a)}function aw(a,h,v,A){var z=h.interleaved;return z===null?(v.next=v,j0(h)):(v.next=z.next,z.next=v),h.interleaved=v,la(a,A)}function la(a,h){a.lanes|=h;var v=a.alternate;for(v!==null&&(v.lanes|=h),v=a,a=a.return;a!==null;)a.childLanes|=h,v=a.alternate,v!==null&&(v.childLanes|=h),v=a,a=a.return;return v.tag===3?v.stateNode:null}var hl=!1;function M0(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lw(a,h){a=a.updateQueue,h.updateQueue===a&&(h.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function ca(a,h){return{eventTime:a,lane:h,tag:0,payload:null,callback:null,next:null}}function fl(a,h,v){var A=a.updateQueue;if(A===null)return null;if(A=A.shared,(Kt&2)!==0){var z=A.pending;return z===null?h.next=h:(h.next=z.next,z.next=h),A.pending=h,la(a,v)}return z=A.interleaved,z===null?(h.next=h,j0(A)):(h.next=z.next,z.next=h),A.interleaved=h,la(a,v)}function Xm(a,h,v){if(h=h.updateQueue,h!==null&&(h=h.shared,(v&4194240)!==0)){var A=h.lanes;A&=a.pendingLanes,v|=A,h.lanes=v,Fr(a,v)}}function cw(a,h){var v=a.updateQueue,A=a.alternate;if(A!==null&&(A=A.updateQueue,v===A)){var z=null,H=null;if(v=v.firstBaseUpdate,v!==null){do{var X={eventTime:v.eventTime,lane:v.lane,tag:v.tag,payload:v.payload,callback:v.callback,next:null};H===null?z=H=X:H=H.next=X,v=v.next}while(v!==null);H===null?z=H=h:H=H.next=h}else z=H=h;v={baseState:A.baseState,firstBaseUpdate:z,lastBaseUpdate:H,shared:A.shared,effects:A.effects},a.updateQueue=v;return}a=v.lastBaseUpdate,a===null?v.firstBaseUpdate=h:a.next=h,v.lastBaseUpdate=h}function Jm(a,h,v,A){var z=a.updateQueue;hl=!1;var H=z.firstBaseUpdate,X=z.lastBaseUpdate,ue=z.shared.pending;if(ue!==null){z.shared.pending=null;var he=ue,Ee=he.next;he.next=null,X===null?H=Ee:X.next=Ee,X=he;var Oe=a.alternate;Oe!==null&&(Oe=Oe.updateQueue,ue=Oe.lastBaseUpdate,ue!==X&&(ue===null?Oe.firstBaseUpdate=Ee:ue.next=Ee,Oe.lastBaseUpdate=he))}if(H!==null){var Me=z.baseState;X=0,Oe=Ee=he=null,ue=H;do{var Ce=ue.lane,We=ue.eventTime;if((A&Ce)===Ce){Oe!==null&&(Oe=Oe.next={eventTime:We,lane:0,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null});e:{var Qe=a,tt=ue;switch(Ce=h,We=v,tt.tag){case 1:if(Qe=tt.payload,typeof Qe=="function"){Me=Qe.call(We,Me,Ce);break e}Me=Qe;break e;case 3:Qe.flags=Qe.flags&-65537|128;case 0:if(Qe=tt.payload,Ce=typeof Qe=="function"?Qe.call(We,Me,Ce):Qe,Ce==null)break e;Me=Y({},Me,Ce);break e;case 2:hl=!0}}ue.callback!==null&&ue.lane!==0&&(a.flags|=64,Ce=z.effects,Ce===null?z.effects=[ue]:Ce.push(ue))}else We={eventTime:We,lane:Ce,tag:ue.tag,payload:ue.payload,callback:ue.callback,next:null},Oe===null?(Ee=Oe=We,he=Me):Oe=Oe.next=We,X|=Ce;if(ue=ue.next,ue===null){if(ue=z.shared.pending,ue===null)break;Ce=ue,ue=Ce.next,Ce.next=null,z.lastBaseUpdate=Ce,z.shared.pending=null}}while(!0);if(Oe===null&&(he=Me),z.baseState=he,z.firstBaseUpdate=Ee,z.lastBaseUpdate=Oe,h=z.shared.interleaved,h!==null){z=h;do X|=z.lane,z=z.next;while(z!==h)}else H===null&&(z.shared.lanes=0);Ac|=X,a.lanes=X,a.memoizedState=Me}}function uw(a,h,v){if(a=h.effects,h.effects=null,a!==null)for(h=0;h<a.length;h++){var A=a[h],z=A.callback;if(z!==null){if(A.callback=null,A=v,typeof z!="function")throw Error(t(191,z));z.call(A)}}}var vh={},xo=cl(vh),_h=cl(vh),xh=cl(vh);function Tc(a){if(a===vh)throw Error(t(174));return a}function D0(a,h){switch(Sn(xh,h),Sn(_h,a),Sn(xo,vh),a=h.nodeType,a){case 9:case 11:h=(h=h.documentElement)?h.namespaceURI:jt(null,"");break;default:a=a===8?h.parentNode:h,h=a.namespaceURI||null,a=a.tagName,h=jt(h,a)}In(xo),Sn(xo,h)}function Hu(){In(xo),In(_h),In(xh)}function dw(a){Tc(xh.current);var h=Tc(xo.current),v=jt(h,a.type);h!==v&&(Sn(_h,a),Sn(xo,v))}function L0(a){_h.current===a&&(In(xo),In(_h))}var Dn=cl(0);function ep(a){for(var h=a;h!==null;){if(h.tag===13){var v=h.memoizedState;if(v!==null&&(v=v.dehydrated,v===null||v.data==="$?"||v.data==="$!"))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var F0=[];function V0(){for(var a=0;a<F0.length;a++)F0[a]._workInProgressVersionPrimary=null;F0.length=0}var tp=N.ReactCurrentDispatcher,z0=N.ReactCurrentBatchConfig,Sc=0,Ln=null,cr=null,xr=null,np=!1,bh=!1,wh=0,zR=0;function qr(){throw Error(t(321))}function B0(a,h){if(h===null)return!1;for(var v=0;v<h.length&&v<a.length;v++)if(!Zi(a[v],h[v]))return!1;return!0}function U0(a,h,v,A,z,H){if(Sc=H,Ln=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,tp.current=a===null||a.memoizedState===null?HR:$R,a=v(A,z),bh){H=0;do{if(bh=!1,wh=0,25<=H)throw Error(t(301));H+=1,xr=cr=null,h.updateQueue=null,tp.current=WR,a=v(A,z)}while(bh)}if(tp.current=sp,h=cr!==null&&cr.next!==null,Sc=0,xr=cr=Ln=null,np=!1,h)throw Error(t(300));return a}function q0(){var a=wh!==0;return wh=0,a}function bo(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return xr===null?Ln.memoizedState=xr=a:xr=xr.next=a,xr}function xs(){if(cr===null){var a=Ln.alternate;a=a!==null?a.memoizedState:null}else a=cr.next;var h=xr===null?Ln.memoizedState:xr.next;if(h!==null)xr=h,cr=a;else{if(a===null)throw Error(t(310));cr=a,a={memoizedState:cr.memoizedState,baseState:cr.baseState,baseQueue:cr.baseQueue,queue:cr.queue,next:null},xr===null?Ln.memoizedState=xr=a:xr=xr.next=a}return xr}function Eh(a,h){return typeof h=="function"?h(a):h}function H0(a){var h=xs(),v=h.queue;if(v===null)throw Error(t(311));v.lastRenderedReducer=a;var A=cr,z=A.baseQueue,H=v.pending;if(H!==null){if(z!==null){var X=z.next;z.next=H.next,H.next=X}A.baseQueue=z=H,v.pending=null}if(z!==null){H=z.next,A=A.baseState;var ue=X=null,he=null,Ee=H;do{var Oe=Ee.lane;if((Sc&Oe)===Oe)he!==null&&(he=he.next={lane:0,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null}),A=Ee.hasEagerState?Ee.eagerState:a(A,Ee.action);else{var Me={lane:Oe,action:Ee.action,hasEagerState:Ee.hasEagerState,eagerState:Ee.eagerState,next:null};he===null?(ue=he=Me,X=A):he=he.next=Me,Ln.lanes|=Oe,Ac|=Oe}Ee=Ee.next}while(Ee!==null&&Ee!==H);he===null?X=A:he.next=ue,Zi(A,h.memoizedState)||(Pi=!0),h.memoizedState=A,h.baseState=X,h.baseQueue=he,v.lastRenderedState=A}if(a=v.interleaved,a!==null){z=a;do H=z.lane,Ln.lanes|=H,Ac|=H,z=z.next;while(z!==a)}else z===null&&(v.lanes=0);return[h.memoizedState,v.dispatch]}function $0(a){var h=xs(),v=h.queue;if(v===null)throw Error(t(311));v.lastRenderedReducer=a;var A=v.dispatch,z=v.pending,H=h.memoizedState;if(z!==null){v.pending=null;var X=z=z.next;do H=a(H,X.action),X=X.next;while(X!==z);Zi(H,h.memoizedState)||(Pi=!0),h.memoizedState=H,h.baseQueue===null&&(h.baseState=H),v.lastRenderedState=H}return[H,A]}function hw(){}function fw(a,h){var v=Ln,A=xs(),z=h(),H=!Zi(A.memoizedState,z);if(H&&(A.memoizedState=z,Pi=!0),A=A.queue,W0(gw.bind(null,v,A,a),[a]),A.getSnapshot!==h||H||xr!==null&&xr.memoizedState.tag&1){if(v.flags|=2048,Th(9,pw.bind(null,v,A,z,h),void 0,null),br===null)throw Error(t(349));(Sc&30)!==0||mw(v,h,z)}return z}function mw(a,h,v){a.flags|=16384,a={getSnapshot:h,value:v},h=Ln.updateQueue,h===null?(h={lastEffect:null,stores:null},Ln.updateQueue=h,h.stores=[a]):(v=h.stores,v===null?h.stores=[a]:v.push(a))}function pw(a,h,v,A){h.value=v,h.getSnapshot=A,yw(h)&&vw(a)}function gw(a,h,v){return v(function(){yw(h)&&vw(a)})}function yw(a){var h=a.getSnapshot;a=a.value;try{var v=h();return!Zi(a,v)}catch{return!0}}function vw(a){var h=la(a,1);h!==null&&Js(h,a,1,-1)}function _w(a){var h=bo();return typeof a=="function"&&(a=a()),h.memoizedState=h.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Eh,lastRenderedState:a},h.queue=a,a=a.dispatch=qR.bind(null,Ln,a),[h.memoizedState,a]}function Th(a,h,v,A){return a={tag:a,create:h,destroy:v,deps:A,next:null},h=Ln.updateQueue,h===null?(h={lastEffect:null,stores:null},Ln.updateQueue=h,h.lastEffect=a.next=a):(v=h.lastEffect,v===null?h.lastEffect=a.next=a:(A=v.next,v.next=a,a.next=A,h.lastEffect=a)),a}function xw(){return xs().memoizedState}function rp(a,h,v,A){var z=bo();Ln.flags|=a,z.memoizedState=Th(1|h,v,void 0,A===void 0?null:A)}function ip(a,h,v,A){var z=xs();A=A===void 0?null:A;var H=void 0;if(cr!==null){var X=cr.memoizedState;if(H=X.destroy,A!==null&&B0(A,X.deps)){z.memoizedState=Th(h,v,H,A);return}}Ln.flags|=a,z.memoizedState=Th(1|h,v,H,A)}function bw(a,h){return rp(8390656,8,a,h)}function W0(a,h){return ip(2048,8,a,h)}function ww(a,h){return ip(4,2,a,h)}function Ew(a,h){return ip(4,4,a,h)}function Tw(a,h){if(typeof h=="function")return a=a(),h(a),function(){h(null)};if(h!=null)return a=a(),h.current=a,function(){h.current=null}}function Sw(a,h,v){return v=v!=null?v.concat([a]):null,ip(4,4,Tw.bind(null,h,a),v)}function G0(){}function Aw(a,h){var v=xs();h=h===void 0?null:h;var A=v.memoizedState;return A!==null&&h!==null&&B0(h,A[1])?A[0]:(v.memoizedState=[a,h],a)}function Iw(a,h){var v=xs();h=h===void 0?null:h;var A=v.memoizedState;return A!==null&&h!==null&&B0(h,A[1])?A[0]:(a=a(),v.memoizedState=[a,h],a)}function Nw(a,h,v){return(Sc&21)===0?(a.baseState&&(a.baseState=!1,Pi=!0),a.memoizedState=v):(Zi(v,h)||(v=Ho(),Ln.lanes|=v,Ac|=v,a.baseState=!0),h)}function BR(a,h){var v=Ct;Ct=v!==0&&4>v?v:4,a(!0);var A=z0.transition;z0.transition={};try{a(!1),h()}finally{Ct=v,z0.transition=A}}function kw(){return xs().memoizedState}function UR(a,h,v){var A=yl(a);if(v={lane:A,action:v,hasEagerState:!1,eagerState:null,next:null},Pw(a))Cw(h,v);else if(v=aw(a,h,v,A),v!==null){var z=li();Js(v,a,A,z),Rw(v,h,A)}}function qR(a,h,v){var A=yl(a),z={lane:A,action:v,hasEagerState:!1,eagerState:null,next:null};if(Pw(a))Cw(h,z);else{var H=a.alternate;if(a.lanes===0&&(H===null||H.lanes===0)&&(H=h.lastRenderedReducer,H!==null))try{var X=h.lastRenderedState,ue=H(X,v);if(z.hasEagerState=!0,z.eagerState=ue,Zi(ue,X)){var he=h.interleaved;he===null?(z.next=z,j0(h)):(z.next=he.next,he.next=z),h.interleaved=z;return}}catch{}finally{}v=aw(a,h,z,A),v!==null&&(z=li(),Js(v,a,A,z),Rw(v,h,A))}}function Pw(a){var h=a.alternate;return a===Ln||h!==null&&h===Ln}function Cw(a,h){bh=np=!0;var v=a.pending;v===null?h.next=h:(h.next=v.next,v.next=h),a.pending=h}function Rw(a,h,v){if((v&4194240)!==0){var A=h.lanes;A&=a.pendingLanes,v|=A,h.lanes=v,Fr(a,v)}}var sp={readContext:_s,useCallback:qr,useContext:qr,useEffect:qr,useImperativeHandle:qr,useInsertionEffect:qr,useLayoutEffect:qr,useMemo:qr,useReducer:qr,useRef:qr,useState:qr,useDebugValue:qr,useDeferredValue:qr,useTransition:qr,useMutableSource:qr,useSyncExternalStore:qr,useId:qr,unstable_isNewReconciler:!1},HR={readContext:_s,useCallback:function(a,h){return bo().memoizedState=[a,h===void 0?null:h],a},useContext:_s,useEffect:bw,useImperativeHandle:function(a,h,v){return v=v!=null?v.concat([a]):null,rp(4194308,4,Tw.bind(null,h,a),v)},useLayoutEffect:function(a,h){return rp(4194308,4,a,h)},useInsertionEffect:function(a,h){return rp(4,2,a,h)},useMemo:function(a,h){var v=bo();return h=h===void 0?null:h,a=a(),v.memoizedState=[a,h],a},useReducer:function(a,h,v){var A=bo();return h=v!==void 0?v(h):h,A.memoizedState=A.baseState=h,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:h},A.queue=a,a=a.dispatch=UR.bind(null,Ln,a),[A.memoizedState,a]},useRef:function(a){var h=bo();return a={current:a},h.memoizedState=a},useState:_w,useDebugValue:G0,useDeferredValue:function(a){return bo().memoizedState=a},useTransition:function(){var a=_w(!1),h=a[0];return a=BR.bind(null,a[1]),bo().memoizedState=a,[h,a]},useMutableSource:function(){},useSyncExternalStore:function(a,h,v){var A=Ln,z=bo();if(Rn){if(v===void 0)throw Error(t(407));v=v()}else{if(v=h(),br===null)throw Error(t(349));(Sc&30)!==0||mw(A,h,v)}z.memoizedState=v;var H={value:v,getSnapshot:h};return z.queue=H,bw(gw.bind(null,A,H,a),[a]),A.flags|=2048,Th(9,pw.bind(null,A,H,v,h),void 0,null),v},useId:function(){var a=bo(),h=br.identifierPrefix;if(Rn){var v=aa,A=oa;v=(A&~(1<<32-_t(A)-1)).toString(32)+v,h=":"+h+"R"+v,v=wh++,0<v&&(h+="H"+v.toString(32)),h+=":"}else v=zR++,h=":"+h+"r"+v.toString(32)+":";return a.memoizedState=h},unstable_isNewReconciler:!1},$R={readContext:_s,useCallback:Aw,useContext:_s,useEffect:W0,useImperativeHandle:Sw,useInsertionEffect:ww,useLayoutEffect:Ew,useMemo:Iw,useReducer:H0,useRef:xw,useState:function(){return H0(Eh)},useDebugValue:G0,useDeferredValue:function(a){var h=xs();return Nw(h,cr.memoizedState,a)},useTransition:function(){var a=H0(Eh)[0],h=xs().memoizedState;return[a,h]},useMutableSource:hw,useSyncExternalStore:fw,useId:kw,unstable_isNewReconciler:!1},WR={readContext:_s,useCallback:Aw,useContext:_s,useEffect:W0,useImperativeHandle:Sw,useInsertionEffect:ww,useLayoutEffect:Ew,useMemo:Iw,useReducer:$0,useRef:xw,useState:function(){return $0(Eh)},useDebugValue:G0,useDeferredValue:function(a){var h=xs();return cr===null?h.memoizedState=a:Nw(h,cr.memoizedState,a)},useTransition:function(){var a=$0(Eh)[0],h=xs().memoizedState;return[a,h]},useMutableSource:hw,useSyncExternalStore:fw,useId:kw,unstable_isNewReconciler:!1};function Zs(a,h){if(a&&a.defaultProps){h=Y({},h),a=a.defaultProps;for(var v in a)h[v]===void 0&&(h[v]=a[v]);return h}return h}function K0(a,h,v,A){h=a.memoizedState,v=v(A,h),v=v==null?h:Y({},h,v),a.memoizedState=v,a.lanes===0&&(a.updateQueue.baseState=v)}var op={isMounted:function(a){return(a=a._reactInternals)?Ar(a)===a:!1},enqueueSetState:function(a,h,v){a=a._reactInternals;var A=li(),z=yl(a),H=ca(A,z);H.payload=h,v!=null&&(H.callback=v),h=fl(a,H,z),h!==null&&(Js(h,a,z,A),Xm(h,a,z))},enqueueReplaceState:function(a,h,v){a=a._reactInternals;var A=li(),z=yl(a),H=ca(A,z);H.tag=1,H.payload=h,v!=null&&(H.callback=v),h=fl(a,H,z),h!==null&&(Js(h,a,z,A),Xm(h,a,z))},enqueueForceUpdate:function(a,h){a=a._reactInternals;var v=li(),A=yl(a),z=ca(v,A);z.tag=2,h!=null&&(z.callback=h),h=fl(a,z,A),h!==null&&(Js(h,a,A,v),Xm(h,a,A))}};function Ow(a,h,v,A,z,H,X){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(A,H,X):h.prototype&&h.prototype.isPureReactComponent?!go(v,A)||!go(z,H):!0}function jw(a,h,v){var A=!1,z=ul,H=h.contextType;return typeof H=="object"&&H!==null?H=_s(H):(z=ki(h)?xc:Ur.current,A=h.contextTypes,H=(A=A!=null)?Lu(a,z):ul),h=new h(v,H),a.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=op,a.stateNode=h,h._reactInternals=a,A&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=z,a.__reactInternalMemoizedMaskedChildContext=H),h}function Mw(a,h,v,A){a=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(v,A),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(v,A),h.state!==a&&op.enqueueReplaceState(h,h.state,null)}function Y0(a,h,v,A){var z=a.stateNode;z.props=v,z.state=a.memoizedState,z.refs={},M0(a);var H=h.contextType;typeof H=="object"&&H!==null?z.context=_s(H):(H=ki(h)?xc:Ur.current,z.context=Lu(a,H)),z.state=a.memoizedState,H=h.getDerivedStateFromProps,typeof H=="function"&&(K0(a,h,H,v),z.state=a.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof z.getSnapshotBeforeUpdate=="function"||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(h=z.state,typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount(),h!==z.state&&op.enqueueReplaceState(z,z.state,null),Jm(a,v,z,A),z.state=a.memoizedState),typeof z.componentDidMount=="function"&&(a.flags|=4194308)}function $u(a,h){try{var v="",A=h;do v+=le(A),A=A.return;while(A);var z=v}catch(H){z=`
Error generating stack: `+H.message+`
`+H.stack}return{value:a,source:h,stack:z,digest:null}}function Z0(a,h,v){return{value:a,source:null,stack:v??null,digest:h??null}}function Q0(a,h){try{console.error(h.value)}catch(v){setTimeout(function(){throw v})}}var GR=typeof WeakMap=="function"?WeakMap:Map;function Dw(a,h,v){v=ca(-1,v),v.tag=3,v.payload={element:null};var A=h.value;return v.callback=function(){fp||(fp=!0,hv=A),Q0(a,h)},v}function Lw(a,h,v){v=ca(-1,v),v.tag=3;var A=a.type.getDerivedStateFromError;if(typeof A=="function"){var z=h.value;v.payload=function(){return A(z)},v.callback=function(){Q0(a,h)}}var H=a.stateNode;return H!==null&&typeof H.componentDidCatch=="function"&&(v.callback=function(){Q0(a,h),typeof A!="function"&&(pl===null?pl=new Set([this]):pl.add(this));var X=h.stack;this.componentDidCatch(h.value,{componentStack:X!==null?X:""})}),v}function Fw(a,h,v){var A=a.pingCache;if(A===null){A=a.pingCache=new GR;var z=new Set;A.set(h,z)}else z=A.get(h),z===void 0&&(z=new Set,A.set(h,z));z.has(v)||(z.add(v),a=a5.bind(null,a,h,v),h.then(a,a))}function Vw(a){do{var h;if((h=a.tag===13)&&(h=a.memoizedState,h=h!==null?h.dehydrated!==null:!0),h)return a;a=a.return}while(a!==null);return null}function zw(a,h,v,A,z){return(a.mode&1)===0?(a===h?a.flags|=65536:(a.flags|=128,v.flags|=131072,v.flags&=-52805,v.tag===1&&(v.alternate===null?v.tag=17:(h=ca(-1,1),h.tag=2,fl(v,h,1))),v.lanes|=1),a):(a.flags|=65536,a.lanes=z,a)}var KR=N.ReactCurrentOwner,Pi=!1;function ai(a,h,v,A){h.child=a===null?ow(h,null,v,A):Bu(h,a.child,v,A)}function Bw(a,h,v,A,z){v=v.render;var H=h.ref;return qu(h,z),A=U0(a,h,v,A,H,z),v=q0(),a!==null&&!Pi?(h.updateQueue=a.updateQueue,h.flags&=-2053,a.lanes&=~z,ua(a,h,z)):(Rn&&v&&S0(h),h.flags|=1,ai(a,h,A,z),h.child)}function Uw(a,h,v,A,z){if(a===null){var H=v.type;return typeof H=="function"&&!_v(H)&&H.defaultProps===void 0&&v.compare===null&&v.defaultProps===void 0?(h.tag=15,h.type=H,qw(a,h,H,A,z)):(a=_p(v.type,null,A,h,h.mode,z),a.ref=h.ref,a.return=h,h.child=a)}if(H=a.child,(a.lanes&z)===0){var X=H.memoizedProps;if(v=v.compare,v=v!==null?v:go,v(X,A)&&a.ref===h.ref)return ua(a,h,z)}return h.flags|=1,a=_l(H,A),a.ref=h.ref,a.return=h,h.child=a}function qw(a,h,v,A,z){if(a!==null){var H=a.memoizedProps;if(go(H,A)&&a.ref===h.ref)if(Pi=!1,h.pendingProps=A=H,(a.lanes&z)!==0)(a.flags&131072)!==0&&(Pi=!0);else return h.lanes=a.lanes,ua(a,h,z)}return X0(a,h,v,A,z)}function Hw(a,h,v){var A=h.pendingProps,z=A.children,H=a!==null?a.memoizedState:null;if(A.mode==="hidden")if((h.mode&1)===0)h.memoizedState={baseLanes:0,cachePool:null,transitions:null},Sn(Gu,es),es|=v;else{if((v&1073741824)===0)return a=H!==null?H.baseLanes|v:v,h.lanes=h.childLanes=1073741824,h.memoizedState={baseLanes:a,cachePool:null,transitions:null},h.updateQueue=null,Sn(Gu,es),es|=a,null;h.memoizedState={baseLanes:0,cachePool:null,transitions:null},A=H!==null?H.baseLanes:v,Sn(Gu,es),es|=A}else H!==null?(A=H.baseLanes|v,h.memoizedState=null):A=v,Sn(Gu,es),es|=A;return ai(a,h,z,v),h.child}function $w(a,h){var v=h.ref;(a===null&&v!==null||a!==null&&a.ref!==v)&&(h.flags|=512,h.flags|=2097152)}function X0(a,h,v,A,z){var H=ki(v)?xc:Ur.current;return H=Lu(h,H),qu(h,z),v=U0(a,h,v,A,H,z),A=q0(),a!==null&&!Pi?(h.updateQueue=a.updateQueue,h.flags&=-2053,a.lanes&=~z,ua(a,h,z)):(Rn&&A&&S0(h),h.flags|=1,ai(a,h,v,z),h.child)}function Ww(a,h,v,A,z){if(ki(v)){var H=!0;Hm(h)}else H=!1;if(qu(h,z),h.stateNode===null)lp(a,h),jw(h,v,A),Y0(h,v,A,z),A=!0;else if(a===null){var X=h.stateNode,ue=h.memoizedProps;X.props=ue;var he=X.context,Ee=v.contextType;typeof Ee=="object"&&Ee!==null?Ee=_s(Ee):(Ee=ki(v)?xc:Ur.current,Ee=Lu(h,Ee));var Oe=v.getDerivedStateFromProps,Me=typeof Oe=="function"||typeof X.getSnapshotBeforeUpdate=="function";Me||typeof X.UNSAFE_componentWillReceiveProps!="function"&&typeof X.componentWillReceiveProps!="function"||(ue!==A||he!==Ee)&&Mw(h,X,A,Ee),hl=!1;var Ce=h.memoizedState;X.state=Ce,Jm(h,A,X,z),he=h.memoizedState,ue!==A||Ce!==he||Ni.current||hl?(typeof Oe=="function"&&(K0(h,v,Oe,A),he=h.memoizedState),(ue=hl||Ow(h,v,ue,A,Ce,he,Ee))?(Me||typeof X.UNSAFE_componentWillMount!="function"&&typeof X.componentWillMount!="function"||(typeof X.componentWillMount=="function"&&X.componentWillMount(),typeof X.UNSAFE_componentWillMount=="function"&&X.UNSAFE_componentWillMount()),typeof X.componentDidMount=="function"&&(h.flags|=4194308)):(typeof X.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=A,h.memoizedState=he),X.props=A,X.state=he,X.context=Ee,A=ue):(typeof X.componentDidMount=="function"&&(h.flags|=4194308),A=!1)}else{X=h.stateNode,lw(a,h),ue=h.memoizedProps,Ee=h.type===h.elementType?ue:Zs(h.type,ue),X.props=Ee,Me=h.pendingProps,Ce=X.context,he=v.contextType,typeof he=="object"&&he!==null?he=_s(he):(he=ki(v)?xc:Ur.current,he=Lu(h,he));var We=v.getDerivedStateFromProps;(Oe=typeof We=="function"||typeof X.getSnapshotBeforeUpdate=="function")||typeof X.UNSAFE_componentWillReceiveProps!="function"&&typeof X.componentWillReceiveProps!="function"||(ue!==Me||Ce!==he)&&Mw(h,X,A,he),hl=!1,Ce=h.memoizedState,X.state=Ce,Jm(h,A,X,z);var Qe=h.memoizedState;ue!==Me||Ce!==Qe||Ni.current||hl?(typeof We=="function"&&(K0(h,v,We,A),Qe=h.memoizedState),(Ee=hl||Ow(h,v,Ee,A,Ce,Qe,he)||!1)?(Oe||typeof X.UNSAFE_componentWillUpdate!="function"&&typeof X.componentWillUpdate!="function"||(typeof X.componentWillUpdate=="function"&&X.componentWillUpdate(A,Qe,he),typeof X.UNSAFE_componentWillUpdate=="function"&&X.UNSAFE_componentWillUpdate(A,Qe,he)),typeof X.componentDidUpdate=="function"&&(h.flags|=4),typeof X.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof X.componentDidUpdate!="function"||ue===a.memoizedProps&&Ce===a.memoizedState||(h.flags|=4),typeof X.getSnapshotBeforeUpdate!="function"||ue===a.memoizedProps&&Ce===a.memoizedState||(h.flags|=1024),h.memoizedProps=A,h.memoizedState=Qe),X.props=A,X.state=Qe,X.context=he,A=Ee):(typeof X.componentDidUpdate!="function"||ue===a.memoizedProps&&Ce===a.memoizedState||(h.flags|=4),typeof X.getSnapshotBeforeUpdate!="function"||ue===a.memoizedProps&&Ce===a.memoizedState||(h.flags|=1024),A=!1)}return J0(a,h,v,A,H,z)}function J0(a,h,v,A,z,H){$w(a,h);var X=(h.flags&128)!==0;if(!A&&!X)return z&&Q2(h,v,!1),ua(a,h,H);A=h.stateNode,KR.current=h;var ue=X&&typeof v.getDerivedStateFromError!="function"?null:A.render();return h.flags|=1,a!==null&&X?(h.child=Bu(h,a.child,null,H),h.child=Bu(h,null,ue,H)):ai(a,h,ue,H),h.memoizedState=A.state,z&&Q2(h,v,!0),h.child}function Gw(a){var h=a.stateNode;h.pendingContext?Y2(a,h.pendingContext,h.pendingContext!==h.context):h.context&&Y2(a,h.context,!1),D0(a,h.containerInfo)}function Kw(a,h,v,A,z){return zu(),k0(z),h.flags|=256,ai(a,h,v,A),h.child}var ev={dehydrated:null,treeContext:null,retryLane:0};function tv(a){return{baseLanes:a,cachePool:null,transitions:null}}function Yw(a,h,v){var A=h.pendingProps,z=Dn.current,H=!1,X=(h.flags&128)!==0,ue;if((ue=X)||(ue=a!==null&&a.memoizedState===null?!1:(z&2)!==0),ue?(H=!0,h.flags&=-129):(a===null||a.memoizedState!==null)&&(z|=1),Sn(Dn,z&1),a===null)return N0(h),a=h.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((h.mode&1)===0?h.lanes=1:a.data==="$!"?h.lanes=8:h.lanes=1073741824,null):(X=A.children,a=A.fallback,H?(A=h.mode,H=h.child,X={mode:"hidden",children:X},(A&1)===0&&H!==null?(H.childLanes=0,H.pendingProps=X):H=xp(X,A,0,null),a=Pc(a,A,v,null),H.return=h,a.return=h,H.sibling=a,h.child=H,h.child.memoizedState=tv(v),h.memoizedState=ev,a):nv(h,X));if(z=a.memoizedState,z!==null&&(ue=z.dehydrated,ue!==null))return YR(a,h,X,A,ue,z,v);if(H){H=A.fallback,X=h.mode,z=a.child,ue=z.sibling;var he={mode:"hidden",children:A.children};return(X&1)===0&&h.child!==z?(A=h.child,A.childLanes=0,A.pendingProps=he,h.deletions=null):(A=_l(z,he),A.subtreeFlags=z.subtreeFlags&14680064),ue!==null?H=_l(ue,H):(H=Pc(H,X,v,null),H.flags|=2),H.return=h,A.return=h,A.sibling=H,h.child=A,A=H,H=h.child,X=a.child.memoizedState,X=X===null?tv(v):{baseLanes:X.baseLanes|v,cachePool:null,transitions:X.transitions},H.memoizedState=X,H.childLanes=a.childLanes&~v,h.memoizedState=ev,A}return H=a.child,a=H.sibling,A=_l(H,{mode:"visible",children:A.children}),(h.mode&1)===0&&(A.lanes=v),A.return=h,A.sibling=null,a!==null&&(v=h.deletions,v===null?(h.deletions=[a],h.flags|=16):v.push(a)),h.child=A,h.memoizedState=null,A}function nv(a,h){return h=xp({mode:"visible",children:h},a.mode,0,null),h.return=a,a.child=h}function ap(a,h,v,A){return A!==null&&k0(A),Bu(h,a.child,null,v),a=nv(h,h.pendingProps.children),a.flags|=2,h.memoizedState=null,a}function YR(a,h,v,A,z,H,X){if(v)return h.flags&256?(h.flags&=-257,A=Z0(Error(t(422))),ap(a,h,X,A)):h.memoizedState!==null?(h.child=a.child,h.flags|=128,null):(H=A.fallback,z=h.mode,A=xp({mode:"visible",children:A.children},z,0,null),H=Pc(H,z,X,null),H.flags|=2,A.return=h,H.return=h,A.sibling=H,h.child=A,(h.mode&1)!==0&&Bu(h,a.child,null,X),h.child.memoizedState=tv(X),h.memoizedState=ev,H);if((h.mode&1)===0)return ap(a,h,X,null);if(z.data==="$!"){if(A=z.nextSibling&&z.nextSibling.dataset,A)var ue=A.dgst;return A=ue,H=Error(t(419)),A=Z0(H,A,void 0),ap(a,h,X,A)}if(ue=(X&a.childLanes)!==0,Pi||ue){if(A=br,A!==null){switch(X&-X){case 4:z=2;break;case 16:z=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:z=32;break;case 536870912:z=268435456;break;default:z=0}z=(z&(A.suspendedLanes|X))!==0?0:z,z!==0&&z!==H.retryLane&&(H.retryLane=z,la(a,z),Js(A,a,z,-1))}return vv(),A=Z0(Error(t(421))),ap(a,h,X,A)}return z.data==="$?"?(h.flags|=128,h.child=a.child,h=l5.bind(null,a),z._reactRetry=h,null):(a=H.treeContext,Ji=_o(z.nextSibling),Xi=h,Rn=!0,Ys=null,a!==null&&(ys[vs++]=oa,ys[vs++]=aa,ys[vs++]=bc,oa=a.id,aa=a.overflow,bc=h),h=nv(h,A.children),h.flags|=4096,h)}function Zw(a,h,v){a.lanes|=h;var A=a.alternate;A!==null&&(A.lanes|=h),O0(a.return,h,v)}function rv(a,h,v,A,z){var H=a.memoizedState;H===null?a.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:A,tail:v,tailMode:z}:(H.isBackwards=h,H.rendering=null,H.renderingStartTime=0,H.last=A,H.tail=v,H.tailMode=z)}function Qw(a,h,v){var A=h.pendingProps,z=A.revealOrder,H=A.tail;if(ai(a,h,A.children,v),A=Dn.current,(A&2)!==0)A=A&1|2,h.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=h.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&Zw(a,v,h);else if(a.tag===19)Zw(a,v,h);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===h)break e;for(;a.sibling===null;){if(a.return===null||a.return===h)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}A&=1}if(Sn(Dn,A),(h.mode&1)===0)h.memoizedState=null;else switch(z){case"forwards":for(v=h.child,z=null;v!==null;)a=v.alternate,a!==null&&ep(a)===null&&(z=v),v=v.sibling;v=z,v===null?(z=h.child,h.child=null):(z=v.sibling,v.sibling=null),rv(h,!1,z,v,H);break;case"backwards":for(v=null,z=h.child,h.child=null;z!==null;){if(a=z.alternate,a!==null&&ep(a)===null){h.child=z;break}a=z.sibling,z.sibling=v,v=z,z=a}rv(h,!0,v,null,H);break;case"together":rv(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function lp(a,h){(h.mode&1)===0&&a!==null&&(a.alternate=null,h.alternate=null,h.flags|=2)}function ua(a,h,v){if(a!==null&&(h.dependencies=a.dependencies),Ac|=h.lanes,(v&h.childLanes)===0)return null;if(a!==null&&h.child!==a.child)throw Error(t(153));if(h.child!==null){for(a=h.child,v=_l(a,a.pendingProps),h.child=v,v.return=h;a.sibling!==null;)a=a.sibling,v=v.sibling=_l(a,a.pendingProps),v.return=h;v.sibling=null}return h.child}function ZR(a,h,v){switch(h.tag){case 3:Gw(h),zu();break;case 5:dw(h);break;case 1:ki(h.type)&&Hm(h);break;case 4:D0(h,h.stateNode.containerInfo);break;case 10:var A=h.type._context,z=h.memoizedProps.value;Sn(Zm,A._currentValue),A._currentValue=z;break;case 13:if(A=h.memoizedState,A!==null)return A.dehydrated!==null?(Sn(Dn,Dn.current&1),h.flags|=128,null):(v&h.child.childLanes)!==0?Yw(a,h,v):(Sn(Dn,Dn.current&1),a=ua(a,h,v),a!==null?a.sibling:null);Sn(Dn,Dn.current&1);break;case 19:if(A=(v&h.childLanes)!==0,(a.flags&128)!==0){if(A)return Qw(a,h,v);h.flags|=128}if(z=h.memoizedState,z!==null&&(z.rendering=null,z.tail=null,z.lastEffect=null),Sn(Dn,Dn.current),A)break;return null;case 22:case 23:return h.lanes=0,Hw(a,h,v)}return ua(a,h,v)}var Xw,iv,Jw,eE;Xw=function(a,h){for(var v=h.child;v!==null;){if(v.tag===5||v.tag===6)a.appendChild(v.stateNode);else if(v.tag!==4&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===h)break;for(;v.sibling===null;){if(v.return===null||v.return===h)return;v=v.return}v.sibling.return=v.return,v=v.sibling}},iv=function(){},Jw=function(a,h,v,A){var z=a.memoizedProps;if(z!==A){a=h.stateNode,Tc(xo.current);var H=null;switch(v){case"input":z=pt(a,z),A=pt(a,A),H=[];break;case"select":z=Y({},z,{value:void 0}),A=Y({},A,{value:void 0}),H=[];break;case"textarea":z=ke(a,z),A=ke(a,A),H=[];break;default:typeof z.onClick!="function"&&typeof A.onClick=="function"&&(a.onclick=Pe)}gi(v,A);var X;v=null;for(Ee in z)if(!A.hasOwnProperty(Ee)&&z.hasOwnProperty(Ee)&&z[Ee]!=null)if(Ee==="style"){var ue=z[Ee];for(X in ue)ue.hasOwnProperty(X)&&(v||(v={}),v[X]="")}else Ee!=="dangerouslySetInnerHTML"&&Ee!=="children"&&Ee!=="suppressContentEditableWarning"&&Ee!=="suppressHydrationWarning"&&Ee!=="autoFocus"&&(i.hasOwnProperty(Ee)?H||(H=[]):(H=H||[]).push(Ee,null));for(Ee in A){var he=A[Ee];if(ue=z!=null?z[Ee]:void 0,A.hasOwnProperty(Ee)&&he!==ue&&(he!=null||ue!=null))if(Ee==="style")if(ue){for(X in ue)!ue.hasOwnProperty(X)||he&&he.hasOwnProperty(X)||(v||(v={}),v[X]="");for(X in he)he.hasOwnProperty(X)&&ue[X]!==he[X]&&(v||(v={}),v[X]=he[X])}else v||(H||(H=[]),H.push(Ee,v)),v=he;else Ee==="dangerouslySetInnerHTML"?(he=he?he.__html:void 0,ue=ue?ue.__html:void 0,he!=null&&ue!==he&&(H=H||[]).push(Ee,he)):Ee==="children"?typeof he!="string"&&typeof he!="number"||(H=H||[]).push(Ee,""+he):Ee!=="suppressContentEditableWarning"&&Ee!=="suppressHydrationWarning"&&(i.hasOwnProperty(Ee)?(he!=null&&Ee==="onScroll"&&vn("scroll",a),H||ue===he||(H=[])):(H=H||[]).push(Ee,he))}v&&(H=H||[]).push("style",v);var Ee=H;(h.updateQueue=Ee)&&(h.flags|=4)}},eE=function(a,h,v,A){v!==A&&(h.flags|=4)};function Sh(a,h){if(!Rn)switch(a.tailMode){case"hidden":h=a.tail;for(var v=null;h!==null;)h.alternate!==null&&(v=h),h=h.sibling;v===null?a.tail=null:v.sibling=null;break;case"collapsed":v=a.tail;for(var A=null;v!==null;)v.alternate!==null&&(A=v),v=v.sibling;A===null?h||a.tail===null?a.tail=null:a.tail.sibling=null:A.sibling=null}}function Hr(a){var h=a.alternate!==null&&a.alternate.child===a.child,v=0,A=0;if(h)for(var z=a.child;z!==null;)v|=z.lanes|z.childLanes,A|=z.subtreeFlags&14680064,A|=z.flags&14680064,z.return=a,z=z.sibling;else for(z=a.child;z!==null;)v|=z.lanes|z.childLanes,A|=z.subtreeFlags,A|=z.flags,z.return=a,z=z.sibling;return a.subtreeFlags|=A,a.childLanes=v,h}function QR(a,h,v){var A=h.pendingProps;switch(A0(h),h.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Hr(h),null;case 1:return ki(h.type)&&qm(),Hr(h),null;case 3:return A=h.stateNode,Hu(),In(Ni),In(Ur),V0(),A.pendingContext&&(A.context=A.pendingContext,A.pendingContext=null),(a===null||a.child===null)&&(Km(h)?h.flags|=4:a===null||a.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,Ys!==null&&(pv(Ys),Ys=null))),iv(a,h),Hr(h),null;case 5:L0(h);var z=Tc(xh.current);if(v=h.type,a!==null&&h.stateNode!=null)Jw(a,h,v,A,z),a.ref!==h.ref&&(h.flags|=512,h.flags|=2097152);else{if(!A){if(h.stateNode===null)throw Error(t(166));return Hr(h),null}if(a=Tc(xo.current),Km(h)){A=h.stateNode,v=h.type;var H=h.memoizedProps;switch(A[gs]=h,A[al]=H,a=(h.mode&1)!==0,v){case"dialog":vn("cancel",A),vn("close",A);break;case"iframe":case"object":case"embed":vn("load",A);break;case"video":case"audio":for(z=0;z<il.length;z++)vn(il[z],A);break;case"source":vn("error",A);break;case"img":case"image":case"link":vn("error",A),vn("load",A);break;case"details":vn("toggle",A);break;case"input":Et(A,H),vn("invalid",A);break;case"select":A._wrapperState={wasMultiple:!!H.multiple},vn("invalid",A);break;case"textarea":gt(A,H),vn("invalid",A)}gi(v,H),z=null;for(var X in H)if(H.hasOwnProperty(X)){var ue=H[X];X==="children"?typeof ue=="string"?A.textContent!==ue&&(H.suppressHydrationWarning!==!0&&we(A.textContent,ue,a),z=["children",ue]):typeof ue=="number"&&A.textContent!==""+ue&&(H.suppressHydrationWarning!==!0&&we(A.textContent,ue,a),z=["children",""+ue]):i.hasOwnProperty(X)&&ue!=null&&X==="onScroll"&&vn("scroll",A)}switch(v){case"input":Ue(A),Se(A,H,!0);break;case"textarea":Ue(A),mt(A);break;case"select":case"option":break;default:typeof H.onClick=="function"&&(A.onclick=Pe)}A=z,h.updateQueue=A,A!==null&&(h.flags|=4)}else{X=z.nodeType===9?z:z.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=kt(v)),a==="http://www.w3.org/1999/xhtml"?v==="script"?(a=X.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof A.is=="string"?a=X.createElement(v,{is:A.is}):(a=X.createElement(v),v==="select"&&(X=a,A.multiple?X.multiple=!0:A.size&&(X.size=A.size))):a=X.createElementNS(a,v),a[gs]=h,a[al]=A,Xw(a,h,!1,!1),h.stateNode=a;e:{switch(X=ti(v,A),v){case"dialog":vn("cancel",a),vn("close",a),z=A;break;case"iframe":case"object":case"embed":vn("load",a),z=A;break;case"video":case"audio":for(z=0;z<il.length;z++)vn(il[z],a);z=A;break;case"source":vn("error",a),z=A;break;case"img":case"image":case"link":vn("error",a),vn("load",a),z=A;break;case"details":vn("toggle",a),z=A;break;case"input":Et(a,A),z=pt(a,A),vn("invalid",a);break;case"option":z=A;break;case"select":a._wrapperState={wasMultiple:!!A.multiple},z=Y({},A,{value:void 0}),vn("invalid",a);break;case"textarea":gt(a,A),z=ke(a,A),vn("invalid",a);break;default:z=A}gi(v,z),ue=z;for(H in ue)if(ue.hasOwnProperty(H)){var he=ue[H];H==="style"?pi(a,he):H==="dangerouslySetInnerHTML"?(he=he?he.__html:void 0,he!=null&&os(a,he)):H==="children"?typeof he=="string"?(v!=="textarea"||he!=="")&&qt(a,he):typeof he=="number"&&qt(a,""+he):H!=="suppressContentEditableWarning"&&H!=="suppressHydrationWarning"&&H!=="autoFocus"&&(i.hasOwnProperty(H)?he!=null&&H==="onScroll"&&vn("scroll",a):he!=null&&C(a,H,he,X))}switch(v){case"input":Ue(a),Se(a,A,!1);break;case"textarea":Ue(a),mt(a);break;case"option":A.value!=null&&a.setAttribute("value",""+me(A.value));break;case"select":a.multiple=!!A.multiple,H=A.value,H!=null?Ve(a,!!A.multiple,H,!1):A.defaultValue!=null&&Ve(a,!!A.multiple,A.defaultValue,!0);break;default:typeof z.onClick=="function"&&(a.onclick=Pe)}switch(v){case"button":case"input":case"select":case"textarea":A=!!A.autoFocus;break e;case"img":A=!0;break e;default:A=!1}}A&&(h.flags|=4)}h.ref!==null&&(h.flags|=512,h.flags|=2097152)}return Hr(h),null;case 6:if(a&&h.stateNode!=null)eE(a,h,a.memoizedProps,A);else{if(typeof A!="string"&&h.stateNode===null)throw Error(t(166));if(v=Tc(xh.current),Tc(xo.current),Km(h)){if(A=h.stateNode,v=h.memoizedProps,A[gs]=h,(H=A.nodeValue!==v)&&(a=Xi,a!==null))switch(a.tag){case 3:we(A.nodeValue,v,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&we(A.nodeValue,v,(a.mode&1)!==0)}H&&(h.flags|=4)}else A=(v.nodeType===9?v:v.ownerDocument).createTextNode(A),A[gs]=h,h.stateNode=A}return Hr(h),null;case 13:if(In(Dn),A=h.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(Rn&&Ji!==null&&(h.mode&1)!==0&&(h.flags&128)===0)rw(),zu(),h.flags|=98560,H=!1;else if(H=Km(h),A!==null&&A.dehydrated!==null){if(a===null){if(!H)throw Error(t(318));if(H=h.memoizedState,H=H!==null?H.dehydrated:null,!H)throw Error(t(317));H[gs]=h}else zu(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;Hr(h),H=!1}else Ys!==null&&(pv(Ys),Ys=null),H=!0;if(!H)return h.flags&65536?h:null}return(h.flags&128)!==0?(h.lanes=v,h):(A=A!==null,A!==(a!==null&&a.memoizedState!==null)&&A&&(h.child.flags|=8192,(h.mode&1)!==0&&(a===null||(Dn.current&1)!==0?ur===0&&(ur=3):vv())),h.updateQueue!==null&&(h.flags|=4),Hr(h),null);case 4:return Hu(),iv(a,h),a===null&&sl(h.stateNode.containerInfo),Hr(h),null;case 10:return R0(h.type._context),Hr(h),null;case 17:return ki(h.type)&&qm(),Hr(h),null;case 19:if(In(Dn),H=h.memoizedState,H===null)return Hr(h),null;if(A=(h.flags&128)!==0,X=H.rendering,X===null)if(A)Sh(H,!1);else{if(ur!==0||a!==null&&(a.flags&128)!==0)for(a=h.child;a!==null;){if(X=ep(a),X!==null){for(h.flags|=128,Sh(H,!1),A=X.updateQueue,A!==null&&(h.updateQueue=A,h.flags|=4),h.subtreeFlags=0,A=v,v=h.child;v!==null;)H=v,a=A,H.flags&=14680066,X=H.alternate,X===null?(H.childLanes=0,H.lanes=a,H.child=null,H.subtreeFlags=0,H.memoizedProps=null,H.memoizedState=null,H.updateQueue=null,H.dependencies=null,H.stateNode=null):(H.childLanes=X.childLanes,H.lanes=X.lanes,H.child=X.child,H.subtreeFlags=0,H.deletions=null,H.memoizedProps=X.memoizedProps,H.memoizedState=X.memoizedState,H.updateQueue=X.updateQueue,H.type=X.type,a=X.dependencies,H.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),v=v.sibling;return Sn(Dn,Dn.current&1|2),h.child}a=a.sibling}H.tail!==null&&It()>Ku&&(h.flags|=128,A=!0,Sh(H,!1),h.lanes=4194304)}else{if(!A)if(a=ep(X),a!==null){if(h.flags|=128,A=!0,v=a.updateQueue,v!==null&&(h.updateQueue=v,h.flags|=4),Sh(H,!0),H.tail===null&&H.tailMode==="hidden"&&!X.alternate&&!Rn)return Hr(h),null}else 2*It()-H.renderingStartTime>Ku&&v!==1073741824&&(h.flags|=128,A=!0,Sh(H,!1),h.lanes=4194304);H.isBackwards?(X.sibling=h.child,h.child=X):(v=H.last,v!==null?v.sibling=X:h.child=X,H.last=X)}return H.tail!==null?(h=H.tail,H.rendering=h,H.tail=h.sibling,H.renderingStartTime=It(),h.sibling=null,v=Dn.current,Sn(Dn,A?v&1|2:v&1),h):(Hr(h),null);case 22:case 23:return yv(),A=h.memoizedState!==null,a!==null&&a.memoizedState!==null!==A&&(h.flags|=8192),A&&(h.mode&1)!==0?(es&1073741824)!==0&&(Hr(h),h.subtreeFlags&6&&(h.flags|=8192)):Hr(h),null;case 24:return null;case 25:return null}throw Error(t(156,h.tag))}function XR(a,h){switch(A0(h),h.tag){case 1:return ki(h.type)&&qm(),a=h.flags,a&65536?(h.flags=a&-65537|128,h):null;case 3:return Hu(),In(Ni),In(Ur),V0(),a=h.flags,(a&65536)!==0&&(a&128)===0?(h.flags=a&-65537|128,h):null;case 5:return L0(h),null;case 13:if(In(Dn),a=h.memoizedState,a!==null&&a.dehydrated!==null){if(h.alternate===null)throw Error(t(340));zu()}return a=h.flags,a&65536?(h.flags=a&-65537|128,h):null;case 19:return In(Dn),null;case 4:return Hu(),null;case 10:return R0(h.type._context),null;case 22:case 23:return yv(),null;case 24:return null;default:return null}}var cp=!1,$r=!1,JR=typeof WeakSet=="function"?WeakSet:Set,Ke=null;function Wu(a,h){var v=a.ref;if(v!==null)if(typeof v=="function")try{v(null)}catch(A){Bn(a,h,A)}else v.current=null}function sv(a,h,v){try{v()}catch(A){Bn(a,h,A)}}var tE=!1;function e5(a,h){if(He=qs,a=lh(),ch(a)){if("selectionStart"in a)var v={start:a.selectionStart,end:a.selectionEnd};else e:{v=(v=a.ownerDocument)&&v.defaultView||window;var A=v.getSelection&&v.getSelection();if(A&&A.rangeCount!==0){v=A.anchorNode;var z=A.anchorOffset,H=A.focusNode;A=A.focusOffset;try{v.nodeType,H.nodeType}catch{v=null;break e}var X=0,ue=-1,he=-1,Ee=0,Oe=0,Me=a,Ce=null;t:for(;;){for(var We;Me!==v||z!==0&&Me.nodeType!==3||(ue=X+z),Me!==H||A!==0&&Me.nodeType!==3||(he=X+A),Me.nodeType===3&&(X+=Me.nodeValue.length),(We=Me.firstChild)!==null;)Ce=Me,Me=We;for(;;){if(Me===a)break t;if(Ce===v&&++Ee===z&&(ue=X),Ce===H&&++Oe===A&&(he=X),(We=Me.nextSibling)!==null)break;Me=Ce,Ce=Me.parentNode}Me=We}v=ue===-1||he===-1?null:{start:ue,end:he}}else v=null}v=v||{start:0,end:0}}else v=null;for(ut={focusedElem:a,selectionRange:v},qs=!1,Ke=h;Ke!==null;)if(h=Ke,a=h.child,(h.subtreeFlags&1028)!==0&&a!==null)a.return=h,Ke=a;else for(;Ke!==null;){h=Ke;try{var Qe=h.alternate;if((h.flags&1024)!==0)switch(h.tag){case 0:case 11:case 15:break;case 1:if(Qe!==null){var tt=Qe.memoizedProps,Gn=Qe.memoizedState,xe=h.stateNode,pe=xe.getSnapshotBeforeUpdate(h.elementType===h.type?tt:Zs(h.type,tt),Gn);xe.__reactInternalSnapshotBeforeUpdate=pe}break;case 3:var be=h.stateNode.containerInfo;be.nodeType===1?be.textContent="":be.nodeType===9&&be.documentElement&&be.removeChild(be.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Fe){Bn(h,h.return,Fe)}if(a=h.sibling,a!==null){a.return=h.return,Ke=a;break}Ke=h.return}return Qe=tE,tE=!1,Qe}function Ah(a,h,v){var A=h.updateQueue;if(A=A!==null?A.lastEffect:null,A!==null){var z=A=A.next;do{if((z.tag&a)===a){var H=z.destroy;z.destroy=void 0,H!==void 0&&sv(h,v,H)}z=z.next}while(z!==A)}}function up(a,h){if(h=h.updateQueue,h=h!==null?h.lastEffect:null,h!==null){var v=h=h.next;do{if((v.tag&a)===a){var A=v.create;v.destroy=A()}v=v.next}while(v!==h)}}function ov(a){var h=a.ref;if(h!==null){var v=a.stateNode;switch(a.tag){case 5:a=v;break;default:a=v}typeof h=="function"?h(a):h.current=a}}function nE(a){var h=a.alternate;h!==null&&(a.alternate=null,nE(h)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(h=a.stateNode,h!==null&&(delete h[gs],delete h[al],delete h[ll],delete h[b0],delete h[w0])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function rE(a){return a.tag===5||a.tag===3||a.tag===4}function iE(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||rE(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function av(a,h,v){var A=a.tag;if(A===5||A===6)a=a.stateNode,h?v.nodeType===8?v.parentNode.insertBefore(a,h):v.insertBefore(a,h):(v.nodeType===8?(h=v.parentNode,h.insertBefore(a,v)):(h=v,h.appendChild(a)),v=v._reactRootContainer,v!=null||h.onclick!==null||(h.onclick=Pe));else if(A!==4&&(a=a.child,a!==null))for(av(a,h,v),a=a.sibling;a!==null;)av(a,h,v),a=a.sibling}function lv(a,h,v){var A=a.tag;if(A===5||A===6)a=a.stateNode,h?v.insertBefore(a,h):v.appendChild(a);else if(A!==4&&(a=a.child,a!==null))for(lv(a,h,v),a=a.sibling;a!==null;)lv(a,h,v),a=a.sibling}var Cr=null,Qs=!1;function ml(a,h,v){for(v=v.child;v!==null;)sE(a,h,v),v=v.sibling}function sE(a,h,v){if(or&&typeof or.onCommitFiberUnmount=="function")try{or.onCommitFiberUnmount($i,v)}catch{}switch(v.tag){case 5:$r||Wu(v,h);case 6:var A=Cr,z=Qs;Cr=null,ml(a,h,v),Cr=A,Qs=z,Cr!==null&&(Qs?(a=Cr,v=v.stateNode,a.nodeType===8?a.parentNode.removeChild(v):a.removeChild(v)):Cr.removeChild(v.stateNode));break;case 18:Cr!==null&&(Qs?(a=Cr,v=v.stateNode,a.nodeType===8?gh(a.parentNode,v):a.nodeType===1&&gh(a,v),ar(a)):gh(Cr,v.stateNode));break;case 4:A=Cr,z=Qs,Cr=v.stateNode.containerInfo,Qs=!0,ml(a,h,v),Cr=A,Qs=z;break;case 0:case 11:case 14:case 15:if(!$r&&(A=v.updateQueue,A!==null&&(A=A.lastEffect,A!==null))){z=A=A.next;do{var H=z,X=H.destroy;H=H.tag,X!==void 0&&((H&2)!==0||(H&4)!==0)&&sv(v,h,X),z=z.next}while(z!==A)}ml(a,h,v);break;case 1:if(!$r&&(Wu(v,h),A=v.stateNode,typeof A.componentWillUnmount=="function"))try{A.props=v.memoizedProps,A.state=v.memoizedState,A.componentWillUnmount()}catch(ue){Bn(v,h,ue)}ml(a,h,v);break;case 21:ml(a,h,v);break;case 22:v.mode&1?($r=(A=$r)||v.memoizedState!==null,ml(a,h,v),$r=A):ml(a,h,v);break;default:ml(a,h,v)}}function oE(a){var h=a.updateQueue;if(h!==null){a.updateQueue=null;var v=a.stateNode;v===null&&(v=a.stateNode=new JR),h.forEach(function(A){var z=c5.bind(null,a,A);v.has(A)||(v.add(A),A.then(z,z))})}}function Xs(a,h){var v=h.deletions;if(v!==null)for(var A=0;A<v.length;A++){var z=v[A];try{var H=a,X=h,ue=X;e:for(;ue!==null;){switch(ue.tag){case 5:Cr=ue.stateNode,Qs=!1;break e;case 3:Cr=ue.stateNode.containerInfo,Qs=!0;break e;case 4:Cr=ue.stateNode.containerInfo,Qs=!0;break e}ue=ue.return}if(Cr===null)throw Error(t(160));sE(H,X,z),Cr=null,Qs=!1;var he=z.alternate;he!==null&&(he.return=null),z.return=null}catch(Ee){Bn(z,h,Ee)}}if(h.subtreeFlags&12854)for(h=h.child;h!==null;)aE(h,a),h=h.sibling}function aE(a,h){var v=a.alternate,A=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(Xs(h,a),wo(a),A&4){try{Ah(3,a,a.return),up(3,a)}catch(tt){Bn(a,a.return,tt)}try{Ah(5,a,a.return)}catch(tt){Bn(a,a.return,tt)}}break;case 1:Xs(h,a),wo(a),A&512&&v!==null&&Wu(v,v.return);break;case 5:if(Xs(h,a),wo(a),A&512&&v!==null&&Wu(v,v.return),a.flags&32){var z=a.stateNode;try{qt(z,"")}catch(tt){Bn(a,a.return,tt)}}if(A&4&&(z=a.stateNode,z!=null)){var H=a.memoizedProps,X=v!==null?v.memoizedProps:H,ue=a.type,he=a.updateQueue;if(a.updateQueue=null,he!==null)try{ue==="input"&&H.type==="radio"&&H.name!=null&&_n(z,H),ti(ue,X);var Ee=ti(ue,H);for(X=0;X<he.length;X+=2){var Oe=he[X],Me=he[X+1];Oe==="style"?pi(z,Me):Oe==="dangerouslySetInnerHTML"?os(z,Me):Oe==="children"?qt(z,Me):C(z,Oe,Me,Ee)}switch(ue){case"input":Wt(z,H);break;case"textarea":ft(z,H);break;case"select":var Ce=z._wrapperState.wasMultiple;z._wrapperState.wasMultiple=!!H.multiple;var We=H.value;We!=null?Ve(z,!!H.multiple,We,!1):Ce!==!!H.multiple&&(H.defaultValue!=null?Ve(z,!!H.multiple,H.defaultValue,!0):Ve(z,!!H.multiple,H.multiple?[]:"",!1))}z[al]=H}catch(tt){Bn(a,a.return,tt)}}break;case 6:if(Xs(h,a),wo(a),A&4){if(a.stateNode===null)throw Error(t(162));z=a.stateNode,H=a.memoizedProps;try{z.nodeValue=H}catch(tt){Bn(a,a.return,tt)}}break;case 3:if(Xs(h,a),wo(a),A&4&&v!==null&&v.memoizedState.isDehydrated)try{ar(h.containerInfo)}catch(tt){Bn(a,a.return,tt)}break;case 4:Xs(h,a),wo(a);break;case 13:Xs(h,a),wo(a),z=a.child,z.flags&8192&&(H=z.memoizedState!==null,z.stateNode.isHidden=H,!H||z.alternate!==null&&z.alternate.memoizedState!==null||(dv=It())),A&4&&oE(a);break;case 22:if(Oe=v!==null&&v.memoizedState!==null,a.mode&1?($r=(Ee=$r)||Oe,Xs(h,a),$r=Ee):Xs(h,a),wo(a),A&8192){if(Ee=a.memoizedState!==null,(a.stateNode.isHidden=Ee)&&!Oe&&(a.mode&1)!==0)for(Ke=a,Oe=a.child;Oe!==null;){for(Me=Ke=Oe;Ke!==null;){switch(Ce=Ke,We=Ce.child,Ce.tag){case 0:case 11:case 14:case 15:Ah(4,Ce,Ce.return);break;case 1:Wu(Ce,Ce.return);var Qe=Ce.stateNode;if(typeof Qe.componentWillUnmount=="function"){A=Ce,v=Ce.return;try{h=A,Qe.props=h.memoizedProps,Qe.state=h.memoizedState,Qe.componentWillUnmount()}catch(tt){Bn(A,v,tt)}}break;case 5:Wu(Ce,Ce.return);break;case 22:if(Ce.memoizedState!==null){uE(Me);continue}}We!==null?(We.return=Ce,Ke=We):uE(Me)}Oe=Oe.sibling}e:for(Oe=null,Me=a;;){if(Me.tag===5){if(Oe===null){Oe=Me;try{z=Me.stateNode,Ee?(H=z.style,typeof H.setProperty=="function"?H.setProperty("display","none","important"):H.display="none"):(ue=Me.stateNode,he=Me.memoizedProps.style,X=he!=null&&he.hasOwnProperty("display")?he.display:null,ue.style.display=Bi("display",X))}catch(tt){Bn(a,a.return,tt)}}}else if(Me.tag===6){if(Oe===null)try{Me.stateNode.nodeValue=Ee?"":Me.memoizedProps}catch(tt){Bn(a,a.return,tt)}}else if((Me.tag!==22&&Me.tag!==23||Me.memoizedState===null||Me===a)&&Me.child!==null){Me.child.return=Me,Me=Me.child;continue}if(Me===a)break e;for(;Me.sibling===null;){if(Me.return===null||Me.return===a)break e;Oe===Me&&(Oe=null),Me=Me.return}Oe===Me&&(Oe=null),Me.sibling.return=Me.return,Me=Me.sibling}}break;case 19:Xs(h,a),wo(a),A&4&&oE(a);break;case 21:break;default:Xs(h,a),wo(a)}}function wo(a){var h=a.flags;if(h&2){try{e:{for(var v=a.return;v!==null;){if(rE(v)){var A=v;break e}v=v.return}throw Error(t(160))}switch(A.tag){case 5:var z=A.stateNode;A.flags&32&&(qt(z,""),A.flags&=-33);var H=iE(a);lv(a,H,z);break;case 3:case 4:var X=A.stateNode.containerInfo,ue=iE(a);av(a,ue,X);break;default:throw Error(t(161))}}catch(he){Bn(a,a.return,he)}a.flags&=-3}h&4096&&(a.flags&=-4097)}function t5(a,h,v){Ke=a,lE(a)}function lE(a,h,v){for(var A=(a.mode&1)!==0;Ke!==null;){var z=Ke,H=z.child;if(z.tag===22&&A){var X=z.memoizedState!==null||cp;if(!X){var ue=z.alternate,he=ue!==null&&ue.memoizedState!==null||$r;ue=cp;var Ee=$r;if(cp=X,($r=he)&&!Ee)for(Ke=z;Ke!==null;)X=Ke,he=X.child,X.tag===22&&X.memoizedState!==null?dE(z):he!==null?(he.return=X,Ke=he):dE(z);for(;H!==null;)Ke=H,lE(H),H=H.sibling;Ke=z,cp=ue,$r=Ee}cE(a)}else(z.subtreeFlags&8772)!==0&&H!==null?(H.return=z,Ke=H):cE(a)}}function cE(a){for(;Ke!==null;){var h=Ke;if((h.flags&8772)!==0){var v=h.alternate;try{if((h.flags&8772)!==0)switch(h.tag){case 0:case 11:case 15:$r||up(5,h);break;case 1:var A=h.stateNode;if(h.flags&4&&!$r)if(v===null)A.componentDidMount();else{var z=h.elementType===h.type?v.memoizedProps:Zs(h.type,v.memoizedProps);A.componentDidUpdate(z,v.memoizedState,A.__reactInternalSnapshotBeforeUpdate)}var H=h.updateQueue;H!==null&&uw(h,H,A);break;case 3:var X=h.updateQueue;if(X!==null){if(v=null,h.child!==null)switch(h.child.tag){case 5:v=h.child.stateNode;break;case 1:v=h.child.stateNode}uw(h,X,v)}break;case 5:var ue=h.stateNode;if(v===null&&h.flags&4){v=ue;var he=h.memoizedProps;switch(h.type){case"button":case"input":case"select":case"textarea":he.autoFocus&&v.focus();break;case"img":he.src&&(v.src=he.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(h.memoizedState===null){var Ee=h.alternate;if(Ee!==null){var Oe=Ee.memoizedState;if(Oe!==null){var Me=Oe.dehydrated;Me!==null&&ar(Me)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}$r||h.flags&512&&ov(h)}catch(Ce){Bn(h,h.return,Ce)}}if(h===a){Ke=null;break}if(v=h.sibling,v!==null){v.return=h.return,Ke=v;break}Ke=h.return}}function uE(a){for(;Ke!==null;){var h=Ke;if(h===a){Ke=null;break}var v=h.sibling;if(v!==null){v.return=h.return,Ke=v;break}Ke=h.return}}function dE(a){for(;Ke!==null;){var h=Ke;try{switch(h.tag){case 0:case 11:case 15:var v=h.return;try{up(4,h)}catch(he){Bn(h,v,he)}break;case 1:var A=h.stateNode;if(typeof A.componentDidMount=="function"){var z=h.return;try{A.componentDidMount()}catch(he){Bn(h,z,he)}}var H=h.return;try{ov(h)}catch(he){Bn(h,H,he)}break;case 5:var X=h.return;try{ov(h)}catch(he){Bn(h,X,he)}}}catch(he){Bn(h,h.return,he)}if(h===a){Ke=null;break}var ue=h.sibling;if(ue!==null){ue.return=h.return,Ke=ue;break}Ke=h.return}}var n5=Math.ceil,dp=N.ReactCurrentDispatcher,cv=N.ReactCurrentOwner,bs=N.ReactCurrentBatchConfig,Kt=0,br=null,rr=null,Rr=0,es=0,Gu=cl(0),ur=0,Ih=null,Ac=0,hp=0,uv=0,Nh=null,Ci=null,dv=0,Ku=1/0,da=null,fp=!1,hv=null,pl=null,mp=!1,gl=null,pp=0,kh=0,fv=null,gp=-1,yp=0;function li(){return(Kt&6)!==0?It():gp!==-1?gp:gp=It()}function yl(a){return(a.mode&1)===0?1:(Kt&2)!==0&&Rr!==0?Rr&-Rr:VR.transition!==null?(yp===0&&(yp=Ho()),yp):(a=Ct,a!==0||(a=window.event,a=a===void 0?16:Rt(a.type)),a)}function Js(a,h,v,A){if(50<kh)throw kh=0,fv=null,Error(t(185));Lr(a,v,A),((Kt&2)===0||a!==br)&&(a===br&&((Kt&2)===0&&(hp|=v),ur===4&&vl(a,Rr)),Ri(a,A),v===1&&Kt===0&&(h.mode&1)===0&&(Ku=It()+500,$m&&dl()))}function Ri(a,h){var v=a.callbackNode;bi(a,h);var A=cn(a,a===br?Rr:0);if(A===0)v!==null&&je(v),a.callbackNode=null,a.callbackPriority=0;else if(h=A&-A,a.callbackPriority!==h){if(v!=null&&je(v),h===1)a.tag===0?FR(fE.bind(null,a)):X2(fE.bind(null,a)),Br(function(){(Kt&6)===0&&dl()}),v=null;else{switch(wi(A)){case 1:v=Cn;break;case 4:v=Xn;break;case 16:v=$n;break;case 536870912:v=yn;break;default:v=$n}v=bE(v,hE.bind(null,a))}a.callbackPriority=h,a.callbackNode=v}}function hE(a,h){if(gp=-1,yp=0,(Kt&6)!==0)throw Error(t(327));var v=a.callbackNode;if(Yu()&&a.callbackNode!==v)return null;var A=cn(a,a===br?Rr:0);if(A===0)return null;if((A&30)!==0||(A&a.expiredLanes)!==0||h)h=vp(a,A);else{h=A;var z=Kt;Kt|=2;var H=pE();(br!==a||Rr!==h)&&(da=null,Ku=It()+500,Nc(a,h));do try{s5();break}catch(ue){mE(a,ue)}while(!0);C0(),dp.current=H,Kt=z,rr!==null?h=0:(br=null,Rr=0,h=ur)}if(h!==0){if(h===2&&(z=En(a),z!==0&&(A=z,h=mv(a,z))),h===1)throw v=Ih,Nc(a,0),vl(a,A),Ri(a,It()),v;if(h===6)vl(a,A);else{if(z=a.current.alternate,(A&30)===0&&!r5(z)&&(h=vp(a,A),h===2&&(H=En(a),H!==0&&(A=H,h=mv(a,H))),h===1))throw v=Ih,Nc(a,0),vl(a,A),Ri(a,It()),v;switch(a.finishedWork=z,a.finishedLanes=A,h){case 0:case 1:throw Error(t(345));case 2:kc(a,Ci,da);break;case 3:if(vl(a,A),(A&130023424)===A&&(h=dv+500-It(),10<h)){if(cn(a,0)!==0)break;if(z=a.suspendedLanes,(z&A)!==A){li(),a.pingedLanes|=a.suspendedLanes&z;break}a.timeoutHandle=lr(kc.bind(null,a,Ci,da),h);break}kc(a,Ci,da);break;case 4:if(vl(a,A),(A&4194240)===A)break;for(h=a.eventTimes,z=-1;0<A;){var X=31-_t(A);H=1<<X,X=h[X],X>z&&(z=X),A&=~H}if(A=z,A=It()-A,A=(120>A?120:480>A?480:1080>A?1080:1920>A?1920:3e3>A?3e3:4320>A?4320:1960*n5(A/1960))-A,10<A){a.timeoutHandle=lr(kc.bind(null,a,Ci,da),A);break}kc(a,Ci,da);break;case 5:kc(a,Ci,da);break;default:throw Error(t(329))}}}return Ri(a,It()),a.callbackNode===v?hE.bind(null,a):null}function mv(a,h){var v=Nh;return a.current.memoizedState.isDehydrated&&(Nc(a,h).flags|=256),a=vp(a,h),a!==2&&(h=Ci,Ci=v,h!==null&&pv(h)),a}function pv(a){Ci===null?Ci=a:Ci.push.apply(Ci,a)}function r5(a){for(var h=a;;){if(h.flags&16384){var v=h.updateQueue;if(v!==null&&(v=v.stores,v!==null))for(var A=0;A<v.length;A++){var z=v[A],H=z.getSnapshot;z=z.value;try{if(!Zi(H(),z))return!1}catch{return!1}}}if(v=h.child,h.subtreeFlags&16384&&v!==null)v.return=h,h=v;else{if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function vl(a,h){for(h&=~uv,h&=~hp,a.suspendedLanes|=h,a.pingedLanes&=~h,a=a.expirationTimes;0<h;){var v=31-_t(h),A=1<<v;a[v]=-1,h&=~A}}function fE(a){if((Kt&6)!==0)throw Error(t(327));Yu();var h=cn(a,0);if((h&1)===0)return Ri(a,It()),null;var v=vp(a,h);if(a.tag!==0&&v===2){var A=En(a);A!==0&&(h=A,v=mv(a,A))}if(v===1)throw v=Ih,Nc(a,0),vl(a,h),Ri(a,It()),v;if(v===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=h,kc(a,Ci,da),Ri(a,It()),null}function gv(a,h){var v=Kt;Kt|=1;try{return a(h)}finally{Kt=v,Kt===0&&(Ku=It()+500,$m&&dl())}}function Ic(a){gl!==null&&gl.tag===0&&(Kt&6)===0&&Yu();var h=Kt;Kt|=1;var v=bs.transition,A=Ct;try{if(bs.transition=null,Ct=1,a)return a()}finally{Ct=A,bs.transition=v,Kt=h,(Kt&6)===0&&dl()}}function yv(){es=Gu.current,In(Gu)}function Nc(a,h){a.finishedWork=null,a.finishedLanes=0;var v=a.timeoutHandle;if(v!==-1&&(a.timeoutHandle=-1,nr(v)),rr!==null)for(v=rr.return;v!==null;){var A=v;switch(A0(A),A.tag){case 1:A=A.type.childContextTypes,A!=null&&qm();break;case 3:Hu(),In(Ni),In(Ur),V0();break;case 5:L0(A);break;case 4:Hu();break;case 13:In(Dn);break;case 19:In(Dn);break;case 10:R0(A.type._context);break;case 22:case 23:yv()}v=v.return}if(br=a,rr=a=_l(a.current,null),Rr=es=h,ur=0,Ih=null,uv=hp=Ac=0,Ci=Nh=null,Ec!==null){for(h=0;h<Ec.length;h++)if(v=Ec[h],A=v.interleaved,A!==null){v.interleaved=null;var z=A.next,H=v.pending;if(H!==null){var X=H.next;H.next=z,A.next=X}v.pending=A}Ec=null}return a}function mE(a,h){do{var v=rr;try{if(C0(),tp.current=sp,np){for(var A=Ln.memoizedState;A!==null;){var z=A.queue;z!==null&&(z.pending=null),A=A.next}np=!1}if(Sc=0,xr=cr=Ln=null,bh=!1,wh=0,cv.current=null,v===null||v.return===null){ur=1,Ih=h,rr=null;break}e:{var H=a,X=v.return,ue=v,he=h;if(h=Rr,ue.flags|=32768,he!==null&&typeof he=="object"&&typeof he.then=="function"){var Ee=he,Oe=ue,Me=Oe.tag;if((Oe.mode&1)===0&&(Me===0||Me===11||Me===15)){var Ce=Oe.alternate;Ce?(Oe.updateQueue=Ce.updateQueue,Oe.memoizedState=Ce.memoizedState,Oe.lanes=Ce.lanes):(Oe.updateQueue=null,Oe.memoizedState=null)}var We=Vw(X);if(We!==null){We.flags&=-257,zw(We,X,ue,H,h),We.mode&1&&Fw(H,Ee,h),h=We,he=Ee;var Qe=h.updateQueue;if(Qe===null){var tt=new Set;tt.add(he),h.updateQueue=tt}else Qe.add(he);break e}else{if((h&1)===0){Fw(H,Ee,h),vv();break e}he=Error(t(426))}}else if(Rn&&ue.mode&1){var Gn=Vw(X);if(Gn!==null){(Gn.flags&65536)===0&&(Gn.flags|=256),zw(Gn,X,ue,H,h),k0($u(he,ue));break e}}H=he=$u(he,ue),ur!==4&&(ur=2),Nh===null?Nh=[H]:Nh.push(H),H=X;do{switch(H.tag){case 3:H.flags|=65536,h&=-h,H.lanes|=h;var xe=Dw(H,he,h);cw(H,xe);break e;case 1:ue=he;var pe=H.type,be=H.stateNode;if((H.flags&128)===0&&(typeof pe.getDerivedStateFromError=="function"||be!==null&&typeof be.componentDidCatch=="function"&&(pl===null||!pl.has(be)))){H.flags|=65536,h&=-h,H.lanes|=h;var Fe=Lw(H,ue,h);cw(H,Fe);break e}}H=H.return}while(H!==null)}yE(v)}catch(rt){h=rt,rr===v&&v!==null&&(rr=v=v.return);continue}break}while(!0)}function pE(){var a=dp.current;return dp.current=sp,a===null?sp:a}function vv(){(ur===0||ur===3||ur===2)&&(ur=4),br===null||(Ac&268435455)===0&&(hp&268435455)===0||vl(br,Rr)}function vp(a,h){var v=Kt;Kt|=2;var A=pE();(br!==a||Rr!==h)&&(da=null,Nc(a,h));do try{i5();break}catch(z){mE(a,z)}while(!0);if(C0(),Kt=v,dp.current=A,rr!==null)throw Error(t(261));return br=null,Rr=0,ur}function i5(){for(;rr!==null;)gE(rr)}function s5(){for(;rr!==null&&!Ge();)gE(rr)}function gE(a){var h=xE(a.alternate,a,es);a.memoizedProps=a.pendingProps,h===null?yE(a):rr=h,cv.current=null}function yE(a){var h=a;do{var v=h.alternate;if(a=h.return,(h.flags&32768)===0){if(v=QR(v,h,es),v!==null){rr=v;return}}else{if(v=XR(v,h),v!==null){v.flags&=32767,rr=v;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{ur=6,rr=null;return}}if(h=h.sibling,h!==null){rr=h;return}rr=h=a}while(h!==null);ur===0&&(ur=5)}function kc(a,h,v){var A=Ct,z=bs.transition;try{bs.transition=null,Ct=1,o5(a,h,v,A)}finally{bs.transition=z,Ct=A}return null}function o5(a,h,v,A){do Yu();while(gl!==null);if((Kt&6)!==0)throw Error(t(327));v=a.finishedWork;var z=a.finishedLanes;if(v===null)return null;if(a.finishedWork=null,a.finishedLanes=0,v===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var H=v.lanes|v.childLanes;if(xt(a,H),a===br&&(rr=br=null,Rr=0),(v.subtreeFlags&2064)===0&&(v.flags&2064)===0||mp||(mp=!0,bE($n,function(){return Yu(),null})),H=(v.flags&15990)!==0,(v.subtreeFlags&15990)!==0||H){H=bs.transition,bs.transition=null;var X=Ct;Ct=1;var ue=Kt;Kt|=4,cv.current=null,e5(a,v),aE(v,a),ms(ut),qs=!!He,ut=He=null,a.current=v,t5(v),Gt(),Kt=ue,Ct=X,bs.transition=H}else a.current=v;if(mp&&(mp=!1,gl=a,pp=z),H=a.pendingLanes,H===0&&(pl=null),uo(v.stateNode),Ri(a,It()),h!==null)for(A=a.onRecoverableError,v=0;v<h.length;v++)z=h[v],A(z.value,{componentStack:z.stack,digest:z.digest});if(fp)throw fp=!1,a=hv,hv=null,a;return(pp&1)!==0&&a.tag!==0&&Yu(),H=a.pendingLanes,(H&1)!==0?a===fv?kh++:(kh=0,fv=a):kh=0,dl(),null}function Yu(){if(gl!==null){var a=wi(pp),h=bs.transition,v=Ct;try{if(bs.transition=null,Ct=16>a?16:a,gl===null)var A=!1;else{if(a=gl,gl=null,pp=0,(Kt&6)!==0)throw Error(t(331));var z=Kt;for(Kt|=4,Ke=a.current;Ke!==null;){var H=Ke,X=H.child;if((Ke.flags&16)!==0){var ue=H.deletions;if(ue!==null){for(var he=0;he<ue.length;he++){var Ee=ue[he];for(Ke=Ee;Ke!==null;){var Oe=Ke;switch(Oe.tag){case 0:case 11:case 15:Ah(8,Oe,H)}var Me=Oe.child;if(Me!==null)Me.return=Oe,Ke=Me;else for(;Ke!==null;){Oe=Ke;var Ce=Oe.sibling,We=Oe.return;if(nE(Oe),Oe===Ee){Ke=null;break}if(Ce!==null){Ce.return=We,Ke=Ce;break}Ke=We}}}var Qe=H.alternate;if(Qe!==null){var tt=Qe.child;if(tt!==null){Qe.child=null;do{var Gn=tt.sibling;tt.sibling=null,tt=Gn}while(tt!==null)}}Ke=H}}if((H.subtreeFlags&2064)!==0&&X!==null)X.return=H,Ke=X;else e:for(;Ke!==null;){if(H=Ke,(H.flags&2048)!==0)switch(H.tag){case 0:case 11:case 15:Ah(9,H,H.return)}var xe=H.sibling;if(xe!==null){xe.return=H.return,Ke=xe;break e}Ke=H.return}}var pe=a.current;for(Ke=pe;Ke!==null;){X=Ke;var be=X.child;if((X.subtreeFlags&2064)!==0&&be!==null)be.return=X,Ke=be;else e:for(X=pe;Ke!==null;){if(ue=Ke,(ue.flags&2048)!==0)try{switch(ue.tag){case 0:case 11:case 15:up(9,ue)}}catch(rt){Bn(ue,ue.return,rt)}if(ue===X){Ke=null;break e}var Fe=ue.sibling;if(Fe!==null){Fe.return=ue.return,Ke=Fe;break e}Ke=ue.return}}if(Kt=z,dl(),or&&typeof or.onPostCommitFiberRoot=="function")try{or.onPostCommitFiberRoot($i,a)}catch{}A=!0}return A}finally{Ct=v,bs.transition=h}}return!1}function vE(a,h,v){h=$u(v,h),h=Dw(a,h,1),a=fl(a,h,1),h=li(),a!==null&&(Lr(a,1,h),Ri(a,h))}function Bn(a,h,v){if(a.tag===3)vE(a,a,v);else for(;h!==null;){if(h.tag===3){vE(h,a,v);break}else if(h.tag===1){var A=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof A.componentDidCatch=="function"&&(pl===null||!pl.has(A))){a=$u(v,a),a=Lw(h,a,1),h=fl(h,a,1),a=li(),h!==null&&(Lr(h,1,a),Ri(h,a));break}}h=h.return}}function a5(a,h,v){var A=a.pingCache;A!==null&&A.delete(h),h=li(),a.pingedLanes|=a.suspendedLanes&v,br===a&&(Rr&v)===v&&(ur===4||ur===3&&(Rr&130023424)===Rr&&500>It()-dv?Nc(a,0):uv|=v),Ri(a,h)}function _E(a,h){h===0&&((a.mode&1)===0?h=1:(h=ho,ho<<=1,(ho&130023424)===0&&(ho=4194304)));var v=li();a=la(a,h),a!==null&&(Lr(a,h,v),Ri(a,v))}function l5(a){var h=a.memoizedState,v=0;h!==null&&(v=h.retryLane),_E(a,v)}function c5(a,h){var v=0;switch(a.tag){case 13:var A=a.stateNode,z=a.memoizedState;z!==null&&(v=z.retryLane);break;case 19:A=a.stateNode;break;default:throw Error(t(314))}A!==null&&A.delete(h),_E(a,v)}var xE;xE=function(a,h,v){if(a!==null)if(a.memoizedProps!==h.pendingProps||Ni.current)Pi=!0;else{if((a.lanes&v)===0&&(h.flags&128)===0)return Pi=!1,ZR(a,h,v);Pi=(a.flags&131072)!==0}else Pi=!1,Rn&&(h.flags&1048576)!==0&&J2(h,Gm,h.index);switch(h.lanes=0,h.tag){case 2:var A=h.type;lp(a,h),a=h.pendingProps;var z=Lu(h,Ur.current);qu(h,v),z=U0(null,h,A,a,z,v);var H=q0();return h.flags|=1,typeof z=="object"&&z!==null&&typeof z.render=="function"&&z.$$typeof===void 0?(h.tag=1,h.memoizedState=null,h.updateQueue=null,ki(A)?(H=!0,Hm(h)):H=!1,h.memoizedState=z.state!==null&&z.state!==void 0?z.state:null,M0(h),z.updater=op,h.stateNode=z,z._reactInternals=h,Y0(h,A,a,v),h=J0(null,h,A,!0,H,v)):(h.tag=0,Rn&&H&&S0(h),ai(null,h,z,v),h=h.child),h;case 16:A=h.elementType;e:{switch(lp(a,h),a=h.pendingProps,z=A._init,A=z(A._payload),h.type=A,z=h.tag=d5(A),a=Zs(A,a),z){case 0:h=X0(null,h,A,a,v);break e;case 1:h=Ww(null,h,A,a,v);break e;case 11:h=Bw(null,h,A,a,v);break e;case 14:h=Uw(null,h,A,Zs(A.type,a),v);break e}throw Error(t(306,A,""))}return h;case 0:return A=h.type,z=h.pendingProps,z=h.elementType===A?z:Zs(A,z),X0(a,h,A,z,v);case 1:return A=h.type,z=h.pendingProps,z=h.elementType===A?z:Zs(A,z),Ww(a,h,A,z,v);case 3:e:{if(Gw(h),a===null)throw Error(t(387));A=h.pendingProps,H=h.memoizedState,z=H.element,lw(a,h),Jm(h,A,null,v);var X=h.memoizedState;if(A=X.element,H.isDehydrated)if(H={element:A,isDehydrated:!1,cache:X.cache,pendingSuspenseBoundaries:X.pendingSuspenseBoundaries,transitions:X.transitions},h.updateQueue.baseState=H,h.memoizedState=H,h.flags&256){z=$u(Error(t(423)),h),h=Kw(a,h,A,v,z);break e}else if(A!==z){z=$u(Error(t(424)),h),h=Kw(a,h,A,v,z);break e}else for(Ji=_o(h.stateNode.containerInfo.firstChild),Xi=h,Rn=!0,Ys=null,v=ow(h,null,A,v),h.child=v;v;)v.flags=v.flags&-3|4096,v=v.sibling;else{if(zu(),A===z){h=ua(a,h,v);break e}ai(a,h,A,v)}h=h.child}return h;case 5:return dw(h),a===null&&N0(h),A=h.type,z=h.pendingProps,H=a!==null?a.memoizedProps:null,X=z.children,Pt(A,z)?X=null:H!==null&&Pt(A,H)&&(h.flags|=32),$w(a,h),ai(a,h,X,v),h.child;case 6:return a===null&&N0(h),null;case 13:return Yw(a,h,v);case 4:return D0(h,h.stateNode.containerInfo),A=h.pendingProps,a===null?h.child=Bu(h,null,A,v):ai(a,h,A,v),h.child;case 11:return A=h.type,z=h.pendingProps,z=h.elementType===A?z:Zs(A,z),Bw(a,h,A,z,v);case 7:return ai(a,h,h.pendingProps,v),h.child;case 8:return ai(a,h,h.pendingProps.children,v),h.child;case 12:return ai(a,h,h.pendingProps.children,v),h.child;case 10:e:{if(A=h.type._context,z=h.pendingProps,H=h.memoizedProps,X=z.value,Sn(Zm,A._currentValue),A._currentValue=X,H!==null)if(Zi(H.value,X)){if(H.children===z.children&&!Ni.current){h=ua(a,h,v);break e}}else for(H=h.child,H!==null&&(H.return=h);H!==null;){var ue=H.dependencies;if(ue!==null){X=H.child;for(var he=ue.firstContext;he!==null;){if(he.context===A){if(H.tag===1){he=ca(-1,v&-v),he.tag=2;var Ee=H.updateQueue;if(Ee!==null){Ee=Ee.shared;var Oe=Ee.pending;Oe===null?he.next=he:(he.next=Oe.next,Oe.next=he),Ee.pending=he}}H.lanes|=v,he=H.alternate,he!==null&&(he.lanes|=v),O0(H.return,v,h),ue.lanes|=v;break}he=he.next}}else if(H.tag===10)X=H.type===h.type?null:H.child;else if(H.tag===18){if(X=H.return,X===null)throw Error(t(341));X.lanes|=v,ue=X.alternate,ue!==null&&(ue.lanes|=v),O0(X,v,h),X=H.sibling}else X=H.child;if(X!==null)X.return=H;else for(X=H;X!==null;){if(X===h){X=null;break}if(H=X.sibling,H!==null){H.return=X.return,X=H;break}X=X.return}H=X}ai(a,h,z.children,v),h=h.child}return h;case 9:return z=h.type,A=h.pendingProps.children,qu(h,v),z=_s(z),A=A(z),h.flags|=1,ai(a,h,A,v),h.child;case 14:return A=h.type,z=Zs(A,h.pendingProps),z=Zs(A.type,z),Uw(a,h,A,z,v);case 15:return qw(a,h,h.type,h.pendingProps,v);case 17:return A=h.type,z=h.pendingProps,z=h.elementType===A?z:Zs(A,z),lp(a,h),h.tag=1,ki(A)?(a=!0,Hm(h)):a=!1,qu(h,v),jw(h,A,z),Y0(h,A,z,v),J0(null,h,A,!0,a,v);case 19:return Qw(a,h,v);case 22:return Hw(a,h,v)}throw Error(t(156,h.tag))};function bE(a,h){return fe(a,h)}function u5(a,h,v,A){this.tag=a,this.key=v,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=A,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ws(a,h,v,A){return new u5(a,h,v,A)}function _v(a){return a=a.prototype,!(!a||!a.isReactComponent)}function d5(a){if(typeof a=="function")return _v(a)?1:0;if(a!=null){if(a=a.$$typeof,a===D)return 11;if(a===G)return 14}return 2}function _l(a,h){var v=a.alternate;return v===null?(v=ws(a.tag,h,a.key,a.mode),v.elementType=a.elementType,v.type=a.type,v.stateNode=a.stateNode,v.alternate=a,a.alternate=v):(v.pendingProps=h,v.type=a.type,v.flags=0,v.subtreeFlags=0,v.deletions=null),v.flags=a.flags&14680064,v.childLanes=a.childLanes,v.lanes=a.lanes,v.child=a.child,v.memoizedProps=a.memoizedProps,v.memoizedState=a.memoizedState,v.updateQueue=a.updateQueue,h=a.dependencies,v.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},v.sibling=a.sibling,v.index=a.index,v.ref=a.ref,v}function _p(a,h,v,A,z,H){var X=2;if(A=a,typeof a=="function")_v(a)&&(X=1);else if(typeof a=="string")X=5;else e:switch(a){case P:return Pc(v.children,z,H,h);case k:X=8,z|=8;break;case F:return a=ws(12,v,h,z|2),a.elementType=F,a.lanes=H,a;case M:return a=ws(13,v,h,z),a.elementType=M,a.lanes=H,a;case $:return a=ws(19,v,h,z),a.elementType=$,a.lanes=H,a;case oe:return xp(v,z,H,h);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case j:X=10;break e;case O:X=9;break e;case D:X=11;break e;case G:X=14;break e;case ie:X=16,A=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return h=ws(X,v,h,z),h.elementType=a,h.type=A,h.lanes=H,h}function Pc(a,h,v,A){return a=ws(7,a,A,h),a.lanes=v,a}function xp(a,h,v,A){return a=ws(22,a,A,h),a.elementType=oe,a.lanes=v,a.stateNode={isHidden:!1},a}function xv(a,h,v){return a=ws(6,a,null,h),a.lanes=v,a}function bv(a,h,v){return h=ws(4,a.children!==null?a.children:[],a.key,h),h.lanes=v,h.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},h}function h5(a,h,v,A,z){this.tag=h,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Gi(0),this.expirationTimes=Gi(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Gi(0),this.identifierPrefix=A,this.onRecoverableError=z,this.mutableSourceEagerHydrationData=null}function wv(a,h,v,A,z,H,X,ue,he){return a=new h5(a,h,v,ue,he),h===1?(h=1,H===!0&&(h|=8)):h=0,H=ws(3,null,null,h),a.current=H,H.stateNode=a,H.memoizedState={element:A,isDehydrated:v,cache:null,transitions:null,pendingSuspenseBoundaries:null},M0(H),a}function f5(a,h,v){var A=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:B,key:A==null?null:""+A,children:a,containerInfo:h,implementation:v}}function wE(a){if(!a)return ul;a=a._reactInternals;e:{if(Ar(a)!==a||a.tag!==1)throw Error(t(170));var h=a;do{switch(h.tag){case 3:h=h.stateNode.context;break e;case 1:if(ki(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break e}}h=h.return}while(h!==null);throw Error(t(171))}if(a.tag===1){var v=a.type;if(ki(v))return Z2(a,v,h)}return h}function EE(a,h,v,A,z,H,X,ue,he){return a=wv(v,A,!0,a,z,H,X,ue,he),a.context=wE(null),v=a.current,A=li(),z=yl(v),H=ca(A,z),H.callback=h??null,fl(v,H,z),a.current.lanes=z,Lr(a,z,A),Ri(a,A),a}function bp(a,h,v,A){var z=h.current,H=li(),X=yl(z);return v=wE(v),h.context===null?h.context=v:h.pendingContext=v,h=ca(H,X),h.payload={element:a},A=A===void 0?null:A,A!==null&&(h.callback=A),a=fl(z,h,X),a!==null&&(Js(a,z,X,H),Xm(a,z,X)),X}function wp(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function TE(a,h){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var v=a.retryLane;a.retryLane=v!==0&&v<h?v:h}}function Ev(a,h){TE(a,h),(a=a.alternate)&&TE(a,h)}function m5(){return null}var SE=typeof reportError=="function"?reportError:function(a){console.error(a)};function Tv(a){this._internalRoot=a}Ep.prototype.render=Tv.prototype.render=function(a){var h=this._internalRoot;if(h===null)throw Error(t(409));bp(a,h,null,null)},Ep.prototype.unmount=Tv.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var h=a.containerInfo;Ic(function(){bp(null,a,null,null)}),h[rn]=null}};function Ep(a){this._internalRoot=a}Ep.prototype.unstable_scheduleHydration=function(a){if(a){var h=Ba();a={blockedOn:null,target:a,priority:h};for(var v=0;v<Wn.length&&h!==0&&h<Wn[v].priority;v++);Wn.splice(v,0,a),v===0&&Ua(a)}};function Sv(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Tp(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function AE(){}function p5(a,h,v,A,z){if(z){if(typeof A=="function"){var H=A;A=function(){var Ee=wp(X);H.call(Ee)}}var X=EE(h,A,a,0,null,!1,!1,"",AE);return a._reactRootContainer=X,a[rn]=X.current,sl(a.nodeType===8?a.parentNode:a),Ic(),X}for(;z=a.lastChild;)a.removeChild(z);if(typeof A=="function"){var ue=A;A=function(){var Ee=wp(he);ue.call(Ee)}}var he=wv(a,0,!1,null,null,!1,!1,"",AE);return a._reactRootContainer=he,a[rn]=he.current,sl(a.nodeType===8?a.parentNode:a),Ic(function(){bp(h,he,v,A)}),he}function Sp(a,h,v,A,z){var H=v._reactRootContainer;if(H){var X=H;if(typeof z=="function"){var ue=z;z=function(){var he=wp(X);ue.call(he)}}bp(h,X,a,z)}else X=p5(v,h,a,z,A);return wp(X)}Va=function(a){switch(a.tag){case 3:var h=a.stateNode;if(h.current.memoizedState.isDehydrated){var v=yt(h.pendingLanes);v!==0&&(Fr(h,v|1),Ri(h,It()),(Kt&6)===0&&(Ku=It()+500,dl()))}break;case 13:Ic(function(){var A=la(a,1);if(A!==null){var z=li();Js(A,a,1,z)}}),Ev(a,1)}},us=function(a){if(a.tag===13){var h=la(a,134217728);if(h!==null){var v=li();Js(h,a,134217728,v)}Ev(a,134217728)}},za=function(a){if(a.tag===13){var h=yl(a),v=la(a,h);if(v!==null){var A=li();Js(v,a,h,A)}Ev(a,h)}},Ba=function(){return Ct},$o=function(a,h){var v=Ct;try{return Ct=a,h()}finally{Ct=v}},yi=function(a,h,v){switch(h){case"input":if(Wt(a,v),h=v.name,v.type==="radio"&&h!=null){for(v=a;v.parentNode;)v=v.parentNode;for(v=v.querySelectorAll("input[name="+JSON.stringify(""+h)+'][type="radio"]'),h=0;h<v.length;h++){var A=v[h];if(A!==a&&A.form===a.form){var z=Mu(A);if(!z)throw Error(t(90));nt(A),Wt(A,z)}}}break;case"textarea":ft(a,v);break;case"select":h=v.value,h!=null&&Ve(a,!!v.multiple,h,!1)}},gn=gv,xi=Ic;var g5={usingClientEntryPoint:!1,Events:[ra,ia,Mu,_i,zo,gv]},Ph={findFiberByHostInstance:na,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},y5={bundleType:Ph.bundleType,version:Ph.version,rendererPackageName:Ph.rendererPackageName,rendererConfig:Ph.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:N.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=Uo(a),a===null?null:a.stateNode},findFiberByHostInstance:Ph.findFiberByHostInstance||m5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ap=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ap.isDisabled&&Ap.supportsFiber)try{$i=Ap.inject(y5),or=Ap}catch{}}return Oi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=g5,Oi.createPortal=function(a,h){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Sv(h))throw Error(t(200));return f5(a,h,null,v)},Oi.createRoot=function(a,h){if(!Sv(a))throw Error(t(299));var v=!1,A="",z=SE;return h!=null&&(h.unstable_strictMode===!0&&(v=!0),h.identifierPrefix!==void 0&&(A=h.identifierPrefix),h.onRecoverableError!==void 0&&(z=h.onRecoverableError)),h=wv(a,1,!1,null,null,v,!1,A,z),a[rn]=h.current,sl(a.nodeType===8?a.parentNode:a),new Tv(h)},Oi.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var h=a._reactInternals;if(h===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=Uo(h),a=a===null?null:a.stateNode,a},Oi.flushSync=function(a){return Ic(a)},Oi.hydrate=function(a,h,v){if(!Tp(h))throw Error(t(200));return Sp(null,a,h,!0,v)},Oi.hydrateRoot=function(a,h,v){if(!Sv(a))throw Error(t(405));var A=v!=null&&v.hydratedSources||null,z=!1,H="",X=SE;if(v!=null&&(v.unstable_strictMode===!0&&(z=!0),v.identifierPrefix!==void 0&&(H=v.identifierPrefix),v.onRecoverableError!==void 0&&(X=v.onRecoverableError)),h=EE(h,null,a,1,v??null,z,!1,H,X),a[rn]=h.current,sl(a),A)for(a=0;a<A.length;a++)v=A[a],z=v._getVersion,z=z(v._source),h.mutableSourceEagerHydrationData==null?h.mutableSourceEagerHydrationData=[v,z]:h.mutableSourceEagerHydrationData.push(v,z);return new Ep(h)},Oi.render=function(a,h,v){if(!Tp(h))throw Error(t(200));return Sp(null,a,h,!1,v)},Oi.unmountComponentAtNode=function(a){if(!Tp(a))throw Error(t(40));return a._reactRootContainer?(Ic(function(){Sp(null,null,a,!1,function(){a._reactRootContainer=null,a[rn]=null})}),!0):!1},Oi.unstable_batchedUpdates=gv,Oi.unstable_renderSubtreeIntoContainer=function(a,h,v,A){if(!Tp(v))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return Sp(a,h,v,!1,A)},Oi.version="18.3.1-next-f1338f8080-20240426",Oi}var jE;function Zx(){if(jE)return Nv.exports;jE=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),Nv.exports=A5(),Nv.exports}var ME;function I5(){if(ME)return Np;ME=1;var r=Zx();return Np.createRoot=r.createRoot,Np.hydrateRoot=r.hydrateRoot,Np}var N5=I5();const k5=Yx(N5),P5=()=>{};var DE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const d4=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},C5=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=r[t++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=r[t++],o=r[t++],l=r[t++],u=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(u>>10)),e[n++]=String.fromCharCode(56320+(u&1023))}else{const s=r[t++],o=r[t++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},h4={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const s=r[i],o=i+1<r.length,l=o?r[i+1]:0,u=i+2<r.length,f=u?r[i+2]:0,m=s>>2,y=(s&3)<<4|l>>4;let g=(l&15)<<2|f>>6,_=f&63;u||(_=64,o||(g=64)),n.push(t[m],t[y],t[g],t[_])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(d4(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):C5(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const s=t[r.charAt(i++)],l=i<r.length?t[r.charAt(i)]:0;++i;const f=i<r.length?t[r.charAt(i)]:64;++i;const y=i<r.length?t[r.charAt(i)]:64;if(++i,s==null||l==null||f==null||y==null)throw new R5;const g=s<<2|l>>4;if(n.push(g),f!==64){const _=l<<4&240|f>>2;if(n.push(_),y!==64){const E=f<<6&192|y;n.push(E)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class R5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const O5=function(r){const e=d4(r);return h4.encodeByteArray(e,!0)},Ag=function(r){return O5(r).replace(/\./g,"")},f4=function(r){try{return h4.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function m4(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j5=()=>m4().__FIREBASE_DEFAULTS__,M5=()=>{if(typeof process>"u"||typeof DE>"u")return;const r=DE.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},D5=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&f4(r[1]);return e&&JSON.parse(e)},by=()=>{try{return P5()||j5()||M5()||D5()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},p4=r=>{var e,t;return(t=(e=by())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[r]},g4=r=>{const e=p4(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},y4=()=>{var r;return(r=by())===null||r===void 0?void 0:r.config},v4=r=>{var e;return(e=by())===null||e===void 0?void 0:e[`_${r}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pu(r){return r.endsWith(".cloudworkstations.dev")}async function Qx(r){return(await fetch(r,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function F5(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",i=r.iat||0,s=r.sub||r.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},r);return[Ag(JSON.stringify(t)),Ag(JSON.stringify(o)),""].join(".")}const vf={};function V5(){const r={prod:[],emulator:[]};for(const e of Object.keys(vf))vf[e]?r.emulator.push(e):r.prod.push(e);return r}function z5(r){let e=document.getElementById(r),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",r),t=!0),{created:t,element:e}}let LE=!1;function Xx(r,e){if(typeof window>"u"||typeof document>"u"||!pu(window.location.host)||vf[r]===e||vf[r]||LE)return;vf[r]=e;function t(g){return`__firebase__banner__${g}`}const n="__firebase__banner",s=V5().prod.length>0;function o(){const g=document.getElementById(n);g&&g.remove()}function l(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function u(g,_){g.setAttribute("width","24"),g.setAttribute("id",_),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function f(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{LE=!0,o()},g}function m(g,_){g.setAttribute("id",_),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function y(){const g=z5(n),_=t("text"),E=document.getElementById(_)||document.createElement("span"),x=t("learnmore"),w=document.getElementById(x)||document.createElement("a"),S=t("preprendIcon"),I=document.getElementById(S)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const C=g.element;l(C),m(w,x);const N=f();u(I,S),C.append(I,E,w,N),document.body.appendChild(C)}s?(E.innerText="Preview backend disconnected.",I.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(I.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function B5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(mr())}function _4(){var r;const e=(r=by())===null||r===void 0?void 0:r.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function U5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function q5(){const r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function H5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function $5(){const r=mr();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}function x4(){return!_4()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function b4(){return!_4()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function w4(){try{return typeof indexedDB=="object"}catch{return!1}}function W5(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G5="FirebaseError";class Lo extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=G5,Object.setPrototypeOf(this,Lo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,lm.prototype.create)}}class lm{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?K5(s,n):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new Lo(i,l,n)}}function K5(r,e){return r.replace(Y5,(t,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const Y5=/\{\$([^}]+)}/g;function Z5(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}function Ul(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const s=r[i],o=e[i];if(FE(s)&&FE(o)){if(!Ul(s,o))return!1}else if(s!==o)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function FE(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cm(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function tf(r){const e={};return r.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,s]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function nf(r){const e=r.indexOf("?");if(!e)return"";const t=r.indexOf("#",e);return r.substring(e,t>0?t:void 0)}function Q5(r,e){const t=new X5(r,e);return t.subscribe.bind(t)}class X5{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");J5(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:n},i.next===void 0&&(i.next=Cv),i.error===void 0&&(i.error=Cv),i.complete===void 0&&(i.complete=Cv);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function J5(r,e){if(typeof r!="object"||r===null)return!1;for(const t of e)if(t in r&&typeof r[t]=="function")return!0;return!1}function Cv(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Pn(r){return r&&r._delegate?r._delegate:r}class ql{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mc="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class e7{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new L5;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(n7(e))try{this.getOrInitializeService({instanceIdentifier:Mc})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Mc){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Mc){return this.instances.has(e)}getOptions(e=Mc){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);n===l&&o.resolve(i)}return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:t7(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Mc){return this.component?this.component.multipleInstances?e:Mc:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function t7(r){return r===Mc?void 0:r}function n7(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r7{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new e7(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bt;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(Bt||(Bt={}));const i7={debug:Bt.DEBUG,verbose:Bt.VERBOSE,info:Bt.INFO,warn:Bt.WARN,error:Bt.ERROR,silent:Bt.SILENT},s7=Bt.INFO,o7={[Bt.DEBUG]:"log",[Bt.VERBOSE]:"log",[Bt.INFO]:"info",[Bt.WARN]:"warn",[Bt.ERROR]:"error"},a7=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),i=o7[e];if(i)console[i](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Jx{constructor(e){this.name=e,this._logLevel=s7,this._logHandler=a7,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Bt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?i7[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Bt.DEBUG,...e),this._logHandler(this,Bt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Bt.VERBOSE,...e),this._logHandler(this,Bt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Bt.INFO,...e),this._logHandler(this,Bt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Bt.WARN,...e),this._logHandler(this,Bt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Bt.ERROR,...e),this._logHandler(this,Bt.ERROR,...e)}}const l7=(r,e)=>e.some(t=>r instanceof t);let VE,zE;function c7(){return VE||(VE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function u7(){return zE||(zE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const E4=new WeakMap,Q_=new WeakMap,T4=new WeakMap,Rv=new WeakMap,eb=new WeakMap;function d7(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",o)},s=()=>{t(Dl(r.result)),i()},o=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&E4.set(t,r)}).catch(()=>{}),eb.set(e,r),e}function h7(r){if(Q_.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",o),r.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",o),r.addEventListener("abort",o)});Q_.set(r,e)}let X_={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return Q_.get(r);if(e==="objectStoreNames")return r.objectStoreNames||T4.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Dl(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function f7(r){X_=r(X_)}function m7(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(Ov(this),e,...t);return T4.set(n,e.sort?e.sort():[e]),Dl(n)}:u7().includes(r)?function(...e){return r.apply(Ov(this),e),Dl(E4.get(this))}:function(...e){return Dl(r.apply(Ov(this),e))}}function p7(r){return typeof r=="function"?m7(r):(r instanceof IDBTransaction&&h7(r),l7(r,c7())?new Proxy(r,X_):r)}function Dl(r){if(r instanceof IDBRequest)return d7(r);if(Rv.has(r))return Rv.get(r);const e=p7(r);return e!==r&&(Rv.set(r,e),eb.set(e,r)),e}const Ov=r=>eb.get(r);function g7(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const o=indexedDB.open(r,e),l=Dl(o);return n&&o.addEventListener("upgradeneeded",u=>{n(Dl(o.result),u.oldVersion,u.newVersion,Dl(o.transaction),u)}),t&&o.addEventListener("blocked",u=>t(u.oldVersion,u.newVersion,u)),l.then(u=>{s&&u.addEventListener("close",()=>s()),i&&u.addEventListener("versionchange",f=>i(f.oldVersion,f.newVersion,f))}).catch(()=>{}),l}const y7=["get","getKey","getAll","getAllKeys","count"],v7=["put","add","delete","clear"],jv=new Map;function BE(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(jv.get(e))return jv.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=v7.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||y7.includes(t)))return;const s=async function(o,...l){const u=this.transaction(o,i?"readwrite":"readonly");let f=u.store;return n&&(f=f.index(l.shift())),(await Promise.all([f[t](...l),i&&u.done]))[0]};return jv.set(e,s),s}f7(r=>({...r,get:(e,t,n)=>BE(e,t)||r.get(e,t,n),has:(e,t)=>!!BE(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _7{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(x7(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function x7(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const J_="@firebase/app",UE="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ea=new Jx("@firebase/app"),b7="@firebase/app-compat",w7="@firebase/analytics-compat",E7="@firebase/analytics",T7="@firebase/app-check-compat",S7="@firebase/app-check",A7="@firebase/auth",I7="@firebase/auth-compat",N7="@firebase/database",k7="@firebase/data-connect",P7="@firebase/database-compat",C7="@firebase/functions",R7="@firebase/functions-compat",O7="@firebase/installations",j7="@firebase/installations-compat",M7="@firebase/messaging",D7="@firebase/messaging-compat",L7="@firebase/performance",F7="@firebase/performance-compat",V7="@firebase/remote-config",z7="@firebase/remote-config-compat",B7="@firebase/storage",U7="@firebase/storage-compat",q7="@firebase/firestore",H7="@firebase/ai",$7="@firebase/firestore-compat",W7="firebase",G7="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ex="[DEFAULT]",K7={[J_]:"fire-core",[b7]:"fire-core-compat",[E7]:"fire-analytics",[w7]:"fire-analytics-compat",[S7]:"fire-app-check",[T7]:"fire-app-check-compat",[A7]:"fire-auth",[I7]:"fire-auth-compat",[N7]:"fire-rtdb",[k7]:"fire-data-connect",[P7]:"fire-rtdb-compat",[C7]:"fire-fn",[R7]:"fire-fn-compat",[O7]:"fire-iid",[j7]:"fire-iid-compat",[M7]:"fire-fcm",[D7]:"fire-fcm-compat",[L7]:"fire-perf",[F7]:"fire-perf-compat",[V7]:"fire-rc",[z7]:"fire-rc-compat",[B7]:"fire-gcs",[U7]:"fire-gcs-compat",[q7]:"fire-fst",[$7]:"fire-fst-compat",[H7]:"fire-vertex","fire-js":"fire-js",[W7]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jf=new Map,Y7=new Map,tx=new Map;function qE(r,e){try{r.container.addComponent(e)}catch(t){Ea.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function Xc(r){const e=r.name;if(tx.has(e))return Ea.debug(`There were multiple attempts to register component ${e}.`),!1;tx.set(e,r);for(const t of jf.values())qE(t,r);for(const t of Y7.values())qE(t,r);return!0}function wy(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function ui(r){return r==null?!1:r.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Ll=new lm("app","Firebase",Z7);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q7{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new ql("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Ll.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ud=G7;function S4(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n=Object.assign({name:ex,automaticDataCollectionEnabled:!0},e),i=n.name;if(typeof i!="string"||!i)throw Ll.create("bad-app-name",{appName:String(i)});if(t||(t=y4()),!t)throw Ll.create("no-options");const s=jf.get(i);if(s){if(Ul(t,s.options)&&Ul(n,s.config))return s;throw Ll.create("duplicate-app",{appName:i})}const o=new r7(i);for(const u of tx.values())o.addComponent(u);const l=new Q7(t,n,o);return jf.set(i,l),l}function Ey(r=ex){const e=jf.get(r);if(!e&&r===ex&&y4())return S4();if(!e)throw Ll.create("no-app",{appName:r});return e}function X7(){return Array.from(jf.values())}function Co(r,e,t){var n;let i=(n=K7[r])!==null&&n!==void 0?n:r;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ea.warn(l.join(" "));return}Xc(new ql(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J7="firebase-heartbeat-database",eO=1,Mf="firebase-heartbeat-store";let Mv=null;function A4(){return Mv||(Mv=g7(J7,eO,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(Mf)}catch(t){console.warn(t)}}}}).catch(r=>{throw Ll.create("idb-open",{originalErrorMessage:r.message})})),Mv}async function tO(r){try{const t=(await A4()).transaction(Mf),n=await t.objectStore(Mf).get(I4(r));return await t.done,n}catch(e){if(e instanceof Lo)Ea.warn(e.message);else{const t=Ll.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ea.warn(t.message)}}}async function HE(r,e){try{const n=(await A4()).transaction(Mf,"readwrite");await n.objectStore(Mf).put(e,I4(r)),await n.done}catch(t){if(t instanceof Lo)Ea.warn(t.message);else{const n=Ll.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Ea.warn(n.message)}}}function I4(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nO=1024,rO=30;class iO{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new oO(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=$E();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>rO){const o=aO(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Ea.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=$E(),{heartbeatsToSend:n,unsentEntries:i}=sO(this._heartbeatsCache.heartbeats),s=Ag(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Ea.warn(t),""}}}function $E(){return new Date().toISOString().substring(0,10)}function sO(r,e=nO){const t=[];let n=r.slice();for(const i of r){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),WE(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),WE(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class oO{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return w4()?W5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await tO(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return HE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return HE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function WE(r){return Ag(JSON.stringify({version:2,heartbeats:r})).length}function aO(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let n=1;n<r.length;n++)r[n].date<t&&(t=r[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lO(r){Xc(new ql("platform-logger",e=>new _7(e),"PRIVATE")),Xc(new ql("heartbeat",e=>new iO(e),"PRIVATE")),Co(J_,UE,r),Co(J_,UE,"esm2017"),Co("fire-js","")}lO("");function tb(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t}function N4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const cO=N4,k4=new lm("auth","Firebase",N4());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ig=new Jx("@firebase/auth");function uO(r,...e){Ig.logLevel<=Bt.WARN&&Ig.warn(`Auth (${Ud}): ${r}`,...e)}function rg(r,...e){Ig.logLevel<=Bt.ERROR&&Ig.error(`Auth (${Ud}): ${r}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Is(r,...e){throw rb(r,...e)}function oo(r,...e){return rb(r,...e)}function nb(r,e,t){const n=Object.assign(Object.assign({},cO()),{[e]:t});return new lm("auth","Firebase",n).create(e,{appName:r.name})}function Ro(r){return nb(r,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function dO(r,e,t){const n=t;if(!(e instanceof n))throw n.name!==e.constructor.name&&Is(r,"argument-error"),nb(r,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function rb(r,...e){if(typeof r!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return k4.create(r,...e)}function ot(r,e,...t){if(!r)throw rb(e,...t)}function va(r){const e="INTERNAL ASSERTION FAILED: "+r;throw rg(e),new Error(e)}function Ta(r,e){r||va(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ng(){var r;return typeof self<"u"&&((r=self.location)===null||r===void 0?void 0:r.href)||""}function hO(){return GE()==="http:"||GE()==="https:"}function GE(){var r;return typeof self<"u"&&((r=self.location)===null||r===void 0?void 0:r.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function fO(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(hO()||q5()||"connection"in navigator)?navigator.onLine:!0}function mO(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class um{constructor(e,t){this.shortDelay=e,this.longDelay=t,Ta(t>e,"Short delay should be less than long delay!"),this.isMobile=B5()||H5()}get(){return fO()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ib(r,e){Ta(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P4{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;va("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;va("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;va("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pO={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gO=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],yO=new um(3e4,6e4);function Pa(r,e){return r.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:r.tenantId}):e}async function Ca(r,e,t,n,i={}){return C4(r,i,async()=>{let s={},o={};n&&(e==="GET"?o=n:s={body:JSON.stringify(n)});const l=cm(Object.assign({key:r.config.apiKey},o)).slice(1),u=await r._getAdditionalHeaders();u["Content-Type"]="application/json",r.languageCode&&(u["X-Firebase-Locale"]=r.languageCode);const f=Object.assign({method:e,headers:u},s);return U5()||(f.referrerPolicy="no-referrer"),r.emulatorConfig&&pu(r.emulatorConfig.host)&&(f.credentials="include"),P4.fetch()(await R4(r,r.config.apiHost,t,l),f)})}async function C4(r,e,t){r._canInitEmulator=!1;const n=Object.assign(Object.assign({},pO),e);try{const i=new _O(r),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw kp(r,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[u,f]=l.split(" : ");if(u==="FEDERATED_USER_ID_ALREADY_LINKED")throw kp(r,"credential-already-in-use",o);if(u==="EMAIL_EXISTS")throw kp(r,"email-already-in-use",o);if(u==="USER_DISABLED")throw kp(r,"user-disabled",o);const m=n[u]||u.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw nb(r,m,f);Is(r,m)}}catch(i){if(i instanceof Lo)throw i;Is(r,"network-request-failed",{message:String(i)})}}async function dm(r,e,t,n,i={}){const s=await Ca(r,e,t,n,i);return"mfaPendingCredential"in s&&Is(r,"multi-factor-auth-required",{_serverResponse:s}),s}async function R4(r,e,t,n){const i=`${e}${t}?${n}`,s=r,o=s.config.emulator?ib(r.config,i):`${r.config.apiScheme}://${i}`;return gO.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function vO(r){switch(r){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class _O{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(oo(this.auth,"network-request-failed")),yO.get())})}}function kp(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const i=oo(r,e,n);return i.customData._tokenResponse=t,i}function KE(r){return r!==void 0&&r.enterprise!==void 0}class xO{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return vO(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function bO(r,e){return Ca(r,"GET","/v2/recaptchaConfig",Pa(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wO(r,e){return Ca(r,"POST","/v1/accounts:delete",e)}async function kg(r,e){return Ca(r,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _f(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function EO(r,e=!1){const t=Pn(r),n=await t.getIdToken(e),i=sb(n);ot(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:_f(Dv(i.auth_time)),issuedAtTime:_f(Dv(i.iat)),expirationTime:_f(Dv(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Dv(r){return Number(r)*1e3}function sb(r){const[e,t,n]=r.split(".");if(e===void 0||t===void 0||n===void 0)return rg("JWT malformed, contained fewer than 3 sections"),null;try{const i=f4(t);return i?JSON.parse(i):(rg("Failed to decode base64 JWT payload"),null)}catch(i){return rg("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function YE(r){const e=sb(r);return ot(e,"internal-error"),ot(typeof e.exp<"u","internal-error"),ot(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Df(r,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof Lo&&TO(n)&&r.auth.currentUser===r&&await r.auth.signOut(),n}}function TO({code:r}){return r==="auth/user-disabled"||r==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SO{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nx{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=_f(this.lastLoginAt),this.creationTime=_f(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Pg(r){var e;const t=r.auth,n=await r.getIdToken(),i=await Df(r,kg(t,{idToken:n}));ot(i==null?void 0:i.users.length,t,"internal-error");const s=i.users[0];r._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?O4(s.providerUserInfo):[],l=IO(r.providerData,o),u=r.isAnonymous,f=!(r.email&&s.passwordHash)&&!(l!=null&&l.length),m=u?f:!1,y={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new nx(s.createdAt,s.lastLoginAt),isAnonymous:m};Object.assign(r,y)}async function AO(r){const e=Pn(r);await Pg(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function IO(r,e){return[...r.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function O4(r){return r.map(e=>{var{providerId:t}=e,n=tb(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function NO(r,e){const t=await C4(r,{},async()=>{const n=cm({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=r.config,o=await R4(r,i,"/v1/token",`key=${s}`),l=await r._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const u={method:"POST",headers:l,body:n};return r.emulatorConfig&&pu(r.emulatorConfig.host)&&(u.credentials="include"),P4.fetch()(o,u)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function kO(r,e){return Ca(r,"POST","/v2/accounts:revokeToken",Pa(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fd{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){ot(e.idToken,"internal-error"),ot(typeof e.idToken<"u","internal-error"),ot(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):YE(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){ot(e.length!==0,"internal-error");const t=YE(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(ot(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:s}=await NO(e,t);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:s}=t,o=new fd;return n&&(ot(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),i&&(ot(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(ot(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new fd,this.toJSON())}_performRefresh(){return va("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bl(r,e){ot(typeof r=="string"||typeof r>"u","internal-error",{appName:e})}class so{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,s=tb(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new SO(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new nx(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Df(this,this.stsTokenManager.getToken(this.auth,e));return ot(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return EO(this,e)}reload(){return AO(this)}_assign(e){this!==e&&(ot(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new so(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){ot(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Pg(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ui(this.auth.app))return Promise.reject(Ro(this.auth));const e=await this.getIdToken();return await Df(this,wO(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,s,o,l,u,f,m;const y=(n=t.displayName)!==null&&n!==void 0?n:void 0,g=(i=t.email)!==null&&i!==void 0?i:void 0,_=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,E=(o=t.photoURL)!==null&&o!==void 0?o:void 0,x=(l=t.tenantId)!==null&&l!==void 0?l:void 0,w=(u=t._redirectEventId)!==null&&u!==void 0?u:void 0,S=(f=t.createdAt)!==null&&f!==void 0?f:void 0,I=(m=t.lastLoginAt)!==null&&m!==void 0?m:void 0,{uid:C,emailVerified:N,isAnonymous:R,providerData:B,stsTokenManager:P}=t;ot(C&&P,e,"internal-error");const k=fd.fromJSON(this.name,P);ot(typeof C=="string",e,"internal-error"),bl(y,e.name),bl(g,e.name),ot(typeof N=="boolean",e,"internal-error"),ot(typeof R=="boolean",e,"internal-error"),bl(_,e.name),bl(E,e.name),bl(x,e.name),bl(w,e.name),bl(S,e.name),bl(I,e.name);const F=new so({uid:C,auth:e,email:g,emailVerified:N,displayName:y,isAnonymous:R,photoURL:E,phoneNumber:_,tenantId:x,stsTokenManager:k,createdAt:S,lastLoginAt:I});return B&&Array.isArray(B)&&(F.providerData=B.map(j=>Object.assign({},j))),w&&(F._redirectEventId=w),F}static async _fromIdTokenResponse(e,t,n=!1){const i=new fd;i.updateFromServerResponse(t);const s=new so({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Pg(s),s}static async _fromGetAccountInfoResponse(e,t,n){const i=t.users[0];ot(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?O4(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),l=new fd;l.updateFromIdToken(n);const u=new so({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:o}),f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new nx(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(u,f),u}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZE=new Map;function _a(r){Ta(r instanceof Function,"Expected a class definition");let e=ZE.get(r);return e?(Ta(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,ZE.set(r,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}j4.type="NONE";const QE=j4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ig(r,e,t){return`firebase:${r}:${e}:${t}`}class md{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=ig(this.userKey,i.apiKey,s),this.fullPersistenceKey=ig("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await kg(this.auth,{idToken:e}).catch(()=>{});return t?so._fromGetAccountInfoResponse(this.auth,t,e):null}return so._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new md(_a(QE),e,n);const i=(await Promise.all(t.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f);let s=i[0]||_a(QE);const o=ig(n,e.config.apiKey,e.name);let l=null;for(const f of t)try{const m=await f._get(o);if(m){let y;if(typeof m=="string"){const g=await kg(e,{idToken:m}).catch(()=>{});if(!g)break;y=await so._fromGetAccountInfoResponse(e,g,m)}else y=so._fromJSON(e,m);f!==s&&(l=y),s=f;break}}catch{}const u=i.filter(f=>f._shouldAllowMigration);return!s._shouldAllowMigration||!u.length?new md(s,e,n):(s=u[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async f=>{if(f!==s)try{await f._remove(o)}catch{}})),new md(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XE(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(F4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(M4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(z4(e))return"Blackberry";if(B4(e))return"Webos";if(D4(e))return"Safari";if((e.includes("chrome/")||L4(e))&&!e.includes("edge/"))return"Chrome";if(V4(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=r.match(t);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function M4(r=mr()){return/firefox\//i.test(r)}function D4(r=mr()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function L4(r=mr()){return/crios\//i.test(r)}function F4(r=mr()){return/iemobile/i.test(r)}function V4(r=mr()){return/android/i.test(r)}function z4(r=mr()){return/blackberry/i.test(r)}function B4(r=mr()){return/webos/i.test(r)}function ob(r=mr()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function PO(r=mr()){var e;return ob(r)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function CO(){return $5()&&document.documentMode===10}function U4(r=mr()){return ob(r)||V4(r)||B4(r)||z4(r)||/windows phone/i.test(r)||F4(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function q4(r,e=[]){let t;switch(r){case"Browser":t=XE(mr());break;case"Worker":t=`${XE(mr())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Ud}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RO{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=s=>new Promise((o,l)=>{try{const u=e(s);o(u)}catch(u){l(u)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function OO(r,e={}){return Ca(r,"GET","/v2/passwordPolicy",Pa(r,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jO=6;class MO{constructor(e){var t,n,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:jO,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,i,s,o,l;const u={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,u),this.validatePasswordCharacterOptions(e,u),u.isValid&&(u.isValid=(t=u.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),u.isValid&&(u.isValid=(n=u.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),u.isValid&&(u.isValid=(i=u.containsLowercaseLetter)!==null&&i!==void 0?i:!0),u.isValid&&(u.isValid=(s=u.containsUppercaseLetter)!==null&&s!==void 0?s:!0),u.isValid&&(u.isValid=(o=u.containsNumericCharacter)!==null&&o!==void 0?o:!0),u.isValid&&(u.isValid=(l=u.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),u}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DO{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new JE(this),this.idTokenSubscription=new JE(this),this.beforeStateQueue=new RO(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=k4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=_a(t)),this._initializationPromise=this.queue(async()=>{var n,i,s;if(!this._deleted&&(this.persistenceManager=await md.create(this,e),(n=this._resolvePersistenceManagerAvailable)===null||n===void 0||n.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await kg(this,{idToken:e}),n=await so._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(ui(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,l=i==null?void 0:i._redirectEventId,u=await this.tryRedirectSignIn(e);(!o||o===l)&&(u!=null&&u.user)&&(i=u.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return ot(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Pg(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=mO()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ui(this.app))return Promise.reject(Ro(this));const t=e?Pn(e):null;return t&&ot(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&ot(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ui(this.app)?Promise.reject(Ro(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ui(this.app)?Promise.reject(Ro(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(_a(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await OO(this),t=new MO(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new lm("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await kO(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&_a(e)||this._popupRedirectResolver;ot(t,this,"argument-error"),this.redirectPersistenceManager=await md.create(this,[_a(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(ot(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const u=e.addObserver(t,n,i);return()=>{o=!0,u()}}else{const u=e.addObserver(t);return()=>{o=!0,u()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return ot(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=q4(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;if(ui(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&uO(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function Fo(r){return Pn(r)}class JE{constructor(e){this.auth=e,this.observer=null,this.addObserver=Q5(t=>this.observer=t)}get next(){return ot(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ty={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function LO(r){Ty=r}function H4(r){return Ty.loadJS(r)}function FO(){return Ty.recaptchaEnterpriseScript}function VO(){return Ty.gapiScript}function zO(r){return`__${r}${Math.floor(Math.random()*1e6)}`}class BO{constructor(){this.enterprise=new UO}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class UO{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const qO="recaptcha-enterprise",$4="NO_RECAPTCHA";class HO{constructor(e){this.type=qO,this.auth=Fo(e)}async verify(e="verify",t=!1){async function n(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,l)=>{bO(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(u=>{if(u.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const f=new xO(u);return s.tenantId==null?s._agentRecaptchaConfig=f:s._tenantRecaptchaConfigs[s.tenantId]=f,o(f.siteKey)}}).catch(u=>{l(u)})})}function i(s,o,l){const u=window.grecaptcha;KE(u)?u.enterprise.ready(()=>{u.enterprise.execute(s,{action:e}).then(f=>{o(f)}).catch(()=>{o($4)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new BO().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{n(this.auth).then(l=>{if(!t&&KE(window.grecaptcha))i(l,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let u=FO();u.length!==0&&(u+=l),H4(u).then(()=>{i(l,s,o)}).catch(f=>{o(f)})}}).catch(l=>{o(l)})})}}async function eT(r,e,t,n=!1,i=!1){const s=new HO(r);let o;if(i)o=$4;else try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}const l=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const u=l.phoneEnrollmentInfo.phoneNumber,f=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:u,recaptchaToken:f,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const u=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return n?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function Lf(r,e,t,n,i){var s;if(!((s=r._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await eT(r,e,t,t==="getOobCode");return n(r,o)}else return n(r,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await eT(r,e,t,t==="getOobCode");return n(r,l)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $O(r,e){const t=wy(r,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(Ul(s,e??{}))return i;Is(i,"already-initialized")}return t.initialize({options:e})}function WO(r,e){const t=(e==null?void 0:e.persistence)||[],n=(Array.isArray(t)?t:[t]).map(_a);e!=null&&e.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function GO(r,e,t){const n=Fo(r);ot(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=W4(e),{host:o,port:l}=KO(e),u=l===null?"":`:${l}`,f={url:`${s}//${o}${u}/`},m=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){ot(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),ot(Ul(f,n.config.emulator)&&Ul(m,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=f,n.emulatorConfig=m,n.settings.appVerificationDisabledForTesting=!0,pu(o)?(Qx(`${s}//${o}${u}`),Xx("Auth",!0)):YO()}function W4(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function KO(r){const e=W4(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:tT(n.substr(s.length+1))}}else{const[s,o]=n.split(":");return{host:s,port:tT(o)}}}function tT(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}function YO(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",r):r())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ab{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return va("not implemented")}_getIdTokenResponse(e){return va("not implemented")}_linkToIdToken(e,t){return va("not implemented")}_getReauthenticationResolver(e){return va("not implemented")}}async function ZO(r,e){return Ca(r,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function QO(r,e){return dm(r,"POST","/v1/accounts:signInWithPassword",Pa(r,e))}async function G4(r,e){return Ca(r,"POST","/v1/accounts:sendOobCode",Pa(r,e))}async function XO(r,e){return G4(r,e)}async function JO(r,e){return G4(r,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ej(r,e){return dm(r,"POST","/v1/accounts:signInWithEmailLink",Pa(r,e))}async function tj(r,e){return dm(r,"POST","/v1/accounts:signInWithEmailLink",Pa(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ff extends ab{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Ff(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Ff(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Lf(e,t,"signInWithPassword",QO);case"emailLink":return ej(e,{email:this._email,oobCode:this._password});default:Is(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Lf(e,n,"signUpPassword",ZO);case"emailLink":return tj(e,{idToken:t,email:this._email,oobCode:this._password});default:Is(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pd(r,e){return dm(r,"POST","/v1/accounts:signInWithIdp",Pa(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nj="http://localhost";class Jc extends ab{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Jc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Is("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,s=tb(t,["providerId","signInMethod"]);if(!n||!i)return null;const o=new Jc(n,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return pd(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,pd(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,pd(e,t)}buildRequest(){const e={requestUri:nj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=cm(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rj(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function ij(r){const e=tf(nf(r)).link,t=e?tf(nf(e)).deep_link_id:null,n=tf(nf(r)).deep_link_id;return(n?tf(nf(n)).link:null)||n||t||e||r}class Sy{constructor(e){var t,n,i,s,o,l;const u=tf(nf(e)),f=(t=u.apiKey)!==null&&t!==void 0?t:null,m=(n=u.oobCode)!==null&&n!==void 0?n:null,y=rj((i=u.mode)!==null&&i!==void 0?i:null);ot(f&&m&&y,"argument-error"),this.apiKey=f,this.operation=y,this.code=m,this.continueUrl=(s=u.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=u.lang)!==null&&o!==void 0?o:null,this.tenantId=(l=u.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const t=ij(e);try{return new Sy(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(){this.providerId=gu.PROVIDER_ID}static credential(e,t){return Ff._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Sy.parseLink(t);return ot(n,"argument-error"),Ff._fromEmailAndCode(e,n.code,n.tenantId)}}gu.PROVIDER_ID="password";gu.EMAIL_PASSWORD_SIGN_IN_METHOD="password";gu.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lb{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hm extends lb{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Al extends hm{constructor(){super("facebook.com")}static credential(e){return Jc._fromParams({providerId:Al.PROVIDER_ID,signInMethod:Al.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Al.credentialFromTaggedObject(e)}static credentialFromError(e){return Al.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Al.credential(e.oauthAccessToken)}catch{return null}}}Al.FACEBOOK_SIGN_IN_METHOD="facebook.com";Al.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya extends hm{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Jc._fromParams({providerId:ya.PROVIDER_ID,signInMethod:ya.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return ya.credentialFromTaggedObject(e)}static credentialFromError(e){return ya.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return ya.credential(t,n)}catch{return null}}}ya.GOOGLE_SIGN_IN_METHOD="google.com";ya.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Il extends hm{constructor(){super("github.com")}static credential(e){return Jc._fromParams({providerId:Il.PROVIDER_ID,signInMethod:Il.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Il.credentialFromTaggedObject(e)}static credentialFromError(e){return Il.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Il.credential(e.oauthAccessToken)}catch{return null}}}Il.GITHUB_SIGN_IN_METHOD="github.com";Il.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nl extends hm{constructor(){super("twitter.com")}static credential(e,t){return Jc._fromParams({providerId:Nl.PROVIDER_ID,signInMethod:Nl.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Nl.credentialFromTaggedObject(e)}static credentialFromError(e){return Nl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Nl.credential(t,n)}catch{return null}}}Nl.TWITTER_SIGN_IN_METHOD="twitter.com";Nl.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sj(r,e){return dm(r,"POST","/v1/accounts:signUp",Pa(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const s=await so._fromIdTokenResponse(e,n,i),o=nT(n);return new eu({user:s,providerId:o,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=nT(n);return new eu({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function nT(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cg extends Lo{constructor(e,t,n,i){var s;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Cg.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new Cg(e,t,n,i)}}function K4(r,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Cg._fromErrorAndOperation(r,s,e,n):s})}async function oj(r,e,t=!1){const n=await Df(r,e._linkToIdToken(r.auth,await r.getIdToken()),t);return eu._forOperation(r,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function aj(r,e,t=!1){const{auth:n}=r;if(ui(n.app))return Promise.reject(Ro(n));const i="reauthenticate";try{const s=await Df(r,K4(n,i,e,r),t);ot(s.idToken,n,"internal-error");const o=sb(s.idToken);ot(o,n,"internal-error");const{sub:l}=o;return ot(r.uid===l,n,"user-mismatch"),eu._forOperation(r,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Is(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Y4(r,e,t=!1){if(ui(r.app))return Promise.reject(Ro(r));const n="signIn",i=await K4(r,n,e),s=await eu._fromIdTokenResponse(r,n,i);return t||await r._updateCurrentUser(s.user),s}async function Z4(r,e){return Y4(Fo(r),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lj(r,e,t){var n;ot(((n=t.url)===null||n===void 0?void 0:n.length)>0,r,"invalid-continue-uri"),ot(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,r,"invalid-dynamic-link-domain"),ot(typeof t.linkDomain>"u"||t.linkDomain.length>0,r,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(ot(t.iOS.bundleId.length>0,r,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(ot(t.android.packageName.length>0,r,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q4(r){const e=Fo(r);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function cj(r,e,t){const n=Fo(r);await Lf(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",XO)}async function uj(r,e,t){if(ui(r.app))return Promise.reject(Ro(r));const n=Fo(r),o=await Lf(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",sj).catch(u=>{throw u.code==="auth/password-does-not-meet-requirements"&&Q4(r),u}),l=await eu._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(l.user),l}function dj(r,e,t){return ui(r.app)?Promise.reject(Ro(r)):Z4(Pn(r),gu.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&Q4(r),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hj(r,e,t){const n=Fo(r),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,l){ot(l.handleCodeInApp,n,"argument-error"),l&&lj(n,o,l)}s(i,t),await Lf(n,i,"getOobCode",JO)}function X4(r,e){const t=Sy.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function fj(r,e,t){if(ui(r.app))return Promise.reject(Ro(r));const n=Pn(r),i=gu.credentialWithLink(e,t||Ng());return ot(i._tenantId===(n.tenantId||null),n,"tenant-id-mismatch"),Z4(n,i)}function mj(r,e,t,n){return Pn(r).onIdTokenChanged(e,t,n)}function pj(r,e,t){return Pn(r).beforeAuthStateChanged(e,t)}function gj(r,e,t,n){return Pn(r).onAuthStateChanged(e,t,n)}function yj(r){return Pn(r).signOut()}const Rg="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J4{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(Rg,"1"),this.storage.removeItem(Rg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vj=1e3,_j=10;class ek extends J4{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=U4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,u)=>{this.notifyListeners(o,u)});return}const n=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(n);!t&&this.localCache[n]===o||this.notifyListeners(n,o)},s=this.storage.getItem(n);CO()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,_j):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},vj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}ek.type="LOCAL";const xj=ek;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tk extends J4{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}tk.type="SESSION";const nk=tk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bj(r){return Promise.all(r.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ay{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const n=new Ay(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const l=Array.from(o).map(async f=>f(t.origin,s)),u=await bj(l);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:u})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Ay.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cb(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return r+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wj{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((l,u)=>{const f=cb("",20);i.port1.start();const m=setTimeout(()=>{u(new Error("unsupported_event"))},n);o={messageChannel:i,onMessage(y){const g=y;if(g.data.eventId===f)switch(g.data.status){case"ack":clearTimeout(m),s=setTimeout(()=>{u(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(g.data.response);break;default:clearTimeout(m),clearTimeout(s),u(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:f,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oo(){return window}function Ej(r){Oo().location.href=r}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rk(){return typeof Oo().WorkerGlobalScope<"u"&&typeof Oo().importScripts=="function"}async function Tj(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Sj(){var r;return((r=navigator==null?void 0:navigator.serviceWorker)===null||r===void 0?void 0:r.controller)||null}function Aj(){return rk()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ik="firebaseLocalStorageDb",Ij=1,Og="firebaseLocalStorage",sk="fbase_key";class fm{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Iy(r,e){return r.transaction([Og],e?"readwrite":"readonly").objectStore(Og)}function Nj(){const r=indexedDB.deleteDatabase(ik);return new fm(r).toPromise()}function rx(){const r=indexedDB.open(ik,Ij);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(Og,{keyPath:sk})}catch(i){t(i)}}),r.addEventListener("success",async()=>{const n=r.result;n.objectStoreNames.contains(Og)?e(n):(n.close(),await Nj(),e(await rx()))})})}async function rT(r,e,t){const n=Iy(r,!0).put({[sk]:e,value:t});return new fm(n).toPromise()}async function kj(r,e){const t=Iy(r,!1).get(e),n=await new fm(t).toPromise();return n===void 0?null:n.value}function iT(r,e){const t=Iy(r,!0).delete(e);return new fm(t).toPromise()}const Pj=800,Cj=3;class ok{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await rx(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>Cj)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return rk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Ay._getInstance(Aj()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await Tj(),!this.activeServiceWorker)return;this.sender=new wj(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((t=n[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Sj()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await rx();return await rT(e,Rg,"1"),await iT(e,Rg),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>rT(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>kj(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>iT(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Iy(i,!1).getAll();return new fm(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Pj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}ok.type="LOCAL";const Rj=ok;new um(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ak(r,e){return e?_a(e):(ot(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub extends ab{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return pd(e,this._buildIdpRequest())}_linkToIdToken(e,t){return pd(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return pd(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function Oj(r){return Y4(r.auth,new ub(r),r.bypassAuthState)}function jj(r){const{auth:e,user:t}=r;return ot(t,e,"internal-error"),aj(t,new ub(r),r.bypassAuthState)}async function Mj(r){const{auth:e,user:t}=r;return ot(t,e,"internal-error"),oj(t,new ub(r),r.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lk{constructor(e,t,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const u={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(u))}catch(f){this.reject(f)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Oj;case"linkViaPopup":case"linkViaRedirect":return Mj;case"reauthViaPopup":case"reauthViaRedirect":return jj;default:Is(this.auth,"internal-error")}}resolve(e){Ta(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ta(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dj=new um(2e3,1e4);async function Lj(r,e,t){if(ui(r.app))return Promise.reject(oo(r,"operation-not-supported-in-this-environment"));const n=Fo(r);dO(r,e,lb);const i=ak(n,t);return new Hc(n,"signInViaPopup",e,i).executeNotNull()}class Hc extends lk{constructor(e,t,n,i,s){super(e,t,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Hc.currentPopupAction&&Hc.currentPopupAction.cancel(),Hc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return ot(e,this.auth,"internal-error"),e}async onExecution(){Ta(this.filter.length===1,"Popup operations only handle one event");const e=cb();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(oo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(oo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Hc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;if(!((n=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(oo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Dj.get())};e()}}Hc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fj="pendingRedirect",sg=new Map;class Vj extends lk{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=sg.get(this.auth._key());if(!e){try{const n=await zj(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}sg.set(this.auth._key(),e)}return this.bypassAuthState||sg.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function zj(r,e){const t=qj(e),n=Uj(r);if(!await n._isAvailable())return!1;const i=await n._get(t)==="true";return await n._remove(t),i}function Bj(r,e){sg.set(r._key(),e)}function Uj(r){return _a(r._redirectPersistence)}function qj(r){return ig(Fj,r.config.apiKey,r.name)}async function Hj(r,e,t=!1){if(ui(r.app))return Promise.reject(Ro(r));const n=Fo(r),i=ak(n,e),o=await new Vj(n,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $j=10*60*1e3;class Wj{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!Gj(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!ck(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";t.onError(oo(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=$j&&this.cachedEventUids.clear(),this.cachedEventUids.has(sT(e))}saveEventToCache(e){this.cachedEventUids.add(sT(e)),this.lastProcessedEventTime=Date.now()}}function sT(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function ck({type:r,error:e}){return r==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function Gj(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return ck(r);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kj(r,e={}){return Ca(r,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yj=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Zj=/^https?/;async function Qj(r){if(r.config.emulator)return;const{authorizedDomains:e}=await Kj(r);for(const t of e)try{if(Xj(t))return}catch{}Is(r,"unauthorized-domain")}function Xj(r){const e=Ng(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const o=new URL(r);return o.hostname===""&&n===""?t==="chrome-extension:"&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===n}if(!Zj.test(t))return!1;if(Yj.test(r))return n===r;const i=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jj=new um(3e4,6e4);function oT(){const r=Oo().___jsl;if(r!=null&&r.H){for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}}function eM(r){return new Promise((e,t)=>{var n,i,s;function o(){oT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{oT(),t(oo(r,"network-request-failed"))},timeout:Jj.get()})}if(!((i=(n=Oo().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Oo().gapi)===null||s===void 0)&&s.load)o();else{const l=zO("iframefcb");return Oo()[l]=()=>{gapi.load?o():t(oo(r,"network-request-failed"))},H4(`${VO()}?onload=${l}`).catch(u=>t(u))}}).catch(e=>{throw og=null,e})}let og=null;function tM(r){return og=og||eM(r),og}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nM=new um(5e3,15e3),rM="__/auth/iframe",iM="emulator/auth/iframe",sM={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},oM=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function aM(r){const e=r.config;ot(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?ib(e,iM):`https://${r.config.authDomain}/${rM}`,n={apiKey:e.apiKey,appName:r.name,v:Ud},i=oM.get(r.config.apiHost);i&&(n.eid=i);const s=r._getFrameworks();return s.length&&(n.fw=s.join(",")),`${t}?${cm(n).slice(1)}`}async function lM(r){const e=await tM(r),t=Oo().gapi;return ot(t,r,"internal-error"),e.open({where:document.body,url:aM(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:sM,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const o=oo(r,"network-request-failed"),l=Oo().setTimeout(()=>{s(o)},nM.get());function u(){Oo().clearTimeout(l),i(n)}n.ping(u).then(u,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cM={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},uM=500,dM=600,hM="_blank",fM="http://localhost";class aT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function mM(r,e,t,n=uM,i=dM){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const u=Object.assign(Object.assign({},cM),{width:n.toString(),height:i.toString(),top:s,left:o}),f=mr().toLowerCase();t&&(l=L4(f)?hM:t),M4(f)&&(e=e||fM,u.scrollbars="yes");const m=Object.entries(u).reduce((g,[_,E])=>`${g}${_}=${E},`,"");if(PO(f)&&l!=="_self")return pM(e||"",l),new aT(null);const y=window.open(e||"",l,m);ot(y,r,"popup-blocked");try{y.focus()}catch{}return new aT(y)}function pM(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gM="__/auth/handler",yM="emulator/auth/handler",vM=encodeURIComponent("fac");async function lT(r,e,t,n,i,s){ot(r.config.authDomain,r,"auth-domain-config-required"),ot(r.config.apiKey,r,"invalid-api-key");const o={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:Ud,eventId:i};if(e instanceof lb){e.setDefaultLanguage(r.languageCode),o.providerId=e.providerId||"",Z5(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,y]of Object.entries({}))o[m]=y}if(e instanceof hm){const m=e.getScopes().filter(y=>y!=="");m.length>0&&(o.scopes=m.join(","))}r.tenantId&&(o.tid=r.tenantId);const l=o;for(const m of Object.keys(l))l[m]===void 0&&delete l[m];const u=await r._getAppCheckToken(),f=u?`#${vM}=${encodeURIComponent(u)}`:"";return`${_M(r)}?${cm(l).slice(1)}${f}`}function _M({config:r}){return r.emulator?ib(r,yM):`https://${r.authDomain}/${gM}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lv="webStorageSupport";class xM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=nk,this._completeRedirectFn=Hj,this._overrideRedirectResult=Bj}async _openPopup(e,t,n,i){var s;Ta((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await lT(e,t,n,Ng(),i);return mM(e,o,cb())}async _openRedirect(e,t,n,i){await this._originValidation(e);const s=await lT(e,t,n,Ng(),i);return Ej(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Ta(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await lM(e),n=new Wj(e);return t.register("authEvent",i=>(ot(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Lv,{type:Lv},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Lv];o!==void 0&&t(!!o),Is(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=Qj(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return U4()||D4()||ob()}}const bM=xM;var cT="@firebase/auth",uT="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){ot(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EM(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function TM(r){Xc(new ql("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=n.options;ot(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const u={apiKey:o,authDomain:l,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:q4(r)},f=new DO(n,i,s,u);return WO(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),Xc(new ql("auth-internal",e=>{const t=Fo(e.getProvider("auth").getImmediate());return(n=>new wM(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),Co(cT,uT,EM(r)),Co(cT,uT,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SM=5*60,AM=v4("authIdTokenMaxAge")||SM;let dT=null;const IM=r=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>AM)return;const i=t==null?void 0:t.token;dT!==i&&(dT=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function NM(r=Ey()){const e=wy(r,"auth");if(e.isInitialized())return e.getImmediate();const t=$O(r,{popupRedirectResolver:bM,persistence:[Rj,xj,nk]}),n=v4("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const o=IM(s.toString());pj(t,o,()=>o(t.currentUser)),mj(t,l=>o(l))}}const i=p4("auth");return i&&GO(t,`http://${i}`),t}function kM(){var r,e;return(e=(r=document.getElementsByTagName("head"))===null||r===void 0?void 0:r[0])!==null&&e!==void 0?e:document}LO({loadJS(r){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=i=>{const s=oo("internal-error");s.customData=i,t(s)},n.type="text/javascript",n.charset="UTF-8",kM().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});TM("Browser");var hT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Fl,uk;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(P,k){function F(){}F.prototype=k.prototype,P.D=k.prototype,P.prototype=new F,P.prototype.constructor=P,P.C=function(j,O,D){for(var M=Array(arguments.length-2),$=2;$<arguments.length;$++)M[$-2]=arguments[$];return k.prototype[O].apply(j,M)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(P,k,F){F||(F=0);var j=Array(16);if(typeof k=="string")for(var O=0;16>O;++O)j[O]=k.charCodeAt(F++)|k.charCodeAt(F++)<<8|k.charCodeAt(F++)<<16|k.charCodeAt(F++)<<24;else for(O=0;16>O;++O)j[O]=k[F++]|k[F++]<<8|k[F++]<<16|k[F++]<<24;k=P.g[0],F=P.g[1],O=P.g[2];var D=P.g[3],M=k+(D^F&(O^D))+j[0]+3614090360&4294967295;k=F+(M<<7&4294967295|M>>>25),M=D+(O^k&(F^O))+j[1]+3905402710&4294967295,D=k+(M<<12&4294967295|M>>>20),M=O+(F^D&(k^F))+j[2]+606105819&4294967295,O=D+(M<<17&4294967295|M>>>15),M=F+(k^O&(D^k))+j[3]+3250441966&4294967295,F=O+(M<<22&4294967295|M>>>10),M=k+(D^F&(O^D))+j[4]+4118548399&4294967295,k=F+(M<<7&4294967295|M>>>25),M=D+(O^k&(F^O))+j[5]+1200080426&4294967295,D=k+(M<<12&4294967295|M>>>20),M=O+(F^D&(k^F))+j[6]+2821735955&4294967295,O=D+(M<<17&4294967295|M>>>15),M=F+(k^O&(D^k))+j[7]+4249261313&4294967295,F=O+(M<<22&4294967295|M>>>10),M=k+(D^F&(O^D))+j[8]+1770035416&4294967295,k=F+(M<<7&4294967295|M>>>25),M=D+(O^k&(F^O))+j[9]+2336552879&4294967295,D=k+(M<<12&4294967295|M>>>20),M=O+(F^D&(k^F))+j[10]+4294925233&4294967295,O=D+(M<<17&4294967295|M>>>15),M=F+(k^O&(D^k))+j[11]+2304563134&4294967295,F=O+(M<<22&4294967295|M>>>10),M=k+(D^F&(O^D))+j[12]+1804603682&4294967295,k=F+(M<<7&4294967295|M>>>25),M=D+(O^k&(F^O))+j[13]+4254626195&4294967295,D=k+(M<<12&4294967295|M>>>20),M=O+(F^D&(k^F))+j[14]+2792965006&4294967295,O=D+(M<<17&4294967295|M>>>15),M=F+(k^O&(D^k))+j[15]+1236535329&4294967295,F=O+(M<<22&4294967295|M>>>10),M=k+(O^D&(F^O))+j[1]+4129170786&4294967295,k=F+(M<<5&4294967295|M>>>27),M=D+(F^O&(k^F))+j[6]+3225465664&4294967295,D=k+(M<<9&4294967295|M>>>23),M=O+(k^F&(D^k))+j[11]+643717713&4294967295,O=D+(M<<14&4294967295|M>>>18),M=F+(D^k&(O^D))+j[0]+3921069994&4294967295,F=O+(M<<20&4294967295|M>>>12),M=k+(O^D&(F^O))+j[5]+3593408605&4294967295,k=F+(M<<5&4294967295|M>>>27),M=D+(F^O&(k^F))+j[10]+38016083&4294967295,D=k+(M<<9&4294967295|M>>>23),M=O+(k^F&(D^k))+j[15]+3634488961&4294967295,O=D+(M<<14&4294967295|M>>>18),M=F+(D^k&(O^D))+j[4]+3889429448&4294967295,F=O+(M<<20&4294967295|M>>>12),M=k+(O^D&(F^O))+j[9]+568446438&4294967295,k=F+(M<<5&4294967295|M>>>27),M=D+(F^O&(k^F))+j[14]+3275163606&4294967295,D=k+(M<<9&4294967295|M>>>23),M=O+(k^F&(D^k))+j[3]+4107603335&4294967295,O=D+(M<<14&4294967295|M>>>18),M=F+(D^k&(O^D))+j[8]+1163531501&4294967295,F=O+(M<<20&4294967295|M>>>12),M=k+(O^D&(F^O))+j[13]+2850285829&4294967295,k=F+(M<<5&4294967295|M>>>27),M=D+(F^O&(k^F))+j[2]+4243563512&4294967295,D=k+(M<<9&4294967295|M>>>23),M=O+(k^F&(D^k))+j[7]+1735328473&4294967295,O=D+(M<<14&4294967295|M>>>18),M=F+(D^k&(O^D))+j[12]+2368359562&4294967295,F=O+(M<<20&4294967295|M>>>12),M=k+(F^O^D)+j[5]+4294588738&4294967295,k=F+(M<<4&4294967295|M>>>28),M=D+(k^F^O)+j[8]+2272392833&4294967295,D=k+(M<<11&4294967295|M>>>21),M=O+(D^k^F)+j[11]+1839030562&4294967295,O=D+(M<<16&4294967295|M>>>16),M=F+(O^D^k)+j[14]+4259657740&4294967295,F=O+(M<<23&4294967295|M>>>9),M=k+(F^O^D)+j[1]+2763975236&4294967295,k=F+(M<<4&4294967295|M>>>28),M=D+(k^F^O)+j[4]+1272893353&4294967295,D=k+(M<<11&4294967295|M>>>21),M=O+(D^k^F)+j[7]+4139469664&4294967295,O=D+(M<<16&4294967295|M>>>16),M=F+(O^D^k)+j[10]+3200236656&4294967295,F=O+(M<<23&4294967295|M>>>9),M=k+(F^O^D)+j[13]+681279174&4294967295,k=F+(M<<4&4294967295|M>>>28),M=D+(k^F^O)+j[0]+3936430074&4294967295,D=k+(M<<11&4294967295|M>>>21),M=O+(D^k^F)+j[3]+3572445317&4294967295,O=D+(M<<16&4294967295|M>>>16),M=F+(O^D^k)+j[6]+76029189&4294967295,F=O+(M<<23&4294967295|M>>>9),M=k+(F^O^D)+j[9]+3654602809&4294967295,k=F+(M<<4&4294967295|M>>>28),M=D+(k^F^O)+j[12]+3873151461&4294967295,D=k+(M<<11&4294967295|M>>>21),M=O+(D^k^F)+j[15]+530742520&4294967295,O=D+(M<<16&4294967295|M>>>16),M=F+(O^D^k)+j[2]+3299628645&4294967295,F=O+(M<<23&4294967295|M>>>9),M=k+(O^(F|~D))+j[0]+4096336452&4294967295,k=F+(M<<6&4294967295|M>>>26),M=D+(F^(k|~O))+j[7]+1126891415&4294967295,D=k+(M<<10&4294967295|M>>>22),M=O+(k^(D|~F))+j[14]+2878612391&4294967295,O=D+(M<<15&4294967295|M>>>17),M=F+(D^(O|~k))+j[5]+4237533241&4294967295,F=O+(M<<21&4294967295|M>>>11),M=k+(O^(F|~D))+j[12]+1700485571&4294967295,k=F+(M<<6&4294967295|M>>>26),M=D+(F^(k|~O))+j[3]+2399980690&4294967295,D=k+(M<<10&4294967295|M>>>22),M=O+(k^(D|~F))+j[10]+4293915773&4294967295,O=D+(M<<15&4294967295|M>>>17),M=F+(D^(O|~k))+j[1]+2240044497&4294967295,F=O+(M<<21&4294967295|M>>>11),M=k+(O^(F|~D))+j[8]+1873313359&4294967295,k=F+(M<<6&4294967295|M>>>26),M=D+(F^(k|~O))+j[15]+4264355552&4294967295,D=k+(M<<10&4294967295|M>>>22),M=O+(k^(D|~F))+j[6]+2734768916&4294967295,O=D+(M<<15&4294967295|M>>>17),M=F+(D^(O|~k))+j[13]+1309151649&4294967295,F=O+(M<<21&4294967295|M>>>11),M=k+(O^(F|~D))+j[4]+4149444226&4294967295,k=F+(M<<6&4294967295|M>>>26),M=D+(F^(k|~O))+j[11]+3174756917&4294967295,D=k+(M<<10&4294967295|M>>>22),M=O+(k^(D|~F))+j[2]+718787259&4294967295,O=D+(M<<15&4294967295|M>>>17),M=F+(D^(O|~k))+j[9]+3951481745&4294967295,P.g[0]=P.g[0]+k&4294967295,P.g[1]=P.g[1]+(O+(M<<21&4294967295|M>>>11))&4294967295,P.g[2]=P.g[2]+O&4294967295,P.g[3]=P.g[3]+D&4294967295}n.prototype.u=function(P,k){k===void 0&&(k=P.length);for(var F=k-this.blockSize,j=this.B,O=this.h,D=0;D<k;){if(O==0)for(;D<=F;)i(this,P,D),D+=this.blockSize;if(typeof P=="string"){for(;D<k;)if(j[O++]=P.charCodeAt(D++),O==this.blockSize){i(this,j),O=0;break}}else for(;D<k;)if(j[O++]=P[D++],O==this.blockSize){i(this,j),O=0;break}}this.h=O,this.o+=k},n.prototype.v=function(){var P=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);P[0]=128;for(var k=1;k<P.length-8;++k)P[k]=0;var F=8*this.o;for(k=P.length-8;k<P.length;++k)P[k]=F&255,F/=256;for(this.u(P),P=Array(16),k=F=0;4>k;++k)for(var j=0;32>j;j+=8)P[F++]=this.g[k]>>>j&255;return P};function s(P,k){var F=l;return Object.prototype.hasOwnProperty.call(F,P)?F[P]:F[P]=k(P)}function o(P,k){this.h=k;for(var F=[],j=!0,O=P.length-1;0<=O;O--){var D=P[O]|0;j&&D==k||(F[O]=D,j=!1)}this.g=F}var l={};function u(P){return-128<=P&&128>P?s(P,function(k){return new o([k|0],0>k?-1:0)}):new o([P|0],0>P?-1:0)}function f(P){if(isNaN(P)||!isFinite(P))return y;if(0>P)return w(f(-P));for(var k=[],F=1,j=0;P>=F;j++)k[j]=P/F|0,F*=4294967296;return new o(k,0)}function m(P,k){if(P.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(P.charAt(0)=="-")return w(m(P.substring(1),k));if(0<=P.indexOf("-"))throw Error('number format error: interior "-" character');for(var F=f(Math.pow(k,8)),j=y,O=0;O<P.length;O+=8){var D=Math.min(8,P.length-O),M=parseInt(P.substring(O,O+D),k);8>D?(D=f(Math.pow(k,D)),j=j.j(D).add(f(M))):(j=j.j(F),j=j.add(f(M)))}return j}var y=u(0),g=u(1),_=u(16777216);r=o.prototype,r.m=function(){if(x(this))return-w(this).m();for(var P=0,k=1,F=0;F<this.g.length;F++){var j=this.i(F);P+=(0<=j?j:4294967296+j)*k,k*=4294967296}return P},r.toString=function(P){if(P=P||10,2>P||36<P)throw Error("radix out of range: "+P);if(E(this))return"0";if(x(this))return"-"+w(this).toString(P);for(var k=f(Math.pow(P,6)),F=this,j="";;){var O=N(F,k).g;F=S(F,O.j(k));var D=((0<F.g.length?F.g[0]:F.h)>>>0).toString(P);if(F=O,E(F))return D+j;for(;6>D.length;)D="0"+D;j=D+j}},r.i=function(P){return 0>P?0:P<this.g.length?this.g[P]:this.h};function E(P){if(P.h!=0)return!1;for(var k=0;k<P.g.length;k++)if(P.g[k]!=0)return!1;return!0}function x(P){return P.h==-1}r.l=function(P){return P=S(this,P),x(P)?-1:E(P)?0:1};function w(P){for(var k=P.g.length,F=[],j=0;j<k;j++)F[j]=~P.g[j];return new o(F,~P.h).add(g)}r.abs=function(){return x(this)?w(this):this},r.add=function(P){for(var k=Math.max(this.g.length,P.g.length),F=[],j=0,O=0;O<=k;O++){var D=j+(this.i(O)&65535)+(P.i(O)&65535),M=(D>>>16)+(this.i(O)>>>16)+(P.i(O)>>>16);j=M>>>16,D&=65535,M&=65535,F[O]=M<<16|D}return new o(F,F[F.length-1]&-2147483648?-1:0)};function S(P,k){return P.add(w(k))}r.j=function(P){if(E(this)||E(P))return y;if(x(this))return x(P)?w(this).j(w(P)):w(w(this).j(P));if(x(P))return w(this.j(w(P)));if(0>this.l(_)&&0>P.l(_))return f(this.m()*P.m());for(var k=this.g.length+P.g.length,F=[],j=0;j<2*k;j++)F[j]=0;for(j=0;j<this.g.length;j++)for(var O=0;O<P.g.length;O++){var D=this.i(j)>>>16,M=this.i(j)&65535,$=P.i(O)>>>16,G=P.i(O)&65535;F[2*j+2*O]+=M*G,I(F,2*j+2*O),F[2*j+2*O+1]+=D*G,I(F,2*j+2*O+1),F[2*j+2*O+1]+=M*$,I(F,2*j+2*O+1),F[2*j+2*O+2]+=D*$,I(F,2*j+2*O+2)}for(j=0;j<k;j++)F[j]=F[2*j+1]<<16|F[2*j];for(j=k;j<2*k;j++)F[j]=0;return new o(F,0)};function I(P,k){for(;(P[k]&65535)!=P[k];)P[k+1]+=P[k]>>>16,P[k]&=65535,k++}function C(P,k){this.g=P,this.h=k}function N(P,k){if(E(k))throw Error("division by zero");if(E(P))return new C(y,y);if(x(P))return k=N(w(P),k),new C(w(k.g),w(k.h));if(x(k))return k=N(P,w(k)),new C(w(k.g),k.h);if(30<P.g.length){if(x(P)||x(k))throw Error("slowDivide_ only works with positive integers.");for(var F=g,j=k;0>=j.l(P);)F=R(F),j=R(j);var O=B(F,1),D=B(j,1);for(j=B(j,2),F=B(F,2);!E(j);){var M=D.add(j);0>=M.l(P)&&(O=O.add(F),D=M),j=B(j,1),F=B(F,1)}return k=S(P,O.j(k)),new C(O,k)}for(O=y;0<=P.l(k);){for(F=Math.max(1,Math.floor(P.m()/k.m())),j=Math.ceil(Math.log(F)/Math.LN2),j=48>=j?1:Math.pow(2,j-48),D=f(F),M=D.j(k);x(M)||0<M.l(P);)F-=j,D=f(F),M=D.j(k);E(D)&&(D=g),O=O.add(D),P=S(P,M)}return new C(O,P)}r.A=function(P){return N(this,P).h},r.and=function(P){for(var k=Math.max(this.g.length,P.g.length),F=[],j=0;j<k;j++)F[j]=this.i(j)&P.i(j);return new o(F,this.h&P.h)},r.or=function(P){for(var k=Math.max(this.g.length,P.g.length),F=[],j=0;j<k;j++)F[j]=this.i(j)|P.i(j);return new o(F,this.h|P.h)},r.xor=function(P){for(var k=Math.max(this.g.length,P.g.length),F=[],j=0;j<k;j++)F[j]=this.i(j)^P.i(j);return new o(F,this.h^P.h)};function R(P){for(var k=P.g.length+1,F=[],j=0;j<k;j++)F[j]=P.i(j)<<1|P.i(j-1)>>>31;return new o(F,P.h)}function B(P,k){var F=k>>5;k%=32;for(var j=P.g.length-F,O=[],D=0;D<j;D++)O[D]=0<k?P.i(D+F)>>>k|P.i(D+F+1)<<32-k:P.i(D+F);return new o(O,P.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,uk=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=f,o.fromString=m,Fl=o}).apply(typeof hT<"u"?hT:typeof self<"u"?self:typeof window<"u"?window:{});var Pp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var dk,rf,hk,ag,ix,fk,mk,pk;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(b,U,K){return b==Array.prototype||b==Object.prototype||(b[U]=K.value),b};function t(b){b=[typeof globalThis=="object"&&globalThis,b,typeof window=="object"&&window,typeof self=="object"&&self,typeof Pp=="object"&&Pp];for(var U=0;U<b.length;++U){var K=b[U];if(K&&K.Math==Math)return K}throw Error("Cannot find global object")}var n=t(this);function i(b,U){if(U)e:{var K=n;b=b.split(".");for(var ae=0;ae<b.length-1;ae++){var ye=b[ae];if(!(ye in K))break e;K=K[ye]}b=b[b.length-1],ae=K[b],U=U(ae),U!=ae&&U!=null&&e(K,b,{configurable:!0,writable:!0,value:U})}}function s(b,U){b instanceof String&&(b+="");var K=0,ae=!1,ye={next:function(){if(!ae&&K<b.length){var Te=K++;return{value:U(Te,b[Te]),done:!1}}return ae=!0,{done:!0,value:void 0}}};return ye[Symbol.iterator]=function(){return ye},ye}i("Array.prototype.values",function(b){return b||function(){return s(this,function(U,K){return K})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function u(b){var U=typeof b;return U=U!="object"?U:b?Array.isArray(b)?"array":U:"null",U=="array"||U=="object"&&typeof b.length=="number"}function f(b){var U=typeof b;return U=="object"&&b!=null||U=="function"}function m(b,U,K){return b.call.apply(b.bind,arguments)}function y(b,U,K){if(!b)throw Error();if(2<arguments.length){var ae=Array.prototype.slice.call(arguments,2);return function(){var ye=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ye,ae),b.apply(U,ye)}}return function(){return b.apply(U,arguments)}}function g(b,U,K){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:y,g.apply(null,arguments)}function _(b,U){var K=Array.prototype.slice.call(arguments,1);return function(){var ae=K.slice();return ae.push.apply(ae,arguments),b.apply(this,ae)}}function E(b,U){function K(){}K.prototype=U.prototype,b.aa=U.prototype,b.prototype=new K,b.prototype.constructor=b,b.Qb=function(ae,ye,Te){for(var ze=Array(arguments.length-2),en=2;en<arguments.length;en++)ze[en-2]=arguments[en];return U.prototype[ye].apply(ae,ze)}}function x(b){const U=b.length;if(0<U){const K=Array(U);for(let ae=0;ae<U;ae++)K[ae]=b[ae];return K}return[]}function w(b,U){for(let K=1;K<arguments.length;K++){const ae=arguments[K];if(u(ae)){const ye=b.length||0,Te=ae.length||0;b.length=ye+Te;for(let ze=0;ze<Te;ze++)b[ye+ze]=ae[ze]}else b.push(ae)}}class S{constructor(U,K){this.i=U,this.j=K,this.h=0,this.g=null}get(){let U;return 0<this.h?(this.h--,U=this.g,this.g=U.next,U.next=null):U=this.i(),U}}function I(b){return/^[\s\xa0]*$/.test(b)}function C(){var b=l.navigator;return b&&(b=b.userAgent)?b:""}function N(b){return N[" "](b),b}N[" "]=function(){};var R=C().indexOf("Gecko")!=-1&&!(C().toLowerCase().indexOf("webkit")!=-1&&C().indexOf("Edge")==-1)&&!(C().indexOf("Trident")!=-1||C().indexOf("MSIE")!=-1)&&C().indexOf("Edge")==-1;function B(b,U,K){for(const ae in b)U.call(K,b[ae],ae,b)}function P(b,U){for(const K in b)U.call(void 0,b[K],K,b)}function k(b){const U={};for(const K in b)U[K]=b[K];return U}const F="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function j(b,U){let K,ae;for(let ye=1;ye<arguments.length;ye++){ae=arguments[ye];for(K in ae)b[K]=ae[K];for(let Te=0;Te<F.length;Te++)K=F[Te],Object.prototype.hasOwnProperty.call(ae,K)&&(b[K]=ae[K])}}function O(b){var U=1;b=b.split(":");const K=[];for(;0<U&&b.length;)K.push(b.shift()),U--;return b.length&&K.push(b.join(":")),K}function D(b){l.setTimeout(()=>{throw b},0)}function M(){var b=J;let U=null;return b.g&&(U=b.g,b.g=b.g.next,b.g||(b.h=null),U.next=null),U}class ${constructor(){this.h=this.g=null}add(U,K){const ae=G.get();ae.set(U,K),this.h?this.h.next=ae:this.g=ae,this.h=ae}}var G=new S(()=>new ie,b=>b.reset());class ie{constructor(){this.next=this.g=this.h=null}set(U,K){this.h=U,this.g=K,this.next=null}reset(){this.next=this.g=this.h=null}}let oe,ee=!1,J=new $,Y=()=>{const b=l.Promise.resolve(void 0);oe=()=>{b.then(q)}};var q=()=>{for(var b;b=M();){try{b.h.call(b.g)}catch(K){D(K)}var U=G;U.j(b),100>U.h&&(U.h++,b.next=U.g,U.g=b)}ee=!1};function Z(){this.s=this.s,this.C=this.C}Z.prototype.s=!1,Z.prototype.ma=function(){this.s||(this.s=!0,this.N())},Z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ne(b,U){this.type=b,this.g=this.target=U,this.defaultPrevented=!1}ne.prototype.h=function(){this.defaultPrevented=!0};var se=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var b=!1,U=Object.defineProperty({},"passive",{get:function(){b=!0}});try{const K=()=>{};l.addEventListener("test",K,U),l.removeEventListener("test",K,U)}catch{}return b}();function le(b,U){if(ne.call(this,b?b.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,b){var K=this.type=b.type,ae=b.changedTouches&&b.changedTouches.length?b.changedTouches[0]:null;if(this.target=b.target||b.srcElement,this.g=U,U=b.relatedTarget){if(R){e:{try{N(U.nodeName);var ye=!0;break e}catch{}ye=!1}ye||(U=null)}}else K=="mouseover"?U=b.fromElement:K=="mouseout"&&(U=b.toElement);this.relatedTarget=U,ae?(this.clientX=ae.clientX!==void 0?ae.clientX:ae.pageX,this.clientY=ae.clientY!==void 0?ae.clientY:ae.pageY,this.screenX=ae.screenX||0,this.screenY=ae.screenY||0):(this.clientX=b.clientX!==void 0?b.clientX:b.pageX,this.clientY=b.clientY!==void 0?b.clientY:b.pageY,this.screenX=b.screenX||0,this.screenY=b.screenY||0),this.button=b.button,this.key=b.key||"",this.ctrlKey=b.ctrlKey,this.altKey=b.altKey,this.shiftKey=b.shiftKey,this.metaKey=b.metaKey,this.pointerId=b.pointerId||0,this.pointerType=typeof b.pointerType=="string"?b.pointerType:Q[b.pointerType]||"",this.state=b.state,this.i=b,b.defaultPrevented&&le.aa.h.call(this)}}E(le,ne);var Q={2:"touch",3:"pen",4:"mouse"};le.prototype.h=function(){le.aa.h.call(this);var b=this.i;b.preventDefault?b.preventDefault():b.returnValue=!1};var ce="closure_listenable_"+(1e6*Math.random()|0),me=0;function ge(b,U,K,ae,ye){this.listener=b,this.proxy=null,this.src=U,this.type=K,this.capture=!!ae,this.ha=ye,this.key=++me,this.da=this.fa=!1}function Ae(b){b.da=!0,b.listener=null,b.proxy=null,b.src=null,b.ha=null}function Ue(b){this.src=b,this.g={},this.h=0}Ue.prototype.add=function(b,U,K,ae,ye){var Te=b.toString();b=this.g[Te],b||(b=this.g[Te]=[],this.h++);var ze=et(b,U,ae,ye);return-1<ze?(U=b[ze],K||(U.fa=!1)):(U=new ge(U,this.src,Te,!!ae,ye),U.fa=K,b.push(U)),U};function nt(b,U){var K=U.type;if(K in b.g){var ae=b.g[K],ye=Array.prototype.indexOf.call(ae,U,void 0),Te;(Te=0<=ye)&&Array.prototype.splice.call(ae,ye,1),Te&&(Ae(U),b.g[K].length==0&&(delete b.g[K],b.h--))}}function et(b,U,K,ae){for(var ye=0;ye<b.length;++ye){var Te=b[ye];if(!Te.da&&Te.listener==U&&Te.capture==!!K&&Te.ha==ae)return ye}return-1}var pt="closure_lm_"+(1e6*Math.random()|0),Et={};function _n(b,U,K,ae,ye){if(Array.isArray(U)){for(var Te=0;Te<U.length;Te++)_n(b,U[Te],K,ae,ye);return null}return K=mt(K),b&&b[ce]?b.K(U,K,f(ae)?!!ae.capture:!1,ye):Wt(b,U,K,!1,ae,ye)}function Wt(b,U,K,ae,ye,Te){if(!U)throw Error("Invalid event type");var ze=f(ye)?!!ye.capture:!!ye,en=gt(b);if(en||(b[pt]=en=new Ue(b)),K=en.add(U,K,ae,ze,Te),K.proxy)return K;if(ae=Se(),K.proxy=ae,ae.src=b,ae.listener=K,b.addEventListener)se||(ye=ze),ye===void 0&&(ye=!1),b.addEventListener(U.toString(),ae,ye);else if(b.attachEvent)b.attachEvent(Ve(U.toString()),ae);else if(b.addListener&&b.removeListener)b.addListener(ae);else throw Error("addEventListener and attachEvent are unavailable.");return K}function Se(){function b(K){return U.call(b.src,b.listener,K)}const U=ke;return b}function Ie(b,U,K,ae,ye){if(Array.isArray(U))for(var Te=0;Te<U.length;Te++)Ie(b,U[Te],K,ae,ye);else ae=f(ae)?!!ae.capture:!!ae,K=mt(K),b&&b[ce]?(b=b.i,U=String(U).toString(),U in b.g&&(Te=b.g[U],K=et(Te,K,ae,ye),-1<K&&(Ae(Te[K]),Array.prototype.splice.call(Te,K,1),Te.length==0&&(delete b.g[U],b.h--)))):b&&(b=gt(b))&&(U=b.g[U.toString()],b=-1,U&&(b=et(U,K,ae,ye)),(K=-1<b?U[b]:null)&&De(K))}function De(b){if(typeof b!="number"&&b&&!b.da){var U=b.src;if(U&&U[ce])nt(U.i,b);else{var K=b.type,ae=b.proxy;U.removeEventListener?U.removeEventListener(K,ae,b.capture):U.detachEvent?U.detachEvent(Ve(K),ae):U.addListener&&U.removeListener&&U.removeListener(ae),(K=gt(U))?(nt(K,b),K.h==0&&(K.src=null,U[pt]=null)):Ae(b)}}}function Ve(b){return b in Et?Et[b]:Et[b]="on"+b}function ke(b,U){if(b.da)b=!0;else{U=new le(U,this);var K=b.listener,ae=b.ha||b.src;b.fa&&De(b),b=K.call(ae,U)}return b}function gt(b){return b=b[pt],b instanceof Ue?b:null}var ft="__closure_events_fn_"+(1e9*Math.random()>>>0);function mt(b){return typeof b=="function"?b:(b[ft]||(b[ft]=function(U){return b.handleEvent(U)}),b[ft])}function kt(){Z.call(this),this.i=new Ue(this),this.M=this,this.F=null}E(kt,Z),kt.prototype[ce]=!0,kt.prototype.removeEventListener=function(b,U,K,ae){Ie(this,b,U,K,ae)};function jt(b,U){var K,ae=b.F;if(ae)for(K=[];ae;ae=ae.F)K.push(ae);if(b=b.M,ae=U.type||U,typeof U=="string")U=new ne(U,b);else if(U instanceof ne)U.target=U.target||b;else{var ye=U;U=new ne(ae,b),j(U,ye)}if(ye=!0,K)for(var Te=K.length-1;0<=Te;Te--){var ze=U.g=K[Te];ye=Mt(ze,ae,!0,U)&&ye}if(ze=U.g=b,ye=Mt(ze,ae,!0,U)&&ye,ye=Mt(ze,ae,!1,U)&&ye,K)for(Te=0;Te<K.length;Te++)ze=U.g=K[Te],ye=Mt(ze,ae,!1,U)&&ye}kt.prototype.N=function(){if(kt.aa.N.call(this),this.i){var b=this.i,U;for(U in b.g){for(var K=b.g[U],ae=0;ae<K.length;ae++)Ae(K[ae]);delete b.g[U],b.h--}}this.F=null},kt.prototype.K=function(b,U,K,ae){return this.i.add(String(b),U,!1,K,ae)},kt.prototype.L=function(b,U,K,ae){return this.i.add(String(b),U,!0,K,ae)};function Mt(b,U,K,ae){if(U=b.i.g[String(U)],!U)return!0;U=U.concat();for(var ye=!0,Te=0;Te<U.length;++Te){var ze=U[Te];if(ze&&!ze.da&&ze.capture==K){var en=ze.listener,zn=ze.ha||ze.src;ze.fa&&nt(b.i,ze),ye=en.call(zn,ae)!==!1&&ye}}return ye&&!ae.defaultPrevented}function os(b,U,K){if(typeof b=="function")K&&(b=g(b,K));else if(b&&typeof b.handleEvent=="function")b=g(b.handleEvent,b);else throw Error("Invalid listener argument");return 2147483647<Number(U)?-1:l.setTimeout(b,U||0)}function qt(b){b.g=os(()=>{b.g=null,b.i&&(b.i=!1,qt(b))},b.l);const U=b.h;b.h=null,b.m.apply(null,U)}class jn extends Z{constructor(U,K){super(),this.m=U,this.l=K,this.h=null,this.i=!1,this.g=null}j(U){this.h=arguments,this.g?this.i=!0:qt(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function as(b){Z.call(this),this.h=b,this.g={}}E(as,Z);var Bi=[];function pi(b){B(b.g,function(U,K){this.g.hasOwnProperty(K)&&De(U)},b),b.g={}}as.prototype.N=function(){as.aa.N.call(this),pi(this)},as.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var gr=l.JSON.stringify,gi=l.JSON.parse,ti=class{stringify(b){return l.JSON.stringify(b,void 0)}parse(b){return l.JSON.parse(b,void 0)}};function Ui(){}Ui.prototype.h=null;function lo(b){return b.h||(b.h=b.i())}function yi(){}var Qn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ni(){ne.call(this,"d")}E(ni,ne);function vi(){ne.call(this,"c")}E(vi,ne);var _i={},zo=null;function gn(){return zo=zo||new kt}_i.La="serverreachability";function xi(b){ne.call(this,_i.La,b)}E(xi,ne);function qi(b){const U=gn();jt(U,new xi(U))}_i.STAT_EVENT="statevent";function ls(b,U){ne.call(this,_i.STAT_EVENT,b),this.stat=U}E(ls,ne);function xn(b){const U=gn();jt(U,new ls(U,b))}_i.Ma="timingevent";function Fs(b,U){ne.call(this,_i.Ma,b),this.size=U}E(Fs,ne);function Dr(b,U){if(typeof b!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){b()},U)}function Vs(){this.g=!0}Vs.prototype.xa=function(){this.g=!1};function an(b,U,K,ae,ye,Te){b.info(function(){if(b.g)if(Te)for(var ze="",en=Te.split("&"),zn=0;zn<en.length;zn++){var zt=en[zn].split("=");if(1<zt.length){var nn=zt[0];zt=zt[1];var wn=nn.split("_");ze=2<=wn.length&&wn[1]=="type"?ze+(nn+"="+zt+"&"):ze+(nn+"=redacted&")}}else ze=null;else ze=Te;return"XMLHTTP REQ ("+ae+") [attempt "+ye+"]: "+U+`
`+K+`
`+ze})}function $e(b,U,K,ae,ye,Te,ze){b.info(function(){return"XMLHTTP RESP ("+ae+") [ attempt "+ye+"]: "+U+`
`+K+`
`+Te+" "+ze})}function Sr(b,U,K,ae){b.info(function(){return"XMLHTTP TEXT ("+U+"): "+co(b,K)+(ae?" "+ae:"")})}function zs(b,U){b.info(function(){return"TIMEOUT: "+U})}Vs.prototype.info=function(){};function co(b,U){if(!b.g)return U;if(!U)return null;try{var K=JSON.parse(U);if(K){for(b=0;b<K.length;b++)if(Array.isArray(K[b])){var ae=K[b];if(!(2>ae.length)){var ye=ae[1];if(Array.isArray(ye)&&!(1>ye.length)){var Te=ye[0];if(Te!="noop"&&Te!="stop"&&Te!="close")for(var ze=1;ze<ye.length;ze++)ye[ze]=""}}}}return gr(K)}catch{return U}}var cs={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},yr={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ar;function Ir(){}E(Ir,Ui),Ir.prototype.g=function(){return new XMLHttpRequest},Ir.prototype.i=function(){return{}},Ar=new Ir;function Nr(b,U,K,ae){this.j=b,this.i=U,this.l=K,this.R=ae||1,this.U=new as(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Bo}function Bo(){this.i=null,this.g="",this.h=!1}var Uo={},Ze={};function fe(b,U,K){b.L=1,b.v=Fr(En(U)),b.m=K,b.P=!0,je(b,null)}function je(b,U){b.F=Date.now(),It(b),b.A=En(b.v);var K=b.A,ae=b.R;Array.isArray(ae)||(ae=[String(ae)]),fo(K.i,"t",ae),b.C=0,K=b.j.J,b.h=new Bo,b.g=Eu(b.j,K?U:null,!b.m),0<b.O&&(b.M=new jn(g(b.Y,b,b.g),b.O)),U=b.U,K=b.g,ae=b.ca;var ye="readystatechange";Array.isArray(ye)||(ye&&(Bi[0]=ye.toString()),ye=Bi);for(var Te=0;Te<ye.length;Te++){var ze=_n(K,ye[Te],ae||U.handleEvent,!1,U.h||U);if(!ze)break;U.g[ze.key]=ze}U=b.H?k(b.H):{},b.m?(b.u||(b.u="POST"),U["Content-Type"]="application/x-www-form-urlencoded",b.g.ea(b.A,b.u,b.m,U)):(b.u="GET",b.g.ea(b.A,b.u,null,U)),qi(),an(b.i,b.u,b.A,b.l,b.R,b.m)}Nr.prototype.ca=function(b){b=b.target;const U=this.M;U&&Jn(b)==3?U.j():this.Y(b)},Nr.prototype.Y=function(b){try{if(b==this.g)e:{const wn=Jn(this.g);var U=this.g.Ba();const Ii=this.g.Z();if(!(3>wn)&&(wn!=3||this.g&&(this.h.h||this.g.oa()||qa(this.g)))){this.J||wn!=4||U==7||(U==8||0>=Ii?qi(3):qi(2)),Cn(this);var K=this.g.Z();this.X=K;t:if(Ge(this)){var ae=qa(this.g);b="";var ye=ae.length,Te=Jn(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){$n(this),Xn(this);var ze="";break t}this.h.i=new l.TextDecoder}for(U=0;U<ye;U++)this.h.h=!0,b+=this.h.i.decode(ae[U],{stream:!(Te&&U==ye-1)});ae.length=0,this.h.g+=b,this.C=0,ze=this.h.g}else ze=this.g.oa();if(this.o=K==200,$e(this.i,this.u,this.A,this.l,this.R,wn,K),this.o){if(this.T&&!this.K){t:{if(this.g){var en,zn=this.g;if((en=zn.g?zn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!I(en)){var zt=en;break t}}zt=null}if(K=zt)Sr(this.i,this.l,K,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Hi(this,K);else{this.o=!1,this.s=3,xn(12),$n(this),Xn(this);break e}}if(this.P){K=!0;let Mn;for(;!this.J&&this.C<ze.length;)if(Mn=Gt(this,ze),Mn==Ze){wn==4&&(this.s=4,xn(14),K=!1),Sr(this.i,this.l,null,"[Incomplete Response]");break}else if(Mn==Uo){this.s=4,xn(15),Sr(this.i,this.l,ze,"[Invalid Chunk]"),K=!1;break}else Sr(this.i,this.l,Mn,null),Hi(this,Mn);if(Ge(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),wn!=4||ze.length!=0||this.h.h||(this.s=1,xn(16),K=!1),this.o=this.o&&K,!K)Sr(this.i,this.l,ze,"[Invalid Chunked Response]"),$n(this),Xn(this);else if(0<ze.length&&!this.W){this.W=!0;var nn=this.j;nn.g==this&&nn.ba&&!nn.M&&(nn.j.info("Great, no buffering proxy detected. Bytes received: "+ze.length),Wa(nn),nn.M=!0,xn(11))}}else Sr(this.i,this.l,ze,null),Hi(this,ze);wn==4&&$n(this),this.o&&!this.J&&(wn==4?Qo(this.j,this):(this.o=!1,It(this)))}else Ha(this.g),K==400&&0<ze.indexOf("Unknown SID")?(this.s=3,xn(12)):(this.s=0,xn(13)),$n(this),Xn(this)}}}catch{}finally{}};function Ge(b){return b.g?b.u=="GET"&&b.L!=2&&b.j.Ca:!1}function Gt(b,U){var K=b.C,ae=U.indexOf(`
`,K);return ae==-1?Ze:(K=Number(U.substring(K,ae)),isNaN(K)?Uo:(ae+=1,ae+K>U.length?Ze:(U=U.slice(ae,ae+K),b.C=ae+K,U)))}Nr.prototype.cancel=function(){this.J=!0,$n(this)};function It(b){b.S=Date.now()+b.I,bn(b,b.I)}function bn(b,U){if(b.B!=null)throw Error("WatchDog timer not null");b.B=Dr(g(b.ba,b),U)}function Cn(b){b.B&&(l.clearTimeout(b.B),b.B=null)}Nr.prototype.ba=function(){this.B=null;const b=Date.now();0<=b-this.S?(zs(this.i,this.A),this.L!=2&&(qi(),xn(17)),$n(this),this.s=2,Xn(this)):bn(this,this.S-b)};function Xn(b){b.j.G==0||b.J||Qo(b.j,b)}function $n(b){Cn(b);var U=b.M;U&&typeof U.ma=="function"&&U.ma(),b.M=null,pi(b.U),b.g&&(U=b.g,b.g=null,U.abort(),U.ma())}function Hi(b,U){try{var K=b.j;if(K.G!=0&&(K.g==b||_t(K.h,b))){if(!b.K&&_t(K.h,b)&&K.G==3){try{var ae=K.Da.g.parse(U)}catch{ae=null}if(Array.isArray(ae)&&ae.length==3){var ye=ae;if(ye[0]==0){e:if(!K.u){if(K.g)if(K.g.F+3e3<b.F)Ka(K),Ki(K);else break e;Zo(K),xn(18)}}else K.za=ye[1],0<K.za-K.T&&37500>ye[2]&&K.F&&K.v==0&&!K.C&&(K.C=Dr(g(K.Za,K),6e3));if(1>=uo(K.h)&&K.ca){try{K.ca()}catch{}K.ca=void 0}}else Ws(K,11)}else if((b.K||K.g==b)&&Ka(K),!I(U))for(ye=K.Da.g.parse(U),U=0;U<ye.length;U++){let zt=ye[U];if(K.T=zt[0],zt=zt[1],K.G==2)if(zt[0]=="c"){K.K=zt[1],K.ia=zt[2];const nn=zt[3];nn!=null&&(K.la=nn,K.j.info("VER="+K.la));const wn=zt[4];wn!=null&&(K.Aa=wn,K.j.info("SVER="+K.Aa));const Ii=zt[5];Ii!=null&&typeof Ii=="number"&&0<Ii&&(ae=1.5*Ii,K.L=ae,K.j.info("backChannelRequestTimeoutMs_="+ae)),ae=K;const Mn=b.g;if(Mn){const Jo=Mn.g?Mn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Jo){var Te=ae.h;Te.g||Jo.indexOf("spdy")==-1&&Jo.indexOf("quic")==-1&&Jo.indexOf("h2")==-1||(Te.j=Te.l,Te.g=new Set,Te.h&&(ln(Te,Te.h),Te.h=null))}if(ae.D){const Yi=Mn.g?Mn.g.getResponseHeader("X-HTTP-Session-Id"):null;Yi&&(ae.ya=Yi,xt(ae.I,ae.D,Yi))}}K.G=3,K.l&&K.l.ua(),K.ba&&(K.R=Date.now()-b.F,K.j.info("Handshake RTT: "+K.R+"ms")),ae=K;var ze=b;if(ae.qa=Ya(ae,ae.J?ae.ia:null,ae.W),ze.K){qo(ae.h,ze);var en=ze,zn=ae.L;zn&&(en.I=zn),en.B&&(Cn(en),It(en)),ae.g=ze}else Vr(ae);0<K.i.length&&Ai(K)}else zt[0]!="stop"&&zt[0]!="close"||Ws(K,7);else K.G==3&&(zt[0]=="stop"||zt[0]=="close"?zt[0]=="stop"?Ws(K,7):er(K):zt[0]!="noop"&&K.l&&K.l.ta(zt),K.v=0)}}qi(4)}catch{}}var yn=class{constructor(b,U){this.g=b,this.map=U}};function $i(b){this.l=b||10,l.PerformanceNavigationTiming?(b=l.performance.getEntriesByType("navigation"),b=0<b.length&&(b[0].nextHopProtocol=="hq"||b[0].nextHopProtocol=="h2")):b=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=b?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function or(b){return b.h?!0:b.g?b.g.size>=b.j:!1}function uo(b){return b.h?1:b.g?b.g.size:0}function _t(b,U){return b.h?b.h==U:b.g?b.g.has(U):!1}function ln(b,U){b.g?b.g.add(U):b.h=U}function qo(b,U){b.h&&b.h==U?b.h=null:b.g&&b.g.has(U)&&b.g.delete(U)}$i.prototype.cancel=function(){if(this.i=Bs(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const b of this.g.values())b.cancel();this.g.clear()}};function Bs(b){if(b.h!=null)return b.i.concat(b.h.D);if(b.g!=null&&b.g.size!==0){let U=b.i;for(const K of b.g.values())U=U.concat(K.D);return U}return x(b.i)}function Wi(b){if(b.V&&typeof b.V=="function")return b.V();if(typeof Map<"u"&&b instanceof Map||typeof Set<"u"&&b instanceof Set)return Array.from(b.values());if(typeof b=="string")return b.split("");if(u(b)){for(var U=[],K=b.length,ae=0;ae<K;ae++)U.push(b[ae]);return U}U=[],K=0;for(ae in b)U[K++]=b[ae];return U}function ho(b){if(b.na&&typeof b.na=="function")return b.na();if(!b.V||typeof b.V!="function"){if(typeof Map<"u"&&b instanceof Map)return Array.from(b.keys());if(!(typeof Set<"u"&&b instanceof Set)){if(u(b)||typeof b=="string"){var U=[];b=b.length;for(var K=0;K<b;K++)U.push(K);return U}U=[],K=0;for(const ae in b)U[K++]=ae;return U}}}function yt(b,U){if(b.forEach&&typeof b.forEach=="function")b.forEach(U,void 0);else if(u(b)||typeof b=="string")Array.prototype.forEach.call(b,U,void 0);else for(var K=ho(b),ae=Wi(b),ye=ae.length,Te=0;Te<ye;Te++)U.call(void 0,ae[Te],K&&K[Te],b)}var cn=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function uc(b,U){if(b){b=b.split("&");for(var K=0;K<b.length;K++){var ae=b[K].indexOf("="),ye=null;if(0<=ae){var Te=b[K].substring(0,ae);ye=b[K].substring(ae+1)}else Te=b[K];U(Te,ye?decodeURIComponent(ye.replace(/\+/g," ")):"")}}}function bi(b){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,b instanceof bi){this.h=b.h,Ho(this,b.j),this.o=b.o,this.g=b.g,Gi(this,b.s),this.l=b.l;var U=b.i,K=new Ei;K.i=U.i,U.g&&(K.g=new Map(U.g),K.h=U.h),Lr(this,K),this.m=b.m}else b&&(U=String(b).match(cn))?(this.h=!1,Ho(this,U[1]||"",!0),this.o=Ct(U[2]||""),this.g=Ct(U[3]||"",!0),Gi(this,U[4]),this.l=Ct(U[5]||"",!0),Lr(this,U[6]||"",!0),this.m=Ct(U[7]||"")):(this.h=!1,this.i=new Ei(null,this.h))}bi.prototype.toString=function(){var b=[],U=this.j;U&&b.push(wi(U,us,!0),":");var K=this.g;return(K||U=="file")&&(b.push("//"),(U=this.o)&&b.push(wi(U,us,!0),"@"),b.push(encodeURIComponent(String(K)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),K=this.s,K!=null&&b.push(":",String(K))),(K=this.l)&&(this.g&&K.charAt(0)!="/"&&b.push("/"),b.push(wi(K,K.charAt(0)=="/"?Ba:za,!0))),(K=this.i.toString())&&b.push("?",K),(K=this.m)&&b.push("#",wi(K,Wo)),b.join("")};function En(b){return new bi(b)}function Ho(b,U,K){b.j=K?Ct(U,!0):U,b.j&&(b.j=b.j.replace(/:$/,""))}function Gi(b,U){if(U){if(U=Number(U),isNaN(U)||0>U)throw Error("Bad port number "+U);b.s=U}else b.s=null}function Lr(b,U,K){U instanceof Ei?(b.i=U,Wn(b.i,b.h)):(K||(U=wi(U,$o)),b.i=new Ei(U,b.h))}function xt(b,U,K){b.i.set(U,K)}function Fr(b){return xt(b,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),b}function Ct(b,U){return b?U?decodeURI(b.replace(/%25/g,"%2525")):decodeURIComponent(b):""}function wi(b,U,K){return typeof b=="string"?(b=encodeURI(b).replace(U,Va),K&&(b=b.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),b):null}function Va(b){return b=b.charCodeAt(0),"%"+(b>>4&15).toString(16)+(b&15).toString(16)}var us=/[#\/\?@]/g,za=/[#\?:]/g,Ba=/[#\?]/g,$o=/[#\?@]/g,Wo=/#/g;function Ei(b,U){this.h=this.g=null,this.i=b||null,this.j=!!U}function Vn(b){b.g||(b.g=new Map,b.h=0,b.i&&uc(b.i,function(U,K){b.add(decodeURIComponent(U.replace(/\+/g," ")),K)}))}r=Ei.prototype,r.add=function(b,U){Vn(this),this.i=null,b=at(this,b);var K=this.g.get(b);return K||this.g.set(b,K=[]),K.push(U),this.h+=1,this};function Ti(b,U){Vn(b),U=at(b,U),b.g.has(U)&&(b.i=null,b.h-=b.g.get(U).length,b.g.delete(U))}function ri(b,U){return Vn(b),U=at(b,U),b.g.has(U)}r.forEach=function(b,U){Vn(this),this.g.forEach(function(K,ae){K.forEach(function(ye){b.call(U,ye,ae,this)},this)},this)},r.na=function(){Vn(this);const b=Array.from(this.g.values()),U=Array.from(this.g.keys()),K=[];for(let ae=0;ae<U.length;ae++){const ye=b[ae];for(let Te=0;Te<ye.length;Te++)K.push(U[ae])}return K},r.V=function(b){Vn(this);let U=[];if(typeof b=="string")ri(this,b)&&(U=U.concat(this.g.get(at(this,b))));else{b=Array.from(this.g.values());for(let K=0;K<b.length;K++)U=U.concat(b[K])}return U},r.set=function(b,U){return Vn(this),this.i=null,b=at(this,b),ri(this,b)&&(this.h-=this.g.get(b).length),this.g.set(b,[U]),this.h+=1,this},r.get=function(b,U){return b?(b=this.V(b),0<b.length?String(b[0]):U):U};function fo(b,U,K){Ti(b,U),0<K.length&&(b.i=null,b.g.set(at(b,U),x(K)),b.h+=K.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const b=[],U=Array.from(this.g.keys());for(var K=0;K<U.length;K++){var ae=U[K];const Te=encodeURIComponent(String(ae)),ze=this.V(ae);for(ae=0;ae<ze.length;ae++){var ye=Te;ze[ae]!==""&&(ye+="="+encodeURIComponent(String(ze[ae]))),b.push(ye)}}return this.i=b.join("&")};function at(b,U){return U=String(U),b.j&&(U=U.toLowerCase()),U}function Wn(b,U){U&&!b.j&&(Vn(b),b.i=null,b.g.forEach(function(K,ae){var ye=ae.toLowerCase();ae!=ye&&(Ti(this,ae),fo(this,ye,K))},b)),b.j=U}function tn(b,U){const K=new Vs;if(l.Image){const ae=new Image;ae.onload=_(vr,K,"TestLoadImage: loaded",!0,U,ae),ae.onerror=_(vr,K,"TestLoadImage: error",!1,U,ae),ae.onabort=_(vr,K,"TestLoadImage: abort",!1,U,ae),ae.ontimeout=_(vr,K,"TestLoadImage: timeout",!1,U,ae),l.setTimeout(function(){ae.ontimeout&&ae.ontimeout()},1e4),ae.src=b}else U(!1)}function dc(b,U){const K=new Vs,ae=new AbortController,ye=setTimeout(()=>{ae.abort(),vr(K,"TestPingServer: timeout",!1,U)},1e4);fetch(b,{signal:ae.signal}).then(Te=>{clearTimeout(ye),Te.ok?vr(K,"TestPingServer: ok",!0,U):vr(K,"TestPingServer: server error",!1,U)}).catch(()=>{clearTimeout(ye),vr(K,"TestPingServer: error",!1,U)})}function vr(b,U,K,ae,ye){try{ye&&(ye.onload=null,ye.onerror=null,ye.onabort=null,ye.ontimeout=null),ae(K)}catch{}}function hc(){this.g=new ti}function Ua(b,U,K){const ae=K||"";try{yt(b,function(ye,Te){let ze=ye;f(ye)&&(ze=gr(ye)),U.push(ae+Te+"="+encodeURIComponent(ze))})}catch(ye){throw U.push(ae+"type="+encodeURIComponent("_badmap")),ye}}function kr(b){this.l=b.Ub||null,this.j=b.eb||!1}E(kr,Ui),kr.prototype.g=function(){return new Us(this.l,this.j)},kr.prototype.i=function(b){return function(){return b}}({});function Us(b,U){kt.call(this),this.D=b,this.o=U,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(Us,kt),r=Us.prototype,r.open=function(b,U){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=b,this.A=U,this.readyState=1,ar(this)},r.send=function(b){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const U={headers:this.u,method:this.B,credentials:this.m,cache:void 0};b&&(U.body=b),(this.D||l).fetch(new Request(this.A,U)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,un(this)),this.readyState=0},r.Sa=function(b){if(this.g&&(this.l=b,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=b.headers,this.readyState=2,ar(this)),this.g&&(this.readyState=3,ar(this),this.g)))if(this.responseType==="arraybuffer")b.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in b){if(this.j=b.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;mo(this)}else b.text().then(this.Ra.bind(this),this.ga.bind(this))};function mo(b){b.j.read().then(b.Pa.bind(b)).catch(b.ga.bind(b))}r.Pa=function(b){if(this.g){if(this.o&&b.value)this.response.push(b.value);else if(!this.o){var U=b.value?b.value:new Uint8Array(0);(U=this.v.decode(U,{stream:!b.done}))&&(this.response=this.responseText+=U)}b.done?un(this):ar(this),this.readyState==3&&mo(this)}},r.Ra=function(b){this.g&&(this.response=this.responseText=b,un(this))},r.Qa=function(b){this.g&&(this.response=b,un(this))},r.ga=function(){this.g&&un(this)};function un(b){b.readyState=4,b.l=null,b.j=null,b.v=null,ar(b)}r.setRequestHeader=function(b,U){this.u.append(b,U)},r.getResponseHeader=function(b){return this.h&&this.h.get(b.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const b=[],U=this.h.entries();for(var K=U.next();!K.done;)K=K.value,b.push(K[0]+": "+K[1]),K=U.next();return b.join(`\r
`)};function ar(b){b.onreadystatechange&&b.onreadystatechange.call(b)}Object.defineProperty(Us.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(b){this.m=b?"include":"same-origin"}});function ds(b){let U="";return B(b,function(K,ae){U+=ae,U+=":",U+=K,U+=`\r
`}),U}function qs(b,U,K){e:{for(ae in K){var ae=!1;break e}ae=!0}ae||(K=ds(K),typeof b=="string"?K!=null&&encodeURIComponent(String(K)):xt(b,U,K))}function Tn(b){kt.call(this),this.headers=new Map,this.o=b||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(Tn,kt);var bu=/^https?$/i,Go=["POST","PUT"];r=Tn.prototype,r.Ha=function(b){this.J=b},r.ea=function(b,U,K,ae){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+b);U=U?U.toUpperCase():"GET",this.D=b,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ar.g(),this.v=this.o?lo(this.o):lo(Ar),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(U,String(b),!0),this.B=!1}catch(Te){Ko(this,Te);return}if(b=K||"",K=new Map(this.headers),ae)if(Object.getPrototypeOf(ae)===Object.prototype)for(var ye in ae)K.set(ye,ae[ye]);else if(typeof ae.keys=="function"&&typeof ae.get=="function")for(const Te of ae.keys())K.set(Te,ae.get(Te));else throw Error("Unknown input type for opt_headers: "+String(ae));ae=Array.from(K.keys()).find(Te=>Te.toLowerCase()=="content-type"),ye=l.FormData&&b instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Go,U,void 0))||ae||ye||K.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Te,ze]of K)this.g.setRequestHeader(Te,ze);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{_r(this),this.u=!0,this.g.send(b),this.u=!1}catch(Te){Ko(this,Te)}};function Ko(b,U){b.h=!1,b.g&&(b.j=!0,b.g.abort(),b.j=!1),b.l=U,b.m=5,Yo(b),ii(b)}function Yo(b){b.A||(b.A=!0,jt(b,"complete"),jt(b,"error"))}r.abort=function(b){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=b||7,jt(this,"complete"),jt(this,"abort"),ii(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ii(this,!0)),Tn.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?Rt(this):this.bb())},r.bb=function(){Rt(this)};function Rt(b){if(b.h&&typeof o<"u"&&(!b.v[1]||Jn(b)!=4||b.Z()!=2)){if(b.u&&Jn(b)==4)os(b.Ea,0,b);else if(jt(b,"readystatechange"),Jn(b)==4){b.h=!1;try{const ze=b.Z();e:switch(ze){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var U=!0;break e;default:U=!1}var K;if(!(K=U)){var ae;if(ae=ze===0){var ye=String(b.D).match(cn)[1]||null;!ye&&l.self&&l.self.location&&(ye=l.self.location.protocol.slice(0,-1)),ae=!bu.test(ye?ye.toLowerCase():"")}K=ae}if(K)jt(b,"complete"),jt(b,"success");else{b.m=6;try{var Te=2<Jn(b)?b.g.statusText:""}catch{Te=""}b.l=Te+" ["+b.Z()+"]",Yo(b)}}finally{ii(b)}}}}function ii(b,U){if(b.g){_r(b);const K=b.g,ae=b.v[0]?()=>{}:null;b.g=null,b.v=null,U||jt(b,"ready");try{K.onreadystatechange=ae}catch{}}}function _r(b){b.I&&(l.clearTimeout(b.I),b.I=null)}r.isActive=function(){return!!this.g};function Jn(b){return b.g?b.g.readyState:0}r.Z=function(){try{return 2<Jn(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(b){if(this.g){var U=this.g.responseText;return b&&U.indexOf(b)==0&&(U=U.substring(b.length)),gi(U)}};function qa(b){try{if(!b.g)return null;if("response"in b.g)return b.g.response;switch(b.H){case"":case"text":return b.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in b.g)return b.g.mozResponseArrayBuffer}return null}catch{return null}}function Ha(b){const U={};b=(b.g&&2<=Jn(b)&&b.g.getAllResponseHeaders()||"").split(`\r
`);for(let ae=0;ae<b.length;ae++){if(I(b[ae]))continue;var K=O(b[ae]);const ye=K[0];if(K=K[1],typeof K!="string")continue;K=K.trim();const Te=U[ye]||[];U[ye]=Te,Te.push(K)}P(U,function(ae){return ae.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Si(b,U,K){return K&&K.internalChannelParams&&K.internalChannelParams[b]||U}function fc(b){this.Aa=0,this.i=[],this.j=new Vs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Si("failFast",!1,b),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Si("baseRetryDelayMs",5e3,b),this.cb=Si("retryDelaySeedMs",1e4,b),this.Wa=Si("forwardChannelMaxRetries",2,b),this.wa=Si("forwardChannelRequestTimeoutMs",2e4,b),this.pa=b&&b.xmlHttpFactory||void 0,this.Xa=b&&b.Tb||void 0,this.Ca=b&&b.useFetchStreams||!1,this.L=void 0,this.J=b&&b.supportsCrossDomainXhr||!1,this.K="",this.h=new $i(b&&b.concurrentRequestLimit),this.Da=new hc,this.P=b&&b.fastHandshake||!1,this.O=b&&b.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=b&&b.Rb||!1,b&&b.xa&&this.j.xa(),b&&b.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&b&&b.detectBufferingProxy||!1,this.ja=void 0,b&&b.longPollingTimeout&&0<b.longPollingTimeout&&(this.ja=b.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=fc.prototype,r.la=8,r.G=1,r.connect=function(b,U,K,ae){xn(0),this.W=b,this.H=U||{},K&&ae!==void 0&&(this.H.OSID=K,this.H.OAID=ae),this.F=this.X,this.I=Ya(this,null,this.W),Ai(this)};function er(b){if($a(b),b.G==3){var U=b.U++,K=En(b.I);if(xt(K,"SID",b.K),xt(K,"RID",U),xt(K,"TYPE","terminate"),Hs(b,K),U=new Nr(b,b.j,U),U.L=2,U.v=Fr(En(K)),K=!1,l.navigator&&l.navigator.sendBeacon)try{K=l.navigator.sendBeacon(U.v.toString(),"")}catch{}!K&&l.Image&&(new Image().src=U.v,K=!0),K||(U.g=Eu(U.j,null),U.g.ea(U.v)),U.F=Date.now(),It(U)}wu(b)}function Ki(b){b.g&&(Wa(b),b.g.cancel(),b.g=null)}function $a(b){Ki(b),b.u&&(l.clearTimeout(b.u),b.u=null),Ka(b),b.h.cancel(),b.s&&(typeof b.s=="number"&&l.clearTimeout(b.s),b.s=null)}function Ai(b){if(!or(b.h)&&!b.s){b.s=!0;var U=b.Ga;oe||Y(),ee||(oe(),ee=!0),J.add(U,b),b.B=0}}function ih(b,U){return uo(b.h)>=b.h.j-(b.s?1:0)?!1:b.s?(b.i=U.D.concat(b.i),!0):b.G==1||b.G==2||b.B>=(b.Va?0:b.Wa)?!1:(b.s=Dr(g(b.Ga,b,U),mc(b,b.B)),b.B++,!0)}r.Ga=function(b){if(this.s)if(this.s=null,this.G==1){if(!b){this.U=Math.floor(1e5*Math.random()),b=this.U++;const ye=new Nr(this,this.j,b);let Te=this.o;if(this.S&&(Te?(Te=k(Te),j(Te,this.S)):Te=this.S),this.m!==null||this.O||(ye.H=Te,Te=null),this.P)e:{for(var U=0,K=0;K<this.i.length;K++){t:{var ae=this.i[K];if("__data__"in ae.map&&(ae=ae.map.__data__,typeof ae=="string")){ae=ae.length;break t}ae=void 0}if(ae===void 0)break;if(U+=ae,4096<U){U=K;break e}if(U===4096||K===this.i.length-1){U=K+1;break e}}U=1e3}else U=1e3;U=$s(this,ye,U),K=En(this.I),xt(K,"RID",b),xt(K,"CVER",22),this.D&&xt(K,"X-HTTP-Session-Id",this.D),Hs(this,K),Te&&(this.O?U="headers="+encodeURIComponent(String(ds(Te)))+"&"+U:this.m&&qs(K,this.m,Te)),ln(this.h,ye),this.Ua&&xt(K,"TYPE","init"),this.P?(xt(K,"$req",U),xt(K,"SID","null"),ye.T=!0,fe(ye,K,null)):fe(ye,K,U),this.G=2}}else this.G==3&&(b?Pr(this,b):this.i.length==0||or(this.h)||Pr(this))};function Pr(b,U){var K;U?K=U.l:K=b.U++;const ae=En(b.I);xt(ae,"SID",b.K),xt(ae,"RID",K),xt(ae,"AID",b.T),Hs(b,ae),b.m&&b.o&&qs(ae,b.m,b.o),K=new Nr(b,b.j,K,b.B+1),b.m===null&&(K.H=b.o),U&&(b.i=U.D.concat(b.i)),U=$s(b,K,1e3),K.I=Math.round(.5*b.wa)+Math.round(.5*b.wa*Math.random()),ln(b.h,K),fe(K,ae,U)}function Hs(b,U){b.H&&B(b.H,function(K,ae){xt(U,ae,K)}),b.l&&yt({},function(K,ae){xt(U,ae,K)})}function $s(b,U,K){K=Math.min(b.i.length,K);var ae=b.l?g(b.l.Na,b.l,b):null;e:{var ye=b.i;let Te=-1;for(;;){const ze=["count="+K];Te==-1?0<K?(Te=ye[0].g,ze.push("ofs="+Te)):Te=0:ze.push("ofs="+Te);let en=!0;for(let zn=0;zn<K;zn++){let zt=ye[zn].g;const nn=ye[zn].map;if(zt-=Te,0>zt)Te=Math.max(0,ye[zn].g-100),en=!1;else try{Ua(nn,ze,"req"+zt+"_")}catch{ae&&ae(nn)}}if(en){ae=ze.join("&");break e}}}return b=b.i.splice(0,K),U.D=b,ae}function Vr(b){if(!b.g&&!b.u){b.Y=1;var U=b.Fa;oe||Y(),ee||(oe(),ee=!0),J.add(U,b),b.v=0}}function Zo(b){return b.g||b.u||3<=b.v?!1:(b.Y++,b.u=Dr(g(b.Fa,b),mc(b,b.v)),b.v++,!0)}r.Fa=function(){if(this.u=null,Ga(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var b=2*this.R;this.j.info("BP detection timer enabled: "+b),this.A=Dr(g(this.ab,this),b)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,xn(10),Ki(this),Ga(this))};function Wa(b){b.A!=null&&(l.clearTimeout(b.A),b.A=null)}function Ga(b){b.g=new Nr(b,b.j,"rpc",b.Y),b.m===null&&(b.g.H=b.o),b.g.O=0;var U=En(b.qa);xt(U,"RID","rpc"),xt(U,"SID",b.K),xt(U,"AID",b.T),xt(U,"CI",b.F?"0":"1"),!b.F&&b.ja&&xt(U,"TO",b.ja),xt(U,"TYPE","xmlhttp"),Hs(b,U),b.m&&b.o&&qs(U,b.m,b.o),b.L&&(b.g.I=b.L);var K=b.g;b=b.ia,K.L=1,K.v=Fr(En(U)),K.m=null,K.P=!0,je(K,b)}r.Za=function(){this.C!=null&&(this.C=null,Ki(this),Zo(this),xn(19))};function Ka(b){b.C!=null&&(l.clearTimeout(b.C),b.C=null)}function Qo(b,U){var K=null;if(b.g==U){Ka(b),Wa(b),b.g=null;var ae=2}else if(_t(b.h,U))K=U.D,qo(b.h,U),ae=1;else return;if(b.G!=0){if(U.o)if(ae==1){K=U.m?U.m.length:0,U=Date.now()-U.F;var ye=b.B;ae=gn(),jt(ae,new Fs(ae,K)),Ai(b)}else Vr(b);else if(ye=U.s,ye==3||ye==0&&0<U.X||!(ae==1&&ih(b,U)||ae==2&&Zo(b)))switch(K&&0<K.length&&(U=b.h,U.i=U.i.concat(K)),ye){case 1:Ws(b,5);break;case 4:Ws(b,10);break;case 3:Ws(b,6);break;default:Ws(b,2)}}}function mc(b,U){let K=b.Ta+Math.floor(Math.random()*b.cb);return b.isActive()||(K*=2),K*U}function Ws(b,U){if(b.j.info("Error code "+U),U==2){var K=g(b.fb,b),ae=b.Xa;const ye=!ae;ae=new bi(ae||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||Ho(ae,"https"),Fr(ae),ye?tn(ae.toString(),K):dc(ae.toString(),K)}else xn(2);b.G=0,b.l&&b.l.sa(U),wu(b),$a(b)}r.fb=function(b){b?(this.j.info("Successfully pinged google.com"),xn(2)):(this.j.info("Failed to ping google.com"),xn(1))};function wu(b){if(b.G=0,b.ka=[],b.l){const U=Bs(b.h);(U.length!=0||b.i.length!=0)&&(w(b.ka,U),w(b.ka,b.i),b.h.i.length=0,x(b.i),b.i.length=0),b.l.ra()}}function Ya(b,U,K){var ae=K instanceof bi?En(K):new bi(K);if(ae.g!="")U&&(ae.g=U+"."+ae.g),Gi(ae,ae.s);else{var ye=l.location;ae=ye.protocol,U=U?U+"."+ye.hostname:ye.hostname,ye=+ye.port;var Te=new bi(null);ae&&Ho(Te,ae),U&&(Te.g=U),ye&&Gi(Te,ye),K&&(Te.l=K),ae=Te}return K=b.D,U=b.ya,K&&U&&xt(ae,K,U),xt(ae,"VER",b.la),Hs(b,ae),ae}function Eu(b,U,K){if(U&&!b.J)throw Error("Can't create secondary domain capable XhrIo object.");return U=b.Ca&&!b.pa?new Tn(new kr({eb:K})):new Tn(b.pa),U.Ha(b.J),U}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function Za(){}r=Za.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function Xo(){}Xo.prototype.g=function(b,U){return new tr(b,U)};function tr(b,U){kt.call(this),this.g=new fc(U),this.l=b,this.h=U&&U.messageUrlParams||null,b=U&&U.messageHeaders||null,U&&U.clientProtocolHeaderRequired&&(b?b["X-Client-Protocol"]="webchannel":b={"X-Client-Protocol":"webchannel"}),this.g.o=b,b=U&&U.initMessageHeaders||null,U&&U.messageContentType&&(b?b["X-WebChannel-Content-Type"]=U.messageContentType:b={"X-WebChannel-Content-Type":U.messageContentType}),U&&U.va&&(b?b["X-WebChannel-Client-Profile"]=U.va:b={"X-WebChannel-Client-Profile":U.va}),this.g.S=b,(b=U&&U.Sb)&&!I(b)&&(this.g.m=b),this.v=U&&U.supportsCrossDomainXhr||!1,this.u=U&&U.sendRawJson||!1,(U=U&&U.httpSessionIdParam)&&!I(U)&&(this.g.D=U,b=this.h,b!==null&&U in b&&(b=this.h,U in b&&delete b[U])),this.j=new zr(this)}E(tr,kt),tr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},tr.prototype.close=function(){er(this.g)},tr.prototype.o=function(b){var U=this.g;if(typeof b=="string"){var K={};K.__data__=b,b=K}else this.u&&(K={},K.__data__=gr(b),b=K);U.i.push(new yn(U.Ya++,b)),U.G==3&&Ai(U)},tr.prototype.N=function(){this.g.l=null,delete this.j,er(this.g),delete this.g,tr.aa.N.call(this)};function hs(b){ni.call(this),b.__headers__&&(this.headers=b.__headers__,this.statusCode=b.__status__,delete b.__headers__,delete b.__status__);var U=b.__sm__;if(U){e:{for(const K in U){b=K;break e}b=void 0}(this.i=b)&&(b=this.i,U=U!==null&&b in U?U[b]:void 0),this.data=U}else this.data=b}E(hs,ni);function Tu(){vi.call(this),this.status=1}E(Tu,vi);function zr(b){this.g=b}E(zr,Za),zr.prototype.ua=function(){jt(this.g,"a")},zr.prototype.ta=function(b){jt(this.g,new hs(b))},zr.prototype.sa=function(b){jt(this.g,new Tu)},zr.prototype.ra=function(){jt(this.g,"b")},Xo.prototype.createWebChannel=Xo.prototype.g,tr.prototype.send=tr.prototype.o,tr.prototype.open=tr.prototype.m,tr.prototype.close=tr.prototype.close,pk=function(){return new Xo},mk=function(){return gn()},fk=_i,ix={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},cs.NO_ERROR=0,cs.TIMEOUT=8,cs.HTTP_ERROR=6,ag=cs,yr.COMPLETE="complete",hk=yr,yi.EventType=Qn,Qn.OPEN="a",Qn.CLOSE="b",Qn.ERROR="c",Qn.MESSAGE="d",kt.prototype.listen=kt.prototype.K,rf=yi,Tn.prototype.listenOnce=Tn.prototype.L,Tn.prototype.getLastError=Tn.prototype.Ka,Tn.prototype.getLastErrorCode=Tn.prototype.Ba,Tn.prototype.getStatus=Tn.prototype.Z,Tn.prototype.getResponseJson=Tn.prototype.Oa,Tn.prototype.getResponseText=Tn.prototype.oa,Tn.prototype.send=Tn.prototype.ea,Tn.prototype.setWithCredentials=Tn.prototype.Ha,dk=Tn}).apply(typeof Pp<"u"?Pp:typeof self<"u"?self:typeof window<"u"?window:{});const fT="@firebase/firestore",mT="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tr=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Tr.UNAUTHENTICATED=new Tr(null),Tr.GOOGLE_CREDENTIALS=new Tr("google-credentials-uid"),Tr.FIRST_PARTY=new Tr("first-party-uid"),Tr.MOCK_USER=new Tr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qd="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tu=new Jx("@firebase/firestore");function ad(){return tu.logLevel}function Re(r,...e){if(tu.logLevel<=Bt.DEBUG){const t=e.map(db);tu.debug(`Firestore (${qd}): ${r}`,...t)}}function Kn(r,...e){if(tu.logLevel<=Bt.ERROR){const t=e.map(db);tu.error(`Firestore (${qd}): ${r}`,...t)}}function nu(r,...e){if(tu.logLevel<=Bt.WARN){const t=e.map(db);tu.warn(`Firestore (${qd}): ${r}`,...t)}}function db(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ye(r,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,gk(r,n,t)}function gk(r,e,t){let n=`FIRESTORE (${qd}) INTERNAL ASSERTION FAILED: ${e} (ID: ${r.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw Kn(n),new Error(n)}function it(r,e,t,n){let i="Unexpected state";typeof t=="string"?i=t:n=t,r||gk(e,i,n)}function Je(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Be extends Lo{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ao{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yk{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class PM{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Tr.UNAUTHENTICATED))}shutdown(){}}class CM{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class RM{constructor(e){this.t=e,this.currentUser=Tr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){it(this.o===void 0,42304);let n=this.i;const i=u=>this.i!==n?(n=this.i,t(u)):Promise.resolve();let s=new ao;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new ao,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const u=s;e.enqueueRetryable(async()=>{await u.promise,await i(this.currentUser)})},l=u=>{Re("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=u,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(u=>l(u)),setTimeout(()=>{if(!this.auth){const u=this.t.getImmediate({optional:!0});u?l(u):(Re("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new ao)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(Re("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(it(typeof n.accessToken=="string",31837,{l:n}),new yk(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return it(e===null||typeof e=="string",2055,{h:e}),new Tr(e)}}class OM{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Tr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class jM{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new OM(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Tr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class pT{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class MM{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ui(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){it(this.o===void 0,3512);const n=s=>{s.error!=null&&Re("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,Re("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Re("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):Re("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new pT(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(it(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new pT(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DM(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vk(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _k{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=DM(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+=e.charAt(i[s]%62))}return n}}function vt(r,e){return r<e?-1:r>e?1:0}function sx(r,e){let t=0;for(;t<r.length&&t<e.length;){const n=r.codePointAt(t),i=e.codePointAt(t);if(n!==i){if(n<128&&i<128)return vt(n,i);{const s=vk(),o=LM(s.encode(gT(r,t)),s.encode(gT(e,t)));return o!==0?o:vt(n,i)}}t+=n>65535?2:1}return vt(r.length,e.length)}function gT(r,e){return r.codePointAt(e)>65535?r.substring(e,e+2):r.substring(e,e+1)}function LM(r,e){for(let t=0;t<r.length&&t<e.length;++t)if(r[t]!==e[t])return vt(r[t],e[t]);return vt(r.length,e.length)}function xd(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}function xk(r){return r+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yT=-62135596800,vT=1e6;class Ot{static now(){return Ot.fromMillis(Date.now())}static fromDate(e){return Ot.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*vT);return new Ot(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Be(Ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Be(Ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<yT)throw new Be(Ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Be(Ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/vT}_compareTo(e){return this.seconds===e.seconds?vt(this.nanoseconds,e.nanoseconds):vt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-yT;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lt{static fromTimestamp(e){return new lt(e)}static min(){return new lt(new Ot(0,0))}static max(){return new lt(new Ot(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _T="__name__";class Io{constructor(e,t,n){t===void 0?t=0:t>e.length&&Ye(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&Ye(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return Io.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Io?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const s=Io.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return vt(e.length,t.length)}static compareSegments(e,t){const n=Io.isNumericId(e),i=Io.isNumericId(t);return n&&!i?-1:!n&&i?1:n&&i?Io.extractNumericId(e).compare(Io.extractNumericId(t)):sx(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Fl.fromString(e.substring(4,e.length-2))}}class sn extends Io{construct(e,t,n){return new sn(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Be(Ne.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new sn(t)}static emptyPath(){return new sn([])}}const FM=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Fn extends Io{construct(e,t,n){return new Fn(e,t,n)}static isValidIdentifier(e){return FM.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Fn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===_T}static keyField(){return new Fn([_T])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(n.length===0)throw new Be(Ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new Be(Ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const u=e[i+1];if(u!=="\\"&&u!=="."&&u!=="`")throw new Be(Ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=u,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(n+=l,i++):(s(),i++)}if(s(),o)throw new Be(Ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Fn(t)}static emptyPath(){return new Fn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qe{constructor(e){this.path=e}static fromPath(e){return new qe(sn.fromString(e))}static fromName(e){return new qe(sn.fromString(e).popFirst(5))}static empty(){return new qe(sn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&sn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return sn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new qe(new sn(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bd=-1;class jg{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}}function ox(r){return r.fields.find(e=>e.kind===2)}function Dc(r){return r.fields.filter(e=>e.kind!==2)}jg.UNKNOWN_ID=-1;class lg{constructor(e,t){this.fieldPath=e,this.kind=t}}class Vf{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Vf(0,ss.min())}}function bk(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=lt.fromTimestamp(n===1e9?new Ot(t+1,0):new Ot(t,n));return new ss(i,qe.empty(),e)}function wk(r){return new ss(r.readTime,r.key,bd)}class ss{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new ss(lt.min(),qe.empty(),bd)}static max(){return new ss(lt.max(),qe.empty(),bd)}}function hb(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=qe.comparator(r.documentKey,e.documentKey),t!==0?t:vt(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ek="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Tk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function nc(r){if(r.code!==Ne.FAILED_PRECONDITION||r.message!==Ek)throw r;Re("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ye(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ve((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ve?t:ve.resolve(t)}catch(t){return ve.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ve.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ve.reject(t)}static resolve(e){return new ve((t,n)=>{t(e)})}static reject(e){return new ve((t,n)=>{n(e)})}static waitFor(e){return new ve((t,n)=>{let i=0,s=0,o=!1;e.forEach(l=>{++i,l.next(()=>{++s,o&&s===i&&t()},u=>n(u))}),o=!0,s===i&&t()})}static or(e){let t=ve.resolve(!1);for(const n of e)t=t.next(i=>i?ve.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,s)=>{n.push(t.call(this,i,s))}),this.waitFor(n)}static mapArray(e,t){return new ve((n,i)=>{const s=e.length,o=new Array(s);let l=0;for(let u=0;u<s;u++){const f=u;t(e[f]).next(m=>{o[f]=m,++l,l===s&&n(o)},m=>i(m))}})}static doWhile(e,t){return new ve((n,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):n()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ts="SimpleDb";class Ny{static open(e,t,n,i){try{return new Ny(t,e.transaction(i,n))}catch(s){throw new xf(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new ao,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new xf(e,t.error)):this.S.resolve()},this.transaction.onerror=n=>{const i=fb(n.target.error);this.S.reject(new xf(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Re(ts,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new zM(t)}}class Vl{static delete(e){return Re(ts,"Removing database:",e),zc(m4().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!w4())return!1;if(Vl.F())return!0;const e=mr(),t=Vl.M(e),n=0<t&&t<10,i=Sk(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.B=n,this.L=null,Vl.M(mr())===12.2&&Kn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(Re(ts,"Opening database:",this.name),this.db=await new Promise((t,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;t(o)},i.onblocked=()=>{n(new xf(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?n(new Be(Ne.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?n(new Be(Ne.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):n(new xf(e,o))},i.onupgradeneeded=s=>{Re(ts,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;if(this.L!==null&&this.L!==s.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${s.oldVersion}, event.newVersion=${s.newVersion}, db.version=${o.version}`);this.B.q(o,i.transaction,s.oldVersion,this.version).next(()=>{Re(ts,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",t=>{const n=t.target;this.L=n.version},{passive:!0})),this.$&&(this.db.onversionchange=t=>this.$(t)),this.db}U(e){this.$=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,i){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.k(e);const l=Ny.open(this.db,e,s?"readonly":"readwrite",n),u=i(l).next(f=>(l.v(),f)).catch(f=>(l.abort(f),ve.reject(f))).toPromise();return u.catch(()=>{}),await l.D,u}catch(l){const u=l,f=u.name!=="FirebaseError"&&o<3;if(Re(ts,"Transaction failed with error:",u.message,"Retrying:",f),this.close(),!f)return Promise.reject(u)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Sk(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class VM{constructor(e){this.K=e,this.W=!1,this.G=null}get isDone(){return this.W}get j(){return this.G}set cursor(e){this.K=e}done(){this.W=!0}H(e){this.G=e}delete(){return zc(this.K.delete())}}class xf extends Be{constructor(e,t){super(Ne.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function rc(r){return r.name==="IndexedDbTransactionError"}class zM{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(Re(ts,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(Re(ts,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),zc(n)}add(e){return Re(ts,"ADD",this.store.name,e,e),zc(this.store.add(e))}get(e){return zc(this.store.get(e)).next(t=>(t===void 0&&(t=null),Re(ts,"GET",this.store.name,e,t),t))}delete(e){return Re(ts,"DELETE",this.store.name,e),zc(this.store.delete(e))}count(){return Re(ts,"COUNT",this.store.name),zc(this.store.count())}J(e,t){const n=this.options(e,t),i=n.index?this.store.index(n.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(n.range);return new ve((o,l)=>{s.onerror=u=>{l(u.target.error)},s.onsuccess=u=>{o(u.target.result)}})}{const s=this.cursor(n),o=[];return this.Y(s,(l,u)=>{o.push(u)}).next(()=>o)}}Z(e,t){const n=this.store.getAll(e,t===null?void 0:t);return new ve((i,s)=>{n.onerror=o=>{s(o.target.error)},n.onsuccess=o=>{i(o.target.result)}})}X(e,t){Re(ts,"DELETE ALL",this.store.name);const n=this.options(e,t);n.ee=!1;const i=this.cursor(n);return this.Y(i,(s,o,l)=>l.delete())}te(e,t){let n;t?n=e:(n={},t=e);const i=this.cursor(n);return this.Y(i,t)}ne(e){const t=this.cursor({});return new ve((n,i)=>{t.onerror=s=>{const o=fb(s.target.error);i(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():n()}):n()}})}Y(e,t){const n=[];return new ve((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void i();const u=new VM(l),f=t(l.primaryKey,l.value,u);if(f instanceof ve){const m=f.catch(y=>(u.done(),ve.reject(y)));n.push(m)}u.isDone?i():u.j===null?l.continue():l.continue(u.j)}}).next(()=>ve.waitFor(n))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.ee?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function zc(r){return new ve((e,t)=>{r.onsuccess=n=>{const i=n.target.result;e(i)},r.onerror=n=>{const i=fb(n.target.error);t(i)}})}let xT=!1;function fb(r){const e=Vl.M(mr());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(r.message.indexOf(t)>=0){const n=new Be("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return xT||(xT=!0,setTimeout(()=>{throw n},0)),n}}return r}const bf="IndexBackfiller";class BM{constructor(e,t){this.asyncQueue=e,this.re=t,this.task=null}start(){this.ie(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ie(e){Re(bf,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.re.se();Re(bf,`Documents written: ${t}`)}catch(t){rc(t)?Re(bf,"Ignoring IndexedDB error during index backfill: ",t):await nc(t)}await this.ie(6e4)})}}class UM{constructor(e,t){this.localStore=e,this.persistence=t}async se(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.oe(t,e))}oe(e,t){const n=new Set;let i=t,s=!0;return ve.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!n.has(o))return Re(bf,`Processing collection: ${o}`),this._e(e,o,i).next(l=>{i-=l,n.add(o)});s=!1})).next(()=>t-i)}_e(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,n).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ae(i,s)).next(l=>(Re(bf,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l))).next(()=>o.size)}))}ae(e,t){let n=e;return t.changes.forEach((i,s)=>{const o=wk(s);hb(o,n)>0&&(n=o)}),new ss(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Li{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ue(n),this.ce=n=>t.writeSequenceNumber(n))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}Li.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gc=-1;function ky(r){return r==null}function zf(r){return r===0&&1/r==-1/0}function Ak(r){return typeof r=="number"&&Number.isInteger(r)&&!zf(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mg="";function Xr(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=bT(e)),e=qM(r.get(t),e);return bT(e)}function qM(r,e){let t=e;const n=r.length;for(let i=0;i<n;i++){const s=r.charAt(i);switch(s){case"\0":t+="";break;case Mg:t+="";break;default:t+=s}}return t}function bT(r){return r+Mg+""}function ko(r){const e=r.length;if(it(e>=2,64408,{path:r}),e===2)return it(r.charAt(0)===Mg&&r.charAt(1)==="",56145,{path:r}),sn.emptyPath();const t=e-2,n=[];let i="";for(let s=0;s<e;){const o=r.indexOf(Mg,s);switch((o<0||o>t)&&Ye(50515,{path:r}),r.charAt(o+1)){case"":const l=r.substring(s,o);let u;i.length===0?u=l:(i+=l,u=i,i=""),n.push(u);break;case"":i+=r.substring(s,o),i+="\0";break;case"":i+=r.substring(s,o+1);break;default:Ye(61167,{path:r})}s=o+2}return new sn(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lc="remoteDocuments",mm="owner",Zu="owner",Bf="mutationQueues",HM="userId",ro="mutations",wT="batchId",$c="userMutationsIndex",ET=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cg(r,e){return[r,Xr(e)]}function Ik(r,e,t){return[r,Xr(e),t]}const $M={},wd="documentMutations",Dg="remoteDocumentsV14",WM=["prefixPath","collectionGroup","readTime","documentId"],ug="documentKeyIndex",GM=["prefixPath","collectionGroup","documentId"],Nk="collectionGroupIndex",KM=["collectionGroup","readTime","prefixPath","documentId"],Uf="remoteDocumentGlobal",ax="remoteDocumentGlobalKey",Ed="targets",kk="queryTargetsIndex",YM=["canonicalId","targetId"],Td="targetDocuments",ZM=["targetId","path"],mb="documentTargetsIndex",QM=["path","targetId"],Lg="targetGlobalKey",Kc="targetGlobal",qf="collectionParents",XM=["collectionId","parent"],Sd="clientMetadata",JM="clientId",Py="bundles",eD="bundleId",Cy="namedQueries",tD="name",pb="indexConfiguration",nD="indexId",lx="collectionGroupIndex",rD="collectionGroup",wf="indexState",iD=["indexId","uid"],Pk="sequenceNumberIndex",sD=["uid","sequenceNumber"],Ef="indexEntries",oD=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Ck="documentKeyIndex",aD=["indexId","uid","orderedDocumentKey"],Ry="documentOverlays",lD=["userId","collectionPath","documentId"],cx="collectionPathOverlayIndex",cD=["userId","collectionPath","largestBatchId"],Rk="collectionGroupOverlayIndex",uD=["userId","collectionGroup","largestBatchId"],gb="globals",dD="name",Ok=[Bf,ro,wd,Lc,Ed,mm,Kc,Td,Sd,Uf,qf,Py,Cy],hD=[...Ok,Ry],jk=[Bf,ro,wd,Dg,Ed,mm,Kc,Td,Sd,Uf,qf,Py,Cy,Ry],Mk=jk,yb=[...Mk,pb,wf,Ef],fD=yb,Dk=[...yb,gb],mD=Dk;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ux extends Tk{constructor(e,t){super(),this.he=e,this.currentSequenceNumber=t}}function pr(r,e){const t=Je(r);return Vl.N(t.he,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TT(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function ic(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function pD(r,e){const t=[];for(const n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.push(e(r[n],n,r));return t}function Lk(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class An{constructor(e,t){this.comparator=e,this.root=t||Or.EMPTY}insert(e,t){return new An(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Or.BLACK,null,null))}remove(e){return new An(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Or.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Cp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Cp(this.root,e,this.comparator,!1)}getReverseIterator(){return new Cp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Cp(this.root,e,this.comparator,!0)}}class Cp{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Or{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??Or.RED,this.left=i??Or.EMPTY,this.right=s??Or.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new Or(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Or.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Or.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Or.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Or.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ye(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ye(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ye(27949);return e+(this.isRed()?0:1)}}Or.EMPTY=null,Or.RED=!0,Or.BLACK=!1;Or.EMPTY=new class{constructor(){this.size=0}get key(){throw Ye(57766)}get value(){throw Ye(16141)}get color(){throw Ye(16727)}get left(){throw Ye(29726)}get right(){throw Ye(36894)}copy(e,t,n,i,s){return this}insert(e,t,n){return new Or(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mn{constructor(e){this.comparator=e,this.data=new An(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ST(this.data.getIterator())}getIteratorFrom(e){return new ST(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof mn)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new mn(this.comparator);return t.data=e,t}}class ST{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Qu(r){return r.hasNext()?r.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fi{constructor(e){this.fields=e,e.sort(Fn.comparator)}static empty(){return new Fi([])}unionWith(e){let t=new mn(Fn.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Fi(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return xd(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Fk("Invalid base64 string: "+s):s}}(e);return new Zn(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Zn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return vt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Zn.EMPTY_BYTE_STRING=new Zn("");const gD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Sa(r){if(it(!!r,39018),typeof r=="string"){let e=0;const t=gD.exec(r);if(it(!!t,46558,{timestamp:r}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:On(r.seconds),nanos:On(r.nanos)}}function On(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function Aa(r){return typeof r=="string"?Zn.fromBase64String(r):Zn.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vk="server_timestamp",zk="__type__",Bk="__previous_value__",Uk="__local_write_time__";function vb(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[zk])===null||t===void 0?void 0:t.stringValue)===Vk}function Oy(r){const e=r.mapValue.fields[Bk];return vb(e)?Oy(e):e}function Hf(r){const e=Sa(r.mapValue.fields[Uk].timestampValue);return new Ot(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yD{constructor(e,t,n,i,s,o,l,u,f,m){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=u,this.useFetchStreams=f,this.isUsingEmulator=m}}const Fg="(default)";class ru{constructor(e,t){this.projectId=e,this.database=t||Fg}static empty(){return new ru("","")}get isDefaultDatabase(){return this.database===Fg}isEqual(e){return e instanceof ru&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _b="__type__",qk="__max__",Cl={mapValue:{fields:{__type__:{stringValue:qk}}}},xb="__vector__",Ad="value",dg={nullValue:"NULL_VALUE"};function Hl(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?vb(r)?4:Hk(r)?9007199254740991:jy(r)?10:11:Ye(28295,{value:r})}function Mo(r,e){if(r===e)return!0;const t=Hl(r);if(t!==Hl(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return Hf(r).isEqual(Hf(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Sa(i.timestampValue),l=Sa(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(i,s){return Aa(i.bytesValue).isEqual(Aa(s.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,s){return On(i.geoPointValue.latitude)===On(s.geoPointValue.latitude)&&On(i.geoPointValue.longitude)===On(s.geoPointValue.longitude)}(r,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return On(i.integerValue)===On(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=On(i.doubleValue),l=On(s.doubleValue);return o===l?zf(o)===zf(l):isNaN(o)&&isNaN(l)}return!1}(r,e);case 9:return xd(r.arrayValue.values||[],e.arrayValue.values||[],Mo);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(TT(o)!==TT(l))return!1;for(const u in o)if(o.hasOwnProperty(u)&&(l[u]===void 0||!Mo(o[u],l[u])))return!1;return!0}(r,e);default:return Ye(52216,{left:r})}}function $f(r,e){return(r.values||[]).find(t=>Mo(t,e))!==void 0}function $l(r,e){if(r===e)return 0;const t=Hl(r),n=Hl(e);if(t!==n)return vt(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return vt(r.booleanValue,e.booleanValue);case 2:return function(s,o){const l=On(s.integerValue||s.doubleValue),u=On(o.integerValue||o.doubleValue);return l<u?-1:l>u?1:l===u?0:isNaN(l)?isNaN(u)?0:-1:1}(r,e);case 3:return AT(r.timestampValue,e.timestampValue);case 4:return AT(Hf(r),Hf(e));case 5:return sx(r.stringValue,e.stringValue);case 6:return function(s,o){const l=Aa(s),u=Aa(o);return l.compareTo(u)}(r.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),u=o.split("/");for(let f=0;f<l.length&&f<u.length;f++){const m=vt(l[f],u[f]);if(m!==0)return m}return vt(l.length,u.length)}(r.referenceValue,e.referenceValue);case 8:return function(s,o){const l=vt(On(s.latitude),On(o.latitude));return l!==0?l:vt(On(s.longitude),On(o.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return IT(r.arrayValue,e.arrayValue);case 10:return function(s,o){var l,u,f,m;const y=s.fields||{},g=o.fields||{},_=(l=y[Ad])===null||l===void 0?void 0:l.arrayValue,E=(u=g[Ad])===null||u===void 0?void 0:u.arrayValue,x=vt(((f=_==null?void 0:_.values)===null||f===void 0?void 0:f.length)||0,((m=E==null?void 0:E.values)===null||m===void 0?void 0:m.length)||0);return x!==0?x:IT(_,E)}(r.mapValue,e.mapValue);case 11:return function(s,o){if(s===Cl.mapValue&&o===Cl.mapValue)return 0;if(s===Cl.mapValue)return 1;if(o===Cl.mapValue)return-1;const l=s.fields||{},u=Object.keys(l),f=o.fields||{},m=Object.keys(f);u.sort(),m.sort();for(let y=0;y<u.length&&y<m.length;++y){const g=sx(u[y],m[y]);if(g!==0)return g;const _=$l(l[u[y]],f[m[y]]);if(_!==0)return _}return vt(u.length,m.length)}(r.mapValue,e.mapValue);default:throw Ye(23264,{Pe:t})}}function AT(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return vt(r,e);const t=Sa(r),n=Sa(e),i=vt(t.seconds,n.seconds);return i!==0?i:vt(t.nanos,n.nanos)}function IT(r,e){const t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){const s=$l(t[i],n[i]);if(s)return s}return vt(t.length,n.length)}function Id(r){return dx(r)}function dx(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const n=Sa(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return Aa(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return qe.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(const s of t.values||[])i?i=!1:n+=",",n+=dx(s);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){const n=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of n)s?s=!1:i+=",",i+=`${o}:${dx(t.fields[o])}`;return i+"}"}(r.mapValue):Ye(61005,{value:r})}function hg(r){switch(Hl(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Oy(r);return e?16+hg(e):16;case 5:return 2*r.stringValue.length;case 6:return Aa(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,s)=>i+hg(s),0)}(r.arrayValue);case 10:case 11:return function(n){let i=0;return ic(n.fields,(s,o)=>{i+=s.length+hg(o)}),i}(r.mapValue);default:throw Ye(13486,{value:r})}}function Wf(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function hx(r){return!!r&&"integerValue"in r}function Gf(r){return!!r&&"arrayValue"in r}function NT(r){return!!r&&"nullValue"in r}function kT(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function fg(r){return!!r&&"mapValue"in r}function jy(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[_b])===null||t===void 0?void 0:t.stringValue)===xb}function Tf(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return ic(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Tf(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Tf(r.arrayValue.values[t]);return e}return Object.assign({},r)}function Hk(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===qk}const $k={mapValue:{fields:{[_b]:{stringValue:xb},[Ad]:{arrayValue:{}}}}};function vD(r){return"nullValue"in r?dg:"booleanValue"in r?{booleanValue:!1}:"integerValue"in r||"doubleValue"in r?{doubleValue:NaN}:"timestampValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in r?{stringValue:""}:"bytesValue"in r?{bytesValue:""}:"referenceValue"in r?Wf(ru.empty(),qe.empty()):"geoPointValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in r?{arrayValue:{}}:"mapValue"in r?jy(r)?$k:{mapValue:{}}:Ye(35942,{value:r})}function _D(r){return"nullValue"in r?{booleanValue:!1}:"booleanValue"in r?{doubleValue:NaN}:"integerValue"in r||"doubleValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in r?{stringValue:""}:"stringValue"in r?{bytesValue:""}:"bytesValue"in r?Wf(ru.empty(),qe.empty()):"referenceValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in r?{arrayValue:{}}:"arrayValue"in r?$k:"mapValue"in r?jy(r)?{mapValue:{}}:Cl:Ye(61959,{value:r})}function PT(r,e){const t=$l(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?-1:!r.inclusive&&e.inclusive?1:0}function CT(r,e){const t=$l(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?1:!r.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yr{constructor(e){this.value=e}static empty(){return new Yr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!fg(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Tf(t)}setAll(e){let t=Fn.emptyPath(),n={},i=[];e.forEach((o,l)=>{if(!t.isImmediateParentOf(l)){const u=this.getFieldsMap(t);this.applyChanges(u,n,i),n={},i=[],t=l.popLast()}o?n[l.lastSegment()]=Tf(o):i.push(l.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());fg(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Mo(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];fg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){ic(t,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new Yr(Tf(this.value))}}function Wk(r){const e=[];return ic(r.fields,(t,n)=>{const i=new Fn([t]);if(fg(n)){const s=Wk(n.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Fi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Un{constructor(e,t,n,i,s,o,l){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Un(e,0,lt.min(),lt.min(),lt.min(),Yr.empty(),0)}static newFoundDocument(e,t,n,i){return new Un(e,1,t,lt.min(),n,i,0)}static newNoDocument(e,t){return new Un(e,2,t,lt.min(),lt.min(),Yr.empty(),0)}static newUnknownDocument(e,t){return new Un(e,3,t,lt.min(),lt.min(),Yr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(lt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Yr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Yr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=lt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Un&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Un(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nd{constructor(e,t){this.position=e,this.inclusive=t}}function RT(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const s=e[i],o=r.position[i];if(s.field.isKeyField()?n=qe.comparator(qe.fromName(o.referenceValue),t.key):n=$l(o,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function OT(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!Mo(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kf{constructor(e,t="asc"){this.field=e,this.dir=t}}function xD(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gk=class{};class Ut extends Gk{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new bD(e,t,n):t==="array-contains"?new TD(e,n):t==="in"?new Jk(e,n):t==="not-in"?new SD(e,n):t==="array-contains-any"?new AD(e,n):new Ut(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new wD(e,n):new ED(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison($l(t,this.value)):t!==null&&Hl(this.value)===Hl(t)&&this.matchesComparison($l(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ye(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class fn extends Gk{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new fn(e,t)}matches(e){return kd(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function kd(r){return r.op==="and"}function fx(r){return r.op==="or"}function bb(r){return Kk(r)&&kd(r)}function Kk(r){for(const e of r.filters)if(e instanceof fn)return!1;return!0}function mx(r){if(r instanceof Ut)return r.field.canonicalString()+r.op.toString()+Id(r.value);if(bb(r))return r.filters.map(e=>mx(e)).join(",");{const e=r.filters.map(t=>mx(t)).join(",");return`${r.op}(${e})`}}function Yk(r,e){return r instanceof Ut?function(n,i){return i instanceof Ut&&n.op===i.op&&n.field.isEqual(i.field)&&Mo(n.value,i.value)}(r,e):r instanceof fn?function(n,i){return i instanceof fn&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,o,l)=>s&&Yk(o,i.filters[l]),!0):!1}(r,e):void Ye(19439)}function Zk(r,e){const t=r.filters.concat(e);return fn.create(t,r.op)}function Qk(r){return r instanceof Ut?function(t){return`${t.field.canonicalString()} ${t.op} ${Id(t.value)}`}(r):r instanceof fn?function(t){return t.op.toString()+" {"+t.getFilters().map(Qk).join(" ,")+"}"}(r):"Filter"}class bD extends Ut{constructor(e,t,n){super(e,t,n),this.key=qe.fromName(n.referenceValue)}matches(e){const t=qe.comparator(e.key,this.key);return this.matchesComparison(t)}}class wD extends Ut{constructor(e,t){super(e,"in",t),this.keys=Xk("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class ED extends Ut{constructor(e,t){super(e,"not-in",t),this.keys=Xk("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function Xk(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>qe.fromName(n.referenceValue))}class TD extends Ut{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Gf(t)&&$f(t.arrayValue,this.value)}}class Jk extends Ut{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&$f(this.value.arrayValue,t)}}class SD extends Ut{constructor(e,t){super(e,"not-in",t)}matches(e){if($f(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!$f(this.value.arrayValue,t)}}class AD extends Ut{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Gf(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>$f(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ID{constructor(e,t=null,n=[],i=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.Ie=null}}function px(r,e=null,t=[],n=[],i=null,s=null,o=null){return new ID(r,e,t,n,i,s,o)}function iu(r){const e=Je(r);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>mx(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),ky(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Id(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Id(n)).join(",")),e.Ie=t}return e.Ie}function pm(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!xD(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!Yk(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!OT(r.startAt,e.startAt)&&OT(r.endAt,e.endAt)}function Vg(r){return qe.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}function zg(r,e){return r.filters.filter(t=>t instanceof Ut&&t.field.isEqual(e))}function jT(r,e,t){let n=dg,i=!0;for(const s of zg(r,e)){let o=dg,l=!0;switch(s.op){case"<":case"<=":o=vD(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=dg}PT({value:n,inclusive:i},{value:o,inclusive:l})<0&&(n=o,i=l)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){const o=t.position[s];PT({value:n,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(n=o,i=t.inclusive);break}}return{value:n,inclusive:i}}function MT(r,e,t){let n=Cl,i=!0;for(const s of zg(r,e)){let o=Cl,l=!0;switch(s.op){case">=":case">":o=_D(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=Cl}CT({value:n,inclusive:i},{value:o,inclusive:l})>0&&(n=o,i=l)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){const o=t.position[s];CT({value:n,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(n=o,i=t.inclusive);break}}return{value:n,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hd{constructor(e,t=null,n=[],i=[],s=null,o="F",l=null,u=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=u,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function eP(r,e,t,n,i,s,o,l){return new Hd(r,e,t,n,i,s,o,l)}function gm(r){return new Hd(r)}function DT(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function tP(r){return r.collectionGroup!==null}function Sf(r){const e=Je(r);if(e.Ee===null){e.Ee=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ee.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new mn(Fn.comparator);return o.filters.forEach(u=>{u.getFlattenedFilters().forEach(f=>{f.isInequality()&&(l=l.add(f.field))})}),l})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ee.push(new Kf(s,n))}),t.has(Fn.keyField().canonicalString())||e.Ee.push(new Kf(Fn.keyField(),n))}return e.Ee}function rs(r){const e=Je(r);return e.de||(e.de=nP(e,Sf(r))),e.de}function ND(r){const e=Je(r);return e.Ae||(e.Ae=nP(e,r.explicitOrderBy)),e.Ae}function nP(r,e){if(r.limitType==="F")return px(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Kf(i.field,s)});const t=r.endAt?new Nd(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new Nd(r.startAt.position,r.startAt.inclusive):null;return px(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function gx(r,e){const t=r.filters.concat([e]);return new Hd(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function Bg(r,e,t){return new Hd(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function My(r,e){return pm(rs(r),rs(e))&&r.limitType===e.limitType}function rP(r){return`${iu(rs(r))}|lt:${r.limitType}`}function ld(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>Qk(i)).join(", ")}]`),ky(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>Id(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>Id(i)).join(",")),`Target(${n})`}(rs(r))}; limitType=${r.limitType})`}function ym(r,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):qe.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(r,e)&&function(n,i){for(const s of Sf(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(r,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(r,e)&&function(n,i){return!(n.startAt&&!function(o,l,u){const f=RT(o,l,u);return o.inclusive?f<=0:f<0}(n.startAt,Sf(n),i)||n.endAt&&!function(o,l,u){const f=RT(o,l,u);return o.inclusive?f>=0:f>0}(n.endAt,Sf(n),i))}(r,e)}function iP(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function sP(r){return(e,t)=>{let n=!1;for(const i of Sf(r)){const s=kD(i,e,t);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function kD(r,e,t){const n=r.field.isKeyField()?qe.comparator(e.key,t.key):function(s,o,l){const u=o.data.field(s),f=l.data.field(s);return u!==null&&f!==null?$l(u,f):Ye(42886)}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return Ye(19790,{direction:r.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ra{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){ic(this.inner,(t,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return Lk(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PD=new An(qe.comparator);function ns(){return PD}const oP=new An(qe.comparator);function sf(...r){let e=oP;for(const t of r)e=e.insert(t.key,t);return e}function aP(r){let e=oP;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Po(){return Af()}function lP(){return Af()}function Af(){return new Ra(r=>r.toString(),(r,e)=>r.isEqual(e))}const CD=new An(qe.comparator),RD=new mn(qe.comparator);function Lt(...r){let e=RD;for(const t of r)e=e.add(t);return e}const OD=new mn(vt);function wb(){return OD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eb(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:zf(e)?"-0":e}}function cP(r){return{integerValue:""+r}}function jD(r,e){return Ak(e)?cP(e):Eb(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dy{constructor(){this._=void 0}}function MD(r,e,t){return r instanceof Pd?function(i,s){const o={fields:{[zk]:{stringValue:Vk},[Uk]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&vb(s)&&(s=Oy(s)),s&&(o.fields[Bk]=s),{mapValue:o}}(t,e):r instanceof su?dP(r,e):r instanceof Cd?hP(r,e):function(i,s){const o=uP(i,s),l=LT(o)+LT(i.Re);return hx(o)&&hx(i.Re)?cP(l):Eb(i.serializer,l)}(r,e)}function DD(r,e,t){return r instanceof su?dP(r,e):r instanceof Cd?hP(r,e):t}function uP(r,e){return r instanceof Yf?function(n){return hx(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class Pd extends Dy{}class su extends Dy{constructor(e){super(),this.elements=e}}function dP(r,e){const t=fP(e);for(const n of r.elements)t.some(i=>Mo(i,n))||t.push(n);return{arrayValue:{values:t}}}class Cd extends Dy{constructor(e){super(),this.elements=e}}function hP(r,e){let t=fP(e);for(const n of r.elements)t=t.filter(i=>!Mo(i,n));return{arrayValue:{values:t}}}class Yf extends Dy{constructor(e,t){super(),this.serializer=e,this.Re=t}}function LT(r){return On(r.integerValue||r.doubleValue)}function fP(r){return Gf(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tb{constructor(e,t){this.field=e,this.transform=t}}function LD(r,e){return r.field.isEqual(e.field)&&function(n,i){return n instanceof su&&i instanceof su||n instanceof Cd&&i instanceof Cd?xd(n.elements,i.elements,Mo):n instanceof Yf&&i instanceof Yf?Mo(n.Re,i.Re):n instanceof Pd&&i instanceof Pd}(r.transform,e.transform)}class FD{constructor(e,t){this.version=e,this.transformResults=t}}class hr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new hr}static exists(e){return new hr(void 0,e)}static updateTime(e){return new hr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function mg(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class Ly{}function mP(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new vm(r.key,hr.none()):new $d(r.key,r.data,hr.none());{const t=r.data,n=Yr.empty();let i=new mn(Fn.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?n.delete(s):n.set(s,o),i=i.add(s)}return new Oa(r.key,n,new Fi(i.toArray()),hr.none())}}function VD(r,e,t){r instanceof $d?function(i,s,o){const l=i.value.clone(),u=VT(i.fieldTransforms,s,o.transformResults);l.setAll(u),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(r,e,t):r instanceof Oa?function(i,s,o){if(!mg(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=VT(i.fieldTransforms,s,o.transformResults),u=s.data;u.setAll(pP(i)),u.setAll(l),s.convertToFoundDocument(o.version,u).setHasCommittedMutations()}(r,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function If(r,e,t,n){return r instanceof $d?function(s,o,l,u){if(!mg(s.precondition,o))return l;const f=s.value.clone(),m=zT(s.fieldTransforms,u,o);return f.setAll(m),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),null}(r,e,t,n):r instanceof Oa?function(s,o,l,u){if(!mg(s.precondition,o))return l;const f=zT(s.fieldTransforms,u,o),m=o.data;return m.setAll(pP(s)),m.setAll(f),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(y=>y.field))}(r,e,t,n):function(s,o,l){return mg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(r,e,t)}function zD(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),s=uP(n.transform,i||null);s!=null&&(t===null&&(t=Yr.empty()),t.set(n.field,s))}return t||null}function FT(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&xd(n,i,(s,o)=>LD(s,o))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class $d extends Ly{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Oa extends Ly{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function pP(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function VT(r,e,t){const n=new Map;it(r.length===t.length,32656,{Ve:t.length,me:r.length});for(let i=0;i<t.length;i++){const s=r[i],o=s.transform,l=e.data.field(s.field);n.set(s.field,DD(o,l,t[i]))}return n}function zT(r,e,t){const n=new Map;for(const i of r){const s=i.transform,o=t.data.field(i.field);n.set(i.field,MD(s,o,e))}return n}class vm extends Ly{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class gP extends Ly{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sb{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&VD(s,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=If(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=If(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=lP();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(i.key)?null:l;const u=mP(o,l);u!==null&&n.set(i.key,u),o.isValidDocument()||o.convertToNoDocument(lt.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Lt())}isEqual(e){return this.batchId===e.batchId&&xd(this.mutations,e.mutations,(t,n)=>FT(t,n))&&xd(this.baseMutations,e.baseMutations,(t,n)=>FT(t,n))}}class Ab{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){it(e.mutations.length===n.length,58842,{fe:e.mutations.length,ge:n.length});let i=function(){return CD}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,n[o].version);return new Ab(e,t,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ib{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BD{constructor(e,t,n){this.alias=e,this.aggregateType=t,this.fieldPath=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UD{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ir,Ht;function qD(r){switch(r){case Ne.OK:return Ye(64938);case Ne.CANCELLED:case Ne.UNKNOWN:case Ne.DEADLINE_EXCEEDED:case Ne.RESOURCE_EXHAUSTED:case Ne.INTERNAL:case Ne.UNAVAILABLE:case Ne.UNAUTHENTICATED:return!1;case Ne.INVALID_ARGUMENT:case Ne.NOT_FOUND:case Ne.ALREADY_EXISTS:case Ne.PERMISSION_DENIED:case Ne.FAILED_PRECONDITION:case Ne.ABORTED:case Ne.OUT_OF_RANGE:case Ne.UNIMPLEMENTED:case Ne.DATA_LOSS:return!0;default:return Ye(15467,{code:r})}}function yP(r){if(r===void 0)return Kn("GRPC error has no .code"),Ne.UNKNOWN;switch(r){case ir.OK:return Ne.OK;case ir.CANCELLED:return Ne.CANCELLED;case ir.UNKNOWN:return Ne.UNKNOWN;case ir.DEADLINE_EXCEEDED:return Ne.DEADLINE_EXCEEDED;case ir.RESOURCE_EXHAUSTED:return Ne.RESOURCE_EXHAUSTED;case ir.INTERNAL:return Ne.INTERNAL;case ir.UNAVAILABLE:return Ne.UNAVAILABLE;case ir.UNAUTHENTICATED:return Ne.UNAUTHENTICATED;case ir.INVALID_ARGUMENT:return Ne.INVALID_ARGUMENT;case ir.NOT_FOUND:return Ne.NOT_FOUND;case ir.ALREADY_EXISTS:return Ne.ALREADY_EXISTS;case ir.PERMISSION_DENIED:return Ne.PERMISSION_DENIED;case ir.FAILED_PRECONDITION:return Ne.FAILED_PRECONDITION;case ir.ABORTED:return Ne.ABORTED;case ir.OUT_OF_RANGE:return Ne.OUT_OF_RANGE;case ir.UNIMPLEMENTED:return Ne.UNIMPLEMENTED;case ir.DATA_LOSS:return Ne.DATA_LOSS;default:return Ye(39323,{code:r})}}(Ht=ir||(ir={}))[Ht.OK=0]="OK",Ht[Ht.CANCELLED=1]="CANCELLED",Ht[Ht.UNKNOWN=2]="UNKNOWN",Ht[Ht.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ht[Ht.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ht[Ht.NOT_FOUND=5]="NOT_FOUND",Ht[Ht.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ht[Ht.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ht[Ht.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ht[Ht.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ht[Ht.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ht[Ht.ABORTED=10]="ABORTED",Ht[Ht.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ht[Ht.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ht[Ht.INTERNAL=13]="INTERNAL",Ht[Ht.UNAVAILABLE=14]="UNAVAILABLE",Ht[Ht.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HD=new Fl([4294967295,4294967295],0);function BT(r){const e=vk().encode(r),t=new uk;return t.update(e),new Uint8Array(t.digest())}function UT(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Fl([t,n],0),new Fl([i,s],0)]}class Nb{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new of(`Invalid padding: ${t}`);if(n<0)throw new of(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new of(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new of(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=Fl.fromNumber(this.pe)}we(e,t,n){let i=e.add(t.multiply(Fl.fromNumber(n)));return i.compare(HD)===1&&(i=new Fl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=BT(e),[n,i]=UT(t);for(let s=0;s<this.hashCount;s++){const o=this.we(n,i,s);if(!this.be(o))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Nb(s,i,t);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.pe===0)return;const t=BT(e),[n,i]=UT(t);for(let s=0;s<this.hashCount;s++){const o=this.we(n,i,s);this.Se(o)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class of extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _m{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,xm.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new _m(lt.min(),i,new An(vt),ns(),Lt())}}class xm{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new xm(n,t,Lt(),Lt(),Lt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pg{constructor(e,t,n,i){this.De=e,this.removedTargetIds=t,this.key=n,this.ve=i}}class vP{constructor(e,t){this.targetId=e,this.Ce=t}}class _P{constructor(e,t,n=Zn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class qT{constructor(){this.Fe=0,this.Me=HT(),this.xe=Zn.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Lt(),t=Lt(),n=Lt();return this.Me.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:Ye(38017,{changeType:s})}}),new xm(this.xe,this.Oe,e,t,n)}Qe(){this.Ne=!1,this.Me=HT()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,it(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class $D{constructor(e){this.ze=e,this.je=new Map,this.He=ns(),this.Je=Rp(),this.Ye=Rp(),this.Ze=new An(vt)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const n=this.rt(t);switch(e.state){case 0:this.it(t)&&n.ke(e.resumeToken);break;case 1:n.We(),n.Be||n.Qe(),n.ke(e.resumeToken);break;case 2:n.We(),n.Be||this.removeTarget(t);break;case 3:this.it(t)&&(n.Ge(),n.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),n.ke(e.resumeToken));break;default:Ye(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((n,i)=>{this.it(i)&&t(i)})}ot(e){const t=e.targetId,n=e.Ce.count,i=this._t(t);if(i){const s=i.target;if(Vg(s))if(n===0){const o=new qe(s.path);this.tt(t,o,Un.newNoDocument(o,lt.min()))}else it(n===1,20013,{expectedCount:n});else{const o=this.ut(t);if(o!==n){const l=this.ct(e),u=l?this.lt(l,e,o):1;if(u!==0){this.st(t);const f=u===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,f)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=t;let o,l;try{o=Aa(n).toUint8Array()}catch(u){if(u instanceof Fk)return nu("Decoding the base64 bloom filter in existence filter failed ("+u.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw u}try{l=new Nb(o,i,s)}catch(u){return nu(u instanceof of?"BloomFilter error: ":"Applying bloom filter failed: ",u),null}return l.pe===0?null:l}lt(e,t,n){return t.Ce.count===n-this.Tt(e,t.targetId)?0:2}Tt(e,t){const n=this.ze.getRemoteKeysForTarget(t);let i=0;return n.forEach(s=>{const o=this.ze.Pt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.tt(t,s,null),i++)}),i}It(e){const t=new Map;this.je.forEach((s,o)=>{const l=this._t(o);if(l){if(s.current&&Vg(l.target)){const u=new qe(l.target.path);this.Et(u).has(o)||this.dt(o,u)||this.tt(o,u,Un.newNoDocument(u,e))}s.Le&&(t.set(o,s.qe()),s.Qe())}});let n=Lt();this.Ye.forEach((s,o)=>{let l=!0;o.forEachWhile(u=>{const f=this._t(u);return!f||f.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(s))}),this.He.forEach((s,o)=>o.setReadTime(e));const i=new _m(e,t,this.Ze,this.He,n);return this.He=ns(),this.Je=Rp(),this.Ye=Rp(),this.Ze=new An(vt),i}et(e,t){if(!this.it(e))return;const n=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,n),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,n){if(!this.it(e))return;const i=this.rt(e);this.dt(e,t)?i.$e(t,1):i.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),n&&(this.He=this.He.insert(t,n))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new qT,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new mn(vt),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new mn(vt),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||Re("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new qT),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function Rp(){return new An(qe.comparator)}function HT(){return new An(qe.comparator)}const WD={asc:"ASCENDING",desc:"DESCENDING"},GD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},KD={and:"AND",or:"OR"};class YD{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function yx(r,e){return r.useProto3Json||ky(e)?e:{value:e}}function Rd(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function xP(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function ZD(r,e){return Rd(r,e.toTimestamp())}function hi(r){return it(!!r,49232),lt.fromTimestamp(function(t){const n=Sa(t);return new Ot(n.seconds,n.nanos)}(r))}function kb(r,e){return vx(r,e).canonicalString()}function vx(r,e){const t=function(i){return new sn(["projects",i.projectId,"databases",i.database])}(r).child("documents");return e===void 0?t:t.child(e)}function bP(r){const e=sn.fromString(r);return it(kP(e),10190,{key:e.toString()}),e}function Ug(r,e){return kb(r.databaseId,e.path)}function Yc(r,e){const t=bP(e);if(t.get(1)!==r.databaseId.projectId)throw new Be(Ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new Be(Ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new qe(TP(t))}function wP(r,e){return kb(r.databaseId,e)}function EP(r){const e=bP(r);return e.length===4?sn.emptyPath():TP(e)}function _x(r){return new sn(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function TP(r){return it(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}function $T(r,e,t){return{name:Ug(r,e),fields:t.value.mapValue.fields}}function QD(r,e,t){const n=Yc(r,e.name),i=hi(e.updateTime),s=e.createTime?hi(e.createTime):lt.min(),o=new Yr({mapValue:{fields:e.fields}}),l=Un.newFoundDocument(n,i,s,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function XD(r,e){let t;if("targetChange"in e){e.targetChange;const n=function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:Ye(39313,{state:f})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(f,m){return f.useProto3Json?(it(m===void 0||typeof m=="string",58123),Zn.fromBase64String(m||"")):(it(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),Zn.fromUint8Array(m||new Uint8Array))}(r,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(f){const m=f.code===void 0?Ne.UNKNOWN:yP(f.code);return new Be(m,f.message||"")}(o);t=new _P(n,i,s,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Yc(r,n.document.name),s=hi(n.document.updateTime),o=n.document.createTime?hi(n.document.createTime):lt.min(),l=new Yr({mapValue:{fields:n.document.fields}}),u=Un.newFoundDocument(i,s,o,l),f=n.targetIds||[],m=n.removedTargetIds||[];t=new pg(f,m,u.key,u)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Yc(r,n.document),s=n.readTime?hi(n.readTime):lt.min(),o=Un.newNoDocument(i,s),l=n.removedTargetIds||[];t=new pg([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Yc(r,n.document),s=n.removedTargetIds||[];t=new pg([],s,i,null)}else{if(!("filter"in e))return Ye(11601,{Vt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,o=new UD(i,s),l=n.targetId;t=new vP(l,o)}}return t}function qg(r,e){let t;if(e instanceof $d)t={update:$T(r,e.key,e.value)};else if(e instanceof vm)t={delete:Ug(r,e.key)};else if(e instanceof Oa)t={update:$T(r,e.key,e.data),updateMask:s6(e.fieldMask)};else{if(!(e instanceof gP))return Ye(16599,{ft:e.type});t={verify:Ug(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,o){const l=o.transform;if(l instanceof Pd)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof su)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Cd)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Yf)return{fieldPath:o.field.canonicalString(),increment:l.Re};throw Ye(20930,{transform:o.transform})}(0,n))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:ZD(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ye(27497)}(r,e.precondition)),t}function xx(r,e){const t=e.currentDocument?function(s){return s.updateTime!==void 0?hr.updateTime(hi(s.updateTime)):s.exists!==void 0?hr.exists(s.exists):hr.none()}(e.currentDocument):hr.none(),n=e.updateTransforms?e.updateTransforms.map(i=>function(o,l){let u=null;if("setToServerValue"in l)it(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),u=new Pd;else if("appendMissingElements"in l){const m=l.appendMissingElements.values||[];u=new su(m)}else if("removeAllFromArray"in l){const m=l.removeAllFromArray.values||[];u=new Cd(m)}else"increment"in l?u=new Yf(o,l.increment):Ye(16584,{proto:l});const f=Fn.fromServerFormat(l.fieldPath);return new Tb(f,u)}(r,i)):[];if(e.update){e.update.name;const i=Yc(r,e.update.name),s=new Yr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(u){const f=u.fieldPaths||[];return new Fi(f.map(m=>Fn.fromServerFormat(m)))}(e.updateMask);return new Oa(i,s,o,t,n)}return new $d(i,s,t,n)}if(e.delete){const i=Yc(r,e.delete);return new vm(i,t)}if(e.verify){const i=Yc(r,e.verify);return new gP(i,t)}return Ye(1463,{proto:e})}function JD(r,e){return r&&r.length>0?(it(e!==void 0,14353),r.map(t=>function(i,s){let o=i.updateTime?hi(i.updateTime):hi(s);return o.isEqual(lt.min())&&(o=hi(s)),new FD(o,i.transformResults||[])}(t,e))):[]}function SP(r,e){return{documents:[wP(r,e.path)]}}function Pb(r,e){const t={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=wP(r,i);const s=function(f){if(f.length!==0)return NP(fn.create(f,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(f){if(f.length!==0)return f.map(m=>function(g){return{field:kl(g.field),direction:n6(g.dir)}}(m))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=yx(r,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(f){return{before:f.inclusive,values:f.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(f){return{before:!f.inclusive,values:f.position}}(e.endAt)),{gt:t,parent:i}}function e6(r,e,t,n){const{gt:i,parent:s}=Pb(r,e),o={},l=[];let u=0;return t.forEach(f=>{const m="aggregate_"+u++;o[m]=f.alias,f.aggregateType==="count"?l.push({alias:m,count:{}}):f.aggregateType==="avg"?l.push({alias:m,avg:{field:kl(f.fieldPath)}}):f.aggregateType==="sum"&&l.push({alias:m,sum:{field:kl(f.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:l,structuredQuery:i.structuredQuery},parent:i.parent},yt:o,parent:s}}function AP(r){let e=EP(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){it(n===1,65062);const m=t.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let s=[];t.where&&(s=function(y){const g=IP(y);return g instanceof fn&&bb(g)?g.getFilters():[g]}(t.where));let o=[];t.orderBy&&(o=function(y){return y.map(g=>function(E){return new Kf(cd(E.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(g))}(t.orderBy));let l=null;t.limit&&(l=function(y){let g;return g=typeof y=="object"?y.value:y,ky(g)?null:g}(t.limit));let u=null;t.startAt&&(u=function(y){const g=!!y.before,_=y.values||[];return new Nd(_,g)}(t.startAt));let f=null;return t.endAt&&(f=function(y){const g=!y.before,_=y.values||[];return new Nd(_,g)}(t.endAt)),eP(e,i,o,s,l,"F",u,f)}function t6(r,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ye(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function IP(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=cd(t.unaryFilter.field);return Ut.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=cd(t.unaryFilter.field);return Ut.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=cd(t.unaryFilter.field);return Ut.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=cd(t.unaryFilter.field);return Ut.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ye(61313);default:return Ye(60726)}}(r):r.fieldFilter!==void 0?function(t){return Ut.create(cd(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ye(58110);default:return Ye(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return fn.create(t.compositeFilter.filters.map(n=>IP(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ye(1026)}}(t.compositeFilter.op))}(r):Ye(30097,{filter:r})}function n6(r){return WD[r]}function r6(r){return GD[r]}function i6(r){return KD[r]}function kl(r){return{fieldPath:r.canonicalString()}}function cd(r){return Fn.fromServerFormat(r.fieldPath)}function NP(r){return r instanceof Ut?function(t){if(t.op==="=="){if(kT(t.value))return{unaryFilter:{field:kl(t.field),op:"IS_NAN"}};if(NT(t.value))return{unaryFilter:{field:kl(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(kT(t.value))return{unaryFilter:{field:kl(t.field),op:"IS_NOT_NAN"}};if(NT(t.value))return{unaryFilter:{field:kl(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:kl(t.field),op:r6(t.op),value:t.value}}}(r):r instanceof fn?function(t){const n=t.getFilters().map(i=>NP(i));return n.length===1?n[0]:{compositeFilter:{op:i6(t.op),filters:n}}}(r):Ye(54877,{filter:r})}function s6(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function kP(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xa{constructor(e,t,n,i,s=lt.min(),o=lt.min(),l=Zn.EMPTY_BYTE_STRING,u=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=u}withSequenceNumber(e){return new xa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new xa(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new xa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new xa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PP{constructor(e){this.wt=e}}function o6(r,e){let t;if(e.document)t=QD(r.wt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=qe.fromSegments(e.noDocument.path),i=au(e.noDocument.readTime);t=Un.newNoDocument(n,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ye(56709);{const n=qe.fromSegments(e.unknownDocument.path),i=au(e.unknownDocument.version);t=Un.newUnknownDocument(n,i)}}return e.readTime&&t.setReadTime(function(i){const s=new Ot(i[0],i[1]);return lt.fromTimestamp(s)}(e.readTime)),t}function WT(r,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:Hg(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(s,o){return{name:Ug(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Rd(s,o.version.toTimestamp()),createTime:Rd(s,o.createTime.toTimestamp())}}(r.wt,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:ou(e.version)};else{if(!e.isUnknownDocument())return Ye(57904,{document:e});n.unknownDocument={path:t.path.toArray(),version:ou(e.version)}}return n}function Hg(r){const e=r.toTimestamp();return[e.seconds,e.nanoseconds]}function ou(r){const e=r.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function au(r){const e=new Ot(r.seconds,r.nanoseconds);return lt.fromTimestamp(e)}function Bc(r,e){const t=(e.baseMutations||[]).map(s=>xx(r.wt,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const n=e.mutations.map(s=>xx(r.wt,s)),i=Ot.fromMillis(e.localWriteTimeMs);return new Sb(e.batchId,i,t,n)}function af(r){const e=au(r.readTime),t=r.lastLimboFreeSnapshotVersion!==void 0?au(r.lastLimboFreeSnapshotVersion):lt.min();let n;return n=function(s){return s.documents!==void 0}(r.query)?function(s){const o=s.documents.length;return it(o===1,1966,{count:o}),rs(gm(EP(s.documents[0])))}(r.query):function(s){return rs(AP(s))}(r.query),new xa(n,r.targetId,"TargetPurposeListen",r.lastListenSequenceNumber,e,t,Zn.fromBase64String(r.resumeToken))}function CP(r,e){const t=ou(e.snapshotVersion),n=ou(e.lastLimboFreeSnapshotVersion);let i;i=Vg(e.target)?SP(r.wt,e.target):Pb(r.wt,e.target).gt;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:iu(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:i}}function RP(r){const e=AP({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?Bg(e,e.limit,"L"):e}function Fv(r,e){return new Ib(e.largestBatchId,xx(r.wt,e.overlayMutation))}function GT(r,e){const t=e.path.lastSegment();return[r,Xr(e.path.popLast()),t]}function KT(r,e,t,n){return{indexId:r,uid:e,sequenceNumber:t,readTime:ou(n.readTime),documentKey:Xr(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a6{getBundleMetadata(e,t){return YT(e).get(t).next(n=>{if(n)return function(s){return{id:s.bundleId,createTime:au(s.createTime),version:s.version}}(n)})}saveBundleMetadata(e,t){return YT(e).put(function(i){return{bundleId:i.id,createTime:ou(hi(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return ZT(e).get(t).next(n=>{if(n)return function(s){return{name:s.name,query:RP(s.bundledQuery),readTime:au(s.readTime)}}(n)})}saveNamedQuery(e,t){return ZT(e).put(function(i){return{name:i.name,readTime:ou(hi(i.readTime)),bundledQuery:i.bundledQuery}}(t))}}function YT(r){return pr(r,Py)}function ZT(r){return pr(r,Cy)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fy{constructor(e,t){this.serializer=e,this.userId=t}static bt(e,t){const n=t.uid||"";return new Fy(e,n)}getOverlay(e,t){return Rh(e).get(GT(this.userId,t)).next(n=>n?Fv(this.serializer,n):null)}getOverlays(e,t){const n=Po();return ve.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){const i=[];return n.forEach((s,o)=>{const l=new Ib(t,o);i.push(this.St(e,l))}),ve.waitFor(i)}removeOverlaysForBatchId(e,t,n){const i=new Set;t.forEach(o=>i.add(Xr(o.getCollectionPath())));const s=[];return i.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,n+1],!1,!0);s.push(Rh(e).X(cx,l))}),ve.waitFor(s)}getOverlaysForCollection(e,t,n){const i=Po(),s=Xr(t),o=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Rh(e).J(cx,o).next(l=>{for(const u of l){const f=Fv(this.serializer,u);i.set(f.getKey(),f)}return i})}getOverlaysForCollectionGroup(e,t,n,i){const s=Po();let o;const l=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Rh(e).te({index:Rk,range:l},(u,f,m)=>{const y=Fv(this.serializer,f);s.size()<i||y.largestBatchId===o?(s.set(y.getKey(),y),o=y.largestBatchId):m.done()}).next(()=>s)}St(e,t){return Rh(e).put(function(i,s,o){const[l,u,f]=GT(s,o.mutation.key);return{userId:s,collectionPath:u,documentId:f,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:qg(i.wt,o.mutation)}}(this.serializer,this.userId,t))}}function Rh(r){return pr(r,Ry)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l6{Dt(e){return pr(e,gb)}getSessionToken(e){return this.Dt(e).get("sessionToken").next(t=>{const n=t==null?void 0:t.value;return n?Zn.fromUint8Array(n):Zn.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Dt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uc{constructor(){}vt(e,t){this.Ct(e,t),t.Ft()}Ct(e,t){if("nullValue"in e)this.Mt(t,5);else if("booleanValue"in e)this.Mt(t,10),t.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(t,15),t.xt(On(e.integerValue));else if("doubleValue"in e){const n=On(e.doubleValue);isNaN(n)?this.Mt(t,13):(this.Mt(t,15),zf(n)?t.xt(0):t.xt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Mt(t,20),typeof n=="string"&&(n=Sa(n)),t.Ot(`${n.seconds||""}`),t.xt(n.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,t),this.Bt(t);else if("bytesValue"in e)this.Mt(t,30),t.Lt(Aa(e.bytesValue)),this.Bt(t);else if("referenceValue"in e)this.kt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Mt(t,45),t.xt(n.latitude||0),t.xt(n.longitude||0)}else"mapValue"in e?Hk(e)?this.Mt(t,Number.MAX_SAFE_INTEGER):jy(e)?this.qt(e.mapValue,t):(this.Qt(e.mapValue,t),this.Bt(t)):"arrayValue"in e?(this.$t(e.arrayValue,t),this.Bt(t)):Ye(19022,{Ut:e})}Nt(e,t){this.Mt(t,25),this.Kt(e,t)}Kt(e,t){t.Ot(e)}Qt(e,t){const n=e.fields||{};this.Mt(t,55);for(const i of Object.keys(n))this.Nt(i,t),this.Ct(n[i],t)}qt(e,t){var n,i;const s=e.fields||{};this.Mt(t,53);const o=Ad,l=((i=(n=s[o].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.length)||0;this.Mt(t,15),t.xt(On(l)),this.Nt(o,t),this.Ct(s[o],t)}$t(e,t){const n=e.values||[];this.Mt(t,50);for(const i of n)this.Ct(i,t)}kt(e,t){this.Mt(t,37),qe.fromName(e).path.forEach(n=>{this.Mt(t,60),this.Kt(n,t)})}Mt(e,t){e.xt(t)}Bt(e){e.xt(2)}}Uc.Wt=new Uc;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xu=255;function c6(r){if(r===0)return 8;let e=0;return r>>4||(e+=4,r<<=4),r>>6||(e+=2,r<<=2),r>>7||(e+=1),e}function QT(r){const e=64-function(n){let i=0;for(let s=0;s<8;++s){const o=c6(255&n[s]);if(i+=o,o!==8)break}return i}(r);return Math.ceil(e/8)}class u6{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Gt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.zt(n.value),n=t.next();this.jt()}Ht(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Jt(n.value),n=t.next();this.Yt()}Zt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.zt(n);else if(n<2048)this.zt(960|n>>>6),this.zt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.zt(480|n>>>12),this.zt(128|63&n>>>6),this.zt(128|63&n);else{const i=t.codePointAt(0);this.zt(240|i>>>18),this.zt(128|63&i>>>12),this.zt(128|63&i>>>6),this.zt(128|63&i)}}this.jt()}Xt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Jt(n);else if(n<2048)this.Jt(960|n>>>6),this.Jt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|n>>>12),this.Jt(128|63&n>>>6),this.Jt(128|63&n);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Yt()}en(e){const t=this.tn(e),n=QT(t);this.nn(1+n),this.buffer[this.position++]=255&n;for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=255&t[i]}rn(e){const t=this.tn(e),n=QT(t);this.nn(1+n),this.buffer[this.position++]=~(255&n);for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}sn(){this._n(Xu),this._n(255)}an(){this.un(Xu),this.un(255)}reset(){this.position=0}seed(e){this.nn(e.length),this.buffer.set(e,this.position),this.position+=e.length}cn(){return this.buffer.slice(0,this.position)}tn(e){const t=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let i=1;i<t.length;++i)t[i]^=n?255:0;return t}zt(e){const t=255&e;t===0?(this._n(0),this._n(255)):t===Xu?(this._n(Xu),this._n(0)):this._n(t)}Jt(e){const t=255&e;t===0?(this.un(0),this.un(255)):t===Xu?(this.un(Xu),this.un(0)):this.un(e)}jt(){this._n(0),this._n(1)}Yt(){this.un(0),this.un(1)}_n(e){this.nn(1),this.buffer[this.position++]=e}un(e){this.nn(1),this.buffer[this.position++]=~e}nn(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}}class d6{constructor(e){this.ln=e}Lt(e){this.ln.Gt(e)}Ot(e){this.ln.Zt(e)}xt(e){this.ln.en(e)}Ft(){this.ln.sn()}}class h6{constructor(e){this.ln=e}Lt(e){this.ln.Ht(e)}Ot(e){this.ln.Xt(e)}xt(e){this.ln.rn(e)}Ft(){this.ln.an()}}class Oh{constructor(){this.ln=new u6,this.hn=new d6(this.ln),this.Pn=new h6(this.ln)}seed(e){this.ln.seed(e)}Tn(e){return e===0?this.hn:this.Pn}cn(){return this.ln.cn()}reset(){this.ln.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(e,t,n,i){this.In=e,this.En=t,this.dn=n,this.An=i}Rn(){const e=this.An.length,t=e===0||this.An[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.An,0),t!==e?n.set([0],this.An.length):++n[n.length-1],new qc(this.In,this.En,this.dn,n)}Vn(e,t,n){return{indexId:this.In,uid:e,arrayValue:gg(this.dn),directionalValue:gg(this.An),orderedDocumentKey:gg(t),documentKey:n.path.toArray()}}mn(e,t,n){const i=this.Vn(e,t,n);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function wl(r,e){let t=r.In-e.In;return t!==0?t:(t=XT(r.dn,e.dn),t!==0?t:(t=XT(r.An,e.An),t!==0?t:qe.comparator(r.En,e.En)))}function XT(r,e){for(let t=0;t<r.length&&t<e.length;++t){const n=r[t]-e[t];if(n!==0)return n}return r.length-e.length}function gg(r){return b4()?function(t){let n="";for(let i=0;i<t.length;i++)n+=String.fromCharCode(t[i]);return n}(r):r}function JT(r){return typeof r!="string"?r:function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(r)}class eS{constructor(e){this.fn=new mn((t,n)=>Fn.comparator(t.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.gn=e.orderBy,this.pn=[];for(const t of e.filters){const n=t;n.isInequality()?this.fn=this.fn.add(n):this.pn.push(n)}}get yn(){return this.fn.size>1}wn(e){if(it(e.collectionGroup===this.collectionId,49279),this.yn)return!1;const t=ox(e);if(t!==void 0&&!this.bn(t))return!1;const n=Dc(e);let i=new Set,s=0,o=0;for(;s<n.length&&this.bn(n[s]);++s)i=i.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.fn.size>0){const l=this.fn.getIterator().getNext();if(!i.has(l.field.canonicalString())){const u=n[s];if(!this.Sn(l,u)||!this.Dn(this.gn[o++],u))return!1}++s}for(;s<n.length;++s){const l=n[s];if(o>=this.gn.length||!this.Dn(this.gn[o++],l))return!1}return!0}vn(){if(this.yn)return null;let e=new mn(Fn.comparator);const t=[];for(const n of this.pn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new lg(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new lg(n.field,0))}for(const n of this.gn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new lg(n.field,n.dir==="asc"?0:1)));return new jg(jg.UNKNOWN_ID,this.collectionId,t,Vf.empty())}bn(e){for(const t of this.pn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}Dn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OP(r){var e,t;if(it(r instanceof Ut||r instanceof fn,20012),r instanceof Ut){if(r instanceof Jk){const i=((t=(e=r.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>Ut.create(r.field,"==",s)))||[];return fn.create(i,"or")}return r}const n=r.filters.map(i=>OP(i));return fn.create(n,r.op)}function f6(r){if(r.getFilters().length===0)return[];const e=Ex(OP(r));return it(jP(e),7391),bx(e)||wx(e)?[e]:e.getFilters()}function bx(r){return r instanceof Ut}function wx(r){return r instanceof fn&&bb(r)}function jP(r){return bx(r)||wx(r)||function(t){if(t instanceof fn&&fx(t)){for(const n of t.getFilters())if(!bx(n)&&!wx(n))return!1;return!0}return!1}(r)}function Ex(r){if(it(r instanceof Ut||r instanceof fn,34018),r instanceof Ut)return r;if(r.filters.length===1)return Ex(r.filters[0]);const e=r.filters.map(n=>Ex(n));let t=fn.create(e,r.op);return t=$g(t),jP(t)?t:(it(t instanceof fn,64498),it(kd(t),40251),it(t.filters.length>1,57927),t.filters.reduce((n,i)=>Cb(n,i)))}function Cb(r,e){let t;return it(r instanceof Ut||r instanceof fn,38388),it(e instanceof Ut||e instanceof fn,25473),t=r instanceof Ut?e instanceof Ut?function(i,s){return fn.create([i,s],"and")}(r,e):tS(r,e):e instanceof Ut?tS(e,r):function(i,s){if(it(i.filters.length>0&&s.filters.length>0,48005),kd(i)&&kd(s))return Zk(i,s.getFilters());const o=fx(i)?i:s,l=fx(i)?s:i,u=o.filters.map(f=>Cb(f,l));return fn.create(u,"or")}(r,e),$g(t)}function tS(r,e){if(kd(e))return Zk(e,r.getFilters());{const t=e.filters.map(n=>Cb(r,n));return fn.create(t,"or")}}function $g(r){if(it(r instanceof Ut||r instanceof fn,11850),r instanceof Ut)return r;const e=r.getFilters();if(e.length===1)return $g(e[0]);if(Kk(r))return r;const t=e.map(i=>$g(i)),n=[];return t.forEach(i=>{i instanceof Ut?n.push(i):i instanceof fn&&(i.op===r.op?n.push(...i.filters):n.push(i))}),n.length===1?n[0]:fn.create(n,r.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m6{constructor(){this.Cn=new Rb}addToCollectionParentIndex(e,t){return this.Cn.add(t),ve.resolve()}getCollectionParents(e,t){return ve.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ve.resolve()}deleteFieldIndex(e,t){return ve.resolve()}deleteAllFieldIndexes(e){return ve.resolve()}createTargetIndexes(e,t){return ve.resolve()}getDocumentsMatchingTarget(e,t){return ve.resolve(null)}getIndexType(e,t){return ve.resolve(0)}getFieldIndexes(e,t){return ve.resolve([])}getNextCollectionGroupToUpdate(e){return ve.resolve(null)}getMinOffset(e,t){return ve.resolve(ss.min())}getMinOffsetFromCollectionGroup(e,t){return ve.resolve(ss.min())}updateCollectionGroup(e,t,n){return ve.resolve()}updateIndexEntries(e,t){return ve.resolve()}}class Rb{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new mn(sn.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new mn(sn.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nS="IndexedDbIndexManager",Op=new Uint8Array(0);class p6{constructor(e,t){this.databaseId=t,this.Fn=new Rb,this.Mn=new Ra(n=>iu(n),(n,i)=>pm(n,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Fn.has(t)){const n=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.Fn.add(t)});const s={collectionId:n,parent:Xr(i)};return rS(e).put(s)}return ve.resolve()}getCollectionParents(e,t){const n=[],i=IDBKeyRange.bound([t,""],[xk(t),""],!1,!0);return rS(e).J(i).next(s=>{for(const o of s){if(o.collectionId!==t)break;n.push(ko(o.parent))}return n})}addFieldIndex(e,t){const n=jh(e),i=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(u=>[u.fieldPath.canonicalString(),u.kind])}}(t);delete i.indexId;const s=n.add(i);if(t.indexState){const o=ed(e);return s.next(l=>{o.put(KT(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const n=jh(e),i=ed(e),s=Ju(e);return n.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=jh(e),n=Ju(e),i=ed(e);return t.X().next(()=>n.X()).next(()=>i.X())}createTargetIndexes(e,t){return ve.forEach(this.xn(t),n=>this.getIndexType(e,n).next(i=>{if(i===0||i===1){const s=new eS(n).vn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const n=Ju(e);let i=!0;const s=new Map;return ve.forEach(this.xn(t),o=>this.On(e,o).next(l=>{i&&(i=!!l),s.set(o,l)})).next(()=>{if(i){let o=Lt();const l=[];return ve.forEach(s,(u,f)=>{Re(nS,`Using index ${function(C){return`id=${C.indexId}|cg=${C.collectionGroup}|f=${C.fields.map(N=>`${N.fieldPath}:${N.kind}`).join(",")}`}(u)} to execute ${iu(t)}`);const m=function(C,N){const R=ox(N);if(R===void 0)return null;for(const B of zg(C,R.fieldPath))switch(B.op){case"array-contains-any":return B.value.arrayValue.values||[];case"array-contains":return[B.value]}return null}(f,u),y=function(C,N){const R=new Map;for(const B of Dc(N))for(const P of zg(C,B.fieldPath))switch(P.op){case"==":case"in":R.set(B.fieldPath.canonicalString(),P.value);break;case"not-in":case"!=":return R.set(B.fieldPath.canonicalString(),P.value),Array.from(R.values())}return null}(f,u),g=function(C,N){const R=[];let B=!0;for(const P of Dc(N)){const k=P.kind===0?jT(C,P.fieldPath,C.startAt):MT(C,P.fieldPath,C.startAt);R.push(k.value),B&&(B=k.inclusive)}return new Nd(R,B)}(f,u),_=function(C,N){const R=[];let B=!0;for(const P of Dc(N)){const k=P.kind===0?MT(C,P.fieldPath,C.endAt):jT(C,P.fieldPath,C.endAt);R.push(k.value),B&&(B=k.inclusive)}return new Nd(R,B)}(f,u),E=this.Nn(u,f,g),x=this.Nn(u,f,_),w=this.Bn(u,f,y),S=this.Ln(u.indexId,m,E,g.inclusive,x,_.inclusive,w);return ve.forEach(S,I=>n.Z(I,t.limit).next(C=>{C.forEach(N=>{const R=qe.fromSegments(N.documentKey);o.has(R)||(o=o.add(R),l.push(R))})}))}).next(()=>l)}return ve.resolve(null)})}xn(e){let t=this.Mn.get(e);return t||(e.filters.length===0?t=[e]:t=f6(fn.create(e.filters,"and")).map(n=>px(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.Mn.set(e,t),t)}Ln(e,t,n,i,s,o,l){const u=(t!=null?t.length:1)*Math.max(n.length,s.length),f=u/(t!=null?t.length:1),m=[];for(let y=0;y<u;++y){const g=t?this.kn(t[y/f]):Op,_=this.qn(e,g,n[y%f],i),E=this.Qn(e,g,s[y%f],o),x=l.map(w=>this.qn(e,g,w,!0));m.push(...this.createRange(_,E,x))}return m}qn(e,t,n,i){const s=new qc(e,qe.empty(),t,n);return i?s:s.Rn()}Qn(e,t,n,i){const s=new qc(e,qe.empty(),t,n);return i?s.Rn():s}On(e,t){const n=new eS(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const l of s)n.wn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,t){let n=2;const i=this.xn(t);return ve.forEach(i,s=>this.On(e,s).next(o=>{o?n!==0&&o.fields.length<function(u){let f=new mn(Fn.comparator),m=!1;for(const y of u.filters)for(const g of y.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?m=!0:f=f.add(g.field));for(const y of u.orderBy)y.field.isKeyField()||(f=f.add(y.field));return f.size+(m?1:0)}(s)&&(n=1):n=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&n===2?1:n)}$n(e,t){const n=new Oh;for(const i of Dc(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const o=n.Tn(i.kind);Uc.Wt.vt(s,o)}return n.cn()}kn(e){const t=new Oh;return Uc.Wt.vt(e,t.Tn(0)),t.cn()}Un(e,t){const n=new Oh;return Uc.Wt.vt(Wf(this.databaseId,t),n.Tn(function(s){const o=Dc(s);return o.length===0?0:o[o.length-1].kind}(e))),n.cn()}Bn(e,t,n){if(n===null)return[];let i=[];i.push(new Oh);let s=0;for(const o of Dc(e)){const l=n[s++];for(const u of i)if(this.Kn(t,o.fieldPath)&&Gf(l))i=this.Wn(i,o,l);else{const f=u.Tn(o.kind);Uc.Wt.vt(l,f)}}return this.Gn(i)}Nn(e,t,n){return this.Bn(e,t,n.position)}Gn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].cn();return t}Wn(e,t,n){const i=[...e],s=[];for(const o of n.arrayValue.values||[])for(const l of i){const u=new Oh;u.seed(l.cn()),Uc.Wt.vt(o,u.Tn(t.kind)),s.push(u)}return s}Kn(e,t){return!!e.filters.find(n=>n instanceof Ut&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,t){const n=jh(e),i=ed(e);return(t?n.J(lx,IDBKeyRange.bound(t,t)):n.J()).next(s=>{const o=[];return ve.forEach(s,l=>i.get([l.indexId,this.uid]).next(u=>{o.push(function(m,y){const g=y?new Vf(y.sequenceNumber,new ss(au(y.readTime),new qe(ko(y.documentKey)),y.largestBatchId)):Vf.empty(),_=m.fields.map(([E,x])=>new lg(Fn.fromServerFormat(E),x));return new jg(m.indexId,m.collectionGroup,_,g)}(l,u))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((n,i)=>{const s=n.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:vt(n.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,n){const i=jh(e),s=ed(e);return this.zn(e).next(o=>i.J(lx,IDBKeyRange.bound(t,t)).next(l=>ve.forEach(l,u=>s.put(KT(u.indexId,this.uid,o,n)))))}updateIndexEntries(e,t){const n=new Map;return ve.forEach(t,(i,s)=>{const o=n.get(i.collectionGroup);return(o?ve.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(l=>(n.set(i.collectionGroup,l),ve.forEach(l,u=>this.jn(e,i,u).next(f=>{const m=this.Hn(s,u);return f.isEqual(m)?ve.resolve():this.Jn(e,s,u,f,m)}))))})}Yn(e,t,n,i){return Ju(e).put(i.Vn(this.uid,this.Un(n,t.key),t.key))}Zn(e,t,n,i){return Ju(e).delete(i.mn(this.uid,this.Un(n,t.key),t.key))}jn(e,t,n){const i=Ju(e);let s=new mn(wl);return i.te({index:Ck,range:IDBKeyRange.only([n.indexId,this.uid,gg(this.Un(n,t))])},(o,l)=>{s=s.add(new qc(n.indexId,t,JT(l.arrayValue),JT(l.directionalValue)))}).next(()=>s)}Hn(e,t){let n=new mn(wl);const i=this.$n(t,e);if(i==null)return n;const s=ox(t);if(s!=null){const o=e.data.field(s.fieldPath);if(Gf(o))for(const l of o.arrayValue.values||[])n=n.add(new qc(t.indexId,e.key,this.kn(l),i))}else n=n.add(new qc(t.indexId,e.key,Op,i));return n}Jn(e,t,n,i,s){Re(nS,"Updating index entries for document '%s'",t.key);const o=[];return function(u,f,m,y,g){const _=u.getIterator(),E=f.getIterator();let x=Qu(_),w=Qu(E);for(;x||w;){let S=!1,I=!1;if(x&&w){const C=m(x,w);C<0?I=!0:C>0&&(S=!0)}else x!=null?I=!0:S=!0;S?(y(w),w=Qu(E)):I?(g(x),x=Qu(_)):(x=Qu(_),w=Qu(E))}}(i,s,wl,l=>{o.push(this.Yn(e,t,n,l))},l=>{o.push(this.Zn(e,t,n,l))}),ve.waitFor(o)}zn(e){let t=1;return ed(e).te({index:Pk,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((o,l)=>wl(o,l)).filter((o,l,u)=>!l||wl(o,u[l-1])!==0);const i=[];i.push(e);for(const o of n){const l=wl(o,e),u=wl(o,t);if(l===0)i[0]=e.Rn();else if(l>0&&u<0)i.push(o),i.push(o.Rn());else if(u>0)break}i.push(t);const s=[];for(let o=0;o<i.length;o+=2){if(this.Xn(i[o],i[o+1]))return[];const l=i[o].mn(this.uid,Op,qe.empty()),u=i[o+1].mn(this.uid,Op,qe.empty());s.push(IDBKeyRange.bound(l,u))}return s}Xn(e,t){return wl(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(iS)}getMinOffset(e,t){return ve.mapArray(this.xn(t),n=>this.On(e,n).next(i=>i||Ye(44426))).next(iS)}}function rS(r){return pr(r,qf)}function Ju(r){return pr(r,Ef)}function jh(r){return pr(r,pb)}function ed(r){return pr(r,wf)}function iS(r){it(r.length!==0,28825);let e=r[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<r.length;n++){const i=r[n].indexState.offset;hb(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new ss(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sS={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},MP=41943040;class Kr{static withCacheSize(e){return new Kr(e,Kr.DEFAULT_COLLECTION_PERCENTILE,Kr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DP(r,e,t){const n=r.store(ro),i=r.store(wd),s=[],o=IDBKeyRange.only(t.batchId);let l=0;const u=n.te({range:o},(m,y,g)=>(l++,g.delete()));s.push(u.next(()=>{it(l===1,47070,{batchId:t.batchId})}));const f=[];for(const m of t.mutations){const y=Ik(e,m.key.path,t.batchId);s.push(i.delete(y)),f.push(m.key)}return ve.waitFor(s).next(()=>f)}function Wg(r){if(!r)return 0;let e;if(r.document)e=r.document;else if(r.unknownDocument)e=r.unknownDocument;else{if(!r.noDocument)throw Ye(14731);e=r.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Kr.DEFAULT_COLLECTION_PERCENTILE=10,Kr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Kr.DEFAULT=new Kr(MP,Kr.DEFAULT_COLLECTION_PERCENTILE,Kr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Kr.DISABLED=new Kr(-1,0,0);class Vy{constructor(e,t,n,i){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=i,this.er={}}static bt(e,t,n,i){it(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new Vy(s,t,n,i)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return El(e).te({index:$c,range:n},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,n,i){const s=ud(e),o=El(e);return o.add({}).next(l=>{it(typeof l=="number",49019);const u=new Sb(l,t,n,i),f=function(_,E,x){const w=x.baseMutations.map(I=>qg(_.wt,I)),S=x.mutations.map(I=>qg(_.wt,I));return{userId:E,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:w,mutations:S}}(this.serializer,this.userId,u),m=[];let y=new mn((g,_)=>vt(g.canonicalString(),_.canonicalString()));for(const g of i){const _=Ik(this.userId,g.key.path,l);y=y.add(g.key.path.popLast()),m.push(o.put(f)),m.push(s.put(_,$M))}return y.forEach(g=>{m.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.er[l]=u.keys()}),ve.waitFor(m).next(()=>u)})}lookupMutationBatch(e,t){return El(e).get(t).next(n=>n?(it(n.userId===this.userId,48,"Unexpected user for mutation batch",{userId:n.userId,batchId:t}),Bc(this.serializer,n)):null)}tr(e,t){return this.er[t]?ve.resolve(this.er[t]):this.lookupMutationBatch(e,t).next(n=>{if(n){const i=n.keys();return this.er[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return El(e).te({index:$c,range:i},(o,l,u)=>{l.userId===this.userId&&(it(l.batchId>=n,47524,{nr:n}),s=Bc(this.serializer,l)),u.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=Gc;return El(e).te({index:$c,range:t,reverse:!0},(i,s,o)=>{n=s.batchId,o.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Gc],[this.userId,Number.POSITIVE_INFINITY]);return El(e).J($c,t).next(n=>n.map(i=>Bc(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=cg(this.userId,t.path),i=IDBKeyRange.lowerBound(n),s=[];return ud(e).te({range:i},(o,l,u)=>{const[f,m,y]=o,g=ko(m);if(f===this.userId&&t.path.isEqual(g))return El(e).get(y).next(_=>{if(!_)throw Ye(61480,{rr:o,batchId:y});it(_.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:_.userId,batchId:y}),s.push(Bc(this.serializer,_))});u.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new mn(vt);const i=[];return t.forEach(s=>{const o=cg(this.userId,s.path),l=IDBKeyRange.lowerBound(o),u=ud(e).te({range:l},(f,m,y)=>{const[g,_,E]=f,x=ko(_);g===this.userId&&s.path.isEqual(x)?n=n.add(E):y.done()});i.push(u)}),ve.waitFor(i).next(()=>this.ir(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1,s=cg(this.userId,n),o=IDBKeyRange.lowerBound(s);let l=new mn(vt);return ud(e).te({range:o},(u,f,m)=>{const[y,g,_]=u,E=ko(g);y===this.userId&&n.isPrefixOf(E)?E.length===i&&(l=l.add(_)):m.done()}).next(()=>this.ir(e,l))}ir(e,t){const n=[],i=[];return t.forEach(s=>{i.push(El(e).get(s).next(o=>{if(o===null)throw Ye(35274,{batchId:s});it(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),n.push(Bc(this.serializer,o))}))}),ve.waitFor(i).next(()=>n)}removeMutationBatch(e,t){return DP(e.he,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.sr(t.batchId)}),ve.forEach(n,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}sr(e){delete this.er[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return ve.resolve();const n=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return ud(e).te({range:n},(s,o,l)=>{if(s[0]===this.userId){const u=ko(s[1]);i.push(u)}else l.done()}).next(()=>{it(i.length===0,56720,{_r:i.map(s=>s.canonicalString())})})})}containsKey(e,t){return LP(e,this.userId,t)}ar(e){return FP(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:Gc,lastStreamToken:""})}}function LP(r,e,t){const n=cg(e,t.path),i=n[1],s=IDBKeyRange.lowerBound(n);let o=!1;return ud(r).te({range:s,ee:!0},(l,u,f)=>{const[m,y,g]=l;m===e&&y===i&&(o=!0),f.done()}).next(()=>o)}function El(r){return pr(r,ro)}function ud(r){return pr(r,wd)}function FP(r){return pr(r,Bf)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lu{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new lu(0)}static lr(){return new lu(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.hr(e).next(t=>{const n=new lu(t.highestTargetId);return t.highestTargetId=n.next(),this.Pr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.hr(e).next(t=>lt.fromTimestamp(new Ot(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.hr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.hr(e).next(i=>(i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Pr(e,i)))}addTargetData(e,t){return this.Tr(e,t).next(()=>this.hr(e).next(n=>(n.targetCount+=1,this.Ir(t,n),this.Pr(e,n))))}updateTargetData(e,t){return this.Tr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>td(e).delete(t.targetId)).next(()=>this.hr(e)).next(n=>(it(n.targetCount>0,8065),n.targetCount-=1,this.Pr(e,n)))}removeTargets(e,t,n){let i=0;const s=[];return td(e).te((o,l)=>{const u=af(l);u.sequenceNumber<=t&&n.get(u.targetId)===null&&(i++,s.push(this.removeTargetData(e,u)))}).next(()=>ve.waitFor(s)).next(()=>i)}forEachTarget(e,t){return td(e).te((n,i)=>{const s=af(i);t(s)})}hr(e){return oS(e).get(Lg).next(t=>(it(t!==null,2888),t))}Pr(e,t){return oS(e).put(Lg,t)}Tr(e,t){return td(e).put(CP(this.serializer,t))}Ir(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.hr(e).next(t=>t.targetCount)}getTargetData(e,t){const n=iu(t),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return td(e).te({range:i,index:kk},(o,l,u)=>{const f=af(l);pm(t,f.target)&&(s=f,u.done())}).next(()=>s)}addMatchingKeys(e,t,n){const i=[],s=Pl(e);return t.forEach(o=>{const l=Xr(o.path);i.push(s.put({targetId:n,path:l})),i.push(this.referenceDelegate.addReference(e,n,o))}),ve.waitFor(i)}removeMatchingKeys(e,t,n){const i=Pl(e);return ve.forEach(t,s=>{const o=Xr(s.path);return ve.waitFor([i.delete([n,o]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,t){const n=Pl(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),i=Pl(e);let s=Lt();return i.te({range:n,ee:!0},(o,l,u)=>{const f=ko(o[1]),m=new qe(f);s=s.add(m)}).next(()=>s)}containsKey(e,t){const n=Xr(t.path),i=IDBKeyRange.bound([n],[xk(n)],!1,!0);let s=0;return Pl(e).te({index:mb,ee:!0,range:i},([o,l],u,f)=>{o!==0&&(s++,f.done())}).next(()=>s>0)}Rt(e,t){return td(e).get(t).next(n=>n?af(n):null)}}function td(r){return pr(r,Ed)}function oS(r){return pr(r,Kc)}function Pl(r){return pr(r,Td)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aS="LruGarbageCollector",y6=1048576;function lS([r,e],[t,n]){const i=vt(r,t);return i===0?vt(e,n):i}class v6{constructor(e){this.Er=e,this.buffer=new mn(lS),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();lS(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class VP{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){Re(aS,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){rc(t)?Re(aS,"Ignoring IndexedDB error during garbage collection: ",t):await nc(t)}await this.mr(3e5)})}}class _6{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return ve.resolve(Li.le);const n=new v6(t);return this.gr.forEachTarget(e,i=>n.Rr(i.sequenceNumber)).next(()=>this.gr.yr(e,i=>n.Rr(i))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.gr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Re("LruGarbageCollector","Garbage collection skipped; disabled"),ve.resolve(sS)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Re("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),sS):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let n,i,s,o,l,u,f;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(Re("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),i=this.params.maximumSequenceNumbersToCollect):i=y,o=Date.now(),this.nthSequenceNumber(e,i))).next(y=>(n=y,l=Date.now(),this.removeTargets(e,n,t))).next(y=>(s=y,u=Date.now(),this.removeOrphanedDocuments(e,n))).next(y=>(f=Date.now(),ad()<=Bt.DEBUG&&Re("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-m}ms
	Determined least recently used ${i} in `+(l-o)+`ms
	Removed ${s} targets in `+(u-l)+`ms
	Removed ${y} documents in `+(f-u)+`ms
Total Duration: ${f-m}ms`),ve.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:y})))}}function zP(r,e){return new _6(r,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x6{constructor(e,t){this.db=e,this.garbageCollector=zP(this,t)}pr(e){const t=this.br(e);return this.db.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}br(e){let t=0;return this.yr(e,n=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}yr(e,t){return this.Sr(e,(n,i)=>t(i))}addReference(e,t,n){return jp(e,n)}removeReference(e,t,n){return jp(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return jp(e,t)}Dr(e,t){return function(i,s){let o=!1;return FP(i).ne(l=>LP(i,l,s).next(u=>(u&&(o=!0),ve.resolve(!u)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,(o,l)=>{if(l<=t){const u=this.Dr(e,o).next(f=>{if(!f)return s++,n.getEntry(e,o).next(()=>(n.removeEntry(o,lt.min()),Pl(e).delete(function(y){return[0,Xr(y.path)]}(o))))});i.push(u)}}).next(()=>ve.waitFor(i)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return jp(e,t)}Sr(e,t){const n=Pl(e);let i,s=Li.le;return n.te({index:mb},([o,l],{path:u,sequenceNumber:f})=>{o===0?(s!==Li.le&&t(new qe(ko(i)),s),s=f,i=u):s=Li.le}).next(()=>{s!==Li.le&&t(new qe(ko(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function jp(r,e){return Pl(r).put(function(n,i){return{targetId:0,path:Xr(n.path),sequenceNumber:i}}(e,r.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BP{constructor(){this.changes=new Ra(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Un.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?ve.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b6{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Cc(e).put(n)}removeEntry(e,t,n){return Cc(e).delete(function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Hg(o),l[l.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.vr(e,n)))}getEntry(e,t){let n=Un.newInvalidDocument(t);return Cc(e).te({index:ug,range:IDBKeyRange.only(Mh(t))},(i,s)=>{n=this.Cr(t,s)}).next(()=>n)}Fr(e,t){let n={size:0,document:Un.newInvalidDocument(t)};return Cc(e).te({index:ug,range:IDBKeyRange.only(Mh(t))},(i,s)=>{n={document:this.Cr(t,s),size:Wg(s)}}).next(()=>n)}getEntries(e,t){let n=ns();return this.Mr(e,t,(i,s)=>{const o=this.Cr(i,s);n=n.insert(i,o)}).next(()=>n)}Or(e,t){let n=ns(),i=new An(qe.comparator);return this.Mr(e,t,(s,o)=>{const l=this.Cr(s,o);n=n.insert(s,l),i=i.insert(s,Wg(o))}).next(()=>({documents:n,Nr:i}))}Mr(e,t,n){if(t.isEmpty())return ve.resolve();let i=new mn(dS);t.forEach(u=>i=i.add(u));const s=IDBKeyRange.bound(Mh(i.first()),Mh(i.last())),o=i.getIterator();let l=o.getNext();return Cc(e).te({index:ug,range:s},(u,f,m)=>{const y=qe.fromSegments([...f.prefixPath,f.collectionGroup,f.documentId]);for(;l&&dS(l,y)<0;)n(l,null),l=o.getNext();l&&l.isEqual(y)&&(n(l,f),l=o.hasNext()?o.getNext():null),l?m.H(Mh(l)):m.done()}).next(()=>{for(;l;)n(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,n,i,s){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),Hg(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],u=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Cc(e).J(IDBKeyRange.bound(l,u,!0)).next(f=>{s==null||s.incrementDocumentReadCount(f.length);let m=ns();for(const y of f){const g=this.Cr(qe.fromSegments(y.prefixPath.concat(y.collectionGroup,y.documentId)),y);g.isFoundDocument()&&(ym(t,g)||i.has(g.key))&&(m=m.insert(g.key,g))}return m})}getAllFromCollectionGroup(e,t,n,i){let s=ns();const o=uS(t,n),l=uS(t,ss.max());return Cc(e).te({index:Nk,range:IDBKeyRange.bound(o,l,!0)},(u,f,m)=>{const y=this.Cr(qe.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);s=s.insert(y.key,y),s.size===i&&m.done()}).next(()=>s)}newChangeBuffer(e){return new w6(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return cS(e).get(ax).next(t=>(it(!!t,20021),t))}vr(e,t){return cS(e).put(ax,t)}Cr(e,t){if(t){const n=o6(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(lt.min())))return n}return Un.newInvalidDocument(e)}}function UP(r){return new b6(r)}class w6 extends BP{constructor(e,t){super(),this.Br=e,this.trackRemovals=t,this.Lr=new Ra(n=>n.toString(),(n,i)=>n.isEqual(i))}applyChanges(e){const t=[];let n=0,i=new mn((s,o)=>vt(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const l=this.Lr.get(s);if(t.push(this.Br.removeEntry(e,s,l.readTime)),o.isValidDocument()){const u=WT(this.Br.serializer,o);i=i.add(s.path.popLast());const f=Wg(u);n+=f-l.size,t.push(this.Br.addEntry(e,s,u))}else if(n-=l.size,this.trackRemovals){const u=WT(this.Br.serializer,o.convertToNoDocument(lt.min()));t.push(this.Br.addEntry(e,s,u))}}),i.forEach(s=>{t.push(this.Br.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.Br.updateMetadata(e,n)),ve.waitFor(t)}getFromCache(e,t){return this.Br.Fr(e,t).next(n=>(this.Lr.set(t,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,t){return this.Br.Or(e,t).next(({documents:n,Nr:i})=>(i.forEach((s,o)=>{this.Lr.set(s,{size:o,readTime:n.get(s).readTime})}),n))}}function cS(r){return pr(r,Uf)}function Cc(r){return pr(r,Dg)}function Mh(r){const e=r.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function uS(r,e){const t=e.documentKey.path.toArray();return[r,Hg(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function dS(r,e){const t=r.path.toArray(),n=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<n.length-2;++s)if(i=vt(t[s],n[s]),i)return i;return i=vt(t.length,n.length),i||(i=vt(t[t.length-2],n[n.length-2]),i||vt(t[t.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E6{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qP{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(n!==null&&If(n.mutation,i,Fi.empty(),Ot.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,Lt()).next(()=>n))}getLocalViewOfDocuments(e,t,n=Lt()){const i=Po();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(s=>{let o=sf();return s.forEach((l,u)=>{o=o.insert(l,u.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=Po();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Lt()))}populateOverlays(e,t,n){const i=[];return n.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,l)=>{t.set(o,l)})})}computeViews(e,t,n,i){let s=ns();const o=Af(),l=function(){return Af()}();return t.forEach((u,f)=>{const m=n.get(f.key);i.has(f.key)&&(m===void 0||m.mutation instanceof Oa)?s=s.insert(f.key,f):m!==void 0?(o.set(f.key,m.mutation.getFieldMask()),If(m.mutation,f,m.mutation.getFieldMask(),Ot.now())):o.set(f.key,Fi.empty())}),this.recalculateAndSaveOverlays(e,s).next(u=>(u.forEach((f,m)=>o.set(f,m)),t.forEach((f,m)=>{var y;return l.set(f,new E6(m,(y=o.get(f))!==null&&y!==void 0?y:null))}),l))}recalculateAndSaveOverlays(e,t){const n=Af();let i=new An((o,l)=>o-l),s=Lt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const l of o)l.keys().forEach(u=>{const f=t.get(u);if(f===null)return;let m=n.get(u)||Fi.empty();m=l.applyToLocalView(f,m),n.set(u,m);const y=(i.get(l.batchId)||Lt()).add(u);i=i.insert(l.batchId,y)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const u=l.getNext(),f=u.key,m=u.value,y=lP();m.forEach(g=>{if(!s.has(g)){const _=mP(t.get(g),n.get(g));_!==null&&y.set(g,_),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,f,y))}return ve.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return function(o){return qe.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):tP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):ve.resolve(Po());let l=bd,u=s;return o.next(f=>ve.forEach(f,(m,y)=>(l<y.largestBatchId&&(l=y.largestBatchId),s.get(m)?ve.resolve():this.remoteDocumentCache.getEntry(e,m).next(g=>{u=u.insert(m,g)}))).next(()=>this.populateOverlays(e,f,s)).next(()=>this.computeViews(e,u,f,Lt())).next(m=>({batchId:l,changes:aP(m)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new qe(t)).next(n=>{let i=sf();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const s=t.collectionGroup;let o=sf();return this.indexManager.getCollectionParents(e,s).next(l=>ve.forEach(l,u=>{const f=function(y,g){return new Hd(g,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(t,u.child(s));return this.getDocumentsMatchingCollectionQuery(e,f,n,i).next(m=>{m.forEach((y,g)=>{o=o.insert(y,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,i))).next(o=>{s.forEach((u,f)=>{const m=f.getKey();o.get(m)===null&&(o=o.insert(m,Un.newInvalidDocument(m)))});let l=sf();return o.forEach((u,f)=>{const m=s.get(u);m!==void 0&&If(m.mutation,f,Fi.empty(),Ot.now()),ym(t,f)&&(l=l.insert(u,f))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T6{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return ve.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:hi(i.createTime)}}(t)),ve.resolve()}getNamedQuery(e,t){return ve.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(i){return{name:i.name,query:RP(i.bundledQuery),readTime:hi(i.readTime)}}(t)),ve.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S6{constructor(){this.overlays=new An(qe.comparator),this.Qr=new Map}getOverlay(e,t){return ve.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Po();return ve.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,s)=>{this.St(e,t,s)}),ve.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.Qr.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Qr.delete(n)),ve.resolve()}getOverlaysForCollection(e,t,n){const i=Po(),s=t.length+1,o=new qe(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const u=l.getNext().value,f=u.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===s&&u.largestBatchId>n&&i.set(u.getKey(),u)}return ve.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new An((f,m)=>f-m);const o=this.overlays.getIterator();for(;o.hasNext();){const f=o.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>n){let m=s.get(f.largestBatchId);m===null&&(m=Po(),s=s.insert(f.largestBatchId,m)),m.set(f.getKey(),f)}}const l=Po(),u=s.getIterator();for(;u.hasNext()&&(u.getNext().value.forEach((f,m)=>l.set(f,m)),!(l.size()>=i)););return ve.resolve(l)}St(e,t,n){const i=this.overlays.get(n.key);if(i!==null){const o=this.Qr.get(i.largestBatchId).delete(n.key);this.Qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new Ib(t,n));let s=this.Qr.get(t);s===void 0&&(s=Lt(),this.Qr.set(t,s)),this.Qr.set(t,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6{constructor(){this.sessionToken=Zn.EMPTY_BYTE_STRING}getSessionToken(e){return ve.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ve.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ob{constructor(){this.$r=new mn(Er.Ur),this.Kr=new mn(Er.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const n=new Er(e,t);this.$r=this.$r.add(n),this.Kr=this.Kr.add(n)}Gr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.zr(new Er(e,t))}jr(e,t){e.forEach(n=>this.removeReference(n,t))}Hr(e){const t=new qe(new sn([])),n=new Er(t,e),i=new Er(t,e+1),s=[];return this.Kr.forEachInRange([n,i],o=>{this.zr(o),s.push(o.key)}),s}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new qe(new sn([])),n=new Er(t,e),i=new Er(t,e+1);let s=Lt();return this.Kr.forEachInRange([n,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new Er(e,0),n=this.$r.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class Er{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return qe.comparator(e.key,t.key)||vt(e.Zr,t.Zr)}static Wr(e,t){return vt(e.Zr,t.Zr)||qe.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new mn(Er.Ur)}checkEmpty(e){return ve.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){const s=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Sb(s,t,n,i);this.mutationQueue.push(o);for(const l of i)this.Xr=this.Xr.add(new Er(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return ve.resolve(o)}lookupMutationBatch(e,t){return ve.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.ti(n),s=i<0?0:i;return ve.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ve.resolve(this.mutationQueue.length===0?Gc:this.nr-1)}getAllMutationBatches(e){return ve.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Er(t,0),i=new Er(t,Number.POSITIVE_INFINITY),s=[];return this.Xr.forEachInRange([n,i],o=>{const l=this.ei(o.Zr);s.push(l)}),ve.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new mn(vt);return t.forEach(i=>{const s=new Er(i,0),o=new Er(i,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([s,o],l=>{n=n.add(l.Zr)})}),ve.resolve(this.ni(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;qe.isDocumentKey(s)||(s=s.child(""));const o=new Er(new qe(s),0);let l=new mn(vt);return this.Xr.forEachWhile(u=>{const f=u.key.path;return!!n.isPrefixOf(f)&&(f.length===i&&(l=l.add(u.Zr)),!0)},o),ve.resolve(this.ni(l))}ni(e){const t=[];return e.forEach(n=>{const i=this.ei(n);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){it(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Xr;return ve.forEach(t.mutations,i=>{const s=new Er(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Xr=n})}sr(e){}containsKey(e,t){const n=new Er(t,0),i=this.Xr.firstAfterOrEqual(n);return ve.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ve.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N6{constructor(e){this.ii=e,this.docs=function(){return new An(qe.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,o=this.ii(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ve.resolve(n?n.document.mutableCopy():Un.newInvalidDocument(t))}getEntries(e,t){let n=ns();return t.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Un.newInvalidDocument(i))}),ve.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=ns();const o=t.path,l=new qe(o.child("__id-9223372036854775808__")),u=this.docs.getIteratorFrom(l);for(;u.hasNext();){const{key:f,value:{document:m}}=u.getNext();if(!o.isPrefixOf(f.path))break;f.path.length>o.length+1||hb(wk(m),n)<=0||(i.has(m.key)||ym(t,m))&&(s=s.insert(m.key,m.mutableCopy()))}return ve.resolve(s)}getAllFromCollectionGroup(e,t,n,i){Ye(9500)}si(e,t){return ve.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new k6(this)}getSize(e){return ve.resolve(this.size)}}class k6 extends BP{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.Br.addEntry(e,i)):this.Br.removeEntry(n)}),ve.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P6{constructor(e){this.persistence=e,this.oi=new Ra(t=>iu(t),pm),this.lastRemoteSnapshotVersion=lt.min(),this.highestTargetId=0,this._i=0,this.ai=new Ob,this.targetCount=0,this.ui=lu.cr()}forEachTarget(e,t){return this.oi.forEach((n,i)=>t(i)),ve.resolve()}getLastRemoteSnapshotVersion(e){return ve.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ve.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),ve.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this._i&&(this._i=t),ve.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new lu(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,ve.resolve()}updateTargetData(e,t){return this.Tr(t),ve.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,ve.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.oi.forEach((o,l)=>{l.sequenceNumber<=t&&n.get(l.targetId)===null&&(this.oi.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),ve.waitFor(s).next(()=>i)}getTargetCount(e){return ve.resolve(this.targetCount)}getTargetData(e,t){const n=this.oi.get(t)||null;return ve.resolve(n)}addMatchingKeys(e,t,n){return this.ai.Gr(t,n),ve.resolve()}removeMatchingKeys(e,t,n){this.ai.jr(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),ve.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),ve.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ai.Yr(t);return ve.resolve(n)}containsKey(e,t){return ve.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(e,t){this.ci={},this.overlays={},this.li=new Li(0),this.hi=!1,this.hi=!0,this.Pi=new A6,this.referenceDelegate=e(this),this.Ti=new P6(this),this.indexManager=new m6,this.remoteDocumentCache=function(i){return new N6(i)}(n=>this.referenceDelegate.Ii(n)),this.serializer=new PP(t),this.Ei=new T6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new S6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ci[e.toKey()];return n||(n=new I6(t,this.referenceDelegate),this.ci[e.toKey()]=n),n}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,n){Re("MemoryPersistence","Starting transaction:",e);const i=new C6(this.li.next());return this.referenceDelegate.di(),n(i).next(s=>this.referenceDelegate.Ai(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ri(e,t){return ve.or(Object.values(this.ci).map(n=>()=>n.containsKey(e,t)))}}class C6 extends Tk{constructor(e){super(),this.currentSequenceNumber=e}}class zy{constructor(e){this.persistence=e,this.Vi=new Ob,this.mi=null}static fi(e){return new zy(e)}get gi(){if(this.mi)return this.mi;throw Ye(60996)}addReference(e,t,n){return this.Vi.addReference(n,t),this.gi.delete(n.toString()),ve.resolve()}removeReference(e,t,n){return this.Vi.removeReference(n,t),this.gi.add(n.toString()),ve.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),ve.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(i=>this.gi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.gi.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ve.forEach(this.gi,n=>{const i=qe.fromPath(n);return this.pi(e,i).next(s=>{s||t.removeEntry(i,lt.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(n=>{n?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return ve.or([()=>ve.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class Gg{constructor(e,t){this.persistence=e,this.yi=new Ra(n=>Xr(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=zP(this,t)}static fi(e,t){return new Gg(e,t)}di(){}Ai(e){return ve.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}br(e){let t=0;return this.yr(e,n=>{t++}).next(()=>t)}yr(e,t){return ve.forEach(this.yi,(n,i)=>this.Dr(e,n,i).next(s=>s?ve.resolve():t(i)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.si(e,o=>this.Dr(e,o,t).next(l=>{l||(n++,s.removeEntry(o,lt.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),ve.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.yi.set(n,e.currentSequenceNumber),ve.resolve()}removeReference(e,t,n){return this.yi.set(n,e.currentSequenceNumber),ve.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),ve.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=hg(e.data.value)),t}Dr(e,t,n){return ve.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.yi.get(t);return ve.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R6{constructor(e){this.serializer=e}q(e,t,n,i){const s=new Ny("createOrUpgrade",t);n<1&&i>=1&&(function(u){u.createObjectStore(mm)}(e),function(u){u.createObjectStore(Bf,{keyPath:HM}),u.createObjectStore(ro,{keyPath:wT,autoIncrement:!0}).createIndex($c,ET,{unique:!0}),u.createObjectStore(wd)}(e),hS(e),function(u){u.createObjectStore(Lc)}(e));let o=ve.resolve();return n<3&&i>=3&&(n!==0&&(function(u){u.deleteObjectStore(Td),u.deleteObjectStore(Ed),u.deleteObjectStore(Kc)}(e),hS(e)),o=o.next(()=>function(u){const f=u.store(Kc),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:lt.min().toTimestamp(),targetCount:0};return f.put(Lg,m)}(s))),n<4&&i>=4&&(n!==0&&(o=o.next(()=>function(u,f){return f.store(ro).J().next(y=>{u.deleteObjectStore(ro),u.createObjectStore(ro,{keyPath:wT,autoIncrement:!0}).createIndex($c,ET,{unique:!0});const g=f.store(ro),_=y.map(E=>g.put(E));return ve.waitFor(_)})}(e,s))),o=o.next(()=>{(function(u){u.createObjectStore(Sd,{keyPath:JM})})(e)})),n<5&&i>=5&&(o=o.next(()=>this.wi(s))),n<6&&i>=6&&(o=o.next(()=>(function(u){u.createObjectStore(Uf)}(e),this.bi(s)))),n<7&&i>=7&&(o=o.next(()=>this.Si(s))),n<8&&i>=8&&(o=o.next(()=>this.Di(e,s))),n<9&&i>=9&&(o=o.next(()=>{(function(u){u.objectStoreNames.contains("remoteDocumentChanges")&&u.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&i>=10&&(o=o.next(()=>this.Ci(s))),n<11&&i>=11&&(o=o.next(()=>{(function(u){u.createObjectStore(Py,{keyPath:eD})})(e),function(u){u.createObjectStore(Cy,{keyPath:tD})}(e)})),n<12&&i>=12&&(o=o.next(()=>{(function(u){const f=u.createObjectStore(Ry,{keyPath:lD});f.createIndex(cx,cD,{unique:!1}),f.createIndex(Rk,uD,{unique:!1})})(e)})),n<13&&i>=13&&(o=o.next(()=>function(u){const f=u.createObjectStore(Dg,{keyPath:WM});f.createIndex(ug,GM),f.createIndex(Nk,KM)}(e)).next(()=>this.Fi(e,s)).next(()=>e.deleteObjectStore(Lc))),n<14&&i>=14&&(o=o.next(()=>this.Mi(e,s))),n<15&&i>=15&&(o=o.next(()=>function(u){u.createObjectStore(pb,{keyPath:nD,autoIncrement:!0}).createIndex(lx,rD,{unique:!1}),u.createObjectStore(wf,{keyPath:iD}).createIndex(Pk,sD,{unique:!1}),u.createObjectStore(Ef,{keyPath:oD}).createIndex(Ck,aD,{unique:!1})}(e))),n<16&&i>=16&&(o=o.next(()=>{t.objectStore(wf).clear()}).next(()=>{t.objectStore(Ef).clear()})),n<17&&i>=17&&(o=o.next(()=>{(function(u){u.createObjectStore(gb,{keyPath:dD})})(e)})),n<18&&i>=18&&b4()&&(o=o.next(()=>{t.objectStore(wf).clear()}).next(()=>{t.objectStore(Ef).clear()})),o}bi(e){let t=0;return e.store(Lc).te((n,i)=>{t+=Wg(i)}).next(()=>{const n={byteSize:t};return e.store(Uf).put(ax,n)})}wi(e){const t=e.store(Bf),n=e.store(ro);return t.J().next(i=>ve.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,Gc],[s.userId,s.lastAcknowledgedBatchId]);return n.J($c,o).next(l=>ve.forEach(l,u=>{it(u.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:u.batchId});const f=Bc(this.serializer,u);return DP(e,s.userId,f).next(()=>{})}))}))}Si(e){const t=e.store(Td),n=e.store(Lc);return e.store(Kc).get(Lg).next(i=>{const s=[];return n.te((o,l)=>{const u=new sn(o),f=function(y){return[0,Xr(y)]}(u);s.push(t.get(f).next(m=>m?ve.resolve():(y=>t.put({targetId:0,path:Xr(y),sequenceNumber:i.highestListenSequenceNumber}))(u)))}).next(()=>ve.waitFor(s))})}Di(e,t){e.createObjectStore(qf,{keyPath:XM});const n=t.store(qf),i=new Rb,s=o=>{if(i.add(o)){const l=o.lastSegment(),u=o.popLast();return n.put({collectionId:l,parent:Xr(u)})}};return t.store(Lc).te({ee:!0},(o,l)=>{const u=new sn(o);return s(u.popLast())}).next(()=>t.store(wd).te({ee:!0},([o,l,u],f)=>{const m=ko(l);return s(m.popLast())}))}Ci(e){const t=e.store(Ed);return t.te((n,i)=>{const s=af(i),o=CP(this.serializer,s);return t.put(o)})}Fi(e,t){const n=t.store(Lc),i=[];return n.te((s,o)=>{const l=t.store(Dg),u=function(y){return y.document?new qe(sn.fromString(y.document.name).popFirst(5)):y.noDocument?qe.fromSegments(y.noDocument.path):y.unknownDocument?qe.fromSegments(y.unknownDocument.path):Ye(36783)}(o).path.toArray(),f={prefixPath:u.slice(0,u.length-2),collectionGroup:u[u.length-2],documentId:u[u.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(l.put(f))}).next(()=>ve.waitFor(i))}Mi(e,t){const n=t.store(ro),i=UP(this.serializer),s=new jb(zy.fi,this.serializer.wt);return n.J().next(o=>{const l=new Map;return o.forEach(u=>{var f;let m=(f=l.get(u.userId))!==null&&f!==void 0?f:Lt();Bc(this.serializer,u).keys().forEach(y=>m=m.add(y)),l.set(u.userId,m)}),ve.forEach(l,(u,f)=>{const m=new Tr(f),y=Fy.bt(this.serializer,m),g=s.getIndexManager(m),_=Vy.bt(m,this.serializer,g,s.referenceDelegate);return new qP(i,_,y,g).recalculateAndSaveOverlaysForDocumentKeys(new ux(t,Li.le),u).next()})})}}function hS(r){r.createObjectStore(Td,{keyPath:ZM}).createIndex(mb,QM,{unique:!0}),r.createObjectStore(Ed,{keyPath:"targetId"}).createIndex(kk,YM,{unique:!0}),r.createObjectStore(Kc)}const Tl="IndexedDbPersistence",Vv=18e5,zv=5e3,Bv="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",O6="main";class Mb{constructor(e,t,n,i,s,o,l,u,f,m,y=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.xi=s,this.window=o,this.document=l,this.Oi=f,this.Ni=m,this.Bi=y,this.li=null,this.hi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Li=null,this.inForeground=!1,this.ki=null,this.qi=null,this.Qi=Number.NEGATIVE_INFINITY,this.$i=g=>Promise.resolve(),!Mb.C())throw new Be(Ne.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new x6(this,i),this.Ui=t+O6,this.serializer=new PP(u),this.Ki=new Vl(this.Ui,this.Bi,new R6(this.serializer)),this.Pi=new l6,this.Ti=new g6(this.referenceDelegate,this.serializer),this.remoteDocumentCache=UP(this.serializer),this.Ei=new a6,this.window&&this.window.localStorage?this.Wi=this.window.localStorage:(this.Wi=null,m===!1&&Kn(Tl,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Gi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Be(Ne.FAILED_PRECONDITION,Bv);return this.zi(),this.ji(),this.Hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ti.getHighestSequenceNumber(e))}).then(e=>{this.li=new Li(e,this.Oi)}).then(()=>{this.hi=!0}).catch(e=>(this.Ki&&this.Ki.close(),Promise.reject(e)))}Ji(e){return this.$i=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ki.U(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.xi.enqueueAndForget(async()=>{this.started&&await this.Gi()}))}Gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Mp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Yi(e).next(t=>{t||(this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)))})}).next(()=>this.Zi(e)).next(t=>this.isPrimary&&!t?this.Xi(e).next(()=>!1):!!t&&this.es(e).next(()=>!0))).catch(e=>{if(rc(e))return Re(Tl,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Re(Tl,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.xi.enqueueRetryable(()=>this.$i(e)),this.isPrimary=e})}Yi(e){return Dh(e).get(Zu).next(t=>ve.resolve(this.ts(t)))}ns(e){return Mp(e).delete(this.clientId)}async rs(){if(this.isPrimary&&!this.ss(this.Qi,Vv)){this.Qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const n=pr(t,Sd);return n.J().next(i=>{const s=this._s(i,Vv),o=i.filter(l=>s.indexOf(l)===-1);return ve.forEach(o,l=>n.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Wi)for(const t of e)this.Wi.removeItem(this.us(t.clientId))}}Hi(){this.qi=this.xi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Gi().then(()=>this.rs()).then(()=>this.Hi()))}ts(e){return!!e&&e.ownerId===this.clientId}Zi(e){return this.Ni?ve.resolve(!0):Dh(e).get(Zu).next(t=>{if(t!==null&&this.ss(t.leaseTimestampMs,zv)&&!this.cs(t.ownerId)){if(this.ts(t)&&this.networkEnabled)return!0;if(!this.ts(t)){if(!t.allowTabSynchronization)throw new Be(Ne.FAILED_PRECONDITION,Bv);return!1}}return!(!this.networkEnabled||!this.inForeground)||Mp(e).J().next(n=>this._s(n,zv).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,l=this.networkEnabled===i.networkEnabled;if(s||o&&l)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&Re(Tl,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.hi=!1,this.ls(),this.qi&&(this.qi.cancel(),this.qi=null),this.hs(),this.Ps(),await this.Ki.runTransaction("shutdown","readwrite",[mm,Sd],e=>{const t=new ux(e,Li.le);return this.Xi(t).next(()=>this.ns(t))}),this.Ki.close(),this.Ts()}_s(e,t){return e.filter(n=>this.ss(n.updateTimeMs,t)&&!this.cs(n.clientId))}Is(){return this.runTransaction("getActiveClients","readonly",e=>Mp(e).J().next(t=>this._s(t,Vv).map(n=>n.clientId)))}get started(){return this.hi}getGlobalsCache(){return this.Pi}getMutationQueue(e,t){return Vy.bt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new p6(e,this.serializer.wt.databaseId)}getDocumentOverlayCache(e){return Fy.bt(this.serializer,e)}getBundleCache(){return this.Ei}runTransaction(e,t,n){Re(Tl,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=function(u){return u===18?mD:u===17?Dk:u===16?fD:u===15?yb:u===14?Mk:u===13?jk:u===12?hD:u===11?Ok:void Ye(60245)}(this.Bi);let o;return this.Ki.runTransaction(e,i,s,l=>(o=new ux(l,this.li?this.li.next():Li.le),t==="readwrite-primary"?this.Yi(o).next(u=>!!u||this.Zi(o)).next(u=>{if(!u)throw Kn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)),new Be(Ne.FAILED_PRECONDITION,Ek);return n(o)}).next(u=>this.es(o).next(()=>u)):this.Es(o).next(()=>n(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Es(e){return Dh(e).get(Zu).next(t=>{if(t!==null&&this.ss(t.leaseTimestampMs,zv)&&!this.cs(t.ownerId)&&!this.ts(t)&&!(this.Ni||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Be(Ne.FAILED_PRECONDITION,Bv)})}es(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Dh(e).put(Zu,t)}static C(){return Vl.C()}Xi(e){const t=Dh(e);return t.get(Zu).next(n=>this.ts(n)?(Re(Tl,"Releasing primary lease."),t.delete(Zu)):ve.resolve())}ss(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(Kn(`Detected an update time that is in the future: ${e} > ${n}`),!1))}zi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ki=()=>{this.xi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Gi()))},this.document.addEventListener("visibilitychange",this.ki),this.inForeground=this.document.visibilityState==="visible")}hs(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)}ji(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Li=()=>{this.ls();const t=/(?:Version|Mobile)\/1[456]/;x4()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.xi.enterRestrictedMode(!0),this.xi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Li))}Ps(){this.Li&&(this.window.removeEventListener("pagehide",this.Li),this.Li=null)}cs(e){var t;try{const n=((t=this.Wi)===null||t===void 0?void 0:t.getItem(this.us(e)))!==null;return Re(Tl,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Kn(Tl,"Failed to get zombied client id.",n),!1}}ls(){if(this.Wi)try{this.Wi.setItem(this.us(this.clientId),String(Date.now()))}catch(e){Kn("Failed to set zombie client id.",e)}}Ts(){if(this.Wi)try{this.Wi.removeItem(this.us(this.clientId))}catch{}}us(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Dh(r){return pr(r,mm)}function Mp(r){return pr(r,Sd)}function HP(r,e){let t=r.projectId;return r.isDefaultDatabase||(t+="."+r.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Db{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.ds=n,this.As=i}static Rs(e,t){let n=Lt(),i=Lt();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Db(e,t.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return x4()?8:Sk(mr())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,n,i){const s={result:null};return this.ws(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.bs(e,t,i,n).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new j6;return this.Ss(e,t,o).next(l=>{if(s.result=l,this.fs)return this.Ds(e,t,o,l.size)})}).next(()=>s.result)}Ds(e,t,n,i){return n.documentReadCount<this.gs?(ad()<=Bt.DEBUG&&Re("QueryEngine","SDK will not create cache indexes for query:",ld(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),ve.resolve()):(ad()<=Bt.DEBUG&&Re("QueryEngine","Query:",ld(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.ps*i?(ad()<=Bt.DEBUG&&Re("QueryEngine","The SDK decides to create cache indexes for query:",ld(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,rs(t))):ve.resolve())}ws(e,t){if(DT(t))return ve.resolve(null);let n=rs(t);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Bg(t,null,"F"),n=rs(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=Lt(...s);return this.ys.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(u=>{const f=this.vs(t,l);return this.Cs(t,f,o,u.readTime)?this.ws(e,Bg(t,null,"F")):this.Fs(e,f,t,u)}))})))}bs(e,t,n,i){return DT(t)||i.isEqual(lt.min())?ve.resolve(null):this.ys.getDocuments(e,n).next(s=>{const o=this.vs(t,s);return this.Cs(t,o,n,i)?ve.resolve(null):(ad()<=Bt.DEBUG&&Re("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ld(t)),this.Fs(e,o,t,bk(i,bd)).next(l=>l))})}vs(e,t){let n=new mn(sP(e));return t.forEach((i,s)=>{ym(e,s)&&(n=n.add(s))}),n}Cs(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,n){return ad()<=Bt.DEBUG&&Re("QueryEngine","Using full collection scan to execute query:",ld(t)),this.ys.getDocumentsMatchingQuery(e,t,ss.min(),n)}Fs(e,t,n,i){return this.ys.getDocumentsMatchingQuery(e,n,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lb="LocalStore",M6=3e8;class D6{constructor(e,t,n,i){this.persistence=e,this.Ms=t,this.serializer=i,this.xs=new An(vt),this.Os=new Ra(s=>iu(s),pm),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(n)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new qP(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function WP(r,e,t,n){return new D6(r,e,t,n)}async function GP(r,e){const t=Je(r);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,t.Ls(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],l=[];let u=Lt();for(const f of i){o.push(f.batchId);for(const m of f.mutations)u=u.add(m.key)}for(const f of s){l.push(f.batchId);for(const m of f.mutations)u=u.add(m.key)}return t.localDocuments.getDocuments(n,u).next(f=>({ks:f,removedBatchIds:o,addedBatchIds:l}))})})}function L6(r,e){const t=Je(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=t.Bs.newChangeBuffer({trackRemovals:!0});return function(l,u,f,m){const y=f.batch,g=y.keys();let _=ve.resolve();return g.forEach(E=>{_=_.next(()=>m.getEntry(u,E)).next(x=>{const w=f.docVersions.get(E);it(w!==null,48541),x.version.compareTo(w)<0&&(y.applyToRemoteDocument(x,f),x.isValidDocument()&&(x.setReadTime(f.commitVersion),m.addEntry(x)))})}),_.next(()=>l.mutationQueue.removeMutationBatch(u,y))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let u=Lt();for(let f=0;f<l.mutationResults.length;++f)l.mutationResults[f].transformResults.length>0&&(u=u.add(l.batch.mutations[f].key));return u}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}function KP(r){const e=Je(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function F6(r,e){const t=Je(r),n=e.snapshotVersion;let i=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.Bs.newChangeBuffer({trackRemovals:!0});i=t.xs;const l=[];e.targetChanges.forEach((m,y)=>{const g=i.get(y);if(!g)return;l.push(t.Ti.removeMatchingKeys(s,m.removedDocuments,y).next(()=>t.Ti.addMatchingKeys(s,m.addedDocuments,y)));let _=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(y)!==null?_=_.withResumeToken(Zn.EMPTY_BYTE_STRING,lt.min()).withLastLimboFreeSnapshotVersion(lt.min()):m.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(m.resumeToken,n)),i=i.insert(y,_),function(x,w,S){return x.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=M6?!0:S.addedDocuments.size+S.modifiedDocuments.size+S.removedDocuments.size>0}(g,_,m)&&l.push(t.Ti.updateTargetData(s,_))});let u=ns(),f=Lt();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(s,m))}),l.push(V6(s,o,e.documentUpdates).next(m=>{u=m.qs,f=m.Qs})),!n.isEqual(lt.min())){const m=t.Ti.getLastRemoteSnapshotVersion(s).next(y=>t.Ti.setTargetsMetadata(s,s.currentSequenceNumber,n));l.push(m)}return ve.waitFor(l).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,u,f)).next(()=>u)}).then(s=>(t.xs=i,s))}function V6(r,e,t){let n=Lt(),i=Lt();return t.forEach(s=>n=n.add(s)),e.getEntries(r,n).next(s=>{let o=ns();return t.forEach((l,u)=>{const f=s.get(l);u.isFoundDocument()!==f.isFoundDocument()&&(i=i.add(l)),u.isNoDocument()&&u.version.isEqual(lt.min())?(e.removeEntry(l,u.readTime),o=o.insert(l,u)):!f.isValidDocument()||u.version.compareTo(f.version)>0||u.version.compareTo(f.version)===0&&f.hasPendingWrites?(e.addEntry(u),o=o.insert(l,u)):Re(Lb,"Ignoring outdated watch update for ",l,". Current version:",f.version," Watch version:",u.version)}),{qs:o,Qs:i}})}function z6(r,e){const t=Je(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Gc),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function Kg(r,e){const t=Je(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Ti.getTargetData(n,e).next(s=>s?(i=s,ve.resolve(i)):t.Ti.allocateTargetId(n).next(o=>(i=new xa(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Ti.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.xs.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.xs=t.xs.insert(n.targetId,n),t.Os.set(e,n.targetId)),n})}async function Od(r,e,t){const n=Je(r),i=n.xs.get(e),s=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!rc(o))throw o;Re(Lb,`Failed to update sequence numbers for target ${e}: ${o}`)}n.xs=n.xs.remove(e),n.Os.delete(i.target)}function Tx(r,e,t){const n=Je(r);let i=lt.min(),s=Lt();return n.persistence.runTransaction("Execute query","readwrite",o=>function(u,f,m){const y=Je(u),g=y.Os.get(m);return g!==void 0?ve.resolve(y.xs.get(g)):y.Ti.getTargetData(f,m)}(n,o,rs(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,n.Ti.getMatchingKeysForTargetId(o,l.targetId).next(u=>{s=u})}).next(()=>n.Ms.getDocumentsMatchingQuery(o,e,t?i:lt.min(),t?s:Lt())).next(l=>(QP(n,iP(e),l),{documents:l,$s:s})))}function YP(r,e){const t=Je(r),n=Je(t.Ti),i=t.xs.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>n.Rt(s,e).next(o=>o?o.target:null))}function ZP(r,e){const t=Je(r),n=t.Ns.get(e)||lt.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Bs.getAllFromCollectionGroup(i,e,bk(n,bd),Number.MAX_SAFE_INTEGER)).then(i=>(QP(t,e,i),i))}function QP(r,e,t){let n=r.Ns.get(e)||lt.min();t.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),r.Ns.set(e,n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XP="firestore_clients";function fS(r,e){return`${XP}_${r}_${e}`}const JP="firestore_mutations";function mS(r,e,t){let n=`${JP}_${r}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}const eC="firestore_targets";function Uv(r,e){return`${eC}_${r}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const No="SharedClientState";class Yg{constructor(e,t,n,i){this.user=e,this.batchId=t,this.state=n,this.error=i}static Gs(e,t,n){const i=JSON.parse(n);let s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new Be(i.error.code,i.error.message))),o?new Yg(e,t,i.state,s):(Kn(No,`Failed to parse mutation state for ID '${t}': ${n}`),null)}zs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Nf{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Gs(e,t){const n=JSON.parse(t);let i,s=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return s&&n.error&&(s=typeof n.error.message=="string"&&typeof n.error.code=="string",s&&(i=new Be(n.error.code,n.error.message))),s?new Nf(e,n.state,i):(Kn(No,`Failed to parse target state for ID '${e}': ${t}`),null)}zs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Zg{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Gs(e,t){const n=JSON.parse(t);let i=typeof n=="object"&&n.activeTargetIds instanceof Array,s=wb();for(let o=0;i&&o<n.activeTargetIds.length;++o)i=Ak(n.activeTargetIds[o]),s=s.add(n.activeTargetIds[o]);return i?new Zg(e,s):(Kn(No,`Failed to parse client data for instance '${e}': ${t}`),null)}}class Fb{constructor(e,t){this.clientId=e,this.onlineState=t}static Gs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Fb(t.clientId,t.onlineState):(Kn(No,`Failed to parse online state: ${e}`),null)}}class Sx{constructor(){this.activeTargetIds=wb()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class qv{constructor(e,t,n,i,s){this.window=e,this.xi=t,this.persistenceKey=n,this.Js=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ys=this.Zs.bind(this),this.Xs=new An(vt),this.started=!1,this.eo=[];const o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.no=fS(this.persistenceKey,this.Js),this.ro=function(u){return`firestore_sequence_number_${u}`}(this.persistenceKey),this.Xs=this.Xs.insert(this.Js,new Sx),this.io=new RegExp(`^${XP}_${o}_([^_]*)$`),this.so=new RegExp(`^${JP}_${o}_(\\d+)(?:_(.*))?$`),this.oo=new RegExp(`^${eC}_${o}_(\\d+)$`),this._o=function(u){return`firestore_online_state_${u}`}(this.persistenceKey),this.ao=function(u){return`firestore_bundle_loaded_v2_${u}`}(this.persistenceKey),this.window.addEventListener("storage",this.Ys)}static C(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Is();for(const n of e){if(n===this.Js)continue;const i=this.getItem(fS(this.persistenceKey,n));if(i){const s=Zg.Gs(n,i);s&&(this.Xs=this.Xs.insert(s.clientId,s))}}this.uo();const t=this.storage.getItem(this._o);if(t){const n=this.co(t);n&&this.lo(n)}for(const n of this.eo)this.Zs(n);this.eo=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ro,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ho(this.Xs)}isActiveQueryTarget(e){let t=!1;return this.Xs.forEach((n,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Po(e,"pending")}updateMutationState(e,t,n){this.Po(e,t,n),this.To(e)}addLocalQueryTarget(e,t=!0){let n="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(Uv(this.persistenceKey,e));if(i){const s=Nf.Gs(e,i);s&&(n=s.state)}}return t&&this.Io.js(e),this.uo(),n}removeLocalQueryTarget(e){this.Io.Hs(e),this.uo()}isLocalQueryTarget(e){return this.Io.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Uv(this.persistenceKey,e))}updateQueryState(e,t,n){this.Eo(e,t,n)}handleUserChange(e,t,n){t.forEach(i=>{this.To(i)}),this.currentUser=e,n.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Ao(e)}notifyBundleLoaded(e){this.Ro(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Ys),this.removeItem(this.no),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Re(No,"READ",e,t),t}setItem(e,t){Re(No,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){Re(No,"REMOVE",e),this.storage.removeItem(e)}Zs(e){const t=e;if(t.storageArea===this.storage){if(Re(No,"EVENT",t.key,t.newValue),t.key===this.no)return void Kn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.xi.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.io.test(t.key)){if(t.newValue==null){const n=this.Vo(t.key);return this.mo(n,null)}{const n=this.fo(t.key,t.newValue);if(n)return this.mo(n.clientId,n)}}else if(this.so.test(t.key)){if(t.newValue!==null){const n=this.po(t.key,t.newValue);if(n)return this.yo(n)}}else if(this.oo.test(t.key)){if(t.newValue!==null){const n=this.wo(t.key,t.newValue);if(n)return this.bo(n)}}else if(t.key===this._o){if(t.newValue!==null){const n=this.co(t.newValue);if(n)return this.lo(n)}}else if(t.key===this.ro){const n=function(s){let o=Li.le;if(s!=null)try{const l=JSON.parse(s);it(typeof l=="number",30636,{So:s}),o=l}catch(l){Kn(No,"Failed to read sequence number from WebStorage",l)}return o}(t.newValue);n!==Li.le&&this.sequenceNumberHandler(n)}else if(t.key===this.ao){const n=this.Do(t.newValue);await Promise.all(n.map(i=>this.syncEngine.vo(i)))}}}else this.eo.push(t)})}}get Io(){return this.Xs.get(this.Js)}uo(){this.setItem(this.no,this.Io.zs())}Po(e,t,n){const i=new Yg(this.currentUser,e,t,n),s=mS(this.persistenceKey,this.currentUser,e);this.setItem(s,i.zs())}To(e){const t=mS(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Ao(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this._o,JSON.stringify(t))}Eo(e,t,n){const i=Uv(this.persistenceKey,e),s=new Nf(e,t,n);this.setItem(i,s.zs())}Ro(e){const t=JSON.stringify(Array.from(e));this.setItem(this.ao,t)}Vo(e){const t=this.io.exec(e);return t?t[1]:null}fo(e,t){const n=this.Vo(e);return Zg.Gs(n,t)}po(e,t){const n=this.so.exec(e),i=Number(n[1]),s=n[2]!==void 0?n[2]:null;return Yg.Gs(new Tr(s),i,t)}wo(e,t){const n=this.oo.exec(e),i=Number(n[1]);return Nf.Gs(i,t)}co(e){return Fb.Gs(e)}Do(e){return JSON.parse(e)}async yo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);Re(No,`Ignoring mutation for non-active user ${e.user.uid}`)}bo(e){return this.syncEngine.Fo(e.targetId,e.state,e.error)}mo(e,t){const n=t?this.Xs.insert(e,t):this.Xs.remove(e),i=this.ho(this.Xs),s=this.ho(n),o=[],l=[];return s.forEach(u=>{i.has(u)||o.push(u)}),i.forEach(u=>{s.has(u)||l.push(u)}),this.syncEngine.Mo(o,l).then(()=>{this.Xs=n})}lo(e){this.Xs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ho(e){let t=wb();return e.forEach((n,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class tC{constructor(){this.xo=new Sx,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,n){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new Sx,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B6{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pS="ConnectivityMonitor";class gS{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){Re(pS,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){Re(pS,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dp=null;function Ax(){return Dp===null?Dp=function(){return 268435456+Math.round(2147483648*Math.random())}():Dp++,"0x"+Dp.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hv="RestConnection",U6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class q6{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${n}/databases/${i}`,this.Go=this.databaseId.database===Fg?`project_id=${n}`:`project_id=${n}&database_id=${i}`}zo(e,t,n,i,s){const o=Ax(),l=this.jo(e,t.toUriEncodedString());Re(Hv,`Sending RPC '${e}' ${o}:`,l,n);const u={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(u,i,s);const{host:f}=new URL(l),m=pu(f);return this.Jo(e,l,u,n,m).then(y=>(Re(Hv,`Received RPC '${e}' ${o}: `,y),y),y=>{throw nu(Hv,`RPC '${e}' ${o} failed with error: `,y,"url: ",l,"request:",n),y})}Yo(e,t,n,i,s,o){return this.zo(e,t,n,i,s)}Ho(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+qd}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),n&&n.headers.forEach((i,s)=>e[s]=i)}jo(e,t){const n=U6[e];return`${this.Ko}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H6{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wr="WebChannelConnection";class $6 extends q6{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,i,s){const o=Ax();return new Promise((l,u)=>{const f=new dk;f.setWithCredentials(!0),f.listenOnce(hk.COMPLETE,()=>{try{switch(f.getLastErrorCode()){case ag.NO_ERROR:const y=f.getResponseJson();Re(Wr,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(y)),l(y);break;case ag.TIMEOUT:Re(Wr,`RPC '${e}' ${o} timed out`),u(new Be(Ne.DEADLINE_EXCEEDED,"Request time out"));break;case ag.HTTP_ERROR:const g=f.getStatus();if(Re(Wr,`RPC '${e}' ${o} failed with status:`,g,"response text:",f.getResponseText()),g>0){let _=f.getResponseJson();Array.isArray(_)&&(_=_[0]);const E=_==null?void 0:_.error;if(E&&E.status&&E.message){const x=function(S){const I=S.toLowerCase().replace(/_/g,"-");return Object.values(Ne).indexOf(I)>=0?I:Ne.UNKNOWN}(E.status);u(new Be(x,E.message))}else u(new Be(Ne.UNKNOWN,"Server responded with status "+f.getStatus()))}else u(new Be(Ne.UNAVAILABLE,"Connection failed."));break;default:Ye(9055,{h_:e,streamId:o,P_:f.getLastErrorCode(),T_:f.getLastError()})}}finally{Re(Wr,`RPC '${e}' ${o} completed.`)}});const m=JSON.stringify(i);Re(Wr,`RPC '${e}' ${o} sending request:`,i),f.send(t,"POST",m,n,15)})}I_(e,t,n){const i=Ax(),s=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=pk(),l=mk(),u={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(u.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(u.useFetchStreams=!0),this.Ho(u.initMessageHeaders,t,n),u.encodeInitMessageHeaders=!0;const m=s.join("");Re(Wr,`Creating RPC '${e}' stream ${i}: ${m}`,u);const y=o.createWebChannel(m,u);this.E_(y);let g=!1,_=!1;const E=new H6({Zo:w=>{_?Re(Wr,`Not sending because RPC '${e}' stream ${i} is closed:`,w):(g||(Re(Wr,`Opening RPC '${e}' stream ${i} transport.`),y.open(),g=!0),Re(Wr,`RPC '${e}' stream ${i} sending:`,w),y.send(w))},Xo:()=>y.close()}),x=(w,S,I)=>{w.listen(S,C=>{try{I(C)}catch(N){setTimeout(()=>{throw N},0)}})};return x(y,rf.EventType.OPEN,()=>{_||(Re(Wr,`RPC '${e}' stream ${i} transport opened.`),E.__())}),x(y,rf.EventType.CLOSE,()=>{_||(_=!0,Re(Wr,`RPC '${e}' stream ${i} transport closed`),E.u_(),this.d_(y))}),x(y,rf.EventType.ERROR,w=>{_||(_=!0,nu(Wr,`RPC '${e}' stream ${i} transport errored. Name:`,w.name,"Message:",w.message),E.u_(new Be(Ne.UNAVAILABLE,"The operation could not be completed")))}),x(y,rf.EventType.MESSAGE,w=>{var S;if(!_){const I=w.data[0];it(!!I,16349);const C=I,N=(C==null?void 0:C.error)||((S=C[0])===null||S===void 0?void 0:S.error);if(N){Re(Wr,`RPC '${e}' stream ${i} received error:`,N);const R=N.status;let B=function(F){const j=ir[F];if(j!==void 0)return yP(j)}(R),P=N.message;B===void 0&&(B=Ne.INTERNAL,P="Unknown error status: "+R+" with message "+N.message),_=!0,E.u_(new Be(B,P)),y.close()}else Re(Wr,`RPC '${e}' stream ${i} received:`,I),E.c_(I)}}),x(l,fk.STAT_EVENT,w=>{w.stat===ix.PROXY?Re(Wr,`RPC '${e}' stream ${i} detected buffering proxy`):w.stat===ix.NOPROXY&&Re(Wr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.a_()},0),E}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nC(){return typeof window<"u"?window:null}function yg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function By(r){return new YD(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rC{constructor(e,t,n=1e3,i=1.5,s=6e4){this.xi=e,this.timerId=t,this.A_=n,this.R_=i,this.V_=s,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),n=Math.max(0,Date.now()-this.g_),i=Math.max(0,t-n);i>0&&Re("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,i,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yS="PersistentStream";class iC{constructor(e,t,n,i,s,o,l,u){this.xi=e,this.S_=n,this.D_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=u,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new rC(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===Ne.RESOURCE_EXHAUSTED?(Kn(t.toString()),Kn("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===Ne.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.v_===t&&this.z_(n,i)},n=>{e(()=>{const i=new Be(Ne.UNKNOWN,"Fetching auth token failed: "+n.message);return this.j_(i)})})}z_(e,t){const n=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{n(()=>this.listener.e_())}),this.stream.n_(()=>{n(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(i=>{n(()=>this.j_(i))}),this.stream.onMessage(i=>{n(()=>++this.M_==1?this.J_(i):this.onNext(i))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return Re(yS,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(Re(yS,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class W6 extends iC{constructor(e,t,n,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=XD(this.serializer,e),n=function(s){if(!("targetChange"in s))return lt.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?lt.min():o.readTime?hi(o.readTime):lt.min()}(e);return this.listener.Y_(t,n)}Z_(e){const t={};t.database=_x(this.serializer),t.addTarget=function(s,o){let l;const u=o.target;if(l=Vg(u)?{documents:SP(s,u)}:{query:Pb(s,u).gt},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=xP(s,o.resumeToken);const f=yx(s,o.expectedCount);f!==null&&(l.expectedCount=f)}else if(o.snapshotVersion.compareTo(lt.min())>0){l.readTime=Rd(s,o.snapshotVersion.toTimestamp());const f=yx(s,o.expectedCount);f!==null&&(l.expectedCount=f)}return l}(this.serializer,e);const n=t6(this.serializer,e);n&&(t.labels=n),this.Q_(t)}X_(e){const t={};t.database=_x(this.serializer),t.removeTarget=e,this.Q_(t)}}class G6 extends iC{constructor(e,t,n,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return it(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,it(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){it(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=JD(e.writeResults,e.commitTime),n=hi(e.commitTime);return this.listener.ra(n,t)}ia(){const e={};e.database=_x(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>qg(this.serializer,n))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K6{}class Y6 extends K6{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.sa=!1}oa(){if(this.sa)throw new Be(Ne.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,n,i){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.zo(e,vx(t,n),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Be(Ne.UNKNOWN,s.toString())})}Yo(e,t,n,i,s){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Yo(e,vx(t,n),i,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Be(Ne.UNKNOWN,o.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class Z6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Kn(t),this.ua=!1):Re("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cu="RemoteStore";class Q6{constructor(e,t,n,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=s,this.Ra.No(o=>{n.enqueueAndForget(async()=>{yu(this)&&(Re(cu,"Restarting streams for network reachability change."),await async function(u){const f=Je(u);f.da.add(4),await bm(f),f.Va.set("Unknown"),f.da.delete(4),await Uy(f)}(this))})}),this.Va=new Z6(n,i)}}async function Uy(r){if(yu(r))for(const e of r.Aa)await e(!0)}async function bm(r){for(const e of r.Aa)await e(!1)}function qy(r,e){const t=Je(r);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),Bb(t)?zb(t):Gd(t).N_()&&Vb(t,e))}function jd(r,e){const t=Je(r),n=Gd(t);t.Ea.delete(e),n.N_()&&sC(t,e),t.Ea.size===0&&(n.N_()?n.k_():yu(t)&&t.Va.set("Unknown"))}function Vb(r,e){if(r.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(lt.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Gd(r).Z_(e)}function sC(r,e){r.ma.Ke(e),Gd(r).X_(e)}function zb(r){r.ma=new $D({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>r.Ea.get(e)||null,Pt:()=>r.datastore.serializer.databaseId}),Gd(r).start(),r.Va.ca()}function Bb(r){return yu(r)&&!Gd(r).O_()&&r.Ea.size>0}function yu(r){return Je(r).da.size===0}function oC(r){r.ma=void 0}async function X6(r){r.Va.set("Online")}async function J6(r){r.Ea.forEach((e,t)=>{Vb(r,e)})}async function eL(r,e){oC(r),Bb(r)?(r.Va.Pa(e),zb(r)):r.Va.set("Unknown")}async function tL(r,e,t){if(r.Va.set("Online"),e instanceof _P&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const l of s.targetIds)i.Ea.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.Ea.delete(l),i.ma.removeTarget(l))}(r,e)}catch(n){Re(cu,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Qg(r,n)}else if(e instanceof pg?r.ma.Xe(e):e instanceof vP?r.ma.ot(e):r.ma.nt(e),!t.isEqual(lt.min()))try{const n=await KP(r.localStore);t.compareTo(n)>=0&&await function(s,o){const l=s.ma.It(o);return l.targetChanges.forEach((u,f)=>{if(u.resumeToken.approximateByteSize()>0){const m=s.Ea.get(f);m&&s.Ea.set(f,m.withResumeToken(u.resumeToken,o))}}),l.targetMismatches.forEach((u,f)=>{const m=s.Ea.get(u);if(!m)return;s.Ea.set(u,m.withResumeToken(Zn.EMPTY_BYTE_STRING,m.snapshotVersion)),sC(s,u);const y=new xa(m.target,u,f,m.sequenceNumber);Vb(s,y)}),s.remoteSyncer.applyRemoteEvent(l)}(r,t)}catch(n){Re(cu,"Failed to raise snapshot:",n),await Qg(r,n)}}async function Qg(r,e,t){if(!rc(e))throw e;r.da.add(1),await bm(r),r.Va.set("Offline"),t||(t=()=>KP(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{Re(cu,"Retrying IndexedDB access"),await t(),r.da.delete(1),await Uy(r)})}function aC(r,e){return e().catch(t=>Qg(r,t,e))}async function Wd(r){const e=Je(r),t=Wl(e);let n=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:Gc;for(;nL(e);)try{const i=await z6(e.localStore,n);if(i===null){e.Ia.length===0&&t.k_();break}n=i.batchId,rL(e,i)}catch(i){await Qg(e,i)}lC(e)&&cC(e)}function nL(r){return yu(r)&&r.Ia.length<10}function rL(r,e){r.Ia.push(e);const t=Wl(r);t.N_()&&t.ea&&t.ta(e.mutations)}function lC(r){return yu(r)&&!Wl(r).O_()&&r.Ia.length>0}function cC(r){Wl(r).start()}async function iL(r){Wl(r).ia()}async function sL(r){const e=Wl(r);for(const t of r.Ia)e.ta(t.mutations)}async function oL(r,e,t){const n=r.Ia.shift(),i=Ab.from(n,e,t);await aC(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),await Wd(r)}async function aL(r,e){e&&Wl(r).ea&&await async function(n,i){if(function(o){return qD(o)&&o!==Ne.ABORTED}(i.code)){const s=n.Ia.shift();Wl(n).L_(),await aC(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Wd(n)}}(r,e),lC(r)&&cC(r)}async function vS(r,e){const t=Je(r);t.asyncQueue.verifyOperationInProgress(),Re(cu,"RemoteStore received new credentials");const n=yu(t);t.da.add(3),await bm(t),n&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await Uy(t)}async function Ix(r,e){const t=Je(r);e?(t.da.delete(2),await Uy(t)):e||(t.da.add(2),await bm(t),t.Va.set("Unknown"))}function Gd(r){return r.fa||(r.fa=function(t,n,i){const s=Je(t);return s.oa(),new W6(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{e_:X6.bind(null,r),n_:J6.bind(null,r),i_:eL.bind(null,r),Y_:tL.bind(null,r)}),r.Aa.push(async e=>{e?(r.fa.L_(),Bb(r)?zb(r):r.Va.set("Unknown")):(await r.fa.stop(),oC(r))})),r.fa}function Wl(r){return r.ga||(r.ga=function(t,n,i){const s=Je(t);return s.oa(),new G6(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{e_:()=>Promise.resolve(),n_:iL.bind(null,r),i_:aL.bind(null,r),na:sL.bind(null,r),ra:oL.bind(null,r)}),r.Aa.push(async e=>{e?(r.ga.L_(),await Wd(r)):(await r.ga.stop(),r.Ia.length>0&&(Re(cu,`Stopping write stream with ${r.Ia.length} pending writes`),r.Ia=[]))})),r.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new ao,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,s){const o=Date.now()+n,l=new Ub(e,t,o,i,s);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Be(Ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function qb(r,e){if(Kn("AsyncQueue",`${e}: ${r}`),rc(r))return new Be(Ne.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gd{static emptySet(e){return new gd(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||qe.comparator(t.key,n.key):(t,n)=>qe.comparator(t.key,n.key),this.keyedMap=sf(),this.sortedSet=new An(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof gd)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new gd;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _S{constructor(){this.pa=new An(qe.comparator)}track(e){const t=e.doc.key,n=this.pa.get(t);n?e.type!==0&&n.type===3?this.pa=this.pa.insert(t,e):e.type===3&&n.type!==1?this.pa=this.pa.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.pa=this.pa.remove(t):e.type===1&&n.type===2?this.pa=this.pa.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):Ye(63341,{Vt:e,ya:n}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,n)=>{e.push(n)}),e}}class Md{constructor(e,t,n,i,s,o,l,u,f){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=u,this.hasCachedResults=f}static fromInitialDocuments(e,t,n,i,s){const o=[];return t.forEach(l=>{o.push({type:0,doc:l})}),new Md(e,t,gd.emptySet(t),o,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&My(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lL{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class cL{constructor(){this.queries=xS(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const i=Je(t),s=i.queries;i.queries=xS(),s.forEach((o,l)=>{for(const u of l.Sa)u.onError(n)})})(this,new Be(Ne.ABORTED,"Firestore shutting down"))}}function xS(){return new Ra(r=>rP(r),My)}async function Hb(r,e){const t=Je(r);let n=3;const i=e.query;let s=t.queries.get(i);s?!s.Da()&&e.va()&&(n=2):(s=new lL,n=e.va()?0:1);try{switch(n){case 0:s.ba=await t.onListen(i,!0);break;case 1:s.ba=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const l=qb(o,`Initialization of query '${ld(e.query)}' failed`);return void e.onError(l)}t.queries.set(i,s),s.Sa.push(e),e.Fa(t.onlineState),s.ba&&e.Ma(s.ba)&&Wb(t)}async function $b(r,e){const t=Je(r),n=e.query;let i=3;const s=t.queries.get(n);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.va()?0:1:!s.Da()&&e.va()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function uL(r,e){const t=Je(r);let n=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const l of o.Sa)l.Ma(i)&&(n=!0);o.ba=i}}n&&Wb(t)}function dL(r,e,t){const n=Je(r),i=n.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);n.queries.delete(e)}function Wb(r){r.Ca.forEach(e=>{e.next()})}var Nx,bS;(bS=Nx||(Nx={})).xa="default",bS.Cache="cache";class Gb{constructor(e,t,n){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=n||{}}Ma(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Md(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const n=t!=="Offline";return(!this.options.Qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=Md.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==Nx.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uC{constructor(e){this.key=e}}class dC{constructor(e){this.key=e}}class hL{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Lt(),this.mutatedKeys=Lt(),this.Za=sP(e),this.Xa=new gd(this.Za)}get eu(){return this.Ha}tu(e,t){const n=t?t.nu:new _S,i=t?t.Xa:this.Xa;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,l=!1;const u=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,f=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((m,y)=>{const g=i.get(m),_=ym(this.query,y)?y:null,E=!!g&&this.mutatedKeys.has(g.key),x=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let w=!1;g&&_?g.data.isEqual(_.data)?E!==x&&(n.track({type:3,doc:_}),w=!0):this.ru(g,_)||(n.track({type:2,doc:_}),w=!0,(u&&this.Za(_,u)>0||f&&this.Za(_,f)<0)&&(l=!0)):!g&&_?(n.track({type:0,doc:_}),w=!0):g&&!_&&(n.track({type:1,doc:g}),w=!0,(u||f)&&(l=!0)),w&&(_?(o=o.add(_),s=x?s.add(m):s.delete(m)):(o=o.delete(m),s=s.delete(m)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const m=this.query.limitType==="F"?o.last():o.first();o=o.delete(m.key),s=s.delete(m.key),n.track({type:1,doc:m})}return{Xa:o,nu:n,Cs:l,mutatedKeys:s}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const s=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const o=e.nu.wa();o.sort((m,y)=>function(_,E){const x=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ye(20277,{Vt:w})}};return x(_)-x(E)}(m.type,y.type)||this.Za(m.doc,y.doc)),this.iu(n),i=i!=null&&i;const l=t&&!i?this.su():[],u=this.Ya.size===0&&this.current&&!i?1:0,f=u!==this.Ja;return this.Ja=u,o.length!==0||f?{snapshot:new Md(this.query,e.Xa,s,o,e.mutatedKeys,u===0,f,!1,!!n&&n.resumeToken.approximateByteSize()>0),ou:l}:{ou:l}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new _S,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=Lt(),this.Xa.forEach(n=>{this._u(n.key)&&(this.Ya=this.Ya.add(n.key))});const t=[];return e.forEach(n=>{this.Ya.has(n)||t.push(new dC(n))}),this.Ya.forEach(n=>{e.has(n)||t.push(new uC(n))}),t}au(e){this.Ha=e.$s,this.Ya=Lt();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return Md.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const Kd="SyncEngine";class fL{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class mL{constructor(e){this.key=e,this.cu=!1}}class pL{constructor(e,t,n,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.lu={},this.hu=new Ra(l=>rP(l),My),this.Pu=new Map,this.Tu=new Set,this.Iu=new An(qe.comparator),this.Eu=new Map,this.du=new Ob,this.Au={},this.Ru=new Map,this.Vu=lu.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function gL(r,e,t=!0){const n=Hy(r);let i;const s=n.hu.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.uu()):i=await hC(n,e,t,!0),i}async function yL(r,e){const t=Hy(r);await hC(t,e,!0,!1)}async function hC(r,e,t,n){const i=await Kg(r.localStore,rs(e)),s=i.targetId,o=r.sharedClientState.addLocalQueryTarget(s,t);let l;return n&&(l=await Kb(r,e,s,o==="current",i.resumeToken)),r.isPrimaryClient&&t&&qy(r.remoteStore,i),l}async function Kb(r,e,t,n,i){r.fu=(y,g,_)=>async function(x,w,S,I){let C=w.view.tu(S);C.Cs&&(C=await Tx(x.localStore,w.query,!1).then(({documents:P})=>w.view.tu(P,C)));const N=I&&I.targetChanges.get(w.targetId),R=I&&I.targetMismatches.get(w.targetId)!=null,B=w.view.applyChanges(C,x.isPrimaryClient,N,R);return kx(x,w.targetId,B.ou),B.snapshot}(r,y,g,_);const s=await Tx(r.localStore,e,!0),o=new hL(e,s.$s),l=o.tu(s.documents),u=xm.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),f=o.applyChanges(l,r.isPrimaryClient,u);kx(r,t,f.ou);const m=new fL(e,t,o);return r.hu.set(e,m),r.Pu.has(t)?r.Pu.get(t).push(e):r.Pu.set(t,[e]),f.snapshot}async function vL(r,e,t){const n=Je(r),i=n.hu.get(e),s=n.Pu.get(i.targetId);if(s.length>1)return n.Pu.set(i.targetId,s.filter(o=>!My(o,e))),void n.hu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Od(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),t&&jd(n.remoteStore,i.targetId),Dd(n,i.targetId)}).catch(nc)):(Dd(n,i.targetId),await Od(n.localStore,i.targetId,!0))}async function _L(r,e){const t=Je(r),n=t.hu.get(e),i=t.Pu.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),jd(t.remoteStore,n.targetId))}async function xL(r,e,t){const n=Xb(r);try{const i=await function(o,l){const u=Je(o),f=Ot.now(),m=l.reduce((_,E)=>_.add(E.key),Lt());let y,g;return u.persistence.runTransaction("Locally write mutations","readwrite",_=>{let E=ns(),x=Lt();return u.Bs.getEntries(_,m).next(w=>{E=w,E.forEach((S,I)=>{I.isValidDocument()||(x=x.add(S))})}).next(()=>u.localDocuments.getOverlayedDocuments(_,E)).next(w=>{y=w;const S=[];for(const I of l){const C=zD(I,y.get(I.key).overlayedDocument);C!=null&&S.push(new Oa(I.key,C,Wk(C.value.mapValue),hr.exists(!0)))}return u.mutationQueue.addMutationBatch(_,f,S,l)}).next(w=>{g=w;const S=w.applyToLocalDocumentSet(y,x);return u.documentOverlayCache.saveOverlays(_,w.batchId,S)})}).then(()=>({batchId:g.batchId,changes:aP(y)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(o,l,u){let f=o.Au[o.currentUser.toKey()];f||(f=new An(vt)),f=f.insert(l,u),o.Au[o.currentUser.toKey()]=f}(n,i.batchId,t),await sc(n,i.changes),await Wd(n.remoteStore)}catch(i){const s=qb(i,"Failed to persist write");t.reject(s)}}async function fC(r,e){const t=Je(r);try{const n=await F6(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.Eu.get(s);o&&(it(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.cu=!0:i.modifiedDocuments.size>0?it(o.cu,14607):i.removedDocuments.size>0&&(it(o.cu,42227),o.cu=!1))}),await sc(t,n,e)}catch(n){await nc(n)}}function wS(r,e,t){const n=Je(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const i=[];n.hu.forEach((s,o)=>{const l=o.view.Fa(e);l.snapshot&&i.push(l.snapshot)}),function(o,l){const u=Je(o);u.onlineState=l;let f=!1;u.queries.forEach((m,y)=>{for(const g of y.Sa)g.Fa(l)&&(f=!0)}),f&&Wb(u)}(n.eventManager,e),i.length&&n.lu.Y_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function bL(r,e,t){const n=Je(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.Eu.get(e),s=i&&i.key;if(s){let o=new An(qe.comparator);o=o.insert(s,Un.newNoDocument(s,lt.min()));const l=Lt().add(s),u=new _m(lt.min(),new Map,new An(vt),o,l);await fC(n,u),n.Iu=n.Iu.remove(s),n.Eu.delete(e),Qb(n)}else await Od(n.localStore,e,!1).then(()=>Dd(n,e,t)).catch(nc)}async function wL(r,e){const t=Je(r),n=e.batch.batchId;try{const i=await L6(t.localStore,e);Zb(t,n,null),Yb(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await sc(t,i)}catch(i){await nc(i)}}async function EL(r,e,t){const n=Je(r);try{const i=await function(o,l){const u=Je(o);return u.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let m;return u.mutationQueue.lookupMutationBatch(f,l).next(y=>(it(y!==null,37113),m=y.keys(),u.mutationQueue.removeMutationBatch(f,y))).next(()=>u.mutationQueue.performConsistencyCheck(f)).next(()=>u.documentOverlayCache.removeOverlaysForBatchId(f,m,l)).next(()=>u.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,m)).next(()=>u.localDocuments.getDocuments(f,m))})}(n.localStore,e);Zb(n,e,t),Yb(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await sc(n,i)}catch(i){await nc(i)}}function Yb(r,e){(r.Ru.get(e)||[]).forEach(t=>{t.resolve()}),r.Ru.delete(e)}function Zb(r,e,t){const n=Je(r);let i=n.Au[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.Au[n.currentUser.toKey()]=i}}function Dd(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.Pu.get(e))r.hu.delete(n),t&&r.lu.gu(n,t);r.Pu.delete(e),r.isPrimaryClient&&r.du.Hr(e).forEach(n=>{r.du.containsKey(n)||mC(r,n)})}function mC(r,e){r.Tu.delete(e.path.canonicalString());const t=r.Iu.get(e);t!==null&&(jd(r.remoteStore,t),r.Iu=r.Iu.remove(e),r.Eu.delete(t),Qb(r))}function kx(r,e,t){for(const n of t)n instanceof uC?(r.du.addReference(n.key,e),TL(r,n)):n instanceof dC?(Re(Kd,"Document no longer in limbo: "+n.key),r.du.removeReference(n.key,e),r.du.containsKey(n.key)||mC(r,n.key)):Ye(19791,{pu:n})}function TL(r,e){const t=e.key,n=t.path.canonicalString();r.Iu.get(t)||r.Tu.has(n)||(Re(Kd,"New document in limbo: "+t),r.Tu.add(n),Qb(r))}function Qb(r){for(;r.Tu.size>0&&r.Iu.size<r.maxConcurrentLimboResolutions;){const e=r.Tu.values().next().value;r.Tu.delete(e);const t=new qe(sn.fromString(e)),n=r.Vu.next();r.Eu.set(n,new mL(t)),r.Iu=r.Iu.insert(t,n),qy(r.remoteStore,new xa(rs(gm(t.path)),n,"TargetPurposeLimboResolution",Li.le))}}async function sc(r,e,t){const n=Je(r),i=[],s=[],o=[];n.hu.isEmpty()||(n.hu.forEach((l,u)=>{o.push(n.fu(u,e,t).then(f=>{var m;if((f||t)&&n.isPrimaryClient){const y=f?!f.fromCache:(m=t==null?void 0:t.targetChanges.get(u.targetId))===null||m===void 0?void 0:m.current;n.sharedClientState.updateQueryState(u.targetId,y?"current":"not-current")}if(f){i.push(f);const y=Db.Rs(u.targetId,f);s.push(y)}}))}),await Promise.all(o),n.lu.Y_(i),await async function(u,f){const m=Je(u);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>ve.forEach(f,g=>ve.forEach(g.ds,_=>m.persistence.referenceDelegate.addReference(y,g.targetId,_)).next(()=>ve.forEach(g.As,_=>m.persistence.referenceDelegate.removeReference(y,g.targetId,_)))))}catch(y){if(!rc(y))throw y;Re(Lb,"Failed to update sequence numbers: "+y)}for(const y of f){const g=y.targetId;if(!y.fromCache){const _=m.xs.get(g),E=_.snapshotVersion,x=_.withLastLimboFreeSnapshotVersion(E);m.xs=m.xs.insert(g,x)}}}(n.localStore,s))}async function SL(r,e){const t=Je(r);if(!t.currentUser.isEqual(e)){Re(Kd,"User change. New user:",e.toKey());const n=await GP(t.localStore,e);t.currentUser=e,function(s,o){s.Ru.forEach(l=>{l.forEach(u=>{u.reject(new Be(Ne.CANCELLED,o))})}),s.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await sc(t,n.ks)}}function AL(r,e){const t=Je(r),n=t.Eu.get(e);if(n&&n.cu)return Lt().add(n.key);{let i=Lt();const s=t.Pu.get(e);if(!s)return i;for(const o of s){const l=t.hu.get(o);i=i.unionWith(l.view.eu)}return i}}async function IL(r,e){const t=Je(r),n=await Tx(t.localStore,e.query,!0),i=e.view.au(n);return t.isPrimaryClient&&kx(t,e.targetId,i.ou),i}async function NL(r,e){const t=Je(r);return ZP(t.localStore,e).then(n=>sc(t,n))}async function kL(r,e,t,n){const i=Je(r),s=await function(l,u){const f=Je(l),m=Je(f.mutationQueue);return f.persistence.runTransaction("Lookup mutation documents","readonly",y=>m.tr(y,u).next(g=>g?f.localDocuments.getDocuments(y,g):ve.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?await Wd(i.remoteStore):t==="acknowledged"||t==="rejected"?(Zb(i,e,n||null),Yb(i,e),function(l,u){Je(Je(l).mutationQueue).sr(u)}(i.localStore,e)):Ye(6720,"Unknown batchState",{yu:t}),await sc(i,s)):Re(Kd,"Cannot apply mutation batch with id: "+e)}async function PL(r,e){const t=Je(r);if(Hy(t),Xb(t),e===!0&&t.mu!==!0){const n=t.sharedClientState.getAllActiveQueryTargets(),i=await ES(t,n.toArray());t.mu=!0,await Ix(t.remoteStore,!0);for(const s of i)qy(t.remoteStore,s)}else if(e===!1&&t.mu!==!1){const n=[];let i=Promise.resolve();t.Pu.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?n.push(o):i=i.then(()=>(Dd(t,o),Od(t.localStore,o,!0))),jd(t.remoteStore,o)}),await i,await ES(t,n),function(o){const l=Je(o);l.Eu.forEach((u,f)=>{jd(l.remoteStore,f)}),l.du.Jr(),l.Eu=new Map,l.Iu=new An(qe.comparator)}(t),t.mu=!1,await Ix(t.remoteStore,!1)}}async function ES(r,e,t){const n=Je(r),i=[],s=[];for(const o of e){let l;const u=n.Pu.get(o);if(u&&u.length!==0){l=await Kg(n.localStore,rs(u[0]));for(const f of u){const m=n.hu.get(f),y=await IL(n,m);y.snapshot&&s.push(y.snapshot)}}else{const f=await YP(n.localStore,o);l=await Kg(n.localStore,f),await Kb(n,pC(f),o,!1,l.resumeToken)}i.push(l)}return n.lu.Y_(s),i}function pC(r){return eP(r.path,r.collectionGroup,r.orderBy,r.filters,r.limit,"F",r.startAt,r.endAt)}function CL(r){return function(t){return Je(Je(t).persistence).Is()}(Je(r).localStore)}async function RL(r,e,t,n){const i=Je(r);if(i.mu)return void Re(Kd,"Ignoring unexpected query state notification.");const s=i.Pu.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const o=await ZP(i.localStore,iP(s[0])),l=_m.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Zn.EMPTY_BYTE_STRING);await sc(i,o,l);break}case"rejected":await Od(i.localStore,e,!0),Dd(i,e,n);break;default:Ye(64155,t)}}async function OL(r,e,t){const n=Hy(r);if(n.mu){for(const i of e){if(n.Pu.has(i)&&n.sharedClientState.isActiveQueryTarget(i)){Re(Kd,"Adding an already active target "+i);continue}const s=await YP(n.localStore,i),o=await Kg(n.localStore,s);await Kb(n,pC(s),o.targetId,!1,o.resumeToken),qy(n.remoteStore,o)}for(const i of t)n.Pu.has(i)&&await Od(n.localStore,i,!1).then(()=>{jd(n.remoteStore,i),Dd(n,i)}).catch(nc)}}function Hy(r){const e=Je(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=fC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=AL.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=bL.bind(null,e),e.lu.Y_=uL.bind(null,e.eventManager),e.lu.gu=dL.bind(null,e.eventManager),e}function Xb(r){const e=Je(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=wL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=EL.bind(null,e),e}class Zf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=By(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return WP(this.persistence,new $P,e.initialUser,this.serializer)}Su(e){return new jb(zy.fi,this.serializer)}bu(e){return new tC}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Zf.provider={build:()=>new Zf};class jL extends Zf{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){it(this.persistence.referenceDelegate instanceof Gg,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new VP(n,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?Kr.withCacheSize(this.cacheSizeBytes):Kr.DEFAULT;return new jb(n=>Gg.fi(n,t),this.serializer)}}class ML extends Zf{constructor(e,t,n){super(),this.Fu=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Fu.initialize(this,e),await Xb(this.Fu.syncEngine),await Wd(this.Fu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}Du(e){return WP(this.persistence,new $P,e.initialUser,this.serializer)}vu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new VP(n,e.asyncQueue,t)}Cu(e,t){const n=new UM(t,this.persistence);return new BM(e.asyncQueue,n)}Su(e){const t=HP(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Kr.withCacheSize(this.cacheSizeBytes):Kr.DEFAULT;return new Mb(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,nC(),yg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}bu(e){return new tC}}class DL extends ML{constructor(e,t){super(e,t,!1),this.Fu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Fu.syncEngine;this.sharedClientState instanceof qv&&(this.sharedClientState.syncEngine={Co:kL.bind(null,t),Fo:RL.bind(null,t),Mo:OL.bind(null,t),Is:CL.bind(null,t),vo:NL.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji(async n=>{await PL(this.Fu.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())})}bu(e){const t=nC();if(!qv.C(t))throw new Be(Ne.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=HP(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new qv(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class Xg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>wS(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=SL.bind(null,this.syncEngine),await Ix(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new cL}()}createDatastore(e){const t=By(e.databaseInfo.databaseId),n=function(s){return new $6(s)}(e.databaseInfo);return function(s,o,l,u){return new Y6(s,o,l,u)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,i,s,o,l){return new Q6(n,i,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,t=>wS(this.syncEngine,t,0),function(){return gS.C()?new gS:new B6}())}createSyncEngine(e,t){return function(i,s,o,l,u,f,m){const y=new pL(i,s,o,l,u,f);return m&&(y.mu=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=Je(i);Re(cu,"RemoteStore shutting down."),s.da.add(5),await bm(s),s.Ra.shutdown(),s.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Xg.provider={build:()=>new Xg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jb{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):Kn("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gl="FirestoreClient";class LL{constructor(e,t,n,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=Tr.UNAUTHENTICATED,this.clientId=_k.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async o=>{Re(Gl,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(Re(Gl,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ao;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=qb(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function $v(r,e){r.asyncQueue.verifyOperationInProgress(),Re(Gl,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(async i=>{n.isEqual(i)||(await GP(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}async function TS(r,e){r.asyncQueue.verifyOperationInProgress();const t=await FL(r);Re(Gl,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>vS(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>vS(e.remoteStore,i)),r._onlineComponents=e}async function FL(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){Re(Gl,"Using user provided OfflineComponentProvider");try{await $v(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===Ne.FAILED_PRECONDITION||i.code===Ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;nu("Error using user provided cache. Falling back to memory cache: "+t),await $v(r,new Zf)}}else Re(Gl,"Using default OfflineComponentProvider"),await $v(r,new jL(void 0));return r._offlineComponents}async function e2(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(Re(Gl,"Using user provided OnlineComponentProvider"),await TS(r,r._uninitializedComponentsProvider._online)):(Re(Gl,"Using default OnlineComponentProvider"),await TS(r,new Xg))),r._onlineComponents}function VL(r){return e2(r).then(e=>e.syncEngine)}function zL(r){return e2(r).then(e=>e.datastore)}async function Jg(r){const e=await e2(r),t=e.eventManager;return t.onListen=gL.bind(null,e.syncEngine),t.onUnlisten=vL.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=yL.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=_L.bind(null,e.syncEngine),t}function BL(r,e,t={}){const n=new ao;return r.asyncQueue.enqueueAndForget(async()=>function(s,o,l,u,f){const m=new Jb({next:g=>{m.xu(),o.enqueueAndForget(()=>$b(s,y));const _=g.docs.has(l);!_&&g.fromCache?f.reject(new Be(Ne.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&g.fromCache&&u&&u.source==="server"?f.reject(new Be(Ne.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(g)},error:g=>f.reject(g)}),y=new Gb(gm(l.path),m,{includeMetadataChanges:!0,Qa:!0});return Hb(s,y)}(await Jg(r),r.asyncQueue,e,t,n)),n.promise}function UL(r,e,t={}){const n=new ao;return r.asyncQueue.enqueueAndForget(async()=>function(s,o,l,u,f){const m=new Jb({next:g=>{m.xu(),o.enqueueAndForget(()=>$b(s,y)),g.fromCache&&u.source==="server"?f.reject(new Be(Ne.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(g)},error:g=>f.reject(g)}),y=new Gb(l,m,{includeMetadataChanges:!0,Qa:!0});return Hb(s,y)}(await Jg(r),r.asyncQueue,e,t,n)),n.promise}function qL(r,e,t){const n=new ao;return r.asyncQueue.enqueueAndForget(async()=>{try{const i=await zL(r);n.resolve(async function(o,l,u){var f;const m=Je(o),{request:y,yt:g,parent:_}=e6(m.serializer,ND(l),u);m.connection.Uo||delete y.parent;const E=(await m.Yo("RunAggregationQuery",m.serializer.databaseId,_,y,1)).filter(w=>!!w.result);it(E.length===1,64727);const x=(f=E[0].result)===null||f===void 0?void 0:f.aggregateFields;return Object.keys(x).reduce((w,S)=>(w[g[S]]=x[S],w),{})}(i,e,t))}catch(i){n.reject(i)}}),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gC(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SS=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yC(r,e,t){if(!t)throw new Be(Ne.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function HL(r,e,t,n){if(e===!0&&n===!0)throw new Be(Ne.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function AS(r){if(!qe.isDocumentKey(r))throw new Be(Ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function IS(r){if(qe.isDocumentKey(r))throw new Be(Ne.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function $y(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":Ye(12329,{type:typeof r})}function jr(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new Be(Ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=$y(r);throw new Be(Ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}function $L(r,e){if(e<=0)throw new Be(Ne.INVALID_ARGUMENT,`Function ${r}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vC="firestore.googleapis.com",NS=!0;class kS{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Be(Ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=vC,this.ssl=NS}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:NS;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=MP;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<y6)throw new Be(Ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}HL("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=gC((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Be(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Be(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Be(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Wy{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new kS({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Be(Ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Be(Ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new kS(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new PM;switch(n.type){case"firstParty":return new jM(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Be(Ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=SS.get(t);n&&(Re("ComponentProvider","Removing Datastore"),SS.delete(t),n.terminate())}(this),Promise.resolve()}}function WL(r,e,t,n={}){var i;r=jr(r,Wy);const s=pu(e),o=r._getSettings(),l=Object.assign(Object.assign({},o),{emulatorOptions:r._getEmulatorOptions()}),u=`${e}:${t}`;s&&(Qx(`https://${u}`),Xx("Firestore",!0)),o.host!==vC&&o.host!==u&&nu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f=Object.assign(Object.assign({},o),{host:u,ssl:s,emulatorOptions:n});if(!Ul(f,l)&&(r._setSettings(f),n.mockUserToken)){let m,y;if(typeof n.mockUserToken=="string")m=n.mockUserToken,y=Tr.MOCK_USER;else{m=F5(n.mockUserToken,(i=r._app)===null||i===void 0?void 0:i.options.projectId);const g=n.mockUserToken.sub||n.mockUserToken.user_id;if(!g)throw new Be(Ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new Tr(g)}r._authCredentials=new CM(new yk(m,y))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ja{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new ja(this.firestore,e,this._query)}}class Jr{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new zl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Jr(this.firestore,e,this._key)}}class zl extends ja{constructor(e,t,n){super(e,t,gm(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Jr(this.firestore,null,new qe(e))}withConverter(e){return new zl(this.firestore,e,this._path)}}function ct(r,e,...t){if(r=Pn(r),yC("collection","path",e),r instanceof Wy){const n=sn.fromString(e,...t);return IS(n),new zl(r,null,n)}{if(!(r instanceof Jr||r instanceof zl))throw new Be(Ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(sn.fromString(e,...t));return IS(n),new zl(r.firestore,null,n)}}function $t(r,e,...t){if(r=Pn(r),arguments.length===1&&(e=_k.newId()),yC("doc","path",e),r instanceof Wy){const n=sn.fromString(e,...t);return AS(n),new Jr(r,null,new qe(n))}{if(!(r instanceof Jr||r instanceof zl))throw new Be(Ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(sn.fromString(e,...t));return AS(n),new Jr(r.firestore,r instanceof zl?r.converter:null,new qe(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PS="AsyncQueue";class CS{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new rC(this,"async_queue_retry"),this.rc=()=>{const n=yg();n&&Re(PS,"Visibility state changed to "+n.visibilityState),this.x_.b_()},this.sc=e;const t=yg();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=yg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new ao;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!rc(e))throw e;Re(PS,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(n=>{throw this.Xu=n,this.ec=!1,Kn("INTERNAL UNHANDLED ERROR: ",RS(n)),n}).then(n=>(this.ec=!1,n))));return this.sc=t,t}enqueueAfterDelay(e,t,n){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const i=Ub.createAndSchedule(this,e,t,n,s=>this.uc(s));return this.Zu.push(i),i}oc(){this.Xu&&Ye(47125,{cc:RS(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function RS(r){let e=r.message||"";return r.stack&&(e=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OS(r){return function(t,n){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(r,["next","error","complete"])}class Ns extends Wy{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new CS,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new CS(e),this._firestoreClient=void 0,await e}}}function GL(r,e){const t=typeof r=="object"?r:Ey(),n=typeof r=="string"?r:Fg,i=wy(t,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=g4("firestore");s&&WL(i,...s)}return i}function Yd(r){if(r._terminated)throw new Be(Ne.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||_C(r),r._firestoreClient}function _C(r){var e,t,n;const i=r._freezeSettings(),s=function(l,u,f,m){return new yD(l,u,f,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,gC(m.experimentalLongPollingOptions),m.useFetchStreams,m.isUsingEmulator)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,i);r._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(r._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),r._firestoreClient=new LL(r._authCredentials,r._appCheckCredentials,r._queue,s,r._componentsProvider&&function(l){const u=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(u),_online:u}}(r._componentsProvider))}async function KL(r){nu("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=r._freezeSettings();YL(r,Xg.provider,{build:t=>new DL(t,e.cacheSizeBytes)})}function YL(r,e,t){if((r=jr(r,Ns))._firestoreClient||r._terminated)throw new Be(Ne.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(r._componentsProvider||r._getSettings().localCache)throw new Be(Ne.FAILED_PRECONDITION,"SDK cache is already specified.");r._componentsProvider={_online:e,_offline:t},_C(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZL{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class QL{constructor(e,t,n){this._userDataWriter=t,this._data=n,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ld{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ld(Zn.fromBase64String(e))}catch(t){throw new Be(Ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Ld(Zn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zd{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Be(Ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Fn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wm{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t2{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Be(Ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Be(Ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return vt(this._lat,e._lat)||vt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XL=/^__.*__$/;class JL{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Oa(e,this.data,this.fieldMask,t,this.fieldTransforms):new $d(e,this.data,t,this.fieldTransforms)}}class xC{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Oa(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function bC(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ye(40011,{Ic:r})}}class Gy{constructor(e,t,n,i,s,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.Ec(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new Gy(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.dc({path:n,Rc:!1});return i.Vc(e),i}mc(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.dc({path:n,Rc:!1});return i.Ec(),i}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return ey(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(bC(this.Ic)&&XL.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class e8{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||By(e)}bc(e,t,n,i=!1){return new Gy({Ic:e,methodName:t,wc:n,path:Fn.emptyPath(),Rc:!1,yc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Em(r){const e=r._freezeSettings(),t=By(r._databaseId);return new e8(r._databaseId,!!e.ignoreUndefinedProperties,t)}function r2(r,e,t,n,i,s={}){const o=r.bc(s.merge||s.mergeFields?2:0,e,t,i);o2("Data must be an object, but it was:",o,n);const l=TC(n,o);let u,f;if(s.merge)u=new Fi(o.fieldMask),f=o.fieldTransforms;else if(s.mergeFields){const m=[];for(const y of s.mergeFields){const g=Px(e,y,t);if(!o.contains(g))throw new Be(Ne.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);AC(m,g)||m.push(g)}u=new Fi(m),f=o.fieldTransforms.filter(y=>u.covers(y.field))}else u=null,f=o.fieldTransforms;return new JL(new Yr(l),u,f)}class Ky extends wm{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Ky}}function t8(r,e,t){return new Gy({Ic:3,wc:e.settings.wc,methodName:r._methodName,Rc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class i2 extends wm{_toFieldTransform(e){return new Tb(e.path,new Pd)}isEqual(e){return e instanceof i2}}class s2 extends wm{constructor(e,t){super(e),this.Sc=t}_toFieldTransform(e){const t=t8(this,e,!0),n=this.Sc.map(s=>Qd(s,t)),i=new su(n);return new Tb(e.path,i)}isEqual(e){return e instanceof s2&&Ul(this.Sc,e.Sc)}}function wC(r,e,t,n){const i=r.bc(1,e,t);o2("Data must be an object, but it was:",i,n);const s=[],o=Yr.empty();ic(n,(u,f)=>{const m=a2(e,u,t);f=Pn(f);const y=i.mc(m);if(f instanceof Ky)s.push(m);else{const g=Qd(f,y);g!=null&&(s.push(m),o.set(m,g))}});const l=new Fi(s);return new xC(o,l,i.fieldTransforms)}function EC(r,e,t,n,i,s){const o=r.bc(1,e,t),l=[Px(e,n,t)],u=[i];if(s.length%2!=0)throw new Be(Ne.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)l.push(Px(e,s[g])),u.push(s[g+1]);const f=[],m=Yr.empty();for(let g=l.length-1;g>=0;--g)if(!AC(f,l[g])){const _=l[g];let E=u[g];E=Pn(E);const x=o.mc(_);if(E instanceof Ky)f.push(_);else{const w=Qd(E,x);w!=null&&(f.push(_),m.set(_,w))}}const y=new Fi(f);return new xC(m,y,o.fieldTransforms)}function n8(r,e,t,n=!1){return Qd(t,r.bc(n?4:3,e))}function Qd(r,e){if(SC(r=Pn(r)))return o2("Unsupported field value:",e,r),TC(r,e);if(r instanceof wm)return function(n,i){if(!bC(i.Ic))throw i.gc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.gc(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(n,i){const s=[];let o=0;for(const l of n){let u=Qd(l,i.fc(o));u==null&&(u={nullValue:"NULL_VALUE"}),s.push(u),o++}return{arrayValue:{values:s}}}(r,e)}return function(n,i){if((n=Pn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return jD(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=Ot.fromDate(n);return{timestampValue:Rd(i.serializer,s)}}if(n instanceof Ot){const s=new Ot(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Rd(i.serializer,s)}}if(n instanceof t2)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Ld)return{bytesValue:xP(i.serializer,n._byteString)};if(n instanceof Jr){const s=i.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw i.gc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:kb(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof n2)return function(o,l){return{mapValue:{fields:{[_b]:{stringValue:xb},[Ad]:{arrayValue:{values:o.toArray().map(f=>{if(typeof f!="number")throw l.gc("VectorValues must only contain numeric values.");return Eb(l.serializer,f)})}}}}}}(n,i);throw i.gc(`Unsupported field value: ${$y(n)}`)}(r,e)}function TC(r,e){const t={};return Lk(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ic(r,(n,i)=>{const s=Qd(i,e.Ac(n));s!=null&&(t[n]=s)}),{mapValue:{fields:t}}}function SC(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof Ot||r instanceof t2||r instanceof Ld||r instanceof Jr||r instanceof wm||r instanceof n2)}function o2(r,e,t){if(!SC(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const n=$y(t);throw n==="an object"?e.gc(r+" a custom object"):e.gc(r+" "+n)}}function Px(r,e,t){if((e=Pn(e))instanceof Zd)return e._internalPath;if(typeof e=="string")return a2(r,e);throw ey("Field path arguments must be of type string or ",r,!1,void 0,t)}const r8=new RegExp("[~\\*/\\[\\]]");function a2(r,e,t){if(e.search(r8)>=0)throw ey(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new Zd(...e.split("."))._internalPath}catch{throw ey(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function ey(r,e,t,n,i){const s=n&&!n.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let u="";return(s||o)&&(u+=" (found",s&&(u+=` in field ${n}`),o&&(u+=` in document ${i}`),u+=")"),new Be(Ne.INVALID_ARGUMENT,l+r+u)}function AC(r,e){return r.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IC{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Jr(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new i8(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Yy("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class i8 extends IC{data(){return super.data()}}function Yy(r,e){return typeof e=="string"?a2(r,e):e instanceof Zd?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NC(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new Be(Ne.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class l2{}class c2 extends l2{}function wt(r,e,...t){let n=[];e instanceof l2&&n.push(e),n=n.concat(t),function(s){const o=s.filter(u=>u instanceof u2).length,l=s.filter(u=>u instanceof Zy).length;if(o>1||o>0&&l>0)throw new Be(Ne.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)r=i._apply(r);return r}class Zy extends c2{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Zy(e,t,n)}_apply(e){const t=this._parse(e);return kC(e._query,t),new ja(e.firestore,e.converter,gx(e._query,t))}_parse(e){const t=Em(e.firestore);return function(s,o,l,u,f,m,y){let g;if(f.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new Be(Ne.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){MS(y,m);const E=[];for(const x of y)E.push(jS(u,s,x));g={arrayValue:{values:E}}}else g=jS(u,s,y)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||MS(y,m),g=n8(l,o,y,m==="in"||m==="not-in");return Ut.create(f,m,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function bt(r,e,t){const n=e,i=Yy("where",r);return Zy._create(i,n,t)}class u2 extends l2{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new u2(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:fn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i;const l=s.getFlattenedFilters();for(const u of l)kC(o,u),o=gx(o,u)}(e._query,t),new ja(e.firestore,e.converter,gx(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class d2 extends c2{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new d2(e,t)}_apply(e){const t=function(i,s,o){if(i.startAt!==null)throw new Be(Ne.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Be(Ne.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Kf(s,o)}(e._query,this._field,this._direction);return new ja(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Hd(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function ei(r,e="asc"){const t=e,n=Yy("orderBy",r);return d2._create(n,t)}class h2 extends c2{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new h2(e,t,n)}_apply(e){return new ja(e.firestore,e.converter,Bg(e._query,this._limit,this._limitType))}}function Qf(r){return $L("limit",r),h2._create("limit",r,"F")}function jS(r,e,t){if(typeof(t=Pn(t))=="string"){if(t==="")throw new Be(Ne.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!tP(e)&&t.indexOf("/")!==-1)throw new Be(Ne.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(sn.fromString(t));if(!qe.isDocumentKey(n))throw new Be(Ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Wf(r,new qe(n))}if(t instanceof Jr)return Wf(r,t._key);throw new Be(Ne.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${$y(t)}.`)}function MS(r,e){if(!Array.isArray(r)||r.length===0)throw new Be(Ne.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function kC(r,e){const t=function(i,s){for(const o of i)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(r.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new Be(Ne.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Be(Ne.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class s8{convertValue(e,t="none"){switch(Hl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return On(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Aa(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ye(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return ic(e,(i,s)=>{n[i]=this.convertValue(s,t)}),n}convertVectorValue(e){var t,n,i;const s=(i=(n=(t=e.fields)===null||t===void 0?void 0:t[Ad].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(o=>On(o.doubleValue));return new n2(s)}convertGeoPoint(e){return new t2(On(e.latitude),On(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Oy(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Hf(e));default:return null}}convertTimestamp(e){const t=Sa(e);return new Ot(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=sn.fromString(e);it(kP(n),9688,{name:e});const i=new ru(n.get(1),n.get(3)),s=new qe(n.popFirst(5));return i.isEqual(t)||Kn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function f2(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}function o8(){return new ZL("count")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lf{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class PC extends IC{constructor(e,t,n,i,s,o){super(e,t,n,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new vg(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Yy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class vg extends PC{data(e={}){return super.data(e)}}class CC{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new lf(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new vg(this._firestore,this._userDataWriter,n.key,n,new lf(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Be(Ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const u=new vg(i._firestore,i._userDataWriter,l.doc.key,l.doc,new lf(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:u,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const u=new vg(i._firestore,i._userDataWriter,l.doc.key,l.doc,new lf(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let f=-1,m=-1;return l.type!==0&&(f=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),m=o.indexOf(l.doc.key)),{type:a8(l.type),doc:u,oldIndex:f,newIndex:m}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function a8(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ye(61501,{type:r})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uu(r){r=jr(r,Jr);const e=jr(r.firestore,Ns);return BL(Yd(e),r._key).then(t=>OC(e,r,t))}class Qy extends s8{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ld(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Jr(this.firestore,null,t)}}function St(r){r=jr(r,ja);const e=jr(r.firestore,Ns),t=Yd(e),n=new Qy(e);return NC(r._query),UL(t,r._query).then(i=>new CC(e,n,r,i))}function l8(r,e,t){r=jr(r,Jr);const n=jr(r.firestore,Ns),i=f2(r.converter,e,t);return Sm(n,[r2(Em(n),"setDoc",r._key,i,r.converter!==null,t).toMutation(r._key,hr.none())])}function Ls(r,e,t,...n){r=jr(r,Jr);const i=jr(r.firestore,Ns),s=Em(i);let o;return o=typeof(e=Pn(e))=="string"||e instanceof Zd?EC(s,"updateDoc",r._key,e,t,n):wC(s,"updateDoc",r._key,e),Sm(i,[o.toMutation(r._key,hr.exists(!0))])}function Tm(r){return Sm(jr(r.firestore,Ns),[new vm(r._key,hr.none())])}function Xd(r,e){const t=jr(r.firestore,Ns),n=$t(r),i=f2(r.converter,e);return Sm(t,[r2(Em(r.firestore),"addDoc",n._key,i,r.converter!==null,{}).toMutation(n._key,hr.exists(!1))]).then(()=>n)}function RC(r,...e){var t,n,i;r=Pn(r);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||OS(e[o])||(s=e[o],o++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(OS(e[o])){const y=e[o];e[o]=(t=y.next)===null||t===void 0?void 0:t.bind(y),e[o+1]=(n=y.error)===null||n===void 0?void 0:n.bind(y),e[o+2]=(i=y.complete)===null||i===void 0?void 0:i.bind(y)}let u,f,m;if(r instanceof Jr)f=jr(r.firestore,Ns),m=gm(r._key.path),u={next:y=>{e[o]&&e[o](OC(f,r,y))},error:e[o+1],complete:e[o+2]};else{const y=jr(r,ja);f=jr(y.firestore,Ns),m=y._query;const g=new Qy(f);u={next:_=>{e[o]&&e[o](new CC(f,g,y,_))},error:e[o+1],complete:e[o+2]},NC(r._query)}return function(g,_,E,x){const w=new Jb(x),S=new Gb(_,w,E);return g.asyncQueue.enqueueAndForget(async()=>Hb(await Jg(g),S)),()=>{w.xu(),g.asyncQueue.enqueueAndForget(async()=>$b(await Jg(g),S))}}(Yd(f),m,l,u)}function Sm(r,e){return function(n,i){const s=new ao;return n.asyncQueue.enqueueAndForget(async()=>xL(await VL(n),i,s)),s.promise}(Yd(r),e)}function OC(r,e,t){const n=t.docs.get(e._key),i=new Qy(r);return new PC(r,i,e._key,n,new lf(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ty(r){return c8(r,{count:o8()})}function c8(r,e){const t=jr(r.firestore,Ns),n=Yd(t),i=pD(e,(s,o)=>new BD(o,s.aggregateType,s._internalFieldPath));return qL(n,r._query,i).then(s=>function(l,u,f){const m=new Qy(l);return new QL(u,m,f)}(t,r,s))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u8{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Em(e)}set(e,t,n){this._verifyNotCommitted();const i=Wv(e,this._firestore),s=f2(i.converter,t,n),o=r2(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,n);return this._mutations.push(o.toMutation(i._key,hr.none())),this}update(e,t,n,...i){this._verifyNotCommitted();const s=Wv(e,this._firestore);let o;return o=typeof(t=Pn(t))=="string"||t instanceof Zd?EC(this._dataReader,"WriteBatch.update",s._key,t,n,i):wC(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,hr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Wv(e,this._firestore);return this._mutations=this._mutations.concat(new vm(t._key,hr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Be(Ne.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Wv(r,e){if((r=Pn(r)).firestore!==e)throw new Be(Ne.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}function Hn(){return new i2("serverTimestamp")}function d8(...r){return new s2("arrayUnion",r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oc(r){return Yd(r=jr(r,Ns)),new u8(r,e=>Sm(r,e))}(function(e,t=!0){(function(i){qd=i})(Ud),Xc(new ql("firestore",(n,{instanceIdentifier:i,options:s})=>{const o=n.getProvider("app").getImmediate(),l=new Ns(new RM(n.getProvider("auth-internal")),new MM(o,n.getProvider("app-check-internal")),function(f,m){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new Be(Ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ru(f.options.projectId,m)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),Co(fT,mT,e),Co(fT,mT,"esm2017")})();var h8="firebase",f8="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Co(h8,f8,"app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m8="type.googleapis.com/google.protobuf.Int64Value",p8="type.googleapis.com/google.protobuf.UInt64Value";function jC(r,e){const t={};for(const n in r)r.hasOwnProperty(n)&&(t[n]=e(r[n]));return t}function ny(r){if(r==null)return null;if(r instanceof Number&&(r=r.valueOf()),typeof r=="number"&&isFinite(r)||r===!0||r===!1||Object.prototype.toString.call(r)==="[object String]")return r;if(r instanceof Date)return r.toISOString();if(Array.isArray(r))return r.map(e=>ny(e));if(typeof r=="function"||typeof r=="object")return jC(r,e=>ny(e));throw new Error("Data cannot be encoded in JSON: "+r)}function Fd(r){if(r==null)return r;if(r["@type"])switch(r["@type"]){case m8:case p8:{const e=Number(r.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+r);return e}default:throw new Error("Data cannot be decoded from JSON: "+r)}return Array.isArray(r)?r.map(e=>Fd(e)):typeof r=="function"||typeof r=="object"?jC(r,e=>Fd(e)):r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m2="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DS={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Vi extends Lo{constructor(e,t,n){super(`${m2}/${e}`,t||""),this.details=n,Object.setPrototypeOf(this,Vi.prototype)}}function g8(r){if(r>=200&&r<300)return"ok";switch(r){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function ry(r,e){let t=g8(r),n=t,i;try{const s=e&&e.error;if(s){const o=s.status;if(typeof o=="string"){if(!DS[o])return new Vi("internal","internal");t=DS[o],n=o}const l=s.message;typeof l=="string"&&(n=l),i=s.details,i!==void 0&&(i=Fd(i))}}catch{}return t==="ok"?null:new Vi(t,n,i)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y8{constructor(e,t,n,i){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,ui(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||t.get().then(s=>this.auth=s,()=>{}),this.messaging||n.get().then(s=>this.messaging=s,()=>{}),this.appCheck||i==null||i.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),n=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:t,messagingToken:n,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cx="us-central1",v8=/^data: (.*?)(?:\n|$)/;function _8(r){let e=null;return{promise:new Promise((t,n)=>{e=setTimeout(()=>{n(new Vi("deadline-exceeded","deadline-exceeded"))},r)}),cancel:()=>{e&&clearTimeout(e)}}}class x8{constructor(e,t,n,i,s=Cx,o=(...l)=>fetch(...l)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new y8(e,t,n,i),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(s);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=Cx}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function b8(r,e,t){const n=pu(e);r.emulatorOrigin=`http${n?"s":""}://${e}:${t}`,n&&(Qx(r.emulatorOrigin),Xx("Functions",!0))}function w8(r,e,t){const n=i=>T8(r,e,i,{});return n.stream=(i,s)=>A8(r,e,i,s),n}async function E8(r,e,t,n){t["Content-Type"]="application/json";let i;try{i=await n(r,{method:"POST",body:JSON.stringify(e),headers:t})}catch{return{status:0,json:null}}let s=null;try{s=await i.json()}catch{}return{status:i.status,json:s}}async function MC(r,e){const t={},n=await r.contextProvider.getContext(e.limitedUseAppCheckTokens);return n.authToken&&(t.Authorization="Bearer "+n.authToken),n.messagingToken&&(t["Firebase-Instance-ID-Token"]=n.messagingToken),n.appCheckToken!==null&&(t["X-Firebase-AppCheck"]=n.appCheckToken),t}function T8(r,e,t,n){const i=r._url(e);return S8(r,i,t,n)}async function S8(r,e,t,n){t=ny(t);const i={data:t},s=await MC(r,n),o=n.timeout||7e4,l=_8(o),u=await Promise.race([E8(e,i,s,r.fetchImpl),l.promise,r.cancelAllRequests]);if(l.cancel(),!u)throw new Vi("cancelled","Firebase Functions instance was deleted.");const f=ry(u.status,u.json);if(f)throw f;if(!u.json)throw new Vi("internal","Response is not valid JSON object.");let m=u.json.data;if(typeof m>"u"&&(m=u.json.result),typeof m>"u")throw new Vi("internal","Response is missing data field.");return{data:Fd(m)}}function A8(r,e,t,n){const i=r._url(e);return I8(r,i,t,n||{})}async function I8(r,e,t,n){var i;t=ny(t);const s={data:t},o=await MC(r,n);o["Content-Type"]="application/json",o.Accept="text/event-stream";let l;try{l=await r.fetchImpl(e,{method:"POST",body:JSON.stringify(s),headers:o,signal:n==null?void 0:n.signal})}catch(_){if(_ instanceof Error&&_.name==="AbortError"){const x=new Vi("cancelled","Request was cancelled.");return{data:Promise.reject(x),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(x)}}}}}}const E=ry(0,null);return{data:Promise.reject(E),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(E)}}}}}}let u,f;const m=new Promise((_,E)=>{u=_,f=E});(i=n==null?void 0:n.signal)===null||i===void 0||i.addEventListener("abort",()=>{const _=new Vi("cancelled","Request was cancelled.");f(_)});const y=l.body.getReader(),g=N8(y,u,f,n==null?void 0:n.signal);return{stream:{[Symbol.asyncIterator](){const _=g.getReader();return{async next(){const{value:E,done:x}=await _.read();return{value:E,done:x}},async return(){return await _.cancel(),{done:!0,value:void 0}}}}},data:m}}function N8(r,e,t,n){const i=(o,l)=>{const u=o.match(v8);if(!u)return;const f=u[1];try{const m=JSON.parse(f);if("result"in m){e(Fd(m.result));return}if("message"in m){l.enqueue(Fd(m.message));return}if("error"in m){const y=ry(0,m);l.error(y),t(y);return}}catch(m){if(m instanceof Vi){l.error(m),t(m);return}}},s=new TextDecoder;return new ReadableStream({start(o){let l="";return u();async function u(){if(n!=null&&n.aborted){const f=new Vi("cancelled","Request was cancelled");return o.error(f),t(f),Promise.resolve()}try{const{value:f,done:m}=await r.read();if(m){l.trim()&&i(l.trim(),o),o.close();return}if(n!=null&&n.aborted){const g=new Vi("cancelled","Request was cancelled");o.error(g),t(g),await r.cancel();return}l+=s.decode(f,{stream:!0});const y=l.split(`
`);l=y.pop()||"";for(const g of y)g.trim()&&i(g.trim(),o);return u()}catch(f){const m=f instanceof Vi?f:ry(0,null);o.error(m),t(m)}}},cancel(){return r.cancel()}})}const LS="@firebase/functions",FS="0.12.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const k8="auth-internal",P8="app-check-internal",C8="messaging-internal";function R8(r){const e=(t,{instanceIdentifier:n})=>{const i=t.getProvider("app").getImmediate(),s=t.getProvider(k8),o=t.getProvider(C8),l=t.getProvider(P8);return new x8(i,s,o,l,n)};Xc(new ql(m2,e,"PUBLIC").setMultipleInstances(!0)),Co(LS,FS,r),Co(LS,FS,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DC(r=Ey(),e=Cx){const n=wy(Pn(r),m2).getImmediate({identifier:e}),i=g4("functions");return i&&O8(n,...i),n}function O8(r,e,t){b8(Pn(r),e,t)}function j8(r,e,t){return w8(Pn(r),e)}R8();const M8={apiKey:"",authDomain:"",projectId:"agwa-wsi",storageBucket:"",messagingSenderId:"",appId:"",measurementId:""};let Vd;X7().length?Vd=Ey():Vd=S4(M8);const Lh=NM(Vd),Jt=GL(Vd);DC(Vd);console.log(" Connecting to Production Firebase Services ");KL(Jt).then(()=>{console.log("Firestore offline persistence enabled for multiple tabs.")}).catch(r=>{r.code==="failed-precondition"?console.warn("Firestore offline persistence failed: Multiple tabs open or other issues."):r.code==="unimplemented"&&console.warn("Firestore offline persistence failed: Browser does not support all features.")});const D8=()=>"users",vu=r=>`${D8()}/${r}/profile/data`,ac=()=>"public/data",sr=()=>`${ac()}/profiles`,lc=()=>`${ac()}/support_tickets`,Xy=r=>`${lc()}/${r}`,Am=()=>`${ac()}/announcements`,LC=r=>`${Am()}/${r}`,Im=()=>`${ac()}/system_config/settings`,zi=()=>`${ac()}/all_bills`,VS=r=>`${zi()}/${r}`,Vo=()=>`${ac()}/all_meter_readings`,FC=r=>`${Vo()}/${r}`,Kl=()=>`${ac()}/meter_routes`,_u=()=>`${ac()}/service_interruptions`,VC=r=>`${_u()}/${r}`,cc=r=>{let e=r.message||"An unknown authentication error occurred.";return r.code&&(e=r.code.replace("auth/","").replace(/-/g," "),e=e.charAt(0).toUpperCase()+e.slice(1)+".",(r.code==="auth/invalid-credential"||r.code==="auth/wrong-password"||r.code==="auth/user-not-found")&&(e="Invalid credentials. Please check your email and password."),r.code==="auth/email-already-in-use"&&(e="This email address is already registered. Please try logging in.")),console.error("Auth Service Error:",r.code,r.message),e},L8=async(r,e,t)=>{try{return{success:!0,userCredential:await uj(r,e,t)}}catch(n){return{success:!1,error:cc(n)}}},F8=async(r,e,t)=>{try{return{success:!0,userCredential:await dj(r,e,t)}}catch(n){return{success:!1,error:cc(n)}}},V8=async r=>{try{const e=new ya;return{success:!0,userCredential:await Lj(r,e)}}catch(e){return{success:!1,error:cc(e)}}},z8=async(r,e,t)=>{try{return await hj(r,e,t),window.localStorage.setItem("emailForSignIn",e),{success:!0,message:`Sign-in link sent to ${e}!`}}catch(n){return{success:!1,error:cc(n)}}},B8=async(r,e,t)=>{if(X4(r,t))try{const n=await fj(r,e,t);return window.localStorage.removeItem("emailForSignIn"),{success:!0,userCredential:n}}catch(n){return{success:!1,error:cc(n)}}return{success:!1,error:"Not a valid sign-in-with-email-link request."}},U8=async(r,e)=>{try{return await cj(r,e),{success:!0,message:"Password reset email sent!"}}catch(t){return{success:!1,error:cc(t)}}},q8=async r=>{try{return await yj(r),{success:!0,message:"Logged out successfully."}}catch(e){return{success:!1,error:cc(e)}}},zC=(r,e,t='1/2"',n={})=>{let i=0,s=0,o=0,l=0,u=0,f=0,m=0,y=0;const g=parseFloat(r)||0,_={fcdaPercentage:1.29,environmentalChargePercentage:25,sewerageChargePercentageCommercial:32.85,governmentTaxPercentage:2,vatPercentage:12},E={..._,...n},x=(E.fcdaPercentage||_.fcdaPercentage)/100,w=(E.environmentalChargePercentage||_.environmentalChargePercentage)/100,S=(E.sewerageChargePercentageCommercial||_.sewerageChargePercentageCommercial)/100,I=(E.governmentTaxPercentage||_.governmentTaxPercentage)/100,C=(E.vatPercentage||_.vatPercentage)/100,N=String(t).replace(/["]/g,"").trim();if(N==="1/2"||N==="15mm"?u=1.5:N==="3/4"||N==="20mm"?u=2:N==="1"||N==="25mm"?u=3:N==="1 1/4"||N==="40mm"||N==="1 1/2"||N==="32mm"?u=4:N==="2"||N==="50mm"?u=6:N==="3"||N==="75mm"?u=10:N==="4"||N==="100mm"?u=20:N==="6"||N==="150mm"?u=35:N==="8"||N==="200mm"?u=50:u=1.5,e==="Residential Low-Income")if(g<=10)i=70.07;else if(g<=20)i=70.07+(g-10)*14.29;else{i=70.07+10*14.29;let k=g-20;k>0&&(k<=10?i+=k*23.82:k<=20?i+=10*23.82+(k-10)*45.17:i+=10*23.82+10*45.17+(k-20)*59.54)}else if(e==="Residential")g<=10?i=195.49:g<=20?i=195.49+(g-10)*23.82:g<=30?i=195.49+10*23.82+(g-20)*45.17:g<=50?i=195.49+10*23.82+10*45.17+(g-30)*59.54:g<=70?i=195.49+10*23.82+10*45.17+20*59.54+(g-50)*69.52:g<=90?i=195.49+10*23.82+10*45.17+20*59.54+20*69.52+(g-70)*72.89:g<=140?i=195.49+10*23.82+10*45.17+20*59.54+20*69.52+20*72.89+(g-90)*76.14:g<=200?i=195.49+10*23.82+10*45.17+20*59.54+20*69.52+20*72.89+50*76.14+(g-140)*79.42:i=195.49+10*23.82+10*45.17+20*59.54+20*69.52+20*72.89+50*76.14+60*79.42+(g-200)*82.67;else if(e==="Semi-Business")if(g<=10)i=195.49;else{i=195.49;let k=g-10;k<=10?i+=k*39.9:k<=30?i+=10*39.9+(k-10)*49.22:k<=50?i+=10*39.9+20*49.22+(k-30)*62.55:k<=70?i+=10*39.9+20*49.22+20*62.55+(k-50)*72.88:k<=120?i+=10*39.9+20*49.22+20*62.55+20*72.88+(k-70)*76.14:k<=170?i+=10*39.9+20*49.22+20*62.55+20*72.88+50*76.14+(k-120)*79.42:i+=10*39.9+20*49.22+20*62.55+20*72.88+50*76.14+50*79.42+(k-170)*82.67}else if(e==="Commercial"||e==="Admin"){const k=[{limit:10,rate:0,fixed:512.3},{limit:20,rate:53.61},{limit:40,rate:58.98},{limit:60,rate:64.33},{limit:80,rate:69.69},{limit:100,rate:72.88},{limit:150,rate:76.14},{limit:200,rate:79.42},{limit:1/0,rate:82.67}];let F=g;i=0,F>0&&k[0].fixed&&(i+=k[0].fixed,F-=k[0].limit);for(let j=1;j<k.length&&!(F<=0);j++){const O=k[j-1].limit,D=k[j].limit-O,M=Math.min(F,D);i+=M*k[j].rate,F-=M}}else e==="Industrial"||e==="Meter Reading Personnel"?i=g*72.68:g<=10?i=195.49:i=195.49+(g-10)*23.82;s=i*x,y=i+s,o=y*w,e==="Commercial"||e==="Industrial"||e==="Admin"||e==="Meter Reading Personnel"?l=y*S:l=0;const R=y+o+l+u;f=R*I;const B=R;m=B*C;const P=B+f+m;return{consumption:g,serviceType:e,meterSize:N,basicCharge:parseFloat(i.toFixed(2)),fcda:parseFloat(s.toFixed(2)),waterCharge:parseFloat(y.toFixed(2)),environmentalCharge:parseFloat(o.toFixed(2)),sewerageCharge:parseFloat(l.toFixed(2)),maintenanceServiceCharge:parseFloat(u.toFixed(2)),subTotalBeforeTaxes:parseFloat(B.toFixed(2)),governmentTaxes:parseFloat(f.toFixed(2)),vatableSales:parseFloat(B.toFixed(2)),vat:parseFloat(m.toFixed(2)),totalCalculatedCharges:parseFloat(P.toFixed(2))}},p2=r=>{if(!r||typeof r!="string")return{serviceType:"Residential",role:"customer"};const e=r.toUpperCase().trim();return e.startsWith("ADM")?{serviceType:"Admin",role:"admin"}:e.startsWith("PER")?{serviceType:"Meter Reading Personnel",role:"meter_reader"}:e.startsWith("CLE")?{serviceType:"Clerk Operations",role:"clerk_cashier"}:e.startsWith("RES-LI")?{serviceType:"Residential Low-Income",role:"customer"}:e.startsWith("RES")?{serviceType:"Residential",role:"customer"}:e.startsWith("COM")?{serviceType:"Commercial",role:"customer"}:e.startsWith("IND")?{serviceType:"Industrial",role:"customer"}:{serviceType:"Residential",role:"customer"}},H8=r=>`https://placehold.co/100x100/3b82f6/FFFFFF?text=${r?r.charAt(0).toUpperCase():"A"}`,Yt=(r,e={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})=>{if(!r)return"N/A";let t;if(r.toDate&&typeof r.toDate=="function")t=r.toDate();else if(r instanceof Date)t=r;else if(typeof r=="string"||typeof r=="number")t=new Date(r);else return"Invalid Date";if(isNaN(t.getTime()))return"Invalid Date";try{return new Intl.DateTimeFormat("en-US",e).format(t)}catch{return"Invalid Date"}},st=(r,e)=>{console.error(`Firestore Error [${r}]:`,e.code,e.message,e.stack);let t=`An error occurred while ${r.replace(/([A-Z])/g," $1").toLowerCase()}. Code: ${e.code}.`;return e.code==="failed-precondition"?t+=" This often requires creating a Firestore index. Check the console logs for a link.":e.code==="permission-denied"?t+=" You don't have permission for this action. Check Firestore rules.":t+=" Please check your connection or contact support if the issue persists.",{success:!1,error:t}},$8=async(r,e,t)=>{if(!e||e.length===0)return{success:!0};try{const n=oc(r);return e.forEach(i=>{const s=$t(r,Xy(i));n.update(s,{status:t,lastUpdatedAt:Hn()})}),await n.commit(),{success:!0,count:e.length}}catch(n){return st("batch updating ticket status",n)}},W8=async(r,e)=>{if(!e)return{success:!1,error:"User ID is required."};try{const t=oc(r),n=$t(r,sr(),e),i=$t(r,vu(e));return t.delete(n),t.delete(i),await t.commit(),{success:!0}}catch(t){return st(`deleting user profile ${e}`,t)}},Jd=async(r,e)=>{try{const t=await St(wt(ct(r,e),Qf(500)));if(t.empty)return{success:!0,count:0};let n=0;for(;!t.empty;){const i=oc(r);if(t.docs.forEach(s=>{i.delete(s.ref)}),await i.commit(),n+=t.size,t.size<500)break;t=await St(wt(ct(r,e),Qf(500)))}return{success:!0,count:n}}catch(t){return st(`deleting all from ${e}`,t)}},G8=r=>Jd(r,lc()),K8=r=>Jd(r,zi()),Y8=r=>Jd(r,Vo()),Z8=r=>Jd(r,Am()),Q8=r=>Jd(r,_u()),X8=r=>Jd(r,Kl()),J8=async r=>{try{const e=await St(wt(ct(r,sr())));if(e.empty)return{success:!0,count:0};const t=oc(r);return e.docs.forEach(n=>{t.delete($t(r,sr(),n.id)),t.delete($t(r,vu(n.id)))}),await t.commit(),{success:!0,count:e.size}}catch(e){return st("deleting all users",e)}},e9=async(r,e,t)=>{if(!t||!e)return{success:!1,error:"User ID and Account Number required."};const n=t.trim().toUpperCase();if(!n)return{success:!1,error:"Account Number cannot be empty."};try{const i=ct(r,sr()),s=wt(i,bt("accountNumber","==",n)),o=await St(s);if(o.empty)return{success:!1,error:`Account Number "${n}" not found.`};const l=o.docs[0],u=l.data(),f=l.id;if(f===e)return{success:!0};if(u.uid&&u.uid!==e)return{success:!1,error:"Account already linked to another user."};const{role:m,serviceType:y}=p2(n),g={uid:e,accountNumber:n,role:m,serviceType:y,meterSerialNumber:u.meterSerialNumber||"",meterSize:u.meterSize||'1/2"',serviceAddress:u.serviceAddress||{}},_=oc(r);return _.update($t(r,sr(),f),g),_.update($t(r,vu(e)),g),await _.commit(),{success:!0}}catch(i){return st("linking account number",i)}},t9=async r=>{try{const e=ct(r,sr()),t=await St(e),n=new Set;return t.docs.forEach(i=>{var o;const s=(o=i.data().serviceAddress)==null?void 0:o.barangay;s&&n.add(s)}),{success:!0,data:Array.from(n).sort()}}catch(e){return st("getting unique service locations",e)}},n9=async(r,e)=>{if(!e)return{success:!0,data:[]};try{const t=ct(r,sr()),n=wt(t,bt("serviceAddress.barangay","==",e));return{success:!0,data:(await St(n)).docs.map(o=>o.data().accountNumber).filter(Boolean)}}catch(t){return st(`getting accounts in ${e}`,t)}},r9=async(r,e,t=null)=>{try{const n={...e,updatedAt:Hn()};return t?await Ls($t(r,Kl(),t),n):(n.createdAt=Hn(),await Xd(ct(r,Kl()),n)),{success:!0}}catch(n){return st("saving meter route",n)}},i9=async r=>{try{const e=wt(ct(r,Kl()),ei("name","asc"));return{success:!0,data:(await St(e)).docs.map(n=>({id:n.id,...n.data()}))}}catch(e){return st("getting all meter routes",e)}},s9=async(r,e)=>{try{return await Tm($t(r,Kl(),e)),{success:!0}}catch(t){return st("deleting meter route",t)}},o9=async r=>{try{const e=wt(ct(r,sr()),bt("role","==","meter_reader"),ei("displayName","asc"));return{success:!0,data:(await St(e)).docs.map(n=>({id:n.id,...n.data()}))}}catch(e){return st("getting all meter readers",e)}},a9=async r=>{try{const e=wt(ct(r,zi()),bt("status","==","Paid")),t=await St(e),n={};t.forEach(s=>{var f;const o=s.data(),l=(f=o.paymentDate)!=null&&f.toDate?o.paymentDate.toDate():null;if(!l)return;const u=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`;n[u]=(n[u]||0)+(o.amountPaid||0)});const i=Object.entries(n).sort(([s],[o])=>s.localeCompare(o)).slice(-12);return{success:!0,data:Object.fromEntries(i)}}catch(e){return st("getting revenue stats",e)}},l9=async r=>{try{const e=wt(ct(r,zi()),bt("status","==","Paid")),t=await St(e);if(t.empty)return{success:!0,data:{}};const n={},i=[...new Set(t.docs.map(o=>o.data().userId).filter(Boolean))],s={};for(let o=0;o<i.length;o+=30){const l=i.slice(o,o+30);if(l.length===0)continue;const u=wt(ct(r,sr()),bt(Zd.documentId(),"in",l));(await St(u)).forEach(m=>s[m.id]=m.data())}return t.forEach(o=>{var m;const l=o.data(),u=s[l.userId],f=((m=u==null?void 0:u.serviceAddress)==null?void 0:m.barangay)||"Unknown Barangay";n[f]=(n[f]||0)+(l.amountPaid||0)}),{success:!0,data:n}}catch(e){return st("getting revenue by location",e)}},c9=async r=>{try{const e=wt(ct(r,zi()),bt("status","==","Unpaid")),t=await St(e);let n=0;return t.forEach(i=>{n+=i.data().amount||0}),{success:!0,data:{totalOutstanding:n}}}catch(e){return st("getting outstanding balance",e)}},u9=async(r,e,t)=>{try{const n=wt(ct(r,Vo()),bt("readerId","==",e),bt("readingDateString","==",t));return{success:!0,data:{count:(await ty(n)).data().count}}}catch(n){return st("getting readings count by reader",n)}},d9=async(r,e)=>{const t=e==null?void 0:e.accountNumbers;if(!Array.isArray(t)||t.length===0)return{success:!0,data:[]};try{const n=ct(r,sr()),i=[];for(let s=0;s<t.length;s+=30){const o=t.slice(s,s+30);if(o.length===0)continue;const l=wt(n,bt("accountNumber","in",o));(await St(l)).forEach(f=>i.push({id:f.id,...f.data()}))}return{success:!0,data:i}}catch(n){return st("getting accounts in route",n)}},iy=async(r,e)=>{if(!e)return{success:!1,error:"User ID required."};try{const t=$t(r,sr(),e),n=await uu(t);if(n.exists())return{success:!0,data:{id:n.id,...n.data()}};{const i=$t(r,vu(e)),s=await uu(i);return s.exists()?{success:!0,data:{id:s.id,...s.data()}}:{success:!1,error:"User profile not found."}}}catch(t){return st(`getting user profile ${e}`,t)}},Jy=async(r,e)=>{const t=e==null?void 0:e.trim().toLowerCase();if(!t)return{success:!1,error:"Search term required."};const n=e.trim().toUpperCase();try{const i=ct(r,sr()),s=[wt(i,bt("accountNumber","==",n)),wt(i,bt("email","==",t)),wt(i,bt("meterSerialNumber","==",n)),wt(i,ei("displayNameLower"),bt("displayNameLower",">=",t),bt("displayNameLower","<=",t+""))],o=await Promise.allSettled(s.map(u=>St(u))),l=new Map;return o.forEach(u=>{u.status==="fulfilled"?u.value.forEach(f=>{l.has(f.id)||l.set(f.id,{id:f.id,...f.data()})}):console.error("Search query failed:",u.reason)}),{success:!0,data:Array.from(l.values())}}catch(i){return st("searching user profiles",i)}},BC=async(r,e,t)=>{if(!e||!t)return{success:!1,error:"User ID and profile required."};try{const n=wt(ct(r,Vo()),bt("userId","==",e),ei("readingDate","desc"),Qf(2)),i=await St(n);if(i.docs.length<2)return{success:!1,error:"At least two readings needed."};const s=i.docs[0],o=i.docs[1],l=s.data(),u=o.data(),f=l.readingValue-u.readingValue;if(f<0)return{success:!1,error:"Latest reading is lower than previous."};const m=l.readingDate.toDate(),y=m.toLocaleString("en-US",{month:"long",year:"numeric"}),g=wt(ct(r,zi()),bt("userId","==",e),bt("monthYear","==",y));if(!(await St(g)).empty)return{success:!1,error:`Bill for ${y} already exists.`};const E=await g2(r),x=E.success?E.data:{},w=zC(f,t.serviceType,t.meterSize,x),S=new Date(m);S.setDate(S.getDate()+(x.latePaymentPenaltyDelayDays||15));const I={userId:e,accountNumber:t.accountNumber,userName:t.displayName,billingPeriod:`${zS(u.readingDate.toDate())} - ${zS(l.readingDate.toDate())}`,monthYear:y,billDate:Ot.fromDate(m),dueDate:Ot.fromDate(S),previousReading:u.readingValue,currentReading:l.readingValue,consumption:f,...w,amount:w.totalCalculatedCharges||0,previousUnpaidAmount:0,seniorCitizenDiscount:0,totalAmountDue:w.totalCalculatedCharges||0,status:"Unpaid",createdAt:Hn(),previousReadingId:o.id,currentReadingId:s.id},C=await Xd(ct(r,zi()),I);return await Ls(C,{billId:C.id}),{success:!0,message:`Bill for ${y} generated.`,billId:C.id}}catch(n){return st(`generating bill for ${t==null?void 0:t.accountNumber}`,n)}},zS=r=>r?r.toLocaleDateString("en-CA"):"N/A",h9=async(r,e)=>{if(!e)return{success:!1,error:"Location required."};try{const t=ct(r,_u()),n=wt(t,bt("affectedAreas","array-contains",e),bt("status","in",["Scheduled","Ongoing"]),bt("isBillingPaused","==",!0));if(!(await St(n)).empty)return{success:!0,data:[]};const s=wt(ct(r,sr()),bt("serviceAddress.barangay","==",e)),o=await St(s);if(o.empty)return{success:!0,data:[]};const l=[],u=new Date;u.setDate(u.getDate()-30);for(const f of o.docs){const m={id:f.id,...f.data()};if(!m.accountNumber)continue;const y=wt(ct(r,Vo()),bt("userId","==",m.id),ei("readingDate","desc"),Qf(2)),g=await St(y);if(g.docs.length<2)continue;const E=g.docs[0].data().readingDate.toDate().toLocaleString("default",{month:"long",year:"numeric"}),x=wt(ct(r,zi()),bt("userId","==",m.id),bt("monthYear","==",E),Qf(1));(await St(x)).empty&&l.push(m)}return{success:!0,data:l}}catch(t){return st(`getting billable accounts in ${e}`,t)}},f9=async(r,e)=>{const t=[];let n=0,i=0;for(const s of e){const o=await BC(r,s.id,s);t.push({success:o.success,message:`${o.success?"SUCCESS":"FAILED"} [${s.accountNumber}]: ${o.message||o.error}`}),o.success?n++:i++}return{logs:t,successCount:n,failCount:i}},m9=async(r,e,t)=>{if(!e)return{success:!1,error:"User ID required."};try{const n=oc(r),i={...t,accountNumber:t.accountNumber?t.accountNumber.toUpperCase():"",uid:e,createdAt:Hn(),lastLoginAt:Hn(),displayNameLower:t.displayName?t.displayName.toLowerCase():"",rebatePoints:0,rebateTier:"Bronze"};return n.set($t(r,vu(e)),i),n.set($t(r,sr(),e),i),await n.commit(),{success:!0}}catch(n){return st("creating user profile",n)}},cf=async(r,e,t)=>{if(!e)return{success:!1,error:"User ID required."};try{const n=oc(r),i={...t,updatedAt:Hn()};return i.accountNumber&&(i.accountNumber=i.accountNumber.toUpperCase()),i.displayName&&(i.displayNameLower=i.displayName.toLowerCase()),n.update($t(r,vu(e)),i),n.update($t(r,sr(),e),i),await n.commit(),{success:!0}}catch(n){return st(`updating user profile ${e}`,n)}},p9=async r=>{try{return{success:!0,data:(await St(wt(ct(r,sr()),ei("displayNameLower","asc")))).docs.map(t=>({id:t.id,...t.data()}))}}catch(e){return st("getting all users profiles",e)}},g9=async(r,e)=>{try{const t=await Xd(ct(r,lc()),{...e,status:"Open",submittedAt:Hn(),lastUpdatedAt:Hn(),conversation:[]});return await Ls(t,{ticketId:t.id}),{success:!0,id:t.id}}catch(t){return st("creating support ticket",t)}},y9=async(r,e)=>{try{return await Tm($t(r,Xy(e))),{success:!0}}catch(t){return st("deleting support ticket",t)}},UC=async(r,e,t)=>{var n;if(!e||!(t!=null&&t.text))return{success:!1,error:"Ticket ID and reply text required."};try{const i=$t(r,Xy(e)),s={conversation:d8(t),lastUpdatedAt:Hn()},l=(n=(await uu(i)).data())==null?void 0:n.status;return t.authorRole!=="admin"&&(l==="Resolved"||l==="Closed")?s.status="Open":(t.authorRole==="admin"&&l==="Open"||t.authorRole!=="admin"&&l==="Awaiting Customer")&&(s.status="In Progress"),await Ls(i,s),{success:!0}}catch(i){return st("adding ticket reply",i)}},BS=async r=>{try{const e=wt(ct(r,lc()),ei("lastUpdatedAt","desc"));return{success:!0,data:(await St(e)).docs.map(n=>({id:n.id,...n.data()}))}}catch(e){return st("getting all support tickets",e)}},qC=async(r,e)=>{try{const t=wt(ct(r,lc()),bt("userId","==",e),ei("lastUpdatedAt","desc"));return{success:!0,data:(await St(t)).docs.map(i=>({id:i.id,...i.data()}))}}catch(t){return st("getting tickets by reporter",t)}},v9=async(r,e,t)=>{try{return await Ls($t(r,Xy(e)),{...t,lastUpdatedAt:Hn()}),{success:!0}}catch(n){return st("updating support ticket",n)}},_9=async(r,e)=>{try{const t=await Xd(ct(r,Am()),{...e,createdAt:Hn(),updatedAt:Hn()});return await Ls(t,{announcementId:t.id}),{success:!0,id:t.id}}catch(t){return st("creating announcement",t)}},x9=async(r,e=!1)=>{try{const t=e?[bt("status","==","active"),ei("startDate","desc")]:[ei("createdAt","desc")],n=wt(ct(r,Am()),...t);return{success:!0,data:(await St(n)).docs.map(s=>({id:s.id,...s.data()}))}}catch(t){return st("getting announcements",t)}},US=async(r,e,t)=>{try{return await Ls($t(r,LC(e)),{...t,updatedAt:Hn()}),{success:!0}}catch(n){return st("updating announcement",n)}},b9=async(r,e)=>{try{return await Tm($t(r,LC(e))),{success:!0}}catch(t){return st("deleting announcement",t)}},g2=async r=>{try{const e=await uu($t(r,Im()));return{success:!0,data:e.exists()?e.data():null}}catch(e){return st("getting system settings",e)}},w9=async(r,e)=>{try{return await l8($t(r,Im()),e,{merge:!0}),{success:!0}}catch(t){return st("updating system settings",t)}},Nm=async(r,e)=>{try{const t=wt(ct(r,zi()),bt("userId","==",e),ei("billDate","desc"));return{success:!0,data:(await St(t)).docs.map(i=>({id:i.id,...i.data()}))}}catch(t){return st("getting bills for user",t)}},E9=async(r,e,t,n,i)=>{var s;if(!(!(i!=null&&i.isRebateProgramEnabled)||!e))try{const o=i.pointsPerPeso||0,l=i.earlyPaymentDaysThreshold||7,u=i.earlyPaymentBonusPoints||10;let f=n*o;const m=(s=t.dueDate)!=null&&s.toDate?t.dueDate.toDate():new Date,y=new Date;if((m.getTime()-y.getTime())/(1e3*60*60*24)>=l&&(f+=u),f<=0)return;const _=$t(r,sr(),e),E=await uu(_);if(!E.exists())return;const w=(E.data().rebatePoints||0)+f;let S="Bronze";w>=3e3?S="Platinum":w>=1500?S="Gold":w>=500&&(S="Silver");const I={rebatePoints:w,rebateTier:S},C=oc(r);C.update(_,I),C.update($t(r,vu(e)),I),await C.commit()}catch(o){console.error("Failed to award rebate points:",o)}},T9=async(r,e,t)=>{try{if(await Ls($t(r,VS(e)),{...t,lastUpdatedAt:Hn()}),t.status==="Paid"&&t.amountPaid&&t.paymentTimestamp){const n=await uu($t(r,VS(e)));if(n.exists()){const i=n.data();if(i.userId){const s=await uu($t(r,Im())),o=s.exists()?s.data():{};await E9(r,i.userId,i,t.amountPaid,o)}}}return{success:!0}}catch(n){return st("updating bill",n)}},HC=async(r,e)=>{try{const t=new Date(e.readingDate);if(isNaN(t))throw new Error("Invalid reading date format.");const n={...e,readingValue:parseFloat(e.readingValue)||0,readingDate:Ot.fromDate(t),readingDateString:e.readingDate,recordedAt:Hn()},i=await Xd(ct(r,Vo()),n);return await Ls(i,{readingId:i.id}),{success:!0,id:i.id}}catch(t){return st("adding meter reading",t)}},S9=async(r,e,t)=>{try{const n=$t(r,FC(e)),i={...t,lastUpdatedAt:Hn()};if(i.readingDate&&typeof i.readingDate=="string"){const s=new Date(i.readingDate);isNaN(s)?(delete i.readingDate,delete i.readingDateString):(i.readingDate=Ot.fromDate(s),i.readingDateString=i.readingDate)}return i.readingValue!==void 0&&(i.readingValue=parseFloat(i.readingValue)||0),await Ls(n,i),{success:!0}}catch(n){return st("updating meter reading",n)}},A9=async(r,e)=>{try{return await Tm($t(r,FC(e))),{success:!0}}catch(t){return st("deleting meter reading",t)}},I9=async(r,e)=>{try{const t=wt(ct(r,Vo()),bt("accountNumber","==",e),ei("readingDate","desc"));return{success:!0,data:(await St(t)).docs.map(i=>({id:i.id,...i.data()}))}}catch(t){return st("getting meter readings for account",t)}},$C=async(r,e)=>{try{const t=wt(ct(r,Kl()),bt("assignedReaderId","==",e),ei("name"));return{success:!0,data:(await St(t)).docs.map(i=>({id:i.id,...i.data()}))}}catch(t){return st("getting routes for reader",t)}},N9=async(r,e,t=[])=>{try{const n=wt(ct(r,e),...t);return{success:!0,data:(await St(n)).docs.map(s=>({id:s.id,...s.data()}))}}catch(n){return st(`getting documents from ${e.split("/").pop()}`,n)}},WC=async r=>{try{const e=ct(r,sr()),t=await ty(e),i=(await St(e)).docs.reduce((s,o)=>{const l=o.data().role||"unknown";return s[l]=(s[l]||0)+1,s},{});return{success:!0,data:{total:t.data().count,byRole:i}}}catch(e){return st("getting users stats",e)}},GC=async r=>{try{const e=ct(r,lc()),t=await St(e),n={total:t.size,byStatus:{},byType:{}};return t.forEach(i=>{const s=i.data(),o=s.status||"Unknown",l=s.issueType||"Other Concern";n.byStatus[o]=(n.byStatus[o]||0)+1,n.byType[l]=(n.byType[l]||0)+1}),{success:!0,data:n}}catch(e){return st("getting tickets stats",e)}},k9=async r=>{try{const e=ct(r,Am()),t=await ty(e),n=wt(e,bt("status","==","active")),i=await ty(n);return{success:!0,data:{total:t.data().count,active:i.data().count}}}catch(e){return st("getting announcements stats",e)}},P9=async(r,e)=>{if(!e)return{success:!1,error:"Clerk ID required."};try{const t=new Date;t.setHours(0,0,0,0);const n=new Date;n.setHours(23,59,59,999);const i=Ot.fromDate(t),s=Ot.fromDate(n),o=wt(ct(r,zi()),bt("processedByClerkId","==",e),bt("paymentTimestamp",">=",i),bt("paymentTimestamp","<=",s)),l=await St(o);let u=0;const f=l.docs.map(m=>{const y=m.data();return u+=y.amountPaid||0,{id:m.id,...y}});return{success:!0,data:{paymentsTodayCount:l.size,totalCollectedToday:u,transactions:f.sort((m,y)=>y.paymentTimestamp.toDate()-m.paymentTimestamp.toDate())}}}catch(t){return st("getting payments by clerk for today",t)}},C9=async(r,e)=>{try{const t=await Xd(ct(r,_u()),{...e,startDate:Ot.fromDate(new Date(e.startDate)),estimatedEndDate:e.estimatedEndDate?Ot.fromDate(new Date(e.estimatedEndDate)):null,isBillingPaused:e.isBillingPaused||!1,createdAt:Hn(),updatedAt:Hn()});return await Ls(t,{interruptionId:t.id}),{success:!0,id:t.id}}catch(t){return st("creating service interruption",t)}},R9=async(r,e,t)=>{try{const n={...t,updatedAt:Hn()};return n.startDate&&typeof n.startDate=="string"&&(n.startDate=Ot.fromDate(new Date(n.startDate))),n.estimatedEndDate&&typeof n.estimatedEndDate=="string"&&(n.estimatedEndDate=Ot.fromDate(new Date(n.estimatedEndDate))),n.status==="Resolved"&&!n.resolvedAt&&(n.resolvedAt=Hn()),await Ls($t(r,VC(e)),n),{success:!0}}catch(n){return st("updating service interruption",n)}},O9=async(r,e)=>{try{return await Tm($t(r,VC(e))),{success:!0}}catch(t){return st("deleting service interruption",t)}},KC=async r=>{try{const e=Ot.now(),t=wt(ct(r,_u()),bt("status","in",["Ongoing","Scheduled"]),ei("startDate","desc"));return{success:!0,data:(await St(t)).docs.map(s=>({id:s.id,...s.data()})).filter(s=>s.status==="Scheduled"&&s.startDate.toMillis()>e.toMillis()?!0:s.status==="Ongoing"?s.estimatedEndDate?s.estimatedEndDate.toMillis()>e.toMillis():!0:s.status!=="Resolved"&&s.startDate.toMillis()<=e.toMillis()&&(!s.estimatedEndDate||s.estimatedEndDate.toMillis()>e.toMillis()))}}catch(e){return st("getting active service interruptions",e)}},j9=async r=>{try{const e=wt(ct(r,_u()),ei("createdAt","desc"));return{success:!0,data:(await St(e)).docs.map(n=>({id:n.id,...n.data()}))}}catch(e){return st("getting all service interruptions",e)}},M9=async r=>{try{const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),n=Ot.fromDate(t),[i,s,o]=await Promise.all([St(wt(ct(r,lc()),bt("submittedAt",">=",n))),St(wt(ct(r,Vo()),bt("recordedAt",">=",n))),St(wt(ct(r,zi()),bt("paymentTimestamp",">=",n)))]),l=Array(24).fill(0).map(()=>({tickets:0,readings:0,payments:0}));return i.forEach(u=>{const f=u.data().submittedAt.toDate().getHours();l[f].tickets++}),s.forEach(u=>{const f=u.data().recordedAt.toDate().getHours();l[f].payments++}),o.forEach(u=>{const f=u.data().paymentTimestamp.toDate().getHours();l[f].payments++}),{success:!0,data:l}}catch(e){return st("getting hourly activity stats",e)}},D9=async r=>{try{const e=new Date;e.setHours(0,0,0,0);const t=Ot.fromDate(e),[n,i,s]=await Promise.all([St(wt(ct(r,Vo()),bt("recordedAt",">=",t))),St(wt(ct(r,zi()),bt("paymentTimestamp",">=",t),bt("processedByClerkId","!=",null))),St(wt(ct(r,lc()),bt("lastUpdatedAt",">=",t)))]),o=n.docs.reduce((f,m)=>{const y=m.data().readBy||"Unknown Reader";return f[y]=(f[y]||0)+1,f},{}),l=i.docs.reduce((f,m)=>{const y=m.data().processedByClerkName||"Unknown Clerk";return f[y]=(f[y]||0)+1,f},{}),u=s.docs.reduce((f,m)=>{const y=m.data();if(y.status==="Resolved"||y.status==="Closed"){const g=y.lastUpdatedByAdminName||"Unknown Admin";f[g]=(f[g]||0)+1}return f},{});return{success:!0,data:{readerActivity:o,clerkActivity:l,adminActivity:u}}}catch(e){return st("getting staff activity stats",e)}},L9=async r=>{try{const[e,t,n]=await Promise.all([St(ct(r,Kl())),St(wt(ct(r,_u()),bt("status","in",["Scheduled","Ongoing"]))),St(wt(ct(r,Kl()),bt("assignedReaderId","==","")))]),i=e.size,s=e.docs.reduce((u,f)=>{var m;return u+(((m=f.data().accountNumbers)==null?void 0:m.length)||0)},0),o=t.size,l=n.size;return{success:!0,data:{totalRoutes:i,totalAccounts:s,activeInterrupts:o,unassignedRoutes:l}}}catch(e){return st("getting technical stats",e)}},F9=async r=>{try{const e=wt(ct(r,zi())),t=await St(e),n={};t.forEach(s=>{var f;const o=s.data(),l=(f=o.billDate)!=null&&f.toDate?o.billDate.toDate():null;if(!l||typeof o.consumption!="number")return;const u=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`;n[u]=(n[u]||0)+(o.consumption||0)});const i=Object.entries(n).sort(([s],[o])=>s.localeCompare(o)).slice(-12);return{success:!0,data:Object.fromEntries(i)}}catch(e){return st("getting consumption stats",e)}},V9=async r=>{try{const e=wt(ct(r,zi()),bt("status","==","Paid")),t=await St(e),n={};return t.forEach(i=>{const s=i.data().paymentMethod||"Unknown";n[s]=(n[s]||0)+1}),{success:!0,data:n}}catch(e){return st("getting payment method stats",e)}},z9=async r=>{try{const e=wt(ct(r,sr()),bt("createdAt","!=",null)),t=await St(e),n={};t.forEach(s=>{var f;const o=s.data(),l=(f=o.createdAt)!=null&&f.toDate?o.createdAt.toDate():null;if(!l)return;const u=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`;n[u]=(n[u]||0)+1});const i=Object.entries(n).sort(([s],[o])=>s.localeCompare(o)).slice(-12);return{success:!0,data:Object.fromEntries(i)}}catch(e){return st("getting user growth stats",e)}};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B9=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),YC=(...r)=>r.filter((e,t,n)=>!!e&&n.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var U9={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q9=te.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:o,...l},u)=>te.createElement("svg",{ref:u,...U9,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:YC("lucide",i),...l},[...o.map(([f,m])=>te.createElement(f,m)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=(r,e)=>{const t=te.forwardRef(({className:n,...i},s)=>te.createElement(q9,{ref:s,iconNode:e,className:YC(`lucide-${B9(r)}`,n),...i}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sy=Le("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H9=Le("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oy=Le("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $9=Le("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y2=Le("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rx=Le("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZC=Le("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const du=Le("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QC=Le("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XC=Le("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W9=Le("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=Le("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v2=Le("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G9=Le("CirclePause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K9=Le("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e0=Le("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=Le("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y9=Le("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z9=Le("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _2=Le("ClipboardPen",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",key:"1oijnt"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-5.5",key:"cereej"}],["path",{d:"M4 13.5V6a2 2 0 0 1 2-2h2",key:"5ua5vh"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=Le("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q9=Le("Compass",[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JC=Le("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ox=Le("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X9=Le("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J9=Le("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ay=Le("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yl=Le("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eF=Le("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tF=Le("FilePlus",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x2=Le("FileSearch",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4.268 21a2 2 0 0 0 1.727 1H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"ms7g94"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}],["circle",{cx:"5",cy:"14",r:"3",key:"ufru5t"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zl=Le("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nF=Le("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ql=Le("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b2=Le("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rF=Le("HardHat",[["path",{d:"M2 18a1 1 0 0 0 1 1h18a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v2z",key:"1dej2m"}],["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6",key:"9ciidu"}],["path",{d:"M14 6a6 6 0 0 1 6 6v3",key:"1hnv84"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=Le("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w2=Le("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kn=Le("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iF=Le("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ly=Le("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E2=Le("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e3=Le("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sF=Le("ListFilter",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oF=Le("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const At=Le("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t0=Le("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=Le("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=Le("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xl=Le("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yd=Le("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aF=Le("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lF=Le("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ka=Le("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t3=Le("OctagonAlert",[["polygon",{points:"7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2",key:"h1p8hx"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T2=Le("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cF=Le("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fh=Le("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n3=Le("PhoneCall",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uF=Le("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S2=Le("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dF=Le("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ma=Le("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Da=Le("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=Le("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n0=Le("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r0=Le("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eh=Le("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hF=Le("ShieldQuestion",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=Le("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fF=Le("SquareCheckBig",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xf=Le("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mF=Le("SquareX",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dd=Le("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pF=Le("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gF=Le("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const th=Le("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=Le("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qt=Le("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yF=Le("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i3=Le("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=Le("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o3=Le("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gv=Le("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vF=Le("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _F=Le("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=Le("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qS=Le("Wind",[["path",{d:"M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2",key:"1k4u03"}],["path",{d:"M9.6 4.6A2 2 0 1 1 11 8H2",key:"b7d0fd"}],["path",{d:"M12.6 19.4A2 2 0 1 0 14 16H2",key:"1p5cb3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i0=Le("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a3=Le("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),jx=is.memo(({message:r,type:e,onClose:t})=>{if(te.useEffect(()=>{if(!r)return;const s=setTimeout(()=>{t()},5e3);return()=>clearTimeout(s)},[t,r,e]),!r)return null;let n="bg-red-500",i=Qt;return e==="success"?(n="bg-green-500",i=ks):e==="warning"?(n="bg-yellow-500",i=Qt):e==="info"&&(n="bg-blue-500",i=Qt),d.jsxs("div",{className:`fixed top-5 right-5 ${n} text-white p-4 rounded-lg shadow-xl flex items-center space-x-3 z-[200] animate-slide-in-right`,role:"alert",children:[d.jsx(i,{size:24,"aria-hidden":"true"}),d.jsx("span",{className:"text-sm font-medium",children:r}),d.jsx("button",{onClick:t,className:"ml-auto p-1 rounded-full hover:bg-white/20 transition-colors","aria-label":"Close notification",children:d.jsx(i0,{size:18})}),d.jsx("style",{children:`
        @keyframes slide-in-right {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }
        .animate-slide-in-right {
          animation: slide-in-right 0.5s cubic-bezier(0.25, 0.8, 0.25, 1) forwards;
        }
      `})]})});jx.displayName="Notification";const HS=({message:r="Loading..."})=>d.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-700 to-indigo-800 flex flex-col justify-center items-center p-4 font-inter text-white selection:bg-blue-300 selection:text-blue-900",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("h1",{className:"text-6xl font-bold tracking-tight mb-2 animate-pulse",children:"AGWA"}),d.jsx("p",{className:"text-blue-200 text-lg italic mb-8",children:"Ensuring Clarity, Sustaining Life."}),d.jsx(At,{className:"h-12 w-12 mx-auto animate-spin text-blue-300"}),d.jsx("p",{className:"text-blue-300 text-sm mt-4",children:r})]}),d.jsxs("p",{className:"text-center text-xs text-blue-400 mt-12 absolute bottom-6",children:[" ",new Date().getFullYear()," AGWA Water Services, Inc."]})]}),Mr=is.memo(({isOpen:r,onClose:e,title:t="",children:n,size:i="md",hideCloseButton:s=!1,modalDialogClassName:o="",contentClassName:l=""})=>{const u=te.useCallback(y=>{y.key==="Escape"&&e()},[e]);if(te.useEffect(()=>(r?(window.addEventListener("keydown",u),document.body.style.overflow="hidden"):(window.removeEventListener("keydown",u),document.body.style.overflow="unset"),()=>{window.removeEventListener("keydown",u),document.body.style.overflow="unset"}),[r,u]),!r)return null;const f={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl","2xl":"max-w-2xl","3xl":"max-w-3xl","4xl":"max-w-4xl","5xl":"max-w-5xl",full:"max-w-full h-full sm:h-auto sm:max-h-[95vh]"},m=`bg-white rounded-xl shadow-2xl w-full ${f[i]||f.md} transform transition-all duration-300 ease-out scale-95 opacity-0 animate-modal-appear flex flex-col max-h-[90vh] ${o}`;return d.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex justify-center items-center z-[100] p-4 overflow-y-auto animate-fadeIn",onClick:s?void 0:e,role:"dialog","aria-modal":"true","aria-labelledby":t?"modal-title":void 0,children:[d.jsxs("div",{className:m,onClick:y=>y.stopPropagation(),role:"document",children:[t&&d.jsxs("div",{className:"flex justify-between items-center p-4 sm:p-5 border-b border-gray-200 sticky top-0 bg-white z-10 rounded-t-xl",children:[d.jsx("h3",{id:"modal-title",className:"text-lg sm:text-xl font-semibold text-gray-800",children:t}),!s&&d.jsx("button",{type:"button",onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors p-1 rounded-full hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Close modal",children:d.jsx(i0,{size:24})})]}),d.jsx("div",{className:`p-4 sm:p-6 flex-grow overflow-y-auto ${l}`,children:n})]}),d.jsx("style",{children:`
                @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
                .animate-fadeIn { animation: fadeIn 0.2s ease-out forwards; }
                @keyframes modal-appear { 0% { transform: scale(0.95) translateY(10px); opacity: 0; } 100% { transform: scale(1) translateY(0); opacity: 1; } }
                .animate-modal-appear { animation: modal-appear 0.25s cubic-bezier(0.25, 0.8, 0.25, 1) forwards; }
                `})]})});Mr.displayName="Modal";const xF=({isOpen:r,onClose:e})=>d.jsx(Mr,{isOpen:r,onClose:e,title:"Terms of Service",size:"3xl",children:d.jsxs("div",{className:"prose prose-sm max-w-none max-h-[70vh] overflow-y-auto pr-2",children:[d.jsx("p",{children:d.jsx("strong",{children:"Last Updated: October 31, 2025"})}),d.jsx("p",{children:'Please read these Terms of Service ("Terms", "Terms of Service") carefully before using the AGWA Water Services, Inc. ("AGWA", "us", "we", or "our") customer portal (the "Service").'}),d.jsx("p",{children:"Your access to and use of the Service is conditioned on your acceptance of and compliance with these Terms. These Terms apply to all visitors, users, and others who access or use the Service."}),d.jsx("h4",{children:"1. Account Registration and Security"}),d.jsxs("ul",{children:[d.jsx("li",{children:"To use this Service, you must be a registered customer of AGWA Water Services, Inc. You agree to provide information that is accurate, complete, and current at all times. Failure to do so constitutes a breach of the Terms, which may result in immediate termination of your account on our Service."}),d.jsx("li",{children:"You are responsible for safeguarding the password that you use to access the Service and for any activities or actions under your password."}),d.jsx("li",{children:"You agree not to disclose your password to any third party. You must notify us immediately upon becoming aware of any breach of security or unauthorized use of your account."})]}),d.jsx("h4",{children:"2. Use of the Service"}),d.jsx("p",{children:"You agree to use the Service only for lawful purposes. You are responsible for all of your activity in connection with the Service. You shall not (and shall not permit any third party to):"}),d.jsxs("ul",{children:[d.jsx("li",{children:"Take any action that imposes or may impose (as determined by us in our sole discretion) an unreasonable or disproportionately large load on our infrastructure."}),d.jsx("li",{children:"Interfere or attempt to interfere with the proper working of the Service or any activities conducted on the Service."}),d.jsx("li",{children:"Bypass any measures we may use to prevent or restrict access to the Service."})]}),d.jsx("h4",{children:"3. Online Payments"}),d.jsxs("ul",{children:[d.jsx("li",{children:"The Service provides a platform to facilitate payments for your water bills using third-party payment gateways (e.g., Stripe)."}),d.jsx("li",{children:"AGWA is not a bank or financial institution. All payment transactions are processed by our third-party payment partners. You agree to abide by the terms and conditions of these partners."}),d.jsx("li",{children:"You are responsible for ensuring that your payment information is correct and that you have sufficient funds to cover your payment."})]}),d.jsx("h4",{children:"4. Disclaimers"}),d.jsx("p",{children:'The Service is provided on an "AS IS" and "AS AVAILABLE" basis. Your use of the Service is at your sole risk.'}),d.jsx("p",{children:"AGWA does not warrant that (a) the Service will function uninterrupted, secure, or available at any particular time or location; (b) any errors or defects will be corrected; (c) the Service is free of viruses or other harmful components."}),d.jsx("p",{children:"All data presented in the Portal (including consumption, billing amounts, and payment status) is provided for convenience. In the event of any discrepancy, the official records held by AGWA Water Services, Inc. shall be deemed correct."}),d.jsx("h4",{children:"5. Limitation of Liability"}),d.jsx("p",{children:"In no event shall AGWA, nor its directors, employees, partners, or agents, be liable for any indirect, incidental, special, consequential, or punitive damages, including without limitation, loss of profits, data, use, goodwill, or other intangible losses, resulting from your access to or use of or inability to access or use the Service."}),d.jsx("h4",{children:"6. Governing Law"}),d.jsx("p",{children:"These Terms shall be governed and construed in accordance with the laws of the Republic of the Philippines, without regard to its conflict of law provisions."}),d.jsx("h4",{children:"7. Changes to Terms"}),d.jsx("p",{children:"We reserve the right, at our sole discretion, to modify or replace these Terms at any time. We will provide notice of any changes by posting the new Terms on this page. Your continued use of the Service after any such changes constitutes your acceptance of the new Terms."}),d.jsx("h4",{children:"8. Contact Us"}),d.jsx("p",{children:'If you have any questions about these Terms, please contact us through the "Contact Us" page available after logging in.'})]})}),bF=({isOpen:r,onClose:e})=>d.jsx(Mr,{isOpen:r,onClose:e,title:"Data Privacy Notice",size:"3xl",children:d.jsxs("div",{className:"prose prose-sm max-w-none max-h-[70vh] overflow-y-auto pr-2",children:[d.jsx("p",{children:d.jsx("strong",{children:"Last Updated: October 31, 2025"})}),d.jsx("h4",{children:"Our Commitment to Privacy"}),d.jsx("p",{children:'AGWA Water Services, Inc. ("AGWA") is committed to protecting your privacy in accordance with Republic Act No. 10173, also known as the Data Privacy Act of 2012 (DPA), its Implementing Rules and Regulations (IRR), and other relevant data privacy laws.'}),d.jsx("h4",{children:"1. What Personal Information We Collect"}),d.jsx("p",{children:"We collect, store, and process your personal information when you register for an account, use our services, pay your bills, or interact with our customer support. This information may include:"}),d.jsxs("ul",{children:[d.jsxs("li",{children:[d.jsx("strong",{children:"Personal Identification Data:"})," Full name, email address, phone number, and service address."]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Account and Service Data:"})," AGWA Account Number, meter serial number, service type, account status, and account creation date."]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Financial and Transaction Data:"})," Billing history, payment history, consumption data, payment method details (which are securely processed by our third-party payment partners), and rebate point information."]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Communication Data:"})," Records of your correspondence with us, such as support tickets, chat logs, and issue reports."]})]}),d.jsx("h4",{children:"2. How We Use Your Information"}),d.jsx("p",{children:"Your personal data is used for the following legitimate business purposes:"}),d.jsxs("ul",{children:[d.jsx("li",{children:"To create, maintain, and secure your AGWA Portal account."}),d.jsx("li",{children:"To provide and manage your water services, including meter reading, billing, and maintenance."}),d.jsx("li",{children:"To process your bill payments and manage your account transactions."}),d.jsx("li",{children:"To respond to your inquiries, concerns, and support tickets, and to provide customer support."}),d.jsx("li",{children:"To send you essential service advisories, billing reminders, and other system notifications."}),d.jsx("li",{children:"To manage your participation in programs such as the AGWA Rewards Program."}),d.jsx("li",{children:"To analyze portal and service usage to improve our operations, services, and user experience."}),d.jsx("li",{children:"To comply with our legal and regulatory obligations as a public utility."})]}),d.jsx("h4",{children:"3. Data Sharing and Disclosure"}),d.jsx("p",{children:"We do not sell or rent your personal information. We may share your data in the following limited circumstances:"}),d.jsxs("ul",{children:[d.jsxs("li",{children:[d.jsx("strong",{children:"Third-Party Service Providers:"})," With trusted partners who perform services on our behalf, such as payment gateways (e.g., Stripe) and data hosting (e.g., Firebase). These partners are contractually bound to protect your data and use it only for the purposes we specify."]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Legal and Regulatory Requirements:"})," When required by law, such as in response to a subpoena, court order, or formal request from government authorities."]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Emergency:"})," To protect the vital interests of any individual, such as during emergencies or service-related safety incidents."]})]}),d.jsx("h4",{children:"4. Data Security and Retention"}),d.jsx("p",{children:"We implement robust technical, physical, and organizational security measures to protect your personal information from unauthorized access, use, alteration, or disclosure. This includes data encryption, access controls, and secure server environments."}),d.jsx("p",{children:"We retain your personal data only for as long as your account is active or as necessary to fulfill the purposes outlined in this notice, and as required by law for auditing and regulatory record-keeping."}),d.jsx("h4",{children:"5. Your Rights as a Data Subject"}),d.jsx("p",{children:"In accordance with the Data Privacy Act, you have the right to:"}),d.jsxs("ul",{children:[d.jsxs("li",{children:[d.jsx("strong",{children:"Be Informed"})," that your personal data will be, are being, or were processed."]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Access"})," your personal information we hold."]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Rectify"})," any inaccuracies or errors in your data."]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Erase or Block"})," your data from our systems, subject to legal and contractual limitations."]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Object"})," to the processing of your personal data."]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Data Portability"})," to obtain a copy of your data in a machine-readable format."]}),d.jsxs("li",{children:[d.jsx("strong",{children:"Lodge a Complaint"})," with the National Privacy Commission (NPC) if you feel your data privacy rights have been violated."]})]}),d.jsx("h4",{children:"6. Contacting Us"}),d.jsx("p",{children:"To exercise any of these rights or if you have any questions about this privacy notice, please contact our Data Privacy Officer at:"}),d.jsxs("p",{children:[d.jsx("strong",{children:"Email:"})," ",d.jsx("a",{href:"mailto:dpo@agwa-waterservices.com.ph",children:"dpo@agwa-waterservices.com.ph"}),d.jsx("br",{}),d.jsx("strong",{children:"Hotline:"})," 1627-AGWA (Attn: Data Privacy Officer)"]}),d.jsx("h4",{children:"7. Changes to This Notice"}),d.jsx("p",{children:'We may update this Data Privacy Notice from time to time. We will notify you of any significant changes by posting the new notice on this page and updating the "Last Updated" date.'})]})}),l3=is.memo(({children:r,authError:e,appIdForPaths:t,systemSettings:n={}})=>{const[i,s]=te.useState(!1),[o,l]=te.useState(!1);return d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-700 to-indigo-800 flex flex-col justify-center items-center p-4 font-sans selection:bg-blue-300 selection:text-blue-900",children:[d.jsxs("div",{className:"bg-white p-8 sm:p-10 md:p-12 rounded-xl shadow-2xl w-full max-w-md transform transition-all duration-500 ease-out animate-fadeInUp",children:[d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("h1",{className:"text-5xl font-bold text-blue-600 tracking-tight",children:"AGWA"}),d.jsx("p",{className:"text-sm text-gray-500 mt-1 italic",children:"Ensuring Clarity, Sustaining Life."})]}),e&&d.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 text-red-700 rounded-lg text-sm text-center animate-shake",role:"alert",children:e}),is.cloneElement(r,{systemSettings:n}),d.jsxs("p",{className:"text-xs text-gray-400 text-center mt-6",children:["By continuing, you agree to our ",d.jsx("br",{}),d.jsx("button",{type:"button",onClick:()=>s(!0),className:"font-medium text-blue-600 hover:underline",children:"Terms of Service"})," ","and"," ",d.jsx("button",{type:"button",onClick:()=>l(!0),className:"font-medium text-blue-600 hover:underline",children:"Data Privacy Notice"}),"."]})]}),t&&d.jsxs("p",{className:"text-center text-xs text-blue-200 mt-8",children:["App ID (DB): ",d.jsx("span",{className:"font-semibold opacity-80",children:t})]}),d.jsxs("p",{className:"text-center text-xs text-blue-300 mt-2",children:[" ",new Date().getFullYear()," AGWA Water Services, Inc."]}),d.jsx("div",{id:"recaptcha-container",className:"my-2 mx-auto"}),d.jsx("style",{children:`
          @keyframes fadeInUp {
            from {
              opacity: 0;
              transform: translateY(20px);
            }
            to {
              opacity: 1;
              transform: translateY(0);
            }
          }
          .animate-fadeInUp {
            animation: fadeInUp 0.6s ease-out forwards;
          }

          @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
          }
          .animate-shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
          }
        `})]}),d.jsx(xF,{isOpen:i,onClose:()=>s(!1)}),d.jsx(bF,{isOpen:o,onClose:()=>l(!1)})]})});l3.displayName="AuthFormContainer";function c3(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var i=r.length;for(e=0;e<i;e++)r[e]&&(t=c3(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function A2(){for(var r,e,t=0,n="",i=arguments.length;t<i;t++)(r=arguments[t])&&(e=c3(r))&&(n&&(n+=" "),n+=e);return n}const Mi="w-full px-4 py-3 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 focus:outline-none transition duration-200 text-gray-900 placeholder-gray-400 disabled:bg-gray-200 disabled:cursor-not-allowed",Jf=r=>A2("w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 active:scale-95 flex items-center justify-center",{"opacity-60 cursor-not-allowed":r}),u3=r=>A2("w-full bg-white hover:bg-gray-100 text-gray-700 font-semibold py-3 px-4 rounded-lg border border-gray-300 shadow-sm hover:shadow transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-opacity-50 flex items-center justify-center space-x-2 active:scale-95",{"opacity-50 cursor-not-allowed":r}),d3=r=>A2("w-full bg-teal-500 hover:bg-teal-600 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-teal-400 focus:ring-opacity-50 flex items-center justify-center space-x-2 active:scale-95",{"opacity-50 cursor-not-allowed":r}),wF=({navigateTo:r,authActionLoading:e,handleLoginExternal:t,handleGoogleSignIn:n,setAuthError:i,systemSettings:s={}})=>{const[o,l]=te.useState(""),[u,f]=te.useState(""),[m,y]=te.useState(!1),g=async S=>{if(S.preventDefault(),!o||!u){i&&i("Please enter both email and password.");return}i&&i(""),await t(o,u)},_=async()=>{i&&i(""),await n()},{isGoogleLoginEnabled:E=!0,isPasswordlessLoginEnabled:x=!0,isSignupEnabled:w=!0}=s;return d.jsxs("form",{onSubmit:g,className:"space-y-5",children:[d.jsxs("div",{className:"relative",children:[d.jsx(Ia,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),d.jsx("input",{type:"email",placeholder:"Email Address *",value:o,onChange:S=>l(S.target.value),className:`${Mi} pl-11`,required:!0,disabled:e,"aria-label":"Email Address"})]}),d.jsxs("div",{className:"relative",children:[d.jsx(ly,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),d.jsx("input",{type:m?"text":"password",placeholder:"Password *",value:u,onChange:S=>f(S.target.value),className:`${Mi} pl-11`,required:!0,disabled:e,"aria-label":"Password"}),d.jsx("button",{type:"button",onClick:()=>y(!m),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 p-1 focus:outline-none","aria-label":m?"Hide password":"Show password",disabled:e,children:m?d.jsx(ay,{size:20}):d.jsx(Yl,{size:20})})]}),d.jsxs("button",{type:"submit",className:Jf(e),disabled:e,children:[e&&d.jsx(At,{className:"animate-spin inline mr-2",size:18}),e?"Logging In...":"Login"]}),(E||x)&&d.jsxs("div",{className:"relative my-4",children:[d.jsx("div",{className:"absolute inset-0 flex items-center",children:d.jsx("div",{className:"w-full border-t border-gray-300"})}),d.jsx("div",{className:"relative flex justify-center text-sm",children:d.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with"})})]}),E&&d.jsxs("button",{type:"button",onClick:_,className:u3(e),disabled:e,children:[d.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",className:"h-5 w-5",onError:S=>S.target.style.display="none"}),d.jsx("span",{children:"Sign in with Google"})]}),x&&d.jsxs("button",{type:"button",onClick:()=>r("passwordlessLogin"),className:d3(e),disabled:e,children:[d.jsx(E2,{size:18,className:"mr-2"}),d.jsx("span",{children:"Sign in with Email Link"})]}),d.jsxs("div",{className:"text-sm text-center mt-5 space-y-1.5",children:[w&&d.jsxs("p",{className:"text-gray-600",children:["Don't have an account?"," ",d.jsx("button",{type:"button",onClick:()=>r("signup"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-70",disabled:e,children:"Sign Up"})]}),d.jsx("p",{className:"text-gray-600",children:d.jsx("button",{type:"button",onClick:()=>r("forgotPassword"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-70",disabled:e,children:"Forgot Password?"})})]})]})},EF=({navigateTo:r,authActionLoading:e,handleSignupExternal:t,handleGoogleSignIn:n,setAuthError:i,showNotification:s,systemSettings:o={}})=>{const[l,u]=te.useState(""),[f,m]=te.useState(""),[y,g]=te.useState(""),[_,E]=te.useState(""),[x,w]=te.useState(""),[S,I]=te.useState(!1),[C,N]=te.useState(!1),R=async k=>{if(k.preventDefault(),i(""),!_.trim()){i("Full Name is required."),s("Full Name is required.","warning");return}if(!x.trim()){i("AGWA Account Number is required (e.g., RES-12345, ADM-001)."),s("AGWA Account Number is required.","warning");return}if(f.length<6){i("Password must be at least 6 characters long."),s("Password too short (min. 6 chars).","warning");return}if(f!==y){i("Passwords do not match."),s("Passwords don't match.","warning");return}await t(l,f,_,x)},B=async()=>{await n()},{isGoogleLoginEnabled:P=!0}=o;return d.jsxs("form",{onSubmit:R,className:"space-y-5",children:[d.jsxs("div",{className:"relative",children:[d.jsx(Ps,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),d.jsx("input",{type:"text",placeholder:"Full Name *",value:_,onChange:k=>E(k.target.value),className:`${Mi} pl-11`,required:!0,disabled:e,"aria-label":"Full Name"})]}),d.jsxs("div",{className:"relative",children:[d.jsx(Cs,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),d.jsx("input",{type:"text",placeholder:"AGWA Account Number (e.g., RES-12345) *",value:x,onChange:k=>w(k.target.value),className:`${Mi} pl-11`,required:!0,disabled:e,"aria-label":"AGWA Account Number"})]}),d.jsxs("div",{className:"relative",children:[d.jsx(Ia,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),d.jsx("input",{type:"email",placeholder:"Email Address *",value:l,onChange:k=>u(k.target.value),className:`${Mi} pl-11`,required:!0,disabled:e,"aria-label":"Email Address"})]}),d.jsxs("div",{className:"relative",children:[d.jsx(ly,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),d.jsx("input",{type:S?"text":"password",placeholder:"Password (min. 6 chars) *",value:f,onChange:k=>m(k.target.value),className:`${Mi} pl-11`,required:!0,disabled:e,"aria-label":"Password"}),d.jsx("button",{type:"button",onClick:()=>I(!S),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 p-1 focus:outline-none","aria-label":S?"Hide password":"Show password",disabled:e,children:S?d.jsx(ay,{size:20}):d.jsx(Yl,{size:20})})]}),d.jsxs("div",{className:"relative",children:[d.jsx(ly,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),d.jsx("input",{type:C?"text":"password",placeholder:"Confirm Password *",value:y,onChange:k=>g(k.target.value),className:`${Mi} pl-11`,required:!0,disabled:e,"aria-label":"Confirm Password"}),d.jsx("button",{type:"button",onClick:()=>N(!C),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 p-1 focus:outline-none","aria-label":C?"Hide confirm password":"Show confirm password",disabled:e,children:C?d.jsx(ay,{size:20}):d.jsx(Yl,{size:20})})]}),d.jsxs("button",{type:"submit",className:Jf(e),disabled:e,children:[e&&d.jsx(At,{className:"animate-spin inline mr-2",size:18}),e?"Creating Account...":"Create My Account"]}),P&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"relative my-4",children:[d.jsx("div",{className:"absolute inset-0 flex items-center",children:d.jsx("div",{className:"w-full border-t border-gray-300"})}),d.jsx("div",{className:"relative flex justify-center text-sm",children:d.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or sign up with"})})]}),d.jsxs("button",{type:"button",onClick:B,className:u3(e),disabled:e,children:[d.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",className:"h-5 w-5",onError:k=>k.target.style.display="none"}),d.jsx("span",{children:"Sign up with Google"})]})]}),d.jsxs("p",{className:"text-sm text-center text-gray-600 mt-5",children:["Already have an account?"," ",d.jsx("button",{type:"button",onClick:()=>r("login"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-70",disabled:e,children:"Login"})]})]})},TF=({handleForgotPasswordExternal:r,navigateTo:e,authActionLoading:t})=>{const[n,i]=te.useState(""),[s,o]=te.useState(!1),l=async u=>{if(u.preventDefault(),!n.trim()){alert("Please enter your email address.");return}await r(n)&&o(!0)};return s?d.jsxs("div",{className:"space-y-5 text-center",children:[d.jsx(Ia,{size:48,className:"mx-auto text-green-500 mb-3"}),d.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Password Reset Email Sent"}),d.jsxs("p",{className:"text-sm text-gray-600",children:["If an account exists for ",d.jsx("strong",{children:n}),", you will receive an email with instructions to reset your password. Please check your inbox (and spam folder)."]}),d.jsxs("button",{type:"button",onClick:()=>e("login"),className:`${Jf(!1)} bg-green-600 hover:bg-green-700 focus:ring-green-500 mt-4`,children:[d.jsx(sy,{size:18,className:"mr-2"})," Back to Login"]})]}):d.jsxs("form",{onSubmit:l,className:"space-y-5",children:[d.jsx("p",{className:"text-sm text-gray-600 mb-4 text-center",children:"Enter your email address below, and we'll send you a link to reset your password."}),d.jsxs("div",{className:"relative",children:[d.jsx(Ia,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),d.jsx("input",{type:"email",placeholder:"Enter your Email Address",value:n,onChange:u=>i(u.target.value),className:`${Mi} pl-11`,required:!0,disabled:t,"aria-label":"Email for password reset"})]}),d.jsxs("button",{type:"submit",className:Jf(t||!n.trim()),disabled:t||!n.trim(),children:[t?d.jsx(At,{className:"animate-spin mr-2",size:20}):null,t?"Sending Link...":"Send Password Reset Link"]}),d.jsx("div",{className:"text-sm text-center mt-6",children:d.jsxs("button",{type:"button",onClick:()=>e("login"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-50",disabled:t,children:[d.jsx(sy,{size:16,className:"inline mr-1"})," Remembered your password? Login"]})})]})},SF=({handlePasswordlessSignInExternal:r,navigateTo:e,authActionLoading:t})=>{const[n,i]=te.useState(""),[s,o]=te.useState(!1),l=async u=>{if(u.preventDefault(),!n.trim()){alert("Please enter your email address.");return}const f=await r(n);f&&f.success&&o(!0)};return s?d.jsxs("div",{className:"space-y-5 text-center",children:[d.jsx(ks,{size:48,className:"mx-auto text-green-500 mb-3"}),d.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Sign-in Link Sent!"}),d.jsxs("p",{className:"text-sm text-gray-600",children:["A magic sign-in link has been sent to ",d.jsx("strong",{children:n}),". Please check your email and click the link to sign in. The link is valid for a limited time."]}),d.jsxs("button",{type:"button",onClick:()=>e("login"),className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 flex items-center justify-center mt-4",children:[d.jsx(sy,{size:18,className:"mr-2"})," Okay, Got It!"]})]}):d.jsxs("form",{onSubmit:l,className:"space-y-5",children:[d.jsx("p",{className:"text-sm text-gray-600 mb-4 text-center",children:"Enter your email address, and we'll send you a magic link to sign in instantly. No password needed!"}),d.jsxs("div",{className:"relative",children:[d.jsx(Ia,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),d.jsx("input",{type:"email",placeholder:"Enter your Email Address",value:n,onChange:u=>i(u.target.value),className:`${Mi} pl-11`,required:!0,disabled:t,"aria-label":"Email for passwordless sign-in"})]}),d.jsxs("button",{type:"submit",className:d3(t||!n.trim()),disabled:t||!n.trim(),children:[t?d.jsx(At,{className:"animate-spin mr-2",size:20}):d.jsx(E2,{size:20,className:"mr-2"}),t?"Sending Link...":"Send Sign-in Link"]}),d.jsx("div",{className:"text-sm text-center mt-6",children:d.jsxs("button",{type:"button",onClick:()=>e("login"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-50",disabled:t,children:[d.jsx(sy,{size:16,className:"inline mr-1"})," Prefer a password? Login"]})})]})},AF={Home:w2,UserCog:o3,FileText:Zl,AlertTriangle:Qt,Users:wa,MessageSquare:ka,Settings:r0,HelpCircle:v2,Info:kn,PhoneCall:n3,LogOut:t0,ShieldCheck:eh,Megaphone:yd,BarChart3:y2,Edit:Xf,Gauge:Ql,Map:Xl,ClipboardEdit:_2,Search:Rs,Banknote:oy,FileSearch:x2,TrendingUp:r3,Gift:b2,AlertIcon:Qt,EditIcon:Xf,Eye:Yl},IF=({userData:r,navItems:e,activeSection:t,onNavigate:n,onLogout:i,isMobileOpen:s,setMobileOpen:o})=>{var y;const l=`https://placehold.co/40x40/FFFFFF/3B82F6?text=${((r==null?void 0:r.displayName)||(r==null?void 0:r.email)||"U").charAt(0).toUpperCase()}`,u=e.reduce((g,_)=>{const E=_.group||"General";return g[E]||(g[E]=[]),g[E].push(_),g},{}),f=["Main","Account","Operations","Administration","Support","Information","Help & Info"],m=d.jsxs("div",{className:"h-full flex flex-col bg-gradient-to-b from-blue-700 to-blue-900 text-white shadow-2xl",children:[d.jsxs("div",{className:"p-5 pt-6 text-center border-b border-blue-600",children:[d.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-white tracking-tight",children:"AGWA"}),d.jsx("p",{className:"text-xs text-blue-200 font-light mt-0.5 italic",children:"Ensuring Clarity, Sustaining Life."})]}),d.jsx("nav",{className:"flex-grow p-3 space-y-1.5 overflow-y-auto scrollbar-thin scrollbar-thumb-blue-500 scrollbar-track-blue-800",children:f.map(g=>{const _=u[g];return _?d.jsxs("div",{className:"space-y-1.5",children:[f.length>1&&d.jsx("h3",{className:"px-3.5 pt-3 pb-1 text-xs font-semibold text-blue-300 uppercase tracking-wider",children:g}),_.map(E=>{const x=AF[E.iconName]||v2,w=t===E.section;return d.jsxs("button",{onClick:()=>{n(E.section),o&&o(!1)},className:`w-full flex items-center space-x-3 px-3.5 py-2.5 rounded-lg transition-all duration-200 ease-in-out text-sm font-medium focus:outline-none focus:ring-2 focus:ring-opacity-50 focus:ring-sky-300 group
                                            ${w?"bg-sky-500 text-white shadow-md transform scale-105 font-semibold":"text-blue-100 hover:bg-blue-600/70 hover:text-white hover:translate-x-1"}`,title:E.name,children:[d.jsx(x,{size:20,className:`${w?"text-white":"text-blue-300 group-hover:text-white transition-colors"}`}),d.jsx("span",{className:"truncate",children:E.name})]},E.section||E.name)})]},g):null})}),d.jsxs("div",{className:"p-4 border-t border-blue-600",children:[r&&d.jsxs("div",{className:"flex items-center mb-3 p-2.5 bg-blue-800/50 rounded-lg shadow-inner",children:[d.jsx("img",{src:r.photoURL||l,alt:"User",className:"h-10 w-10 rounded-full border-2 border-blue-400 object-cover bg-gray-200 flex-shrink-0",onError:g=>{g.target.onerror=null,g.target.src=l}}),d.jsxs("div",{className:"ml-3 overflow-hidden",children:[d.jsx("p",{className:"text-sm font-semibold leading-tight truncate text-white",title:r.displayName||r.email,children:r.displayName||r.email}),d.jsxs("p",{className:"text-xs text-blue-200 leading-tight capitalize truncate",title:`Role: ${r.role}`,children:["Role: ",((y=r.role)==null?void 0:y.replace("_"," "))||"N/A"]}),r.role==="customer"&&d.jsxs("p",{className:"text-xs text-blue-300 leading-tight truncate",title:`Account: ${r.accountNumber||"N/A"}`,children:["Acc: ",r.accountNumber||"N/A"]})]})]}),d.jsxs("button",{onClick:i,className:"w-full flex items-center justify-center space-x-2 bg-red-600 hover:bg-red-700 text-white font-semibold py-2.5 px-4 rounded-lg transition-all duration-150 active:scale-95 focus:outline-none focus:ring-2 focus:ring-red-400 ring-offset-2 ring-offset-blue-800",children:[d.jsx(t0,{size:20}),d.jsx("span",{children:"Logout"})]})]})]});return d.jsxs(d.Fragment,{children:[d.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-60 z-40 lg:hidden transition-opacity duration-300 ${s?"opacity-100":"opacity-0 pointer-events-none"} no-print`,onClick:()=>o(!1),"aria-hidden":"true"}),d.jsx("aside",{className:`fixed top-0 left-0 h-full w-64 z-50 transform transition-transform duration-300 ease-in-out lg:translate-x-0 ${s?"translate-x-0 shadow-xl":"-translate-x-full"} no-print`,children:m}),d.jsx("style",{children:`
                .scrollbar-thin { scrollbar-width: thin; scrollbar-color: #3b82f6 #1e40af; }
                .scrollbar-thin::-webkit-scrollbar { width: 6px; height: 6px; }
                .scrollbar-thin::-webkit-scrollbar-track { background: #1e40af; border-radius: 3px;}
                .scrollbar-thin::-webkit-scrollbar-thumb { background-color: #3b82f6; border-radius: 3px; border: 1px solid #1e40af; }
                .scrollbar-thin::-webkit-scrollbar-thumb:hover { background-color: #2563eb; }
             `})]})},NF=({title:r,value:e,icon:t,iconColor:n="text-blue-600",borderColor:i="border-blue-600",subtext:s,onClick:o,className:l=""})=>{const u="bg-white p-5 rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 ease-in-out flex items-start space-x-4 border-l-4",f=o?"cursor-pointer":"";return d.jsxs("div",{className:`${u} ${i} ${f} ${l}`,onClick:o,role:o?"button":"figure",tabIndex:o?0:-1,onKeyDown:o?m=>{(m.key==="Enter"||m.key===" ")&&o()}:void 0,children:[t&&d.jsx("div",{className:"p-2 bg-gray-100 rounded-full",children:d.jsx(t,{className:`w-7 h-7 ${n}`,"aria-hidden":"true"})}),d.jsxs("div",{className:"flex-1 overflow-hidden",children:[d.jsx("p",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider truncate",title:r,children:r}),d.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-gray-800 truncate",title:String(e),children:e}),s&&d.jsx("p",{className:"text-xs text-gray-500 mt-1 truncate",title:s,children:s})]})]})},di=is.memo(NF),pn=({size:r="h-8 w-8",color:e="text-blue-600",className:t="",message:n="",messageClassName:i="text-sm text-gray-500 mt-2"})=>d.jsxs("div",{className:`flex flex-col items-center justify-center ${t}`,children:[d.jsx(At,{className:`animate-spin ${r} ${e}`}),n&&d.jsx("p",{className:i,children:n})]}),Jl=async(r,e="llama-3.1-8b-instant")=>{throw new Error("Groq API key is missing. Please check your .env file for VITE_GROQ_API_KEY.")},kF=async(r,e)=>{const t=r.map(i=>({role:i.role==="assistant"?"assistant":"user",content:i.text})),n=[{role:"system",content:e},...t];return Jl(n,"llama-3.1-8b-instant")},PF=async({title:r,reason:e,area:t,time:n})=>Jl(),h3=async({ticketDescription:r,conversationHistory:e,draftReply:t,customerName:n})=>Jl(),CF=async({billDetails:r,charges:e,customerName:t,serviceType:n})=>(`${t}${r.monthYear}${r.amount.toFixed(2)}${Yt(r.dueDate)}${r.consumption}${r.monthYear}${e.basicCharge.toFixed(2)}${r.consumption}${n}${e.fcda.toFixed(2)}${e.environmentalCharge.toFixed(2)}${e.maintenanceServiceCharge.toFixed(2)}`,e.sewerageCharge>0&&`${e.sewerageCharge.toFixed(2)}`,`${e.vat.toFixed(2)}`,r.previousUnpaidAmount>0&&`${(r.previousUnpaidAmount||0).toFixed(2)}`,r.seniorCitizenDiscount>0&&`${(r.seniorCitizenDiscount||0).toFixed(2)}`,`${r.amount.toFixed(2)}${Yt(r.dueDate)}`,Jl()),RF=({user:r,userData:e,db:t,showNotification:n,setActiveSection:i,billingService:s})=>{const[o,l]=te.useState([]),[u,f]=te.useState(!0),[m,y]=te.useState(""),[g,_]=te.useState(0),[E,x]=te.useState(""),[w,S]=te.useState(""),[I,C]=te.useState(!1),[N,R]=te.useState(!1),B=te.useCallback(async()=>{if(!r||!r.uid||!e||!s){f(!1),y("User data or essential services are unavailable.");return}f(!0),y("");try{const D=await Nm(t,r.uid);if(D.success){const M=D.data.map(G=>{var ee;const ie=s(G.consumption,e.serviceType,e.meterSize,e.systemSettings||{}),oe=ie.totalCalculatedCharges+(G.previousUnpaidAmount||0)-(G.seniorCitizenDiscount||0);return{...G,amount:oe,calculatedCharges:ie,billDateTimestamp:(ee=G.billDate)!=null&&ee.toDate?G.billDate.toDate():new Date(G.billDate)}}).sort((G,ie)=>ie.billDateTimestamp-G.billDateTimestamp);l(M.slice(0,3));const $=M.filter(G=>G.status==="Unpaid");if($.length>0){const ie=$.sort((oe,ee)=>{var J,Y;return new Date(((J=oe.dueDate)==null?void 0:J.toDate())||0)-new Date(((Y=ee.dueDate)==null?void 0:Y.toDate())||0)})[0];_(ie.amount),x(ie.dueDate)}else _(0),x("")}else y(D.error||"Failed to fetch recent bills."),n(D.error||"Failed to fetch recent bills.","error")}catch(D){console.error("Error fetching customer dashboard data:",D);const M="An error occurred while loading your dashboard information.";y(M),n(M,"error")}f(!1)},[r,e,t,n,s]);te.useEffect(()=>{B()},[B]);const P=async()=>{C(!0),R(!0),S("");try{const D=e.serviceAddress&&e.serviceAddress.barangay?`for a household in ${e.serviceAddress.barangay}`:"for a household",G=await Jl([{role:"user",content:"You are Agie, a friendly and knowledgeable water conservation expert from AGWA. Provide a mix of 8-10 engaging items for a customer. Include practical water-saving tips, surprising water trivia/facts, and at least one local-context tip for the Philippines. Format them as a fun, easy-to-read list using markdown (e.g., using emojis like  or , and bolding for emphasis)."}]);S(G)}catch(D){const M=(D==null?void 0:D.message)||"Could not fetch water saving tips at the moment.";n(M,"error"),S("Sorry, couldn't fetch tips right now. Try checking online for general water conservation advice!")}finally{C(!1)}},k=`${g.toFixed(2)}`,F=g>0&&E?`Next Due: ${Yt(E,{month:"short",day:"numeric",year:"numeric"})}`:g===0?"All bills settled!":"",j="p-5 bg-white rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 ease-in-out text-left focus:outline-none focus:ring-2 focus:ring-opacity-75 flex flex-col items-start",O=()=>d.jsx("span",{className:"font-bold",children:""});return d.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5",children:[d.jsx(di,{title:"Account Status",value:u&&!e.accountStatus?d.jsx(At,{className:"animate-spin h-5 w-5"}):e.accountStatus||"Active",icon:eh,borderColor:"border-green-500",iconColor:"text-green-500"}),d.jsx(di,{title:"Current Balance",value:u&&g===0&&E===""?d.jsx(At,{className:"animate-spin h-5 w-5"}):k,subtext:F,icon:O,borderColor:g>0?"border-red-500":"border-green-500",iconColor:g>0?"text-red-500":"text-green-500"}),d.jsx(di,{title:"Account Number",value:e.accountNumber||"N/A",icon:Ps,borderColor:"border-blue-500",iconColor:"text-blue-500"}),d.jsx(di,{title:"Service Type",value:e.serviceType||"Residential",icon:w2,borderColor:"border-purple-500",iconColor:"text-purple-500"})]}),m&&d.jsxs("div",{className:"p-4 bg-red-50 text-red-700 border border-red-200 rounded-lg text-sm flex items-center justify-center",children:[d.jsx(Qt,{size:20,className:"mr-2"})," ",m]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[d.jsxs("div",{className:"lg:col-span-2 bg-white p-5 rounded-xl shadow-lg",children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-3 flex items-center",children:[d.jsx(Zl,{size:22,className:"mr-2 text-gray-500"}),"Recent Bills Summary"]}),u?d.jsx(pn,{message:"Loading recent bills..."}):o.length>0?d.jsxs("div",{className:"space-y-3",children:[o.map(D=>{var M;return d.jsxs("div",{className:`flex flex-col sm:flex-row justify-between items-start sm:items-center p-3.5 border rounded-lg hover:bg-gray-50/70 transition-colors duration-150 ${D.status==="Paid"?"border-green-200 bg-green-50/50":"border-yellow-200 bg-yellow-50/30"}`,children:[d.jsxs("div",{children:[d.jsxs("p",{className:"font-medium text-gray-800 text-sm",children:[D.monthYear||D.billingPeriod," - ",d.jsxs("span",{className:"font-bold",children:["",(M=D.amount)==null?void 0:M.toFixed(2)]})]}),d.jsxs("p",{className:`text-xs mt-0.5 font-semibold ${D.status==="Paid"?"text-green-600":"text-orange-600"}`,children:["Status: ",D.status," ",D.status==="Unpaid"&&`(Due: ${Yt(D.dueDate,{month:"short",day:"numeric"})})`]})]}),d.jsxs("div",{className:"flex gap-2 mt-2 sm:mt-0",children:[D.status==="Unpaid"&&d.jsx("button",{onClick:()=>i("myBills"),className:"text-xs bg-red-500 hover:bg-red-600 text-white py-1.5 px-3 rounded-md transition-all active:scale-95 font-medium",children:"Pay Now"}),d.jsx("button",{onClick:()=>i("myBills"),className:"text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 py-1.5 px-3 rounded-md transition-all font-medium",children:"View Details"})]})]},D.id)}),d.jsx("button",{onClick:()=>i("myBills"),className:"mt-3 text-sm text-blue-600 hover:text-blue-800 font-medium hover:underline",children:"View All Bills & Payment History "})]}):d.jsxs("div",{className:"text-sm text-gray-500 py-4 text-center",children:[d.jsx(kn,{size:24,className:"mx-auto mb-1 text-gray-400"}),"No recent bills to display. All up to date!"]})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("button",{onClick:()=>i("myBills"),className:`${j} focus:ring-green-500 border-l-4 border-green-500`,children:[d.jsx(JC,{size:26,className:"mb-2 text-green-500"}),d.jsx("h4",{className:"font-semibold text-green-700 text-md",children:"Pay My Bill"}),d.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"View outstanding bills and make (simulated) payments."})]}),d.jsxs("button",{onClick:()=>i("reportIssue"),className:`${j} focus:ring-orange-500 border-l-4 border-orange-500`,children:[d.jsx(Qt,{size:26,className:"mb-2 text-orange-500"}),d.jsx("h4",{className:"font-semibold text-orange-700 text-md",children:"Report an Issue"}),d.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Report leaks, service interruptions, or other concerns."})]}),d.jsxs("button",{onClick:P,className:`${j} focus:ring-teal-500 border-l-4 border-teal-500`,disabled:I,children:[d.jsxs("div",{className:"flex items-center justify-between w-full",children:[d.jsx(Os,{size:26,className:"mb-2 text-teal-500"}),I&&d.jsx(At,{className:"animate-spin text-teal-500",size:20})]}),d.jsx("h4",{className:"font-semibold text-teal-700 text-md",children:I?"Getting Tips...":" Get Water Saving Tips"}),d.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Discover ways to conserve water and save money."})]})]})]}),d.jsx(Mr,{isOpen:N,onClose:()=>R(!1),title:" Water Saving Tips by Agie",size:"lg",children:I?d.jsx("div",{className:"flex justify-center items-center h-40",children:d.jsx(pn,{message:"Agie is thinking of the best tips for you..."})}):d.jsx("div",{className:"prose prose-sm sm:prose max-w-none whitespace-pre-line p-2 leading-relaxed text-gray-700",children:w||"No tips available at the moment. Please try again!"})})]})};var f3="clover",OF=function(e){return e===3?"v3":e},m3="https://js.stripe.com",jF="".concat(m3,"/").concat(f3,"/stripe.js"),MF=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,DF=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var LF=function(e){return MF.test(e)||DF.test(e)},FF=function(){for(var e=document.querySelectorAll('script[src^="'.concat(m3,'"]')),t=0;t<e.length;t++){var n=e[t];if(LF(n.src))return n}return null},$S=function(e){var t="",n=document.createElement("script");n.src="".concat(jF).concat(t);var i=document.head||document.body;if(!i)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return i.appendChild(n),n},VF=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"8.2.0",startTime:t})},Vh=null,Lp=null,Fp=null,zF=function(e){return function(t){e(new Error("Failed to load Stripe.js",{cause:t}))}},BF=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},UF=function(e){return Vh!==null?Vh:(Vh=new Promise(function(t,n){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe){t(window.Stripe);return}try{var i=FF();if(!(i&&e)){if(!i)i=$S(e);else if(i&&Fp!==null&&Lp!==null){var s;i.removeEventListener("load",Fp),i.removeEventListener("error",Lp),(s=i.parentNode)===null||s===void 0||s.removeChild(i),i=$S(e)}}Fp=BF(t,n),Lp=zF(n),i.addEventListener("load",Fp),i.addEventListener("error",Lp)}catch(o){n(o);return}}),Vh.catch(function(t){return Vh=null,Promise.reject(t)}))},qF=function(e,t,n){if(e===null)return null;var i=t[0],s=i.match(/^pk_test/),o=OF(e.version),l=f3;s&&o!==l&&console.warn("Stripe.js@".concat(o," was loaded on the page, but @stripe/stripe-js@").concat("8.2.0"," expected Stripe.js@").concat(l,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var u=e.apply(void 0,t);return VF(u,n),u},zh,p3=!1,g3=function(){return zh||(zh=UF(null).catch(function(e){return zh=null,Promise.reject(e)}),zh)};Promise.resolve().then(function(){return g3()}).catch(function(r){p3||console.warn(r)});var HF=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];p3=!0;var i=Date.now();return g3().then(function(s){return qF(s,t,i)})};const $F=HF(void 0),WF=()=>$F,GF=async(r,e,t,n,i)=>{try{const s=DC(Vd),o=j8(s,"createStripeCheckoutSession"),l=Math.round(e*100),f=(await o({billId:r,amount:l,userEmail:t,userId:n,accountNumber:i,successUrl:`${window.location.origin}/dashboard?payment=success&session_id={CHECKOUT_SESSION_ID}`,cancelUrl:`${window.location.origin}/dashboard?payment=cancel`})).data;if(!f||!f.sessionId)throw new Error("Failed to create a checkout session.");return f.sessionId}catch(s){throw console.error("Error creating checkout session:",s),new Error(s.message||"Could not connect to payment service.")}},KF=({isOpen:r,onClose:e,billToPay:t,userData:n,showNotification:i,stripePromise:s})=>{var y;const[o,l]=te.useState(!1),[u,f]=te.useState(""),m=async()=>{if(l(!0),f(""),!s||!t||!n){f("Payment system is not initialized."),l(!1);return}try{const g=await GF(t.id,t.amount,n.email,n.uid,n.accountNumber),_=await s,{error:E}=await _.redirectToCheckout({sessionId:g});E&&(f(E.message||"Failed to redirect to Stripe."),i(E.message||"Failed to redirect to Stripe.","error"))}catch(g){f(g.message||"An error occurred while preparing your payment."),i(g.message||"An error occurred.","error")}l(!1)};return r?d.jsx(Mr,{isOpen:r,onClose:e,title:"Secure Payment with Stripe",size:"md",children:d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg text-center",children:[d.jsx("p",{className:"text-sm text-blue-700",children:"You are paying for bill:"}),d.jsx("p",{className:"font-bold text-lg text-blue-800",children:t.monthYear}),d.jsxs("div",{className:"mt-2 text-3xl font-bold text-gray-800",children:["",((y=t.amount)==null?void 0:y.toFixed(2))||"0.00"]})]}),u&&d.jsxs("div",{className:"p-3 bg-red-100 border border-red-300 text-red-700 rounded-lg text-sm flex items-center gap-2",children:[d.jsx(Qt,{size:18}),d.jsx("span",{children:u})]}),d.jsxs("div",{className:"pt-6 border-t border-gray-200",children:[d.jsx("button",{onClick:m,className:"w-full flex items-center justify-center py-3 px-4 bg-blue-600 text-white font-bold rounded-lg text-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors",disabled:o,children:o?d.jsxs(d.Fragment,{children:[d.jsx(At,{className:"animate-spin mr-2"})," Processing..."]}):d.jsxs(d.Fragment,{children:[" ",d.jsx(JC,{className:"mr-2",size:20})," Proceed to Secure Checkout"]})}),d.jsx("p",{className:"text-xs text-center text-gray-500 mt-2",children:"You will be redirected to Stripe to complete your payment."})]})]})}):null},y3=({value:r})=>{if(!r)return null;const e=n=>{const i={0:"1101100",1:"1100110",2:"1001101",3:"1011001",4:"1010011",5:"1100101",6:"1000111",7:"1011100",8:"1110100",9:"1110010","-":"1001011"},s="11010010000",o="1100011101011";let l=s;for(const u of n)i[u]&&(l+=i[u]);return l+=o,l.split("").map((u,f)=>d.jsx("div",{className:`h-full ${u==="1"?"bg-black":"bg-transparent"}`,style:{width:"2px"}},f))},t=r.replace(/[^0-9-]/g,"");return d.jsxs("div",{className:"flex flex-col items-center justify-center",children:[d.jsx("div",{className:"flex h-16 items-stretch","aria-label":`Barcode for ${t}`,children:e(t)}),d.jsx("p",{className:"tracking-widest text-xs font-mono mt-1",children:t})]})};/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:v3,setPrototypeOf:WS,isFrozen:YF,getPrototypeOf:ZF,getOwnPropertyDescriptor:QF}=Object;let{freeze:fi,seal:js,create:Mx}=Object,{apply:Dx,construct:Lx}=typeof Reflect<"u"&&Reflect;fi||(fi=function(e){return e});js||(js=function(e){return e});Dx||(Dx=function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];return e.apply(t,i)});Lx||(Lx=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new e(...n)});const Vp=mi(Array.prototype.forEach),XF=mi(Array.prototype.lastIndexOf),GS=mi(Array.prototype.pop),Bh=mi(Array.prototype.push),JF=mi(Array.prototype.splice),_g=mi(String.prototype.toLowerCase),Kv=mi(String.prototype.toString),Yv=mi(String.prototype.match),Uh=mi(String.prototype.replace),eV=mi(String.prototype.indexOf),tV=mi(String.prototype.trim),no=mi(Object.prototype.hasOwnProperty),ci=mi(RegExp.prototype.test),qh=nV(TypeError);function mi(r){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Dx(r,e,n)}}function nV(r){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Lx(r,t)}}function Vt(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_g;WS&&WS(r,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){const s=t(i);s!==i&&(YF(e)||(e[n]=s),i=s)}r[i]=!0}return r}function rV(r){for(let e=0;e<r.length;e++)no(r,e)||(r[e]=null);return r}function fa(r){const e=Mx(null);for(const[t,n]of v3(r))no(r,t)&&(Array.isArray(n)?e[t]=rV(n):n&&typeof n=="object"&&n.constructor===Object?e[t]=fa(n):e[t]=n);return e}function Hh(r,e){for(;r!==null;){const n=QF(r,e);if(n){if(n.get)return mi(n.get);if(typeof n.value=="function")return mi(n.value)}r=ZF(r)}function t(){return null}return t}const KS=fi(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Zv=fi(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Qv=fi(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),iV=fi(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Xv=fi(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),sV=fi(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),YS=fi(["#text"]),ZS=fi(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Jv=fi(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),QS=fi(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),zp=fi(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),oV=js(/\{\{[\w\W]*|[\w\W]*\}\}/gm),aV=js(/<%[\w\W]*|[\w\W]*%>/gm),lV=js(/\$\{[\w\W]*/gm),cV=js(/^data-[\-\w.\u00B7-\uFFFF]+$/),uV=js(/^aria-[\-\w]+$/),_3=js(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),dV=js(/^(?:\w+script|data):/i),hV=js(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),x3=js(/^html$/i),fV=js(/^[a-z][.\w]*(-[.\w]+)+$/i);var XS=Object.freeze({__proto__:null,ARIA_ATTR:uV,ATTR_WHITESPACE:hV,CUSTOM_ELEMENT:fV,DATA_ATTR:cV,DOCTYPE_NAME:x3,ERB_EXPR:aV,IS_ALLOWED_URI:_3,IS_SCRIPT_OR_DATA:dV,MUSTACHE_EXPR:oV,TMPLIT_EXPR:lV});const $h={element:1,text:3,progressingInstruction:7,comment:8,document:9},mV=function(){return typeof window>"u"?null:window},pV=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(n=t.getAttribute(i));const s="dompurify"+(n?"#"+n:"");try{return e.createPolicy(s,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},JS=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function b3(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:mV();const e=Ze=>b3(Ze);if(e.version="3.3.0",e.removed=[],!r||!r.document||r.document.nodeType!==$h.document||!r.Element)return e.isSupported=!1,e;let{document:t}=r;const n=t,i=n.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:l,Element:u,NodeFilter:f,NamedNodeMap:m=r.NamedNodeMap||r.MozNamedAttrMap,HTMLFormElement:y,DOMParser:g,trustedTypes:_}=r,E=u.prototype,x=Hh(E,"cloneNode"),w=Hh(E,"remove"),S=Hh(E,"nextSibling"),I=Hh(E,"childNodes"),C=Hh(E,"parentNode");if(typeof o=="function"){const Ze=t.createElement("template");Ze.content&&Ze.content.ownerDocument&&(t=Ze.content.ownerDocument)}let N,R="";const{implementation:B,createNodeIterator:P,createDocumentFragment:k,getElementsByTagName:F}=t,{importNode:j}=n;let O=JS();e.isSupported=typeof v3=="function"&&typeof C=="function"&&B&&B.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:D,ERB_EXPR:M,TMPLIT_EXPR:$,DATA_ATTR:G,ARIA_ATTR:ie,IS_SCRIPT_OR_DATA:oe,ATTR_WHITESPACE:ee,CUSTOM_ELEMENT:J}=XS;let{IS_ALLOWED_URI:Y}=XS,q=null;const Z=Vt({},[...KS,...Zv,...Qv,...Xv,...YS]);let ne=null;const se=Vt({},[...ZS,...Jv,...QS,...zp]);let le=Object.seal(Mx(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Q=null,ce=null;const me=Object.seal(Mx(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let ge=!0,Ae=!0,Ue=!1,nt=!0,et=!1,pt=!0,Et=!1,_n=!1,Wt=!1,Se=!1,Ie=!1,De=!1,Ve=!0,ke=!1;const gt="user-content-";let ft=!0,mt=!1,kt={},jt=null;const Mt=Vt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let os=null;const qt=Vt({},["audio","video","img","source","image","track"]);let jn=null;const as=Vt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Bi="http://www.w3.org/1998/Math/MathML",pi="http://www.w3.org/2000/svg",gr="http://www.w3.org/1999/xhtml";let gi=gr,ti=!1,Ui=null;const lo=Vt({},[Bi,pi,gr],Kv);let yi=Vt({},["mi","mo","mn","ms","mtext"]),Qn=Vt({},["annotation-xml"]);const ni=Vt({},["title","style","font","a","script"]);let vi=null;const _i=["application/xhtml+xml","text/html"],zo="text/html";let gn=null,xi=null;const qi=t.createElement("form"),ls=function(fe){return fe instanceof RegExp||fe instanceof Function},xn=function(){let fe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(xi&&xi===fe)){if((!fe||typeof fe!="object")&&(fe={}),fe=fa(fe),vi=_i.indexOf(fe.PARSER_MEDIA_TYPE)===-1?zo:fe.PARSER_MEDIA_TYPE,gn=vi==="application/xhtml+xml"?Kv:_g,q=no(fe,"ALLOWED_TAGS")?Vt({},fe.ALLOWED_TAGS,gn):Z,ne=no(fe,"ALLOWED_ATTR")?Vt({},fe.ALLOWED_ATTR,gn):se,Ui=no(fe,"ALLOWED_NAMESPACES")?Vt({},fe.ALLOWED_NAMESPACES,Kv):lo,jn=no(fe,"ADD_URI_SAFE_ATTR")?Vt(fa(as),fe.ADD_URI_SAFE_ATTR,gn):as,os=no(fe,"ADD_DATA_URI_TAGS")?Vt(fa(qt),fe.ADD_DATA_URI_TAGS,gn):qt,jt=no(fe,"FORBID_CONTENTS")?Vt({},fe.FORBID_CONTENTS,gn):Mt,Q=no(fe,"FORBID_TAGS")?Vt({},fe.FORBID_TAGS,gn):fa({}),ce=no(fe,"FORBID_ATTR")?Vt({},fe.FORBID_ATTR,gn):fa({}),kt=no(fe,"USE_PROFILES")?fe.USE_PROFILES:!1,ge=fe.ALLOW_ARIA_ATTR!==!1,Ae=fe.ALLOW_DATA_ATTR!==!1,Ue=fe.ALLOW_UNKNOWN_PROTOCOLS||!1,nt=fe.ALLOW_SELF_CLOSE_IN_ATTR!==!1,et=fe.SAFE_FOR_TEMPLATES||!1,pt=fe.SAFE_FOR_XML!==!1,Et=fe.WHOLE_DOCUMENT||!1,Se=fe.RETURN_DOM||!1,Ie=fe.RETURN_DOM_FRAGMENT||!1,De=fe.RETURN_TRUSTED_TYPE||!1,Wt=fe.FORCE_BODY||!1,Ve=fe.SANITIZE_DOM!==!1,ke=fe.SANITIZE_NAMED_PROPS||!1,ft=fe.KEEP_CONTENT!==!1,mt=fe.IN_PLACE||!1,Y=fe.ALLOWED_URI_REGEXP||_3,gi=fe.NAMESPACE||gr,yi=fe.MATHML_TEXT_INTEGRATION_POINTS||yi,Qn=fe.HTML_INTEGRATION_POINTS||Qn,le=fe.CUSTOM_ELEMENT_HANDLING||{},fe.CUSTOM_ELEMENT_HANDLING&&ls(fe.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(le.tagNameCheck=fe.CUSTOM_ELEMENT_HANDLING.tagNameCheck),fe.CUSTOM_ELEMENT_HANDLING&&ls(fe.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(le.attributeNameCheck=fe.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),fe.CUSTOM_ELEMENT_HANDLING&&typeof fe.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(le.allowCustomizedBuiltInElements=fe.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),et&&(Ae=!1),Ie&&(Se=!0),kt&&(q=Vt({},YS),ne=[],kt.html===!0&&(Vt(q,KS),Vt(ne,ZS)),kt.svg===!0&&(Vt(q,Zv),Vt(ne,Jv),Vt(ne,zp)),kt.svgFilters===!0&&(Vt(q,Qv),Vt(ne,Jv),Vt(ne,zp)),kt.mathMl===!0&&(Vt(q,Xv),Vt(ne,QS),Vt(ne,zp))),fe.ADD_TAGS&&(typeof fe.ADD_TAGS=="function"?me.tagCheck=fe.ADD_TAGS:(q===Z&&(q=fa(q)),Vt(q,fe.ADD_TAGS,gn))),fe.ADD_ATTR&&(typeof fe.ADD_ATTR=="function"?me.attributeCheck=fe.ADD_ATTR:(ne===se&&(ne=fa(ne)),Vt(ne,fe.ADD_ATTR,gn))),fe.ADD_URI_SAFE_ATTR&&Vt(jn,fe.ADD_URI_SAFE_ATTR,gn),fe.FORBID_CONTENTS&&(jt===Mt&&(jt=fa(jt)),Vt(jt,fe.FORBID_CONTENTS,gn)),ft&&(q["#text"]=!0),Et&&Vt(q,["html","head","body"]),q.table&&(Vt(q,["tbody"]),delete Q.tbody),fe.TRUSTED_TYPES_POLICY){if(typeof fe.TRUSTED_TYPES_POLICY.createHTML!="function")throw qh('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof fe.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw qh('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');N=fe.TRUSTED_TYPES_POLICY,R=N.createHTML("")}else N===void 0&&(N=pV(_,i)),N!==null&&typeof R=="string"&&(R=N.createHTML(""));fi&&fi(fe),xi=fe}},Fs=Vt({},[...Zv,...Qv,...iV]),Dr=Vt({},[...Xv,...sV]),Vs=function(fe){let je=C(fe);(!je||!je.tagName)&&(je={namespaceURI:gi,tagName:"template"});const Ge=_g(fe.tagName),Gt=_g(je.tagName);return Ui[fe.namespaceURI]?fe.namespaceURI===pi?je.namespaceURI===gr?Ge==="svg":je.namespaceURI===Bi?Ge==="svg"&&(Gt==="annotation-xml"||yi[Gt]):!!Fs[Ge]:fe.namespaceURI===Bi?je.namespaceURI===gr?Ge==="math":je.namespaceURI===pi?Ge==="math"&&Qn[Gt]:!!Dr[Ge]:fe.namespaceURI===gr?je.namespaceURI===pi&&!Qn[Gt]||je.namespaceURI===Bi&&!yi[Gt]?!1:!Dr[Ge]&&(ni[Ge]||!Fs[Ge]):!!(vi==="application/xhtml+xml"&&Ui[fe.namespaceURI]):!1},an=function(fe){Bh(e.removed,{element:fe});try{C(fe).removeChild(fe)}catch{w(fe)}},$e=function(fe,je){try{Bh(e.removed,{attribute:je.getAttributeNode(fe),from:je})}catch{Bh(e.removed,{attribute:null,from:je})}if(je.removeAttribute(fe),fe==="is")if(Se||Ie)try{an(je)}catch{}else try{je.setAttribute(fe,"")}catch{}},Sr=function(fe){let je=null,Ge=null;if(Wt)fe="<remove></remove>"+fe;else{const bn=Yv(fe,/^[\r\n\t ]+/);Ge=bn&&bn[0]}vi==="application/xhtml+xml"&&gi===gr&&(fe='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+fe+"</body></html>");const Gt=N?N.createHTML(fe):fe;if(gi===gr)try{je=new g().parseFromString(Gt,vi)}catch{}if(!je||!je.documentElement){je=B.createDocument(gi,"template",null);try{je.documentElement.innerHTML=ti?R:Gt}catch{}}const It=je.body||je.documentElement;return fe&&Ge&&It.insertBefore(t.createTextNode(Ge),It.childNodes[0]||null),gi===gr?F.call(je,Et?"html":"body")[0]:Et?je.documentElement:It},zs=function(fe){return P.call(fe.ownerDocument||fe,fe,f.SHOW_ELEMENT|f.SHOW_COMMENT|f.SHOW_TEXT|f.SHOW_PROCESSING_INSTRUCTION|f.SHOW_CDATA_SECTION,null)},co=function(fe){return fe instanceof y&&(typeof fe.nodeName!="string"||typeof fe.textContent!="string"||typeof fe.removeChild!="function"||!(fe.attributes instanceof m)||typeof fe.removeAttribute!="function"||typeof fe.setAttribute!="function"||typeof fe.namespaceURI!="string"||typeof fe.insertBefore!="function"||typeof fe.hasChildNodes!="function")},cs=function(fe){return typeof l=="function"&&fe instanceof l};function yr(Ze,fe,je){Vp(Ze,Ge=>{Ge.call(e,fe,je,xi)})}const Ar=function(fe){let je=null;if(yr(O.beforeSanitizeElements,fe,null),co(fe))return an(fe),!0;const Ge=gn(fe.nodeName);if(yr(O.uponSanitizeElement,fe,{tagName:Ge,allowedTags:q}),pt&&fe.hasChildNodes()&&!cs(fe.firstElementChild)&&ci(/<[/\w!]/g,fe.innerHTML)&&ci(/<[/\w!]/g,fe.textContent)||fe.nodeType===$h.progressingInstruction||pt&&fe.nodeType===$h.comment&&ci(/<[/\w]/g,fe.data))return an(fe),!0;if(!(me.tagCheck instanceof Function&&me.tagCheck(Ge))&&(!q[Ge]||Q[Ge])){if(!Q[Ge]&&Nr(Ge)&&(le.tagNameCheck instanceof RegExp&&ci(le.tagNameCheck,Ge)||le.tagNameCheck instanceof Function&&le.tagNameCheck(Ge)))return!1;if(ft&&!jt[Ge]){const Gt=C(fe)||fe.parentNode,It=I(fe)||fe.childNodes;if(It&&Gt){const bn=It.length;for(let Cn=bn-1;Cn>=0;--Cn){const Xn=x(It[Cn],!0);Xn.__removalCount=(fe.__removalCount||0)+1,Gt.insertBefore(Xn,S(fe))}}}return an(fe),!0}return fe instanceof u&&!Vs(fe)||(Ge==="noscript"||Ge==="noembed"||Ge==="noframes")&&ci(/<\/no(script|embed|frames)/i,fe.innerHTML)?(an(fe),!0):(et&&fe.nodeType===$h.text&&(je=fe.textContent,Vp([D,M,$],Gt=>{je=Uh(je,Gt," ")}),fe.textContent!==je&&(Bh(e.removed,{element:fe.cloneNode()}),fe.textContent=je)),yr(O.afterSanitizeElements,fe,null),!1)},Ir=function(fe,je,Ge){if(Ve&&(je==="id"||je==="name")&&(Ge in t||Ge in qi))return!1;if(!(Ae&&!ce[je]&&ci(G,je))){if(!(ge&&ci(ie,je))){if(!(me.attributeCheck instanceof Function&&me.attributeCheck(je,fe))){if(!ne[je]||ce[je]){if(!(Nr(fe)&&(le.tagNameCheck instanceof RegExp&&ci(le.tagNameCheck,fe)||le.tagNameCheck instanceof Function&&le.tagNameCheck(fe))&&(le.attributeNameCheck instanceof RegExp&&ci(le.attributeNameCheck,je)||le.attributeNameCheck instanceof Function&&le.attributeNameCheck(je,fe))||je==="is"&&le.allowCustomizedBuiltInElements&&(le.tagNameCheck instanceof RegExp&&ci(le.tagNameCheck,Ge)||le.tagNameCheck instanceof Function&&le.tagNameCheck(Ge))))return!1}else if(!jn[je]){if(!ci(Y,Uh(Ge,ee,""))){if(!((je==="src"||je==="xlink:href"||je==="href")&&fe!=="script"&&eV(Ge,"data:")===0&&os[fe])){if(!(Ue&&!ci(oe,Uh(Ge,ee,"")))){if(Ge)return!1}}}}}}}return!0},Nr=function(fe){return fe!=="annotation-xml"&&Yv(fe,J)},Bo=function(fe){yr(O.beforeSanitizeAttributes,fe,null);const{attributes:je}=fe;if(!je||co(fe))return;const Ge={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ne,forceKeepAttr:void 0};let Gt=je.length;for(;Gt--;){const It=je[Gt],{name:bn,namespaceURI:Cn,value:Xn}=It,$n=gn(bn),Hi=Xn;let yn=bn==="value"?Hi:tV(Hi);if(Ge.attrName=$n,Ge.attrValue=yn,Ge.keepAttr=!0,Ge.forceKeepAttr=void 0,yr(O.uponSanitizeAttribute,fe,Ge),yn=Ge.attrValue,ke&&($n==="id"||$n==="name")&&($e(bn,fe),yn=gt+yn),pt&&ci(/((--!?|])>)|<\/(style|title|textarea)/i,yn)){$e(bn,fe);continue}if($n==="attributename"&&Yv(yn,"href")){$e(bn,fe);continue}if(Ge.forceKeepAttr)continue;if(!Ge.keepAttr){$e(bn,fe);continue}if(!nt&&ci(/\/>/i,yn)){$e(bn,fe);continue}et&&Vp([D,M,$],or=>{yn=Uh(yn,or," ")});const $i=gn(fe.nodeName);if(!Ir($i,$n,yn)){$e(bn,fe);continue}if(N&&typeof _=="object"&&typeof _.getAttributeType=="function"&&!Cn)switch(_.getAttributeType($i,$n)){case"TrustedHTML":{yn=N.createHTML(yn);break}case"TrustedScriptURL":{yn=N.createScriptURL(yn);break}}if(yn!==Hi)try{Cn?fe.setAttributeNS(Cn,bn,yn):fe.setAttribute(bn,yn),co(fe)?an(fe):GS(e.removed)}catch{$e(bn,fe)}}yr(O.afterSanitizeAttributes,fe,null)},Uo=function Ze(fe){let je=null;const Ge=zs(fe);for(yr(O.beforeSanitizeShadowDOM,fe,null);je=Ge.nextNode();)yr(O.uponSanitizeShadowNode,je,null),Ar(je),Bo(je),je.content instanceof s&&Ze(je.content);yr(O.afterSanitizeShadowDOM,fe,null)};return e.sanitize=function(Ze){let fe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},je=null,Ge=null,Gt=null,It=null;if(ti=!Ze,ti&&(Ze="<!-->"),typeof Ze!="string"&&!cs(Ze))if(typeof Ze.toString=="function"){if(Ze=Ze.toString(),typeof Ze!="string")throw qh("dirty is not a string, aborting")}else throw qh("toString is not a function");if(!e.isSupported)return Ze;if(_n||xn(fe),e.removed=[],typeof Ze=="string"&&(mt=!1),mt){if(Ze.nodeName){const Xn=gn(Ze.nodeName);if(!q[Xn]||Q[Xn])throw qh("root node is forbidden and cannot be sanitized in-place")}}else if(Ze instanceof l)je=Sr("<!---->"),Ge=je.ownerDocument.importNode(Ze,!0),Ge.nodeType===$h.element&&Ge.nodeName==="BODY"||Ge.nodeName==="HTML"?je=Ge:je.appendChild(Ge);else{if(!Se&&!et&&!Et&&Ze.indexOf("<")===-1)return N&&De?N.createHTML(Ze):Ze;if(je=Sr(Ze),!je)return Se?null:De?R:""}je&&Wt&&an(je.firstChild);const bn=zs(mt?Ze:je);for(;Gt=bn.nextNode();)Ar(Gt),Bo(Gt),Gt.content instanceof s&&Uo(Gt.content);if(mt)return Ze;if(Se){if(Ie)for(It=k.call(je.ownerDocument);je.firstChild;)It.appendChild(je.firstChild);else It=je;return(ne.shadowroot||ne.shadowrootmode)&&(It=j.call(n,It,!0)),It}let Cn=Et?je.outerHTML:je.innerHTML;return Et&&q["!doctype"]&&je.ownerDocument&&je.ownerDocument.doctype&&je.ownerDocument.doctype.name&&ci(x3,je.ownerDocument.doctype.name)&&(Cn="<!DOCTYPE "+je.ownerDocument.doctype.name+`>
`+Cn),et&&Vp([D,M,$],Xn=>{Cn=Uh(Cn,Xn," ")}),N&&De?N.createHTML(Cn):Cn},e.setConfig=function(){let Ze=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};xn(Ze),_n=!0},e.clearConfig=function(){xi=null,_n=!1},e.isValidAttribute=function(Ze,fe,je){xi||xn({});const Ge=gn(Ze),Gt=gn(fe);return Ir(Ge,Gt,je)},e.addHook=function(Ze,fe){typeof fe=="function"&&Bh(O[Ze],fe)},e.removeHook=function(Ze,fe){if(fe!==void 0){const je=XF(O[Ze],fe);return je===-1?void 0:JF(O[Ze],je,1)[0]}return GS(O[Ze])},e.removeHooks=function(Ze){O[Ze]=[]},e.removeAllHooks=function(){O=JS()},e}var Do=b3();const w3=({isOpen:r,onClose:e,bill:t,userData:n,calculateBillDetails:i,showNotification:s})=>{var x,w,S,I,C,N,R,B,P,k,F,j,O,D;if(!r||!t||!n)return null;const o=t.calculatedCharges||i(t.consumption,n.serviceType,n.meterSize||'1/2"'),l=(o.totalCalculatedCharges+(t.previousUnpaidAmount||0)-(t.seniorCitizenDiscount||0)).toFixed(2),u=(x=t.billDate)!=null&&x.toDate?t.billDate.toDate():null,f=u?`${u.getFullYear()}${String(u.getMonth()+1).padStart(2,"0")}${String(u.getDate()).padStart(2,"0")}`:Date.now().toString().slice(-6),m=t.invoiceNumber||`AGWA-${(w=t.id)==null?void 0:w.slice(0,4).toUpperCase()}-${f}`,y=M=>!M||typeof M!="object"?M||"N/A":[M.street,M.barangay,M.district,"Quezon City"].filter(G=>G&&G.trim()).join(", "),g=()=>{const M=document.getElementById("invoice-content-to-print-modal-fullscreen");if(M){const $=Do.sanitize(M.innerHTML),G=window.open("","_blank","height=800,width=1000,scrollbars=yes");G.document.write("<html><head><title>AGWA Water Services - Invoice</title>"),G.document.write('<script src="https://cdn.tailwindcss.com"><\/script>'),G.document.write(`
                <style>
                    body { font-family: 'Inter', sans-serif; margin: 0; padding: 15px; font-size: 9.5pt; line-height: 1.45; color: #2d3748; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                    .invoice-container-print { max-width: 820px; margin: auto; padding: 20px; background-color: #fff; position: relative; }
                    .paid-stamp {
                        position: absolute;
                        top: 40%;
                        left: 50%;
                        transform: translate(-50%, -50%) rotate(-20deg);
                        color: #e53e3e;
                        border: 5px double #e53e3e;
                        padding: 12px 30px;
                        border-radius: 6px;
                        font-family: 'Courier New', Courier, monospace;
                        text-align: center;
                        opacity: 0.6;
                        z-index: 1000;
                        pointer-events: none;
                        filter: blur(0.5px) grayscale(10%) sepia(50%) brightness(90%) contrast(120%);
                    }
                    .paid-stamp-main { font-size: 3rem; font-weight: bold; letter-spacing: 5px; line-height: 1; text-shadow: 1px 1px 0 rgba(0,0,0,0.1); }
                    .paid-stamp-date { font-size: 0.9rem; font-weight: 600; margin-top: 8px; display: block; }
                    table { width: 100%; border-collapse: collapse; margin-bottom: 10px; position: relative; z-index: 1; }
                    td, th { border: 1px solid #e2e8f0; padding: 5px 7px; text-align: left; font-size: 9pt; vertical-align: top; }
                    th { background-color: #f7fafc; font-weight: 600; color: #4a5568; }
                    .header-logo-print { font-size: 24pt; font-weight: bold; color: #2b6cb0; margin-bottom: 0px; }
                    .header-tagline-print { font-size: 8pt; color: #4299e1; margin-top: -2px; }
                    .invoice-title-print { font-size: 20pt; font-weight: bold; text-align: center; margin-bottom: 12px; margin-top: 8px; text-transform: uppercase; color: #1a202c; }
                    .section-title-print { font-weight: bold; margin-top: 12px; margin-bottom: 4px; font-size: 11pt; border-bottom: 2px solid #4a5568; padding-bottom: 3px; color: #2c5282;}
                    .text-right-print { text-align: right; }
                    .font-bold-print { font-weight: bold; }
                    .total-due-print { font-size: 14pt; font-weight: bold; color: #c53030; }
                    hr.dashed-print { border: none; border-top: 1px dashed #a0aec0; margin: 10px 0; }
                    .footer-notes-print { font-size: 8pt; text-align: center; margin-top: 20px; padding-top: 12px; border-top: 1px solid #e2e8f0; color: #4a5568; }
                    .payment-stub-print { margin-top: 20px; padding: 12px; border: 1px dashed #718096; background-color: #f8f9fa; }
                    .no-print-in-iframe { display: none !important; }
                    @media print {
                        body { margin: 0; font-size: 9.5pt; background-color: #fff; }
                        .no-print-in-iframe { display: none !important; }
                        .invoice-container-print { border: none; box-shadow: none; padding: 0;}
                        .paid-stamp { color: #e53e3e !important; border-color: #e53e3e !important; filter: blur(0.3px) grayscale(5%) sepia(40%) brightness(90%) contrast(120%); }
                        table td, table th {font-size: 8.5pt;}
                    }
                </style>
            `),G.document.write('</head><body><div class="invoice-container-print">'),G.document.write($),G.document.write("</div></body></html>"),G.document.close(),setTimeout(()=>{G.print()},700)}else s&&s("Invoice content element not found for printing.","error")},_=({label:M,value:$,valueClass:G="text-gray-800",labelWidth:ie="w-2/5 sm:w-1/3",valueWidth:oe="w-3/5 sm:w-2/3"})=>d.jsxs("div",{className:"flex justify-between py-1.5 text-sm border-b border-gray-100 last:border-b-0 hover:bg-gray-50/50 px-1 -mx-1 rounded-sm",children:[d.jsxs("span",{className:`text-gray-500 ${ie} pr-2`,children:[M,":"]}),d.jsx("span",{className:`${oe} text-right font-medium ${G}`,children:$})]}),E=({label:M,value:$,valueClass:G="text-gray-800",isBold:ie=!1,isTotal:oe=!1})=>d.jsxs("tr",{className:`${oe?"bg-gray-100 font-semibold":"hover:bg-gray-50/50"}`,children:[d.jsx("td",{className:`py-2 px-2 ${ie?"font-semibold":""}`,children:M}),d.jsx("td",{className:`py-2 px-2 text-right ${G} ${ie?"font-semibold":""}`,children:$})]});return d.jsxs(Mr,{isOpen:r,onClose:e,title:"",size:"full",modalDialogClassName:"sm:max-w-4xl md:max-w-5xl lg:max-w-6xl xl:max-w-7xl w-[95vw] h-[95vh]",contentClassName:"p-0",children:[d.jsx("style",{children:`
                    .paid-stamp {
                        position: absolute;
                        top: 40%;
                        left: 50%;
                        transform: translate(-50%, -50%) rotate(-20deg);
                        color: #e53e3e;
                        border: 5px double #e53e3e;
                        padding: 12px 30px;
                        border-radius: 6px;
                        font-family: 'Courier New', Courier, monospace;
                        text-align: center;
                        opacity: 0.6;
                        z-index: 1000;
                        pointer-events: none;
                        filter: blur(0.5px) grayscale(10%) sepia(50%) brightness(90%) contrast(120%);
                    }
                    .paid-stamp-main { font-size: 3rem; font-weight: bold; letter-spacing: 5px; line-height: 1; text-shadow: 1px 1px 0 rgba(0,0,0,0.1); }
                    .paid-stamp-date { font-size: 0.9rem; font-weight: 600; margin-top: 8px; display: block; }
                `}),d.jsxs("div",{className:"flex justify-between items-center p-3 sm:p-4 border-b border-gray-200 bg-slate-50 rounded-t-xl sticky top-0 z-20",children:[d.jsxs("div",{className:"flex items-center",children:[d.jsx(Zl,{size:22,className:"mr-2.5 text-blue-600"}),d.jsxs("h3",{className:"text-md sm:text-lg font-semibold text-slate-800 truncate",title:m,children:["Invoice: ",m]})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsxs("button",{onClick:g,className:"p-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors flex items-center focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50",title:"Print/Download Invoice",children:[d.jsx(X9,{size:16,className:"mr-0 sm:mr-1.5"})," ",d.jsx("span",{className:"hidden sm:inline",children:"Print/Save"})]}),d.jsx("button",{onClick:e,className:"p-2 text-gray-500 hover:text-gray-700 bg-gray-200 hover:bg-gray-300 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500",title:"Close Invoice View",children:d.jsx(i0,{size:18})})]})]}),d.jsx("div",{className:"overflow-y-auto flex-grow p-1",children:d.jsxs("div",{id:"invoice-content-to-print-modal-fullscreen",className:"p-3 sm:p-5 font-sans text-gray-700 text-xs sm:text-sm bg-white shadow-lg rounded-lg max-w-4xl mx-auto my-2 relative",children:[((S=t.status)==null?void 0:S.toLowerCase())==="paid"&&d.jsxs("div",{className:"paid-stamp",children:[d.jsx("div",{className:"paid-stamp-main",children:"PAID"}),d.jsx("div",{className:"paid-stamp-date",children:Yt(t.paymentDate,{year:"numeric",month:"short",day:"numeric"})})]}),d.jsxs("div",{className:"relative z-0",children:[d.jsxs("div",{className:"flex justify-between items-start mb-5 pb-4 border-b-2 border-blue-700",children:[d.jsxs("div",{children:[d.jsx("div",{className:"header-logo-print text-3xl font-bold text-blue-700",children:"AGWA"}),d.jsx("div",{className:"header-tagline-print text-xs text-blue-600 italic",children:"Ensuring Clarity, Sustaining Life."})]}),d.jsxs("div",{className:"text-right text-xs",children:[d.jsx("div",{className:"font-semibold",children:"AGWA Water Services, Inc."}),d.jsx("div",{children:"123 Aqua Drive, Hydro Business Park"}),d.jsx("div",{children:"Quezon City, Metro Manila, Philippines 1101"}),d.jsx("div",{children:"VAT Reg. TIN: 000-123-456-789"}),d.jsx("div",{className:"no-print-in-iframe",children:"Machine Serial No.: AGWAMSN001"})]})]}),d.jsx("div",{className:"invoice-title-print text-2xl font-bold text-center mb-2 text-gray-800",children:"STATEMENT OF ACCOUNT"}),d.jsxs("div",{className:"text-center text-sm mb-5",children:["Invoice No.: ",m]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 mb-5 text-xs",children:[d.jsxs("div",{className:"border border-gray-200 p-3.5 rounded-lg bg-slate-50/60 shadow-sm",children:[d.jsx("h5",{className:"font-semibold text-slate-600 mb-2 text-sm border-b pb-1.5",children:"SERVICE INFORMATION"}),d.jsx(_,{label:"Contract Acct No.",value:n.accountNumber,valueClass:"font-bold text-slate-900"}),d.jsx(_,{label:"Account Name",value:n.displayName||n.email,valueClass:"font-bold text-slate-900"}),d.jsx(_,{label:"Service Address",value:y(n.serviceAddress)}),d.jsx(_,{label:"Meter Serial No.",value:n.meterSerialNumber||"N/A"}),d.jsx(_,{label:"Rate Class",value:n.serviceType||"Residential"})]}),d.jsxs("div",{className:"border border-gray-200 p-3.5 rounded-lg bg-slate-50/60 mt-3 md:mt-0 shadow-sm",children:[d.jsx("h5",{className:"font-semibold text-slate-600 mb-2 text-sm border-b pb-1.5",children:"BILLING SUMMARY"}),d.jsx(_,{label:"Bill Date",value:Yt(t.billDate,{year:"numeric",month:"long",day:"numeric"})||"N/A"}),d.jsx(_,{label:"Billing Period",value:t.billingPeriod||t.monthYear}),d.jsx(_,{label:"Current Reading",value:`${t.currentReading??"N/A"} m`}),d.jsx(_,{label:"Previous Reading",value:`${t.prevReading??"N/A"} m`}),d.jsx(_,{label:"Consumption",value:`${o.consumption??"N/A"} m`,valueClass:"font-bold text-slate-900"})]})]}),d.jsx("hr",{className:"my-4 border-gray-300 dashed-print"}),d.jsx("div",{className:"section-title-print text-sm font-semibold text-slate-700 mb-1.5",children:"CHARGES BREAKDOWN"}),d.jsxs("table",{className:"w-full text-xs mb-4",children:[d.jsx("thead",{className:"bg-slate-100",children:d.jsxs("tr",{children:[d.jsx("th",{className:"py-2 px-2.5 text-left",children:"Description"}),d.jsx("th",{className:"py-2 px-2.5 text-right",children:"Amount (PHP)"})]})}),d.jsxs("tbody",{children:[d.jsx(E,{label:"Basic Charge",value:(I=o.basicCharge)==null?void 0:I.toFixed(2)}),d.jsx(E,{label:"Foreign Currency Differential Adj. (FCDA)",value:(C=o.fcda)==null?void 0:C.toFixed(2)}),d.jsx(E,{label:"Water Charge (Basic + FCDA)",value:(N=o.waterCharge)==null?void 0:N.toFixed(2),isBold:!0}),d.jsx(E,{label:"Environmental Charge (EC)",value:(R=o.environmentalCharge)==null?void 0:R.toFixed(2)}),d.jsx(E,{label:"Sewerage Charge (SC)",value:(B=o.sewerageCharge)==null?void 0:B.toFixed(2)}),d.jsx(E,{label:"Maintenance Service Charge",value:(P=o.maintenanceServiceCharge)==null?void 0:P.toFixed(2)}),t.seniorCitizenDiscount>0&&d.jsx(E,{label:"Senior Citizen Discount",value:`(${parseFloat(t.seniorCitizenDiscount).toFixed(2)})`,valueClass:"text-green-600"}),d.jsx(E,{label:"SUB-TOTAL (Water & Other Charges)",value:(k=o.subTotalBeforeTaxes)==null?void 0:k.toFixed(2),isTotal:!0}),d.jsx(E,{label:"Government Taxes (Local Franchise Tax)",value:(F=o.governmentTaxes)==null?void 0:F.toFixed(2)}),d.jsx(E,{label:"VATable Sales",value:(j=o.vatableSales)==null?void 0:j.toFixed(2),isTotal:!0}),d.jsx(E,{label:"VAT (12%)",value:(O=o.vat)==null?void 0:O.toFixed(2)})]})]}),d.jsx("hr",{className:"my-4 border-gray-300 dashed-print"}),d.jsxs("div",{className:"text-xs space-y-1.5 mt-1",children:[d.jsx(_,{label:"Total Current Charges",value:`PHP ${(D=o.totalCalculatedCharges)==null?void 0:D.toFixed(2)}`,valueClass:"font-bold text-slate-900 text-sm"}),d.jsx(_,{label:"Previous Unpaid Amount",value:`PHP ${(t.previousUnpaidAmount||0).toFixed(2)}`,valueClass:`font-semibold text-sm ${(t.previousUnpaidAmount||0)>0?"text-red-600":"text-slate-800"}`}),d.jsxs("div",{className:"flex justify-between items-center py-2.5 text-lg sm:text-xl border-t-2 border-b-2 border-black my-2.5 px-1",children:[d.jsx("span",{className:"font-bold text-slate-900",children:"TOTAL AMOUNT DUE"}),d.jsxs("span",{className:"font-bold text-red-600 total-due-print",children:["",l]})]}),d.jsx(_,{label:"Payment Due Date",value:Yt(t.dueDate,{weekday:"long",year:"numeric",month:"long",day:"numeric"})||"N/A",valueClass:"font-bold text-red-700 text-sm"})]}),d.jsx("hr",{className:"my-4 border-gray-300 dashed-print"}),t.paymentHistory&&t.paymentHistory.length>0&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"section-title-print text-sm font-semibold text-slate-700 mb-1.5 mt-4",children:"PAYMENT HISTORY (This Bill)"}),d.jsxs("table",{className:"w-full text-xs mb-4",children:[d.jsx("thead",{className:"bg-slate-100",children:d.jsxs("tr",{children:[d.jsx("th",{className:"py-2 px-2.5",children:"Date"}),d.jsx("th",{className:"py-2 px-2.5",children:"Ref. No."}),d.jsx("th",{className:"py-2 px-2.5 text-right",children:"Amount Paid"})]})}),d.jsx("tbody",{children:t.paymentHistory.map((M,$)=>d.jsxs("tr",{className:"hover:bg-gray-50/50",children:[d.jsx("td",{className:"py-1.5 px-2.5",children:Yt(M.postingDate)}),d.jsx("td",{className:"py-1.5 px-2.5",children:M.referenceNo}),d.jsx("td",{className:"py-1.5 px-2.5 text-right",children:parseFloat(M.amount).toFixed(2)})]},$))})]}),d.jsx("hr",{className:"my-4 border-gray-300 dashed-print"})]}),d.jsxs("div",{className:"footer-notes-print text-xs text-center my-4 space-y-1 text-gray-600",children:[d.jsx("p",{className:"no-print-in-iframe",children:"BIR Permit No. AGWA-001-012025-000001 | Date Issued: 01/01/2025"}),d.jsx("p",{children:"Please settle your account on or before the due date to avoid disconnection and late payment penalties."}),d.jsx("p",{className:"font-semibold",children:"CUSTOMER SERVICE: 1627-AGWA | support@agwa-waterservices.com.ph"})]}),d.jsxs("div",{className:"payment-stub-print mt-5 p-3.5 border-t-2 border-dashed border-gray-500 text-xs no-print-in-iframe",children:[d.jsx("h5",{className:"font-bold text-center mb-2 text-slate-700 text-sm",children:"PAYMENT STUB (For Accredited Centers)"}),d.jsx(_,{label:"Acct. No.",value:n.accountNumber,valueClass:"font-bold"}),d.jsx(_,{label:"Acct. Name",value:n.displayName||n.email}),d.jsx(_,{label:"Invoice No.",value:m}),d.jsx(_,{label:"Amount Due",value:`${l}`,valueClass:"font-bold text-lg"}),d.jsx(_,{label:"Due Date",value:Yt(t.dueDate,{month:"long",day:"numeric",year:"numeric"}),valueClass:"font-bold"}),d.jsx("div",{className:"py-2",children:d.jsx(y3,{value:m})})]})]})]})})]})},gV=({user:r,userData:e,db:t,showNotification:n,billingService:i,systemSettings:s={}})=>{const[o,l]=te.useState([]),[u,f]=te.useState(!0),[m,y]=te.useState(""),[g,_]=te.useState(null),[E,x]=te.useState(!1),[w,S]=te.useState(null),[I,C]=te.useState(""),[N,R]=te.useState(!1),[B,P]=te.useState(null),[k,F]=te.useState(!1),{isOnlinePaymentsEnabled:j=!0}=s,O=WF(),D=JSON.stringify(s),M=JSON.stringify(e),$=te.useCallback(async()=>{f(!0),y("");const ee=JSON.parse(M);if(!(r!=null&&r.uid)||!(ee!=null&&ee.serviceType)){y("Missing user data for fetching bills."),f(!1);return}const J=await Nm(t,r.uid);if(J.success){const Y=JSON.parse(D),Z=J.data.sort((ne,se)=>{var ce,me;const le=(ce=ne.billDate)!=null&&ce.toDate?ne.billDate.toDate():new Date(0);return((me=se.billDate)!=null&&me.toDate?se.billDate.toDate():new Date(0))-le}).map(ne=>{const se=i(ne.consumption??0,ee.serviceType,ee.meterSize,Y),le=(se.totalCalculatedCharges||0)+(ne.previousUnpaidAmount||0)-(ne.seniorCitizenDiscount||0);return{...ne,amount:le,calculatedCharges:se}}).filter(ne=>ne.amount!==void 0);l(Z)}else y(J.error||"Failed to fetch your bills."),n(J.error||"Failed to fetch bills.","error");f(!1)},[t,r==null?void 0:r.uid,n,i,M,D]);te.useEffect(()=>{$()},[$]),te.useEffect(()=>{const ee=new URLSearchParams(window.location.search);ee.get("payment")==="success"&&(n("Payment successful! Your bill is being updated.","success"),$()),ee.get("payment")==="cancel"&&n("Payment was cancelled. Your bill remains unpaid.","warning")},[$,n]);const G=ee=>{_(ee),x(!0)},ie=async ee=>{if(!ee||!ee.calculatedCharges){n("Bill details unavailable for explanation.","warning");return}S(ee),C(""),R(!0);try{const J=await CF({billDetails:ee,charges:ee.calculatedCharges,customerName:e.displayName||"Valued Customer",serviceType:e.serviceType||"Residential"});C(J)}catch(J){const Y=(J==null?void 0:J.message)||"AI explanation failed.";C("<p>Sorry, an error occurred while generating the explanation. Please view the detailed invoice instead.</p>"),n(Y,"error")}finally{R(!1)}},oe=ee=>{P(ee),F(!0)};return u?d.jsx(pn,{message:"Loading your bills..."}):d.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[d.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center mb-6 pb-4 border-b border-gray-200",children:[d.jsx(Zl,{size:30,className:"mr-3 text-blue-600"})," My Bills & Payment History"]}),m&&d.jsx("div",{className:"text-red-500 bg-red-50 p-3 rounded-md text-center",children:m}),o.length===0&&!m&&d.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner",children:[d.jsx(kn,{size:48,className:"mx-auto text-gray-400 mb-4"}),d.jsx("p",{className:"text-gray-600 text-lg",children:"No billing history found."})]}),d.jsx("div",{className:"space-y-4",children:o.map(ee=>{var J;return d.jsxs("div",{className:`p-4 rounded-lg shadow-md border-l-4 ${ee.status==="Paid"?"bg-green-50 border-green-400":"bg-yellow-50 border-yellow-400"}`,children:[d.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-2",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:ee.monthYear||ee.billingPeriod||"N/A"}),d.jsxs("p",{className:"text-sm text-gray-600",children:["Due: ",Yt(ee.dueDate,{month:"long",day:"numeric"})]}),d.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Bill ID: ",ee.id.substring(0,8),"..."]})]}),d.jsxs("div",{className:"text-right",children:[d.jsxs("p",{className:"text-2xl font-bold text-gray-700",children:["",((J=ee.amount)==null?void 0:J.toFixed(2))??"0.00"]}),d.jsx("p",{className:`text-sm font-semibold ${ee.status==="Paid"?"text-green-600":"text-red-600"}`,children:ee.status||"Unknown"})]})]}),d.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200/80 flex flex-wrap gap-2 justify-end",children:[d.jsxs("button",{onClick:()=>oe(ee),className:"text-xs font-medium bg-blue-100 text-blue-700 hover:bg-blue-200 px-3 py-1.5 rounded-md transition flex items-center",children:[d.jsx(Yl,{size:14,className:"mr-1"}),"View Invoice"]}),d.jsxs("button",{onClick:()=>ie(ee),className:"text-xs font-medium bg-purple-100 text-purple-700 hover:bg-purple-200 px-3 py-1.5 rounded-md transition flex items-center",disabled:N&&(w==null?void 0:w.id)===ee.id,children:[N&&(w==null?void 0:w.id)===ee.id?d.jsx(At,{size:14,className:"animate-spin mr-1"}):d.jsx(Os,{size:14,className:"mr-1"})," Explain Bill (AI)"]}),ee.status==="Unpaid"&&j&&d.jsxs("button",{onClick:()=>G(ee),className:"text-xs font-bold bg-green-500 text-white hover:bg-green-600 px-4 py-1.5 rounded-md transition flex items-center",children:[d.jsx("span",{className:"mr-1 font-bold",children:""})," Pay Now"]})]})]},ee.id)})}),d.jsx(Mr,{isOpen:!!w,onClose:()=>S(null),title:` AI Explanation for ${(w==null?void 0:w.monthYear)||"Bill"}`,size:"lg",children:N?d.jsx(pn,{message:"Agie is analyzing your bill..."}):d.jsx("div",{className:"prose prose-sm max-w-none leading-relaxed p-2",dangerouslySetInnerHTML:{__html:Do.sanitize(I||"")}})}),E&&g&&d.jsx(KF,{isOpen:E,onClose:()=>x(!1),billToPay:g,userData:e,showNotification:n,stripePromise:O}),k&&B&&d.jsx(w3,{isOpen:k,onClose:()=>F(!1),bill:B,userData:e,calculateBillDetails:i,showNotification:n})]})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function km(r){return r+.5|0}const Rl=(r,e,t)=>Math.max(Math.min(r,t),e);function uf(r){return Rl(km(r*2.55),0,255)}function Bl(r){return Rl(km(r*255),0,255)}function ga(r){return Rl(km(r/2.55)/100,0,1)}function eA(r){return Rl(km(r*100),0,100)}const Es={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},Fx=[..."0123456789ABCDEF"],yV=r=>Fx[r&15],vV=r=>Fx[(r&240)>>4]+Fx[r&15],Bp=r=>(r&240)>>4===(r&15),_V=r=>Bp(r.r)&&Bp(r.g)&&Bp(r.b)&&Bp(r.a);function xV(r){var e=r.length,t;return r[0]==="#"&&(e===4||e===5?t={r:255&Es[r[1]]*17,g:255&Es[r[2]]*17,b:255&Es[r[3]]*17,a:e===5?Es[r[4]]*17:255}:(e===7||e===9)&&(t={r:Es[r[1]]<<4|Es[r[2]],g:Es[r[3]]<<4|Es[r[4]],b:Es[r[5]]<<4|Es[r[6]],a:e===9?Es[r[7]]<<4|Es[r[8]]:255})),t}const bV=(r,e)=>r<255?e(r):"";function wV(r){var e=_V(r)?yV:vV;return r?"#"+e(r.r)+e(r.g)+e(r.b)+bV(r.a,e):void 0}const EV=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function E3(r,e,t){const n=e*Math.min(t,1-t),i=(s,o=(s+r/30)%12)=>t-n*Math.max(Math.min(o-3,9-o,1),-1);return[i(0),i(8),i(4)]}function TV(r,e,t){const n=(i,s=(i+r/60)%6)=>t-t*e*Math.max(Math.min(s,4-s,1),0);return[n(5),n(3),n(1)]}function SV(r,e,t){const n=E3(r,1,.5);let i;for(e+t>1&&(i=1/(e+t),e*=i,t*=i),i=0;i<3;i++)n[i]*=1-e-t,n[i]+=e;return n}function AV(r,e,t,n,i){return r===i?(e-t)/n+(e<t?6:0):e===i?(t-r)/n+2:(r-e)/n+4}function I2(r){const t=r.r/255,n=r.g/255,i=r.b/255,s=Math.max(t,n,i),o=Math.min(t,n,i),l=(s+o)/2;let u,f,m;return s!==o&&(m=s-o,f=l>.5?m/(2-s-o):m/(s+o),u=AV(t,n,i,m,s),u=u*60+.5),[u|0,f||0,l]}function N2(r,e,t,n){return(Array.isArray(e)?r(e[0],e[1],e[2]):r(e,t,n)).map(Bl)}function k2(r,e,t){return N2(E3,r,e,t)}function IV(r,e,t){return N2(SV,r,e,t)}function NV(r,e,t){return N2(TV,r,e,t)}function T3(r){return(r%360+360)%360}function kV(r){const e=EV.exec(r);let t=255,n;if(!e)return;e[5]!==n&&(t=e[6]?uf(+e[5]):Bl(+e[5]));const i=T3(+e[2]),s=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?n=IV(i,s,o):e[1]==="hsv"?n=NV(i,s,o):n=k2(i,s,o),{r:n[0],g:n[1],b:n[2],a:t}}function PV(r,e){var t=I2(r);t[0]=T3(t[0]+e),t=k2(t),r.r=t[0],r.g=t[1],r.b=t[2]}function CV(r){if(!r)return;const e=I2(r),t=e[0],n=eA(e[1]),i=eA(e[2]);return r.a<255?`hsla(${t}, ${n}%, ${i}%, ${ga(r.a)})`:`hsl(${t}, ${n}%, ${i}%)`}const tA={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},nA={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function RV(){const r={},e=Object.keys(nA),t=Object.keys(tA);let n,i,s,o,l;for(n=0;n<e.length;n++){for(o=l=e[n],i=0;i<t.length;i++)s=t[i],l=l.replace(s,tA[s]);s=parseInt(nA[o],16),r[l]=[s>>16&255,s>>8&255,s&255]}return r}let Up;function OV(r){Up||(Up=RV(),Up.transparent=[0,0,0,0]);const e=Up[r.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const jV=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function MV(r){const e=jV.exec(r);let t=255,n,i,s;if(e){if(e[7]!==n){const o=+e[7];t=e[8]?uf(o):Rl(o*255,0,255)}return n=+e[1],i=+e[3],s=+e[5],n=255&(e[2]?uf(n):Rl(n,0,255)),i=255&(e[4]?uf(i):Rl(i,0,255)),s=255&(e[6]?uf(s):Rl(s,0,255)),{r:n,g:i,b:s,a:t}}}function DV(r){return r&&(r.a<255?`rgba(${r.r}, ${r.g}, ${r.b}, ${ga(r.a)})`:`rgb(${r.r}, ${r.g}, ${r.b})`)}const e1=r=>r<=.0031308?r*12.92:Math.pow(r,1/2.4)*1.055-.055,nd=r=>r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4);function LV(r,e,t){const n=nd(ga(r.r)),i=nd(ga(r.g)),s=nd(ga(r.b));return{r:Bl(e1(n+t*(nd(ga(e.r))-n))),g:Bl(e1(i+t*(nd(ga(e.g))-i))),b:Bl(e1(s+t*(nd(ga(e.b))-s))),a:r.a+t*(e.a-r.a)}}function qp(r,e,t){if(r){let n=I2(r);n[e]=Math.max(0,Math.min(n[e]+n[e]*t,e===0?360:1)),n=k2(n),r.r=n[0],r.g=n[1],r.b=n[2]}}function S3(r,e){return r&&Object.assign(e||{},r)}function rA(r){var e={r:0,g:0,b:0,a:255};return Array.isArray(r)?r.length>=3&&(e={r:r[0],g:r[1],b:r[2],a:255},r.length>3&&(e.a=Bl(r[3]))):(e=S3(r,{r:0,g:0,b:0,a:1}),e.a=Bl(e.a)),e}function FV(r){return r.charAt(0)==="r"?MV(r):kV(r)}class em{constructor(e){if(e instanceof em)return e;const t=typeof e;let n;t==="object"?n=rA(e):t==="string"&&(n=xV(e)||OV(e)||FV(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=S3(this._rgb);return e&&(e.a=ga(e.a)),e}set rgb(e){this._rgb=rA(e)}rgbString(){return this._valid?DV(this._rgb):void 0}hexString(){return this._valid?wV(this._rgb):void 0}hslString(){return this._valid?CV(this._rgb):void 0}mix(e,t){if(e){const n=this.rgb,i=e.rgb;let s;const o=t===s?.5:t,l=2*o-1,u=n.a-i.a,f=((l*u===-1?l:(l+u)/(1+l*u))+1)/2;s=1-f,n.r=255&f*n.r+s*i.r+.5,n.g=255&f*n.g+s*i.g+.5,n.b=255&f*n.b+s*i.b+.5,n.a=o*n.a+(1-o)*i.a,this.rgb=n}return this}interpolate(e,t){return e&&(this._rgb=LV(this._rgb,e._rgb,t)),this}clone(){return new em(this.rgb)}alpha(e){return this._rgb.a=Bl(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=km(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return qp(this._rgb,2,e),this}darken(e){return qp(this._rgb,2,-e),this}saturate(e){return qp(this._rgb,1,e),this}desaturate(e){return qp(this._rgb,1,-e),this}rotate(e){return PV(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function ha(){}const VV=(()=>{let r=0;return()=>r++})();function on(r){return r==null}function dr(r){if(Array.isArray&&Array.isArray(r))return!0;const e=Object.prototype.toString.call(r);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Zt(r){return r!==null&&Object.prototype.toString.call(r)==="[object Object]"}function Ms(r){return(typeof r=="number"||r instanceof Number)&&isFinite(+r)}function Eo(r,e){return Ms(r)?r:e}function Dt(r,e){return typeof r>"u"?e:r}const zV=(r,e)=>typeof r=="string"&&r.endsWith("%")?parseFloat(r)/100:+r/e,A3=(r,e)=>typeof r=="string"&&r.endsWith("%")?parseFloat(r)/100*e:+r;function Nn(r,e,t){if(r&&typeof r.call=="function")return r.apply(t,e)}function dn(r,e,t,n){let i,s,o;if(dr(r))for(s=r.length,i=0;i<s;i++)e.call(t,r[i],i);else if(Zt(r))for(o=Object.keys(r),s=o.length,i=0;i<s;i++)e.call(t,r[o[i]],o[i])}function cy(r,e){let t,n,i,s;if(!r||!e||r.length!==e.length)return!1;for(t=0,n=r.length;t<n;++t)if(i=r[t],s=e[t],i.datasetIndex!==s.datasetIndex||i.index!==s.index)return!1;return!0}function uy(r){if(dr(r))return r.map(uy);if(Zt(r)){const e=Object.create(null),t=Object.keys(r),n=t.length;let i=0;for(;i<n;++i)e[t[i]]=uy(r[t[i]]);return e}return r}function I3(r){return["__proto__","prototype","constructor"].indexOf(r)===-1}function BV(r,e,t,n){if(!I3(r))return;const i=e[r],s=t[r];Zt(i)&&Zt(s)?tm(i,s,n):e[r]=uy(s)}function tm(r,e,t){const n=dr(e)?e:[e],i=n.length;if(!Zt(r))return r;t=t||{};const s=t.merger||BV;let o;for(let l=0;l<i;++l){if(o=n[l],!Zt(o))continue;const u=Object.keys(o);for(let f=0,m=u.length;f<m;++f)s(u[f],r,o,t)}return r}function kf(r,e){return tm(r,e,{merger:UV})}function UV(r,e,t){if(!I3(r))return;const n=e[r],i=t[r];Zt(n)&&Zt(i)?kf(n,i):Object.prototype.hasOwnProperty.call(e,r)||(e[r]=uy(i))}const iA={"":r=>r,x:r=>r.x,y:r=>r.y};function qV(r){const e=r.split("."),t=[];let n="";for(const i of e)n+=i,n.endsWith("\\")?n=n.slice(0,-1)+".":(t.push(n),n="");return t}function HV(r){const e=qV(r);return t=>{for(const n of e){if(n==="")break;t=t&&t[n]}return t}}function hu(r,e){return(iA[e]||(iA[e]=HV(e)))(r)}function P2(r){return r.charAt(0).toUpperCase()+r.slice(1)}const nm=r=>typeof r<"u",ec=r=>typeof r=="function",sA=(r,e)=>{if(r.size!==e.size)return!1;for(const t of r)if(!e.has(t))return!1;return!0};function $V(r){return r.type==="mouseup"||r.type==="click"||r.type==="contextmenu"}const hn=Math.PI,qn=2*hn,WV=qn+hn,dy=Number.POSITIVE_INFINITY,GV=hn/180,fr=hn/2,Rc=hn/4,oA=hn*2/3,N3=Math.log10,jo=Math.sign;function Pf(r,e,t){return Math.abs(r-e)<t}function aA(r){const e=Math.round(r);r=Pf(r,e,r/1e3)?e:r;const t=Math.pow(10,Math.floor(N3(r))),n=r/t;return(n<=1?1:n<=2?2:n<=5?5:10)*t}function KV(r){const e=[],t=Math.sqrt(r);let n;for(n=1;n<t;n++)r%n===0&&(e.push(n),e.push(r/n));return t===(t|0)&&e.push(t),e.sort((i,s)=>i-s).pop(),e}function YV(r){return typeof r=="symbol"||typeof r=="object"&&r!==null&&!(Symbol.toPrimitive in r||"toString"in r||"valueOf"in r)}function rm(r){return!YV(r)&&!isNaN(parseFloat(r))&&isFinite(r)}function ZV(r,e){const t=Math.round(r);return t-e<=r&&t+e>=r}function QV(r,e,t){let n,i,s;for(n=0,i=r.length;n<i;n++)s=r[n][t],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function ba(r){return r*(hn/180)}function XV(r){return r*(180/hn)}function lA(r){if(!Ms(r))return;let e=1,t=0;for(;Math.round(r*e)/e!==r;)e*=10,t++;return t}function k3(r,e){const t=e.x-r.x,n=e.y-r.y,i=Math.sqrt(t*t+n*n);let s=Math.atan2(n,t);return s<-.5*hn&&(s+=qn),{angle:s,distance:i}}function Vx(r,e){return Math.sqrt(Math.pow(e.x-r.x,2)+Math.pow(e.y-r.y,2))}function JV(r,e){return(r-e+WV)%qn-hn}function io(r){return(r%qn+qn)%qn}function im(r,e,t,n){const i=io(r),s=io(e),o=io(t),l=io(s-i),u=io(o-i),f=io(i-s),m=io(i-o);return i===s||i===o||n&&s===o||l>u&&f<m}function Zr(r,e,t){return Math.max(e,Math.min(t,r))}function ez(r){return Zr(r,-32768,32767)}function Ol(r,e,t,n=1e-6){return r>=Math.min(e,t)-n&&r<=Math.max(e,t)+n}function C2(r,e,t){t=t||(o=>r[o]<e);let n=r.length-1,i=0,s;for(;n-i>1;)s=i+n>>1,t(s)?i=s:n=s;return{lo:i,hi:n}}const Wc=(r,e,t,n)=>C2(r,t,n?i=>{const s=r[i][e];return s<t||s===t&&r[i+1][e]===t}:i=>r[i][e]<t),tz=(r,e,t)=>C2(r,t,n=>r[n][e]>=t);function nz(r,e,t){let n=0,i=r.length;for(;n<i&&r[n]<e;)n++;for(;i>n&&r[i-1]>t;)i--;return n>0||i<r.length?r.slice(n,i):r}const P3=["push","pop","shift","splice","unshift"];function rz(r,e){if(r._chartjs){r._chartjs.listeners.push(e);return}Object.defineProperty(r,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),P3.forEach(t=>{const n="_onData"+P2(t),i=r[t];Object.defineProperty(r,t,{configurable:!0,enumerable:!1,value(...s){const o=i.apply(this,s);return r._chartjs.listeners.forEach(l=>{typeof l[n]=="function"&&l[n](...s)}),o}})})}function cA(r,e){const t=r._chartjs;if(!t)return;const n=t.listeners,i=n.indexOf(e);i!==-1&&n.splice(i,1),!(n.length>0)&&(P3.forEach(s=>{delete r[s]}),delete r._chartjs)}function C3(r){const e=new Set(r);return e.size===r.length?r:Array.from(e)}const R3=function(){return typeof window>"u"?function(r){return r()}:window.requestAnimationFrame}();function O3(r,e){let t=[],n=!1;return function(...i){t=i,n||(n=!0,R3.call(window,()=>{n=!1,r.apply(e,t)}))}}function iz(r,e){let t;return function(...n){return e?(clearTimeout(t),t=setTimeout(r,e,n)):r.apply(this,n),e}}const R2=r=>r==="start"?"left":r==="end"?"right":"center",Gr=(r,e,t)=>r==="start"?e:r==="end"?t:(e+t)/2,sz=(r,e,t,n)=>r===(n?"left":"right")?t:r==="center"?(e+t)/2:e;function oz(r,e,t){const n=e.length;let i=0,s=n;if(r._sorted){const{iScale:o,vScale:l,_parsed:u}=r,f=r.dataset&&r.dataset.options?r.dataset.options.spanGaps:null,m=o.axis,{min:y,max:g,minDefined:_,maxDefined:E}=o.getUserBounds();if(_){if(i=Math.min(Wc(u,m,y).lo,t?n:Wc(e,m,o.getPixelForValue(y)).lo),f){const x=u.slice(0,i+1).reverse().findIndex(w=>!on(w[l.axis]));i-=Math.max(0,x)}i=Zr(i,0,n-1)}if(E){let x=Math.max(Wc(u,o.axis,g,!0).hi+1,t?0:Wc(e,m,o.getPixelForValue(g),!0).hi+1);if(f){const w=u.slice(x-1).findIndex(S=>!on(S[l.axis]));x+=Math.max(0,w)}s=Zr(x,i,n)-i}else s=n-i}return{start:i,count:s}}function az(r){const{xScale:e,yScale:t,_scaleRanges:n}=r,i={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!n)return r._scaleRanges=i,!0;const s=n.xmin!==e.min||n.xmax!==e.max||n.ymin!==t.min||n.ymax!==t.max;return Object.assign(n,i),s}const Hp=r=>r===0||r===1,uA=(r,e,t)=>-(Math.pow(2,10*(r-=1))*Math.sin((r-e)*qn/t)),dA=(r,e,t)=>Math.pow(2,-10*r)*Math.sin((r-e)*qn/t)+1,Cf={linear:r=>r,easeInQuad:r=>r*r,easeOutQuad:r=>-r*(r-2),easeInOutQuad:r=>(r/=.5)<1?.5*r*r:-.5*(--r*(r-2)-1),easeInCubic:r=>r*r*r,easeOutCubic:r=>(r-=1)*r*r+1,easeInOutCubic:r=>(r/=.5)<1?.5*r*r*r:.5*((r-=2)*r*r+2),easeInQuart:r=>r*r*r*r,easeOutQuart:r=>-((r-=1)*r*r*r-1),easeInOutQuart:r=>(r/=.5)<1?.5*r*r*r*r:-.5*((r-=2)*r*r*r-2),easeInQuint:r=>r*r*r*r*r,easeOutQuint:r=>(r-=1)*r*r*r*r+1,easeInOutQuint:r=>(r/=.5)<1?.5*r*r*r*r*r:.5*((r-=2)*r*r*r*r+2),easeInSine:r=>-Math.cos(r*fr)+1,easeOutSine:r=>Math.sin(r*fr),easeInOutSine:r=>-.5*(Math.cos(hn*r)-1),easeInExpo:r=>r===0?0:Math.pow(2,10*(r-1)),easeOutExpo:r=>r===1?1:-Math.pow(2,-10*r)+1,easeInOutExpo:r=>Hp(r)?r:r<.5?.5*Math.pow(2,10*(r*2-1)):.5*(-Math.pow(2,-10*(r*2-1))+2),easeInCirc:r=>r>=1?r:-(Math.sqrt(1-r*r)-1),easeOutCirc:r=>Math.sqrt(1-(r-=1)*r),easeInOutCirc:r=>(r/=.5)<1?-.5*(Math.sqrt(1-r*r)-1):.5*(Math.sqrt(1-(r-=2)*r)+1),easeInElastic:r=>Hp(r)?r:uA(r,.075,.3),easeOutElastic:r=>Hp(r)?r:dA(r,.075,.3),easeInOutElastic(r){return Hp(r)?r:r<.5?.5*uA(r*2,.1125,.45):.5+.5*dA(r*2-1,.1125,.45)},easeInBack(r){return r*r*((1.70158+1)*r-1.70158)},easeOutBack(r){return(r-=1)*r*((1.70158+1)*r+1.70158)+1},easeInOutBack(r){let e=1.70158;return(r/=.5)<1?.5*(r*r*(((e*=1.525)+1)*r-e)):.5*((r-=2)*r*(((e*=1.525)+1)*r+e)+2)},easeInBounce:r=>1-Cf.easeOutBounce(1-r),easeOutBounce(r){return r<1/2.75?7.5625*r*r:r<2/2.75?7.5625*(r-=1.5/2.75)*r+.75:r<2.5/2.75?7.5625*(r-=2.25/2.75)*r+.9375:7.5625*(r-=2.625/2.75)*r+.984375},easeInOutBounce:r=>r<.5?Cf.easeInBounce(r*2)*.5:Cf.easeOutBounce(r*2-1)*.5+.5};function O2(r){if(r&&typeof r=="object"){const e=r.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function hA(r){return O2(r)?r:new em(r)}function t1(r){return O2(r)?r:new em(r).saturate(.5).darken(.1).hexString()}const lz=["x","y","borderWidth","radius","tension"],cz=["color","borderColor","backgroundColor"];function uz(r){r.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),r.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),r.set("animations",{colors:{type:"color",properties:cz},numbers:{type:"number",properties:lz}}),r.describe("animations",{_fallback:"animation"}),r.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function dz(r){r.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const fA=new Map;function hz(r,e){e=e||{};const t=r+JSON.stringify(e);let n=fA.get(t);return n||(n=new Intl.NumberFormat(r,e),fA.set(t,n)),n}function j2(r,e,t){return hz(e,t).format(r)}const fz={values(r){return dr(r)?r:""+r},numeric(r,e,t){if(r===0)return"0";const n=this.chart.options.locale;let i,s=r;if(t.length>1){const f=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(f<1e-4||f>1e15)&&(i="scientific"),s=mz(r,t)}const o=N3(Math.abs(s)),l=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),u={notation:i,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(u,this.options.ticks.format),j2(r,n,u)}};function mz(r,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&r!==Math.floor(r)&&(t=r-Math.floor(r)),t}var j3={formatters:fz};function pz(r){r.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:j3.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),r.route("scale.ticks","color","","color"),r.route("scale.grid","color","","borderColor"),r.route("scale.border","color","","borderColor"),r.route("scale.title","color","","color"),r.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),r.describe("scales",{_fallback:"scale"}),r.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const fu=Object.create(null),zx=Object.create(null);function Rf(r,e){if(!e)return r;const t=e.split(".");for(let n=0,i=t.length;n<i;++n){const s=t[n];r=r[s]||(r[s]=Object.create(null))}return r}function n1(r,e,t){return typeof e=="string"?tm(Rf(r,e),t):tm(Rf(r,""),e)}class gz{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,i)=>t1(i.backgroundColor),this.hoverBorderColor=(n,i)=>t1(i.borderColor),this.hoverColor=(n,i)=>t1(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return n1(this,e,t)}get(e){return Rf(this,e)}describe(e,t){return n1(zx,e,t)}override(e,t){return n1(fu,e,t)}route(e,t,n,i){const s=Rf(this,e),o=Rf(this,n),l="_"+t;Object.defineProperties(s,{[l]:{value:s[t],writable:!0},[t]:{enumerable:!0,get(){const u=this[l],f=o[i];return Zt(u)?Object.assign({},f,u):Dt(u,f)},set(u){this[l]=u}}})}apply(e){e.forEach(t=>t(this))}}var Yn=new gz({_scriptable:r=>!r.startsWith("on"),_indexable:r=>r!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[uz,dz,pz]);function yz(r){return!r||on(r.size)||on(r.family)?null:(r.style?r.style+" ":"")+(r.weight?r.weight+" ":"")+r.size+"px "+r.family}function mA(r,e,t,n,i){let s=e[i];return s||(s=e[i]=r.measureText(i).width,t.push(i)),s>n&&(n=s),n}function Oc(r,e,t){const n=r.currentDevicePixelRatio,i=t!==0?Math.max(t/2,.5):0;return Math.round((e-i)*n)/n+i}function pA(r,e){!e&&!r||(e=e||r.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,r.width,r.height),e.restore())}function Bx(r,e,t,n){M3(r,e,t,n,null)}function M3(r,e,t,n,i){let s,o,l,u,f,m,y,g;const _=e.pointStyle,E=e.rotation,x=e.radius;let w=(E||0)*GV;if(_&&typeof _=="object"&&(s=_.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){r.save(),r.translate(t,n),r.rotate(w),r.drawImage(_,-_.width/2,-_.height/2,_.width,_.height),r.restore();return}if(!(isNaN(x)||x<=0)){switch(r.beginPath(),_){default:i?r.ellipse(t,n,i/2,x,0,0,qn):r.arc(t,n,x,0,qn),r.closePath();break;case"triangle":m=i?i/2:x,r.moveTo(t+Math.sin(w)*m,n-Math.cos(w)*x),w+=oA,r.lineTo(t+Math.sin(w)*m,n-Math.cos(w)*x),w+=oA,r.lineTo(t+Math.sin(w)*m,n-Math.cos(w)*x),r.closePath();break;case"rectRounded":f=x*.516,u=x-f,o=Math.cos(w+Rc)*u,y=Math.cos(w+Rc)*(i?i/2-f:u),l=Math.sin(w+Rc)*u,g=Math.sin(w+Rc)*(i?i/2-f:u),r.arc(t-y,n-l,f,w-hn,w-fr),r.arc(t+g,n-o,f,w-fr,w),r.arc(t+y,n+l,f,w,w+fr),r.arc(t-g,n+o,f,w+fr,w+hn),r.closePath();break;case"rect":if(!E){u=Math.SQRT1_2*x,m=i?i/2:u,r.rect(t-m,n-u,2*m,2*u);break}w+=Rc;case"rectRot":y=Math.cos(w)*(i?i/2:x),o=Math.cos(w)*x,l=Math.sin(w)*x,g=Math.sin(w)*(i?i/2:x),r.moveTo(t-y,n-l),r.lineTo(t+g,n-o),r.lineTo(t+y,n+l),r.lineTo(t-g,n+o),r.closePath();break;case"crossRot":w+=Rc;case"cross":y=Math.cos(w)*(i?i/2:x),o=Math.cos(w)*x,l=Math.sin(w)*x,g=Math.sin(w)*(i?i/2:x),r.moveTo(t-y,n-l),r.lineTo(t+y,n+l),r.moveTo(t+g,n-o),r.lineTo(t-g,n+o);break;case"star":y=Math.cos(w)*(i?i/2:x),o=Math.cos(w)*x,l=Math.sin(w)*x,g=Math.sin(w)*(i?i/2:x),r.moveTo(t-y,n-l),r.lineTo(t+y,n+l),r.moveTo(t+g,n-o),r.lineTo(t-g,n+o),w+=Rc,y=Math.cos(w)*(i?i/2:x),o=Math.cos(w)*x,l=Math.sin(w)*x,g=Math.sin(w)*(i?i/2:x),r.moveTo(t-y,n-l),r.lineTo(t+y,n+l),r.moveTo(t+g,n-o),r.lineTo(t-g,n+o);break;case"line":o=i?i/2:Math.cos(w)*x,l=Math.sin(w)*x,r.moveTo(t-o,n-l),r.lineTo(t+o,n+l);break;case"dash":r.moveTo(t,n),r.lineTo(t+Math.cos(w)*(i?i/2:x),n+Math.sin(w)*x);break;case!1:r.closePath();break}r.fill(),e.borderWidth>0&&r.stroke()}}function sm(r,e,t){return t=t||.5,!e||r&&r.x>e.left-t&&r.x<e.right+t&&r.y>e.top-t&&r.y<e.bottom+t}function M2(r,e){r.save(),r.beginPath(),r.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),r.clip()}function D2(r){r.restore()}function vz(r,e,t,n,i){if(!e)return r.lineTo(t.x,t.y);if(i==="middle"){const s=(e.x+t.x)/2;r.lineTo(s,e.y),r.lineTo(s,t.y)}else i==="after"!=!!n?r.lineTo(e.x,t.y):r.lineTo(t.x,e.y);r.lineTo(t.x,t.y)}function _z(r,e,t,n){if(!e)return r.lineTo(t.x,t.y);r.bezierCurveTo(n?e.cp1x:e.cp2x,n?e.cp1y:e.cp2y,n?t.cp2x:t.cp1x,n?t.cp2y:t.cp1y,t.x,t.y)}function xz(r,e){e.translation&&r.translate(e.translation[0],e.translation[1]),on(e.rotation)||r.rotate(e.rotation),e.color&&(r.fillStyle=e.color),e.textAlign&&(r.textAlign=e.textAlign),e.textBaseline&&(r.textBaseline=e.textBaseline)}function bz(r,e,t,n,i){if(i.strikethrough||i.underline){const s=r.measureText(n),o=e-s.actualBoundingBoxLeft,l=e+s.actualBoundingBoxRight,u=t-s.actualBoundingBoxAscent,f=t+s.actualBoundingBoxDescent,m=i.strikethrough?(u+f)/2:f;r.strokeStyle=r.fillStyle,r.beginPath(),r.lineWidth=i.decorationWidth||2,r.moveTo(o,m),r.lineTo(l,m),r.stroke()}}function wz(r,e){const t=r.fillStyle;r.fillStyle=e.color,r.fillRect(e.left,e.top,e.width,e.height),r.fillStyle=t}function om(r,e,t,n,i,s={}){const o=dr(e)?e:[e],l=s.strokeWidth>0&&s.strokeColor!=="";let u,f;for(r.save(),r.font=i.string,xz(r,s),u=0;u<o.length;++u)f=o[u],s.backdrop&&wz(r,s.backdrop),l&&(s.strokeColor&&(r.strokeStyle=s.strokeColor),on(s.strokeWidth)||(r.lineWidth=s.strokeWidth),r.strokeText(f,t,n,s.maxWidth)),r.fillText(f,t,n,s.maxWidth),bz(r,t,n,f,s),n+=Number(i.lineHeight);r.restore()}function hy(r,e){const{x:t,y:n,w:i,h:s,radius:o}=e;r.arc(t+o.topLeft,n+o.topLeft,o.topLeft,1.5*hn,hn,!0),r.lineTo(t,n+s-o.bottomLeft),r.arc(t+o.bottomLeft,n+s-o.bottomLeft,o.bottomLeft,hn,fr,!0),r.lineTo(t+i-o.bottomRight,n+s),r.arc(t+i-o.bottomRight,n+s-o.bottomRight,o.bottomRight,fr,0,!0),r.lineTo(t+i,n+o.topRight),r.arc(t+i-o.topRight,n+o.topRight,o.topRight,0,-fr,!0),r.lineTo(t+o.topLeft,n)}const Ez=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Tz=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Sz(r,e){const t=(""+r).match(Ez);if(!t||t[1]==="normal")return e*1.2;switch(r=+t[2],t[3]){case"px":return r;case"%":r/=100;break}return e*r}const Az=r=>+r||0;function L2(r,e){const t={},n=Zt(e),i=n?Object.keys(e):e,s=Zt(r)?n?o=>Dt(r[o],r[e[o]]):o=>r[o]:()=>r;for(const o of i)t[o]=Az(s(o));return t}function D3(r){return L2(r,{top:"y",right:"x",bottom:"y",left:"x"})}function vd(r){return L2(r,["topLeft","topRight","bottomLeft","bottomRight"])}function Ds(r){const e=D3(r);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Qr(r,e){r=r||{},e=e||Yn.font;let t=Dt(r.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let n=Dt(r.style,e.style);n&&!(""+n).match(Tz)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const i={family:Dt(r.family,e.family),lineHeight:Sz(Dt(r.lineHeight,e.lineHeight),t),size:t,style:n,weight:Dt(r.weight,e.weight),string:""};return i.string=yz(i),i}function $p(r,e,t,n){let i,s,o;for(i=0,s=r.length;i<s;++i)if(o=r[i],o!==void 0&&o!==void 0)return o}function Iz(r,e,t){const{min:n,max:i}=r,s=A3(e,(i-n)/2),o=(l,u)=>t&&l===0?0:l+u;return{min:o(n,-Math.abs(s)),max:o(i,s)}}function xu(r,e){return Object.assign(Object.create(r),e)}function F2(r,e=[""],t,n,i=()=>r[0]){const s=t||r;typeof n>"u"&&(n=z3("_fallback",r));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:r,_rootScopes:s,_fallback:n,_getTarget:i,override:l=>F2([l,...r],e,s,n)};return new Proxy(o,{deleteProperty(l,u){return delete l[u],delete l._keys,delete r[0][u],!0},get(l,u){return F3(l,u,()=>Mz(u,e,r,l))},getOwnPropertyDescriptor(l,u){return Reflect.getOwnPropertyDescriptor(l._scopes[0],u)},getPrototypeOf(){return Reflect.getPrototypeOf(r[0])},has(l,u){return yA(l).includes(u)},ownKeys(l){return yA(l)},set(l,u,f){const m=l._storage||(l._storage=i());return l[u]=m[u]=f,delete l._keys,!0}})}function zd(r,e,t,n){const i={_cacheable:!1,_proxy:r,_context:e,_subProxy:t,_stack:new Set,_descriptors:L3(r,n),setContext:s=>zd(r,s,t,n),override:s=>zd(r.override(s),e,t,n)};return new Proxy(i,{deleteProperty(s,o){return delete s[o],delete r[o],!0},get(s,o,l){return F3(s,o,()=>kz(s,o,l))},getOwnPropertyDescriptor(s,o){return s._descriptors.allKeys?Reflect.has(r,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(r,o)},getPrototypeOf(){return Reflect.getPrototypeOf(r)},has(s,o){return Reflect.has(r,o)},ownKeys(){return Reflect.ownKeys(r)},set(s,o,l){return r[o]=l,delete s[o],!0}})}function L3(r,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:n=e.indexable,_allKeys:i=e.allKeys}=r;return{allKeys:i,scriptable:t,indexable:n,isScriptable:ec(t)?t:()=>t,isIndexable:ec(n)?n:()=>n}}const Nz=(r,e)=>r?r+P2(e):e,V2=(r,e)=>Zt(e)&&r!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function F3(r,e,t){if(Object.prototype.hasOwnProperty.call(r,e)||e==="constructor")return r[e];const n=t();return r[e]=n,n}function kz(r,e,t){const{_proxy:n,_context:i,_subProxy:s,_descriptors:o}=r;let l=n[e];return ec(l)&&o.isScriptable(e)&&(l=Pz(e,l,r,t)),dr(l)&&l.length&&(l=Cz(e,l,r,o.isIndexable)),V2(e,l)&&(l=zd(l,i,s&&s[e],o)),l}function Pz(r,e,t,n){const{_proxy:i,_context:s,_subProxy:o,_stack:l}=t;if(l.has(r))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+r);l.add(r);let u=e(s,o||n);return l.delete(r),V2(r,u)&&(u=z2(i._scopes,i,r,u)),u}function Cz(r,e,t,n){const{_proxy:i,_context:s,_subProxy:o,_descriptors:l}=t;if(typeof s.index<"u"&&n(r))return e[s.index%e.length];if(Zt(e[0])){const u=e,f=i._scopes.filter(m=>m!==u);e=[];for(const m of u){const y=z2(f,i,r,m);e.push(zd(y,s,o&&o[r],l))}}return e}function V3(r,e,t){return ec(r)?r(e,t):r}const Rz=(r,e)=>r===!0?e:typeof r=="string"?hu(e,r):void 0;function Oz(r,e,t,n,i){for(const s of e){const o=Rz(t,s);if(o){r.add(o);const l=V3(o._fallback,t,i);if(typeof l<"u"&&l!==t&&l!==n)return l}else if(o===!1&&typeof n<"u"&&t!==n)return null}return!1}function z2(r,e,t,n){const i=e._rootScopes,s=V3(e._fallback,t,n),o=[...r,...i],l=new Set;l.add(n);let u=gA(l,o,t,s||t,n);return u===null||typeof s<"u"&&s!==t&&(u=gA(l,o,s,u,n),u===null)?!1:F2(Array.from(l),[""],i,s,()=>jz(e,t,n))}function gA(r,e,t,n,i){for(;t;)t=Oz(r,e,t,n,i);return t}function jz(r,e,t){const n=r._getTarget();e in n||(n[e]={});const i=n[e];return dr(i)&&Zt(t)?t:i||{}}function Mz(r,e,t,n){let i;for(const s of e)if(i=z3(Nz(s,r),t),typeof i<"u")return V2(r,i)?z2(t,n,r,i):i}function z3(r,e){for(const t of e){if(!t)continue;const n=t[r];if(typeof n<"u")return n}}function yA(r){let e=r._keys;return e||(e=r._keys=Dz(r._scopes)),e}function Dz(r){const e=new Set;for(const t of r)for(const n of Object.keys(t).filter(i=>!i.startsWith("_")))e.add(n);return Array.from(e)}const Lz=Number.EPSILON||1e-14,Bd=(r,e)=>e<r.length&&!r[e].skip&&r[e],B3=r=>r==="x"?"y":"x";function Fz(r,e,t,n){const i=r.skip?e:r,s=e,o=t.skip?e:t,l=Vx(s,i),u=Vx(o,s);let f=l/(l+u),m=u/(l+u);f=isNaN(f)?0:f,m=isNaN(m)?0:m;const y=n*f,g=n*m;return{previous:{x:s.x-y*(o.x-i.x),y:s.y-y*(o.y-i.y)},next:{x:s.x+g*(o.x-i.x),y:s.y+g*(o.y-i.y)}}}function Vz(r,e,t){const n=r.length;let i,s,o,l,u,f=Bd(r,0);for(let m=0;m<n-1;++m)if(u=f,f=Bd(r,m+1),!(!u||!f)){if(Pf(e[m],0,Lz)){t[m]=t[m+1]=0;continue}i=t[m]/e[m],s=t[m+1]/e[m],l=Math.pow(i,2)+Math.pow(s,2),!(l<=9)&&(o=3/Math.sqrt(l),t[m]=i*o*e[m],t[m+1]=s*o*e[m])}}function zz(r,e,t="x"){const n=B3(t),i=r.length;let s,o,l,u=Bd(r,0);for(let f=0;f<i;++f){if(o=l,l=u,u=Bd(r,f+1),!l)continue;const m=l[t],y=l[n];o&&(s=(m-o[t])/3,l[`cp1${t}`]=m-s,l[`cp1${n}`]=y-s*e[f]),u&&(s=(u[t]-m)/3,l[`cp2${t}`]=m+s,l[`cp2${n}`]=y+s*e[f])}}function Bz(r,e="x"){const t=B3(e),n=r.length,i=Array(n).fill(0),s=Array(n);let o,l,u,f=Bd(r,0);for(o=0;o<n;++o)if(l=u,u=f,f=Bd(r,o+1),!!u){if(f){const m=f[e]-u[e];i[o]=m!==0?(f[t]-u[t])/m:0}s[o]=l?f?jo(i[o-1])!==jo(i[o])?0:(i[o-1]+i[o])/2:i[o-1]:i[o]}Vz(r,i,s),zz(r,s,e)}function Wp(r,e,t){return Math.max(Math.min(r,t),e)}function Uz(r,e){let t,n,i,s,o,l=sm(r[0],e);for(t=0,n=r.length;t<n;++t)o=s,s=l,l=t<n-1&&sm(r[t+1],e),s&&(i=r[t],o&&(i.cp1x=Wp(i.cp1x,e.left,e.right),i.cp1y=Wp(i.cp1y,e.top,e.bottom)),l&&(i.cp2x=Wp(i.cp2x,e.left,e.right),i.cp2y=Wp(i.cp2y,e.top,e.bottom)))}function qz(r,e,t,n,i){let s,o,l,u;if(e.spanGaps&&(r=r.filter(f=>!f.skip)),e.cubicInterpolationMode==="monotone")Bz(r,i);else{let f=n?r[r.length-1]:r[0];for(s=0,o=r.length;s<o;++s)l=r[s],u=Fz(f,l,r[Math.min(s+1,o-(n?0:1))%o],e.tension),l.cp1x=u.previous.x,l.cp1y=u.previous.y,l.cp2x=u.next.x,l.cp2y=u.next.y,f=l}e.capBezierPoints&&Uz(r,t)}function B2(){return typeof window<"u"&&typeof document<"u"}function U2(r){let e=r.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function fy(r,e,t){let n;return typeof r=="string"?(n=parseInt(r,10),r.indexOf("%")!==-1&&(n=n/100*e.parentNode[t])):n=r,n}const s0=r=>r.ownerDocument.defaultView.getComputedStyle(r,null);function Hz(r,e){return s0(r).getPropertyValue(e)}const $z=["top","right","bottom","left"];function Zc(r,e,t){const n={};t=t?"-"+t:"";for(let i=0;i<4;i++){const s=$z[i];n[s]=parseFloat(r[e+"-"+s+t])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const Wz=(r,e,t)=>(r>0||e>0)&&(!t||!t.shadowRoot);function Gz(r,e){const t=r.touches,n=t&&t.length?t[0]:r,{offsetX:i,offsetY:s}=n;let o=!1,l,u;if(Wz(i,s,r.target))l=i,u=s;else{const f=e.getBoundingClientRect();l=n.clientX-f.left,u=n.clientY-f.top,o=!0}return{x:l,y:u,box:o}}function Fc(r,e){if("native"in r)return r;const{canvas:t,currentDevicePixelRatio:n}=e,i=s0(t),s=i.boxSizing==="border-box",o=Zc(i,"padding"),l=Zc(i,"border","width"),{x:u,y:f,box:m}=Gz(r,t),y=o.left+(m&&l.left),g=o.top+(m&&l.top);let{width:_,height:E}=e;return s&&(_-=o.width+l.width,E-=o.height+l.height),{x:Math.round((u-y)/_*t.width/n),y:Math.round((f-g)/E*t.height/n)}}function Kz(r,e,t){let n,i;if(e===void 0||t===void 0){const s=r&&U2(r);if(!s)e=r.clientWidth,t=r.clientHeight;else{const o=s.getBoundingClientRect(),l=s0(s),u=Zc(l,"border","width"),f=Zc(l,"padding");e=o.width-f.width-u.width,t=o.height-f.height-u.height,n=fy(l.maxWidth,s,"clientWidth"),i=fy(l.maxHeight,s,"clientHeight")}}return{width:e,height:t,maxWidth:n||dy,maxHeight:i||dy}}const jl=r=>Math.round(r*10)/10;function Yz(r,e,t,n){const i=s0(r),s=Zc(i,"margin"),o=fy(i.maxWidth,r,"clientWidth")||dy,l=fy(i.maxHeight,r,"clientHeight")||dy,u=Kz(r,e,t);let{width:f,height:m}=u;if(i.boxSizing==="content-box"){const g=Zc(i,"border","width"),_=Zc(i,"padding");f-=_.width+g.width,m-=_.height+g.height}return f=Math.max(0,f-s.width),m=Math.max(0,n?f/n:m-s.height),f=jl(Math.min(f,o,u.maxWidth)),m=jl(Math.min(m,l,u.maxHeight)),f&&!m&&(m=jl(f/2)),(e!==void 0||t!==void 0)&&n&&u.height&&m>u.height&&(m=u.height,f=jl(Math.floor(m*n))),{width:f,height:m}}function vA(r,e,t){const n=e||1,i=jl(r.height*n),s=jl(r.width*n);r.height=jl(r.height),r.width=jl(r.width);const o=r.canvas;return o.style&&(t||!o.style.height&&!o.style.width)&&(o.style.height=`${r.height}px`,o.style.width=`${r.width}px`),r.currentDevicePixelRatio!==n||o.height!==i||o.width!==s?(r.currentDevicePixelRatio=n,o.height=i,o.width=s,r.ctx.setTransform(n,0,0,n,0,0),!0):!1}const Zz=function(){let r=!1;try{const e={get passive(){return r=!0,!1}};B2()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return r}();function _A(r,e){const t=Hz(r,e),n=t&&t.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function Vc(r,e,t,n){return{x:r.x+t*(e.x-r.x),y:r.y+t*(e.y-r.y)}}function Qz(r,e,t,n){return{x:r.x+t*(e.x-r.x),y:n==="middle"?t<.5?r.y:e.y:n==="after"?t<1?r.y:e.y:t>0?e.y:r.y}}function Xz(r,e,t,n){const i={x:r.cp2x,y:r.cp2y},s={x:e.cp1x,y:e.cp1y},o=Vc(r,i,t),l=Vc(i,s,t),u=Vc(s,e,t),f=Vc(o,l,t),m=Vc(l,u,t);return Vc(f,m,t)}const Jz=function(r,e){return{x(t){return r+r+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,n){return t-n},leftForLtr(t,n){return t-n}}},eB=function(){return{x(r){return r},setWidth(r){},textAlign(r){return r},xPlus(r,e){return r+e},leftForLtr(r,e){return r}}};function _d(r,e,t){return r?Jz(e,t):eB()}function U3(r,e){let t,n;(e==="ltr"||e==="rtl")&&(t=r.canvas.style,n=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),r.prevTextDirection=n)}function q3(r,e){e!==void 0&&(delete r.prevTextDirection,r.canvas.style.setProperty("direction",e[0],e[1]))}function H3(r){return r==="angle"?{between:im,compare:JV,normalize:io}:{between:Ol,compare:(e,t)=>e-t,normalize:e=>e}}function xA({start:r,end:e,count:t,loop:n,style:i}){return{start:r%t,end:e%t,loop:n&&(e-r+1)%t===0,style:i}}function tB(r,e,t){const{property:n,start:i,end:s}=t,{between:o,normalize:l}=H3(n),u=e.length;let{start:f,end:m,loop:y}=r,g,_;if(y){for(f+=u,m+=u,g=0,_=u;g<_&&o(l(e[f%u][n]),i,s);++g)f--,m--;f%=u,m%=u}return m<f&&(m+=u),{start:f,end:m,loop:y,style:r.style}}function nB(r,e,t){if(!t)return[r];const{property:n,start:i,end:s}=t,o=e.length,{compare:l,between:u,normalize:f}=H3(n),{start:m,end:y,loop:g,style:_}=tB(r,e,t),E=[];let x=!1,w=null,S,I,C;const N=()=>u(i,C,S)&&l(i,C)!==0,R=()=>l(s,S)===0||u(s,C,S),B=()=>x||N(),P=()=>!x||R();for(let k=m,F=m;k<=y;++k)I=e[k%o],!I.skip&&(S=f(I[n]),S!==C&&(x=u(S,i,s),w===null&&B()&&(w=l(S,i)===0?k:F),w!==null&&P()&&(E.push(xA({start:w,end:k,loop:g,count:o,style:_})),w=null),F=k,C=S));return w!==null&&E.push(xA({start:w,end:y,loop:g,count:o,style:_})),E}function rB(r,e){const t=[],n=r.segments;for(let i=0;i<n.length;i++){const s=nB(n[i],r.points,e);s.length&&t.push(...s)}return t}function iB(r,e,t,n){let i=0,s=e-1;if(t&&!n)for(;i<e&&!r[i].skip;)i++;for(;i<e&&r[i].skip;)i++;for(i%=e,t&&(s+=i);s>i&&r[s%e].skip;)s--;return s%=e,{start:i,end:s}}function sB(r,e,t,n){const i=r.length,s=[];let o=e,l=r[e],u;for(u=e+1;u<=t;++u){const f=r[u%i];f.skip||f.stop?l.skip||(n=!1,s.push({start:e%i,end:(u-1)%i,loop:n}),e=o=f.stop?u:null):(o=u,l.skip&&(e=u)),l=f}return o!==null&&s.push({start:e%i,end:o%i,loop:n}),s}function oB(r,e){const t=r.points,n=r.options.spanGaps,i=t.length;if(!i)return[];const s=!!r._loop,{start:o,end:l}=iB(t,i,s,n);if(n===!0)return bA(r,[{start:o,end:l,loop:s}],t,e);const u=l<o?l+i:l,f=!!r._fullLoop&&o===0&&l===i-1;return bA(r,sB(t,o,u,f),t,e)}function bA(r,e,t,n){return!n||!n.setContext||!t?e:aB(r,e,t,n)}function aB(r,e,t,n){const i=r._chart.getContext(),s=wA(r.options),{_datasetIndex:o,options:{spanGaps:l}}=r,u=t.length,f=[];let m=s,y=e[0].start,g=y;function _(E,x,w,S){const I=l?-1:1;if(E!==x){for(E+=u;t[E%u].skip;)E-=I;for(;t[x%u].skip;)x+=I;E%u!==x%u&&(f.push({start:E%u,end:x%u,loop:w,style:S}),m=S,y=x%u)}}for(const E of e){y=l?y:E.start;let x=t[y%u],w;for(g=y+1;g<=E.end;g++){const S=t[g%u];w=wA(n.setContext(xu(i,{type:"segment",p0:x,p1:S,p0DataIndex:(g-1)%u,p1DataIndex:g%u,datasetIndex:o}))),lB(w,m)&&_(y,g-1,E.loop,m),x=S,m=w}y<g-1&&_(y,g-1,E.loop,m)}return f}function wA(r){return{backgroundColor:r.backgroundColor,borderCapStyle:r.borderCapStyle,borderDash:r.borderDash,borderDashOffset:r.borderDashOffset,borderJoinStyle:r.borderJoinStyle,borderWidth:r.borderWidth,borderColor:r.borderColor}}function lB(r,e){if(!e)return!1;const t=[],n=function(i,s){return O2(s)?(t.includes(s)||t.push(s),t.indexOf(s)):s};return JSON.stringify(r,n)!==JSON.stringify(e,n)}function Gp(r,e,t){return r.options.clip?r[t]:e[t]}function cB(r,e){const{xScale:t,yScale:n}=r;return t&&n?{left:Gp(t,e,"left"),right:Gp(t,e,"right"),top:Gp(n,e,"top"),bottom:Gp(n,e,"bottom")}:e}function uB(r,e){const t=e._clip;if(t.disabled)return!1;const n=cB(e,r.chartArea);return{left:t.left===!1?0:n.left-(t.left===!0?0:t.left),right:t.right===!1?r.width:n.right+(t.right===!0?0:t.right),top:t.top===!1?0:n.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?r.height:n.bottom+(t.bottom===!0?0:t.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class dB{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,n,i){const s=t.listeners[i],o=t.duration;s.forEach(l=>l({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(n-t.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=R3.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((n,i)=>{if(!n.running||!n.items.length)return;const s=n.items;let o=s.length-1,l=!1,u;for(;o>=0;--o)u=s[o],u._active?(u._total>n.duration&&(n.duration=u._total),u.tick(e),l=!0):(s[o]=s[s.length-1],s.pop());l&&(i.draw(),this._notify(i,n,e,"progress")),s.length||(n.running=!1,this._notify(i,n,e,"complete"),n.initial=!1),t+=s.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}listen(e,t,n){this._getAnims(e).listeners[t].push(n)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((n,i)=>Math.max(n,i._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const n=t.items;let i=n.length-1;for(;i>=0;--i)n[i].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var ma=new dB;const EA="transparent",hB={boolean(r,e,t){return t>.5?e:r},color(r,e,t){const n=hA(r||EA),i=n.valid&&hA(e||EA);return i&&i.valid?i.mix(n,t).hexString():e},number(r,e,t){return r+(e-r)*t}};class fB{constructor(e,t,n,i){const s=t[n];i=$p([e.to,i,s,e.from]);const o=$p([e.from,s,i]);this._active=!0,this._fn=e.fn||hB[e.type||typeof o],this._easing=Cf[e.easing]||Cf.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=n,this._from=o,this._to=i,this._promises=void 0}active(){return this._active}update(e,t,n){if(this._active){this._notify(!1);const i=this._target[this._prop],s=n-this._start,o=this._duration-s;this._start=n,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=$p([e.to,t,i,e.from]),this._from=$p([e.from,i,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,n=this._duration,i=this._prop,s=this._from,o=this._loop,l=this._to;let u;if(this._active=s!==l&&(o||t<n),!this._active){this._target[i]=l,this._notify(!0);return}if(t<0){this._target[i]=s;return}u=t/n%2,u=o&&u>1?2-u:u,u=this._easing(Math.min(1,Math.max(0,u))),this._target[i]=this._fn(s,l,u)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,n)=>{e.push({res:t,rej:n})})}_notify(e){const t=e?"res":"rej",n=this._promises||[];for(let i=0;i<n.length;i++)n[i][t]()}}class $3{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!Zt(e))return;const t=Object.keys(Yn.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach(i=>{const s=e[i];if(!Zt(s))return;const o={};for(const l of t)o[l]=s[l];(dr(s.properties)&&s.properties||[i]).forEach(l=>{(l===i||!n.has(l))&&n.set(l,o)})})}_animateOptions(e,t){const n=t.options,i=pB(e,n);if(!i)return[];const s=this._createAnimations(i,n);return n.$shared&&mB(e.options.$animations,n).then(()=>{e.options=n},()=>{}),s}_createAnimations(e,t){const n=this._properties,i=[],s=e.$animations||(e.$animations={}),o=Object.keys(t),l=Date.now();let u;for(u=o.length-1;u>=0;--u){const f=o[u];if(f.charAt(0)==="$")continue;if(f==="options"){i.push(...this._animateOptions(e,t));continue}const m=t[f];let y=s[f];const g=n.get(f);if(y)if(g&&y.active()){y.update(g,m,l);continue}else y.cancel();if(!g||!g.duration){e[f]=m;continue}s[f]=y=new fB(g,e,f,m),i.push(y)}return i}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const n=this._createAnimations(e,t);if(n.length)return ma.add(this._chart,n),!0}}function mB(r,e){const t=[],n=Object.keys(e);for(let i=0;i<n.length;i++){const s=r[n[i]];s&&s.active()&&t.push(s.wait())}return Promise.all(t)}function pB(r,e){if(!e)return;let t=r.options;if(!t){r.options=e;return}return t.$shared&&(r.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function TA(r,e){const t=r&&r.options||{},n=t.reverse,i=t.min===void 0?e:0,s=t.max===void 0?e:0;return{start:n?s:i,end:n?i:s}}function gB(r,e,t){if(t===!1)return!1;const n=TA(r,t),i=TA(e,t);return{top:i.end,right:n.end,bottom:i.start,left:n.start}}function yB(r){let e,t,n,i;return Zt(r)?(e=r.top,t=r.right,n=r.bottom,i=r.left):e=t=n=i=r,{top:e,right:t,bottom:n,left:i,disabled:r===!1}}function W3(r,e){const t=[],n=r._getSortedDatasetMetas(e);let i,s;for(i=0,s=n.length;i<s;++i)t.push(n[i].index);return t}function SA(r,e,t,n={}){const i=r.keys,s=n.mode==="single";let o,l,u,f;if(e===null)return;let m=!1;for(o=0,l=i.length;o<l;++o){if(u=+i[o],u===t){if(m=!0,n.all)continue;break}f=r.values[u],Ms(f)&&(s||e===0||jo(e)===jo(f))&&(e+=f)}return!m&&!n.all?0:e}function vB(r,e){const{iScale:t,vScale:n}=e,i=t.axis==="x"?"x":"y",s=n.axis==="x"?"x":"y",o=Object.keys(r),l=new Array(o.length);let u,f,m;for(u=0,f=o.length;u<f;++u)m=o[u],l[u]={[i]:m,[s]:r[m]};return l}function r1(r,e){const t=r&&r.options.stacked;return t||t===void 0&&e.stack!==void 0}function _B(r,e,t){return`${r.id}.${e.id}.${t.stack||t.type}`}function xB(r){const{min:e,max:t,minDefined:n,maxDefined:i}=r.getUserBounds();return{min:n?e:Number.NEGATIVE_INFINITY,max:i?t:Number.POSITIVE_INFINITY}}function bB(r,e,t){const n=r[e]||(r[e]={});return n[t]||(n[t]={})}function AA(r,e,t,n){for(const i of e.getMatchingVisibleMetas(n).reverse()){const s=r[i.index];if(t&&s>0||!t&&s<0)return i.index}return null}function IA(r,e){const{chart:t,_cachedMeta:n}=r,i=t._stacks||(t._stacks={}),{iScale:s,vScale:o,index:l}=n,u=s.axis,f=o.axis,m=_B(s,o,n),y=e.length;let g;for(let _=0;_<y;++_){const E=e[_],{[u]:x,[f]:w}=E,S=E._stacks||(E._stacks={});g=S[f]=bB(i,m,x),g[l]=w,g._top=AA(g,o,!0,n.type),g._bottom=AA(g,o,!1,n.type);const I=g._visualValues||(g._visualValues={});I[l]=w}}function i1(r,e){const t=r.scales;return Object.keys(t).filter(n=>t[n].axis===e).shift()}function wB(r,e){return xu(r,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function EB(r,e,t){return xu(r,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function Wh(r,e){const t=r.controller.index,n=r.vScale&&r.vScale.axis;if(n){e=e||r._parsed;for(const i of e){const s=i._stacks;if(!s||s[n]===void 0||s[n][t]===void 0)return;delete s[n][t],s[n]._visualValues!==void 0&&s[n]._visualValues[t]!==void 0&&delete s[n]._visualValues[t]}}}const s1=r=>r==="reset"||r==="none",NA=(r,e)=>e?r:Object.assign({},r),TB=(r,e,t)=>r&&!e.hidden&&e._stacked&&{keys:W3(t,!0),values:null};class Qc{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=r1(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Wh(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,n=this.getDataset(),i=(y,g,_,E)=>y==="x"?g:y==="r"?E:_,s=t.xAxisID=Dt(n.xAxisID,i1(e,"x")),o=t.yAxisID=Dt(n.yAxisID,i1(e,"y")),l=t.rAxisID=Dt(n.rAxisID,i1(e,"r")),u=t.indexAxis,f=t.iAxisID=i(u,s,o,l),m=t.vAxisID=i(u,o,s,l);t.xScale=this.getScaleForId(s),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(l),t.iScale=this.getScaleForId(f),t.vScale=this.getScaleForId(m)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&cA(this._data,this),e._stacked&&Wh(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),n=this._data;if(Zt(t)){const i=this._cachedMeta;this._data=vB(t,i)}else if(n!==t){if(n){cA(n,this);const i=this._cachedMeta;Wh(i),i._parsed=[]}t&&Object.isExtensible(t)&&rz(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,n=this.getDataset();let i=!1;this._dataCheck();const s=t._stacked;t._stacked=r1(t.vScale,t),t.stack!==n.stack&&(i=!0,Wh(t),t.stack=n.stack),this._resyncElements(e),(i||s!==t._stacked)&&(IA(this,t._parsed),t._stacked=r1(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:n,_data:i}=this,{iScale:s,_stacked:o}=n,l=s.axis;let u=e===0&&t===i.length?!0:n._sorted,f=e>0&&n._parsed[e-1],m,y,g;if(this._parsing===!1)n._parsed=i,n._sorted=!0,g=i;else{dr(i[e])?g=this.parseArrayData(n,i,e,t):Zt(i[e])?g=this.parseObjectData(n,i,e,t):g=this.parsePrimitiveData(n,i,e,t);const _=()=>y[l]===null||f&&y[l]<f[l];for(m=0;m<t;++m)n._parsed[m+e]=y=g[m],u&&(_()&&(u=!1),f=y);n._sorted=u}o&&IA(this,g)}parsePrimitiveData(e,t,n,i){const{iScale:s,vScale:o}=e,l=s.axis,u=o.axis,f=s.getLabels(),m=s===o,y=new Array(i);let g,_,E;for(g=0,_=i;g<_;++g)E=g+n,y[g]={[l]:m||s.parse(f[E],E),[u]:o.parse(t[E],E)};return y}parseArrayData(e,t,n,i){const{xScale:s,yScale:o}=e,l=new Array(i);let u,f,m,y;for(u=0,f=i;u<f;++u)m=u+n,y=t[m],l[u]={x:s.parse(y[0],m),y:o.parse(y[1],m)};return l}parseObjectData(e,t,n,i){const{xScale:s,yScale:o}=e,{xAxisKey:l="x",yAxisKey:u="y"}=this._parsing,f=new Array(i);let m,y,g,_;for(m=0,y=i;m<y;++m)g=m+n,_=t[g],f[m]={x:s.parse(hu(_,l),g),y:o.parse(hu(_,u),g)};return f}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,n){const i=this.chart,s=this._cachedMeta,o=t[e.axis],l={keys:W3(i,!0),values:t._stacks[e.axis]._visualValues};return SA(l,o,s.index,{mode:n})}updateRangeFromParsed(e,t,n,i){const s=n[t.axis];let o=s===null?NaN:s;const l=i&&n._stacks[t.axis];i&&l&&(i.values=l,o=SA(i,s,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const n=this._cachedMeta,i=n._parsed,s=n._sorted&&e===n.iScale,o=i.length,l=this._getOtherScale(e),u=TB(t,n,this.chart),f={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:m,max:y}=xB(l);let g,_;function E(){_=i[g];const x=_[l.axis];return!Ms(_[e.axis])||m>x||y<x}for(g=0;g<o&&!(!E()&&(this.updateRangeFromParsed(f,e,_,u),s));++g);if(s){for(g=o-1;g>=0;--g)if(!E()){this.updateRangeFromParsed(f,e,_,u);break}}return f}getAllParsedValues(e){const t=this._cachedMeta._parsed,n=[];let i,s,o;for(i=0,s=t.length;i<s;++i)o=t[i][e.axis],Ms(o)&&n.push(o);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,n=t.iScale,i=t.vScale,s=this.getParsed(e);return{label:n?""+n.getLabelForValue(s[n.axis]):"",value:i?""+i.getLabelForValue(s[i.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=yB(Dt(this.options.clip,gB(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,n=this._cachedMeta,i=n.data||[],s=t.chartArea,o=[],l=this._drawStart||0,u=this._drawCount||i.length-l,f=this.options.drawActiveElementsOnTop;let m;for(n.dataset&&n.dataset.draw(e,s,l,u),m=l;m<l+u;++m){const y=i[m];y.hidden||(y.active&&f?o.push(y):y.draw(e,s))}for(m=0;m<o.length;++m)o[m].draw(e,s)}getStyle(e,t){const n=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,t,n){const i=this.getDataset();let s;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];s=o.$context||(o.$context=EB(this.getContext(),e,o)),s.parsed=this.getParsed(e),s.raw=i.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=wB(this.chart.getContext(),this.index)),s.dataset=i,s.index=s.datasetIndex=this.index;return s.active=!!t,s.mode=n,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",n){const i=t==="active",s=this._cachedDataOpts,o=e+"-"+t,l=s[o],u=this.enableOptionSharing&&nm(n);if(l)return NA(l,u);const f=this.chart.config,m=f.datasetElementScopeKeys(this._type,e),y=i?[`${e}Hover`,"hover",e,""]:[e,""],g=f.getOptionScopes(this.getDataset(),m),_=Object.keys(Yn.elements[e]),E=()=>this.getContext(n,i,t),x=f.resolveNamedOptions(g,_,E,y);return x.$shared&&(x.$shared=u,s[o]=Object.freeze(NA(x,u))),x}_resolveAnimations(e,t,n){const i=this.chart,s=this._cachedDataOpts,o=`animation-${t}`,l=s[o];if(l)return l;let u;if(i.options.animation!==!1){const m=this.chart.config,y=m.datasetAnimationScopeKeys(this._type,t),g=m.getOptionScopes(this.getDataset(),y);u=m.createResolver(g,this.getContext(e,n,t))}const f=new $3(i,u&&u.animations);return u&&u._cacheable&&(s[o]=Object.freeze(f)),f}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||s1(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const n=this.resolveDataElementOptions(e,t),i=this._sharedOptions,s=this.getSharedOptions(n),o=this.includeOptions(t,s)||s!==i;return this.updateSharedOptions(s,t,n),{sharedOptions:s,includeOptions:o}}updateElement(e,t,n,i){s1(i)?Object.assign(e,n):this._resolveAnimations(t,i).update(e,n)}updateSharedOptions(e,t,n){e&&!s1(t)&&this._resolveAnimations(void 0,t).update(e,n)}_setStyle(e,t,n,i){e.active=i;const s=this.getStyle(t,i);this._resolveAnimations(t,n,i).update(e,{options:!i&&this.getSharedOptions(s)||s})}removeHoverStyle(e,t,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,t,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,n=this._cachedMeta.data;for(const[l,u,f]of this._syncList)this[l](u,f);this._syncList=[];const i=n.length,s=t.length,o=Math.min(s,i);o&&this.parse(0,o),s>i?this._insertElements(i,s-i,e):s<i&&this._removeElements(s,i-s)}_insertElements(e,t,n=!0){const i=this._cachedMeta,s=i.data,o=e+t;let l;const u=f=>{for(f.length+=t,l=f.length-1;l>=o;l--)f[l]=f[l-t]};for(u(s),l=e;l<o;++l)s[l]=new this.dataElementType;this._parsing&&u(i._parsed),this.parse(e,t),n&&this.updateElements(s,e,t,"reset")}updateElements(e,t,n,i){}_removeElements(e,t){const n=this._cachedMeta;if(this._parsing){const i=n._parsed.splice(e,t);n._stacked&&Wh(n,i)}n.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,n,i]=e;this[t](n,i)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Xe(Qc,"defaults",{}),Xe(Qc,"datasetElementType",null),Xe(Qc,"dataElementType",null);function SB(r,e){if(!r._cache.$bar){const t=r.getMatchingVisibleMetas(e);let n=[];for(let i=0,s=t.length;i<s;i++)n=n.concat(t[i].controller.getAllParsedValues(r));r._cache.$bar=C3(n.sort((i,s)=>i-s))}return r._cache.$bar}function AB(r){const e=r.iScale,t=SB(e,r.type);let n=e._length,i,s,o,l;const u=()=>{o===32767||o===-32768||(nm(l)&&(n=Math.min(n,Math.abs(o-l)||n)),l=o)};for(i=0,s=t.length;i<s;++i)o=e.getPixelForValue(t[i]),u();for(l=void 0,i=0,s=e.ticks.length;i<s;++i)o=e.getPixelForTick(i),u();return n}function IB(r,e,t,n){const i=t.barThickness;let s,o;return on(i)?(s=e.min*t.categoryPercentage,o=t.barPercentage):(s=i*n,o=1),{chunk:s/n,ratio:o,start:e.pixels[r]-s/2}}function NB(r,e,t,n){const i=e.pixels,s=i[r];let o=r>0?i[r-1]:null,l=r<i.length-1?i[r+1]:null;const u=t.categoryPercentage;o===null&&(o=s-(l===null?e.end-e.start:l-s)),l===null&&(l=s+s-o);const f=s-(s-Math.min(o,l))/2*u;return{chunk:Math.abs(l-o)/2*u/n,ratio:t.barPercentage,start:f}}function kB(r,e,t,n){const i=t.parse(r[0],n),s=t.parse(r[1],n),o=Math.min(i,s),l=Math.max(i,s);let u=o,f=l;Math.abs(o)>Math.abs(l)&&(u=l,f=o),e[t.axis]=f,e._custom={barStart:u,barEnd:f,start:i,end:s,min:o,max:l}}function G3(r,e,t,n){return dr(r)?kB(r,e,t,n):e[t.axis]=t.parse(r,n),e}function kA(r,e,t,n){const i=r.iScale,s=r.vScale,o=i.getLabels(),l=i===s,u=[];let f,m,y,g;for(f=t,m=t+n;f<m;++f)g=e[f],y={},y[i.axis]=l||i.parse(o[f],f),u.push(G3(g,y,s,f));return u}function o1(r){return r&&r.barStart!==void 0&&r.barEnd!==void 0}function PB(r,e,t){return r!==0?jo(r):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function CB(r){let e,t,n,i,s;return r.horizontal?(e=r.base>r.x,t="left",n="right"):(e=r.base<r.y,t="bottom",n="top"),e?(i="end",s="start"):(i="start",s="end"),{start:t,end:n,reverse:e,top:i,bottom:s}}function RB(r,e,t,n){let i=e.borderSkipped;const s={};if(!i){r.borderSkipped=s;return}if(i===!0){r.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:l,reverse:u,top:f,bottom:m}=CB(r);i==="middle"&&t&&(r.enableBorderRadius=!0,(t._top||0)===n?i=f:(t._bottom||0)===n?i=m:(s[PA(m,o,l,u)]=!0,i=f)),s[PA(i,o,l,u)]=!0,r.borderSkipped=s}function PA(r,e,t,n){return n?(r=OB(r,e,t),r=CA(r,t,e)):r=CA(r,e,t),r}function OB(r,e,t){return r===e?t:r===t?e:r}function CA(r,e,t){return r==="start"?e:r==="end"?t:r}function jB(r,{inflateAmount:e},t){r.inflateAmount=e==="auto"?t===1?.33:0:e}class xg extends Qc{parsePrimitiveData(e,t,n,i){return kA(e,t,n,i)}parseArrayData(e,t,n,i){return kA(e,t,n,i)}parseObjectData(e,t,n,i){const{iScale:s,vScale:o}=e,{xAxisKey:l="x",yAxisKey:u="y"}=this._parsing,f=s.axis==="x"?l:u,m=o.axis==="x"?l:u,y=[];let g,_,E,x;for(g=n,_=n+i;g<_;++g)x=t[g],E={},E[s.axis]=s.parse(hu(x,f),g),y.push(G3(hu(x,m),E,o,g));return y}updateRangeFromParsed(e,t,n,i){super.updateRangeFromParsed(e,t,n,i);const s=n._custom;s&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,s.min),e.max=Math.max(e.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:n,vScale:i}=t,s=this.getParsed(e),o=s._custom,l=o1(o)?"["+o.start+", "+o.end+"]":""+i.getLabelForValue(s[i.axis]);return{label:""+n.getLabelForValue(s[n.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,n,i){const s=i==="reset",{index:o,_cachedMeta:{vScale:l}}=this,u=l.getBasePixel(),f=l.isHorizontal(),m=this._getRuler(),{sharedOptions:y,includeOptions:g}=this._getSharedOptions(t,i);for(let _=t;_<t+n;_++){const E=this.getParsed(_),x=s||on(E[l.axis])?{base:u,head:u}:this._calculateBarValuePixels(_),w=this._calculateBarIndexPixels(_,m),S=(E._stacks||{})[l.axis],I={horizontal:f,base:x.base,enableBorderRadius:!S||o1(E._custom)||o===S._top||o===S._bottom,x:f?x.head:w.center,y:f?w.center:x.head,height:f?w.size:Math.abs(x.size),width:f?Math.abs(x.size):w.size};g&&(I.options=y||this.resolveDataElementOptions(_,e[_].active?"active":i));const C=I.options||e[_].options;RB(I,C,S,o),jB(I,C,m.ratio),this.updateElement(e[_],_,I,i)}}_getStacks(e,t){const{iScale:n}=this._cachedMeta,i=n.getMatchingVisibleMetas(this._type).filter(m=>m.controller.options.grouped),s=n.options.stacked,o=[],l=this._cachedMeta.controller.getParsed(t),u=l&&l[n.axis],f=m=>{const y=m._parsed.find(_=>_[n.axis]===u),g=y&&y[m.vScale.axis];if(on(g)||isNaN(g))return!0};for(const m of i)if(!(t!==void 0&&f(m))&&((s===!1||o.indexOf(m.stack)===-1||s===void 0&&m.stack===void 0)&&o.push(m.stack),m.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(n=>e[n].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const n of this.chart.data.datasets)e[Dt(this.chart.options.indexAxis==="x"?n.xAxisID:n.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,n){const i=this._getStacks(e,n),s=t!==void 0?i.indexOf(t):-1;return s===-1?i.length-1:s}_getRuler(){const e=this.options,t=this._cachedMeta,n=t.iScale,i=[];let s,o;for(s=0,o=t.data.length;s<o;++s)i.push(n.getPixelForValue(this.getParsed(s)[n.axis],s));const l=e.barThickness;return{min:l||AB(t),pixels:i,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:e.grouped,ratio:l?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:n,index:i},options:{base:s,minBarLength:o}}=this,l=s||0,u=this.getParsed(e),f=u._custom,m=o1(f);let y=u[t.axis],g=0,_=n?this.applyStack(t,u,n):y,E,x;_!==y&&(g=_-y,_=y),m&&(y=f.barStart,_=f.barEnd-f.barStart,y!==0&&jo(y)!==jo(f.barEnd)&&(g=0),g+=y);const w=!on(s)&&!m?s:g;let S=t.getPixelForValue(w);if(this.chart.getDataVisibility(e)?E=t.getPixelForValue(g+_):E=S,x=E-S,Math.abs(x)<o){x=PB(x,t,l)*o,y===l&&(S-=x/2);const I=t.getPixelForDecimal(0),C=t.getPixelForDecimal(1),N=Math.min(I,C),R=Math.max(I,C);S=Math.max(Math.min(S,R),N),E=S+x,n&&!m&&(u._stacks[t.axis]._visualValues[i]=t.getValueForPixel(E)-t.getValueForPixel(S))}if(S===t.getPixelForValue(l)){const I=jo(x)*t.getLineWidthForValue(l)/2;S+=I,x-=I}return{size:x,base:S,head:E,center:E+x/2}}_calculateBarIndexPixels(e,t){const n=t.scale,i=this.options,s=i.skipNull,o=Dt(i.maxBarThickness,1/0);let l,u;const f=this._getAxisCount();if(t.grouped){const m=s?this._getStackCount(e):t.stackCount,y=i.barThickness==="flex"?NB(e,t,i,m*f):IB(e,t,i,m*f),g=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,_=this._getAxis().indexOf(Dt(g,this.getFirstScaleIdForIndexAxis())),E=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0)+_;l=y.start+y.chunk*E+y.chunk/2,u=Math.min(o,y.chunk*y.ratio)}else l=n.getPixelForValue(this.getParsed(e)[n.axis],e),u=Math.min(o,t.min*t.ratio);return{base:l-u/2,head:l+u/2,center:l,size:u}}draw(){const e=this._cachedMeta,t=e.vScale,n=e.data,i=n.length;let s=0;for(;s<i;++s)this.getParsed(s)[t.axis]!==null&&!n[s].hidden&&n[s].draw(this._ctx)}}Xe(xg,"id","bar"),Xe(xg,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Xe(xg,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function MB(r,e,t){let n=1,i=1,s=0,o=0;if(e<qn){const l=r,u=l+e,f=Math.cos(l),m=Math.sin(l),y=Math.cos(u),g=Math.sin(u),_=(C,N,R)=>im(C,l,u,!0)?1:Math.max(N,N*t,R,R*t),E=(C,N,R)=>im(C,l,u,!0)?-1:Math.min(N,N*t,R,R*t),x=_(0,f,y),w=_(fr,m,g),S=E(hn,f,y),I=E(hn+fr,m,g);n=(x-S)/2,i=(w-I)/2,s=-(x+S)/2,o=-(w+I)/2}return{ratioX:n,ratioY:i,offsetX:s,offsetY:o}}class hd extends Qc{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const n=this.getDataset().data,i=this._cachedMeta;if(this._parsing===!1)i._parsed=n;else{let s=u=>+n[u];if(Zt(n[e])){const{key:u="value"}=this._parsing;s=f=>+hu(n[f],u)}let o,l;for(o=e,l=e+t;o<l;++o)i._parsed[o]=s(o)}}_getRotation(){return ba(this.options.rotation-90)}_getCircumference(){return ba(this.options.circumference)}_getRotationExtents(){let e=qn,t=-qn;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const i=this.chart.getDatasetMeta(n).controller,s=i._getRotation(),o=i._getCircumference();e=Math.min(e,s),t=Math.max(t,s+o)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:n}=t,i=this._cachedMeta,s=i.data,o=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,l=Math.max((Math.min(n.width,n.height)-o)/2,0),u=Math.min(zV(this.options.cutout,l),1),f=this._getRingWeight(this.index),{circumference:m,rotation:y}=this._getRotationExtents(),{ratioX:g,ratioY:_,offsetX:E,offsetY:x}=MB(y,m,u),w=(n.width-o)/g,S=(n.height-o)/_,I=Math.max(Math.min(w,S)/2,0),C=A3(this.options.radius,I),N=Math.max(C*u,0),R=(C-N)/this._getVisibleDatasetWeightTotal();this.offsetX=E*C,this.offsetY=x*C,i.total=this.calculateTotal(),this.outerRadius=C-R*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-R*f,0),this.updateElements(s,0,s.length,e)}_circumference(e,t){const n=this.options,i=this._cachedMeta,s=this._getCircumference();return t&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||i._parsed[e]===null||i.data[e].hidden?0:this.calculateCircumference(i._parsed[e]*s/qn)}updateElements(e,t,n,i){const s=i==="reset",o=this.chart,l=o.chartArea,f=o.options.animation,m=(l.left+l.right)/2,y=(l.top+l.bottom)/2,g=s&&f.animateScale,_=g?0:this.innerRadius,E=g?0:this.outerRadius,{sharedOptions:x,includeOptions:w}=this._getSharedOptions(t,i);let S=this._getRotation(),I;for(I=0;I<t;++I)S+=this._circumference(I,s);for(I=t;I<t+n;++I){const C=this._circumference(I,s),N=e[I],R={x:m+this.offsetX,y:y+this.offsetY,startAngle:S,endAngle:S+C,circumference:C,outerRadius:E,innerRadius:_};w&&(R.options=x||this.resolveDataElementOptions(I,N.active?"active":i)),S+=C,this.updateElement(N,I,R,i)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let n=0,i;for(i=0;i<t.length;i++){const s=e._parsed[i];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(i)&&!t[i].hidden&&(n+=Math.abs(s))}return n}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?qn*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,i=n.data.labels||[],s=j2(t._parsed[e],n.options.locale);return{label:i[e]||"",value:s}}getMaxBorderWidth(e){let t=0;const n=this.chart;let i,s,o,l,u;if(!e){for(i=0,s=n.data.datasets.length;i<s;++i)if(n.isDatasetVisible(i)){o=n.getDatasetMeta(i),e=o.data,l=o.controller;break}}if(!e)return 0;for(i=0,s=e.length;i<s;++i)u=l.resolveDataElementOptions(i),u.borderAlign!=="inner"&&(t=Math.max(t,u.borderWidth||0,u.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let n=0,i=e.length;n<i;++n){const s=this.resolveDataElementOptions(n);t=Math.max(t,s.offset||0,s.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t}_getRingWeight(e){return Math.max(Dt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Xe(hd,"id","doughnut"),Xe(hd,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Xe(hd,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),Xe(hd,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data,{labels:{pointStyle:n,textAlign:i,color:s,useBorderRadius:o,borderRadius:l}}=e.legend.options;return t.labels.length&&t.datasets.length?t.labels.map((u,f)=>{const y=e.getDatasetMeta(0).controller.getStyle(f);return{text:u,fillStyle:y.backgroundColor,fontColor:s,hidden:!e.getDataVisibility(f),lineDash:y.borderDash,lineDashOffset:y.borderDashOffset,lineJoin:y.borderJoinStyle,lineWidth:y.borderWidth,strokeStyle:y.borderColor,textAlign:i,pointStyle:n,borderRadius:o&&(l||y.borderRadius),index:f}}):[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}}});class bg extends Qc{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:n,data:i=[],_dataset:s}=t,o=this.chart._animationsDisabled;let{start:l,count:u}=oz(t,i,o);this._drawStart=l,this._drawCount=u,az(t)&&(l=0,u=i.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!s._decimated,n.points=i;const f=this.resolveDatasetElementOptions(e);this.options.showLine||(f.borderWidth=0),f.segment=this.options.segment,this.updateElement(n,void 0,{animated:!o,options:f},e),this.updateElements(i,l,u,e)}updateElements(e,t,n,i){const s=i==="reset",{iScale:o,vScale:l,_stacked:u,_dataset:f}=this._cachedMeta,{sharedOptions:m,includeOptions:y}=this._getSharedOptions(t,i),g=o.axis,_=l.axis,{spanGaps:E,segment:x}=this.options,w=rm(E)?E:Number.POSITIVE_INFINITY,S=this.chart._animationsDisabled||s||i==="none",I=t+n,C=e.length;let N=t>0&&this.getParsed(t-1);for(let R=0;R<C;++R){const B=e[R],P=S?B:{};if(R<t||R>=I){P.skip=!0;continue}const k=this.getParsed(R),F=on(k[_]),j=P[g]=o.getPixelForValue(k[g],R),O=P[_]=s||F?l.getBasePixel():l.getPixelForValue(u?this.applyStack(l,k,u):k[_],R);P.skip=isNaN(j)||isNaN(O)||F,P.stop=R>0&&Math.abs(k[g]-N[g])>w,x&&(P.parsed=k,P.raw=f.data[R]),y&&(P.options=m||this.resolveDataElementOptions(R,B.active?"active":i)),S||this.updateElement(B,R,P,i),N=k}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,n=t.options&&t.options.borderWidth||0,i=e.data||[];if(!i.length)return n;const s=i[0].size(this.resolveDataElementOptions(0)),o=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(n,s,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}Xe(bg,"id","line"),Xe(bg,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Xe(bg,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class Ux extends hd{}Xe(Ux,"id","pie"),Xe(Ux,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});function jc(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class q2{constructor(e){Xe(this,"options");this.options=e||{}}static override(e){Object.assign(q2.prototype,e)}init(){}formats(){return jc()}parse(){return jc()}format(){return jc()}add(){return jc()}diff(){return jc()}startOf(){return jc()}endOf(){return jc()}}var DB={_date:q2};function LB(r,e,t,n){const{controller:i,data:s,_sorted:o}=r,l=i._cachedMeta.iScale,u=r.dataset&&r.dataset.options?r.dataset.options.spanGaps:null;if(l&&e===l.axis&&e!=="r"&&o&&s.length){const f=l._reversePixels?tz:Wc;if(n){if(i._sharedOptions){const m=s[0],y=typeof m.getRange=="function"&&m.getRange(e);if(y){const g=f(s,e,t-y),_=f(s,e,t+y);return{lo:g.lo,hi:_.hi}}}}else{const m=f(s,e,t);if(u){const{vScale:y}=i._cachedMeta,{_parsed:g}=r,_=g.slice(0,m.lo+1).reverse().findIndex(x=>!on(x[y.axis]));m.lo-=Math.max(0,_);const E=g.slice(m.hi).findIndex(x=>!on(x[y.axis]));m.hi+=Math.max(0,E)}return m}}return{lo:0,hi:s.length-1}}function o0(r,e,t,n,i){const s=r.getSortedVisibleDatasetMetas(),o=t[e];for(let l=0,u=s.length;l<u;++l){const{index:f,data:m}=s[l],{lo:y,hi:g}=LB(s[l],e,o,i);for(let _=y;_<=g;++_){const E=m[_];E.skip||n(E,f,_)}}}function FB(r){const e=r.indexOf("x")!==-1,t=r.indexOf("y")!==-1;return function(n,i){const s=e?Math.abs(n.x-i.x):0,o=t?Math.abs(n.y-i.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(o,2))}}function a1(r,e,t,n,i){const s=[];return!i&&!r.isPointInArea(e)||o0(r,t,e,function(l,u,f){!i&&!sm(l,r.chartArea,0)||l.inRange(e.x,e.y,n)&&s.push({element:l,datasetIndex:u,index:f})},!0),s}function VB(r,e,t,n){let i=[];function s(o,l,u){const{startAngle:f,endAngle:m}=o.getProps(["startAngle","endAngle"],n),{angle:y}=k3(o,{x:e.x,y:e.y});im(y,f,m)&&i.push({element:o,datasetIndex:l,index:u})}return o0(r,t,e,s),i}function zB(r,e,t,n,i,s){let o=[];const l=FB(t);let u=Number.POSITIVE_INFINITY;function f(m,y,g){const _=m.inRange(e.x,e.y,i);if(n&&!_)return;const E=m.getCenterPoint(i);if(!(!!s||r.isPointInArea(E))&&!_)return;const w=l(e,E);w<u?(o=[{element:m,datasetIndex:y,index:g}],u=w):w===u&&o.push({element:m,datasetIndex:y,index:g})}return o0(r,t,e,f),o}function l1(r,e,t,n,i,s){return!s&&!r.isPointInArea(e)?[]:t==="r"&&!n?VB(r,e,t,i):zB(r,e,t,n,i,s)}function RA(r,e,t,n,i){const s=[],o=t==="x"?"inXRange":"inYRange";let l=!1;return o0(r,t,e,(u,f,m)=>{u[o]&&u[o](e[t],i)&&(s.push({element:u,datasetIndex:f,index:m}),l=l||u.inRange(e.x,e.y,i))}),n&&!l?[]:s}var BB={modes:{index(r,e,t,n){const i=Fc(e,r),s=t.axis||"x",o=t.includeInvisible||!1,l=t.intersect?a1(r,i,s,n,o):l1(r,i,s,!1,n,o),u=[];return l.length?(r.getSortedVisibleDatasetMetas().forEach(f=>{const m=l[0].index,y=f.data[m];y&&!y.skip&&u.push({element:y,datasetIndex:f.index,index:m})}),u):[]},dataset(r,e,t,n){const i=Fc(e,r),s=t.axis||"xy",o=t.includeInvisible||!1;let l=t.intersect?a1(r,i,s,n,o):l1(r,i,s,!1,n,o);if(l.length>0){const u=l[0].datasetIndex,f=r.getDatasetMeta(u).data;l=[];for(let m=0;m<f.length;++m)l.push({element:f[m],datasetIndex:u,index:m})}return l},point(r,e,t,n){const i=Fc(e,r),s=t.axis||"xy",o=t.includeInvisible||!1;return a1(r,i,s,n,o)},nearest(r,e,t,n){const i=Fc(e,r),s=t.axis||"xy",o=t.includeInvisible||!1;return l1(r,i,s,t.intersect,n,o)},x(r,e,t,n){const i=Fc(e,r);return RA(r,i,"x",t.intersect,n)},y(r,e,t,n){const i=Fc(e,r);return RA(r,i,"y",t.intersect,n)}}};const K3=["left","top","right","bottom"];function Gh(r,e){return r.filter(t=>t.pos===e)}function OA(r,e){return r.filter(t=>K3.indexOf(t.pos)===-1&&t.box.axis===e)}function Kh(r,e){return r.sort((t,n)=>{const i=e?n:t,s=e?t:n;return i.weight===s.weight?i.index-s.index:i.weight-s.weight})}function UB(r){const e=[];let t,n,i,s,o,l;for(t=0,n=(r||[]).length;t<n;++t)i=r[t],{position:s,options:{stack:o,stackWeight:l=1}}=i,e.push({index:t,box:i,pos:s,horizontal:i.isHorizontal(),weight:i.weight,stack:o&&s+o,stackWeight:l});return e}function qB(r){const e={};for(const t of r){const{stack:n,pos:i,stackWeight:s}=t;if(!n||!K3.includes(i))continue;const o=e[n]||(e[n]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=s}return e}function HB(r,e){const t=qB(r),{vBoxMaxWidth:n,hBoxMaxHeight:i}=e;let s,o,l;for(s=0,o=r.length;s<o;++s){l=r[s];const{fullSize:u}=l.box,f=t[l.stack],m=f&&l.stackWeight/f.weight;l.horizontal?(l.width=m?m*n:u&&e.availableWidth,l.height=i):(l.width=n,l.height=m?m*i:u&&e.availableHeight)}return t}function $B(r){const e=UB(r),t=Kh(e.filter(f=>f.box.fullSize),!0),n=Kh(Gh(e,"left"),!0),i=Kh(Gh(e,"right")),s=Kh(Gh(e,"top"),!0),o=Kh(Gh(e,"bottom")),l=OA(e,"x"),u=OA(e,"y");return{fullSize:t,leftAndTop:n.concat(s),rightAndBottom:i.concat(u).concat(o).concat(l),chartArea:Gh(e,"chartArea"),vertical:n.concat(i).concat(u),horizontal:s.concat(o).concat(l)}}function jA(r,e,t,n){return Math.max(r[t],e[t])+Math.max(r[n],e[n])}function Y3(r,e){r.top=Math.max(r.top,e.top),r.left=Math.max(r.left,e.left),r.bottom=Math.max(r.bottom,e.bottom),r.right=Math.max(r.right,e.right)}function WB(r,e,t,n){const{pos:i,box:s}=t,o=r.maxPadding;if(!Zt(i)){t.size&&(r[i]-=t.size);const y=n[t.stack]||{size:0,count:1};y.size=Math.max(y.size,t.horizontal?s.height:s.width),t.size=y.size/y.count,r[i]+=t.size}s.getPadding&&Y3(o,s.getPadding());const l=Math.max(0,e.outerWidth-jA(o,r,"left","right")),u=Math.max(0,e.outerHeight-jA(o,r,"top","bottom")),f=l!==r.w,m=u!==r.h;return r.w=l,r.h=u,t.horizontal?{same:f,other:m}:{same:m,other:f}}function GB(r){const e=r.maxPadding;function t(n){const i=Math.max(e[n]-r[n],0);return r[n]+=i,i}r.y+=t("top"),r.x+=t("left"),t("right"),t("bottom")}function KB(r,e){const t=e.maxPadding;function n(i){const s={left:0,top:0,right:0,bottom:0};return i.forEach(o=>{s[o]=Math.max(e[o],t[o])}),s}return n(r?["left","right"]:["top","bottom"])}function df(r,e,t,n){const i=[];let s,o,l,u,f,m;for(s=0,o=r.length,f=0;s<o;++s){l=r[s],u=l.box,u.update(l.width||e.w,l.height||e.h,KB(l.horizontal,e));const{same:y,other:g}=WB(e,t,l,n);f|=y&&i.length,m=m||g,u.fullSize||i.push(l)}return f&&df(i,e,t,n)||m}function Kp(r,e,t,n,i){r.top=t,r.left=e,r.right=e+n,r.bottom=t+i,r.width=n,r.height=i}function MA(r,e,t,n){const i=t.padding;let{x:s,y:o}=e;for(const l of r){const u=l.box,f=n[l.stack]||{placed:0,weight:1},m=l.stackWeight/f.weight||1;if(l.horizontal){const y=e.w*m,g=f.size||u.height;nm(f.start)&&(o=f.start),u.fullSize?Kp(u,i.left,o,t.outerWidth-i.right-i.left,g):Kp(u,e.left+f.placed,o,y,g),f.start=o,f.placed+=y,o=u.bottom}else{const y=e.h*m,g=f.size||u.width;nm(f.start)&&(s=f.start),u.fullSize?Kp(u,s,i.top,g,t.outerHeight-i.bottom-i.top):Kp(u,s,e.top+f.placed,g,y),f.start=s,f.placed+=y,s=u.right}}e.x=s,e.y=o}var Ss={addBox(r,e){r.boxes||(r.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},r.boxes.push(e)},removeBox(r,e){const t=r.boxes?r.boxes.indexOf(e):-1;t!==-1&&r.boxes.splice(t,1)},configure(r,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(r,e,t,n){if(!r)return;const i=Ds(r.options.layout.padding),s=Math.max(e-i.width,0),o=Math.max(t-i.height,0),l=$B(r.boxes),u=l.vertical,f=l.horizontal;dn(r.boxes,x=>{typeof x.beforeLayout=="function"&&x.beforeLayout()});const m=u.reduce((x,w)=>w.box.options&&w.box.options.display===!1?x:x+1,0)||1,y=Object.freeze({outerWidth:e,outerHeight:t,padding:i,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/m,hBoxMaxHeight:o/2}),g=Object.assign({},i);Y3(g,Ds(n));const _=Object.assign({maxPadding:g,w:s,h:o,x:i.left,y:i.top},i),E=HB(u.concat(f),y);df(l.fullSize,_,y,E),df(u,_,y,E),df(f,_,y,E)&&df(u,_,y,E),GB(_),MA(l.leftAndTop,_,y,E),_.x+=_.w,_.y+=_.h,MA(l.rightAndBottom,_,y,E),r.chartArea={left:_.left,top:_.top,right:_.left+_.w,bottom:_.top+_.h,height:_.h,width:_.w},dn(l.chartArea,x=>{const w=x.box;Object.assign(w,r.chartArea),w.update(_.w,_.h,{left:0,top:0,right:0,bottom:0})})}};class Z3{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,n){}removeEventListener(e,t,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,n,i){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,i?Math.floor(t/i):n)}}isAttached(e){return!0}updateConfig(e){}}class YB extends Z3{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const wg="$chartjs",ZB={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},DA=r=>r===null||r==="";function QB(r,e){const t=r.style,n=r.getAttribute("height"),i=r.getAttribute("width");if(r[wg]={initial:{height:n,width:i,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",DA(i)){const s=_A(r,"width");s!==void 0&&(r.width=s)}if(DA(n))if(r.style.height==="")r.height=r.width/(e||2);else{const s=_A(r,"height");s!==void 0&&(r.height=s)}return r}const Q3=Zz?{passive:!0}:!1;function XB(r,e,t){r&&r.addEventListener(e,t,Q3)}function JB(r,e,t){r&&r.canvas&&r.canvas.removeEventListener(e,t,Q3)}function eU(r,e){const t=ZB[r.type]||r.type,{x:n,y:i}=Fc(r,e);return{type:t,chart:e,native:r,x:n!==void 0?n:null,y:i!==void 0?i:null}}function my(r,e){for(const t of r)if(t===e||t.contains(e))return!0}function tU(r,e,t){const n=r.canvas,i=new MutationObserver(s=>{let o=!1;for(const l of s)o=o||my(l.addedNodes,n),o=o&&!my(l.removedNodes,n);o&&t()});return i.observe(document,{childList:!0,subtree:!0}),i}function nU(r,e,t){const n=r.canvas,i=new MutationObserver(s=>{let o=!1;for(const l of s)o=o||my(l.removedNodes,n),o=o&&!my(l.addedNodes,n);o&&t()});return i.observe(document,{childList:!0,subtree:!0}),i}const am=new Map;let LA=0;function X3(){const r=window.devicePixelRatio;r!==LA&&(LA=r,am.forEach((e,t)=>{t.currentDevicePixelRatio!==r&&e()}))}function rU(r,e){am.size||window.addEventListener("resize",X3),am.set(r,e)}function iU(r){am.delete(r),am.size||window.removeEventListener("resize",X3)}function sU(r,e,t){const n=r.canvas,i=n&&U2(n);if(!i)return;const s=O3((l,u)=>{const f=i.clientWidth;t(l,u),f<i.clientWidth&&t()},window),o=new ResizeObserver(l=>{const u=l[0],f=u.contentRect.width,m=u.contentRect.height;f===0&&m===0||s(f,m)});return o.observe(i),rU(r,s),o}function c1(r,e,t){t&&t.disconnect(),e==="resize"&&iU(r)}function oU(r,e,t){const n=r.canvas,i=O3(s=>{r.ctx!==null&&t(eU(s,r))},r);return XB(n,e,i),i}class aU extends Z3{acquireContext(e,t){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(QB(e,t),n):null}releaseContext(e){const t=e.canvas;if(!t[wg])return!1;const n=t[wg].initial;["height","width"].forEach(s=>{const o=n[s];on(o)?t.removeAttribute(s):t.setAttribute(s,o)});const i=n.style||{};return Object.keys(i).forEach(s=>{t.style[s]=i[s]}),t.width=t.width,delete t[wg],!0}addEventListener(e,t,n){this.removeEventListener(e,t);const i=e.$proxies||(e.$proxies={}),o={attach:tU,detach:nU,resize:sU}[t]||oU;i[t]=o(e,t,n)}removeEventListener(e,t){const n=e.$proxies||(e.$proxies={}),i=n[t];if(!i)return;({attach:c1,detach:c1,resize:c1}[t]||JB)(e,t,i),n[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,n,i){return Yz(e,t,n,i)}isAttached(e){const t=e&&U2(e);return!!(t&&t.isConnected)}}function lU(r){return!B2()||typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas?YB:aU}var ng;let La=(ng=class{constructor(){Xe(this,"x");Xe(this,"y");Xe(this,"active",!1);Xe(this,"options");Xe(this,"$animations")}tooltipPosition(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}hasValue(){return rm(this.x)&&rm(this.y)}getProps(e,t){const n=this.$animations;if(!t||!n)return this;const i={};return e.forEach(s=>{i[s]=n[s]&&n[s].active()?n[s]._to:this[s]}),i}},Xe(ng,"defaults",{}),Xe(ng,"defaultRoutes"),ng);function cU(r,e){const t=r.options.ticks,n=uU(r),i=Math.min(t.maxTicksLimit||n,n),s=t.major.enabled?hU(e):[],o=s.length,l=s[0],u=s[o-1],f=[];if(o>i)return fU(e,f,s,o/i),f;const m=dU(s,e,i);if(o>0){let y,g;const _=o>1?Math.round((u-l)/(o-1)):null;for(Yp(e,f,m,on(_)?0:l-_,l),y=0,g=o-1;y<g;y++)Yp(e,f,m,s[y],s[y+1]);return Yp(e,f,m,u,on(_)?e.length:u+_),f}return Yp(e,f,m),f}function uU(r){const e=r.options.offset,t=r._tickSize(),n=r._length/t+(e?0:1),i=r._maxLength/t;return Math.floor(Math.min(n,i))}function dU(r,e,t){const n=mU(r),i=e.length/t;if(!n)return Math.max(i,1);const s=KV(n);for(let o=0,l=s.length-1;o<l;o++){const u=s[o];if(u>i)return u}return Math.max(i,1)}function hU(r){const e=[];let t,n;for(t=0,n=r.length;t<n;t++)r[t].major&&e.push(t);return e}function fU(r,e,t,n){let i=0,s=t[0],o;for(n=Math.ceil(n),o=0;o<r.length;o++)o===s&&(e.push(r[o]),i++,s=t[i*n])}function Yp(r,e,t,n,i){const s=Dt(n,0),o=Math.min(Dt(i,r.length),r.length);let l=0,u,f,m;for(t=Math.ceil(t),i&&(u=i-n,t=u/Math.floor(u/t)),m=s;m<0;)l++,m=Math.round(s+l*t);for(f=Math.max(s,0);f<o;f++)f===m&&(e.push(r[f]),l++,m=Math.round(s+l*t))}function mU(r){const e=r.length;let t,n;if(e<2)return!1;for(n=r[0],t=1;t<e;++t)if(r[t]-r[t-1]!==n)return!1;return n}const pU=r=>r==="left"?"right":r==="right"?"left":r,FA=(r,e,t)=>e==="top"||e==="left"?r[e]+t:r[e]-t,VA=(r,e)=>Math.min(e||r,r);function zA(r,e){const t=[],n=r.length/e,i=r.length;let s=0;for(;s<i;s+=n)t.push(r[Math.floor(s)]);return t}function gU(r,e,t){const n=r.ticks.length,i=Math.min(e,n-1),s=r._startPixel,o=r._endPixel,l=1e-6;let u=r.getPixelForTick(i),f;if(!(t&&(n===1?f=Math.max(u-s,o-u):e===0?f=(r.getPixelForTick(1)-u)/2:f=(u-r.getPixelForTick(i-1))/2,u+=i<e?f:-f,u<s-l||u>o+l)))return u}function yU(r,e){dn(r,t=>{const n=t.gc,i=n.length/2;let s;if(i>e){for(s=0;s<i;++s)delete t.data[n[s]];n.splice(0,i)}})}function Yh(r){return r.drawTicks?r.tickLength:0}function BA(r,e){if(!r.display)return 0;const t=Qr(r.font,e),n=Ds(r.padding);return(dr(r.text)?r.text.length:1)*t.lineHeight+n.height}function vU(r,e){return xu(r,{scale:e,type:"scale"})}function _U(r,e,t){return xu(r,{tick:t,index:e,type:"tick"})}function xU(r,e,t){let n=R2(r);return(t&&e!=="right"||!t&&e==="right")&&(n=pU(n)),n}function bU(r,e,t,n){const{top:i,left:s,bottom:o,right:l,chart:u}=r,{chartArea:f,scales:m}=u;let y=0,g,_,E;const x=o-i,w=l-s;if(r.isHorizontal()){if(_=Gr(n,s,l),Zt(t)){const S=Object.keys(t)[0],I=t[S];E=m[S].getPixelForValue(I)+x-e}else t==="center"?E=(f.bottom+f.top)/2+x-e:E=FA(r,t,e);g=l-s}else{if(Zt(t)){const S=Object.keys(t)[0],I=t[S];_=m[S].getPixelForValue(I)-w+e}else t==="center"?_=(f.left+f.right)/2-w+e:_=FA(r,t,e);E=Gr(n,o,i),y=t==="left"?-fr:fr}return{titleX:_,titleY:E,maxWidth:g,rotation:y}}class nh extends La{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:n,_suggestedMax:i}=this;return e=Eo(e,Number.POSITIVE_INFINITY),t=Eo(t,Number.NEGATIVE_INFINITY),n=Eo(n,Number.POSITIVE_INFINITY),i=Eo(i,Number.NEGATIVE_INFINITY),{min:Eo(e,n),max:Eo(t,i),minDefined:Ms(e),maxDefined:Ms(t)}}getMinMax(e){let{min:t,max:n,minDefined:i,maxDefined:s}=this.getUserBounds(),o;if(i&&s)return{min:t,max:n};const l=this.getMatchingVisibleMetas();for(let u=0,f=l.length;u<f;++u)o=l[u].controller.getMinMax(this,e),i||(t=Math.min(t,o.min)),s||(n=Math.max(n,o.max));return t=s&&t>n?n:t,n=i&&t>n?t:n,{min:Eo(t,Eo(n,t)),max:Eo(n,Eo(t,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Nn(this.options.beforeUpdate,[this])}update(e,t,n){const{beginAtZero:i,grace:s,ticks:o}=this.options,l=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Iz(this,s,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const u=l<this.ticks.length;this._convertTicksToLabels(u?zA(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=cU(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),u&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,n;this.isHorizontal()?(t=this.left,n=this.right):(t=this.top,n=this.bottom,e=!e),this._startPixel=t,this._endPixel=n,this._reversePixels=e,this._length=n-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Nn(this.options.afterUpdate,[this])}beforeSetDimensions(){Nn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Nn(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Nn(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Nn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let n,i,s;for(n=0,i=e.length;n<i;n++)s=e[n],s.label=Nn(t.callback,[s.value,n,e],this)}afterTickToLabelConversion(){Nn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Nn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,n=VA(this.ticks.length,e.ticks.maxTicksLimit),i=t.minRotation||0,s=t.maxRotation;let o=i,l,u,f;if(!this._isVisible()||!t.display||i>=s||n<=1||!this.isHorizontal()){this.labelRotation=i;return}const m=this._getLabelSizes(),y=m.widest.width,g=m.highest.height,_=Zr(this.chart.width-y,0,this.maxWidth);l=e.offset?this.maxWidth/n:_/(n-1),y+6>l&&(l=_/(n-(e.offset?.5:1)),u=this.maxHeight-Yh(e.grid)-t.padding-BA(e.title,this.chart.options.font),f=Math.sqrt(y*y+g*g),o=XV(Math.min(Math.asin(Zr((m.highest.height+6)/l,-1,1)),Math.asin(Zr(u/f,-1,1))-Math.asin(Zr(g/f,-1,1)))),o=Math.max(i,Math.min(s,o))),this.labelRotation=o}afterCalculateLabelRotation(){Nn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Nn(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:n,title:i,grid:s}}=this,o=this._isVisible(),l=this.isHorizontal();if(o){const u=BA(i,t.options.font);if(l?(e.width=this.maxWidth,e.height=Yh(s)+u):(e.height=this.maxHeight,e.width=Yh(s)+u),n.display&&this.ticks.length){const{first:f,last:m,widest:y,highest:g}=this._getLabelSizes(),_=n.padding*2,E=ba(this.labelRotation),x=Math.cos(E),w=Math.sin(E);if(l){const S=n.mirror?0:w*y.width+x*g.height;e.height=Math.min(this.maxHeight,e.height+S+_)}else{const S=n.mirror?0:x*y.width+w*g.height;e.width=Math.min(this.maxWidth,e.width+S+_)}this._calculatePadding(f,m,w,x)}}this._handleMargins(),l?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,n,i){const{ticks:{align:s,padding:o},position:l}=this.options,u=this.labelRotation!==0,f=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const m=this.getPixelForTick(0)-this.left,y=this.right-this.getPixelForTick(this.ticks.length-1);let g=0,_=0;u?f?(g=i*e.width,_=n*t.height):(g=n*e.height,_=i*t.width):s==="start"?_=t.width:s==="end"?g=e.width:s!=="inner"&&(g=e.width/2,_=t.width/2),this.paddingLeft=Math.max((g-m+o)*this.width/(this.width-m),0),this.paddingRight=Math.max((_-y+o)*this.width/(this.width-y),0)}else{let m=t.height/2,y=e.height/2;s==="start"?(m=0,y=e.height):s==="end"&&(m=t.height,y=0),this.paddingTop=m+o,this.paddingBottom=y+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Nn(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,n;for(t=0,n=e.length;t<n;t++)on(e[t].label)&&(e.splice(t,1),n--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let n=this.ticks;t<n.length&&(n=zA(n,t)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,n){const{ctx:i,_longestTextCache:s}=this,o=[],l=[],u=Math.floor(t/VA(t,n));let f=0,m=0,y,g,_,E,x,w,S,I,C,N,R;for(y=0;y<t;y+=u){if(E=e[y].label,x=this._resolveTickFontOptions(y),i.font=w=x.string,S=s[w]=s[w]||{data:{},gc:[]},I=x.lineHeight,C=N=0,!on(E)&&!dr(E))C=mA(i,S.data,S.gc,C,E),N=I;else if(dr(E))for(g=0,_=E.length;g<_;++g)R=E[g],!on(R)&&!dr(R)&&(C=mA(i,S.data,S.gc,C,R),N+=I);o.push(C),l.push(N),f=Math.max(C,f),m=Math.max(N,m)}yU(s,t);const B=o.indexOf(f),P=l.indexOf(m),k=F=>({width:o[F]||0,height:l[F]||0});return{first:k(0),last:k(t-1),widest:k(B),highest:k(P),widths:o,heights:l}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return ez(this._alignToPixels?Oc(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const n=t[e];return n.$context||(n.$context=_U(this.getContext(),e,n))}return this.$context||(this.$context=vU(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=ba(this.labelRotation),n=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t)),s=this._getLabelSizes(),o=e.autoSkipPadding||0,l=s?s.widest.width+o:0,u=s?s.highest.height+o:0;return this.isHorizontal()?u*n>l*i?l/n:u/i:u*i<l*n?u/n:l/i}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,n=this.chart,i=this.options,{grid:s,position:o,border:l}=i,u=s.offset,f=this.isHorizontal(),y=this.ticks.length+(u?1:0),g=Yh(s),_=[],E=l.setContext(this.getContext()),x=E.display?E.width:0,w=x/2,S=function(ie){return Oc(n,ie,x)};let I,C,N,R,B,P,k,F,j,O,D,M;if(o==="top")I=S(this.bottom),P=this.bottom-g,F=I-w,O=S(e.top)+w,M=e.bottom;else if(o==="bottom")I=S(this.top),O=e.top,M=S(e.bottom)-w,P=I+w,F=this.top+g;else if(o==="left")I=S(this.right),B=this.right-g,k=I-w,j=S(e.left)+w,D=e.right;else if(o==="right")I=S(this.left),j=e.left,D=S(e.right)-w,B=I+w,k=this.left+g;else if(t==="x"){if(o==="center")I=S((e.top+e.bottom)/2+.5);else if(Zt(o)){const ie=Object.keys(o)[0],oe=o[ie];I=S(this.chart.scales[ie].getPixelForValue(oe))}O=e.top,M=e.bottom,P=I+w,F=P+g}else if(t==="y"){if(o==="center")I=S((e.left+e.right)/2);else if(Zt(o)){const ie=Object.keys(o)[0],oe=o[ie];I=S(this.chart.scales[ie].getPixelForValue(oe))}B=I-w,k=B-g,j=e.left,D=e.right}const $=Dt(i.ticks.maxTicksLimit,y),G=Math.max(1,Math.ceil(y/$));for(C=0;C<y;C+=G){const ie=this.getContext(C),oe=s.setContext(ie),ee=l.setContext(ie),J=oe.lineWidth,Y=oe.color,q=ee.dash||[],Z=ee.dashOffset,ne=oe.tickWidth,se=oe.tickColor,le=oe.tickBorderDash||[],Q=oe.tickBorderDashOffset;N=gU(this,C,u),N!==void 0&&(R=Oc(n,N,J),f?B=k=j=D=R:P=F=O=M=R,_.push({tx1:B,ty1:P,tx2:k,ty2:F,x1:j,y1:O,x2:D,y2:M,width:J,color:Y,borderDash:q,borderDashOffset:Z,tickWidth:ne,tickColor:se,tickBorderDash:le,tickBorderDashOffset:Q}))}return this._ticksLength=y,this._borderValue=I,_}_computeLabelItems(e){const t=this.axis,n=this.options,{position:i,ticks:s}=n,o=this.isHorizontal(),l=this.ticks,{align:u,crossAlign:f,padding:m,mirror:y}=s,g=Yh(n.grid),_=g+m,E=y?-m:_,x=-ba(this.labelRotation),w=[];let S,I,C,N,R,B,P,k,F,j,O,D,M="middle";if(i==="top")B=this.bottom-E,P=this._getXAxisLabelAlignment();else if(i==="bottom")B=this.top+E,P=this._getXAxisLabelAlignment();else if(i==="left"){const G=this._getYAxisLabelAlignment(g);P=G.textAlign,R=G.x}else if(i==="right"){const G=this._getYAxisLabelAlignment(g);P=G.textAlign,R=G.x}else if(t==="x"){if(i==="center")B=(e.top+e.bottom)/2+_;else if(Zt(i)){const G=Object.keys(i)[0],ie=i[G];B=this.chart.scales[G].getPixelForValue(ie)+_}P=this._getXAxisLabelAlignment()}else if(t==="y"){if(i==="center")R=(e.left+e.right)/2-_;else if(Zt(i)){const G=Object.keys(i)[0],ie=i[G];R=this.chart.scales[G].getPixelForValue(ie)}P=this._getYAxisLabelAlignment(g).textAlign}t==="y"&&(u==="start"?M="top":u==="end"&&(M="bottom"));const $=this._getLabelSizes();for(S=0,I=l.length;S<I;++S){C=l[S],N=C.label;const G=s.setContext(this.getContext(S));k=this.getPixelForTick(S)+s.labelOffset,F=this._resolveTickFontOptions(S),j=F.lineHeight,O=dr(N)?N.length:1;const ie=O/2,oe=G.color,ee=G.textStrokeColor,J=G.textStrokeWidth;let Y=P;o?(R=k,P==="inner"&&(S===I-1?Y=this.options.reverse?"left":"right":S===0?Y=this.options.reverse?"right":"left":Y="center"),i==="top"?f==="near"||x!==0?D=-O*j+j/2:f==="center"?D=-$.highest.height/2-ie*j+j:D=-$.highest.height+j/2:f==="near"||x!==0?D=j/2:f==="center"?D=$.highest.height/2-ie*j:D=$.highest.height-O*j,y&&(D*=-1),x!==0&&!G.showLabelBackdrop&&(R+=j/2*Math.sin(x))):(B=k,D=(1-O)*j/2);let q;if(G.showLabelBackdrop){const Z=Ds(G.backdropPadding),ne=$.heights[S],se=$.widths[S];let le=D-Z.top,Q=0-Z.left;switch(M){case"middle":le-=ne/2;break;case"bottom":le-=ne;break}switch(P){case"center":Q-=se/2;break;case"right":Q-=se;break;case"inner":S===I-1?Q-=se:S>0&&(Q-=se/2);break}q={left:Q,top:le,width:se+Z.width,height:ne+Z.height,color:G.backdropColor}}w.push({label:N,font:F,textOffset:D,options:{rotation:x,color:oe,strokeColor:ee,strokeWidth:J,textAlign:Y,textBaseline:M,translation:[R,B],backdrop:q}})}return w}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-ba(this.labelRotation))return e==="top"?"left":"right";let i="center";return t.align==="start"?i="left":t.align==="end"?i="right":t.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:n,mirror:i,padding:s}}=this.options,o=this._getLabelSizes(),l=e+s,u=o.widest.width;let f,m;return t==="left"?i?(m=this.right+s,n==="near"?f="left":n==="center"?(f="center",m+=u/2):(f="right",m+=u)):(m=this.right-l,n==="near"?f="right":n==="center"?(f="center",m-=u/2):(f="left",m=this.left)):t==="right"?i?(m=this.left+s,n==="near"?f="right":n==="center"?(f="center",m-=u/2):(f="left",m-=u)):(m=this.left+l,n==="near"?f="left":n==="center"?(f="center",m+=u/2):(f="right",m=this.right)):f="right",{textAlign:f,x:m}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:n,top:i,width:s,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(n,i,s,o),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const i=this.ticks.findIndex(s=>s.value===e);return i>=0?t.setContext(this.getContext(i)).lineWidth:0}drawGrid(e){const t=this.options.grid,n=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let s,o;const l=(u,f,m)=>{!m.width||!m.color||(n.save(),n.lineWidth=m.width,n.strokeStyle=m.color,n.setLineDash(m.borderDash||[]),n.lineDashOffset=m.borderDashOffset,n.beginPath(),n.moveTo(u.x,u.y),n.lineTo(f.x,f.y),n.stroke(),n.restore())};if(t.display)for(s=0,o=i.length;s<o;++s){const u=i[s];t.drawOnChartArea&&l({x:u.x1,y:u.y1},{x:u.x2,y:u.y2},u),t.drawTicks&&l({x:u.tx1,y:u.ty1},{x:u.tx2,y:u.ty2},{color:u.tickColor,width:u.tickWidth,borderDash:u.tickBorderDash,borderDashOffset:u.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:n,grid:i}}=this,s=n.setContext(this.getContext()),o=n.display?s.width:0;if(!o)return;const l=i.setContext(this.getContext(0)).lineWidth,u=this._borderValue;let f,m,y,g;this.isHorizontal()?(f=Oc(e,this.left,o)-o/2,m=Oc(e,this.right,l)+l/2,y=g=u):(y=Oc(e,this.top,o)-o/2,g=Oc(e,this.bottom,l)+l/2,f=m=u),t.save(),t.lineWidth=s.width,t.strokeStyle=s.color,t.beginPath(),t.moveTo(f,y),t.lineTo(m,g),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const n=this.ctx,i=this._computeLabelArea();i&&M2(n,i);const s=this.getLabelItems(e);for(const o of s){const l=o.options,u=o.font,f=o.label,m=o.textOffset;om(n,f,0,m,u,l)}i&&D2(n)}drawTitle(){const{ctx:e,options:{position:t,title:n,reverse:i}}=this;if(!n.display)return;const s=Qr(n.font),o=Ds(n.padding),l=n.align;let u=s.lineHeight/2;t==="bottom"||t==="center"||Zt(t)?(u+=o.bottom,dr(n.text)&&(u+=s.lineHeight*(n.text.length-1))):u+=o.top;const{titleX:f,titleY:m,maxWidth:y,rotation:g}=bU(this,u,t,l);om(e,n.text,0,0,s,{color:n.color,maxWidth:y,rotation:g,textAlign:xU(l,t,i),textBaseline:"middle",translation:[f,m]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,n=Dt(e.grid&&e.grid.z,-1),i=Dt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==nh.prototype.draw?[{z:t,draw:s=>{this.draw(s)}}]:[{z:n,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:t,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",i=[];let s,o;for(s=0,o=t.length;s<o;++s){const l=t[s];l[n]===this.id&&(!e||l.type===e)&&i.push(l)}return i}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return Qr(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Zp{constructor(e,t,n){this.type=e,this.scope=t,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let n;TU(t)&&(n=this.register(t));const i=this.items,s=e.id,o=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in i||(i[s]=e,wU(e,o,n),this.override&&Yn.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,n=e.id,i=this.scope;n in t&&delete t[n],i&&n in Yn[i]&&(delete Yn[i][n],this.override&&delete fu[n])}}function wU(r,e,t){const n=tm(Object.create(null),[t?Yn.get(t):{},Yn.get(e),r.defaults]);Yn.set(e,n),r.defaultRoutes&&EU(e,r.defaultRoutes),r.descriptors&&Yn.describe(e,r.descriptors)}function EU(r,e){Object.keys(e).forEach(t=>{const n=t.split("."),i=n.pop(),s=[r].concat(n).join("."),o=e[t].split("."),l=o.pop(),u=o.join(".");Yn.route(s,i,u,l)})}function TU(r){return"id"in r&&"defaults"in r}class SU{constructor(){this.controllers=new Zp(Qc,"datasets",!0),this.elements=new Zp(La,"elements"),this.plugins=new Zp(Object,"plugins"),this.scales=new Zp(nh,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,n){[...t].forEach(i=>{const s=n||this._getRegistryForType(i);n||s.isForType(i)||s===this.plugins&&i.id?this._exec(e,s,i):dn(i,o=>{const l=n||this._getRegistryForType(o);this._exec(e,l,o)})})}_exec(e,t,n){const i=P2(e);Nn(n["before"+i],[],n),t[e](n),Nn(n["after"+i],[],n)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}_get(e,t,n){const i=t.get(e);if(i===void 0)throw new Error('"'+e+'" is not a registered '+n+".");return i}}var Ao=new SU;class AU{constructor(){this._init=void 0}notify(e,t,n,i){if(t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const s=i?this._descriptors(e).filter(i):this._descriptors(e),o=this._notify(s,e,t,n);return t==="afterDestroy"&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),o}_notify(e,t,n,i){i=i||{};for(const s of e){const o=s.plugin,l=o[n],u=[t,i,s.options];if(Nn(l,u,o)===!1&&i.cancelable)return!1}return!0}invalidate(){on(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const n=e&&e.config,i=Dt(n.options&&n.options.plugins,{}),s=IU(n);return i===!1&&!t?[]:kU(e,s,i,t)}_notifyStateChanges(e){const t=this._oldCache||[],n=this._cache,i=(s,o)=>s.filter(l=>!o.some(u=>l.plugin.id===u.plugin.id));this._notify(i(t,n),e,"stop"),this._notify(i(n,t),e,"start")}}function IU(r){const e={},t=[],n=Object.keys(Ao.plugins.items);for(let s=0;s<n.length;s++)t.push(Ao.getPlugin(n[s]));const i=r.plugins||[];for(let s=0;s<i.length;s++){const o=i[s];t.indexOf(o)===-1&&(t.push(o),e[o.id]=!0)}return{plugins:t,localIds:e}}function NU(r,e){return!e&&r===!1?null:r===!0?{}:r}function kU(r,{plugins:e,localIds:t},n,i){const s=[],o=r.getContext();for(const l of e){const u=l.id,f=NU(n[u],i);f!==null&&s.push({plugin:l,options:PU(r.config,{plugin:l,local:t[u]},f,o)})}return s}function PU(r,{plugin:e,local:t},n,i){const s=r.pluginScopeKeys(e),o=r.getOptionScopes(n,s);return t&&e.defaults&&o.push(e.defaults),r.createResolver(o,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function qx(r,e){const t=Yn.datasets[r]||{};return((e.datasets||{})[r]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function CU(r,e){let t=r;return r==="_index_"?t=e:r==="_value_"&&(t=e==="x"?"y":"x"),t}function RU(r,e){return r===e?"_index_":"_value_"}function UA(r){if(r==="x"||r==="y"||r==="r")return r}function OU(r){if(r==="top"||r==="bottom")return"x";if(r==="left"||r==="right")return"y"}function Hx(r,...e){if(UA(r))return r;for(const t of e){const n=t.axis||OU(t.position)||r.length>1&&UA(r[0].toLowerCase());if(n)return n}throw new Error(`Cannot determine type of '${r}' axis. Please provide 'axis' or 'position' option.`)}function qA(r,e,t){if(t[e+"AxisID"]===r)return{axis:e}}function jU(r,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(n=>n.xAxisID===r||n.yAxisID===r);if(t.length)return qA(r,"x",t[0])||qA(r,"y",t[0])}return{}}function MU(r,e){const t=fu[r.type]||{scales:{}},n=e.scales||{},i=qx(r.type,e),s=Object.create(null);return Object.keys(n).forEach(o=>{const l=n[o];if(!Zt(l))return console.error(`Invalid scale configuration for scale: ${o}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const u=Hx(o,l,jU(o,r),Yn.scales[l.type]),f=RU(u,i),m=t.scales||{};s[o]=kf(Object.create(null),[{axis:u},l,m[u],m[f]])}),r.data.datasets.forEach(o=>{const l=o.type||r.type,u=o.indexAxis||qx(l,e),m=(fu[l]||{}).scales||{};Object.keys(m).forEach(y=>{const g=CU(y,u),_=o[g+"AxisID"]||g;s[_]=s[_]||Object.create(null),kf(s[_],[{axis:g},n[_],m[y]])})}),Object.keys(s).forEach(o=>{const l=s[o];kf(l,[Yn.scales[l.type],Yn.scale])}),s}function J3(r){const e=r.options||(r.options={});e.plugins=Dt(e.plugins,{}),e.scales=MU(r,e)}function eR(r){return r=r||{},r.datasets=r.datasets||[],r.labels=r.labels||[],r}function DU(r){return r=r||{},r.data=eR(r.data),J3(r),r}const HA=new Map,tR=new Set;function Qp(r,e){let t=HA.get(r);return t||(t=e(),HA.set(r,t),tR.add(t)),t}const Zh=(r,e,t)=>{const n=hu(e,t);n!==void 0&&r.add(n)};class LU{constructor(e){this._config=DU(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=eR(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),J3(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Qp(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return Qp(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return Qp(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,n=this.type;return Qp(`${n}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const n=this._scopeCache;let i=n.get(e);return(!i||t)&&(i=new Map,n.set(e,i)),i}getOptionScopes(e,t,n){const{options:i,type:s}=this,o=this._cachedScopes(e,n),l=o.get(t);if(l)return l;const u=new Set;t.forEach(m=>{e&&(u.add(e),m.forEach(y=>Zh(u,e,y))),m.forEach(y=>Zh(u,i,y)),m.forEach(y=>Zh(u,fu[s]||{},y)),m.forEach(y=>Zh(u,Yn,y)),m.forEach(y=>Zh(u,zx,y))});const f=Array.from(u);return f.length===0&&f.push(Object.create(null)),tR.has(t)&&o.set(t,f),f}chartOptionScopes(){const{options:e,type:t}=this;return[e,fu[t]||{},Yn.datasets[t]||{},{type:t},Yn,zx]}resolveNamedOptions(e,t,n,i=[""]){const s={$shared:!0},{resolver:o,subPrefixes:l}=$A(this._resolverCache,e,i);let u=o;if(VU(o,t)){s.$shared=!1,n=ec(n)?n():n;const f=this.createResolver(e,n,l);u=zd(o,n,f)}for(const f of t)s[f]=u[f];return s}createResolver(e,t,n=[""],i){const{resolver:s}=$A(this._resolverCache,e,n);return Zt(t)?zd(s,t,void 0,i):s}}function $A(r,e,t){let n=r.get(e);n||(n=new Map,r.set(e,n));const i=t.join();let s=n.get(i);return s||(s={resolver:F2(e,t),subPrefixes:t.filter(l=>!l.toLowerCase().includes("hover"))},n.set(i,s)),s}const FU=r=>Zt(r)&&Object.getOwnPropertyNames(r).some(e=>ec(r[e]));function VU(r,e){const{isScriptable:t,isIndexable:n}=L3(r);for(const i of e){const s=t(i),o=n(i),l=(o||s)&&r[i];if(s&&(ec(l)||FU(l))||o&&dr(l))return!0}return!1}var zU="4.5.1";const BU=["top","bottom","left","right","chartArea"];function WA(r,e){return r==="top"||r==="bottom"||BU.indexOf(r)===-1&&e==="x"}function GA(r,e){return function(t,n){return t[r]===n[r]?t[e]-n[e]:t[r]-n[r]}}function KA(r){const e=r.chart,t=e.options.animation;e.notifyPlugins("afterRender"),Nn(t&&t.onComplete,[r],e)}function UU(r){const e=r.chart,t=e.options.animation;Nn(t&&t.onProgress,[r],e)}function nR(r){return B2()&&typeof r=="string"?r=document.getElementById(r):r&&r.length&&(r=r[0]),r&&r.canvas&&(r=r.canvas),r}const Eg={},YA=r=>{const e=nR(r);return Object.values(Eg).filter(t=>t.canvas===e).pop()};function qU(r,e,t){const n=Object.keys(r);for(const i of n){const s=+i;if(s>=e){const o=r[i];delete r[i],(t>0||s>e)&&(r[s+t]=o)}}}function HU(r,e,t,n){return!t||r.type==="mouseout"?null:n?e:r}var Sl;let Pm=(Sl=class{static register(...e){Ao.add(...e),ZA()}static unregister(...e){Ao.remove(...e),ZA()}constructor(e,t){const n=this.config=new LU(t),i=nR(e),s=YA(i);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const o=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||lU(i)),this.platform.updateConfig(n);const l=this.platform.acquireContext(i,o.aspectRatio),u=l&&l.canvas,f=u&&u.height,m=u&&u.width;if(this.id=VV(),this.ctx=l,this.canvas=u,this.width=m,this.height=f,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new AU,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=iz(y=>this.update(y),o.resizeDelay||0),this._dataChanges=[],Eg[this.id]=this,!l||!u){console.error("Failed to create chart: can't acquire context from the given item");return}ma.listen(this,"complete",KA),ma.listen(this,"progress",UU),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:n,height:i,_aspectRatio:s}=this;return on(e)?t&&s?s:i?n/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Ao}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():vA(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return pA(this.canvas,this.ctx),this}stop(){return ma.stop(this),this}resize(e,t){ma.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const n=this.options,i=this.canvas,s=n.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(i,e,t,s),l=n.devicePixelRatio||this.platform.getDevicePixelRatio(),u=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,vA(this,l,!0)&&(this.notifyPlugins("resize",{size:o}),Nn(n.onResize,[this,o],this),this.attached&&this._doResize(u)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};dn(t,(n,i)=>{n.id=i})}buildOrUpdateScales(){const e=this.options,t=e.scales,n=this.scales,i=Object.keys(n).reduce((o,l)=>(o[l]=!1,o),{});let s=[];t&&(s=s.concat(Object.keys(t).map(o=>{const l=t[o],u=Hx(o,l),f=u==="r",m=u==="x";return{options:l,dposition:f?"chartArea":m?"bottom":"left",dtype:f?"radialLinear":m?"category":"linear"}}))),dn(s,o=>{const l=o.options,u=l.id,f=Hx(u,l),m=Dt(l.type,o.dtype);(l.position===void 0||WA(l.position,f)!==WA(o.dposition))&&(l.position=o.dposition),i[u]=!0;let y=null;if(u in n&&n[u].type===m)y=n[u];else{const g=Ao.getScale(m);y=new g({id:u,type:m,ctx:this.ctx,chart:this}),n[y.id]=y}y.init(l,e)}),dn(i,(o,l)=>{o||delete n[l]}),dn(n,o=>{Ss.configure(this,o,o.options),Ss.addBox(this,o)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,n=e.length;if(e.sort((i,s)=>i.index-s.index),n>t){for(let i=t;i<n;++i)this._destroyDatasetMeta(i);e.splice(t,n-t)}this._sortedMetasets=e.slice(0).sort(GA("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((n,i)=>{t.filter(s=>s===n._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let n,i;for(this._removeUnreferencedMetasets(),n=0,i=t.length;n<i;n++){const s=t[n];let o=this.getDatasetMeta(n);const l=s.type||this.config.type;if(o.type&&o.type!==l&&(this._destroyDatasetMeta(n),o=this.getDatasetMeta(n)),o.type=l,o.indexAxis=s.indexAxis||qx(l,this.options),o.order=s.order||0,o.index=n,o.label=""+s.label,o.visible=this.isDatasetVisible(n),o.controller)o.controller.updateIndex(n),o.controller.linkScales();else{const u=Ao.getController(l),{datasetElementType:f,dataElementType:m}=Yn.datasets[l];Object.assign(u,{dataElementType:Ao.getElement(m),datasetElementType:f&&Ao.getElement(f)}),o.controller=new u(this,n),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){dn(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const n=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let f=0,m=this.data.datasets.length;f<m;f++){const{controller:y}=this.getDatasetMeta(f),g=!i&&s.indexOf(y)===-1;y.buildOrUpdateElements(g),o=Math.max(+y.getMaxOverflow(),o)}o=this._minPadding=n.layout.autoPadding?o:0,this._updateLayout(o),i||dn(s,f=>{f.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(GA("z","_idx"));const{_active:l,_lastEvent:u}=this;u?this._eventHandler(u,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){dn(this.scales,e=>{Ss.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),n=new Set(e.events);(!sA(t,n)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:n,start:i,count:s}of t){const o=n==="_removeElements"?-s:s;qU(e,i,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,n=s=>new Set(e.filter(o=>o[0]===s).map((o,l)=>l+","+o.splice(1).join(","))),i=n(0);for(let s=1;s<t;s++)if(!sA(i,n(s)))return;return Array.from(i).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Ss.update(this,this.width,this.height,e);const t=this.chartArea,n=t.width<=0||t.height<=0;this._layers=[],dn(this.boxes,i=>{n&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,s)=>{i._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,n=this.data.datasets.length;t<n;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,n=this.data.datasets.length;t<n;++t)this._updateDataset(t,ec(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const n=this.getDatasetMeta(e),i={meta:n,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(n.controller._update(t),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(ma.has(this)?this.attached&&!ma.running(this)&&ma.start(this):(this.draw(),KA({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:n,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(n,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,n=[];let i,s;for(i=0,s=t.length;i<s;++i){const o=t[i];(!e||o.visible)&&n.push(o)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,n={meta:e,index:e.index,cancelable:!0},i=uB(this,e);this.notifyPlugins("beforeDatasetDraw",n)!==!1&&(i&&M2(t,i),e.controller.draw(),i&&D2(t),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(e){return sm(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,n,i){const s=BB.modes[t];return typeof s=="function"?s(this,e,n,i):[]}getDatasetMeta(e){const t=this.data.datasets[e],n=this._metasets;let i=n.filter(s=>s&&s._dataset===t).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(i)),i}getContext(){return this.$context||(this.$context=xu(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const n=this.getDatasetMeta(e);return typeof n.hidden=="boolean"?!n.hidden:!t.hidden}setDatasetVisibility(e,t){const n=this.getDatasetMeta(e);n.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,n){const i=n?"show":"hide",s=this.getDatasetMeta(e),o=s.controller._resolveAnimations(void 0,i);nm(t)?(s.data[t].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),o.update(s,{visible:n}),this.update(l=>l.datasetIndex===e?i:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),ma.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),pA(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete Eg[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,n=(s,o)=>{t.addEventListener(this,s,o),e[s]=o},i=(s,o,l)=>{s.offsetX=o,s.offsetY=l,this._eventHandler(s)};dn(this.options.events,s=>n(s,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,n=(u,f)=>{t.addEventListener(this,u,f),e[u]=f},i=(u,f)=>{e[u]&&(t.removeEventListener(this,u,f),delete e[u])},s=(u,f)=>{this.canvas&&this.resize(u,f)};let o;const l=()=>{i("attach",l),this.attached=!0,this.resize(),n("resize",s),n("detach",o)};o=()=>{this.attached=!1,i("resize",s),this._stop(),this._resize(0,0),n("attach",l)},t.isAttached(this.canvas)?l():o()}unbindEvents(){dn(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},dn(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,n){const i=n?"set":"remove";let s,o,l,u;for(t==="dataset"&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+i+"DatasetHoverStyle"]()),l=0,u=e.length;l<u;++l){o=e[l];const f=o&&this.getDatasetMeta(o.datasetIndex).controller;f&&f[i+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],n=e.map(({datasetIndex:s,index:o})=>{const l=this.getDatasetMeta(s);if(!l)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:l.data[o],index:o}});!cy(n,t)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,t))}notifyPlugins(e,t,n){return this._plugins.notify(this,e,t,n)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,n){const i=this.options.hover,s=(u,f)=>u.filter(m=>!f.some(y=>m.datasetIndex===y.datasetIndex&&m.index===y.index)),o=s(t,e),l=n?e:s(e,t);o.length&&this.updateHoverStyle(o,i.mode,!1),l.length&&i.mode&&this.updateHoverStyle(l,i.mode,!0)}_eventHandler(e,t){const n={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},i=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",n,i)===!1)return;const s=this._handleEvent(e,t,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,i),(s||n.changed)&&this.render(),this}_handleEvent(e,t,n){const{_active:i=[],options:s}=this,o=t,l=this._getActiveElements(e,i,n,o),u=$V(e),f=HU(e,this._lastEvent,n,u);n&&(this._lastEvent=null,Nn(s.onHover,[e,l,this],this),u&&Nn(s.onClick,[e,l,this],this));const m=!cy(l,i);return(m||t)&&(this._active=l,this._updateHoverStyles(l,i,t)),this._lastEvent=f,m}_getActiveElements(e,t,n,i){if(e.type==="mouseout")return[];if(!n)return t;const s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,i)}},Xe(Sl,"defaults",Yn),Xe(Sl,"instances",Eg),Xe(Sl,"overrides",fu),Xe(Sl,"registry",Ao),Xe(Sl,"version",zU),Xe(Sl,"getChart",YA),Sl);function ZA(){return dn(Pm.instances,r=>r._plugins.invalidate())}function $U(r,e,t){const{startAngle:n,x:i,y:s,outerRadius:o,innerRadius:l,options:u}=e,{borderWidth:f,borderJoinStyle:m}=u,y=Math.min(f/o,io(n-t));if(r.beginPath(),r.arc(i,s,o-f/2,n+y/2,t-y/2),l>0){const g=Math.min(f/l,io(n-t));r.arc(i,s,l+f/2,t-g/2,n+g/2,!0)}else{const g=Math.min(f/2,o*io(n-t));if(m==="round")r.arc(i,s,g,t-hn/2,n+hn/2,!0);else if(m==="bevel"){const _=2*g*g,E=-_*Math.cos(t+hn/2)+i,x=-_*Math.sin(t+hn/2)+s,w=_*Math.cos(n+hn/2)+i,S=_*Math.sin(n+hn/2)+s;r.lineTo(E,x),r.lineTo(w,S)}}r.closePath(),r.moveTo(0,0),r.rect(0,0,r.canvas.width,r.canvas.height),r.clip("evenodd")}function WU(r,e,t){const{startAngle:n,pixelMargin:i,x:s,y:o,outerRadius:l,innerRadius:u}=e;let f=i/l;r.beginPath(),r.arc(s,o,l,n-f,t+f),u>i?(f=i/u,r.arc(s,o,u,t+f,n-f,!0)):r.arc(s,o,i,t+fr,n-fr),r.closePath(),r.clip()}function GU(r){return L2(r,["outerStart","outerEnd","innerStart","innerEnd"])}function KU(r,e,t,n){const i=GU(r.options.borderRadius),s=(t-e)/2,o=Math.min(s,n*e/2),l=u=>{const f=(t-Math.min(s,u))*n/2;return Zr(u,0,Math.min(s,f))};return{outerStart:l(i.outerStart),outerEnd:l(i.outerEnd),innerStart:Zr(i.innerStart,0,o),innerEnd:Zr(i.innerEnd,0,o)}}function rd(r,e,t,n){return{x:t+r*Math.cos(e),y:n+r*Math.sin(e)}}function py(r,e,t,n,i,s){const{x:o,y:l,startAngle:u,pixelMargin:f,innerRadius:m}=e,y=Math.max(e.outerRadius+n+t-f,0),g=m>0?m+n+t+f:0;let _=0;const E=i-u;if(n){const G=m>0?m-n:0,ie=y>0?y-n:0,oe=(G+ie)/2,ee=oe!==0?E*oe/(oe+n):E;_=(E-ee)/2}const x=Math.max(.001,E*y-t/hn)/y,w=(E-x)/2,S=u+w+_,I=i-w-_,{outerStart:C,outerEnd:N,innerStart:R,innerEnd:B}=KU(e,g,y,I-S),P=y-C,k=y-N,F=S+C/P,j=I-N/k,O=g+R,D=g+B,M=S+R/O,$=I-B/D;if(r.beginPath(),s){const G=(F+j)/2;if(r.arc(o,l,y,F,G),r.arc(o,l,y,G,j),N>0){const J=rd(k,j,o,l);r.arc(J.x,J.y,N,j,I+fr)}const ie=rd(D,I,o,l);if(r.lineTo(ie.x,ie.y),B>0){const J=rd(D,$,o,l);r.arc(J.x,J.y,B,I+fr,$+Math.PI)}const oe=(I-B/g+(S+R/g))/2;if(r.arc(o,l,g,I-B/g,oe,!0),r.arc(o,l,g,oe,S+R/g,!0),R>0){const J=rd(O,M,o,l);r.arc(J.x,J.y,R,M+Math.PI,S-fr)}const ee=rd(P,S,o,l);if(r.lineTo(ee.x,ee.y),C>0){const J=rd(P,F,o,l);r.arc(J.x,J.y,C,S-fr,F)}}else{r.moveTo(o,l);const G=Math.cos(F)*y+o,ie=Math.sin(F)*y+l;r.lineTo(G,ie);const oe=Math.cos(j)*y+o,ee=Math.sin(j)*y+l;r.lineTo(oe,ee)}r.closePath()}function YU(r,e,t,n,i){const{fullCircles:s,startAngle:o,circumference:l}=e;let u=e.endAngle;if(s){py(r,e,t,n,u,i);for(let f=0;f<s;++f)r.fill();isNaN(l)||(u=o+(l%qn||qn))}return py(r,e,t,n,u,i),r.fill(),u}function ZU(r,e,t,n,i){const{fullCircles:s,startAngle:o,circumference:l,options:u}=e,{borderWidth:f,borderJoinStyle:m,borderDash:y,borderDashOffset:g,borderRadius:_}=u,E=u.borderAlign==="inner";if(!f)return;r.setLineDash(y||[]),r.lineDashOffset=g,E?(r.lineWidth=f*2,r.lineJoin=m||"round"):(r.lineWidth=f,r.lineJoin=m||"bevel");let x=e.endAngle;if(s){py(r,e,t,n,x,i);for(let w=0;w<s;++w)r.stroke();isNaN(l)||(x=o+(l%qn||qn))}E&&WU(r,e,x),u.selfJoin&&x-o>=hn&&_===0&&m!=="miter"&&$U(r,e,x),s||(py(r,e,t,n,x,i),r.stroke())}class hf extends La{constructor(t){super();Xe(this,"circumference");Xe(this,"endAngle");Xe(this,"fullCircles");Xe(this,"innerRadius");Xe(this,"outerRadius");Xe(this,"pixelMargin");Xe(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,n,i){const s=this.getProps(["x","y"],i),{angle:o,distance:l}=k3(s,{x:t,y:n}),{startAngle:u,endAngle:f,innerRadius:m,outerRadius:y,circumference:g}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),_=(this.options.spacing+this.options.borderWidth)/2,E=Dt(g,f-u),x=im(o,u,f)&&u!==f,w=E>=qn||x,S=Ol(l,m+_,y+_);return w&&S}getCenterPoint(t){const{x:n,y:i,startAngle:s,endAngle:o,innerRadius:l,outerRadius:u}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:f,spacing:m}=this.options,y=(s+o)/2,g=(l+u+m+f)/2;return{x:n+Math.cos(y)*g,y:i+Math.sin(y)*g}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:n,circumference:i}=this,s=(n.offset||0)/4,o=(n.spacing||0)/2,l=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=i>qn?Math.floor(i/qn):0,i===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const u=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(u)*s,Math.sin(u)*s);const f=1-Math.sin(Math.min(hn,i||0)),m=s*f;t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor,YU(t,this,m,o,l),ZU(t,this,m,o,l),t.restore()}}Xe(hf,"id","arc"),Xe(hf,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),Xe(hf,"defaultRoutes",{backgroundColor:"backgroundColor"}),Xe(hf,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"});function rR(r,e,t=e){r.lineCap=Dt(t.borderCapStyle,e.borderCapStyle),r.setLineDash(Dt(t.borderDash,e.borderDash)),r.lineDashOffset=Dt(t.borderDashOffset,e.borderDashOffset),r.lineJoin=Dt(t.borderJoinStyle,e.borderJoinStyle),r.lineWidth=Dt(t.borderWidth,e.borderWidth),r.strokeStyle=Dt(t.borderColor,e.borderColor)}function QU(r,e,t){r.lineTo(t.x,t.y)}function XU(r){return r.stepped?vz:r.tension||r.cubicInterpolationMode==="monotone"?_z:QU}function iR(r,e,t={}){const n=r.length,{start:i=0,end:s=n-1}=t,{start:o,end:l}=e,u=Math.max(i,o),f=Math.min(s,l),m=i<o&&s<o||i>l&&s>l;return{count:n,start:u,loop:e.loop,ilen:f<u&&!m?n+f-u:f-u}}function JU(r,e,t,n){const{points:i,options:s}=e,{count:o,start:l,loop:u,ilen:f}=iR(i,t,n),m=XU(s);let{move:y=!0,reverse:g}=n||{},_,E,x;for(_=0;_<=f;++_)E=i[(l+(g?f-_:_))%o],!E.skip&&(y?(r.moveTo(E.x,E.y),y=!1):m(r,x,E,g,s.stepped),x=E);return u&&(E=i[(l+(g?f:0))%o],m(r,x,E,g,s.stepped)),!!u}function eq(r,e,t,n){const i=e.points,{count:s,start:o,ilen:l}=iR(i,t,n),{move:u=!0,reverse:f}=n||{};let m=0,y=0,g,_,E,x,w,S;const I=N=>(o+(f?l-N:N))%s,C=()=>{x!==w&&(r.lineTo(m,w),r.lineTo(m,x),r.lineTo(m,S))};for(u&&(_=i[I(0)],r.moveTo(_.x,_.y)),g=0;g<=l;++g){if(_=i[I(g)],_.skip)continue;const N=_.x,R=_.y,B=N|0;B===E?(R<x?x=R:R>w&&(w=R),m=(y*m+N)/++y):(C(),r.lineTo(N,R),E=B,y=0,x=w=R),S=R}C()}function $x(r){const e=r.options,t=e.borderDash&&e.borderDash.length;return!r._decimated&&!r._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?eq:JU}function tq(r){return r.stepped?Qz:r.tension||r.cubicInterpolationMode==="monotone"?Xz:Vc}function nq(r,e,t,n){let i=e._path;i||(i=e._path=new Path2D,e.path(i,t,n)&&i.closePath()),rR(r,e.options),r.stroke(i)}function rq(r,e,t,n){const{segments:i,options:s}=e,o=$x(e);for(const l of i)rR(r,s,l.style),r.beginPath(),o(r,e,l,{start:t,end:t+n-1})&&r.closePath(),r.stroke()}const iq=typeof Path2D=="function";function sq(r,e,t,n){iq&&!e.options.segment?nq(r,e,t,n):rq(r,e,t,n)}class ff extends La{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const n=this.options;if((n.tension||n.cubicInterpolationMode==="monotone")&&!n.stepped&&!this._pointsUpdated){const i=n.spanGaps?this._loop:this._fullLoop;qz(this._points,n,e,i,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=oB(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,n=e.length;return n&&t[e[n-1].end]}interpolate(e,t){const n=this.options,i=e[t],s=this.points,o=rB(this,{property:t,start:i,end:i});if(!o.length)return;const l=[],u=tq(n);let f,m;for(f=0,m=o.length;f<m;++f){const{start:y,end:g}=o[f],_=s[y],E=s[g];if(_===E){l.push(_);continue}const x=Math.abs((i-_[t])/(E[t]-_[t])),w=u(_,E,x,n.stepped);w[t]=e[t],l.push(w)}return l.length===1?l[0]:l}pathSegment(e,t,n){return $x(this)(e,this,t,n)}path(e,t,n){const i=this.segments,s=$x(this);let o=this._loop;t=t||0,n=n||this.points.length-t;for(const l of i)o&=s(e,this,l,{start:t,end:t+n-1});return!!o}draw(e,t,n,i){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),sq(e,this,n,i),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Xe(ff,"id","line"),Xe(ff,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Xe(ff,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Xe(ff,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function QA(r,e,t,n){const i=r.options,{[t]:s}=r.getProps([t],n);return Math.abs(e-s)<i.radius+i.hitRadius}class Tg extends La{constructor(t){super();Xe(this,"parsed");Xe(this,"skip");Xe(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,n,i){const s=this.options,{x:o,y:l}=this.getProps(["x","y"],i);return Math.pow(t-o,2)+Math.pow(n-l,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(t,n){return QA(this,t,"x",n)}inYRange(t,n){return QA(this,t,"y",n)}getCenterPoint(t){const{x:n,y:i}=this.getProps(["x","y"],t);return{x:n,y:i}}size(t){t=t||this.options||{};let n=t.radius||0;n=Math.max(n,n&&t.hoverRadius||0);const i=n&&t.borderWidth||0;return(n+i)*2}draw(t,n){const i=this.options;this.skip||i.radius<.1||!sm(this,n,this.size(i)/2)||(t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.fillStyle=i.backgroundColor,Bx(t,i,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}Xe(Tg,"id","point"),Xe(Tg,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Xe(Tg,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function sR(r,e){const{x:t,y:n,base:i,width:s,height:o}=r.getProps(["x","y","base","width","height"],e);let l,u,f,m,y;return r.horizontal?(y=o/2,l=Math.min(t,i),u=Math.max(t,i),f=n-y,m=n+y):(y=s/2,l=t-y,u=t+y,f=Math.min(n,i),m=Math.max(n,i)),{left:l,top:f,right:u,bottom:m}}function Ml(r,e,t,n){return r?0:Zr(e,t,n)}function oq(r,e,t){const n=r.options.borderWidth,i=r.borderSkipped,s=D3(n);return{t:Ml(i.top,s.top,0,t),r:Ml(i.right,s.right,0,e),b:Ml(i.bottom,s.bottom,0,t),l:Ml(i.left,s.left,0,e)}}function aq(r,e,t){const{enableBorderRadius:n}=r.getProps(["enableBorderRadius"]),i=r.options.borderRadius,s=vd(i),o=Math.min(e,t),l=r.borderSkipped,u=n||Zt(i);return{topLeft:Ml(!u||l.top||l.left,s.topLeft,0,o),topRight:Ml(!u||l.top||l.right,s.topRight,0,o),bottomLeft:Ml(!u||l.bottom||l.left,s.bottomLeft,0,o),bottomRight:Ml(!u||l.bottom||l.right,s.bottomRight,0,o)}}function lq(r){const e=sR(r),t=e.right-e.left,n=e.bottom-e.top,i=oq(r,t/2,n/2),s=aq(r,t/2,n/2);return{outer:{x:e.left,y:e.top,w:t,h:n,radius:s},inner:{x:e.left+i.l,y:e.top+i.t,w:t-i.l-i.r,h:n-i.t-i.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,s.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(i.b,i.r))}}}}function u1(r,e,t,n){const i=e===null,s=t===null,l=r&&!(i&&s)&&sR(r,n);return l&&(i||Ol(e,l.left,l.right))&&(s||Ol(t,l.top,l.bottom))}function cq(r){return r.topLeft||r.topRight||r.bottomLeft||r.bottomRight}function uq(r,e){r.rect(e.x,e.y,e.w,e.h)}function d1(r,e,t={}){const n=r.x!==t.x?-e:0,i=r.y!==t.y?-e:0,s=(r.x+r.w!==t.x+t.w?e:0)-n,o=(r.y+r.h!==t.y+t.h?e:0)-i;return{x:r.x+n,y:r.y+i,w:r.w+s,h:r.h+o,radius:r.radius}}class Of extends La{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:n,backgroundColor:i}}=this,{inner:s,outer:o}=lq(this),l=cq(o.radius)?hy:uq;e.save(),(o.w!==s.w||o.h!==s.h)&&(e.beginPath(),l(e,d1(o,t,s)),e.clip(),l(e,d1(s,-t,o)),e.fillStyle=n,e.fill("evenodd")),e.beginPath(),l(e,d1(s,t)),e.fillStyle=i,e.fill(),e.restore()}inRange(e,t,n){return u1(this,e,t,n)}inXRange(e,t){return u1(this,e,null,t)}inYRange(e,t){return u1(this,null,e,t)}getCenterPoint(e){const{x:t,y:n,base:i,horizontal:s}=this.getProps(["x","y","base","horizontal"],e);return{x:s?(t+i)/2:t,y:s?n:(n+i)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}Xe(Of,"id","bar"),Xe(Of,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Xe(Of,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const XA=(r,e)=>{let{boxHeight:t=e,boxWidth:n=e}=r;return r.usePointStyle&&(t=Math.min(t,e),n=r.pointStyleWidth||Math.min(n,e)),{boxWidth:n,boxHeight:t,itemHeight:Math.max(e,t)}},dq=(r,e)=>r!==null&&e!==null&&r.datasetIndex===e.datasetIndex&&r.index===e.index;class JA extends La{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,n){this.maxWidth=e,this.maxHeight=t,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Nn(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(n=>e.filter(n,this.chart.data))),e.sort&&(t=t.sort((n,i)=>e.sort(n,i,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const n=e.labels,i=Qr(n.font),s=i.size,o=this._computeTitleHeight(),{boxWidth:l,itemHeight:u}=XA(n,s);let f,m;t.font=i.string,this.isHorizontal()?(f=this.maxWidth,m=this._fitRows(o,s,l,u)+10):(m=this.maxHeight,f=this._fitCols(o,i,l,u)+10),this.width=Math.min(f,e.maxWidth||this.maxWidth),this.height=Math.min(m,e.maxHeight||this.maxHeight)}_fitRows(e,t,n,i){const{ctx:s,maxWidth:o,options:{labels:{padding:l}}}=this,u=this.legendHitBoxes=[],f=this.lineWidths=[0],m=i+l;let y=e;s.textAlign="left",s.textBaseline="middle";let g=-1,_=-m;return this.legendItems.forEach((E,x)=>{const w=n+t/2+s.measureText(E.text).width;(x===0||f[f.length-1]+w+2*l>o)&&(y+=m,f[f.length-(x>0?0:1)]=0,_+=m,g++),u[x]={left:0,top:_,row:g,width:w,height:i},f[f.length-1]+=w+l}),y}_fitCols(e,t,n,i){const{ctx:s,maxHeight:o,options:{labels:{padding:l}}}=this,u=this.legendHitBoxes=[],f=this.columnSizes=[],m=o-e;let y=l,g=0,_=0,E=0,x=0;return this.legendItems.forEach((w,S)=>{const{itemWidth:I,itemHeight:C}=hq(n,t,s,w,i);S>0&&_+C+2*l>m&&(y+=g+l,f.push({width:g,height:_}),E+=g+l,x++,g=_=0),u[S]={left:E,top:_,col:x,width:I,height:C},g=Math.max(g,I),_+=C+l}),y+=g,f.push({width:g,height:_}),y}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:n,labels:{padding:i},rtl:s}}=this,o=_d(s,this.left,this.width);if(this.isHorizontal()){let l=0,u=Gr(n,this.left+i,this.right-this.lineWidths[l]);for(const f of t)l!==f.row&&(l=f.row,u=Gr(n,this.left+i,this.right-this.lineWidths[l])),f.top+=this.top+e+i,f.left=o.leftForLtr(o.x(u),f.width),u+=f.width+i}else{let l=0,u=Gr(n,this.top+e+i,this.bottom-this.columnSizes[l].height);for(const f of t)f.col!==l&&(l=f.col,u=Gr(n,this.top+e+i,this.bottom-this.columnSizes[l].height)),f.top=u,f.left+=this.left+i,f.left=o.leftForLtr(o.x(f.left),f.width),u+=f.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;M2(e,this),this._draw(),D2(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:n,ctx:i}=this,{align:s,labels:o}=e,l=Yn.color,u=_d(e.rtl,this.left,this.width),f=Qr(o.font),{padding:m}=o,y=f.size,g=y/2;let _;this.drawTitle(),i.textAlign=u.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=f.string;const{boxWidth:E,boxHeight:x,itemHeight:w}=XA(o,y),S=function(B,P,k){if(isNaN(E)||E<=0||isNaN(x)||x<0)return;i.save();const F=Dt(k.lineWidth,1);if(i.fillStyle=Dt(k.fillStyle,l),i.lineCap=Dt(k.lineCap,"butt"),i.lineDashOffset=Dt(k.lineDashOffset,0),i.lineJoin=Dt(k.lineJoin,"miter"),i.lineWidth=F,i.strokeStyle=Dt(k.strokeStyle,l),i.setLineDash(Dt(k.lineDash,[])),o.usePointStyle){const j={radius:x*Math.SQRT2/2,pointStyle:k.pointStyle,rotation:k.rotation,borderWidth:F},O=u.xPlus(B,E/2),D=P+g;M3(i,j,O,D,o.pointStyleWidth&&E)}else{const j=P+Math.max((y-x)/2,0),O=u.leftForLtr(B,E),D=vd(k.borderRadius);i.beginPath(),Object.values(D).some(M=>M!==0)?hy(i,{x:O,y:j,w:E,h:x,radius:D}):i.rect(O,j,E,x),i.fill(),F!==0&&i.stroke()}i.restore()},I=function(B,P,k){om(i,k.text,B,P+w/2,f,{strikethrough:k.hidden,textAlign:u.textAlign(k.textAlign)})},C=this.isHorizontal(),N=this._computeTitleHeight();C?_={x:Gr(s,this.left+m,this.right-n[0]),y:this.top+m+N,line:0}:_={x:this.left+m,y:Gr(s,this.top+N+m,this.bottom-t[0].height),line:0},U3(this.ctx,e.textDirection);const R=w+m;this.legendItems.forEach((B,P)=>{i.strokeStyle=B.fontColor,i.fillStyle=B.fontColor;const k=i.measureText(B.text).width,F=u.textAlign(B.textAlign||(B.textAlign=o.textAlign)),j=E+g+k;let O=_.x,D=_.y;u.setWidth(this.width),C?P>0&&O+j+m>this.right&&(D=_.y+=R,_.line++,O=_.x=Gr(s,this.left+m,this.right-n[_.line])):P>0&&D+R>this.bottom&&(O=_.x=O+t[_.line].width+m,_.line++,D=_.y=Gr(s,this.top+N+m,this.bottom-t[_.line].height));const M=u.x(O);if(S(M,D,B),O=sz(F,O+E+g,C?O+j:this.right,e.rtl),I(u.x(O),D,B),C)_.x+=j+m;else if(typeof B.text!="string"){const $=f.lineHeight;_.y+=oR(B,$)+m}else _.y+=R}),q3(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,n=Qr(t.font),i=Ds(t.padding);if(!t.display)return;const s=_d(e.rtl,this.left,this.width),o=this.ctx,l=t.position,u=n.size/2,f=i.top+u;let m,y=this.left,g=this.width;if(this.isHorizontal())g=Math.max(...this.lineWidths),m=this.top+f,y=Gr(e.align,y,this.right-g);else{const E=this.columnSizes.reduce((x,w)=>Math.max(x,w.height),0);m=f+Gr(e.align,this.top,this.bottom-E-e.labels.padding-this._computeTitleHeight())}const _=Gr(l,y,y+g);o.textAlign=s.textAlign(R2(l)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=n.string,om(o,t.text,_,m,n)}_computeTitleHeight(){const e=this.options.title,t=Qr(e.font),n=Ds(e.padding);return e.display?t.lineHeight+n.height:0}_getLegendItemAt(e,t){let n,i,s;if(Ol(e,this.left,this.right)&&Ol(t,this.top,this.bottom)){for(s=this.legendHitBoxes,n=0;n<s.length;++n)if(i=s[n],Ol(e,i.left,i.left+i.width)&&Ol(t,i.top,i.top+i.height))return this.legendItems[n]}return null}handleEvent(e){const t=this.options;if(!pq(e.type,t))return;const n=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const i=this._hoveredItem,s=dq(i,n);i&&!s&&Nn(t.onLeave,[e,i,this],this),this._hoveredItem=n,n&&!s&&Nn(t.onHover,[e,n,this],this)}else n&&Nn(t.onClick,[e,n,this],this)}}function hq(r,e,t,n,i){const s=fq(n,r,e,t),o=mq(i,n,e.lineHeight);return{itemWidth:s,itemHeight:o}}function fq(r,e,t,n){let i=r.text;return i&&typeof i!="string"&&(i=i.reduce((s,o)=>s.length>o.length?s:o)),e+t.size/2+n.measureText(i).width}function mq(r,e,t){let n=r;return typeof e.text!="string"&&(n=oR(e,t)),n}function oR(r,e){const t=r.text?r.text.length:0;return e*t}function pq(r,e){return!!((r==="mousemove"||r==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(r==="click"||r==="mouseup"))}var aR={id:"legend",_element:JA,start(r,e,t){const n=r.legend=new JA({ctx:r.ctx,options:t,chart:r});Ss.configure(r,n,t),Ss.addBox(r,n)},stop(r){Ss.removeBox(r,r.legend),delete r.legend},beforeUpdate(r,e,t){const n=r.legend;Ss.configure(r,n,t),n.options=t},afterUpdate(r){const e=r.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(r,e){e.replay||r.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(r,e,t){const n=e.datasetIndex,i=t.chart;i.isDatasetVisible(n)?(i.hide(n),e.hidden=!0):(i.show(n),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:r=>r.chart.options.color,boxWidth:40,padding:10,generateLabels(r){const e=r.data.datasets,{labels:{usePointStyle:t,pointStyle:n,textAlign:i,color:s,useBorderRadius:o,borderRadius:l}}=r.legend.options;return r._getSortedDatasetMetas().map(u=>{const f=u.controller.getStyle(t?0:void 0),m=Ds(f.borderWidth);return{text:e[u.index].label,fillStyle:f.backgroundColor,fontColor:s,hidden:!u.visible,lineCap:f.borderCapStyle,lineDash:f.borderDash,lineDashOffset:f.borderDashOffset,lineJoin:f.borderJoinStyle,lineWidth:(m.width+m.height)/4,strokeStyle:f.borderColor,pointStyle:n||f.pointStyle,rotation:f.rotation,textAlign:i||f.textAlign,borderRadius:o&&(l||f.borderRadius),datasetIndex:u.index}},this)}},title:{color:r=>r.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:r=>!r.startsWith("on"),labels:{_scriptable:r=>!["generateLabels","filter","sort"].includes(r)}}};class lR extends La{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const i=dr(n.text)?n.text.length:1;this._padding=Ds(n.padding);const s=i*Qr(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:n,bottom:i,right:s,options:o}=this,l=o.align;let u=0,f,m,y;return this.isHorizontal()?(m=Gr(l,n,s),y=t+e,f=s-n):(o.position==="left"?(m=n+e,y=Gr(l,i,t),u=hn*-.5):(m=s-e,y=Gr(l,t,i),u=hn*.5),f=i-t),{titleX:m,titleY:y,maxWidth:f,rotation:u}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const n=Qr(t.font),s=n.lineHeight/2+this._padding.top,{titleX:o,titleY:l,maxWidth:u,rotation:f}=this._drawArgs(s);om(e,t.text,0,0,n,{color:t.color,maxWidth:u,rotation:f,textAlign:R2(t.align),textBaseline:"middle",translation:[o,l]})}}function gq(r,e){const t=new lR({ctx:r.ctx,options:e,chart:r});Ss.configure(r,t,e),Ss.addBox(r,t),r.titleBlock=t}var cR={id:"title",_element:lR,start(r,e,t){gq(r,t)},stop(r){const e=r.titleBlock;Ss.removeBox(r,e),delete r.titleBlock},beforeUpdate(r,e,t){const n=r.titleBlock;Ss.configure(r,n,t),n.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const mf={average(r){if(!r.length)return!1;let e,t,n=new Set,i=0,s=0;for(e=0,t=r.length;e<t;++e){const l=r[e].element;if(l&&l.hasValue()){const u=l.tooltipPosition();n.add(u.x),i+=u.y,++s}}return s===0||n.size===0?!1:{x:[...n].reduce((l,u)=>l+u)/n.size,y:i/s}},nearest(r,e){if(!r.length)return!1;let t=e.x,n=e.y,i=Number.POSITIVE_INFINITY,s,o,l;for(s=0,o=r.length;s<o;++s){const u=r[s].element;if(u&&u.hasValue()){const f=u.getCenterPoint(),m=Vx(e,f);m<i&&(i=m,l=u)}}if(l){const u=l.tooltipPosition();t=u.x,n=u.y}return{x:t,y:n}}};function So(r,e){return e&&(dr(e)?Array.prototype.push.apply(r,e):r.push(e)),r}function pa(r){return(typeof r=="string"||r instanceof String)&&r.indexOf(`
`)>-1?r.split(`
`):r}function yq(r,e){const{element:t,datasetIndex:n,index:i}=e,s=r.getDatasetMeta(n).controller,{label:o,value:l}=s.getLabelAndValue(i);return{chart:r,label:o,parsed:s.getParsed(i),raw:r.data.datasets[n].data[i],formattedValue:l,dataset:s.getDataset(),dataIndex:i,datasetIndex:n,element:t}}function eI(r,e){const t=r.chart.ctx,{body:n,footer:i,title:s}=r,{boxWidth:o,boxHeight:l}=e,u=Qr(e.bodyFont),f=Qr(e.titleFont),m=Qr(e.footerFont),y=s.length,g=i.length,_=n.length,E=Ds(e.padding);let x=E.height,w=0,S=n.reduce((N,R)=>N+R.before.length+R.lines.length+R.after.length,0);if(S+=r.beforeBody.length+r.afterBody.length,y&&(x+=y*f.lineHeight+(y-1)*e.titleSpacing+e.titleMarginBottom),S){const N=e.displayColors?Math.max(l,u.lineHeight):u.lineHeight;x+=_*N+(S-_)*u.lineHeight+(S-1)*e.bodySpacing}g&&(x+=e.footerMarginTop+g*m.lineHeight+(g-1)*e.footerSpacing);let I=0;const C=function(N){w=Math.max(w,t.measureText(N).width+I)};return t.save(),t.font=f.string,dn(r.title,C),t.font=u.string,dn(r.beforeBody.concat(r.afterBody),C),I=e.displayColors?o+2+e.boxPadding:0,dn(n,N=>{dn(N.before,C),dn(N.lines,C),dn(N.after,C)}),I=0,t.font=m.string,dn(r.footer,C),t.restore(),w+=E.width,{width:w,height:x}}function vq(r,e){const{y:t,height:n}=e;return t<n/2?"top":t>r.height-n/2?"bottom":"center"}function _q(r,e,t,n){const{x:i,width:s}=n,o=t.caretSize+t.caretPadding;if(r==="left"&&i+s+o>e.width||r==="right"&&i-s-o<0)return!0}function xq(r,e,t,n){const{x:i,width:s}=t,{width:o,chartArea:{left:l,right:u}}=r;let f="center";return n==="center"?f=i<=(l+u)/2?"left":"right":i<=s/2?f="left":i>=o-s/2&&(f="right"),_q(f,r,e,t)&&(f="center"),f}function tI(r,e,t){const n=t.yAlign||e.yAlign||vq(r,t);return{xAlign:t.xAlign||e.xAlign||xq(r,e,t,n),yAlign:n}}function bq(r,e){let{x:t,width:n}=r;return e==="right"?t-=n:e==="center"&&(t-=n/2),t}function wq(r,e,t){let{y:n,height:i}=r;return e==="top"?n+=t:e==="bottom"?n-=i+t:n-=i/2,n}function nI(r,e,t,n){const{caretSize:i,caretPadding:s,cornerRadius:o}=r,{xAlign:l,yAlign:u}=t,f=i+s,{topLeft:m,topRight:y,bottomLeft:g,bottomRight:_}=vd(o);let E=bq(e,l);const x=wq(e,u,f);return u==="center"?l==="left"?E+=f:l==="right"&&(E-=f):l==="left"?E-=Math.max(m,g)+i:l==="right"&&(E+=Math.max(y,_)+i),{x:Zr(E,0,n.width-e.width),y:Zr(x,0,n.height-e.height)}}function Xp(r,e,t){const n=Ds(t.padding);return e==="center"?r.x+r.width/2:e==="right"?r.x+r.width-n.right:r.x+n.left}function rI(r){return So([],pa(r))}function Eq(r,e,t){return xu(r,{tooltip:e,tooltipItems:t,type:"tooltip"})}function iI(r,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?r.override(t):r}const uR={beforeTitle:ha,title(r){if(r.length>0){const e=r[0],t=e.chart.data.labels,n=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(n>0&&e.dataIndex<n)return t[e.dataIndex]}return""},afterTitle:ha,beforeBody:ha,beforeLabel:ha,label(r){if(this&&this.options&&this.options.mode==="dataset")return r.label+": "+r.formattedValue||r.formattedValue;let e=r.dataset.label||"";e&&(e+=": ");const t=r.formattedValue;return on(t)||(e+=t),e},labelColor(r){const t=r.chart.getDatasetMeta(r.datasetIndex).controller.getStyle(r.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(r){const t=r.chart.getDatasetMeta(r.datasetIndex).controller.getStyle(r.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:ha,afterBody:ha,beforeFooter:ha,footer:ha,afterFooter:ha};function ji(r,e,t,n){const i=r[e].call(t,n);return typeof i>"u"?uR[e].call(t,n):i}var Z_;let sI=(Z_=class extends La{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,n=this.options.setContext(this.getContext()),i=n.enabled&&t.options.animation&&n.animations,s=new $3(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=Eq(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:n}=t,i=ji(n,"beforeTitle",this,e),s=ji(n,"title",this,e),o=ji(n,"afterTitle",this,e);let l=[];return l=So(l,pa(i)),l=So(l,pa(s)),l=So(l,pa(o)),l}getBeforeBody(e,t){return rI(ji(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:n}=t,i=[];return dn(e,s=>{const o={before:[],lines:[],after:[]},l=iI(n,s);So(o.before,pa(ji(l,"beforeLabel",this,s))),So(o.lines,ji(l,"label",this,s)),So(o.after,pa(ji(l,"afterLabel",this,s))),i.push(o)}),i}getAfterBody(e,t){return rI(ji(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:n}=t,i=ji(n,"beforeFooter",this,e),s=ji(n,"footer",this,e),o=ji(n,"afterFooter",this,e);let l=[];return l=So(l,pa(i)),l=So(l,pa(s)),l=So(l,pa(o)),l}_createItems(e){const t=this._active,n=this.chart.data,i=[],s=[],o=[];let l=[],u,f;for(u=0,f=t.length;u<f;++u)l.push(yq(this.chart,t[u]));return e.filter&&(l=l.filter((m,y,g)=>e.filter(m,y,g,n))),e.itemSort&&(l=l.sort((m,y)=>e.itemSort(m,y,n))),dn(l,m=>{const y=iI(e.callbacks,m);i.push(ji(y,"labelColor",this,m)),s.push(ji(y,"labelPointStyle",this,m)),o.push(ji(y,"labelTextColor",this,m))}),this.labelColors=i,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=l,l}update(e,t){const n=this.options.setContext(this.getContext()),i=this._active;let s,o=[];if(!i.length)this.opacity!==0&&(s={opacity:0});else{const l=mf[n.position].call(this,i,this._eventPosition);o=this._createItems(n),this.title=this.getTitle(o,n),this.beforeBody=this.getBeforeBody(o,n),this.body=this.getBody(o,n),this.afterBody=this.getAfterBody(o,n),this.footer=this.getFooter(o,n);const u=this._size=eI(this,n),f=Object.assign({},l,u),m=tI(this.chart,n,f),y=nI(n,f,m,this.chart);this.xAlign=m.xAlign,this.yAlign=m.yAlign,s={opacity:1,x:y.x,y:y.y,width:u.width,height:u.height,caretX:l.x,caretY:l.y}}this._tooltipItems=o,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,n,i){const s=this.getCaretPosition(e,n,i);t.lineTo(s.x1,s.y1),t.lineTo(s.x2,s.y2),t.lineTo(s.x3,s.y3)}getCaretPosition(e,t,n){const{xAlign:i,yAlign:s}=this,{caretSize:o,cornerRadius:l}=n,{topLeft:u,topRight:f,bottomLeft:m,bottomRight:y}=vd(l),{x:g,y:_}=e,{width:E,height:x}=t;let w,S,I,C,N,R;return s==="center"?(N=_+x/2,i==="left"?(w=g,S=w-o,C=N+o,R=N-o):(w=g+E,S=w+o,C=N-o,R=N+o),I=w):(i==="left"?S=g+Math.max(u,m)+o:i==="right"?S=g+E-Math.max(f,y)-o:S=this.caretX,s==="top"?(C=_,N=C-o,w=S-o,I=S+o):(C=_+x,N=C+o,w=S+o,I=S-o),R=C),{x1:w,x2:S,x3:I,y1:C,y2:N,y3:R}}drawTitle(e,t,n){const i=this.title,s=i.length;let o,l,u;if(s){const f=_d(n.rtl,this.x,this.width);for(e.x=Xp(this,n.titleAlign,n),t.textAlign=f.textAlign(n.titleAlign),t.textBaseline="middle",o=Qr(n.titleFont),l=n.titleSpacing,t.fillStyle=n.titleColor,t.font=o.string,u=0;u<s;++u)t.fillText(i[u],f.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+l,u+1===s&&(e.y+=n.titleMarginBottom-l)}}_drawColorBox(e,t,n,i,s){const o=this.labelColors[n],l=this.labelPointStyles[n],{boxHeight:u,boxWidth:f}=s,m=Qr(s.bodyFont),y=Xp(this,"left",s),g=i.x(y),_=u<m.lineHeight?(m.lineHeight-u)/2:0,E=t.y+_;if(s.usePointStyle){const x={radius:Math.min(f,u)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},w=i.leftForLtr(g,f)+f/2,S=E+u/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,Bx(e,x,w,S),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,Bx(e,x,w,S)}else{e.lineWidth=Zt(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const x=i.leftForLtr(g,f),w=i.leftForLtr(i.xPlus(g,1),f-2),S=vd(o.borderRadius);Object.values(S).some(I=>I!==0)?(e.beginPath(),e.fillStyle=s.multiKeyBackground,hy(e,{x,y:E,w:f,h:u,radius:S}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),hy(e,{x:w,y:E+1,w:f-2,h:u-2,radius:S}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(x,E,f,u),e.strokeRect(x,E,f,u),e.fillStyle=o.backgroundColor,e.fillRect(w,E+1,f-2,u-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,t,n){const{body:i}=this,{bodySpacing:s,bodyAlign:o,displayColors:l,boxHeight:u,boxWidth:f,boxPadding:m}=n,y=Qr(n.bodyFont);let g=y.lineHeight,_=0;const E=_d(n.rtl,this.x,this.width),x=function(k){t.fillText(k,E.x(e.x+_),e.y+g/2),e.y+=g+s},w=E.textAlign(o);let S,I,C,N,R,B,P;for(t.textAlign=o,t.textBaseline="middle",t.font=y.string,e.x=Xp(this,w,n),t.fillStyle=n.bodyColor,dn(this.beforeBody,x),_=l&&w!=="right"?o==="center"?f/2+m:f+2+m:0,N=0,B=i.length;N<B;++N){for(S=i[N],I=this.labelTextColors[N],t.fillStyle=I,dn(S.before,x),C=S.lines,l&&C.length&&(this._drawColorBox(t,e,N,E,n),g=Math.max(y.lineHeight,u)),R=0,P=C.length;R<P;++R)x(C[R]),g=y.lineHeight;dn(S.after,x)}_=0,g=y.lineHeight,dn(this.afterBody,x),e.y-=s}drawFooter(e,t,n){const i=this.footer,s=i.length;let o,l;if(s){const u=_d(n.rtl,this.x,this.width);for(e.x=Xp(this,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=u.textAlign(n.footerAlign),t.textBaseline="middle",o=Qr(n.footerFont),t.fillStyle=n.footerColor,t.font=o.string,l=0;l<s;++l)t.fillText(i[l],u.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+n.footerSpacing}}drawBackground(e,t,n,i){const{xAlign:s,yAlign:o}=this,{x:l,y:u}=e,{width:f,height:m}=n,{topLeft:y,topRight:g,bottomLeft:_,bottomRight:E}=vd(i.cornerRadius);t.fillStyle=i.backgroundColor,t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.beginPath(),t.moveTo(l+y,u),o==="top"&&this.drawCaret(e,t,n,i),t.lineTo(l+f-g,u),t.quadraticCurveTo(l+f,u,l+f,u+g),o==="center"&&s==="right"&&this.drawCaret(e,t,n,i),t.lineTo(l+f,u+m-E),t.quadraticCurveTo(l+f,u+m,l+f-E,u+m),o==="bottom"&&this.drawCaret(e,t,n,i),t.lineTo(l+_,u+m),t.quadraticCurveTo(l,u+m,l,u+m-_),o==="center"&&s==="left"&&this.drawCaret(e,t,n,i),t.lineTo(l,u+y),t.quadraticCurveTo(l,u,l+y,u),t.closePath(),t.fill(),i.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,n=this.$animations,i=n&&n.x,s=n&&n.y;if(i||s){const o=mf[e.position].call(this,this._active,this._eventPosition);if(!o)return;const l=this._size=eI(this,e),u=Object.assign({},o,this._size),f=tI(t,e,u),m=nI(e,u,f,t);(i._to!==m.x||s._to!==m.y)&&(this.xAlign=f.xAlign,this.yAlign=f.yAlign,this.width=l.width,this.height=l.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,m))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(t);const i={width:this.width,height:this.height},s={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const o=Ds(t.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&l&&(e.save(),e.globalAlpha=n,this.drawBackground(s,e,i,t),U3(e,t.textDirection),s.y+=o.top,this.drawTitle(s,e,t),this.drawBody(s,e,t),this.drawFooter(s,e,t),q3(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const n=this._active,i=e.map(({datasetIndex:l,index:u})=>{const f=this.chart.getDatasetMeta(l);if(!f)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:f.data[u],index:u}}),s=!cy(n,i),o=this._positionChanged(i,t);(s||o)&&(this._active=i,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,n=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,s=this._active||[],o=this._getActiveElements(e,s,t,n),l=this._positionChanged(o,e),u=t||!cy(o,s)||l;return u&&(this._active=o,(i.enabled||i.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),u}_getActiveElements(e,t,n,i){const s=this.options;if(e.type==="mouseout")return[];if(!i)return t.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,s.mode,s,n);return s.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:n,caretY:i,options:s}=this,o=mf[s.position].call(this,e,t);return o!==!1&&(n!==o.x||i!==o.y)}},Xe(Z_,"positioners",mf),Z_);var dR={id:"tooltip",_element:sI,positioners:mf,afterInit(r,e,t){t&&(r.tooltip=new sI({chart:r,options:t}))},beforeUpdate(r,e,t){r.tooltip&&r.tooltip.initialize(t)},reset(r,e,t){r.tooltip&&r.tooltip.initialize(t)},afterDraw(r){const e=r.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(r.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(r.ctx),r.notifyPlugins("afterTooltipDraw",t)}},afterEvent(r,e){if(r.tooltip){const t=e.replay;r.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(r,e)=>e.bodyFont.size,boxWidth:(r,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:uR},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:r=>r!=="filter"&&r!=="itemSort"&&r!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const Tq=(r,e,t,n)=>(typeof e=="string"?(t=r.push(e)-1,n.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function Sq(r,e,t,n){const i=r.indexOf(e);if(i===-1)return Tq(r,e,t,n);const s=r.lastIndexOf(e);return i!==s?t:i}const Aq=(r,e)=>r===null?null:Zr(Math.round(r),0,e);function oI(r){const e=this.getLabels();return r>=0&&r<e.length?e[r]:r}class gy extends nh{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const n=this.getLabels();for(const{index:i,label:s}of t)n[i]===s&&n.splice(i,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(on(e))return null;const n=this.getLabels();return t=isFinite(t)&&n[t]===e?t:Sq(n,e,Dt(t,e),this._addedLabels),Aq(t,n.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:n,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(n=0),t||(i=this.getLabels().length-1)),this.min=n,this.max=i}buildTicks(){const e=this.min,t=this.max,n=this.options.offset,i=[];let s=this.getLabels();s=e===0&&t===s.length-1?s:s.slice(e,t+1),this._valueRange=Math.max(s.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let o=e;o<=t;o++)i.push({value:o});return i}getLabelForValue(e){return oI.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}Xe(gy,"id","category"),Xe(gy,"defaults",{ticks:{callback:oI}});function Iq(r,e){const t=[],{bounds:i,step:s,min:o,max:l,precision:u,count:f,maxTicks:m,maxDigits:y,includeBounds:g}=r,_=s||1,E=m-1,{min:x,max:w}=e,S=!on(o),I=!on(l),C=!on(f),N=(w-x)/(y+1);let R=aA((w-x)/E/_)*_,B,P,k,F;if(R<1e-14&&!S&&!I)return[{value:x},{value:w}];F=Math.ceil(w/R)-Math.floor(x/R),F>E&&(R=aA(F*R/E/_)*_),on(u)||(B=Math.pow(10,u),R=Math.ceil(R*B)/B),i==="ticks"?(P=Math.floor(x/R)*R,k=Math.ceil(w/R)*R):(P=x,k=w),S&&I&&s&&ZV((l-o)/s,R/1e3)?(F=Math.round(Math.min((l-o)/R,m)),R=(l-o)/F,P=o,k=l):C?(P=S?o:P,k=I?l:k,F=f-1,R=(k-P)/F):(F=(k-P)/R,Pf(F,Math.round(F),R/1e3)?F=Math.round(F):F=Math.ceil(F));const j=Math.max(lA(R),lA(P));B=Math.pow(10,on(u)?j:u),P=Math.round(P*B)/B,k=Math.round(k*B)/B;let O=0;for(S&&(g&&P!==o?(t.push({value:o}),P<o&&O++,Pf(Math.round((P+O*R)*B)/B,o,aI(o,N,r))&&O++):P<o&&O++);O<F;++O){const D=Math.round((P+O*R)*B)/B;if(I&&D>l)break;t.push({value:D})}return I&&g&&k!==l?t.length&&Pf(t[t.length-1].value,l,aI(l,N,r))?t[t.length-1].value=l:t.push({value:l}):(!I||k===l)&&t.push({value:k}),t}function aI(r,e,{horizontal:t,minRotation:n}){const i=ba(n),s=(t?Math.sin(i):Math.cos(i))||.001,o=.75*e*(""+r).length;return Math.min(e/s,o)}class Nq extends nh{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return on(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:i,max:s}=this;const o=u=>i=t?i:u,l=u=>s=n?s:u;if(e){const u=jo(i),f=jo(s);u<0&&f<0?l(0):u>0&&f>0&&o(0)}if(i===s){let u=s===0?1:Math.abs(s*.05);l(s+u),e||o(i-u)}this.min=i,this.max=s}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:n}=e,i;return n?(i=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),t=t||11),t&&(i=Math.min(t,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let n=this.getTickLimit();n=Math.max(2,n);const i={maxTicks:n,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},s=this._range||this,o=Iq(i,s);return e.bounds==="ticks"&&QV(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let t=this.min,n=this.max;if(super.configure(),this.options.offset&&e.length){const i=(n-t)/Math.max(e.length-1,1)/2;t-=i,n+=i}this._startValue=t,this._endValue=n,this._valueRange=n-t}getLabelForValue(e){return j2(e,this.chart.options.locale,this.options.ticks.format)}}class yy extends Nq{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=Ms(e)?e:0,this.max=Ms(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,n=ba(this.options.ticks.minRotation),i=(e?Math.sin(n):Math.cos(n))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,s.lineHeight/i))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}Xe(yy,"id","linear"),Xe(yy,"defaults",{ticks:{callback:j3.formatters.numeric}});const a0={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Di=Object.keys(a0);function lI(r,e){return r-e}function cI(r,e){if(on(e))return null;const t=r._adapter,{parser:n,round:i,isoWeekday:s}=r._parseOpts;let o=e;return typeof n=="function"&&(o=n(o)),Ms(o)||(o=typeof n=="string"?t.parse(o,n):t.parse(o)),o===null?null:(i&&(o=i==="week"&&(rm(s)||s===!0)?t.startOf(o,"isoWeek",s):t.startOf(o,i)),+o)}function uI(r,e,t,n){const i=Di.length;for(let s=Di.indexOf(r);s<i-1;++s){const o=a0[Di[s]],l=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((t-e)/(l*o.size))<=n)return Di[s]}return Di[i-1]}function kq(r,e,t,n,i){for(let s=Di.length-1;s>=Di.indexOf(t);s--){const o=Di[s];if(a0[o].common&&r._adapter.diff(i,n,o)>=e-1)return o}return Di[t?Di.indexOf(t):0]}function Pq(r){for(let e=Di.indexOf(r)+1,t=Di.length;e<t;++e)if(a0[Di[e]].common)return Di[e]}function dI(r,e,t){if(!t)r[e]=!0;else if(t.length){const{lo:n,hi:i}=C2(t,e),s=t[n]>=e?t[n]:t[i];r[s]=!0}}function Cq(r,e,t,n){const i=r._adapter,s=+i.startOf(e[0].value,n),o=e[e.length-1].value;let l,u;for(l=s;l<=o;l=+i.add(l,1,n))u=t[l],u>=0&&(e[u].major=!0);return e}function hI(r,e,t){const n=[],i={},s=e.length;let o,l;for(o=0;o<s;++o)l=e[o],i[l]=o,n.push({value:l,major:!1});return s===0||!t?n:Cq(r,n,i,t)}class vy extends nh{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const n=e.time||(e.time={}),i=this._adapter=new DB._date(e.adapters.date);i.init(t),kf(n.displayFormats,i.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:cI(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,n=e.time.unit||"day";let{min:i,max:s,minDefined:o,maxDefined:l}=this.getUserBounds();function u(f){!o&&!isNaN(f.min)&&(i=Math.min(i,f.min)),!l&&!isNaN(f.max)&&(s=Math.max(s,f.max))}(!o||!l)&&(u(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&u(this.getMinMax(!1))),i=Ms(i)&&!isNaN(i)?i:+t.startOf(Date.now(),n),s=Ms(s)&&!isNaN(s)?s:+t.endOf(Date.now(),n)+1,this.min=Math.min(i,s-1),this.max=Math.max(i+1,s)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],n=e[e.length-1]),{min:t,max:n}}buildTicks(){const e=this.options,t=e.time,n=e.ticks,i=n.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const s=this.min,o=this.max,l=nz(i,s,o);return this._unit=t.unit||(n.autoSkip?uI(t.minUnit,this.min,this.max,this._getLabelCapacity(s)):kq(this,l.length,t.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:Pq(this._unit),this.initOffsets(i),e.reverse&&l.reverse(),hI(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,n=0,i,s;this.options.offset&&e.length&&(i=this.getDecimalForValue(e[0]),e.length===1?t=1-i:t=(this.getDecimalForValue(e[1])-i)/2,s=this.getDecimalForValue(e[e.length-1]),e.length===1?n=s:n=(s-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;t=Zr(t,0,o),n=Zr(n,0,o),this._offsets={start:t,end:n,factor:1/(t+1+n)}}_generate(){const e=this._adapter,t=this.min,n=this.max,i=this.options,s=i.time,o=s.unit||uI(s.minUnit,t,n,this._getLabelCapacity(t)),l=Dt(i.ticks.stepSize,1),u=o==="week"?s.isoWeekday:!1,f=rm(u)||u===!0,m={};let y=t,g,_;if(f&&(y=+e.startOf(y,"isoWeek",u)),y=+e.startOf(y,f?"day":o),e.diff(n,t,o)>1e5*l)throw new Error(t+" and "+n+" are too far apart with stepSize of "+l+" "+o);const E=i.ticks.source==="data"&&this.getDataTimestamps();for(g=y,_=0;g<n;g=+e.add(g,l,o),_++)dI(m,g,E);return(g===n||i.bounds==="ticks"||_===1)&&dI(m,g,E),Object.keys(m).sort(lI).map(x=>+x)}getLabelForValue(e){const t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}format(e,t){const i=this.options.time.displayFormats,s=this._unit,o=t||i[s];return this._adapter.format(e,o)}_tickFormatFunction(e,t,n,i){const s=this.options,o=s.ticks.callback;if(o)return Nn(o,[e,t,n],this);const l=s.time.displayFormats,u=this._unit,f=this._majorUnit,m=u&&l[u],y=f&&l[f],g=n[t],_=f&&y&&g&&g.major;return this._adapter.format(e,i||(_?y:m))}generateTickLabels(e){let t,n,i;for(t=0,n=e.length;t<n;++t)i=e[t],i.label=this._tickFormatFunction(i.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+n)*t.factor)}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,n=this.ctx.measureText(e).width,i=ba(this.isHorizontal()?t.maxRotation:t.minRotation),s=Math.cos(i),o=Math.sin(i),l=this._resolveTickFontOptions(0).size;return{w:n*s+l*o,h:n*o+l*s}}_getLabelCapacity(e){const t=this.options.time,n=t.displayFormats,i=n[t.unit]||n.millisecond,s=this._tickFormatFunction(e,0,hI(this,[e],this._majorUnit),i),o=this._getLabelSize(s),l=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return l>0?l:1}getDataTimestamps(){let e=this._cache.data||[],t,n;if(e.length)return e;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(t=0,n=i.length;t<n;++t)e=e.concat(i[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,n;if(e.length)return e;const i=this.getLabels();for(t=0,n=i.length;t<n;++t)e.push(cI(this,i[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return C3(e.sort(lI))}}Xe(vy,"id","time"),Xe(vy,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Jp(r,e,t){let n=0,i=r.length-1,s,o,l,u;t?(e>=r[n].pos&&e<=r[i].pos&&({lo:n,hi:i}=Wc(r,"pos",e)),{pos:s,time:l}=r[n],{pos:o,time:u}=r[i]):(e>=r[n].time&&e<=r[i].time&&({lo:n,hi:i}=Wc(r,"time",e)),{time:s,pos:l}=r[n],{time:o,pos:u}=r[i]);const f=o-s;return f?l+(u-l)*(e-s)/f:l}class fI extends vy{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=Jp(t,this.min),this._tableRange=Jp(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:n}=this,i=[],s=[];let o,l,u,f,m;for(o=0,l=e.length;o<l;++o)f=e[o],f>=t&&f<=n&&i.push(f);if(i.length<2)return[{time:t,pos:0},{time:n,pos:1}];for(o=0,l=i.length;o<l;++o)m=i[o+1],u=i[o-1],f=i[o],Math.round((m+u)/2)!==f&&s.push({time:f,pos:o/(l-1)});return s}_generate(){const e=this.min,t=this.max;let n=super.getDataTimestamps();return(!n.includes(e)||!n.length)&&n.splice(0,0,e),(!n.includes(t)||n.length===1)&&n.push(t),n.sort((i,s)=>i-s)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),n=this.getLabelTimestamps();return t.length&&n.length?e=this.normalize(t.concat(n)):e=t.length?t:n,e=this._cache.all=e,e}getDecimalForValue(e){return(Jp(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return Jp(this._table,n*this._tableRange+this._minPos,!0)}}Xe(fI,"id","timeseries"),Xe(fI,"defaults",vy.defaults);const hR="label";function mI(r,e){typeof r=="function"?r(e):r&&(r.current=e)}function Rq(r,e){const t=r.options;t&&e&&Object.assign(t,e)}function fR(r,e){r.labels=e}function mR(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:hR;const n=[];r.datasets=e.map(i=>{const s=r.datasets.find(o=>o[t]===i[t]);return!s||!i.data||n.includes(s)?{...i}:(n.push(s),Object.assign(s,i),s)})}function Oq(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hR;const t={labels:[],datasets:[]};return fR(t,r.labels),mR(t,r.datasets,e),t}function jq(r,e){const{height:t=150,width:n=300,redraw:i=!1,datasetIdKey:s,type:o,data:l,options:u,plugins:f=[],fallbackContent:m,updateMode:y,...g}=r,_=te.useRef(null),E=te.useRef(null),x=()=>{_.current&&(E.current=new Pm(_.current,{type:o,data:Oq(l,s),options:u&&{...u},plugins:f}),mI(e,E.current))},w=()=>{mI(e,null),E.current&&(E.current.destroy(),E.current=null)};return te.useEffect(()=>{!i&&E.current&&u&&Rq(E.current,u)},[i,u]),te.useEffect(()=>{!i&&E.current&&fR(E.current.config.data,l.labels)},[i,l.labels]),te.useEffect(()=>{!i&&E.current&&l.datasets&&mR(E.current.config.data,l.datasets,s)},[i,l.datasets]),te.useEffect(()=>{E.current&&(i?(w(),setTimeout(x)):E.current.update(y))},[i,u,l.labels,l.datasets,y]),te.useEffect(()=>{E.current&&(w(),setTimeout(x))},[o]),te.useEffect(()=>(x(),()=>w()),[]),is.createElement("canvas",{ref:_,role:"img",height:t,width:n,...g},m)}const Mq=te.forwardRef(jq);function l0(r,e){return Pm.register(e),te.forwardRef((t,n)=>is.createElement(Mq,{...t,ref:n,type:r}))}const Dq=l0("line",bg),pR=l0("bar",xg),Lq=l0("doughnut",hd),Fq=l0("pie",Ux);Pm.register(gy,yy,Of,cR,dR,aR);const Vq=()=>{const r=new Date;return r.setMonth(r.getMonth()-6),r.toISOString().split("T")[0]},pI=()=>new Date().toISOString().split("T")[0],zq=({user:r,userData:e,db:t,showNotification:n})=>{const[i,s]=te.useState([]),[o,l]=te.useState("monthly"),[u,f]=te.useState(Vq()),[m,y]=te.useState(pI()),[g,_]=te.useState(!0),[E,x]=te.useState(""),w=te.useCallback(async()=>{if(!r||!r.uid){x("User data not available."),_(!1);return}_(!0),x("");try{const P=await Nm(t,r.uid);if(P.success){const k=P.data.filter(F=>{var j;return((j=F.billDate)==null?void 0:j.toDate)&&typeof F.consumption=="number"&&F.consumption>=0}).sort((F,j)=>F.billDate.toDate()-j.billDate.toDate());s(k)}else throw new Error(P.error||"Failed to fetch billing data.")}catch(P){x(P.message||"An unexpected error occurred fetching data."),n(P.message||"Could not load consumption data.","error")}finally{_(!1)}},[t,r,n]);te.useEffect(()=>{w()},[w]);const I=((P,k,F,j)=>{const O={},D=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],M=new Date(F).getTime(),$=new Date(j).getTime()+(24*60*60*1e3-1);return P.filter(oe=>{const ee=oe.billDate.toDate().getTime();return ee>=M&&ee<=$}).forEach(oe=>{const ee=oe.billDate.toDate(),J=ee.getFullYear(),Y=ee.getMonth();let q;switch(k){case"yearly":q=`${J}`;break;case"daily":q=`${J}-${String(Y+1).padStart(2,"0")}-${String(ee.getDate()).padStart(2,"0")}`;break;case"monthly":default:q=`${J}-${String(Y+1).padStart(2,"0")}`;break}O[q]=(O[q]||0)+(oe.consumption||0)}),Object.keys(O).sort().reduce((oe,ee)=>{let J=ee;if(k==="monthly"){const[Y,q]=ee.split("-");q&&D[parseInt(q)-1]&&(J=`${D[parseInt(q)-1]} '${Y.slice(-2)}`)}else if(k==="daily"){const[Y,q,Z]=ee.split("-");q&&Z&&(J=`${D[parseInt(q)-1]} ${Z}, '${Y.slice(-2)}`)}return oe[J]=O[ee],oe},{})})(i,o,u,m),C={labels:Object.keys(I),datasets:[{label:"Consumption (m)",data:Object.values(I),backgroundColor:"rgba(59, 130, 246, 0.7)",borderColor:"rgba(37, 99, 235, 1)",borderWidth:1,borderRadius:4,hoverBackgroundColor:"rgba(37, 99, 235, 0.8)"}]},N={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:`Water Consumption Trend (${o.charAt(0).toUpperCase()+o.slice(1)})`,font:{size:16},color:"#374151",padding:{bottom:15}},tooltip:{backgroundColor:"#1F2937",titleColor:"#E5E7EB",bodyColor:"#D1D5DB",borderColor:"#4B5563",borderWidth:1,padding:10,callbacks:{label:function(P){return` Consumption: ${P.parsed.y.toFixed(2)} m`}}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Consumption (m)",color:"#4B5563"},grid:{color:"#E5E7EB"},ticks:{color:"#6B7280"}},x:{title:{display:!0,text:"Period",color:"#4B5563"},grid:{display:!1},ticks:{color:"#6B7280"}}}},R=i.length>0?i.reduce((P,k)=>P+(k.consumption||0),0)/i.length:0,B=P=>{const k=Object.values(P),F=Object.keys(P);if(k.length<2)return"Not enough data for comparison in the selected range.";const j=k[k.length-1],O=k[k.length-2],D=F[k.length-1],M=j-O,$=O!==0?M/O*100:j>0?1/0:0;let G=`Consumption in ${D} was ${j.toFixed(2)} m. `;return $===1/0?G+="This is up from 0 in the previous period.":M>0?(G+=`This is ${$>=.1?"+":""}${$.toFixed(1)}% (${M>=0?"+":""}${M.toFixed(2)} m) compared to the previous period.`,$>25&&(G+=" Consider checking for potential leaks or reviewing usage patterns.")):M<0?G+=`This is a ${Math.abs($).toFixed(1)}% decrease (${M.toFixed(2)} m) compared to the previous period.`:G+="Consumption remained stable compared to the previous period.",G};return d.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200 gap-4",children:[d.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[d.jsx(r3,{size:30,className:"mr-3 text-blue-600"})," Water Consumption Analytics"]}),d.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3 w-full sm:w-auto",children:[d.jsxs("div",{className:"flex items-center gap-2 w-full",children:[d.jsx($9,{size:18,className:"text-gray-500"}),d.jsxs("select",{value:o,onChange:P=>l(P.target.value),className:"p-2 border rounded-md text-sm bg-gray-50 focus:ring-blue-500 focus:border-blue-500 w-full",disabled:g,children:[d.jsx("option",{value:"daily",children:"Group by Day"}),d.jsx("option",{value:"monthly",children:"Group by Month"}),d.jsx("option",{value:"yearly",children:"Group by Year"})]})]}),d.jsxs("div",{className:"flex items-center gap-2 w-full",children:[d.jsx(QC,{size:18,className:"text-gray-500"}),d.jsx("input",{type:"date",value:u,onChange:P=>f(P.target.value),className:"p-2 border rounded-md text-sm bg-gray-50 focus:ring-blue-500 focus:border-blue-500 w-full",disabled:g,max:m}),d.jsx("span",{className:"text-gray-500",children:"-"}),d.jsx("input",{type:"date",value:m,onChange:P=>y(P.target.value),className:"p-2 border rounded-md text-sm bg-gray-50 focus:ring-blue-500 focus:border-blue-500 w-full",disabled:g,min:u,max:pI()})]})]})]}),g&&d.jsx(pn,{message:"Loading consumption data..."}),E&&!g&&d.jsxs("div",{className:"text-center py-10 bg-red-50 p-4 rounded-lg",children:[d.jsx(Qt,{size:48,className:"mx-auto text-red-400 mb-3"}),d.jsx("p",{className:"text-red-600 text-lg font-semibold",children:"Error Loading Data"}),d.jsx("p",{className:"text-sm text-red-500 mt-1",children:E})]}),!g&&!E&&i.length===0&&d.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner",children:[d.jsx(kn,{size:48,className:"mx-auto text-gray-400 mb-4"}),d.jsx("p",{className:"text-gray-600 text-lg",children:"No consumption data found yet."}),d.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Analytics will appear after your first few bills."})]}),!g&&!E&&i.length>0&&Object.keys(I).length>0&&d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"text-sm text-center text-gray-700 bg-blue-50 p-3 rounded-md border border-blue-200 shadow-sm",children:[d.jsxs("p",{children:[d.jsx("strong",{children:"Insight:"})," ",B(I)]}),d.jsxs("p",{className:"mt-1",children:["Average monthly use (all data): ",d.jsxs("strong",{children:[R.toFixed(2)," m"]}),"."]})]}),d.jsx("div",{className:"h-64 md:h-80 lg:h-96 w-full p-4 border rounded-lg bg-gray-50 shadow-inner",children:d.jsx(pR,{options:N,data:C})})]}),!g&&!E&&i.length>0&&Object.keys(I).length===0&&d.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner",children:[d.jsx(kn,{size:48,className:"mx-auto text-gray-400 mb-4"}),d.jsx("p",{className:"text-gray-600 text-lg",children:"No data found for the selected date range and grouping."}),d.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Try expanding your date range or changing the grouping."})]})]})},id={Bronze:{points:0,color:"text-yellow-700",iconColor:"#cd7f32",benefits:["Standard Support Access","Basic Portal Features","Regular Service Updates"]},Silver:{points:500,color:"text-gray-600",iconColor:"#c0c0c0",benefits:["Priority Support Queue","Eligibility for 1% Annual Bill Rebate*","Early Access to Water Saving Tips","+ Bronze Benefits"]},Gold:{points:1500,color:"text-amber-500",iconColor:"#ffd700",benefits:["Dedicated Support Agent Option","Eligibility for 2.5% Annual Bill Rebate*","Exclusive Conservation Workshop Invites","+ Silver Benefits"]},Platinum:{points:3e3,color:"text-blue-700",iconColor:"#e5e4e2",benefits:["Highest Priority Support Escalation","Eligibility for 5% Annual Bill Rebate*","Free Annual Water Audit Consultation (On Request)","+ Gold Benefits"]}},Bq=({userData:r,systemSettings:e={}})=>{const t=(r==null?void 0:r.rebatePoints)||0,i=(x=>x>=id.Platinum.points?"Platinum":x>=id.Gold.points?"Gold":x>=id.Silver.points?"Silver":"Bronze")(t),s=id[i],l=(x=>{const w=Object.keys(id),S=w.indexOf(x);if(S>=0&&S<w.length-1){const I=w[S+1];return{name:I,...id[I]}}return null})(i),u=l?l.points-t:0,f=l?Math.max(0,Math.min(100,t/l.points*100)):100,{isRebateProgramEnabled:m=!1,pointsPerPeso:y=.01,earlyPaymentBonusPoints:g=10,earlyPaymentDaysThreshold:_=7}=e,E=y*100;return d.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[d.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:d.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[d.jsx(b2,{size:30,className:"mr-3 text-amber-500"})," AGWA Rewards Program"]})}),d.jsxs("section",{className:"mb-8 p-6 bg-gradient-to-r from-blue-600 to-indigo-700 text-white rounded-lg shadow-xl text-center",children:[d.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Your Rewards Status"}),d.jsxs("div",{className:"text-4xl font-bold mb-1 flex items-center justify-center gap-2",children:[d.jsx(dd,{size:36,fill:s.iconColor,stroke:s.iconColor}),d.jsxs("span",{style:{color:s.iconColor},children:[i," Tier"]})]}),d.jsxs("p",{className:"text-2xl font-semibold text-blue-100 mb-3",children:[t.toLocaleString()," Points"]}),l&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"w-full max-w-md mx-auto bg-blue-400 rounded-full h-3 mb-1 overflow-hidden shadow-inner",children:d.jsx("div",{className:"bg-yellow-400 h-3 rounded-full transition-all duration-500 ease-out",style:{width:`${f}%`}})}),d.jsx("p",{className:"text-xs text-blue-100",children:u>0?`${u.toLocaleString()} points needed for ${l.name} tier (${l.points.toLocaleString()} total).`:`You've reached the ${l.name} tier!`})]}),i==="Platinum"&&d.jsx("p",{className:"text-sm text-yellow-300 font-semibold mt-2",children:" You are a Platinum member! Enjoy the highest rewards."})]}),d.jsxs("section",{className:"mb-8",children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:["Benefits for ",i," Tier"]}),d.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50 shadow-inner",children:[d.jsx("ul",{className:"list-disc list-inside space-y-1.5 text-sm text-gray-700 pl-4",children:s.benefits.map((x,w)=>d.jsx("li",{children:x.replace("*","")},w))}),d.jsx("p",{className:"text-xs text-gray-500 mt-3",children:"*Annual Bill Rebate eligibility requires 12 consecutive months of good standing within the tier. Rebate applied as bill credit. See terms."})]})]}),d.jsxs("section",{className:"mb-8 p-4 bg-blue-50 border border-blue-200 rounded-lg shadow-sm",children:[d.jsxs("h3",{className:"text-lg font-semibold text-blue-800 mb-3 flex items-center",children:[d.jsx(v2,{size:20,className:"mr-2"})," How to Earn Points (Mechanics)"]}),m?d.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[d.jsx("p",{children:"Earning points is simple! Points are awarded automatically for diligent payments:"}),d.jsxs("ul",{className:"list-none space-y-2 pl-2",children:[d.jsxs("li",{className:"flex items-start",children:[d.jsx(dd,{size:16,className:"text-yellow-500 mr-2 mt-0.5 flex-shrink-0"}),d.jsxs("div",{children:[d.jsx("strong",{children:"Pay Your Bill:"})," Earn ",d.jsxs("strong",{children:[E.toLocaleString()," point",E!==1?"s":""]})," for every ",d.jsx("strong",{children:"100.00"})," paid on your water bill."]})]}),d.jsxs("li",{className:"flex items-start",children:[d.jsx(dd,{size:16,className:"text-yellow-500 mr-2 mt-0.5 flex-shrink-0"}),d.jsxs("div",{children:[d.jsx("strong",{children:"Pay Early:"})," Earn a ",d.jsxs("strong",{children:[g," point bonus"]})," when you pay your bill in full at least ",d.jsxs("strong",{children:[_," day",_!==1?"s":""]})," before your due date."]})]}),d.jsxs("li",{className:"flex items-start",children:[d.jsx(dd,{size:16,className:"text-gray-400 mr-2 mt-0.5 flex-shrink-0"}),d.jsxs("div",{children:[d.jsx("strong",{children:"Stay Tuned:"})," Look out for special promotions and events to earn even more bonus points!"]})]})]}),d.jsx("p",{className:"text-xs text-gray-500",children:"Points are automatically credited to your account after your payment is successfully posted (usually within 24-48 hours)."})]}):d.jsx("p",{className:"text-sm text-gray-700",children:"The AGWA Rewards Program is not currently active."})]}),d.jsxs("section",{children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-3 flex items-center",children:[d.jsx(eh,{size:20,className:"mr-2 text-gray-500"})," Program Terms & Conditions"]}),d.jsxs("details",{className:"text-xs text-gray-500 space-y-2 border p-3 rounded bg-gray-50 cursor-pointer group hover:bg-gray-100 transition-colors",children:[d.jsxs("summary",{className:"font-medium text-gray-700 group-hover:text-blue-600 list-none flex justify-between items-center",children:["Click to view Terms & Conditions",d.jsx("span",{className:"transition-transform duration-200 group-open:rotate-180",children:""})]}),d.jsxs("div",{className:"mt-2 space-y-1.5 max-h-0 overflow-hidden group-open:max-h-[500px] transition-all duration-500 ease-in-out pt-2 border-t",children:[d.jsxs("p",{children:[d.jsx("strong",{children:"1. Eligibility:"}),' All AGWA Water Services, Inc. customers with an active residential or commercial account in good standing are eligible to participate in the AGWA Rewards Program ("Program").']}),d.jsxs("p",{children:[d.jsx("strong",{children:"2. Earning Points:"}),' Points are earned based on (a) the total amount paid for water bills and (b) bonuses for early payments, as specified in the "How to Earn Points" section. Earning rates are determined by AGWA and may be subject to change based on system settings.']}),d.jsxs("p",{children:[d.jsx("strong",{children:"3. Point Crediting:"})," Points will be credited to the customer's account after a payment is successfully processed and posted. This may take up to 48 hours."]}),d.jsxs("p",{children:[d.jsx("strong",{children:"4. Tiers and Benefits:"})," Tier status (Bronze, Silver, Gold, Platinum) is determined by the total accumulated points. Benefits are associated with each tier and are non-transferable. AGWA reserves the right to modify, add, or remove benefits at any time."]}),d.jsxs("p",{children:[d.jsx("strong",{children:"5. Annual Bill Rebate:"}),' Rebates mentioned in tier benefits (e.g., "Eligibility for 1% Annual Bill Rebate") are not automatic. To qualify, a customer must maintain their tier status (Silver or higher) and remain in good standing (no service disconnections due to non-payment) for 12 consecutive months. The rebate is calculated on the total basic charges paid within that 12-month period and will be applied as a credit to a future bill, not as a cash payout.']}),d.jsxs("p",{children:[d.jsx("strong",{children:"6. Point Expiration:"})," Points do not expire as long as the customer's account remains active. If an account is closed or becomes inactive for a period of 24 consecutive months, all accumulated points may be forfeited."]}),d.jsxs("p",{children:[d.jsx("strong",{children:"7. No Cash Value:"})," Points have no cash value, are non-transferable, and cannot be sold, bartered, or redeemed for cash."]}),d.jsxs("p",{children:[d.jsx("strong",{children:"8. Program Modification/Termination:"})," AGWA Water Services, Inc. reserves the right to modify, suspend, or terminate the AGWA Rewards Program, its rules, tiers, benefits, or earning mechanics at any time, with or without prior notice."]}),d.jsxs("p",{children:[d.jsx("strong",{children:"9. Account Status:"})," Customers must be in good standing to enjoy tier benefits. Accounts that are suspended or disconnected may have their benefits temporarily revoked."]}),d.jsxs("p",{children:[d.jsx("strong",{children:"10. Disputes:"})," Any discrepancies in point calculation must be reported to AGWA customer service within 60 days of the payment date. AGWA's decision on point disputes is final."]}),d.jsxs("p",{children:[d.jsx("strong",{children:"11. Acceptance of Terms:"})," Continued participation in the Program, including earning and redeeming benefits, constitutes acceptance of these Terms & Conditions."]})]})]})]})]})},gR={Poblacion:["Capt. C. Nazareno","Gombalza","Kanluran","Ibayo Silangan","Humbac","Balsahan"],"Baybayin Bayan-Hilaga":["Timalan Balsahan","Timalan Concepcion","Munting Mapino","Ibayo Estacion","Latoria","Bucana Sasahan"],"Baybayin Timog":["Bagong Kalsada","Bucana Malaki","Bancaan","Mabulo","Labac","Sapa"],"Ilayang Hilaga":["Calubcob","Halang","Palangue Central","Palangue 2&3","Sabang","Makina"],"Ilayang Timog":["Muzon","Malainen Bago","Malainen Luma","Molino","San Roque","Santulan"]},c0=()=>Object.keys(gR),mu=r=>gR[r]||[],eo="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",Qh="bg-gray-200 cursor-not-allowed text-gray-500",Uq=({user:r,userData:e,setUserData:t,auth:n,db:i,showNotification:s})=>{var O;const[o,l]=te.useState(!1),[u,f]=te.useState({}),[m,y]=te.useState({district:"",barangay:"",street:"",landmark:""}),[g,_]=te.useState(!1),[E,x]=te.useState(""),[w,S]=te.useState([]),[I,C]=te.useState([]),N=(e==null?void 0:e.role)==="customer";te.useEffect(()=>{if(S(c0()),e)if(f({...e}),N&&e.serviceAddress&&typeof e.serviceAddress=="object"){const D=e.serviceAddress.district||"";y(e.serviceAddress),D&&C(mu(D))}else y({district:"",barangay:"",street:"",landmark:""})},[e,N]);const R=D=>!D||typeof D!="object"?"N/A":[D.street,D.barangay,D.district,"Quezon City"].filter($=>$&&$.trim()).join(", "),B=D=>{const{name:M,value:$}=D.target;y(G=>{const ie={...G,[M]:$};return M==="district"&&(ie.barangay="",C(mu($))),ie})},P=D=>{const{name:M,value:$}=D.target;f(G=>({...G,[M]:$}))},k=async D=>{var G,ie;if(D.preventDefault(),x(""),!((G=u.displayName)!=null&&G.trim())){x("Display Name cannot be empty.");return}_(!0);const M={displayName:u.displayName.trim(),photoURL:((ie=u.photoURL)==null?void 0:ie.trim())||"",serviceAddress:N?m:e.serviceAddress||{}},$=await cf(i,r.uid,M);if(!$.success){s($.error||"Failed to update profile in database.","error"),_(!1);return}t(oe=>({...oe,...M})),s("Profile updated successfully!","success"),l(!1),_(!1)},F=()=>{l(!1),x(""),N&&e.serviceAddress&&typeof e.serviceAddress=="object"&&y(e.serviceAddress)};if(!e)return d.jsx(pn,{message:"Loading profile..."});const j=u.photoURL||H8(u.displayName);return d.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[d.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center",children:[d.jsx(o3,{size:30,className:"mr-3 text-blue-600"})," My Profile"]}),!o&&d.jsxs("button",{onClick:()=>l(!0),className:"flex items-center bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg",children:[d.jsx(T2,{size:18,className:"mr-2"})," Edit Profile"]})]}),E&&d.jsxs("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg text-sm flex items-center",children:[d.jsx(Qt,{size:20,className:"mr-2"})," ",E]}),d.jsxs("form",{onSubmit:k,className:"space-y-5",children:[d.jsxs("div",{className:"text-center space-y-3",children:[d.jsx("img",{src:j,alt:"Profile",className:"h-28 w-28 rounded-full object-cover border-4 border-blue-200 shadow-md bg-gray-200 mx-auto"}),o&&d.jsx("input",{type:"url",name:"photoURL",value:u.photoURL||"",onChange:P,className:`${eo} max-w-sm mx-auto text-center`,placeholder:"Image URL"})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[d.jsxs("div",{children:[d.jsxs("label",{className:"text-xs font-medium text-gray-600 mb-1 flex items-center",children:[d.jsx(Ps,{size:14,className:"mr-1.5"}),"Full Name"]}),o?d.jsx("input",{type:"text",name:"displayName",value:u.displayName||"",onChange:P,className:eo}):d.jsx("p",{className:`${eo} ${Qh}`,children:u.displayName})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"text-xs font-medium text-gray-600 mb-1 flex items-center",children:[d.jsx(Ia,{size:14,className:"mr-1.5"}),"Email Address"]}),d.jsx("p",{className:`${eo} ${Qh}`,children:u.email})]}),N&&d.jsxs("div",{children:[d.jsxs("label",{className:"text-xs font-medium text-gray-600 mb-1 flex items-center",children:[d.jsx(Cs,{size:14,className:"mr-1.5"}),"Account Number"]}),d.jsx("p",{className:`${eo} ${Qh}`,children:u.accountNumber})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"text-xs font-medium text-gray-600 mb-1 flex items-center",children:[d.jsx(Rx,{size:14,className:"mr-1.5"}),"User Role"]}),d.jsx("p",{className:`${eo} ${Qh} capitalize`,children:(O=u.role)==null?void 0:O.replace("_"," ")})]})]}),N&&d.jsxs("div",{className:"pt-4 mt-4 border-t",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Service Address"}),o?d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1",children:"District"}),d.jsxs("select",{name:"district",value:m.district,onChange:B,className:eo,children:[d.jsx("option",{value:"",children:"Select District"}),w.map(D=>d.jsx("option",{value:D,children:D},D))]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1",children:"Barangay"}),d.jsxs("select",{name:"barangay",value:m.barangay,onChange:B,className:eo,disabled:!m.district,children:[d.jsx("option",{value:"",children:"Select Barangay"}),I.map(D=>d.jsx("option",{value:D,children:D},D))]})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1",children:"Street Name, Building, House No."}),d.jsx("input",{type:"text",name:"street",value:m.street,onChange:B,className:eo})]}),d.jsxs("div",{className:"md:col-span-2",children:[d.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1",children:"Landmark"}),d.jsx("input",{type:"text",name:"landmark",value:m.landmark,onChange:B,className:eo})]})]}):d.jsx("p",{className:`${eo} ${Qh}`,children:R(u.serviceAddress)})]}),o&&d.jsxs("div",{className:"flex justify-end space-x-4 pt-5",children:[d.jsx("button",{type:"button",onClick:F,className:"px-6 py-2.5 text-sm font-medium bg-gray-100 rounded-lg",disabled:g,children:"Cancel"}),d.jsxs("button",{type:"submit",className:"px-6 py-2.5 text-sm font-medium text-white bg-green-600 rounded-lg flex items-center",disabled:g,children:[g?d.jsx(At,{size:18,className:"animate-spin mr-2"}):d.jsx(Da,{size:18,className:"mr-2"}),g?"Saving...":"Save Changes"]})]})]})]})};function qq(r,e,t){const[n,i]=te.useState(r),[s,o]=te.useState({}),[l,u]=te.useState(!1),[f,m]=te.useState(!1),y=te.useCallback(x=>{const{name:w,value:S,type:I,checked:C}=x.target;i(N=>({...N,[w]:I==="checkbox"?C:S})),s[w]&&o(N=>({...N,[w]:void 0}))},[s]),g=te.useCallback((x,w)=>{i(S=>({...S,[x]:w})),s[x]&&o(S=>({...S,[x]:void 0}))},[s]),_=te.useCallback(()=>{i(r),o({}),u(!1),m(!1)},[r]);return{values:n,setValues:i,setFieldValue:g,errors:s,setErrors:o,isLoading:l,handleChange:y,handleSubmit:async x=>{if(x&&x.preventDefault(),f)return;m(!0),u(!0),o({});let w={};if(e&&(w=e(n),o(w)),Object.keys(w).length===0)try{t&&await t(n,_)}catch(S){console.error("Form submission error:",S),o(I=>({...I,submit:S.message||"An unexpected error occurred during submission."}))}u(!1),m(!1)},resetForm:_}}const _y=({children:r,text:e,position:t="top",className:n="",delay:i=100})=>{const[s,o]=te.useState(!1),[l,u]=te.useState(null),f=()=>{const _=setTimeout(()=>{o(!0)},i);u(_)},m=()=>{l&&(clearTimeout(l),u(null)),o(!1)},y={top:"bottom-full left-1/2 -translate-x-1/2 mb-2",bottom:"top-full left-1/2 -translate-x-1/2 mt-2",left:"right-full top-1/2 -translate-y-1/2 mr-2",right:"left-full top-1/2 -translate-y-1/2 ml-2"},g={top:"absolute left-1/2 -translate-x-1/2 top-full h-0 w-0 border-x-4 border-x-transparent border-t-4 border-t-gray-800",bottom:"absolute left-1/2 -translate-x-1/2 bottom-full h-0 w-0 border-x-4 border-x-transparent border-b-4 border-b-gray-800",left:"absolute top-1/2 -translate-y-1/2 left-full h-0 w-0 border-y-4 border-y-transparent border-l-4 border-l-gray-800",right:"absolute top-1/2 -translate-y-1/2 right-full h-0 w-0 border-y-4 border-y-transparent border-r-4 border-r-gray-800"};return e?d.jsxs("div",{className:"relative inline-flex",onMouseEnter:f,onMouseLeave:m,onFocus:f,onBlur:m,tabIndex:0,children:[r,s&&d.jsxs("div",{role:"tooltip",className:`absolute z-50 whitespace-nowrap px-3 py-1.5 text-xs font-medium text-white bg-gray-800 rounded-md shadow-lg transition-opacity duration-150 ease-in-out opacity-100 ${y[t]} ${n}`,children:[e,d.jsx("div",{className:g[t]})]})]}):d.jsx(d.Fragment,{children:r})},h1="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",f1="flex items-center justify-center px-5 py-2.5 rounded-lg font-semibold transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95 text-sm",Hq=r=>!r||typeof r!="object"?"":[r.street,r.barangay,r.district].filter(t=>t&&t.trim()).join(", "),$q=({user:r,userData:e,db:t,auth:n,showNotification:i})=>{const s=()=>e!=null&&e.serviceAddress&&typeof e.serviceAddress=="object"?Hq(e.serviceAddress):(e==null?void 0:e.accountNumber)||"",o={issueType:"",description:"",issueAddress:s()},[l,u]=te.useState(!1),[f,m]=te.useState(!1),y=O=>{const D={};return O.issueType||(D.issueType="Please select an issue type."),O.description.trim()||(D.description="Description cannot be empty."),O.issueAddress.trim()||(D.issueAddress="Please specify the location of the issue."),D},g=async(O,D)=>{const M={...O,userId:r.uid,userName:e.displayName,userEmail:e.email,accountNumber:e.accountNumber||"N/A"},$=await g9(t,M);$.success?(i("Support ticket submitted successfully!","success"),D()):i($.error||"Failed to submit ticket.","error")},{values:_,errors:E,isLoading:x,handleChange:w,handleSubmit:S,setFieldValue:I}=qq(o,y,g),C=["Billing Discrepancy or Inquiry","Water Leak (Before Meter)","Water Leak (After Meter - Your Property)","No Water Supply / Low Pressure","Water Quality Issue (Color, Odor, Taste)","Meter Problem (Damaged, Stuck, Inaccurate)","Online Portal Issue / Account Access","Request for Service (Disconnection/Reconnection)","Chatbot Assistance Follow-up","Other Concern"],N=["Unable to Access Meter","Damaged or Tampered Meter Found","Suspected Illegal Connection","Route Data Inaccuracy","Safety Concern on Route","Device or App Problem","Customer Inquiry on Field","Other Field Report"],R=["Payment Posting Issue","Customer Account Inquiry","Bill Printing Problem","System Access/Login Issue","Other Office Concern"],B=["User Role/Permission Change Request","Data Correction Request","System Bug Report","Feature Request","Urgent System Alert"],[P,k]=te.useState(C);te.useEffect(()=>{switch(e==null?void 0:e.role){case"meter_reader":k(N);break;case"clerk_cashier":k(R);break;case"admin":k(B);break;default:k(C)}I("issueType","")},[e.role,I]),te.useEffect(()=>{I("issueAddress",s())},[e,I]);const F=async()=>{if(!_.description.trim()){i("Please describe your issue first before using the AI categorizer.","warning");return}u(!0);try{const M=[{role:"user",content:`Based on the following user complaint, which of these categories does it best fit into? Categories: [${P.join(", ")}]. Respond with only the exact category name from the list and nothing else. Complaint: "${_.description}"`}];let $=await Jl(M);$=$.replace(/["'.*]/g,"").trim(),P.includes($)?(I("issueType",$),i(`AI suggested category: "${$}"`,"success")):i("AI could not determine a matching category. Please select one manually.","info")}catch(O){const D=(O==null?void 0:O.message)||"AI categorization failed.";i(D,"error")}finally{u(!1)}},j=async()=>{if(!_.description.trim()){i("Please provide some keywords or a brief description for the AI to expand upon.","warning");return}m(!0);try{const D=[{role:"user",content:`You are helping a user report an issue to AGWA Water Services. Elaborate on the following user-provided details to create a clear, detailed, and formal issue description. Be polite and include any relevant questions the user might need to answer. Do not add any extra commentary, just provide the refined description.

User's input: "${_.description}"`}],M=await Jl(D);I("description",M),i("AI has helped draft your issue description!","success")}catch(O){const D=(O==null?void 0:O.message)||"AI assistance failed.";i(D,"error")}finally{m(!1)}};return d.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[d.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:d.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[d.jsx(Qt,{size:30,className:"mr-3 text-orange-500"})," Report an Issue or Concern"]})}),d.jsxs("form",{onSubmit:S,className:"space-y-6",children:[d.jsxs("div",{children:[d.jsxs("label",{htmlFor:"issueType",className:"text-sm font-medium text-gray-700 mb-1 flex items-center",children:[d.jsx(e3,{size:16,className:"mr-1.5 text-gray-500"})," Issue Type / Category *"]}),d.jsxs("div",{className:"flex gap-2 items-center",children:[d.jsxs("select",{id:"issueType",name:"issueType",value:_.issueType,onChange:w,className:`${h1} ${E.issueType?"border-red-500":""}`,children:[d.jsx("option",{value:"",disabled:!0,children:"Select the type of issue..."}),P.map(O=>d.jsx("option",{value:O,children:O},O))]}),d.jsx(_y,{text:"Let AI suggest a category based on your description below.",children:d.jsx("button",{type:"button",onClick:F,className:`${f1} w-auto bg-blue-100 text-blue-700 hover:bg-blue-200 focus:ring-blue-300 px-3`,disabled:l||x,children:l?d.jsx(At,{size:16,className:"animate-spin"}):d.jsx(Os,{size:16})})})]}),E.issueType&&d.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.issueType})]}),d.jsxs("div",{children:[d.jsxs("label",{htmlFor:"issueAddress",className:"text-sm font-medium text-gray-700 mb-1 flex items-center",children:[d.jsx(Na,{size:16,className:"mr-1.5 text-gray-500"})," Address / Location of Issue *"]}),d.jsx("input",{type:"text",id:"issueAddress",name:"issueAddress",value:_.issueAddress,onChange:w,className:`${h1} ${E.issueAddress?"border-red-500":""}`,placeholder:"E.g., Your service address, specific street, or account number if general"}),E.issueAddress&&d.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.issueAddress})]}),d.jsxs("div",{children:[d.jsxs("div",{className:"flex justify-between items-center mb-1",children:[d.jsxs("label",{htmlFor:"description",className:"text-sm font-medium text-gray-700 flex items-center",children:[d.jsx(lF,{size:16,className:"mr-1.5 text-gray-500"})," Detailed Description of Issue *"]}),d.jsx(_y,{text:_.description.trim()?"Use AI to help draft or refine your description.":"Write a description first to enable AI Assist",children:d.jsxs("button",{type:"button",onClick:j,className:`${f1} text-xs bg-purple-100 text-purple-700 hover:bg-purple-200 focus:ring-purple-300 py-1.5 px-3`,disabled:f||x||!_.description.trim(),children:[f?d.jsx(At,{size:16,className:"animate-spin mr-1.5"}):d.jsx(Os,{size:16,className:"mr-1.5"}),f?"Drafting...":"AI Assist"]})})]}),d.jsx("textarea",{id:"description",name:"description",value:_.description,onChange:w,rows:"6",className:`${h1} ${E.description?"border-red-500":""}`,placeholder:"Please provide as much detail as possible: What is the problem? When did it start? Any specific error messages or observations?"}),E.description&&d.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.description})]}),d.jsx("div",{className:"pt-3",children:d.jsxs("button",{type:"submit",className:`${f1} w-full bg-orange-500 hover:bg-orange-600 text-white focus:ring-orange-400`,disabled:x||f||l,children:[x?d.jsx(At,{size:20,className:"animate-spin mr-2"}):d.jsx(n0,{size:18,className:"mr-2"}),x?"Submitting Report...":"Submit Issue Report"]})})]})]})},Wq=[{q:"How do I register for an online account?",a:"Click 'Sign Up' on the login page. Provide your full name, AGWA account number (e.g., RES-12345), a valid email address, and create a password of at least 6 characters."},{q:"I forgot my password. How can I reset it?",a:"On the login page, click the 'Forgot Password?' link. Enter the email address associated with your AGWA account, and we'll send you a link to reset your password."},{q:"How can I pay my water bill through this portal?",a:"Once logged in, navigate to 'My Bills'. Select an unpaid bill, click 'Pay Now', and choose a simulated payment option (e.g., GCash, Maya, Bank Transfer, Credit Card). Please note that payments in this portal are for demonstration purposes only. For actual payments, please use AGWA's officially accredited payment channels."},{q:"How is my water consumption calculated?",a:"Your consumption is the difference between your current meter reading and your previous meter reading, measured in cubic meters (m). This consumption is then used with the tariff rates applicable to your service type to calculate your water bill charges."},{q:"What are the different charges on my bill?",a:"Your bill typically includes a Basic Charge (based on consumption and service type), Foreign Currency Differential Adjustment (FCDA), Environmental Charge (EC), Sewerage Charge (SC, if applicable), Maintenance Service Charge (based on your meter size), Government Taxes, and Value Added Tax (VAT). You can use the ' Explain Bill' feature in the 'My Bills' section for a personalized breakdown of a specific bill."},{q:"How can I view my past bills and payment history?",a:"Navigate to the 'My Bills' section after logging in. You'll find a history of your past bills, their status (Paid/Unpaid), and payment details if paid via the portal (simulated). You can also view a detailed invoice for each bill."},{q:"What should I do if I suspect a water leak at my premises?",a:"If it's safe to do so, try to identify the source of the leak and turn off your main water shut-off valve (usually located near your meter). Immediately report the suspected leak to AGWA via the 'Report Issue' section in the portal or by calling our 24/7 emergency hotline: 1627-AGWA (1627-2492)."},{q:"My water supply is interrupted. What should I do?",a:"First, check for any service advisories on our official AGWA website or social media channels. If there are no posted advisories for your area, please report the interruption via the 'Report Issue' section in the portal or call our customer service hotline with your account details."},{q:"Can I change my registered email address or other profile details?",a:"You can update your Display Name, Photo URL, Service Address, and Meter Size in the 'My Profile' section. For changes to critical information like your registered email address (if it's your primary login ID), account number, or assigned role, please contact AGWA customer support for assistance and verification."},{q:"What is FCDA (Foreign Currency Differential Adjustment)?",a:"FCDA is a tariff mechanism approved by regulatory bodies that allows water utilities like AGWA to recover or pass on to customers the gains or losses arising from fluctuations in foreign exchange rates. These fluctuations affect the cost of foreign currency-denominated loans and expenses used for service improvements and operational needs."},{q:"Why is there an Environmental Charge (EC) on my bill?",a:"The Environmental Charge (EC) is a fee collected to fund projects and initiatives related to wastewater treatment, septage management, and other environmental protection programs. This helps ensure that water resources are used sustainably and that wastewater is treated properly before being discharged back into the environment."},{q:"What if I think my water meter is malfunctioning or inaccurate?",a:"If you suspect your water meter is not recording your consumption accurately, please report it immediately. You can do this through the 'Report Issue' section of the portal (select 'Meter Problem') or by contacting AGWA customer service. We will arrange for an inspection and testing of your meter."},{q:"How often are water meters read?",a:"Water meters are typically read on a monthly cycle. The specific reading schedule can vary by area. Your billing statement will indicate the period covered by the meter reading (e.g., 'Billing Period: 01 Jan 2025 to 31 Jan 2025')."},{q:"Are there discounts for senior citizens or Persons with Disabilities (PWDs)?",a:"Yes, AGWA Water Services adheres to Republic Act No. 9994 (Expanded Senior Citizens Act) and Republic Act No. 10754 (Act Expanding the Benefits and Privileges of Persons with Disability). Qualified senior citizens and PWDs are entitled to a discount on their water consumption, subject to certain conditions (e.g., the account must be registered in their name, consumption limits). Please update your details in 'My Profile' or contact customer service with the necessary identification to apply for these discounts."},{q:"How do I update my contact number or service address on file with AGWA?",a:"You can update your Service Address directly in the 'My Profile' section of this portal. For changes to your primary contact number, especially if it's used for OTPs or critical alerts, it's best to contact AGWA customer service or visit one of our business offices to ensure your records are accurately updated and verified."},{q:"What are the accepted payment methods for my water bill?",a:"This portal simulates payments via various methods for demonstration. For actual payments, AGWA accepts payments through a wide range of accredited channels, including: AGWA Business Offices, Bayad Centers, 7-Eleven, SM Bills Payment, selected banks (over-the-counter and online banking), and mobile wallets like GCash and Maya. Please refer to the official AGWA website or your bill statement for a complete list of authorized payment partners."},{q:"How can I get an official receipt (OR) after making a payment?",a:"For payments made through this portal (which are simulated), a transaction reference is provided. For actual payments made via AGWA's accredited channels, an official receipt or proof of payment will be issued by that specific channel (e.g., a bank validation slip, a payment center receipt, a digital receipt from an e-wallet). AGWA is continuously working on enhancing digital services, including the future provision of consolidated digital ORs through the portal."},{q:"What is a 'meter deposit' for new service connections?",a:"A meter deposit is a one-time charge collected from customers upon application for a new water service connection. This deposit serves as a security against potential unpaid bills or damages to the water meter. It is refundable, with interest (if applicable by law), upon termination of the service contract, provided all outstanding obligations to AGWA have been settled."},{q:"How do I report a damaged, leaking, or stolen water meter?",a:"Report any instance of a damaged, leaking, or stolen water meter to AGWA immediately. You can use the 'Report Issue' section in this portal (select 'Meter Problem') or call our emergency hotline. Tampering with or unauthorized removal of water meters is illegal and may result in penalties."},{q:"Can I request for a temporary disconnection of my water service if I'll be away for an extended period?",a:"Yes, you can request a temporary or voluntary disconnection of your water service. To do this, please visit any AGWA business office to file your formal request. There might be applicable fees for the disconnection and subsequent reconnection process. Please inquire about the specific requirements and charges."}],Gq=()=>d.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[d.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:d.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[d.jsx(hF,{size:30,className:"mr-3 text-blue-600"}),"Frequently Asked Questions"]})}),d.jsx("div",{className:"space-y-4",children:Wq.map((r,e)=>d.jsxs("details",{className:"group bg-gray-50 hover:bg-gray-100 p-4 rounded-lg shadow-sm hover:shadow-md transition-all duration-200 ease-in-out",children:[d.jsxs("summary",{className:"flex justify-between items-center font-medium cursor-pointer list-none text-gray-900 text-sm sm:text-base",children:[d.jsx("span",{className:"group-open:text-blue-700 group-open:font-semibold",children:r.q}),d.jsx("span",{className:"transition-transform duration-300 transform group-open:rotate-180 text-blue-600 group-open:text-blue-700",children:d.jsx(XC,{size:24})})]}),d.jsx("div",{className:"text-gray-600 mt-3 prose prose-sm max-w-none grid grid-rows-[0fr] group-open:grid-rows-[1fr] transition-all duration-500 ease-in-out",children:d.jsx("div",{className:"overflow-hidden",children:d.jsx("p",{className:"pb-2",children:r.a})})})]},e))})]}),Kq=()=>{const r=[{letter:"C",word:"Customer-Centricity",desc:"Our customers are at the heart of every decision and action we take, ensuring their needs are met with utmost priority and care.",icon:Ps},{letter:"R",word:"Responsibility",desc:"We hold ourselves accountable for our impact on the communities we serve and the environment, operating with integrity and a commitment to social good.",icon:eh},{letter:"E",word:"Excellence",desc:"We relentlessly pursue the highest standards in all aspects of our service, operations, and innovation, striving for continuous improvement.",icon:Os},{letter:"S",word:"Sustainability",desc:"We are dedicated to the long-term health and viability of our precious water resources and the planet, implementing eco-friendly practices.",icon:Ql},{letter:"T",word:"Teamwork & Integrity",desc:"We foster a collaborative environment built on mutual respect, honesty, and transparency, working together to achieve our common goals.",icon:wa}],e=[{title:"Deliver Quality",description:"Consistently provide safe, reliable, and affordable water and wastewater services that exceed customer expectations and meet stringent regulatory standards."},{title:"Innovate & Adapt",description:"Embrace technological advancements and innovative practices to enhance operational efficiency, service delivery, and resource management in an ever-changing world."},{title:"Customer First",description:"Cultivate a culture of exceptional customer care through responsive, transparent, fair, and easily accessible service channels, including this advanced digital portal."},{title:"Protect Resources",description:"Champion water conservation, actively work to reduce non-revenue water, and promote environmental protection through sustainable practices and robust community engagement."},{title:"Empower People",description:"Invest in the growth, professional development, and overall well-being of our employees, fostering a skilled, motivated, diverse, and safety-conscious workforce."},{title:"Community Partnership",description:"Actively contribute to the socio-economic development, health, and resilience of the communities we serve through targeted corporate social responsibility programs and collaborative partnerships."}];return d.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn leading-relaxed text-gray-700",children:[d.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:d.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[d.jsx(kn,{size:30,className:"mr-3 text-blue-600"}),"About AGWA Water Services, Inc."]})}),d.jsxs("section",{className:"mb-8",children:[d.jsxs("h3",{className:"text-xl font-semibold text-blue-700 mb-2 flex items-center",children:[d.jsx(ZC,{size:22,className:"mr-2.5 text-blue-600/80"})," Our Genesis & Enduring Commitment"]}),d.jsx("p",{children:"AGWA Water Services, Inc. was established in 2005 with a singular, profound vision: to ensure every Filipino has access to clean, safe, and sustainable water. Recognizing water as the cornerstone of life, health, and economic progress, AGWA embarked on a mission to become a leading force in the Philippine water utility sector. From humble beginnings, we have grown through unwavering dedication, strategic investments in infrastructure and technology, and a deep-rooted commitment to the communities we are privileged to serve. Our journey has been one of continuous learning, adaptation, and an ever-stronger resolve to meet the evolving water needs of a dynamic nation."})]}),d.jsxs("section",{className:"mb-8",children:[d.jsxs("h3",{className:"text-xl font-semibold text-blue-700 mb-2 flex items-center",children:[d.jsx(Os,{size:22,className:"mr-2.5 text-blue-600/80"})," Operational Excellence & Innovation"]}),d.jsx("p",{children:"At the heart of AGWA lies a relentless pursuit of excellence. We employ state-of-the-art water sourcing techniques, advanced multi-stage treatment processes, and smart distribution networks, all managed by a team of highly skilled engineers, certified technicians, and dedicated customer service professionals. Our operations strictly adhere to, and often exceed, national and international quality standards (PNSDW, WHO guidelines), ensuring that the water reaching your taps is not just potable but of the highest purity and reliability. We continuously invest in research and development to innovate and improve our services, from leak detection technologies and pressure management systems to digital customer interfaces and data-driven resource planning."})]}),d.jsxs("section",{className:"mb-8",children:[d.jsxs("h3",{className:"text-xl font-semibold text-blue-700 mb-2 flex items-center",children:[d.jsx(Ql,{size:22,className:"mr-2.5 text-blue-600/80"})," Sustainability and Environmental Stewardship: Our Pledge"]}),d.jsx("p",{children:"AGWA is profoundly aware of its responsibility as a steward of one of Earth's most precious resources. Sustainability is not just a buzzword for us; it's integrated into every facet of our operations. This includes responsible water abstraction from diverse sources, active participation in watershed protection and reforestation programs, and the implementation of advanced wastewater treatment and water recycling initiatives to minimize our environmental footprint. We actively promote water conservation education among our consumers and invest in projects that enhance climate resilience and mitigate environmental impact, ensuring that future generations can also enjoy the gift of clean water."})]}),d.jsxs("div",{className:"my-10 p-6 bg-gradient-to-r from-blue-600 to-indigo-700 text-white rounded-xl shadow-xl text-center",children:[d.jsx(Yl,{size:36,className:"mx-auto mb-3 text-blue-200"}),d.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Our Vision"}),d.jsx("p",{className:"italic text-lg text-blue-100 leading-relaxed max-w-3xl mx-auto",children:`"To be the Philippines' most trusted and innovative water solutions provider, empowering communities with sustainable access to life-enhancing water services and championing environmental stewardship for a resilient future."`})]}),d.jsxs("div",{className:"my-10",children:[d.jsxs("h3",{className:"text-2xl font-bold text-blue-700 mb-6 text-center flex items-center justify-center",children:[d.jsx(gF,{size:28,className:"mr-3 text-blue-600"})," Our Mission"]}),d.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-5",children:e.map((t,n)=>d.jsxs("div",{className:"bg-blue-50 p-5 rounded-lg shadow-md hover:shadow-lg transition-shadow h-full flex flex-col",children:[d.jsx("strong",{className:"text-blue-700 block text-md mb-1.5",children:t.title}),d.jsx("p",{className:"text-sm text-gray-600 leading-normal flex-grow",children:t.description})]},n))})]}),d.jsxs("div",{className:"my-12 pt-8 border-t border-gray-200",children:[d.jsx("h3",{className:"text-2xl font-bold text-blue-700 mb-8 text-center",children:"Our Core Values: The AGWA C.R.E.S.T."}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-5",children:r.map(t=>{const n=t.icon;return d.jsxs("div",{className:"p-5 border border-blue-100 rounded-xl bg-white shadow-lg hover:shadow-2xl transition-all duration-300 flex flex-col items-center text-center h-full hover:border-blue-300 transform hover:-translate-y-1",children:[d.jsx("div",{className:"p-3 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 text-white mb-3 shadow-md",children:d.jsx(n,{className:"",size:32})}),d.jsx("p",{className:"text-4xl font-bold text-blue-600 mb-1",children:t.letter}),d.jsx("strong",{className:"text-blue-700 block text-md mb-1.5",children:t.word}),d.jsx("p",{className:"text-xs text-gray-600 mt-1 leading-snug flex-grow",children:t.desc})]},t.letter)})})]}),d.jsx("p",{className:"pt-8 mt-8 text-gray-800 font-medium text-center text-lg border-t border-gray-200",children:"AGWA Water Services, Inc.  Ensuring Clarity, Sustaining Life."})]})},Yq=({type:r,href:e})=>{let t,n="hover:text-blue-700";switch(r){case"Facebook":t=eF,n="hover:text-blue-600";break;case"Twitter":t=yF,n="hover:text-sky-500";break;case"Instagram":t=iF,n="hover:text-pink-600";break;default:return null}return d.jsx("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:`text-gray-500 transition-colors duration-200 ${n}`,title:r,children:d.jsx(t,{size:28})})},Zq=({systemSettings:r={}})=>{const{supportHotline:e="1627-AGWA (24/7 Emergency)",supportEmail:t="support@agwa-waterservices.com.ph"}=r,n=[{icon:n3,title:"Customer Service Hotlines",lines:[{text:e,valueClass:"text-2xl font-semibold text-blue-700 tracking-tight"},{text:"(+63 2) 8162-2492 (Outside Metro Manila / Standard Hours)",valueClass:"text-lg text-gray-700"}],note:"Emergency reports are handled 24/7. General inquiries: Mon - Fri, 8 AM - 5 PM PHT.",bgColor:"bg-blue-50",iconColor:"text-blue-600"},{icon:Ia,title:"Email Support",lines:[{text:t,valueClass:"text-lg text-green-700 hover:underline"}],note:"For general inquiries, billing concerns, feedback, and non-urgent requests. Expect a response within 1-2 business days.",href:`mailto:${t}`,bgColor:"bg-green-50",iconColor:"text-green-600"}],i={title:"AGWA Head Office",addressLines:["AGWA Water Services Tower","123 Aqua Drive, Hydro Business Park","Naic, Cavite, Philippines 4110"],hours:"Mon - Fri, 8:00 AM - 5:00 PM PHT (Closed on weekends & public holidays)",note:"Walk-ins are welcome for payments and specific services. For complex concerns, an appointment is recommended to ensure specialist availability.",mapLink:"https://maps.google.com/?q=AGWA+Water+Services+Tower,Quezon+City",bgColor:"bg-gray-100",iconColor:"text-gray-600"},s=[{type:"Facebook",href:"https://facebook.com/AGWAwaterservices"},{type:"Twitter",href:"https://twitter.com/AGWAwaterserv"},{type:"Instagram",href:"https://instagram.com/AGWAwater"}];return d.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[d.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:d.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[d.jsx(ka,{size:30,className:"mr-3 text-blue-600"}),"Get In Touch With AGWA"]})}),d.jsx("p",{className:"text-gray-700 mb-8 leading-relaxed text-sm sm:text-base",children:"We value your feedback and are dedicated to assisting you with your water service needs. For immediate assistance, especially during emergencies like major leaks or widespread service interruptions, please use our 24/7 hotline. For other inquiries, choose the most convenient channel below."}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:n.map((o,l)=>{const u=o.icon;return d.jsxs("div",{className:`p-5 rounded-xl shadow-lg hover:shadow-xl transition-shadow ${o.bgColor} border border-gray-200`,children:[d.jsxs("div",{className:"flex items-start mb-3",children:[d.jsx(u,{size:28,className:`mr-4 mt-1 flex-shrink-0 ${o.iconColor}`}),d.jsxs("div",{children:[d.jsx("h3",{className:`text-lg font-semibold ${o.iconColor}`,children:o.title}),o.lines.map((f,m)=>o.href&&m===0?d.jsx("a",{href:o.href,className:f.valueClass,children:f.text},m):d.jsx("p",{className:f.valueClass,children:f.text},m))]})]}),d.jsx("p",{className:"text-xs text-gray-500 leading-normal",children:o.note})]},l)})}),d.jsxs("div",{className:`p-5 rounded-xl shadow-lg hover:shadow-xl transition-shadow mb-8 ${i.bgColor} border border-gray-200`,children:[d.jsxs("div",{className:"flex items-start mb-3",children:[d.jsx(ZC,{size:28,className:`mr-4 mt-1 flex-shrink-0 ${i.iconColor}`}),d.jsxs("div",{children:[d.jsx("h3",{className:`text-lg font-semibold ${i.iconColor}`,children:i.title}),i.addressLines.map((o,l)=>d.jsx("p",{className:"text-sm text-gray-700 leading-snug",children:o},l))]})]}),d.jsxs("div",{className:"text-sm text-gray-600 space-y-1 mt-2",children:[d.jsxs("p",{className:"flex items-center",children:[d.jsx(As,{size:14,className:"mr-2 text-gray-500"}),d.jsx("strong",{children:"Hours:"})," ",i.hours]}),d.jsxs("p",{className:"flex items-start",children:[d.jsx(Na,{size:14,className:"mr-2 mt-0.5 text-gray-500 flex-shrink-0"}),d.jsx("strong",{children:"Location Note:"})," ",i.note]})]}),d.jsxs("a",{href:i.mapLink,target:"_blank",rel:"noopener noreferrer",className:"mt-3 inline-flex items-center text-xs text-blue-600 hover:text-blue-800 hover:underline font-medium",children:["View on Map ",d.jsx(Na,{size:12,className:"ml-1"})]})]}),d.jsxs("div",{className:"mt-10 text-center border-t border-gray-200 pt-8",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"Stay Connected"}),d.jsx("p",{className:"text-sm text-gray-600 mb-5 max-w-md mx-auto",children:"Follow us on our official social media channels for the latest news, service advisories, water conservation tips, and community program updates."}),d.jsx("div",{className:"flex justify-center space-x-6 sm:space-x-8",children:s.map(o=>d.jsx(Yq,{type:o.type,href:o.href},o.type))}),d.jsxs("p",{className:"mt-8 text-xs text-gray-500",children:["For online self-service options, please ",d.jsx("button",{onClick:()=>{alert("Please log in to access self-service options.")},className:"text-blue-600 hover:underline font-medium",children:"log in"})," to your account. ",d.jsx("br",{}),"General information is also available on our official website: ",d.jsx("a",{href:"https://www.agwa-waterservices.com.ph",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline font-medium",children:"www.agwa-waterservices.com.ph"})]})]})]})},Qq=({user:r,userData:e,db:t,showNotification:n,setActiveSection:i})=>{const[s,o]=te.useState({totalUsers:0,openTickets:0,activeAnnouncements:0,systemStatus:"Operational"}),[l,u]=te.useState(!0),[f,m]=te.useState(""),y=te.useCallback(async()=>{u(!0),m("");try{const _=await Promise.allSettled([WC(t),GC(t),k9(t)]),[E,x,w]=_,S={systemStatus:"Operational"};let I="";E.status==="fulfilled"&&E.value.success?S.totalUsers=E.value.data.total:I+="Users data unavailable. ",x.status==="fulfilled"&&x.value.success?S.openTickets=x.value.data.byStatus.Open||0:I+="Tickets data unavailable. ",w.status==="fulfilled"&&w.value.success?S.activeAnnouncements=w.value.data.active:I+="Announcements data unavailable. ",o(C=>({...C,...S})),I.trim()&&(m(I.trim()),n(`Partial data load: ${I}`,"warning"))}catch{const E="A critical error occurred while fetching dashboard statistics.";m(E),n(E,"error"),o(x=>({...x,systemStatus:"Error"}))}finally{u(!1)}},[t,n]);te.useEffect(()=>{y()},[y]);const g=[{title:"User Management",icon:wa,section:"userManagement",description:"View, edit, and manage all user accounts.",color:"blue"},{title:"Support Tickets",icon:ka,section:"supportTickets",description:"Address and manage user-submitted issues.",color:"purple"},{title:"Announcements",icon:yd,section:"manageAnnouncements",description:"Create and publish portal-wide announcements.",color:"teal"},{title:"System Analytics",icon:y2,section:"systemAnalytics",description:"View key metrics and system performance data.",color:"orange"},{title:"Meter Readings Mgt.",icon:Ql,section:"editMeterReadingsAdmin",description:"Oversee and manage meter reading entries.",color:"sky"},{title:"System Settings",icon:r0,section:"systemSettings",description:"Configure application parameters and settings.",color:"gray"}];return l?d.jsx(pn,{message:"Loading admin dashboard statistics...",className:"mt-10 h-48"}):d.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[d.jsx("div",{className:"p-6 bg-gradient-to-r from-slate-700 to-slate-900 text-white rounded-xl shadow-2xl",children:d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl sm:text-3xl font-bold",children:"Administrator Dashboard"}),d.jsxs("p",{className:"mt-1 text-slate-300",children:["Welcome, ",(e==null?void 0:e.displayName)||"Admin",". Oversee portal operations."]})]}),d.jsxs("button",{onClick:y,className:"text-sm flex items-center bg-slate-600 hover:bg-slate-500 text-white font-medium py-2 px-3 rounded-lg transition-colors disabled:opacity-70",disabled:l,title:"Refresh Statistics",children:[l?d.jsx(At,{size:16,className:"animate-spin"}):d.jsx(Ma,{size:16}),d.jsx("span",{className:"ml-2 hidden sm:inline",children:"Refresh"})]})]})}),f&&d.jsxs("p",{className:"text-sm text-yellow-600 bg-yellow-50 p-3 rounded-md text-center flex items-center justify-center gap-2",children:[d.jsx(kn,{size:16})," ",f]}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5",children:[d.jsx(di,{title:"Total Users",value:s.totalUsers??"N/A",icon:wa,borderColor:"border-blue-500",iconColor:"text-blue-500",onClick:()=>i("userManagement")}),d.jsx(di,{title:"Open Support Tickets",value:s.openTickets,icon:Qt,borderColor:"border-red-500",iconColor:"text-red-500",onClick:()=>i("supportTickets")}),d.jsx(di,{title:"Active Announcements",value:s.activeAnnouncements??"N/A",icon:yd,borderColor:"border-teal-500",iconColor:"text-teal-500",onClick:()=>i("viewAnnouncements")}),d.jsx(di,{title:"System Status",value:s.systemStatus,icon:eh,borderColor:s.systemStatus==="Error"?"border-red-500":"border-green-500",iconColor:s.systemStatus==="Error"?"text-red-500":"text-green-500"})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-5 mt-8 pt-5 border-t border-gray-200",children:"Administrative Tools"}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(_=>d.jsxs("button",{onClick:()=>i(_.section),className:`p-6 bg-white rounded-xl shadow-lg hover:shadow-2xl transform hover:-translate-y-1.5 transition-all duration-300 ease-in-out text-left focus:outline-none focus:ring-2 focus:ring-${_.color}-500 focus:ring-opacity-75 group h-full flex flex-col`,children:[d.jsx("div",{className:`p-3 bg-${_.color}-100 rounded-full inline-block mb-3 self-start group-hover:scale-110 transition-transform`,children:d.jsx(_.icon,{size:28,className:`text-${_.color}-600`})}),d.jsx("h4",{className:`text-lg font-semibold text-gray-800 group-hover:text-${_.color}-700 transition-colors`,children:_.title}),d.jsx("p",{className:"text-sm text-gray-500 mt-1 leading-normal flex-grow",children:_.description})]},_.section))})]})]})},Ts="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",gI="bg-gray-200 cursor-not-allowed text-gray-500",Xq=({user:r,isOpen:e,onClose:t,onSave:n,isSaving:i,determineServiceTypeAndRole:s})=>{const[o,l]=te.useState({displayName:"",email:"",accountNumber:"",accountStatus:"Active",role:"customer",serviceType:"Residential",meterSerialNumber:"",meterSize:'1/2"'}),[u,f]=te.useState({district:"",barangay:"",street:"",landmark:""}),[m,y]=te.useState([]),[g,_]=te.useState([]),E=o.role==="customer";te.useEffect(()=>{if(y(c0()),r){const I=r.role||"customer",C=I==="customer";if(l({displayName:r.displayName||"",email:r.email||"",accountNumber:r.accountNumber||"",accountStatus:r.accountStatus||"Active",role:I,serviceType:r.serviceType||"Residential",meterSerialNumber:r.meterSerialNumber||"",meterSize:r.meterSize||'1/2"'}),C&&r.serviceAddress&&typeof r.serviceAddress=="object"){const N=r.serviceAddress.district||"";f({district:r.serviceAddress.district||"",barangay:r.serviceAddress.barangay||"",street:r.serviceAddress.street||"",landmark:r.serviceAddress.landmark||""}),N&&_(mu(N))}else f({district:"",barangay:"",street:"",landmark:""})}},[r]);const x=I=>{const{name:C,value:N}=I.target;f(R=>{const B={...R,[C]:N};return C==="district"&&(B.barangay="",_(mu(N))),B})},w=I=>{const{name:C,value:N}=I.target;let R={...o,[C]:N};if(C==="accountNumber"&&s){const{role:B,serviceType:P}=s(N);R={...R,role:B,serviceType:P}}if(C==="role"&&N!=="customer"){R.accountNumber="",R.meterSerialNumber="",R.meterSize="";const{serviceType:B}=s("");R.serviceType=B,f({district:"",barangay:"",street:"",landmark:""})}l(R)},S=I=>{I.preventDefault();const C={...o,serviceAddress:E?u:{}};E||(delete C.meterSerialNumber,delete C.meterSize,delete C.serviceAddress),n(C)};return d.jsx(Mr,{isOpen:e,onClose:t,title:`Edit User: ${r.displayName||r.email}`,size:"3xl",children:d.jsxs("form",{onSubmit:S,className:"space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsx("input",{type:"text",name:"displayName",value:o.displayName,onChange:w,className:Ts,placeholder:"Full Name"}),d.jsx("input",{type:"email",name:"email",value:o.email,className:`${Ts} ${gI}`,disabled:!0}),d.jsx("select",{name:"role",value:o.role,onChange:w,className:`${Ts} capitalize`,children:["customer","admin","meter_reader","clerk_cashier"].map(I=>d.jsx("option",{value:I,children:I.replace("_"," ")},I))}),d.jsxs("select",{name:"accountStatus",value:o.accountStatus,onChange:w,className:Ts,children:[d.jsx("option",{value:"Active",children:"Active"}),d.jsx("option",{value:"Inactive",children:"Inactive"}),d.jsx("option",{value:"Suspended",children:"Suspended"})]}),d.jsx("input",{type:"text",name:"accountNumber",value:o.accountNumber,onChange:w,className:Ts,placeholder:"Account Number",disabled:!E}),d.jsx("input",{type:"text",name:"serviceType",value:o.serviceType,className:`${Ts} ${gI}`,disabled:!0}),E&&d.jsxs(d.Fragment,{children:[d.jsx("input",{type:"text",name:"meterSerialNumber",value:o.meterSerialNumber,onChange:w,className:Ts,placeholder:"Meter Serial Number"}),d.jsx("input",{type:"text",name:"meterSize",value:o.meterSize,onChange:w,className:Ts,placeholder:"Meter Size"})]})]}),E&&d.jsxs("div",{className:"pt-4 mt-4 border-t",children:[d.jsx("h3",{className:"text-md font-semibold text-gray-700 mb-2",children:"Service Address"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("select",{name:"district",value:u.district,onChange:x,className:Ts,children:[d.jsx("option",{value:"",children:"Select District"}),m.map(I=>d.jsx("option",{value:I,children:I},I))]}),d.jsxs("select",{name:"barangay",value:u.barangay,onChange:x,className:Ts,disabled:!u.district,children:[d.jsx("option",{value:"",children:"Select Barangay"}),g.map(I=>d.jsx("option",{value:I,children:I},I))]}),d.jsx("div",{className:"md:col-span-2",children:d.jsx("input",{type:"text",name:"street",value:u.street,onChange:x,className:Ts,placeholder:"Street Name, Building, House No."})}),d.jsx("div",{className:"md:col-span-2",children:d.jsx("input",{type:"text",name:"landmark",value:u.landmark,onChange:x,className:Ts,placeholder:"Landmark"})})]})]}),d.jsxs("div",{className:"pt-4 flex justify-end space-x-3",children:[d.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg border",disabled:i,children:"Cancel"}),d.jsxs("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg flex items-center",disabled:i,children:[i?d.jsx(At,{size:18,className:"animate-spin mr-2"}):d.jsx(Da,{size:18,className:"mr-2"}),i?"Saving...":"Save Changes"]})]})]})})},tc=({isOpen:r,onClose:e,onConfirm:t,title:n,children:i,confirmText:s="Confirm",cancelText:o="Cancel",confirmButtonClass:l="bg-red-600 hover:bg-red-700 focus:ring-red-500",cancelButtonClass:u="bg-gray-200 hover:bg-gray-300 text-gray-700 focus:ring-gray-400",iconType:f="warning",isConfirming:m=!1})=>{if(!r)return null;let y,g="";switch(f){case"success":y=ks,g="text-green-500";break;case"danger":y=Y9,g="text-red-500";break;case"warning":default:y=Qt,g="text-yellow-500";break}return d.jsxs(Mr,{isOpen:r,onClose:e,title:n,size:"md",children:[d.jsxs("div",{className:"text-center",children:[y&&d.jsx("div",{className:`mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-${f==="warning"?"yellow":f==="success"?"green":"red"}-100 mb-4`,children:d.jsx(y,{className:`h-6 w-6 ${g}`,"aria-hidden":"true"})}),d.jsx("div",{className:"text-sm text-gray-600 mb-6",children:i})]}),d.jsxs("div",{className:"mt-5 sm:mt-6 flex flex-col sm:flex-row-reverse gap-3",children:[d.jsxs("button",{type:"button",className:`w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 text-base font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 sm:text-sm ${l} ${m?"opacity-50 cursor-not-allowed":""}`,onClick:t,disabled:m,children:[m?d.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[d.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),d.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):null,m?"Processing...":s]}),d.jsx("button",{type:"button",className:`w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 text-base font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 sm:text-sm ${u}`,onClick:e,disabled:m,children:o})]})]})};function Wx(){return Wx=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Wx.apply(null,arguments)}function yI(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Gx(r,e){return Gx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Gx(r,e)}function Jq(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,Gx(r,e)}var vI=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function eH(r,e){return!!(r===e||vI(r)&&vI(e))}function tH(r,e){if(r.length!==e.length)return!1;for(var t=0;t<r.length;t++)if(!eH(r[t],e[t]))return!1;return!0}function m1(r,e){e===void 0&&(e=tH);var t,n=[],i,s=!1;function o(){for(var l=[],u=0;u<arguments.length;u++)l[u]=arguments[u];return s&&t===this&&e(l,n)||(i=r.apply(this,l),s=!0,t=this,n=l),i}return o}var nH=typeof performance=="object"&&typeof performance.now=="function",_I=nH?function(){return performance.now()}:function(){return Date.now()};function xI(r){cancelAnimationFrame(r.id)}function rH(r,e){var t=_I();function n(){_I()-t>=e?r.call(null):i.id=requestAnimationFrame(n)}var i={id:requestAnimationFrame(n)};return i}var p1=-1;function bI(r){if(r===void 0&&(r=!1),p1===-1||r){var e=document.createElement("div"),t=e.style;t.width="50px",t.height="50px",t.overflow="scroll",document.body.appendChild(e),p1=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return p1}var sd=null;function wI(r){if(r===void 0&&(r=!1),sd===null||r){var e=document.createElement("div"),t=e.style;t.width="50px",t.height="50px",t.overflow="scroll",t.direction="rtl";var n=document.createElement("div"),i=n.style;return i.width="100px",i.height="100px",e.appendChild(n),document.body.appendChild(e),e.scrollLeft>0?sd="positive-descending":(e.scrollLeft=1,e.scrollLeft===0?sd="negative":sd="positive-ascending"),document.body.removeChild(e),sd}return sd}var iH=150,sH=function(e,t){return e};function oH(r){var e,t=r.getItemOffset,n=r.getEstimatedTotalSize,i=r.getItemSize,s=r.getOffsetForIndexAndAlignment,o=r.getStartIndexForOffset,l=r.getStopIndexForStartIndex,u=r.initInstanceProps,f=r.shouldResetStyleCacheOnItemSizeChange,m=r.validateProps;return e=function(y){Jq(g,y);function g(E){var x;return x=y.call(this,E)||this,x._instanceProps=u(x.props,yI(x)),x._outerRef=void 0,x._resetIsScrollingTimeoutId=null,x.state={instance:yI(x),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof x.props.initialScrollOffset=="number"?x.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},x._callOnItemsRendered=void 0,x._callOnItemsRendered=m1(function(w,S,I,C){return x.props.onItemsRendered({overscanStartIndex:w,overscanStopIndex:S,visibleStartIndex:I,visibleStopIndex:C})}),x._callOnScroll=void 0,x._callOnScroll=m1(function(w,S,I){return x.props.onScroll({scrollDirection:w,scrollOffset:S,scrollUpdateWasRequested:I})}),x._getItemStyle=void 0,x._getItemStyle=function(w){var S=x.props,I=S.direction,C=S.itemSize,N=S.layout,R=x._getItemStyleCache(f&&C,f&&N,f&&I),B;if(R.hasOwnProperty(w))B=R[w];else{var P=t(x.props,w,x._instanceProps),k=i(x.props,w,x._instanceProps),F=I==="horizontal"||N==="horizontal",j=I==="rtl",O=F?P:0;R[w]=B={position:"absolute",left:j?void 0:O,right:j?O:void 0,top:F?0:P,height:F?"100%":k,width:F?k:"100%"}}return B},x._getItemStyleCache=void 0,x._getItemStyleCache=m1(function(w,S,I){return{}}),x._onScrollHorizontal=function(w){var S=w.currentTarget,I=S.clientWidth,C=S.scrollLeft,N=S.scrollWidth;x.setState(function(R){if(R.scrollOffset===C)return null;var B=x.props.direction,P=C;if(B==="rtl")switch(wI()){case"negative":P=-C;break;case"positive-descending":P=N-I-C;break}return P=Math.max(0,Math.min(P,N-I)),{isScrolling:!0,scrollDirection:R.scrollOffset<P?"forward":"backward",scrollOffset:P,scrollUpdateWasRequested:!1}},x._resetIsScrollingDebounced)},x._onScrollVertical=function(w){var S=w.currentTarget,I=S.clientHeight,C=S.scrollHeight,N=S.scrollTop;x.setState(function(R){if(R.scrollOffset===N)return null;var B=Math.max(0,Math.min(N,C-I));return{isScrolling:!0,scrollDirection:R.scrollOffset<B?"forward":"backward",scrollOffset:B,scrollUpdateWasRequested:!1}},x._resetIsScrollingDebounced)},x._outerRefSetter=function(w){var S=x.props.outerRef;x._outerRef=w,typeof S=="function"?S(w):S!=null&&typeof S=="object"&&S.hasOwnProperty("current")&&(S.current=w)},x._resetIsScrollingDebounced=function(){x._resetIsScrollingTimeoutId!==null&&xI(x._resetIsScrollingTimeoutId),x._resetIsScrollingTimeoutId=rH(x._resetIsScrolling,iH)},x._resetIsScrolling=function(){x._resetIsScrollingTimeoutId=null,x.setState({isScrolling:!1},function(){x._getItemStyleCache(-1,null)})},x}g.getDerivedStateFromProps=function(x,w){return aH(x,w),m(x),null};var _=g.prototype;return _.scrollTo=function(x){x=Math.max(0,x),this.setState(function(w){return w.scrollOffset===x?null:{scrollDirection:w.scrollOffset<x?"forward":"backward",scrollOffset:x,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},_.scrollToItem=function(x,w){w===void 0&&(w="auto");var S=this.props,I=S.itemCount,C=S.layout,N=this.state.scrollOffset;x=Math.max(0,Math.min(x,I-1));var R=0;if(this._outerRef){var B=this._outerRef;C==="vertical"?R=B.scrollWidth>B.clientWidth?bI():0:R=B.scrollHeight>B.clientHeight?bI():0}this.scrollTo(s(this.props,x,w,N,this._instanceProps,R))},_.componentDidMount=function(){var x=this.props,w=x.direction,S=x.initialScrollOffset,I=x.layout;if(typeof S=="number"&&this._outerRef!=null){var C=this._outerRef;w==="horizontal"||I==="horizontal"?C.scrollLeft=S:C.scrollTop=S}this._callPropsCallbacks()},_.componentDidUpdate=function(){var x=this.props,w=x.direction,S=x.layout,I=this.state,C=I.scrollOffset,N=I.scrollUpdateWasRequested;if(N&&this._outerRef!=null){var R=this._outerRef;if(w==="horizontal"||S==="horizontal")if(w==="rtl")switch(wI()){case"negative":R.scrollLeft=-C;break;case"positive-ascending":R.scrollLeft=C;break;default:var B=R.clientWidth,P=R.scrollWidth;R.scrollLeft=P-B-C;break}else R.scrollLeft=C;else R.scrollTop=C}this._callPropsCallbacks()},_.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&xI(this._resetIsScrollingTimeoutId)},_.render=function(){var x=this.props,w=x.children,S=x.className,I=x.direction,C=x.height,N=x.innerRef,R=x.innerElementType,B=x.innerTagName,P=x.itemCount,k=x.itemData,F=x.itemKey,j=F===void 0?sH:F,O=x.layout,D=x.outerElementType,M=x.outerTagName,$=x.style,G=x.useIsScrolling,ie=x.width,oe=this.state.isScrolling,ee=I==="horizontal"||O==="horizontal",J=ee?this._onScrollHorizontal:this._onScrollVertical,Y=this._getRangeToRender(),q=Y[0],Z=Y[1],ne=[];if(P>0)for(var se=q;se<=Z;se++)ne.push(te.createElement(w,{data:k,key:j(se,k),index:se,isScrolling:G?oe:void 0,style:this._getItemStyle(se)}));var le=n(this.props,this._instanceProps);return te.createElement(D||M||"div",{className:S,onScroll:J,ref:this._outerRefSetter,style:Wx({position:"relative",height:C,width:ie,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:I},$)},te.createElement(R||B||"div",{children:ne,ref:N,style:{height:ee?"100%":le,pointerEvents:oe?"none":void 0,width:ee?le:"100%"}}))},_._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var x=this.props.itemCount;if(x>0){var w=this._getRangeToRender(),S=w[0],I=w[1],C=w[2],N=w[3];this._callOnItemsRendered(S,I,C,N)}}if(typeof this.props.onScroll=="function"){var R=this.state,B=R.scrollDirection,P=R.scrollOffset,k=R.scrollUpdateWasRequested;this._callOnScroll(B,P,k)}},_._getRangeToRender=function(){var x=this.props,w=x.itemCount,S=x.overscanCount,I=this.state,C=I.isScrolling,N=I.scrollDirection,R=I.scrollOffset;if(w===0)return[0,0,0,0];var B=o(this.props,R,this._instanceProps),P=l(this.props,B,R,this._instanceProps),k=!C||N==="backward"?Math.max(1,S):1,F=!C||N==="forward"?Math.max(1,S):1;return[Math.max(0,B-k),Math.max(0,Math.min(w-1,P+F)),B,P]},g}(te.PureComponent),e.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},e}var aH=function(e,t){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,t.instance},lH=oH({getItemOffset:function(e,t){var n=e.itemSize;return t*n},getItemSize:function(e,t){var n=e.itemSize;return n},getEstimatedTotalSize:function(e){var t=e.itemCount,n=e.itemSize;return n*t},getOffsetForIndexAndAlignment:function(e,t,n,i,s,o){var l=e.direction,u=e.height,f=e.itemCount,m=e.itemSize,y=e.layout,g=e.width,_=l==="horizontal"||y==="horizontal",E=_?g:u,x=Math.max(0,f*m-E),w=Math.min(x,t*m),S=Math.max(0,t*m-E+m+o);switch(n==="smart"&&(i>=S-E&&i<=w+E?n="auto":n="center"),n){case"start":return w;case"end":return S;case"center":{var I=Math.round(S+(w-S)/2);return I<Math.ceil(E/2)?0:I>x+Math.floor(E/2)?x:I}case"auto":default:return i>=S&&i<=w?i:i<S?S:w}},getStartIndexForOffset:function(e,t){var n=e.itemCount,i=e.itemSize;return Math.max(0,Math.min(n-1,Math.floor(t/i)))},getStopIndexForStartIndex:function(e,t,n){var i=e.direction,s=e.height,o=e.itemCount,l=e.itemSize,u=e.layout,f=e.width,m=i==="horizontal"||u==="horizontal",y=t*l,g=m?f:s,_=Math.ceil((g+n-y)/l);return Math.max(0,Math.min(o-1,t+_-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.itemSize}});const g1="w-full px-3 py-2 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",cH=({db:r,showNotification:e,determineServiceTypeAndRole:t,userData:n})=>{const[i,s]=te.useState([]),[o,l]=te.useState(!0),[u,f]=te.useState(null),[m,y]=te.useState(null),[g,_]=te.useState(""),[E,x]=te.useState(!1),[w,S]=te.useState(!1),[I,C]=te.useState(""),[N,R]=te.useState(""),[B,P]=te.useState(""),[k,F]=te.useState(!1),[j,O]=te.useState(""),D=te.useCallback(async()=>{l(!0),O("");const se=await p9(r);if(se.success)s(se.data.sort((le,Q)=>(le.displayName||le.email||"").localeCompare(Q.displayName||Q.email||"")));else{const le=se.error||"Failed to fetch user list. Please try again.";O(le)}l(!1)},[r]);te.useEffect(()=>{D()},[D]);const M=se=>f(se),$=()=>f(null),G=async se=>{if(!u)return;F(!0);const le=await cf(r,u.id,se);le.success?(e("User profile updated successfully!","success"),$(),D()):e(le.error||"Failed to update user profile.","error"),F(!1)},ie=(se,le)=>{y(se),_(le),x(!0)},oe=async()=>{!m||!g||(F(!0),await cf(r,m.id,{accountStatus:g}),e(`User account status changed to ${g}.`,"success"),D(),x(!1),y(null),_(""),F(!1))},ee=se=>{y(se),S(!0)},J=async()=>{if(!m)return;F(!0),await cf(r,m.id,{accountStatus:"Suspended"});const se=await W8(r,m.id);se.success?(e(`User ${m.displayName} has been permanently deleted.`,"success"),D()):(e(se.error||"Failed to delete user profile.","error"),await cf(r,m.id,{accountStatus:m.accountStatus})),S(!1),y(null),F(!1)},Y=i.filter(se=>{var Q,ce,me;const le=I.toLowerCase();return(((Q=se.displayName)==null?void 0:Q.toLowerCase().includes(le))||((ce=se.email)==null?void 0:ce.toLowerCase().includes(le))||((me=se.accountNumber)==null?void 0:me.toLowerCase().includes(le)))&&(N?se.role===N:!0)&&(B?se.accountStatus===B:!0)}),q={admin:"bg-purple-100 text-purple-700",customer:"bg-blue-100 text-blue-700",meter_reader:"bg-teal-100 text-teal-700",clerk_cashier:"bg-indigo-100 text-indigo-700",unknown:"bg-gray-100 text-gray-700"},Z={Active:"bg-green-100 text-green-700",Inactive:"bg-gray-200 text-gray-600",Suspended:"bg-red-100 text-red-700","Profile Missing":"bg-yellow-100 text-yellow-700",Unknown:"bg-gray-100 text-gray-600"},ne=({index:se,style:le})=>{var ce;const Q=Y[se];return d.jsxs("div",{style:le,className:"flex items-center border-b border-gray-200 text-sm",children:[d.jsx("div",{className:"px-4 py-2 whitespace-nowrap text-gray-800 font-medium flex-1",children:Q.displayName||"N/A"}),d.jsx("div",{className:"px-4 py-2 whitespace-nowrap text-gray-500 truncate flex-1",title:Q.email||Q.phoneNumber,children:Q.email||Q.phoneNumber||"N/A"}),d.jsx("div",{className:"px-4 py-2 flex-1",children:d.jsx("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full capitalize ${q[Q.role||"unknown"]}`,children:((ce=Q.role)==null?void 0:ce.replace("_"," "))||"Unknown"})}),d.jsx("div",{className:"px-4 py-2 whitespace-nowrap text-gray-500 font-mono text-xs flex-1",children:Q.accountNumber||"N/A"}),d.jsx("div",{className:"px-4 py-2 flex-1",children:d.jsx("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full ${Z[Q.accountStatus||"Unknown"]}`,children:Q.accountStatus||"Unknown"})}),d.jsx("div",{className:"px-4 py-2 whitespace-nowrap text-gray-500 flex-1",children:Q.createdAt?Yt(Q.createdAt,{year:"numeric",month:"short",day:"numeric"}):"N/A"}),d.jsxs("div",{className:"px-4 py-2 whitespace-nowrap text-sm text-center space-x-1.5 flex-1",children:[d.jsx("button",{onClick:()=>M(Q),className:"text-blue-600 hover:text-blue-800 p-1 hover:bg-blue-100 rounded-md",title:"Edit User",children:d.jsx(T2,{size:16})}),Q.accountStatus!=="Suspended"&&d.jsx("button",{onClick:()=>ie(Q,"Suspended"),className:"text-orange-500 hover:text-orange-700 p-1 hover:bg-orange-100 rounded-md",title:"Suspend User",children:d.jsx(vF,{size:16})}),(Q.accountStatus==="Suspended"||Q.accountStatus==="Inactive")&&d.jsx("button",{onClick:()=>ie(Q,"Active"),className:"text-green-500 hover:text-green-700 p-1 hover:bg-green-100 rounded-md",title:"Activate User",children:d.jsx(s3,{size:16})}),(n==null?void 0:n.uid)!==Q.id&&d.jsx("button",{onClick:()=>ee(Q),className:"text-red-600 hover:text-red-800 p-1 hover:bg-red-100 rounded-md",title:"Delete User",children:d.jsx(th,{size:16})})]})]})};return o?d.jsx(pn,{message:"Loading user accounts...",className:"mt-10 h-64"}):d.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[d.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[d.jsx(wa,{size:30,className:"mr-3 text-blue-600"})," User Account Management"]}),d.jsxs("button",{onClick:D,className:"mt-3 sm:mt-0 text-sm flex items-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-3 rounded-lg border border-gray-300 transition-colors",disabled:o,title:"Refresh User List",children:[o?d.jsx(At,{size:16,className:"animate-spin mr-1.5"}):d.jsx(Ma,{size:16,className:"mr-1.5"})," Refresh List"]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6 p-4 bg-gray-50 rounded-lg shadow-sm",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"userMgmtSearchTerm",className:"block text-xs font-medium text-gray-600 mb-1",children:"Search Users"}),d.jsxs("div",{className:"relative",children:[d.jsx(Rs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),d.jsx("input",{type:"text",id:"userMgmtSearchTerm",placeholder:"Name, Email, Account No...",className:`${g1} pl-9`,value:I,onChange:se=>C(se.target.value)})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"userMgmtFilterRole",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Role"}),d.jsxs("div",{className:"relative",children:[d.jsx(nF,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),d.jsxs("select",{id:"userMgmtFilterRole",className:`${g1} pl-9`,value:N,onChange:se=>R(se.target.value),children:[d.jsx("option",{value:"",children:"All Roles"}),d.jsx("option",{value:"customer",children:"Customer"}),d.jsx("option",{value:"admin",children:"Admin"}),d.jsx("option",{value:"meter_reader",children:"Meter Reader"}),d.jsx("option",{value:"clerk_cashier",children:"Clerk/Cashier"})]})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"userMgmtFilterStatus",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Status"}),d.jsxs("div",{className:"relative",children:[d.jsx(eh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),d.jsxs("select",{id:"userMgmtFilterStatus",className:`${g1} pl-9`,value:B,onChange:se=>P(se.target.value),children:[d.jsx("option",{value:"",children:"All Statuses"}),d.jsx("option",{value:"Active",children:"Active"}),d.jsx("option",{value:"Inactive",children:"Inactive"}),d.jsx("option",{value:"Suspended",children:"Suspended"}),d.jsx("option",{value:"Profile Missing",children:"Profile Missing"})]})]})]})]}),!o&&Y.length===0&&d.jsxs("div",{className:"text-center py-10",children:[d.jsx(kn,{size:48,className:"mx-auto text-gray-400 mb-3"}),d.jsx("p",{className:"text-gray-500 text-lg",children:i.length===0&&!j?"No users found.":"No users match your filters."})]}),!o&&Y.length>0&&d.jsxs("div",{className:"overflow-x-auto shadow-md rounded-lg border border-gray-200",children:[d.jsxs("div",{className:"flex bg-gray-100 text-xs font-medium text-gray-500 uppercase tracking-wider",children:[d.jsx("div",{className:"px-4 py-3 flex-1",children:"Name"}),d.jsx("div",{className:"px-4 py-3 flex-1",children:"Email / Contact"}),d.jsx("div",{className:"px-4 py-3 flex-1",children:"Role"}),d.jsx("div",{className:"px-4 py-3 flex-1",children:"Account No."}),d.jsx("div",{className:"px-4 py-3 flex-1",children:"Status"}),d.jsx("div",{className:"px-4 py-3 flex-1",children:"Joined"}),d.jsx("div",{className:"px-4 py-3 text-center flex-1",children:"Actions"})]}),d.jsx(lH,{height:400,itemCount:Y.length,itemSize:60,width:"100%",children:ne})]}),u&&d.jsx(Xq,{user:u,isOpen:!!u,onClose:$,onSave:G,isSaving:k,determineServiceTypeAndRole:t,showNotification:e}),E&&m&&d.jsx(tc,{isOpen:E,onClose:()=>x(!1),onConfirm:oe,title:"Confirm Status Change",confirmText:k?"Updating...":`Set to ${g}`,isConfirming:k,iconType:g==="Active"?"success":"danger",confirmButtonClass:g==="Active"?"bg-green-600 hover:bg-green-700 focus:ring-green-500":"bg-red-600 hover:bg-red-700 focus:ring-red-500",children:d.jsxs("p",{children:["Change status for ",d.jsx("strong",{children:m.displayName||m.email})," to ",d.jsx("strong",{className:g==="Active"?"text-green-600":"text-red-600",children:g}),"?"]})}),w&&m&&d.jsxs(tc,{isOpen:w,onClose:()=>S(!1),onConfirm:J,title:"Confirm User Deletion",confirmText:"Yes, Permanently Delete",isConfirming:k,iconType:"danger",children:[d.jsxs("p",{children:["Are you sure you want to delete ",d.jsx("strong",{children:m.displayName||m.email}),"?"]}),d.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"This will permanently delete the user's profile and data. Their authentication account will be disabled. This action cannot be undone."})]})]})};var y1,EI;function uH(){if(EI)return y1;EI=1;function r(){this.__data__=[],this.size=0}return y1=r,y1}var v1,TI;function yR(){if(TI)return v1;TI=1;function r(e,t){return e===t||e!==e&&t!==t}return v1=r,v1}var _1,SI;function u0(){if(SI)return _1;SI=1;var r=yR();function e(t,n){for(var i=t.length;i--;)if(r(t[i][0],n))return i;return-1}return _1=e,_1}var x1,AI;function dH(){if(AI)return x1;AI=1;var r=u0(),e=Array.prototype,t=e.splice;function n(i){var s=this.__data__,o=r(s,i);if(o<0)return!1;var l=s.length-1;return o==l?s.pop():t.call(s,o,1),--this.size,!0}return x1=n,x1}var b1,II;function hH(){if(II)return b1;II=1;var r=u0();function e(t){var n=this.__data__,i=r(n,t);return i<0?void 0:n[i][1]}return b1=e,b1}var w1,NI;function fH(){if(NI)return w1;NI=1;var r=u0();function e(t){return r(this.__data__,t)>-1}return w1=e,w1}var E1,kI;function mH(){if(kI)return E1;kI=1;var r=u0();function e(t,n){var i=this.__data__,s=r(i,t);return s<0?(++this.size,i.push([t,n])):i[s][1]=n,this}return E1=e,E1}var T1,PI;function d0(){if(PI)return T1;PI=1;var r=uH(),e=dH(),t=hH(),n=fH(),i=mH();function s(o){var l=-1,u=o==null?0:o.length;for(this.clear();++l<u;){var f=o[l];this.set(f[0],f[1])}}return s.prototype.clear=r,s.prototype.delete=e,s.prototype.get=t,s.prototype.has=n,s.prototype.set=i,T1=s,T1}var S1,CI;function pH(){if(CI)return S1;CI=1;var r=d0();function e(){this.__data__=new r,this.size=0}return S1=e,S1}var A1,RI;function gH(){if(RI)return A1;RI=1;function r(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}return A1=r,A1}var I1,OI;function yH(){if(OI)return I1;OI=1;function r(e){return this.__data__.get(e)}return I1=r,I1}var N1,jI;function vH(){if(jI)return N1;jI=1;function r(e){return this.__data__.has(e)}return N1=r,N1}var k1,MI;function vR(){if(MI)return k1;MI=1;var r=typeof Ip=="object"&&Ip&&Ip.Object===Object&&Ip;return k1=r,k1}var P1,DI;function Fa(){if(DI)return P1;DI=1;var r=vR(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=r||e||Function("return this")();return P1=t,P1}var C1,LI;function H2(){if(LI)return C1;LI=1;var r=Fa(),e=r.Symbol;return C1=e,C1}var R1,FI;function _H(){if(FI)return R1;FI=1;var r=H2(),e=Object.prototype,t=e.hasOwnProperty,n=e.toString,i=r?r.toStringTag:void 0;function s(o){var l=t.call(o,i),u=o[i];try{o[i]=void 0;var f=!0}catch{}var m=n.call(o);return f&&(l?o[i]=u:delete o[i]),m}return R1=s,R1}var O1,VI;function xH(){if(VI)return O1;VI=1;var r=Object.prototype,e=r.toString;function t(n){return e.call(n)}return O1=t,O1}var j1,zI;function h0(){if(zI)return j1;zI=1;var r=H2(),e=_H(),t=xH(),n="[object Null]",i="[object Undefined]",s=r?r.toStringTag:void 0;function o(l){return l==null?l===void 0?i:n:s&&s in Object(l)?e(l):t(l)}return j1=o,j1}var M1,BI;function _R(){if(BI)return M1;BI=1;function r(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return M1=r,M1}var D1,UI;function xR(){if(UI)return D1;UI=1;var r=h0(),e=_R(),t="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",s="[object Proxy]";function o(l){if(!e(l))return!1;var u=r(l);return u==n||u==i||u==t||u==s}return D1=o,D1}var L1,qI;function bH(){if(qI)return L1;qI=1;var r=Fa(),e=r["__core-js_shared__"];return L1=e,L1}var F1,HI;function wH(){if(HI)return F1;HI=1;var r=bH(),e=function(){var n=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function t(n){return!!e&&e in n}return F1=t,F1}var V1,$I;function bR(){if($I)return V1;$I=1;var r=Function.prototype,e=r.toString;function t(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return V1=t,V1}var z1,WI;function EH(){if(WI)return z1;WI=1;var r=xR(),e=wH(),t=_R(),n=bR(),i=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,o=Function.prototype,l=Object.prototype,u=o.toString,f=l.hasOwnProperty,m=RegExp("^"+u.call(f).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function y(g){if(!t(g)||e(g))return!1;var _=r(g)?m:s;return _.test(n(g))}return z1=y,z1}var B1,GI;function TH(){if(GI)return B1;GI=1;function r(e,t){return e==null?void 0:e[t]}return B1=r,B1}var U1,KI;function rh(){if(KI)return U1;KI=1;var r=EH(),e=TH();function t(n,i){var s=e(n,i);return r(s)?s:void 0}return U1=t,U1}var q1,YI;function $2(){if(YI)return q1;YI=1;var r=rh(),e=Fa(),t=r(e,"Map");return q1=t,q1}var H1,ZI;function f0(){if(ZI)return H1;ZI=1;var r=rh(),e=r(Object,"create");return H1=e,H1}var $1,QI;function SH(){if(QI)return $1;QI=1;var r=f0();function e(){this.__data__=r?r(null):{},this.size=0}return $1=e,$1}var W1,XI;function AH(){if(XI)return W1;XI=1;function r(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}return W1=r,W1}var G1,JI;function IH(){if(JI)return G1;JI=1;var r=f0(),e="__lodash_hash_undefined__",t=Object.prototype,n=t.hasOwnProperty;function i(s){var o=this.__data__;if(r){var l=o[s];return l===e?void 0:l}return n.call(o,s)?o[s]:void 0}return G1=i,G1}var K1,eN;function NH(){if(eN)return K1;eN=1;var r=f0(),e=Object.prototype,t=e.hasOwnProperty;function n(i){var s=this.__data__;return r?s[i]!==void 0:t.call(s,i)}return K1=n,K1}var Y1,tN;function kH(){if(tN)return Y1;tN=1;var r=f0(),e="__lodash_hash_undefined__";function t(n,i){var s=this.__data__;return this.size+=this.has(n)?0:1,s[n]=r&&i===void 0?e:i,this}return Y1=t,Y1}var Z1,nN;function PH(){if(nN)return Z1;nN=1;var r=SH(),e=AH(),t=IH(),n=NH(),i=kH();function s(o){var l=-1,u=o==null?0:o.length;for(this.clear();++l<u;){var f=o[l];this.set(f[0],f[1])}}return s.prototype.clear=r,s.prototype.delete=e,s.prototype.get=t,s.prototype.has=n,s.prototype.set=i,Z1=s,Z1}var Q1,rN;function CH(){if(rN)return Q1;rN=1;var r=PH(),e=d0(),t=$2();function n(){this.size=0,this.__data__={hash:new r,map:new(t||e),string:new r}}return Q1=n,Q1}var X1,iN;function RH(){if(iN)return X1;iN=1;function r(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}return X1=r,X1}var J1,sN;function m0(){if(sN)return J1;sN=1;var r=RH();function e(t,n){var i=t.__data__;return r(n)?i[typeof n=="string"?"string":"hash"]:i.map}return J1=e,J1}var e_,oN;function OH(){if(oN)return e_;oN=1;var r=m0();function e(t){var n=r(this,t).delete(t);return this.size-=n?1:0,n}return e_=e,e_}var t_,aN;function jH(){if(aN)return t_;aN=1;var r=m0();function e(t){return r(this,t).get(t)}return t_=e,t_}var n_,lN;function MH(){if(lN)return n_;lN=1;var r=m0();function e(t){return r(this,t).has(t)}return n_=e,n_}var r_,cN;function DH(){if(cN)return r_;cN=1;var r=m0();function e(t,n){var i=r(this,t),s=i.size;return i.set(t,n),this.size+=i.size==s?0:1,this}return r_=e,r_}var i_,uN;function wR(){if(uN)return i_;uN=1;var r=CH(),e=OH(),t=jH(),n=MH(),i=DH();function s(o){var l=-1,u=o==null?0:o.length;for(this.clear();++l<u;){var f=o[l];this.set(f[0],f[1])}}return s.prototype.clear=r,s.prototype.delete=e,s.prototype.get=t,s.prototype.has=n,s.prototype.set=i,i_=s,i_}var s_,dN;function LH(){if(dN)return s_;dN=1;var r=d0(),e=$2(),t=wR(),n=200;function i(s,o){var l=this.__data__;if(l instanceof r){var u=l.__data__;if(!e||u.length<n-1)return u.push([s,o]),this.size=++l.size,this;l=this.__data__=new t(u)}return l.set(s,o),this.size=l.size,this}return s_=i,s_}var o_,hN;function FH(){if(hN)return o_;hN=1;var r=d0(),e=pH(),t=gH(),n=yH(),i=vH(),s=LH();function o(l){var u=this.__data__=new r(l);this.size=u.size}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=i,o.prototype.set=s,o_=o,o_}var a_,fN;function VH(){if(fN)return a_;fN=1;var r="__lodash_hash_undefined__";function e(t){return this.__data__.set(t,r),this}return a_=e,a_}var l_,mN;function zH(){if(mN)return l_;mN=1;function r(e){return this.__data__.has(e)}return l_=r,l_}var c_,pN;function BH(){if(pN)return c_;pN=1;var r=wR(),e=VH(),t=zH();function n(i){var s=-1,o=i==null?0:i.length;for(this.__data__=new r;++s<o;)this.add(i[s])}return n.prototype.add=n.prototype.push=e,n.prototype.has=t,c_=n,c_}var u_,gN;function UH(){if(gN)return u_;gN=1;function r(e,t){for(var n=-1,i=e==null?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}return u_=r,u_}var d_,yN;function qH(){if(yN)return d_;yN=1;function r(e,t){return e.has(t)}return d_=r,d_}var h_,vN;function ER(){if(vN)return h_;vN=1;var r=BH(),e=UH(),t=qH(),n=1,i=2;function s(o,l,u,f,m,y){var g=u&n,_=o.length,E=l.length;if(_!=E&&!(g&&E>_))return!1;var x=y.get(o),w=y.get(l);if(x&&w)return x==l&&w==o;var S=-1,I=!0,C=u&i?new r:void 0;for(y.set(o,l),y.set(l,o);++S<_;){var N=o[S],R=l[S];if(f)var B=g?f(R,N,S,l,o,y):f(N,R,S,o,l,y);if(B!==void 0){if(B)continue;I=!1;break}if(C){if(!e(l,function(P,k){if(!t(C,k)&&(N===P||m(N,P,u,f,y)))return C.push(k)})){I=!1;break}}else if(!(N===R||m(N,R,u,f,y))){I=!1;break}}return y.delete(o),y.delete(l),I}return h_=s,h_}var f_,_N;function HH(){if(_N)return f_;_N=1;var r=Fa(),e=r.Uint8Array;return f_=e,f_}var m_,xN;function $H(){if(xN)return m_;xN=1;function r(e){var t=-1,n=Array(e.size);return e.forEach(function(i,s){n[++t]=[s,i]}),n}return m_=r,m_}var p_,bN;function WH(){if(bN)return p_;bN=1;function r(e){var t=-1,n=Array(e.size);return e.forEach(function(i){n[++t]=i}),n}return p_=r,p_}var g_,wN;function GH(){if(wN)return g_;wN=1;var r=H2(),e=HH(),t=yR(),n=ER(),i=$H(),s=WH(),o=1,l=2,u="[object Boolean]",f="[object Date]",m="[object Error]",y="[object Map]",g="[object Number]",_="[object RegExp]",E="[object Set]",x="[object String]",w="[object Symbol]",S="[object ArrayBuffer]",I="[object DataView]",C=r?r.prototype:void 0,N=C?C.valueOf:void 0;function R(B,P,k,F,j,O,D){switch(k){case I:if(B.byteLength!=P.byteLength||B.byteOffset!=P.byteOffset)return!1;B=B.buffer,P=P.buffer;case S:return!(B.byteLength!=P.byteLength||!O(new e(B),new e(P)));case u:case f:case g:return t(+B,+P);case m:return B.name==P.name&&B.message==P.message;case _:case x:return B==P+"";case y:var M=i;case E:var $=F&o;if(M||(M=s),B.size!=P.size&&!$)return!1;var G=D.get(B);if(G)return G==P;F|=l,D.set(B,P);var ie=n(M(B),M(P),F,j,O,D);return D.delete(B),ie;case w:if(N)return N.call(B)==N.call(P)}return!1}return g_=R,g_}var y_,EN;function KH(){if(EN)return y_;EN=1;function r(e,t){for(var n=-1,i=t.length,s=e.length;++n<i;)e[s+n]=t[n];return e}return y_=r,y_}var v_,TN;function W2(){if(TN)return v_;TN=1;var r=Array.isArray;return v_=r,v_}var __,SN;function YH(){if(SN)return __;SN=1;var r=KH(),e=W2();function t(n,i,s){var o=i(n);return e(n)?o:r(o,s(n))}return __=t,__}var x_,AN;function ZH(){if(AN)return x_;AN=1;function r(e,t){for(var n=-1,i=e==null?0:e.length,s=0,o=[];++n<i;){var l=e[n];t(l,n,e)&&(o[s++]=l)}return o}return x_=r,x_}var b_,IN;function QH(){if(IN)return b_;IN=1;function r(){return[]}return b_=r,b_}var w_,NN;function XH(){if(NN)return w_;NN=1;var r=ZH(),e=QH(),t=Object.prototype,n=t.propertyIsEnumerable,i=Object.getOwnPropertySymbols,s=i?function(o){return o==null?[]:(o=Object(o),r(i(o),function(l){return n.call(o,l)}))}:e;return w_=s,w_}var E_,kN;function JH(){if(kN)return E_;kN=1;function r(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}return E_=r,E_}var T_,PN;function p0(){if(PN)return T_;PN=1;function r(e){return e!=null&&typeof e=="object"}return T_=r,T_}var S_,CN;function e$(){if(CN)return S_;CN=1;var r=h0(),e=p0(),t="[object Arguments]";function n(i){return e(i)&&r(i)==t}return S_=n,S_}var A_,RN;function t$(){if(RN)return A_;RN=1;var r=e$(),e=p0(),t=Object.prototype,n=t.hasOwnProperty,i=t.propertyIsEnumerable,s=r(function(){return arguments}())?r:function(o){return e(o)&&n.call(o,"callee")&&!i.call(o,"callee")};return A_=s,A_}var pf={exports:{}},I_,ON;function n$(){if(ON)return I_;ON=1;function r(){return!1}return I_=r,I_}pf.exports;var jN;function TR(){return jN||(jN=1,function(r,e){var t=Fa(),n=n$(),i=e&&!e.nodeType&&e,s=i&&!0&&r&&!r.nodeType&&r,o=s&&s.exports===i,l=o?t.Buffer:void 0,u=l?l.isBuffer:void 0,f=u||n;r.exports=f}(pf,pf.exports)),pf.exports}var N_,MN;function r$(){if(MN)return N_;MN=1;var r=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function t(n,i){var s=typeof n;return i=i??r,!!i&&(s=="number"||s!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<i}return N_=t,N_}var k_,DN;function SR(){if(DN)return k_;DN=1;var r=9007199254740991;function e(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=r}return k_=e,k_}var P_,LN;function i$(){if(LN)return P_;LN=1;var r=h0(),e=SR(),t=p0(),n="[object Arguments]",i="[object Array]",s="[object Boolean]",o="[object Date]",l="[object Error]",u="[object Function]",f="[object Map]",m="[object Number]",y="[object Object]",g="[object RegExp]",_="[object Set]",E="[object String]",x="[object WeakMap]",w="[object ArrayBuffer]",S="[object DataView]",I="[object Float32Array]",C="[object Float64Array]",N="[object Int8Array]",R="[object Int16Array]",B="[object Int32Array]",P="[object Uint8Array]",k="[object Uint8ClampedArray]",F="[object Uint16Array]",j="[object Uint32Array]",O={};O[I]=O[C]=O[N]=O[R]=O[B]=O[P]=O[k]=O[F]=O[j]=!0,O[n]=O[i]=O[w]=O[s]=O[S]=O[o]=O[l]=O[u]=O[f]=O[m]=O[y]=O[g]=O[_]=O[E]=O[x]=!1;function D(M){return t(M)&&e(M.length)&&!!O[r(M)]}return P_=D,P_}var C_,FN;function s$(){if(FN)return C_;FN=1;function r(e){return function(t){return e(t)}}return C_=r,C_}var gf={exports:{}};gf.exports;var VN;function o$(){return VN||(VN=1,function(r,e){var t=vR(),n=e&&!e.nodeType&&e,i=n&&!0&&r&&!r.nodeType&&r,s=i&&i.exports===n,o=s&&t.process,l=function(){try{var u=i&&i.require&&i.require("util").types;return u||o&&o.binding&&o.binding("util")}catch{}}();r.exports=l}(gf,gf.exports)),gf.exports}var R_,zN;function AR(){if(zN)return R_;zN=1;var r=i$(),e=s$(),t=o$(),n=t&&t.isTypedArray,i=n?e(n):r;return R_=i,R_}var O_,BN;function a$(){if(BN)return O_;BN=1;var r=JH(),e=t$(),t=W2(),n=TR(),i=r$(),s=AR(),o=Object.prototype,l=o.hasOwnProperty;function u(f,m){var y=t(f),g=!y&&e(f),_=!y&&!g&&n(f),E=!y&&!g&&!_&&s(f),x=y||g||_||E,w=x?r(f.length,String):[],S=w.length;for(var I in f)(m||l.call(f,I))&&!(x&&(I=="length"||_&&(I=="offset"||I=="parent")||E&&(I=="buffer"||I=="byteLength"||I=="byteOffset")||i(I,S)))&&w.push(I);return w}return O_=u,O_}var j_,UN;function l$(){if(UN)return j_;UN=1;var r=Object.prototype;function e(t){var n=t&&t.constructor,i=typeof n=="function"&&n.prototype||r;return t===i}return j_=e,j_}var M_,qN;function c$(){if(qN)return M_;qN=1;function r(e,t){return function(n){return e(t(n))}}return M_=r,M_}var D_,HN;function u$(){if(HN)return D_;HN=1;var r=c$(),e=r(Object.keys,Object);return D_=e,D_}var L_,$N;function d$(){if($N)return L_;$N=1;var r=l$(),e=u$(),t=Object.prototype,n=t.hasOwnProperty;function i(s){if(!r(s))return e(s);var o=[];for(var l in Object(s))n.call(s,l)&&l!="constructor"&&o.push(l);return o}return L_=i,L_}var F_,WN;function h$(){if(WN)return F_;WN=1;var r=xR(),e=SR();function t(n){return n!=null&&e(n.length)&&!r(n)}return F_=t,F_}var V_,GN;function f$(){if(GN)return V_;GN=1;var r=a$(),e=d$(),t=h$();function n(i){return t(i)?r(i):e(i)}return V_=n,V_}var z_,KN;function m$(){if(KN)return z_;KN=1;var r=YH(),e=XH(),t=f$();function n(i){return r(i,t,e)}return z_=n,z_}var B_,YN;function p$(){if(YN)return B_;YN=1;var r=m$(),e=1,t=Object.prototype,n=t.hasOwnProperty;function i(s,o,l,u,f,m){var y=l&e,g=r(s),_=g.length,E=r(o),x=E.length;if(_!=x&&!y)return!1;for(var w=_;w--;){var S=g[w];if(!(y?S in o:n.call(o,S)))return!1}var I=m.get(s),C=m.get(o);if(I&&C)return I==o&&C==s;var N=!0;m.set(s,o),m.set(o,s);for(var R=y;++w<_;){S=g[w];var B=s[S],P=o[S];if(u)var k=y?u(P,B,S,o,s,m):u(B,P,S,s,o,m);if(!(k===void 0?B===P||f(B,P,l,u,m):k)){N=!1;break}R||(R=S=="constructor")}if(N&&!R){var F=s.constructor,j=o.constructor;F!=j&&"constructor"in s&&"constructor"in o&&!(typeof F=="function"&&F instanceof F&&typeof j=="function"&&j instanceof j)&&(N=!1)}return m.delete(s),m.delete(o),N}return B_=i,B_}var U_,ZN;function g$(){if(ZN)return U_;ZN=1;var r=rh(),e=Fa(),t=r(e,"DataView");return U_=t,U_}var q_,QN;function y$(){if(QN)return q_;QN=1;var r=rh(),e=Fa(),t=r(e,"Promise");return q_=t,q_}var H_,XN;function v$(){if(XN)return H_;XN=1;var r=rh(),e=Fa(),t=r(e,"Set");return H_=t,H_}var $_,JN;function _$(){if(JN)return $_;JN=1;var r=rh(),e=Fa(),t=r(e,"WeakMap");return $_=t,$_}var W_,e4;function x$(){if(e4)return W_;e4=1;var r=g$(),e=$2(),t=y$(),n=v$(),i=_$(),s=h0(),o=bR(),l="[object Map]",u="[object Object]",f="[object Promise]",m="[object Set]",y="[object WeakMap]",g="[object DataView]",_=o(r),E=o(e),x=o(t),w=o(n),S=o(i),I=s;return(r&&I(new r(new ArrayBuffer(1)))!=g||e&&I(new e)!=l||t&&I(t.resolve())!=f||n&&I(new n)!=m||i&&I(new i)!=y)&&(I=function(C){var N=s(C),R=N==u?C.constructor:void 0,B=R?o(R):"";if(B)switch(B){case _:return g;case E:return l;case x:return f;case w:return m;case S:return y}return N}),W_=I,W_}var G_,t4;function b$(){if(t4)return G_;t4=1;var r=FH(),e=ER(),t=GH(),n=p$(),i=x$(),s=W2(),o=TR(),l=AR(),u=1,f="[object Arguments]",m="[object Array]",y="[object Object]",g=Object.prototype,_=g.hasOwnProperty;function E(x,w,S,I,C,N){var R=s(x),B=s(w),P=R?m:i(x),k=B?m:i(w);P=P==f?y:P,k=k==f?y:k;var F=P==y,j=k==y,O=P==k;if(O&&o(x)){if(!o(w))return!1;R=!0,F=!1}if(O&&!F)return N||(N=new r),R||l(x)?e(x,w,S,I,C,N):t(x,w,P,S,I,C,N);if(!(S&u)){var D=F&&_.call(x,"__wrapped__"),M=j&&_.call(w,"__wrapped__");if(D||M){var $=D?x.value():x,G=M?w.value():w;return N||(N=new r),C($,G,S,I,N)}}return O?(N||(N=new r),n(x,w,S,I,C,N)):!1}return G_=E,G_}var K_,n4;function w$(){if(n4)return K_;n4=1;var r=b$(),e=p0();function t(n,i,s,o,l){return n===i?!0:n==null||i==null||!e(n)&&!e(i)?n!==n&&i!==i:r(n,i,s,o,t,l)}return K_=t,K_}var Y_,r4;function E$(){if(r4)return Y_;r4=1;var r=w$();function e(t,n){return r(t,n)}return Y_=e,Y_}var Sg={exports:{}};/*!
 * Quill Editor v1.3.7
 * https://quilljs.com/
 * Copyright (c) 2014, Jason Chen
 * Copyright (c) 2013, salesforce.com
 */var T$=Sg.exports,i4;function S$(){return i4||(i4=1,function(r,e){(function(n,i){r.exports=i()})(typeof self<"u"?self:T$,function(){return function(t){var n={};function i(s){if(n[s])return n[s].exports;var o=n[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=n,i.d=function(s,o,l){i.o(s,o)||Object.defineProperty(s,o,{configurable:!1,enumerable:!0,get:l})},i.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return i.d(o,"a",o),o},i.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},i.p="",i(i.s=109)}([function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(17),o=i(18),l=i(19),u=i(45),f=i(46),m=i(47),y=i(48),g=i(49),_=i(12),E=i(32),x=i(33),w=i(31),S=i(1),I={Scope:S.Scope,create:S.create,find:S.find,query:S.query,register:S.register,Container:s.default,Format:o.default,Leaf:l.default,Embed:y.default,Scroll:u.default,Block:m.default,Inline:f.default,Text:g.default,Attributor:{Attribute:_.default,Class:E.default,Style:x.default,Store:w.default}};n.default=I},function(t,n,i){var s=this&&this.__extends||function(){var w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(S,I){S.__proto__=I}||function(S,I){for(var C in I)I.hasOwnProperty(C)&&(S[C]=I[C])};return function(S,I){w(S,I);function C(){this.constructor=S}S.prototype=I===null?Object.create(I):(C.prototype=I.prototype,new C)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=function(w){s(S,w);function S(I){var C=this;return I="[Parchment] "+I,C=w.call(this,I)||this,C.message=I,C.name=C.constructor.name,C}return S}(Error);n.ParchmentError=o;var l={},u={},f={},m={};n.DATA_KEY="__blot";var y;(function(w){w[w.TYPE=3]="TYPE",w[w.LEVEL=12]="LEVEL",w[w.ATTRIBUTE=13]="ATTRIBUTE",w[w.BLOT=14]="BLOT",w[w.INLINE=7]="INLINE",w[w.BLOCK=11]="BLOCK",w[w.BLOCK_BLOT=10]="BLOCK_BLOT",w[w.INLINE_BLOT=6]="INLINE_BLOT",w[w.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",w[w.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",w[w.ANY=15]="ANY"})(y=n.Scope||(n.Scope={}));function g(w,S){var I=E(w);if(I==null)throw new o("Unable to create "+w+" blot");var C=I,N=w instanceof Node||w.nodeType===Node.TEXT_NODE?w:C.create(S);return new C(N,S)}n.create=g;function _(w,S){return S===void 0&&(S=!1),w==null?null:w[n.DATA_KEY]!=null?w[n.DATA_KEY].blot:S?_(w.parentNode,S):null}n.find=_;function E(w,S){S===void 0&&(S=y.ANY);var I;if(typeof w=="string")I=m[w]||l[w];else if(w instanceof Text||w.nodeType===Node.TEXT_NODE)I=m.text;else if(typeof w=="number")w&y.LEVEL&y.BLOCK?I=m.block:w&y.LEVEL&y.INLINE&&(I=m.inline);else if(w instanceof HTMLElement){var C=(w.getAttribute("class")||"").split(/\s+/);for(var N in C)if(I=u[C[N]],I)break;I=I||f[w.tagName]}return I==null?null:S&y.LEVEL&I.scope&&S&y.TYPE&I.scope?I:null}n.query=E;function x(){for(var w=[],S=0;S<arguments.length;S++)w[S]=arguments[S];if(w.length>1)return w.map(function(N){return x(N)});var I=w[0];if(typeof I.blotName!="string"&&typeof I.attrName!="string")throw new o("Invalid definition");if(I.blotName==="abstract")throw new o("Cannot register abstract class");if(m[I.blotName||I.attrName]=I,typeof I.keyName=="string")l[I.keyName]=I;else if(I.className!=null&&(u[I.className]=I),I.tagName!=null){Array.isArray(I.tagName)?I.tagName=I.tagName.map(function(N){return N.toUpperCase()}):I.tagName=I.tagName.toUpperCase();var C=Array.isArray(I.tagName)?I.tagName:[I.tagName];C.forEach(function(N){(f[N]==null||I.className==null)&&(f[N]=I)})}return I}n.register=x},function(t,n,i){var s=i(51),o=i(11),l=i(3),u=i(20),f="\0",m=function(y){Array.isArray(y)?this.ops=y:y!=null&&Array.isArray(y.ops)?this.ops=y.ops:this.ops=[]};m.prototype.insert=function(y,g){var _={};return y.length===0?this:(_.insert=y,g!=null&&typeof g=="object"&&Object.keys(g).length>0&&(_.attributes=g),this.push(_))},m.prototype.delete=function(y){return y<=0?this:this.push({delete:y})},m.prototype.retain=function(y,g){if(y<=0)return this;var _={retain:y};return g!=null&&typeof g=="object"&&Object.keys(g).length>0&&(_.attributes=g),this.push(_)},m.prototype.push=function(y){var g=this.ops.length,_=this.ops[g-1];if(y=l(!0,{},y),typeof _=="object"){if(typeof y.delete=="number"&&typeof _.delete=="number")return this.ops[g-1]={delete:_.delete+y.delete},this;if(typeof _.delete=="number"&&y.insert!=null&&(g-=1,_=this.ops[g-1],typeof _!="object"))return this.ops.unshift(y),this;if(o(y.attributes,_.attributes)){if(typeof y.insert=="string"&&typeof _.insert=="string")return this.ops[g-1]={insert:_.insert+y.insert},typeof y.attributes=="object"&&(this.ops[g-1].attributes=y.attributes),this;if(typeof y.retain=="number"&&typeof _.retain=="number")return this.ops[g-1]={retain:_.retain+y.retain},typeof y.attributes=="object"&&(this.ops[g-1].attributes=y.attributes),this}}return g===this.ops.length?this.ops.push(y):this.ops.splice(g,0,y),this},m.prototype.chop=function(){var y=this.ops[this.ops.length-1];return y&&y.retain&&!y.attributes&&this.ops.pop(),this},m.prototype.filter=function(y){return this.ops.filter(y)},m.prototype.forEach=function(y){this.ops.forEach(y)},m.prototype.map=function(y){return this.ops.map(y)},m.prototype.partition=function(y){var g=[],_=[];return this.forEach(function(E){var x=y(E)?g:_;x.push(E)}),[g,_]},m.prototype.reduce=function(y,g){return this.ops.reduce(y,g)},m.prototype.changeLength=function(){return this.reduce(function(y,g){return g.insert?y+u.length(g):g.delete?y-g.delete:y},0)},m.prototype.length=function(){return this.reduce(function(y,g){return y+u.length(g)},0)},m.prototype.slice=function(y,g){y=y||0,typeof g!="number"&&(g=1/0);for(var _=[],E=u.iterator(this.ops),x=0;x<g&&E.hasNext();){var w;x<y?w=E.next(y-x):(w=E.next(g-x),_.push(w)),x+=u.length(w)}return new m(_)},m.prototype.compose=function(y){var g=u.iterator(this.ops),_=u.iterator(y.ops),E=[],x=_.peek();if(x!=null&&typeof x.retain=="number"&&x.attributes==null){for(var w=x.retain;g.peekType()==="insert"&&g.peekLength()<=w;)w-=g.peekLength(),E.push(g.next());x.retain-w>0&&_.next(x.retain-w)}for(var S=new m(E);g.hasNext()||_.hasNext();)if(_.peekType()==="insert")S.push(_.next());else if(g.peekType()==="delete")S.push(g.next());else{var I=Math.min(g.peekLength(),_.peekLength()),C=g.next(I),N=_.next(I);if(typeof N.retain=="number"){var R={};typeof C.retain=="number"?R.retain=I:R.insert=C.insert;var B=u.attributes.compose(C.attributes,N.attributes,typeof C.retain=="number");if(B&&(R.attributes=B),S.push(R),!_.hasNext()&&o(S.ops[S.ops.length-1],R)){var P=new m(g.rest());return S.concat(P).chop()}}else typeof N.delete=="number"&&typeof C.retain=="number"&&S.push(N)}return S.chop()},m.prototype.concat=function(y){var g=new m(this.ops.slice());return y.ops.length>0&&(g.push(y.ops[0]),g.ops=g.ops.concat(y.ops.slice(1))),g},m.prototype.diff=function(y,g){if(this.ops===y.ops)return new m;var _=[this,y].map(function(I){return I.map(function(C){if(C.insert!=null)return typeof C.insert=="string"?C.insert:f;var N=I===y?"on":"with";throw new Error("diff() called "+N+" non-document")}).join("")}),E=new m,x=s(_[0],_[1],g),w=u.iterator(this.ops),S=u.iterator(y.ops);return x.forEach(function(I){for(var C=I[1].length;C>0;){var N=0;switch(I[0]){case s.INSERT:N=Math.min(S.peekLength(),C),E.push(S.next(N));break;case s.DELETE:N=Math.min(C,w.peekLength()),w.next(N),E.delete(N);break;case s.EQUAL:N=Math.min(w.peekLength(),S.peekLength(),C);var R=w.next(N),B=S.next(N);o(R.insert,B.insert)?E.retain(N,u.attributes.diff(R.attributes,B.attributes)):E.push(B).delete(N);break}C-=N}}),E.chop()},m.prototype.eachLine=function(y,g){g=g||`
`;for(var _=u.iterator(this.ops),E=new m,x=0;_.hasNext();){if(_.peekType()!=="insert")return;var w=_.peek(),S=u.length(w)-_.peekLength(),I=typeof w.insert=="string"?w.insert.indexOf(g,S)-S:-1;if(I<0)E.push(_.next());else if(I>0)E.push(_.next(I));else{if(y(E,_.next(1).attributes||{},x)===!1)return;x+=1,E=new m}}E.length()>0&&y(E,{},x)},m.prototype.transform=function(y,g){if(g=!!g,typeof y=="number")return this.transformPosition(y,g);for(var _=u.iterator(this.ops),E=u.iterator(y.ops),x=new m;_.hasNext()||E.hasNext();)if(_.peekType()==="insert"&&(g||E.peekType()!=="insert"))x.retain(u.length(_.next()));else if(E.peekType()==="insert")x.push(E.next());else{var w=Math.min(_.peekLength(),E.peekLength()),S=_.next(w),I=E.next(w);if(S.delete)continue;I.delete?x.push(I):x.retain(w,u.attributes.transform(S.attributes,I.attributes,g))}return x.chop()},m.prototype.transformPosition=function(y,g){g=!!g;for(var _=u.iterator(this.ops),E=0;_.hasNext()&&E<=y;){var x=_.peekLength(),w=_.peekType();if(_.next(),w==="delete"){y-=Math.min(x,y-E);continue}else w==="insert"&&(E<y||!g)&&(y+=x);E+=x}return y},t.exports=m},function(t,n){var i=Object.prototype.hasOwnProperty,s=Object.prototype.toString,o=Object.defineProperty,l=Object.getOwnPropertyDescriptor,u=function(_){return typeof Array.isArray=="function"?Array.isArray(_):s.call(_)==="[object Array]"},f=function(_){if(!_||s.call(_)!=="[object Object]")return!1;var E=i.call(_,"constructor"),x=_.constructor&&_.constructor.prototype&&i.call(_.constructor.prototype,"isPrototypeOf");if(_.constructor&&!E&&!x)return!1;var w;for(w in _);return typeof w>"u"||i.call(_,w)},m=function(_,E){o&&E.name==="__proto__"?o(_,E.name,{enumerable:!0,configurable:!0,value:E.newValue,writable:!0}):_[E.name]=E.newValue},y=function(_,E){if(E==="__proto__")if(i.call(_,E)){if(l)return l(_,E).value}else return;return _[E]};t.exports=function g(){var _,E,x,w,S,I,C=arguments[0],N=1,R=arguments.length,B=!1;for(typeof C=="boolean"&&(B=C,C=arguments[1]||{},N=2),(C==null||typeof C!="object"&&typeof C!="function")&&(C={});N<R;++N)if(_=arguments[N],_!=null)for(E in _)x=y(C,E),w=y(_,E),C!==w&&(B&&w&&(f(w)||(S=u(w)))?(S?(S=!1,I=x&&u(x)?x:[]):I=x&&f(x)?x:{},m(C,{name:E,newValue:g(B,I,w)})):typeof w<"u"&&m(C,{name:E,newValue:w}));return C}},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BlockEmbed=n.bubbleFormats=void 0;var s=function(){function O(D,M){for(var $=0;$<M.length;$++){var G=M[$];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(D,G.key,G)}}return function(D,M,$){return M&&O(D.prototype,M),$&&O(D,$),D}}(),o=function O(D,M,$){D===null&&(D=Function.prototype);var G=Object.getOwnPropertyDescriptor(D,M);if(G===void 0){var ie=Object.getPrototypeOf(D);return ie===null?void 0:O(ie,M,$)}else{if("value"in G)return G.value;var oe=G.get;return oe===void 0?void 0:oe.call($)}},l=i(3),u=C(l),f=i(2),m=C(f),y=i(0),g=C(y),_=i(16),E=C(_),x=i(6),w=C(x),S=i(7),I=C(S);function C(O){return O&&O.__esModule?O:{default:O}}function N(O,D){if(!(O instanceof D))throw new TypeError("Cannot call a class as a function")}function R(O,D){if(!O)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D&&(typeof D=="object"||typeof D=="function")?D:O}function B(O,D){if(typeof D!="function"&&D!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof D);O.prototype=Object.create(D&&D.prototype,{constructor:{value:O,enumerable:!1,writable:!0,configurable:!0}}),D&&(Object.setPrototypeOf?Object.setPrototypeOf(O,D):O.__proto__=D)}var P=1,k=function(O){B(D,O);function D(){return N(this,D),R(this,(D.__proto__||Object.getPrototypeOf(D)).apply(this,arguments))}return s(D,[{key:"attach",value:function(){o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"attach",this).call(this),this.attributes=new g.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return new m.default().insert(this.value(),(0,u.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function($,G){var ie=g.default.query($,g.default.Scope.BLOCK_ATTRIBUTE);ie!=null&&this.attributes.attribute(ie,G)}},{key:"formatAt",value:function($,G,ie,oe){this.format(ie,oe)}},{key:"insertAt",value:function($,G,ie){if(typeof G=="string"&&G.endsWith(`
`)){var oe=g.default.create(F.blotName);this.parent.insertBefore(oe,$===0?this:this.next),oe.insertAt(0,G.slice(0,-1))}else o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"insertAt",this).call(this,$,G,ie)}}]),D}(g.default.Embed);k.scope=g.default.Scope.BLOCK_BLOT;var F=function(O){B(D,O);function D(M){N(this,D);var $=R(this,(D.__proto__||Object.getPrototypeOf(D)).call(this,M));return $.cache={},$}return s(D,[{key:"delta",value:function(){return this.cache.delta==null&&(this.cache.delta=this.descendants(g.default.Leaf).reduce(function($,G){return G.length()===0?$:$.insert(G.value(),j(G))},new m.default).insert(`
`,j(this))),this.cache.delta}},{key:"deleteAt",value:function($,G){o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"deleteAt",this).call(this,$,G),this.cache={}}},{key:"formatAt",value:function($,G,ie,oe){G<=0||(g.default.query(ie,g.default.Scope.BLOCK)?$+G===this.length()&&this.format(ie,oe):o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"formatAt",this).call(this,$,Math.min(G,this.length()-$-1),ie,oe),this.cache={})}},{key:"insertAt",value:function($,G,ie){if(ie!=null)return o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"insertAt",this).call(this,$,G,ie);if(G.length!==0){var oe=G.split(`
`),ee=oe.shift();ee.length>0&&($<this.length()-1||this.children.tail==null?o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"insertAt",this).call(this,Math.min($,this.length()-1),ee):this.children.tail.insertAt(this.children.tail.length(),ee),this.cache={});var J=this;oe.reduce(function(Y,q){return J=J.split(Y,!0),J.insertAt(0,q),q.length},$+ee.length)}}},{key:"insertBefore",value:function($,G){var ie=this.children.head;o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"insertBefore",this).call(this,$,G),ie instanceof E.default&&ie.remove(),this.cache={}}},{key:"length",value:function(){return this.cache.length==null&&(this.cache.length=o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"length",this).call(this)+P),this.cache.length}},{key:"moveChildren",value:function($,G){o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"moveChildren",this).call(this,$,G),this.cache={}}},{key:"optimize",value:function($){o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"optimize",this).call(this,$),this.cache={}}},{key:"path",value:function($){return o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"path",this).call(this,$,!0)}},{key:"removeChild",value:function($){o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"removeChild",this).call(this,$),this.cache={}}},{key:"split",value:function($){var G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(G&&($===0||$>=this.length()-P)){var ie=this.clone();return $===0?(this.parent.insertBefore(ie,this),this):(this.parent.insertBefore(ie,this.next),ie)}else{var oe=o(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"split",this).call(this,$,G);return this.cache={},oe}}}]),D}(g.default.Block);F.blotName="block",F.tagName="P",F.defaultChild="break",F.allowedChildren=[w.default,g.default.Embed,I.default];function j(O){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return O==null||(typeof O.formats=="function"&&(D=(0,u.default)(D,O.formats())),O.parent==null||O.parent.blotName=="scroll"||O.parent.statics.scope!==O.statics.scope)?D:j(O.parent,D)}n.bubbleFormats=j,n.BlockEmbed=k,n.default=F},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.overload=n.expandConfig=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(J){return typeof J}:function(J){return J&&typeof Symbol=="function"&&J.constructor===Symbol&&J!==Symbol.prototype?"symbol":typeof J},o=function(){function J(Y,q){var Z=[],ne=!0,se=!1,le=void 0;try{for(var Q=Y[Symbol.iterator](),ce;!(ne=(ce=Q.next()).done)&&(Z.push(ce.value),!(q&&Z.length===q));ne=!0);}catch(me){se=!0,le=me}finally{try{!ne&&Q.return&&Q.return()}finally{if(se)throw le}}return Z}return function(Y,q){if(Array.isArray(Y))return Y;if(Symbol.iterator in Object(Y))return J(Y,q);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function J(Y,q){for(var Z=0;Z<q.length;Z++){var ne=q[Z];ne.enumerable=ne.enumerable||!1,ne.configurable=!0,"value"in ne&&(ne.writable=!0),Object.defineProperty(Y,ne.key,ne)}}return function(Y,q,Z){return q&&J(Y.prototype,q),Z&&J(Y,Z),Y}}();i(50);var u=i(2),f=j(u),m=i(14),y=j(m),g=i(8),_=j(g),E=i(9),x=j(E),w=i(0),S=j(w),I=i(15),C=j(I),N=i(3),R=j(N),B=i(10),P=j(B),k=i(34),F=j(k);function j(J){return J&&J.__esModule?J:{default:J}}function O(J,Y,q){return Y in J?Object.defineProperty(J,Y,{value:q,enumerable:!0,configurable:!0,writable:!0}):J[Y]=q,J}function D(J,Y){if(!(J instanceof Y))throw new TypeError("Cannot call a class as a function")}var M=(0,P.default)("quill"),$=function(){l(J,null,[{key:"debug",value:function(q){q===!0&&(q="log"),P.default.level(q)}},{key:"find",value:function(q){return q.__quill||S.default.find(q)}},{key:"import",value:function(q){return this.imports[q]==null&&M.error("Cannot import "+q+". Are you sure it was registered?"),this.imports[q]}},{key:"register",value:function(q,Z){var ne=this,se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof q!="string"){var le=q.attrName||q.blotName;typeof le=="string"?this.register("formats/"+le,q,Z):Object.keys(q).forEach(function(Q){ne.register(Q,q[Q],Z)})}else this.imports[q]!=null&&!se&&M.warn("Overwriting "+q+" with",Z),this.imports[q]=Z,(q.startsWith("blots/")||q.startsWith("formats/"))&&Z.blotName!=="abstract"?S.default.register(Z):q.startsWith("modules")&&typeof Z.register=="function"&&Z.register()}}]);function J(Y){var q=this,Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(D(this,J),this.options=G(Y,Z),this.container=this.options.container,this.container==null)return M.error("Invalid Quill container",Y);this.options.debug&&J.debug(this.options.debug);var ne=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new _.default,this.scroll=S.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new y.default(this.scroll),this.selection=new C.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(_.default.events.EDITOR_CHANGE,function(le){le===_.default.events.TEXT_CHANGE&&q.root.classList.toggle("ql-blank",q.editor.isBlank())}),this.emitter.on(_.default.events.SCROLL_UPDATE,function(le,Q){var ce=q.selection.lastRange,me=ce&&ce.length===0?ce.index:void 0;ie.call(q,function(){return q.editor.update(null,Q,me)},le)});var se=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">`+ne+"<p><br></p></div>");this.setContents(se),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return l(J,[{key:"addContainer",value:function(q){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof q=="string"){var ne=q;q=document.createElement("div"),q.classList.add(ne)}return this.container.insertBefore(q,Z),q}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(q,Z,ne){var se=this,le=oe(q,Z,ne),Q=o(le,4);return q=Q[0],Z=Q[1],ne=Q[3],ie.call(this,function(){return se.editor.deleteText(q,Z)},ne,q,-1*Z)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(q),this.container.classList.toggle("ql-disabled",!q)}},{key:"focus",value:function(){var q=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=q,this.scrollIntoView()}},{key:"format",value:function(q,Z){var ne=this,se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_.default.sources.API;return ie.call(this,function(){var le=ne.getSelection(!0),Q=new f.default;if(le==null)return Q;if(S.default.query(q,S.default.Scope.BLOCK))Q=ne.editor.formatLine(le.index,le.length,O({},q,Z));else{if(le.length===0)return ne.selection.format(q,Z),Q;Q=ne.editor.formatText(le.index,le.length,O({},q,Z))}return ne.setSelection(le,_.default.sources.SILENT),Q},se)}},{key:"formatLine",value:function(q,Z,ne,se,le){var Q=this,ce=void 0,me=oe(q,Z,ne,se,le),ge=o(me,4);return q=ge[0],Z=ge[1],ce=ge[2],le=ge[3],ie.call(this,function(){return Q.editor.formatLine(q,Z,ce)},le,q,0)}},{key:"formatText",value:function(q,Z,ne,se,le){var Q=this,ce=void 0,me=oe(q,Z,ne,se,le),ge=o(me,4);return q=ge[0],Z=ge[1],ce=ge[2],le=ge[3],ie.call(this,function(){return Q.editor.formatText(q,Z,ce)},le,q,0)}},{key:"getBounds",value:function(q){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,ne=void 0;typeof q=="number"?ne=this.selection.getBounds(q,Z):ne=this.selection.getBounds(q.index,q.length);var se=this.container.getBoundingClientRect();return{bottom:ne.bottom-se.top,height:ne.height,left:ne.left-se.left,right:ne.right-se.left,top:ne.top-se.top,width:ne.width}}},{key:"getContents",value:function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-q,ne=oe(q,Z),se=o(ne,2);return q=se[0],Z=se[1],this.editor.getContents(q,Z)}},{key:"getFormat",value:function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof q=="number"?this.editor.getFormat(q,Z):this.editor.getFormat(q.index,q.length)}},{key:"getIndex",value:function(q){return q.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(q){return this.scroll.leaf(q)}},{key:"getLine",value:function(q){return this.scroll.line(q)}},{key:"getLines",value:function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof q!="number"?this.scroll.lines(q.index,q.length):this.scroll.lines(q,Z)}},{key:"getModule",value:function(q){return this.theme.modules[q]}},{key:"getSelection",value:function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return q&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-q,ne=oe(q,Z),se=o(ne,2);return q=se[0],Z=se[1],this.editor.getText(q,Z)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(q,Z,ne){var se=this,le=arguments.length>3&&arguments[3]!==void 0?arguments[3]:J.sources.API;return ie.call(this,function(){return se.editor.insertEmbed(q,Z,ne)},le,q)}},{key:"insertText",value:function(q,Z,ne,se,le){var Q=this,ce=void 0,me=oe(q,0,ne,se,le),ge=o(me,4);return q=ge[0],ce=ge[2],le=ge[3],ie.call(this,function(){return Q.editor.insertText(q,Z,ce)},le,q,Z.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(q,Z,ne){this.clipboard.dangerouslyPasteHTML(q,Z,ne)}},{key:"removeFormat",value:function(q,Z,ne){var se=this,le=oe(q,Z,ne),Q=o(le,4);return q=Q[0],Z=Q[1],ne=Q[3],ie.call(this,function(){return se.editor.removeFormat(q,Z)},ne,q)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(q){var Z=this,ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.default.sources.API;return ie.call(this,function(){q=new f.default(q);var se=Z.getLength(),le=Z.editor.deleteText(0,se),Q=Z.editor.applyDelta(q),ce=Q.ops[Q.ops.length-1];ce!=null&&typeof ce.insert=="string"&&ce.insert[ce.insert.length-1]===`
`&&(Z.editor.deleteText(Z.getLength()-1,1),Q.delete(1));var me=le.compose(Q);return me},ne)}},{key:"setSelection",value:function(q,Z,ne){if(q==null)this.selection.setRange(null,Z||J.sources.API);else{var se=oe(q,Z,ne),le=o(se,4);q=le[0],Z=le[1],ne=le[3],this.selection.setRange(new I.Range(q,Z),ne),ne!==_.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(q){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.default.sources.API,ne=new f.default().insert(q);return this.setContents(ne,Z)}},{key:"update",value:function(){var q=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_.default.sources.USER,Z=this.scroll.update(q);return this.selection.update(q),Z}},{key:"updateContents",value:function(q){var Z=this,ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.default.sources.API;return ie.call(this,function(){return q=new f.default(q),Z.editor.applyDelta(q,ne)},ne,!0)}}]),J}();$.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},$.events=_.default.events,$.sources=_.default.sources,$.version="1.3.7",$.imports={delta:f.default,parchment:S.default,"core/module":x.default,"core/theme":F.default};function G(J,Y){if(Y=(0,R.default)(!0,{container:J,modules:{clipboard:!0,keyboard:!0,history:!0}},Y),!Y.theme||Y.theme===$.DEFAULTS.theme)Y.theme=F.default;else if(Y.theme=$.import("themes/"+Y.theme),Y.theme==null)throw new Error("Invalid theme "+Y.theme+". Did you register it?");var q=(0,R.default)(!0,{},Y.theme.DEFAULTS);[q,Y].forEach(function(se){se.modules=se.modules||{},Object.keys(se.modules).forEach(function(le){se.modules[le]===!0&&(se.modules[le]={})})});var Z=Object.keys(q.modules).concat(Object.keys(Y.modules)),ne=Z.reduce(function(se,le){var Q=$.import("modules/"+le);return Q==null?M.error("Cannot load "+le+" module. Are you sure you registered it?"):se[le]=Q.DEFAULTS||{},se},{});return Y.modules!=null&&Y.modules.toolbar&&Y.modules.toolbar.constructor!==Object&&(Y.modules.toolbar={container:Y.modules.toolbar}),Y=(0,R.default)(!0,{},$.DEFAULTS,{modules:ne},q,Y),["bounds","container","scrollingContainer"].forEach(function(se){typeof Y[se]=="string"&&(Y[se]=document.querySelector(Y[se]))}),Y.modules=Object.keys(Y.modules).reduce(function(se,le){return Y.modules[le]&&(se[le]=Y.modules[le]),se},{}),Y}function ie(J,Y,q,Z){if(this.options.strict&&!this.isEnabled()&&Y===_.default.sources.USER)return new f.default;var ne=q==null?null:this.getSelection(),se=this.editor.delta,le=J();if(ne!=null&&(q===!0&&(q=ne.index),Z==null?ne=ee(ne,le,Y):Z!==0&&(ne=ee(ne,q,Z,Y)),this.setSelection(ne,_.default.sources.SILENT)),le.length()>0){var Q,ce=[_.default.events.TEXT_CHANGE,le,se,Y];if((Q=this.emitter).emit.apply(Q,[_.default.events.EDITOR_CHANGE].concat(ce)),Y!==_.default.sources.SILENT){var me;(me=this.emitter).emit.apply(me,ce)}}return le}function oe(J,Y,q,Z,ne){var se={};return typeof J.index=="number"&&typeof J.length=="number"?typeof Y!="number"?(ne=Z,Z=q,q=Y,Y=J.length,J=J.index):(Y=J.length,J=J.index):typeof Y!="number"&&(ne=Z,Z=q,q=Y,Y=0),(typeof q>"u"?"undefined":s(q))==="object"?(se=q,ne=Z):typeof q=="string"&&(Z!=null?se[q]=Z:ne=q),ne=ne||_.default.sources.API,[J,Y,se,ne]}function ee(J,Y,q,Z){if(J==null)return null;var ne=void 0,se=void 0;if(Y instanceof f.default){var le=[J.index,J.index+J.length].map(function(ge){return Y.transformPosition(ge,Z!==_.default.sources.USER)}),Q=o(le,2);ne=Q[0],se=Q[1]}else{var ce=[J.index,J.index+J.length].map(function(ge){return ge<Y||ge===Y&&Z===_.default.sources.USER?ge:q>=0?ge+q:Math.max(Y,ge+q)}),me=o(ce,2);ne=me[0],se=me[1]}return new I.Range(ne,se-ne)}n.expandConfig=G,n.overload=oe,n.default=$},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function w(S,I){for(var C=0;C<I.length;C++){var N=I[C];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(S,N.key,N)}}return function(S,I,C){return I&&w(S.prototype,I),C&&w(S,C),S}}(),o=function w(S,I,C){S===null&&(S=Function.prototype);var N=Object.getOwnPropertyDescriptor(S,I);if(N===void 0){var R=Object.getPrototypeOf(S);return R===null?void 0:w(R,I,C)}else{if("value"in N)return N.value;var B=N.get;return B===void 0?void 0:B.call(C)}},l=i(7),u=y(l),f=i(0),m=y(f);function y(w){return w&&w.__esModule?w:{default:w}}function g(w,S){if(!(w instanceof S))throw new TypeError("Cannot call a class as a function")}function _(w,S){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:w}function E(w,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);w.prototype=Object.create(S&&S.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(w,S):w.__proto__=S)}var x=function(w){E(S,w);function S(){return g(this,S),_(this,(S.__proto__||Object.getPrototypeOf(S)).apply(this,arguments))}return s(S,[{key:"formatAt",value:function(C,N,R,B){if(S.compare(this.statics.blotName,R)<0&&m.default.query(R,m.default.Scope.BLOT)){var P=this.isolate(C,N);B&&P.wrap(R,B)}else o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"formatAt",this).call(this,C,N,R,B)}},{key:"optimize",value:function(C){if(o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"optimize",this).call(this,C),this.parent instanceof S&&S.compare(this.statics.blotName,this.parent.statics.blotName)>0){var N=this.parent.isolate(this.offset(),this.length());this.moveChildren(N),N.wrap(this)}}}],[{key:"compare",value:function(C,N){var R=S.order.indexOf(C),B=S.order.indexOf(N);return R>=0||B>=0?R-B:C===N?0:C<N?-1:1}}]),S}(m.default.Inline);x.allowedChildren=[x,m.default.Embed,u.default],x.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],n.default=x},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(0),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}function u(g,_){if(!(g instanceof _))throw new TypeError("Cannot call a class as a function")}function f(g,_){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:g}function m(g,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);g.prototype=Object.create(_&&_.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(g,_):g.__proto__=_)}var y=function(g){m(_,g);function _(){return u(this,_),f(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return _}(o.default.Text);n.default=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function I(C,N){for(var R=0;R<N.length;R++){var B=N[R];B.enumerable=B.enumerable||!1,B.configurable=!0,"value"in B&&(B.writable=!0),Object.defineProperty(C,B.key,B)}}return function(C,N,R){return N&&I(C.prototype,N),R&&I(C,R),C}}(),o=function I(C,N,R){C===null&&(C=Function.prototype);var B=Object.getOwnPropertyDescriptor(C,N);if(B===void 0){var P=Object.getPrototypeOf(C);return P===null?void 0:I(P,N,R)}else{if("value"in B)return B.value;var k=B.get;return k===void 0?void 0:k.call(R)}},l=i(54),u=y(l),f=i(10),m=y(f);function y(I){return I&&I.__esModule?I:{default:I}}function g(I,C){if(!(I instanceof C))throw new TypeError("Cannot call a class as a function")}function _(I,C){if(!I)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C&&(typeof C=="object"||typeof C=="function")?C:I}function E(I,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof C);I.prototype=Object.create(C&&C.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}),C&&(Object.setPrototypeOf?Object.setPrototypeOf(I,C):I.__proto__=C)}var x=(0,m.default)("quill:events"),w=["selectionchange","mousedown","mouseup","click"];w.forEach(function(I){document.addEventListener(I,function(){for(var C=arguments.length,N=Array(C),R=0;R<C;R++)N[R]=arguments[R];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(B){if(B.__quill&&B.__quill.emitter){var P;(P=B.__quill.emitter).handleDOM.apply(P,N)}})})});var S=function(I){E(C,I);function C(){g(this,C);var N=_(this,(C.__proto__||Object.getPrototypeOf(C)).call(this));return N.listeners={},N.on("error",x.error),N}return s(C,[{key:"emit",value:function(){x.log.apply(x,arguments),o(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(R){for(var B=arguments.length,P=Array(B>1?B-1:0),k=1;k<B;k++)P[k-1]=arguments[k];(this.listeners[R.type]||[]).forEach(function(F){var j=F.node,O=F.handler;(R.target===j||j.contains(R.target))&&O.apply(void 0,[R].concat(P))})}},{key:"listenDOM",value:function(R,B,P){this.listeners[R]||(this.listeners[R]=[]),this.listeners[R].push({node:B,handler:P})}}]),C}(u.default);S.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},S.sources={API:"api",SILENT:"silent",USER:"user"},n.default=S},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});function s(l,u){if(!(l instanceof u))throw new TypeError("Cannot call a class as a function")}var o=function l(u){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};s(this,l),this.quill=u,this.options=f};o.DEFAULTS={},n.default=o},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=["error","warn","log","info"],o="warn";function l(f){if(s.indexOf(f)<=s.indexOf(o)){for(var m,y=arguments.length,g=Array(y>1?y-1:0),_=1;_<y;_++)g[_-1]=arguments[_];(m=console)[f].apply(m,g)}}function u(f){return s.reduce(function(m,y){return m[y]=l.bind(console,y,f),m},{})}l.level=u.level=function(f){o=f},n.default=u},function(t,n,i){var s=Array.prototype.slice,o=i(52),l=i(53),u=t.exports=function(g,_,E){return E||(E={}),g===_?!0:g instanceof Date&&_ instanceof Date?g.getTime()===_.getTime():!g||!_||typeof g!="object"&&typeof _!="object"?E.strict?g===_:g==_:y(g,_,E)};function f(g){return g==null}function m(g){return!(!g||typeof g!="object"||typeof g.length!="number"||typeof g.copy!="function"||typeof g.slice!="function"||g.length>0&&typeof g[0]!="number")}function y(g,_,E){var x,w;if(f(g)||f(_)||g.prototype!==_.prototype)return!1;if(l(g))return l(_)?(g=s.call(g),_=s.call(_),u(g,_,E)):!1;if(m(g)){if(!m(_)||g.length!==_.length)return!1;for(x=0;x<g.length;x++)if(g[x]!==_[x])return!1;return!0}try{var S=o(g),I=o(_)}catch{return!1}if(S.length!=I.length)return!1;for(S.sort(),I.sort(),x=S.length-1;x>=0;x--)if(S[x]!=I[x])return!1;for(x=S.length-1;x>=0;x--)if(w=S[x],!u(g[w],_[w],E))return!1;return typeof g==typeof _}},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(1),o=function(){function l(u,f,m){m===void 0&&(m={}),this.attrName=u,this.keyName=f;var y=s.Scope.TYPE&s.Scope.ATTRIBUTE;m.scope!=null?this.scope=m.scope&s.Scope.LEVEL|y:this.scope=s.Scope.ATTRIBUTE,m.whitelist!=null&&(this.whitelist=m.whitelist)}return l.keys=function(u){return[].map.call(u.attributes,function(f){return f.name})},l.prototype.add=function(u,f){return this.canAdd(u,f)?(u.setAttribute(this.keyName,f),!0):!1},l.prototype.canAdd=function(u,f){var m=s.query(u,s.Scope.BLOT&(this.scope|s.Scope.TYPE));return m==null?!1:this.whitelist==null?!0:typeof f=="string"?this.whitelist.indexOf(f.replace(/["']/g,""))>-1:this.whitelist.indexOf(f)>-1},l.prototype.remove=function(u){u.removeAttribute(this.keyName)},l.prototype.value=function(u){var f=u.getAttribute(this.keyName);return this.canAdd(u,f)&&f?f:""},l}();n.default=o},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Code=void 0;var s=function(){function k(F,j){var O=[],D=!0,M=!1,$=void 0;try{for(var G=F[Symbol.iterator](),ie;!(D=(ie=G.next()).done)&&(O.push(ie.value),!(j&&O.length===j));D=!0);}catch(oe){M=!0,$=oe}finally{try{!D&&G.return&&G.return()}finally{if(M)throw $}}return O}return function(F,j){if(Array.isArray(F))return F;if(Symbol.iterator in Object(F))return k(F,j);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function k(F,j){for(var O=0;O<j.length;O++){var D=j[O];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(F,D.key,D)}}return function(F,j,O){return j&&k(F.prototype,j),O&&k(F,O),F}}(),l=function k(F,j,O){F===null&&(F=Function.prototype);var D=Object.getOwnPropertyDescriptor(F,j);if(D===void 0){var M=Object.getPrototypeOf(F);return M===null?void 0:k(M,j,O)}else{if("value"in D)return D.value;var $=D.get;return $===void 0?void 0:$.call(O)}},u=i(2),f=I(u),m=i(0),y=I(m),g=i(4),_=I(g),E=i(6),x=I(E),w=i(7),S=I(w);function I(k){return k&&k.__esModule?k:{default:k}}function C(k,F){if(!(k instanceof F))throw new TypeError("Cannot call a class as a function")}function N(k,F){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F&&(typeof F=="object"||typeof F=="function")?F:k}function R(k,F){if(typeof F!="function"&&F!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof F);k.prototype=Object.create(F&&F.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),F&&(Object.setPrototypeOf?Object.setPrototypeOf(k,F):k.__proto__=F)}var B=function(k){R(F,k);function F(){return C(this,F),N(this,(F.__proto__||Object.getPrototypeOf(F)).apply(this,arguments))}return F}(x.default);B.blotName="code",B.tagName="CODE";var P=function(k){R(F,k);function F(){return C(this,F),N(this,(F.__proto__||Object.getPrototypeOf(F)).apply(this,arguments))}return o(F,[{key:"delta",value:function(){var O=this,D=this.domNode.textContent;return D.endsWith(`
`)&&(D=D.slice(0,-1)),D.split(`
`).reduce(function(M,$){return M.insert($).insert(`
`,O.formats())},new f.default)}},{key:"format",value:function(O,D){if(!(O===this.statics.blotName&&D)){var M=this.descendant(S.default,this.length()-1),$=s(M,1),G=$[0];G!=null&&G.deleteAt(G.length()-1,1),l(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"format",this).call(this,O,D)}}},{key:"formatAt",value:function(O,D,M,$){if(D!==0&&!(y.default.query(M,y.default.Scope.BLOCK)==null||M===this.statics.blotName&&$===this.statics.formats(this.domNode))){var G=this.newlineIndex(O);if(!(G<0||G>=O+D)){var ie=this.newlineIndex(O,!0)+1,oe=G-ie+1,ee=this.isolate(ie,oe),J=ee.next;ee.format(M,$),J instanceof F&&J.formatAt(0,O-ie+D-oe,M,$)}}}},{key:"insertAt",value:function(O,D,M){if(M==null){var $=this.descendant(S.default,O),G=s($,2),ie=G[0],oe=G[1];ie.insertAt(oe,D)}}},{key:"length",value:function(){var O=this.domNode.textContent.length;return this.domNode.textContent.endsWith(`
`)?O:O+1}},{key:"newlineIndex",value:function(O){var D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(D)return this.domNode.textContent.slice(0,O).lastIndexOf(`
`);var M=this.domNode.textContent.slice(O).indexOf(`
`);return M>-1?O+M:-1}},{key:"optimize",value:function(O){this.domNode.textContent.endsWith(`
`)||this.appendChild(y.default.create("text",`
`)),l(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"optimize",this).call(this,O);var D=this.next;D!=null&&D.prev===this&&D.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===D.statics.formats(D.domNode)&&(D.optimize(O),D.moveChildren(this),D.remove())}},{key:"replace",value:function(O){l(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"replace",this).call(this,O),[].slice.call(this.domNode.querySelectorAll("*")).forEach(function(D){var M=y.default.find(D);M==null?D.parentNode.removeChild(D):M instanceof y.default.Embed?M.remove():M.unwrap()})}}],[{key:"create",value:function(O){var D=l(F.__proto__||Object.getPrototypeOf(F),"create",this).call(this,O);return D.setAttribute("spellcheck",!1),D}},{key:"formats",value:function(){return!0}}]),F}(_.default);P.blotName="code-block",P.tagName="PRE",P.TAB="  ",n.Code=B,n.default=P},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(J){return typeof J}:function(J){return J&&typeof Symbol=="function"&&J.constructor===Symbol&&J!==Symbol.prototype?"symbol":typeof J},o=function(){function J(Y,q){var Z=[],ne=!0,se=!1,le=void 0;try{for(var Q=Y[Symbol.iterator](),ce;!(ne=(ce=Q.next()).done)&&(Z.push(ce.value),!(q&&Z.length===q));ne=!0);}catch(me){se=!0,le=me}finally{try{!ne&&Q.return&&Q.return()}finally{if(se)throw le}}return Z}return function(Y,q){if(Array.isArray(Y))return Y;if(Symbol.iterator in Object(Y))return J(Y,q);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function J(Y,q){for(var Z=0;Z<q.length;Z++){var ne=q[Z];ne.enumerable=ne.enumerable||!1,ne.configurable=!0,"value"in ne&&(ne.writable=!0),Object.defineProperty(Y,ne.key,ne)}}return function(Y,q,Z){return q&&J(Y.prototype,q),Z&&J(Y,Z),Y}}(),u=i(2),f=D(u),m=i(20),y=D(m),g=i(0),_=D(g),E=i(13),x=D(E),w=i(24),S=D(w),I=i(4),C=D(I),N=i(16),R=D(N),B=i(21),P=D(B),k=i(11),F=D(k),j=i(3),O=D(j);function D(J){return J&&J.__esModule?J:{default:J}}function M(J,Y,q){return Y in J?Object.defineProperty(J,Y,{value:q,enumerable:!0,configurable:!0,writable:!0}):J[Y]=q,J}function $(J,Y){if(!(J instanceof Y))throw new TypeError("Cannot call a class as a function")}var G=/^[ -~]*$/,ie=function(){function J(Y){$(this,J),this.scroll=Y,this.delta=this.getDelta()}return l(J,[{key:"applyDelta",value:function(q){var Z=this,ne=!1;this.scroll.update();var se=this.scroll.length();return this.scroll.batchStart(),q=ee(q),q.reduce(function(le,Q){var ce=Q.retain||Q.delete||Q.insert.length||1,me=Q.attributes||{};if(Q.insert!=null){if(typeof Q.insert=="string"){var ge=Q.insert;ge.endsWith(`
`)&&ne&&(ne=!1,ge=ge.slice(0,-1)),le>=se&&!ge.endsWith(`
`)&&(ne=!0),Z.scroll.insertAt(le,ge);var Ae=Z.scroll.line(le),Ue=o(Ae,2),nt=Ue[0],et=Ue[1],pt=(0,O.default)({},(0,I.bubbleFormats)(nt));if(nt instanceof C.default){var Et=nt.descendant(_.default.Leaf,et),_n=o(Et,1),Wt=_n[0];pt=(0,O.default)(pt,(0,I.bubbleFormats)(Wt))}me=y.default.attributes.diff(pt,me)||{}}else if(s(Q.insert)==="object"){var Se=Object.keys(Q.insert)[0];if(Se==null)return le;Z.scroll.insertAt(le,Se,Q.insert[Se])}se+=ce}return Object.keys(me).forEach(function(Ie){Z.scroll.formatAt(le,ce,Ie,me[Ie])}),le+ce},0),q.reduce(function(le,Q){return typeof Q.delete=="number"?(Z.scroll.deleteAt(le,Q.delete),le):le+(Q.retain||Q.insert.length||1)},0),this.scroll.batchEnd(),this.update(q)}},{key:"deleteText",value:function(q,Z){return this.scroll.deleteAt(q,Z),this.update(new f.default().retain(q).delete(Z))}},{key:"formatLine",value:function(q,Z){var ne=this,se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.scroll.update(),Object.keys(se).forEach(function(le){if(!(ne.scroll.whitelist!=null&&!ne.scroll.whitelist[le])){var Q=ne.scroll.lines(q,Math.max(Z,1)),ce=Z;Q.forEach(function(me){var ge=me.length();if(!(me instanceof x.default))me.format(le,se[le]);else{var Ae=q-me.offset(ne.scroll),Ue=me.newlineIndex(Ae+ce)-Ae+1;me.formatAt(Ae,Ue,le,se[le])}ce-=ge})}}),this.scroll.optimize(),this.update(new f.default().retain(q).retain(Z,(0,P.default)(se)))}},{key:"formatText",value:function(q,Z){var ne=this,se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Object.keys(se).forEach(function(le){ne.scroll.formatAt(q,Z,le,se[le])}),this.update(new f.default().retain(q).retain(Z,(0,P.default)(se)))}},{key:"getContents",value:function(q,Z){return this.delta.slice(q,q+Z)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce(function(q,Z){return q.concat(Z.delta())},new f.default)}},{key:"getFormat",value:function(q){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,ne=[],se=[];Z===0?this.scroll.path(q).forEach(function(Q){var ce=o(Q,1),me=ce[0];me instanceof C.default?ne.push(me):me instanceof _.default.Leaf&&se.push(me)}):(ne=this.scroll.lines(q,Z),se=this.scroll.descendants(_.default.Leaf,q,Z));var le=[ne,se].map(function(Q){if(Q.length===0)return{};for(var ce=(0,I.bubbleFormats)(Q.shift());Object.keys(ce).length>0;){var me=Q.shift();if(me==null)return ce;ce=oe((0,I.bubbleFormats)(me),ce)}return ce});return O.default.apply(O.default,le)}},{key:"getText",value:function(q,Z){return this.getContents(q,Z).filter(function(ne){return typeof ne.insert=="string"}).map(function(ne){return ne.insert}).join("")}},{key:"insertEmbed",value:function(q,Z,ne){return this.scroll.insertAt(q,Z,ne),this.update(new f.default().retain(q).insert(M({},Z,ne)))}},{key:"insertText",value:function(q,Z){var ne=this,se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Z=Z.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(q,Z),Object.keys(se).forEach(function(le){ne.scroll.formatAt(q,Z.length,le,se[le])}),this.update(new f.default().retain(q).insert(Z,(0,P.default)(se)))}},{key:"isBlank",value:function(){if(this.scroll.children.length==0)return!0;if(this.scroll.children.length>1)return!1;var q=this.scroll.children.head;return q.statics.blotName!==C.default.blotName||q.children.length>1?!1:q.children.head instanceof R.default}},{key:"removeFormat",value:function(q,Z){var ne=this.getText(q,Z),se=this.scroll.line(q+Z),le=o(se,2),Q=le[0],ce=le[1],me=0,ge=new f.default;Q!=null&&(Q instanceof x.default?me=Q.newlineIndex(ce)-ce+1:me=Q.length()-ce,ge=Q.delta().slice(ce,ce+me-1).insert(`
`));var Ae=this.getContents(q,Z+me),Ue=Ae.diff(new f.default().insert(ne).concat(ge)),nt=new f.default().retain(q).concat(Ue);return this.applyDelta(nt)}},{key:"update",value:function(q){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],ne=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,se=this.delta;if(Z.length===1&&Z[0].type==="characterData"&&Z[0].target.data.match(G)&&_.default.find(Z[0].target)){var le=_.default.find(Z[0].target),Q=(0,I.bubbleFormats)(le),ce=le.offset(this.scroll),me=Z[0].oldValue.replace(S.default.CONTENTS,""),ge=new f.default().insert(me),Ae=new f.default().insert(le.value()),Ue=new f.default().retain(ce).concat(ge.diff(Ae,ne));q=Ue.reduce(function(nt,et){return et.insert?nt.insert(et.insert,Q):nt.push(et)},new f.default),this.delta=se.compose(q)}else this.delta=this.getDelta(),(!q||!(0,F.default)(se.compose(q),this.delta))&&(q=se.diff(this.delta,ne));return q}}]),J}();function oe(J,Y){return Object.keys(Y).reduce(function(q,Z){return J[Z]==null||(Y[Z]===J[Z]?q[Z]=Y[Z]:Array.isArray(Y[Z])?Y[Z].indexOf(J[Z])<0&&(q[Z]=Y[Z].concat([J[Z]])):q[Z]=[Y[Z],J[Z]]),q},{})}function ee(J){return J.reduce(function(Y,q){if(q.insert===1){var Z=(0,P.default)(q.attributes);return delete Z.image,Y.insert({image:q.attributes.image},Z)}if(q.attributes!=null&&(q.attributes.list===!0||q.attributes.bullet===!0)&&(q=(0,P.default)(q),q.attributes.list?q.attributes.list="ordered":(q.attributes.list="bullet",delete q.attributes.bullet)),typeof q.insert=="string"){var ne=q.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return Y.insert(ne,q.attributes)}return Y.push(q)},new f.default)}n.default=ie},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Range=void 0;var s=function(){function k(F,j){var O=[],D=!0,M=!1,$=void 0;try{for(var G=F[Symbol.iterator](),ie;!(D=(ie=G.next()).done)&&(O.push(ie.value),!(j&&O.length===j));D=!0);}catch(oe){M=!0,$=oe}finally{try{!D&&G.return&&G.return()}finally{if(M)throw $}}return O}return function(F,j){if(Array.isArray(F))return F;if(Symbol.iterator in Object(F))return k(F,j);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function k(F,j){for(var O=0;O<j.length;O++){var D=j[O];D.enumerable=D.enumerable||!1,D.configurable=!0,"value"in D&&(D.writable=!0),Object.defineProperty(F,D.key,D)}}return function(F,j,O){return j&&k(F.prototype,j),O&&k(F,O),F}}(),l=i(0),u=S(l),f=i(21),m=S(f),y=i(11),g=S(y),_=i(8),E=S(_),x=i(10),w=S(x);function S(k){return k&&k.__esModule?k:{default:k}}function I(k){if(Array.isArray(k)){for(var F=0,j=Array(k.length);F<k.length;F++)j[F]=k[F];return j}else return Array.from(k)}function C(k,F){if(!(k instanceof F))throw new TypeError("Cannot call a class as a function")}var N=(0,w.default)("quill:selection"),R=function k(F){var j=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;C(this,k),this.index=F,this.length=j},B=function(){function k(F,j){var O=this;C(this,k),this.emitter=j,this.scroll=F,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=u.default.create("cursor",this),this.lastRange=this.savedRange=new R(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){O.mouseDown||setTimeout(O.update.bind(O,E.default.sources.USER),1)}),this.emitter.on(E.default.events.EDITOR_CHANGE,function(D,M){D===E.default.events.TEXT_CHANGE&&M.length()>0&&O.update(E.default.sources.SILENT)}),this.emitter.on(E.default.events.SCROLL_BEFORE_UPDATE,function(){if(O.hasFocus()){var D=O.getNativeRange();D!=null&&D.start.node!==O.cursor.textNode&&O.emitter.once(E.default.events.SCROLL_UPDATE,function(){try{O.setNativeRange(D.start.node,D.start.offset,D.end.node,D.end.offset)}catch{}})}}),this.emitter.on(E.default.events.SCROLL_OPTIMIZE,function(D,M){if(M.range){var $=M.range,G=$.startNode,ie=$.startOffset,oe=$.endNode,ee=$.endOffset;O.setNativeRange(G,ie,oe,ee)}}),this.update(E.default.sources.SILENT)}return o(k,[{key:"handleComposition",value:function(){var j=this;this.root.addEventListener("compositionstart",function(){j.composing=!0}),this.root.addEventListener("compositionend",function(){if(j.composing=!1,j.cursor.parent){var O=j.cursor.restore();if(!O)return;setTimeout(function(){j.setNativeRange(O.startNode,O.startOffset,O.endNode,O.endOffset)},1)}})}},{key:"handleDragging",value:function(){var j=this;this.emitter.listenDOM("mousedown",document.body,function(){j.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){j.mouseDown=!1,j.update(E.default.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(j,O){if(!(this.scroll.whitelist!=null&&!this.scroll.whitelist[j])){this.scroll.update();var D=this.getNativeRange();if(!(D==null||!D.native.collapsed||u.default.query(j,u.default.Scope.BLOCK))){if(D.start.node!==this.cursor.textNode){var M=u.default.find(D.start.node,!1);if(M==null)return;if(M instanceof u.default.Leaf){var $=M.split(D.start.offset);M.parent.insertBefore(this.cursor,$)}else M.insertBefore(this.cursor,D.start.node);this.cursor.attach()}this.cursor.format(j,O),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(j){var O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,D=this.scroll.length();j=Math.min(j,D-1),O=Math.min(j+O,D-1)-j;var M=void 0,$=this.scroll.leaf(j),G=s($,2),ie=G[0],oe=G[1];if(ie==null)return null;var ee=ie.position(oe,!0),J=s(ee,2);M=J[0],oe=J[1];var Y=document.createRange();if(O>0){Y.setStart(M,oe);var q=this.scroll.leaf(j+O),Z=s(q,2);if(ie=Z[0],oe=Z[1],ie==null)return null;var ne=ie.position(oe,!0),se=s(ne,2);return M=se[0],oe=se[1],Y.setEnd(M,oe),Y.getBoundingClientRect()}else{var le="left",Q=void 0;return M instanceof Text?(oe<M.data.length?(Y.setStart(M,oe),Y.setEnd(M,oe+1)):(Y.setStart(M,oe-1),Y.setEnd(M,oe),le="right"),Q=Y.getBoundingClientRect()):(Q=ie.domNode.getBoundingClientRect(),oe>0&&(le="right")),{bottom:Q.top+Q.height,height:Q.height,left:Q[le],right:Q[le],top:Q.top,width:0}}}},{key:"getNativeRange",value:function(){var j=document.getSelection();if(j==null||j.rangeCount<=0)return null;var O=j.getRangeAt(0);if(O==null)return null;var D=this.normalizeNative(O);return N.info("getNativeRange",D),D}},{key:"getRange",value:function(){var j=this.getNativeRange();if(j==null)return[null,null];var O=this.normalizedToRange(j);return[O,j]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(j){var O=this,D=[[j.start.node,j.start.offset]];j.native.collapsed||D.push([j.end.node,j.end.offset]);var M=D.map(function(ie){var oe=s(ie,2),ee=oe[0],J=oe[1],Y=u.default.find(ee,!0),q=Y.offset(O.scroll);return J===0?q:Y instanceof u.default.Container?q+Y.length():q+Y.index(ee,J)}),$=Math.min(Math.max.apply(Math,I(M)),this.scroll.length()-1),G=Math.min.apply(Math,[$].concat(I(M)));return new R(G,$-G)}},{key:"normalizeNative",value:function(j){if(!P(this.root,j.startContainer)||!j.collapsed&&!P(this.root,j.endContainer))return null;var O={start:{node:j.startContainer,offset:j.startOffset},end:{node:j.endContainer,offset:j.endOffset},native:j};return[O.start,O.end].forEach(function(D){for(var M=D.node,$=D.offset;!(M instanceof Text)&&M.childNodes.length>0;)if(M.childNodes.length>$)M=M.childNodes[$],$=0;else if(M.childNodes.length===$)M=M.lastChild,$=M instanceof Text?M.data.length:M.childNodes.length+1;else break;D.node=M,D.offset=$}),O}},{key:"rangeToNative",value:function(j){var O=this,D=j.collapsed?[j.index]:[j.index,j.index+j.length],M=[],$=this.scroll.length();return D.forEach(function(G,ie){G=Math.min($-1,G);var oe=void 0,ee=O.scroll.leaf(G),J=s(ee,2),Y=J[0],q=J[1],Z=Y.position(q,ie!==0),ne=s(Z,2);oe=ne[0],q=ne[1],M.push(oe,q)}),M.length<2&&(M=M.concat(M)),M}},{key:"scrollIntoView",value:function(j){var O=this.lastRange;if(O!=null){var D=this.getBounds(O.index,O.length);if(D!=null){var M=this.scroll.length()-1,$=this.scroll.line(Math.min(O.index,M)),G=s($,1),ie=G[0],oe=ie;if(O.length>0){var ee=this.scroll.line(Math.min(O.index+O.length,M)),J=s(ee,1);oe=J[0]}if(!(ie==null||oe==null)){var Y=j.getBoundingClientRect();D.top<Y.top?j.scrollTop-=Y.top-D.top:D.bottom>Y.bottom&&(j.scrollTop+=D.bottom-Y.bottom)}}}}},{key:"setNativeRange",value:function(j,O){var D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:j,M=arguments.length>3&&arguments[3]!==void 0?arguments[3]:O,$=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(N.info("setNativeRange",j,O,D,M),!(j!=null&&(this.root.parentNode==null||j.parentNode==null||D.parentNode==null))){var G=document.getSelection();if(G!=null)if(j!=null){this.hasFocus()||this.root.focus();var ie=(this.getNativeRange()||{}).native;if(ie==null||$||j!==ie.startContainer||O!==ie.startOffset||D!==ie.endContainer||M!==ie.endOffset){j.tagName=="BR"&&(O=[].indexOf.call(j.parentNode.childNodes,j),j=j.parentNode),D.tagName=="BR"&&(M=[].indexOf.call(D.parentNode.childNodes,D),D=D.parentNode);var oe=document.createRange();oe.setStart(j,O),oe.setEnd(D,M),G.removeAllRanges(),G.addRange(oe)}}else G.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(j){var O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,D=arguments.length>2&&arguments[2]!==void 0?arguments[2]:E.default.sources.API;if(typeof O=="string"&&(D=O,O=!1),N.info("setRange",j),j!=null){var M=this.rangeToNative(j);this.setNativeRange.apply(this,I(M).concat([O]))}else this.setNativeRange(null);this.update(D)}},{key:"update",value:function(){var j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:E.default.sources.USER,O=this.lastRange,D=this.getRange(),M=s(D,2),$=M[0],G=M[1];if(this.lastRange=$,this.lastRange!=null&&(this.savedRange=this.lastRange),!(0,g.default)(O,this.lastRange)){var ie;!this.composing&&G!=null&&G.native.collapsed&&G.start.node!==this.cursor.textNode&&this.cursor.restore();var oe=[E.default.events.SELECTION_CHANGE,(0,m.default)(this.lastRange),(0,m.default)(O),j];if((ie=this.emitter).emit.apply(ie,[E.default.events.EDITOR_CHANGE].concat(oe)),j!==E.default.sources.SILENT){var ee;(ee=this.emitter).emit.apply(ee,oe)}}}}]),k}();function P(k,F){try{F.parentNode}catch{return!1}return F instanceof Text&&(F=F.parentNode),k.contains(F)}n.Range=R,n.default=B},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function E(x,w){for(var S=0;S<w.length;S++){var I=w[S];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(x,I.key,I)}}return function(x,w,S){return w&&E(x.prototype,w),S&&E(x,S),x}}(),o=function E(x,w,S){x===null&&(x=Function.prototype);var I=Object.getOwnPropertyDescriptor(x,w);if(I===void 0){var C=Object.getPrototypeOf(x);return C===null?void 0:E(C,w,S)}else{if("value"in I)return I.value;var N=I.get;return N===void 0?void 0:N.call(S)}},l=i(0),u=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function y(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var _=function(E){g(x,E);function x(){return m(this,x),y(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return s(x,[{key:"insertInto",value:function(S,I){S.children.length===0?o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"insertInto",this).call(this,S,I):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),x}(u.default.Embed);_.blotName="break",_.tagName="BR",n.default=_},function(t,n,i){var s=this&&this.__extends||function(){var y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,_){g.__proto__=_}||function(g,_){for(var E in _)_.hasOwnProperty(E)&&(g[E]=_[E])};return function(g,_){y(g,_);function E(){this.constructor=g}g.prototype=_===null?Object.create(_):(E.prototype=_.prototype,new E)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(44),l=i(30),u=i(1),f=function(y){s(g,y);function g(_){var E=y.call(this,_)||this;return E.build(),E}return g.prototype.appendChild=function(_){this.insertBefore(_)},g.prototype.attach=function(){y.prototype.attach.call(this),this.children.forEach(function(_){_.attach()})},g.prototype.build=function(){var _=this;this.children=new o.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(E){try{var x=m(E);_.insertBefore(x,_.children.head||void 0)}catch(w){if(w instanceof u.ParchmentError)return;throw w}})},g.prototype.deleteAt=function(_,E){if(_===0&&E===this.length())return this.remove();this.children.forEachAt(_,E,function(x,w,S){x.deleteAt(w,S)})},g.prototype.descendant=function(_,E){var x=this.children.find(E),w=x[0],S=x[1];return _.blotName==null&&_(w)||_.blotName!=null&&w instanceof _?[w,S]:w instanceof g?w.descendant(_,S):[null,-1]},g.prototype.descendants=function(_,E,x){E===void 0&&(E=0),x===void 0&&(x=Number.MAX_VALUE);var w=[],S=x;return this.children.forEachAt(E,x,function(I,C,N){(_.blotName==null&&_(I)||_.blotName!=null&&I instanceof _)&&w.push(I),I instanceof g&&(w=w.concat(I.descendants(_,C,S))),S-=N}),w},g.prototype.detach=function(){this.children.forEach(function(_){_.detach()}),y.prototype.detach.call(this)},g.prototype.formatAt=function(_,E,x,w){this.children.forEachAt(_,E,function(S,I,C){S.formatAt(I,C,x,w)})},g.prototype.insertAt=function(_,E,x){var w=this.children.find(_),S=w[0],I=w[1];if(S)S.insertAt(I,E,x);else{var C=x==null?u.create("text",E):u.create(E,x);this.appendChild(C)}},g.prototype.insertBefore=function(_,E){if(this.statics.allowedChildren!=null&&!this.statics.allowedChildren.some(function(x){return _ instanceof x}))throw new u.ParchmentError("Cannot insert "+_.statics.blotName+" into "+this.statics.blotName);_.insertInto(this,E)},g.prototype.length=function(){return this.children.reduce(function(_,E){return _+E.length()},0)},g.prototype.moveChildren=function(_,E){this.children.forEach(function(x){_.insertBefore(x,E)})},g.prototype.optimize=function(_){if(y.prototype.optimize.call(this,_),this.children.length===0)if(this.statics.defaultChild!=null){var E=u.create(this.statics.defaultChild);this.appendChild(E),E.optimize(_)}else this.remove()},g.prototype.path=function(_,E){E===void 0&&(E=!1);var x=this.children.find(_,E),w=x[0],S=x[1],I=[[this,_]];return w instanceof g?I.concat(w.path(S,E)):(w!=null&&I.push([w,S]),I)},g.prototype.removeChild=function(_){this.children.remove(_)},g.prototype.replace=function(_){_ instanceof g&&_.moveChildren(this),y.prototype.replace.call(this,_)},g.prototype.split=function(_,E){if(E===void 0&&(E=!1),!E){if(_===0)return this;if(_===this.length())return this.next}var x=this.clone();return this.parent.insertBefore(x,this.next),this.children.forEachAt(_,this.length(),function(w,S,I){w=w.split(S,E),x.appendChild(w)}),x},g.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},g.prototype.update=function(_,E){var x=this,w=[],S=[];_.forEach(function(I){I.target===x.domNode&&I.type==="childList"&&(w.push.apply(w,I.addedNodes),S.push.apply(S,I.removedNodes))}),S.forEach(function(I){if(!(I.parentNode!=null&&I.tagName!=="IFRAME"&&document.body.compareDocumentPosition(I)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var C=u.find(I);C!=null&&(C.domNode.parentNode==null||C.domNode.parentNode===x.domNode)&&C.detach()}}),w.filter(function(I){return I.parentNode==x.domNode}).sort(function(I,C){return I===C?0:I.compareDocumentPosition(C)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(I){var C=null;I.nextSibling!=null&&(C=u.find(I.nextSibling));var N=m(I);(N.next!=C||N.next==null)&&(N.parent!=null&&N.parent.removeChild(x),x.insertBefore(N,C||void 0))})},g}(l.default);function m(y){var g=u.find(y);if(g==null)try{g=u.create(y)}catch{g=u.create(u.Scope.INLINE),[].slice.call(y.childNodes).forEach(function(E){g.domNode.appendChild(E)}),y.parentNode&&y.parentNode.replaceChild(g.domNode,y),g.attach()}return g}n.default=f},function(t,n,i){var s=this&&this.__extends||function(){var y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,_){g.__proto__=_}||function(g,_){for(var E in _)_.hasOwnProperty(E)&&(g[E]=_[E])};return function(g,_){y(g,_);function E(){this.constructor=g}g.prototype=_===null?Object.create(_):(E.prototype=_.prototype,new E)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12),l=i(31),u=i(17),f=i(1),m=function(y){s(g,y);function g(_){var E=y.call(this,_)||this;return E.attributes=new l.default(E.domNode),E}return g.formats=function(_){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return _.tagName.toLowerCase()},g.prototype.format=function(_,E){var x=f.query(_);x instanceof o.default?this.attributes.attribute(x,E):E&&x!=null&&(_!==this.statics.blotName||this.formats()[_]!==E)&&this.replaceWith(_,E)},g.prototype.formats=function(){var _=this.attributes.values(),E=this.statics.formats(this.domNode);return E!=null&&(_[this.statics.blotName]=E),_},g.prototype.replaceWith=function(_,E){var x=y.prototype.replaceWith.call(this,_,E);return this.attributes.copy(x),x},g.prototype.update=function(_,E){var x=this;y.prototype.update.call(this,_,E),_.some(function(w){return w.target===x.domNode&&w.type==="attributes"})&&this.attributes.build()},g.prototype.wrap=function(_,E){var x=y.prototype.wrap.call(this,_,E);return x instanceof g&&x.statics.scope===this.statics.scope&&this.attributes.move(x),x},g}(u.default);n.default=m},function(t,n,i){var s=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var g in y)y.hasOwnProperty(g)&&(m[g]=y[g])};return function(m,y){f(m,y);function g(){this.constructor=m}m.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(30),l=i(1),u=function(f){s(m,f);function m(){return f!==null&&f.apply(this,arguments)||this}return m.value=function(y){return!0},m.prototype.index=function(y,g){return this.domNode===y||this.domNode.compareDocumentPosition(y)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(g,1):-1},m.prototype.position=function(y,g){var _=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return y>0&&(_+=1),[this.parent.domNode,_]},m.prototype.value=function(){var y;return y={},y[this.statics.blotName]=this.statics.value(this.domNode)||!0,y},m.scope=l.Scope.INLINE_BLOT,m}(o.default);n.default=u},function(t,n,i){var s=i(11),o=i(3),l={attributes:{compose:function(f,m,y){typeof f!="object"&&(f={}),typeof m!="object"&&(m={});var g=o(!0,{},m);y||(g=Object.keys(g).reduce(function(E,x){return g[x]!=null&&(E[x]=g[x]),E},{}));for(var _ in f)f[_]!==void 0&&m[_]===void 0&&(g[_]=f[_]);return Object.keys(g).length>0?g:void 0},diff:function(f,m){typeof f!="object"&&(f={}),typeof m!="object"&&(m={});var y=Object.keys(f).concat(Object.keys(m)).reduce(function(g,_){return s(f[_],m[_])||(g[_]=m[_]===void 0?null:m[_]),g},{});return Object.keys(y).length>0?y:void 0},transform:function(f,m,y){if(typeof f!="object")return m;if(typeof m=="object"){if(!y)return m;var g=Object.keys(m).reduce(function(_,E){return f[E]===void 0&&(_[E]=m[E]),_},{});return Object.keys(g).length>0?g:void 0}}},iterator:function(f){return new u(f)},length:function(f){return typeof f.delete=="number"?f.delete:typeof f.retain=="number"?f.retain:typeof f.insert=="string"?f.insert.length:1}};function u(f){this.ops=f,this.index=0,this.offset=0}u.prototype.hasNext=function(){return this.peekLength()<1/0},u.prototype.next=function(f){f||(f=1/0);var m=this.ops[this.index];if(m){var y=this.offset,g=l.length(m);if(f>=g-y?(f=g-y,this.index+=1,this.offset=0):this.offset+=f,typeof m.delete=="number")return{delete:f};var _={};return m.attributes&&(_.attributes=m.attributes),typeof m.retain=="number"?_.retain=f:typeof m.insert=="string"?_.insert=m.insert.substr(y,f):_.insert=m.insert,_}else return{retain:1/0}},u.prototype.peek=function(){return this.ops[this.index]},u.prototype.peekLength=function(){return this.ops[this.index]?l.length(this.ops[this.index])-this.offset:1/0},u.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},u.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var f=this.offset,m=this.index,y=this.next(),g=this.ops.slice(this.index);return this.offset=f,this.index=m,[y].concat(g)}else return[]},t.exports=l},function(t,n){var i=function(){function s(x,w){return w!=null&&x instanceof w}var o;try{o=Map}catch{o=function(){}}var l;try{l=Set}catch{l=function(){}}var u;try{u=Promise}catch{u=function(){}}function f(x,w,S,I,C){typeof w=="object"&&(S=w.depth,I=w.prototype,C=w.includeNonEnumerable,w=w.circular);var N=[],R=[],B=typeof Buffer<"u";typeof w>"u"&&(w=!0),typeof S>"u"&&(S=1/0);function P(k,F){if(k===null)return null;if(F===0)return k;var j,O;if(typeof k!="object")return k;if(s(k,o))j=new o;else if(s(k,l))j=new l;else if(s(k,u))j=new u(function(Y,q){k.then(function(Z){Y(P(Z,F-1))},function(Z){q(P(Z,F-1))})});else if(f.__isArray(k))j=[];else if(f.__isRegExp(k))j=new RegExp(k.source,E(k)),k.lastIndex&&(j.lastIndex=k.lastIndex);else if(f.__isDate(k))j=new Date(k.getTime());else{if(B&&Buffer.isBuffer(k))return Buffer.allocUnsafe?j=Buffer.allocUnsafe(k.length):j=new Buffer(k.length),k.copy(j),j;s(k,Error)?j=Object.create(k):typeof I>"u"?(O=Object.getPrototypeOf(k),j=Object.create(O)):(j=Object.create(I),O=I)}if(w){var D=N.indexOf(k);if(D!=-1)return R[D];N.push(k),R.push(j)}s(k,o)&&k.forEach(function(Y,q){var Z=P(q,F-1),ne=P(Y,F-1);j.set(Z,ne)}),s(k,l)&&k.forEach(function(Y){var q=P(Y,F-1);j.add(q)});for(var M in k){var $;O&&($=Object.getOwnPropertyDescriptor(O,M)),!($&&$.set==null)&&(j[M]=P(k[M],F-1))}if(Object.getOwnPropertySymbols)for(var G=Object.getOwnPropertySymbols(k),M=0;M<G.length;M++){var ie=G[M],oe=Object.getOwnPropertyDescriptor(k,ie);oe&&!oe.enumerable&&!C||(j[ie]=P(k[ie],F-1),oe.enumerable||Object.defineProperty(j,ie,{enumerable:!1}))}if(C)for(var ee=Object.getOwnPropertyNames(k),M=0;M<ee.length;M++){var J=ee[M],oe=Object.getOwnPropertyDescriptor(k,J);oe&&oe.enumerable||(j[J]=P(k[J],F-1),Object.defineProperty(j,J,{enumerable:!1}))}return j}return P(x,S)}f.clonePrototype=function(w){if(w===null)return null;var S=function(){};return S.prototype=w,new S};function m(x){return Object.prototype.toString.call(x)}f.__objToStr=m;function y(x){return typeof x=="object"&&m(x)==="[object Date]"}f.__isDate=y;function g(x){return typeof x=="object"&&m(x)==="[object Array]"}f.__isArray=g;function _(x){return typeof x=="object"&&m(x)==="[object RegExp]"}f.__isRegExp=_;function E(x){var w="";return x.global&&(w+="g"),x.ignoreCase&&(w+="i"),x.multiline&&(w+="m"),w}return f.__getRegExpFlags=E,f}();typeof t=="object"&&t.exports&&(t.exports=i)},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function j(O,D){var M=[],$=!0,G=!1,ie=void 0;try{for(var oe=O[Symbol.iterator](),ee;!($=(ee=oe.next()).done)&&(M.push(ee.value),!(D&&M.length===D));$=!0);}catch(J){G=!0,ie=J}finally{try{!$&&oe.return&&oe.return()}finally{if(G)throw ie}}return M}return function(O,D){if(Array.isArray(O))return O;if(Symbol.iterator in Object(O))return j(O,D);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function j(O,D){for(var M=0;M<D.length;M++){var $=D[M];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(O,$.key,$)}}return function(O,D,M){return D&&j(O.prototype,D),M&&j(O,M),O}}(),l=function j(O,D,M){O===null&&(O=Function.prototype);var $=Object.getOwnPropertyDescriptor(O,D);if($===void 0){var G=Object.getPrototypeOf(O);return G===null?void 0:j(G,D,M)}else{if("value"in $)return $.value;var ie=$.get;return ie===void 0?void 0:ie.call(M)}},u=i(0),f=N(u),m=i(8),y=N(m),g=i(4),_=N(g),E=i(16),x=N(E),w=i(13),S=N(w),I=i(25),C=N(I);function N(j){return j&&j.__esModule?j:{default:j}}function R(j,O){if(!(j instanceof O))throw new TypeError("Cannot call a class as a function")}function B(j,O){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return O&&(typeof O=="object"||typeof O=="function")?O:j}function P(j,O){if(typeof O!="function"&&O!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof O);j.prototype=Object.create(O&&O.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),O&&(Object.setPrototypeOf?Object.setPrototypeOf(j,O):j.__proto__=O)}function k(j){return j instanceof _.default||j instanceof g.BlockEmbed}var F=function(j){P(O,j);function O(D,M){R(this,O);var $=B(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,D));return $.emitter=M.emitter,Array.isArray(M.whitelist)&&($.whitelist=M.whitelist.reduce(function(G,ie){return G[ie]=!0,G},{})),$.domNode.addEventListener("DOMNodeInserted",function(){}),$.optimize(),$.enable(),$}return o(O,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(M,$){var G=this.line(M),ie=s(G,2),oe=ie[0],ee=ie[1],J=this.line(M+$),Y=s(J,1),q=Y[0];if(l(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"deleteAt",this).call(this,M,$),q!=null&&oe!==q&&ee>0){if(oe instanceof g.BlockEmbed||q instanceof g.BlockEmbed){this.optimize();return}if(oe instanceof S.default){var Z=oe.newlineIndex(oe.length(),!0);if(Z>-1&&(oe=oe.split(Z+1),oe===q)){this.optimize();return}}else if(q instanceof S.default){var ne=q.newlineIndex(0);ne>-1&&q.split(ne+1)}var se=q.children.head instanceof x.default?null:q.children.head;oe.moveChildren(q,se),oe.remove()}this.optimize()}},{key:"enable",value:function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",M)}},{key:"formatAt",value:function(M,$,G,ie){this.whitelist!=null&&!this.whitelist[G]||(l(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"formatAt",this).call(this,M,$,G,ie),this.optimize())}},{key:"insertAt",value:function(M,$,G){if(!(G!=null&&this.whitelist!=null&&!this.whitelist[$])){if(M>=this.length())if(G==null||f.default.query($,f.default.Scope.BLOCK)==null){var ie=f.default.create(this.statics.defaultChild);this.appendChild(ie),G==null&&$.endsWith(`
`)&&($=$.slice(0,-1)),ie.insertAt(0,$,G)}else{var oe=f.default.create($,G);this.appendChild(oe)}else l(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"insertAt",this).call(this,M,$,G);this.optimize()}}},{key:"insertBefore",value:function(M,$){if(M.statics.scope===f.default.Scope.INLINE_BLOT){var G=f.default.create(this.statics.defaultChild);G.appendChild(M),M=G}l(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"insertBefore",this).call(this,M,$)}},{key:"leaf",value:function(M){return this.path(M).pop()||[null,-1]}},{key:"line",value:function(M){return M===this.length()?this.line(M-1):this.descendant(k,M)}},{key:"lines",value:function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,G=function ie(oe,ee,J){var Y=[],q=J;return oe.children.forEachAt(ee,J,function(Z,ne,se){k(Z)?Y.push(Z):Z instanceof f.default.Container&&(Y=Y.concat(ie(Z,ne,q))),q-=se}),Y};return G(this,M,$)}},{key:"optimize",value:function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch!==!0&&(l(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"optimize",this).call(this,M,$),M.length>0&&this.emitter.emit(y.default.events.SCROLL_OPTIMIZE,M,$))}},{key:"path",value:function(M){return l(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"path",this).call(this,M).slice(1)}},{key:"update",value:function(M){if(this.batch!==!0){var $=y.default.sources.USER;typeof M=="string"&&($=M),Array.isArray(M)||(M=this.observer.takeRecords()),M.length>0&&this.emitter.emit(y.default.events.SCROLL_BEFORE_UPDATE,$,M),l(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"update",this).call(this,M.concat([])),M.length>0&&this.emitter.emit(y.default.events.SCROLL_UPDATE,$,M)}}}]),O}(f.default.Scroll);F.blotName="scroll",F.className="ql-editor",F.tagName="DIV",F.defaultChild="block",F.allowedChildren=[_.default,g.BlockEmbed,C.default],n.default=F},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SHORTKEY=n.default=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Q){return typeof Q}:function(Q){return Q&&typeof Symbol=="function"&&Q.constructor===Symbol&&Q!==Symbol.prototype?"symbol":typeof Q},o=function(){function Q(ce,me){var ge=[],Ae=!0,Ue=!1,nt=void 0;try{for(var et=ce[Symbol.iterator](),pt;!(Ae=(pt=et.next()).done)&&(ge.push(pt.value),!(me&&ge.length===me));Ae=!0);}catch(Et){Ue=!0,nt=Et}finally{try{!Ae&&et.return&&et.return()}finally{if(Ue)throw nt}}return ge}return function(ce,me){if(Array.isArray(ce))return ce;if(Symbol.iterator in Object(ce))return Q(ce,me);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function Q(ce,me){for(var ge=0;ge<me.length;ge++){var Ae=me[ge];Ae.enumerable=Ae.enumerable||!1,Ae.configurable=!0,"value"in Ae&&(Ae.writable=!0),Object.defineProperty(ce,Ae.key,Ae)}}return function(ce,me,ge){return me&&Q(ce.prototype,me),ge&&Q(ce,ge),ce}}(),u=i(21),f=j(u),m=i(11),y=j(m),g=i(3),_=j(g),E=i(2),x=j(E),w=i(20),S=j(w),I=i(0),C=j(I),N=i(5),R=j(N),B=i(10),P=j(B),k=i(9),F=j(k);function j(Q){return Q&&Q.__esModule?Q:{default:Q}}function O(Q,ce,me){return ce in Q?Object.defineProperty(Q,ce,{value:me,enumerable:!0,configurable:!0,writable:!0}):Q[ce]=me,Q}function D(Q,ce){if(!(Q instanceof ce))throw new TypeError("Cannot call a class as a function")}function M(Q,ce){if(!Q)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ce&&(typeof ce=="object"||typeof ce=="function")?ce:Q}function $(Q,ce){if(typeof ce!="function"&&ce!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ce);Q.prototype=Object.create(ce&&ce.prototype,{constructor:{value:Q,enumerable:!1,writable:!0,configurable:!0}}),ce&&(Object.setPrototypeOf?Object.setPrototypeOf(Q,ce):Q.__proto__=ce)}var G=(0,P.default)("quill:keyboard"),ie=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",oe=function(Q){$(ce,Q),l(ce,null,[{key:"match",value:function(ge,Ae){return Ae=le(Ae),["altKey","ctrlKey","metaKey","shiftKey"].some(function(Ue){return!!Ae[Ue]!==ge[Ue]&&Ae[Ue]!==null})?!1:Ae.key===(ge.which||ge.keyCode)}}]);function ce(me,ge){D(this,ce);var Ae=M(this,(ce.__proto__||Object.getPrototypeOf(ce)).call(this,me,ge));return Ae.bindings={},Object.keys(Ae.options.bindings).forEach(function(Ue){Ue==="list autofill"&&me.scroll.whitelist!=null&&!me.scroll.whitelist.list||Ae.options.bindings[Ue]&&Ae.addBinding(Ae.options.bindings[Ue])}),Ae.addBinding({key:ce.keys.ENTER,shiftKey:null},Z),Ae.addBinding({key:ce.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},function(){}),/Firefox/i.test(navigator.userAgent)?(Ae.addBinding({key:ce.keys.BACKSPACE},{collapsed:!0},J),Ae.addBinding({key:ce.keys.DELETE},{collapsed:!0},Y)):(Ae.addBinding({key:ce.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},J),Ae.addBinding({key:ce.keys.DELETE},{collapsed:!0,suffix:/^.?$/},Y)),Ae.addBinding({key:ce.keys.BACKSPACE},{collapsed:!1},q),Ae.addBinding({key:ce.keys.DELETE},{collapsed:!1},q),Ae.addBinding({key:ce.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},J),Ae.listen(),Ae}return l(ce,[{key:"addBinding",value:function(ge){var Ae=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Ue=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},nt=le(ge);if(nt==null||nt.key==null)return G.warn("Attempted to add invalid keyboard binding",nt);typeof Ae=="function"&&(Ae={handler:Ae}),typeof Ue=="function"&&(Ue={handler:Ue}),nt=(0,_.default)(nt,Ae,Ue),this.bindings[nt.key]=this.bindings[nt.key]||[],this.bindings[nt.key].push(nt)}},{key:"listen",value:function(){var ge=this;this.quill.root.addEventListener("keydown",function(Ae){if(!Ae.defaultPrevented){var Ue=Ae.which||Ae.keyCode,nt=(ge.bindings[Ue]||[]).filter(function(qt){return ce.match(Ae,qt)});if(nt.length!==0){var et=ge.quill.getSelection();if(!(et==null||!ge.quill.hasFocus())){var pt=ge.quill.getLine(et.index),Et=o(pt,2),_n=Et[0],Wt=Et[1],Se=ge.quill.getLeaf(et.index),Ie=o(Se,2),De=Ie[0],Ve=Ie[1],ke=et.length===0?[De,Ve]:ge.quill.getLeaf(et.index+et.length),gt=o(ke,2),ft=gt[0],mt=gt[1],kt=De instanceof C.default.Text?De.value().slice(0,Ve):"",jt=ft instanceof C.default.Text?ft.value().slice(mt):"",Mt={collapsed:et.length===0,empty:et.length===0&&_n.length()<=1,format:ge.quill.getFormat(et),offset:Wt,prefix:kt,suffix:jt},os=nt.some(function(qt){if(qt.collapsed!=null&&qt.collapsed!==Mt.collapsed||qt.empty!=null&&qt.empty!==Mt.empty||qt.offset!=null&&qt.offset!==Mt.offset)return!1;if(Array.isArray(qt.format)){if(qt.format.every(function(jn){return Mt.format[jn]==null}))return!1}else if(s(qt.format)==="object"&&!Object.keys(qt.format).every(function(jn){return qt.format[jn]===!0?Mt.format[jn]!=null:qt.format[jn]===!1?Mt.format[jn]==null:(0,y.default)(qt.format[jn],Mt.format[jn])}))return!1;return qt.prefix!=null&&!qt.prefix.test(Mt.prefix)||qt.suffix!=null&&!qt.suffix.test(Mt.suffix)?!1:qt.handler.call(ge,et,Mt)!==!0});os&&Ae.preventDefault()}}}})}}]),ce}(F.default);oe.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},oe.DEFAULTS={bindings:{bold:se("bold"),italic:se("italic"),underline:se("underline"),indent:{key:oe.keys.TAB,format:["blockquote","indent","list"],handler:function(ce,me){if(me.collapsed&&me.offset!==0)return!0;this.quill.format("indent","+1",R.default.sources.USER)}},outdent:{key:oe.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(ce,me){if(me.collapsed&&me.offset!==0)return!0;this.quill.format("indent","-1",R.default.sources.USER)}},"outdent backspace":{key:oe.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(ce,me){me.format.indent!=null?this.quill.format("indent","-1",R.default.sources.USER):me.format.list!=null&&this.quill.format("list",!1,R.default.sources.USER)}},"indent code-block":ne(!0),"outdent code-block":ne(!1),"remove tab":{key:oe.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(ce){this.quill.deleteText(ce.index-1,1,R.default.sources.USER)}},tab:{key:oe.keys.TAB,handler:function(ce){this.quill.history.cutoff();var me=new x.default().retain(ce.index).delete(ce.length).insert("	");this.quill.updateContents(me,R.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(ce.index+1,R.default.sources.SILENT)}},"list empty enter":{key:oe.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(ce,me){this.quill.format("list",!1,R.default.sources.USER),me.format.indent&&this.quill.format("indent",!1,R.default.sources.USER)}},"checklist enter":{key:oe.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(ce){var me=this.quill.getLine(ce.index),ge=o(me,2),Ae=ge[0],Ue=ge[1],nt=(0,_.default)({},Ae.formats(),{list:"checked"}),et=new x.default().retain(ce.index).insert(`
`,nt).retain(Ae.length()-Ue-1).retain(1,{list:"unchecked"});this.quill.updateContents(et,R.default.sources.USER),this.quill.setSelection(ce.index+1,R.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:oe.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(ce,me){var ge=this.quill.getLine(ce.index),Ae=o(ge,2),Ue=Ae[0],nt=Ae[1],et=new x.default().retain(ce.index).insert(`
`,me.format).retain(Ue.length()-nt-1).retain(1,{header:null});this.quill.updateContents(et,R.default.sources.USER),this.quill.setSelection(ce.index+1,R.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(ce,me){var ge=me.prefix.length,Ae=this.quill.getLine(ce.index),Ue=o(Ae,2),nt=Ue[0],et=Ue[1];if(et>ge)return!0;var pt=void 0;switch(me.prefix.trim()){case"[]":case"[ ]":pt="unchecked";break;case"[x]":pt="checked";break;case"-":case"*":pt="bullet";break;default:pt="ordered"}this.quill.insertText(ce.index," ",R.default.sources.USER),this.quill.history.cutoff();var Et=new x.default().retain(ce.index-et).delete(ge+1).retain(nt.length()-2-et).retain(1,{list:pt});this.quill.updateContents(Et,R.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(ce.index-ge,R.default.sources.SILENT)}},"code exit":{key:oe.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(ce){var me=this.quill.getLine(ce.index),ge=o(me,2),Ae=ge[0],Ue=ge[1],nt=new x.default().retain(ce.index+Ae.length()-Ue-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(nt,R.default.sources.USER)}},"embed left":ee(oe.keys.LEFT,!1),"embed left shift":ee(oe.keys.LEFT,!0),"embed right":ee(oe.keys.RIGHT,!1),"embed right shift":ee(oe.keys.RIGHT,!0)}};function ee(Q,ce){var me,ge=Q===oe.keys.LEFT?"prefix":"suffix";return me={key:Q,shiftKey:ce,altKey:null},O(me,ge,/^$/),O(me,"handler",function(Ue){var nt=Ue.index;Q===oe.keys.RIGHT&&(nt+=Ue.length+1);var et=this.quill.getLeaf(nt),pt=o(et,1),Et=pt[0];return Et instanceof C.default.Embed?(Q===oe.keys.LEFT?ce?this.quill.setSelection(Ue.index-1,Ue.length+1,R.default.sources.USER):this.quill.setSelection(Ue.index-1,R.default.sources.USER):ce?this.quill.setSelection(Ue.index,Ue.length+1,R.default.sources.USER):this.quill.setSelection(Ue.index+Ue.length+1,R.default.sources.USER),!1):!0}),me}function J(Q,ce){if(!(Q.index===0||this.quill.getLength()<=1)){var me=this.quill.getLine(Q.index),ge=o(me,1),Ae=ge[0],Ue={};if(ce.offset===0){var nt=this.quill.getLine(Q.index-1),et=o(nt,1),pt=et[0];if(pt!=null&&pt.length()>1){var Et=Ae.formats(),_n=this.quill.getFormat(Q.index-1,1);Ue=S.default.attributes.diff(Et,_n)||{}}}var Wt=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(ce.prefix)?2:1;this.quill.deleteText(Q.index-Wt,Wt,R.default.sources.USER),Object.keys(Ue).length>0&&this.quill.formatLine(Q.index-Wt,Wt,Ue,R.default.sources.USER),this.quill.focus()}}function Y(Q,ce){var me=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(ce.suffix)?2:1;if(!(Q.index>=this.quill.getLength()-me)){var ge={},Ae=0,Ue=this.quill.getLine(Q.index),nt=o(Ue,1),et=nt[0];if(ce.offset>=et.length()-1){var pt=this.quill.getLine(Q.index+1),Et=o(pt,1),_n=Et[0];if(_n){var Wt=et.formats(),Se=this.quill.getFormat(Q.index,1);ge=S.default.attributes.diff(Wt,Se)||{},Ae=_n.length()}}this.quill.deleteText(Q.index,me,R.default.sources.USER),Object.keys(ge).length>0&&this.quill.formatLine(Q.index+Ae-1,me,ge,R.default.sources.USER)}}function q(Q){var ce=this.quill.getLines(Q),me={};if(ce.length>1){var ge=ce[0].formats(),Ae=ce[ce.length-1].formats();me=S.default.attributes.diff(Ae,ge)||{}}this.quill.deleteText(Q,R.default.sources.USER),Object.keys(me).length>0&&this.quill.formatLine(Q.index,1,me,R.default.sources.USER),this.quill.setSelection(Q.index,R.default.sources.SILENT),this.quill.focus()}function Z(Q,ce){var me=this;Q.length>0&&this.quill.scroll.deleteAt(Q.index,Q.length);var ge=Object.keys(ce.format).reduce(function(Ae,Ue){return C.default.query(Ue,C.default.Scope.BLOCK)&&!Array.isArray(ce.format[Ue])&&(Ae[Ue]=ce.format[Ue]),Ae},{});this.quill.insertText(Q.index,`
`,ge,R.default.sources.USER),this.quill.setSelection(Q.index+1,R.default.sources.SILENT),this.quill.focus(),Object.keys(ce.format).forEach(function(Ae){ge[Ae]==null&&(Array.isArray(ce.format[Ae])||Ae!=="link"&&me.quill.format(Ae,ce.format[Ae],R.default.sources.USER))})}function ne(Q){return{key:oe.keys.TAB,shiftKey:!Q,format:{"code-block":!0},handler:function(me){var ge=C.default.query("code-block"),Ae=me.index,Ue=me.length,nt=this.quill.scroll.descendant(ge,Ae),et=o(nt,2),pt=et[0],Et=et[1];if(pt!=null){var _n=this.quill.getIndex(pt),Wt=pt.newlineIndex(Et,!0)+1,Se=pt.newlineIndex(_n+Et+Ue),Ie=pt.domNode.textContent.slice(Wt,Se).split(`
`);Et=0,Ie.forEach(function(De,Ve){Q?(pt.insertAt(Wt+Et,ge.TAB),Et+=ge.TAB.length,Ve===0?Ae+=ge.TAB.length:Ue+=ge.TAB.length):De.startsWith(ge.TAB)&&(pt.deleteAt(Wt+Et,ge.TAB.length),Et-=ge.TAB.length,Ve===0?Ae-=ge.TAB.length:Ue-=ge.TAB.length),Et+=De.length+1}),this.quill.update(R.default.sources.USER),this.quill.setSelection(Ae,Ue,R.default.sources.SILENT)}}}}function se(Q){return{key:Q[0].toUpperCase(),shortKey:!0,handler:function(me,ge){this.quill.format(Q,!ge.format[Q],R.default.sources.USER)}}}function le(Q){if(typeof Q=="string"||typeof Q=="number")return le({key:Q});if((typeof Q>"u"?"undefined":s(Q))==="object"&&(Q=(0,f.default)(Q,!1)),typeof Q.key=="string")if(oe.keys[Q.key.toUpperCase()]!=null)Q.key=oe.keys[Q.key.toUpperCase()];else if(Q.key.length===1)Q.key=Q.key.toUpperCase().charCodeAt(0);else return null;return Q.shortKey&&(Q[ie]=Q.shortKey,delete Q.shortKey),Q}n.default=oe,n.SHORTKEY=ie},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function S(I,C){var N=[],R=!0,B=!1,P=void 0;try{for(var k=I[Symbol.iterator](),F;!(R=(F=k.next()).done)&&(N.push(F.value),!(C&&N.length===C));R=!0);}catch(j){B=!0,P=j}finally{try{!R&&k.return&&k.return()}finally{if(B)throw P}}return N}return function(I,C){if(Array.isArray(I))return I;if(Symbol.iterator in Object(I))return S(I,C);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function S(I,C,N){I===null&&(I=Function.prototype);var R=Object.getOwnPropertyDescriptor(I,C);if(R===void 0){var B=Object.getPrototypeOf(I);return B===null?void 0:S(B,C,N)}else{if("value"in R)return R.value;var P=R.get;return P===void 0?void 0:P.call(N)}},l=function(){function S(I,C){for(var N=0;N<C.length;N++){var R=C[N];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(I,R.key,R)}}return function(I,C,N){return C&&S(I.prototype,C),N&&S(I,N),I}}(),u=i(0),f=g(u),m=i(7),y=g(m);function g(S){return S&&S.__esModule?S:{default:S}}function _(S,I){if(!(S instanceof I))throw new TypeError("Cannot call a class as a function")}function E(S,I){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I&&(typeof I=="object"||typeof I=="function")?I:S}function x(S,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof I);S.prototype=Object.create(I&&I.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),I&&(Object.setPrototypeOf?Object.setPrototypeOf(S,I):S.__proto__=I)}var w=function(S){x(I,S),l(I,null,[{key:"value",value:function(){}}]);function I(C,N){_(this,I);var R=E(this,(I.__proto__||Object.getPrototypeOf(I)).call(this,C));return R.selection=N,R.textNode=document.createTextNode(I.CONTENTS),R.domNode.appendChild(R.textNode),R._length=0,R}return l(I,[{key:"detach",value:function(){this.parent!=null&&this.parent.removeChild(this)}},{key:"format",value:function(N,R){if(this._length!==0)return o(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"format",this).call(this,N,R);for(var B=this,P=0;B!=null&&B.statics.scope!==f.default.Scope.BLOCK_BLOT;)P+=B.offset(B.parent),B=B.parent;B!=null&&(this._length=I.CONTENTS.length,B.optimize(),B.formatAt(P,I.CONTENTS.length,N,R),this._length=0)}},{key:"index",value:function(N,R){return N===this.textNode?0:o(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"index",this).call(this,N,R)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){o(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!(this.selection.composing||this.parent==null)){var N=this.textNode,R=this.selection.getNativeRange(),B=void 0,P=void 0,k=void 0;if(R!=null&&R.start.node===N&&R.end.node===N){var F=[N,R.start.offset,R.end.offset];B=F[0],P=F[1],k=F[2]}for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==I.CONTENTS){var j=this.textNode.data.split(I.CONTENTS).join("");this.next instanceof y.default?(B=this.next.domNode,this.next.insertAt(0,j),this.textNode.data=I.CONTENTS):(this.textNode.data=j,this.parent.insertBefore(f.default.create(this.textNode),this),this.textNode=document.createTextNode(I.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),P!=null){var O=[P,k].map(function(M){return Math.max(0,Math.min(B.data.length,M-1))}),D=s(O,2);return P=D[0],k=D[1],{startNode:B,startOffset:P,endNode:B,endOffset:k}}}}},{key:"update",value:function(N,R){var B=this;if(N.some(function(k){return k.type==="characterData"&&k.target===B.textNode})){var P=this.restore();P&&(R.range=P)}}},{key:"value",value:function(){return""}}]),I}(f.default.Embed);w.blotName="cursor",w.className="ql-cursor",w.tagName="span",w.CONTENTS="\uFEFF",n.default=w},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(0),o=f(s),l=i(4),u=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function y(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var _=function(E){g(x,E);function x(){return m(this,x),y(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return x}(o.default.Container);_.allowedChildren=[u.default,l.BlockEmbed,_],n.default=_},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ColorStyle=n.ColorClass=n.ColorAttributor=void 0;var s=function(){function w(S,I){for(var C=0;C<I.length;C++){var N=I[C];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(S,N.key,N)}}return function(S,I,C){return I&&w(S.prototype,I),C&&w(S,C),S}}(),o=function w(S,I,C){S===null&&(S=Function.prototype);var N=Object.getOwnPropertyDescriptor(S,I);if(N===void 0){var R=Object.getPrototypeOf(S);return R===null?void 0:w(R,I,C)}else{if("value"in N)return N.value;var B=N.get;return B===void 0?void 0:B.call(C)}},l=i(0),u=f(l);function f(w){return w&&w.__esModule?w:{default:w}}function m(w,S){if(!(w instanceof S))throw new TypeError("Cannot call a class as a function")}function y(w,S){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:w}function g(w,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);w.prototype=Object.create(S&&S.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(w,S):w.__proto__=S)}var _=function(w){g(S,w);function S(){return m(this,S),y(this,(S.__proto__||Object.getPrototypeOf(S)).apply(this,arguments))}return s(S,[{key:"value",value:function(C){var N=o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"value",this).call(this,C);return N.startsWith("rgb(")?(N=N.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+N.split(",").map(function(R){return("00"+parseInt(R).toString(16)).slice(-2)}).join("")):N}}]),S}(u.default.Attributor.Style),E=new u.default.Attributor.Class("color","ql-color",{scope:u.default.Scope.INLINE}),x=new _("color","color",{scope:u.default.Scope.INLINE});n.ColorAttributor=_,n.ColorClass=E,n.ColorStyle=x},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.sanitize=n.default=void 0;var s=function(){function x(w,S){for(var I=0;I<S.length;I++){var C=S[I];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(w,C.key,C)}}return function(w,S,I){return S&&x(w.prototype,S),I&&x(w,I),w}}(),o=function x(w,S,I){w===null&&(w=Function.prototype);var C=Object.getOwnPropertyDescriptor(w,S);if(C===void 0){var N=Object.getPrototypeOf(w);return N===null?void 0:x(N,S,I)}else{if("value"in C)return C.value;var R=C.get;return R===void 0?void 0:R.call(I)}},l=i(6),u=f(l);function f(x){return x&&x.__esModule?x:{default:x}}function m(x,w){if(!(x instanceof w))throw new TypeError("Cannot call a class as a function")}function y(x,w){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:x}function g(x,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);x.prototype=Object.create(w&&w.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(x,w):x.__proto__=w)}var _=function(x){g(w,x);function w(){return m(this,w),y(this,(w.__proto__||Object.getPrototypeOf(w)).apply(this,arguments))}return s(w,[{key:"format",value:function(I,C){if(I!==this.statics.blotName||!C)return o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"format",this).call(this,I,C);C=this.constructor.sanitize(C),this.domNode.setAttribute("href",C)}}],[{key:"create",value:function(I){var C=o(w.__proto__||Object.getPrototypeOf(w),"create",this).call(this,I);return I=this.sanitize(I),C.setAttribute("href",I),C.setAttribute("rel","noopener noreferrer"),C.setAttribute("target","_blank"),C}},{key:"formats",value:function(I){return I.getAttribute("href")}},{key:"sanitize",value:function(I){return E(I,this.PROTOCOL_WHITELIST)?I:this.SANITIZED_URL}}]),w}(u.default);_.blotName="link",_.tagName="A",_.SANITIZED_URL="about:blank",_.PROTOCOL_WHITELIST=["http","https","mailto","tel"];function E(x,w){var S=document.createElement("a");S.href=x;var I=S.href.slice(0,S.href.indexOf(":"));return w.indexOf(I)>-1}n.default=_,n.sanitize=E},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w},o=function(){function w(S,I){for(var C=0;C<I.length;C++){var N=I[C];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(S,N.key,N)}}return function(S,I,C){return I&&w(S.prototype,I),C&&w(S,C),S}}(),l=i(23),u=y(l),f=i(107),m=y(f);function y(w){return w&&w.__esModule?w:{default:w}}function g(w,S){if(!(w instanceof S))throw new TypeError("Cannot call a class as a function")}var _=0;function E(w,S){w.setAttribute(S,w.getAttribute(S)!=="true")}var x=function(){function w(S){var I=this;g(this,w),this.select=S,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",function(){I.togglePicker()}),this.label.addEventListener("keydown",function(C){switch(C.keyCode){case u.default.keys.ENTER:I.togglePicker();break;case u.default.keys.ESCAPE:I.escape(),C.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}return o(w,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),E(this.label,"aria-expanded"),E(this.options,"aria-hidden")}},{key:"buildItem",value:function(I){var C=this,N=document.createElement("span");return N.tabIndex="0",N.setAttribute("role","button"),N.classList.add("ql-picker-item"),I.hasAttribute("value")&&N.setAttribute("data-value",I.getAttribute("value")),I.textContent&&N.setAttribute("data-label",I.textContent),N.addEventListener("click",function(){C.selectItem(N,!0)}),N.addEventListener("keydown",function(R){switch(R.keyCode){case u.default.keys.ENTER:C.selectItem(N,!0),R.preventDefault();break;case u.default.keys.ESCAPE:C.escape(),R.preventDefault();break}}),N}},{key:"buildLabel",value:function(){var I=document.createElement("span");return I.classList.add("ql-picker-label"),I.innerHTML=m.default,I.tabIndex="0",I.setAttribute("role","button"),I.setAttribute("aria-expanded","false"),this.container.appendChild(I),I}},{key:"buildOptions",value:function(){var I=this,C=document.createElement("span");C.classList.add("ql-picker-options"),C.setAttribute("aria-hidden","true"),C.tabIndex="-1",C.id="ql-picker-options-"+_,_+=1,this.label.setAttribute("aria-controls",C.id),this.options=C,[].slice.call(this.select.options).forEach(function(N){var R=I.buildItem(N);C.appendChild(R),N.selected===!0&&I.selectItem(R)}),this.container.appendChild(C)}},{key:"buildPicker",value:function(){var I=this;[].slice.call(this.select.attributes).forEach(function(C){I.container.setAttribute(C.name,C.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var I=this;this.close(),setTimeout(function(){return I.label.focus()},1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(I){var C=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,N=this.container.querySelector(".ql-selected");if(I!==N&&(N!=null&&N.classList.remove("ql-selected"),I!=null&&(I.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(I.parentNode.children,I),I.hasAttribute("data-value")?this.label.setAttribute("data-value",I.getAttribute("data-value")):this.label.removeAttribute("data-value"),I.hasAttribute("data-label")?this.label.setAttribute("data-label",I.getAttribute("data-label")):this.label.removeAttribute("data-label"),C))){if(typeof Event=="function")this.select.dispatchEvent(new Event("change"));else if((typeof Event>"u"?"undefined":s(Event))==="object"){var R=document.createEvent("Event");R.initEvent("change",!0,!0),this.select.dispatchEvent(R)}this.close()}}},{key:"update",value:function(){var I=void 0;if(this.select.selectedIndex>-1){var C=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];I=this.select.options[this.select.selectedIndex],this.selectItem(C)}else this.selectItem(null);var N=I!=null&&I!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",N)}}]),w}();n.default=x},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(0),o=G(s),l=i(5),u=G(l),f=i(4),m=G(f),y=i(16),g=G(y),_=i(25),E=G(_),x=i(24),w=G(x),S=i(35),I=G(S),C=i(6),N=G(C),R=i(22),B=G(R),P=i(7),k=G(P),F=i(55),j=G(F),O=i(42),D=G(O),M=i(23),$=G(M);function G(ie){return ie&&ie.__esModule?ie:{default:ie}}u.default.register({"blots/block":m.default,"blots/block/embed":f.BlockEmbed,"blots/break":g.default,"blots/container":E.default,"blots/cursor":w.default,"blots/embed":I.default,"blots/inline":N.default,"blots/scroll":B.default,"blots/text":k.default,"modules/clipboard":j.default,"modules/history":D.default,"modules/keyboard":$.default}),o.default.register(m.default,g.default,w.default,N.default,B.default,k.default),n.default=u.default},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(1),o=function(){function l(u){this.domNode=u,this.domNode[s.DATA_KEY]={blot:this}}return Object.defineProperty(l.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),l.create=function(u){if(this.tagName==null)throw new s.ParchmentError("Blot definition missing tagName");var f;return Array.isArray(this.tagName)?(typeof u=="string"&&(u=u.toUpperCase(),parseInt(u).toString()===u&&(u=parseInt(u))),typeof u=="number"?f=document.createElement(this.tagName[u-1]):this.tagName.indexOf(u)>-1?f=document.createElement(u):f=document.createElement(this.tagName[0])):f=document.createElement(this.tagName),this.className&&f.classList.add(this.className),f},l.prototype.attach=function(){this.parent!=null&&(this.scroll=this.parent.scroll)},l.prototype.clone=function(){var u=this.domNode.cloneNode(!1);return s.create(u)},l.prototype.detach=function(){this.parent!=null&&this.parent.removeChild(this),delete this.domNode[s.DATA_KEY]},l.prototype.deleteAt=function(u,f){var m=this.isolate(u,f);m.remove()},l.prototype.formatAt=function(u,f,m,y){var g=this.isolate(u,f);if(s.query(m,s.Scope.BLOT)!=null&&y)g.wrap(m,y);else if(s.query(m,s.Scope.ATTRIBUTE)!=null){var _=s.create(this.statics.scope);g.wrap(_),_.format(m,y)}},l.prototype.insertAt=function(u,f,m){var y=m==null?s.create("text",f):s.create(f,m),g=this.split(u);this.parent.insertBefore(y,g)},l.prototype.insertInto=function(u,f){f===void 0&&(f=null),this.parent!=null&&this.parent.children.remove(this);var m=null;u.children.insertBefore(this,f),f!=null&&(m=f.domNode),(this.domNode.parentNode!=u.domNode||this.domNode.nextSibling!=m)&&u.domNode.insertBefore(this.domNode,m),this.parent=u,this.attach()},l.prototype.isolate=function(u,f){var m=this.split(u);return m.split(f),m},l.prototype.length=function(){return 1},l.prototype.offset=function(u){return u===void 0&&(u=this.parent),this.parent==null||this==u?0:this.parent.children.offset(this)+this.parent.offset(u)},l.prototype.optimize=function(u){this.domNode[s.DATA_KEY]!=null&&delete this.domNode[s.DATA_KEY].mutations},l.prototype.remove=function(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},l.prototype.replace=function(u){u.parent!=null&&(u.parent.insertBefore(this,u.next),u.remove())},l.prototype.replaceWith=function(u,f){var m=typeof u=="string"?s.create(u,f):u;return m.replace(this),m},l.prototype.split=function(u,f){return u===0?this:this.next},l.prototype.update=function(u,f){},l.prototype.wrap=function(u,f){var m=typeof u=="string"?s.create(u,f):u;return this.parent!=null&&this.parent.insertBefore(m,this.next),m.appendChild(this),m},l.blotName="abstract",l}();n.default=o},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(12),o=i(32),l=i(33),u=i(1),f=function(){function m(y){this.attributes={},this.domNode=y,this.build()}return m.prototype.attribute=function(y,g){g?y.add(this.domNode,g)&&(y.value(this.domNode)!=null?this.attributes[y.attrName]=y:delete this.attributes[y.attrName]):(y.remove(this.domNode),delete this.attributes[y.attrName])},m.prototype.build=function(){var y=this;this.attributes={};var g=s.default.keys(this.domNode),_=o.default.keys(this.domNode),E=l.default.keys(this.domNode);g.concat(_).concat(E).forEach(function(x){var w=u.query(x,u.Scope.ATTRIBUTE);w instanceof s.default&&(y.attributes[w.attrName]=w)})},m.prototype.copy=function(y){var g=this;Object.keys(this.attributes).forEach(function(_){var E=g.attributes[_].value(g.domNode);y.format(_,E)})},m.prototype.move=function(y){var g=this;this.copy(y),Object.keys(this.attributes).forEach(function(_){g.attributes[_].remove(g.domNode)}),this.attributes={}},m.prototype.values=function(){var y=this;return Object.keys(this.attributes).reduce(function(g,_){return g[_]=y.attributes[_].value(y.domNode),g},{})},m}();n.default=f},function(t,n,i){var s=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var g in y)y.hasOwnProperty(g)&&(m[g]=y[g])};return function(m,y){f(m,y);function g(){this.constructor=m}m.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12);function l(f,m){var y=f.getAttribute("class")||"";return y.split(/\s+/).filter(function(g){return g.indexOf(m+"-")===0})}var u=function(f){s(m,f);function m(){return f!==null&&f.apply(this,arguments)||this}return m.keys=function(y){return(y.getAttribute("class")||"").split(/\s+/).map(function(g){return g.split("-").slice(0,-1).join("-")})},m.prototype.add=function(y,g){return this.canAdd(y,g)?(this.remove(y),y.classList.add(this.keyName+"-"+g),!0):!1},m.prototype.remove=function(y){var g=l(y,this.keyName);g.forEach(function(_){y.classList.remove(_)}),y.classList.length===0&&y.removeAttribute("class")},m.prototype.value=function(y){var g=l(y,this.keyName)[0]||"",_=g.slice(this.keyName.length+1);return this.canAdd(y,_)?_:""},m}(o.default);n.default=u},function(t,n,i){var s=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var g in y)y.hasOwnProperty(g)&&(m[g]=y[g])};return function(m,y){f(m,y);function g(){this.constructor=m}m.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12);function l(f){var m=f.split("-"),y=m.slice(1).map(function(g){return g[0].toUpperCase()+g.slice(1)}).join("");return m[0]+y}var u=function(f){s(m,f);function m(){return f!==null&&f.apply(this,arguments)||this}return m.keys=function(y){return(y.getAttribute("style")||"").split(";").map(function(g){var _=g.split(":");return _[0].trim()})},m.prototype.add=function(y,g){return this.canAdd(y,g)?(y.style[l(this.keyName)]=g,!0):!1},m.prototype.remove=function(y){y.style[l(this.keyName)]="",y.getAttribute("style")||y.removeAttribute("style")},m.prototype.value=function(y){var g=y.style[l(this.keyName)];return this.canAdd(y,g)?g:""},m}(o.default);n.default=u},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function u(f,m){for(var y=0;y<m.length;y++){var g=m[y];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(f,m,y){return m&&u(f.prototype,m),y&&u(f,y),f}}();function o(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")}var l=function(){function u(f,m){o(this,u),this.quill=f,this.options=m,this.modules={}}return s(u,[{key:"init",value:function(){var m=this;Object.keys(this.options.modules).forEach(function(y){m.modules[y]==null&&m.addModule(y)})}},{key:"addModule",value:function(m){var y=this.quill.constructor.import("modules/"+m);return this.modules[m]=new y(this.quill,this.options.modules[m]||{}),this.modules[m]}}]),u}();l.DEFAULTS={modules:{}},l.themes={default:l},n.default=l},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function S(I,C){for(var N=0;N<C.length;N++){var R=C[N];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(I,R.key,R)}}return function(I,C,N){return C&&S(I.prototype,C),N&&S(I,N),I}}(),o=function S(I,C,N){I===null&&(I=Function.prototype);var R=Object.getOwnPropertyDescriptor(I,C);if(R===void 0){var B=Object.getPrototypeOf(I);return B===null?void 0:S(B,C,N)}else{if("value"in R)return R.value;var P=R.get;return P===void 0?void 0:P.call(N)}},l=i(0),u=y(l),f=i(7),m=y(f);function y(S){return S&&S.__esModule?S:{default:S}}function g(S,I){if(!(S instanceof I))throw new TypeError("Cannot call a class as a function")}function _(S,I){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I&&(typeof I=="object"||typeof I=="function")?I:S}function E(S,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof I);S.prototype=Object.create(I&&I.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),I&&(Object.setPrototypeOf?Object.setPrototypeOf(S,I):S.__proto__=I)}var x="\uFEFF",w=function(S){E(I,S);function I(C){g(this,I);var N=_(this,(I.__proto__||Object.getPrototypeOf(I)).call(this,C));return N.contentNode=document.createElement("span"),N.contentNode.setAttribute("contenteditable",!1),[].slice.call(N.domNode.childNodes).forEach(function(R){N.contentNode.appendChild(R)}),N.leftGuard=document.createTextNode(x),N.rightGuard=document.createTextNode(x),N.domNode.appendChild(N.leftGuard),N.domNode.appendChild(N.contentNode),N.domNode.appendChild(N.rightGuard),N}return s(I,[{key:"index",value:function(N,R){return N===this.leftGuard?0:N===this.rightGuard?1:o(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"index",this).call(this,N,R)}},{key:"restore",value:function(N){var R=void 0,B=void 0,P=N.data.split(x).join("");if(N===this.leftGuard)if(this.prev instanceof m.default){var k=this.prev.length();this.prev.insertAt(k,P),R={startNode:this.prev.domNode,startOffset:k+P.length}}else B=document.createTextNode(P),this.parent.insertBefore(u.default.create(B),this),R={startNode:B,startOffset:P.length};else N===this.rightGuard&&(this.next instanceof m.default?(this.next.insertAt(0,P),R={startNode:this.next.domNode,startOffset:P.length}):(B=document.createTextNode(P),this.parent.insertBefore(u.default.create(B),this.next),R={startNode:B,startOffset:P.length}));return N.data=x,R}},{key:"update",value:function(N,R){var B=this;N.forEach(function(P){if(P.type==="characterData"&&(P.target===B.leftGuard||P.target===B.rightGuard)){var k=B.restore(P.target);k&&(R.range=k)}})}}]),I}(u.default.Embed);n.default=w},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.AlignStyle=n.AlignClass=n.AlignAttribute=void 0;var s=i(0),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}var u={scope:o.default.Scope.BLOCK,whitelist:["right","center","justify"]},f=new o.default.Attributor.Attribute("align","align",u),m=new o.default.Attributor.Class("align","ql-align",u),y=new o.default.Attributor.Style("align","text-align",u);n.AlignAttribute=f,n.AlignClass=m,n.AlignStyle=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.BackgroundStyle=n.BackgroundClass=void 0;var s=i(0),o=u(s),l=i(26);function u(y){return y&&y.__esModule?y:{default:y}}var f=new o.default.Attributor.Class("background","ql-bg",{scope:o.default.Scope.INLINE}),m=new l.ColorAttributor("background","background-color",{scope:o.default.Scope.INLINE});n.BackgroundClass=f,n.BackgroundStyle=m},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.DirectionStyle=n.DirectionClass=n.DirectionAttribute=void 0;var s=i(0),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}var u={scope:o.default.Scope.BLOCK,whitelist:["rtl"]},f=new o.default.Attributor.Attribute("direction","dir",u),m=new o.default.Attributor.Class("direction","ql-direction",u),y=new o.default.Attributor.Style("direction","direction",u);n.DirectionAttribute=f,n.DirectionClass=m,n.DirectionStyle=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.FontClass=n.FontStyle=void 0;var s=function(){function S(I,C){for(var N=0;N<C.length;N++){var R=C[N];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(I,R.key,R)}}return function(I,C,N){return C&&S(I.prototype,C),N&&S(I,N),I}}(),o=function S(I,C,N){I===null&&(I=Function.prototype);var R=Object.getOwnPropertyDescriptor(I,C);if(R===void 0){var B=Object.getPrototypeOf(I);return B===null?void 0:S(B,C,N)}else{if("value"in R)return R.value;var P=R.get;return P===void 0?void 0:P.call(N)}},l=i(0),u=f(l);function f(S){return S&&S.__esModule?S:{default:S}}function m(S,I){if(!(S instanceof I))throw new TypeError("Cannot call a class as a function")}function y(S,I){if(!S)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I&&(typeof I=="object"||typeof I=="function")?I:S}function g(S,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof I);S.prototype=Object.create(I&&I.prototype,{constructor:{value:S,enumerable:!1,writable:!0,configurable:!0}}),I&&(Object.setPrototypeOf?Object.setPrototypeOf(S,I):S.__proto__=I)}var _={scope:u.default.Scope.INLINE,whitelist:["serif","monospace"]},E=new u.default.Attributor.Class("font","ql-font",_),x=function(S){g(I,S);function I(){return m(this,I),y(this,(I.__proto__||Object.getPrototypeOf(I)).apply(this,arguments))}return s(I,[{key:"value",value:function(N){return o(I.prototype.__proto__||Object.getPrototypeOf(I.prototype),"value",this).call(this,N).replace(/["']/g,"")}}]),I}(u.default.Attributor.Style),w=new x("font","font-family",_);n.FontStyle=w,n.FontClass=E},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SizeStyle=n.SizeClass=void 0;var s=i(0),o=l(s);function l(m){return m&&m.__esModule?m:{default:m}}var u=new o.default.Attributor.Class("size","ql-size",{scope:o.default.Scope.INLINE,whitelist:["small","large","huge"]}),f=new o.default.Attributor.Style("size","font-size",{scope:o.default.Scope.INLINE,whitelist:["10px","18px","32px"]});n.SizeClass=u,n.SizeStyle=f},function(t,n,i){t.exports={align:{"":i(76),center:i(77),right:i(78),justify:i(79)},background:i(80),blockquote:i(81),bold:i(82),clean:i(83),code:i(58),"code-block":i(58),color:i(84),direction:{"":i(85),rtl:i(86)},float:{center:i(87),full:i(88),left:i(89),right:i(90)},formula:i(91),header:{1:i(92),2:i(93)},italic:i(94),image:i(95),indent:{"+1":i(96),"-1":i(97)},link:i(98),list:{ordered:i(99),bullet:i(100),check:i(101)},script:{sub:i(102),super:i(103)},strike:i(104),underline:i(105),video:i(106)}},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.getLastChangeIndex=n.default=void 0;var s=function(){function C(N,R){for(var B=0;B<R.length;B++){var P=R[B];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(N,P.key,P)}}return function(N,R,B){return R&&C(N.prototype,R),B&&C(N,B),N}}(),o=i(0),l=g(o),u=i(5),f=g(u),m=i(9),y=g(m);function g(C){return C&&C.__esModule?C:{default:C}}function _(C,N){if(!(C instanceof N))throw new TypeError("Cannot call a class as a function")}function E(C,N){if(!C)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:C}function x(C,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);C.prototype=Object.create(N&&N.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(C,N):C.__proto__=N)}var w=function(C){x(N,C);function N(R,B){_(this,N);var P=E(this,(N.__proto__||Object.getPrototypeOf(N)).call(this,R,B));return P.lastRecorded=0,P.ignoreChange=!1,P.clear(),P.quill.on(f.default.events.EDITOR_CHANGE,function(k,F,j,O){k!==f.default.events.TEXT_CHANGE||P.ignoreChange||(!P.options.userOnly||O===f.default.sources.USER?P.record(F,j):P.transform(F))}),P.quill.keyboard.addBinding({key:"Z",shortKey:!0},P.undo.bind(P)),P.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},P.redo.bind(P)),/Win/i.test(navigator.platform)&&P.quill.keyboard.addBinding({key:"Y",shortKey:!0},P.redo.bind(P)),P}return s(N,[{key:"change",value:function(B,P){if(this.stack[B].length!==0){var k=this.stack[B].pop();this.stack[P].push(k),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(k[B],f.default.sources.USER),this.ignoreChange=!1;var F=I(k[B]);this.quill.setSelection(F)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(B,P){if(B.ops.length!==0){this.stack.redo=[];var k=this.quill.getContents().diff(P),F=Date.now();if(this.lastRecorded+this.options.delay>F&&this.stack.undo.length>0){var j=this.stack.undo.pop();k=k.compose(j.undo),B=j.redo.compose(B)}else this.lastRecorded=F;this.stack.undo.push({redo:B,undo:k}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(B){this.stack.undo.forEach(function(P){P.undo=B.transform(P.undo,!0),P.redo=B.transform(P.redo,!0)}),this.stack.redo.forEach(function(P){P.undo=B.transform(P.undo,!0),P.redo=B.transform(P.redo,!0)})}},{key:"undo",value:function(){this.change("undo","redo")}}]),N}(y.default);w.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};function S(C){var N=C.ops[C.ops.length-1];return N==null?!1:N.insert!=null?typeof N.insert=="string"&&N.insert.endsWith(`
`):N.attributes!=null?Object.keys(N.attributes).some(function(R){return l.default.query(R,l.default.Scope.BLOCK)!=null}):!1}function I(C){var N=C.reduce(function(B,P){return B+=P.delete||0,B},0),R=C.length()-N;return S(C)&&(R-=1),R}n.default=w,n.getLastChangeIndex=I},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BaseTooltip=void 0;var s=function(){function Z(ne,se){for(var le=0;le<se.length;le++){var Q=se[le];Q.enumerable=Q.enumerable||!1,Q.configurable=!0,"value"in Q&&(Q.writable=!0),Object.defineProperty(ne,Q.key,Q)}}return function(ne,se,le){return se&&Z(ne.prototype,se),le&&Z(ne,le),ne}}(),o=function Z(ne,se,le){ne===null&&(ne=Function.prototype);var Q=Object.getOwnPropertyDescriptor(ne,se);if(Q===void 0){var ce=Object.getPrototypeOf(ne);return ce===null?void 0:Z(ce,se,le)}else{if("value"in Q)return Q.value;var me=Q.get;return me===void 0?void 0:me.call(le)}},l=i(3),u=F(l),f=i(2),m=F(f),y=i(8),g=F(y),_=i(23),E=F(_),x=i(34),w=F(x),S=i(59),I=F(S),C=i(60),N=F(C),R=i(28),B=F(R),P=i(61),k=F(P);function F(Z){return Z&&Z.__esModule?Z:{default:Z}}function j(Z,ne){if(!(Z instanceof ne))throw new TypeError("Cannot call a class as a function")}function O(Z,ne){if(!Z)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ne&&(typeof ne=="object"||typeof ne=="function")?ne:Z}function D(Z,ne){if(typeof ne!="function"&&ne!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ne);Z.prototype=Object.create(ne&&ne.prototype,{constructor:{value:Z,enumerable:!1,writable:!0,configurable:!0}}),ne&&(Object.setPrototypeOf?Object.setPrototypeOf(Z,ne):Z.__proto__=ne)}var M=[!1,"center","right","justify"],$=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],G=[!1,"serif","monospace"],ie=["1","2","3",!1],oe=["small",!1,"large","huge"],ee=function(Z){D(ne,Z);function ne(se,le){j(this,ne);var Q=O(this,(ne.__proto__||Object.getPrototypeOf(ne)).call(this,se,le)),ce=function me(ge){if(!document.body.contains(se.root))return document.body.removeEventListener("click",me);Q.tooltip!=null&&!Q.tooltip.root.contains(ge.target)&&document.activeElement!==Q.tooltip.textbox&&!Q.quill.hasFocus()&&Q.tooltip.hide(),Q.pickers!=null&&Q.pickers.forEach(function(Ae){Ae.container.contains(ge.target)||Ae.close()})};return se.emitter.listenDOM("click",document.body,ce),Q}return s(ne,[{key:"addModule",value:function(le){var Q=o(ne.prototype.__proto__||Object.getPrototypeOf(ne.prototype),"addModule",this).call(this,le);return le==="toolbar"&&this.extendToolbar(Q),Q}},{key:"buildButtons",value:function(le,Q){le.forEach(function(ce){var me=ce.getAttribute("class")||"";me.split(/\s+/).forEach(function(ge){if(ge.startsWith("ql-")&&(ge=ge.slice(3),Q[ge]!=null))if(ge==="direction")ce.innerHTML=Q[ge][""]+Q[ge].rtl;else if(typeof Q[ge]=="string")ce.innerHTML=Q[ge];else{var Ae=ce.value||"";Ae!=null&&Q[ge][Ae]&&(ce.innerHTML=Q[ge][Ae])}})})}},{key:"buildPickers",value:function(le,Q){var ce=this;this.pickers=le.map(function(ge){if(ge.classList.contains("ql-align"))return ge.querySelector("option")==null&&q(ge,M),new N.default(ge,Q.align);if(ge.classList.contains("ql-background")||ge.classList.contains("ql-color")){var Ae=ge.classList.contains("ql-background")?"background":"color";return ge.querySelector("option")==null&&q(ge,$,Ae==="background"?"#ffffff":"#000000"),new I.default(ge,Q[Ae])}else return ge.querySelector("option")==null&&(ge.classList.contains("ql-font")?q(ge,G):ge.classList.contains("ql-header")?q(ge,ie):ge.classList.contains("ql-size")&&q(ge,oe)),new B.default(ge)});var me=function(){ce.pickers.forEach(function(Ae){Ae.update()})};this.quill.on(g.default.events.EDITOR_CHANGE,me)}}]),ne}(w.default);ee.DEFAULTS=(0,u.default)(!0,{},w.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var ne=this,se=this.container.querySelector("input.ql-image[type=file]");se==null&&(se=document.createElement("input"),se.setAttribute("type","file"),se.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),se.classList.add("ql-image"),se.addEventListener("change",function(){if(se.files!=null&&se.files[0]!=null){var le=new FileReader;le.onload=function(Q){var ce=ne.quill.getSelection(!0);ne.quill.updateContents(new m.default().retain(ce.index).delete(ce.length).insert({image:Q.target.result}),g.default.sources.USER),ne.quill.setSelection(ce.index+1,g.default.sources.SILENT),se.value=""},le.readAsDataURL(se.files[0])}}),this.container.appendChild(se)),se.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var J=function(Z){D(ne,Z);function ne(se,le){j(this,ne);var Q=O(this,(ne.__proto__||Object.getPrototypeOf(ne)).call(this,se,le));return Q.textbox=Q.root.querySelector('input[type="text"]'),Q.listen(),Q}return s(ne,[{key:"listen",value:function(){var le=this;this.textbox.addEventListener("keydown",function(Q){E.default.match(Q,"enter")?(le.save(),Q.preventDefault()):E.default.match(Q,"escape")&&(le.cancel(),Q.preventDefault())})}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var le=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),Q!=null?this.textbox.value=Q:le!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+le)||""),this.root.setAttribute("data-mode",le)}},{key:"restoreFocus",value:function(){var le=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=le}},{key:"save",value:function(){var le=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":{var Q=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",le,g.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",le,g.default.sources.USER)),this.quill.root.scrollTop=Q;break}case"video":le=Y(le);case"formula":{if(!le)break;var ce=this.quill.getSelection(!0);if(ce!=null){var me=ce.index+ce.length;this.quill.insertEmbed(me,this.root.getAttribute("data-mode"),le,g.default.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(me+1," ",g.default.sources.USER),this.quill.setSelection(me+2,g.default.sources.USER)}break}}this.textbox.value="",this.hide()}}]),ne}(k.default);function Y(Z){var ne=Z.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||Z.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return ne?(ne[1]||"https")+"://www.youtube.com/embed/"+ne[2]+"?showinfo=0":(ne=Z.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?(ne[1]||"https")+"://player.vimeo.com/video/"+ne[2]+"/":Z}function q(Z,ne){var se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;ne.forEach(function(le){var Q=document.createElement("option");le===se?Q.setAttribute("selected","selected"):Q.setAttribute("value",le),Z.appendChild(Q)})}n.BaseTooltip=J,n.default=ee},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function o(){this.head=this.tail=null,this.length=0}return o.prototype.append=function(){for(var l=[],u=0;u<arguments.length;u++)l[u]=arguments[u];this.insertBefore(l[0],null),l.length>1&&this.append.apply(this,l.slice(1))},o.prototype.contains=function(l){for(var u,f=this.iterator();u=f();)if(u===l)return!0;return!1},o.prototype.insertBefore=function(l,u){l&&(l.next=u,u!=null?(l.prev=u.prev,u.prev!=null&&(u.prev.next=l),u.prev=l,u===this.head&&(this.head=l)):this.tail!=null?(this.tail.next=l,l.prev=this.tail,this.tail=l):(l.prev=null,this.head=this.tail=l),this.length+=1)},o.prototype.offset=function(l){for(var u=0,f=this.head;f!=null;){if(f===l)return u;u+=f.length(),f=f.next}return-1},o.prototype.remove=function(l){this.contains(l)&&(l.prev!=null&&(l.prev.next=l.next),l.next!=null&&(l.next.prev=l.prev),l===this.head&&(this.head=l.next),l===this.tail&&(this.tail=l.prev),this.length-=1)},o.prototype.iterator=function(l){return l===void 0&&(l=this.head),function(){var u=l;return l!=null&&(l=l.next),u}},o.prototype.find=function(l,u){u===void 0&&(u=!1);for(var f,m=this.iterator();f=m();){var y=f.length();if(l<y||u&&l===y&&(f.next==null||f.next.length()!==0))return[f,l];l-=y}return[null,0]},o.prototype.forEach=function(l){for(var u,f=this.iterator();u=f();)l(u)},o.prototype.forEachAt=function(l,u,f){if(!(u<=0))for(var m=this.find(l),y=m[0],g=m[1],_,E=l-g,x=this.iterator(y);(_=x())&&E<l+u;){var w=_.length();l>E?f(_,l-E,Math.min(u,E+w-l)):f(_,0,Math.min(w,l+u-E)),E+=w}},o.prototype.map=function(l){return this.reduce(function(u,f){return u.push(l(f)),u},[])},o.prototype.reduce=function(l,u){for(var f,m=this.iterator();f=m();)u=l(u,f);return u},o}();n.default=s},function(t,n,i){var s=this&&this.__extends||function(){var y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,_){g.__proto__=_}||function(g,_){for(var E in _)_.hasOwnProperty(E)&&(g[E]=_[E])};return function(g,_){y(g,_);function E(){this.constructor=g}g.prototype=_===null?Object.create(_):(E.prototype=_.prototype,new E)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(17),l=i(1),u={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},f=100,m=function(y){s(g,y);function g(_){var E=y.call(this,_)||this;return E.scroll=E,E.observer=new MutationObserver(function(x){E.update(x)}),E.observer.observe(E.domNode,u),E.attach(),E}return g.prototype.detach=function(){y.prototype.detach.call(this),this.observer.disconnect()},g.prototype.deleteAt=function(_,E){this.update(),_===0&&E===this.length()?this.children.forEach(function(x){x.remove()}):y.prototype.deleteAt.call(this,_,E)},g.prototype.formatAt=function(_,E,x,w){this.update(),y.prototype.formatAt.call(this,_,E,x,w)},g.prototype.insertAt=function(_,E,x){this.update(),y.prototype.insertAt.call(this,_,E,x)},g.prototype.optimize=function(_,E){var x=this;_===void 0&&(_=[]),E===void 0&&(E={}),y.prototype.optimize.call(this,E);for(var w=[].slice.call(this.observer.takeRecords());w.length>0;)_.push(w.pop());for(var S=function(R,B){B===void 0&&(B=!0),!(R==null||R===x)&&R.domNode.parentNode!=null&&(R.domNode[l.DATA_KEY].mutations==null&&(R.domNode[l.DATA_KEY].mutations=[]),B&&S(R.parent))},I=function(R){R.domNode[l.DATA_KEY]==null||R.domNode[l.DATA_KEY].mutations==null||(R instanceof o.default&&R.children.forEach(I),R.optimize(E))},C=_,N=0;C.length>0;N+=1){if(N>=f)throw new Error("[Parchment] Maximum optimize iterations reached");for(C.forEach(function(R){var B=l.find(R.target,!0);B!=null&&(B.domNode===R.target&&(R.type==="childList"?(S(l.find(R.previousSibling,!1)),[].forEach.call(R.addedNodes,function(P){var k=l.find(P,!1);S(k,!1),k instanceof o.default&&k.children.forEach(function(F){S(F,!1)})})):R.type==="attributes"&&S(B.prev)),S(B))}),this.children.forEach(I),C=[].slice.call(this.observer.takeRecords()),w=C.slice();w.length>0;)_.push(w.pop())}},g.prototype.update=function(_,E){var x=this;E===void 0&&(E={}),_=_||this.observer.takeRecords(),_.map(function(w){var S=l.find(w.target,!0);return S==null?null:S.domNode[l.DATA_KEY].mutations==null?(S.domNode[l.DATA_KEY].mutations=[w],S):(S.domNode[l.DATA_KEY].mutations.push(w),null)}).forEach(function(w){w==null||w===x||w.domNode[l.DATA_KEY]==null||w.update(w.domNode[l.DATA_KEY].mutations||[],E)}),this.domNode[l.DATA_KEY].mutations!=null&&y.prototype.update.call(this,this.domNode[l.DATA_KEY].mutations,E),this.optimize(_,E)},g.blotName="scroll",g.defaultChild="block",g.scope=l.Scope.BLOCK_BLOT,g.tagName="DIV",g}(o.default);n.default=m},function(t,n,i){var s=this&&this.__extends||function(){var m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,g){y.__proto__=g}||function(y,g){for(var _ in g)g.hasOwnProperty(_)&&(y[_]=g[_])};return function(y,g){m(y,g);function _(){this.constructor=y}y.prototype=g===null?Object.create(g):(_.prototype=g.prototype,new _)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(18),l=i(1);function u(m,y){if(Object.keys(m).length!==Object.keys(y).length)return!1;for(var g in m)if(m[g]!==y[g])return!1;return!0}var f=function(m){s(y,m);function y(){return m!==null&&m.apply(this,arguments)||this}return y.formats=function(g){if(g.tagName!==y.tagName)return m.formats.call(this,g)},y.prototype.format=function(g,_){var E=this;g===this.statics.blotName&&!_?(this.children.forEach(function(x){x instanceof o.default||(x=x.wrap(y.blotName,!0)),E.attributes.copy(x)}),this.unwrap()):m.prototype.format.call(this,g,_)},y.prototype.formatAt=function(g,_,E,x){if(this.formats()[E]!=null||l.query(E,l.Scope.ATTRIBUTE)){var w=this.isolate(g,_);w.format(E,x)}else m.prototype.formatAt.call(this,g,_,E,x)},y.prototype.optimize=function(g){m.prototype.optimize.call(this,g);var _=this.formats();if(Object.keys(_).length===0)return this.unwrap();var E=this.next;E instanceof y&&E.prev===this&&u(_,E.formats())&&(E.moveChildren(this),E.remove())},y.blotName="inline",y.scope=l.Scope.INLINE_BLOT,y.tagName="SPAN",y}(o.default);n.default=f},function(t,n,i){var s=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var g in y)y.hasOwnProperty(g)&&(m[g]=y[g])};return function(m,y){f(m,y);function g(){this.constructor=m}m.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(18),l=i(1),u=function(f){s(m,f);function m(){return f!==null&&f.apply(this,arguments)||this}return m.formats=function(y){var g=l.query(m.blotName).tagName;if(y.tagName!==g)return f.formats.call(this,y)},m.prototype.format=function(y,g){l.query(y,l.Scope.BLOCK)!=null&&(y===this.statics.blotName&&!g?this.replaceWith(m.blotName):f.prototype.format.call(this,y,g))},m.prototype.formatAt=function(y,g,_,E){l.query(_,l.Scope.BLOCK)!=null?this.format(_,E):f.prototype.formatAt.call(this,y,g,_,E)},m.prototype.insertAt=function(y,g,_){if(_==null||l.query(g,l.Scope.INLINE)!=null)f.prototype.insertAt.call(this,y,g,_);else{var E=this.split(y),x=l.create(g,_);E.parent.insertBefore(x,E)}},m.prototype.update=function(y,g){navigator.userAgent.match(/Trident/)?this.build():f.prototype.update.call(this,y,g)},m.blotName="block",m.scope=l.Scope.BLOCK_BLOT,m.tagName="P",m}(o.default);n.default=u},function(t,n,i){var s=this&&this.__extends||function(){var u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,m){f.__proto__=m}||function(f,m){for(var y in m)m.hasOwnProperty(y)&&(f[y]=m[y])};return function(f,m){u(f,m);function y(){this.constructor=f}f.prototype=m===null?Object.create(m):(y.prototype=m.prototype,new y)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(19),l=function(u){s(f,u);function f(){return u!==null&&u.apply(this,arguments)||this}return f.formats=function(m){},f.prototype.format=function(m,y){u.prototype.formatAt.call(this,0,this.length(),m,y)},f.prototype.formatAt=function(m,y,g,_){m===0&&y===this.length()?this.format(g,_):u.prototype.formatAt.call(this,m,y,g,_)},f.prototype.formats=function(){return this.statics.formats(this.domNode)},f}(o.default);n.default=l},function(t,n,i){var s=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var g in y)y.hasOwnProperty(g)&&(m[g]=y[g])};return function(m,y){f(m,y);function g(){this.constructor=m}m.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(19),l=i(1),u=function(f){s(m,f);function m(y){var g=f.call(this,y)||this;return g.text=g.statics.value(g.domNode),g}return m.create=function(y){return document.createTextNode(y)},m.value=function(y){var g=y.data;return g.normalize&&(g=g.normalize()),g},m.prototype.deleteAt=function(y,g){this.domNode.data=this.text=this.text.slice(0,y)+this.text.slice(y+g)},m.prototype.index=function(y,g){return this.domNode===y?g:-1},m.prototype.insertAt=function(y,g,_){_==null?(this.text=this.text.slice(0,y)+g+this.text.slice(y),this.domNode.data=this.text):f.prototype.insertAt.call(this,y,g,_)},m.prototype.length=function(){return this.text.length},m.prototype.optimize=function(y){f.prototype.optimize.call(this,y),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof m&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},m.prototype.position=function(y,g){return[this.domNode,y]},m.prototype.split=function(y,g){if(g===void 0&&(g=!1),!g){if(y===0)return this;if(y===this.length())return this.next}var _=l.create(this.domNode.splitText(y));return this.parent.insertBefore(_,this.next),this.text=this.statics.value(this.domNode),_},m.prototype.update=function(y,g){var _=this;y.some(function(E){return E.type==="characterData"&&E.target===_.domNode})&&(this.text=this.statics.value(this.domNode))},m.prototype.value=function(){return this.text},m.blotName="text",m.scope=l.Scope.INLINE_BLOT,m}(o.default);n.default=u},function(t,n,i){var s=document.createElement("div");if(s.classList.toggle("test-class",!1),s.classList.contains("test-class")){var o=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(l,u){return arguments.length>1&&!this.contains(l)==!u?u:o.call(this,l)}}String.prototype.startsWith||(String.prototype.startsWith=function(l,u){return u=u||0,this.substr(u,l.length)===l}),String.prototype.endsWith||(String.prototype.endsWith=function(l,u){var f=this.toString();(typeof u!="number"||!isFinite(u)||Math.floor(u)!==u||u>f.length)&&(u=f.length),u-=l.length;var m=f.indexOf(l,u);return m!==-1&&m===u}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(u){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof u!="function")throw new TypeError("predicate must be a function");for(var f=Object(this),m=f.length>>>0,y=arguments[1],g,_=0;_<m;_++)if(g=f[_],u.call(y,g,_,f))return g}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})},function(t,n){var i=-1,s=1,o=0;function l(N,R,B){if(N==R)return N?[[o,N]]:[];(B<0||N.length<B)&&(B=null);var P=y(N,R),k=N.substring(0,P);N=N.substring(P),R=R.substring(P),P=g(N,R);var F=N.substring(N.length-P);N=N.substring(0,N.length-P),R=R.substring(0,R.length-P);var j=u(N,R);return k&&j.unshift([o,k]),F&&j.push([o,F]),E(j),B!=null&&(j=S(j,B)),j=I(j),j}function u(N,R){var B;if(!N)return[[s,R]];if(!R)return[[i,N]];var P=N.length>R.length?N:R,k=N.length>R.length?R:N,F=P.indexOf(k);if(F!=-1)return B=[[s,P.substring(0,F)],[o,k],[s,P.substring(F+k.length)]],N.length>R.length&&(B[0][0]=B[2][0]=i),B;if(k.length==1)return[[i,N],[s,R]];var j=_(N,R);if(j){var O=j[0],D=j[1],M=j[2],$=j[3],G=j[4],ie=l(O,M),oe=l(D,$);return ie.concat([[o,G]],oe)}return f(N,R)}function f(N,R){for(var B=N.length,P=R.length,k=Math.ceil((B+P)/2),F=k,j=2*k,O=new Array(j),D=new Array(j),M=0;M<j;M++)O[M]=-1,D[M]=-1;O[F+1]=0,D[F+1]=0;for(var $=B-P,G=$%2!=0,ie=0,oe=0,ee=0,J=0,Y=0;Y<k;Y++){for(var q=-Y+ie;q<=Y-oe;q+=2){var Z=F+q,ne;q==-Y||q!=Y&&O[Z-1]<O[Z+1]?ne=O[Z+1]:ne=O[Z-1]+1;for(var se=ne-q;ne<B&&se<P&&N.charAt(ne)==R.charAt(se);)ne++,se++;if(O[Z]=ne,ne>B)oe+=2;else if(se>P)ie+=2;else if(G){var le=F+$-q;if(le>=0&&le<j&&D[le]!=-1){var Q=B-D[le];if(ne>=Q)return m(N,R,ne,se)}}}for(var ce=-Y+ee;ce<=Y-J;ce+=2){var le=F+ce,Q;ce==-Y||ce!=Y&&D[le-1]<D[le+1]?Q=D[le+1]:Q=D[le-1]+1;for(var me=Q-ce;Q<B&&me<P&&N.charAt(B-Q-1)==R.charAt(P-me-1);)Q++,me++;if(D[le]=Q,Q>B)J+=2;else if(me>P)ee+=2;else if(!G){var Z=F+$-ce;if(Z>=0&&Z<j&&O[Z]!=-1){var ne=O[Z],se=F+ne-Z;if(Q=B-Q,ne>=Q)return m(N,R,ne,se)}}}}return[[i,N],[s,R]]}function m(N,R,B,P){var k=N.substring(0,B),F=R.substring(0,P),j=N.substring(B),O=R.substring(P),D=l(k,F),M=l(j,O);return D.concat(M)}function y(N,R){if(!N||!R||N.charAt(0)!=R.charAt(0))return 0;for(var B=0,P=Math.min(N.length,R.length),k=P,F=0;B<k;)N.substring(F,k)==R.substring(F,k)?(B=k,F=B):P=k,k=Math.floor((P-B)/2+B);return k}function g(N,R){if(!N||!R||N.charAt(N.length-1)!=R.charAt(R.length-1))return 0;for(var B=0,P=Math.min(N.length,R.length),k=P,F=0;B<k;)N.substring(N.length-k,N.length-F)==R.substring(R.length-k,R.length-F)?(B=k,F=B):P=k,k=Math.floor((P-B)/2+B);return k}function _(N,R){var B=N.length>R.length?N:R,P=N.length>R.length?R:N;if(B.length<4||P.length*2<B.length)return null;function k(oe,ee,J){for(var Y=oe.substring(J,J+Math.floor(oe.length/4)),q=-1,Z="",ne,se,le,Q;(q=ee.indexOf(Y,q+1))!=-1;){var ce=y(oe.substring(J),ee.substring(q)),me=g(oe.substring(0,J),ee.substring(0,q));Z.length<me+ce&&(Z=ee.substring(q-me,q)+ee.substring(q,q+ce),ne=oe.substring(0,J-me),se=oe.substring(J+ce),le=ee.substring(0,q-me),Q=ee.substring(q+ce))}return Z.length*2>=oe.length?[ne,se,le,Q,Z]:null}var F=k(B,P,Math.ceil(B.length/4)),j=k(B,P,Math.ceil(B.length/2)),O;if(!F&&!j)return null;j?F?O=F[4].length>j[4].length?F:j:O=j:O=F;var D,M,$,G;N.length>R.length?(D=O[0],M=O[1],$=O[2],G=O[3]):($=O[0],G=O[1],D=O[2],M=O[3]);var ie=O[4];return[D,M,$,G,ie]}function E(N){N.push([o,""]);for(var R=0,B=0,P=0,k="",F="",j;R<N.length;)switch(N[R][0]){case s:P++,F+=N[R][1],R++;break;case i:B++,k+=N[R][1],R++;break;case o:B+P>1?(B!==0&&P!==0&&(j=y(F,k),j!==0&&(R-B-P>0&&N[R-B-P-1][0]==o?N[R-B-P-1][1]+=F.substring(0,j):(N.splice(0,0,[o,F.substring(0,j)]),R++),F=F.substring(j),k=k.substring(j)),j=g(F,k),j!==0&&(N[R][1]=F.substring(F.length-j)+N[R][1],F=F.substring(0,F.length-j),k=k.substring(0,k.length-j))),B===0?N.splice(R-P,B+P,[s,F]):P===0?N.splice(R-B,B+P,[i,k]):N.splice(R-B-P,B+P,[i,k],[s,F]),R=R-B-P+(B?1:0)+(P?1:0)+1):R!==0&&N[R-1][0]==o?(N[R-1][1]+=N[R][1],N.splice(R,1)):R++,P=0,B=0,k="",F="";break}N[N.length-1][1]===""&&N.pop();var O=!1;for(R=1;R<N.length-1;)N[R-1][0]==o&&N[R+1][0]==o&&(N[R][1].substring(N[R][1].length-N[R-1][1].length)==N[R-1][1]?(N[R][1]=N[R-1][1]+N[R][1].substring(0,N[R][1].length-N[R-1][1].length),N[R+1][1]=N[R-1][1]+N[R+1][1],N.splice(R-1,1),O=!0):N[R][1].substring(0,N[R+1][1].length)==N[R+1][1]&&(N[R-1][1]+=N[R+1][1],N[R][1]=N[R][1].substring(N[R+1][1].length)+N[R+1][1],N.splice(R+1,1),O=!0)),R++;O&&E(N)}var x=l;x.INSERT=s,x.DELETE=i,x.EQUAL=o,t.exports=x;function w(N,R){if(R===0)return[o,N];for(var B=0,P=0;P<N.length;P++){var k=N[P];if(k[0]===i||k[0]===o){var F=B+k[1].length;if(R===F)return[P+1,N];if(R<F){N=N.slice();var j=R-B,O=[k[0],k[1].slice(0,j)],D=[k[0],k[1].slice(j)];return N.splice(P,1,O,D),[P+1,N]}else B=F}}throw new Error("cursor_pos is out of bounds!")}function S(N,R){var B=w(N,R),P=B[1],k=B[0],F=P[k],j=P[k+1];if(F==null)return N;if(F[0]!==o)return N;if(j!=null&&F[1]+j[1]===j[1]+F[1])return P.splice(k,2,j,F),C(P,k,2);if(j!=null&&j[1].indexOf(F[1])===0){P.splice(k,2,[j[0],F[1]],[0,F[1]]);var O=j[1].slice(F[1].length);return O.length>0&&P.splice(k+2,0,[j[0],O]),C(P,k,3)}else return N}function I(N){for(var R=!1,B=function(j){return j.charCodeAt(0)>=56320&&j.charCodeAt(0)<=57343},P=function(j){return j.charCodeAt(j.length-1)>=55296&&j.charCodeAt(j.length-1)<=56319},k=2;k<N.length;k+=1)N[k-2][0]===o&&P(N[k-2][1])&&N[k-1][0]===i&&B(N[k-1][1])&&N[k][0]===s&&B(N[k][1])&&(R=!0,N[k-1][1]=N[k-2][1].slice(-1)+N[k-1][1],N[k][1]=N[k-2][1].slice(-1)+N[k][1],N[k-2][1]=N[k-2][1].slice(0,-1));if(!R)return N;for(var F=[],k=0;k<N.length;k+=1)N[k][1].length>0&&F.push(N[k]);return F}function C(N,R,B){for(var P=R+B-1;P>=0&&P>=R-1;P--)if(P+1<N.length){var k=N[P],F=N[P+1];k[0]===F[1]&&N.splice(P,2,[k[0],k[1]+F[1]])}return N}},function(t,n){n=t.exports=typeof Object.keys=="function"?Object.keys:i,n.shim=i;function i(s){var o=[];for(var l in s)o.push(l);return o}},function(t,n){var i=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";n=t.exports=i?s:o,n.supported=s;function s(l){return Object.prototype.toString.call(l)=="[object Arguments]"}n.unsupported=o;function o(l){return l&&typeof l=="object"&&typeof l.length=="number"&&Object.prototype.hasOwnProperty.call(l,"callee")&&!Object.prototype.propertyIsEnumerable.call(l,"callee")||!1}},function(t,n){var i=Object.prototype.hasOwnProperty,s="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(s=!1));function l(f,m,y){this.fn=f,this.context=m,this.once=y||!1}function u(){this._events=new o,this._eventsCount=0}u.prototype.eventNames=function(){var m=[],y,g;if(this._eventsCount===0)return m;for(g in y=this._events)i.call(y,g)&&m.push(s?g.slice(1):g);return Object.getOwnPropertySymbols?m.concat(Object.getOwnPropertySymbols(y)):m},u.prototype.listeners=function(m,y){var g=s?s+m:m,_=this._events[g];if(y)return!!_;if(!_)return[];if(_.fn)return[_.fn];for(var E=0,x=_.length,w=new Array(x);E<x;E++)w[E]=_[E].fn;return w},u.prototype.emit=function(m,y,g,_,E,x){var w=s?s+m:m;if(!this._events[w])return!1;var S=this._events[w],I=arguments.length,C,N;if(S.fn){switch(S.once&&this.removeListener(m,S.fn,void 0,!0),I){case 1:return S.fn.call(S.context),!0;case 2:return S.fn.call(S.context,y),!0;case 3:return S.fn.call(S.context,y,g),!0;case 4:return S.fn.call(S.context,y,g,_),!0;case 5:return S.fn.call(S.context,y,g,_,E),!0;case 6:return S.fn.call(S.context,y,g,_,E,x),!0}for(N=1,C=new Array(I-1);N<I;N++)C[N-1]=arguments[N];S.fn.apply(S.context,C)}else{var R=S.length,B;for(N=0;N<R;N++)switch(S[N].once&&this.removeListener(m,S[N].fn,void 0,!0),I){case 1:S[N].fn.call(S[N].context);break;case 2:S[N].fn.call(S[N].context,y);break;case 3:S[N].fn.call(S[N].context,y,g);break;case 4:S[N].fn.call(S[N].context,y,g,_);break;default:if(!C)for(B=1,C=new Array(I-1);B<I;B++)C[B-1]=arguments[B];S[N].fn.apply(S[N].context,C)}}return!0},u.prototype.on=function(m,y,g){var _=new l(y,g||this),E=s?s+m:m;return this._events[E]?this._events[E].fn?this._events[E]=[this._events[E],_]:this._events[E].push(_):(this._events[E]=_,this._eventsCount++),this},u.prototype.once=function(m,y,g){var _=new l(y,g||this,!0),E=s?s+m:m;return this._events[E]?this._events[E].fn?this._events[E]=[this._events[E],_]:this._events[E].push(_):(this._events[E]=_,this._eventsCount++),this},u.prototype.removeListener=function(m,y,g,_){var E=s?s+m:m;if(!this._events[E])return this;if(!y)return--this._eventsCount===0?this._events=new o:delete this._events[E],this;var x=this._events[E];if(x.fn)x.fn===y&&(!_||x.once)&&(!g||x.context===g)&&(--this._eventsCount===0?this._events=new o:delete this._events[E]);else{for(var w=0,S=[],I=x.length;w<I;w++)(x[w].fn!==y||_&&!x[w].once||g&&x[w].context!==g)&&S.push(x[w]);S.length?this._events[E]=S.length===1?S[0]:S:--this._eventsCount===0?this._events=new o:delete this._events[E]}return this},u.prototype.removeAllListeners=function(m){var y;return m?(y=s?s+m:m,this._events[y]&&(--this._eventsCount===0?this._events=new o:delete this._events[y])):(this._events=new o,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prototype.setMaxListeners=function(){return this},u.prefixed=s,u.EventEmitter=u,typeof t<"u"&&(t.exports=u)},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.matchText=n.matchSpacing=n.matchNewline=n.matchBlot=n.matchAttributor=n.default=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Se){return typeof Se}:function(Se){return Se&&typeof Symbol=="function"&&Se.constructor===Symbol&&Se!==Symbol.prototype?"symbol":typeof Se},o=function(){function Se(Ie,De){var Ve=[],ke=!0,gt=!1,ft=void 0;try{for(var mt=Ie[Symbol.iterator](),kt;!(ke=(kt=mt.next()).done)&&(Ve.push(kt.value),!(De&&Ve.length===De));ke=!0);}catch(jt){gt=!0,ft=jt}finally{try{!ke&&mt.return&&mt.return()}finally{if(gt)throw ft}}return Ve}return function(Ie,De){if(Array.isArray(Ie))return Ie;if(Symbol.iterator in Object(Ie))return Se(Ie,De);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function Se(Ie,De){for(var Ve=0;Ve<De.length;Ve++){var ke=De[Ve];ke.enumerable=ke.enumerable||!1,ke.configurable=!0,"value"in ke&&(ke.writable=!0),Object.defineProperty(Ie,ke.key,ke)}}return function(Ie,De,Ve){return De&&Se(Ie.prototype,De),Ve&&Se(Ie,Ve),Ie}}(),u=i(3),f=D(u),m=i(2),y=D(m),g=i(0),_=D(g),E=i(5),x=D(E),w=i(10),S=D(w),I=i(9),C=D(I),N=i(36),R=i(37),B=i(13),P=D(B),k=i(26),F=i(38),j=i(39),O=i(40);function D(Se){return Se&&Se.__esModule?Se:{default:Se}}function M(Se,Ie,De){return Ie in Se?Object.defineProperty(Se,Ie,{value:De,enumerable:!0,configurable:!0,writable:!0}):Se[Ie]=De,Se}function $(Se,Ie){if(!(Se instanceof Ie))throw new TypeError("Cannot call a class as a function")}function G(Se,Ie){if(!Se)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Ie&&(typeof Ie=="object"||typeof Ie=="function")?Ie:Se}function ie(Se,Ie){if(typeof Ie!="function"&&Ie!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Ie);Se.prototype=Object.create(Ie&&Ie.prototype,{constructor:{value:Se,enumerable:!1,writable:!0,configurable:!0}}),Ie&&(Object.setPrototypeOf?Object.setPrototypeOf(Se,Ie):Se.__proto__=Ie)}var oe=(0,S.default)("quill:clipboard"),ee="__ql-matcher",J=[[Node.TEXT_NODE,Wt],[Node.TEXT_NODE,pt],["br",Ue],[Node.ELEMENT_NODE,pt],[Node.ELEMENT_NODE,Ae],[Node.ELEMENT_NODE,Et],[Node.ELEMENT_NODE,ge],[Node.ELEMENT_NODE,_n],["li",et],["b",me.bind(me,"bold")],["i",me.bind(me,"italic")],["style",nt]],Y=[N.AlignAttribute,F.DirectionAttribute].reduce(function(Se,Ie){return Se[Ie.keyName]=Ie,Se},{}),q=[N.AlignStyle,R.BackgroundStyle,k.ColorStyle,F.DirectionStyle,j.FontStyle,O.SizeStyle].reduce(function(Se,Ie){return Se[Ie.keyName]=Ie,Se},{}),Z=function(Se){ie(Ie,Se);function Ie(De,Ve){$(this,Ie);var ke=G(this,(Ie.__proto__||Object.getPrototypeOf(Ie)).call(this,De,Ve));return ke.quill.root.addEventListener("paste",ke.onPaste.bind(ke)),ke.container=ke.quill.addContainer("ql-clipboard"),ke.container.setAttribute("contenteditable",!0),ke.container.setAttribute("tabindex",-1),ke.matchers=[],J.concat(ke.options.matchers).forEach(function(gt){var ft=o(gt,2),mt=ft[0],kt=ft[1];!Ve.matchVisual&&kt===Et||ke.addMatcher(mt,kt)}),ke}return l(Ie,[{key:"addMatcher",value:function(Ve,ke){this.matchers.push([Ve,ke])}},{key:"convert",value:function(Ve){if(typeof Ve=="string")return this.container.innerHTML=Ve.replace(/\>\r?\n +\</g,"><"),this.convert();var ke=this.quill.getFormat(this.quill.selection.savedRange.index);if(ke[P.default.blotName]){var gt=this.container.innerText;return this.container.innerHTML="",new y.default().insert(gt,M({},P.default.blotName,ke[P.default.blotName]))}var ft=this.prepareMatching(),mt=o(ft,2),kt=mt[0],jt=mt[1],Mt=ce(this.container,kt,jt);return le(Mt,`
`)&&Mt.ops[Mt.ops.length-1].attributes==null&&(Mt=Mt.compose(new y.default().retain(Mt.length()-1).delete(1))),oe.log("convert",this.container.innerHTML,Mt),this.container.innerHTML="",Mt}},{key:"dangerouslyPasteHTML",value:function(Ve,ke){var gt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:x.default.sources.API;if(typeof Ve=="string")this.quill.setContents(this.convert(Ve),ke),this.quill.setSelection(0,x.default.sources.SILENT);else{var ft=this.convert(ke);this.quill.updateContents(new y.default().retain(Ve).concat(ft),gt),this.quill.setSelection(Ve+ft.length(),x.default.sources.SILENT)}}},{key:"onPaste",value:function(Ve){var ke=this;if(!(Ve.defaultPrevented||!this.quill.isEnabled())){var gt=this.quill.getSelection(),ft=new y.default().retain(gt.index),mt=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(x.default.sources.SILENT),setTimeout(function(){ft=ft.concat(ke.convert()).delete(gt.length),ke.quill.updateContents(ft,x.default.sources.USER),ke.quill.setSelection(ft.length()-gt.length,x.default.sources.SILENT),ke.quill.scrollingContainer.scrollTop=mt,ke.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var Ve=this,ke=[],gt=[];return this.matchers.forEach(function(ft){var mt=o(ft,2),kt=mt[0],jt=mt[1];switch(kt){case Node.TEXT_NODE:gt.push(jt);break;case Node.ELEMENT_NODE:ke.push(jt);break;default:[].forEach.call(Ve.container.querySelectorAll(kt),function(Mt){Mt[ee]=Mt[ee]||[],Mt[ee].push(jt)});break}}),[ke,gt]}}]),Ie}(C.default);Z.DEFAULTS={matchers:[],matchVisual:!0};function ne(Se,Ie,De){return(typeof Ie>"u"?"undefined":s(Ie))==="object"?Object.keys(Ie).reduce(function(Ve,ke){return ne(Ve,ke,Ie[ke])},Se):Se.reduce(function(Ve,ke){return ke.attributes&&ke.attributes[Ie]?Ve.push(ke):Ve.insert(ke.insert,(0,f.default)({},M({},Ie,De),ke.attributes))},new y.default)}function se(Se){if(Se.nodeType!==Node.ELEMENT_NODE)return{};var Ie="__ql-computed-style";return Se[Ie]||(Se[Ie]=window.getComputedStyle(Se))}function le(Se,Ie){for(var De="",Ve=Se.ops.length-1;Ve>=0&&De.length<Ie.length;--Ve){var ke=Se.ops[Ve];if(typeof ke.insert!="string")break;De=ke.insert+De}return De.slice(-1*Ie.length)===Ie}function Q(Se){if(Se.childNodes.length===0)return!1;var Ie=se(Se);return["block","list-item"].indexOf(Ie.display)>-1}function ce(Se,Ie,De){return Se.nodeType===Se.TEXT_NODE?De.reduce(function(Ve,ke){return ke(Se,Ve)},new y.default):Se.nodeType===Se.ELEMENT_NODE?[].reduce.call(Se.childNodes||[],function(Ve,ke){var gt=ce(ke,Ie,De);return ke.nodeType===Se.ELEMENT_NODE&&(gt=Ie.reduce(function(ft,mt){return mt(ke,ft)},gt),gt=(ke[ee]||[]).reduce(function(ft,mt){return mt(ke,ft)},gt)),Ve.concat(gt)},new y.default):new y.default}function me(Se,Ie,De){return ne(De,Se,!0)}function ge(Se,Ie){var De=_.default.Attributor.Attribute.keys(Se),Ve=_.default.Attributor.Class.keys(Se),ke=_.default.Attributor.Style.keys(Se),gt={};return De.concat(Ve).concat(ke).forEach(function(ft){var mt=_.default.query(ft,_.default.Scope.ATTRIBUTE);mt!=null&&(gt[mt.attrName]=mt.value(Se),gt[mt.attrName])||(mt=Y[ft],mt!=null&&(mt.attrName===ft||mt.keyName===ft)&&(gt[mt.attrName]=mt.value(Se)||void 0),mt=q[ft],mt!=null&&(mt.attrName===ft||mt.keyName===ft)&&(mt=q[ft],gt[mt.attrName]=mt.value(Se)||void 0))}),Object.keys(gt).length>0&&(Ie=ne(Ie,gt)),Ie}function Ae(Se,Ie){var De=_.default.query(Se);if(De==null)return Ie;if(De.prototype instanceof _.default.Embed){var Ve={},ke=De.value(Se);ke!=null&&(Ve[De.blotName]=ke,Ie=new y.default().insert(Ve,De.formats(Se)))}else typeof De.formats=="function"&&(Ie=ne(Ie,De.blotName,De.formats(Se)));return Ie}function Ue(Se,Ie){return le(Ie,`
`)||Ie.insert(`
`),Ie}function nt(){return new y.default}function et(Se,Ie){var De=_.default.query(Se);if(De==null||De.blotName!=="list-item"||!le(Ie,`
`))return Ie;for(var Ve=-1,ke=Se.parentNode;!ke.classList.contains("ql-clipboard");)(_.default.query(ke)||{}).blotName==="list"&&(Ve+=1),ke=ke.parentNode;return Ve<=0?Ie:Ie.compose(new y.default().retain(Ie.length()-1).retain(1,{indent:Ve}))}function pt(Se,Ie){return le(Ie,`
`)||(Q(Se)||Ie.length()>0&&Se.nextSibling&&Q(Se.nextSibling))&&Ie.insert(`
`),Ie}function Et(Se,Ie){if(Q(Se)&&Se.nextElementSibling!=null&&!le(Ie,`

`)){var De=Se.offsetHeight+parseFloat(se(Se).marginTop)+parseFloat(se(Se).marginBottom);Se.nextElementSibling.offsetTop>Se.offsetTop+De*1.5&&Ie.insert(`
`)}return Ie}function _n(Se,Ie){var De={},Ve=Se.style||{};return Ve.fontStyle&&se(Se).fontStyle==="italic"&&(De.italic=!0),Ve.fontWeight&&(se(Se).fontWeight.startsWith("bold")||parseInt(se(Se).fontWeight)>=700)&&(De.bold=!0),Object.keys(De).length>0&&(Ie=ne(Ie,De)),parseFloat(Ve.textIndent||0)>0&&(Ie=new y.default().insert("	").concat(Ie)),Ie}function Wt(Se,Ie){var De=Se.data;if(Se.parentNode.tagName==="O:P")return Ie.insert(De.trim());if(De.trim().length===0&&Se.parentNode.classList.contains("ql-clipboard"))return Ie;if(!se(Se.parentNode).whiteSpace.startsWith("pre")){var Ve=function(gt,ft){return ft=ft.replace(/[^\u00a0]/g,""),ft.length<1&&gt?" ":ft};De=De.replace(/\r\n/g," ").replace(/\n/g," "),De=De.replace(/\s\s+/g,Ve.bind(Ve,!0)),(Se.previousSibling==null&&Q(Se.parentNode)||Se.previousSibling!=null&&Q(Se.previousSibling))&&(De=De.replace(/^\s+/,Ve.bind(Ve,!1))),(Se.nextSibling==null&&Q(Se.parentNode)||Se.nextSibling!=null&&Q(Se.nextSibling))&&(De=De.replace(/\s+$/,Ve.bind(Ve,!1)))}return Ie.insert(De)}n.default=Z,n.matchAttributor=ge,n.matchBlot=Ae,n.matchNewline=pt,n.matchSpacing=Et,n.matchText=Wt},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function E(x,w){for(var S=0;S<w.length;S++){var I=w[S];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(x,I.key,I)}}return function(x,w,S){return w&&E(x.prototype,w),S&&E(x,S),x}}(),o=function E(x,w,S){x===null&&(x=Function.prototype);var I=Object.getOwnPropertyDescriptor(x,w);if(I===void 0){var C=Object.getPrototypeOf(x);return C===null?void 0:E(C,w,S)}else{if("value"in I)return I.value;var N=I.get;return N===void 0?void 0:N.call(S)}},l=i(6),u=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function y(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var _=function(E){g(x,E);function x(){return m(this,x),y(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return s(x,[{key:"optimize",value:function(S){o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"optimize",this).call(this,S),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return o(x.__proto__||Object.getPrototypeOf(x),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),x}(u.default);_.blotName="bold",_.tagName=["STRONG","B"],n.default=_},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.addControls=n.default=void 0;var s=function(){function O(D,M){var $=[],G=!0,ie=!1,oe=void 0;try{for(var ee=D[Symbol.iterator](),J;!(G=(J=ee.next()).done)&&($.push(J.value),!(M&&$.length===M));G=!0);}catch(Y){ie=!0,oe=Y}finally{try{!G&&ee.return&&ee.return()}finally{if(ie)throw oe}}return $}return function(D,M){if(Array.isArray(D))return D;if(Symbol.iterator in Object(D))return O(D,M);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function O(D,M){for(var $=0;$<M.length;$++){var G=M[$];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(D,G.key,G)}}return function(D,M,$){return M&&O(D.prototype,M),$&&O(D,$),D}}(),l=i(2),u=S(l),f=i(0),m=S(f),y=i(5),g=S(y),_=i(10),E=S(_),x=i(9),w=S(x);function S(O){return O&&O.__esModule?O:{default:O}}function I(O,D,M){return D in O?Object.defineProperty(O,D,{value:M,enumerable:!0,configurable:!0,writable:!0}):O[D]=M,O}function C(O,D){if(!(O instanceof D))throw new TypeError("Cannot call a class as a function")}function N(O,D){if(!O)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D&&(typeof D=="object"||typeof D=="function")?D:O}function R(O,D){if(typeof D!="function"&&D!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof D);O.prototype=Object.create(D&&D.prototype,{constructor:{value:O,enumerable:!1,writable:!0,configurable:!0}}),D&&(Object.setPrototypeOf?Object.setPrototypeOf(O,D):O.__proto__=D)}var B=(0,E.default)("quill:toolbar"),P=function(O){R(D,O);function D(M,$){C(this,D);var G=N(this,(D.__proto__||Object.getPrototypeOf(D)).call(this,M,$));if(Array.isArray(G.options.container)){var ie=document.createElement("div");F(ie,G.options.container),M.container.parentNode.insertBefore(ie,M.container),G.container=ie}else typeof G.options.container=="string"?G.container=document.querySelector(G.options.container):G.container=G.options.container;if(!(G.container instanceof HTMLElement)){var oe;return oe=B.error("Container required for toolbar",G.options),N(G,oe)}return G.container.classList.add("ql-toolbar"),G.controls=[],G.handlers={},Object.keys(G.options.handlers).forEach(function(ee){G.addHandler(ee,G.options.handlers[ee])}),[].forEach.call(G.container.querySelectorAll("button, select"),function(ee){G.attach(ee)}),G.quill.on(g.default.events.EDITOR_CHANGE,function(ee,J){ee===g.default.events.SELECTION_CHANGE&&G.update(J)}),G.quill.on(g.default.events.SCROLL_OPTIMIZE,function(){var ee=G.quill.selection.getRange(),J=s(ee,1),Y=J[0];G.update(Y)}),G}return o(D,[{key:"addHandler",value:function($,G){this.handlers[$]=G}},{key:"attach",value:function($){var G=this,ie=[].find.call($.classList,function(ee){return ee.indexOf("ql-")===0});if(ie){if(ie=ie.slice(3),$.tagName==="BUTTON"&&$.setAttribute("type","button"),this.handlers[ie]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[ie]==null){B.warn("ignoring attaching to disabled format",ie,$);return}if(m.default.query(ie)==null){B.warn("ignoring attaching to nonexistent format",ie,$);return}}var oe=$.tagName==="SELECT"?"change":"click";$.addEventListener(oe,function(ee){var J=void 0;if($.tagName==="SELECT"){if($.selectedIndex<0)return;var Y=$.options[$.selectedIndex];Y.hasAttribute("selected")?J=!1:J=Y.value||!1}else $.classList.contains("ql-active")?J=!1:J=$.value||!$.hasAttribute("value"),ee.preventDefault();G.quill.focus();var q=G.quill.selection.getRange(),Z=s(q,1),ne=Z[0];if(G.handlers[ie]!=null)G.handlers[ie].call(G,J);else if(m.default.query(ie).prototype instanceof m.default.Embed){if(J=prompt("Enter "+ie),!J)return;G.quill.updateContents(new u.default().retain(ne.index).delete(ne.length).insert(I({},ie,J)),g.default.sources.USER)}else G.quill.format(ie,J,g.default.sources.USER);G.update(ne)}),this.controls.push([ie,$])}}},{key:"update",value:function($){var G=$==null?{}:this.quill.getFormat($);this.controls.forEach(function(ie){var oe=s(ie,2),ee=oe[0],J=oe[1];if(J.tagName==="SELECT"){var Y=void 0;if($==null)Y=null;else if(G[ee]==null)Y=J.querySelector("option[selected]");else if(!Array.isArray(G[ee])){var q=G[ee];typeof q=="string"&&(q=q.replace(/\"/g,'\\"')),Y=J.querySelector('option[value="'+q+'"]')}Y==null?(J.value="",J.selectedIndex=-1):Y.selected=!0}else if($==null)J.classList.remove("ql-active");else if(J.hasAttribute("value")){var Z=G[ee]===J.getAttribute("value")||G[ee]!=null&&G[ee].toString()===J.getAttribute("value")||G[ee]==null&&!J.getAttribute("value");J.classList.toggle("ql-active",Z)}else J.classList.toggle("ql-active",G[ee]!=null)})}}]),D}(w.default);P.DEFAULTS={};function k(O,D,M){var $=document.createElement("button");$.setAttribute("type","button"),$.classList.add("ql-"+D),M!=null&&($.value=M),O.appendChild($)}function F(O,D){Array.isArray(D[0])||(D=[D]),D.forEach(function(M){var $=document.createElement("span");$.classList.add("ql-formats"),M.forEach(function(G){if(typeof G=="string")k($,G);else{var ie=Object.keys(G)[0],oe=G[ie];Array.isArray(oe)?j($,ie,oe):k($,ie,oe)}}),O.appendChild($)})}function j(O,D,M){var $=document.createElement("select");$.classList.add("ql-"+D),M.forEach(function(G){var ie=document.createElement("option");G!==!1?ie.setAttribute("value",G):ie.setAttribute("selected","selected"),$.appendChild(ie)}),O.appendChild($)}P.DEFAULTS={container:null,handlers:{clean:function(){var D=this,M=this.quill.getSelection();if(M!=null)if(M.length==0){var $=this.quill.getFormat();Object.keys($).forEach(function(G){m.default.query(G,m.default.Scope.INLINE)!=null&&D.quill.format(G,!1)})}else this.quill.removeFormat(M,g.default.sources.USER)},direction:function(D){var M=this.quill.getFormat().align;D==="rtl"&&M==null?this.quill.format("align","right",g.default.sources.USER):!D&&M==="right"&&this.quill.format("align",!1,g.default.sources.USER),this.quill.format("direction",D,g.default.sources.USER)},indent:function(D){var M=this.quill.getSelection(),$=this.quill.getFormat(M),G=parseInt($.indent||0);if(D==="+1"||D==="-1"){var ie=D==="+1"?1:-1;$.direction==="rtl"&&(ie*=-1),this.quill.format("indent",G+ie,g.default.sources.USER)}},link:function(D){D===!0&&(D=prompt("Enter link URL:")),this.quill.format("link",D,g.default.sources.USER)},list:function(D){var M=this.quill.getSelection(),$=this.quill.getFormat(M);D==="check"?$.list==="checked"||$.list==="unchecked"?this.quill.format("list",!1,g.default.sources.USER):this.quill.format("list","unchecked",g.default.sources.USER):this.quill.format("list",D,g.default.sources.USER)}}},n.default=P,n.addControls=F},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function E(x,w){for(var S=0;S<w.length;S++){var I=w[S];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(x,I.key,I)}}return function(x,w,S){return w&&E(x.prototype,w),S&&E(x,S),x}}(),o=function E(x,w,S){x===null&&(x=Function.prototype);var I=Object.getOwnPropertyDescriptor(x,w);if(I===void 0){var C=Object.getPrototypeOf(x);return C===null?void 0:E(C,w,S)}else{if("value"in I)return I.value;var N=I.get;return N===void 0?void 0:N.call(S)}},l=i(28),u=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function y(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var _=function(E){g(x,E);function x(w,S){m(this,x);var I=y(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,w));return I.label.innerHTML=S,I.container.classList.add("ql-color-picker"),[].slice.call(I.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(C){C.classList.add("ql-primary")}),I}return s(x,[{key:"buildItem",value:function(S){var I=o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"buildItem",this).call(this,S);return I.style.backgroundColor=S.getAttribute("value")||"",I}},{key:"selectItem",value:function(S,I){o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"selectItem",this).call(this,S,I);var C=this.label.querySelector(".ql-color-label"),N=S&&S.getAttribute("data-value")||"";C&&(C.tagName==="line"?C.style.stroke=N:C.style.fill=N)}}]),x}(u.default);n.default=_},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function E(x,w){for(var S=0;S<w.length;S++){var I=w[S];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(x,I.key,I)}}return function(x,w,S){return w&&E(x.prototype,w),S&&E(x,S),x}}(),o=function E(x,w,S){x===null&&(x=Function.prototype);var I=Object.getOwnPropertyDescriptor(x,w);if(I===void 0){var C=Object.getPrototypeOf(x);return C===null?void 0:E(C,w,S)}else{if("value"in I)return I.value;var N=I.get;return N===void 0?void 0:N.call(S)}},l=i(28),u=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function y(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var _=function(E){g(x,E);function x(w,S){m(this,x);var I=y(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,w));return I.container.classList.add("ql-icon-picker"),[].forEach.call(I.container.querySelectorAll(".ql-picker-item"),function(C){C.innerHTML=S[C.getAttribute("data-value")||""]}),I.defaultItem=I.container.querySelector(".ql-selected"),I.selectItem(I.defaultItem),I}return s(x,[{key:"selectItem",value:function(S,I){o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"selectItem",this).call(this,S,I),S=S||this.defaultItem,this.label.innerHTML=S.innerHTML}}]),x}(u.default);n.default=_},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function u(f,m){for(var y=0;y<m.length;y++){var g=m[y];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(f,m,y){return m&&u(f.prototype,m),y&&u(f,y),f}}();function o(u,f){if(!(u instanceof f))throw new TypeError("Cannot call a class as a function")}var l=function(){function u(f,m){var y=this;o(this,u),this.quill=f,this.boundsContainer=m||document.body,this.root=f.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){y.root.style.marginTop=-1*y.quill.root.scrollTop+"px"}),this.hide()}return s(u,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(m){var y=m.left+m.width/2-this.root.offsetWidth/2,g=m.bottom+this.quill.root.scrollTop;this.root.style.left=y+"px",this.root.style.top=g+"px",this.root.classList.remove("ql-flip");var _=this.boundsContainer.getBoundingClientRect(),E=this.root.getBoundingClientRect(),x=0;if(E.right>_.right&&(x=_.right-E.right,this.root.style.left=y+x+"px"),E.left<_.left&&(x=_.left-E.left,this.root.style.left=y+x+"px"),E.bottom>_.bottom){var w=E.bottom-E.top,S=m.bottom-m.top+w;this.root.style.top=g-S+"px",this.root.classList.add("ql-flip")}return x}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),u}();n.default=l},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function j(O,D){var M=[],$=!0,G=!1,ie=void 0;try{for(var oe=O[Symbol.iterator](),ee;!($=(ee=oe.next()).done)&&(M.push(ee.value),!(D&&M.length===D));$=!0);}catch(J){G=!0,ie=J}finally{try{!$&&oe.return&&oe.return()}finally{if(G)throw ie}}return M}return function(O,D){if(Array.isArray(O))return O;if(Symbol.iterator in Object(O))return j(O,D);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function j(O,D,M){O===null&&(O=Function.prototype);var $=Object.getOwnPropertyDescriptor(O,D);if($===void 0){var G=Object.getPrototypeOf(O);return G===null?void 0:j(G,D,M)}else{if("value"in $)return $.value;var ie=$.get;return ie===void 0?void 0:ie.call(M)}},l=function(){function j(O,D){for(var M=0;M<D.length;M++){var $=D[M];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(O,$.key,$)}}return function(O,D,M){return D&&j(O.prototype,D),M&&j(O,M),O}}(),u=i(3),f=C(u),m=i(8),y=C(m),g=i(43),_=C(g),E=i(27),x=C(E),w=i(15),S=i(41),I=C(S);function C(j){return j&&j.__esModule?j:{default:j}}function N(j,O){if(!(j instanceof O))throw new TypeError("Cannot call a class as a function")}function R(j,O){if(!j)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return O&&(typeof O=="object"||typeof O=="function")?O:j}function B(j,O){if(typeof O!="function"&&O!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof O);j.prototype=Object.create(O&&O.prototype,{constructor:{value:j,enumerable:!1,writable:!0,configurable:!0}}),O&&(Object.setPrototypeOf?Object.setPrototypeOf(j,O):j.__proto__=O)}var P=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],k=function(j){B(O,j);function O(D,M){N(this,O),M.modules.toolbar!=null&&M.modules.toolbar.container==null&&(M.modules.toolbar.container=P);var $=R(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,D,M));return $.quill.container.classList.add("ql-snow"),$}return l(O,[{key:"extendToolbar",value:function(M){M.container.classList.add("ql-snow"),this.buildButtons([].slice.call(M.container.querySelectorAll("button")),I.default),this.buildPickers([].slice.call(M.container.querySelectorAll("select")),I.default),this.tooltip=new F(this.quill,this.options.bounds),M.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function($,G){M.handlers.link.call(M,!G.format.link)})}}]),O}(_.default);k.DEFAULTS=(0,f.default)(!0,{},_.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(O){if(O){var D=this.quill.getSelection();if(D==null||D.length==0)return;var M=this.quill.getText(D);/^\S+@\S+\.\S+$/.test(M)&&M.indexOf("mailto:")!==0&&(M="mailto:"+M);var $=this.quill.theme.tooltip;$.edit("link",M)}else this.quill.format("link",!1)}}}}});var F=function(j){B(O,j);function O(D,M){N(this,O);var $=R(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,D,M));return $.preview=$.root.querySelector("a.ql-preview"),$}return l(O,[{key:"listen",value:function(){var M=this;o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function($){M.root.classList.contains("ql-editing")?M.save():M.edit("link",M.preview.textContent),$.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function($){if(M.linkRange!=null){var G=M.linkRange;M.restoreFocus(),M.quill.formatText(G,"link",!1,y.default.sources.USER),delete M.linkRange}$.preventDefault(),M.hide()}),this.quill.on(y.default.events.SELECTION_CHANGE,function($,G,ie){if($!=null){if($.length===0&&ie===y.default.sources.USER){var oe=M.quill.scroll.descendant(x.default,$.index),ee=s(oe,2),J=ee[0],Y=ee[1];if(J!=null){M.linkRange=new w.Range($.index-Y,J.length());var q=x.default.formats(J.domNode);M.preview.textContent=q,M.preview.setAttribute("href",q),M.show(),M.position(M.quill.getBounds(M.linkRange));return}}else delete M.linkRange;M.hide()}})}},{key:"show",value:function(){o(O.prototype.__proto__||Object.getPrototypeOf(O.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),O}(g.BaseTooltip);F.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),n.default=k},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(29),o=ke(s),l=i(36),u=i(38),f=i(64),m=i(65),y=ke(m),g=i(66),_=ke(g),E=i(67),x=ke(E),w=i(37),S=i(26),I=i(39),C=i(40),N=i(56),R=ke(N),B=i(68),P=ke(B),k=i(27),F=ke(k),j=i(69),O=ke(j),D=i(70),M=ke(D),$=i(71),G=ke($),ie=i(72),oe=ke(ie),ee=i(73),J=ke(ee),Y=i(13),q=ke(Y),Z=i(74),ne=ke(Z),se=i(75),le=ke(se),Q=i(57),ce=ke(Q),me=i(41),ge=ke(me),Ae=i(28),Ue=ke(Ae),nt=i(59),et=ke(nt),pt=i(60),Et=ke(pt),_n=i(61),Wt=ke(_n),Se=i(108),Ie=ke(Se),De=i(62),Ve=ke(De);function ke(gt){return gt&&gt.__esModule?gt:{default:gt}}o.default.register({"attributors/attribute/direction":u.DirectionAttribute,"attributors/class/align":l.AlignClass,"attributors/class/background":w.BackgroundClass,"attributors/class/color":S.ColorClass,"attributors/class/direction":u.DirectionClass,"attributors/class/font":I.FontClass,"attributors/class/size":C.SizeClass,"attributors/style/align":l.AlignStyle,"attributors/style/background":w.BackgroundStyle,"attributors/style/color":S.ColorStyle,"attributors/style/direction":u.DirectionStyle,"attributors/style/font":I.FontStyle,"attributors/style/size":C.SizeStyle},!0),o.default.register({"formats/align":l.AlignClass,"formats/direction":u.DirectionClass,"formats/indent":f.IndentClass,"formats/background":w.BackgroundStyle,"formats/color":S.ColorStyle,"formats/font":I.FontClass,"formats/size":C.SizeClass,"formats/blockquote":y.default,"formats/code-block":q.default,"formats/header":_.default,"formats/list":x.default,"formats/bold":R.default,"formats/code":Y.Code,"formats/italic":P.default,"formats/link":F.default,"formats/script":O.default,"formats/strike":M.default,"formats/underline":G.default,"formats/image":oe.default,"formats/video":J.default,"formats/list/item":E.ListItem,"modules/formula":ne.default,"modules/syntax":le.default,"modules/toolbar":ce.default,"themes/bubble":Ie.default,"themes/snow":Ve.default,"ui/icons":ge.default,"ui/picker":Ue.default,"ui/icon-picker":Et.default,"ui/color-picker":et.default,"ui/tooltip":Wt.default},!0),n.default=o.default},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.IndentClass=void 0;var s=function(){function x(w,S){for(var I=0;I<S.length;I++){var C=S[I];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(w,C.key,C)}}return function(w,S,I){return S&&x(w.prototype,S),I&&x(w,I),w}}(),o=function x(w,S,I){w===null&&(w=Function.prototype);var C=Object.getOwnPropertyDescriptor(w,S);if(C===void 0){var N=Object.getPrototypeOf(w);return N===null?void 0:x(N,S,I)}else{if("value"in C)return C.value;var R=C.get;return R===void 0?void 0:R.call(I)}},l=i(0),u=f(l);function f(x){return x&&x.__esModule?x:{default:x}}function m(x,w){if(!(x instanceof w))throw new TypeError("Cannot call a class as a function")}function y(x,w){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return w&&(typeof w=="object"||typeof w=="function")?w:x}function g(x,w){if(typeof w!="function"&&w!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof w);x.prototype=Object.create(w&&w.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),w&&(Object.setPrototypeOf?Object.setPrototypeOf(x,w):x.__proto__=w)}var _=function(x){g(w,x);function w(){return m(this,w),y(this,(w.__proto__||Object.getPrototypeOf(w)).apply(this,arguments))}return s(w,[{key:"add",value:function(I,C){if(C==="+1"||C==="-1"){var N=this.value(I)||0;C=C==="+1"?N+1:N-1}return C===0?(this.remove(I),!0):o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"add",this).call(this,I,C)}},{key:"canAdd",value:function(I,C){return o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"canAdd",this).call(this,I,C)||o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"canAdd",this).call(this,I,parseInt(C))}},{key:"value",value:function(I){return parseInt(o(w.prototype.__proto__||Object.getPrototypeOf(w.prototype),"value",this).call(this,I))||void 0}}]),w}(u.default.Attributor.Class),E=new _("indent","ql-indent",{scope:u.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});n.IndentClass=E},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(4),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}function u(g,_){if(!(g instanceof _))throw new TypeError("Cannot call a class as a function")}function f(g,_){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:g}function m(g,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);g.prototype=Object.create(_&&_.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(g,_):g.__proto__=_)}var y=function(g){m(_,g);function _(){return u(this,_),f(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return _}(o.default);y.blotName="blockquote",y.tagName="blockquote",n.default=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function _(E,x){for(var w=0;w<x.length;w++){var S=x[w];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(E,S.key,S)}}return function(E,x,w){return x&&_(E.prototype,x),w&&_(E,w),E}}(),o=i(4),l=u(o);function u(_){return _&&_.__esModule?_:{default:_}}function f(_,E){if(!(_ instanceof E))throw new TypeError("Cannot call a class as a function")}function m(_,E){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&(typeof E=="object"||typeof E=="function")?E:_}function y(_,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);_.prototype=Object.create(E&&E.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(_,E):_.__proto__=E)}var g=function(_){y(E,_);function E(){return f(this,E),m(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return s(E,null,[{key:"formats",value:function(w){return this.tagName.indexOf(w.tagName)+1}}]),E}(l.default);g.blotName="header",g.tagName=["H1","H2","H3","H4","H5","H6"],n.default=g},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.ListItem=void 0;var s=function(){function N(R,B){for(var P=0;P<B.length;P++){var k=B[P];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(R,k.key,k)}}return function(R,B,P){return B&&N(R.prototype,B),P&&N(R,P),R}}(),o=function N(R,B,P){R===null&&(R=Function.prototype);var k=Object.getOwnPropertyDescriptor(R,B);if(k===void 0){var F=Object.getPrototypeOf(R);return F===null?void 0:N(F,B,P)}else{if("value"in k)return k.value;var j=k.get;return j===void 0?void 0:j.call(P)}},l=i(0),u=_(l),f=i(4),m=_(f),y=i(25),g=_(y);function _(N){return N&&N.__esModule?N:{default:N}}function E(N,R,B){return R in N?Object.defineProperty(N,R,{value:B,enumerable:!0,configurable:!0,writable:!0}):N[R]=B,N}function x(N,R){if(!(N instanceof R))throw new TypeError("Cannot call a class as a function")}function w(N,R){if(!N)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R&&(typeof R=="object"||typeof R=="function")?R:N}function S(N,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof R);N.prototype=Object.create(R&&R.prototype,{constructor:{value:N,enumerable:!1,writable:!0,configurable:!0}}),R&&(Object.setPrototypeOf?Object.setPrototypeOf(N,R):N.__proto__=R)}var I=function(N){S(R,N);function R(){return x(this,R),w(this,(R.__proto__||Object.getPrototypeOf(R)).apply(this,arguments))}return s(R,[{key:"format",value:function(P,k){P===C.blotName&&!k?this.replaceWith(u.default.create(this.statics.scope)):o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"format",this).call(this,P,k)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(P,k){return this.parent.isolate(this.offset(this.parent),this.length()),P===this.parent.statics.blotName?(this.parent.replaceWith(P,k),this):(this.parent.unwrap(),o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"replaceWith",this).call(this,P,k))}}],[{key:"formats",value:function(P){return P.tagName===this.tagName?void 0:o(R.__proto__||Object.getPrototypeOf(R),"formats",this).call(this,P)}}]),R}(m.default);I.blotName="list-item",I.tagName="LI";var C=function(N){S(R,N),s(R,null,[{key:"create",value:function(P){var k=P==="ordered"?"OL":"UL",F=o(R.__proto__||Object.getPrototypeOf(R),"create",this).call(this,k);return(P==="checked"||P==="unchecked")&&F.setAttribute("data-checked",P==="checked"),F}},{key:"formats",value:function(P){if(P.tagName==="OL")return"ordered";if(P.tagName==="UL")return P.hasAttribute("data-checked")?P.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function R(B){x(this,R);var P=w(this,(R.__proto__||Object.getPrototypeOf(R)).call(this,B)),k=function(j){if(j.target.parentNode===B){var O=P.statics.formats(B),D=u.default.find(j.target);O==="checked"?D.format("list","unchecked"):O==="unchecked"&&D.format("list","checked")}};return B.addEventListener("touchstart",k),B.addEventListener("mousedown",k),P}return s(R,[{key:"format",value:function(P,k){this.children.length>0&&this.children.tail.format(P,k)}},{key:"formats",value:function(){return E({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(P,k){if(P instanceof I)o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"insertBefore",this).call(this,P,k);else{var F=k==null?this.length():k.offset(this),j=this.split(F);j.parent.insertBefore(P,j)}}},{key:"optimize",value:function(P){o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"optimize",this).call(this,P);var k=this.next;k!=null&&k.prev===this&&k.statics.blotName===this.statics.blotName&&k.domNode.tagName===this.domNode.tagName&&k.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(k.moveChildren(this),k.remove())}},{key:"replace",value:function(P){if(P.statics.blotName!==this.statics.blotName){var k=u.default.create(this.statics.defaultChild);P.moveChildren(k),this.appendChild(k)}o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"replace",this).call(this,P)}}]),R}(g.default);C.blotName="list",C.scope=u.default.Scope.BLOCK_BLOT,C.tagName=["OL","UL"],C.defaultChild="list-item",C.allowedChildren=[I],n.ListItem=I,n.default=C},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(56),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}function u(g,_){if(!(g instanceof _))throw new TypeError("Cannot call a class as a function")}function f(g,_){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:g}function m(g,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);g.prototype=Object.create(_&&_.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(g,_):g.__proto__=_)}var y=function(g){m(_,g);function _(){return u(this,_),f(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return _}(o.default);y.blotName="italic",y.tagName=["EM","I"],n.default=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function E(x,w){for(var S=0;S<w.length;S++){var I=w[S];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(x,I.key,I)}}return function(x,w,S){return w&&E(x.prototype,w),S&&E(x,S),x}}(),o=function E(x,w,S){x===null&&(x=Function.prototype);var I=Object.getOwnPropertyDescriptor(x,w);if(I===void 0){var C=Object.getPrototypeOf(x);return C===null?void 0:E(C,w,S)}else{if("value"in I)return I.value;var N=I.get;return N===void 0?void 0:N.call(S)}},l=i(6),u=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function y(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var _=function(E){g(x,E);function x(){return m(this,x),y(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return s(x,null,[{key:"create",value:function(S){return S==="super"?document.createElement("sup"):S==="sub"?document.createElement("sub"):o(x.__proto__||Object.getPrototypeOf(x),"create",this).call(this,S)}},{key:"formats",value:function(S){if(S.tagName==="SUB")return"sub";if(S.tagName==="SUP")return"super"}}]),x}(u.default);_.blotName="script",_.tagName=["SUB","SUP"],n.default=_},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(6),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}function u(g,_){if(!(g instanceof _))throw new TypeError("Cannot call a class as a function")}function f(g,_){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:g}function m(g,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);g.prototype=Object.create(_&&_.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(g,_):g.__proto__=_)}var y=function(g){m(_,g);function _(){return u(this,_),f(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return _}(o.default);y.blotName="strike",y.tagName="S",n.default=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(6),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}function u(g,_){if(!(g instanceof _))throw new TypeError("Cannot call a class as a function")}function f(g,_){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:g}function m(g,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);g.prototype=Object.create(_&&_.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(g,_):g.__proto__=_)}var y=function(g){m(_,g);function _(){return u(this,_),f(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return _}(o.default);y.blotName="underline",y.tagName="U",n.default=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function w(S,I){for(var C=0;C<I.length;C++){var N=I[C];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(S,N.key,N)}}return function(S,I,C){return I&&w(S.prototype,I),C&&w(S,C),S}}(),o=function w(S,I,C){S===null&&(S=Function.prototype);var N=Object.getOwnPropertyDescriptor(S,I);if(N===void 0){var R=Object.getPrototypeOf(S);return R===null?void 0:w(R,I,C)}else{if("value"in N)return N.value;var B=N.get;return B===void 0?void 0:B.call(C)}},l=i(0),u=m(l),f=i(27);function m(w){return w&&w.__esModule?w:{default:w}}function y(w,S){if(!(w instanceof S))throw new TypeError("Cannot call a class as a function")}function g(w,S){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:w}function _(w,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);w.prototype=Object.create(S&&S.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(w,S):w.__proto__=S)}var E=["alt","height","width"],x=function(w){_(S,w);function S(){return y(this,S),g(this,(S.__proto__||Object.getPrototypeOf(S)).apply(this,arguments))}return s(S,[{key:"format",value:function(C,N){E.indexOf(C)>-1?N?this.domNode.setAttribute(C,N):this.domNode.removeAttribute(C):o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"format",this).call(this,C,N)}}],[{key:"create",value:function(C){var N=o(S.__proto__||Object.getPrototypeOf(S),"create",this).call(this,C);return typeof C=="string"&&N.setAttribute("src",this.sanitize(C)),N}},{key:"formats",value:function(C){return E.reduce(function(N,R){return C.hasAttribute(R)&&(N[R]=C.getAttribute(R)),N},{})}},{key:"match",value:function(C){return/\.(jpe?g|gif|png)$/.test(C)||/^data:image\/.+;base64/.test(C)}},{key:"sanitize",value:function(C){return(0,f.sanitize)(C,["http","https","data"])?C:"//:0"}},{key:"value",value:function(C){return C.getAttribute("src")}}]),S}(u.default.Embed);x.blotName="image",x.tagName="IMG",n.default=x},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function w(S,I){for(var C=0;C<I.length;C++){var N=I[C];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(S,N.key,N)}}return function(S,I,C){return I&&w(S.prototype,I),C&&w(S,C),S}}(),o=function w(S,I,C){S===null&&(S=Function.prototype);var N=Object.getOwnPropertyDescriptor(S,I);if(N===void 0){var R=Object.getPrototypeOf(S);return R===null?void 0:w(R,I,C)}else{if("value"in N)return N.value;var B=N.get;return B===void 0?void 0:B.call(C)}},l=i(4),u=i(27),f=m(u);function m(w){return w&&w.__esModule?w:{default:w}}function y(w,S){if(!(w instanceof S))throw new TypeError("Cannot call a class as a function")}function g(w,S){if(!w)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return S&&(typeof S=="object"||typeof S=="function")?S:w}function _(w,S){if(typeof S!="function"&&S!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof S);w.prototype=Object.create(S&&S.prototype,{constructor:{value:w,enumerable:!1,writable:!0,configurable:!0}}),S&&(Object.setPrototypeOf?Object.setPrototypeOf(w,S):w.__proto__=S)}var E=["height","width"],x=function(w){_(S,w);function S(){return y(this,S),g(this,(S.__proto__||Object.getPrototypeOf(S)).apply(this,arguments))}return s(S,[{key:"format",value:function(C,N){E.indexOf(C)>-1?N?this.domNode.setAttribute(C,N):this.domNode.removeAttribute(C):o(S.prototype.__proto__||Object.getPrototypeOf(S.prototype),"format",this).call(this,C,N)}}],[{key:"create",value:function(C){var N=o(S.__proto__||Object.getPrototypeOf(S),"create",this).call(this,C);return N.setAttribute("frameborder","0"),N.setAttribute("allowfullscreen",!0),N.setAttribute("src",this.sanitize(C)),N}},{key:"formats",value:function(C){return E.reduce(function(N,R){return C.hasAttribute(R)&&(N[R]=C.getAttribute(R)),N},{})}},{key:"sanitize",value:function(C){return f.default.sanitize(C)}},{key:"value",value:function(C){return C.getAttribute("src")}}]),S}(l.BlockEmbed);x.blotName="video",x.className="ql-video",x.tagName="IFRAME",n.default=x},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.FormulaBlot=void 0;var s=function(){function C(N,R){for(var B=0;B<R.length;B++){var P=R[B];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(N,P.key,P)}}return function(N,R,B){return R&&C(N.prototype,R),B&&C(N,B),N}}(),o=function C(N,R,B){N===null&&(N=Function.prototype);var P=Object.getOwnPropertyDescriptor(N,R);if(P===void 0){var k=Object.getPrototypeOf(N);return k===null?void 0:C(k,R,B)}else{if("value"in P)return P.value;var F=P.get;return F===void 0?void 0:F.call(B)}},l=i(35),u=_(l),f=i(5),m=_(f),y=i(9),g=_(y);function _(C){return C&&C.__esModule?C:{default:C}}function E(C,N){if(!(C instanceof N))throw new TypeError("Cannot call a class as a function")}function x(C,N){if(!C)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:C}function w(C,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);C.prototype=Object.create(N&&N.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(C,N):C.__proto__=N)}var S=function(C){w(N,C);function N(){return E(this,N),x(this,(N.__proto__||Object.getPrototypeOf(N)).apply(this,arguments))}return s(N,null,[{key:"create",value:function(B){var P=o(N.__proto__||Object.getPrototypeOf(N),"create",this).call(this,B);return typeof B=="string"&&(window.katex.render(B,P,{throwOnError:!1,errorColor:"#f00"}),P.setAttribute("data-value",B)),P}},{key:"value",value:function(B){return B.getAttribute("data-value")}}]),N}(u.default);S.blotName="formula",S.className="ql-formula",S.tagName="SPAN";var I=function(C){w(N,C),s(N,null,[{key:"register",value:function(){m.default.register(S,!0)}}]);function N(){E(this,N);var R=x(this,(N.__proto__||Object.getPrototypeOf(N)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return R}return N}(g.default);n.FormulaBlot=S,n.default=I},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.CodeToken=n.CodeBlock=void 0;var s=function(){function B(P,k){for(var F=0;F<k.length;F++){var j=k[F];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(P,j.key,j)}}return function(P,k,F){return k&&B(P.prototype,k),F&&B(P,F),P}}(),o=function B(P,k,F){P===null&&(P=Function.prototype);var j=Object.getOwnPropertyDescriptor(P,k);if(j===void 0){var O=Object.getPrototypeOf(P);return O===null?void 0:B(O,k,F)}else{if("value"in j)return j.value;var D=j.get;return D===void 0?void 0:D.call(F)}},l=i(0),u=x(l),f=i(5),m=x(f),y=i(9),g=x(y),_=i(13),E=x(_);function x(B){return B&&B.__esModule?B:{default:B}}function w(B,P){if(!(B instanceof P))throw new TypeError("Cannot call a class as a function")}function S(B,P){if(!B)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P&&(typeof P=="object"||typeof P=="function")?P:B}function I(B,P){if(typeof P!="function"&&P!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof P);B.prototype=Object.create(P&&P.prototype,{constructor:{value:B,enumerable:!1,writable:!0,configurable:!0}}),P&&(Object.setPrototypeOf?Object.setPrototypeOf(B,P):B.__proto__=P)}var C=function(B){I(P,B);function P(){return w(this,P),S(this,(P.__proto__||Object.getPrototypeOf(P)).apply(this,arguments))}return s(P,[{key:"replaceWith",value:function(F){this.domNode.textContent=this.domNode.textContent,this.attach(),o(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"replaceWith",this).call(this,F)}},{key:"highlight",value:function(F){var j=this.domNode.textContent;this.cachedText!==j&&((j.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=F(j),this.domNode.normalize(),this.attach()),this.cachedText=j)}}]),P}(E.default);C.className="ql-syntax";var N=new u.default.Attributor.Class("token","hljs",{scope:u.default.Scope.INLINE}),R=function(B){I(P,B),s(P,null,[{key:"register",value:function(){m.default.register(N,!0),m.default.register(C,!0)}}]);function P(k,F){w(this,P);var j=S(this,(P.__proto__||Object.getPrototypeOf(P)).call(this,k,F));if(typeof j.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var O=null;return j.quill.on(m.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(O),O=setTimeout(function(){j.highlight(),O=null},j.options.interval)}),j.highlight(),j}return s(P,[{key:"highlight",value:function(){var F=this;if(!this.quill.selection.composing){this.quill.update(m.default.sources.USER);var j=this.quill.getSelection();this.quill.scroll.descendants(C).forEach(function(O){O.highlight(F.options.highlight)}),this.quill.update(m.default.sources.SILENT),j!=null&&this.quill.setSelection(j,m.default.sources.SILENT)}}}]),P}(g.default);R.DEFAULTS={highlight:function(){return window.hljs==null?null:function(B){var P=window.hljs.highlightAuto(B);return P.value}}(),interval:1e3},n.CodeBlock=C,n.CodeToken=N,n.default=R},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(t,n){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(t,n){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(t,n){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(t,n){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BubbleTooltip=void 0;var s=function P(k,F,j){k===null&&(k=Function.prototype);var O=Object.getOwnPropertyDescriptor(k,F);if(O===void 0){var D=Object.getPrototypeOf(k);return D===null?void 0:P(D,F,j)}else{if("value"in O)return O.value;var M=O.get;return M===void 0?void 0:M.call(j)}},o=function(){function P(k,F){for(var j=0;j<F.length;j++){var O=F[j];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(k,O.key,O)}}return function(k,F,j){return F&&P(k.prototype,F),j&&P(k,j),k}}(),l=i(3),u=w(l),f=i(8),m=w(f),y=i(43),g=w(y),_=i(15),E=i(41),x=w(E);function w(P){return P&&P.__esModule?P:{default:P}}function S(P,k){if(!(P instanceof k))throw new TypeError("Cannot call a class as a function")}function I(P,k){if(!P)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k&&(typeof k=="object"||typeof k=="function")?k:P}function C(P,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof k);P.prototype=Object.create(k&&k.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),k&&(Object.setPrototypeOf?Object.setPrototypeOf(P,k):P.__proto__=k)}var N=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],R=function(P){C(k,P);function k(F,j){S(this,k),j.modules.toolbar!=null&&j.modules.toolbar.container==null&&(j.modules.toolbar.container=N);var O=I(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,F,j));return O.quill.container.classList.add("ql-bubble"),O}return o(k,[{key:"extendToolbar",value:function(j){this.tooltip=new B(this.quill,this.options.bounds),this.tooltip.root.appendChild(j.container),this.buildButtons([].slice.call(j.container.querySelectorAll("button")),x.default),this.buildPickers([].slice.call(j.container.querySelectorAll("select")),x.default)}}]),k}(g.default);R.DEFAULTS=(0,u.default)(!0,{},g.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(k){k?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var B=function(P){C(k,P);function k(F,j){S(this,k);var O=I(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,F,j));return O.quill.on(m.default.events.EDITOR_CHANGE,function(D,M,$,G){if(D===m.default.events.SELECTION_CHANGE)if(M!=null&&M.length>0&&G===m.default.sources.USER){O.show(),O.root.style.left="0px",O.root.style.width="",O.root.style.width=O.root.offsetWidth+"px";var ie=O.quill.getLines(M.index,M.length);if(ie.length===1)O.position(O.quill.getBounds(M));else{var oe=ie[ie.length-1],ee=O.quill.getIndex(oe),J=Math.min(oe.length()-1,M.index+M.length-ee),Y=O.quill.getBounds(new _.Range(ee,J));O.position(Y)}}else document.activeElement!==O.textbox&&O.quill.hasFocus()&&O.hide()}),O}return o(k,[{key:"listen",value:function(){var j=this;s(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){j.root.classList.remove("ql-editing")}),this.quill.on(m.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!j.root.classList.contains("ql-hidden")){var O=j.quill.getSelection();O!=null&&j.position(j.quill.getBounds(O))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(j){var O=s(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"position",this).call(this,j),D=this.root.querySelector(".ql-tooltip-arrow");if(D.style.marginLeft="",O===0)return O;D.style.marginLeft=-1*O-D.offsetWidth/2+"px"}}]),k}(y.BaseTooltip);B.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),n.BubbleTooltip=B,n.default=R},function(t,n,i){t.exports=i(63)}]).default})}(Sg)),Sg.exports}var to,s4;function A$(){if(s4)return to;s4=1;var r=to&&to.__extends||function(){var m=function(y,g){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,E){_.__proto__=E}||function(_,E){for(var x in E)E.hasOwnProperty(x)&&(_[x]=E[x])},m(y,g)};return function(y,g){m(y,g);function _(){this.constructor=y}y.prototype=g===null?Object.create(g):(_.prototype=g.prototype,new _)}}(),e=to&&to.__assign||function(){return e=Object.assign||function(m){for(var y,g=1,_=arguments.length;g<_;g++){y=arguments[g];for(var E in y)Object.prototype.hasOwnProperty.call(y,E)&&(m[E]=y[E])}return m},e.apply(this,arguments)},t=to&&to.__spreadArrays||function(){for(var m=0,y=0,g=arguments.length;y<g;y++)m+=arguments[y].length;for(var _=Array(m),E=0,y=0;y<g;y++)for(var x=arguments[y],w=0,S=x.length;w<S;w++,E++)_[E]=x[w];return _},n=to&&to.__importDefault||function(m){return m&&m.__esModule?m:{default:m}},i=n(xy()),s=n(Zx()),o=n(E$()),l=n(S$()),u=function(m){r(y,m);function y(g){var _=m.call(this,g)||this;_.dirtyProps=["modules","formats","bounds","theme","children"],_.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],_.state={generation:0},_.selection=null,_.onEditorChange=function(x,w,S,I){var C,N,R,B;x==="text-change"?(N=(C=_).onEditorChangeText)===null||N===void 0||N.call(C,_.editor.root.innerHTML,w,I,_.unprivilegedEditor):x==="selection-change"&&((B=(R=_).onEditorChangeSelection)===null||B===void 0||B.call(R,w,I,_.unprivilegedEditor))};var E=_.isControlled()?g.value:g.defaultValue;return _.value=E??"",_}return y.prototype.validateProps=function(g){var _;if(i.default.Children.count(g.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(i.default.Children.count(g.children)){var E=i.default.Children.only(g.children);if(((_=E)===null||_===void 0?void 0:_.type)==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.")}if(this.lastDeltaChangeSet&&g.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")},y.prototype.shouldComponentUpdate=function(g,_){var E=this,x;if(this.validateProps(g),!this.editor||this.state.generation!==_.generation)return!0;if("value"in g){var w=this.getEditorContents(),S=(x=g.value,x??"");this.isEqualValue(S,w)||this.setEditorContents(this.editor,S)}return g.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,g.readOnly),t(this.cleanProps,this.dirtyProps).some(function(I){return!o.default(g[I],E.props[I])})},y.prototype.shouldComponentRegenerate=function(g){var _=this;return this.dirtyProps.some(function(E){return!o.default(g[E],_.props[E])})},y.prototype.componentDidMount=function(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())},y.prototype.componentWillUnmount=function(){this.destroyEditor()},y.prototype.componentDidUpdate=function(g,_){var E=this;if(this.editor&&this.shouldComponentRegenerate(g)){var x=this.editor.getContents(),w=this.editor.getSelection();this.regenerationSnapshot={delta:x,selection:w},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.state.generation!==_.generation){var S=this.regenerationSnapshot,x=S.delta,I=S.selection;delete this.regenerationSnapshot,this.instantiateEditor();var C=this.editor;C.setContents(x),f(function(){return E.setEditorSelection(C,I)})}},y.prototype.instantiateEditor=function(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())},y.prototype.destroyEditor=function(){this.editor&&this.unhookEditor(this.editor)},y.prototype.isControlled=function(){return"value"in this.props},y.prototype.getEditorConfig=function(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,scrollingContainer:this.props.scrollingContainer,tabIndex:this.props.tabIndex,theme:this.props.theme}},y.prototype.getEditor=function(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor},y.prototype.createEditor=function(g,_){var E=new l.default(g,_);return _.tabIndex!=null&&this.setEditorTabIndex(E,_.tabIndex),this.hookEditor(E),E},y.prototype.hookEditor=function(g){this.unprivilegedEditor=this.makeUnprivilegedEditor(g),g.on("editor-change",this.onEditorChange)},y.prototype.unhookEditor=function(g){g.off("editor-change",this.onEditorChange)},y.prototype.getEditorContents=function(){return this.value},y.prototype.getEditorSelection=function(){return this.selection},y.prototype.isDelta=function(g){return g&&g.ops},y.prototype.isEqualValue=function(g,_){return this.isDelta(g)&&this.isDelta(_)?o.default(g.ops,_.ops):o.default(g,_)},y.prototype.setEditorContents=function(g,_){var E=this;this.value=_;var x=this.getEditorSelection();typeof _=="string"?g.setContents(g.clipboard.convert(_)):g.setContents(_),f(function(){return E.setEditorSelection(g,x)})},y.prototype.setEditorSelection=function(g,_){if(this.selection=_,_){var E=g.getLength();_.index=Math.max(0,Math.min(_.index,E-1)),_.length=Math.max(0,Math.min(_.length,E-1-_.index)),g.setSelection(_)}},y.prototype.setEditorTabIndex=function(g,_){var E,x;!((x=(E=g)===null||E===void 0?void 0:E.scroll)===null||x===void 0)&&x.domNode&&(g.scroll.domNode.tabIndex=_)},y.prototype.setEditorReadOnly=function(g,_){_?g.disable():g.enable()},y.prototype.makeUnprivilegedEditor=function(g){var _=g;return{getHTML:function(){return _.root.innerHTML},getLength:_.getLength.bind(_),getText:_.getText.bind(_),getContents:_.getContents.bind(_),getSelection:_.getSelection.bind(_),getBounds:_.getBounds.bind(_)}},y.prototype.getEditingArea=function(){if(!this.editingArea)throw new Error("Instantiating on missing editing area");var g=s.default.findDOMNode(this.editingArea);if(!g)throw new Error("Cannot find element for editing area");if(g.nodeType===3)throw new Error("Editing area cannot be a text node");return g},y.prototype.renderEditingArea=function(){var g=this,_=this.props,E=_.children,x=_.preserveWhitespace,w=this.state.generation,S={key:w,ref:function(I){g.editingArea=I}};return i.default.Children.count(E)?i.default.cloneElement(i.default.Children.only(E),S):x?i.default.createElement("pre",e({},S)):i.default.createElement("div",e({},S))},y.prototype.render=function(){var g;return i.default.createElement("div",{id:this.props.id,style:this.props.style,key:this.state.generation,className:"quill "+(g=this.props.className,g??""),onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())},y.prototype.onEditorChangeText=function(g,_,E,x){var w,S;if(this.editor){var I=this.isDelta(this.value)?x.getContents():x.getHTML();I!==this.getEditorContents()&&(this.lastDeltaChangeSet=_,this.value=I,(S=(w=this.props).onChange)===null||S===void 0||S.call(w,g,_,E,x))}},y.prototype.onEditorChangeSelection=function(g,_,E){var x,w,S,I,C,N;if(this.editor){var R=this.getEditorSelection(),B=!R&&g,P=R&&!g;o.default(g,R)||(this.selection=g,(w=(x=this.props).onChangeSelection)===null||w===void 0||w.call(x,g,_,E),B?(I=(S=this.props).onFocus)===null||I===void 0||I.call(S,g,_,E):P&&((N=(C=this.props).onBlur)===null||N===void 0||N.call(C,R,_,E)))}},y.prototype.focus=function(){this.editor&&this.editor.focus()},y.prototype.blur=function(){this.editor&&(this.selection=null,this.editor.blur())},y.displayName="React Quill",y.Quill=l.default,y.defaultProps={theme:"snow",modules:{},readOnly:!1},y}(i.default.Component);function f(m){Promise.resolve().then(m)}return to=u,to}var I$=A$();const N$=Yx(I$),k$={toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["link"],[{color:[]},{background:[]}],[{align:[]}],["clean"]]},P$=["header","bold","italic","underline","strike","list","bullet","link","color","background","align"],g0=({value:r,onChange:e,placeholder:t,readOnly:n=!1,theme:i="snow",className:s=""})=>d.jsx(N$,{theme:i,value:r||"",onChange:e,modules:k$,formats:P$,placeholder:t,readOnly:n,className:s}),C$=({isOpen:r,onClose:e,ticket:t,db:n,adminUserData:i,showNotification:s,onTicketUpdate:o})=>{const[l,u]=te.useState(null),[f,m]=te.useState(""),[y,g]=te.useState(""),[_,E]=te.useState(!1),[x,w]=te.useState(!1),[S,I]=te.useState(!1),C=te.useRef(null);if(te.useEffect(()=>{t?(u(t),m(t.status||"Open"),g("")):u(null)},[t]),te.useEffect(()=>{var M;(M=C.current)==null||M.scrollIntoView({behavior:"smooth",block:"end"})},[l==null?void 0:l.conversation]),!r||!l)return null;const N="w-full px-3 py-2 rounded-md bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm",R="flex items-center justify-center px-4 py-2 rounded-md font-semibold text-sm transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95",B=async()=>{if(!f||f===l.status){s("Status is unchanged or invalid.","info");return}E(!0);const M={status:f,lastUpdatedByAdminName:i.displayName||"Admin",lastUpdatedByAdminId:i.uid},$=await v9(n,l.id,M);if($.success){s("Ticket status updated!","success");const G={...l,...M,status:f,lastUpdatedAt:Ot.now()};u(G),o&&o(G)}else s($.error||"Failed to update status.","error");E(!1)},P=M=>{g(M)},k=async()=>{if(!y.replace(/<[^>]*>?/gm,"").trim()){s("Reply cannot be empty.","warning");return}w(!0);const G={text:Do.sanitize(y),authorId:i.uid,authorName:i.displayName||"Admin",authorRole:i.role||"admin",timestamp:Ot.now()},ie=await UC(n,l.id,G);if(ie.success){s("Reply sent!","success");const oe=[...l.conversation||[],G],ee=f==="Open"||f==="Awaiting Customer"?"In Progress":f,J={...l,conversation:oe,lastUpdatedAt:Ot.now(),status:ee};ee!==f&&m(ee),u(J),o&&o(J),g("")}else s(ie.error||"Failed to send reply.","error");w(!1)},F=async()=>{const M=y.replace(/<[^>]*>?/gm,"").trim();if(!M){s("Write a draft or keywords first.","warning");return}I(!0);try{const $=(l.conversation||[]).map(ie=>`${ie.authorRole==="admin"?"Support":"Customer"}: ${ie.text.replace(/<[^>]*>?/gm,"")}`).join(`

`),G=await h3({ticketDescription:l.description,conversationHistory:$,draftReply:M,customerName:l.userName});g(G),s("AI refined your reply.","success")}catch($){const G=($==null?void 0:$.message)||"AI assistance failed.";s(G,"error")}finally{I(!1)}},j=({label:M,value:$,icon:G,valueClass:ie="text-gray-700"})=>d.jsxs("div",{className:"flex items-start py-2 border-b border-slate-100 last:border-b-0",children:[d.jsxs("span",{className:"text-xs font-semibold text-slate-500 w-32 flex items-center shrink-0",children:[G&&d.jsx(G,{size:14,className:"mr-2 text-slate-400"}),M,":"]}),d.jsx("span",{className:`text-sm ${ie} flex-1 break-words`,children:$||"N/A"})]}),O=M=>{switch(M){case"Open":return"bg-red-100 text-red-700";case"In Progress":return"bg-yellow-100 text-yellow-700";case"Resolved":return"bg-green-100 text-green-700";case"Closed":return"bg-purple-100 text-purple-700";case"Awaiting Customer":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-600"}},D=["Open","In Progress","Awaiting Customer","Resolved","Closed"];return d.jsxs(Mr,{isOpen:r,onClose:e,title:"Ticket Details",size:"full",modalDialogClassName:"sm:max-w-4xl w-[95vw] h-[95vh]",contentClassName:"p-0 flex flex-col",children:[d.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 bg-slate-50 rounded-t-xl sticky top-0 z-10",children:[d.jsxs("h3",{className:"text-lg font-semibold text-slate-800 truncate",title:l.issueType,children:[l.issueType," - ID: ",l.id.substring(0,8),"..."]}),d.jsx("button",{onClick:e,className:"p-2 text-gray-500 hover:text-gray-700 rounded-lg",children:d.jsx(i0,{size:18})})]}),d.jsxs("div",{className:"overflow-y-auto flex-grow p-4 space-y-4",children:[d.jsx("div",{className:"p-4 border rounded-lg bg-slate-50/70",children:d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4",children:[d.jsx(j,{label:"User",value:`${l.userName} (${l.userEmail||"N/A"})`,icon:Ps}),d.jsx(j,{label:"Account No",value:l.accountNumber||"N/A",icon:Cs}),d.jsx(j,{label:"Submitted",value:Yt(l.submittedAt),icon:du}),d.jsx(j,{label:"Last Update",value:Yt(l.lastUpdatedAt),icon:As}),d.jsx(j,{label:"Status",value:d.jsx("span",{className:`px-2 py-0.5 text-xs font-semibold rounded-full ${O(l.status)}`,children:l.status}),icon:Qt}),d.jsx(j,{label:"Ticket ID",value:l.id,icon:Cs,valueClass:"font-mono text-xs"})]})}),d.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[d.jsx("h4",{className:"text-sm font-semibold text-slate-600 mb-1",children:"Initial Description:"}),d.jsx("div",{className:"p-3 bg-slate-100 rounded-md text-sm text-slate-800 whitespace-pre-line prose prose-sm max-w-none",children:l.description})]}),d.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[d.jsx("h4",{className:"text-sm font-semibold text-slate-600 mb-2",children:"Conversation History"}),d.jsxs("div",{className:"max-h-60 overflow-y-auto space-y-3 p-3 bg-slate-50 border rounded-md",children:[l.conversation&&l.conversation.length>0?l.conversation.map((M,$)=>d.jsxs("div",{className:`p-2.5 rounded-lg ${M.authorRole==="admin"?"bg-blue-100":"bg-green-50"}`,children:[d.jsxs("p",{className:"text-xs font-bold text-gray-800",children:[M.authorName," (",M.authorRole,")"]}),d.jsx("div",{className:"text-sm text-gray-700 prose prose-sm max-w-none break-words",dangerouslySetInnerHTML:{__html:Do.sanitize(M.text||"")}}),d.jsx("p",{className:"text-right text-xs text-gray-500 mt-1",children:Yt(M.timestamp)})]},$)):d.jsx("p",{className:"text-sm text-center text-gray-500 py-4",children:"No replies yet."}),d.jsx("div",{ref:C})]})]}),d.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[d.jsx("h4",{className:"text-sm font-semibold text-slate-600 mb-2",children:"Send Reply"}),d.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[d.jsx(g0,{value:y,onChange:P,placeholder:"Type your reply...",className:"flex-grow bg-white rounded-lg border border-gray-300 min-h-[120px]",readOnly:x||S}),d.jsx("button",{onClick:F,className:`${R} bg-purple-100 text-purple-700 hover:bg-purple-200 self-start p-2`,disabled:S||!y.replace(/<[^>]*>?/gm,"").trim(),title:"Refine reply with AI",children:S?d.jsx(At,{size:18,className:"animate-spin"}):d.jsx(Os,{size:18})})]}),d.jsxs("button",{onClick:k,className:`${R} bg-blue-600 hover:bg-blue-700 text-white`,disabled:x||!y.replace(/<[^>]*>?/gm,"").trim(),children:[x?d.jsx(At,{size:18,className:"animate-spin mr-2"}):d.jsx(n0,{size:16,className:"mr-2"}),"Send Reply"]})]}),d.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[d.jsx("label",{htmlFor:"ticketStatusUpdate",className:"block text-sm font-semibold text-slate-600 mb-1.5",children:"Update Ticket Status:"}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("select",{id:"ticketStatusUpdate",value:f,onChange:M=>m(M.target.value),className:`${N} flex-grow`,disabled:_,children:D.map(M=>d.jsx("option",{value:M,children:M},M))}),d.jsxs("button",{onClick:B,className:`${R} bg-green-600 hover:bg-green-700 text-white`,disabled:_||f===l.status,children:[_?d.jsx(At,{size:18,className:"animate-spin mr-2"}):d.jsx(Da,{size:18,className:"mr-2"}),"Update Status"]})]})]})]})]})},R$=({db:r,appId:e,userData:t,showNotification:n})=>{const[i,s]=te.useState([]),[o,l]=te.useState(!0),[u,f]=te.useState(null),[m,y]=te.useState(null),[g,_]=te.useState(!1),[E,x]=te.useState(""),[w,S]=te.useState(""),[I,C]=te.useState(""),N="w-full sm:w-auto text-sm px-3 py-2 rounded-md bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150",R=`${N} placeholder-gray-400`,B=te.useCallback(async(G,ie)=>{const oe=ie==null?void 0:ie.autoCloseTicketsDays;if(!oe||isNaN(oe)||oe<=0)return;const ee=new Date,J=[];if(G.forEach(Y=>{var q;if(Y.status==="Resolved"){const Z=(q=Y.lastUpdatedAt)!=null&&q.toDate?Y.lastUpdatedAt.toDate():new Date(0);(ee-Z)/(1e3*60*60*24)>oe&&J.push(Y.id)}}),J.length>0){const Y=await $8(r,J,"Closed");Y.success?n(`Successfully auto-closed ${J.length} inactive ticket(s).`,"success"):n(`Failed to auto-close tickets: ${Y.error}`,"error")}},[r,n]),P=te.useCallback(async()=>{l(!0);const[G,ie]=await Promise.all([BS(r),g2(r)]);if(G.success){if(s(G.data),ie.success&&ie.data&&(await B(G.data,ie.data),G.data.some(oe=>oe.status==="Resolved"))){const oe=await BS(r);oe.success&&s(oe.data)}}else n(G.error||"Failed to fetch support tickets.","error"),s([]);l(!1)},[r,n,B]);te.useEffect(()=>{P()},[P]);const k=G=>{f(G)},F=()=>{f(null)},j=G=>{s(ie=>ie.map(oe=>oe.id===G.id?G:oe))},O=async()=>{if(!m)return;_(!0);const G=await y9(r,m.id);G.success?(n("Support ticket deleted successfully.","success"),P()):n(G.error||"Failed to delete ticket.","error"),_(!1),y(null)},D=G=>{switch(G){case"Open":return"bg-red-100 text-red-700";case"In Progress":return"bg-yellow-100 text-yellow-700";case"On Hold":return"bg-gray-200 text-gray-700";case"Awaiting Customer":return"bg-blue-100 text-blue-700";case"Resolved":return"bg-green-100 text-green-700";case"Closed":return"bg-purple-100 text-purple-700";default:return"bg-gray-100 text-gray-600"}},M=i.filter(G=>{var Y,q,Z,ne,se;const ie=I.toLowerCase(),oe=I?((Y=G.id)==null?void 0:Y.toLowerCase().includes(ie))||((q=G.userName)==null?void 0:q.toLowerCase().includes(ie))||((Z=G.userEmail)==null?void 0:Z.toLowerCase().includes(ie))||((ne=G.accountNumber)==null?void 0:ne.toLowerCase().includes(ie))||((se=G.description)==null?void 0:se.toLowerCase().includes(ie)):!0,ee=E?G.status===E:!0,J=w?G.issueType===w:!0;return oe&&ee&&J}),$=Array.from(new Set(i.map(G=>G.issueType))).sort();return o&&i.length===0?d.jsx(pn,{message:"Loading support tickets...",className:"mt-10 h-64"}):d.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[d.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[d.jsx(ka,{size:30,className:"mr-3 text-purple-600"})," Support Ticket Management"]}),d.jsxs("button",{onClick:P,className:"mt-3 sm:mt-0 text-sm flex items-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-3 rounded-lg border border-gray-300 transition-colors",disabled:o,title:"Refresh Ticket List",children:[o?d.jsx(At,{size:16,className:"animate-spin mr-1.5"}):d.jsx(Ma,{size:16,className:"mr-1.5"}),"Refresh"]})]}),d.jsxs("div",{className:"mb-5 p-4 bg-gray-50 rounded-lg shadow-sm grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 items-end",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"searchTerm",className:"block text-xs font-medium text-gray-600 mb-1",children:"Search Tickets"}),d.jsx("input",{type:"text",id:"searchTerm",placeholder:"ID, Name, Email, Account#, Keyword...",value:I,onChange:G=>C(G.target.value),className:R})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"filterStatus",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Status"}),d.jsxs("select",{id:"filterStatus",value:E,onChange:G=>x(G.target.value),className:N,children:[d.jsx("option",{value:"",children:"All Statuses"}),["Open","In Progress","On Hold","Awaiting Customer","Resolved","Closed"].map(G=>d.jsx("option",{value:G,children:G},G))]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"filterIssueType",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Issue Type"}),d.jsxs("select",{id:"filterIssueType",value:w,onChange:G=>S(G.target.value),className:N,children:[d.jsx("option",{value:"",children:"All Issue Types"}),$.map(G=>d.jsx("option",{value:G,children:G},G))]})]})]}),!o&&M.length===0&&d.jsxs("div",{className:"text-center py-10",children:[d.jsx(kn,{size:48,className:"mx-auto text-gray-400 mb-3"}),d.jsx("p",{className:"text-gray-500 text-lg",children:i.length===0?"No support tickets found in the system.":"No tickets match your current filters."})]}),M.length>0&&d.jsx("div",{className:"overflow-x-auto shadow-md rounded-lg border border-gray-200",children:d.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[d.jsx("thead",{className:"bg-gray-100",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ticket ID"}),d.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Submitted"}),d.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),d.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Issue Type"}),d.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),d.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Update"}),d.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:M.map(G=>d.jsxs("tr",{className:"hover:bg-gray-50/80 transition-colors duration-100",children:[d.jsxs("td",{className:"px-4 py-3 whitespace-nowrap font-mono text-xs text-gray-600",title:G.id,children:[G.id.substring(0,8),"..."]}),d.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-500",children:Yt(G.submittedAt,{month:"short",day:"numeric",year:"2-digit"})}),d.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-800 font-medium truncate max-w-[150px]",title:G.userName||G.userEmail,children:G.userName||G.userEmail}),d.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-600 truncate max-w-[180px]",title:G.issueType,children:G.issueType}),d.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:d.jsx("span",{className:`px-2.5 py-1 inline-flex text-xs leading-tight font-semibold rounded-full ${D(G.status)}`,children:G.status})}),d.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-500",children:Yt(G.lastUpdatedAt||G.lastUpdatedByAdmin||G.submittedAt,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),d.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-center space-x-2",children:[d.jsx("button",{onClick:()=>k(G),className:"text-indigo-600 hover:text-indigo-800 p-1.5 rounded-md hover:bg-indigo-50 transition-colors",title:"View & Manage Ticket",children:d.jsx(Yl,{size:18})}),d.jsx("button",{onClick:()=>y(G),className:"text-red-600 hover:text-red-800 p-1.5 rounded-md hover:bg-red-50 transition-colors",title:"Delete Ticket",children:d.jsx(th,{size:18})})]})]},G.id))})]})}),u&&t&&d.jsx(C$,{isOpen:!!u,onClose:F,ticket:u,db:r,appId:e,adminUserData:t,showNotification:n,onTicketUpdate:j}),m&&d.jsxs(tc,{isOpen:!!m,onClose:()=>y(null),onConfirm:O,title:"Confirm Ticket Deletion",confirmText:"Yes, Delete Ticket",isConfirming:g,iconType:"danger",children:[d.jsxs("p",{children:["Are you sure you want to permanently delete ticket ",d.jsxs("strong",{children:[m.id.substring(0,8),"..."]}),"?"]}),d.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"This action cannot be undone."})]})]})},o4="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",O$="flex items-center justify-center px-5 py-2.5 rounded-lg font-semibold text-sm transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95",Xh=({field:r,settings:e,handleChange:t})=>{const n=r.icon;return d.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50/50",children:[d.jsxs("label",{className:`block text-sm font-medium text-gray-700 mb-1.5 ${r.type!=="checkbox"?"flex items-center":""}`,children:[n&&d.jsx(n,{size:16,className:"mr-2 text-gray-500"}),r.label]}),r.type==="textarea"?d.jsx("textarea",{name:r.name,rows:r.rows||3,value:e[r.name]||"",onChange:t,className:o4,placeholder:r.placeholder}):r.type==="checkbox"?d.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-2",children:[d.jsx("input",{type:"checkbox",name:r.name,checked:!!e[r.name],onChange:t,className:"h-5 w-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),d.jsx("span",{className:"text-sm text-gray-600 select-none",children:r.description||"Enable/Disable"})]}):d.jsx("input",{type:r.type,name:r.name,value:e[r.name]??"",onChange:t,className:o4,step:"0.01",placeholder:r.placeholder})]},r.name)},j$=({showNotification:r=console.log})=>{const[e,t]=te.useState({portalAnnouncement:"",isBannerEnabled:!1,latePaymentPenaltyPercentage:2,latePaymentPenaltyDelayDays:15,reconnectionFee:500,fcdaPercentage:1.29,environmentalChargePercentage:25,sewerageChargePercentageCommercial:32.85,governmentTaxPercentage:2,vatPercentage:12,maintenanceMode:!1,isSignupEnabled:!0,isGoogleLoginEnabled:!0,isPasswordlessLoginEnabled:!0,isOnlinePaymentsEnabled:!0,isChatbotEnabled:!0,supportHotline:"1627-AGWA",supportEmail:"support@agos-waterservices.com.ph",autoCloseTicketsDays:14,isRebateProgramEnabled:!1,pointsPerPeso:.01,earlyPaymentBonusPoints:10,earlyPaymentDaysThreshold:7}),[n,i]=te.useState(!0),[s,o]=te.useState(!1),[l,u]=te.useState(""),[f,m]=te.useState(null),[y,g]=te.useState(!1),_=te.useCallback(async()=>{i(!0),u("");const k=await g2(Jt);k.success&&k.data?t(F=>({...F,...k.data})):u("Could not load existing settings. Default values are shown. Click 'Save' to create the settings document."),i(!1)},[]);te.useEffect(()=>{_()},[_]);const E=k=>{const{name:F,value:j,type:O,checked:D}=k.target;t(M=>({...M,[F]:O==="checkbox"?D:O==="number"&&j!==""?parseFloat(j):j}))},x=async k=>{k.preventDefault(),o(!0),u("");const F=await w9(Jt,e);F.success?r("System settings updated successfully!","success"):(u(F.error||"Failed to save system settings."),r(F.error||"Failed to save system settings.","error")),o(!1)},w=async()=>{if(!f)return;g(!0);let k,F=f;try{switch(F){case"tickets":k=await G8(Jt);break;case"bills":k=await K8(Jt);break;case"readings":k=await Y8(Jt);break;case"announcements":k=await Z8(Jt);break;case"interruptions":k=await Q8(Jt);break;case"routes":k=await X8(Jt);break;case"users":k=await J8(Jt);break;default:k={success:!1,error:"Unknown data type."}}k.success?r(`Successfully deleted ${k.count} ${F}.`,"success"):r(k.error||`Failed to delete ${F}.`,"error")}catch(j){r(j.message||`An error occurred deleting ${F}.`,"error")}g(!1),m(null)},S=[{name:"portalAnnouncement",label:"Portal-Wide Announcement Banner Text",type:"textarea",icon:yd,rows:3},{name:"isBannerEnabled",label:"Enable Announcement Banner",type:"checkbox",icon:yd},{name:"maintenanceMode",label:"Enable Portal Maintenance Mode",type:"checkbox",icon:Qt,description:"If enabled, only Admins can log in."}],I=[{name:"latePaymentPenaltyPercentage",label:"Late Payment Penalty (%)",type:"number",icon:Fh},{name:"latePaymentPenaltyDelayDays",label:"Late Payment Grace Period (Days)",type:"number",icon:As},{name:"reconnectionFee",label:"Reconnection Fee (PHP)",type:"number",icon:ly},{name:"fcdaPercentage",label:"FCDA (%)",type:"number",icon:Fh},{name:"environmentalChargePercentage",label:"Environmental Charge (%)",type:"number",icon:qS},{name:"sewerageChargePercentageCommercial",label:"Sewerage Charge (Comm. %)",type:"number",icon:Fh},{name:"governmentTaxPercentage",label:"Government Taxes (%)",type:"number",icon:Fh},{name:"vatPercentage",label:"VAT (%)",type:"number",icon:Fh}],C=[{name:"isOnlinePaymentsEnabled",label:"Enable Online Payments",type:"checkbox",icon:Rx},{name:"isSignupEnabled",label:"Enable New User Sign-ups",type:"checkbox",icon:Gv},{name:"isGoogleLoginEnabled",label:"Enable Sign-in with Google",type:"checkbox",icon:Gv},{name:"isPasswordlessLoginEnabled",label:"Enable Passwordless (Email Link) Sign-in",type:"checkbox",icon:Gv},{name:"isChatbotEnabled",label:"Enable Chatbot",type:"checkbox",icon:ka}],N=[{name:"isRebateProgramEnabled",label:"Enable Rebate Program",type:"checkbox",icon:b2,description:"Enable the customer rewards program."},{name:"pointsPerPeso",label:"Points Awarded per 1.00 Paid",type:"number",icon:dd,placeholder:"e.g., 0.01 for 1pt per 100"},{name:"earlyPaymentBonusPoints",label:"Early Payment Bonus (Points)",type:"number",icon:dd,placeholder:"e.g., 10"},{name:"earlyPaymentDaysThreshold",label:"Early Payment Threshold (Days)",type:"number",icon:QC,placeholder:"e.g., 7 days before due date"}],R=[{name:"supportHotline",label:"Support Hotline Number",type:"text",icon:uF,placeholder:"e.g., 1627-AGOS"},{name:"supportEmail",label:"Support Email Address",type:"email",icon:H9,placeholder:"e.g., support@agos.com"},{name:"autoCloseTicketsDays",label:"Auto-close Resolved Tickets After (Days)",type:"number",icon:As}],B=[{label:"Clear All Support Tickets",action:"tickets",icon:ka},{label:"Clear All Bills",action:"bills",icon:Rx},{label:"Clear All Meter Readings",action:"readings",icon:qS},{label:"Clear All Announcements",action:"announcements",icon:yd},{label:"Clear All Interruptions",action:"interruptions",icon:Qt},{label:"Clear All Meter Routes",action:"routes",icon:Xl}],P={label:"Clear All User Profiles",action:"users",icon:wa};return n?d.jsx(pn,{message:"Loading system settings...",className:"mt-10 h-64"}):d.jsxs("form",{onSubmit:x,className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[d.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[d.jsx(r0,{size:30,className:"mr-3 text-gray-600"})," System Configuration"]}),d.jsxs("button",{type:"submit",className:`${O$} bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500 w-auto mt-4 sm:mt-0`,disabled:s||n,children:[s?d.jsx(At,{size:18,className:"animate-spin mr-2"}):d.jsx(Da,{size:18,className:"mr-2"}),s?"Saving...":"Save All Settings"]})]}),l&&d.jsxs("div",{className:"mb-4 p-3 bg-yellow-100 border border-yellow-400 text-yellow-800 rounded-lg text-sm flex items-center",children:[d.jsx(Qt,{size:20,className:"mr-2"})," ",l]}),d.jsxs("div",{className:"space-y-8",children:[d.jsxs("section",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"General & Maintenance"}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:S.map(k=>d.jsx(Xh,{field:k,settings:e,handleChange:E},k.name))})]}),d.jsxs("section",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"Billing & Financial"}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:I.map(k=>d.jsx(Xh,{field:k,settings:e,handleChange:E},k.name))})]}),d.jsxs("section",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"Portal Features & Authentication"}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:C.map(k=>d.jsx(Xh,{field:k,settings:e,handleChange:E},k.name))})]}),d.jsxs("section",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"Rewards Program"}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:N.map(k=>d.jsx(Xh,{field:k,settings:e,handleChange:E},k.name))})]}),d.jsxs("section",{children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"Communication & Support"}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:R.map(k=>d.jsx(Xh,{field:k,settings:e,handleChange:E},k.name))})]})]}),d.jsxs("div",{className:"mt-12 pt-6 border-t-2 border-red-300",children:[d.jsxs("h3",{className:"text-xl font-bold text-red-700 flex items-center",children:[d.jsx(Qt,{size:24,className:"mr-2"})," Danger Zone"]}),d.jsx("p",{className:"text-sm text-gray-600 mt-1 mb-4",children:"These actions are destructive and cannot be undone. This will permanently delete transactional data from the database, effectively resetting parts of your system."}),d.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:B.map(k=>{const F=k.icon;return d.jsxs("button",{type:"button",onClick:()=>m(k.action),className:"p-4 border border-red-200 rounded-lg bg-red-50 hover:bg-red-100 hover:border-red-400 transition-colors text-left",children:[d.jsxs("p",{className:"font-semibold text-red-800 flex items-center",children:[d.jsx(F,{size:16,className:"mr-2"}),k.label]}),d.jsxs("p",{className:"text-xs text-red-600 mt-1",children:["Permanently delete all ",k.action," from the database."]})]},k.action)})}),d.jsx("div",{className:"mt-4",children:d.jsxs("button",{type:"button",onClick:()=>m(P.action),className:"p-4 border border-red-300 w-full rounded-lg bg-red-100 hover:bg-red-200 hover:border-red-500 transition-colors text-left",children:[d.jsxs("p",{className:"font-semibold text-red-900 flex items-center",children:[d.jsx(P.icon,{size:16,className:"mr-2"}),P.label]}),d.jsx("p",{className:"text-xs text-red-700 mt-1",children:"Permanently delete all user profiles. This is the most destructive action and will force all users to sign up again."})]},P.action)})]}),f&&d.jsx(tc,{isOpen:!!f,onClose:()=>m(null),onConfirm:w,title:`Confirm Deletion of All ${f.charAt(0).toUpperCase()+f.slice(1)}`,confirmText:`Yes, delete all ${f}`,isConfirming:y,iconType:"danger",children:d.jsxs("p",{children:["Are you absolutely sure you want to proceed? All ",d.jsx("strong",{children:f})," data will be permanently erased. This action cannot be undone."]})})]})},M$=({initialData:r=null,onSubmit:e,onCancel:t,isSaving:n,showNotification:i})=>{const[s,o]=te.useState(""),[l,u]=te.useState(""),[f,m]=te.useState("info"),[y,g]=te.useState("active"),[_,E]=te.useState(""),[x,w]=te.useState(""),[S,I]=te.useState(["all"]),[C,N]=te.useState(""),[R,B]=te.useState(!1),[P,k]=te.useState("");te.useEffect(()=>{var $,G;if(r)o(r.title||""),u(r.content||""),m(r.type||"info"),g(r.status||"active"),E(($=r.startDate)!=null&&$.toDate?r.startDate.toDate().toISOString().split("T")[0]:""),w((G=r.endDate)!=null&&G.toDate?r.endDate.toDate().toISOString().split("T")[0]:""),I(r.targetRoles||["all"]);else{const ie=new Date().toISOString().split("T")[0];E(ie),g("active"),o(""),u(""),m("info"),w(""),I(["all"]),N("")}},[r]);const F=$=>{u($),P&&$.replace(/<[^>]*>?/gm,"").trim()&&k("")},j=async()=>{const $=l.replace(/<[^>]*>?/gm,"").trim();if(C.trim()){B(!0);try{const G=await PF({title:s||C,reason:C,area:"",time:""});u(G),!s.trim()&&C.trim()&&o(C.trim()),i("AI generated a new draft!","success")}catch(G){const ie=(G==null?void 0:G.message)||"AI generation failed.";i(ie,"error")}finally{B(!1)}}else if($){B(!0);try{const ie=[{role:"user",content:`Refine this announcement draft for AGWA Water Services. Make it clear, professional, concise, using simple HTML (<p>, <strong>, <ul>, <li>). Announcement Type: ${f}. Title: "${s}". Original Content (may contain HTML): "${l}". Respond only with the refined HTML content.`}],oe=await Jl(ie);u(oe),i("AI has refined your content!","success")}catch(G){const ie=(G==null?void 0:G.message)||"AI assistance failed.";i(ie,"error")}finally{B(!1)}}else i("Please provide a prompt or write some content for the AI to assist with.","warning")},O=$=>{$.preventDefault(),k("");const G=l.replace(/<[^>]*>?/gm,"").trim();if(!s.trim()||!G||!_){k("Title, Content, and Start Date are required.");return}if(x&&new Date(x)<new Date(_)){k("End date cannot be before start date.");return}const ie=Do.sanitize(l),oe={title:s.trim(),content:ie,type:f,status:y,startDate:new Date(_),endDate:x?new Date(x):null,targetRoles:S.length===0||S.includes("all")?["all"]:S};e(oe)},D="w-full px-4 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 focus:outline-none transition duration-200 text-gray-900",M="flex items-center justify-center px-4 py-2.5 rounded-lg font-semibold transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95";return d.jsx("div",{className:"p-1",children:d.jsxs("form",{onSubmit:O,className:"space-y-6",id:"announcementForm",children:[P&&d.jsxs("div",{className:"p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg text-sm flex items-center",children:[d.jsx(W9,{size:20,className:"mr-2"})," ",P]}),d.jsxs("div",{children:[d.jsxs("label",{htmlFor:"announcementTitle",className:"block text-sm font-medium text-gray-700 mb-1",children:[d.jsx(i3,{size:16,className:"inline mr-1.5"}),"Title *"]}),d.jsx("input",{type:"text",id:"announcementTitle",value:s,onChange:$=>o($.target.value),className:D,placeholder:"E.g., Scheduled Maintenance in Poblacion",required:!0})]}),d.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg space-y-3",children:[d.jsxs("label",{htmlFor:"aiPrompt",className:"block text-sm font-medium text-blue-800",children:[d.jsx(Os,{size:16,className:"inline mr-1.5"}),"AI Assistant"]}),d.jsx("input",{type:"text",id:"aiPrompt",value:C,onChange:$=>N($.target.value),className:D,placeholder:"Type a prompt to generate new content (e.g., 'Emergency repair in Muzon')"}),d.jsxs("button",{type:"button",onClick:j,className:`${M} text-sm bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-300 py-2 px-4`,disabled:R||n,children:[R?d.jsx(At,{size:16,className:"animate-spin mr-1.5"}):d.jsx(Os,{size:16,className:"mr-1.5"}),C.trim()?"Generate Content":"Refine Existing Content"]}),d.jsx("p",{className:"text-xs text-gray-500",children:"If the prompt is filled, AI will generate new content. If the prompt is empty and the editor has content, AI will refine it."})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Content *"}),d.jsx(g0,{value:l,onChange:F,placeholder:"Describe the announcement, or use the AI Assistant above to generate content.",className:"bg-white rounded-lg border border-gray-300 min-h-[250px]"}),P&&!l.replace(/<[^>]*>?/gm,"").trim()&&d.jsx("p",{className:"text-red-500 text-xs mt-1",children:"Content is required."})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"announcementType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),d.jsxs("select",{id:"announcementType",value:f,onChange:$=>m($.target.value),className:D,children:[d.jsx("option",{value:"info",children:"Info"}),d.jsx("option",{value:"warning",children:"Warning"}),d.jsx("option",{value:"critical",children:"Critical"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),d.jsxs("button",{type:"button",onClick:()=>g(y==="active"?"archived":"active"),className:`${M} w-full ${y==="active"?"bg-green-500 hover:bg-green-600 text-white focus:ring-green-400":"bg-gray-200 hover:bg-gray-300 text-gray-700 focus:ring-gray-300"}`,children:[y==="active"?d.jsx(fF,{size:18,className:"mr-2"}):d.jsx(mF,{size:18,className:"mr-2"}),y==="active"?"Active":"Archived"]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsxs("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700 mb-1",children:[d.jsx(du,{size:16,className:"inline mr-1.5"}),"Start Date *"]}),d.jsx("input",{type:"date",id:"startDate",value:_,onChange:$=>E($.target.value),className:D,required:!0})]}),d.jsxs("div",{children:[d.jsxs("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700 mb-1",children:[d.jsx(du,{size:16,className:"inline mr-1.5"}),"End Date (Optional)"]}),d.jsx("input",{type:"date",id:"endDate",value:x,onChange:$=>w($.target.value),className:D,min:_})]})]}),d.jsxs("div",{className:"pt-6 border-t mt-6 flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-4",children:[d.jsx("button",{type:"button",onClick:t,className:`${M} bg-gray-100 hover:bg-gray-200 text-gray-700 border border-gray-300 focus:ring-gray-300 w-full sm:w-auto order-2 sm:order-1`,disabled:n||R,children:"Cancel"}),d.jsxs("button",{type:"submit",form:"announcementForm",className:`${M} bg-green-600 hover:bg-green-700 text-white focus:ring-green-500 w-full sm:w-auto order-1 sm:order-2`,disabled:n||R||!s.trim()||!l.replace(/<[^>]*>?/gm,"").trim(),children:[n?d.jsx(At,{size:20,className:"animate-spin mr-2"}):d.jsx(Da,{size:20,className:"mr-2"}),n?"Saving...":r?"Update Announcement":"Create Announcement"]})]})]})})},D$=({announcements:r,onEdit:e,onDelete:t,onToggleStatus:n,actionLoadingId:i,viewOnly:s=!1})=>{const o=l=>{if(!l)return"N/A";let u;try{if(l.toDate&&typeof l.toDate=="function")u=l.toDate();else if(l instanceof Date)u=l;else if(typeof l=="string"||typeof l=="number")u=new Date(l);else return"Invalid Date";return isNaN(u.getTime())?"Invalid Date":u.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Invalid Date"}};return!r||r.length===0?d.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner border border-gray-200",children:[d.jsx(kn,{size:48,className:"mx-auto text-gray-400 mb-4"}),d.jsx("p",{className:"text-gray-600 text-lg",children:"No announcements found."}),!s&&d.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Create one using the 'New Announcement' button."})]}):d.jsx("div",{className:"space-y-4",children:r.map(l=>{var f,m;const u=Do.sanitize(l.content||"");return d.jsxs("div",{className:`p-4 rounded-lg shadow-md border-l-4 transition-opacity ${l.status==="active"?"border-green-500 bg-white hover:shadow-lg":"border-gray-400 bg-gray-50 opacity-80 hover:opacity-100 hover:shadow-md"}`,children:[d.jsxs("div",{className:"flex justify-between items-start gap-3",children:[d.jsxs("div",{className:"flex-grow pr-4",children:[d.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:l.title}),d.jsxs("div",{className:"flex items-center flex-wrap gap-2 text-xs mt-1",children:[d.jsx("span",{className:`px-2 py-0.5 font-semibold uppercase tracking-wider rounded-full ${l.status==="active"?"bg-green-100 text-green-800":"bg-gray-200 text-gray-600"}`,children:l.status}),d.jsx("span",{className:`px-2 py-0.5 font-semibold uppercase tracking-wider rounded-full ${l.type==="critical"?"bg-red-100 text-red-800":l.type==="warning"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:l.type}),d.jsxs("span",{className:"text-gray-400 font-mono flex items-center",children:[d.jsx(Cs,{size:12,className:"mr-0.5"}),l.id.substring(0,8),"..."]})]})]}),!s&&d.jsx("div",{className:"flex space-x-2 items-center flex-shrink-0",children:i===l.id?d.jsx(At,{className:"animate-spin text-gray-500"}):d.jsxs(d.Fragment,{children:[n&&d.jsx("button",{onClick:()=>n(l),className:`p-1.5 rounded-md hover:bg-opacity-20 transition-colors ${l.status==="active"?"text-yellow-600 hover:bg-yellow-100":"text-green-600 hover:bg-green-100"}`,title:l.status==="active"?"Archive":"Activate",children:l.status==="active"?d.jsx(ay,{size:18}):d.jsx(Yl,{size:18})}),e&&d.jsx("button",{onClick:()=>e(l),className:"text-blue-600 hover:text-blue-800 p-1.5 rounded-md hover:bg-blue-100 transition-colors",title:"Edit",children:d.jsx(cF,{size:18})}),t&&d.jsx("button",{onClick:()=>t(l.id),className:"text-red-600 hover:text-red-800 p-1.5 rounded-md hover:bg-red-100 transition-colors",title:"Delete",children:d.jsx(th,{size:18})})]})})]}),d.jsx("div",{className:"prose prose-sm max-w-none text-gray-700 mt-3 pt-3 border-t border-gray-200/80 leading-relaxed",dangerouslySetInnerHTML:{__html:u}}),d.jsxs("div",{className:"text-xs text-gray-500 mt-3 pt-2 border-t border-gray-200/80",children:[d.jsxs("p",{children:["Author: ",l.authorName||"Admin"]}),d.jsxs("p",{children:["Created: ",o(l.createdAt)]}),l.updatedAt&&((f=l.updatedAt)==null?void 0:f.seconds)!==((m=l.createdAt)==null?void 0:m.seconds)&&d.jsxs("p",{children:["Updated: ",o(l.updatedAt)]}),d.jsxs("p",{children:["Display: ",o(l.startDate)," to ",l.endDate?o(l.endDate):"Ongoing"]})]})]},l.id)})})},a4=({db:r,userData:e,showNotification:t,viewOnly:n=!1})=>{const[i,s]=te.useState([]),[o,l]=te.useState(!0),[u,f]=te.useState(!1),[m,y]=te.useState(null),[g,_]=te.useState(!1),[E,x]=te.useState(null),[w,S]=te.useState(!1),[I,C]=te.useState(null),N=te.useCallback(async()=>{l(!0);try{const O=await x9(r,n);if(O.success)s(O.data||[]);else throw new Error(O.error)}catch{t("Failed to load announcements.","error")}finally{l(!1)}},[r,t,n]);te.useEffect(()=>{N()},[N]);const R=()=>{y(null),f(!0)},B=O=>{y(O),f(!0)},P=async O=>{_(!0);const M=await(m?US(r,m.id,{...O,updatedBy:e.uid}):_9(r,{...O,createdBy:e.uid,authorName:e.displayName}));M.success?(t(`Announcement ${m?"updated":"created"} successfully!`,"success"),N(),f(!1)):t(`Failed to save announcement: ${M.error}`,"error"),_(!1)},k=O=>{C(O),S(!0)},F=async()=>{if(!I)return;x(I);const O=await b9(r,I);O.success?(t("Announcement deleted successfully!","success"),N()):t(`Failed to delete announcement: ${O.error}`,"error"),S(!1),C(null),x(null)},j=async O=>{x(O.id);const D=O.status==="active"?"archived":"active",M=await US(r,O.id,{status:D,updatedBy:e.uid});M.success?(t(`Announcement status changed to ${D}.`,"success"),N()):t("Failed to update status: "+M.error,"error"),x(null)};return d.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-xl",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[d.jsx("h3",{className:"text-2xl font-semibold",children:n?"Company Announcements":"Manage Announcements"}),!n&&d.jsxs("button",{onClick:R,className:"bg-blue-600 text-white font-medium py-2 px-4 rounded-lg flex items-center",children:[d.jsx(e0,{size:18,className:"mr-2"})," New Announcement"]})]}),o?d.jsx(pn,{message:"Loading Announcements..."}):d.jsx(D$,{announcements:i,onEdit:n?void 0:B,onDelete:n?void 0:k,onToggleStatus:n?void 0:j,actionLoadingId:E,viewOnly:n}),!n&&u&&d.jsx(Mr,{isOpen:u,onClose:()=>f(!1),title:m?"Edit Announcement":"Create Announcement",size:"full",children:d.jsx(M$,{initialData:m,onSubmit:P,onCancel:()=>f(!1),isSaving:g,showNotification:t})}),!n&&w&&d.jsx(tc,{isOpen:w,onClose:()=>S(!1),onConfirm:F,title:"Confirm Deletion",isConfirming:!!E,children:"Are you sure you want to delete this announcement? This action cannot be undone."})]})},L$=({initialData:r=null,onSubmit:e,onCancel:t,isSaving:n,showNotification:i})=>{const[s,o]=te.useState(""),[l,u]=te.useState(""),[f,m]=te.useState("Maintenance"),[y,g]=te.useState("Scheduled"),[_,E]=te.useState(""),[x,w]=te.useState("08:00"),[S,I]=te.useState(""),[C,N]=te.useState("17:00"),[R,B]=te.useState([]),[P,k]=te.useState(!1),[F,j]=te.useState(""),[O,D]=te.useState({}),[M,$]=te.useState([]);te.useEffect(()=>{const se=c0(),le=[],Q=se.reduce((ce,me)=>{const ge=mu(me).sort();return ce[me]=ge,le.push(...ge),ce},{});D(Q),$(le.sort())},[]),te.useEffect(()=>{var se,le;if(r){o(r.title||""),u(r.description||""),m(r.type||"Maintenance"),g(r.status||"Scheduled"),B(r.affectedAreas||[]),k(r.isBillingPaused||!1);const Q=(se=r.startDate)!=null&&se.toDate?r.startDate.toDate():null,ce=(le=r.estimatedEndDate)!=null&&le.toDate?r.estimatedEndDate.toDate():null;E(Q?Q.toISOString().split("T")[0]:""),w(Q?`${String(Q.getHours()).padStart(2,"0")}:${String(Q.getMinutes()).padStart(2,"0")}`:"08:00"),I(ce?ce.toISOString().split("T")[0]:""),N(ce?`${String(ce.getHours()).padStart(2,"0")}:${String(ce.getMinutes()).padStart(2,"0")}`:"17:00")}else{const ce=new Date().toISOString().split("T")[0];o(""),u(""),m("Maintenance"),g("Scheduled"),E(ce),w("08:00"),I(ce),N("17:00"),B([]),k(!1)}},[r]);const G=se=>{u(se),F&&se.replace(/<[^>]*>?/gm,"").trim()&&j("")},ie=se=>{B(le=>le.includes(se)?le.filter(Q=>Q!==se):[...le,se]),F&&R.length>0&&j("")},oe=()=>{R.length===M.length?B([]):(B([...M]),F&&j(""))},ee=(se,le)=>{const Q=le.every(ce=>R.includes(ce));B(Q?ce=>ce.filter(me=>!le.includes(me)):ce=>[...new Set([...ce,...le])])},J=se=>{se.preventDefault(),j("");const le=l.replace(/<[^>]*>?/gm,"").trim();if(!s.trim()||!le||!_||!x||R.length===0){j("Title, Description, Affected Area(s), Start Date/Time are required.");return}const Q=new Date(`${_}T${x}`);if(isNaN(Q)){j("Invalid Start Date or Time.");return}let ce=null;if(S&&C){if(ce=new Date(`${S}T${C}`),isNaN(ce)){j("Invalid Estimated End Date or Time.");return}if(ce<=Q){j("Estimated End must be after Start.");return}}const me=Do.sanitize(l),ge={title:s.trim(),description:me,type:f,status:y,startDate:Q,estimatedEndDate:ce,affectedAreas:R.sort(),isBillingPaused:P};e(ge)},Y="w-full px-4 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm text-gray-900",q="flex items-center justify-center px-4 py-2.5 rounded-lg font-semibold transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95 text-sm",Z=["Maintenance","Emergency Repair","System Upgrade","Leak Detection","Other"],ne=["Scheduled","Ongoing","Resolved"];return d.jsxs("form",{onSubmit:J,className:"space-y-6 p-1",children:[F&&d.jsxs("div",{className:"p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg text-sm flex items-center",children:[d.jsx(Qt,{size:20,className:"mr-2"})," ",F]}),d.jsxs("div",{children:[d.jsxs("label",{htmlFor:"interruptionTitle",className:"block text-sm font-medium text-gray-700 mb-1",children:[d.jsx(i3,{size:16,className:"inline mr-1.5"}),"Title *"]}),d.jsx("input",{type:"text",id:"interruptionTitle",value:s,onChange:se=>o(se.target.value),className:Y,placeholder:"E.g., Water Interruption in Brgy. Muzon",required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),d.jsx(g0,{value:l,onChange:G,placeholder:"Provide details...",className:"bg-white rounded-lg border border-gray-300 min-h-[150px]"}),F&&!l.replace(/<[^>]*>?/gm,"").trim()&&d.jsx("p",{className:"text-red-500 text-xs mt-1",children:"Description is required."})]}),d.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50 max-h-72 overflow-y-auto scrollbar-thin",children:[d.jsxs("div",{className:"flex justify-between items-center mb-2 sticky top-0 bg-gray-50 py-1 -mt-1 border-b border-gray-200",children:[d.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[d.jsx(Na,{size:16,className:"inline mr-1.5"}),"Affected Area(s) *"]}),d.jsx("button",{type:"button",onClick:oe,className:"text-xs font-medium text-blue-600 hover:underline",children:R.length===M.length?"Deselect All":`Select All (${M.length})`})]}),d.jsx("div",{className:"space-y-2",children:Object.entries(O).map(([se,le])=>d.jsxs("details",{className:"group bg-white border rounded-md",children:[d.jsxs("summary",{className:"flex justify-between items-center p-2 cursor-pointer list-none",children:[d.jsx("span",{className:"font-semibold text-sm text-blue-700",children:se}),d.jsxs("div",{className:"flex items-center",children:[d.jsx("button",{type:"button",onClick:Q=>{Q.preventDefault(),ee(se,le)},className:"text-xs text-blue-600 hover:underline mr-2",children:"Toggle District"}),d.jsx(XC,{size:18,className:"text-gray-500 group-open:rotate-180 transition-transform"})]})]}),d.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 p-3 border-t border-gray-100",children:le.map(Q=>d.jsxs("label",{className:"flex items-center space-x-2 p-1.5 rounded bg-gray-50 border border-gray-200 hover:bg-blue-50 cursor-pointer text-xs has-[:checked]:bg-blue-100 has-[:checked]:border-blue-300",children:[d.jsx("input",{type:"checkbox",checked:R.includes(Q),onChange:()=>ie(Q),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 shrink-0"}),d.jsx("span",{className:"truncate",title:Q,children:Q})]},Q))})]},se))}),F&&R.length===0&&d.jsx("p",{className:"text-red-500 text-xs mt-2",children:"Select at least one area."})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"interruptionType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Type *"}),d.jsx("select",{id:"interruptionType",value:f,onChange:se=>m(se.target.value),className:Y,required:!0,children:Z.map(se=>d.jsx("option",{value:se,children:se},se))})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"interruptionStatus",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status *"}),d.jsx("select",{id:"interruptionStatus",value:y,onChange:se=>g(se.target.value),className:Y,required:!0,children:ne.map(se=>d.jsx("option",{value:se,children:se},se))})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),d.jsxs("label",{className:"flex items-center space-x-2 p-2.5 rounded-lg bg-yellow-50 border border-yellow-200 cursor-pointer hover:bg-yellow-100",children:[d.jsx("input",{type:"checkbox",checked:P,onChange:se=>k(se.target.checked),className:"h-4 w-4 text-yellow-600 border-gray-300 rounded focus:ring-yellow-500"}),d.jsxs("span",{className:"text-sm font-medium text-yellow-800 flex items-center",children:[d.jsx(G9,{size:16,className:"mr-1.5"})," Pause Billing"]})]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[d.jsxs("div",{children:[d.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[d.jsx(du,{size:16,className:"inline mr-1.5"}),"Start Date & Time *"]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"date",id:"startDate",value:_,onChange:se=>E(se.target.value),className:Y,required:!0}),d.jsx("input",{type:"time",id:"startTime",value:x,onChange:se=>w(se.target.value),className:Y,required:!0})]})]}),d.jsxs("div",{children:[d.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[d.jsx(As,{size:16,className:"inline mr-1.5"}),"Estimated End Date & Time"]}),d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"date",id:"estimatedEndDate",value:S,onChange:se=>I(se.target.value),className:Y,min:_}),d.jsx("input",{type:"time",id:"estimatedEndTime",value:C,onChange:se=>N(se.target.value),className:Y})]}),F.includes("End Date/Time")&&d.jsx("p",{className:"text-red-500 text-xs mt-1",children:F})]})]}),d.jsxs("div",{className:"pt-6 border-t mt-6 flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-4",children:[d.jsx("button",{type:"button",onClick:t,className:`${q} bg-gray-100 hover:bg-gray-200 text-gray-700 border border-gray-300 focus:ring-gray-300 w-full sm:w-auto order-2 sm:order-1`,disabled:n,children:"Cancel"}),d.jsxs("button",{type:"submit",className:`${q} bg-green-600 hover:bg-green-700 text-white focus:ring-green-500 w-full sm:w-auto order-1 sm:order-2`,disabled:n,children:[n?d.jsx(At,{size:20,className:"animate-spin mr-2"}):d.jsx(Da,{size:20,className:"mr-2"}),n?"Saving...":r?"Update Advisory":"Create Advisory"]})]}),d.jsx("style",{children:`
                .scrollbar-thin { scrollbar-width: thin; scrollbar-color: #9ca3af #f3f4f6; }
                .scrollbar-thin::-webkit-scrollbar { width: 6px; height: 6px;}
                .scrollbar-thin::-webkit-scrollbar-track { background: #f3f4f6; border-radius:3px; }
                .scrollbar-thin::-webkit-scrollbar-thumb { background-color: #9ca3af; border-radius: 3px; border: 1px solid #f3f4f6;}
                .scrollbar-thin::-webkit-scrollbar-thumb:hover { background-color: #6b7280; }
             `})]})},F$=({db:r,userData:e,showNotification:t})=>{const[n,i]=te.useState([]),[s,o]=te.useState(!0),[l,u]=te.useState(!1),[f,m]=te.useState(null),[y,g]=te.useState(!1),[_,E]=te.useState(null),[x,w]=te.useState(!1),[S,I]=te.useState(null),C=te.useCallback(async()=>{o(!0);try{const j=await j9(r);if(j.success)i(j.data||[]);else throw new Error(j.error)}catch(j){t(j.message||"Failed to load interruptions.","error")}finally{o(!1)}},[r,t]);te.useEffect(()=>{C()},[C]);const N=()=>{m(null),u(!0)},R=j=>{m(j),u(!0)},B=async j=>{g(!0);const D=await(f?R9(r,f.id,j):C9(r,j));D.success?(t(`Advisory ${f?"updated":"created"} successfully!`,"success"),C(),u(!1)):t(D.error||"Failed to save advisory.","error"),g(!1)},P=j=>{I(j),w(!0)},k=async()=>{if(!S)return;E(S.id);const j=await O9(r,S.id);j.success?(t("Advisory deleted successfully!","success"),C()):t(j.error||"Failed to delete advisory.","error"),w(!1),I(null),E(null)},F=(j,O)=>{if((O==="Emergency Repair"||O==="Leak Detection")&&j!=="Resolved")return{icon:a3,color:"text-red-700",bgColor:"bg-red-100",label:"Emergency"};switch(j){case"Ongoing":return{icon:Qt,color:"text-orange-600",bgColor:"bg-orange-100",label:"Ongoing"};case"Scheduled":return{icon:As,color:"text-blue-600",bgColor:"bg-blue-100",label:"Scheduled"};case"Resolved":return{icon:ks,color:"text-green-600",bgColor:"bg-green-100",label:"Resolved"};default:return{icon:kn,color:"text-gray-500",bgColor:"bg-gray-100",label:j||"Unknown"}}};return d.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-xl",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[d.jsxs("h3",{className:"text-2xl font-semibold flex items-center",children:[d.jsx(Qt,{className:"mr-3 text-orange-500"})," Manage Service Advisories"]}),d.jsxs("button",{onClick:N,className:"bg-blue-600 text-white font-medium py-2 px-4 rounded-lg flex items-center text-sm",children:[d.jsx(e0,{size:16,className:"mr-2"})," New Advisory"]})]}),s?d.jsx(pn,{message:"Loading Advisories..."}):d.jsxs("div",{className:"space-y-3",children:[n.length===0&&d.jsxs("div",{className:"text-center py-10 bg-gray-50 rounded-lg",children:[d.jsx(kn,{size:32,className:"mx-auto text-gray-400 mb-2"}),d.jsx("p",{className:"text-gray-500",children:"No advisories found."})]}),n.map(j=>{var M,$,G;const O=F(j.status,j.type),D=O.icon;return d.jsxs("div",{className:`p-4 rounded-lg shadow border-l-4 flex justify-between items-start gap-4 ${O.bgColor.replace("bg-","border-")}`,children:[d.jsxs("div",{className:"flex-grow",children:[d.jsx("h4",{className:"font-semibold text-gray-800",children:j.title}),d.jsxs("div",{className:"text-xs text-gray-600 mt-1 space-y-0.5",children:[d.jsxs("p",{className:"flex items-center",children:[d.jsx(Na,{size:12,className:"mr-1.5"})," Areas: ",(M=j.affectedAreas)==null?void 0:M.slice(0,3).join(", "),(($=j.affectedAreas)==null?void 0:$.length)>3?"...":""," (",((G=j.affectedAreas)==null?void 0:G.length)||0,")"]}),d.jsxs("p",{className:"flex items-center",children:[d.jsx(As,{size:12,className:"mr-1.5"})," Start: ",Yt(j.startDate)]}),j.estimatedEndDate&&d.jsxs("p",{className:"flex items-center",children:[d.jsx(As,{size:12,className:"mr-1.5"})," End: ",Yt(j.estimatedEndDate)]}),d.jsxs("p",{className:"text-gray-400",children:["ID: ",j.id.substring(0,8),"..."]})]})]}),d.jsxs("div",{className:"flex flex-col items-end gap-2 shrink-0",children:[d.jsxs("span",{className:`px-2 py-0.5 text-xs font-semibold rounded-full flex items-center ${O.bgColor} ${O.color}`,children:[d.jsx(D,{size:12,className:"mr-1"})," ",O.label]}),d.jsxs("div",{className:"flex space-x-1",children:[d.jsx("button",{onClick:()=>R(j),className:"p-1.5 text-blue-600 hover:bg-blue-100 rounded-md disabled:opacity-50",disabled:_===j.id,children:d.jsx(Xf,{size:16})}),d.jsx("button",{onClick:()=>P(j),className:"p-1.5 text-red-600 hover:bg-red-100 rounded-md disabled:opacity-50",disabled:_===j.id,children:_===j.id?d.jsx(At,{className:"animate-spin",size:16}):d.jsx(th,{size:16})})]})]})]},j.id)})]}),l&&d.jsx(Mr,{isOpen:l,onClose:()=>u(!1),title:f?"Edit Advisory":"Create New Advisory",size:"2xl",children:d.jsx(L$,{initialData:f,onSubmit:B,onCancel:()=>u(!1),isSaving:y,showNotification:t})}),x&&S&&d.jsxs(tc,{isOpen:x,onClose:()=>w(!1),onConfirm:k,title:"Confirm Deletion",isConfirming:!!_,confirmText:"Yes, Delete",iconType:"danger",children:['Delete advisory "',S.title,'"? This cannot be undone.']})]})};Pm.register(gy,yy,Of,ff,Tg,hf,cR,dR,aR);const Nt={blue:"rgba(59, 130, 246, 0.6)",blueBorder:"rgba(59, 130, 246, 1)",green:"rgba(16, 185, 129, 0.6)",greenBorder:"rgba(16, 185, 129, 1)",purple:"rgba(139, 92, 246, 0.6)",purpleBorder:"rgba(139, 92, 246, 1)",red:"rgba(239, 68, 68, 0.6)",redBorder:"rgba(239, 68, 68, 1)",orange:"rgba(249, 115, 22, 0.6)",orangeBorder:"rgba(249, 115, 22, 1)",teal:"rgba(20, 184, 166, 0.6)",tealBorder:"rgba(20, 184, 166, 1)",sky:"rgba(14, 165, 233, 0.6)",skyBorder:"rgba(14, 165, 233, 1)",pink:"rgba(236, 72, 153, 0.6)",yellow:"rgba(234, 179, 8, 0.6)"},IR=r=>({responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"bottom"},title:{display:!0,text:r,font:{size:16},color:"#374151",padding:{bottom:15}},tooltip:{backgroundColor:"#1F2937",titleColor:"#E5E7EB",bodyColor:"#D1D5DB",borderColor:"#4B5563",borderWidth:1,padding:10,boxPadding:3}},scales:{y:{beginAtZero:!0,grid:{color:"#E5E7EB"},ticks:{color:"#6B7280"}},x:{grid:{display:!1},ticks:{color:"#6B7280"}}}}),eg=({data:r,title:e,label:t,color:n,borderColor:i})=>{if(!r||Object.keys(r).length===0)return d.jsxs("p",{className:"text-sm text-gray-500 text-center py-10",children:["No data available for ",e,"."]});const s={labels:Object.keys(r),datasets:[{label:t,data:Object.values(r),backgroundColor:n,borderColor:i,borderWidth:1,borderRadius:4}]};return d.jsx("div",{className:"h-72 w-full",children:d.jsx(pR,{options:IR(e),data:s})})},l4=({data:r,title:e,datasets:t})=>{if(!r||r.length===0)return d.jsxs("p",{className:"text-sm text-gray-500 text-center py-10",children:["No data available for ",e,"."]});let n;return t?n={labels:Object.keys(r),datasets:t.map(i=>({...i,data:Object.values(r).map(s=>s[i.key]||0)}))}:n={labels:Array.from({length:24},(s,o)=>`${o}:00`),datasets:[{label:"Tickets",data:r.map(s=>s.tickets),borderColor:Nt.blueBorder,backgroundColor:Nt.blue,tension:.1},{label:"Readings",data:r.map(s=>s.readings),borderColor:Nt.greenBorder,backgroundColor:Nt.green,tension:.1},{label:"Payments",data:r.map(s=>s.payments),borderColor:Nt.purpleBorder,backgroundColor:Nt.purple,tension:.1}]},d.jsx("div",{className:"h-72 w-full",children:d.jsx(Dq,{options:IR(e),data:n})})},tg=({data:r,title:e})=>{if(!r||Object.keys(r).length===0)return d.jsxs("p",{className:"text-sm text-gray-500 text-center py-10",children:["No data for ",e,"."]});const t={labels:Object.keys(r),datasets:[{data:Object.values(r),backgroundColor:[Nt.blue,Nt.green,Nt.purple,Nt.orange,Nt.red,Nt.teal,Nt.sky,Nt.pink,Nt.yellow],borderColor:"#FFFFFF",borderWidth:2}]},n={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"bottom",labels:{boxWidth:12,padding:15}},title:{display:!0,text:e,font:{size:16},color:"#374151",padding:{bottom:15}},tooltip:{backgroundColor:"#1F2937",titleColor:"#E5E7EB",bodyColor:"#D1D5DB",borderColor:"#4B5563",borderWidth:1,padding:10,boxPadding:3}}};return d.jsx("div",{className:"h-72 w-full",children:d.jsx(Lq,{options:n,data:t})})},V$=({data:r,title:e})=>{if(!r||Object.keys(r).length===0)return d.jsxs("p",{className:"text-sm text-gray-500 text-center py-10",children:["No data for ",e,"."]});const t={labels:Object.keys(r),datasets:[{data:Object.values(r),backgroundColor:[Nt.teal,Nt.orange,Nt.pink,Nt.yellow,Nt.sky,Nt.blue,Nt.green,Nt.purple,Nt.red],borderColor:"#FFFFFF",borderWidth:2}]},n={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"bottom",labels:{boxWidth:12,padding:15}},title:{display:!0,text:e,font:{size:16},color:"#374151",padding:{bottom:15}},tooltip:{backgroundColor:"#1F2937",titleColor:"#E5E7EB",bodyColor:"#D1D5DB",borderColor:"#4B5563",borderWidth:1,padding:10,boxPadding:3}}};return d.jsx("div",{className:"h-72 w-full",children:d.jsx(Fq,{options:n,data:t})})},To=({title:r,value:e,icon:t,color:n})=>d.jsx("div",{className:"bg-gray-50 p-4 rounded-lg shadow border-l-4",style:{borderColor:n},children:d.jsxs("div",{className:"flex items-center",children:[d.jsx("div",{className:"p-2 rounded-full mr-3",style:{backgroundColor:`${n}20`},children:d.jsx(t,{size:20,style:{color:n}})}),d.jsxs("div",{children:[d.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase",children:r}),d.jsx("p",{className:"text-xl font-bold text-gray-800",children:e})]})]})}),z$=({showNotification:r=console.log})=>{var y,g,_,E,x,w,S;const[e,t]=te.useState(null),[n,i]=te.useState(!0),[s,o]=te.useState(""),l=te.useCallback(async()=>{i(!0),o("");try{const I=await Promise.allSettled([WC(Jt),GC(Jt),a9(Jt),M9(Jt),D9(Jt),L9(Jt),l9(Jt),c9(Jt),F9(Jt),V9(Jt),z9(Jt)]),[C,N,R,B,P,k,F,j,O,D,M]=I;let $="";const G={};C.status==="fulfilled"&&C.value.success?(G.usersByRole=C.value.data.byRole,G.totalUsers=C.value.data.total):$+="User stats failed. ",N.status==="fulfilled"&&N.value.success?(G.ticketStats=N.value.data.byStatus,G.ticketsByType=N.value.data.byType,G.totalTickets=N.value.data.total):$+="Ticket stats failed. ",R.status==="fulfilled"&&R.value.success?G.monthlyRevenue=R.value.data:$+="Monthly revenue failed. ",B.status==="fulfilled"&&B.value.success?G.hourlyActivity=B.value.data:$+="Hourly activity failed. ",P.status==="fulfilled"&&P.value.success?G.staffActivity=P.value.data:$+="Staff activity failed. ",k.status==="fulfilled"&&k.value.success?G.techStats=k.value.data:$+="Technical stats failed. ",F.status==="fulfilled"&&F.value.success?G.revenueByLocation=F.value.data:$+="Location revenue failed. ",j.status==="fulfilled"&&j.value.success?G.outstandingBalance=j.value.data.totalOutstanding:$+="Outstanding balance failed. ",O.status==="fulfilled"&&O.value.success?G.monthlyConsumption=O.value.data:$+="Consumption stats failed. ",D.status==="fulfilled"&&D.value.success?G.paymentMethods=D.value.data:$+="Payment methods failed. ",M.status==="fulfilled"&&M.value.success?G.userGrowth=M.value.data:$+="User growth failed. ",$&&o($.trim()),t(G)}catch(I){o("Critical error fetching statistics."),console.error("fetchStatistics error:",I)}finally{i(!1)}},[]);te.useEffect(()=>{l()},[l]);const u=()=>{window.print()},f=te.useMemo(()=>e!=null&&e.monthlyRevenue?Object.values(e.monthlyRevenue).reduce((I,C)=>I+C,0):0,[e==null?void 0:e.monthlyRevenue]),m=te.useMemo(()=>e!=null&&e.monthlyConsumption?Object.values(e.monthlyConsumption).reduce((I,C)=>I+C,0):0,[e==null?void 0:e.monthlyConsumption]);return n?d.jsx(pn,{message:"Loading system analytics...",className:"mt-10 h-64"}):d.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-200 no-print",children:[d.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center",children:[d.jsx(y2,{size:30,className:"mr-3 text-orange-600"})," System Analytics"]}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("button",{onClick:l,disabled:n,className:"flex items-center text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-3 rounded-lg border border-gray-300",children:[n?d.jsx(At,{size:16,className:"animate-spin mr-2"}):d.jsx(Ma,{size:16,className:"mr-2"}),"Refresh"]}),d.jsxs("button",{onClick:u,className:"flex items-center text-sm bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-3 rounded-lg",children:[d.jsx(S2,{size:16,className:"mr-2"})," Print Report"]})]})]}),s&&d.jsxs("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 p-4 my-4 flex items-center no-print",role:"alert",children:[d.jsx(kn,{size:20,className:"mr-3"}),d.jsxs("p",{children:["Could not load all statistics: ",s]})]}),d.jsxs("div",{id:"stats-print-area",children:[d.jsxs("header",{className:"hidden print:block text-center mb-8",children:[d.jsx("h1",{className:"text-3xl font-bold text-blue-700",children:"AGWA System Analytics Report"}),d.jsxs("p",{className:"text-sm text-gray-500",children:["Generated: ",new Date().toLocaleString()]})]}),d.jsxs("div",{className:"space-y-8",children:[d.jsxs("section",{className:"print-section",children:[d.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[d.jsx(Ox,{size:22,className:"mr-2 text-green-600"}),"Business Analytics"]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[d.jsx(To,{title:"Total Revenue (12 Mo.)",value:`${f.toLocaleString("en-US",{minimumFractionDigits:0})}`,icon:Ox,color:Nt.greenBorder}),d.jsx(To,{title:"Total Outstanding",value:`${((e==null?void 0:e.outstandingBalance)??0).toLocaleString("en-US",{minimumFractionDigits:0})}`,icon:t3,color:Nt.redBorder}),d.jsx(To,{title:"Total Consumption (12 Mo.)",value:`${m.toLocaleString("en-US")} m`,icon:J9,color:Nt.blueBorder})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:d.jsx(eg,{data:(e==null?void 0:e.monthlyRevenue)||{},title:"Monthly Collected Revenue (Last 12 Months)",label:"Revenue",color:Nt.green,borderColor:Nt.greenBorder})}),d.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:d.jsx(eg,{data:(e==null?void 0:e.monthlyConsumption)||{},title:"Monthly Water Consumption (Last 12 Months)",label:"Consumption (m)",color:Nt.blue,borderColor:Nt.blueBorder})}),d.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:d.jsx(tg,{data:e==null?void 0:e.revenueByLocation,title:"Revenue by Location"})}),d.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:d.jsx(tg,{data:e==null?void 0:e.paymentMethods,title:"Payments by Method"})})]})]}),d.jsxs("section",{className:"print-section pt-6 border-t",children:[d.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[d.jsx(wa,{size:22,className:"mr-2 text-purple-600"}),"User & Support Analytics"]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[d.jsx(To,{title:"Total Users",value:(e==null?void 0:e.totalUsers)??"N/A",icon:wa,color:Nt.purpleBorder}),d.jsx(To,{title:"Total Tickets",value:(e==null?void 0:e.totalTickets)??"N/A",icon:ka,color:Nt.orangeBorder}),d.jsx(To,{title:"Open Tickets",value:((y=e==null?void 0:e.ticketStats)==null?void 0:y.Open)??"0",icon:Qt,color:Nt.redBorder})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:d.jsx(l4,{data:(e==null?void 0:e.userGrowth)||{},title:"New User Signups (Last 12 Months)",datasets:[{label:"New Users",key:"users",borderColor:Nt.purpleBorder,backgroundColor:Nt.purple,tension:.1,data:Object.values((e==null?void 0:e.userGrowth)||{})}]})}),d.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:d.jsx(tg,{data:e==null?void 0:e.usersByRole,title:"Users by Role"})}),d.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:d.jsx(V$,{data:e==null?void 0:e.ticketsByType,title:"Tickets by Type"})}),d.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:d.jsx(tg,{data:e==null?void 0:e.ticketStats,title:"Support Tickets by Status"})})]})]}),d.jsxs("section",{className:"print-section pt-6 border-t",children:[d.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center",children:[d.jsx(s3,{size:22,className:"mr-2 text-sky-600"}),"Staff & Technical Analytics"]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[d.jsx(To,{title:"Total Routes",value:((g=e==null?void 0:e.techStats)==null?void 0:g.totalRoutes)??"N/A",icon:Na,color:Nt.tealBorder}),d.jsx(To,{title:"Total Accounts",value:((_=e==null?void 0:e.techStats)==null?void 0:_.totalAccounts)??"N/A",icon:wa,color:Nt.tealBorder}),d.jsx(To,{title:"Active Interruptions",value:((E=e==null?void 0:e.techStats)==null?void 0:E.activeInterrupts)??"N/A",icon:Qt,color:Nt.redBorder}),d.jsx(To,{title:"Unassigned Routes",value:((x=e==null?void 0:e.techStats)==null?void 0:x.unassignedRoutes)??"N/A",icon:r0,color:Nt.orangeBorder})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[d.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:d.jsx(eg,{data:((w=e==null?void 0:e.staffActivity)==null?void 0:w.readerActivity)||{},title:"Readings Submitted Today (by Staff)",label:"Readings",color:Nt.sky,borderColor:Nt.skyBorder})}),d.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:d.jsx(eg,{data:((S=e==null?void 0:e.staffActivity)==null?void 0:S.clerkActivity)||{},title:"Payments Processed Today (by Staff)",label:"Payments",color:Nt.purple,borderColor:Nt.purpleBorder})}),d.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border",children:d.jsx(l4,{data:(e==null?void 0:e.hourlyActivity)||[],title:"Hourly Portal Activity (Today)"})})]})]})]})]}),d.jsx("style",{children:`
                @media print {
                    .no-print { display: none !important; }
                    .print-section { 
                        page-break-inside: avoid; 
                        margin-bottom: 2rem; 
                        border-top: 1px solid #eee !important; 
                        padding-top: 1rem !important;
                    }
                    body, .bg-white { background-color: #FFFFFF !important; }
                    .shadow-xl, .shadow-md, .shadow-lg, .border { border: none !important; box-shadow: none !imporant; }
                    .bg-gray-50 { background-color: #F9FAFB !important; -webkit-print-color-adjust: exact; print-color-adjust: exact; }
                    
                    /* Reset dashboard layout for printing */
                    div.lg\\:pl-64 {
                        padding-left: 0 !important;
                    }
                    main.print\\:p-4 {
                        padding: 1rem !important;
                    }
                }
                `})]})},B$=({isOpen:r,onClose:e,onSave:t,reading:n,isSaving:i,accountNumber:s})=>{const[o,l]=te.useState({});te.useEffect(()=>{var f;if(n){const m=(f=n.readingDate)!=null&&f.toDate?n.readingDate.toDate():new Date(n.readingDate),y=m.getFullYear(),g=String(m.getMonth()+1).padStart(2,"0"),_=String(m.getDate()).padStart(2,"0");l({readingValue:n.readingValue||"",readingDate:`${y}-${g}-${_}`,readingType:n.readingType||"Actual",notes:n.notes||""})}else l({readingValue:"",readingDate:new Date().toISOString().split("T")[0],readingType:"Actual",notes:""})},[n]);const u=f=>{f.preventDefault(),t(n==null?void 0:n.id,o)};return r?d.jsx(Mr,{isOpen:r,onClose:e,title:n?`Edit Reading for ${n.accountNumber}`:`Create New Reading for ${s}`,children:d.jsxs("form",{onSubmit:u,className:"space-y-4",children:[d.jsxs("div",{children:[d.jsxs("label",{htmlFor:"readingValue",className:"text-sm font-medium text-gray-700 flex items-center mb-1",children:[d.jsx(Ql,{size:14,className:"mr-1.5"}),"Reading Value (m)"]}),d.jsx("input",{type:"number",name:"readingValue",value:o.readingValue,onChange:f=>l({...o,readingValue:f.target.value}),className:Mi,step:"0.01",required:!0})]}),d.jsxs("div",{children:[d.jsxs("label",{htmlFor:"readingDate",className:"text-sm font-medium text-gray-700 flex items-center mb-1",children:[d.jsx(du,{size:14,className:"mr-1.5"}),"Reading Date"]}),d.jsx("input",{type:"date",name:"readingDate",value:o.readingDate,onChange:f=>l({...o,readingDate:f.target.value}),className:Mi,required:!0})]}),d.jsxs("div",{children:[d.jsxs("label",{htmlFor:"readingType",className:"text-sm font-medium text-gray-700 flex items-center mb-1",children:[d.jsx(Z9,{size:14,className:"mr-1.5"}),"Reading Type"]}),d.jsxs("select",{name:"readingType",value:o.readingType,onChange:f=>l({...o,readingType:f.target.value}),className:Mi,children:[d.jsx("option",{value:"Actual",children:"Actual"}),d.jsx("option",{value:"Estimated",children:"Estimated"}),d.jsx("option",{value:"No Reading",children:"No Reading"})]})]}),d.jsxs("div",{children:[d.jsxs("label",{htmlFor:"notes",className:"text-sm font-medium text-gray-700 flex items-center mb-1",children:[d.jsx(pF,{size:14,className:"mr-1.5"}),"Notes"]}),d.jsx("textarea",{name:"notes",rows:"3",value:o.notes,onChange:f=>l({...o,notes:f.target.value}),className:Mi})]}),d.jsxs("div",{className:"pt-4 flex justify-end space-x-3",children:[d.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg border",disabled:i,children:"Cancel"}),d.jsxs("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg flex items-center",disabled:i,children:[i?d.jsx(At,{size:18,className:"animate-spin mr-2"}):d.jsx(Da,{size:18,className:"mr-2"}),i?"Saving...":"Save Changes"]})]})]})}):null},U$=({showNotification:r,userData:e})=>{var ie,oe,ee;const[t,n]=te.useState(""),[i,s]=te.useState(null),[o,l]=te.useState(!1),[u,f]=te.useState(""),[m,y]=te.useState(!1),[g,_]=te.useState(null),[E,x]=te.useState(!1),[w,S]=te.useState(null),[I,C]=te.useState(!1),[N,R]=te.useState(!1),B=async J=>{if(J.preventDefault(),!t.trim()){f("Please enter an account number.");return}l(!0),f(""),y(!0),s(null);try{const Y=ct(Jt,sr()),q=wt(Y,bt("accountNumber","==",t.trim().toUpperCase())),Z=await St(q);if(Z.empty){f("No user found with the provided account number."),l(!1);return}const ne=Z.docs[0];await P({id:ne.id,...ne.data()})}catch(Y){console.error("Error searching for user or readings:",Y),f("An error occurred during the search. Check Firestore rules and indexes."),l(!1)}},P=async J=>{const Y=ct(Jt,Vo()),q=wt(Y,bt("userId","==",J.id),ei("readingDate","desc")),ne=(await St(q)).docs.map(se=>({id:se.id,...se.data()}));s({user:J,readings:ne}),l(!1)},k=J=>{x(!1),_(J)},F=()=>{if(!(i!=null&&i.user)){r("Please search for a user first before creating a reading.","warning");return}_(null),x(!0)},j=()=>{_(null),x(!1)},O=async(J,Y)=>{C(!0);const q=await S9(Jt,J,Y);q.success?(r("Meter reading updated successfully!","success"),await P(i.user),j()):r(q.error||"Failed to update reading.","error"),C(!1)},D=async(J,Y)=>{C(!0);const q={...Y,userId:i.user.id,accountNumber:i.user.accountNumber,meterSerialNumber:i.user.meterSerialNumber||"N/A",readBy:e.displayName||"Admin",readerId:e.uid},Z=await HC(Jt,q);Z.success?(r("New meter reading created successfully!","success"),await P(i.user),j()):r(Z.error||"Failed to create reading.","error"),C(!1)},M=async()=>{if(!(i!=null&&i.user)){r("Please search for a user first.","error");return}R(!0);const J=await BC(Jt,i.user.id,i.user);J.success?r(J.message,"success"):r(J.error,"error"),R(!1)},$=J=>{S(J)},G=async()=>{if(!w)return;C(!0);const J=await A9(Jt,w);J.success?(r("Meter reading deleted successfully!","success"),await P(i.user)):r(J.error||"Failed to delete reading.","error"),S(null),C(!1)};return d.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl",children:[d.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Meter Reading & Billing"}),d.jsxs("form",{onSubmit:B,className:"mb-6 flex flex-col sm:flex-row gap-2 items-center bg-gray-50 p-4 rounded-lg shadow-sm",children:[d.jsx("input",{type:"text",value:t,onChange:J=>n(J.target.value),placeholder:"Enter user account number...",className:"w-full p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500"}),d.jsxs("button",{type:"submit",disabled:o,className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 disabled:bg-blue-400 flex items-center justify-center w-full sm:w-auto",children:[o?d.jsx(At,{className:"animate-spin mr-2"}):d.jsx(Rs,{className:"mr-2",size:18}),o?"Searching...":"Search"]})]}),u&&d.jsx("p",{className:"text-red-500 text-center mb-4",children:u}),o&&d.jsx(pn,{message:"Fetching data..."}),(i==null?void 0:i.user)&&d.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-lg shadow-md mt-6 border border-gray-200",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-3",children:[d.jsxs("h2",{className:"text-xl font-semibold",children:["Data for ",i.user.displayName," (",i.user.accountNumber,")"]}),d.jsxs("div",{className:"flex gap-2 flex-wrap",children:[d.jsxs("button",{onClick:F,className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 flex items-center text-sm",children:[d.jsx(e0,{size:16,className:"mr-2"})," Create Reading"]}),d.jsxs("button",{onClick:M,className:"bg-cyan-600 text-white px-4 py-2 rounded-md hover:bg-cyan-700 flex items-center text-sm disabled:bg-gray-400",disabled:N||i.readings.length<2,title:i.readings.length<2?"At least 2 readings are required to generate a bill":"Generate bill from latest reading",children:[N?d.jsx(At,{size:16,className:"animate-spin mr-2"}):d.jsx(Zl,{size:16,className:"mr-2"}),N?"Generating...":"Generate Bill"]})]})]}),d.jsxs("div",{className:"overflow-x-auto",children:[d.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[d.jsx("thead",{className:"bg-gray-50",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reading (m)"}),d.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),d.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reader"}),d.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),d.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(ie=i.readings)==null?void 0:ie.map(J=>d.jsxs("tr",{children:[d.jsx("td",{className:"px-4 py-4 whitespace-nowrap font-medium",children:J.readingValue}),d.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:Yt(J.readingDate,{year:"numeric",month:"short",day:"numeric"})}),d.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:J.readBy||"N/A"}),d.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:J.readingType||"N/A"}),d.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-center space-x-2",children:[d.jsx("button",{onClick:()=>k(J),className:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded-md transition-colors",title:"Edit Reading",children:d.jsx(Xf,{size:16})}),d.jsx("button",{onClick:()=>$(J.id),className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-100 rounded-md transition-colors",title:"Delete Reading",children:d.jsx(th,{size:16})})]})]},J.id))})]}),((oe=i.readings)==null?void 0:oe.length)<2&&d.jsx("p",{className:"text-xs text-center text-yellow-600 bg-yellow-50 p-2 mt-2 rounded-md",children:"Note: At least two readings are needed before a bill can be generated."})]})]}),(g||E)&&d.jsx(B$,{isOpen:!0,onClose:j,onSave:E?D:O,reading:g,isSaving:I,accountNumber:(ee=i==null?void 0:i.user)==null?void 0:ee.accountNumber}),w&&d.jsx(tc,{isOpen:!!w,onClose:()=>S(null),onConfirm:G,title:"Confirm Deletion",confirmText:"Yes, Delete",isConfirming:I,iconType:"danger",children:"Are you sure you want to permanently delete this meter reading? This action cannot be undone."})]})},od="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition-150 text-sm",q$=({isOpen:r,onClose:e,onSave:t,route:n,readers:i,isSaving:s,db:o})=>{const[l,u]=te.useState({name:"",areaCode:"",description:"",assignedReaderId:"",district:"",barangay:""}),[f,m]=te.useState([]),[y,g]=te.useState([]),[_,E]=te.useState([]),[x,w]=te.useState(!1);te.useEffect(()=>{if(r)if(g(c0()),n){const P=n.district||"";u({name:n.name||"",areaCode:n.areaCode||"",description:n.description||"",assignedReaderId:n.assignedReaderId||"",district:P,barangay:n.barangay||""}),P&&E(mu(P)),m(n.accountNumbers||[])}else u({name:"",areaCode:"",description:"",assignedReaderId:"",district:"",barangay:""}),m([]),E([])},[n,r]);const S=P=>{const k=P.target.value;u(F=>({...F,district:k,barangay:""})),E(mu(k)),m([])},I=async P=>{const k=P.target.value;if(u(F=>({...F,barangay:k})),k){w(!0);const F=await n9(o,k);F.success&&m(F.data),w(!1)}else m([])},C=P=>P?P.split(" ").map(k=>k[0]).join("").toUpperCase():"",N=P=>{const k=P.target.value;u(F=>({...F,name:k,areaCode:C(k)}))},R=P=>{const{name:k,value:F}=P.target;u(j=>({...j,[k]:F}))},B=P=>{P.preventDefault(),t({name:l.name,areaCode:l.areaCode,description:l.description,assignedReaderId:l.assignedReaderId,district:l.district,barangay:l.barangay,accountNumbers:f})};return d.jsx(Mr,{isOpen:r,onClose:e,title:n?"Edit Meter Route":"Create New Meter Route",size:"2xl",children:d.jsxs("form",{onSubmit:B,className:"space-y-4",children:[d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"name",className:"block text-sm font-medium mb-1",children:"Route Name"}),d.jsx("input",{type:"text",name:"name",value:l.name,onChange:N,className:od,required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"areaCode",className:"block text-sm font-medium mb-1",children:"Generated Area Code"}),d.jsx("input",{type:"text",name:"areaCode",value:l.areaCode,className:`${od} bg-gray-200`,readOnly:!0})]})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"district",className:"block text-sm font-medium mb-1",children:"District"}),d.jsxs("select",{name:"district",value:l.district,onChange:S,className:od,required:!0,children:[d.jsx("option",{value:"",children:"Select District"}),y.map(P=>d.jsx("option",{value:P,children:P},P))]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"barangay",className:"block text-sm font-medium mb-1",children:"Barangay"}),d.jsxs("select",{name:"barangay",value:l.barangay,onChange:I,className:od,required:!0,disabled:!l.district,children:[d.jsx("option",{value:"",children:"Select Barangay"}),_.map(P=>d.jsx("option",{value:P,children:P},P))]})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"assignedReaderId",className:"block text-sm font-medium mb-1",children:"Assign to Meter Reader"}),d.jsxs("select",{name:"assignedReaderId",value:l.assignedReaderId,onChange:R,className:od,children:[d.jsx("option",{value:"",children:"Unassigned"}),i.map(P=>d.jsxs("option",{value:P.id,children:[P.displayName," (",P.email,")"]},P.id))]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"description",className:"block text-sm font-medium mb-1",children:"Description"}),d.jsx("textarea",{name:"description",value:l.description,onChange:R,rows:"2",className:od})]}),d.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[d.jsxs("p",{className:"text-sm font-medium text-blue-800 flex items-center",children:[d.jsx(oF,{size:16,className:"mr-2"}),"Auto-Assigned Accounts"]}),x?d.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[d.jsx(At,{className:"animate-spin h-4 w-4 mr-2"}),"Searching for accounts..."]}):l.barangay&&f.length>0?d.jsxs("p",{className:"text-sm text-gray-700",children:[f.length," accounts found for ",l.barangay," and will be assigned."]}):l.barangay&&f.length===0?d.jsxs("p",{className:"text-sm text-orange-700 bg-orange-100 p-2 rounded-md flex items-center",children:[d.jsx(kn,{size:14,className:"mr-2"}),"No accounts found for this location. You cannot save an empty route."]}):d.jsx("p",{className:"text-xs text-gray-500",children:"Select a location to find and assign real accounts from your database."})]}),d.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[d.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium bg-gray-200 rounded-lg",disabled:s,children:"Cancel"}),d.jsxs("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg flex items-center disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:s||x||f.length===0,children:[s?d.jsx(At,{size:18,className:"animate-spin mr-2"}):d.jsx(Da,{size:18,className:"mr-2"}),s?"Saving...":"Save Route"]})]})]})})},H$=({db:r,showNotification:e})=>{const[t,n]=te.useState([]),[i,s]=te.useState([]),[o,l]=te.useState(!0),[u,f]=te.useState(""),[m,y]=te.useState(!1),[g,_]=te.useState(null),[E,x]=te.useState(!1),[w,S]=te.useState(null),I=te.useCallback(async()=>{l(!0),f("");try{const[k,F]=await Promise.all([i9(r),o9(r)]);k.success?n(k.data):f(k.error||"Failed to load routes."),F.success?s(F.data):f(j=>j+(F.error||" Failed to load meter readers."))}catch{f("An unexpected error occurred while fetching data.")}l(!1)},[r]);te.useEffect(()=>{I()},[I]);const C=(k=null)=>{_(k),y(!0)},N=()=>{_(null),y(!1)},R=async k=>{x(!0);const F=await r9(r,k,g==null?void 0:g.id);F.success?(e(`Route ${g?"updated":"created"} successfully!`,"success"),I(),N()):e(F.error||"Failed to save route.","error"),x(!1)},B=async()=>{if(!w)return;x(!0);const k=await s9(r,w.id);k.success?(e("Route deleted successfully!","success"),S(null),I()):e(k.error||"Failed to delete route.","error"),x(!1)},P=k=>{var F;return((F=i.find(j=>j.id===k))==null?void 0:F.displayName)||"Unassigned"};return o?d.jsx(pn,{message:"Loading route data..."}):d.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[d.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center",children:[d.jsx(Xl,{size:30,className:"mr-3 text-blue-600"})," Meter Route Management"]}),d.jsxs("button",{onClick:()=>C(),className:"bg-blue-600 text-white font-medium py-2 px-4 rounded-lg flex items-center",children:[d.jsx(e0,{size:18,className:"mr-2"})," Add New Route"]})]}),u&&d.jsx("p",{className:"text-red-500 mb-4",children:u}),d.jsx("div",{className:"space-y-3",children:t.length>0?t.map(k=>{var F;return d.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 flex justify-between items-center",children:[d.jsxs("div",{children:[d.jsxs("p",{className:"font-bold text-gray-800",children:[k.name," ",d.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["(",k.areaCode,")"]})]}),d.jsxs("p",{className:"text-xs text-gray-600 flex items-center mt-1",children:[d.jsx(_F,{size:12,className:"mr-1.5"}),"Assigned to: ",d.jsx("span",{className:"font-medium ml-1",children:P(k.assignedReaderId)})]}),d.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Accounts: ",((F=k.accountNumbers)==null?void 0:F.length)||0]})]}),d.jsxs("div",{className:"flex items-center space-x-2",children:[d.jsx("button",{onClick:()=>C(k),className:"p-2 text-blue-600 hover:bg-blue-100 rounded-full",children:d.jsx(Xf,{size:18})}),d.jsx("button",{onClick:()=>S(k),className:"p-2 text-red-600 hover:bg-red-100 rounded-full",children:d.jsx(th,{size:18})})]})]},k.id)}):d.jsxs("div",{className:"text-center py-10",children:[d.jsx(kn,{size:48,className:"mx-auto text-gray-400 mb-3"}),d.jsx("p",{className:"text-gray-500",children:"No routes found. Click 'Add New Route' to create one."})]})}),m&&d.jsx(q$,{isOpen:m,onClose:N,onSave:R,route:g,readers:i,isSaving:E,db:r}),w&&d.jsxs(tc,{isOpen:!!w,onClose:()=>S(null),onConfirm:B,title:"Confirm Route Deletion",isConfirming:E,children:['Are you sure you want to delete the route "',w.name,'"? This action cannot be undone.']})]})},$$=({db:r,showNotification:e})=>{const[t,n]=te.useState([]),[i,s]=te.useState(""),[o,l]=te.useState([]),[u,f]=te.useState(!1),[m,y]=te.useState(!1),[g,_]=te.useState([]);te.useEffect(()=>{(async()=>{const S=await t9(r);S.success?n(S.data):e(S.error,"error")})()},[r,e]);const E=async w=>{if(s(w),!w){l([]);return}f(!0),l([]);const S=await h9(r,w);S.success?l(S.data):e(S.error,"error"),f(!1)},x=async()=>{if(o.length===0){e("No billable accounts in the selected area.","warning");return}y(!0),_([]);const w=await f9(r,o);_(w),y(!1),e("Batch billing process completed. Check logs for details.","success"),E(i)};return d.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl",children:[d.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center mb-4",children:[d.jsx(Zl,{size:30,className:"mr-3 text-green-600"})," Batch Bill Generation"]}),d.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Select a service area to find eligible accounts and generate bills in bulk. An account is eligible if it has a new reading that has not yet been billed."}),d.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border",children:[d.jsx("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Service Area (Barangay)"}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[d.jsxs("select",{id:"location",value:i,onChange:w=>E(w.target.value),className:"w-full p-2 border rounded-md bg-white",children:[d.jsx("option",{value:"",children:"-- Select an Area --"}),t.map(w=>d.jsx("option",{value:w,children:w},w))]}),d.jsxs("button",{onClick:x,className:"bg-green-600 text-white px-5 py-2 rounded-md flex items-center justify-center whitespace-nowrap disabled:bg-gray-400",disabled:u||m||o.length===0,children:[m?d.jsx(At,{size:18,className:"animate-spin mr-2"}):d.jsx(K9,{size:18,className:"mr-2"}),m?"Processing...":`Generate ${o.length} Bills`]})]})]}),d.jsxs("div",{className:"mt-6",children:[d.jsxs("h3",{className:"font-semibold",children:["Eligible Accounts in ",i||"..."]}),u&&d.jsx(pn,{message:"Finding billable accounts..."}),!u&&i&&o.length===0&&d.jsxs("div",{className:"text-center py-6 bg-gray-50 mt-2 rounded-md",children:[d.jsx(kn,{size:32,className:"mx-auto text-gray-400 mb-2"}),d.jsx("p",{className:"text-gray-600",children:"No new readings eligible for billing in this area."})]}),!u&&o.length>0&&d.jsxs("p",{className:"text-green-700 font-medium my-2",children:[o.length," accounts ready for billing."]})]}),g.length>0&&d.jsxs("div",{className:"mt-6 pt-4 border-t",children:[d.jsx("h3",{className:"font-semibold mb-2",children:"Processing Log"}),d.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto bg-gray-900 text-white font-mono text-xs p-4 rounded-md",children:g.map((w,S)=>d.jsxs("div",{className:`flex items-start ${w.success?"text-green-400":"text-red-400"}`,children:[w.success?d.jsx(ks,{size:14,className:"mr-2 mt-0.5 flex-shrink-0"}):d.jsx(Qt,{size:14,className:"mr-2 mt-0.5 flex-shrink-0"}),d.jsx("span",{children:w.message})]},S))})]})]})},W$=({userData:r,db:e,showNotification:t,setActiveSection:n})=>{const[i,s]=te.useState({assignedRoutesCount:0,totalAccountsInRoutes:0,pendingReadingsInRoutes:0,readingsCompletedToday:0,issuesReportedByMe:0}),[o,l]=te.useState(!0),[u,f]=te.useState(""),m=te.useCallback(async()=>{if(!r||!r.uid){t("Meter reader data not available.","error"),l(!1);return}l(!0),f("");try{const g={};let _="";const E=await $C(e,r.uid);E.success&&E.data?(g.assignedRoutesCount=E.data.length,g.totalAccountsInRoutes=E.data.reduce((I,C)=>{var N;return I+(C.accountCount||((N=C.accountNumbers)==null?void 0:N.length)||0)},0),g.pendingReadingsInRoutes=E.data.reduce((I,C)=>I+(C.pendingCount||0),0)):_+="Route data unavailable. ";const x=new Date().toISOString().split("T")[0],w=await u9(e,r.uid,x);w.success?g.readingsCompletedToday=w.data.count:_+="Today's readings data unavailable. ";const S=await qC(e,r.uid);S.success&&(g.issuesReportedByMe=S.data.length),s(I=>({...I,...g})),_&&(f(_.trim()),t("Some dashboard statistics could not be loaded.","warning"))}catch{const _="Could not load meter reader dashboard statistics. Please try refreshing.";f(_),t(_,"error")}finally{l(!1)}},[e,r,t]);te.useEffect(()=>{m()},[m]);const y=[{title:"View Assigned Routes",icon:Xl,section:"assignedRoutes",description:"Check your daily routes and assigned accounts for reading.",color:"blue"},{title:"Manual Reading Entry",icon:_2,section:"searchAndSubmitReading",description:"Submit a reading for an account not on your immediate list.",color:"green"},{title:"Search Customer Info",icon:Rs,section:"searchCustomerMeterReader",description:"Look up customer or meter details for verification.",color:"teal"},{title:"Report Field Issue",icon:Qt,section:"reportIssue",description:"Log issues like meter damage, leaks, or access problems.",color:"orange"}];return o?d.jsx(pn,{message:"Loading your dashboard...",className:"mt-10 h-48"}):d.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[d.jsx("div",{className:"p-6 bg-gradient-to-r from-sky-600 to-cyan-700 text-white rounded-xl shadow-xl",children:d.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl sm:text-3xl font-bold",children:"Meter Reader Dashboard"}),d.jsxs("p",{className:"mt-1 text-sky-100",children:["Welcome, ",r.displayName||"Meter Reader","! Your tasks and tools are below."]})]}),d.jsxs("button",{onClick:m,className:"mt-3 sm:mt-0 text-sm flex items-center bg-sky-500 hover:bg-sky-400 text-white font-medium py-2 px-3 rounded-lg transition-colors disabled:opacity-70 self-start sm:self-center",disabled:o,title:"Refresh Statistics",children:[o?d.jsx(At,{size:16,className:"animate-spin"}):d.jsx(Ma,{size:16}),d.jsx("span",{className:"ml-2 hidden sm:inline",children:"Refresh"})]})]})}),u&&d.jsxs("p",{className:"text-sm text-yellow-600 bg-yellow-50 p-3 rounded-md text-center my-4 flex items-center justify-center gap-2",children:[d.jsx(kn,{size:16})," ",u]}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5",children:[d.jsx(di,{title:"Assigned Routes",value:i.assignedRoutesCount,icon:Xl,borderColor:"border-blue-500",iconColor:"text-blue-500",onClick:()=>n("assignedRoutes")}),d.jsx(di,{title:"Pending Readings",value:i.pendingReadingsInRoutes,icon:sF,borderColor:"border-orange-500",iconColor:"text-orange-500",subtext:`Across ${i.totalAccountsInRoutes} total accounts`,onClick:()=>n("assignedRoutes")}),d.jsx(di,{title:"Readings Done Today",value:i.readingsCompletedToday,icon:ks,borderColor:"border-green-500",iconColor:"text-green-500"}),d.jsx(di,{title:"My Reported Issues",value:i.issuesReportedByMe,icon:Qt,borderColor:"border-red-500",iconColor:"text-red-500",onClick:()=>n("myTickets")})]}),d.jsxs("div",{children:[d.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-5 mt-8 pt-5 border-t border-gray-200",children:"Your Tools & Actions"}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:y.map(g=>d.jsxs("button",{onClick:()=>n(g.section),className:`p-6 bg-white rounded-xl shadow-lg hover:shadow-2xl transform hover:-translate-y-1.5 transition-all duration-300 ease-in-out text-left focus:outline-none focus:ring-2 focus:ring-${g.color}-500 focus:ring-opacity-75 group h-full flex flex-col`,children:[d.jsx("div",{className:`p-3 bg-${g.color}-100 rounded-full inline-block mb-3 self-start group-hover:scale-110 transition-transform`,children:d.jsx(g.icon,{size:28,className:`text-${g.color}-600`})}),d.jsx("h4",{className:`text-lg font-semibold text-gray-800 group-hover:text-${g.color}-700 transition-colors`,children:g.title}),d.jsx("p",{className:"text-sm text-gray-500 mt-1 leading-normal flex-grow",children:g.description})]},g.section))})]}),d.jsxs("div",{className:"mt-8 p-5 bg-gray-50 rounded-xl shadow",children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-3 flex items-center",children:[d.jsx(Qt,{size:20,className:"mr-2 text-yellow-500"})," Important Notices / Route Highlights"]}),d.jsx("p",{className:"text-sm text-gray-500",children:"No specific system notices for your routes today. Please ensure all readings are accurate and submitted on time. Report any discrepancies or issues immediately. Stay safe and hydrated!"})]})]})},Jh="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",NR=({db:r,userData:e,showNotification:t,customerToRead:n,onReadingSubmitted:i,isModalMode:s=!1,onCloseModal:o})=>{const[l,u]=te.useState(""),[f,m]=te.useState(!1),[y,g]=te.useState(""),[_,E]=te.useState(n||null),[x,w]=te.useState(""),[S,I]=te.useState(new Date().toISOString().split("T")[0]),[C,N]=te.useState("Actual"),[R,B]=te.useState(""),[P,k]=te.useState(!1),F=async D=>{if(D.preventDefault(),!l.trim()){t("Please enter a search term.","warning");return}m(!0),g(""),E(null);const M=await Jy(r,l);M.success&&M.data.length>0?E(M.data[0]):M.success?g(`No customer found matching "${l}".`):g(M.error||"Failed to execute user search."),m(!1)},j=async D=>{if(D.preventDefault(),!_){t("No customer selected. Please search for a customer first.","error");return}if(!x||isNaN(parseFloat(x))||parseFloat(x)<0){t("Meter reading must be a valid, non-negative number.","warning");return}k(!0);const M={userId:_.id,accountNumber:_.accountNumber,meterSerialNumber:_.meterSerialNumber||"N/A",readingValue:parseFloat(x),readingDate:S,readingDateString:S,readingType:C,notes:R.trim(),readBy:e.displayName||e.email,readerId:e.uid},$=await HC(r,M);$.success?s&&i?i($.id,M):(t(`Reading for ${_.accountNumber} submitted successfully!`,"success"),u(""),E(null),w(""),B(""),N("Actual")):t($.error||"Failed to submit meter reading.","error"),k(!1)},O=["Actual","Estimated","No Reading","Customer Refused","Unable to Access Meter"];return d.jsxs("div",{className:s?"":"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[!s&&d.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:d.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[d.jsx(_2,{size:30,className:"mr-3 text-blue-600"})," Search & Submit Reading"]})}),!_&&!s&&d.jsxs("form",{onSubmit:F,className:"mb-6 p-4 bg-gray-50 rounded-lg shadow-sm",children:[d.jsx("label",{htmlFor:"customerSearchTerm",className:"block text-sm font-medium text-gray-700 mb-1",children:"Find Customer to Read"}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[d.jsxs("div",{className:"relative flex-grow",children:[d.jsx(Rs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),d.jsx("input",{type:"text",id:"customerSearchTerm",value:l,onChange:D=>u(D.target.value),className:`${Jh} pl-9`,placeholder:"Search by Account No, Name, or Meter No...",disabled:f})]}),d.jsxs("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2.5 px-6 rounded-lg flex items-center justify-center",disabled:f,children:[f?d.jsx(At,{size:18,className:"animate-spin mr-2"}):d.jsx(Rs,{size:18,className:"mr-2"}),"Find"]})]}),y&&d.jsx("p",{className:"text-red-500 text-xs mt-2",children:y})]}),f&&d.jsx(pn,{message:"Searching..."}),_&&d.jsxs("form",{onSubmit:j,className:"space-y-5 p-4 border-t-4 border-blue-500 bg-blue-50 rounded-lg shadow-md animate-fadeIn",children:[d.jsxs("div",{className:"p-3 border border-blue-200 bg-white rounded-md text-sm space-y-1",children:[d.jsxs("p",{className:"font-semibold text-blue-800 flex items-center",children:[d.jsx(Ps,{size:16,className:"mr-2"}),_.displayName]}),d.jsxs("p",{className:"text-gray-600 flex items-center",children:[d.jsx(Cs,{size:14,className:"mr-2"}),"Account No: ",_.accountNumber]}),d.jsxs("p",{className:"text-gray-600 flex items-center",children:[d.jsx(Ql,{size:14,className:"mr-2"}),"Meter No: ",_.meterSerialNumber||"N/A"]})]}),d.jsxs("fieldset",{disabled:P,className:"space-y-5",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"readingValue",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Meter Reading (m)*"}),d.jsx("input",{type:"number",id:"readingValue",value:x,onChange:D=>w(D.target.value),className:Jh,step:"0.01",required:!0})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"readingDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Reading Date*"}),d.jsx("input",{type:"date",id:"readingDate",value:S,onChange:D=>I(D.target.value),className:Jh,required:!0})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"readingType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Reading Type*"}),d.jsx("select",{id:"readingType",value:C,onChange:D=>N(D.target.value),className:Jh,required:!0,children:O.map(D=>d.jsx("option",{value:D,children:D},D))})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes / Remarks"}),d.jsx("textarea",{id:"notes",value:R,onChange:D=>B(D.target.value),rows:"3",className:Jh,placeholder:"e.g., Meter obstructed, Dog on premises..."})]})]}),d.jsxs("div",{className:"flex gap-3",children:[s&&d.jsx("button",{type:"button",onClick:o,className:"w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2.5 px-6 rounded-lg",disabled:P,children:"Cancel"}),d.jsxs("button",{type:"submit",className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-2.5 px-6 rounded-lg flex items-center justify-center disabled:opacity-60",disabled:P,children:[P?d.jsx(At,{size:20,className:"animate-spin mr-2"}):d.jsx(Da,{size:20,className:"mr-2"}),P?"Submitting...":"Submit Reading"]})]})]})]})},G$="w-full px-3 py-2 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",K$=({db:r,userData:e,showNotification:t})=>{const[n,i]=te.useState([]),[s,o]=te.useState(null),[l,u]=te.useState([]),[f,m]=te.useState(!0),[y,g]=te.useState(!1),[_,E]=te.useState(""),[x,w]=te.useState(""),[S,I]=te.useState(null),[C,N]=te.useState(!1),[R,B]=te.useState(""),P=te.useCallback(async($=!0)=>{if(!e||!e.uid){E("Meter reader ID not available. Cannot fetch routes."),m(!1);return}$&&m(!0),E("");const G=await $C(r,e.uid);if(G.success){const ie=G.data.map(oe=>{var ee,J,Y;return{...oe,accountCount:oe.accountCount||((ee=oe.accountNumbers)==null?void 0:ee.length)||((J=oe.accountIds)==null?void 0:J.length)||0,completedCount:oe.completedReadingsToday||0,pendingCount:Math.max(0,(oe.accountCount||((Y=oe.accountNumbers)==null?void 0:Y.length)||0)-(oe.completedReadingsToday||0))}});i(ie.sort((oe,ee)=>(oe.name||"").localeCompare(ee.name||"")))}else{const ie=G.error||"Failed to fetch assigned routes.";E(ie),i([])}$&&m(!1)},[r,e]);te.useEffect(()=>{P()},[P]);const k=te.useCallback(async $=>{if(!$)return;g(!0),w("");const G=await d9(r,$);if(G.success){const ie=new Date().toISOString().split("T")[0],oe=await Promise.all(G.data.map(async ee=>{var Z;let J={readingValue:"N/A",readingDate:null},Y=!1;const q=await I9(r,ee.accountNumber);if(q.success&&q.data.length>0){const ne=q.data[0];J.readingValue=ne.readingValue,J.readingDate=(Z=ne.readingDate)!=null&&Z.toDate?ne.readingDate.toDate():new Date(ne.readingDate),ne.readingDate.toDate().toISOString().split("T")[0]===ie&&(Y=!0)}return{...ee,lastReading:J.readingValue,lastReadingDateDisplay:J.readingDate?Yt(J.readingDate,{month:"short",day:"numeric"}):"N/A",readingStatus:Y?"Completed Today":"Pending"}}));u(oe.sort((ee,J)=>{var Y,q;return(((Y=ee.serviceAddress)==null?void 0:Y.street)||"").localeCompare(((q=J.serviceAddress)==null?void 0:q.street)||"")}))}else{const ie=G.error||`Failed to fetch accounts for route ${$.name}.`;w(ie),u([])}g(!1)},[r]),F=$=>{(s==null?void 0:s.id)!==($==null?void 0:$.id)&&(o($),B(""),u([]),$&&k($))},j=$=>{I($),N(!0)},O=($,G)=>{if(t(`Reading for ${G.accountNumber} submitted successfully.`,"success"),u(ie=>ie.map(oe=>oe.accountNumber===G.accountNumber?{...oe,readingStatus:"Completed Today",lastReading:G.readingValue,lastReadingDateDisplay:Yt(new Date,{month:"short",day:"numeric"})}:oe)),s){const ie=n.map(ee=>{if(ee.id===s.id){const J=(ee.completedCount||0)+1;return{...ee,completedCount:J,pendingCount:Math.max(0,ee.accountCount-J)}}return ee});i(ie);const oe=ie.find(ee=>ee.id===s.id);oe&&o(oe)}N(!1),I(null)},D=$=>!$||typeof $!="object"?"N/A":[$.street,$.barangay,$.district].filter(ie=>ie&&ie.trim()).join(", "),M=l.filter($=>{var oe,ee,J;const G=R.toLowerCase(),ie=D($.serviceAddress).toLowerCase();return((oe=$.displayName)==null?void 0:oe.toLowerCase().includes(G))||((ee=$.accountNumber)==null?void 0:ee.toLowerCase().includes(G))||ie.includes(G)||((J=$.meterSerialNumber)==null?void 0:J.toLowerCase().includes(G))});return f?d.jsx(pn,{message:"Loading your assigned routes...",className:"mt-10 h-64"}):_&&n.length===0?d.jsxs("div",{className:"text-center py-10 bg-red-50 p-4 rounded-lg",children:[d.jsx(Qt,{size:48,className:"mx-auto text-red-400 mb-3"}),d.jsx("p",{className:"text-red-600 text-lg font-semibold",children:"Error Loading Routes"}),d.jsx("p",{className:"text-sm text-red-500 mt-1",children:_})]}):d.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[d.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[d.jsx(Xl,{size:30,className:"mr-3 text-blue-600"})," Assigned Routes & Meter Reading"]}),d.jsxs("button",{onClick:()=>P(!1),className:"mt-3 sm:mt-0 text-sm flex items-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-3 rounded-lg border border-gray-300 transition-colors",disabled:f||y,title:"Refresh Route List",children:[d.jsx(Ma,{size:16,className:`mr-1.5 ${f?"animate-spin":""}`}),"Refresh Routes"]})]}),n.length===0&&!f&&!_&&d.jsxs("div",{className:"text-center py-10 bg-gray-50 rounded-lg p-4",children:[d.jsx(kn,{size:48,className:"mx-auto text-gray-400 mb-3"}),d.jsx("p",{className:"text-gray-500 text-lg",children:"No routes are currently assigned to you."})]}),n.length>0&&d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[d.jsxs("div",{className:"lg:col-span-1 bg-slate-50 p-3.5 rounded-lg shadow-md max-h-[75vh] overflow-y-auto",children:[d.jsxs("h3",{className:"text-md font-semibold text-slate-700 mb-3 sticky top-0 bg-slate-50 py-2 z-10 border-b border-slate-200",children:["My Routes (",n.length,")"]}),d.jsx("div",{className:"space-y-2.5",children:n.map($=>d.jsxs("button",{onClick:()=>F($),className:`w-full text-left p-3 rounded-lg border-2 transition-all duration-200 transform hover:scale-[1.02] focus:outline-none focus:ring-2 focus:ring-offset-1
                                        ${(s==null?void 0:s.id)===$.id?"bg-blue-600 text-white shadow-lg border-blue-700 ring-blue-500":"bg-white hover:bg-blue-50 border-gray-200 hover:border-blue-400"}`,children:[d.jsx("p",{className:`font-semibold text-sm ${(s==null?void 0:s.id)===$.id?"text-white":"text-blue-700"}`,children:$.name}),d.jsxs("p",{className:`text-xs mt-0.5 ${(s==null?void 0:s.id)===$.id?"text-blue-100":"text-gray-500"}`,children:["Area: ",$.areaCode||"N/A"]}),d.jsxs("div",{className:"mt-1.5 text-xs",children:[d.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-white text-[10px] ${($.pendingCount||0)>0?"bg-orange-500":"bg-green-500"}`,children:($.pendingCount||0)===0&&$.accountCount>0?"All Read":`${$.pendingCount} Pending`}),d.jsxs("span",{className:`ml-1.5 ${(s==null?void 0:s.id)===$.id?"text-blue-200":"text-gray-400"}`,children:["(",$.completedCount||0," / ",$.accountCount||0,")"]})]})]},$.id))})]}),d.jsxs("div",{className:"lg:col-span-3",children:[!s&&!y&&d.jsxs("div",{className:"p-6 text-center text-gray-400 bg-slate-50 rounded-lg shadow-inner h-full flex flex-col justify-center items-center min-h-[300px]",children:[d.jsx(e3,{size:48,className:"mb-3 opacity-70"}),d.jsx("p",{className:"text-lg",children:"Please select a route to view accounts."})]}),s&&y&&d.jsx(pn,{message:`Loading accounts for ${s.name}...`,className:"min-h-[300px]"}),s&&!y&&d.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg shadow-md",children:[d.jsxs("div",{className:"pb-2 mb-3 border-b border-slate-200",children:[d.jsxs("h3",{className:"text-lg font-semibold text-slate-700",children:["Accounts in: ",s.name]}),d.jsx("p",{className:"text-xs text-slate-500",children:s.description||"No route description provided."})]}),d.jsxs("div",{className:"relative mb-4",children:[d.jsx(Rs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"}),d.jsx("input",{type:"text",placeholder:"Search by Name, Account No, Address...",value:R,onChange:$=>B($.target.value),className:`${G$} pl-9`})]}),x&&d.jsx("p",{className:"text-sm text-red-500 text-center py-3 bg-red-50 rounded-md",children:x}),d.jsx("div",{className:"space-y-3 max-h-[65vh] overflow-y-auto pr-1 pb-2",children:M.length>0?M.map($=>d.jsxs("div",{className:`p-3.5 border rounded-lg flex flex-col sm:flex-row justify-between items-start sm:items-center transition-shadow hover:shadow-md 
                                            ${$.readingStatus==="Completed Today"?"bg-green-50 border-green-300":"bg-white border-gray-200 hover:border-blue-400"}`,children:[d.jsxs("div",{className:"flex-grow mb-2 sm:mb-0",children:[d.jsxs("p",{className:"font-medium text-slate-800 text-sm",children:[$.displayName," ",d.jsxs("span",{className:"text-xs text-slate-500 font-mono",children:["(",$.accountNumber,")"]})]}),d.jsx("p",{className:"text-xs text-slate-600 mt-0.5",children:D($.serviceAddress)}),d.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:["Meter: ",$.meterSerialNumber," | Last Reading: ",$.lastReading||"N/A"," on ",$.lastReadingDateDisplay]}),d.jsxs("p",{className:`text-xs font-semibold mt-1 ${$.readingStatus==="Completed Today"?"text-green-600":"text-orange-600"}`,children:["Status: ",$.readingStatus]})]}),d.jsxs("button",{onClick:()=>j($),className:`text-xs font-medium py-1.5 px-3.5 rounded-md flex items-center transition-colors active:scale-95 whitespace-nowrap
                                                    ${$.readingStatus==="Completed Today"?"bg-yellow-500 hover:bg-yellow-600 text-white":"bg-blue-600 hover:bg-blue-700 text-white"}`,title:$.readingStatus==="Completed Today"?"Review or Edit Reading":"Submit New Reading",children:[d.jsx(T2,{size:13,className:"mr-1.5"})," ",$.readingStatus==="Completed Today"?"Edit":"Enter Reading"]})]},$.id||$.accountNumber)):d.jsxs("div",{className:"py-6 text-center text-gray-500",children:[d.jsx(Ps,{size:36,className:"mx-auto mb-2 text-gray-400"}),"No accounts ",R?"match your search.":"found for this route."]})})]})]})]}),C&&S&&d.jsx(Mr,{isOpen:C,onClose:()=>{N(!1),I(null)},title:`Meter Reading: ${S.displayName} (${S.accountNumber})`,size:"lg",children:d.jsx(NR,{db:r,userData:e,showNotification:t,customerToRead:S,onReadingSubmitted:O,isModalMode:!0,onCloseModal:()=>{N(!1),I(null)}})})]})},Y$="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",Z$=({db:r,showNotification:e})=>{const[t,n]=te.useState(""),[i,s]=te.useState(null),[o,l]=te.useState(!1),[u,f]=te.useState(""),m=async _=>{if(_.preventDefault(),!t.trim()){e("Please enter a search term (Account No., Name, or Meter No.).","warning");return}l(!0),f(""),s(null);try{const E=await Jy(r,t);E.success&&E.data.length>0?s(E.data[0]):E.success?f(`No customer found matching "${t}".`):f(E.error||"Failed to search for users.")}catch{f("An error occurred during the search.")}l(!1)},y=_=>!_||typeof _!="object"?_||"N/A":[_.street,_.barangay,_.district,"Quezon City"].filter(x=>x&&x.trim()).join(", "),g=({label:_,value:E,icon:x})=>d.jsxs("div",{className:"flex items-start py-2 border-b border-gray-100",children:[x&&d.jsx(x,{size:16,className:"mr-2.5 text-blue-500 flex-shrink-0 mt-0.5"}),d.jsxs("span",{className:"text-xs font-medium text-gray-500 w-32 sm:w-40",children:[_,":"]}),d.jsx("span",{className:"text-sm text-gray-800 flex-1 break-words",children:E||"N/A"})]});return d.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[d.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:d.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[d.jsx(Rs,{size:30,className:"mr-3 text-blue-600"})," Search Customer Profile"]})}),d.jsxs("form",{onSubmit:m,className:"mb-8 p-4 bg-gray-50 rounded-lg shadow",children:[d.jsx("label",{htmlFor:"customerSearchTerm",className:"block text-sm font-medium text-gray-700 mb-1",children:"Find Customer"}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[d.jsxs("div",{className:"relative flex-grow",children:[d.jsx(Ps,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),d.jsx("input",{type:"text",id:"customerSearchTerm",value:t,onChange:_=>n(_.target.value),className:`${Y$} pl-9`,placeholder:"Account No, Name, or Meter No."})]}),d.jsxs("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2.5 px-6 rounded-lg flex items-center justify-center sm:w-auto w-full",disabled:o,children:[o?d.jsx(At,{size:18,className:"animate-spin mr-2"}):d.jsx(Rs,{size:18,className:"mr-2"}),"Search Customer"]})]}),u&&d.jsx("p",{className:"text-red-600 text-xs mt-2",children:u})]}),o&&d.jsx(pn,{message:"Searching for customer..."}),!o&&i&&d.jsxs("div",{className:"mt-6 p-5 border border-blue-200 bg-blue-50 rounded-lg shadow-md animate-fadeIn",children:[d.jsx("h3",{className:"text-xl font-semibold text-blue-700 mb-4 border-b border-blue-200 pb-2",children:"Customer Details"}),d.jsxs("div",{className:"space-y-1",children:[d.jsx(g,{label:"Account Name",value:i.displayName,icon:Ps}),d.jsx(g,{label:"Account Number",value:i.accountNumber,icon:Cs}),d.jsx(g,{label:"Email Address",value:i.email,icon:Ia}),d.jsx(g,{label:"Service Address",value:y(i.serviceAddress),icon:Na}),d.jsx(g,{label:"Meter Serial No.",value:i.meterSerialNumber,icon:Ql}),d.jsx(g,{label:"Meter Size",value:i.meterSize,icon:Ql}),d.jsx(g,{label:"Service Type",value:i.serviceType,icon:kn}),d.jsx(g,{label:"Account Status",value:i.accountStatus,icon:i.accountStatus==="Active"?ks:Qt})]})]})]})},Q$=({userData:r,showNotification:e,setActiveSection:t,db:n})=>{const[i,s]=te.useState({paymentsTodayCount:0,totalCollectedToday:0,avgPaymentAmount:0}),[o,l]=te.useState([]),[u,f]=te.useState(!0),[m,y]=te.useState(""),g=te.useCallback(async()=>{if(!r||!r.uid){f(!1),y("Clerk user data is not available.");return}f(!0),y("");try{const w=await P9(n,r.uid);if(w.success&&w.data){const{paymentsTodayCount:S,totalCollectedToday:I,transactions:C}=w.data,N=C.reduce((R,B)=>{const P=B.paymentMethod||"Other";return R[P]=(R[P]||0)+(B.amountPaid||0),R},{});s({paymentsTodayCount:S,totalCollectedToday:I,avgPaymentAmount:S>0?I/S:0,paymentMethodSummary:N}),l(C)}else y(w.error||"Today's payment data unavailable.")}catch{y("Could not load clerk dashboard statistics. Please try refreshing.")}finally{f(!1)}},[r,n]);te.useEffect(()=>{g()},[g]);const _=()=>{const w=document.getElementById("eod-report-content").innerHTML,S=window.open("","","height=800,width=1000");S.document.write("<html><head><title>End-of-Day Report</title>"),S.document.write('<script src="https://cdn.tailwindcss.com"><\/script>'),S.document.write("<style>body {font-family: Arial, sans-serif;-webkit-print-color-adjust: exact !important; print-color-adjust: exact !important;} @media print {.no-print{display:none;} .printable-area { padding: 1rem; } }</style>"),S.document.write('</head><body><div class="printable-area">'),S.document.write(w),S.document.write("</div></body></html>"),S.document.close(),setTimeout(()=>S.print(),500)},E=[{title:"Process Walk-in Payment",icon:oy,section:"walkInPayments",description:"Record payments for customers paying in person at the counter.",color:"blue"},{title:"Search Account / Bill",icon:x2,section:"searchAccountOrBill",description:"Look up customer account details, outstanding bills, or payment history.",color:"teal"}],x=()=>d.jsx("span",{className:"font-bold",children:""});return u?d.jsx(pn,{message:"Loading clerk dashboard...",className:"mt-10 h-48"}):d.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[d.jsx("div",{className:"p-6 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl shadow-xl no-print",children:d.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl sm:text-3xl font-bold",children:"Clerk / Cashier Dashboard"}),d.jsxs("p",{className:"mt-1 text-indigo-100",children:["Welcome, ",r.displayName||"Clerk","! Manage payments and customer inquiries."]})]}),d.jsxs("button",{onClick:g,className:"mt-3 sm:mt-0 text-sm flex items-center bg-indigo-400 hover:bg-indigo-300 text-white font-medium py-2 px-3 rounded-lg transition-colors disabled:opacity-70 self-start sm:self-center",disabled:u,title:"Refresh Statistics",children:[u?d.jsx(At,{size:16,className:"animate-spin"}):d.jsx(Ma,{size:16}),d.jsx("span",{className:"ml-2 hidden sm:inline",children:"Refresh"})]})]})}),m&&d.jsxs("p",{className:"text-sm text-yellow-600 bg-yellow-50 p-3 rounded-md text-center my-4 flex items-center justify-center gap-2 no-print",children:[d.jsx(kn,{size:16})," ",m]}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 no-print",children:[d.jsx(di,{title:"Payments Today",value:i.paymentsTodayCount,icon:oy,borderColor:"border-green-500",iconColor:"text-green-500",onClick:()=>{var w;return(w=document.getElementById("eod-report-wrapper"))==null?void 0:w.scrollIntoView({behavior:"smooth"})}}),d.jsx(di,{title:"Total Collected Today",value:`${i.totalCollectedToday.toLocaleString("en-US",{minimumFractionDigits:2})}`,icon:x,borderColor:"border-emerald-500",iconColor:"text-emerald-500"}),d.jsx(di,{title:"Avg. Payment Today",value:`${i.avgPaymentAmount.toLocaleString("en-US",{minimumFractionDigits:2})}`,icon:x,borderColor:"border-teal-500",iconColor:"text-teal-500"})]}),d.jsxs("div",{className:"no-print",children:[d.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-5 mt-8 pt-5 border-t border-gray-200",children:"Primary Tasks"}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:E.map(w=>d.jsxs("button",{onClick:()=>t(w.section),className:`p-6 bg-white rounded-xl shadow-lg hover:shadow-2xl transform hover:-translate-y-1.5 transition-all duration-300 ease-in-out text-left focus:outline-none focus:ring-2 focus:ring-${w.color}-500 focus:ring-opacity-75 group h-full flex flex-col`,children:[d.jsx("div",{className:`p-3 bg-${w.color}-100 rounded-full inline-block mb-3 self-start group-hover:scale-110 transition-transform`,children:d.jsx(w.icon,{size:28,className:`text-${w.color}-600`})}),d.jsx("h4",{className:`text-lg font-semibold text-gray-800 group-hover:text-${w.color}-700 transition-colors`,children:w.title}),d.jsx("p",{className:"text-sm text-gray-500 mt-1 leading-normal flex-grow",children:w.description})]},w.section))})]}),d.jsxs("div",{id:"eod-report-wrapper",className:"mt-8 p-5 bg-gray-50 rounded-xl shadow",children:[d.jsxs("div",{className:"flex justify-between items-center mb-4 no-print",children:[d.jsxs("h3",{className:"text-lg font-semibold text-gray-700 flex items-center",children:[d.jsx(As,{size:20,className:"mr-2 text-gray-500"})," Shift Summary / End-of-Day Report"]}),d.jsxs("button",{onClick:_,className:"flex items-center bg-blue-500 text-white text-xs font-semibold px-3 py-1.5 rounded-lg hover:bg-blue-600 transition-colors",children:[d.jsx(S2,{size:14,className:"mr-1.5"})," Print Report"]})]}),d.jsxs("div",{id:"eod-report-content",className:"bg-white p-6 rounded-lg border text-gray-800",children:[d.jsxs("header",{className:"flex justify-between items-start pb-4 border-b-2 border-gray-700",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-3xl font-bold text-blue-700",children:"AGWA"}),d.jsx("p",{className:"text-sm text-gray-500 italic",children:"End-of-Day Clerk Report"})]}),d.jsxs("div",{className:"text-right text-sm",children:[d.jsxs("p",{children:[d.jsx("span",{className:"font-semibold",children:"Cashier:"})," ",r.displayName]}),d.jsxs("p",{children:[d.jsx("span",{className:"font-semibold",children:"Date:"})," ",Yt(new Date,{year:"numeric",month:"long",day:"numeric"})]}),d.jsxs("p",{children:[d.jsx("span",{className:"font-semibold",children:"Report Generated:"})," ",Yt(new Date,{hour:"2-digit",minute:"2-digit"})]})]})]}),d.jsxs("section",{className:"my-6",children:[d.jsx("h2",{className:"text-lg font-semibold mb-3 text-center",children:"Shift Summary"}),d.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[d.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[d.jsx("p",{className:"text-sm text-blue-700 uppercase font-semibold",children:"Total Collected"}),d.jsxs("p",{className:"text-2xl font-bold text-blue-800",children:["",i.totalCollectedToday.toLocaleString("en-US",{minimumFractionDigits:2})]})]}),d.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg text-center",children:[d.jsx("p",{className:"text-sm text-gray-600 uppercase font-semibold",children:"Total Transactions"}),d.jsx("p",{className:"text-2xl font-bold",children:i.paymentsTodayCount})]}),d.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg text-center",children:[d.jsx("p",{className:"text-sm text-gray-600 uppercase font-semibold",children:"Average Transaction"}),d.jsxs("p",{className:"text-2xl font-bold",children:["",i.avgPaymentAmount.toLocaleString("en-US",{minimumFractionDigits:2})]})]})]}),i.paymentMethodSummary&&Object.keys(i.paymentMethodSummary).length>0&&d.jsxs("div",{className:"mt-4 p-4 border rounded-lg",children:[d.jsx("h3",{className:"text-sm font-semibold mb-2",children:"Collection by Payment Method:"}),d.jsx("div",{className:"text-xs space-y-1",children:Object.entries(i.paymentMethodSummary).map(([w,S])=>d.jsxs("div",{className:"flex justify-between",children:[d.jsxs("span",{children:[w,":"]}),d.jsxs("span",{className:"font-medium",children:["",S.toLocaleString("en-US",{minimumFractionDigits:2})]})]},w))})]})]}),d.jsxs("section",{className:"mt-6",children:[d.jsx("h2",{className:"text-lg font-semibold mb-3 text-center",children:"Transaction Details"}),o.length>0?d.jsx("div",{className:"overflow-x-auto border rounded-lg",children:d.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[d.jsx("thead",{className:"bg-gray-100",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Time"}),d.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Account #"}),d.jsx("th",{className:"px-4 py-2 text-left font-semibold text-gray-600",children:"Ref #"}),d.jsx("th",{className:"px-4 py-2 text-right font-semibold text-gray-600",children:"Amount (PHP)"})]})}),d.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:o.map(w=>{var S,I;return d.jsxs("tr",{children:[d.jsx("td",{className:"px-4 py-2 whitespace-nowrap",children:Yt((S=w.paymentTimestamp)==null?void 0:S.toDate(),{hour:"2-digit",minute:"2-digit",second:"2-digit"})}),d.jsx("td",{className:"px-4 py-2 whitespace-nowrap font-mono",children:w.accountNumber}),d.jsx("td",{className:"px-4 py-2 whitespace-nowrap font-mono text-xs",children:w.paymentReference}),d.jsxs("td",{className:"px-4 py-2 whitespace-nowrap text-right font-semibold",children:["",(I=w.amountPaid)==null?void 0:I.toFixed(2)]})]},w.id)})})]})}):d.jsx("p",{className:"text-sm text-gray-500 text-center py-6 bg-gray-50 rounded-md",children:"No payments have been processed yet today."})]}),d.jsx("footer",{className:"mt-12 pt-8",children:d.jsx("div",{className:"w-1/2 sm:w-1/3 border-t-2 border-gray-400 text-center mx-auto pt-2",children:d.jsx("p",{className:"text-xs text-gray-600",children:"Cashier's Signature"})})})]})]})]})},ef="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",X$=({db:r,userData:e,showNotification:t,billingService:n})=>{const[i,s]=te.useState(""),[o,l]=te.useState(null),[u,f]=te.useState([]),[m,y]=te.useState(null),[g,_]=te.useState(""),[E,x]=te.useState("Cash"),[w,S]=te.useState(""),[I,C]=te.useState(!1),[N,R]=te.useState(!1),[B,P]=te.useState(!1),[k,F]=te.useState(null),[j,O]=te.useState(""),D=async ee=>{if(ee&&ee.preventDefault(),!i.trim()){t("Please enter an Account Number to search.","warning");return}C(!0),O(""),l(null),f([]),y(null),_(""),F(null);try{const J=await Jy(r,i.trim());if(J.success&&J.data.length>0){const Y=J.data.find(q=>q.accountNumber.toLowerCase()===i.trim().toLowerCase());Y?(l(Y),M(Y.id,Y.accountNumber)):O(`No customer found with Account Number: "${i}".`)}else O(`No customer found with Account Number: "${i}".`)}catch{O("An error occurred during customer search.")}C(!1)},M=async(ee,J)=>{R(!0);const Y=await Nm(r,ee);if(Y.success){const q=Y.data.filter(Z=>Z.status==="Unpaid").sort((Z,ne)=>{var se,le;return new Date(((se=Z.dueDate)==null?void 0:se.toDate())||0)-new Date(((le=ne.dueDate)==null?void 0:le.toDate())||0)});f(q),q.length===0&&t(`No unpaid bills found for Account #${J}.`,"info")}else t(Y.error||"Failed to fetch customer bills.","error");R(!1)};te.useEffect(()=>{var ee;if(m)_(((ee=m.amount)==null?void 0:ee.toFixed(2))||"");else if(u.length===0)_("");else if(u.length>0&&!u.find(J=>J.id===(m==null?void 0:m.id))){const J=u.reduce((Y,q)=>Y+(q.amount||0),0);_(J>0?J.toFixed(2):"")}},[m,u]);const $=async ee=>{if(ee.preventDefault(),!m&&u.length===0){t("No bill selected or available for payment.","warning");return}const J=parseFloat(g);if(isNaN(J)||J<=0){t("Please enter a valid payment amount.","warning");return}if(E!=="Cash"&&!w.trim()){t("Reference number is required for this payment method.","warning");return}P(!0),F(null);const Y=m||u.find(q=>q.status==="Unpaid");if(!Y){t("Cannot determine which bill to pay. Please select a bill.","warning"),P(!1);return}try{const q=Hn(),Z=new Date,ne=await T9(r,Y.id,{status:"Paid",paymentDate:Z,paymentTimestamp:q,amountPaid:J,paymentMethod:E,paymentReference:w.trim()||`CASH-${Date.now().toString().slice(-8)}`,processedByClerkId:e.uid,processedByClerkName:e.displayName});if(!ne.success)throw new Error(ne.error||"Failed to update bill status.");const se={customerName:o.displayName,accountNumber:o.accountNumber,serviceAddress:o.serviceAddress,billId:Y.id,billMonthYear:Y.monthYear||Y.billingPeriod,amountPaid:J,paymentDate:Z,paymentMethod:E,referenceNumber:w.trim()||`CASH-${Date.now().toString().slice(-8)}`,processedBy:e.displayName,receiptId:`OR-${Date.now()}`};F(se),t(`Payment of ${J.toFixed(2)} processed successfully!`,"success"),_(""),S(""),y(null),M(o.id,o.accountNumber)}catch(q){t(q.message||"An error occurred while processing the payment.","error")}P(!1)},G=()=>{const ee=document.getElementById("payment-receipt-content");if(ee){const J=window.open("","_blank","height=800,width=1000");J.document.write("<html><head><title>AGWA Payment Receipt</title>"),J.document.write('<script src="https://cdn.tailwindcss.com"><\/script>'),J.document.write(`
                <style>
                    body { font-family: 'Inter', sans-serif; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                    .paid-stamp {
                        position: absolute;
                        top: 50%;
                        left: 50%;
                        transform: translate(-50%, -50%) rotate(-30deg);
                        font-size: 4rem;
                        font-weight: bold;
                        color: rgba(0, 128, 0, 0.15);
                        z-index: -1;
                        letter-spacing: 0.1em;
                        border: 8px solid rgba(0, 128, 0, 0.15);
                        padding: 0.5em 1em;
                        border-radius: 10px;
                        text-transform: uppercase;
                    }
                    .no-print { display: none; }
                </style>
            `),J.document.write('</head><body class="bg-gray-100 p-4">'),J.document.write(ee.innerHTML),J.document.write("</body></html>"),J.document.close(),setTimeout(()=>J.print(),700)}},ie=["Cash","Check","Card (Debit/Credit)","E-wallet (GCash/Maya)"],oe=({label:ee,value:J})=>d.jsxs("div",{className:"flex justify-between py-1.5 text-sm border-b border-gray-200 last:border-b-0",children:[d.jsxs("span",{className:"text-gray-500",children:[ee,":"]}),d.jsx("span",{className:"font-medium text-gray-800 text-right",children:J})]});return d.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[!k&&d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:d.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[d.jsx(oy,{size:30,className:"mr-3 text-green-600"})," Process Walk-in Payment"]})}),d.jsxs("form",{onSubmit:D,className:"mb-6 p-4 bg-gray-50 rounded-lg shadow",children:[d.jsx("label",{htmlFor:"accountNumberSearch",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Customer by Account Number"}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[d.jsxs("div",{className:"relative flex-grow",children:[d.jsx(Cs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),d.jsx("input",{type:"text",id:"accountNumberSearch",value:i,onChange:ee=>s(ee.target.value),className:`${ef} pl-9`,placeholder:"Enter Account Number"})]}),d.jsxs("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2.5 px-5 rounded-lg flex items-center justify-center sm:w-auto w-full",disabled:I,children:[I?d.jsx(At,{size:18,className:"animate-spin mr-2"}):d.jsx(Rs,{size:18,className:"mr-2"})," Find Customer"]})]}),j&&!I&&d.jsx("p",{className:"text-red-500 text-xs mt-2",children:j})]})]}),I&&d.jsx(pn,{message:"Searching for customer..."}),o&&!k&&d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"mb-6 p-4 border border-blue-200 bg-blue-50 rounded-lg shadow",children:[d.jsxs("h3",{className:"text-lg font-semibold text-blue-700 mb-2 flex items-center",children:[d.jsx(Ps,{size:20,className:"mr-2"})," ",o.displayName,d.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["(",o.accountNumber,")"]})]}),N&&d.jsx(pn,{message:"Loading bills..."}),!N&&u.length===0&&d.jsx("p",{className:"text-sm text-green-600 mt-2",children:"No unpaid bills found for this customer."}),!N&&u.length>0&&d.jsxs("div",{className:"mt-3",children:[d.jsx("label",{htmlFor:"selectBill",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Bill to Pay (or pay total outstanding):"}),d.jsxs("select",{id:"selectBill",className:ef,value:m?m.id:"",onChange:ee=>{const J=u.find(Y=>Y.id===ee.target.value);y(J||null)},children:[d.jsx("option",{value:"",children:"Pay Total Unpaid / Select Specific Bill"}),u.map(ee=>{var J,Y;return d.jsxs("option",{value:ee.id,children:[ee.monthYear||ee.billingPeriod," - ",(J=ee.amount)==null?void 0:J.toFixed(2)," (Due: ",Yt((Y=ee.dueDate)==null?void 0:Y.toDate(),{month:"short",day:"numeric"}),")"]},ee.id)})]})]})]}),(u.length>0||m)&&d.jsxs("form",{onSubmit:$,className:"space-y-5 p-4 border border-gray-200 rounded-lg",children:[d.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-1",children:"Payment Details"}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"paymentAmount",className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount to Pay (PHP) *"}),d.jsxs("div",{className:"relative",children:[d.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:""}),d.jsx("input",{type:"number",id:"paymentAmount",value:g,onChange:ee=>_(ee.target.value),className:`${ef} pl-7`,step:"0.01",required:!0})]})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"paymentMethod",className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),d.jsx("select",{id:"paymentMethod",value:E,onChange:ee=>x(ee.target.value),className:ef,required:!0,children:ie.map(ee=>d.jsx("option",{value:ee,children:ee},ee))})]}),E!=="Cash"&&d.jsxs("div",{children:[d.jsx("label",{htmlFor:"referenceNumber",className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference / Transaction No. *"}),d.jsx("input",{type:"text",id:"referenceNumber",value:w,onChange:ee=>S(ee.target.value),className:ef,placeholder:"e.g., Check No., Card Approval Code",required:!0})]}),d.jsxs("button",{type:"submit",className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-2.5 px-5 rounded-lg flex items-center justify-center transition-colors active:scale-95",disabled:B||!g||parseFloat(g)<=0,children:[B?d.jsx(At,{size:20,className:"animate-spin mr-2"}):d.jsx(ks,{size:20,className:"mr-2"}),B?"Processing...":"Process Payment"]})]})]}),k&&d.jsxs("div",{className:"mt-6 p-6 bg-green-50 rounded-lg",children:[d.jsxs("div",{className:"text-center mb-5",children:[d.jsx(ks,{size:48,className:"mx-auto text-green-500 mb-2"}),d.jsx("h3",{className:"text-2xl font-semibold text-green-800",children:"Payment Successful!"}),d.jsx("p",{className:"text-sm text-gray-600",children:"Official Receipt has been generated."})]}),d.jsxs("div",{id:"payment-receipt-content",className:"p-6 bg-white rounded-lg shadow-lg max-w-2xl mx-auto font-sans relative overflow-hidden",children:[d.jsx("div",{className:"paid-stamp",children:"PAID"}),d.jsxs("div",{className:"flex justify-between items-start mb-5 pb-4 border-b-2 border-blue-700",children:[d.jsxs("div",{children:[d.jsx("div",{className:"text-3xl font-bold text-blue-700",children:"AGWA"}),d.jsx("div",{className:"text-xs text-blue-600 italic",children:"Ensuring Clarity, Sustaining Life."})]}),d.jsxs("div",{className:"text-right text-xs",children:[d.jsx("p",{className:"font-semibold",children:"AGWA Water Services, Inc."}),d.jsx("p",{children:"123 Aqua Drive, Hydro Business Park"}),d.jsx("p",{children:"Quezon City, Metro Manila, Philippines 1101"})]})]}),d.jsxs("div",{className:"text-center mb-6",children:[d.jsx("h4",{className:"text-xl font-bold text-gray-800",children:"OFFICIAL RECEIPT"}),d.jsxs("p",{className:"text-sm text-gray-500",children:["Receipt No: ",k.receiptId]})]}),d.jsxs("div",{className:"mb-4",children:[d.jsx(oe,{label:"Received From",value:k.customerName}),d.jsx(oe,{label:"Account Number",value:k.accountNumber})]}),d.jsxs("div",{className:"mb-4",children:[d.jsx(oe,{label:"Payment For",value:`Water Bill - ${k.billMonthYear}`}),d.jsx(oe,{label:"Payment Date",value:Yt(k.paymentDate,{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})}),d.jsx(oe,{label:"Payment Method",value:k.paymentMethod}),k.referenceNumber&&!k.referenceNumber.startsWith("CASH-")&&d.jsx(oe,{label:"Reference No.",value:k.referenceNumber})]}),d.jsxs("div",{className:"mt-4 p-3 bg-gray-100 rounded-lg flex justify-between items-center",children:[d.jsx("span",{className:"text-lg font-semibold text-gray-800",children:"AMOUNT PAID"}),d.jsxs("span",{className:"text-2xl font-bold text-green-600",children:["",k.amountPaid.toFixed(2)]})]}),d.jsx("div",{className:"mt-4 pt-4 border-t border-dashed",children:d.jsx(y3,{value:k.receiptId})}),d.jsxs("div",{className:"text-xs text-gray-500 mt-4",children:[d.jsxs("p",{children:["Cashier: ",k.processedBy]}),d.jsx("p",{children:"This is a system-generated receipt. Thank you for your payment."})]})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-3 mt-6 no-print",children:[d.jsxs("button",{onClick:G,className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg flex items-center justify-center",children:[d.jsx(S2,{size:18,className:"mr-2"})," Print Receipt"]}),d.jsx("button",{onClick:()=>{F(null),s(""),l(null),f([]),y(null)},className:"bg-gray-600 hover:bg-gray-700 text-white font-medium py-2 px-4 rounded-lg flex items-center justify-center",children:"Process Another Payment"})]})]})]})},J$=({db:r,showNotification:e,billingService:t})=>{var k;const[n,i]=te.useState("account"),[s,o]=te.useState(""),[l,u]=te.useState(null),[f,m]=te.useState([]),[y,g]=te.useState(!1),[_,E]=te.useState(""),[x,w]=te.useState(null),[S,I]=te.useState(null),C="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition-150 text-sm placeholder-gray-400",N=async F=>{if(F.preventDefault(),!s.trim()){e("Please enter a search term.","warning");return}g(!0),E(""),u(null),m([]),w(null),I(null);try{if(n==="account"){const j=await Jy(r,s.trim());if(j.success&&j.data.length>0){const O=j.data[0];u(O);const D=await Nm(r,O.id);D.success?m(D.data.sort((M,$)=>{var G,ie;return(((G=$.billDate)==null?void 0:G.toDate())||0)-(((ie=M.billDate)==null?void 0:ie.toDate())||0)})):e("Could not fetch bills for the user.","warning")}else j.success?E(`No account found matching "${s}".`):E(j.error||"Failed to search accounts.")}else{const j=await N9(r,(void 0)(),[where("id","==",s.trim())]);if(j.success&&j.data.length>0){const O=j.data[0];if(u(O),O.userId){const D=await iy(r,O.userId);D.success&&I(D.data)}}else j.success?E(`No bill found matching invoice/bill ID "${s}".`):E(j.error||"Failed to search bills.")}}catch{E("An error occurred during the search.")}g(!1)},R=(F,j)=>{w(F),I(j||(l&&n==="account"?l:null))},B=F=>!F||typeof F!="object"?F||"N/A":[F.street,F.barangay,F.district,"Quezon City"].filter(O=>O&&O.trim()).join(", "),P=({label:F,value:j,icon:O,valueClass:D="text-gray-800"})=>d.jsxs("div",{className:"flex items-start py-1.5",children:[O&&d.jsx(O,{size:16,className:"mr-2.5 text-blue-500 flex-shrink-0 mt-0.5"}),d.jsxs("span",{className:"text-xs font-medium text-gray-500 w-32 sm:w-40",children:[F,":"]}),d.jsx("span",{className:`text-sm ${D} flex-1 break-words`,children:j||"N/A"})]});return d.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[d.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:d.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[d.jsx(x2,{size:30,className:"mr-3 text-indigo-600"})," Search Account / Bill"]})}),d.jsxs("form",{onSubmit:N,className:"mb-6 p-4 bg-gray-50 rounded-lg shadow",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-end",children:[d.jsxs("div",{className:"flex-grow",children:[d.jsx("label",{htmlFor:"searchType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search For"}),d.jsxs("select",{id:"searchType",value:n,onChange:F=>{i(F.target.value),o(""),u(null),m([]),E("")},className:C,children:[d.jsx("option",{value:"account",children:"Customer Account"}),d.jsx("option",{value:"bill",children:"Specific Bill (Invoice #)"})]})]}),d.jsxs("div",{className:"flex-grow-[2]",children:[d.jsx("label",{htmlFor:"searchTerm",className:"block text-sm font-medium text-gray-700 mb-1",children:n==="account"?"Account No, Name, or Email":"Invoice Number or Bill ID"}),d.jsxs("div",{className:"relative",children:[d.jsx(Rs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),d.jsx("input",{type:"text",id:"searchTerm",value:s,onChange:F=>o(F.target.value),className:`${C} pl-9`,placeholder:`Enter ${n==="account"?"details...":"invoice #..."}`})]})]}),d.jsxs("button",{type:"submit",className:"bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2.5 px-6 rounded-lg flex items-center justify-center sm:w-auto w-full transition-colors",disabled:y,children:[y?d.jsx(At,{size:18,className:"animate-spin mr-2"}):d.jsx(Rs,{size:18,className:"mr-2"}),"Search"]})]}),_&&!y&&d.jsx("p",{className:"text-red-500 text-xs mt-2",children:_})]}),y&&d.jsx(pn,{message:"Searching..."}),!y&&l&&d.jsxs("div",{className:"mt-6 p-5 border border-indigo-200 bg-indigo-50 rounded-lg shadow-md animate-fadeIn",children:[n==="account"&&d.jsxs(d.Fragment,{children:[d.jsx("h3",{className:"text-xl font-semibold text-indigo-700 mb-3 border-b border-indigo-200 pb-2",children:"Account Details"}),d.jsxs("div",{className:"space-y-1 mb-4",children:[d.jsx(P,{label:"Name",value:l.displayName,icon:Ps}),d.jsx(P,{label:"Account No",value:l.accountNumber,icon:Cs,valueClass:"font-mono"}),d.jsx(P,{label:"Email",value:l.email,icon:Ia}),d.jsx(P,{label:"Status",value:l.accountStatus,icon:kn,valueClass:`font-semibold ${l.accountStatus==="Active"?"text-green-600":"text-red-600"}`}),d.jsx(P,{label:"Service Address",value:B(l.serviceAddress),icon:Na})]}),d.jsxs("h4",{className:"text-md font-semibold text-indigo-600 mt-4 mb-2",children:["Recent Bills (",f.length,")"]}),f.length>0?d.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 pr-2",children:f.map(F=>{var j;return d.jsxs("div",{className:`p-2.5 border rounded-md flex justify-between items-center text-xs ${F.status==="Paid"?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[d.jsxs("div",{children:[d.jsxs("p",{children:[d.jsx("strong",{children:"Period:"})," ",F.monthYear||F.billingPeriod]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Amount:"})," ",(j=F.amount)==null?void 0:j.toFixed(2)]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Due:"})," ",Yt(F.dueDate,{month:"short",day:"numeric",year:"numeric"})]}),d.jsxs("p",{children:[d.jsx("strong",{children:"Status:"})," ",d.jsx("span",{className:`font-semibold ${F.status==="Paid"?"text-green-700":"text-red-700"}`,children:F.status})]})]}),d.jsxs("button",{onClick:()=>R(F,l),className:"text-indigo-600 hover:text-indigo-800 hover:bg-indigo-100 p-1.5 rounded-md text-xs",children:[d.jsx(Zl,{size:16,className:"inline mr-1"}),"View Invoice"]})]},F.id)})}):d.jsx("p",{className:"text-sm text-gray-500",children:"No bills found for this account."})]}),n==="bill"&&d.jsxs(d.Fragment,{children:[d.jsxs("h3",{className:"text-xl font-semibold text-indigo-700 mb-3 border-b border-indigo-200 pb-2",children:["Bill Details (Invoice: ",l.invoiceNumber||l.id,")"]}),d.jsxs("div",{className:"space-y-1",children:[d.jsx(P,{label:"Account No",value:l.accountNumber,icon:Cs,valueClass:"font-mono"}),S&&d.jsx(P,{label:"Customer Name",value:S.displayName,icon:Ps}),d.jsx(P,{label:"Bill Period",value:l.monthYear||l.billingPeriod,icon:du}),d.jsx(P,{label:"Amount Due",value:`${(k=l.amount)==null?void 0:k.toFixed(2)}`,icon:Ox,valueClass:"font-bold"}),d.jsx(P,{label:"Due Date",value:Yt(l.dueDate,{month:"long",day:"numeric",year:"numeric"}),icon:du}),d.jsx(P,{label:"Status",value:l.status,icon:kn,valueClass:`font-semibold ${l.status==="Paid"?"text-green-600":"text-red-600"}`}),l.status==="Paid"&&d.jsx(P,{label:"Paid Date",value:Yt(l.paymentDate),icon:ks})]}),d.jsxs("button",{onClick:()=>R(l,S),className:"mt-4 bg-indigo-500 hover:bg-indigo-600 text-white font-medium py-2 px-4 rounded-lg flex items-center text-sm",children:[d.jsx(Zl,{size:16,className:"mr-2"})," View Full Invoice"]})]})]}),!y&&!l&&s&&!_&&d.jsxs("div",{className:"mt-6 p-5 text-center text-gray-500 bg-gray-50 rounded-lg",children:[d.jsx(kn,{size:32,className:"mx-auto mb-2 text-gray-400"}),'No results found for "',s,'". Please refine your search.']}),x&&S&&d.jsx(w3,{isOpen:!!x,onClose:()=>{w(null)},bill:x,userData:S,calculateBillDetails:t})]})},eW=({db:r,user:e,userData:t,showNotification:n})=>{const[i,s]=te.useState([]),[o,l]=te.useState(!0),[u,f]=te.useState(""),[m,y]=te.useState({}),[g,_]=te.useState(null),[E,x]=te.useState(null),w=te.useCallback(async()=>{l(!0),f("");const R=await qC(r,e.uid);R.success?s(R.data):(f(R.error||"Failed fetching tickets."),n(R.error||"Failed fetching tickets.","error")),l(!1)},[r,e.uid,n]);te.useEffect(()=>{w()},[w]);const S=(R,B)=>{y(P=>({...P,[R]:B}))},I=async R=>{const B=m[R]||"";if(!B.replace(/<[^>]*>?/gm,"").trim()){n("Reply cannot be empty.","warning");return}_(R);const F={text:Do.sanitize(B),authorId:e.uid,authorName:t.displayName||"Customer",authorRole:t.role||"customer",timestamp:Ot.now()},j=await UC(r,R,F);j.success?(n("Reply sent!","success"),y(O=>({...O,[R]:""})),w()):n(j.error||"Failed to send reply.","error"),_(null)},C=async R=>{const P=(m[R]||"").replace(/<[^>]*>?/gm,"").trim();if(!P){n("Write a draft or keywords first.","warning");return}x(R);const k=i.find(F=>F.id===R);if(!k){x(null);return}try{const F=(k.conversation||[]).map(O=>`${O.authorRole==="admin"?"Support":"You"}: ${O.text.replace(/<[^>]*>?/gm,"")}`).join(`

`),j=await h3({ticketDescription:k.description,conversationHistory:F,draftReply:P,customerName:t.displayName});S(R,j),n("AI refined your reply.","success")}catch(F){const j=(F==null?void 0:F.message)||"AI assistance failed.";n(j,"error")}finally{x(null)}},N=R=>{switch(R){case"Open":return"bg-red-100 text-red-700";case"In Progress":return"bg-yellow-100 text-yellow-700";case"Awaiting Customer":return"bg-blue-100 text-blue-700";case"Resolved":case"Closed":return"bg-green-100 text-green-700";default:return"bg-gray-100 text-gray-600"}};return o?d.jsx(pn,{message:"Loading your support tickets..."}):d.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[d.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[d.jsx(ka,{size:30,className:"mr-3 text-purple-600"})," My Support Tickets"]}),d.jsxs("button",{onClick:w,disabled:o,className:"flex items-center text-sm p-2 bg-gray-100 rounded-lg hover:bg-gray-200 border border-gray-300",children:[d.jsx(Ma,{size:16,className:o?"animate-spin":""}),d.jsx("span",{className:"ml-1.5 hidden sm:inline",children:"Refresh"})]})]}),u&&d.jsx("div",{className:"text-red-500 bg-red-50 p-3 rounded-md text-center border border-red-200",children:u}),i.length===0&&!u&&d.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner border border-gray-200",children:[d.jsx(kn,{size:48,className:"mx-auto text-gray-400 mb-4"}),d.jsx("p",{className:"text-gray-600 text-lg",children:"No support tickets found."}),d.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Use 'Report an Issue' to create one."})]}),d.jsx("div",{className:"space-y-4",children:i.map(R=>d.jsxs("details",{className:"p-4 rounded-lg shadow-md border-l-4 bg-gray-50 border-purple-400 group hover:shadow-lg transition-shadow",children:[d.jsxs("summary",{className:"flex flex-wrap justify-between items-center gap-2 cursor-pointer list-none",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"text-md font-semibold text-gray-800",children:R.issueType||"Support Ticket"}),d.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["Submitted: ",Yt(R.submittedAt,{month:"short",day:"numeric",year:"2-digit"})]}),d.jsx(_y,{text:`Ticket ID: ${R.id}`,position:"bottom",children:d.jsxs("p",{className:"text-xs text-gray-400 font-mono mt-0.5 flex items-center",children:[d.jsx(Cs,{size:12,className:"mr-1"}),R.id.substring(0,8),"..."]})})]}),d.jsx("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full ${N(R.status)} shrink-0`,children:R.status||"Unknown"}),d.jsx("span",{className:"ml-auto transition-transform duration-300 transform group-open:rotate-180 text-purple-600",children:""})]}),d.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200 text-sm text-gray-700 space-y-4 grid grid-rows-[0fr] group-open:grid-rows-[1fr] transition-all duration-500 ease-in-out",children:d.jsxs("div",{className:"overflow-hidden space-y-4",children:[d.jsxs("div",{children:[d.jsx("strong",{className:"text-xs text-gray-500 block mb-1",children:"Your Initial Report:"}),d.jsx("div",{className:"p-2 bg-white border rounded-md whitespace-pre-line text-xs prose prose-xs max-w-none",children:R.description})]}),R.conversation&&R.conversation.length>0&&d.jsxs("div",{className:"space-y-2",children:[d.jsx("strong",{className:"text-xs text-gray-500 block mb-1",children:"Conversation:"}),d.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 border bg-white p-2 rounded-md scrollbar-thin",children:R.conversation.map((B,P)=>d.jsxs("div",{className:`p-2 rounded-lg text-xs ${B.authorRole==="admin"?"bg-blue-50":"bg-green-50"}`,children:[d.jsxs("p",{className:"font-bold text-gray-800",children:[B.authorName," (",B.authorRole,"):"]}),d.jsx("div",{className:"text-gray-700 prose prose-xs max-w-none break-words",dangerouslySetInnerHTML:{__html:Do.sanitize(B.text||"")}}),d.jsx("p",{className:"text-right text-gray-500 mt-1",children:Yt(B.timestamp)})]},P))})]}),R.status!=="Resolved"&&R.status!=="Closed"&&d.jsxs("div",{className:"pt-2",children:[d.jsx("label",{className:"text-xs font-semibold text-gray-600 block mb-1",children:"Send a Reply:"}),d.jsxs("div",{className:"flex items-start gap-2",children:[d.jsx(g0,{value:m[R.id]||"",onChange:B=>S(R.id,B),placeholder:"Type your reply...",className:"flex-grow bg-white rounded-lg border border-gray-300 min-h-[100px]",readOnly:g===R.id||E===R.id}),d.jsx(_y,{text:"Refine draft with AI",children:d.jsx("button",{onClick:()=>C(R.id),className:"p-2 bg-purple-100 text-purple-700 rounded-md hover:bg-purple-200 disabled:opacity-50 disabled:cursor-not-allowed",disabled:E===R.id||!(m[R.id]||"").replace(/<[^>]*>?/gm,"").trim(),children:E===R.id?d.jsx(At,{size:20,className:"animate-spin"}):d.jsx(Os,{size:20})})})]}),d.jsxs("button",{onClick:()=>I(R.id),className:"mt-2 w-full sm:w-auto flex items-center justify-center bg-blue-600 text-white font-semibold py-2 px-4 rounded-md text-xs hover:bg-blue-700 disabled:opacity-60",disabled:g===R.id||!(m[R.id]||"").replace(/<[^>]*>?/gm,"").trim(),children:[g===R.id?d.jsx(At,{size:14,className:"animate-spin mr-2"}):d.jsx(n0,{size:14,className:"mr-2"}),"Send Reply"]})]}),R.status==="Resolved"&&d.jsx("p",{className:"text-xs text-green-700 bg-green-50 p-2 rounded border border-green-200",children:"This ticket is marked as resolved. Replying will reopen it."}),R.status==="Closed"&&d.jsx("p",{className:"text-xs text-purple-700 bg-purple-50 p-2 rounded border border-purple-200",children:"This ticket is closed. Please create a new ticket if you need further assistance."})]})})]},R.id))})]})};function tW(r,e){const t=te.useRef(e);te.useEffect(function(){e!==t.current&&r.attributionControl!=null&&(t.current!=null&&r.attributionControl.removeAttribution(t.current),e!=null&&r.attributionControl.addAttribution(e)),t.current=e},[r,e])}Zx();const nW=1;function rW(r){return Object.freeze({__version:nW,map:r})}function iW(r,e){return Object.freeze({...r,...e})}const kR=te.createContext(null),PR=kR.Provider;function CR(){const r=te.useContext(kR);if(r==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return r}function sW(r){function e(t,n){const{instance:i,context:s}=r(t).current;return te.useImperativeHandle(n,()=>i),t.children==null?null:is.createElement(PR,{value:s},t.children)}return te.forwardRef(e)}function oW(r){function e(t,n){const{instance:i}=r(t).current;return te.useImperativeHandle(n,()=>i),null}return te.forwardRef(e)}function RR(r,e){const t=te.useRef();te.useEffect(function(){return e!=null&&r.instance.on(e),t.current=e,function(){t.current!=null&&r.instance.off(t.current),t.current=null}},[r,e])}function G2(r,e){const t=r.pane??e.pane;return t?{...r,pane:t}:r}var yf={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var aW=yf.exports,c4;function lW(){return c4||(c4=1,function(r,e){(function(t,n){n(e)})(aW,function(t){var n="1.9.4";function i(c){var p,T,V,W;for(T=1,V=arguments.length;T<V;T++){W=arguments[T];for(p in W)c[p]=W[p]}return c}var s=Object.create||function(){function c(){}return function(p){return c.prototype=p,new c}}();function o(c,p){var T=Array.prototype.slice;if(c.bind)return c.bind.apply(c,T.call(arguments,1));var V=T.call(arguments,2);return function(){return c.apply(p,V.length?V.concat(T.call(arguments)):arguments)}}var l=0;function u(c){return"_leaflet_id"in c||(c._leaflet_id=++l),c._leaflet_id}function f(c,p,T){var V,W,re,de;return de=function(){V=!1,W&&(re.apply(T,W),W=!1)},re=function(){V?W=arguments:(c.apply(T,arguments),setTimeout(de,p),V=!0)},re}function m(c,p,T){var V=p[1],W=p[0],re=V-W;return c===V&&T?c:((c-W)%re+re)%re+W}function y(){return!1}function g(c,p){if(p===!1)return c;var T=Math.pow(10,p===void 0?6:p);return Math.round(c*T)/T}function _(c){return c.trim?c.trim():c.replace(/^\s+|\s+$/g,"")}function E(c){return _(c).split(/\s+/)}function x(c,p){Object.prototype.hasOwnProperty.call(c,"options")||(c.options=c.options?s(c.options):{});for(var T in p)c.options[T]=p[T];return c.options}function w(c,p,T){var V=[];for(var W in c)V.push(encodeURIComponent(T?W.toUpperCase():W)+"="+encodeURIComponent(c[W]));return(!p||p.indexOf("?")===-1?"?":"&")+V.join("&")}var S=/\{ *([\w_ -]+) *\}/g;function I(c,p){return c.replace(S,function(T,V){var W=p[V];if(W===void 0)throw new Error("No value provided for variable "+T);return typeof W=="function"&&(W=W(p)),W})}var C=Array.isArray||function(c){return Object.prototype.toString.call(c)==="[object Array]"};function N(c,p){for(var T=0;T<c.length;T++)if(c[T]===p)return T;return-1}var R="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function B(c){return window["webkit"+c]||window["moz"+c]||window["ms"+c]}var P=0;function k(c){var p=+new Date,T=Math.max(0,16-(p-P));return P=p+T,window.setTimeout(c,T)}var F=window.requestAnimationFrame||B("RequestAnimationFrame")||k,j=window.cancelAnimationFrame||B("CancelAnimationFrame")||B("CancelRequestAnimationFrame")||function(c){window.clearTimeout(c)};function O(c,p,T){if(T&&F===k)c.call(p);else return F.call(window,o(c,p))}function D(c){c&&j.call(window,c)}var M={__proto__:null,extend:i,create:s,bind:o,get lastId(){return l},stamp:u,throttle:f,wrapNum:m,falseFn:y,formatNum:g,trim:_,splitWords:E,setOptions:x,getParamString:w,template:I,isArray:C,indexOf:N,emptyImageUrl:R,requestFn:F,cancelFn:j,requestAnimFrame:O,cancelAnimFrame:D};function $(){}$.extend=function(c){var p=function(){x(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},T=p.__super__=this.prototype,V=s(T);V.constructor=p,p.prototype=V;for(var W in this)Object.prototype.hasOwnProperty.call(this,W)&&W!=="prototype"&&W!=="__super__"&&(p[W]=this[W]);return c.statics&&i(p,c.statics),c.includes&&(G(c.includes),i.apply(null,[V].concat(c.includes))),i(V,c),delete V.statics,delete V.includes,V.options&&(V.options=T.options?s(T.options):{},i(V.options,c.options)),V._initHooks=[],V.callInitHooks=function(){if(!this._initHooksCalled){T.callInitHooks&&T.callInitHooks.call(this),this._initHooksCalled=!0;for(var re=0,de=V._initHooks.length;re<de;re++)V._initHooks[re].call(this)}},p},$.include=function(c){var p=this.prototype.options;return i(this.prototype,c),c.options&&(this.prototype.options=p,this.mergeOptions(c.options)),this},$.mergeOptions=function(c){return i(this.prototype.options,c),this},$.addInitHook=function(c){var p=Array.prototype.slice.call(arguments,1),T=typeof c=="function"?c:function(){this[c].apply(this,p)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(T),this};function G(c){if(!(typeof L>"u"||!L||!L.Mixin)){c=C(c)?c:[c];for(var p=0;p<c.length;p++)c[p]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ie={on:function(c,p,T){if(typeof c=="object")for(var V in c)this._on(V,c[V],p);else{c=E(c);for(var W=0,re=c.length;W<re;W++)this._on(c[W],p,T)}return this},off:function(c,p,T){if(!arguments.length)delete this._events;else if(typeof c=="object")for(var V in c)this._off(V,c[V],p);else{c=E(c);for(var W=arguments.length===1,re=0,de=c.length;re<de;re++)W?this._off(c[re]):this._off(c[re],p,T)}return this},_on:function(c,p,T,V){if(typeof p!="function"){console.warn("wrong listener type: "+typeof p);return}if(this._listens(c,p,T)===!1){T===this&&(T=void 0);var W={fn:p,ctx:T};V&&(W.once=!0),this._events=this._events||{},this._events[c]=this._events[c]||[],this._events[c].push(W)}},_off:function(c,p,T){var V,W,re;if(this._events&&(V=this._events[c],!!V)){if(arguments.length===1){if(this._firingCount)for(W=0,re=V.length;W<re;W++)V[W].fn=y;delete this._events[c];return}if(typeof p!="function"){console.warn("wrong listener type: "+typeof p);return}var de=this._listens(c,p,T);if(de!==!1){var _e=V[de];this._firingCount&&(_e.fn=y,this._events[c]=V=V.slice()),V.splice(de,1)}}},fire:function(c,p,T){if(!this.listens(c,T))return this;var V=i({},p,{type:c,target:this,sourceTarget:p&&p.sourceTarget||this});if(this._events){var W=this._events[c];if(W){this._firingCount=this._firingCount+1||1;for(var re=0,de=W.length;re<de;re++){var _e=W[re],we=_e.fn;_e.once&&this.off(c,we,_e.ctx),we.call(_e.ctx||this,V)}this._firingCount--}}return T&&this._propagateEvent(V),this},listens:function(c,p,T,V){typeof c!="string"&&console.warn('"string" type argument expected');var W=p;typeof p!="function"&&(V=!!p,W=void 0,T=void 0);var re=this._events&&this._events[c];if(re&&re.length&&this._listens(c,W,T)!==!1)return!0;if(V){for(var de in this._eventParents)if(this._eventParents[de].listens(c,p,T,V))return!0}return!1},_listens:function(c,p,T){if(!this._events)return!1;var V=this._events[c]||[];if(!p)return!!V.length;T===this&&(T=void 0);for(var W=0,re=V.length;W<re;W++)if(V[W].fn===p&&V[W].ctx===T)return W;return!1},once:function(c,p,T){if(typeof c=="object")for(var V in c)this._on(V,c[V],p,!0);else{c=E(c);for(var W=0,re=c.length;W<re;W++)this._on(c[W],p,T,!0)}return this},addEventParent:function(c){return this._eventParents=this._eventParents||{},this._eventParents[u(c)]=c,this},removeEventParent:function(c){return this._eventParents&&delete this._eventParents[u(c)],this},_propagateEvent:function(c){for(var p in this._eventParents)this._eventParents[p].fire(c.type,i({layer:c.target,propagatedFrom:c.target},c),!0)}};ie.addEventListener=ie.on,ie.removeEventListener=ie.clearAllEventListeners=ie.off,ie.addOneTimeEventListener=ie.once,ie.fireEvent=ie.fire,ie.hasEventListeners=ie.listens;var oe=$.extend(ie);function ee(c,p,T){this.x=T?Math.round(c):c,this.y=T?Math.round(p):p}var J=Math.trunc||function(c){return c>0?Math.floor(c):Math.ceil(c)};ee.prototype={clone:function(){return new ee(this.x,this.y)},add:function(c){return this.clone()._add(Y(c))},_add:function(c){return this.x+=c.x,this.y+=c.y,this},subtract:function(c){return this.clone()._subtract(Y(c))},_subtract:function(c){return this.x-=c.x,this.y-=c.y,this},divideBy:function(c){return this.clone()._divideBy(c)},_divideBy:function(c){return this.x/=c,this.y/=c,this},multiplyBy:function(c){return this.clone()._multiplyBy(c)},_multiplyBy:function(c){return this.x*=c,this.y*=c,this},scaleBy:function(c){return new ee(this.x*c.x,this.y*c.y)},unscaleBy:function(c){return new ee(this.x/c.x,this.y/c.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=J(this.x),this.y=J(this.y),this},distanceTo:function(c){c=Y(c);var p=c.x-this.x,T=c.y-this.y;return Math.sqrt(p*p+T*T)},equals:function(c){return c=Y(c),c.x===this.x&&c.y===this.y},contains:function(c){return c=Y(c),Math.abs(c.x)<=Math.abs(this.x)&&Math.abs(c.y)<=Math.abs(this.y)},toString:function(){return"Point("+g(this.x)+", "+g(this.y)+")"}};function Y(c,p,T){return c instanceof ee?c:C(c)?new ee(c[0],c[1]):c==null?c:typeof c=="object"&&"x"in c&&"y"in c?new ee(c.x,c.y):new ee(c,p,T)}function q(c,p){if(c)for(var T=p?[c,p]:c,V=0,W=T.length;V<W;V++)this.extend(T[V])}q.prototype={extend:function(c){var p,T;if(!c)return this;if(c instanceof ee||typeof c[0]=="number"||"x"in c)p=T=Y(c);else if(c=Z(c),p=c.min,T=c.max,!p||!T)return this;return!this.min&&!this.max?(this.min=p.clone(),this.max=T.clone()):(this.min.x=Math.min(p.x,this.min.x),this.max.x=Math.max(T.x,this.max.x),this.min.y=Math.min(p.y,this.min.y),this.max.y=Math.max(T.y,this.max.y)),this},getCenter:function(c){return Y((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,c)},getBottomLeft:function(){return Y(this.min.x,this.max.y)},getTopRight:function(){return Y(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(c){var p,T;return typeof c[0]=="number"||c instanceof ee?c=Y(c):c=Z(c),c instanceof q?(p=c.min,T=c.max):p=T=c,p.x>=this.min.x&&T.x<=this.max.x&&p.y>=this.min.y&&T.y<=this.max.y},intersects:function(c){c=Z(c);var p=this.min,T=this.max,V=c.min,W=c.max,re=W.x>=p.x&&V.x<=T.x,de=W.y>=p.y&&V.y<=T.y;return re&&de},overlaps:function(c){c=Z(c);var p=this.min,T=this.max,V=c.min,W=c.max,re=W.x>p.x&&V.x<T.x,de=W.y>p.y&&V.y<T.y;return re&&de},isValid:function(){return!!(this.min&&this.max)},pad:function(c){var p=this.min,T=this.max,V=Math.abs(p.x-T.x)*c,W=Math.abs(p.y-T.y)*c;return Z(Y(p.x-V,p.y-W),Y(T.x+V,T.y+W))},equals:function(c){return c?(c=Z(c),this.min.equals(c.getTopLeft())&&this.max.equals(c.getBottomRight())):!1}};function Z(c,p){return!c||c instanceof q?c:new q(c,p)}function ne(c,p){if(c)for(var T=p?[c,p]:c,V=0,W=T.length;V<W;V++)this.extend(T[V])}ne.prototype={extend:function(c){var p=this._southWest,T=this._northEast,V,W;if(c instanceof le)V=c,W=c;else if(c instanceof ne){if(V=c._southWest,W=c._northEast,!V||!W)return this}else return c?this.extend(Q(c)||se(c)):this;return!p&&!T?(this._southWest=new le(V.lat,V.lng),this._northEast=new le(W.lat,W.lng)):(p.lat=Math.min(V.lat,p.lat),p.lng=Math.min(V.lng,p.lng),T.lat=Math.max(W.lat,T.lat),T.lng=Math.max(W.lng,T.lng)),this},pad:function(c){var p=this._southWest,T=this._northEast,V=Math.abs(p.lat-T.lat)*c,W=Math.abs(p.lng-T.lng)*c;return new ne(new le(p.lat-V,p.lng-W),new le(T.lat+V,T.lng+W))},getCenter:function(){return new le((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new le(this.getNorth(),this.getWest())},getSouthEast:function(){return new le(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(c){typeof c[0]=="number"||c instanceof le||"lat"in c?c=Q(c):c=se(c);var p=this._southWest,T=this._northEast,V,W;return c instanceof ne?(V=c.getSouthWest(),W=c.getNorthEast()):V=W=c,V.lat>=p.lat&&W.lat<=T.lat&&V.lng>=p.lng&&W.lng<=T.lng},intersects:function(c){c=se(c);var p=this._southWest,T=this._northEast,V=c.getSouthWest(),W=c.getNorthEast(),re=W.lat>=p.lat&&V.lat<=T.lat,de=W.lng>=p.lng&&V.lng<=T.lng;return re&&de},overlaps:function(c){c=se(c);var p=this._southWest,T=this._northEast,V=c.getSouthWest(),W=c.getNorthEast(),re=W.lat>p.lat&&V.lat<T.lat,de=W.lng>p.lng&&V.lng<T.lng;return re&&de},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(c,p){return c?(c=se(c),this._southWest.equals(c.getSouthWest(),p)&&this._northEast.equals(c.getNorthEast(),p)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function se(c,p){return c instanceof ne?c:new ne(c,p)}function le(c,p,T){if(isNaN(c)||isNaN(p))throw new Error("Invalid LatLng object: ("+c+", "+p+")");this.lat=+c,this.lng=+p,T!==void 0&&(this.alt=+T)}le.prototype={equals:function(c,p){if(!c)return!1;c=Q(c);var T=Math.max(Math.abs(this.lat-c.lat),Math.abs(this.lng-c.lng));return T<=(p===void 0?1e-9:p)},toString:function(c){return"LatLng("+g(this.lat,c)+", "+g(this.lng,c)+")"},distanceTo:function(c){return me.distance(this,Q(c))},wrap:function(){return me.wrapLatLng(this)},toBounds:function(c){var p=180*c/40075017,T=p/Math.cos(Math.PI/180*this.lat);return se([this.lat-p,this.lng-T],[this.lat+p,this.lng+T])},clone:function(){return new le(this.lat,this.lng,this.alt)}};function Q(c,p,T){return c instanceof le?c:C(c)&&typeof c[0]!="object"?c.length===3?new le(c[0],c[1],c[2]):c.length===2?new le(c[0],c[1]):null:c==null?c:typeof c=="object"&&"lat"in c?new le(c.lat,"lng"in c?c.lng:c.lon,c.alt):p===void 0?null:new le(c,p,T)}var ce={latLngToPoint:function(c,p){var T=this.projection.project(c),V=this.scale(p);return this.transformation._transform(T,V)},pointToLatLng:function(c,p){var T=this.scale(p),V=this.transformation.untransform(c,T);return this.projection.unproject(V)},project:function(c){return this.projection.project(c)},unproject:function(c){return this.projection.unproject(c)},scale:function(c){return 256*Math.pow(2,c)},zoom:function(c){return Math.log(c/256)/Math.LN2},getProjectedBounds:function(c){if(this.infinite)return null;var p=this.projection.bounds,T=this.scale(c),V=this.transformation.transform(p.min,T),W=this.transformation.transform(p.max,T);return new q(V,W)},infinite:!1,wrapLatLng:function(c){var p=this.wrapLng?m(c.lng,this.wrapLng,!0):c.lng,T=this.wrapLat?m(c.lat,this.wrapLat,!0):c.lat,V=c.alt;return new le(T,p,V)},wrapLatLngBounds:function(c){var p=c.getCenter(),T=this.wrapLatLng(p),V=p.lat-T.lat,W=p.lng-T.lng;if(V===0&&W===0)return c;var re=c.getSouthWest(),de=c.getNorthEast(),_e=new le(re.lat-V,re.lng-W),we=new le(de.lat-V,de.lng-W);return new ne(_e,we)}},me=i({},ce,{wrapLng:[-180,180],R:6371e3,distance:function(c,p){var T=Math.PI/180,V=c.lat*T,W=p.lat*T,re=Math.sin((p.lat-c.lat)*T/2),de=Math.sin((p.lng-c.lng)*T/2),_e=re*re+Math.cos(V)*Math.cos(W)*de*de,we=2*Math.atan2(Math.sqrt(_e),Math.sqrt(1-_e));return this.R*we}}),ge=6378137,Ae={R:ge,MAX_LATITUDE:85.0511287798,project:function(c){var p=Math.PI/180,T=this.MAX_LATITUDE,V=Math.max(Math.min(T,c.lat),-T),W=Math.sin(V*p);return new ee(this.R*c.lng*p,this.R*Math.log((1+W)/(1-W))/2)},unproject:function(c){var p=180/Math.PI;return new le((2*Math.atan(Math.exp(c.y/this.R))-Math.PI/2)*p,c.x*p/this.R)},bounds:function(){var c=ge*Math.PI;return new q([-c,-c],[c,c])}()};function Ue(c,p,T,V){if(C(c)){this._a=c[0],this._b=c[1],this._c=c[2],this._d=c[3];return}this._a=c,this._b=p,this._c=T,this._d=V}Ue.prototype={transform:function(c,p){return this._transform(c.clone(),p)},_transform:function(c,p){return p=p||1,c.x=p*(this._a*c.x+this._b),c.y=p*(this._c*c.y+this._d),c},untransform:function(c,p){return p=p||1,new ee((c.x/p-this._b)/this._a,(c.y/p-this._d)/this._c)}};function nt(c,p,T,V){return new Ue(c,p,T,V)}var et=i({},me,{code:"EPSG:3857",projection:Ae,transformation:function(){var c=.5/(Math.PI*Ae.R);return nt(c,.5,-c,.5)}()}),pt=i({},et,{code:"EPSG:900913"});function Et(c){return document.createElementNS("http://www.w3.org/2000/svg",c)}function _n(c,p){var T="",V,W,re,de,_e,we;for(V=0,re=c.length;V<re;V++){for(_e=c[V],W=0,de=_e.length;W<de;W++)we=_e[W],T+=(W?"L":"M")+we.x+" "+we.y;T+=p?$e.svg?"z":"x":""}return T||"M0 0"}var Wt=document.documentElement.style,Se="ActiveXObject"in window,Ie=Se&&!document.addEventListener,De="msLaunchUri"in navigator&&!("documentMode"in document),Ve=an("webkit"),ke=an("android"),gt=an("android 2")||an("android 3"),ft=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),mt=ke&&an("Google")&&ft<537&&!("AudioNode"in window),kt=!!window.opera,jt=!De&&an("chrome"),Mt=an("gecko")&&!Ve&&!kt&&!Se,os=!jt&&an("safari"),qt=an("phantom"),jn="OTransition"in Wt,as=navigator.platform.indexOf("Win")===0,Bi=Se&&"transition"in Wt,pi="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!gt,gr="MozPerspective"in Wt,gi=!window.L_DISABLE_3D&&(Bi||pi||gr)&&!jn&&!qt,ti=typeof orientation<"u"||an("mobile"),Ui=ti&&Ve,lo=ti&&pi,yi=!window.PointerEvent&&window.MSPointerEvent,Qn=!!(window.PointerEvent||yi),ni="ontouchstart"in window||!!window.TouchEvent,vi=!window.L_NO_TOUCH&&(ni||Qn),_i=ti&&kt,zo=ti&&Mt,gn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,xi=function(){var c=!1;try{var p=Object.defineProperty({},"passive",{get:function(){c=!0}});window.addEventListener("testPassiveEventSupport",y,p),window.removeEventListener("testPassiveEventSupport",y,p)}catch{}return c}(),qi=function(){return!!document.createElement("canvas").getContext}(),ls=!!(document.createElementNS&&Et("svg").createSVGRect),xn=!!ls&&function(){var c=document.createElement("div");return c.innerHTML="<svg/>",(c.firstChild&&c.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Fs=!ls&&function(){try{var c=document.createElement("div");c.innerHTML='<v:shape adj="1"/>';var p=c.firstChild;return p.style.behavior="url(#default#VML)",p&&typeof p.adj=="object"}catch{return!1}}(),Dr=navigator.platform.indexOf("Mac")===0,Vs=navigator.platform.indexOf("Linux")===0;function an(c){return navigator.userAgent.toLowerCase().indexOf(c)>=0}var $e={ie:Se,ielt9:Ie,edge:De,webkit:Ve,android:ke,android23:gt,androidStock:mt,opera:kt,chrome:jt,gecko:Mt,safari:os,phantom:qt,opera12:jn,win:as,ie3d:Bi,webkit3d:pi,gecko3d:gr,any3d:gi,mobile:ti,mobileWebkit:Ui,mobileWebkit3d:lo,msPointer:yi,pointer:Qn,touch:vi,touchNative:ni,mobileOpera:_i,mobileGecko:zo,retina:gn,passiveEvents:xi,canvas:qi,svg:ls,vml:Fs,inlineSvg:xn,mac:Dr,linux:Vs},Sr=$e.msPointer?"MSPointerDown":"pointerdown",zs=$e.msPointer?"MSPointerMove":"pointermove",co=$e.msPointer?"MSPointerUp":"pointerup",cs=$e.msPointer?"MSPointerCancel":"pointercancel",yr={touchstart:Sr,touchmove:zs,touchend:co,touchcancel:cs},Ar={touchstart:It,touchmove:Gt,touchend:Gt,touchcancel:Gt},Ir={},Nr=!1;function Bo(c,p,T){return p==="touchstart"&&Ge(),Ar[p]?(T=Ar[p].bind(this,T),c.addEventListener(yr[p],T,!1),T):(console.warn("wrong event specified:",p),y)}function Uo(c,p,T){if(!yr[p]){console.warn("wrong event specified:",p);return}c.removeEventListener(yr[p],T,!1)}function Ze(c){Ir[c.pointerId]=c}function fe(c){Ir[c.pointerId]&&(Ir[c.pointerId]=c)}function je(c){delete Ir[c.pointerId]}function Ge(){Nr||(document.addEventListener(Sr,Ze,!0),document.addEventListener(zs,fe,!0),document.addEventListener(co,je,!0),document.addEventListener(cs,je,!0),Nr=!0)}function Gt(c,p){if(p.pointerType!==(p.MSPOINTER_TYPE_MOUSE||"mouse")){p.touches=[];for(var T in Ir)p.touches.push(Ir[T]);p.changedTouches=[p],c(p)}}function It(c,p){p.MSPOINTER_TYPE_TOUCH&&p.pointerType===p.MSPOINTER_TYPE_TOUCH&&un(p),Gt(c,p)}function bn(c){var p={},T,V;for(V in c)T=c[V],p[V]=T&&T.bind?T.bind(c):T;return c=p,p.type="dblclick",p.detail=2,p.isTrusted=!1,p._simulated=!0,p}var Cn=200;function Xn(c,p){c.addEventListener("dblclick",p);var T=0,V;function W(re){if(re.detail!==1){V=re.detail;return}if(!(re.pointerType==="mouse"||re.sourceCapabilities&&!re.sourceCapabilities.firesTouchEvents)){var de=ds(re);if(!(de.some(function(we){return we instanceof HTMLLabelElement&&we.attributes.for})&&!de.some(function(we){return we instanceof HTMLInputElement||we instanceof HTMLSelectElement}))){var _e=Date.now();_e-T<=Cn?(V++,V===2&&p(bn(re))):V=1,T=_e}}}return c.addEventListener("click",W),{dblclick:p,simDblclick:W}}function $n(c,p){c.removeEventListener("dblclick",p.dblclick),c.removeEventListener("click",p.simDblclick)}var Hi=Gi(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),yn=Gi(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),$i=yn==="webkitTransition"||yn==="OTransition"?yn+"End":"transitionend";function or(c){return typeof c=="string"?document.getElementById(c):c}function uo(c,p){var T=c.style[p]||c.currentStyle&&c.currentStyle[p];if((!T||T==="auto")&&document.defaultView){var V=document.defaultView.getComputedStyle(c,null);T=V?V[p]:null}return T==="auto"?null:T}function _t(c,p,T){var V=document.createElement(c);return V.className=p||"",T&&T.appendChild(V),V}function ln(c){var p=c.parentNode;p&&p.removeChild(c)}function qo(c){for(;c.firstChild;)c.removeChild(c.firstChild)}function Bs(c){var p=c.parentNode;p&&p.lastChild!==c&&p.appendChild(c)}function Wi(c){var p=c.parentNode;p&&p.firstChild!==c&&p.insertBefore(c,p.firstChild)}function ho(c,p){if(c.classList!==void 0)return c.classList.contains(p);var T=bi(c);return T.length>0&&new RegExp("(^|\\s)"+p+"(\\s|$)").test(T)}function yt(c,p){if(c.classList!==void 0)for(var T=E(p),V=0,W=T.length;V<W;V++)c.classList.add(T[V]);else if(!ho(c,p)){var re=bi(c);uc(c,(re?re+" ":"")+p)}}function cn(c,p){c.classList!==void 0?c.classList.remove(p):uc(c,_((" "+bi(c)+" ").replace(" "+p+" "," ")))}function uc(c,p){c.className.baseVal===void 0?c.className=p:c.className.baseVal=p}function bi(c){return c.correspondingElement&&(c=c.correspondingElement),c.className.baseVal===void 0?c.className:c.className.baseVal}function En(c,p){"opacity"in c.style?c.style.opacity=p:"filter"in c.style&&Ho(c,p)}function Ho(c,p){var T=!1,V="DXImageTransform.Microsoft.Alpha";try{T=c.filters.item(V)}catch{if(p===1)return}p=Math.round(p*100),T?(T.Enabled=p!==100,T.Opacity=p):c.style.filter+=" progid:"+V+"(opacity="+p+")"}function Gi(c){for(var p=document.documentElement.style,T=0;T<c.length;T++)if(c[T]in p)return c[T];return!1}function Lr(c,p,T){var V=p||new ee(0,0);c.style[Hi]=($e.ie3d?"translate("+V.x+"px,"+V.y+"px)":"translate3d("+V.x+"px,"+V.y+"px,0)")+(T?" scale("+T+")":"")}function xt(c,p){c._leaflet_pos=p,$e.any3d?Lr(c,p):(c.style.left=p.x+"px",c.style.top=p.y+"px")}function Fr(c){return c._leaflet_pos||new ee(0,0)}var Ct,wi,Va;if("onselectstart"in document)Ct=function(){at(window,"selectstart",un)},wi=function(){tn(window,"selectstart",un)};else{var us=Gi(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Ct=function(){if(us){var c=document.documentElement.style;Va=c[us],c[us]="none"}},wi=function(){us&&(document.documentElement.style[us]=Va,Va=void 0)}}function za(){at(window,"dragstart",un)}function Ba(){tn(window,"dragstart",un)}var $o,Wo;function Ei(c){for(;c.tabIndex===-1;)c=c.parentNode;c.style&&(Vn(),$o=c,Wo=c.style.outlineStyle,c.style.outlineStyle="none",at(window,"keydown",Vn))}function Vn(){$o&&($o.style.outlineStyle=Wo,$o=void 0,Wo=void 0,tn(window,"keydown",Vn))}function Ti(c){do c=c.parentNode;while((!c.offsetWidth||!c.offsetHeight)&&c!==document.body);return c}function ri(c){var p=c.getBoundingClientRect();return{x:p.width/c.offsetWidth||1,y:p.height/c.offsetHeight||1,boundingClientRect:p}}var fo={__proto__:null,TRANSFORM:Hi,TRANSITION:yn,TRANSITION_END:$i,get:or,getStyle:uo,create:_t,remove:ln,empty:qo,toFront:Bs,toBack:Wi,hasClass:ho,addClass:yt,removeClass:cn,setClass:uc,getClass:bi,setOpacity:En,testProp:Gi,setTransform:Lr,setPosition:xt,getPosition:Fr,get disableTextSelection(){return Ct},get enableTextSelection(){return wi},disableImageDrag:za,enableImageDrag:Ba,preventOutline:Ei,restoreOutline:Vn,getSizedParentNode:Ti,getScale:ri};function at(c,p,T,V){if(p&&typeof p=="object")for(var W in p)hc(c,W,p[W],T);else{p=E(p);for(var re=0,de=p.length;re<de;re++)hc(c,p[re],T,V)}return this}var Wn="_leaflet_events";function tn(c,p,T,V){if(arguments.length===1)dc(c),delete c[Wn];else if(p&&typeof p=="object")for(var W in p)Ua(c,W,p[W],T);else if(p=E(p),arguments.length===2)dc(c,function(_e){return N(p,_e)!==-1});else for(var re=0,de=p.length;re<de;re++)Ua(c,p[re],T,V);return this}function dc(c,p){for(var T in c[Wn]){var V=T.split(/\d/)[0];(!p||p(V))&&Ua(c,V,null,null,T)}}var vr={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function hc(c,p,T,V){var W=p+u(T)+(V?"_"+u(V):"");if(c[Wn]&&c[Wn][W])return this;var re=function(_e){return T.call(V||c,_e||window.event)},de=re;!$e.touchNative&&$e.pointer&&p.indexOf("touch")===0?re=Bo(c,p,re):$e.touch&&p==="dblclick"?re=Xn(c,re):"addEventListener"in c?p==="touchstart"||p==="touchmove"||p==="wheel"||p==="mousewheel"?c.addEventListener(vr[p]||p,re,$e.passiveEvents?{passive:!1}:!1):p==="mouseenter"||p==="mouseleave"?(re=function(_e){_e=_e||window.event,Go(c,_e)&&de(_e)},c.addEventListener(vr[p],re,!1)):c.addEventListener(p,de,!1):c.attachEvent("on"+p,re),c[Wn]=c[Wn]||{},c[Wn][W]=re}function Ua(c,p,T,V,W){W=W||p+u(T)+(V?"_"+u(V):"");var re=c[Wn]&&c[Wn][W];if(!re)return this;!$e.touchNative&&$e.pointer&&p.indexOf("touch")===0?Uo(c,p,re):$e.touch&&p==="dblclick"?$n(c,re):"removeEventListener"in c?c.removeEventListener(vr[p]||p,re,!1):c.detachEvent("on"+p,re),c[Wn][W]=null}function kr(c){return c.stopPropagation?c.stopPropagation():c.originalEvent?c.originalEvent._stopped=!0:c.cancelBubble=!0,this}function Us(c){return hc(c,"wheel",kr),this}function mo(c){return at(c,"mousedown touchstart dblclick contextmenu",kr),c._leaflet_disable_click=!0,this}function un(c){return c.preventDefault?c.preventDefault():c.returnValue=!1,this}function ar(c){return un(c),kr(c),this}function ds(c){if(c.composedPath)return c.composedPath();for(var p=[],T=c.target;T;)p.push(T),T=T.parentNode;return p}function qs(c,p){if(!p)return new ee(c.clientX,c.clientY);var T=ri(p),V=T.boundingClientRect;return new ee((c.clientX-V.left)/T.x-p.clientLeft,(c.clientY-V.top)/T.y-p.clientTop)}var Tn=$e.linux&&$e.chrome?window.devicePixelRatio:$e.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function bu(c){return $e.edge?c.wheelDeltaY/2:c.deltaY&&c.deltaMode===0?-c.deltaY/Tn:c.deltaY&&c.deltaMode===1?-c.deltaY*20:c.deltaY&&c.deltaMode===2?-c.deltaY*60:c.deltaX||c.deltaZ?0:c.wheelDelta?(c.wheelDeltaY||c.wheelDelta)/2:c.detail&&Math.abs(c.detail)<32765?-c.detail*20:c.detail?c.detail/-32765*60:0}function Go(c,p){var T=p.relatedTarget;if(!T)return!0;try{for(;T&&T!==c;)T=T.parentNode}catch{return!1}return T!==c}var Ko={__proto__:null,on:at,off:tn,stopPropagation:kr,disableScrollPropagation:Us,disableClickPropagation:mo,preventDefault:un,stop:ar,getPropagationPath:ds,getMousePosition:qs,getWheelDelta:bu,isExternalTarget:Go,addListener:at,removeListener:tn},Yo=oe.extend({run:function(c,p,T,V){this.stop(),this._el=c,this._inProgress=!0,this._duration=T||.25,this._easeOutPower=1/Math.max(V||.5,.2),this._startPos=Fr(c),this._offset=p.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=O(this._animate,this),this._step()},_step:function(c){var p=+new Date-this._startTime,T=this._duration*1e3;p<T?this._runFrame(this._easeOut(p/T),c):(this._runFrame(1),this._complete())},_runFrame:function(c,p){var T=this._startPos.add(this._offset.multiplyBy(c));p&&T._round(),xt(this._el,T),this.fire("step")},_complete:function(){D(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(c){return 1-Math.pow(1-c,this._easeOutPower)}}),Rt=oe.extend({options:{crs:et,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(c,p){p=x(this,p),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(c),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),p.maxBounds&&this.setMaxBounds(p.maxBounds),p.zoom!==void 0&&(this._zoom=this._limitZoom(p.zoom)),p.center&&p.zoom!==void 0&&this.setView(Q(p.center),p.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=yn&&$e.any3d&&!$e.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),at(this._proxy,$i,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(c,p,T){if(p=p===void 0?this._zoom:this._limitZoom(p),c=this._limitCenter(Q(c),p,this.options.maxBounds),T=T||{},this._stop(),this._loaded&&!T.reset&&T!==!0){T.animate!==void 0&&(T.zoom=i({animate:T.animate},T.zoom),T.pan=i({animate:T.animate,duration:T.duration},T.pan));var V=this._zoom!==p?this._tryAnimatedZoom&&this._tryAnimatedZoom(c,p,T.zoom):this._tryAnimatedPan(c,T.pan);if(V)return clearTimeout(this._sizeTimer),this}return this._resetView(c,p,T.pan&&T.pan.noMoveStart),this},setZoom:function(c,p){return this._loaded?this.setView(this.getCenter(),c,{zoom:p}):(this._zoom=c,this)},zoomIn:function(c,p){return c=c||($e.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+c,p)},zoomOut:function(c,p){return c=c||($e.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-c,p)},setZoomAround:function(c,p,T){var V=this.getZoomScale(p),W=this.getSize().divideBy(2),re=c instanceof ee?c:this.latLngToContainerPoint(c),de=re.subtract(W).multiplyBy(1-1/V),_e=this.containerPointToLatLng(W.add(de));return this.setView(_e,p,{zoom:T})},_getBoundsCenterZoom:function(c,p){p=p||{},c=c.getBounds?c.getBounds():se(c);var T=Y(p.paddingTopLeft||p.padding||[0,0]),V=Y(p.paddingBottomRight||p.padding||[0,0]),W=this.getBoundsZoom(c,!1,T.add(V));if(W=typeof p.maxZoom=="number"?Math.min(p.maxZoom,W):W,W===1/0)return{center:c.getCenter(),zoom:W};var re=V.subtract(T).divideBy(2),de=this.project(c.getSouthWest(),W),_e=this.project(c.getNorthEast(),W),we=this.unproject(de.add(_e).divideBy(2).add(re),W);return{center:we,zoom:W}},fitBounds:function(c,p){if(c=se(c),!c.isValid())throw new Error("Bounds are not valid.");var T=this._getBoundsCenterZoom(c,p);return this.setView(T.center,T.zoom,p)},fitWorld:function(c){return this.fitBounds([[-90,-180],[90,180]],c)},panTo:function(c,p){return this.setView(c,this._zoom,{pan:p})},panBy:function(c,p){if(c=Y(c).round(),p=p||{},!c.x&&!c.y)return this.fire("moveend");if(p.animate!==!0&&!this.getSize().contains(c))return this._resetView(this.unproject(this.project(this.getCenter()).add(c)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Yo,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),p.noMoveStart||this.fire("movestart"),p.animate!==!1){yt(this._mapPane,"leaflet-pan-anim");var T=this._getMapPanePos().subtract(c).round();this._panAnim.run(this._mapPane,T,p.duration||.25,p.easeLinearity)}else this._rawPanBy(c),this.fire("move").fire("moveend");return this},flyTo:function(c,p,T){if(T=T||{},T.animate===!1||!$e.any3d)return this.setView(c,p,T);this._stop();var V=this.project(this.getCenter()),W=this.project(c),re=this.getSize(),de=this._zoom;c=Q(c),p=p===void 0?de:p;var _e=Math.max(re.x,re.y),we=_e*this.getZoomScale(de,p),Pe=W.distanceTo(V)||1,He=1.42,ut=He*He;function Pt(rn){var ll=rn?-1:1,b0=rn?we:_e,w0=we*we-_e*_e+ll*ut*ut*Pe*Pe,na=2*b0*ut*Pe,ra=w0/na,ia=Math.sqrt(ra*ra+1)-ra,Mu=ia<1e-9?-18:Math.log(ia);return Mu}function lr(rn){return(Math.exp(rn)-Math.exp(-rn))/2}function nr(rn){return(Math.exp(rn)+Math.exp(-rn))/2}function oi(rn){return lr(rn)/nr(rn)}var Br=Pt(0);function ol(rn){return _e*(nr(Br)/nr(Br+He*rn))}function gh(rn){return _e*(nr(Br)*oi(Br+He*rn)-lr(Br))/ut}function _o(rn){return 1-Math.pow(1-rn,1.5)}var Um=Date.now(),ta=(Pt(1)-Br)/He,gs=T.duration?1e3*T.duration:1e3*ta*.8;function al(){var rn=(Date.now()-Um)/gs,ll=_o(rn)*ta;rn<=1?(this._flyToFrame=O(al,this),this._move(this.unproject(V.add(W.subtract(V).multiplyBy(gh(ll)/Pe)),de),this.getScaleZoom(_e/ol(ll),de),{flyTo:!0})):this._move(c,p)._moveEnd(!0)}return this._moveStart(!0,T.noMoveStart),al.call(this),this},flyToBounds:function(c,p){var T=this._getBoundsCenterZoom(c,p);return this.flyTo(T.center,T.zoom,p)},setMaxBounds:function(c){return c=se(c),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),c.isValid()?(this.options.maxBounds=c,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(c){var p=this.options.minZoom;return this.options.minZoom=c,this._loaded&&p!==c&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(c):this},setMaxZoom:function(c){var p=this.options.maxZoom;return this.options.maxZoom=c,this._loaded&&p!==c&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(c):this},panInsideBounds:function(c,p){this._enforcingBounds=!0;var T=this.getCenter(),V=this._limitCenter(T,this._zoom,se(c));return T.equals(V)||this.panTo(V,p),this._enforcingBounds=!1,this},panInside:function(c,p){p=p||{};var T=Y(p.paddingTopLeft||p.padding||[0,0]),V=Y(p.paddingBottomRight||p.padding||[0,0]),W=this.project(this.getCenter()),re=this.project(c),de=this.getPixelBounds(),_e=Z([de.min.add(T),de.max.subtract(V)]),we=_e.getSize();if(!_e.contains(re)){this._enforcingBounds=!0;var Pe=re.subtract(_e.getCenter()),He=_e.extend(re).getSize().subtract(we);W.x+=Pe.x<0?-He.x:He.x,W.y+=Pe.y<0?-He.y:He.y,this.panTo(this.unproject(W),p),this._enforcingBounds=!1}return this},invalidateSize:function(c){if(!this._loaded)return this;c=i({animate:!1,pan:!0},c===!0?{animate:!0}:c);var p=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var T=this.getSize(),V=p.divideBy(2).round(),W=T.divideBy(2).round(),re=V.subtract(W);return!re.x&&!re.y?this:(c.animate&&c.pan?this.panBy(re):(c.pan&&this._rawPanBy(re),this.fire("move"),c.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:p,newSize:T}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(c){if(c=this._locateOptions=i({timeout:1e4,watch:!1},c),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var p=o(this._handleGeolocationResponse,this),T=o(this._handleGeolocationError,this);return c.watch?this._locationWatchId=navigator.geolocation.watchPosition(p,T,c):navigator.geolocation.getCurrentPosition(p,T,c),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(c){if(this._container._leaflet_id){var p=c.code,T=c.message||(p===1?"permission denied":p===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:p,message:"Geolocation error: "+T+"."})}},_handleGeolocationResponse:function(c){if(this._container._leaflet_id){var p=c.coords.latitude,T=c.coords.longitude,V=new le(p,T),W=V.toBounds(c.coords.accuracy*2),re=this._locateOptions;if(re.setView){var de=this.getBoundsZoom(W);this.setView(V,re.maxZoom?Math.min(de,re.maxZoom):de)}var _e={latlng:V,bounds:W,timestamp:c.timestamp};for(var we in c.coords)typeof c.coords[we]=="number"&&(_e[we]=c.coords[we]);this.fire("locationfound",_e)}},addHandler:function(c,p){if(!p)return this;var T=this[c]=new p(this);return this._handlers.push(T),this.options[c]&&T.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),ln(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(D(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var c;for(c in this._layers)this._layers[c].remove();for(c in this._panes)ln(this._panes[c]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(c,p){var T="leaflet-pane"+(c?" leaflet-"+c.replace("Pane","")+"-pane":""),V=_t("div",T,p||this._mapPane);return c&&(this._panes[c]=V),V},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var c=this.getPixelBounds(),p=this.unproject(c.getBottomLeft()),T=this.unproject(c.getTopRight());return new ne(p,T)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(c,p,T){c=se(c),T=Y(T||[0,0]);var V=this.getZoom()||0,W=this.getMinZoom(),re=this.getMaxZoom(),de=c.getNorthWest(),_e=c.getSouthEast(),we=this.getSize().subtract(T),Pe=Z(this.project(_e,V),this.project(de,V)).getSize(),He=$e.any3d?this.options.zoomSnap:1,ut=we.x/Pe.x,Pt=we.y/Pe.y,lr=p?Math.max(ut,Pt):Math.min(ut,Pt);return V=this.getScaleZoom(lr,V),He&&(V=Math.round(V/(He/100))*(He/100),V=p?Math.ceil(V/He)*He:Math.floor(V/He)*He),Math.max(W,Math.min(re,V))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ee(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(c,p){var T=this._getTopLeftPoint(c,p);return new q(T,T.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(c){return this.options.crs.getProjectedBounds(c===void 0?this.getZoom():c)},getPane:function(c){return typeof c=="string"?this._panes[c]:c},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(c,p){var T=this.options.crs;return p=p===void 0?this._zoom:p,T.scale(c)/T.scale(p)},getScaleZoom:function(c,p){var T=this.options.crs;p=p===void 0?this._zoom:p;var V=T.zoom(c*T.scale(p));return isNaN(V)?1/0:V},project:function(c,p){return p=p===void 0?this._zoom:p,this.options.crs.latLngToPoint(Q(c),p)},unproject:function(c,p){return p=p===void 0?this._zoom:p,this.options.crs.pointToLatLng(Y(c),p)},layerPointToLatLng:function(c){var p=Y(c).add(this.getPixelOrigin());return this.unproject(p)},latLngToLayerPoint:function(c){var p=this.project(Q(c))._round();return p._subtract(this.getPixelOrigin())},wrapLatLng:function(c){return this.options.crs.wrapLatLng(Q(c))},wrapLatLngBounds:function(c){return this.options.crs.wrapLatLngBounds(se(c))},distance:function(c,p){return this.options.crs.distance(Q(c),Q(p))},containerPointToLayerPoint:function(c){return Y(c).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(c){return Y(c).add(this._getMapPanePos())},containerPointToLatLng:function(c){var p=this.containerPointToLayerPoint(Y(c));return this.layerPointToLatLng(p)},latLngToContainerPoint:function(c){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Q(c)))},mouseEventToContainerPoint:function(c){return qs(c,this._container)},mouseEventToLayerPoint:function(c){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(c))},mouseEventToLatLng:function(c){return this.layerPointToLatLng(this.mouseEventToLayerPoint(c))},_initContainer:function(c){var p=this._container=or(c);if(p){if(p._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");at(p,"scroll",this._onScroll,this),this._containerId=u(p)},_initLayout:function(){var c=this._container;this._fadeAnimated=this.options.fadeAnimation&&$e.any3d,yt(c,"leaflet-container"+($e.touch?" leaflet-touch":"")+($e.retina?" leaflet-retina":"")+($e.ielt9?" leaflet-oldie":"")+($e.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var p=uo(c,"position");p!=="absolute"&&p!=="relative"&&p!=="fixed"&&p!=="sticky"&&(c.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var c=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),xt(this._mapPane,new ee(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(yt(c.markerPane,"leaflet-zoom-hide"),yt(c.shadowPane,"leaflet-zoom-hide"))},_resetView:function(c,p,T){xt(this._mapPane,new ee(0,0));var V=!this._loaded;this._loaded=!0,p=this._limitZoom(p),this.fire("viewprereset");var W=this._zoom!==p;this._moveStart(W,T)._move(c,p)._moveEnd(W),this.fire("viewreset"),V&&this.fire("load")},_moveStart:function(c,p){return c&&this.fire("zoomstart"),p||this.fire("movestart"),this},_move:function(c,p,T,V){p===void 0&&(p=this._zoom);var W=this._zoom!==p;return this._zoom=p,this._lastCenter=c,this._pixelOrigin=this._getNewPixelOrigin(c),V?T&&T.pinch&&this.fire("zoom",T):((W||T&&T.pinch)&&this.fire("zoom",T),this.fire("move",T)),this},_moveEnd:function(c){return c&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return D(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(c){xt(this._mapPane,this._getMapPanePos().subtract(c))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(c){this._targets={},this._targets[u(this._container)]=this;var p=c?tn:at;p(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&p(window,"resize",this._onResize,this),$e.any3d&&this.options.transform3DLimit&&(c?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){D(this._resizeRequest),this._resizeRequest=O(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var c=this._getMapPanePos();Math.max(Math.abs(c.x),Math.abs(c.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(c,p){for(var T=[],V,W=p==="mouseout"||p==="mouseover",re=c.target||c.srcElement,de=!1;re;){if(V=this._targets[u(re)],V&&(p==="click"||p==="preclick")&&this._draggableMoved(V)){de=!0;break}if(V&&V.listens(p,!0)&&(W&&!Go(re,c)||(T.push(V),W))||re===this._container)break;re=re.parentNode}return!T.length&&!de&&!W&&this.listens(p,!0)&&(T=[this]),T},_isClickDisabled:function(c){for(;c&&c!==this._container;){if(c._leaflet_disable_click)return!0;c=c.parentNode}},_handleDOMEvent:function(c){var p=c.target||c.srcElement;if(!(!this._loaded||p._leaflet_disable_events||c.type==="click"&&this._isClickDisabled(p))){var T=c.type;T==="mousedown"&&Ei(p),this._fireDOMEvent(c,T)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(c,p,T){if(c.type==="click"){var V=i({},c);V.type="preclick",this._fireDOMEvent(V,V.type,T)}var W=this._findEventTargets(c,p);if(T){for(var re=[],de=0;de<T.length;de++)T[de].listens(p,!0)&&re.push(T[de]);W=re.concat(W)}if(W.length){p==="contextmenu"&&un(c);var _e=W[0],we={originalEvent:c};if(c.type!=="keypress"&&c.type!=="keydown"&&c.type!=="keyup"){var Pe=_e.getLatLng&&(!_e._radius||_e._radius<=10);we.containerPoint=Pe?this.latLngToContainerPoint(_e.getLatLng()):this.mouseEventToContainerPoint(c),we.layerPoint=this.containerPointToLayerPoint(we.containerPoint),we.latlng=Pe?_e.getLatLng():this.layerPointToLatLng(we.layerPoint)}for(de=0;de<W.length;de++)if(W[de].fire(p,we,!0),we.originalEvent._stopped||W[de].options.bubblingMouseEvents===!1&&N(this._mouseEvents,p)!==-1)return}},_draggableMoved:function(c){return c=c.dragging&&c.dragging.enabled()?c:this,c.dragging&&c.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var c=0,p=this._handlers.length;c<p;c++)this._handlers[c].disable()},whenReady:function(c,p){return this._loaded?c.call(p||this,{target:this}):this.on("load",c,p),this},_getMapPanePos:function(){return Fr(this._mapPane)||new ee(0,0)},_moved:function(){var c=this._getMapPanePos();return c&&!c.equals([0,0])},_getTopLeftPoint:function(c,p){var T=c&&p!==void 0?this._getNewPixelOrigin(c,p):this.getPixelOrigin();return T.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(c,p){var T=this.getSize()._divideBy(2);return this.project(c,p)._subtract(T)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(c,p,T){var V=this._getNewPixelOrigin(T,p);return this.project(c,p)._subtract(V)},_latLngBoundsToNewLayerBounds:function(c,p,T){var V=this._getNewPixelOrigin(T,p);return Z([this.project(c.getSouthWest(),p)._subtract(V),this.project(c.getNorthWest(),p)._subtract(V),this.project(c.getSouthEast(),p)._subtract(V),this.project(c.getNorthEast(),p)._subtract(V)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(c){return this.latLngToLayerPoint(c).subtract(this._getCenterLayerPoint())},_limitCenter:function(c,p,T){if(!T)return c;var V=this.project(c,p),W=this.getSize().divideBy(2),re=new q(V.subtract(W),V.add(W)),de=this._getBoundsOffset(re,T,p);return Math.abs(de.x)<=1&&Math.abs(de.y)<=1?c:this.unproject(V.add(de),p)},_limitOffset:function(c,p){if(!p)return c;var T=this.getPixelBounds(),V=new q(T.min.add(c),T.max.add(c));return c.add(this._getBoundsOffset(V,p))},_getBoundsOffset:function(c,p,T){var V=Z(this.project(p.getNorthEast(),T),this.project(p.getSouthWest(),T)),W=V.min.subtract(c.min),re=V.max.subtract(c.max),de=this._rebound(W.x,-re.x),_e=this._rebound(W.y,-re.y);return new ee(de,_e)},_rebound:function(c,p){return c+p>0?Math.round(c-p)/2:Math.max(0,Math.ceil(c))-Math.max(0,Math.floor(p))},_limitZoom:function(c){var p=this.getMinZoom(),T=this.getMaxZoom(),V=$e.any3d?this.options.zoomSnap:1;return V&&(c=Math.round(c/V)*V),Math.max(p,Math.min(T,c))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){cn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(c,p){var T=this._getCenterOffset(c)._trunc();return(p&&p.animate)!==!0&&!this.getSize().contains(T)?!1:(this.panBy(T,p),!0)},_createAnimProxy:function(){var c=this._proxy=_t("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(c),this.on("zoomanim",function(p){var T=Hi,V=this._proxy.style[T];Lr(this._proxy,this.project(p.center,p.zoom),this.getZoomScale(p.zoom,1)),V===this._proxy.style[T]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){ln(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var c=this.getCenter(),p=this.getZoom();Lr(this._proxy,this.project(c,p),this.getZoomScale(p,1))},_catchTransitionEnd:function(c){this._animatingZoom&&c.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(c,p,T){if(this._animatingZoom)return!0;if(T=T||{},!this._zoomAnimated||T.animate===!1||this._nothingToAnimate()||Math.abs(p-this._zoom)>this.options.zoomAnimationThreshold)return!1;var V=this.getZoomScale(p),W=this._getCenterOffset(c)._divideBy(1-1/V);return T.animate!==!0&&!this.getSize().contains(W)?!1:(O(function(){this._moveStart(!0,T.noMoveStart||!1)._animateZoom(c,p,!0)},this),!0)},_animateZoom:function(c,p,T,V){this._mapPane&&(T&&(this._animatingZoom=!0,this._animateToCenter=c,this._animateToZoom=p,yt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:c,zoom:p,noUpdate:V}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&cn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function ii(c,p){return new Rt(c,p)}var _r=$.extend({options:{position:"topright"},initialize:function(c){x(this,c)},getPosition:function(){return this.options.position},setPosition:function(c){var p=this._map;return p&&p.removeControl(this),this.options.position=c,p&&p.addControl(this),this},getContainer:function(){return this._container},addTo:function(c){this.remove(),this._map=c;var p=this._container=this.onAdd(c),T=this.getPosition(),V=c._controlCorners[T];return yt(p,"leaflet-control"),T.indexOf("bottom")!==-1?V.insertBefore(p,V.firstChild):V.appendChild(p),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(ln(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(c){this._map&&c&&c.screenX>0&&c.screenY>0&&this._map.getContainer().focus()}}),Jn=function(c){return new _r(c)};Rt.include({addControl:function(c){return c.addTo(this),this},removeControl:function(c){return c.remove(),this},_initControlPos:function(){var c=this._controlCorners={},p="leaflet-",T=this._controlContainer=_t("div",p+"control-container",this._container);function V(W,re){var de=p+W+" "+p+re;c[W+re]=_t("div",de,T)}V("top","left"),V("top","right"),V("bottom","left"),V("bottom","right")},_clearControlPos:function(){for(var c in this._controlCorners)ln(this._controlCorners[c]);ln(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var qa=_r.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(c,p,T,V){return T<V?-1:V<T?1:0}},initialize:function(c,p,T){x(this,T),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var V in c)this._addLayer(c[V],V);for(V in p)this._addLayer(p[V],V,!0)},onAdd:function(c){this._initLayout(),this._update(),this._map=c,c.on("zoomend",this._checkDisabledLayers,this);for(var p=0;p<this._layers.length;p++)this._layers[p].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(c){return _r.prototype.addTo.call(this,c),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(c,p){return this._addLayer(c,p),this._map?this._update():this},addOverlay:function(c,p){return this._addLayer(c,p,!0),this._map?this._update():this},removeLayer:function(c){c.off("add remove",this._onLayerChange,this);var p=this._getLayer(u(c));return p&&this._layers.splice(this._layers.indexOf(p),1),this._map?this._update():this},expand:function(){yt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var c=this._map.getSize().y-(this._container.offsetTop+50);return c<this._section.clientHeight?(yt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=c+"px"):cn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return cn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var c="leaflet-control-layers",p=this._container=_t("div",c),T=this.options.collapsed;p.setAttribute("aria-haspopup",!0),mo(p),Us(p);var V=this._section=_t("section",c+"-list");T&&(this._map.on("click",this.collapse,this),at(p,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var W=this._layersLink=_t("a",c+"-toggle",p);W.href="#",W.title="Layers",W.setAttribute("role","button"),at(W,{keydown:function(re){re.keyCode===13&&this._expandSafely()},click:function(re){un(re),this._expandSafely()}},this),T||this.expand(),this._baseLayersList=_t("div",c+"-base",V),this._separator=_t("div",c+"-separator",V),this._overlaysList=_t("div",c+"-overlays",V),p.appendChild(V)},_getLayer:function(c){for(var p=0;p<this._layers.length;p++)if(this._layers[p]&&u(this._layers[p].layer)===c)return this._layers[p]},_addLayer:function(c,p,T){this._map&&c.on("add remove",this._onLayerChange,this),this._layers.push({layer:c,name:p,overlay:T}),this.options.sortLayers&&this._layers.sort(o(function(V,W){return this.options.sortFunction(V.layer,W.layer,V.name,W.name)},this)),this.options.autoZIndex&&c.setZIndex&&(this._lastZIndex++,c.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;qo(this._baseLayersList),qo(this._overlaysList),this._layerControlInputs=[];var c,p,T,V,W=0;for(T=0;T<this._layers.length;T++)V=this._layers[T],this._addItem(V),p=p||V.overlay,c=c||!V.overlay,W+=V.overlay?0:1;return this.options.hideSingleBase&&(c=c&&W>1,this._baseLayersList.style.display=c?"":"none"),this._separator.style.display=p&&c?"":"none",this},_onLayerChange:function(c){this._handlingClick||this._update();var p=this._getLayer(u(c.target)),T=p.overlay?c.type==="add"?"overlayadd":"overlayremove":c.type==="add"?"baselayerchange":null;T&&this._map.fire(T,p)},_createRadioElement:function(c,p){var T='<input type="radio" class="leaflet-control-layers-selector" name="'+c+'"'+(p?' checked="checked"':"")+"/>",V=document.createElement("div");return V.innerHTML=T,V.firstChild},_addItem:function(c){var p=document.createElement("label"),T=this._map.hasLayer(c.layer),V;c.overlay?(V=document.createElement("input"),V.type="checkbox",V.className="leaflet-control-layers-selector",V.defaultChecked=T):V=this._createRadioElement("leaflet-base-layers_"+u(this),T),this._layerControlInputs.push(V),V.layerId=u(c.layer),at(V,"click",this._onInputClick,this);var W=document.createElement("span");W.innerHTML=" "+c.name;var re=document.createElement("span");p.appendChild(re),re.appendChild(V),re.appendChild(W);var de=c.overlay?this._overlaysList:this._baseLayersList;return de.appendChild(p),this._checkDisabledLayers(),p},_onInputClick:function(){if(!this._preventClick){var c=this._layerControlInputs,p,T,V=[],W=[];this._handlingClick=!0;for(var re=c.length-1;re>=0;re--)p=c[re],T=this._getLayer(p.layerId).layer,p.checked?V.push(T):p.checked||W.push(T);for(re=0;re<W.length;re++)this._map.hasLayer(W[re])&&this._map.removeLayer(W[re]);for(re=0;re<V.length;re++)this._map.hasLayer(V[re])||this._map.addLayer(V[re]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var c=this._layerControlInputs,p,T,V=this._map.getZoom(),W=c.length-1;W>=0;W--)p=c[W],T=this._getLayer(p.layerId).layer,p.disabled=T.options.minZoom!==void 0&&V<T.options.minZoom||T.options.maxZoom!==void 0&&V>T.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var c=this._section;this._preventClick=!0,at(c,"click",un),this.expand();var p=this;setTimeout(function(){tn(c,"click",un),p._preventClick=!1})}}),Ha=function(c,p,T){return new qa(c,p,T)},Si=_r.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(c){var p="leaflet-control-zoom",T=_t("div",p+" leaflet-bar"),V=this.options;return this._zoomInButton=this._createButton(V.zoomInText,V.zoomInTitle,p+"-in",T,this._zoomIn),this._zoomOutButton=this._createButton(V.zoomOutText,V.zoomOutTitle,p+"-out",T,this._zoomOut),this._updateDisabled(),c.on("zoomend zoomlevelschange",this._updateDisabled,this),T},onRemove:function(c){c.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(c){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(c.shiftKey?3:1))},_zoomOut:function(c){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(c.shiftKey?3:1))},_createButton:function(c,p,T,V,W){var re=_t("a",T,V);return re.innerHTML=c,re.href="#",re.title=p,re.setAttribute("role","button"),re.setAttribute("aria-label",p),mo(re),at(re,"click",ar),at(re,"click",W,this),at(re,"click",this._refocusOnMap,this),re},_updateDisabled:function(){var c=this._map,p="leaflet-disabled";cn(this._zoomInButton,p),cn(this._zoomOutButton,p),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||c._zoom===c.getMinZoom())&&(yt(this._zoomOutButton,p),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||c._zoom===c.getMaxZoom())&&(yt(this._zoomInButton,p),this._zoomInButton.setAttribute("aria-disabled","true"))}});Rt.mergeOptions({zoomControl:!0}),Rt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Si,this.addControl(this.zoomControl))});var fc=function(c){return new Si(c)},er=_r.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(c){var p="leaflet-control-scale",T=_t("div",p),V=this.options;return this._addScales(V,p+"-line",T),c.on(V.updateWhenIdle?"moveend":"move",this._update,this),c.whenReady(this._update,this),T},onRemove:function(c){c.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(c,p,T){c.metric&&(this._mScale=_t("div",p,T)),c.imperial&&(this._iScale=_t("div",p,T))},_update:function(){var c=this._map,p=c.getSize().y/2,T=c.distance(c.containerPointToLatLng([0,p]),c.containerPointToLatLng([this.options.maxWidth,p]));this._updateScales(T)},_updateScales:function(c){this.options.metric&&c&&this._updateMetric(c),this.options.imperial&&c&&this._updateImperial(c)},_updateMetric:function(c){var p=this._getRoundNum(c),T=p<1e3?p+" m":p/1e3+" km";this._updateScale(this._mScale,T,p/c)},_updateImperial:function(c){var p=c*3.2808399,T,V,W;p>5280?(T=p/5280,V=this._getRoundNum(T),this._updateScale(this._iScale,V+" mi",V/T)):(W=this._getRoundNum(p),this._updateScale(this._iScale,W+" ft",W/p))},_updateScale:function(c,p,T){c.style.width=Math.round(this.options.maxWidth*T)+"px",c.innerHTML=p},_getRoundNum:function(c){var p=Math.pow(10,(Math.floor(c)+"").length-1),T=c/p;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:1,p*T}}),Ki=function(c){return new er(c)},$a='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Ai=_r.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+($e.inlineSvg?$a+" ":"")+"Leaflet</a>"},initialize:function(c){x(this,c),this._attributions={}},onAdd:function(c){c.attributionControl=this,this._container=_t("div","leaflet-control-attribution"),mo(this._container);for(var p in c._layers)c._layers[p].getAttribution&&this.addAttribution(c._layers[p].getAttribution());return this._update(),c.on("layeradd",this._addAttribution,this),this._container},onRemove:function(c){c.off("layeradd",this._addAttribution,this)},_addAttribution:function(c){c.layer.getAttribution&&(this.addAttribution(c.layer.getAttribution()),c.layer.once("remove",function(){this.removeAttribution(c.layer.getAttribution())},this))},setPrefix:function(c){return this.options.prefix=c,this._update(),this},addAttribution:function(c){return c?(this._attributions[c]||(this._attributions[c]=0),this._attributions[c]++,this._update(),this):this},removeAttribution:function(c){return c?(this._attributions[c]&&(this._attributions[c]--,this._update()),this):this},_update:function(){if(this._map){var c=[];for(var p in this._attributions)this._attributions[p]&&c.push(p);var T=[];this.options.prefix&&T.push(this.options.prefix),c.length&&T.push(c.join(", ")),this._container.innerHTML=T.join(' <span aria-hidden="true">|</span> ')}}});Rt.mergeOptions({attributionControl:!0}),Rt.addInitHook(function(){this.options.attributionControl&&new Ai().addTo(this)});var ih=function(c){return new Ai(c)};_r.Layers=qa,_r.Zoom=Si,_r.Scale=er,_r.Attribution=Ai,Jn.layers=Ha,Jn.zoom=fc,Jn.scale=Ki,Jn.attribution=ih;var Pr=$.extend({initialize:function(c){this._map=c},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Pr.addTo=function(c,p){return c.addHandler(p,this),this};var Hs={Events:ie},$s=$e.touch?"touchstart mousedown":"mousedown",Vr=oe.extend({options:{clickTolerance:3},initialize:function(c,p,T,V){x(this,V),this._element=c,this._dragStartTarget=p||c,this._preventOutline=T},enable:function(){this._enabled||(at(this._dragStartTarget,$s,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Vr._dragging===this&&this.finishDrag(!0),tn(this._dragStartTarget,$s,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(c){if(this._enabled&&(this._moved=!1,!ho(this._element,"leaflet-zoom-anim"))){if(c.touches&&c.touches.length!==1){Vr._dragging===this&&this.finishDrag();return}if(!(Vr._dragging||c.shiftKey||c.which!==1&&c.button!==1&&!c.touches)&&(Vr._dragging=this,this._preventOutline&&Ei(this._element),za(),Ct(),!this._moving)){this.fire("down");var p=c.touches?c.touches[0]:c,T=Ti(this._element);this._startPoint=new ee(p.clientX,p.clientY),this._startPos=Fr(this._element),this._parentScale=ri(T);var V=c.type==="mousedown";at(document,V?"mousemove":"touchmove",this._onMove,this),at(document,V?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(c){if(this._enabled){if(c.touches&&c.touches.length>1){this._moved=!0;return}var p=c.touches&&c.touches.length===1?c.touches[0]:c,T=new ee(p.clientX,p.clientY)._subtract(this._startPoint);!T.x&&!T.y||Math.abs(T.x)+Math.abs(T.y)<this.options.clickTolerance||(T.x/=this._parentScale.x,T.y/=this._parentScale.y,un(c),this._moved||(this.fire("dragstart"),this._moved=!0,yt(document.body,"leaflet-dragging"),this._lastTarget=c.target||c.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),yt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(T),this._moving=!0,this._lastEvent=c,this._updatePosition())}},_updatePosition:function(){var c={originalEvent:this._lastEvent};this.fire("predrag",c),xt(this._element,this._newPos),this.fire("drag",c)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(c){cn(document.body,"leaflet-dragging"),this._lastTarget&&(cn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),tn(document,"mousemove touchmove",this._onMove,this),tn(document,"mouseup touchend touchcancel",this._onUp,this),Ba(),wi();var p=this._moved&&this._moving;this._moving=!1,Vr._dragging=!1,p&&this.fire("dragend",{noInertia:c,distance:this._newPos.distanceTo(this._startPos)})}});function Zo(c,p,T){var V,W=[1,4,2,8],re,de,_e,we,Pe,He,ut,Pt;for(re=0,He=c.length;re<He;re++)c[re]._code=hs(c[re],p);for(_e=0;_e<4;_e++){for(ut=W[_e],V=[],re=0,He=c.length,de=He-1;re<He;de=re++)we=c[re],Pe=c[de],we._code&ut?Pe._code&ut||(Pt=tr(Pe,we,ut,p,T),Pt._code=hs(Pt,p),V.push(Pt)):(Pe._code&ut&&(Pt=tr(Pe,we,ut,p,T),Pt._code=hs(Pt,p),V.push(Pt)),V.push(we));c=V}return c}function Wa(c,p){var T,V,W,re,de,_e,we,Pe,He;if(!c||c.length===0)throw new Error("latlngs not passed");b(c)||(console.warn("latlngs are not flat! Only the first ring will be used"),c=c[0]);var ut=Q([0,0]),Pt=se(c),lr=Pt.getNorthWest().distanceTo(Pt.getSouthWest())*Pt.getNorthEast().distanceTo(Pt.getNorthWest());lr<1700&&(ut=Ga(c));var nr=c.length,oi=[];for(T=0;T<nr;T++){var Br=Q(c[T]);oi.push(p.project(Q([Br.lat-ut.lat,Br.lng-ut.lng])))}for(_e=we=Pe=0,T=0,V=nr-1;T<nr;V=T++)W=oi[T],re=oi[V],de=W.y*re.x-re.y*W.x,we+=(W.x+re.x)*de,Pe+=(W.y+re.y)*de,_e+=de*3;_e===0?He=oi[0]:He=[we/_e,Pe/_e];var ol=p.unproject(Y(He));return Q([ol.lat+ut.lat,ol.lng+ut.lng])}function Ga(c){for(var p=0,T=0,V=0,W=0;W<c.length;W++){var re=Q(c[W]);p+=re.lat,T+=re.lng,V++}return Q([p/V,T/V])}var Ka={__proto__:null,clipPolygon:Zo,polygonCenter:Wa,centroid:Ga};function Qo(c,p){if(!p||!c.length)return c.slice();var T=p*p;return c=Eu(c,T),c=wu(c,T),c}function mc(c,p,T){return Math.sqrt(zr(c,p,T,!0))}function Ws(c,p,T){return zr(c,p,T)}function wu(c,p){var T=c.length,V=typeof Uint8Array<"u"?Uint8Array:Array,W=new V(T);W[0]=W[T-1]=1,Ya(c,W,p,0,T-1);var re,de=[];for(re=0;re<T;re++)W[re]&&de.push(c[re]);return de}function Ya(c,p,T,V,W){var re=0,de,_e,we;for(_e=V+1;_e<=W-1;_e++)we=zr(c[_e],c[V],c[W],!0),we>re&&(de=_e,re=we);re>T&&(p[de]=1,Ya(c,p,T,V,de),Ya(c,p,T,de,W))}function Eu(c,p){for(var T=[c[0]],V=1,W=0,re=c.length;V<re;V++)Tu(c[V],c[W])>p&&(T.push(c[V]),W=V);return W<re-1&&T.push(c[re-1]),T}var Za;function Xo(c,p,T,V,W){var re=V?Za:hs(c,T),de=hs(p,T),_e,we,Pe;for(Za=de;;){if(!(re|de))return[c,p];if(re&de)return!1;_e=re||de,we=tr(c,p,_e,T,W),Pe=hs(we,T),_e===re?(c=we,re=Pe):(p=we,de=Pe)}}function tr(c,p,T,V,W){var re=p.x-c.x,de=p.y-c.y,_e=V.min,we=V.max,Pe,He;return T&8?(Pe=c.x+re*(we.y-c.y)/de,He=we.y):T&4?(Pe=c.x+re*(_e.y-c.y)/de,He=_e.y):T&2?(Pe=we.x,He=c.y+de*(we.x-c.x)/re):T&1&&(Pe=_e.x,He=c.y+de*(_e.x-c.x)/re),new ee(Pe,He,W)}function hs(c,p){var T=0;return c.x<p.min.x?T|=1:c.x>p.max.x&&(T|=2),c.y<p.min.y?T|=4:c.y>p.max.y&&(T|=8),T}function Tu(c,p){var T=p.x-c.x,V=p.y-c.y;return T*T+V*V}function zr(c,p,T,V){var W=p.x,re=p.y,de=T.x-W,_e=T.y-re,we=de*de+_e*_e,Pe;return we>0&&(Pe=((c.x-W)*de+(c.y-re)*_e)/we,Pe>1?(W=T.x,re=T.y):Pe>0&&(W+=de*Pe,re+=_e*Pe)),de=c.x-W,_e=c.y-re,V?de*de+_e*_e:new ee(W,re)}function b(c){return!C(c[0])||typeof c[0][0]!="object"&&typeof c[0][0]<"u"}function U(c){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),b(c)}function K(c,p){var T,V,W,re,de,_e,we,Pe;if(!c||c.length===0)throw new Error("latlngs not passed");b(c)||(console.warn("latlngs are not flat! Only the first ring will be used"),c=c[0]);var He=Q([0,0]),ut=se(c),Pt=ut.getNorthWest().distanceTo(ut.getSouthWest())*ut.getNorthEast().distanceTo(ut.getNorthWest());Pt<1700&&(He=Ga(c));var lr=c.length,nr=[];for(T=0;T<lr;T++){var oi=Q(c[T]);nr.push(p.project(Q([oi.lat-He.lat,oi.lng-He.lng])))}for(T=0,V=0;T<lr-1;T++)V+=nr[T].distanceTo(nr[T+1])/2;if(V===0)Pe=nr[0];else for(T=0,re=0;T<lr-1;T++)if(de=nr[T],_e=nr[T+1],W=de.distanceTo(_e),re+=W,re>V){we=(re-V)/W,Pe=[_e.x-we*(_e.x-de.x),_e.y-we*(_e.y-de.y)];break}var Br=p.unproject(Y(Pe));return Q([Br.lat+He.lat,Br.lng+He.lng])}var ae={__proto__:null,simplify:Qo,pointToSegmentDistance:mc,closestPointOnSegment:Ws,clipSegment:Xo,_getEdgeIntersection:tr,_getBitCode:hs,_sqClosestPointOnSegment:zr,isFlat:b,_flat:U,polylineCenter:K},ye={project:function(c){return new ee(c.lng,c.lat)},unproject:function(c){return new le(c.y,c.x)},bounds:new q([-180,-90],[180,90])},Te={R:6378137,R_MINOR:6356752314245179e-9,bounds:new q([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(c){var p=Math.PI/180,T=this.R,V=c.lat*p,W=this.R_MINOR/T,re=Math.sqrt(1-W*W),de=re*Math.sin(V),_e=Math.tan(Math.PI/4-V/2)/Math.pow((1-de)/(1+de),re/2);return V=-T*Math.log(Math.max(_e,1e-10)),new ee(c.lng*p*T,V)},unproject:function(c){for(var p=180/Math.PI,T=this.R,V=this.R_MINOR/T,W=Math.sqrt(1-V*V),re=Math.exp(-c.y/T),de=Math.PI/2-2*Math.atan(re),_e=0,we=.1,Pe;_e<15&&Math.abs(we)>1e-7;_e++)Pe=W*Math.sin(de),Pe=Math.pow((1-Pe)/(1+Pe),W/2),we=Math.PI/2-2*Math.atan(re*Pe)-de,de+=we;return new le(de*p,c.x*p/T)}},ze={__proto__:null,LonLat:ye,Mercator:Te,SphericalMercator:Ae},en=i({},me,{code:"EPSG:3395",projection:Te,transformation:function(){var c=.5/(Math.PI*Te.R);return nt(c,.5,-c,.5)}()}),zn=i({},me,{code:"EPSG:4326",projection:ye,transformation:nt(1/180,1,-1/180,.5)}),zt=i({},ce,{projection:ye,transformation:nt(1,0,-1,0),scale:function(c){return Math.pow(2,c)},zoom:function(c){return Math.log(c)/Math.LN2},distance:function(c,p){var T=p.lng-c.lng,V=p.lat-c.lat;return Math.sqrt(T*T+V*V)},infinite:!0});ce.Earth=me,ce.EPSG3395=en,ce.EPSG3857=et,ce.EPSG900913=pt,ce.EPSG4326=zn,ce.Simple=zt;var nn=oe.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(c){return c.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(c){return c&&c.removeLayer(this),this},getPane:function(c){return this._map.getPane(c?this.options[c]||c:this.options.pane)},addInteractiveTarget:function(c){return this._map._targets[u(c)]=this,this},removeInteractiveTarget:function(c){return delete this._map._targets[u(c)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(c){var p=c.target;if(p.hasLayer(this)){if(this._map=p,this._zoomAnimated=p._zoomAnimated,this.getEvents){var T=this.getEvents();p.on(T,this),this.once("remove",function(){p.off(T,this)},this)}this.onAdd(p),this.fire("add"),p.fire("layeradd",{layer:this})}}});Rt.include({addLayer:function(c){if(!c._layerAdd)throw new Error("The provided object is not a Layer.");var p=u(c);return this._layers[p]?this:(this._layers[p]=c,c._mapToAdd=this,c.beforeAdd&&c.beforeAdd(this),this.whenReady(c._layerAdd,c),this)},removeLayer:function(c){var p=u(c);return this._layers[p]?(this._loaded&&c.onRemove(this),delete this._layers[p],this._loaded&&(this.fire("layerremove",{layer:c}),c.fire("remove")),c._map=c._mapToAdd=null,this):this},hasLayer:function(c){return u(c)in this._layers},eachLayer:function(c,p){for(var T in this._layers)c.call(p,this._layers[T]);return this},_addLayers:function(c){c=c?C(c)?c:[c]:[];for(var p=0,T=c.length;p<T;p++)this.addLayer(c[p])},_addZoomLimit:function(c){(!isNaN(c.options.maxZoom)||!isNaN(c.options.minZoom))&&(this._zoomBoundLayers[u(c)]=c,this._updateZoomLevels())},_removeZoomLimit:function(c){var p=u(c);this._zoomBoundLayers[p]&&(delete this._zoomBoundLayers[p],this._updateZoomLevels())},_updateZoomLevels:function(){var c=1/0,p=-1/0,T=this._getZoomSpan();for(var V in this._zoomBoundLayers){var W=this._zoomBoundLayers[V].options;c=W.minZoom===void 0?c:Math.min(c,W.minZoom),p=W.maxZoom===void 0?p:Math.max(p,W.maxZoom)}this._layersMaxZoom=p===-1/0?void 0:p,this._layersMinZoom=c===1/0?void 0:c,T!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var wn=nn.extend({initialize:function(c,p){x(this,p),this._layers={};var T,V;if(c)for(T=0,V=c.length;T<V;T++)this.addLayer(c[T])},addLayer:function(c){var p=this.getLayerId(c);return this._layers[p]=c,this._map&&this._map.addLayer(c),this},removeLayer:function(c){var p=c in this._layers?c:this.getLayerId(c);return this._map&&this._layers[p]&&this._map.removeLayer(this._layers[p]),delete this._layers[p],this},hasLayer:function(c){var p=typeof c=="number"?c:this.getLayerId(c);return p in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(c){var p=Array.prototype.slice.call(arguments,1),T,V;for(T in this._layers)V=this._layers[T],V[c]&&V[c].apply(V,p);return this},onAdd:function(c){this.eachLayer(c.addLayer,c)},onRemove:function(c){this.eachLayer(c.removeLayer,c)},eachLayer:function(c,p){for(var T in this._layers)c.call(p,this._layers[T]);return this},getLayer:function(c){return this._layers[c]},getLayers:function(){var c=[];return this.eachLayer(c.push,c),c},setZIndex:function(c){return this.invoke("setZIndex",c)},getLayerId:function(c){return u(c)}}),Ii=function(c,p){return new wn(c,p)},Mn=wn.extend({addLayer:function(c){return this.hasLayer(c)?this:(c.addEventParent(this),wn.prototype.addLayer.call(this,c),this.fire("layeradd",{layer:c}))},removeLayer:function(c){return this.hasLayer(c)?(c in this._layers&&(c=this._layers[c]),c.removeEventParent(this),wn.prototype.removeLayer.call(this,c),this.fire("layerremove",{layer:c})):this},setStyle:function(c){return this.invoke("setStyle",c)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var c=new ne;for(var p in this._layers){var T=this._layers[p];c.extend(T.getBounds?T.getBounds():T.getLatLng())}return c}}),Jo=function(c,p){return new Mn(c,p)},Yi=$.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(c){x(this,c)},createIcon:function(c){return this._createIcon("icon",c)},createShadow:function(c){return this._createIcon("shadow",c)},_createIcon:function(c,p){var T=this._getIconUrl(c);if(!T){if(c==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var V=this._createImg(T,p&&p.tagName==="IMG"?p:null);return this._setIconStyles(V,c),(this.options.crossOrigin||this.options.crossOrigin==="")&&(V.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),V},_setIconStyles:function(c,p){var T=this.options,V=T[p+"Size"];typeof V=="number"&&(V=[V,V]);var W=Y(V),re=Y(p==="shadow"&&T.shadowAnchor||T.iconAnchor||W&&W.divideBy(2,!0));c.className="leaflet-marker-"+p+" "+(T.className||""),re&&(c.style.marginLeft=-re.x+"px",c.style.marginTop=-re.y+"px"),W&&(c.style.width=W.x+"px",c.style.height=W.y+"px")},_createImg:function(c,p){return p=p||document.createElement("img"),p.src=c,p},_getIconUrl:function(c){return $e.retina&&this.options[c+"RetinaUrl"]||this.options[c+"Url"]}});function Cm(c){return new Yi(c)}var Qa=Yi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(c){return typeof Qa.imagePath!="string"&&(Qa.imagePath=this._detectIconPath()),(this.options.imagePath||Qa.imagePath)+Yi.prototype._getIconUrl.call(this,c)},_stripUrl:function(c){var p=function(T,V,W){var re=V.exec(T);return re&&re[W]};return c=p(c,/^url\((['"])?(.+)\1\)$/,2),c&&p(c,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var c=_t("div","leaflet-default-icon-path",document.body),p=uo(c,"background-image")||uo(c,"backgroundImage");if(document.body.removeChild(c),p=this._stripUrl(p),p)return p;var T=document.querySelector('link[href$="leaflet.css"]');return T?T.href.substring(0,T.href.length-11-1):""}}),sh=Pr.extend({initialize:function(c){this._marker=c},addHooks:function(){var c=this._marker._icon;this._draggable||(this._draggable=new Vr(c,c,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),yt(c,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&cn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(c){var p=this._marker,T=p._map,V=this._marker.options.autoPanSpeed,W=this._marker.options.autoPanPadding,re=Fr(p._icon),de=T.getPixelBounds(),_e=T.getPixelOrigin(),we=Z(de.min._subtract(_e).add(W),de.max._subtract(_e).subtract(W));if(!we.contains(re)){var Pe=Y((Math.max(we.max.x,re.x)-we.max.x)/(de.max.x-we.max.x)-(Math.min(we.min.x,re.x)-we.min.x)/(de.min.x-we.min.x),(Math.max(we.max.y,re.y)-we.max.y)/(de.max.y-we.max.y)-(Math.min(we.min.y,re.y)-we.min.y)/(de.min.y-we.min.y)).multiplyBy(V);T.panBy(Pe,{animate:!1}),this._draggable._newPos._add(Pe),this._draggable._startPos._add(Pe),xt(p._icon,this._draggable._newPos),this._onDrag(c),this._panRequest=O(this._adjustPan.bind(this,c))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(c){this._marker.options.autoPan&&(D(this._panRequest),this._panRequest=O(this._adjustPan.bind(this,c)))},_onDrag:function(c){var p=this._marker,T=p._shadow,V=Fr(p._icon),W=p._map.layerPointToLatLng(V);T&&xt(T,V),p._latlng=W,c.latlng=W,c.oldLatLng=this._oldLatLng,p.fire("move",c).fire("drag",c)},_onDragEnd:function(c){D(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",c)}}),Gs=nn.extend({options:{icon:new Qa,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(c,p){x(this,p),this._latlng=Q(c)},onAdd:function(c){this._zoomAnimated=this._zoomAnimated&&c.options.markerZoomAnimation,this._zoomAnimated&&c.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(c){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&c.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(c){var p=this._latlng;return this._latlng=Q(c),this.update(),this.fire("move",{oldLatLng:p,latlng:this._latlng})},setZIndexOffset:function(c){return this.options.zIndexOffset=c,this.update()},getIcon:function(){return this.options.icon},setIcon:function(c){return this.options.icon=c,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var c=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(c)}return this},_initIcon:function(){var c=this.options,p="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),T=c.icon.createIcon(this._icon),V=!1;T!==this._icon&&(this._icon&&this._removeIcon(),V=!0,c.title&&(T.title=c.title),T.tagName==="IMG"&&(T.alt=c.alt||"")),yt(T,p),c.keyboard&&(T.tabIndex="0",T.setAttribute("role","button")),this._icon=T,c.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&at(T,"focus",this._panOnFocus,this);var W=c.icon.createShadow(this._shadow),re=!1;W!==this._shadow&&(this._removeShadow(),re=!0),W&&(yt(W,p),W.alt=""),this._shadow=W,c.opacity<1&&this._updateOpacity(),V&&this.getPane().appendChild(this._icon),this._initInteraction(),W&&re&&this.getPane(c.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&tn(this._icon,"focus",this._panOnFocus,this),ln(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&ln(this._shadow),this._shadow=null},_setPos:function(c){this._icon&&xt(this._icon,c),this._shadow&&xt(this._shadow,c),this._zIndex=c.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(c){this._icon&&(this._icon.style.zIndex=this._zIndex+c)},_animateZoom:function(c){var p=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center).round();this._setPos(p)},_initInteraction:function(){if(this.options.interactive&&(yt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),sh)){var c=this.options.draggable;this.dragging&&(c=this.dragging.enabled(),this.dragging.disable()),this.dragging=new sh(this),c&&this.dragging.enable()}},setOpacity:function(c){return this.options.opacity=c,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var c=this.options.opacity;this._icon&&En(this._icon,c),this._shadow&&En(this._shadow,c)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var c=this._map;if(c){var p=this.options.icon.options,T=p.iconSize?Y(p.iconSize):Y(0,0),V=p.iconAnchor?Y(p.iconAnchor):Y(0,0);c.panInside(this._latlng,{paddingTopLeft:V,paddingBottomRight:T.subtract(V)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function y0(c,p){return new Gs(c,p)}var po=nn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(c){this._renderer=c.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(c){return x(this,c),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&c&&Object.prototype.hasOwnProperty.call(c,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Su=po.extend({options:{fill:!0,radius:10},initialize:function(c,p){x(this,p),this._latlng=Q(c),this._radius=this.options.radius},setLatLng:function(c){var p=this._latlng;return this._latlng=Q(c),this.redraw(),this.fire("move",{oldLatLng:p,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(c){return this.options.radius=this._radius=c,this.redraw()},getRadius:function(){return this._radius},setStyle:function(c){var p=c&&c.radius||this._radius;return po.prototype.setStyle.call(this,c),this.setRadius(p),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var c=this._radius,p=this._radiusY||c,T=this._clickTolerance(),V=[c+T,p+T];this._pxBounds=new q(this._point.subtract(V),this._point.add(V))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(c){return c.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Rm(c,p){return new Su(c,p)}var Au=Su.extend({initialize:function(c,p,T){if(typeof p=="number"&&(p=i({},T,{radius:p})),x(this,p),this._latlng=Q(c),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(c){return this._mRadius=c,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var c=[this._radius,this._radiusY||this._radius];return new ne(this._map.layerPointToLatLng(this._point.subtract(c)),this._map.layerPointToLatLng(this._point.add(c)))},setStyle:po.prototype.setStyle,_project:function(){var c=this._latlng.lng,p=this._latlng.lat,T=this._map,V=T.options.crs;if(V.distance===me.distance){var W=Math.PI/180,re=this._mRadius/me.R/W,de=T.project([p+re,c]),_e=T.project([p-re,c]),we=de.add(_e).divideBy(2),Pe=T.unproject(we).lat,He=Math.acos((Math.cos(re*W)-Math.sin(p*W)*Math.sin(Pe*W))/(Math.cos(p*W)*Math.cos(Pe*W)))/W;(isNaN(He)||He===0)&&(He=re/Math.cos(Math.PI/180*p)),this._point=we.subtract(T.getPixelOrigin()),this._radius=isNaN(He)?0:we.x-T.project([Pe,c-He]).x,this._radiusY=we.y-de.y}else{var ut=V.unproject(V.project(this._latlng).subtract([this._mRadius,0]));this._point=T.latLngToLayerPoint(this._latlng),this._radius=this._point.x-T.latLngToLayerPoint(ut).x}this._updateBounds()}});function pc(c,p,T){return new Au(c,p,T)}var si=po.extend({options:{smoothFactor:1,noClip:!1},initialize:function(c,p){x(this,p),this._setLatLngs(c)},getLatLngs:function(){return this._latlngs},setLatLngs:function(c){return this._setLatLngs(c),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(c){for(var p=1/0,T=null,V=zr,W,re,de=0,_e=this._parts.length;de<_e;de++)for(var we=this._parts[de],Pe=1,He=we.length;Pe<He;Pe++){W=we[Pe-1],re=we[Pe];var ut=V(c,W,re,!0);ut<p&&(p=ut,T=V(c,W,re))}return T&&(T.distance=Math.sqrt(p)),T},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return K(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(c,p){return p=p||this._defaultShape(),c=Q(c),p.push(c),this._bounds.extend(c),this.redraw()},_setLatLngs:function(c){this._bounds=new ne,this._latlngs=this._convertLatLngs(c)},_defaultShape:function(){return b(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(c){for(var p=[],T=b(c),V=0,W=c.length;V<W;V++)T?(p[V]=Q(c[V]),this._bounds.extend(p[V])):p[V]=this._convertLatLngs(c[V]);return p},_project:function(){var c=new q;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,c),this._bounds.isValid()&&c.isValid()&&(this._rawPxBounds=c,this._updateBounds())},_updateBounds:function(){var c=this._clickTolerance(),p=new ee(c,c);this._rawPxBounds&&(this._pxBounds=new q([this._rawPxBounds.min.subtract(p),this._rawPxBounds.max.add(p)]))},_projectLatlngs:function(c,p,T){var V=c[0]instanceof le,W=c.length,re,de;if(V){for(de=[],re=0;re<W;re++)de[re]=this._map.latLngToLayerPoint(c[re]),T.extend(de[re]);p.push(de)}else for(re=0;re<W;re++)this._projectLatlngs(c[re],p,T)},_clipPoints:function(){var c=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(c))){if(this.options.noClip){this._parts=this._rings;return}var p=this._parts,T,V,W,re,de,_e,we;for(T=0,W=0,re=this._rings.length;T<re;T++)for(we=this._rings[T],V=0,de=we.length;V<de-1;V++)_e=Xo(we[V],we[V+1],c,V,!0),_e&&(p[W]=p[W]||[],p[W].push(_e[0]),(_e[1]!==we[V+1]||V===de-2)&&(p[W].push(_e[1]),W++))}},_simplifyPoints:function(){for(var c=this._parts,p=this.options.smoothFactor,T=0,V=c.length;T<V;T++)c[T]=Qo(c[T],p)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(c,p){var T,V,W,re,de,_e,we=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(c))return!1;for(T=0,re=this._parts.length;T<re;T++)for(_e=this._parts[T],V=0,de=_e.length,W=de-1;V<de;W=V++)if(!(!p&&V===0)&&mc(c,_e[W],_e[V])<=we)return!0;return!1}});function v0(c,p){return new si(c,p)}si._flat=U;var Ks=si.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Wa(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(c){var p=si.prototype._convertLatLngs.call(this,c),T=p.length;return T>=2&&p[0]instanceof le&&p[0].equals(p[T-1])&&p.pop(),p},_setLatLngs:function(c){si.prototype._setLatLngs.call(this,c),b(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return b(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var c=this._renderer._bounds,p=this.options.weight,T=new ee(p,p);if(c=new q(c.min.subtract(T),c.max.add(T)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(c))){if(this.options.noClip){this._parts=this._rings;return}for(var V=0,W=this._rings.length,re;V<W;V++)re=Zo(this._rings[V],c,!0),re.length&&this._parts.push(re)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(c){var p=!1,T,V,W,re,de,_e,we,Pe;if(!this._pxBounds||!this._pxBounds.contains(c))return!1;for(re=0,we=this._parts.length;re<we;re++)for(T=this._parts[re],de=0,Pe=T.length,_e=Pe-1;de<Pe;_e=de++)V=T[de],W=T[_e],V.y>c.y!=W.y>c.y&&c.x<(W.x-V.x)*(c.y-V.y)/(W.y-V.y)+V.x&&(p=!p);return p||si.prototype._containsPoint.call(this,c,!0)}});function _0(c,p){return new Ks(c,p)}var fs=Mn.extend({initialize:function(c,p){x(this,p),this._layers={},c&&this.addData(c)},addData:function(c){var p=C(c)?c:c.features,T,V,W;if(p){for(T=0,V=p.length;T<V;T++)W=p[T],(W.geometries||W.geometry||W.features||W.coordinates)&&this.addData(W);return this}var re=this.options;if(re.filter&&!re.filter(c))return this;var de=Xa(c,re);return de?(de.feature=Cu(c),de.defaultOptions=de.options,this.resetStyle(de),re.onEachFeature&&re.onEachFeature(c,de),this.addLayer(de)):this},resetStyle:function(c){return c===void 0?this.eachLayer(this.resetStyle,this):(c.options=i({},c.defaultOptions),this._setLayerStyle(c,this.options.style),this)},setStyle:function(c){return this.eachLayer(function(p){this._setLayerStyle(p,c)},this)},_setLayerStyle:function(c,p){c.setStyle&&(typeof p=="function"&&(p=p(c.feature)),c.setStyle(p))}});function Xa(c,p){var T=c.type==="Feature"?c.geometry:c,V=T?T.coordinates:null,W=[],re=p&&p.pointToLayer,de=p&&p.coordsToLatLng||Nu,_e,we,Pe,He;if(!V&&!T)return null;switch(T.type){case"Point":return _e=de(V),Iu(re,c,_e,p);case"MultiPoint":for(Pe=0,He=V.length;Pe<He;Pe++)_e=de(V[Pe]),W.push(Iu(re,c,_e,p));return new Mn(W);case"LineString":case"MultiLineString":return we=gc(V,T.type==="LineString"?0:1,de),new si(we,p);case"Polygon":case"MultiPolygon":return we=gc(V,T.type==="Polygon"?1:2,de),new Ks(we,p);case"GeometryCollection":for(Pe=0,He=T.geometries.length;Pe<He;Pe++){var ut=Xa({geometry:T.geometries[Pe],type:"Feature",properties:c.properties},p);ut&&W.push(ut)}return new Mn(W);case"FeatureCollection":for(Pe=0,He=T.features.length;Pe<He;Pe++){var Pt=Xa(T.features[Pe],p);Pt&&W.push(Pt)}return new Mn(W);default:throw new Error("Invalid GeoJSON object.")}}function Iu(c,p,T,V){return c?c(p,T):new Gs(T,V&&V.markersInheritOptions&&V)}function Nu(c){return new le(c[1],c[0],c[2])}function gc(c,p,T){for(var V=[],W=0,re=c.length,de;W<re;W++)de=p?gc(c[W],p-1,T):(T||Nu)(c[W]),V.push(de);return V}function ku(c,p){return c=Q(c),c.alt!==void 0?[g(c.lng,p),g(c.lat,p),g(c.alt,p)]:[g(c.lng,p),g(c.lat,p)]}function Pu(c,p,T,V){for(var W=[],re=0,de=c.length;re<de;re++)W.push(p?Pu(c[re],b(c[re])?0:p-1,T,V):ku(c[re],V));return!p&&T&&W.length>0&&W.push(W[0].slice()),W}function Ja(c,p){return c.feature?i({},c.feature,{geometry:p}):Cu(p)}function Cu(c){return c.type==="Feature"||c.type==="FeatureCollection"?c:{type:"Feature",properties:{},geometry:c}}var oh={toGeoJSON:function(c){return Ja(this,{type:"Point",coordinates:ku(this.getLatLng(),c)})}};Gs.include(oh),Au.include(oh),Su.include(oh),si.include({toGeoJSON:function(c){var p=!b(this._latlngs),T=Pu(this._latlngs,p?1:0,!1,c);return Ja(this,{type:(p?"Multi":"")+"LineString",coordinates:T})}}),Ks.include({toGeoJSON:function(c){var p=!b(this._latlngs),T=p&&!b(this._latlngs[0]),V=Pu(this._latlngs,T?2:p?1:0,!0,c);return p||(V=[V]),Ja(this,{type:(T?"Multi":"")+"Polygon",coordinates:V})}}),wn.include({toMultiPoint:function(c){var p=[];return this.eachLayer(function(T){p.push(T.toGeoJSON(c).geometry.coordinates)}),Ja(this,{type:"MultiPoint",coordinates:p})},toGeoJSON:function(c){var p=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(p==="MultiPoint")return this.toMultiPoint(c);var T=p==="GeometryCollection",V=[];return this.eachLayer(function(W){if(W.toGeoJSON){var re=W.toGeoJSON(c);if(T)V.push(re.geometry);else{var de=Cu(re);de.type==="FeatureCollection"?V.push.apply(V,de.features):V.push(de)}}}),T?Ja(this,{geometries:V,type:"GeometryCollection"}):{type:"FeatureCollection",features:V}}});function Om(c,p){return new fs(c,p)}var Zi=Om,go=nn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(c,p,T){this._url=c,this._bounds=se(p),x(this,T)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(yt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){ln(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(c){return this.options.opacity=c,this._image&&this._updateOpacity(),this},setStyle:function(c){return c.opacity&&this.setOpacity(c.opacity),this},bringToFront:function(){return this._map&&Bs(this._image),this},bringToBack:function(){return this._map&&Wi(this._image),this},setUrl:function(c){return this._url=c,this._image&&(this._image.src=c),this},setBounds:function(c){return this._bounds=se(c),this._map&&this._reset(),this},getEvents:function(){var c={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},setZIndex:function(c){return this.options.zIndex=c,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var c=this._url.tagName==="IMG",p=this._image=c?this._url:_t("img");if(yt(p,"leaflet-image-layer"),this._zoomAnimated&&yt(p,"leaflet-zoom-animated"),this.options.className&&yt(p,this.options.className),p.onselectstart=y,p.onmousemove=y,p.onload=o(this.fire,this,"load"),p.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),c){this._url=p.src;return}p.src=this._url,p.alt=this.options.alt},_animateZoom:function(c){var p=this._map.getZoomScale(c.zoom),T=this._map._latLngBoundsToNewLayerBounds(this._bounds,c.zoom,c.center).min;Lr(this._image,T,p)},_reset:function(){var c=this._image,p=new q(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),T=p.getSize();xt(c,p.min),c.style.width=T.x+"px",c.style.height=T.y+"px"},_updateOpacity:function(){En(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var c=this.options.errorOverlayUrl;c&&this._url!==c&&(this._url=c,this._image.src=c)},getCenter:function(){return this._bounds.getCenter()}}),jm=function(c,p,T){return new go(c,p,T)},ah=go.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var c=this._url.tagName==="VIDEO",p=this._image=c?this._url:_t("video");if(yt(p,"leaflet-image-layer"),this._zoomAnimated&&yt(p,"leaflet-zoom-animated"),this.options.className&&yt(p,this.options.className),p.onselectstart=y,p.onmousemove=y,p.onloadeddata=o(this.fire,this,"load"),c){for(var T=p.getElementsByTagName("source"),V=[],W=0;W<T.length;W++)V.push(T[W].src);this._url=T.length>0?V:[p.src];return}C(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(p.style,"objectFit")&&(p.style.objectFit="fill"),p.autoplay=!!this.options.autoplay,p.loop=!!this.options.loop,p.muted=!!this.options.muted,p.playsInline=!!this.options.playsInline;for(var re=0;re<this._url.length;re++){var de=_t("source");de.src=this._url[re],p.appendChild(de)}}});function Mm(c,p,T){return new ah(c,p,T)}var lh=go.extend({_initImage:function(){var c=this._image=this._url;yt(c,"leaflet-image-layer"),this._zoomAnimated&&yt(c,"leaflet-zoom-animated"),this.options.className&&yt(c,this.options.className),c.onselectstart=y,c.onmousemove=y}});function ch(c,p,T){return new lh(c,p,T)}var ms=nn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(c,p){c&&(c instanceof le||C(c))?(this._latlng=Q(c),x(this,p)):(x(this,c),this._source=p),this.options.content&&(this._content=this.options.content)},openOn:function(c){return c=arguments.length?c:this._source._map,c.hasLayer(this)||c.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(c){return this._map?this.close():(arguments.length?this._source=c:c=this._source,this._prepareOpen(),this.openOn(c._map)),this},onAdd:function(c){this._zoomAnimated=c._zoomAnimated,this._container||this._initLayout(),c._fadeAnimated&&En(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),c._fadeAnimated&&En(this._container,1),this.bringToFront(),this.options.interactive&&(yt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(c){c._fadeAnimated?(En(this._container,0),this._removeTimeout=setTimeout(o(ln,void 0,this._container),200)):ln(this._container),this.options.interactive&&(cn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(c){return this._latlng=Q(c),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(c){return this._content=c,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var c={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Bs(this._container),this},bringToBack:function(){return this._map&&Wi(this._container),this},_prepareOpen:function(c){var p=this._source;if(!p._map)return!1;if(p instanceof Mn){p=null;var T=this._source._layers;for(var V in T)if(T[V]._map){p=T[V];break}if(!p)return!1;this._source=p}if(!c)if(p.getCenter)c=p.getCenter();else if(p.getLatLng)c=p.getLatLng();else if(p.getBounds)c=p.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(c),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var c=this._contentNode,p=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof p=="string")c.innerHTML=p;else{for(;c.hasChildNodes();)c.removeChild(c.firstChild);c.appendChild(p)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var c=this._map.latLngToLayerPoint(this._latlng),p=Y(this.options.offset),T=this._getAnchor();this._zoomAnimated?xt(this._container,c.add(T)):p=p.add(c).add(T);var V=this._containerBottom=-p.y,W=this._containerLeft=-Math.round(this._containerWidth/2)+p.x;this._container.style.bottom=V+"px",this._container.style.left=W+"px"}},_getAnchor:function(){return[0,0]}});Rt.include({_initOverlay:function(c,p,T,V){var W=p;return W instanceof c||(W=new c(V).setContent(p)),T&&W.setLatLng(T),W}}),nn.include({_initOverlay:function(c,p,T,V){var W=T;return W instanceof c?(x(W,V),W._source=this):(W=p&&!V?p:new c(V,this),W.setContent(T)),W}});var Ru=ms.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(c){return c=arguments.length?c:this._source._map,!c.hasLayer(this)&&c._popup&&c._popup.options.autoClose&&c.removeLayer(c._popup),c._popup=this,ms.prototype.openOn.call(this,c)},onAdd:function(c){ms.prototype.onAdd.call(this,c),c.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof po||this._source.on("preclick",kr))},onRemove:function(c){ms.prototype.onRemove.call(this,c),c.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof po||this._source.off("preclick",kr))},getEvents:function(){var c=ms.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(c.preclick=this.close),this.options.keepInView&&(c.moveend=this._adjustPan),c},_initLayout:function(){var c="leaflet-popup",p=this._container=_t("div",c+" "+(this.options.className||"")+" leaflet-zoom-animated"),T=this._wrapper=_t("div",c+"-content-wrapper",p);if(this._contentNode=_t("div",c+"-content",T),mo(p),Us(this._contentNode),at(p,"contextmenu",kr),this._tipContainer=_t("div",c+"-tip-container",p),this._tip=_t("div",c+"-tip",this._tipContainer),this.options.closeButton){var V=this._closeButton=_t("a",c+"-close-button",p);V.setAttribute("role","button"),V.setAttribute("aria-label","Close popup"),V.href="#close",V.innerHTML='<span aria-hidden="true">&#215;</span>',at(V,"click",function(W){un(W),this.close()},this)}},_updateLayout:function(){var c=this._contentNode,p=c.style;p.width="",p.whiteSpace="nowrap";var T=c.offsetWidth;T=Math.min(T,this.options.maxWidth),T=Math.max(T,this.options.minWidth),p.width=T+1+"px",p.whiteSpace="",p.height="";var V=c.offsetHeight,W=this.options.maxHeight,re="leaflet-popup-scrolled";W&&V>W?(p.height=W+"px",yt(c,re)):cn(c,re),this._containerWidth=this._container.offsetWidth},_animateZoom:function(c){var p=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center),T=this._getAnchor();xt(this._container,p.add(T))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var c=this._map,p=parseInt(uo(this._container,"marginBottom"),10)||0,T=this._container.offsetHeight+p,V=this._containerWidth,W=new ee(this._containerLeft,-T-this._containerBottom);W._add(Fr(this._container));var re=c.layerPointToContainerPoint(W),de=Y(this.options.autoPanPadding),_e=Y(this.options.autoPanPaddingTopLeft||de),we=Y(this.options.autoPanPaddingBottomRight||de),Pe=c.getSize(),He=0,ut=0;re.x+V+we.x>Pe.x&&(He=re.x+V-Pe.x+we.x),re.x-He-_e.x<0&&(He=re.x-_e.x),re.y+T+we.y>Pe.y&&(ut=re.y+T-Pe.y+we.y),re.y-ut-_e.y<0&&(ut=re.y-_e.y),(He||ut)&&(this.options.keepInView&&(this._autopanning=!0),c.fire("autopanstart").panBy([He,ut]))}},_getAnchor:function(){return Y(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),el=function(c,p){return new Ru(c,p)};Rt.mergeOptions({closePopupOnClick:!0}),Rt.include({openPopup:function(c,p,T){return this._initOverlay(Ru,c,p,T).openOn(this),this},closePopup:function(c){return c=arguments.length?c:this._popup,c&&c.close(),this}}),nn.include({bindPopup:function(c,p){return this._popup=this._initOverlay(Ru,this._popup,c,p),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(c){return this._popup&&(this instanceof Mn||(this._popup._source=this),this._popup._prepareOpen(c||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(c){return this._popup&&this._popup.setContent(c),this},getPopup:function(){return this._popup},_openPopup:function(c){if(!(!this._popup||!this._map)){ar(c);var p=c.layer||c.target;if(this._popup._source===p&&!(p instanceof po)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(c.latlng);return}this._popup._source=p,this.openPopup(c.latlng)}},_movePopup:function(c){this._popup.setLatLng(c.latlng)},_onKeyPress:function(c){c.originalEvent.keyCode===13&&this._openPopup(c)}});var tl=ms.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(c){ms.prototype.onAdd.call(this,c),this.setOpacity(this.options.opacity),c.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(c){ms.prototype.onRemove.call(this,c),c.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var c=ms.prototype.getEvents.call(this);return this.options.permanent||(c.preclick=this.close),c},_initLayout:function(){var c="leaflet-tooltip",p=c+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=_t("div",p),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+u(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(c){var p,T,V=this._map,W=this._container,re=V.latLngToContainerPoint(V.getCenter()),de=V.layerPointToContainerPoint(c),_e=this.options.direction,we=W.offsetWidth,Pe=W.offsetHeight,He=Y(this.options.offset),ut=this._getAnchor();_e==="top"?(p=we/2,T=Pe):_e==="bottom"?(p=we/2,T=0):_e==="center"?(p=we/2,T=Pe/2):_e==="right"?(p=0,T=Pe/2):_e==="left"?(p=we,T=Pe/2):de.x<re.x?(_e="right",p=0,T=Pe/2):(_e="left",p=we+(He.x+ut.x)*2,T=Pe/2),c=c.subtract(Y(p,T,!0)).add(He).add(ut),cn(W,"leaflet-tooltip-right"),cn(W,"leaflet-tooltip-left"),cn(W,"leaflet-tooltip-top"),cn(W,"leaflet-tooltip-bottom"),yt(W,"leaflet-tooltip-"+_e),xt(W,c)},_updatePosition:function(){var c=this._map.latLngToLayerPoint(this._latlng);this._setPosition(c)},setOpacity:function(c){this.options.opacity=c,this._container&&En(this._container,c)},_animateZoom:function(c){var p=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center);this._setPosition(p)},_getAnchor:function(){return Y(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),yc=function(c,p){return new tl(c,p)};Rt.include({openTooltip:function(c,p,T){return this._initOverlay(tl,c,p,T).openOn(this),this},closeTooltip:function(c){return c.close(),this}}),nn.include({bindTooltip:function(c,p){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(tl,this._tooltip,c,p),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(c){if(!(!c&&this._tooltipHandlersAdded)){var p=c?"off":"on",T={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?T.add=this._openTooltip:(T.mouseover=this._openTooltip,T.mouseout=this.closeTooltip,T.click=this._openTooltip,this._map?this._addFocusListeners():T.add=this._addFocusListeners),this._tooltip.options.sticky&&(T.mousemove=this._moveTooltip),this[p](T),this._tooltipHandlersAdded=!c}},openTooltip:function(c){return this._tooltip&&(this instanceof Mn||(this._tooltip._source=this),this._tooltip._prepareOpen(c)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(c){return this._tooltip&&this._tooltip.setContent(c),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(c){var p=typeof c.getElement=="function"&&c.getElement();p&&(at(p,"focus",function(){this._tooltip._source=c,this.openTooltip()},this),at(p,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(c){var p=typeof c.getElement=="function"&&c.getElement();p&&p.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(c){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var p=this;this._map.once("moveend",function(){p._openOnceFlag=!1,p._openTooltip(c)});return}this._tooltip._source=c.layer||c.target,this.openTooltip(this._tooltip.options.sticky?c.latlng:void 0)}},_moveTooltip:function(c){var p=c.latlng,T,V;this._tooltip.options.sticky&&c.originalEvent&&(T=this._map.mouseEventToContainerPoint(c.originalEvent),V=this._map.containerPointToLayerPoint(T),p=this._map.layerPointToLatLng(V)),this._tooltip.setLatLng(p)}});var Ou=Yi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(c){var p=c&&c.tagName==="DIV"?c:document.createElement("div"),T=this.options;if(T.html instanceof Element?(qo(p),p.appendChild(T.html)):p.innerHTML=T.html!==!1?T.html:"",T.bgPos){var V=Y(T.bgPos);p.style.backgroundPosition=-V.x+"px "+-V.y+"px"}return this._setIconStyles(p,"icon"),p},createShadow:function(){return null}});function Dm(c){return new Ou(c)}Yi.Default=Qa;var yo=nn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:$e.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(c){x(this,c)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(c){c._addZoomLimit(this)},onRemove:function(c){this._removeAllTiles(),ln(this._container),c._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Bs(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Wi(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(c){return this.options.opacity=c,this._updateOpacity(),this},setZIndex:function(c){return this.options.zIndex=c,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var c=this._clampZoom(this._map.getZoom());c!==this._tileZoom&&(this._tileZoom=c,this._updateLevels()),this._update()}return this},getEvents:function(){var c={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),c.move=this._onMove),this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},createTile:function(){return document.createElement("div")},getTileSize:function(){var c=this.options.tileSize;return c instanceof ee?c:new ee(c,c)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(c){for(var p=this.getPane().children,T=-c(-1/0,1/0),V=0,W=p.length,re;V<W;V++)re=p[V].style.zIndex,p[V]!==this._container&&re&&(T=c(T,+re));isFinite(T)&&(this.options.zIndex=T+c(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!$e.ielt9){En(this._container,this.options.opacity);var c=+new Date,p=!1,T=!1;for(var V in this._tiles){var W=this._tiles[V];if(!(!W.current||!W.loaded)){var re=Math.min(1,(c-W.loaded)/200);En(W.el,re),re<1?p=!0:(W.active?T=!0:this._onOpaqueTile(W),W.active=!0)}}T&&!this._noPrune&&this._pruneTiles(),p&&(D(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this))}},_onOpaqueTile:y,_initContainer:function(){this._container||(this._container=_t("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var c=this._tileZoom,p=this.options.maxZoom;if(c!==void 0){for(var T in this._levels)T=Number(T),this._levels[T].el.children.length||T===c?(this._levels[T].el.style.zIndex=p-Math.abs(c-T),this._onUpdateLevel(T)):(ln(this._levels[T].el),this._removeTilesAtZoom(T),this._onRemoveLevel(T),delete this._levels[T]);var V=this._levels[c],W=this._map;return V||(V=this._levels[c]={},V.el=_t("div","leaflet-tile-container leaflet-zoom-animated",this._container),V.el.style.zIndex=p,V.origin=W.project(W.unproject(W.getPixelOrigin()),c).round(),V.zoom=c,this._setZoomTransform(V,W.getCenter(),W.getZoom()),y(V.el.offsetWidth),this._onCreateLevel(V)),this._level=V,V}},_onUpdateLevel:y,_onRemoveLevel:y,_onCreateLevel:y,_pruneTiles:function(){if(this._map){var c,p,T=this._map.getZoom();if(T>this.options.maxZoom||T<this.options.minZoom){this._removeAllTiles();return}for(c in this._tiles)p=this._tiles[c],p.retain=p.current;for(c in this._tiles)if(p=this._tiles[c],p.current&&!p.active){var V=p.coords;this._retainParent(V.x,V.y,V.z,V.z-5)||this._retainChildren(V.x,V.y,V.z,V.z+2)}for(c in this._tiles)this._tiles[c].retain||this._removeTile(c)}},_removeTilesAtZoom:function(c){for(var p in this._tiles)this._tiles[p].coords.z===c&&this._removeTile(p)},_removeAllTiles:function(){for(var c in this._tiles)this._removeTile(c)},_invalidateAll:function(){for(var c in this._levels)ln(this._levels[c].el),this._onRemoveLevel(Number(c)),delete this._levels[c];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(c,p,T,V){var W=Math.floor(c/2),re=Math.floor(p/2),de=T-1,_e=new ee(+W,+re);_e.z=+de;var we=this._tileCoordsToKey(_e),Pe=this._tiles[we];return Pe&&Pe.active?(Pe.retain=!0,!0):(Pe&&Pe.loaded&&(Pe.retain=!0),de>V?this._retainParent(W,re,de,V):!1)},_retainChildren:function(c,p,T,V){for(var W=2*c;W<2*c+2;W++)for(var re=2*p;re<2*p+2;re++){var de=new ee(W,re);de.z=T+1;var _e=this._tileCoordsToKey(de),we=this._tiles[_e];if(we&&we.active){we.retain=!0;continue}else we&&we.loaded&&(we.retain=!0);T+1<V&&this._retainChildren(W,re,T+1,V)}},_resetView:function(c){var p=c&&(c.pinch||c.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),p,p)},_animateZoom:function(c){this._setView(c.center,c.zoom,!0,c.noUpdate)},_clampZoom:function(c){var p=this.options;return p.minNativeZoom!==void 0&&c<p.minNativeZoom?p.minNativeZoom:p.maxNativeZoom!==void 0&&p.maxNativeZoom<c?p.maxNativeZoom:c},_setView:function(c,p,T,V){var W=Math.round(p);this.options.maxZoom!==void 0&&W>this.options.maxZoom||this.options.minZoom!==void 0&&W<this.options.minZoom?W=void 0:W=this._clampZoom(W);var re=this.options.updateWhenZooming&&W!==this._tileZoom;(!V||re)&&(this._tileZoom=W,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),W!==void 0&&this._update(c),T||this._pruneTiles(),this._noPrune=!!T),this._setZoomTransforms(c,p)},_setZoomTransforms:function(c,p){for(var T in this._levels)this._setZoomTransform(this._levels[T],c,p)},_setZoomTransform:function(c,p,T){var V=this._map.getZoomScale(T,c.zoom),W=c.origin.multiplyBy(V).subtract(this._map._getNewPixelOrigin(p,T)).round();$e.any3d?Lr(c.el,W,V):xt(c.el,W)},_resetGrid:function(){var c=this._map,p=c.options.crs,T=this._tileSize=this.getTileSize(),V=this._tileZoom,W=this._map.getPixelWorldBounds(this._tileZoom);W&&(this._globalTileRange=this._pxBoundsToTileRange(W)),this._wrapX=p.wrapLng&&!this.options.noWrap&&[Math.floor(c.project([0,p.wrapLng[0]],V).x/T.x),Math.ceil(c.project([0,p.wrapLng[1]],V).x/T.y)],this._wrapY=p.wrapLat&&!this.options.noWrap&&[Math.floor(c.project([p.wrapLat[0],0],V).y/T.x),Math.ceil(c.project([p.wrapLat[1],0],V).y/T.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(c){var p=this._map,T=p._animatingZoom?Math.max(p._animateToZoom,p.getZoom()):p.getZoom(),V=p.getZoomScale(T,this._tileZoom),W=p.project(c,this._tileZoom).floor(),re=p.getSize().divideBy(V*2);return new q(W.subtract(re),W.add(re))},_update:function(c){var p=this._map;if(p){var T=this._clampZoom(p.getZoom());if(c===void 0&&(c=p.getCenter()),this._tileZoom!==void 0){var V=this._getTiledPixelBounds(c),W=this._pxBoundsToTileRange(V),re=W.getCenter(),de=[],_e=this.options.keepBuffer,we=new q(W.getBottomLeft().subtract([_e,-_e]),W.getTopRight().add([_e,-_e]));if(!(isFinite(W.min.x)&&isFinite(W.min.y)&&isFinite(W.max.x)&&isFinite(W.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Pe in this._tiles){var He=this._tiles[Pe].coords;(He.z!==this._tileZoom||!we.contains(new ee(He.x,He.y)))&&(this._tiles[Pe].current=!1)}if(Math.abs(T-this._tileZoom)>1){this._setView(c,T);return}for(var ut=W.min.y;ut<=W.max.y;ut++)for(var Pt=W.min.x;Pt<=W.max.x;Pt++){var lr=new ee(Pt,ut);if(lr.z=this._tileZoom,!!this._isValidTile(lr)){var nr=this._tiles[this._tileCoordsToKey(lr)];nr?nr.current=!0:de.push(lr)}}if(de.sort(function(Br,ol){return Br.distanceTo(re)-ol.distanceTo(re)}),de.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var oi=document.createDocumentFragment();for(Pt=0;Pt<de.length;Pt++)this._addTile(de[Pt],oi);this._level.el.appendChild(oi)}}}},_isValidTile:function(c){var p=this._map.options.crs;if(!p.infinite){var T=this._globalTileRange;if(!p.wrapLng&&(c.x<T.min.x||c.x>T.max.x)||!p.wrapLat&&(c.y<T.min.y||c.y>T.max.y))return!1}if(!this.options.bounds)return!0;var V=this._tileCoordsToBounds(c);return se(this.options.bounds).overlaps(V)},_keyToBounds:function(c){return this._tileCoordsToBounds(this._keyToTileCoords(c))},_tileCoordsToNwSe:function(c){var p=this._map,T=this.getTileSize(),V=c.scaleBy(T),W=V.add(T),re=p.unproject(V,c.z),de=p.unproject(W,c.z);return[re,de]},_tileCoordsToBounds:function(c){var p=this._tileCoordsToNwSe(c),T=new ne(p[0],p[1]);return this.options.noWrap||(T=this._map.wrapLatLngBounds(T)),T},_tileCoordsToKey:function(c){return c.x+":"+c.y+":"+c.z},_keyToTileCoords:function(c){var p=c.split(":"),T=new ee(+p[0],+p[1]);return T.z=+p[2],T},_removeTile:function(c){var p=this._tiles[c];p&&(ln(p.el),delete this._tiles[c],this.fire("tileunload",{tile:p.el,coords:this._keyToTileCoords(c)}))},_initTile:function(c){yt(c,"leaflet-tile");var p=this.getTileSize();c.style.width=p.x+"px",c.style.height=p.y+"px",c.onselectstart=y,c.onmousemove=y,$e.ielt9&&this.options.opacity<1&&En(c,this.options.opacity)},_addTile:function(c,p){var T=this._getTilePos(c),V=this._tileCoordsToKey(c),W=this.createTile(this._wrapCoords(c),o(this._tileReady,this,c));this._initTile(W),this.createTile.length<2&&O(o(this._tileReady,this,c,null,W)),xt(W,T),this._tiles[V]={el:W,coords:c,current:!0},p.appendChild(W),this.fire("tileloadstart",{tile:W,coords:c})},_tileReady:function(c,p,T){p&&this.fire("tileerror",{error:p,tile:T,coords:c});var V=this._tileCoordsToKey(c);T=this._tiles[V],T&&(T.loaded=+new Date,this._map._fadeAnimated?(En(T.el,0),D(this._fadeFrame),this._fadeFrame=O(this._updateOpacity,this)):(T.active=!0,this._pruneTiles()),p||(yt(T.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:T.el,coords:c})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),$e.ielt9||!this._map._fadeAnimated?O(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(c){return c.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(c){var p=new ee(this._wrapX?m(c.x,this._wrapX):c.x,this._wrapY?m(c.y,this._wrapY):c.y);return p.z=c.z,p},_pxBoundsToTileRange:function(c){var p=this.getTileSize();return new q(c.min.unscaleBy(p).floor(),c.max.unscaleBy(p).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var c in this._tiles)if(!this._tiles[c].loaded)return!1;return!0}});function nl(c){return new yo(c)}var vo=yo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(c,p){this._url=c,p=x(this,p),p.detectRetina&&$e.retina&&p.maxZoom>0?(p.tileSize=Math.floor(p.tileSize/2),p.zoomReverse?(p.zoomOffset--,p.minZoom=Math.min(p.maxZoom,p.minZoom+1)):(p.zoomOffset++,p.maxZoom=Math.max(p.minZoom,p.maxZoom-1)),p.minZoom=Math.max(0,p.minZoom)):p.zoomReverse?p.minZoom=Math.min(p.maxZoom,p.minZoom):p.maxZoom=Math.max(p.minZoom,p.maxZoom),typeof p.subdomains=="string"&&(p.subdomains=p.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(c,p){return this._url===c&&p===void 0&&(p=!0),this._url=c,p||this.redraw(),this},createTile:function(c,p){var T=document.createElement("img");return at(T,"load",o(this._tileOnLoad,this,p,T)),at(T,"error",o(this._tileOnError,this,p,T)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(T.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(T.referrerPolicy=this.options.referrerPolicy),T.alt="",T.src=this.getTileUrl(c),T},getTileUrl:function(c){var p={r:$e.retina?"@2x":"",s:this._getSubdomain(c),x:c.x,y:c.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var T=this._globalTileRange.max.y-c.y;this.options.tms&&(p.y=T),p["-y"]=T}return I(this._url,i(p,this.options))},_tileOnLoad:function(c,p){$e.ielt9?setTimeout(o(c,this,null,p),0):c(null,p)},_tileOnError:function(c,p,T){var V=this.options.errorTileUrl;V&&p.getAttribute("src")!==V&&(p.src=V),c(T,p)},_onTileRemove:function(c){c.tile.onload=null},_getZoomForUrl:function(){var c=this._tileZoom,p=this.options.maxZoom,T=this.options.zoomReverse,V=this.options.zoomOffset;return T&&(c=p-c),c+V},_getSubdomain:function(c){var p=Math.abs(c.x+c.y)%this.options.subdomains.length;return this.options.subdomains[p]},_abortLoading:function(){var c,p;for(c in this._tiles)if(this._tiles[c].coords.z!==this._tileZoom&&(p=this._tiles[c].el,p.onload=y,p.onerror=y,!p.complete)){p.src=R;var T=this._tiles[c].coords;ln(p),delete this._tiles[c],this.fire("tileabort",{tile:p,coords:T})}},_removeTile:function(c){var p=this._tiles[c];if(p)return p.el.setAttribute("src",R),yo.prototype._removeTile.call(this,c)},_tileReady:function(c,p,T){if(!(!this._map||T&&T.getAttribute("src")===R))return yo.prototype._tileReady.call(this,c,p,T)}});function uh(c,p){return new vo(c,p)}var vc=vo.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(c,p){this._url=c;var T=i({},this.defaultWmsParams);for(var V in p)V in this.options||(T[V]=p[V]);p=x(this,p);var W=p.detectRetina&&$e.retina?2:1,re=this.getTileSize();T.width=re.x*W,T.height=re.y*W,this.wmsParams=T},onAdd:function(c){this._crs=this.options.crs||c.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var p=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[p]=this._crs.code,vo.prototype.onAdd.call(this,c)},getTileUrl:function(c){var p=this._tileCoordsToNwSe(c),T=this._crs,V=Z(T.project(p[0]),T.project(p[1])),W=V.min,re=V.max,de=(this._wmsVersion>=1.3&&this._crs===zn?[W.y,W.x,re.y,re.x]:[W.x,W.y,re.x,re.y]).join(","),_e=vo.prototype.getTileUrl.call(this,c);return _e+w(this.wmsParams,_e,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+de},setParams:function(c,p){return i(this.wmsParams,c),p||this.redraw(),this}});function Lm(c,p){return new vc(c,p)}vo.WMS=vc,uh.wms=Lm;var ps=nn.extend({options:{padding:.1},initialize:function(c){x(this,c),u(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),yt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var c={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(c.zoomanim=this._onAnimZoom),c},_onAnimZoom:function(c){this._updateTransform(c.center,c.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(c,p){var T=this._map.getZoomScale(p,this._zoom),V=this._map.getSize().multiplyBy(.5+this.options.padding),W=this._map.project(this._center,p),re=V.multiplyBy(-T).add(W).subtract(this._map._getNewPixelOrigin(c,p));$e.any3d?Lr(this._container,re,T):xt(this._container,re)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var c in this._layers)this._layers[c]._reset()},_onZoomEnd:function(){for(var c in this._layers)this._layers[c]._project()},_updatePaths:function(){for(var c in this._layers)this._layers[c]._update()},_update:function(){var c=this.options.padding,p=this._map.getSize(),T=this._map.containerPointToLayerPoint(p.multiplyBy(-c)).round();this._bounds=new q(T,T.add(p.multiplyBy(1+c*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),dh=ps.extend({options:{tolerance:0},getEvents:function(){var c=ps.prototype.getEvents.call(this);return c.viewprereset=this._onViewPreReset,c},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ps.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var c=this._container=document.createElement("canvas");at(c,"mousemove",this._onMouseMove,this),at(c,"click dblclick mousedown mouseup contextmenu",this._onClick,this),at(c,"mouseout",this._handleMouseOut,this),c._leaflet_disable_events=!0,this._ctx=c.getContext("2d")},_destroyContainer:function(){D(this._redrawRequest),delete this._ctx,ln(this._container),tn(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var c;this._redrawBounds=null;for(var p in this._layers)c=this._layers[p],c._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ps.prototype._update.call(this);var c=this._bounds,p=this._container,T=c.getSize(),V=$e.retina?2:1;xt(p,c.min),p.width=V*T.x,p.height=V*T.y,p.style.width=T.x+"px",p.style.height=T.y+"px",$e.retina&&this._ctx.scale(2,2),this._ctx.translate(-c.min.x,-c.min.y),this.fire("update")}},_reset:function(){ps.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(c){this._updateDashArray(c),this._layers[u(c)]=c;var p=c._order={layer:c,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=p),this._drawLast=p,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(c){this._requestRedraw(c)},_removePath:function(c){var p=c._order,T=p.next,V=p.prev;T?T.prev=V:this._drawLast=V,V?V.next=T:this._drawFirst=T,delete c._order,delete this._layers[u(c)],this._requestRedraw(c)},_updatePath:function(c){this._extendRedrawBounds(c),c._project(),c._update(),this._requestRedraw(c)},_updateStyle:function(c){this._updateDashArray(c),this._requestRedraw(c)},_updateDashArray:function(c){if(typeof c.options.dashArray=="string"){var p=c.options.dashArray.split(/[, ]+/),T=[],V,W;for(W=0;W<p.length;W++){if(V=Number(p[W]),isNaN(V))return;T.push(V)}c.options._dashArray=T}else c.options._dashArray=c.options.dashArray},_requestRedraw:function(c){this._map&&(this._extendRedrawBounds(c),this._redrawRequest=this._redrawRequest||O(this._redraw,this))},_extendRedrawBounds:function(c){if(c._pxBounds){var p=(c.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new q,this._redrawBounds.extend(c._pxBounds.min.subtract([p,p])),this._redrawBounds.extend(c._pxBounds.max.add([p,p]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var c=this._redrawBounds;if(c){var p=c.getSize();this._ctx.clearRect(c.min.x,c.min.y,p.x,p.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var c,p=this._redrawBounds;if(this._ctx.save(),p){var T=p.getSize();this._ctx.beginPath(),this._ctx.rect(p.min.x,p.min.y,T.x,T.y),this._ctx.clip()}this._drawing=!0;for(var V=this._drawFirst;V;V=V.next)c=V.layer,(!p||c._pxBounds&&c._pxBounds.intersects(p))&&c._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(c,p){if(this._drawing){var T,V,W,re,de=c._parts,_e=de.length,we=this._ctx;if(_e){for(we.beginPath(),T=0;T<_e;T++){for(V=0,W=de[T].length;V<W;V++)re=de[T][V],we[V?"lineTo":"moveTo"](re.x,re.y);p&&we.closePath()}this._fillStroke(we,c)}}},_updateCircle:function(c){if(!(!this._drawing||c._empty())){var p=c._point,T=this._ctx,V=Math.max(Math.round(c._radius),1),W=(Math.max(Math.round(c._radiusY),1)||V)/V;W!==1&&(T.save(),T.scale(1,W)),T.beginPath(),T.arc(p.x,p.y/W,V,0,Math.PI*2,!1),W!==1&&T.restore(),this._fillStroke(T,c)}},_fillStroke:function(c,p){var T=p.options;T.fill&&(c.globalAlpha=T.fillOpacity,c.fillStyle=T.fillColor||T.color,c.fill(T.fillRule||"evenodd")),T.stroke&&T.weight!==0&&(c.setLineDash&&c.setLineDash(p.options&&p.options._dashArray||[]),c.globalAlpha=T.opacity,c.lineWidth=T.weight,c.strokeStyle=T.color,c.lineCap=T.lineCap,c.lineJoin=T.lineJoin,c.stroke())},_onClick:function(c){for(var p=this._map.mouseEventToLayerPoint(c),T,V,W=this._drawFirst;W;W=W.next)T=W.layer,T.options.interactive&&T._containsPoint(p)&&(!(c.type==="click"||c.type==="preclick")||!this._map._draggableMoved(T))&&(V=T);this._fireEvent(V?[V]:!1,c)},_onMouseMove:function(c){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var p=this._map.mouseEventToLayerPoint(c);this._handleMouseHover(c,p)}},_handleMouseOut:function(c){var p=this._hoveredLayer;p&&(cn(this._container,"leaflet-interactive"),this._fireEvent([p],c,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(c,p){if(!this._mouseHoverThrottled){for(var T,V,W=this._drawFirst;W;W=W.next)T=W.layer,T.options.interactive&&T._containsPoint(p)&&(V=T);V!==this._hoveredLayer&&(this._handleMouseOut(c),V&&(yt(this._container,"leaflet-interactive"),this._fireEvent([V],c,"mouseover"),this._hoveredLayer=V)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,c),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(c,p,T){this._map._fireDOMEvent(p,T||p.type,c)},_bringToFront:function(c){var p=c._order;if(p){var T=p.next,V=p.prev;if(T)T.prev=V;else return;V?V.next=T:T&&(this._drawFirst=T),p.prev=this._drawLast,this._drawLast.next=p,p.next=null,this._drawLast=p,this._requestRedraw(c)}},_bringToBack:function(c){var p=c._order;if(p){var T=p.next,V=p.prev;if(V)V.next=T;else return;T?T.prev=V:V&&(this._drawLast=V),p.prev=null,p.next=this._drawFirst,this._drawFirst.prev=p,this._drawFirst=p,this._requestRedraw(c)}}});function hh(c){return $e.canvas?new dh(c):null}var rl=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(c){return document.createElement("<lvml:"+c+' class="lvml">')}}catch{}return function(c){return document.createElement("<"+c+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Fm={_initContainer:function(){this._container=_t("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ps.prototype._update.call(this),this.fire("update"))},_initPath:function(c){var p=c._container=rl("shape");yt(p,"leaflet-vml-shape "+(this.options.className||"")),p.coordsize="1 1",c._path=rl("path"),p.appendChild(c._path),this._updateStyle(c),this._layers[u(c)]=c},_addPath:function(c){var p=c._container;this._container.appendChild(p),c.options.interactive&&c.addInteractiveTarget(p)},_removePath:function(c){var p=c._container;ln(p),c.removeInteractiveTarget(p),delete this._layers[u(c)]},_updateStyle:function(c){var p=c._stroke,T=c._fill,V=c.options,W=c._container;W.stroked=!!V.stroke,W.filled=!!V.fill,V.stroke?(p||(p=c._stroke=rl("stroke")),W.appendChild(p),p.weight=V.weight+"px",p.color=V.color,p.opacity=V.opacity,V.dashArray?p.dashStyle=C(V.dashArray)?V.dashArray.join(" "):V.dashArray.replace(/( *, *)/g," "):p.dashStyle="",p.endcap=V.lineCap.replace("butt","flat"),p.joinstyle=V.lineJoin):p&&(W.removeChild(p),c._stroke=null),V.fill?(T||(T=c._fill=rl("fill")),W.appendChild(T),T.color=V.fillColor||V.color,T.opacity=V.fillOpacity):T&&(W.removeChild(T),c._fill=null)},_updateCircle:function(c){var p=c._point.round(),T=Math.round(c._radius),V=Math.round(c._radiusY||T);this._setPath(c,c._empty()?"M0 0":"AL "+p.x+","+p.y+" "+T+","+V+" 0,"+65535*360)},_setPath:function(c,p){c._path.v=p},_bringToFront:function(c){Bs(c._container)},_bringToBack:function(c){Wi(c._container)}},Qi=$e.vml?rl:Et,ea=ps.extend({_initContainer:function(){this._container=Qi("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Qi("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){ln(this._container),tn(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ps.prototype._update.call(this);var c=this._bounds,p=c.getSize(),T=this._container;(!this._svgSize||!this._svgSize.equals(p))&&(this._svgSize=p,T.setAttribute("width",p.x),T.setAttribute("height",p.y)),xt(T,c.min),T.setAttribute("viewBox",[c.min.x,c.min.y,p.x,p.y].join(" ")),this.fire("update")}},_initPath:function(c){var p=c._path=Qi("path");c.options.className&&yt(p,c.options.className),c.options.interactive&&yt(p,"leaflet-interactive"),this._updateStyle(c),this._layers[u(c)]=c},_addPath:function(c){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(c._path),c.addInteractiveTarget(c._path)},_removePath:function(c){ln(c._path),c.removeInteractiveTarget(c._path),delete this._layers[u(c)]},_updatePath:function(c){c._project(),c._update()},_updateStyle:function(c){var p=c._path,T=c.options;p&&(T.stroke?(p.setAttribute("stroke",T.color),p.setAttribute("stroke-opacity",T.opacity),p.setAttribute("stroke-width",T.weight),p.setAttribute("stroke-linecap",T.lineCap),p.setAttribute("stroke-linejoin",T.lineJoin),T.dashArray?p.setAttribute("stroke-dasharray",T.dashArray):p.removeAttribute("stroke-dasharray"),T.dashOffset?p.setAttribute("stroke-dashoffset",T.dashOffset):p.removeAttribute("stroke-dashoffset")):p.setAttribute("stroke","none"),T.fill?(p.setAttribute("fill",T.fillColor||T.color),p.setAttribute("fill-opacity",T.fillOpacity),p.setAttribute("fill-rule",T.fillRule||"evenodd")):p.setAttribute("fill","none"))},_updatePoly:function(c,p){this._setPath(c,_n(c._parts,p))},_updateCircle:function(c){var p=c._point,T=Math.max(Math.round(c._radius),1),V=Math.max(Math.round(c._radiusY),1)||T,W="a"+T+","+V+" 0 1,0 ",re=c._empty()?"M0 0":"M"+(p.x-T)+","+p.y+W+T*2+",0 "+W+-T*2+",0 ";this._setPath(c,re)},_setPath:function(c,p){c._path.setAttribute("d",p)},_bringToFront:function(c){Bs(c._path)},_bringToBack:function(c){Wi(c._path)}});$e.vml&&ea.include(Fm);function ju(c){return $e.svg||$e.vml?new ea(c):null}Rt.include({getRenderer:function(c){var p=c.options.renderer||this._getPaneRenderer(c.options.pane)||this.options.renderer||this._renderer;return p||(p=this._renderer=this._createRenderer()),this.hasLayer(p)||this.addLayer(p),p},_getPaneRenderer:function(c){if(c==="overlayPane"||c===void 0)return!1;var p=this._paneRenderers[c];return p===void 0&&(p=this._createRenderer({pane:c}),this._paneRenderers[c]=p),p},_createRenderer:function(c){return this.options.preferCanvas&&hh(c)||ju(c)}});var Vm=Ks.extend({initialize:function(c,p){Ks.prototype.initialize.call(this,this._boundsToLatLngs(c),p)},setBounds:function(c){return this.setLatLngs(this._boundsToLatLngs(c))},_boundsToLatLngs:function(c){return c=se(c),[c.getSouthWest(),c.getNorthWest(),c.getNorthEast(),c.getSouthEast()]}});function x0(c,p){return new Vm(c,p)}ea.create=Qi,ea.pointsToPath=_n,fs.geometryToLayer=Xa,fs.coordsToLatLng=Nu,fs.coordsToLatLngs=gc,fs.latLngToCoords=ku,fs.latLngsToCoords=Pu,fs.getFeature=Ja,fs.asFeature=Cu,Rt.mergeOptions({boxZoom:!0});var il=Pr.extend({initialize:function(c){this._map=c,this._container=c._container,this._pane=c._panes.overlayPane,this._resetStateTimeout=0,c.on("unload",this._destroy,this)},addHooks:function(){at(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){tn(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){ln(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(c){if(!c.shiftKey||c.which!==1&&c.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Ct(),za(),this._startPoint=this._map.mouseEventToContainerPoint(c),at(document,{contextmenu:ar,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(c){this._moved||(this._moved=!0,this._box=_t("div","leaflet-zoom-box",this._container),yt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(c);var p=new q(this._point,this._startPoint),T=p.getSize();xt(this._box,p.min),this._box.style.width=T.x+"px",this._box.style.height=T.y+"px"},_finish:function(){this._moved&&(ln(this._box),cn(this._container,"leaflet-crosshair")),wi(),Ba(),tn(document,{contextmenu:ar,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(c){if(!(c.which!==1&&c.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var p=new ne(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(p).fire("boxzoomend",{boxZoomBounds:p})}},_onKeyDown:function(c){c.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Rt.addInitHook("addHandler","boxZoom",il),Rt.mergeOptions({doubleClickZoom:!0});var zm=Pr.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(c){var p=this._map,T=p.getZoom(),V=p.options.zoomDelta,W=c.originalEvent.shiftKey?T-V:T+V;p.options.doubleClickZoom==="center"?p.setZoom(W):p.setZoomAround(c.containerPoint,W)}});Rt.addInitHook("addHandler","doubleClickZoom",zm),Rt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var fh=Pr.extend({addHooks:function(){if(!this._draggable){var c=this._map;this._draggable=new Vr(c._mapPane,c._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),c.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),c.on("zoomend",this._onZoomEnd,this),c.whenReady(this._onZoomEnd,this))}yt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){cn(this._map._container,"leaflet-grab"),cn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var c=this._map;if(c._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var p=se(this._map.options.maxBounds);this._offsetLimit=Z(this._map.latLngToContainerPoint(p.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(p.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;c.fire("movestart").fire("dragstart"),c.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(c){if(this._map.options.inertia){var p=this._lastTime=+new Date,T=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(T),this._times.push(p),this._prunePositions(p)}this._map.fire("move",c).fire("drag",c)},_prunePositions:function(c){for(;this._positions.length>1&&c-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var c=this._map.getSize().divideBy(2),p=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=p.subtract(c).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(c,p){return c-(c-p)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var c=this._draggable._newPos.subtract(this._draggable._startPos),p=this._offsetLimit;c.x<p.min.x&&(c.x=this._viscousLimit(c.x,p.min.x)),c.y<p.min.y&&(c.y=this._viscousLimit(c.y,p.min.y)),c.x>p.max.x&&(c.x=this._viscousLimit(c.x,p.max.x)),c.y>p.max.y&&(c.y=this._viscousLimit(c.y,p.max.y)),this._draggable._newPos=this._draggable._startPos.add(c)}},_onPreDragWrap:function(){var c=this._worldWidth,p=Math.round(c/2),T=this._initialWorldOffset,V=this._draggable._newPos.x,W=(V-p+T)%c+p-T,re=(V+p+T)%c-p-T,de=Math.abs(W+T)<Math.abs(re+T)?W:re;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=de},_onDragEnd:function(c){var p=this._map,T=p.options,V=!T.inertia||c.noInertia||this._times.length<2;if(p.fire("dragend",c),V)p.fire("moveend");else{this._prunePositions(+new Date);var W=this._lastPos.subtract(this._positions[0]),re=(this._lastTime-this._times[0])/1e3,de=T.easeLinearity,_e=W.multiplyBy(de/re),we=_e.distanceTo([0,0]),Pe=Math.min(T.inertiaMaxSpeed,we),He=_e.multiplyBy(Pe/we),ut=Pe/(T.inertiaDeceleration*de),Pt=He.multiplyBy(-ut/2).round();!Pt.x&&!Pt.y?p.fire("moveend"):(Pt=p._limitOffset(Pt,p.options.maxBounds),O(function(){p.panBy(Pt,{duration:ut,easeLinearity:de,noMoveStart:!0,animate:!0})}))}}});Rt.addInitHook("addHandler","dragging",fh),Rt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var mh=Pr.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(c){this._map=c,this._setPanDelta(c.options.keyboardPanDelta),this._setZoomDelta(c.options.zoomDelta)},addHooks:function(){var c=this._map._container;c.tabIndex<=0&&(c.tabIndex="0"),at(c,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),tn(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var c=document.body,p=document.documentElement,T=c.scrollTop||p.scrollTop,V=c.scrollLeft||p.scrollLeft;this._map._container.focus(),window.scrollTo(V,T)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(c){var p=this._panKeys={},T=this.keyCodes,V,W;for(V=0,W=T.left.length;V<W;V++)p[T.left[V]]=[-1*c,0];for(V=0,W=T.right.length;V<W;V++)p[T.right[V]]=[c,0];for(V=0,W=T.down.length;V<W;V++)p[T.down[V]]=[0,c];for(V=0,W=T.up.length;V<W;V++)p[T.up[V]]=[0,-1*c]},_setZoomDelta:function(c){var p=this._zoomKeys={},T=this.keyCodes,V,W;for(V=0,W=T.zoomIn.length;V<W;V++)p[T.zoomIn[V]]=c;for(V=0,W=T.zoomOut.length;V<W;V++)p[T.zoomOut[V]]=-c},_addHooks:function(){at(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){tn(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(c){if(!(c.altKey||c.ctrlKey||c.metaKey)){var p=c.keyCode,T=this._map,V;if(p in this._panKeys){if(!T._panAnim||!T._panAnim._inProgress)if(V=this._panKeys[p],c.shiftKey&&(V=Y(V).multiplyBy(3)),T.options.maxBounds&&(V=T._limitOffset(Y(V),T.options.maxBounds)),T.options.worldCopyJump){var W=T.wrapLatLng(T.unproject(T.project(T.getCenter()).add(V)));T.panTo(W)}else T.panBy(V)}else if(p in this._zoomKeys)T.setZoom(T.getZoom()+(c.shiftKey?3:1)*this._zoomKeys[p]);else if(p===27&&T._popup&&T._popup.options.closeOnEscapeKey)T.closePopup();else return;ar(c)}}});Rt.addInitHook("addHandler","keyboard",mh),Rt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var vn=Pr.extend({addHooks:function(){at(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){tn(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(c){var p=bu(c),T=this._map.options.wheelDebounceTime;this._delta+=p,this._lastMousePos=this._map.mouseEventToContainerPoint(c),this._startTime||(this._startTime=+new Date);var V=Math.max(T-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),V),ar(c)},_performZoom:function(){var c=this._map,p=c.getZoom(),T=this._map.options.zoomSnap||0;c._stop();var V=this._delta/(this._map.options.wheelPxPerZoomLevel*4),W=4*Math.log(2/(1+Math.exp(-Math.abs(V))))/Math.LN2,re=T?Math.ceil(W/T)*T:W,de=c._limitZoom(p+(this._delta>0?re:-re))-p;this._delta=0,this._startTime=null,de&&(c.options.scrollWheelZoom==="center"?c.setZoom(p+de):c.setZoomAround(this._lastMousePos,p+de))}});Rt.addInitHook("addHandler","scrollWheelZoom",vn);var ph=600;Rt.mergeOptions({tapHold:$e.touchNative&&$e.safari&&$e.mobile,tapTolerance:15});var _c=Pr.extend({addHooks:function(){at(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){tn(this._map._container,"touchstart",this._onDown,this)},_onDown:function(c){if(clearTimeout(this._holdTimeout),c.touches.length===1){var p=c.touches[0];this._startPos=this._newPos=new ee(p.clientX,p.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(at(document,"touchend",un),at(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",p))},this),ph),at(document,"touchend touchcancel contextmenu",this._cancel,this),at(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function c(){tn(document,"touchend",un),tn(document,"touchend touchcancel",c)},_cancel:function(){clearTimeout(this._holdTimeout),tn(document,"touchend touchcancel contextmenu",this._cancel,this),tn(document,"touchmove",this._onMove,this)},_onMove:function(c){var p=c.touches[0];this._newPos=new ee(p.clientX,p.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(c,p){var T=new MouseEvent(c,{bubbles:!0,cancelable:!0,view:window,screenX:p.screenX,screenY:p.screenY,clientX:p.clientX,clientY:p.clientY});T._simulated=!0,p.target.dispatchEvent(T)}});Rt.addInitHook("addHandler","tapHold",_c),Rt.mergeOptions({touchZoom:$e.touch,bounceAtZoomLimits:!0});var sl=Pr.extend({addHooks:function(){yt(this._map._container,"leaflet-touch-zoom"),at(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){cn(this._map._container,"leaflet-touch-zoom"),tn(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(c){var p=this._map;if(!(!c.touches||c.touches.length!==2||p._animatingZoom||this._zooming)){var T=p.mouseEventToContainerPoint(c.touches[0]),V=p.mouseEventToContainerPoint(c.touches[1]);this._centerPoint=p.getSize()._divideBy(2),this._startLatLng=p.containerPointToLatLng(this._centerPoint),p.options.touchZoom!=="center"&&(this._pinchStartLatLng=p.containerPointToLatLng(T.add(V)._divideBy(2))),this._startDist=T.distanceTo(V),this._startZoom=p.getZoom(),this._moved=!1,this._zooming=!0,p._stop(),at(document,"touchmove",this._onTouchMove,this),at(document,"touchend touchcancel",this._onTouchEnd,this),un(c)}},_onTouchMove:function(c){if(!(!c.touches||c.touches.length!==2||!this._zooming)){var p=this._map,T=p.mouseEventToContainerPoint(c.touches[0]),V=p.mouseEventToContainerPoint(c.touches[1]),W=T.distanceTo(V)/this._startDist;if(this._zoom=p.getScaleZoom(W,this._startZoom),!p.options.bounceAtZoomLimits&&(this._zoom<p.getMinZoom()&&W<1||this._zoom>p.getMaxZoom()&&W>1)&&(this._zoom=p._limitZoom(this._zoom)),p.options.touchZoom==="center"){if(this._center=this._startLatLng,W===1)return}else{var re=T._add(V)._divideBy(2)._subtract(this._centerPoint);if(W===1&&re.x===0&&re.y===0)return;this._center=p.unproject(p.project(this._pinchStartLatLng,this._zoom).subtract(re),this._zoom)}this._moved||(p._moveStart(!0,!1),this._moved=!0),D(this._animRequest);var de=o(p._move,p,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=O(de,this,!0),un(c)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,D(this._animRequest),tn(document,"touchmove",this._onTouchMove,this),tn(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Rt.addInitHook("addHandler","touchZoom",sl),Rt.BoxZoom=il,Rt.DoubleClickZoom=zm,Rt.Drag=fh,Rt.Keyboard=mh,Rt.ScrollWheelZoom=vn,Rt.TapHold=_c,Rt.TouchZoom=sl,t.Bounds=q,t.Browser=$e,t.CRS=ce,t.Canvas=dh,t.Circle=Au,t.CircleMarker=Su,t.Class=$,t.Control=_r,t.DivIcon=Ou,t.DivOverlay=ms,t.DomEvent=Ko,t.DomUtil=fo,t.Draggable=Vr,t.Evented=oe,t.FeatureGroup=Mn,t.GeoJSON=fs,t.GridLayer=yo,t.Handler=Pr,t.Icon=Yi,t.ImageOverlay=go,t.LatLng=le,t.LatLngBounds=ne,t.Layer=nn,t.LayerGroup=wn,t.LineUtil=ae,t.Map=Rt,t.Marker=Gs,t.Mixin=Hs,t.Path=po,t.Point=ee,t.PolyUtil=Ka,t.Polygon=Ks,t.Polyline=si,t.Popup=Ru,t.PosAnimation=Yo,t.Projection=ze,t.Rectangle=Vm,t.Renderer=ps,t.SVG=ea,t.SVGOverlay=lh,t.TileLayer=vo,t.Tooltip=tl,t.Transformation=Ue,t.Util=M,t.VideoOverlay=ah,t.bind=o,t.bounds=Z,t.canvas=hh,t.circle=pc,t.circleMarker=Rm,t.control=Jn,t.divIcon=Dm,t.extend=i,t.featureGroup=Jo,t.geoJSON=Om,t.geoJson=Zi,t.gridLayer=nl,t.icon=Cm,t.imageOverlay=jm,t.latLng=Q,t.latLngBounds=se,t.layerGroup=Ii,t.map=ii,t.marker=y0,t.point=Y,t.polygon=_0,t.polyline=v0,t.popup=el,t.rectangle=x0,t.setOptions=x,t.stamp=u,t.svg=ju,t.svgOverlay=ch,t.tileLayer=uh,t.tooltip=yc,t.transformation=nt,t.version=n,t.videoOverlay=Mm;var Bm=window.L;t.noConflict=function(){return window.L=Bm,this},window.L=t})}(yf,yf.exports)),yf.exports}var K2=lW();function OR(r,e,t){return Object.freeze({instance:r,context:e,container:t})}function jR(r,e){return e==null?function(n,i){const s=te.useRef();return s.current||(s.current=r(n,i)),s}:function(n,i){const s=te.useRef();s.current||(s.current=r(n,i));const o=te.useRef(n),{instance:l}=s.current;return te.useEffect(function(){o.current!==n&&(e(l,n,o.current),o.current=n)},[l,n,i]),s}}function MR(r,e){te.useEffect(function(){return(e.layerContainer??e.map).addLayer(r.instance),function(){var s;(s=e.layerContainer)==null||s.removeLayer(r.instance),e.map.removeLayer(r.instance)}},[e,r])}function cW(r){return function(t){const n=CR(),i=r(G2(t,n),n);return tW(n.map,t.attribution),RR(i.current,t.eventHandlers),MR(i.current,n),i}}function uW(r,e){const t=te.useRef();te.useEffect(function(){if(e.pathOptions!==t.current){const i=e.pathOptions??{};r.instance.setStyle(i),t.current=i}},[r,e])}function dW(r){return function(t){const n=CR(),i=r(G2(t,n),n);return RR(i.current,t.eventHandlers),MR(i.current,n),uW(i.current,t),i}}function hW(r,e){const t=jR(r,e),n=dW(t);return sW(n)}function fW(r,e){const t=jR(r,e),n=cW(t);return oW(n)}function mW(r,e,t){const{opacity:n,zIndex:i}=e;n!=null&&n!==t.opacity&&r.setOpacity(n),i!=null&&i!==t.zIndex&&r.setZIndex(i)}const pW=hW(function({data:e,...t},n){const i=new K2.GeoJSON(e,t);return OR(i,iW(n,{overlayContainer:i}))},function(e,t,n){t.style!==n.style&&(t.style==null?e.resetStyle():e.setStyle(t.style))});function Kx(){return Kx=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Kx.apply(this,arguments)}function gW({bounds:r,boundsOptions:e,center:t,children:n,className:i,id:s,placeholder:o,style:l,whenReady:u,zoom:f,...m},y){const[g]=te.useState({className:i,id:s,style:l}),[_,E]=te.useState(null);te.useImperativeHandle(y,()=>(_==null?void 0:_.map)??null,[_]);const x=te.useCallback(S=>{if(S!==null&&_===null){const I=new K2.Map(S,m);t!=null&&f!=null?I.setView(t,f):r!=null&&I.fitBounds(r,e),u!=null&&I.whenReady(u),E(rW(I))}},[]);te.useEffect(()=>()=>{_==null||_.map.remove()},[_]);const w=_?is.createElement(PR,{value:_},n):o??null;return is.createElement("div",Kx({},g,{ref:x}),w)}const yW=te.forwardRef(gW),vW=fW(function({url:e,...t},n){const i=new K2.TileLayer(e,G2(t,n));return OR(i,n)},function(e,t,n){mW(e,t,n);const{url:i}=t;i!=null&&i!==n.url&&e.setUrl(i)}),DR=({geoJsonData:r,affectedAreas:e=[],mapCenter:t=[14.3207,120.7641],mapZoom:n=13,height:i="256px"})=>{const s={fillColor:"#6b7280",weight:1,opacity:1,color:"white",fillOpacity:.3},o={fillColor:"#EF4444",weight:2,opacity:1,color:"#B91C1C",fillOpacity:.7},l=m=>{var g;const y=(g=m==null?void 0:m.properties)==null?void 0:g.NAME_3;return e.includes(y)?o:s},u=(m,y)=>{var _;const g=(_=m==null?void 0:m.properties)==null?void 0:_.NAME_3;if(g){const E=e.includes(g),x=`
                <div>
                    <strong>${g}</strong>
                    <p style="color: ${E?"#B91C1C":"#374151"}; margin: 0; font-weight: bold;">
                        ${E?"AFFECTED":"Not Affected"}
                    </p>
                </div>
            `;y.bindPopup(x)}},f=JSON.stringify(e);return d.jsxs(yW,{center:t,zoom:n,scrollWheelZoom:!1,style:{height:i,width:"100%"},children:[d.jsx(vW,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),d.jsx(pW,{data:r,style:l,onEachFeature:u})]},f)},_W="FeatureCollection",xW=JSON.parse('[{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10541,"NAME_3":"Bagong Karsada","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.751953,14.32201],[120.752228,14.32222],[120.752663,14.32253],[120.753036,14.32284],[120.753357,14.32315],[120.753677,14.32344],[120.753937,14.32382],[120.754112,14.32407],[120.755127,14.32243],[120.755623,14.32164],[120.753319,14.31961],[120.753288,14.31996],[120.75325,14.32051],[120.75177,14.32179],[120.751953,14.32201]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10542,"NAME_3":"Balsahan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.757576,14.324344],[120.757652,14.32411],[120.757851,14.32374],[120.758034,14.3234],[120.758293,14.32305],[120.75853,14.32271],[120.75885,14.32232],[120.759201,14.3219],[120.759644,14.32152],[120.760017,14.32123],[120.759048,14.32047],[120.756859,14.31872],[120.756042,14.31818],[120.755547,14.31786],[120.754921,14.3172],[120.753166,14.31839],[120.753319,14.31961],[120.755623,14.32164],[120.756866,14.32269],[120.756897,14.32261],[120.757576,14.324344]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10543,"NAME_3":"Bancaan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.760017,14.32123],[120.760094,14.32119],[120.76049,14.3209],[120.760841,14.32068],[120.7612,14.32057],[120.761574,14.32058],[120.761879,14.32073],[120.762115,14.32097],[120.762291,14.31999],[120.762367,14.31954],[120.762497,14.31838],[120.763046,14.31687],[120.763611,14.31575],[120.764374,14.31534],[120.764709,14.31529],[120.760948,14.31142],[120.758423,14.30908],[120.75679,14.30764],[120.749802,14.3161],[120.749046,14.31704],[120.748451,14.31786],[120.747993,14.3185],[120.74823,14.31858],[120.748756,14.31893],[120.749207,14.31934],[120.749672,14.31971],[120.750137,14.32007],[120.750542,14.32052],[120.750763,14.32081],[120.750923,14.32101],[120.751343,14.32144],[120.75177,14.32187],[120.751953,14.32201],[120.75177,14.32179],[120.75325,14.32051],[120.753288,14.31996],[120.753319,14.31961],[120.753166,14.31839],[120.754921,14.3172],[120.755547,14.31786],[120.756042,14.31818],[120.756859,14.31872],[120.759048,14.32047],[120.760017,14.32123]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10544,"NAME_3":"Bucana Malaki","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.759468,14.32942],[120.75988,14.32972],[120.760094,14.32985],[120.760612,14.32961],[120.762527,14.32867],[120.765457,14.32651],[120.761711,14.32374],[120.762093,14.32114],[120.762115,14.32097],[120.761879,14.32073],[120.761574,14.32058],[120.7612,14.32057],[120.760841,14.32068],[120.76049,14.3209],[120.760094,14.32119],[120.760017,14.32123],[120.759644,14.32152],[120.759201,14.3219],[120.75885,14.32232],[120.75853,14.32271],[120.758293,14.32305],[120.758034,14.3234],[120.757851,14.32374],[120.757652,14.32411],[120.757576,14.324344],[120.757561,14.32441],[120.757507,14.32458],[120.757393,14.32517],[120.757378,14.32534],[120.757332,14.32586],[120.757423,14.32654],[120.757683,14.32709],[120.758034,14.32756],[120.758377,14.32805],[120.758728,14.32854],[120.759117,14.32899],[120.759468,14.32942]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10545,"NAME_3":"Bucana Sasahan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.75563,14.32561],[120.759468,14.32942],[120.759117,14.32899],[120.758728,14.32854],[120.758377,14.32805],[120.758034,14.32756],[120.757683,14.32709],[120.757423,14.32654],[120.757332,14.32586],[120.757378,14.32534],[120.757393,14.32517],[120.757507,14.32458],[120.757561,14.32441],[120.757576,14.324344],[120.756897,14.32261],[120.756866,14.32269],[120.756737,14.32314],[120.756622,14.32366],[120.756508,14.32416],[120.756378,14.32468],[120.756088,14.32519],[120.75563,14.32561]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10546,"NAME_3":"Calubcob","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.796928,14.30077],[120.795471,14.29953],[120.793137,14.29676],[120.79158,14.29506],[120.787483,14.2923],[120.786659,14.29179],[120.785629,14.29099],[120.783401,14.28984],[120.782379,14.29027],[120.782082,14.29058],[120.78141,14.29118],[120.781189,14.29207],[120.780548,14.29224],[120.780434,14.29373],[120.779984,14.29418],[120.780212,14.29477],[120.780952,14.2945],[120.780899,14.29493],[120.780457,14.29537],[120.78064,14.29603],[120.780273,14.29652],[120.779167,14.29681],[120.778511,14.29719],[120.778053,14.29832],[120.777763,14.29899],[120.777924,14.30045],[120.77832,14.30128],[120.778503,14.30227],[120.779778,14.30327],[120.783112,14.30549],[120.783958,14.30623],[120.785881,14.30723],[120.786102,14.30674],[120.787018,14.30689],[120.787827,14.30755],[120.788567,14.30743],[120.788879,14.30703],[120.78952,14.3074],[120.789886,14.30639],[120.790253,14.30608],[120.790604,14.30655],[120.791344,14.30624],[120.79174,14.30554],[120.79213,14.30448],[120.792648,14.30341],[120.793854,14.30352],[120.795471,14.30197],[120.795929,14.30115],[120.796928,14.30077]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10547,"NAME_3":"Capt. C. Nazareno","NL_NAME_3":"","VARNAME_3":"Poblacion","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.766197,14.31813],[120.763046,14.31687],[120.762497,14.31838],[120.762367,14.31954],[120.76326,14.31981],[120.763931,14.32013],[120.764572,14.32034],[120.7649,14.32048],[120.766197,14.31813]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10548,"NAME_3":"Gomez-Zamora","NL_NAME_3":"","VARNAME_3":"Poblacion","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.762115,14.32097],[120.762093,14.32114],[120.762802,14.32201],[120.763283,14.32248],[120.764091,14.3223],[120.76458,14.32184],[120.765198,14.32126],[120.766006,14.321],[120.766571,14.32094],[120.767021,14.32038],[120.767509,14.31945],[120.766197,14.31813],[120.7649,14.32048],[120.764572,14.32034],[120.763931,14.32013],[120.76326,14.31981],[120.762367,14.31954],[120.762291,14.31999],[120.762115,14.32097]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10549,"NAME_3":"Halang","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.796928,14.30077],[120.798698,14.3027],[120.800812,14.30515],[120.802559,14.3051],[120.803482,14.30436],[120.803978,14.30431],[120.805817,14.30476],[120.807091,14.3045],[120.807037,14.30409],[120.807747,14.30351],[120.808243,14.30261],[120.809677,14.30198],[120.809601,14.3011],[120.81073,14.30081],[120.811562,14.30122],[120.811897,14.30196],[120.812668,14.3024],[120.813179,14.30343],[120.814293,14.30287],[120.815407,14.3016],[120.820297,14.29734],[120.819633,14.29599],[120.819939,14.29436],[120.813843,14.29398],[120.81057,14.29228],[120.809769,14.29181],[120.806229,14.28998],[120.804901,14.28931],[120.802063,14.28757],[120.798309,14.2857],[120.792213,14.28238],[120.788612,14.2884],[120.787956,14.28963],[120.786659,14.29179],[120.787483,14.2923],[120.79158,14.29506],[120.793137,14.29676],[120.795471,14.29953],[120.796928,14.30077]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10550,"NAME_3":"Humbac","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.766197,14.31813],[120.767509,14.31945],[120.768089,14.31881],[120.769089,14.31828],[120.769676,14.31781],[120.770073,14.31745],[120.769814,14.31668],[120.769524,14.31613],[120.769234,14.31572],[120.766197,14.31813]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10551,"NAME_3":"Ibayo Estacion","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.769722,14.32933],[120.769821,14.32828],[120.770157,14.32789],[120.77076,14.32727],[120.77137,14.32683],[120.771744,14.32605],[120.772591,14.32497],[120.770638,14.32312],[120.768913,14.32191],[120.767021,14.32038],[120.766571,14.32094],[120.766006,14.321],[120.765198,14.32126],[120.76458,14.32184],[120.764091,14.3223],[120.763283,14.32248],[120.762802,14.32201],[120.762093,14.32114],[120.761711,14.32374],[120.765457,14.32651],[120.769722,14.32933]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10552,"NAME_3":"Ibayo Silangan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.773247,14.32551],[120.774567,14.32522],[120.77565,14.32507],[120.778954,14.32391],[120.781349,14.32267],[120.780998,14.32235],[120.778877,14.32059],[120.775726,14.31822],[120.773621,14.31899],[120.772987,14.31952],[120.77224,14.31976],[120.771523,14.31882],[120.771339,14.31775],[120.771278,14.31705],[120.770531,14.31729],[120.770073,14.31745],[120.769676,14.31781],[120.769089,14.31828],[120.768089,14.31881],[120.767509,14.31945],[120.767021,14.32038],[120.768913,14.32191],[120.770638,14.32312],[120.772591,14.32497],[120.773247,14.32551]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10553,"NAME_3":"Kanluran","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.763046,14.31687],[120.766197,14.31813],[120.769234,14.31572],[120.768738,14.31548],[120.767899,14.31517],[120.76712,14.31594],[120.766319,14.31657],[120.765717,14.31653],[120.765198,14.31578],[120.764709,14.31529],[120.764374,14.31534],[120.763611,14.31575],[120.763046,14.31687]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10554,"NAME_3":"Labac","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.727501,14.31074],[120.727501,14.31083],[120.728333,14.31167],[120.728333,14.31194],[120.730553,14.31417],[120.731079,14.31434],[120.731506,14.31455],[120.731941,14.31476],[120.73233,14.31499],[120.732742,14.3152],[120.7332,14.31533],[120.733643,14.31549],[120.734047,14.31551],[120.734123,14.31552],[120.734596,14.31547],[120.735077,14.31552],[120.735558,14.31549],[120.736,14.31532],[120.736488,14.31518],[120.737053,14.31506],[120.737663,14.31505],[120.738228,14.31514],[120.738731,14.31529],[120.73922,14.3154],[120.739754,14.31528],[120.739929,14.31525],[120.740311,14.31519],[120.740791,14.31544],[120.741249,14.31574],[120.741814,14.31583],[120.742416,14.31588],[120.742981,14.31611],[120.7435,14.31635],[120.744003,14.3165],[120.744476,14.31663],[120.74498,14.31673],[120.745422,14.31697],[120.745872,14.31728],[120.74633,14.31768],[120.746399,14.31705],[120.746422,14.31649],[120.746307,14.31613],[120.745743,14.31451],[120.74572,14.31392],[120.746071,14.31316],[120.7472,14.31252],[120.747627,14.31176],[120.747269,14.31077],[120.747269,14.31019],[120.747887,14.31001],[120.749023,14.31056],[120.74984,14.31044],[120.750641,14.30858],[120.751472,14.30825],[120.751663,14.30732],[120.751251,14.30685],[120.751167,14.30573],[120.75164,14.30486],[120.752296,14.30424],[120.752907,14.30395],[120.753052,14.30365],[120.746437,14.29659],[120.745796,14.29764],[120.745293,14.29806],[120.743797,14.29915],[120.742577,14.30067],[120.741898,14.3013],[120.740562,14.30152],[120.739609,14.30153],[120.739128,14.30179],[120.738258,14.30266],[120.737892,14.30344],[120.737221,14.3043],[120.736237,14.30493],[120.735184,14.3056],[120.73069,14.30862],[120.727501,14.31074]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10555,"NAME_3":"Latoria","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.760094,14.32985],[120.760246,14.32995],[120.760612,14.33011],[120.760887,14.33032],[120.761208,14.33049],[120.761642,14.33054],[120.762154,14.33055],[120.762688,14.33055],[120.763206,14.33056],[120.763702,14.33058],[120.763947,14.33063],[120.764732,14.33008],[120.765961,14.33096],[120.767014,14.33117],[120.767776,14.3311],[120.768448,14.33105],[120.769211,14.33038],[120.769722,14.32933],[120.765457,14.32651],[120.762527,14.32867],[120.760612,14.32961],[120.760094,14.32985]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10556,"NAME_3":"Mabolo","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.74633,14.31768],[120.746902,14.31804],[120.747551,14.31834],[120.747993,14.3185],[120.748451,14.31786],[120.749046,14.31704],[120.749802,14.3161],[120.75679,14.30764],[120.75473,14.30534],[120.753052,14.30365],[120.752907,14.30395],[120.752296,14.30424],[120.75164,14.30486],[120.751167,14.30573],[120.751251,14.30685],[120.751663,14.30732],[120.751472,14.30825],[120.750641,14.30858],[120.74984,14.31044],[120.749023,14.31056],[120.747887,14.31001],[120.747269,14.31019],[120.747269,14.31077],[120.747627,14.31176],[120.7472,14.31252],[120.746071,14.31316],[120.74572,14.31392],[120.745743,14.31451],[120.746307,14.31613],[120.746422,14.31649],[120.746399,14.31705],[120.74633,14.31768]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10557,"NAME_3":"Makina","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.775726,14.31822],[120.77623,14.31799],[120.776337,14.31736],[120.776016,14.31699],[120.775383,14.31703],[120.775131,14.31666],[120.775398,14.31625],[120.777046,14.31609],[120.77787,14.31627],[120.778267,14.3167],[120.779129,14.31653],[120.779984,14.31584],[120.780212,14.31507],[120.780144,14.31417],[120.780777,14.31381],[120.781914,14.31403],[120.779716,14.31219],[120.779213,14.31167],[120.778717,14.31116],[120.778137,14.31058],[120.776154,14.30884],[120.775749,14.3103],[120.774963,14.31186],[120.774757,14.3131],[120.771317,14.31285],[120.769661,14.31275],[120.768494,14.31254],[120.768318,14.31354],[120.768143,14.3146],[120.767899,14.31517],[120.768738,14.31548],[120.769234,14.31572],[120.769524,14.31613],[120.769814,14.31668],[120.770073,14.31745],[120.770531,14.31729],[120.771278,14.31705],[120.771339,14.31775],[120.771523,14.31882],[120.77224,14.31976],[120.772987,14.31952],[120.773621,14.31899],[120.775726,14.31822]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10558,"NAME_3":"Malainen Bago","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.767899,14.31517],[120.768143,14.3146],[120.768318,14.31354],[120.768494,14.31254],[120.768593,14.3121],[120.769157,14.31145],[120.769272,14.31056],[120.769203,14.30977],[120.769676,14.30846],[120.770462,14.30794],[120.771317,14.3086],[120.771599,14.30837],[120.772362,14.30716],[120.772537,14.3066],[120.773163,14.30608],[120.773613,14.30575],[120.773712,14.30503],[120.774094,14.30462],[120.774361,14.3042],[120.774208,14.30345],[120.774017,14.30235],[120.774811,14.30239],[120.775352,14.3017],[120.77562,14.30165],[120.775917,14.30212],[120.776398,14.30275],[120.777023,14.30223],[120.777603,14.30251],[120.777931,14.30307],[120.778503,14.30227],[120.77832,14.30128],[120.777924,14.30045],[120.777763,14.29899],[120.778053,14.29832],[120.778511,14.29719],[120.779167,14.29681],[120.780273,14.29652],[120.78064,14.29603],[120.780457,14.29537],[120.780899,14.29493],[120.780952,14.2945],[120.780212,14.29477],[120.779984,14.29418],[120.780434,14.29373],[120.780548,14.29224],[120.781189,14.29207],[120.78141,14.29118],[120.782082,14.29058],[120.779907,14.28971],[120.777046,14.28816],[120.775574,14.28685],[120.77198,14.28391],[120.761482,14.29684],[120.760094,14.29865],[120.75946,14.2995],[120.75473,14.30534],[120.75679,14.30764],[120.758423,14.30908],[120.760948,14.31142],[120.764709,14.31529],[120.765198,14.31578],[120.765717,14.31653],[120.766319,14.31657],[120.76712,14.31594],[120.767899,14.31517]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10559,"NAME_3":"Malainen Luma","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.794434,14.27777],[120.795692,14.27623],[120.796799,14.27539],[120.797752,14.2752],[120.798431,14.27461],[120.798401,14.27377],[120.798843,14.27331],[120.799072,14.27257],[120.798943,14.27116],[120.799187,14.27024],[120.79953,14.27012],[120.800102,14.26998],[120.800957,14.26899],[120.801849,14.26861],[120.802597,14.26735],[120.804024,14.26673],[120.804764,14.26612],[120.805527,14.26521],[120.807266,14.26317],[120.808327,14.26269],[120.809067,14.26174],[120.810127,14.26152],[120.810783,14.26001],[120.812187,14.2584],[120.81263,14.25872],[120.813477,14.25752],[120.814072,14.25646],[120.815041,14.25574],[120.816132,14.25479],[120.816208,14.25375],[120.816994,14.25316],[120.81781,14.25278],[120.818863,14.25252],[120.81945,14.25189],[120.819832,14.25076],[120.820511,14.24925],[120.826263,14.24232],[120.830116,14.23784],[120.81546,14.23471],[120.814468,14.23565],[120.813187,14.23765],[120.812798,14.23927],[120.811974,14.24012],[120.810806,14.24049],[120.809669,14.24196],[120.808357,14.24426],[120.807137,14.24588],[120.805428,14.24794],[120.802589,14.25125],[120.801048,14.25189],[120.799553,14.25132],[120.798248,14.25165],[120.797562,14.25312],[120.796822,14.25366],[120.796417,14.25413],[120.795967,14.25481],[120.795403,14.25595],[120.795319,14.2569],[120.795662,14.25829],[120.795952,14.25932],[120.795387,14.26042],[120.794853,14.26151],[120.794067,14.26296],[120.793411,14.26389],[120.792923,14.2645],[120.79171,14.26605],[120.790199,14.26781],[120.789307,14.26891],[120.788406,14.26957],[120.785469,14.27084],[120.783981,14.27122],[120.787018,14.276],[120.789368,14.27823],[120.792053,14.28081],[120.792503,14.28015],[120.793427,14.27897],[120.794434,14.27777]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10560,"NAME_3":"Molino","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.786659,14.29179],[120.787956,14.28963],[120.788612,14.2884],[120.792213,14.28238],[120.792686,14.2815],[120.792053,14.28081],[120.789368,14.27823],[120.787018,14.276],[120.783981,14.27122],[120.7817,14.2724],[120.7799,14.27285],[120.779259,14.27287],[120.778679,14.27272],[120.777924,14.2737],[120.777557,14.2741],[120.776573,14.27447],[120.775352,14.27459],[120.773949,14.27451],[120.772163,14.27538],[120.770981,14.27596],[120.769112,14.27708],[120.768066,14.27766],[120.767036,14.27842],[120.771317,14.2832],[120.77198,14.28391],[120.775574,14.28685],[120.777046,14.28816],[120.779907,14.28971],[120.782082,14.29058],[120.782379,14.29027],[120.783401,14.28984],[120.785629,14.29099],[120.786659,14.29179]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10561,"NAME_3":"Munting Mapino","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.783432,14.3349],[120.77964,14.3313],[120.77916,14.33102],[120.774933,14.32707],[120.773247,14.32551],[120.772591,14.32497],[120.771744,14.32605],[120.77137,14.32683],[120.77076,14.32727],[120.770157,14.32789],[120.769821,14.32828],[120.769722,14.32933],[120.769211,14.33038],[120.768448,14.33105],[120.767776,14.3311],[120.767014,14.33117],[120.765961,14.33096],[120.764732,14.33008],[120.763947,14.33063],[120.764137,14.33066],[120.764526,14.33078],[120.7649,14.33083],[120.765259,14.3309],[120.765602,14.33106],[120.765984,14.33118],[120.766342,14.33134],[120.766762,14.33144],[120.767151,14.33161],[120.767563,14.33169],[120.767937,14.33183],[120.76828,14.33201],[120.768578,14.33226],[120.768837,14.33259],[120.769073,14.33299],[120.769417,14.33334],[120.769791,14.33372],[120.770058,14.33416],[120.770317,14.33464],[120.77066,14.3351],[120.771019,14.33554],[120.77137,14.33595],[120.77166,14.33633],[120.771912,14.33665],[120.772141,14.33694],[120.772346,14.3372],[120.772552,14.33742],[120.772774,14.33763],[120.772972,14.33785],[120.773132,14.33811],[120.773331,14.33833],[120.773529,14.33855],[120.773697,14.33882],[120.773933,14.3391],[120.774178,14.33943],[120.774452,14.33978],[120.77475,14.34015],[120.775047,14.3405],[120.77536,14.34084],[120.775627,14.34119],[120.775887,14.34156],[120.776207,14.3419],[120.776253,14.34193],[120.783432,14.3349]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10562,"NAME_3":"Muzon","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.75473,14.30534],[120.75946,14.2995],[120.760094,14.29865],[120.761482,14.29684],[120.77198,14.28391],[120.771317,14.2832],[120.767036,14.27842],[120.765556,14.27953],[120.763527,14.28064],[120.761757,14.28257],[120.756813,14.28615],[120.752419,14.29057],[120.748428,14.29473],[120.746437,14.29659],[120.753052,14.30365],[120.75473,14.30534]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10563,"NAME_3":"Palangue 1","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.824249,14.28712],[120.824547,14.28576],[120.825531,14.2839],[120.826576,14.28211],[120.827164,14.28046],[120.827538,14.2785],[120.828331,14.27726],[120.829071,14.27591],[120.830704,14.27488],[120.832123,14.27404],[120.83358,14.2724],[120.834877,14.27046],[120.837608,14.26852],[120.84008,14.2674],[120.842598,14.26605],[120.845612,14.26456],[120.845993,14.26402],[120.846367,14.26258],[120.847366,14.26168],[120.84819,14.26081],[120.848877,14.25942],[120.850616,14.25837],[120.851151,14.25713],[120.852226,14.25636],[120.853043,14.25589],[120.85363,14.25501],[120.854843,14.25417],[120.855797,14.25342],[120.856667,14.25242],[120.857269,14.25186],[120.858932,14.25047],[120.860161,14.24863],[120.860924,14.24762],[120.860977,14.24743],[120.861153,14.24699],[120.86116,14.24634],[120.841423,14.24068],[120.840408,14.24005],[120.830116,14.23784],[120.826263,14.24232],[120.820511,14.24925],[120.819832,14.25076],[120.81945,14.25189],[120.818863,14.25252],[120.81781,14.25278],[120.816994,14.25316],[120.816208,14.25375],[120.816132,14.25479],[120.815041,14.25574],[120.814072,14.25646],[120.813477,14.25752],[120.81263,14.25872],[120.812187,14.2584],[120.810783,14.26001],[120.810127,14.26152],[120.809067,14.26174],[120.808327,14.26269],[120.807266,14.26317],[120.805527,14.26521],[120.804764,14.26612],[120.804024,14.26673],[120.802597,14.26735],[120.801849,14.26861],[120.800957,14.26899],[120.800102,14.26998],[120.79953,14.27012],[120.799187,14.27024],[120.798943,14.27116],[120.799072,14.27257],[120.798843,14.27331],[120.798401,14.27377],[120.798431,14.27461],[120.797752,14.2752],[120.796799,14.27539],[120.795692,14.27623],[120.794434,14.27777],[120.799454,14.27923],[120.806091,14.28108],[120.810387,14.28262],[120.811623,14.28306],[120.813179,14.28332],[120.814919,14.28395],[120.820442,14.28561],[120.824249,14.28712]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10564,"NAME_3":"Palangue 2 & 3","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.824249,14.28712],[120.820442,14.28561],[120.814919,14.28395],[120.813179,14.28332],[120.811623,14.28306],[120.810387,14.28262],[120.806091,14.28108],[120.799454,14.27923],[120.794434,14.27777],[120.793427,14.27897],[120.792503,14.28015],[120.792053,14.28081],[120.792686,14.2815],[120.792213,14.28238],[120.798309,14.2857],[120.802063,14.28757],[120.804901,14.28931],[120.806229,14.28998],[120.809769,14.29181],[120.81057,14.29228],[120.813843,14.29398],[120.819939,14.29436],[120.820732,14.2926],[120.821609,14.2913],[120.822838,14.28971],[120.823647,14.28833],[120.824249,14.28712]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10565,"NAME_3":"Sabang","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.788643,14.33889],[120.789307,14.33951],[120.792732,14.34074],[120.794243,14.34066],[120.7957,14.34114],[120.797279,14.34136],[120.799011,14.33994],[120.80159,14.33861],[120.803528,14.3379],[120.803902,14.33652],[120.804771,14.33587],[120.805656,14.33537],[120.806343,14.3347],[120.806549,14.33396],[120.807983,14.33238],[120.809158,14.33198],[120.810867,14.33117],[120.813759,14.32859],[120.813812,14.32728],[120.814857,14.32588],[120.815437,14.32531],[120.816597,14.32479],[120.818443,14.32394],[120.818871,14.32316],[120.819069,14.32229],[120.819817,14.32115],[120.820297,14.32056],[120.820663,14.31985],[120.821167,14.31948],[120.822182,14.31878],[120.822487,14.31704],[120.822533,14.31642],[120.822258,14.31442],[120.822929,14.31309],[120.823288,14.31146],[120.823837,14.30945],[120.82431,14.30771],[120.824966,14.30622],[120.825073,14.30456],[120.824379,14.30272],[120.823463,14.30082],[120.822388,14.29903],[120.821381,14.29831],[120.820297,14.29734],[120.815407,14.3016],[120.814293,14.30287],[120.813179,14.30343],[120.812668,14.3024],[120.811897,14.30196],[120.811562,14.30122],[120.81073,14.30081],[120.809601,14.3011],[120.809677,14.30198],[120.808243,14.30261],[120.807747,14.30351],[120.807037,14.30409],[120.807091,14.3045],[120.805817,14.30476],[120.803978,14.30431],[120.803482,14.30436],[120.802559,14.3051],[120.800812,14.30515],[120.799843,14.30533],[120.799156,14.30575],[120.798843,14.30679],[120.798538,14.30773],[120.797394,14.30863],[120.79641,14.30895],[120.795212,14.30953],[120.795059,14.3103],[120.795502,14.31064],[120.795517,14.31139],[120.794617,14.31257],[120.793159,14.31382],[120.792542,14.31418],[120.791977,14.31496],[120.790672,14.3157],[120.789467,14.31593],[120.788643,14.31569],[120.787987,14.31516],[120.787216,14.31496],[120.78614,14.31564],[120.785332,14.31589],[120.784416,14.31578],[120.783188,14.31485],[120.781914,14.31403],[120.780777,14.31381],[120.780144,14.31417],[120.780212,14.31507],[120.779984,14.31584],[120.779129,14.31653],[120.778267,14.3167],[120.77787,14.31627],[120.777046,14.31609],[120.775398,14.31625],[120.775131,14.31666],[120.775383,14.31703],[120.776016,14.31699],[120.776337,14.31736],[120.77623,14.31799],[120.775726,14.31822],[120.778877,14.32059],[120.780998,14.32235],[120.781349,14.32267],[120.778954,14.32391],[120.77565,14.32507],[120.774567,14.32522],[120.773247,14.32551],[120.774933,14.32707],[120.77916,14.33102],[120.77964,14.3313],[120.783432,14.3349],[120.784019,14.33548],[120.785622,14.33652],[120.788643,14.33889]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10566,"NAME_3":"San Roque","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.781914,14.31403],[120.783188,14.31485],[120.784416,14.31578],[120.785332,14.31589],[120.78614,14.31564],[120.787216,14.31496],[120.787987,14.31516],[120.788643,14.31569],[120.789467,14.31593],[120.790672,14.3157],[120.791977,14.31496],[120.792542,14.31418],[120.793159,14.31382],[120.794617,14.31257],[120.795517,14.31139],[120.795502,14.31064],[120.795059,14.3103],[120.795212,14.30953],[120.79641,14.30895],[120.797394,14.30863],[120.798538,14.30773],[120.798843,14.30679],[120.799156,14.30575],[120.799843,14.30533],[120.800812,14.30515],[120.798698,14.3027],[120.796928,14.30077],[120.795929,14.30115],[120.795471,14.30197],[120.793854,14.30352],[120.792648,14.30341],[120.79213,14.30448],[120.79174,14.30554],[120.791344,14.30624],[120.790604,14.30655],[120.790253,14.30608],[120.789886,14.30639],[120.78952,14.3074],[120.788879,14.30703],[120.788567,14.30743],[120.787827,14.30755],[120.787018,14.30689],[120.786102,14.30674],[120.785881,14.30723],[120.783958,14.30623],[120.783112,14.30549],[120.779778,14.30327],[120.778503,14.30227],[120.777931,14.30307],[120.777603,14.30251],[120.777023,14.30223],[120.776398,14.30275],[120.775917,14.30212],[120.77562,14.30165],[120.775352,14.3017],[120.774811,14.30239],[120.774017,14.30235],[120.774208,14.30345],[120.774361,14.3042],[120.774094,14.30462],[120.773712,14.30503],[120.773613,14.30575],[120.773163,14.30608],[120.772537,14.3066],[120.772362,14.30716],[120.773453,14.30754],[120.776154,14.30884],[120.778137,14.31058],[120.778717,14.31116],[120.779213,14.31167],[120.779716,14.31219],[120.781914,14.31403]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10567,"NAME_3":"Santulan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.768494,14.31254],[120.769661,14.31275],[120.771317,14.31285],[120.774757,14.3131],[120.774963,14.31186],[120.775749,14.3103],[120.776154,14.30884],[120.773453,14.30754],[120.772362,14.30716],[120.771599,14.30837],[120.771317,14.3086],[120.770462,14.30794],[120.769676,14.30846],[120.769203,14.30977],[120.769272,14.31056],[120.769157,14.31145],[120.768593,14.3121],[120.768494,14.31254]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10568,"NAME_3":"Sapa","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.754112,14.32407],[120.754204,14.3242],[120.754471,14.3246],[120.754807,14.32502],[120.755188,14.32543],[120.75563,14.32561],[120.756088,14.32519],[120.756378,14.32468],[120.756508,14.32416],[120.756622,14.32366],[120.756737,14.32314],[120.756866,14.32269],[120.755623,14.32164],[120.755127,14.32243],[120.754112,14.32407]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10569,"NAME_3":"Timalan Balsahan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.776253,14.34193],[120.776588,14.34224],[120.776947,14.3426],[120.777298,14.34298],[120.777634,14.34336],[120.77787,14.34373],[120.778099,14.34394],[120.778259,14.34424],[120.778481,14.34461],[120.77877,14.34497],[120.778938,14.34525],[120.779556,14.34484],[120.780693,14.34406],[120.788643,14.33889],[120.785622,14.33652],[120.784019,14.33548],[120.783432,14.3349],[120.776253,14.34193]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10570,"NAME_3":"Timalan Concepcion","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.778938,14.34525],[120.779007,14.34537],[120.77919,14.34579],[120.779373,14.34617],[120.779533,14.34659],[120.77977,14.34699],[120.780037,14.34738],[120.780357,14.34777],[120.780693,14.34819],[120.78083,14.34833],[120.780563,14.34861],[120.783401,14.34693],[120.783463,14.34691],[120.785927,14.34637],[120.786774,14.34622],[120.788094,14.34523],[120.789192,14.34419],[120.790558,14.3429],[120.792236,14.34101],[120.792732,14.34074],[120.789307,14.33951],[120.788643,14.33889],[120.780693,14.34406],[120.779556,14.34484],[120.778938,14.34525]]]}}]'),LR={type:_W,features:xW},bW=({db:r,showNotification:e})=>{const[t,n]=te.useState([]),[i,s]=te.useState(!0),[o,l]=te.useState(""),u=te.useCallback(async()=>{s(!0),l("");const m=await KC(r);m.success?n(m.data):(l(m.error||"Failed loading advisories."),e(m.error||"Failed loading advisories.","error")),s(!1)},[r,e]);te.useEffect(()=>{u()},[u]);const f=(m,y)=>{if((y==="Emergency Repair"||y==="Leak Detection")&&m!=="Resolved")return{icon:a3,color:"text-red-700",bgColor:"bg-red-50",borderColor:"border-red-400",label:"Emergency"};switch(m){case"Ongoing":return{icon:Qt,color:"text-orange-600",bgColor:"bg-orange-50",borderColor:"border-orange-400",label:"Ongoing"};case"Scheduled":return{icon:As,color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-400",label:"Scheduled"};case"Resolved":return{icon:ks,color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-400",label:"Resolved"};default:return{icon:kn,color:"text-gray-500",bgColor:"bg-gray-50",borderColor:"border-gray-400",label:m||"Unknown"}}};return d.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[d.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[d.jsx(Qt,{size:30,className:"mr-3 text-orange-500"})," Service Advisories"]}),d.jsxs("button",{onClick:u,disabled:i,className:"flex items-center text-sm p-2 bg-gray-100 rounded-lg hover:bg-gray-200 border border-gray-300",children:[i?d.jsx(At,{size:16,className:"animate-spin"}):d.jsx(Ma,{size:16}),d.jsx("span",{className:"ml-1.5 hidden sm:inline",children:"Refresh"})]})]}),i&&d.jsx(pn,{message:"Loading advisories..."}),o&&d.jsx("div",{className:"text-red-600 bg-red-50 p-3 rounded-md text-center border border-red-200",children:o}),!i&&!o&&t.length===0&&d.jsxs("div",{className:"text-center py-10 bg-green-50 p-6 rounded-lg shadow-inner border border-green-200",children:[d.jsx(ks,{size:48,className:"mx-auto text-green-400 mb-4"}),d.jsx("p",{className:"text-gray-700 text-lg font-medium",children:"No Active Service Advisories"}),d.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Water service is currently stable."})]}),!i&&!o&&t.length>0&&d.jsx("div",{className:"space-y-4",children:t.map(m=>{var E;const y=f(m.status,m.type),g=y.icon,_=Do.sanitize(m.description||"");return d.jsxs("details",{className:`p-4 rounded-lg shadow-md border-l-4 group transition-all duration-300 ease-in-out ${y.borderColor} ${y.bgColor} hover:shadow-lg`,children:[d.jsxs("summary",{className:"flex justify-between items-center cursor-pointer list-none",children:[d.jsxs("div",{className:"flex-grow pr-4",children:[d.jsx("h3",{className:"text-md sm:text-lg font-semibold text-gray-800",children:m.title||"Service Advisory"}),d.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["ID: ",m.id.substring(0,8),"..."]})]}),d.jsxs("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full flex items-center shrink-0 ${y.bgColor==="bg-red-50"?"bg-red-100 text-red-700":y.bgColor==="bg-blue-50"?"bg-blue-100 text-blue-700":y.bgColor==="bg-orange-50"?"bg-orange-100 text-orange-700":"bg-green-100 text-green-700"}`,children:[d.jsx(g,{size:14,className:`mr-1.5 ${y.color}`})," ",y.label]}),d.jsx("span",{className:"ml-2 transition-transform duration-300 transform group-open:rotate-180 text-gray-500",children:""})]}),d.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200/80 text-sm text-gray-700 space-y-3 grid grid-rows-[0fr] group-open:grid-rows-[1fr] transition-all duration-500 ease-in-out",children:d.jsxs("div",{className:"overflow-hidden space-y-4",children:[d.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:_}}),d.jsxs("div",{children:[d.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center",children:[d.jsx(Xl,{size:16,className:"mr-2 text-gray-500"}),"Affected Area Map"]}),d.jsx(DR,{geoJsonData:LR,affectedAreas:m.affectedAreas||[]})]}),d.jsxs("div",{className:"text-xs text-gray-600 space-y-1 border-t border-gray-200/80 pt-3 mt-3",children:[d.jsxs("p",{className:"flex items-center",children:[d.jsx(Na,{size:12,className:"mr-1.5 text-gray-400"}),d.jsx("strong",{children:"Affected:"})," ",((E=m.affectedAreas)==null?void 0:E.join(", "))||"N/A"]}),d.jsxs("p",{className:"flex items-center",children:[d.jsx(As,{size:12,className:"mr-1.5 text-gray-400"}),d.jsx("strong",{children:"Start:"})," ",Yt(m.startDate)]}),m.estimatedEndDate&&d.jsxs("p",{className:"flex items-center",children:[d.jsx(As,{size:12,className:"mr-1.5 text-gray-400"}),d.jsx("strong",{children:"Est. End:"})," ",Yt(m.estimatedEndDate)]})]})]})})]},m.id)})})]})},wW=({db:r,showNotification:e})=>{const[t,n]=te.useState([]),[i,s]=te.useState(!0),[o,l]=te.useState(""),u=te.useCallback(async()=>{s(!0),l("");const m=await KC(r);if(m.success){const y=new Set;m.data.forEach(g=>{var _;(_=g.affectedAreas)==null||_.forEach(E=>{y.add(E)})}),n(Array.from(y))}else l(m.error||"Failed loading advisory data."),e(m.error||"Failed loading advisories.","error");s(!1)},[r,e]);te.useEffect(()=>{u()},[u]);const f=te.useMemo(()=>LR,[]);return d.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn h-[calc(100vh-4rem)] flex flex-col",children:[d.jsx("div",{className:"flex justify-between items-center mb-4 pb-4 border-b border-gray-200",children:d.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[d.jsx(Xl,{size:30,className:"mr-3 text-red-600"}),"Active Interruption Map"]})}),i&&d.jsx(pn,{message:"Loading map data..."}),o&&d.jsx("div",{className:"text-red-600 bg-red-50 p-3 rounded-md text-center border border-red-200",children:o}),!i&&!o&&d.jsxs("div",{className:"space-y-4 flex-grow flex flex-col",children:[d.jsxs("p",{className:"text-sm text-gray-600",children:["The map below highlights all areas currently affected by any active service advisory.",t.length===0?" Currently, there are no advisories reporting specific affected areas.":` A total of ${t.length} barangay(s) are affected.`]}),d.jsx("div",{className:"flex-grow w-full rounded-lg overflow-hidden border border-gray-300 shadow-inner",children:d.jsx(DR,{geoJsonData:f,affectedAreas:t,height:"100%"})})]})]})},u4=({onNavigateHome:r})=>d.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-6 bg-gray-50 rounded-lg shadow-md m-4",children:[d.jsx(Q9,{size:48,className:"text-yellow-500 mb-4"}),d.jsx("h1",{className:"text-2xl font-bold text-gray-700 mb-2",children:"404 - Page Not Found"}),d.jsx("p",{className:"text-gray-600 mb-4 max-w-md",children:"The page you are looking for does not exist or has been moved."}),r&&d.jsxs("button",{onClick:r,className:"flex items-center justify-center px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow hover:shadow-md transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50",children:[d.jsx(w2,{size:16,className:"mr-2"}),"Go to Dashboard"]})]}),EW=({isOpen:r,onClose:e,userData:t,showNotification:n,setActiveDashboardSection:i})=>{const s={role:"assistant",text:`Hello, ${(t==null?void 0:t.displayName)||"Valued Customer"}! I am Agie, your AGWA Water Services virtual assistant. How can I help you today with your account (${(t==null?void 0:t.accountNumber)||"N/A"}) or other water service inquiries?`},[o,l]=te.useState([s]),[u,f]=te.useState(""),[m,y]=te.useState(!1),[g,_]=te.useState(!1),[E,x]=te.useState(""),w=te.useRef(null);te.useEffect(()=>{w.current&&(w.current.scrollTop=w.current.scrollHeight)},[o]),te.useEffect(()=>{r&&(l([s]),f(""),y(!1),_(!1),x(""))},[r,t]);const S=async R=>{if(R.preventDefault(),!u.trim()||m)return;const B={role:"user",text:u},P=[...o,B];l(P),f(""),y(!0),_(!1),x("");try{const k=`You are Agie, the friendly and professional AI assistant for AGWA Water Services, a major water utility provider in the Philippines.
Current Customer Details:
- Name: ${t.displayName||"Valued Customer"}
- Account Number: ${t.accountNumber||"Not available"}
- Service Type: ${t.serviceType||"Not specified"}

Your primary goals are:
1.  Understand the customer's query accurately. Queries can be about billing, payments, account management, water quality, leaks, service interruptions, how to use the portal, etc.
2.  Provide clear, concise, helpful, and empathetic responses.
3.  If the query is straightforward and answerable with general knowledge or information commonly found in FAQs (e.g., "how to pay my bill?", "what is FCDA?"), provide the answer.
4.  If the query implies needing specific account data you don't have (e.g., "what was my last payment amount?", "is my meter reading correct for May?"), explain you cannot access real-time specific account details but can guide them to where they might find it in the portal (e.g., "You can check your detailed bill history under 'My Bills' section").
5.  If the customer expresses frustration, has a complex issue (like a persistent leak or no water for an extended time), or directly asks to speak to a human or create a ticket, ALWAYS offer to help them create a support ticket. In this specific scenario, and ONLY in this scenario, end your response with the exact phrase: "WOULD_YOU_LIKE_A_TICKET?".
6.  Do NOT use the phrase "WOULD_YOU_LIKE_A_TICKET?" if you are providing a direct answer or general guidance.
7.  Be polite, patient, and professional. Avoid overly technical jargon unless necessary and explain it if used.
8.  If the user's query is very vague, ask clarifying questions.
9.  Do not make up information or promise actions you cannot perform.
10. Keep responses relatively brief and to the point.

Respond to the customer's latest message based on the conversation history.`,F=await kF(P,k);if(F.includes("WOULD_YOU_LIKE_A_TICKET?")){const j=F.replace("WOULD_YOU_LIKE_A_TICKET?","").trim();l(O=>[...O,{role:"assistant",text:j}]),_(!0)}else l(j=>[...j,{role:"assistant",text:F}])}catch(k){console.error("Chatbot API error:",k);const F="I'm currently experiencing some technical difficulties and can't respond right now. Please try again in a few moments. If the issue persists, you might want to report an issue directly through the portal.";l(j=>[...j,{role:"assistant",text:F}]),x("Failed to get response from assistant.")}finally{y(!1)}},I=()=>{var P;const B=o.slice(-5).map(k=>`${k.role==="user"?t.displayName||"You":"Agie"}: ${k.text}`).join(`

`);localStorage.setItem("chatbotIssueDescription",`Issue raised via Chatbot Agie:

${B}

Initial User Query (if available):
${((P=o.find(k=>k.role==="user"))==null?void 0:P.text)||"User initiated ticket creation from chat."}`),localStorage.setItem("chatbotIssueTypeSuggestion","Chatbot Assistance Follow-up"),e(),i&&i("reportIssue"),n("Please review and submit the support ticket drafted from your chat.","success")},C=["How to pay my bill?","Report a water leak.","My water pressure is low.","What are current announcements?"],N=R=>{f(R)};return d.jsxs(Mr,{isOpen:r,onClose:e,title:"Chat with Agie - Your AGWA Assistant",size:"lg",children:[d.jsx("style",{children:`
                .animate-message-appear {
                    animation: message-appear 0.3s ease-out forwards;
                }
                @keyframes message-appear {
                    from { opacity: 0; transform: translateY(10px) scale(0.98); }
                    to { opacity: 1; transform: translateY(0) scale(1); }
                }
                .chatbot-input-shadow {
                    box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
                }
            `}),d.jsxs("div",{className:"flex flex-col h-[65vh] sm:h-[70vh] bg-gray-50",children:[d.jsxs("div",{ref:w,className:"flex-grow p-4 space-y-4 overflow-y-auto",children:[o.map((R,B)=>{var P;return d.jsxs("div",{className:`flex items-end animate-message-appear ${R.role==="user"?"justify-end":"justify-start"}`,children:[R.role==="assistant"&&d.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-2",children:d.jsx(Os,{size:18})}),d.jsx("div",{className:`max-w-[75%] p-3 rounded-2xl shadow-sm ${R.role==="user"?"bg-blue-600 text-white rounded-br-none":"bg-white text-gray-800 border border-gray-200 rounded-bl-none"}`,children:d.jsx("p",{className:"text-sm whitespace-pre-wrap",children:R.text})}),R.role==="user"&&d.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-gray-300 text-gray-600 flex items-center justify-center ml-2 uppercase",children:((P=t==null?void 0:t.displayName)==null?void 0:P.charAt(0))||"U"})]},B)}),m&&d.jsxs("div",{className:"flex items-end justify-start animate-message-appear",children:[d.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-2",children:d.jsx(Os,{size:18})}),d.jsx("div",{className:"max-w-[75%] p-3 rounded-2xl shadow-sm bg-white text-gray-800 border border-gray-200 rounded-bl-none",children:d.jsx(pn,{size:"h-5 w-5",color:"text-blue-500",message:""})})]}),E&&d.jsxs("div",{className:"flex items-center justify-center p-3 bg-red-50 text-red-700 rounded-lg animate-message-appear",children:[d.jsx(Qt,{size:20,className:"mr-2"}),d.jsx("p",{className:"text-sm",children:E})]})]}),g&&d.jsx("div",{className:"p-3 border-t border-gray-200 bg-white",children:d.jsxs("button",{onClick:I,className:"w-full flex items-center justify-center bg-green-600 hover:bg-green-700 text-white font-semibold py-2.5 px-4 rounded-lg transition-all duration-150 active:scale-95 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50",children:[d.jsx(tF,{size:20,className:"mr-2"})," Create Support Ticket from this Chat"]})}),!g&&o.length<=1&&d.jsx("div",{className:"p-2 border-t border-gray-200 bg-white flex flex-wrap gap-2 justify-center",children:C.map(R=>d.jsx("button",{onClick:()=>N(R),className:"text-xs bg-blue-100 text-blue-700 hover:bg-blue-200 px-3 py-1.5 rounded-full transition-colors",disabled:m,children:R},R))}),d.jsxs("form",{onSubmit:S,className:"p-3 border-t border-gray-200 flex items-center space-x-3 bg-white chatbot-input-shadow",children:[d.jsx("input",{type:"text",value:u,onChange:R=>f(R.target.value),placeholder:"Type your message to Agie...",className:"flex-grow px-4 py-2.5 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-shadow focus:shadow-md text-sm",disabled:m,"aria-label":"Chat input"}),d.jsx("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-xl disabled:opacity-60 disabled:cursor-not-allowed transition-all duration-150 active:scale-90 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50",disabled:m||!u.trim(),"aria-label":"Send message",children:d.jsx(n0,{size:20})})]})]})]})},TW=({isOpen:r,onLink:e,isLinking:t,error:n,onLogout:i})=>{const[s,o]=te.useState("");te.useEffect(()=>{r||o("")},[r]);const l=u=>{u.preventDefault(),s.trim()&&e(s.trim())};return d.jsx(Mr,{isOpen:r,onClose:()=>{},title:"Link Your AGWA Account",hideCloseButton:!0,size:"md",children:d.jsxs("form",{onSubmit:l,className:"space-y-5",children:[d.jsx("p",{className:"text-sm text-center text-gray-600",children:"To access services, please link your official AGWA account number. This is a one-time step for accounts created with Google or an Email Link."}),n&&d.jsx("div",{className:"text-center p-2 bg-red-100 text-red-700 rounded-md text-sm border border-red-200",children:n}),d.jsxs("div",{className:"relative",children:[d.jsx(Cs,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),d.jsx("input",{type:"text",placeholder:"AGWA Account Number (e.g., RES-12345)",value:s,onChange:u=>o(u.target.value),className:`${Mi} pl-11`,required:!0,disabled:t,"aria-label":"AGWA Account Number",autoFocus:!0})]}),d.jsxs("button",{type:"submit",className:Jf(t||!s.trim()),disabled:t||!s.trim(),children:[t?d.jsx(At,{className:"animate-spin inline mr-2",size:18}):d.jsx(E2,{className:"inline mr-2",size:18}),t?"Linking...":"Link My Account"]}),d.jsx("div",{className:"text-center mt-4",children:d.jsxs("button",{type:"button",onClick:i,className:"text-sm font-medium text-gray-500 hover:text-red-600 hover:underline",children:[d.jsx(t0,{size:14,className:"inline mr-1"})," Not you? Logout"]})})]})})},SW=({user:r,userData:e,setUserData:t,handleLogout:n,showNotification:i,auth:s,db:o})=>{const[l,u]=te.useState("mainDashboard"),[f,m]=te.useState(!1),[y,g]=te.useState(!1),[_,E]=te.useState(!1),[x,w]=te.useState(!1),[S,I]=te.useState(""),[C,N]=te.useState(null),[R,B]=te.useState({});te.useEffect(()=>{e&&!e.accountNumber&&e.role==="customer"?E(!0):E(!1)},[e]),te.useEffect(()=>{if(!o)return;const M=$t(o,Im()),$=RC(M,G=>{if(G.exists()){const ie=G.data();B(ie),ie.isBannerEnabled&&ie.portalAnnouncement?N({text:ie.portalAnnouncement}):N(null)}else N(null),B({})},G=>{console.error("Error fetching system settings:",G),N(null),B({})});return()=>$()},[o]);const P=te.useCallback(M=>{u(M),f&&m(!1)},[f]),k=async M=>{w(!0),I("");const $=await e9(o,r.uid,M);if($.success){const G=await iy(o,r.uid);G.success?(t(G.data),E(!1),i("Account linked successfully!","success")):(I("Account linked, but failed to refresh profile. Please reload."),i("Account linked, but failed to refresh profile.","warning"))}else I($.error||"Failed linking account. Check number or contact support.");w(!1)},F={customer:[{name:"Dashboard",iconName:"Home",section:"mainDashboard",group:"Main"},{name:"My Profile",iconName:"UserCog",section:"myProfile",group:"Account"},{name:"My Bills & Payments",iconName:"FileText",section:"myBills",group:"Account"},{name:"Consumption Analytics",iconName:"TrendingUp",section:"waterAnalytics",group:"Account"},{name:"Rewards Program",iconName:"Gift",section:"rebateProgram",group:"Account"},{name:"My Support Tickets",iconName:"MessageSquare",section:"myTickets",group:"Support"},{name:"Report an Issue",iconName:"AlertTriangle",section:"reportIssue",group:"Support"},{name:"View Announcements",iconName:"Megaphone",section:"viewAnnouncements",group:"Information"},{name:"Service Advisories",iconName:"AlertIcon",section:"serviceAdvisories",group:"Information"},{name:"Interruption Map",iconName:"Map",section:"interruptionMap",group:"Information"},{name:"FAQs",iconName:"HelpCircle",section:"faqs",group:"Help & Info"},{name:"About Us",iconName:"Info",section:"aboutUs",group:"Help & Info"},{name:"Contact Us",iconName:"PhoneCall",section:"contactUs",group:"Help & Info"}],admin:[{name:"Dashboard",iconName:"Home",section:"mainDashboard",group:"Main"},{name:"System Analytics",iconName:"BarChart3",section:"systemAnalytics",group:"Main"},{name:"User Management",iconName:"Users",section:"userManagement",group:"Administration"},{name:"Support Tickets",iconName:"MessageSquare",section:"supportTickets",group:"Administration"},{name:"Manage Announcements",iconName:"Edit",section:"manageAnnouncements",group:"Administration"},{name:"Manage Interruptions",iconName:"AlertIcon",section:"manageInterruptions",group:"Administration"},{name:"System Settings",iconName:"Settings",section:"systemSettings",group:"Administration"},{name:"Batch Billing",iconName:"FileText",section:"batchBilling",group:"Operations"},{name:"Meter Reading Mgt.",iconName:"Gauge",section:"editMeterReadingsAdmin",group:"Operations"},{name:"Route Management",iconName:"Map",section:"routeManagement",group:"Operations"},{name:"My Profile",iconName:"UserCog",section:"myProfile",group:"Account"},{name:"Interruption Map",iconName:"Map",section:"interruptionMap",group:"Information"},{name:"FAQs",iconName:"HelpCircle",section:"faqs",group:"Help & Info"},{name:"About Us",iconName:"Info",section:"aboutUs",group:"Help & Info"},{name:"Contact Us",iconName:"PhoneCall",section:"contactUs",group:"Help & Info"}],meter_reader:[{name:"Dashboard",iconName:"Home",section:"mainDashboard",group:"Main"},{name:"Assigned Routes",iconName:"Map",section:"assignedRoutes",group:"Operations"},{name:"Submit Reading",iconName:"ClipboardEdit",section:"searchAndSubmitReading",group:"Operations"},{name:"Search Customer",iconName:"Search",section:"searchCustomerMeterReader",group:"Operations"},{name:"My Profile",iconName:"UserCog",section:"myProfile",group:"Account"},{name:"My Support Tickets",iconName:"MessageSquare",section:"myTickets",group:"Support"},{name:"Report an Issue",iconName:"AlertTriangle",section:"reportIssue",group:"Support"},{name:"View Announcements",iconName:"Megaphone",section:"viewAnnouncements",group:"Information"},{name:"Service Advisories",iconName:"AlertIcon",section:"serviceAdvisories",group:"Information"},{name:"Interruption Map",iconName:"Map",section:"interruptionMap",group:"Information"},{name:"FAQs",iconName:"HelpCircle",section:"faqs",group:"Help & Info"},{name:"Contact Us",iconName:"PhoneCall",section:"contactUs",group:"Help & Info"}],clerk_cashier:[{name:"Dashboard",iconName:"Home",section:"mainDashboard",group:"Main"},{name:"Process Walk-in Payment",iconName:"Banknote",section:"walkInPayments",group:"Operations"},{name:"Search Account / Bill",iconName:"FileSearch",section:"searchAccountOrBill",group:"Operations"},{name:"My Profile",iconName:"UserCog",section:"myProfile",group:"Account"},{name:"My Support Tickets",iconName:"MessageSquare",section:"myTickets",group:"Support"},{name:"Report an Issue",iconName:"AlertTriangle",section:"reportIssue",group:"Support"},{name:"View Announcements",iconName:"Megaphone",section:"viewAnnouncements",group:"Information"},{name:"Service Advisories",iconName:"AlertIcon",section:"serviceAdvisories",group:"Information"},{name:"Interruption Map",iconName:"Map",section:"interruptionMap",group:"Information"},{name:"FAQs",iconName:"HelpCircle",section:"faqs",group:"Help & Info"},{name:"Contact Us",iconName:"PhoneCall",section:"contactUs",group:"Help & Info"}]},j=F[e.role]||F.customer,O=()=>{const M={user:r,userData:e,setUserData:t,auth:s,db:o,showNotification:i,billingService:zC,determineServiceTypeAndRole:p2,setActiveSection:P,systemSettings:R};if(!e||e.role==="customer"&&!e.accountNumber)return null;switch(l){case"mainDashboard":if(e.role==="customer")return d.jsx(RF,{...M});if(e.role==="admin")return d.jsx(Qq,{...M});if(e.role==="meter_reader")return d.jsx(W$,{...M});if(e.role==="clerk_cashier")return d.jsx(Q$,{...M});break;case"myProfile":return d.jsx(Uq,{...M});case"reportIssue":return d.jsx($q,{...M});case"faqs":return d.jsx(Gq,{...M});case"aboutUs":return d.jsx(Kq,{...M});case"contactUs":return d.jsx(Zq,{...M});case"viewAnnouncements":return d.jsx(a4,{...M,viewOnly:!0});case"serviceAdvisories":return d.jsx(bW,{...M});case"interruptionMap":return d.jsx(wW,{...M});case"myBills":if(e.role==="customer")return d.jsx(gV,{...M});break;case"waterAnalytics":if(e.role==="customer")return d.jsx(zq,{...M});break;case"rebateProgram":if(e.role==="customer")return d.jsx(Bq,{...M});break;case"myTickets":if(["customer","clerk_cashier","meter_reader"].includes(e.role))return d.jsx(eW,{...M});break;case"userManagement":if(e.role==="admin")return d.jsx(cH,{...M});break;case"batchBilling":if(e.role==="admin")return d.jsx($$,{...M});break;case"routeManagement":if(e.role==="admin")return d.jsx(H$,{...M});break;case"supportTickets":if(e.role==="admin")return d.jsx(R$,{...M});break;case"manageAnnouncements":if(e.role==="admin")return d.jsx(a4,{...M,viewOnly:!1});break;case"manageInterruptions":if(e.role==="admin")return d.jsx(F$,{...M});break;case"systemAnalytics":if(e.role==="admin")return d.jsx(z$,{...M});break;case"editMeterReadingsAdmin":if(e.role==="admin")return d.jsx(U$,{...M});break;case"systemSettings":if(e.role==="admin")return d.jsx(j$,{...M});break;case"assignedRoutes":if(e.role==="meter_reader")return d.jsx(K$,{...M});break;case"searchAndSubmitReading":if(e.role==="meter_reader")return d.jsx(NR,{...M});break;case"searchCustomerMeterReader":if(e.role==="meter_reader")return d.jsx(Z$,{...M});break;case"walkInPayments":if(e.role==="clerk_cashier")return d.jsx(X$,{...M});break;case"searchAccountOrBill":if(e.role==="clerk_cashier")return d.jsx(J$,{...M});break;default:return d.jsx(u4,{onNavigateHome:()=>P("mainDashboard")})}return d.jsx(u4,{onNavigateHome:()=>P("mainDashboard")})},D=l==="interruptionMap"?"p-0":"p-4 sm:p-6 lg:p-8";return d.jsxs("div",{className:"bg-gray-100 font-sans min-h-screen",children:[d.jsx(IF,{userData:e,navItems:j,activeSection:l,onNavigate:P,onLogout:n,isMobileOpen:f,setMobileOpen:m}),d.jsxs("div",{className:"lg:pl-64 flex flex-col min-h-screen print:pl-0",children:[d.jsxs("header",{className:"sticky top-0 z-30 flex items-center justify-between bg-white/80 backdrop-blur-lg shadow-sm p-3 lg:hidden no-print",children:[d.jsx("button",{onClick:()=>m(!0),className:"text-gray-600 hover:text-gray-900 p-1",children:d.jsx(aF,{size:28})}),d.jsx("h1",{className:"text-lg font-semibold text-blue-700",children:"AGWA Portal"}),d.jsx("div",{className:"w-8"})]}),C&&d.jsx("div",{className:"bg-yellow-400 text-center p-2 text-yellow-900 font-semibold shadow-md text-sm sticky top-[57px] z-20 lg:top-0 no-print",children:C.text}),d.jsx("main",{className:`${D} flex-grow ${C?"pt-2":""} print:p-4`,children:O()})]}),e&&R.isChatbotEnabled&&d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:()=>g(!0),className:"fixed bottom-6 right-6 bg-blue-600 hover:bg-blue-700 text-white rounded-full p-4 shadow-lg transform hover:scale-110 transition-transform duration-200 ease-in-out z-40 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2 no-print","aria-label":"Open Chatbot",children:d.jsx(ka,{size:28})}),y&&d.jsx(EW,{isOpen:y,onClose:()=>g(!1),userData:e,showNotification:i,setActiveDashboardSection:P})]}),e&&e.role==="customer"&&!e.accountNumber&&d.jsx(TW,{isOpen:_,onLink:k,isLinking:x,error:S,onLogout:n})]})},AW=()=>d.jsxs("div",{className:"min-h-screen bg-gray-900 text-white flex flex-col justify-center items-center p-4 text-center",children:[d.jsx(rF,{size:64,className:"text-yellow-400 mb-4 animate-bounce"}),d.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Under Maintenance"}),d.jsx("p",{className:"text-gray-400",children:"The AGWA portal is currently undergoing maintenance."}),d.jsx("p",{className:"text-gray-400",children:"We expect to be back online shortly."})]}),IW=({error:r,onLogout:e})=>d.jsxs("div",{className:"min-h-screen bg-red-50 flex flex-col justify-center items-center p-4 text-center",children:[d.jsx(Qt,{size:48,className:"text-red-500 mb-4"}),d.jsx("h1",{className:"text-2xl font-bold text-red-700 mb-2",children:"Application Error"}),d.jsx("p",{className:"text-gray-700 mb-4 max-w-md",children:"An error occurred while loading your data:"}),d.jsx("p",{className:"text-sm text-red-600 bg-red-100 p-3 rounded mb-4 max-w-xl text-left font-mono break-words",children:r}),d.jsx("p",{className:"text-gray-600 mb-4",children:"Please try refreshing the page. If the problem persists, contact support."}),e&&d.jsxs("button",{onClick:e,className:"mt-4 flex items-center justify-center px-5 py-2.5 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg shadow",children:[d.jsx(t0,{size:16,className:"mr-2"}),"Logout and Try Again"]})]}),NW=()=>{const[r,e]=te.useState("initializing"),[t,n]=te.useState(null),[i,s]=te.useState(null),[o,l]=te.useState(null),[u,f]=te.useState(null),[m,y]=te.useState(null),[g,_]=te.useState(!1),[E,x]=te.useState(""),[w,S]=te.useState("login"),[I,C]=te.useState({message:"",type:""}),N=te.useCallback(($,G="info")=>{C({message:$,type:G}),setTimeout(()=>C({message:"",type:""}),5e3)},[]),R=te.useCallback(()=>C({message:"",type:""}),[]);te.useEffect(()=>{const $=$t(Jt,Im()),G=RC($,oe=>{f(oe.exists()?oe.data():{maintenanceMode:!1}),y(null)},oe=>{console.error("Critical Error: Failed to fetch system settings:",oe),y(`Failed to load config: ${oe.message}. Maintenance mode assumed off.`),f({maintenanceMode:!1})}),ie=gj(Lh,async oe=>{if(l(null),s(null),n(oe),oe){e("loading_profile");try{const ee=await iy(Jt,oe.uid);if(ee.success&&ee.data)s(ee.data),e("app_ready");else if(ee.error&&ee.error.includes("not found")){const J=oe.providerData.some(Z=>Z.providerId==="password");let Y;if(J){const Z=localStorage.getItem("signupDisplayName")||oe.email||"New User",ne=localStorage.getItem("signupAccountNumber")||"";localStorage.removeItem("signupDisplayName"),localStorage.removeItem("signupAccountNumber");const{role:se,serviceType:le}=p2(ne);Y={email:oe.email||"",phoneNumber:oe.phoneNumber||"",displayName:Z,accountNumber:ne,role:se,serviceType:le,accountStatus:"Active",photoURL:oe.photoURL||""}}else Y={email:oe.email||"",phoneNumber:oe.phoneNumber||"",displayName:oe.displayName||oe.email||"New User",accountNumber:"",role:"customer",serviceType:"Residential",accountStatus:"Active",photoURL:oe.photoURL||""};const q=await m9(Jt,oe.uid,Y);if(q.success){const Z=await iy(Jt,oe.uid);if(Z.success&&Z.data)s(Z.data),e("app_ready");else throw new Error(Z.error||"Failed to fetch newly created profile.")}else throw new Error(q.error||"Failed to auto-create user profile.")}else throw new Error(ee.error||"Failed to get user profile data.")}catch(ee){console.error("Profile handling error:",ee),l(`Profile Error: ${ee.message}`),e("error"),s(null)}}else e("auth_required"),S("login")});return()=>{ie(),G()}},[]);const B=te.useCallback($=>{x(""),S($)},[]),P=async($,...G)=>{_(!0),x("");let ie={success:!1,error:"An unexpected error occurred."};try{ie=await $(Lh,...G),!ie.success&&ie.error&&x(ie.error)}catch(oe){const ee=cc(oe);x(ee),ie={success:!1,error:ee}}finally{_(!1)}return ie},k=($,G)=>P(F8,$,G),F=()=>P(V8),j=async()=>{e("initializing"),await P(q8)},O=async($,G,ie,oe)=>{localStorage.setItem("signupDisplayName",ie),localStorage.setItem("signupAccountNumber",oe),await P(L8,$,G)},D=async $=>{const G=await P(U8,$);return G.success&&N(G.message||"Password reset email sent!","success"),G.success},M=async $=>{const G={url:window.location.origin,handleCodeInApp:!0},ie=await P(z8,$,G);return ie.success&&N(ie.message||`Sign-in link sent to ${$}!`,"success"),ie};if(te.useEffect(()=>{(async()=>{if(!Lh)return;const G=window.location.href;if(X4(Lh,G)){let ie=window.localStorage.getItem("emailForSignIn");ie||(ie=window.prompt("Confirm your email for sign-in:")),ie?(e("initializing"),await P(B8,ie,G),window.history.replaceState(null,"",window.location.origin)):(N("Email required for link sign-in.","error"),window.history.replaceState(null,"",window.location.origin),e("auth_required"))}})()},[P,N]),r==="initializing"||r==="loading_profile"){const $=r==="initializing"?"Initializing Session...":"Loading Profile...";return d.jsx(HS,{loadingMessage:$})}if(r==="error")return d.jsx(IW,{error:o||m||"Unknown application error.",onLogout:j});if(r==="app_ready"&&t&&i)return u!=null&&u.maintenanceMode&&(i==null?void 0:i.role)!=="admin"?d.jsx(AW,{}):d.jsxs(d.Fragment,{children:[d.jsx(SW,{user:t,userData:i,setUserData:s,handleLogout:j,showNotification:N,auth:Lh,db:Jt}),d.jsx(jx,{message:I.message,type:I.type,onClose:R})]});if(r==="auth_required"){const $=u||{maintenanceMode:!1},G={login:d.jsx(wF,{handleLoginExternal:k,handleGoogleSignIn:F,navigateTo:B,authActionLoading:g,setAuthError:x,systemSettings:$}),signup:d.jsx(EF,{handleSignupExternal:O,handleGoogleSignIn:F,navigateTo:B,authActionLoading:g,setAuthError:x,showNotification:N,systemSettings:$}),forgotPassword:d.jsx(TF,{handleForgotPasswordExternal:D,navigateTo:B,authActionLoading:g}),passwordlessLogin:d.jsx(SF,{handlePasswordlessSignInExternal:M,navigateTo:B,authActionLoading:g})};return d.jsxs(d.Fragment,{children:[d.jsx(l3,{authError:E||m,systemSettings:$,children:G[w]||G.login}),d.jsx(jx,{message:I.message,type:I.type,onClose:R})]})}return d.jsx(HS,{loadingMessage:"Unexpected Application State"})};class kW extends is.Component{constructor(t){super(t);Xe(this,"handleRetry",()=>{this.setState({hasError:!1,error:null,errorInfo:null,errorId:Date.now()}),this.props.onRetry?this.props.onRetry():window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null,errorId:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,n){console.error("Uncaught error:",t,n),this.setState({errorInfo:n,errorId:Date.now()})}render(){var t,n;if(this.state.hasError){const{fallback:i}=this.props;return i&&typeof i=="function"?i({error:this.state.error,errorInfo:this.state.errorInfo,retry:this.handleRetry}):is.isValidElement(i)?i:d.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen text-center p-6 bg-red-50",role:"alert",children:[d.jsx(t3,{size:48,className:"text-red-500 mb-4"}),d.jsx("h1",{className:"text-2xl font-bold text-red-700 mb-2",children:"Oops! Something went wrong."}),d.jsx("p",{className:"text-gray-700 mb-4 max-w-md",children:"We encountered an unexpected issue. Please try again. If the problem persists, contact support."}),d.jsxs("details",{className:"mb-4 p-3 bg-red-100 text-left text-xs text-red-800 rounded-md w-full max-w-2xl overflow-auto",children:[d.jsx("summary",{className:"font-semibold cursor-pointer",children:"Error Details"}),d.jsxs("pre",{className:"mt-2 whitespace-pre-wrap",children:[(t=this.state.error)==null?void 0:t.toString(),((n=this.state.errorInfo)==null?void 0:n.componentStack)&&`

Component Stack:
${this.state.errorInfo.componentStack}`]})]}),d.jsxs("button",{onClick:this.handleRetry,className:"flex items-center justify-center px-5 py-2.5 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg shadow hover:shadow-md transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50",children:[d.jsx(dF,{size:16,className:"mr-2"}),"Try Again"]}),this.props.showSupportInfo&&d.jsxs("p",{className:"text-xs text-gray-500 mt-6",children:["Error ID: ",this.state.errorId||"N/A",". Please include this ID if you contact support."]})]})}return this.props.children}}k5.createRoot(document.getElementById("root")).render(d.jsx(is.StrictMode,{children:d.jsx(kW,{children:d.jsx(NW,{})})}));
