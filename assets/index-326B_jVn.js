var x5=Object.defineProperty;var b5=(r,e,t)=>e in r?x5(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t;var Je=(r,e,t)=>b5(r,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(i){if(i.ep)return;i.ep=!0;const s=t(i);fetch(i.href,s)}})();var Np=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Qx(r){return r&&r.__esModule&&Object.prototype.hasOwnProperty.call(r,"default")?r.default:r}var Av={exports:{}},Dh={},Nv={exports:{}},Ft={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ME;function w5(){if(ME)return Ft;ME=1;var r=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),s=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),y=Symbol.iterator;function g(B){return B===null||typeof B!="object"?null:(B=y&&B[y]||B["@@iterator"],typeof B=="function"?B:null)}var _={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},E=Object.assign,x={};function b(B,G,X){this.props=B,this.context=G,this.refs=x,this.updater=X||_}b.prototype.isReactComponent={},b.prototype.setState=function(B,G){if(typeof B!="object"&&typeof B!="function"&&B!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,B,G,"setState")},b.prototype.forceUpdate=function(B){this.updater.enqueueForceUpdate(this,B,"forceUpdate")};function T(){}T.prototype=b.prototype;function N(B,G,X){this.props=B,this.context=G,this.refs=x,this.updater=X||_}var R=N.prototype=new T;R.constructor=N,E(R,b.prototype),R.isPureReactComponent=!0;var I=Array.isArray,j=Object.prototype.hasOwnProperty,U={current:null},C={key:!0,ref:!0,__self:!0,__source:!0};function k(B,G,X){var se,le={},Q=null,ce=null;if(G!=null)for(se in G.ref!==void 0&&(ce=G.ref),G.key!==void 0&&(Q=""+G.key),G)j.call(G,se)&&!C.hasOwnProperty(se)&&(le[se]=G[se]);var ue=arguments.length-2;if(ue===1)le.children=X;else if(1<ue){for(var fe=Array(ue),_e=0;_e<ue;_e++)fe[_e]=arguments[_e+2];le.children=fe}if(B&&B.defaultProps)for(se in ue=B.defaultProps,ue)le[se]===void 0&&(le[se]=ue[se]);return{$$typeof:r,type:B,key:Q,ref:ce,props:le,_owner:U.current}}function D(B,G){return{$$typeof:r,type:B.type,key:G,ref:B.ref,props:B.props,_owner:B._owner}}function O(B){return typeof B=="object"&&B!==null&&B.$$typeof===r}function P(B){var G={"=":"=0",":":"=2"};return"$"+B.replace(/[=:]/g,function(X){return G[X]})}var F=/\/+/g;function M(B,G){return typeof B=="object"&&B!==null&&B.key!=null?P(""+B.key):G.toString(36)}function $(B,G,X,se,le){var Q=typeof B;(Q==="undefined"||Q==="boolean")&&(B=null);var ce=!1;if(B===null)ce=!0;else switch(Q){case"string":case"number":ce=!0;break;case"object":switch(B.$$typeof){case r:case e:ce=!0}}if(ce)return ce=B,le=le(ce),B=se===""?"."+M(ce,0):se,I(le)?(X="",B!=null&&(X=B.replace(F,"$&/")+"/"),$(le,G,X,"",function(_e){return _e})):le!=null&&(O(le)&&(le=D(le,X+(!le.key||ce&&ce.key===le.key?"":(""+le.key).replace(F,"$&/")+"/")+B)),G.push(le)),1;if(ce=0,se=se===""?".":se+":",I(B))for(var ue=0;ue<B.length;ue++){Q=B[ue];var fe=se+M(Q,ue);ce+=$(Q,G,X,fe,le)}else if(fe=g(B),typeof fe=="function")for(B=fe.call(B),ue=0;!(Q=B.next()).done;)Q=Q.value,fe=se+M(Q,ue++),ce+=$(Q,G,X,fe,le);else if(Q==="object")throw G=String(B),Error("Objects are not valid as a React child (found: "+(G==="[object Object]"?"object with keys {"+Object.keys(B).join(", ")+"}":G)+"). If you meant to render a collection of children, use an array instead.");return ce}function Y(B,G,X){if(B==null)return B;var se=[],le=0;return $(B,se,"","",function(Q){return G.call(X,Q,le++)}),se}function te(B){if(B._status===-1){var G=B._result;G=G(),G.then(function(X){(B._status===0||B._status===-1)&&(B._status=1,B._result=X)},function(X){(B._status===0||B._status===-1)&&(B._status=2,B._result=X)}),B._status===-1&&(B._status=0,B._result=G)}if(B._status===1)return B._result.default;throw B._result}var oe={current:null},ie={transition:null},ne={ReactCurrentDispatcher:oe,ReactCurrentBatchConfig:ie,ReactCurrentOwner:U};function K(){throw Error("act(...) is not supported in production builds of React.")}return Ft.Children={map:Y,forEach:function(B,G,X){Y(B,function(){G.apply(this,arguments)},X)},count:function(B){var G=0;return Y(B,function(){G++}),G},toArray:function(B){return Y(B,function(G){return G})||[]},only:function(B){if(!O(B))throw Error("React.Children.only expected to receive a single React element child.");return B}},Ft.Component=b,Ft.Fragment=t,Ft.Profiler=i,Ft.PureComponent=N,Ft.StrictMode=n,Ft.Suspense=d,Ft.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ne,Ft.act=K,Ft.cloneElement=function(B,G,X){if(B==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+B+".");var se=E({},B.props),le=B.key,Q=B.ref,ce=B._owner;if(G!=null){if(G.ref!==void 0&&(Q=G.ref,ce=U.current),G.key!==void 0&&(le=""+G.key),B.type&&B.type.defaultProps)var ue=B.type.defaultProps;for(fe in G)j.call(G,fe)&&!C.hasOwnProperty(fe)&&(se[fe]=G[fe]===void 0&&ue!==void 0?ue[fe]:G[fe])}var fe=arguments.length-2;if(fe===1)se.children=X;else if(1<fe){ue=Array(fe);for(var _e=0;_e<fe;_e++)ue[_e]=arguments[_e+2];se.children=ue}return{$$typeof:r,type:B.type,key:le,ref:Q,props:se,_owner:ce}},Ft.createContext=function(B){return B={$$typeof:o,_currentValue:B,_currentValue2:B,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},B.Provider={$$typeof:s,_context:B},B.Consumer=B},Ft.createElement=k,Ft.createFactory=function(B){var G=k.bind(null,B);return G.type=B,G},Ft.createRef=function(){return{current:null}},Ft.forwardRef=function(B){return{$$typeof:l,render:B}},Ft.isValidElement=O,Ft.lazy=function(B){return{$$typeof:m,_payload:{_status:-1,_result:B},_init:te}},Ft.memo=function(B,G){return{$$typeof:f,type:B,compare:G===void 0?null:G}},Ft.startTransition=function(B){var G=ie.transition;ie.transition={};try{B()}finally{ie.transition=G}},Ft.unstable_act=K,Ft.useCallback=function(B,G){return oe.current.useCallback(B,G)},Ft.useContext=function(B){return oe.current.useContext(B)},Ft.useDebugValue=function(){},Ft.useDeferredValue=function(B){return oe.current.useDeferredValue(B)},Ft.useEffect=function(B,G){return oe.current.useEffect(B,G)},Ft.useId=function(){return oe.current.useId()},Ft.useImperativeHandle=function(B,G,X){return oe.current.useImperativeHandle(B,G,X)},Ft.useInsertionEffect=function(B,G){return oe.current.useInsertionEffect(B,G)},Ft.useLayoutEffect=function(B,G){return oe.current.useLayoutEffect(B,G)},Ft.useMemo=function(B,G){return oe.current.useMemo(B,G)},Ft.useReducer=function(B,G,X){return oe.current.useReducer(B,G,X)},Ft.useRef=function(B){return oe.current.useRef(B)},Ft.useState=function(B){return oe.current.useState(B)},Ft.useSyncExternalStore=function(B,G,X){return oe.current.useSyncExternalStore(B,G,X)},Ft.useTransition=function(){return oe.current.useTransition()},Ft.version="18.3.1",Ft}var DE;function vy(){return DE||(DE=1,Nv.exports=w5()),Nv.exports}/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LE;function E5(){if(LE)return Dh;LE=1;var r=vy(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),n=Object.prototype.hasOwnProperty,i=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function o(l,d,f){var m,y={},g=null,_=null;f!==void 0&&(g=""+f),d.key!==void 0&&(g=""+d.key),d.ref!==void 0&&(_=d.ref);for(m in d)n.call(d,m)&&!s.hasOwnProperty(m)&&(y[m]=d[m]);if(l&&l.defaultProps)for(m in d=l.defaultProps,d)y[m]===void 0&&(y[m]=d[m]);return{$$typeof:e,type:l,key:g,ref:_,props:y,_owner:i.current}}return Dh.Fragment=t,Dh.jsx=o,Dh.jsxs=o,Dh}var FE;function S5(){return FE||(FE=1,Av.exports=E5()),Av.exports}var u=S5(),J=vy();const ss=Qx(J);var Ip={},Iv={exports:{}},Mi={},kv={exports:{}},Pv={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VE;function T5(){return VE||(VE=1,function(r){function e(ie,ne){var K=ie.length;ie.push(ne);e:for(;0<K;){var B=K-1>>>1,G=ie[B];if(0<i(G,ne))ie[B]=ne,ie[K]=G,K=B;else break e}}function t(ie){return ie.length===0?null:ie[0]}function n(ie){if(ie.length===0)return null;var ne=ie[0],K=ie.pop();if(K!==ne){ie[0]=K;e:for(var B=0,G=ie.length,X=G>>>1;B<X;){var se=2*(B+1)-1,le=ie[se],Q=se+1,ce=ie[Q];if(0>i(le,K))Q<G&&0>i(ce,le)?(ie[B]=ce,ie[Q]=K,B=Q):(ie[B]=le,ie[se]=K,B=se);else if(Q<G&&0>i(ce,K))ie[B]=ce,ie[Q]=K,B=Q;else break e}}return ne}function i(ie,ne){var K=ie.sortIndex-ne.sortIndex;return K!==0?K:ie.id-ne.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;r.unstable_now=function(){return s.now()}}else{var o=Date,l=o.now();r.unstable_now=function(){return o.now()-l}}var d=[],f=[],m=1,y=null,g=3,_=!1,E=!1,x=!1,b=typeof setTimeout=="function"?setTimeout:null,T=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function R(ie){for(var ne=t(f);ne!==null;){if(ne.callback===null)n(f);else if(ne.startTime<=ie)n(f),ne.sortIndex=ne.expirationTime,e(d,ne);else break;ne=t(f)}}function I(ie){if(x=!1,R(ie),!E)if(t(d)!==null)E=!0,te(j);else{var ne=t(f);ne!==null&&oe(I,ne.startTime-ie)}}function j(ie,ne){E=!1,x&&(x=!1,T(k),k=-1),_=!0;var K=g;try{for(R(ne),y=t(d);y!==null&&(!(y.expirationTime>ne)||ie&&!P());){var B=y.callback;if(typeof B=="function"){y.callback=null,g=y.priorityLevel;var G=B(y.expirationTime<=ne);ne=r.unstable_now(),typeof G=="function"?y.callback=G:y===t(d)&&n(d),R(ne)}else n(d);y=t(d)}if(y!==null)var X=!0;else{var se=t(f);se!==null&&oe(I,se.startTime-ne),X=!1}return X}finally{y=null,g=K,_=!1}}var U=!1,C=null,k=-1,D=5,O=-1;function P(){return!(r.unstable_now()-O<D)}function F(){if(C!==null){var ie=r.unstable_now();O=ie;var ne=!0;try{ne=C(!0,ie)}finally{ne?M():(U=!1,C=null)}}else U=!1}var M;if(typeof N=="function")M=function(){N(F)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,Y=$.port2;$.port1.onmessage=F,M=function(){Y.postMessage(null)}}else M=function(){b(F,0)};function te(ie){C=ie,U||(U=!0,M())}function oe(ie,ne){k=b(function(){ie(r.unstable_now())},ne)}r.unstable_IdlePriority=5,r.unstable_ImmediatePriority=1,r.unstable_LowPriority=4,r.unstable_NormalPriority=3,r.unstable_Profiling=null,r.unstable_UserBlockingPriority=2,r.unstable_cancelCallback=function(ie){ie.callback=null},r.unstable_continueExecution=function(){E||_||(E=!0,te(j))},r.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<ie?Math.floor(1e3/ie):5},r.unstable_getCurrentPriorityLevel=function(){return g},r.unstable_getFirstCallbackNode=function(){return t(d)},r.unstable_next=function(ie){switch(g){case 1:case 2:case 3:var ne=3;break;default:ne=g}var K=g;g=ne;try{return ie()}finally{g=K}},r.unstable_pauseExecution=function(){},r.unstable_requestPaint=function(){},r.unstable_runWithPriority=function(ie,ne){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var K=g;g=ie;try{return ne()}finally{g=K}},r.unstable_scheduleCallback=function(ie,ne,K){var B=r.unstable_now();switch(typeof K=="object"&&K!==null?(K=K.delay,K=typeof K=="number"&&0<K?B+K:B):K=B,ie){case 1:var G=-1;break;case 2:G=250;break;case 5:G=1073741823;break;case 4:G=1e4;break;default:G=5e3}return G=K+G,ie={id:m++,callback:ne,priorityLevel:ie,startTime:K,expirationTime:G,sortIndex:-1},K>B?(ie.sortIndex=K,e(f,ie),t(d)===null&&ie===t(f)&&(x?(T(k),k=-1):x=!0,oe(I,K-B))):(ie.sortIndex=G,e(d,ie),E||_||(E=!0,te(j))),ie},r.unstable_shouldYield=P,r.unstable_wrapCallback=function(ie){var ne=g;return function(){var K=g;g=ne;try{return ie.apply(this,arguments)}finally{g=K}}}}(Pv)),Pv}var zE;function A5(){return zE||(zE=1,kv.exports=T5()),kv.exports}/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BE;function N5(){if(BE)return Mi;BE=1;var r=vy(),e=A5();function t(a){for(var h="https://reactjs.org/docs/error-decoder.html?invariant="+a,v=1;v<arguments.length;v++)h+="&args[]="+encodeURIComponent(arguments[v]);return"Minified React error #"+a+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=new Set,i={};function s(a,h){o(a,h),o(a+"Capture",h)}function o(a,h){for(i[a]=h,a=0;a<h.length;a++)n.add(h[a])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),d=Object.prototype.hasOwnProperty,f=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,m={},y={};function g(a){return d.call(y,a)?!0:d.call(m,a)?!1:f.test(a)?y[a]=!0:(m[a]=!0,!1)}function _(a,h,v,A){if(v!==null&&v.type===0)return!1;switch(typeof h){case"function":case"symbol":return!0;case"boolean":return A?!1:v!==null?!v.acceptsBooleans:(a=a.toLowerCase().slice(0,5),a!=="data-"&&a!=="aria-");default:return!1}}function E(a,h,v,A){if(h===null||typeof h>"u"||_(a,h,v,A))return!0;if(A)return!1;if(v!==null)switch(v.type){case 3:return!h;case 4:return h===!1;case 5:return isNaN(h);case 6:return isNaN(h)||1>h}return!1}function x(a,h,v,A,z,H,ee){this.acceptsBooleans=h===2||h===3||h===4,this.attributeName=A,this.attributeNamespace=z,this.mustUseProperty=v,this.propertyName=a,this.type=h,this.sanitizeURL=H,this.removeEmptyString=ee}var b={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(a){b[a]=new x(a,0,!1,a,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(a){var h=a[0];b[h]=new x(h,1,!1,a[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(a){b[a]=new x(a,2,!1,a.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(a){b[a]=new x(a,2,!1,a,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(a){b[a]=new x(a,3,!1,a.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(a){b[a]=new x(a,3,!0,a,null,!1,!1)}),["capture","download"].forEach(function(a){b[a]=new x(a,4,!1,a,null,!1,!1)}),["cols","rows","size","span"].forEach(function(a){b[a]=new x(a,6,!1,a,null,!1,!1)}),["rowSpan","start"].forEach(function(a){b[a]=new x(a,5,!1,a.toLowerCase(),null,!1,!1)});var T=/[\-:]([a-z])/g;function N(a){return a[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(a){var h=a.replace(T,N);b[h]=new x(h,1,!1,a,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(a){var h=a.replace(T,N);b[h]=new x(h,1,!1,a,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(a){var h=a.replace(T,N);b[h]=new x(h,1,!1,a,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(a){b[a]=new x(a,1,!1,a.toLowerCase(),null,!1,!1)}),b.xlinkHref=new x("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(a){b[a]=new x(a,1,!1,a.toLowerCase(),null,!0,!0)});function R(a,h,v,A){var z=b.hasOwnProperty(h)?b[h]:null;(z!==null?z.type!==0:A||!(2<h.length)||h[0]!=="o"&&h[0]!=="O"||h[1]!=="n"&&h[1]!=="N")&&(E(h,v,z,A)&&(v=null),A||z===null?g(h)&&(v===null?a.removeAttribute(h):a.setAttribute(h,""+v)):z.mustUseProperty?a[z.propertyName]=v===null?z.type===3?!1:"":v:(h=z.attributeName,A=z.attributeNamespace,v===null?a.removeAttribute(h):(z=z.type,v=z===3||z===4&&v===!0?"":""+v,A?a.setAttributeNS(A,h,v):a.setAttribute(h,v))))}var I=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,j=Symbol.for("react.element"),U=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),D=Symbol.for("react.profiler"),O=Symbol.for("react.provider"),P=Symbol.for("react.context"),F=Symbol.for("react.forward_ref"),M=Symbol.for("react.suspense"),$=Symbol.for("react.suspense_list"),Y=Symbol.for("react.memo"),te=Symbol.for("react.lazy"),oe=Symbol.for("react.offscreen"),ie=Symbol.iterator;function ne(a){return a===null||typeof a!="object"?null:(a=ie&&a[ie]||a["@@iterator"],typeof a=="function"?a:null)}var K=Object.assign,B;function G(a){if(B===void 0)try{throw Error()}catch(v){var h=v.stack.trim().match(/\n( *(at )?)/);B=h&&h[1]||""}return`
`+B+a}var X=!1;function se(a,h){if(!a||X)return"";X=!0;var v=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(h)if(h=function(){throw Error()},Object.defineProperty(h.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(h,[])}catch(Se){var A=Se}Reflect.construct(a,[],h)}else{try{h.call()}catch(Se){A=Se}a.call(h.prototype)}else{try{throw Error()}catch(Se){A=Se}a()}}catch(Se){if(Se&&A&&typeof Se.stack=="string"){for(var z=Se.stack.split(`
`),H=A.stack.split(`
`),ee=z.length-1,de=H.length-1;1<=ee&&0<=de&&z[ee]!==H[de];)de--;for(;1<=ee&&0<=de;ee--,de--)if(z[ee]!==H[de]){if(ee!==1||de!==1)do if(ee--,de--,0>de||z[ee]!==H[de]){var me=`
`+z[ee].replace(" at new "," at ");return a.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",a.displayName)),me}while(1<=ee&&0<=de);break}}}finally{X=!1,Error.prepareStackTrace=v}return(a=a?a.displayName||a.name:"")?G(a):""}function le(a){switch(a.tag){case 5:return G(a.type);case 16:return G("Lazy");case 13:return G("Suspense");case 19:return G("SuspenseList");case 0:case 2:case 15:return a=se(a.type,!1),a;case 11:return a=se(a.type.render,!1),a;case 1:return a=se(a.type,!0),a;default:return""}}function Q(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case C:return"Fragment";case U:return"Portal";case D:return"Profiler";case k:return"StrictMode";case M:return"Suspense";case $:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case P:return(a.displayName||"Context")+".Consumer";case O:return(a._context.displayName||"Context")+".Provider";case F:var h=a.render;return a=a.displayName,a||(a=h.displayName||h.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case Y:return h=a.displayName||null,h!==null?h:Q(a.type)||"Memo";case te:h=a._payload,a=a._init;try{return Q(a(h))}catch{}}return null}function ce(a){var h=a.type;switch(a.tag){case 24:return"Cache";case 9:return(h.displayName||"Context")+".Consumer";case 10:return(h._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=h.render,a=a.displayName||a.name||"",h.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return h;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Q(h);case 8:return h===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h}return null}function ue(a){switch(typeof a){case"boolean":case"number":case"string":case"undefined":return a;case"object":return a;default:return""}}function fe(a){var h=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function _e(a){var h=fe(a)?"checked":"value",v=Object.getOwnPropertyDescriptor(a.constructor.prototype,h),A=""+a[h];if(!a.hasOwnProperty(h)&&typeof v<"u"&&typeof v.get=="function"&&typeof v.set=="function"){var z=v.get,H=v.set;return Object.defineProperty(a,h,{configurable:!0,get:function(){return z.call(this)},set:function(ee){A=""+ee,H.call(this,ee)}}),Object.defineProperty(a,h,{enumerable:v.enumerable}),{getValue:function(){return A},setValue:function(ee){A=""+ee},stopTracking:function(){a._valueTracker=null,delete a[h]}}}}function Oe(a){a._valueTracker||(a._valueTracker=_e(a))}function qe(a){if(!a)return!1;var h=a._valueTracker;if(!h)return!0;var v=h.getValue(),A="";return a&&(A=fe(a)?a.checked?"true":"false":a.value),a=A,a!==v?(h.setValue(a),!0):!1}function tt(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function yt(a,h){var v=h.checked;return K({},h,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:v??a._wrapperState.initialChecked})}function At(a,h){var v=h.defaultValue==null?"":h.defaultValue,A=h.checked!=null?h.checked:h.defaultChecked;v=ue(h.value!=null?h.value:v),a._wrapperState={initialChecked:A,initialValue:v,controlled:h.type==="checkbox"||h.type==="radio"?h.checked!=null:h.value!=null}}function xn(a,h){h=h.checked,h!=null&&R(a,"checked",h,!1)}function Yt(a,h){xn(a,h);var v=ue(h.value),A=h.type;if(v!=null)A==="number"?(v===0&&a.value===""||a.value!=v)&&(a.value=""+v):a.value!==""+v&&(a.value=""+v);else if(A==="submit"||A==="reset"){a.removeAttribute("value");return}h.hasOwnProperty("value")?Ne(a,h.type,v):h.hasOwnProperty("defaultValue")&&Ne(a,h.type,ue(h.defaultValue)),h.checked==null&&h.defaultChecked!=null&&(a.defaultChecked=!!h.defaultChecked)}function Ae(a,h,v){if(h.hasOwnProperty("value")||h.hasOwnProperty("defaultValue")){var A=h.type;if(!(A!=="submit"&&A!=="reset"||h.value!==void 0&&h.value!==null))return;h=""+a._wrapperState.initialValue,v||h===a.value||(a.value=h),a.defaultValue=h}v=a.name,v!==""&&(a.name=""),a.defaultChecked=!!a._wrapperState.initialChecked,v!==""&&(a.name=v)}function Ne(a,h,v){(h!=="number"||tt(a.ownerDocument)!==a)&&(v==null?a.defaultValue=""+a._wrapperState.initialValue:a.defaultValue!==""+v&&(a.defaultValue=""+v))}var Le=Array.isArray;function ze(a,h,v,A){if(a=a.options,h){h={};for(var z=0;z<v.length;z++)h["$"+v[z]]=!0;for(v=0;v<a.length;v++)z=h.hasOwnProperty("$"+a[v].value),a[v].selected!==z&&(a[v].selected=z),z&&A&&(a[v].defaultSelected=!0)}else{for(v=""+ue(v),h=null,z=0;z<a.length;z++){if(a[z].value===v){a[z].selected=!0,A&&(a[z].defaultSelected=!0);return}h!==null||a[z].disabled||(h=a[z])}h!==null&&(h.selected=!0)}}function ke(a,h){if(h.dangerouslySetInnerHTML!=null)throw Error(t(91));return K({},h,{value:void 0,defaultValue:void 0,children:""+a._wrapperState.initialValue})}function vt(a,h){var v=h.value;if(v==null){if(v=h.children,h=h.defaultValue,v!=null){if(h!=null)throw Error(t(92));if(Le(v)){if(1<v.length)throw Error(t(93));v=v[0]}h=v}h==null&&(h=""),v=h}a._wrapperState={initialValue:ue(v)}}function mt(a,h){var v=ue(h.value),A=ue(h.defaultValue);v!=null&&(v=""+v,v!==a.value&&(a.value=v),h.defaultValue==null&&a.defaultValue!==v&&(a.defaultValue=v)),A!=null&&(a.defaultValue=""+A)}function pt(a){var h=a.textContent;h===a._wrapperState.initialValue&&h!==""&&h!==null&&(a.value=h)}function kt(a){switch(a){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ot(a,h){return a==null||a==="http://www.w3.org/1999/xhtml"?kt(h):a==="http://www.w3.org/2000/svg"&&h==="foreignObject"?"http://www.w3.org/1999/xhtml":a}var Mt,ls=function(a){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(h,v,A,z){MSApp.execUnsafeLocalFunction(function(){return a(h,v,A,z)})}:a}(function(a,h){if(a.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in a)a.innerHTML=h;else{for(Mt=Mt||document.createElement("div"),Mt.innerHTML="<svg>"+h.valueOf().toString()+"</svg>",h=Mt.firstChild;a.firstChild;)a.removeChild(a.firstChild);for(;h.firstChild;)a.appendChild(h.firstChild)}});function Ht(a,h){if(h){var v=a.firstChild;if(v&&v===a.lastChild&&v.nodeType===3){v.nodeValue=h;return}}a.textContent=h}var Mn={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},cs=["Webkit","ms","Moz","O"];Object.keys(Mn).forEach(function(a){cs.forEach(function(h){h=h+a.charAt(0).toUpperCase()+a.substring(1),Mn[h]=Mn[a]})});function Ui(a,h,v){return h==null||typeof h=="boolean"||h===""?"":v||typeof h!="number"||h===0||Mn.hasOwnProperty(a)&&Mn[a]?(""+h).trim():h+"px"}function yi(a,h){a=a.style;for(var v in h)if(h.hasOwnProperty(v)){var A=v.indexOf("--")===0,z=Ui(v,h[v],A);v==="float"&&(v="cssFloat"),A?a.setProperty(v,z):a[v]=z}}var yr=K({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function vi(a,h){if(h){if(yr[a]&&(h.children!=null||h.dangerouslySetInnerHTML!=null))throw Error(t(137,a));if(h.dangerouslySetInnerHTML!=null){if(h.children!=null)throw Error(t(60));if(typeof h.dangerouslySetInnerHTML!="object"||!("__html"in h.dangerouslySetInnerHTML))throw Error(t(61))}if(h.style!=null&&typeof h.style!="object")throw Error(t(62))}}function ti(a,h){if(a.indexOf("-")===-1)return typeof h.is=="string";switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qi=null;function ho(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}var _i=null,Jn=null,ni=null;function xi(a){if(a=ia(a)){if(typeof _i!="function")throw Error(t(280));var h=a.stateNode;h&&(h=Fu(h),_i(a.stateNode,a.type,h))}}function bi(a){Jn?ni?ni.push(a):ni=[a]:Jn=a}function Bo(){if(Jn){var a=Jn,h=ni;if(ni=Jn=null,xi(a),h)for(a=0;a<h.length;a++)xi(h[a])}}function yn(a,h){return a(h)}function wi(){}var Hi=!1;function us(a,h,v){if(Hi)return a(h,v);Hi=!0;try{return yn(a,h,v)}finally{Hi=!1,(Jn!==null||ni!==null)&&(wi(),Bo())}}function bn(a,h){var v=a.stateNode;if(v===null)return null;var A=Fu(v);if(A===null)return null;v=A[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(A=!A.disabled)||(a=a.type,A=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!A;break e;default:a=!1}if(a)return null;if(v&&typeof v!="function")throw Error(t(231,h,typeof v));return v}var Fs=!1;if(l)try{var Lr={};Object.defineProperty(Lr,"passive",{get:function(){Fs=!0}}),window.addEventListener("test",Lr,Lr),window.removeEventListener("test",Lr,Lr)}catch{Fs=!1}function Vs(a,h,v,A,z,H,ee,de,me){var Se=Array.prototype.slice.call(arguments,3);try{h.apply(v,Se)}catch(je){this.onError(je)}}var ln=!1,We=null,Nr=!1,zs=null,fo={onError:function(a){ln=!0,We=a}};function ds(a,h,v,A,z,H,ee,de,me){ln=!1,We=null,Vs.apply(fo,arguments)}function vr(a,h,v,A,z,H,ee,de,me){if(ds.apply(this,arguments),ln){if(ln){var Se=We;ln=!1,We=null}else throw Error(t(198));Nr||(Nr=!0,zs=Se)}}function Ir(a){var h=a,v=a;if(a.alternate)for(;h.return;)h=h.return;else{a=h;do h=a,(h.flags&4098)!==0&&(v=h.return),a=h.return;while(a)}return h.tag===3?v:null}function kr(a){if(a.tag===13){var h=a.memoizedState;if(h===null&&(a=a.alternate,a!==null&&(h=a.memoizedState)),h!==null)return h.dehydrated}return null}function Pr(a){if(Ir(a)!==a)throw Error(t(188))}function Uo(a){var h=a.alternate;if(!h){if(h=Ir(a),h===null)throw Error(t(188));return h!==a?null:a}for(var v=a,A=h;;){var z=v.return;if(z===null)break;var H=z.alternate;if(H===null){if(A=z.return,A!==null){v=A;continue}break}if(z.child===H.child){for(H=z.child;H;){if(H===v)return Pr(z),a;if(H===A)return Pr(z),h;H=H.sibling}throw Error(t(188))}if(v.return!==A.return)v=z,A=H;else{for(var ee=!1,de=z.child;de;){if(de===v){ee=!0,v=z,A=H;break}if(de===A){ee=!0,A=z,v=H;break}de=de.sibling}if(!ee){for(de=H.child;de;){if(de===v){ee=!0,v=H,A=z;break}if(de===A){ee=!0,A=H,v=z;break}de=de.sibling}if(!ee)throw Error(t(189))}}if(v.alternate!==A)throw Error(t(190))}if(v.tag!==3)throw Error(t(188));return v.stateNode.current===v?a:h}function qo(a){return a=Uo(a),a!==null?Qe(a):null}function Qe(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var h=Qe(a);if(h!==null)return h;a=a.sibling}return null}var pe=e.unstable_scheduleCallback,Me=e.unstable_cancelCallback,Ke=e.unstable_shouldYield,Zt=e.unstable_requestPaint,It=e.unstable_now,wn=e.unstable_getCurrentPriorityLevel,Pn=e.unstable_ImmediatePriority,er=e.unstable_UserBlockingPriority,Gn=e.unstable_NormalPriority,$i=e.unstable_LowPriority,vn=e.unstable_IdlePriority,Wi=null,ar=null;function mo(a){if(ar&&typeof ar.onCommitFiberRoot=="function")try{ar.onCommitFiberRoot(Wi,a,void 0,(a.current.flags&128)===128)}catch{}}var St=Math.clz32?Math.clz32:Bs,cn=Math.log,Ho=Math.LN2;function Bs(a){return a>>>=0,a===0?32:31-(cn(a)/Ho|0)|0}var Gi=64,po=4194304;function xt(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function un(a,h){var v=a.pendingLanes;if(v===0)return 0;var A=0,z=a.suspendedLanes,H=a.pingedLanes,ee=v&268435455;if(ee!==0){var de=ee&~z;de!==0?A=xt(de):(H&=ee,H!==0&&(A=xt(H)))}else ee=v&~z,ee!==0?A=xt(ee):H!==0&&(A=xt(H));if(A===0)return 0;if(h!==0&&h!==A&&(h&z)===0&&(z=A&-A,H=h&-h,z>=H||z===16&&(H&4194240)!==0))return h;if((A&4)!==0&&(A|=v&16),h=a.entangledLanes,h!==0)for(a=a.entanglements,h&=A;0<h;)v=31-St(h),z=1<<v,A|=a[v],h&=~z;return A}function mc(a,h){switch(a){case 1:case 2:case 4:return h+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ei(a,h){for(var v=a.suspendedLanes,A=a.pingedLanes,z=a.expirationTimes,H=a.pendingLanes;0<H;){var ee=31-St(H),de=1<<ee,me=z[ee];me===-1?((de&v)===0||(de&A)!==0)&&(z[ee]=mc(de,h)):me<=h&&(a.expiredLanes|=de),H&=~de}}function Sn(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function $o(){var a=Gi;return Gi<<=1,(Gi&4194240)===0&&(Gi=64),a}function Ki(a){for(var h=[],v=0;31>v;v++)h.push(a);return h}function Fr(a,h,v){a.pendingLanes|=h,h!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,h=31-St(h),a[h]=v}function Tt(a,h){var v=a.pendingLanes&~h;a.pendingLanes=h,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=h,a.mutableReadLanes&=h,a.entangledLanes&=h,h=a.entanglements;var A=a.eventTimes;for(a=a.expirationTimes;0<v;){var z=31-St(v),H=1<<z;h[z]=0,A[z]=-1,a[z]=-1,v&=~H}}function Vr(a,h){var v=a.entangledLanes|=h;for(a=a.entanglements;v;){var A=31-St(v),z=1<<A;z&h|a[A]&h&&(a[A]|=h),v&=~z}}var Ct=0;function Si(a){return a&=-a,1<a?4<a?(a&268435455)!==0?16:536870912:4:1}var Ha,hs,$a,Wa,Wo,Go=!1,Ti=[],Bn=null,Ai=null,ri=null,go=new Map,lt=new Map,Kn=[],tn="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pc(a,h){switch(a){case"focusin":case"focusout":Bn=null;break;case"dragenter":case"dragleave":Ai=null;break;case"mouseover":case"mouseout":ri=null;break;case"pointerover":case"pointerout":go.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":lt.delete(h.pointerId)}}function _r(a,h,v,A,z,H){return a===null||a.nativeEvent!==H?(a={blockedOn:h,domEventName:v,eventSystemFlags:A,nativeEvent:H,targetContainers:[z]},h!==null&&(h=ia(h),h!==null&&hs(h)),a):(a.eventSystemFlags|=A,h=a.targetContainers,z!==null&&h.indexOf(z)===-1&&h.push(z),a)}function gc(a,h,v,A,z){switch(h){case"focusin":return Bn=_r(Bn,a,h,v,A,z),!0;case"dragenter":return Ai=_r(Ai,a,h,v,A,z),!0;case"mouseover":return ri=_r(ri,a,h,v,A,z),!0;case"pointerover":var H=z.pointerId;return go.set(H,_r(go.get(H)||null,a,h,v,A,z)),!0;case"gotpointercapture":return H=z.pointerId,lt.set(H,_r(lt.get(H)||null,a,h,v,A,z)),!0}return!1}function Ga(a){var h=ra(a.target);if(h!==null){var v=Ir(h);if(v!==null){if(h=v.tag,h===13){if(h=kr(v),h!==null){a.blockedOn=h,Wo(a.priority,function(){$a(v)});return}}else if(h===3&&v.stateNode.current.memoizedState.isDehydrated){a.blockedOn=v.tag===3?v.stateNode.containerInfo:null;return}}}a.blockedOn=null}function Cr(a){if(a.blockedOn!==null)return!1;for(var h=a.targetContainers;0<h.length;){var v=Zo(a.domEventName,a.eventSystemFlags,h[0],a.nativeEvent);if(v===null){v=a.nativeEvent;var A=new v.constructor(v.type,v);qi=A,v.target.dispatchEvent(A),qi=null}else return h=ia(v),h!==null&&hs(h),a.blockedOn=v,!1;h.shift()}return!0}function Us(a,h,v){Cr(a)&&v.delete(h)}function yo(){Go=!1,Bn!==null&&Cr(Bn)&&(Bn=null),Ai!==null&&Cr(Ai)&&(Ai=null),ri!==null&&Cr(ri)&&(ri=null),go.forEach(Us),lt.forEach(Us)}function dn(a,h){a.blockedOn===h&&(a.blockedOn=null,Go||(Go=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,yo)))}function lr(a){function h(z){return dn(z,a)}if(0<Ti.length){dn(Ti[0],a);for(var v=1;v<Ti.length;v++){var A=Ti[v];A.blockedOn===a&&(A.blockedOn=null)}}for(Bn!==null&&dn(Bn,a),Ai!==null&&dn(Ai,a),ri!==null&&dn(ri,a),go.forEach(h),lt.forEach(h),v=0;v<Kn.length;v++)A=Kn[v],A.blockedOn===a&&(A.blockedOn=null);for(;0<Kn.length&&(v=Kn[0],v.blockedOn===null);)Ga(v),v.blockedOn===null&&Kn.shift()}var fs=I.ReactCurrentBatchConfig,qs=!0;function Tn(a,h,v,A){var z=Ct,H=fs.transition;fs.transition=null;try{Ct=1,Ko(a,h,v,A)}finally{Ct=z,fs.transition=H}}function Su(a,h,v,A){var z=Ct,H=fs.transition;fs.transition=null;try{Ct=4,Ko(a,h,v,A)}finally{Ct=z,fs.transition=H}}function Ko(a,h,v,A){if(qs){var z=Zo(a,h,v,A);if(z===null)c(a,h,A,Yo,v),pc(a,A);else if(gc(z,a,h,v,A))A.stopPropagation();else if(pc(a,A),h&4&&-1<tn.indexOf(a)){for(;z!==null;){var H=ia(z);if(H!==null&&Ha(H),H=Zo(a,h,v,A),H===null&&c(a,h,A,Yo,v),H===z)break;z=H}z!==null&&A.stopPropagation()}else c(a,h,A,null,v)}}var Yo=null;function Zo(a,h,v,A){if(Yo=null,a=ho(A),a=ra(a),a!==null)if(h=Ir(a),h===null)a=null;else if(v=h.tag,v===13){if(a=kr(h),a!==null)return a;a=null}else if(v===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;a=null}else h!==a&&(a=null);return Yo=a,null}function Rt(a){switch(a){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(wn()){case Pn:return 1;case er:return 4;case Gn:case $i:return 16;case vn:return 536870912;default:return 16}default:return 16}}var ii=null,xr=null,tr=null;function Ka(){if(tr)return tr;var a,h=xr,v=h.length,A,z="value"in ii?ii.value:ii.textContent,H=z.length;for(a=0;a<v&&h[a]===z[a];a++);var ee=v-a;for(A=1;A<=ee&&h[v-A]===z[H-A];A++);return tr=z.slice(a,1<A?1-A:void 0)}function Ya(a){var h=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&h===13&&(a=13)):a=h,a===10&&(a=13),32<=a||a===13?a:0}function Ni(){return!0}function yc(){return!1}function nr(a){function h(v,A,z,H,ee){this._reactName=v,this._targetInst=z,this.type=A,this.nativeEvent=H,this.target=ee,this.currentTarget=null;for(var de in a)a.hasOwnProperty(de)&&(v=a[de],this[de]=v?v(H):H[de]);return this.isDefaultPrevented=(H.defaultPrevented!=null?H.defaultPrevented:H.returnValue===!1)?Ni:yc,this.isPropagationStopped=yc,this}return K(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var v=this.nativeEvent;v&&(v.preventDefault?v.preventDefault():typeof v.returnValue!="unknown"&&(v.returnValue=!1),this.isDefaultPrevented=Ni)},stopPropagation:function(){var v=this.nativeEvent;v&&(v.stopPropagation?v.stopPropagation():typeof v.cancelBubble!="unknown"&&(v.cancelBubble=!0),this.isPropagationStopped=Ni)},persist:function(){},isPersistent:Ni}),h}var Yi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Za=nr(Yi),Ii=K({},Yi,{view:0,detail:0}),ch=nr(Ii),Rr,Hs,$s,zr=K({},Ii,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Br,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==$s&&($s&&a.type==="mousemove"?(Rr=a.screenX-$s.screenX,Hs=a.screenY-$s.screenY):Hs=Rr=0,$s=a),Rr)},movementY:function(a){return"movementY"in a?a.movementY:Hs}}),Qo=nr(zr),Qa=K({},zr,{dataTransfer:0}),Xa=nr(Qa),Ja=K({},Ii,{relatedTarget:0}),Xo=nr(Ja),vc=K({},Yi,{animationName:0,elapsedTime:0,pseudoElement:0}),Ws=nr(vc),Tu=K({},Yi,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),el=nr(Tu),Au=K({},Yi,{data:0}),tl=nr(Au),Jo={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},rr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ms={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Nu(a){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(a):(a=ms[a])?!!h[a]:!1}function Br(){return Nu}var w=K({},Ii,{key:function(a){if(a.key){var h=Jo[a.key]||a.key;if(h!=="Unidentified")return h}return a.type==="keypress"?(a=Ya(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?rr[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Br,charCode:function(a){return a.type==="keypress"?Ya(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Ya(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),q=nr(w),Z=K({},zr,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ae=nr(Z),ye=K({},Ii,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Br}),Te=nr(ye),Be=K({},Yi,{propertyName:0,elapsedTime:0,pseudoElement:0}),en=nr(Be),Un=K({},zr,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),Bt=nr(Un),nn=[9,13,27,32],En=l&&"CompositionEvent"in window,ki=null;l&&"documentMode"in document&&(ki=document.documentMode);var Dn=l&&"TextEvent"in window&&!ki,ea=l&&(!En||ki&&8<ki&&11>=ki),Zi=" ",Cm=!1;function nl(a,h){switch(a){case"keyup":return nn.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function uh(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}var Gs=!1;function y0(a,h){switch(a){case"compositionend":return uh(h);case"keypress":return h.which!==32?null:(Cm=!0,Zi);case"textInput":return a=h.data,a===Zi&&Cm?null:a;default:return null}}function vo(a,h){if(Gs)return a==="compositionend"||!En&&nl(a,h)?(a=Ka(),tr=xr=ii=null,Gs=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return ea&&h.locale!=="ko"?null:h.data;default:return null}}var Iu={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rm(a){var h=a&&a.nodeName&&a.nodeName.toLowerCase();return h==="input"?!!Iu[a.type]:h==="textarea"}function ku(a,h,v,A){bi(A),h=S(h,"onChange"),0<h.length&&(v=new Za("onChange","change",null,v,A),a.push({event:v,listeners:h}))}var _c=null,si=null;function v0(a){_h(a,0)}function Ks(a){var h=sa(a);if(qe(h))return a}function _0(a,h){if(a==="change")return h}var ps=!1;if(l){var rl;if(l){var Pu="oninput"in document;if(!Pu){var Cu=document.createElement("div");Cu.setAttribute("oninput","return;"),Pu=typeof Cu.oninput=="function"}rl=Pu}else rl=!1;ps=rl&&(!document.documentMode||9<document.documentMode)}function xc(){_c&&(_c.detachEvent("onpropertychange",Ru),si=_c=null)}function Ru(a){if(a.propertyName==="value"&&Ks(si)){var h=[];ku(h,si,a,ho(a)),us(v0,h)}}function ju(a,h,v){a==="focusin"?(xc(),_c=h,si=v,_c.attachEvent("onpropertychange",Ru)):a==="focusout"&&xc()}function il(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return Ks(si)}function Ou(a,h){if(a==="click")return Ks(h)}function dh(a,h){if(a==="input"||a==="change")return Ks(h)}function jm(a,h){return a===h&&(a!==0||1/a===1/h)||a!==a&&h!==h}var Qi=typeof Object.is=="function"?Object.is:jm;function _o(a,h){if(Qi(a,h))return!0;if(typeof a!="object"||a===null||typeof h!="object"||h===null)return!1;var v=Object.keys(a),A=Object.keys(h);if(v.length!==A.length)return!1;for(A=0;A<v.length;A++){var z=v[A];if(!d.call(h,z)||!Qi(a[z],h[z]))return!1}return!0}function Om(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function hh(a,h){var v=Om(a);a=0;for(var A;v;){if(v.nodeType===3){if(A=a+v.textContent.length,a<=h&&A>=h)return{node:v,offset:h-a};a=A}e:{for(;v;){if(v.nextSibling){v=v.nextSibling;break e}v=v.parentNode}v=void 0}v=Om(v)}}function Mm(a,h){return a&&h?a===h?!0:a&&a.nodeType===3?!1:h&&h.nodeType===3?Mm(a,h.parentNode):"contains"in a?a.contains(h):a.compareDocumentPosition?!!(a.compareDocumentPosition(h)&16):!1:!1}function fh(){for(var a=window,h=tt();h instanceof a.HTMLIFrameElement;){try{var v=typeof h.contentWindow.location.href=="string"}catch{v=!1}if(v)a=h.contentWindow;else break;h=tt(a.document)}return h}function mh(a){var h=a&&a.nodeName&&a.nodeName.toLowerCase();return h&&(h==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||h==="textarea"||a.contentEditable==="true")}function gs(a){var h=fh(),v=a.focusedElem,A=a.selectionRange;if(h!==v&&v&&v.ownerDocument&&Mm(v.ownerDocument.documentElement,v)){if(A!==null&&mh(v)){if(h=A.start,a=A.end,a===void 0&&(a=h),"selectionStart"in v)v.selectionStart=h,v.selectionEnd=Math.min(a,v.value.length);else if(a=(h=v.ownerDocument||document)&&h.defaultView||window,a.getSelection){a=a.getSelection();var z=v.textContent.length,H=Math.min(A.start,z);A=A.end===void 0?H:Math.min(A.end,z),!a.extend&&H>A&&(z=A,A=H,H=z),z=hh(v,H);var ee=hh(v,A);z&&ee&&(a.rangeCount!==1||a.anchorNode!==z.node||a.anchorOffset!==z.offset||a.focusNode!==ee.node||a.focusOffset!==ee.offset)&&(h=h.createRange(),h.setStart(z.node,z.offset),a.removeAllRanges(),H>A?(a.addRange(h),a.extend(ee.node,ee.offset)):(h.setEnd(ee.node,ee.offset),a.addRange(h)))}}for(h=[],a=v;a=a.parentNode;)a.nodeType===1&&h.push({element:a,left:a.scrollLeft,top:a.scrollTop});for(typeof v.focus=="function"&&v.focus(),v=0;v<h.length;v++)a=h[v],a.element.scrollLeft=a.left,a.element.scrollTop=a.top}}var Mu=l&&"documentMode"in document&&11>=document.documentMode,sl=null,ol=null,bc=null,Du=!1;function Dm(a,h,v){var A=v.window===v?v.document:v.nodeType===9?v:v.ownerDocument;Du||sl==null||sl!==tt(A)||(A=sl,"selectionStart"in A&&mh(A)?A={start:A.selectionStart,end:A.selectionEnd}:(A=(A.ownerDocument&&A.ownerDocument.defaultView||window).getSelection(),A={anchorNode:A.anchorNode,anchorOffset:A.anchorOffset,focusNode:A.focusNode,focusOffset:A.focusOffset}),bc&&_o(bc,A)||(bc=A,A=S(ol,"onSelect"),0<A.length&&(h=new Za("onSelect","select",null,h,v),a.push({event:h,listeners:A}),h.target=sl)))}function xo(a,h){var v={};return v[a.toLowerCase()]=h.toLowerCase(),v["Webkit"+a]="webkit"+h,v["Moz"+a]="moz"+h,v}var al={animationend:xo("Animation","AnimationEnd"),animationiteration:xo("Animation","AnimationIteration"),animationstart:xo("Animation","AnimationStart"),transitionend:xo("Transition","TransitionEnd")},bo={},ph={};l&&(ph=document.createElement("div").style,"AnimationEvent"in window||(delete al.animationend.animation,delete al.animationiteration.animation,delete al.animationstart.animation),"TransitionEvent"in window||delete al.transitionend.transition);function wc(a){if(bo[a])return bo[a];if(!al[a])return a;var h=al[a],v;for(v in h)if(h.hasOwnProperty(v)&&v in ph)return bo[a]=h[v];return a}var Lm=wc("animationend"),ys=wc("animationiteration"),gh=wc("animationstart"),yh=wc("transitionend"),ll=new Map,Fm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Xi(a,h){ll.set(a,h),s(h,[a])}for(var ta=0;ta<Fm.length;ta++){var Lu=Fm[ta],Vm=Lu.toLowerCase(),x0=Lu[0].toUpperCase()+Lu.slice(1);Xi(Vm,"on"+x0)}Xi(Lm,"onAnimationEnd"),Xi(ys,"onAnimationIteration"),Xi(gh,"onAnimationStart"),Xi("dblclick","onDoubleClick"),Xi("focusin","onFocus"),Xi("focusout","onBlur"),Xi(yh,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),s("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),s("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),s("onBeforeInput",["compositionend","keypress","textInput","paste"]),s("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),s("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var cl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),zm=new Set("cancel close invalid load scroll toggle".split(" ").concat(cl));function vh(a,h,v){var A=a.type||"unknown-event";a.currentTarget=v,vr(A,h,void 0,a),a.currentTarget=null}function _h(a,h){h=(h&4)!==0;for(var v=0;v<a.length;v++){var A=a[v],z=A.event;A=A.listeners;e:{var H=void 0;if(h)for(var ee=A.length-1;0<=ee;ee--){var de=A[ee],me=de.instance,Se=de.currentTarget;if(de=de.listener,me!==H&&z.isPropagationStopped())break e;vh(z,de,Se),H=me}else for(ee=0;ee<A.length;ee++){if(de=A[ee],me=de.instance,Se=de.currentTarget,de=de.listener,me!==H&&z.isPropagationStopped())break e;vh(z,de,Se),H=me}}}if(Nr)throw a=zs,Nr=!1,zs=null,a}function _n(a,h){var v=h[fl];v===void 0&&(v=h[fl]=new Set);var A=a+"__bubble";v.has(A)||(Bm(h,a,2,!1),v.add(A))}function xh(a,h,v){var A=0;h&&(A|=4),Bm(v,a,A,h)}var Ec="_reactListening"+Math.random().toString(36).slice(2);function ul(a){if(!a[Ec]){a[Ec]=!0,n.forEach(function(v){v!=="selectionchange"&&(zm.has(v)||xh(v,!1,a),xh(v,!0,a))});var h=a.nodeType===9?a:a.ownerDocument;h===null||h[Ec]||(h[Ec]=!0,xh("selectionchange",!1,h))}}function Bm(a,h,v,A){switch(Rt(h)){case 1:var z=Tn;break;case 4:z=Su;break;default:z=Ko}v=z.bind(null,h,v,a),z=void 0,!Fs||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(z=!0),A?z!==void 0?a.addEventListener(h,v,{capture:!0,passive:z}):a.addEventListener(h,v,!0):z!==void 0?a.addEventListener(h,v,{passive:z}):a.addEventListener(h,v,!1)}function c(a,h,v,A,z){var H=A;if((h&1)===0&&(h&2)===0&&A!==null)e:for(;;){if(A===null)return;var ee=A.tag;if(ee===3||ee===4){var de=A.stateNode.containerInfo;if(de===z||de.nodeType===8&&de.parentNode===z)break;if(ee===4)for(ee=A.return;ee!==null;){var me=ee.tag;if((me===3||me===4)&&(me=ee.stateNode.containerInfo,me===z||me.nodeType===8&&me.parentNode===z))return;ee=ee.return}for(;de!==null;){if(ee=ra(de),ee===null)return;if(me=ee.tag,me===5||me===6){A=H=ee;continue e}de=de.parentNode}}A=A.return}us(function(){var Se=H,je=ho(v),De=[];e:{var Ce=ll.get(a);if(Ce!==void 0){var Ge=Za,Xe=a;switch(a){case"keypress":if(Ya(v)===0)break e;case"keydown":case"keyup":Ge=q;break;case"focusin":Xe="focus",Ge=Xo;break;case"focusout":Xe="blur",Ge=Xo;break;case"beforeblur":case"afterblur":Ge=Xo;break;case"click":if(v.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ge=Qo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ge=Xa;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ge=Te;break;case Lm:case ys:case gh:Ge=Ws;break;case yh:Ge=en;break;case"scroll":Ge=ch;break;case"wheel":Ge=Bt;break;case"copy":case"cut":case"paste":Ge=el;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ge=ae}var nt=(h&4)!==0,Yn=!nt&&a==="scroll",be=nt?Ce!==null?Ce+"Capture":null:Ce;nt=[];for(var ge=Se,we;ge!==null;){we=ge;var Ve=we.stateNode;if(we.tag===5&&Ve!==null&&(we=Ve,be!==null&&(Ve=bn(ge,be),Ve!=null&&nt.push(p(ge,Ve,we)))),Yn)break;ge=ge.return}0<nt.length&&(Ce=new Ge(Ce,Xe,null,v,je),De.push({event:Ce,listeners:nt}))}}if((h&7)===0){e:{if(Ce=a==="mouseover"||a==="pointerover",Ge=a==="mouseout"||a==="pointerout",Ce&&v!==qi&&(Xe=v.relatedTarget||v.fromElement)&&(ra(Xe)||Xe[rn]))break e;if((Ge||Ce)&&(Ce=je.window===je?je:(Ce=je.ownerDocument)?Ce.defaultView||Ce.parentWindow:window,Ge?(Xe=v.relatedTarget||v.toElement,Ge=Se,Xe=Xe?ra(Xe):null,Xe!==null&&(Yn=Ir(Xe),Xe!==Yn||Xe.tag!==5&&Xe.tag!==6)&&(Xe=null)):(Ge=null,Xe=Se),Ge!==Xe)){if(nt=Qo,Ve="onMouseLeave",be="onMouseEnter",ge="mouse",(a==="pointerout"||a==="pointerover")&&(nt=ae,Ve="onPointerLeave",be="onPointerEnter",ge="pointer"),Yn=Ge==null?Ce:sa(Ge),we=Xe==null?Ce:sa(Xe),Ce=new nt(Ve,ge+"leave",Ge,v,je),Ce.target=Yn,Ce.relatedTarget=we,Ve=null,ra(je)===Se&&(nt=new nt(be,ge+"enter",Xe,v,je),nt.target=we,nt.relatedTarget=Yn,Ve=nt),Yn=Ve,Ge&&Xe)t:{for(nt=Ge,be=Xe,ge=0,we=nt;we;we=V(we))ge++;for(we=0,Ve=be;Ve;Ve=V(Ve))we++;for(;0<ge-we;)nt=V(nt),ge--;for(;0<we-ge;)be=V(be),we--;for(;ge--;){if(nt===be||be!==null&&nt===be.alternate)break t;nt=V(nt),be=V(be)}nt=null}else nt=null;Ge!==null&&W(De,Ce,Ge,nt,!1),Xe!==null&&Yn!==null&&W(De,Yn,Xe,nt,!0)}}e:{if(Ce=Se?sa(Se):window,Ge=Ce.nodeName&&Ce.nodeName.toLowerCase(),Ge==="select"||Ge==="input"&&Ce.type==="file")var rt=_0;else if(Rm(Ce))if(ps)rt=dh;else{rt=il;var dt=ju}else(Ge=Ce.nodeName)&&Ge.toLowerCase()==="input"&&(Ce.type==="checkbox"||Ce.type==="radio")&&(rt=Ou);if(rt&&(rt=rt(a,Se))){ku(De,rt,v,je);break e}dt&&dt(a,Ce,Se),a==="focusout"&&(dt=Ce._wrapperState)&&dt.controlled&&Ce.type==="number"&&Ne(Ce,"number",Ce.value)}switch(dt=Se?sa(Se):window,a){case"focusin":(Rm(dt)||dt.contentEditable==="true")&&(sl=dt,ol=Se,bc=null);break;case"focusout":bc=ol=sl=null;break;case"mousedown":Du=!0;break;case"contextmenu":case"mouseup":case"dragend":Du=!1,Dm(De,v,je);break;case"selectionchange":if(Mu)break;case"keydown":case"keyup":Dm(De,v,je)}var ht;if(En)e:{switch(a){case"compositionstart":var Nt="onCompositionStart";break e;case"compositionend":Nt="onCompositionEnd";break e;case"compositionupdate":Nt="onCompositionUpdate";break e}Nt=void 0}else Gs?nl(a,v)&&(Nt="onCompositionEnd"):a==="keydown"&&v.keyCode===229&&(Nt="onCompositionStart");Nt&&(ea&&v.locale!=="ko"&&(Gs||Nt!=="onCompositionStart"?Nt==="onCompositionEnd"&&Gs&&(ht=Ka()):(ii=je,xr="value"in ii?ii.value:ii.textContent,Gs=!0)),dt=S(Se,Nt),0<dt.length&&(Nt=new tl(Nt,a,null,v,je),De.push({event:Nt,listeners:dt}),ht?Nt.data=ht:(ht=uh(v),ht!==null&&(Nt.data=ht)))),(ht=Dn?y0(a,v):vo(a,v))&&(Se=S(Se,"onBeforeInput"),0<Se.length&&(je=new tl("onBeforeInput","beforeinput",null,v,je),De.push({event:je,listeners:Se}),je.data=ht))}_h(De,h)})}function p(a,h,v){return{instance:a,listener:h,currentTarget:v}}function S(a,h){for(var v=h+"Capture",A=[];a!==null;){var z=a,H=z.stateNode;z.tag===5&&H!==null&&(z=H,H=bn(a,v),H!=null&&A.unshift(p(a,H,z)),H=bn(a,h),H!=null&&A.push(p(a,H,z))),a=a.return}return A}function V(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5);return a||null}function W(a,h,v,A,z){for(var H=h._reactName,ee=[];v!==null&&v!==A;){var de=v,me=de.alternate,Se=de.stateNode;if(me!==null&&me===A)break;de.tag===5&&Se!==null&&(de=Se,z?(me=bn(v,H),me!=null&&ee.unshift(p(v,me,de))):z||(me=bn(v,H),me!=null&&ee.push(p(v,me,de)))),v=v.return}ee.length!==0&&a.push({event:h,listeners:ee})}var re=/\r\n?/g,he=/\u0000|\uFFFD/g;function xe(a){return(typeof a=="string"?a:""+a).replace(re,`
`).replace(he,"")}function Ee(a,h,v){if(h=xe(h),xe(a)!==h&&v)throw Error(t(425))}function Pe(){}var $e=null,ut=null;function Pt(a,h){return a==="textarea"||a==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}var cr=typeof setTimeout=="function"?setTimeout:void 0,ir=typeof clearTimeout=="function"?clearTimeout:void 0,oi=typeof Promise=="function"?Promise:void 0,Ur=typeof queueMicrotask=="function"?queueMicrotask:typeof oi<"u"?function(a){return oi.resolve(null).then(a).catch(dl)}:cr;function dl(a){setTimeout(function(){throw a})}function bh(a,h){var v=h,A=0;do{var z=v.nextSibling;if(a.removeChild(v),z&&z.nodeType===8)if(v=z.data,v==="/$"){if(A===0){a.removeChild(z),lr(h);return}A--}else v!=="$"&&v!=="$?"&&v!=="$!"||A++;v=z}while(v);lr(h)}function wo(a){for(;a!=null;a=a.nextSibling){var h=a.nodeType;if(h===1||h===3)break;if(h===8){if(h=a.data,h==="$"||h==="$!"||h==="$?")break;if(h==="/$")return null}}return a}function Um(a){a=a.previousSibling;for(var h=0;a;){if(a.nodeType===8){var v=a.data;if(v==="$"||v==="$!"||v==="$?"){if(h===0)return a;h--}else v==="/$"&&h++}a=a.previousSibling}return null}var na=Math.random().toString(36).slice(2),vs="__reactFiber$"+na,hl="__reactProps$"+na,rn="__reactContainer$"+na,fl="__reactEvents$"+na,b0="__reactListeners$"+na,w0="__reactHandles$"+na;function ra(a){var h=a[vs];if(h)return h;for(var v=a.parentNode;v;){if(h=v[rn]||v[vs]){if(v=h.alternate,h.child!==null||v!==null&&v.child!==null)for(a=Um(a);a!==null;){if(v=a[vs])return v;a=Um(a)}return h}a=v,v=a.parentNode}return null}function ia(a){return a=a[vs]||a[rn],!a||a.tag!==5&&a.tag!==6&&a.tag!==13&&a.tag!==3?null:a}function sa(a){if(a.tag===5||a.tag===6)return a.stateNode;throw Error(t(33))}function Fu(a){return a[hl]||null}var E0=[],Vu=-1;function ml(a){return{current:a}}function In(a){0>Vu||(a.current=E0[Vu],E0[Vu]=null,Vu--)}function An(a,h){Vu++,E0[Vu]=a.current,a.current=h}var pl={},qr=ml(pl),Pi=ml(!1),Sc=pl;function zu(a,h){var v=a.type.contextTypes;if(!v)return pl;var A=a.stateNode;if(A&&A.__reactInternalMemoizedUnmaskedChildContext===h)return A.__reactInternalMemoizedMaskedChildContext;var z={},H;for(H in v)z[H]=h[H];return A&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=h,a.__reactInternalMemoizedMaskedChildContext=z),z}function Ci(a){return a=a.childContextTypes,a!=null}function qm(){In(Pi),In(qr)}function rw(a,h,v){if(qr.current!==pl)throw Error(t(168));An(qr,h),An(Pi,v)}function iw(a,h,v){var A=a.stateNode;if(h=h.childContextTypes,typeof A.getChildContext!="function")return v;A=A.getChildContext();for(var z in A)if(!(z in h))throw Error(t(108,ce(a)||"Unknown",z));return K({},v,A)}function Hm(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||pl,Sc=qr.current,An(qr,a),An(Pi,Pi.current),!0}function sw(a,h,v){var A=a.stateNode;if(!A)throw Error(t(169));v?(a=iw(a,h,Sc),A.__reactInternalMemoizedMergedChildContext=a,In(Pi),In(qr),An(qr,a)):In(Pi),An(Pi,v)}var oa=null,$m=!1,S0=!1;function ow(a){oa===null?oa=[a]:oa.push(a)}function VR(a){$m=!0,ow(a)}function gl(){if(!S0&&oa!==null){S0=!0;var a=0,h=Ct;try{var v=oa;for(Ct=1;a<v.length;a++){var A=v[a];do A=A(!0);while(A!==null)}oa=null,$m=!1}catch(z){throw oa!==null&&(oa=oa.slice(a+1)),pe(Pn,gl),z}finally{Ct=h,S0=!1}}return null}var Bu=[],Uu=0,Wm=null,Gm=0,_s=[],xs=0,Tc=null,aa=1,la="";function Ac(a,h){Bu[Uu++]=Gm,Bu[Uu++]=Wm,Wm=a,Gm=h}function aw(a,h,v){_s[xs++]=aa,_s[xs++]=la,_s[xs++]=Tc,Tc=a;var A=aa;a=la;var z=32-St(A)-1;A&=~(1<<z),v+=1;var H=32-St(h)+z;if(30<H){var ee=z-z%5;H=(A&(1<<ee)-1).toString(32),A>>=ee,z-=ee,aa=1<<32-St(h)+z|v<<z|A,la=H+a}else aa=1<<H|v<<z|A,la=a}function T0(a){a.return!==null&&(Ac(a,1),aw(a,1,0))}function A0(a){for(;a===Wm;)Wm=Bu[--Uu],Bu[Uu]=null,Gm=Bu[--Uu],Bu[Uu]=null;for(;a===Tc;)Tc=_s[--xs],_s[xs]=null,la=_s[--xs],_s[xs]=null,aa=_s[--xs],_s[xs]=null}var Ji=null,es=null,Cn=!1,Ys=null;function lw(a,h){var v=Ss(5,null,null,0);v.elementType="DELETED",v.stateNode=h,v.return=a,h=a.deletions,h===null?(a.deletions=[v],a.flags|=16):h.push(v)}function cw(a,h){switch(a.tag){case 5:var v=a.type;return h=h.nodeType!==1||v.toLowerCase()!==h.nodeName.toLowerCase()?null:h,h!==null?(a.stateNode=h,Ji=a,es=wo(h.firstChild),!0):!1;case 6:return h=a.pendingProps===""||h.nodeType!==3?null:h,h!==null?(a.stateNode=h,Ji=a,es=null,!0):!1;case 13:return h=h.nodeType!==8?null:h,h!==null?(v=Tc!==null?{id:aa,overflow:la}:null,a.memoizedState={dehydrated:h,treeContext:v,retryLane:1073741824},v=Ss(18,null,null,0),v.stateNode=h,v.return=a,a.child=v,Ji=a,es=null,!0):!1;default:return!1}}function N0(a){return(a.mode&1)!==0&&(a.flags&128)===0}function I0(a){if(Cn){var h=es;if(h){var v=h;if(!cw(a,h)){if(N0(a))throw Error(t(418));h=wo(v.nextSibling);var A=Ji;h&&cw(a,h)?lw(A,v):(a.flags=a.flags&-4097|2,Cn=!1,Ji=a)}}else{if(N0(a))throw Error(t(418));a.flags=a.flags&-4097|2,Cn=!1,Ji=a}}}function uw(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;Ji=a}function Km(a){if(a!==Ji)return!1;if(!Cn)return uw(a),Cn=!0,!1;var h;if((h=a.tag!==3)&&!(h=a.tag!==5)&&(h=a.type,h=h!=="head"&&h!=="body"&&!Pt(a.type,a.memoizedProps)),h&&(h=es)){if(N0(a))throw dw(),Error(t(418));for(;h;)lw(a,h),h=wo(h.nextSibling)}if(uw(a),a.tag===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(t(317));e:{for(a=a.nextSibling,h=0;a;){if(a.nodeType===8){var v=a.data;if(v==="/$"){if(h===0){es=wo(a.nextSibling);break e}h--}else v!=="$"&&v!=="$!"&&v!=="$?"||h++}a=a.nextSibling}es=null}}else es=Ji?wo(a.stateNode.nextSibling):null;return!0}function dw(){for(var a=es;a;)a=wo(a.nextSibling)}function qu(){es=Ji=null,Cn=!1}function k0(a){Ys===null?Ys=[a]:Ys.push(a)}var zR=I.ReactCurrentBatchConfig;function wh(a,h,v){if(a=v.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(v._owner){if(v=v._owner,v){if(v.tag!==1)throw Error(t(309));var A=v.stateNode}if(!A)throw Error(t(147,a));var z=A,H=""+a;return h!==null&&h.ref!==null&&typeof h.ref=="function"&&h.ref._stringRef===H?h.ref:(h=function(ee){var de=z.refs;ee===null?delete de[H]:de[H]=ee},h._stringRef=H,h)}if(typeof a!="string")throw Error(t(284));if(!v._owner)throw Error(t(290,a))}return a}function Ym(a,h){throw a=Object.prototype.toString.call(h),Error(t(31,a==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":a))}function hw(a){var h=a._init;return h(a._payload)}function fw(a){function h(be,ge){if(a){var we=be.deletions;we===null?(be.deletions=[ge],be.flags|=16):we.push(ge)}}function v(be,ge){if(!a)return null;for(;ge!==null;)h(be,ge),ge=ge.sibling;return null}function A(be,ge){for(be=new Map;ge!==null;)ge.key!==null?be.set(ge.key,ge):be.set(ge.index,ge),ge=ge.sibling;return be}function z(be,ge){return be=Sl(be,ge),be.index=0,be.sibling=null,be}function H(be,ge,we){return be.index=we,a?(we=be.alternate,we!==null?(we=we.index,we<ge?(be.flags|=2,ge):we):(be.flags|=2,ge)):(be.flags|=1048576,ge)}function ee(be){return a&&be.alternate===null&&(be.flags|=2),be}function de(be,ge,we,Ve){return ge===null||ge.tag!==6?(ge=xv(we,be.mode,Ve),ge.return=be,ge):(ge=z(ge,we),ge.return=be,ge)}function me(be,ge,we,Ve){var rt=we.type;return rt===C?je(be,ge,we.props.children,Ve,we.key):ge!==null&&(ge.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===te&&hw(rt)===ge.type)?(Ve=z(ge,we.props),Ve.ref=wh(be,ge,we),Ve.return=be,Ve):(Ve=_p(we.type,we.key,we.props,null,be.mode,Ve),Ve.ref=wh(be,ge,we),Ve.return=be,Ve)}function Se(be,ge,we,Ve){return ge===null||ge.tag!==4||ge.stateNode.containerInfo!==we.containerInfo||ge.stateNode.implementation!==we.implementation?(ge=bv(we,be.mode,Ve),ge.return=be,ge):(ge=z(ge,we.children||[]),ge.return=be,ge)}function je(be,ge,we,Ve,rt){return ge===null||ge.tag!==7?(ge=Oc(we,be.mode,Ve,rt),ge.return=be,ge):(ge=z(ge,we),ge.return=be,ge)}function De(be,ge,we){if(typeof ge=="string"&&ge!==""||typeof ge=="number")return ge=xv(""+ge,be.mode,we),ge.return=be,ge;if(typeof ge=="object"&&ge!==null){switch(ge.$$typeof){case j:return we=_p(ge.type,ge.key,ge.props,null,be.mode,we),we.ref=wh(be,null,ge),we.return=be,we;case U:return ge=bv(ge,be.mode,we),ge.return=be,ge;case te:var Ve=ge._init;return De(be,Ve(ge._payload),we)}if(Le(ge)||ne(ge))return ge=Oc(ge,be.mode,we,null),ge.return=be,ge;Ym(be,ge)}return null}function Ce(be,ge,we,Ve){var rt=ge!==null?ge.key:null;if(typeof we=="string"&&we!==""||typeof we=="number")return rt!==null?null:de(be,ge,""+we,Ve);if(typeof we=="object"&&we!==null){switch(we.$$typeof){case j:return we.key===rt?me(be,ge,we,Ve):null;case U:return we.key===rt?Se(be,ge,we,Ve):null;case te:return rt=we._init,Ce(be,ge,rt(we._payload),Ve)}if(Le(we)||ne(we))return rt!==null?null:je(be,ge,we,Ve,null);Ym(be,we)}return null}function Ge(be,ge,we,Ve,rt){if(typeof Ve=="string"&&Ve!==""||typeof Ve=="number")return be=be.get(we)||null,de(ge,be,""+Ve,rt);if(typeof Ve=="object"&&Ve!==null){switch(Ve.$$typeof){case j:return be=be.get(Ve.key===null?we:Ve.key)||null,me(ge,be,Ve,rt);case U:return be=be.get(Ve.key===null?we:Ve.key)||null,Se(ge,be,Ve,rt);case te:var dt=Ve._init;return Ge(be,ge,we,dt(Ve._payload),rt)}if(Le(Ve)||ne(Ve))return be=be.get(we)||null,je(ge,be,Ve,rt,null);Ym(ge,Ve)}return null}function Xe(be,ge,we,Ve){for(var rt=null,dt=null,ht=ge,Nt=ge=0,Er=null;ht!==null&&Nt<we.length;Nt++){ht.index>Nt?(Er=ht,ht=null):Er=ht.sibling;var Jt=Ce(be,ht,we[Nt],Ve);if(Jt===null){ht===null&&(ht=Er);break}a&&ht&&Jt.alternate===null&&h(be,ht),ge=H(Jt,ge,Nt),dt===null?rt=Jt:dt.sibling=Jt,dt=Jt,ht=Er}if(Nt===we.length)return v(be,ht),Cn&&Ac(be,Nt),rt;if(ht===null){for(;Nt<we.length;Nt++)ht=De(be,we[Nt],Ve),ht!==null&&(ge=H(ht,ge,Nt),dt===null?rt=ht:dt.sibling=ht,dt=ht);return Cn&&Ac(be,Nt),rt}for(ht=A(be,ht);Nt<we.length;Nt++)Er=Ge(ht,be,Nt,we[Nt],Ve),Er!==null&&(a&&Er.alternate!==null&&ht.delete(Er.key===null?Nt:Er.key),ge=H(Er,ge,Nt),dt===null?rt=Er:dt.sibling=Er,dt=Er);return a&&ht.forEach(function(Tl){return h(be,Tl)}),Cn&&Ac(be,Nt),rt}function nt(be,ge,we,Ve){var rt=ne(we);if(typeof rt!="function")throw Error(t(150));if(we=rt.call(we),we==null)throw Error(t(151));for(var dt=rt=null,ht=ge,Nt=ge=0,Er=null,Jt=we.next();ht!==null&&!Jt.done;Nt++,Jt=we.next()){ht.index>Nt?(Er=ht,ht=null):Er=ht.sibling;var Tl=Ce(be,ht,Jt.value,Ve);if(Tl===null){ht===null&&(ht=Er);break}a&&ht&&Tl.alternate===null&&h(be,ht),ge=H(Tl,ge,Nt),dt===null?rt=Tl:dt.sibling=Tl,dt=Tl,ht=Er}if(Jt.done)return v(be,ht),Cn&&Ac(be,Nt),rt;if(ht===null){for(;!Jt.done;Nt++,Jt=we.next())Jt=De(be,Jt.value,Ve),Jt!==null&&(ge=H(Jt,ge,Nt),dt===null?rt=Jt:dt.sibling=Jt,dt=Jt);return Cn&&Ac(be,Nt),rt}for(ht=A(be,ht);!Jt.done;Nt++,Jt=we.next())Jt=Ge(ht,be,Nt,Jt.value,Ve),Jt!==null&&(a&&Jt.alternate!==null&&ht.delete(Jt.key===null?Nt:Jt.key),ge=H(Jt,ge,Nt),dt===null?rt=Jt:dt.sibling=Jt,dt=Jt);return a&&ht.forEach(function(_5){return h(be,_5)}),Cn&&Ac(be,Nt),rt}function Yn(be,ge,we,Ve){if(typeof we=="object"&&we!==null&&we.type===C&&we.key===null&&(we=we.props.children),typeof we=="object"&&we!==null){switch(we.$$typeof){case j:e:{for(var rt=we.key,dt=ge;dt!==null;){if(dt.key===rt){if(rt=we.type,rt===C){if(dt.tag===7){v(be,dt.sibling),ge=z(dt,we.props.children),ge.return=be,be=ge;break e}}else if(dt.elementType===rt||typeof rt=="object"&&rt!==null&&rt.$$typeof===te&&hw(rt)===dt.type){v(be,dt.sibling),ge=z(dt,we.props),ge.ref=wh(be,dt,we),ge.return=be,be=ge;break e}v(be,dt);break}else h(be,dt);dt=dt.sibling}we.type===C?(ge=Oc(we.props.children,be.mode,Ve,we.key),ge.return=be,be=ge):(Ve=_p(we.type,we.key,we.props,null,be.mode,Ve),Ve.ref=wh(be,ge,we),Ve.return=be,be=Ve)}return ee(be);case U:e:{for(dt=we.key;ge!==null;){if(ge.key===dt)if(ge.tag===4&&ge.stateNode.containerInfo===we.containerInfo&&ge.stateNode.implementation===we.implementation){v(be,ge.sibling),ge=z(ge,we.children||[]),ge.return=be,be=ge;break e}else{v(be,ge);break}else h(be,ge);ge=ge.sibling}ge=bv(we,be.mode,Ve),ge.return=be,be=ge}return ee(be);case te:return dt=we._init,Yn(be,ge,dt(we._payload),Ve)}if(Le(we))return Xe(be,ge,we,Ve);if(ne(we))return nt(be,ge,we,Ve);Ym(be,we)}return typeof we=="string"&&we!==""||typeof we=="number"?(we=""+we,ge!==null&&ge.tag===6?(v(be,ge.sibling),ge=z(ge,we),ge.return=be,be=ge):(v(be,ge),ge=xv(we,be.mode,Ve),ge.return=be,be=ge),ee(be)):v(be,ge)}return Yn}var Hu=fw(!0),mw=fw(!1),Zm=ml(null),Qm=null,$u=null,P0=null;function C0(){P0=$u=Qm=null}function R0(a){var h=Zm.current;In(Zm),a._currentValue=h}function j0(a,h,v){for(;a!==null;){var A=a.alternate;if((a.childLanes&h)!==h?(a.childLanes|=h,A!==null&&(A.childLanes|=h)):A!==null&&(A.childLanes&h)!==h&&(A.childLanes|=h),a===v)break;a=a.return}}function Wu(a,h){Qm=a,P0=$u=null,a=a.dependencies,a!==null&&a.firstContext!==null&&((a.lanes&h)!==0&&(Ri=!0),a.firstContext=null)}function bs(a){var h=a._currentValue;if(P0!==a)if(a={context:a,memoizedValue:h,next:null},$u===null){if(Qm===null)throw Error(t(308));$u=a,Qm.dependencies={lanes:0,firstContext:a}}else $u=$u.next=a;return h}var Nc=null;function O0(a){Nc===null?Nc=[a]:Nc.push(a)}function pw(a,h,v,A){var z=h.interleaved;return z===null?(v.next=v,O0(h)):(v.next=z.next,z.next=v),h.interleaved=v,ca(a,A)}function ca(a,h){a.lanes|=h;var v=a.alternate;for(v!==null&&(v.lanes|=h),v=a,a=a.return;a!==null;)a.childLanes|=h,v=a.alternate,v!==null&&(v.childLanes|=h),v=a,a=a.return;return v.tag===3?v.stateNode:null}var yl=!1;function M0(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function gw(a,h){a=a.updateQueue,h.updateQueue===a&&(h.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function ua(a,h){return{eventTime:a,lane:h,tag:0,payload:null,callback:null,next:null}}function vl(a,h,v){var A=a.updateQueue;if(A===null)return null;if(A=A.shared,(Qt&2)!==0){var z=A.pending;return z===null?h.next=h:(h.next=z.next,z.next=h),A.pending=h,ca(a,v)}return z=A.interleaved,z===null?(h.next=h,O0(A)):(h.next=z.next,z.next=h),A.interleaved=h,ca(a,v)}function Xm(a,h,v){if(h=h.updateQueue,h!==null&&(h=h.shared,(v&4194240)!==0)){var A=h.lanes;A&=a.pendingLanes,v|=A,h.lanes=v,Vr(a,v)}}function yw(a,h){var v=a.updateQueue,A=a.alternate;if(A!==null&&(A=A.updateQueue,v===A)){var z=null,H=null;if(v=v.firstBaseUpdate,v!==null){do{var ee={eventTime:v.eventTime,lane:v.lane,tag:v.tag,payload:v.payload,callback:v.callback,next:null};H===null?z=H=ee:H=H.next=ee,v=v.next}while(v!==null);H===null?z=H=h:H=H.next=h}else z=H=h;v={baseState:A.baseState,firstBaseUpdate:z,lastBaseUpdate:H,shared:A.shared,effects:A.effects},a.updateQueue=v;return}a=v.lastBaseUpdate,a===null?v.firstBaseUpdate=h:a.next=h,v.lastBaseUpdate=h}function Jm(a,h,v,A){var z=a.updateQueue;yl=!1;var H=z.firstBaseUpdate,ee=z.lastBaseUpdate,de=z.shared.pending;if(de!==null){z.shared.pending=null;var me=de,Se=me.next;me.next=null,ee===null?H=Se:ee.next=Se,ee=me;var je=a.alternate;je!==null&&(je=je.updateQueue,de=je.lastBaseUpdate,de!==ee&&(de===null?je.firstBaseUpdate=Se:de.next=Se,je.lastBaseUpdate=me))}if(H!==null){var De=z.baseState;ee=0,je=Se=me=null,de=H;do{var Ce=de.lane,Ge=de.eventTime;if((A&Ce)===Ce){je!==null&&(je=je.next={eventTime:Ge,lane:0,tag:de.tag,payload:de.payload,callback:de.callback,next:null});e:{var Xe=a,nt=de;switch(Ce=h,Ge=v,nt.tag){case 1:if(Xe=nt.payload,typeof Xe=="function"){De=Xe.call(Ge,De,Ce);break e}De=Xe;break e;case 3:Xe.flags=Xe.flags&-65537|128;case 0:if(Xe=nt.payload,Ce=typeof Xe=="function"?Xe.call(Ge,De,Ce):Xe,Ce==null)break e;De=K({},De,Ce);break e;case 2:yl=!0}}de.callback!==null&&de.lane!==0&&(a.flags|=64,Ce=z.effects,Ce===null?z.effects=[de]:Ce.push(de))}else Ge={eventTime:Ge,lane:Ce,tag:de.tag,payload:de.payload,callback:de.callback,next:null},je===null?(Se=je=Ge,me=De):je=je.next=Ge,ee|=Ce;if(de=de.next,de===null){if(de=z.shared.pending,de===null)break;Ce=de,de=Ce.next,Ce.next=null,z.lastBaseUpdate=Ce,z.shared.pending=null}}while(!0);if(je===null&&(me=De),z.baseState=me,z.firstBaseUpdate=Se,z.lastBaseUpdate=je,h=z.shared.interleaved,h!==null){z=h;do ee|=z.lane,z=z.next;while(z!==h)}else H===null&&(z.shared.lanes=0);Pc|=ee,a.lanes=ee,a.memoizedState=De}}function vw(a,h,v){if(a=h.effects,h.effects=null,a!==null)for(h=0;h<a.length;h++){var A=a[h],z=A.callback;if(z!==null){if(A.callback=null,A=v,typeof z!="function")throw Error(t(191,z));z.call(A)}}}var Eh={},Eo=ml(Eh),Sh=ml(Eh),Th=ml(Eh);function Ic(a){if(a===Eh)throw Error(t(174));return a}function D0(a,h){switch(An(Th,h),An(Sh,a),An(Eo,Eh),a=h.nodeType,a){case 9:case 11:h=(h=h.documentElement)?h.namespaceURI:Ot(null,"");break;default:a=a===8?h.parentNode:h,h=a.namespaceURI||null,a=a.tagName,h=Ot(h,a)}In(Eo),An(Eo,h)}function Gu(){In(Eo),In(Sh),In(Th)}function _w(a){Ic(Th.current);var h=Ic(Eo.current),v=Ot(h,a.type);h!==v&&(An(Sh,a),An(Eo,v))}function L0(a){Sh.current===a&&(In(Eo),In(Sh))}var Ln=ml(0);function ep(a){for(var h=a;h!==null;){if(h.tag===13){var v=h.memoizedState;if(v!==null&&(v=v.dehydrated,v===null||v.data==="$?"||v.data==="$!"))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}var F0=[];function V0(){for(var a=0;a<F0.length;a++)F0[a]._workInProgressVersionPrimary=null;F0.length=0}var tp=I.ReactCurrentDispatcher,z0=I.ReactCurrentBatchConfig,kc=0,Fn=null,ur=null,br=null,np=!1,Ah=!1,Nh=0,BR=0;function Hr(){throw Error(t(321))}function B0(a,h){if(h===null)return!1;for(var v=0;v<h.length&&v<a.length;v++)if(!Qi(a[v],h[v]))return!1;return!0}function U0(a,h,v,A,z,H){if(kc=H,Fn=h,h.memoizedState=null,h.updateQueue=null,h.lanes=0,tp.current=a===null||a.memoizedState===null?$R:WR,a=v(A,z),Ah){H=0;do{if(Ah=!1,Nh=0,25<=H)throw Error(t(301));H+=1,br=ur=null,h.updateQueue=null,tp.current=GR,a=v(A,z)}while(Ah)}if(tp.current=sp,h=ur!==null&&ur.next!==null,kc=0,br=ur=Fn=null,np=!1,h)throw Error(t(300));return a}function q0(){var a=Nh!==0;return Nh=0,a}function So(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return br===null?Fn.memoizedState=br=a:br=br.next=a,br}function ws(){if(ur===null){var a=Fn.alternate;a=a!==null?a.memoizedState:null}else a=ur.next;var h=br===null?Fn.memoizedState:br.next;if(h!==null)br=h,ur=a;else{if(a===null)throw Error(t(310));ur=a,a={memoizedState:ur.memoizedState,baseState:ur.baseState,baseQueue:ur.baseQueue,queue:ur.queue,next:null},br===null?Fn.memoizedState=br=a:br=br.next=a}return br}function Ih(a,h){return typeof h=="function"?h(a):h}function H0(a){var h=ws(),v=h.queue;if(v===null)throw Error(t(311));v.lastRenderedReducer=a;var A=ur,z=A.baseQueue,H=v.pending;if(H!==null){if(z!==null){var ee=z.next;z.next=H.next,H.next=ee}A.baseQueue=z=H,v.pending=null}if(z!==null){H=z.next,A=A.baseState;var de=ee=null,me=null,Se=H;do{var je=Se.lane;if((kc&je)===je)me!==null&&(me=me.next={lane:0,action:Se.action,hasEagerState:Se.hasEagerState,eagerState:Se.eagerState,next:null}),A=Se.hasEagerState?Se.eagerState:a(A,Se.action);else{var De={lane:je,action:Se.action,hasEagerState:Se.hasEagerState,eagerState:Se.eagerState,next:null};me===null?(de=me=De,ee=A):me=me.next=De,Fn.lanes|=je,Pc|=je}Se=Se.next}while(Se!==null&&Se!==H);me===null?ee=A:me.next=de,Qi(A,h.memoizedState)||(Ri=!0),h.memoizedState=A,h.baseState=ee,h.baseQueue=me,v.lastRenderedState=A}if(a=v.interleaved,a!==null){z=a;do H=z.lane,Fn.lanes|=H,Pc|=H,z=z.next;while(z!==a)}else z===null&&(v.lanes=0);return[h.memoizedState,v.dispatch]}function $0(a){var h=ws(),v=h.queue;if(v===null)throw Error(t(311));v.lastRenderedReducer=a;var A=v.dispatch,z=v.pending,H=h.memoizedState;if(z!==null){v.pending=null;var ee=z=z.next;do H=a(H,ee.action),ee=ee.next;while(ee!==z);Qi(H,h.memoizedState)||(Ri=!0),h.memoizedState=H,h.baseQueue===null&&(h.baseState=H),v.lastRenderedState=H}return[H,A]}function xw(){}function bw(a,h){var v=Fn,A=ws(),z=h(),H=!Qi(A.memoizedState,z);if(H&&(A.memoizedState=z,Ri=!0),A=A.queue,W0(Sw.bind(null,v,A,a),[a]),A.getSnapshot!==h||H||br!==null&&br.memoizedState.tag&1){if(v.flags|=2048,kh(9,Ew.bind(null,v,A,z,h),void 0,null),wr===null)throw Error(t(349));(kc&30)!==0||ww(v,h,z)}return z}function ww(a,h,v){a.flags|=16384,a={getSnapshot:h,value:v},h=Fn.updateQueue,h===null?(h={lastEffect:null,stores:null},Fn.updateQueue=h,h.stores=[a]):(v=h.stores,v===null?h.stores=[a]:v.push(a))}function Ew(a,h,v,A){h.value=v,h.getSnapshot=A,Tw(h)&&Aw(a)}function Sw(a,h,v){return v(function(){Tw(h)&&Aw(a)})}function Tw(a){var h=a.getSnapshot;a=a.value;try{var v=h();return!Qi(a,v)}catch{return!0}}function Aw(a){var h=ca(a,1);h!==null&&Js(h,a,1,-1)}function Nw(a){var h=So();return typeof a=="function"&&(a=a()),h.memoizedState=h.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ih,lastRenderedState:a},h.queue=a,a=a.dispatch=HR.bind(null,Fn,a),[h.memoizedState,a]}function kh(a,h,v,A){return a={tag:a,create:h,destroy:v,deps:A,next:null},h=Fn.updateQueue,h===null?(h={lastEffect:null,stores:null},Fn.updateQueue=h,h.lastEffect=a.next=a):(v=h.lastEffect,v===null?h.lastEffect=a.next=a:(A=v.next,v.next=a,a.next=A,h.lastEffect=a)),a}function Iw(){return ws().memoizedState}function rp(a,h,v,A){var z=So();Fn.flags|=a,z.memoizedState=kh(1|h,v,void 0,A===void 0?null:A)}function ip(a,h,v,A){var z=ws();A=A===void 0?null:A;var H=void 0;if(ur!==null){var ee=ur.memoizedState;if(H=ee.destroy,A!==null&&B0(A,ee.deps)){z.memoizedState=kh(h,v,H,A);return}}Fn.flags|=a,z.memoizedState=kh(1|h,v,H,A)}function kw(a,h){return rp(8390656,8,a,h)}function W0(a,h){return ip(2048,8,a,h)}function Pw(a,h){return ip(4,2,a,h)}function Cw(a,h){return ip(4,4,a,h)}function Rw(a,h){if(typeof h=="function")return a=a(),h(a),function(){h(null)};if(h!=null)return a=a(),h.current=a,function(){h.current=null}}function jw(a,h,v){return v=v!=null?v.concat([a]):null,ip(4,4,Rw.bind(null,h,a),v)}function G0(){}function Ow(a,h){var v=ws();h=h===void 0?null:h;var A=v.memoizedState;return A!==null&&h!==null&&B0(h,A[1])?A[0]:(v.memoizedState=[a,h],a)}function Mw(a,h){var v=ws();h=h===void 0?null:h;var A=v.memoizedState;return A!==null&&h!==null&&B0(h,A[1])?A[0]:(a=a(),v.memoizedState=[a,h],a)}function Dw(a,h,v){return(kc&21)===0?(a.baseState&&(a.baseState=!1,Ri=!0),a.memoizedState=v):(Qi(v,h)||(v=$o(),Fn.lanes|=v,Pc|=v,a.baseState=!0),h)}function UR(a,h){var v=Ct;Ct=v!==0&&4>v?v:4,a(!0);var A=z0.transition;z0.transition={};try{a(!1),h()}finally{Ct=v,z0.transition=A}}function Lw(){return ws().memoizedState}function qR(a,h,v){var A=wl(a);if(v={lane:A,action:v,hasEagerState:!1,eagerState:null,next:null},Fw(a))Vw(h,v);else if(v=pw(a,h,v,A),v!==null){var z=li();Js(v,a,A,z),zw(v,h,A)}}function HR(a,h,v){var A=wl(a),z={lane:A,action:v,hasEagerState:!1,eagerState:null,next:null};if(Fw(a))Vw(h,z);else{var H=a.alternate;if(a.lanes===0&&(H===null||H.lanes===0)&&(H=h.lastRenderedReducer,H!==null))try{var ee=h.lastRenderedState,de=H(ee,v);if(z.hasEagerState=!0,z.eagerState=de,Qi(de,ee)){var me=h.interleaved;me===null?(z.next=z,O0(h)):(z.next=me.next,me.next=z),h.interleaved=z;return}}catch{}finally{}v=pw(a,h,z,A),v!==null&&(z=li(),Js(v,a,A,z),zw(v,h,A))}}function Fw(a){var h=a.alternate;return a===Fn||h!==null&&h===Fn}function Vw(a,h){Ah=np=!0;var v=a.pending;v===null?h.next=h:(h.next=v.next,v.next=h),a.pending=h}function zw(a,h,v){if((v&4194240)!==0){var A=h.lanes;A&=a.pendingLanes,v|=A,h.lanes=v,Vr(a,v)}}var sp={readContext:bs,useCallback:Hr,useContext:Hr,useEffect:Hr,useImperativeHandle:Hr,useInsertionEffect:Hr,useLayoutEffect:Hr,useMemo:Hr,useReducer:Hr,useRef:Hr,useState:Hr,useDebugValue:Hr,useDeferredValue:Hr,useTransition:Hr,useMutableSource:Hr,useSyncExternalStore:Hr,useId:Hr,unstable_isNewReconciler:!1},$R={readContext:bs,useCallback:function(a,h){return So().memoizedState=[a,h===void 0?null:h],a},useContext:bs,useEffect:kw,useImperativeHandle:function(a,h,v){return v=v!=null?v.concat([a]):null,rp(4194308,4,Rw.bind(null,h,a),v)},useLayoutEffect:function(a,h){return rp(4194308,4,a,h)},useInsertionEffect:function(a,h){return rp(4,2,a,h)},useMemo:function(a,h){var v=So();return h=h===void 0?null:h,a=a(),v.memoizedState=[a,h],a},useReducer:function(a,h,v){var A=So();return h=v!==void 0?v(h):h,A.memoizedState=A.baseState=h,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:h},A.queue=a,a=a.dispatch=qR.bind(null,Fn,a),[A.memoizedState,a]},useRef:function(a){var h=So();return a={current:a},h.memoizedState=a},useState:Nw,useDebugValue:G0,useDeferredValue:function(a){return So().memoizedState=a},useTransition:function(){var a=Nw(!1),h=a[0];return a=UR.bind(null,a[1]),So().memoizedState=a,[h,a]},useMutableSource:function(){},useSyncExternalStore:function(a,h,v){var A=Fn,z=So();if(Cn){if(v===void 0)throw Error(t(407));v=v()}else{if(v=h(),wr===null)throw Error(t(349));(kc&30)!==0||ww(A,h,v)}z.memoizedState=v;var H={value:v,getSnapshot:h};return z.queue=H,kw(Sw.bind(null,A,H,a),[a]),A.flags|=2048,kh(9,Ew.bind(null,A,H,v,h),void 0,null),v},useId:function(){var a=So(),h=wr.identifierPrefix;if(Cn){var v=la,A=aa;v=(A&~(1<<32-St(A)-1)).toString(32)+v,h=":"+h+"R"+v,v=Nh++,0<v&&(h+="H"+v.toString(32)),h+=":"}else v=BR++,h=":"+h+"r"+v.toString(32)+":";return a.memoizedState=h},unstable_isNewReconciler:!1},WR={readContext:bs,useCallback:Ow,useContext:bs,useEffect:W0,useImperativeHandle:jw,useInsertionEffect:Pw,useLayoutEffect:Cw,useMemo:Mw,useReducer:H0,useRef:Iw,useState:function(){return H0(Ih)},useDebugValue:G0,useDeferredValue:function(a){var h=ws();return Dw(h,ur.memoizedState,a)},useTransition:function(){var a=H0(Ih)[0],h=ws().memoizedState;return[a,h]},useMutableSource:xw,useSyncExternalStore:bw,useId:Lw,unstable_isNewReconciler:!1},GR={readContext:bs,useCallback:Ow,useContext:bs,useEffect:W0,useImperativeHandle:jw,useInsertionEffect:Pw,useLayoutEffect:Cw,useMemo:Mw,useReducer:$0,useRef:Iw,useState:function(){return $0(Ih)},useDebugValue:G0,useDeferredValue:function(a){var h=ws();return ur===null?h.memoizedState=a:Dw(h,ur.memoizedState,a)},useTransition:function(){var a=$0(Ih)[0],h=ws().memoizedState;return[a,h]},useMutableSource:xw,useSyncExternalStore:bw,useId:Lw,unstable_isNewReconciler:!1};function Zs(a,h){if(a&&a.defaultProps){h=K({},h),a=a.defaultProps;for(var v in a)h[v]===void 0&&(h[v]=a[v]);return h}return h}function K0(a,h,v,A){h=a.memoizedState,v=v(A,h),v=v==null?h:K({},h,v),a.memoizedState=v,a.lanes===0&&(a.updateQueue.baseState=v)}var op={isMounted:function(a){return(a=a._reactInternals)?Ir(a)===a:!1},enqueueSetState:function(a,h,v){a=a._reactInternals;var A=li(),z=wl(a),H=ua(A,z);H.payload=h,v!=null&&(H.callback=v),h=vl(a,H,z),h!==null&&(Js(h,a,z,A),Xm(h,a,z))},enqueueReplaceState:function(a,h,v){a=a._reactInternals;var A=li(),z=wl(a),H=ua(A,z);H.tag=1,H.payload=h,v!=null&&(H.callback=v),h=vl(a,H,z),h!==null&&(Js(h,a,z,A),Xm(h,a,z))},enqueueForceUpdate:function(a,h){a=a._reactInternals;var v=li(),A=wl(a),z=ua(v,A);z.tag=2,h!=null&&(z.callback=h),h=vl(a,z,A),h!==null&&(Js(h,a,A,v),Xm(h,a,A))}};function Bw(a,h,v,A,z,H,ee){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(A,H,ee):h.prototype&&h.prototype.isPureReactComponent?!_o(v,A)||!_o(z,H):!0}function Uw(a,h,v){var A=!1,z=pl,H=h.contextType;return typeof H=="object"&&H!==null?H=bs(H):(z=Ci(h)?Sc:qr.current,A=h.contextTypes,H=(A=A!=null)?zu(a,z):pl),h=new h(v,H),a.memoizedState=h.state!==null&&h.state!==void 0?h.state:null,h.updater=op,a.stateNode=h,h._reactInternals=a,A&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=z,a.__reactInternalMemoizedMaskedChildContext=H),h}function qw(a,h,v,A){a=h.state,typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(v,A),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(v,A),h.state!==a&&op.enqueueReplaceState(h,h.state,null)}function Y0(a,h,v,A){var z=a.stateNode;z.props=v,z.state=a.memoizedState,z.refs={},M0(a);var H=h.contextType;typeof H=="object"&&H!==null?z.context=bs(H):(H=Ci(h)?Sc:qr.current,z.context=zu(a,H)),z.state=a.memoizedState,H=h.getDerivedStateFromProps,typeof H=="function"&&(K0(a,h,H,v),z.state=a.memoizedState),typeof h.getDerivedStateFromProps=="function"||typeof z.getSnapshotBeforeUpdate=="function"||typeof z.UNSAFE_componentWillMount!="function"&&typeof z.componentWillMount!="function"||(h=z.state,typeof z.componentWillMount=="function"&&z.componentWillMount(),typeof z.UNSAFE_componentWillMount=="function"&&z.UNSAFE_componentWillMount(),h!==z.state&&op.enqueueReplaceState(z,z.state,null),Jm(a,v,z,A),z.state=a.memoizedState),typeof z.componentDidMount=="function"&&(a.flags|=4194308)}function Ku(a,h){try{var v="",A=h;do v+=le(A),A=A.return;while(A);var z=v}catch(H){z=`
Error generating stack: `+H.message+`
`+H.stack}return{value:a,source:h,stack:z,digest:null}}function Z0(a,h,v){return{value:a,source:null,stack:v??null,digest:h??null}}function Q0(a,h){try{console.error(h.value)}catch(v){setTimeout(function(){throw v})}}var KR=typeof WeakMap=="function"?WeakMap:Map;function Hw(a,h,v){v=ua(-1,v),v.tag=3,v.payload={element:null};var A=h.value;return v.callback=function(){fp||(fp=!0,hv=A),Q0(a,h)},v}function $w(a,h,v){v=ua(-1,v),v.tag=3;var A=a.type.getDerivedStateFromError;if(typeof A=="function"){var z=h.value;v.payload=function(){return A(z)},v.callback=function(){Q0(a,h)}}var H=a.stateNode;return H!==null&&typeof H.componentDidCatch=="function"&&(v.callback=function(){Q0(a,h),typeof A!="function"&&(xl===null?xl=new Set([this]):xl.add(this));var ee=h.stack;this.componentDidCatch(h.value,{componentStack:ee!==null?ee:""})}),v}function Ww(a,h,v){var A=a.pingCache;if(A===null){A=a.pingCache=new KR;var z=new Set;A.set(h,z)}else z=A.get(h),z===void 0&&(z=new Set,A.set(h,z));z.has(v)||(z.add(v),a=l5.bind(null,a,h,v),h.then(a,a))}function Gw(a){do{var h;if((h=a.tag===13)&&(h=a.memoizedState,h=h!==null?h.dehydrated!==null:!0),h)return a;a=a.return}while(a!==null);return null}function Kw(a,h,v,A,z){return(a.mode&1)===0?(a===h?a.flags|=65536:(a.flags|=128,v.flags|=131072,v.flags&=-52805,v.tag===1&&(v.alternate===null?v.tag=17:(h=ua(-1,1),h.tag=2,vl(v,h,1))),v.lanes|=1),a):(a.flags|=65536,a.lanes=z,a)}var YR=I.ReactCurrentOwner,Ri=!1;function ai(a,h,v,A){h.child=a===null?mw(h,null,v,A):Hu(h,a.child,v,A)}function Yw(a,h,v,A,z){v=v.render;var H=h.ref;return Wu(h,z),A=U0(a,h,v,A,H,z),v=q0(),a!==null&&!Ri?(h.updateQueue=a.updateQueue,h.flags&=-2053,a.lanes&=~z,da(a,h,z)):(Cn&&v&&T0(h),h.flags|=1,ai(a,h,A,z),h.child)}function Zw(a,h,v,A,z){if(a===null){var H=v.type;return typeof H=="function"&&!_v(H)&&H.defaultProps===void 0&&v.compare===null&&v.defaultProps===void 0?(h.tag=15,h.type=H,Qw(a,h,H,A,z)):(a=_p(v.type,null,A,h,h.mode,z),a.ref=h.ref,a.return=h,h.child=a)}if(H=a.child,(a.lanes&z)===0){var ee=H.memoizedProps;if(v=v.compare,v=v!==null?v:_o,v(ee,A)&&a.ref===h.ref)return da(a,h,z)}return h.flags|=1,a=Sl(H,A),a.ref=h.ref,a.return=h,h.child=a}function Qw(a,h,v,A,z){if(a!==null){var H=a.memoizedProps;if(_o(H,A)&&a.ref===h.ref)if(Ri=!1,h.pendingProps=A=H,(a.lanes&z)!==0)(a.flags&131072)!==0&&(Ri=!0);else return h.lanes=a.lanes,da(a,h,z)}return X0(a,h,v,A,z)}function Xw(a,h,v){var A=h.pendingProps,z=A.children,H=a!==null?a.memoizedState:null;if(A.mode==="hidden")if((h.mode&1)===0)h.memoizedState={baseLanes:0,cachePool:null,transitions:null},An(Zu,ts),ts|=v;else{if((v&1073741824)===0)return a=H!==null?H.baseLanes|v:v,h.lanes=h.childLanes=1073741824,h.memoizedState={baseLanes:a,cachePool:null,transitions:null},h.updateQueue=null,An(Zu,ts),ts|=a,null;h.memoizedState={baseLanes:0,cachePool:null,transitions:null},A=H!==null?H.baseLanes:v,An(Zu,ts),ts|=A}else H!==null?(A=H.baseLanes|v,h.memoizedState=null):A=v,An(Zu,ts),ts|=A;return ai(a,h,z,v),h.child}function Jw(a,h){var v=h.ref;(a===null&&v!==null||a!==null&&a.ref!==v)&&(h.flags|=512,h.flags|=2097152)}function X0(a,h,v,A,z){var H=Ci(v)?Sc:qr.current;return H=zu(h,H),Wu(h,z),v=U0(a,h,v,A,H,z),A=q0(),a!==null&&!Ri?(h.updateQueue=a.updateQueue,h.flags&=-2053,a.lanes&=~z,da(a,h,z)):(Cn&&A&&T0(h),h.flags|=1,ai(a,h,v,z),h.child)}function eE(a,h,v,A,z){if(Ci(v)){var H=!0;Hm(h)}else H=!1;if(Wu(h,z),h.stateNode===null)lp(a,h),Uw(h,v,A),Y0(h,v,A,z),A=!0;else if(a===null){var ee=h.stateNode,de=h.memoizedProps;ee.props=de;var me=ee.context,Se=v.contextType;typeof Se=="object"&&Se!==null?Se=bs(Se):(Se=Ci(v)?Sc:qr.current,Se=zu(h,Se));var je=v.getDerivedStateFromProps,De=typeof je=="function"||typeof ee.getSnapshotBeforeUpdate=="function";De||typeof ee.UNSAFE_componentWillReceiveProps!="function"&&typeof ee.componentWillReceiveProps!="function"||(de!==A||me!==Se)&&qw(h,ee,A,Se),yl=!1;var Ce=h.memoizedState;ee.state=Ce,Jm(h,A,ee,z),me=h.memoizedState,de!==A||Ce!==me||Pi.current||yl?(typeof je=="function"&&(K0(h,v,je,A),me=h.memoizedState),(de=yl||Bw(h,v,de,A,Ce,me,Se))?(De||typeof ee.UNSAFE_componentWillMount!="function"&&typeof ee.componentWillMount!="function"||(typeof ee.componentWillMount=="function"&&ee.componentWillMount(),typeof ee.UNSAFE_componentWillMount=="function"&&ee.UNSAFE_componentWillMount()),typeof ee.componentDidMount=="function"&&(h.flags|=4194308)):(typeof ee.componentDidMount=="function"&&(h.flags|=4194308),h.memoizedProps=A,h.memoizedState=me),ee.props=A,ee.state=me,ee.context=Se,A=de):(typeof ee.componentDidMount=="function"&&(h.flags|=4194308),A=!1)}else{ee=h.stateNode,gw(a,h),de=h.memoizedProps,Se=h.type===h.elementType?de:Zs(h.type,de),ee.props=Se,De=h.pendingProps,Ce=ee.context,me=v.contextType,typeof me=="object"&&me!==null?me=bs(me):(me=Ci(v)?Sc:qr.current,me=zu(h,me));var Ge=v.getDerivedStateFromProps;(je=typeof Ge=="function"||typeof ee.getSnapshotBeforeUpdate=="function")||typeof ee.UNSAFE_componentWillReceiveProps!="function"&&typeof ee.componentWillReceiveProps!="function"||(de!==De||Ce!==me)&&qw(h,ee,A,me),yl=!1,Ce=h.memoizedState,ee.state=Ce,Jm(h,A,ee,z);var Xe=h.memoizedState;de!==De||Ce!==Xe||Pi.current||yl?(typeof Ge=="function"&&(K0(h,v,Ge,A),Xe=h.memoizedState),(Se=yl||Bw(h,v,Se,A,Ce,Xe,me)||!1)?(je||typeof ee.UNSAFE_componentWillUpdate!="function"&&typeof ee.componentWillUpdate!="function"||(typeof ee.componentWillUpdate=="function"&&ee.componentWillUpdate(A,Xe,me),typeof ee.UNSAFE_componentWillUpdate=="function"&&ee.UNSAFE_componentWillUpdate(A,Xe,me)),typeof ee.componentDidUpdate=="function"&&(h.flags|=4),typeof ee.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof ee.componentDidUpdate!="function"||de===a.memoizedProps&&Ce===a.memoizedState||(h.flags|=4),typeof ee.getSnapshotBeforeUpdate!="function"||de===a.memoizedProps&&Ce===a.memoizedState||(h.flags|=1024),h.memoizedProps=A,h.memoizedState=Xe),ee.props=A,ee.state=Xe,ee.context=me,A=Se):(typeof ee.componentDidUpdate!="function"||de===a.memoizedProps&&Ce===a.memoizedState||(h.flags|=4),typeof ee.getSnapshotBeforeUpdate!="function"||de===a.memoizedProps&&Ce===a.memoizedState||(h.flags|=1024),A=!1)}return J0(a,h,v,A,H,z)}function J0(a,h,v,A,z,H){Jw(a,h);var ee=(h.flags&128)!==0;if(!A&&!ee)return z&&sw(h,v,!1),da(a,h,H);A=h.stateNode,YR.current=h;var de=ee&&typeof v.getDerivedStateFromError!="function"?null:A.render();return h.flags|=1,a!==null&&ee?(h.child=Hu(h,a.child,null,H),h.child=Hu(h,null,de,H)):ai(a,h,de,H),h.memoizedState=A.state,z&&sw(h,v,!0),h.child}function tE(a){var h=a.stateNode;h.pendingContext?rw(a,h.pendingContext,h.pendingContext!==h.context):h.context&&rw(a,h.context,!1),D0(a,h.containerInfo)}function nE(a,h,v,A,z){return qu(),k0(z),h.flags|=256,ai(a,h,v,A),h.child}var ev={dehydrated:null,treeContext:null,retryLane:0};function tv(a){return{baseLanes:a,cachePool:null,transitions:null}}function rE(a,h,v){var A=h.pendingProps,z=Ln.current,H=!1,ee=(h.flags&128)!==0,de;if((de=ee)||(de=a!==null&&a.memoizedState===null?!1:(z&2)!==0),de?(H=!0,h.flags&=-129):(a===null||a.memoizedState!==null)&&(z|=1),An(Ln,z&1),a===null)return I0(h),a=h.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?((h.mode&1)===0?h.lanes=1:a.data==="$!"?h.lanes=8:h.lanes=1073741824,null):(ee=A.children,a=A.fallback,H?(A=h.mode,H=h.child,ee={mode:"hidden",children:ee},(A&1)===0&&H!==null?(H.childLanes=0,H.pendingProps=ee):H=xp(ee,A,0,null),a=Oc(a,A,v,null),H.return=h,a.return=h,H.sibling=a,h.child=H,h.child.memoizedState=tv(v),h.memoizedState=ev,a):nv(h,ee));if(z=a.memoizedState,z!==null&&(de=z.dehydrated,de!==null))return ZR(a,h,ee,A,de,z,v);if(H){H=A.fallback,ee=h.mode,z=a.child,de=z.sibling;var me={mode:"hidden",children:A.children};return(ee&1)===0&&h.child!==z?(A=h.child,A.childLanes=0,A.pendingProps=me,h.deletions=null):(A=Sl(z,me),A.subtreeFlags=z.subtreeFlags&14680064),de!==null?H=Sl(de,H):(H=Oc(H,ee,v,null),H.flags|=2),H.return=h,A.return=h,A.sibling=H,h.child=A,A=H,H=h.child,ee=a.child.memoizedState,ee=ee===null?tv(v):{baseLanes:ee.baseLanes|v,cachePool:null,transitions:ee.transitions},H.memoizedState=ee,H.childLanes=a.childLanes&~v,h.memoizedState=ev,A}return H=a.child,a=H.sibling,A=Sl(H,{mode:"visible",children:A.children}),(h.mode&1)===0&&(A.lanes=v),A.return=h,A.sibling=null,a!==null&&(v=h.deletions,v===null?(h.deletions=[a],h.flags|=16):v.push(a)),h.child=A,h.memoizedState=null,A}function nv(a,h){return h=xp({mode:"visible",children:h},a.mode,0,null),h.return=a,a.child=h}function ap(a,h,v,A){return A!==null&&k0(A),Hu(h,a.child,null,v),a=nv(h,h.pendingProps.children),a.flags|=2,h.memoizedState=null,a}function ZR(a,h,v,A,z,H,ee){if(v)return h.flags&256?(h.flags&=-257,A=Z0(Error(t(422))),ap(a,h,ee,A)):h.memoizedState!==null?(h.child=a.child,h.flags|=128,null):(H=A.fallback,z=h.mode,A=xp({mode:"visible",children:A.children},z,0,null),H=Oc(H,z,ee,null),H.flags|=2,A.return=h,H.return=h,A.sibling=H,h.child=A,(h.mode&1)!==0&&Hu(h,a.child,null,ee),h.child.memoizedState=tv(ee),h.memoizedState=ev,H);if((h.mode&1)===0)return ap(a,h,ee,null);if(z.data==="$!"){if(A=z.nextSibling&&z.nextSibling.dataset,A)var de=A.dgst;return A=de,H=Error(t(419)),A=Z0(H,A,void 0),ap(a,h,ee,A)}if(de=(ee&a.childLanes)!==0,Ri||de){if(A=wr,A!==null){switch(ee&-ee){case 4:z=2;break;case 16:z=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:z=32;break;case 536870912:z=268435456;break;default:z=0}z=(z&(A.suspendedLanes|ee))!==0?0:z,z!==0&&z!==H.retryLane&&(H.retryLane=z,ca(a,z),Js(A,a,z,-1))}return vv(),A=Z0(Error(t(421))),ap(a,h,ee,A)}return z.data==="$?"?(h.flags|=128,h.child=a.child,h=c5.bind(null,a),z._reactRetry=h,null):(a=H.treeContext,es=wo(z.nextSibling),Ji=h,Cn=!0,Ys=null,a!==null&&(_s[xs++]=aa,_s[xs++]=la,_s[xs++]=Tc,aa=a.id,la=a.overflow,Tc=h),h=nv(h,A.children),h.flags|=4096,h)}function iE(a,h,v){a.lanes|=h;var A=a.alternate;A!==null&&(A.lanes|=h),j0(a.return,h,v)}function rv(a,h,v,A,z){var H=a.memoizedState;H===null?a.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:A,tail:v,tailMode:z}:(H.isBackwards=h,H.rendering=null,H.renderingStartTime=0,H.last=A,H.tail=v,H.tailMode=z)}function sE(a,h,v){var A=h.pendingProps,z=A.revealOrder,H=A.tail;if(ai(a,h,A.children,v),A=Ln.current,(A&2)!==0)A=A&1|2,h.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=h.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&iE(a,v,h);else if(a.tag===19)iE(a,v,h);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===h)break e;for(;a.sibling===null;){if(a.return===null||a.return===h)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}A&=1}if(An(Ln,A),(h.mode&1)===0)h.memoizedState=null;else switch(z){case"forwards":for(v=h.child,z=null;v!==null;)a=v.alternate,a!==null&&ep(a)===null&&(z=v),v=v.sibling;v=z,v===null?(z=h.child,h.child=null):(z=v.sibling,v.sibling=null),rv(h,!1,z,v,H);break;case"backwards":for(v=null,z=h.child,h.child=null;z!==null;){if(a=z.alternate,a!==null&&ep(a)===null){h.child=z;break}a=z.sibling,z.sibling=v,v=z,z=a}rv(h,!0,v,null,H);break;case"together":rv(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function lp(a,h){(h.mode&1)===0&&a!==null&&(a.alternate=null,h.alternate=null,h.flags|=2)}function da(a,h,v){if(a!==null&&(h.dependencies=a.dependencies),Pc|=h.lanes,(v&h.childLanes)===0)return null;if(a!==null&&h.child!==a.child)throw Error(t(153));if(h.child!==null){for(a=h.child,v=Sl(a,a.pendingProps),h.child=v,v.return=h;a.sibling!==null;)a=a.sibling,v=v.sibling=Sl(a,a.pendingProps),v.return=h;v.sibling=null}return h.child}function QR(a,h,v){switch(h.tag){case 3:tE(h),qu();break;case 5:_w(h);break;case 1:Ci(h.type)&&Hm(h);break;case 4:D0(h,h.stateNode.containerInfo);break;case 10:var A=h.type._context,z=h.memoizedProps.value;An(Zm,A._currentValue),A._currentValue=z;break;case 13:if(A=h.memoizedState,A!==null)return A.dehydrated!==null?(An(Ln,Ln.current&1),h.flags|=128,null):(v&h.child.childLanes)!==0?rE(a,h,v):(An(Ln,Ln.current&1),a=da(a,h,v),a!==null?a.sibling:null);An(Ln,Ln.current&1);break;case 19:if(A=(v&h.childLanes)!==0,(a.flags&128)!==0){if(A)return sE(a,h,v);h.flags|=128}if(z=h.memoizedState,z!==null&&(z.rendering=null,z.tail=null,z.lastEffect=null),An(Ln,Ln.current),A)break;return null;case 22:case 23:return h.lanes=0,Xw(a,h,v)}return da(a,h,v)}var oE,iv,aE,lE;oE=function(a,h){for(var v=h.child;v!==null;){if(v.tag===5||v.tag===6)a.appendChild(v.stateNode);else if(v.tag!==4&&v.child!==null){v.child.return=v,v=v.child;continue}if(v===h)break;for(;v.sibling===null;){if(v.return===null||v.return===h)return;v=v.return}v.sibling.return=v.return,v=v.sibling}},iv=function(){},aE=function(a,h,v,A){var z=a.memoizedProps;if(z!==A){a=h.stateNode,Ic(Eo.current);var H=null;switch(v){case"input":z=yt(a,z),A=yt(a,A),H=[];break;case"select":z=K({},z,{value:void 0}),A=K({},A,{value:void 0}),H=[];break;case"textarea":z=ke(a,z),A=ke(a,A),H=[];break;default:typeof z.onClick!="function"&&typeof A.onClick=="function"&&(a.onclick=Pe)}vi(v,A);var ee;v=null;for(Se in z)if(!A.hasOwnProperty(Se)&&z.hasOwnProperty(Se)&&z[Se]!=null)if(Se==="style"){var de=z[Se];for(ee in de)de.hasOwnProperty(ee)&&(v||(v={}),v[ee]="")}else Se!=="dangerouslySetInnerHTML"&&Se!=="children"&&Se!=="suppressContentEditableWarning"&&Se!=="suppressHydrationWarning"&&Se!=="autoFocus"&&(i.hasOwnProperty(Se)?H||(H=[]):(H=H||[]).push(Se,null));for(Se in A){var me=A[Se];if(de=z!=null?z[Se]:void 0,A.hasOwnProperty(Se)&&me!==de&&(me!=null||de!=null))if(Se==="style")if(de){for(ee in de)!de.hasOwnProperty(ee)||me&&me.hasOwnProperty(ee)||(v||(v={}),v[ee]="");for(ee in me)me.hasOwnProperty(ee)&&de[ee]!==me[ee]&&(v||(v={}),v[ee]=me[ee])}else v||(H||(H=[]),H.push(Se,v)),v=me;else Se==="dangerouslySetInnerHTML"?(me=me?me.__html:void 0,de=de?de.__html:void 0,me!=null&&de!==me&&(H=H||[]).push(Se,me)):Se==="children"?typeof me!="string"&&typeof me!="number"||(H=H||[]).push(Se,""+me):Se!=="suppressContentEditableWarning"&&Se!=="suppressHydrationWarning"&&(i.hasOwnProperty(Se)?(me!=null&&Se==="onScroll"&&_n("scroll",a),H||de===me||(H=[])):(H=H||[]).push(Se,me))}v&&(H=H||[]).push("style",v);var Se=H;(h.updateQueue=Se)&&(h.flags|=4)}},lE=function(a,h,v,A){v!==A&&(h.flags|=4)};function Ph(a,h){if(!Cn)switch(a.tailMode){case"hidden":h=a.tail;for(var v=null;h!==null;)h.alternate!==null&&(v=h),h=h.sibling;v===null?a.tail=null:v.sibling=null;break;case"collapsed":v=a.tail;for(var A=null;v!==null;)v.alternate!==null&&(A=v),v=v.sibling;A===null?h||a.tail===null?a.tail=null:a.tail.sibling=null:A.sibling=null}}function $r(a){var h=a.alternate!==null&&a.alternate.child===a.child,v=0,A=0;if(h)for(var z=a.child;z!==null;)v|=z.lanes|z.childLanes,A|=z.subtreeFlags&14680064,A|=z.flags&14680064,z.return=a,z=z.sibling;else for(z=a.child;z!==null;)v|=z.lanes|z.childLanes,A|=z.subtreeFlags,A|=z.flags,z.return=a,z=z.sibling;return a.subtreeFlags|=A,a.childLanes=v,h}function XR(a,h,v){var A=h.pendingProps;switch(A0(h),h.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return $r(h),null;case 1:return Ci(h.type)&&qm(),$r(h),null;case 3:return A=h.stateNode,Gu(),In(Pi),In(qr),V0(),A.pendingContext&&(A.context=A.pendingContext,A.pendingContext=null),(a===null||a.child===null)&&(Km(h)?h.flags|=4:a===null||a.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,Ys!==null&&(pv(Ys),Ys=null))),iv(a,h),$r(h),null;case 5:L0(h);var z=Ic(Th.current);if(v=h.type,a!==null&&h.stateNode!=null)aE(a,h,v,A,z),a.ref!==h.ref&&(h.flags|=512,h.flags|=2097152);else{if(!A){if(h.stateNode===null)throw Error(t(166));return $r(h),null}if(a=Ic(Eo.current),Km(h)){A=h.stateNode,v=h.type;var H=h.memoizedProps;switch(A[vs]=h,A[hl]=H,a=(h.mode&1)!==0,v){case"dialog":_n("cancel",A),_n("close",A);break;case"iframe":case"object":case"embed":_n("load",A);break;case"video":case"audio":for(z=0;z<cl.length;z++)_n(cl[z],A);break;case"source":_n("error",A);break;case"img":case"image":case"link":_n("error",A),_n("load",A);break;case"details":_n("toggle",A);break;case"input":At(A,H),_n("invalid",A);break;case"select":A._wrapperState={wasMultiple:!!H.multiple},_n("invalid",A);break;case"textarea":vt(A,H),_n("invalid",A)}vi(v,H),z=null;for(var ee in H)if(H.hasOwnProperty(ee)){var de=H[ee];ee==="children"?typeof de=="string"?A.textContent!==de&&(H.suppressHydrationWarning!==!0&&Ee(A.textContent,de,a),z=["children",de]):typeof de=="number"&&A.textContent!==""+de&&(H.suppressHydrationWarning!==!0&&Ee(A.textContent,de,a),z=["children",""+de]):i.hasOwnProperty(ee)&&de!=null&&ee==="onScroll"&&_n("scroll",A)}switch(v){case"input":Oe(A),Ae(A,H,!0);break;case"textarea":Oe(A),pt(A);break;case"select":case"option":break;default:typeof H.onClick=="function"&&(A.onclick=Pe)}A=z,h.updateQueue=A,A!==null&&(h.flags|=4)}else{ee=z.nodeType===9?z:z.ownerDocument,a==="http://www.w3.org/1999/xhtml"&&(a=kt(v)),a==="http://www.w3.org/1999/xhtml"?v==="script"?(a=ee.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild)):typeof A.is=="string"?a=ee.createElement(v,{is:A.is}):(a=ee.createElement(v),v==="select"&&(ee=a,A.multiple?ee.multiple=!0:A.size&&(ee.size=A.size))):a=ee.createElementNS(a,v),a[vs]=h,a[hl]=A,oE(a,h,!1,!1),h.stateNode=a;e:{switch(ee=ti(v,A),v){case"dialog":_n("cancel",a),_n("close",a),z=A;break;case"iframe":case"object":case"embed":_n("load",a),z=A;break;case"video":case"audio":for(z=0;z<cl.length;z++)_n(cl[z],a);z=A;break;case"source":_n("error",a),z=A;break;case"img":case"image":case"link":_n("error",a),_n("load",a),z=A;break;case"details":_n("toggle",a),z=A;break;case"input":At(a,A),z=yt(a,A),_n("invalid",a);break;case"option":z=A;break;case"select":a._wrapperState={wasMultiple:!!A.multiple},z=K({},A,{value:void 0}),_n("invalid",a);break;case"textarea":vt(a,A),z=ke(a,A),_n("invalid",a);break;default:z=A}vi(v,z),de=z;for(H in de)if(de.hasOwnProperty(H)){var me=de[H];H==="style"?yi(a,me):H==="dangerouslySetInnerHTML"?(me=me?me.__html:void 0,me!=null&&ls(a,me)):H==="children"?typeof me=="string"?(v!=="textarea"||me!=="")&&Ht(a,me):typeof me=="number"&&Ht(a,""+me):H!=="suppressContentEditableWarning"&&H!=="suppressHydrationWarning"&&H!=="autoFocus"&&(i.hasOwnProperty(H)?me!=null&&H==="onScroll"&&_n("scroll",a):me!=null&&R(a,H,me,ee))}switch(v){case"input":Oe(a),Ae(a,A,!1);break;case"textarea":Oe(a),pt(a);break;case"option":A.value!=null&&a.setAttribute("value",""+ue(A.value));break;case"select":a.multiple=!!A.multiple,H=A.value,H!=null?ze(a,!!A.multiple,H,!1):A.defaultValue!=null&&ze(a,!!A.multiple,A.defaultValue,!0);break;default:typeof z.onClick=="function"&&(a.onclick=Pe)}switch(v){case"button":case"input":case"select":case"textarea":A=!!A.autoFocus;break e;case"img":A=!0;break e;default:A=!1}}A&&(h.flags|=4)}h.ref!==null&&(h.flags|=512,h.flags|=2097152)}return $r(h),null;case 6:if(a&&h.stateNode!=null)lE(a,h,a.memoizedProps,A);else{if(typeof A!="string"&&h.stateNode===null)throw Error(t(166));if(v=Ic(Th.current),Ic(Eo.current),Km(h)){if(A=h.stateNode,v=h.memoizedProps,A[vs]=h,(H=A.nodeValue!==v)&&(a=Ji,a!==null))switch(a.tag){case 3:Ee(A.nodeValue,v,(a.mode&1)!==0);break;case 5:a.memoizedProps.suppressHydrationWarning!==!0&&Ee(A.nodeValue,v,(a.mode&1)!==0)}H&&(h.flags|=4)}else A=(v.nodeType===9?v:v.ownerDocument).createTextNode(A),A[vs]=h,h.stateNode=A}return $r(h),null;case 13:if(In(Ln),A=h.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(Cn&&es!==null&&(h.mode&1)!==0&&(h.flags&128)===0)dw(),qu(),h.flags|=98560,H=!1;else if(H=Km(h),A!==null&&A.dehydrated!==null){if(a===null){if(!H)throw Error(t(318));if(H=h.memoizedState,H=H!==null?H.dehydrated:null,!H)throw Error(t(317));H[vs]=h}else qu(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4;$r(h),H=!1}else Ys!==null&&(pv(Ys),Ys=null),H=!0;if(!H)return h.flags&65536?h:null}return(h.flags&128)!==0?(h.lanes=v,h):(A=A!==null,A!==(a!==null&&a.memoizedState!==null)&&A&&(h.child.flags|=8192,(h.mode&1)!==0&&(a===null||(Ln.current&1)!==0?dr===0&&(dr=3):vv())),h.updateQueue!==null&&(h.flags|=4),$r(h),null);case 4:return Gu(),iv(a,h),a===null&&ul(h.stateNode.containerInfo),$r(h),null;case 10:return R0(h.type._context),$r(h),null;case 17:return Ci(h.type)&&qm(),$r(h),null;case 19:if(In(Ln),H=h.memoizedState,H===null)return $r(h),null;if(A=(h.flags&128)!==0,ee=H.rendering,ee===null)if(A)Ph(H,!1);else{if(dr!==0||a!==null&&(a.flags&128)!==0)for(a=h.child;a!==null;){if(ee=ep(a),ee!==null){for(h.flags|=128,Ph(H,!1),A=ee.updateQueue,A!==null&&(h.updateQueue=A,h.flags|=4),h.subtreeFlags=0,A=v,v=h.child;v!==null;)H=v,a=A,H.flags&=14680066,ee=H.alternate,ee===null?(H.childLanes=0,H.lanes=a,H.child=null,H.subtreeFlags=0,H.memoizedProps=null,H.memoizedState=null,H.updateQueue=null,H.dependencies=null,H.stateNode=null):(H.childLanes=ee.childLanes,H.lanes=ee.lanes,H.child=ee.child,H.subtreeFlags=0,H.deletions=null,H.memoizedProps=ee.memoizedProps,H.memoizedState=ee.memoizedState,H.updateQueue=ee.updateQueue,H.type=ee.type,a=ee.dependencies,H.dependencies=a===null?null:{lanes:a.lanes,firstContext:a.firstContext}),v=v.sibling;return An(Ln,Ln.current&1|2),h.child}a=a.sibling}H.tail!==null&&It()>Qu&&(h.flags|=128,A=!0,Ph(H,!1),h.lanes=4194304)}else{if(!A)if(a=ep(ee),a!==null){if(h.flags|=128,A=!0,v=a.updateQueue,v!==null&&(h.updateQueue=v,h.flags|=4),Ph(H,!0),H.tail===null&&H.tailMode==="hidden"&&!ee.alternate&&!Cn)return $r(h),null}else 2*It()-H.renderingStartTime>Qu&&v!==1073741824&&(h.flags|=128,A=!0,Ph(H,!1),h.lanes=4194304);H.isBackwards?(ee.sibling=h.child,h.child=ee):(v=H.last,v!==null?v.sibling=ee:h.child=ee,H.last=ee)}return H.tail!==null?(h=H.tail,H.rendering=h,H.tail=h.sibling,H.renderingStartTime=It(),h.sibling=null,v=Ln.current,An(Ln,A?v&1|2:v&1),h):($r(h),null);case 22:case 23:return yv(),A=h.memoizedState!==null,a!==null&&a.memoizedState!==null!==A&&(h.flags|=8192),A&&(h.mode&1)!==0?(ts&1073741824)!==0&&($r(h),h.subtreeFlags&6&&(h.flags|=8192)):$r(h),null;case 24:return null;case 25:return null}throw Error(t(156,h.tag))}function JR(a,h){switch(A0(h),h.tag){case 1:return Ci(h.type)&&qm(),a=h.flags,a&65536?(h.flags=a&-65537|128,h):null;case 3:return Gu(),In(Pi),In(qr),V0(),a=h.flags,(a&65536)!==0&&(a&128)===0?(h.flags=a&-65537|128,h):null;case 5:return L0(h),null;case 13:if(In(Ln),a=h.memoizedState,a!==null&&a.dehydrated!==null){if(h.alternate===null)throw Error(t(340));qu()}return a=h.flags,a&65536?(h.flags=a&-65537|128,h):null;case 19:return In(Ln),null;case 4:return Gu(),null;case 10:return R0(h.type._context),null;case 22:case 23:return yv(),null;case 24:return null;default:return null}}var cp=!1,Wr=!1,e5=typeof WeakSet=="function"?WeakSet:Set,Ye=null;function Yu(a,h){var v=a.ref;if(v!==null)if(typeof v=="function")try{v(null)}catch(A){qn(a,h,A)}else v.current=null}function sv(a,h,v){try{v()}catch(A){qn(a,h,A)}}var cE=!1;function t5(a,h){if($e=qs,a=fh(),mh(a)){if("selectionStart"in a)var v={start:a.selectionStart,end:a.selectionEnd};else e:{v=(v=a.ownerDocument)&&v.defaultView||window;var A=v.getSelection&&v.getSelection();if(A&&A.rangeCount!==0){v=A.anchorNode;var z=A.anchorOffset,H=A.focusNode;A=A.focusOffset;try{v.nodeType,H.nodeType}catch{v=null;break e}var ee=0,de=-1,me=-1,Se=0,je=0,De=a,Ce=null;t:for(;;){for(var Ge;De!==v||z!==0&&De.nodeType!==3||(de=ee+z),De!==H||A!==0&&De.nodeType!==3||(me=ee+A),De.nodeType===3&&(ee+=De.nodeValue.length),(Ge=De.firstChild)!==null;)Ce=De,De=Ge;for(;;){if(De===a)break t;if(Ce===v&&++Se===z&&(de=ee),Ce===H&&++je===A&&(me=ee),(Ge=De.nextSibling)!==null)break;De=Ce,Ce=De.parentNode}De=Ge}v=de===-1||me===-1?null:{start:de,end:me}}else v=null}v=v||{start:0,end:0}}else v=null;for(ut={focusedElem:a,selectionRange:v},qs=!1,Ye=h;Ye!==null;)if(h=Ye,a=h.child,(h.subtreeFlags&1028)!==0&&a!==null)a.return=h,Ye=a;else for(;Ye!==null;){h=Ye;try{var Xe=h.alternate;if((h.flags&1024)!==0)switch(h.tag){case 0:case 11:case 15:break;case 1:if(Xe!==null){var nt=Xe.memoizedProps,Yn=Xe.memoizedState,be=h.stateNode,ge=be.getSnapshotBeforeUpdate(h.elementType===h.type?nt:Zs(h.type,nt),Yn);be.__reactInternalSnapshotBeforeUpdate=ge}break;case 3:var we=h.stateNode.containerInfo;we.nodeType===1?we.textContent="":we.nodeType===9&&we.documentElement&&we.removeChild(we.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Ve){qn(h,h.return,Ve)}if(a=h.sibling,a!==null){a.return=h.return,Ye=a;break}Ye=h.return}return Xe=cE,cE=!1,Xe}function Ch(a,h,v){var A=h.updateQueue;if(A=A!==null?A.lastEffect:null,A!==null){var z=A=A.next;do{if((z.tag&a)===a){var H=z.destroy;z.destroy=void 0,H!==void 0&&sv(h,v,H)}z=z.next}while(z!==A)}}function up(a,h){if(h=h.updateQueue,h=h!==null?h.lastEffect:null,h!==null){var v=h=h.next;do{if((v.tag&a)===a){var A=v.create;v.destroy=A()}v=v.next}while(v!==h)}}function ov(a){var h=a.ref;if(h!==null){var v=a.stateNode;switch(a.tag){case 5:a=v;break;default:a=v}typeof h=="function"?h(a):h.current=a}}function uE(a){var h=a.alternate;h!==null&&(a.alternate=null,uE(h)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(h=a.stateNode,h!==null&&(delete h[vs],delete h[hl],delete h[fl],delete h[b0],delete h[w0])),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function dE(a){return a.tag===5||a.tag===3||a.tag===4}function hE(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||dE(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function av(a,h,v){var A=a.tag;if(A===5||A===6)a=a.stateNode,h?v.nodeType===8?v.parentNode.insertBefore(a,h):v.insertBefore(a,h):(v.nodeType===8?(h=v.parentNode,h.insertBefore(a,v)):(h=v,h.appendChild(a)),v=v._reactRootContainer,v!=null||h.onclick!==null||(h.onclick=Pe));else if(A!==4&&(a=a.child,a!==null))for(av(a,h,v),a=a.sibling;a!==null;)av(a,h,v),a=a.sibling}function lv(a,h,v){var A=a.tag;if(A===5||A===6)a=a.stateNode,h?v.insertBefore(a,h):v.appendChild(a);else if(A!==4&&(a=a.child,a!==null))for(lv(a,h,v),a=a.sibling;a!==null;)lv(a,h,v),a=a.sibling}var jr=null,Qs=!1;function _l(a,h,v){for(v=v.child;v!==null;)fE(a,h,v),v=v.sibling}function fE(a,h,v){if(ar&&typeof ar.onCommitFiberUnmount=="function")try{ar.onCommitFiberUnmount(Wi,v)}catch{}switch(v.tag){case 5:Wr||Yu(v,h);case 6:var A=jr,z=Qs;jr=null,_l(a,h,v),jr=A,Qs=z,jr!==null&&(Qs?(a=jr,v=v.stateNode,a.nodeType===8?a.parentNode.removeChild(v):a.removeChild(v)):jr.removeChild(v.stateNode));break;case 18:jr!==null&&(Qs?(a=jr,v=v.stateNode,a.nodeType===8?bh(a.parentNode,v):a.nodeType===1&&bh(a,v),lr(a)):bh(jr,v.stateNode));break;case 4:A=jr,z=Qs,jr=v.stateNode.containerInfo,Qs=!0,_l(a,h,v),jr=A,Qs=z;break;case 0:case 11:case 14:case 15:if(!Wr&&(A=v.updateQueue,A!==null&&(A=A.lastEffect,A!==null))){z=A=A.next;do{var H=z,ee=H.destroy;H=H.tag,ee!==void 0&&((H&2)!==0||(H&4)!==0)&&sv(v,h,ee),z=z.next}while(z!==A)}_l(a,h,v);break;case 1:if(!Wr&&(Yu(v,h),A=v.stateNode,typeof A.componentWillUnmount=="function"))try{A.props=v.memoizedProps,A.state=v.memoizedState,A.componentWillUnmount()}catch(de){qn(v,h,de)}_l(a,h,v);break;case 21:_l(a,h,v);break;case 22:v.mode&1?(Wr=(A=Wr)||v.memoizedState!==null,_l(a,h,v),Wr=A):_l(a,h,v);break;default:_l(a,h,v)}}function mE(a){var h=a.updateQueue;if(h!==null){a.updateQueue=null;var v=a.stateNode;v===null&&(v=a.stateNode=new e5),h.forEach(function(A){var z=u5.bind(null,a,A);v.has(A)||(v.add(A),A.then(z,z))})}}function Xs(a,h){var v=h.deletions;if(v!==null)for(var A=0;A<v.length;A++){var z=v[A];try{var H=a,ee=h,de=ee;e:for(;de!==null;){switch(de.tag){case 5:jr=de.stateNode,Qs=!1;break e;case 3:jr=de.stateNode.containerInfo,Qs=!0;break e;case 4:jr=de.stateNode.containerInfo,Qs=!0;break e}de=de.return}if(jr===null)throw Error(t(160));fE(H,ee,z),jr=null,Qs=!1;var me=z.alternate;me!==null&&(me.return=null),z.return=null}catch(Se){qn(z,h,Se)}}if(h.subtreeFlags&12854)for(h=h.child;h!==null;)pE(h,a),h=h.sibling}function pE(a,h){var v=a.alternate,A=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(Xs(h,a),To(a),A&4){try{Ch(3,a,a.return),up(3,a)}catch(nt){qn(a,a.return,nt)}try{Ch(5,a,a.return)}catch(nt){qn(a,a.return,nt)}}break;case 1:Xs(h,a),To(a),A&512&&v!==null&&Yu(v,v.return);break;case 5:if(Xs(h,a),To(a),A&512&&v!==null&&Yu(v,v.return),a.flags&32){var z=a.stateNode;try{Ht(z,"")}catch(nt){qn(a,a.return,nt)}}if(A&4&&(z=a.stateNode,z!=null)){var H=a.memoizedProps,ee=v!==null?v.memoizedProps:H,de=a.type,me=a.updateQueue;if(a.updateQueue=null,me!==null)try{de==="input"&&H.type==="radio"&&H.name!=null&&xn(z,H),ti(de,ee);var Se=ti(de,H);for(ee=0;ee<me.length;ee+=2){var je=me[ee],De=me[ee+1];je==="style"?yi(z,De):je==="dangerouslySetInnerHTML"?ls(z,De):je==="children"?Ht(z,De):R(z,je,De,Se)}switch(de){case"input":Yt(z,H);break;case"textarea":mt(z,H);break;case"select":var Ce=z._wrapperState.wasMultiple;z._wrapperState.wasMultiple=!!H.multiple;var Ge=H.value;Ge!=null?ze(z,!!H.multiple,Ge,!1):Ce!==!!H.multiple&&(H.defaultValue!=null?ze(z,!!H.multiple,H.defaultValue,!0):ze(z,!!H.multiple,H.multiple?[]:"",!1))}z[hl]=H}catch(nt){qn(a,a.return,nt)}}break;case 6:if(Xs(h,a),To(a),A&4){if(a.stateNode===null)throw Error(t(162));z=a.stateNode,H=a.memoizedProps;try{z.nodeValue=H}catch(nt){qn(a,a.return,nt)}}break;case 3:if(Xs(h,a),To(a),A&4&&v!==null&&v.memoizedState.isDehydrated)try{lr(h.containerInfo)}catch(nt){qn(a,a.return,nt)}break;case 4:Xs(h,a),To(a);break;case 13:Xs(h,a),To(a),z=a.child,z.flags&8192&&(H=z.memoizedState!==null,z.stateNode.isHidden=H,!H||z.alternate!==null&&z.alternate.memoizedState!==null||(dv=It())),A&4&&mE(a);break;case 22:if(je=v!==null&&v.memoizedState!==null,a.mode&1?(Wr=(Se=Wr)||je,Xs(h,a),Wr=Se):Xs(h,a),To(a),A&8192){if(Se=a.memoizedState!==null,(a.stateNode.isHidden=Se)&&!je&&(a.mode&1)!==0)for(Ye=a,je=a.child;je!==null;){for(De=Ye=je;Ye!==null;){switch(Ce=Ye,Ge=Ce.child,Ce.tag){case 0:case 11:case 14:case 15:Ch(4,Ce,Ce.return);break;case 1:Yu(Ce,Ce.return);var Xe=Ce.stateNode;if(typeof Xe.componentWillUnmount=="function"){A=Ce,v=Ce.return;try{h=A,Xe.props=h.memoizedProps,Xe.state=h.memoizedState,Xe.componentWillUnmount()}catch(nt){qn(A,v,nt)}}break;case 5:Yu(Ce,Ce.return);break;case 22:if(Ce.memoizedState!==null){vE(De);continue}}Ge!==null?(Ge.return=Ce,Ye=Ge):vE(De)}je=je.sibling}e:for(je=null,De=a;;){if(De.tag===5){if(je===null){je=De;try{z=De.stateNode,Se?(H=z.style,typeof H.setProperty=="function"?H.setProperty("display","none","important"):H.display="none"):(de=De.stateNode,me=De.memoizedProps.style,ee=me!=null&&me.hasOwnProperty("display")?me.display:null,de.style.display=Ui("display",ee))}catch(nt){qn(a,a.return,nt)}}}else if(De.tag===6){if(je===null)try{De.stateNode.nodeValue=Se?"":De.memoizedProps}catch(nt){qn(a,a.return,nt)}}else if((De.tag!==22&&De.tag!==23||De.memoizedState===null||De===a)&&De.child!==null){De.child.return=De,De=De.child;continue}if(De===a)break e;for(;De.sibling===null;){if(De.return===null||De.return===a)break e;je===De&&(je=null),De=De.return}je===De&&(je=null),De.sibling.return=De.return,De=De.sibling}}break;case 19:Xs(h,a),To(a),A&4&&mE(a);break;case 21:break;default:Xs(h,a),To(a)}}function To(a){var h=a.flags;if(h&2){try{e:{for(var v=a.return;v!==null;){if(dE(v)){var A=v;break e}v=v.return}throw Error(t(160))}switch(A.tag){case 5:var z=A.stateNode;A.flags&32&&(Ht(z,""),A.flags&=-33);var H=hE(a);lv(a,H,z);break;case 3:case 4:var ee=A.stateNode.containerInfo,de=hE(a);av(a,de,ee);break;default:throw Error(t(161))}}catch(me){qn(a,a.return,me)}a.flags&=-3}h&4096&&(a.flags&=-4097)}function n5(a,h,v){Ye=a,gE(a)}function gE(a,h,v){for(var A=(a.mode&1)!==0;Ye!==null;){var z=Ye,H=z.child;if(z.tag===22&&A){var ee=z.memoizedState!==null||cp;if(!ee){var de=z.alternate,me=de!==null&&de.memoizedState!==null||Wr;de=cp;var Se=Wr;if(cp=ee,(Wr=me)&&!Se)for(Ye=z;Ye!==null;)ee=Ye,me=ee.child,ee.tag===22&&ee.memoizedState!==null?_E(z):me!==null?(me.return=ee,Ye=me):_E(z);for(;H!==null;)Ye=H,gE(H),H=H.sibling;Ye=z,cp=de,Wr=Se}yE(a)}else(z.subtreeFlags&8772)!==0&&H!==null?(H.return=z,Ye=H):yE(a)}}function yE(a){for(;Ye!==null;){var h=Ye;if((h.flags&8772)!==0){var v=h.alternate;try{if((h.flags&8772)!==0)switch(h.tag){case 0:case 11:case 15:Wr||up(5,h);break;case 1:var A=h.stateNode;if(h.flags&4&&!Wr)if(v===null)A.componentDidMount();else{var z=h.elementType===h.type?v.memoizedProps:Zs(h.type,v.memoizedProps);A.componentDidUpdate(z,v.memoizedState,A.__reactInternalSnapshotBeforeUpdate)}var H=h.updateQueue;H!==null&&vw(h,H,A);break;case 3:var ee=h.updateQueue;if(ee!==null){if(v=null,h.child!==null)switch(h.child.tag){case 5:v=h.child.stateNode;break;case 1:v=h.child.stateNode}vw(h,ee,v)}break;case 5:var de=h.stateNode;if(v===null&&h.flags&4){v=de;var me=h.memoizedProps;switch(h.type){case"button":case"input":case"select":case"textarea":me.autoFocus&&v.focus();break;case"img":me.src&&(v.src=me.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(h.memoizedState===null){var Se=h.alternate;if(Se!==null){var je=Se.memoizedState;if(je!==null){var De=je.dehydrated;De!==null&&lr(De)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}Wr||h.flags&512&&ov(h)}catch(Ce){qn(h,h.return,Ce)}}if(h===a){Ye=null;break}if(v=h.sibling,v!==null){v.return=h.return,Ye=v;break}Ye=h.return}}function vE(a){for(;Ye!==null;){var h=Ye;if(h===a){Ye=null;break}var v=h.sibling;if(v!==null){v.return=h.return,Ye=v;break}Ye=h.return}}function _E(a){for(;Ye!==null;){var h=Ye;try{switch(h.tag){case 0:case 11:case 15:var v=h.return;try{up(4,h)}catch(me){qn(h,v,me)}break;case 1:var A=h.stateNode;if(typeof A.componentDidMount=="function"){var z=h.return;try{A.componentDidMount()}catch(me){qn(h,z,me)}}var H=h.return;try{ov(h)}catch(me){qn(h,H,me)}break;case 5:var ee=h.return;try{ov(h)}catch(me){qn(h,ee,me)}}}catch(me){qn(h,h.return,me)}if(h===a){Ye=null;break}var de=h.sibling;if(de!==null){de.return=h.return,Ye=de;break}Ye=h.return}}var r5=Math.ceil,dp=I.ReactCurrentDispatcher,cv=I.ReactCurrentOwner,Es=I.ReactCurrentBatchConfig,Qt=0,wr=null,sr=null,Or=0,ts=0,Zu=ml(0),dr=0,Rh=null,Pc=0,hp=0,uv=0,jh=null,ji=null,dv=0,Qu=1/0,ha=null,fp=!1,hv=null,xl=null,mp=!1,bl=null,pp=0,Oh=0,fv=null,gp=-1,yp=0;function li(){return(Qt&6)!==0?It():gp!==-1?gp:gp=It()}function wl(a){return(a.mode&1)===0?1:(Qt&2)!==0&&Or!==0?Or&-Or:zR.transition!==null?(yp===0&&(yp=$o()),yp):(a=Ct,a!==0||(a=window.event,a=a===void 0?16:Rt(a.type)),a)}function Js(a,h,v,A){if(50<Oh)throw Oh=0,fv=null,Error(t(185));Fr(a,v,A),((Qt&2)===0||a!==wr)&&(a===wr&&((Qt&2)===0&&(hp|=v),dr===4&&El(a,Or)),Oi(a,A),v===1&&Qt===0&&(h.mode&1)===0&&(Qu=It()+500,$m&&gl()))}function Oi(a,h){var v=a.callbackNode;Ei(a,h);var A=un(a,a===wr?Or:0);if(A===0)v!==null&&Me(v),a.callbackNode=null,a.callbackPriority=0;else if(h=A&-A,a.callbackPriority!==h){if(v!=null&&Me(v),h===1)a.tag===0?VR(bE.bind(null,a)):ow(bE.bind(null,a)),Ur(function(){(Qt&6)===0&&gl()}),v=null;else{switch(Si(A)){case 1:v=Pn;break;case 4:v=er;break;case 16:v=Gn;break;case 536870912:v=vn;break;default:v=Gn}v=kE(v,xE.bind(null,a))}a.callbackPriority=h,a.callbackNode=v}}function xE(a,h){if(gp=-1,yp=0,(Qt&6)!==0)throw Error(t(327));var v=a.callbackNode;if(Xu()&&a.callbackNode!==v)return null;var A=un(a,a===wr?Or:0);if(A===0)return null;if((A&30)!==0||(A&a.expiredLanes)!==0||h)h=vp(a,A);else{h=A;var z=Qt;Qt|=2;var H=EE();(wr!==a||Or!==h)&&(ha=null,Qu=It()+500,Rc(a,h));do try{o5();break}catch(de){wE(a,de)}while(!0);C0(),dp.current=H,Qt=z,sr!==null?h=0:(wr=null,Or=0,h=dr)}if(h!==0){if(h===2&&(z=Sn(a),z!==0&&(A=z,h=mv(a,z))),h===1)throw v=Rh,Rc(a,0),El(a,A),Oi(a,It()),v;if(h===6)El(a,A);else{if(z=a.current.alternate,(A&30)===0&&!i5(z)&&(h=vp(a,A),h===2&&(H=Sn(a),H!==0&&(A=H,h=mv(a,H))),h===1))throw v=Rh,Rc(a,0),El(a,A),Oi(a,It()),v;switch(a.finishedWork=z,a.finishedLanes=A,h){case 0:case 1:throw Error(t(345));case 2:jc(a,ji,ha);break;case 3:if(El(a,A),(A&130023424)===A&&(h=dv+500-It(),10<h)){if(un(a,0)!==0)break;if(z=a.suspendedLanes,(z&A)!==A){li(),a.pingedLanes|=a.suspendedLanes&z;break}a.timeoutHandle=cr(jc.bind(null,a,ji,ha),h);break}jc(a,ji,ha);break;case 4:if(El(a,A),(A&4194240)===A)break;for(h=a.eventTimes,z=-1;0<A;){var ee=31-St(A);H=1<<ee,ee=h[ee],ee>z&&(z=ee),A&=~H}if(A=z,A=It()-A,A=(120>A?120:480>A?480:1080>A?1080:1920>A?1920:3e3>A?3e3:4320>A?4320:1960*r5(A/1960))-A,10<A){a.timeoutHandle=cr(jc.bind(null,a,ji,ha),A);break}jc(a,ji,ha);break;case 5:jc(a,ji,ha);break;default:throw Error(t(329))}}}return Oi(a,It()),a.callbackNode===v?xE.bind(null,a):null}function mv(a,h){var v=jh;return a.current.memoizedState.isDehydrated&&(Rc(a,h).flags|=256),a=vp(a,h),a!==2&&(h=ji,ji=v,h!==null&&pv(h)),a}function pv(a){ji===null?ji=a:ji.push.apply(ji,a)}function i5(a){for(var h=a;;){if(h.flags&16384){var v=h.updateQueue;if(v!==null&&(v=v.stores,v!==null))for(var A=0;A<v.length;A++){var z=v[A],H=z.getSnapshot;z=z.value;try{if(!Qi(H(),z))return!1}catch{return!1}}}if(v=h.child,h.subtreeFlags&16384&&v!==null)v.return=h,h=v;else{if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function El(a,h){for(h&=~uv,h&=~hp,a.suspendedLanes|=h,a.pingedLanes&=~h,a=a.expirationTimes;0<h;){var v=31-St(h),A=1<<v;a[v]=-1,h&=~A}}function bE(a){if((Qt&6)!==0)throw Error(t(327));Xu();var h=un(a,0);if((h&1)===0)return Oi(a,It()),null;var v=vp(a,h);if(a.tag!==0&&v===2){var A=Sn(a);A!==0&&(h=A,v=mv(a,A))}if(v===1)throw v=Rh,Rc(a,0),El(a,h),Oi(a,It()),v;if(v===6)throw Error(t(345));return a.finishedWork=a.current.alternate,a.finishedLanes=h,jc(a,ji,ha),Oi(a,It()),null}function gv(a,h){var v=Qt;Qt|=1;try{return a(h)}finally{Qt=v,Qt===0&&(Qu=It()+500,$m&&gl())}}function Cc(a){bl!==null&&bl.tag===0&&(Qt&6)===0&&Xu();var h=Qt;Qt|=1;var v=Es.transition,A=Ct;try{if(Es.transition=null,Ct=1,a)return a()}finally{Ct=A,Es.transition=v,Qt=h,(Qt&6)===0&&gl()}}function yv(){ts=Zu.current,In(Zu)}function Rc(a,h){a.finishedWork=null,a.finishedLanes=0;var v=a.timeoutHandle;if(v!==-1&&(a.timeoutHandle=-1,ir(v)),sr!==null)for(v=sr.return;v!==null;){var A=v;switch(A0(A),A.tag){case 1:A=A.type.childContextTypes,A!=null&&qm();break;case 3:Gu(),In(Pi),In(qr),V0();break;case 5:L0(A);break;case 4:Gu();break;case 13:In(Ln);break;case 19:In(Ln);break;case 10:R0(A.type._context);break;case 22:case 23:yv()}v=v.return}if(wr=a,sr=a=Sl(a.current,null),Or=ts=h,dr=0,Rh=null,uv=hp=Pc=0,ji=jh=null,Nc!==null){for(h=0;h<Nc.length;h++)if(v=Nc[h],A=v.interleaved,A!==null){v.interleaved=null;var z=A.next,H=v.pending;if(H!==null){var ee=H.next;H.next=z,A.next=ee}v.pending=A}Nc=null}return a}function wE(a,h){do{var v=sr;try{if(C0(),tp.current=sp,np){for(var A=Fn.memoizedState;A!==null;){var z=A.queue;z!==null&&(z.pending=null),A=A.next}np=!1}if(kc=0,br=ur=Fn=null,Ah=!1,Nh=0,cv.current=null,v===null||v.return===null){dr=1,Rh=h,sr=null;break}e:{var H=a,ee=v.return,de=v,me=h;if(h=Or,de.flags|=32768,me!==null&&typeof me=="object"&&typeof me.then=="function"){var Se=me,je=de,De=je.tag;if((je.mode&1)===0&&(De===0||De===11||De===15)){var Ce=je.alternate;Ce?(je.updateQueue=Ce.updateQueue,je.memoizedState=Ce.memoizedState,je.lanes=Ce.lanes):(je.updateQueue=null,je.memoizedState=null)}var Ge=Gw(ee);if(Ge!==null){Ge.flags&=-257,Kw(Ge,ee,de,H,h),Ge.mode&1&&Ww(H,Se,h),h=Ge,me=Se;var Xe=h.updateQueue;if(Xe===null){var nt=new Set;nt.add(me),h.updateQueue=nt}else Xe.add(me);break e}else{if((h&1)===0){Ww(H,Se,h),vv();break e}me=Error(t(426))}}else if(Cn&&de.mode&1){var Yn=Gw(ee);if(Yn!==null){(Yn.flags&65536)===0&&(Yn.flags|=256),Kw(Yn,ee,de,H,h),k0(Ku(me,de));break e}}H=me=Ku(me,de),dr!==4&&(dr=2),jh===null?jh=[H]:jh.push(H),H=ee;do{switch(H.tag){case 3:H.flags|=65536,h&=-h,H.lanes|=h;var be=Hw(H,me,h);yw(H,be);break e;case 1:de=me;var ge=H.type,we=H.stateNode;if((H.flags&128)===0&&(typeof ge.getDerivedStateFromError=="function"||we!==null&&typeof we.componentDidCatch=="function"&&(xl===null||!xl.has(we)))){H.flags|=65536,h&=-h,H.lanes|=h;var Ve=$w(H,de,h);yw(H,Ve);break e}}H=H.return}while(H!==null)}TE(v)}catch(rt){h=rt,sr===v&&v!==null&&(sr=v=v.return);continue}break}while(!0)}function EE(){var a=dp.current;return dp.current=sp,a===null?sp:a}function vv(){(dr===0||dr===3||dr===2)&&(dr=4),wr===null||(Pc&268435455)===0&&(hp&268435455)===0||El(wr,Or)}function vp(a,h){var v=Qt;Qt|=2;var A=EE();(wr!==a||Or!==h)&&(ha=null,Rc(a,h));do try{s5();break}catch(z){wE(a,z)}while(!0);if(C0(),Qt=v,dp.current=A,sr!==null)throw Error(t(261));return wr=null,Or=0,dr}function s5(){for(;sr!==null;)SE(sr)}function o5(){for(;sr!==null&&!Ke();)SE(sr)}function SE(a){var h=IE(a.alternate,a,ts);a.memoizedProps=a.pendingProps,h===null?TE(a):sr=h,cv.current=null}function TE(a){var h=a;do{var v=h.alternate;if(a=h.return,(h.flags&32768)===0){if(v=XR(v,h,ts),v!==null){sr=v;return}}else{if(v=JR(v,h),v!==null){v.flags&=32767,sr=v;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{dr=6,sr=null;return}}if(h=h.sibling,h!==null){sr=h;return}sr=h=a}while(h!==null);dr===0&&(dr=5)}function jc(a,h,v){var A=Ct,z=Es.transition;try{Es.transition=null,Ct=1,a5(a,h,v,A)}finally{Es.transition=z,Ct=A}return null}function a5(a,h,v,A){do Xu();while(bl!==null);if((Qt&6)!==0)throw Error(t(327));v=a.finishedWork;var z=a.finishedLanes;if(v===null)return null;if(a.finishedWork=null,a.finishedLanes=0,v===a.current)throw Error(t(177));a.callbackNode=null,a.callbackPriority=0;var H=v.lanes|v.childLanes;if(Tt(a,H),a===wr&&(sr=wr=null,Or=0),(v.subtreeFlags&2064)===0&&(v.flags&2064)===0||mp||(mp=!0,kE(Gn,function(){return Xu(),null})),H=(v.flags&15990)!==0,(v.subtreeFlags&15990)!==0||H){H=Es.transition,Es.transition=null;var ee=Ct;Ct=1;var de=Qt;Qt|=4,cv.current=null,t5(a,v),pE(v,a),gs(ut),qs=!!$e,ut=$e=null,a.current=v,n5(v),Zt(),Qt=de,Ct=ee,Es.transition=H}else a.current=v;if(mp&&(mp=!1,bl=a,pp=z),H=a.pendingLanes,H===0&&(xl=null),mo(v.stateNode),Oi(a,It()),h!==null)for(A=a.onRecoverableError,v=0;v<h.length;v++)z=h[v],A(z.value,{componentStack:z.stack,digest:z.digest});if(fp)throw fp=!1,a=hv,hv=null,a;return(pp&1)!==0&&a.tag!==0&&Xu(),H=a.pendingLanes,(H&1)!==0?a===fv?Oh++:(Oh=0,fv=a):Oh=0,gl(),null}function Xu(){if(bl!==null){var a=Si(pp),h=Es.transition,v=Ct;try{if(Es.transition=null,Ct=16>a?16:a,bl===null)var A=!1;else{if(a=bl,bl=null,pp=0,(Qt&6)!==0)throw Error(t(331));var z=Qt;for(Qt|=4,Ye=a.current;Ye!==null;){var H=Ye,ee=H.child;if((Ye.flags&16)!==0){var de=H.deletions;if(de!==null){for(var me=0;me<de.length;me++){var Se=de[me];for(Ye=Se;Ye!==null;){var je=Ye;switch(je.tag){case 0:case 11:case 15:Ch(8,je,H)}var De=je.child;if(De!==null)De.return=je,Ye=De;else for(;Ye!==null;){je=Ye;var Ce=je.sibling,Ge=je.return;if(uE(je),je===Se){Ye=null;break}if(Ce!==null){Ce.return=Ge,Ye=Ce;break}Ye=Ge}}}var Xe=H.alternate;if(Xe!==null){var nt=Xe.child;if(nt!==null){Xe.child=null;do{var Yn=nt.sibling;nt.sibling=null,nt=Yn}while(nt!==null)}}Ye=H}}if((H.subtreeFlags&2064)!==0&&ee!==null)ee.return=H,Ye=ee;else e:for(;Ye!==null;){if(H=Ye,(H.flags&2048)!==0)switch(H.tag){case 0:case 11:case 15:Ch(9,H,H.return)}var be=H.sibling;if(be!==null){be.return=H.return,Ye=be;break e}Ye=H.return}}var ge=a.current;for(Ye=ge;Ye!==null;){ee=Ye;var we=ee.child;if((ee.subtreeFlags&2064)!==0&&we!==null)we.return=ee,Ye=we;else e:for(ee=ge;Ye!==null;){if(de=Ye,(de.flags&2048)!==0)try{switch(de.tag){case 0:case 11:case 15:up(9,de)}}catch(rt){qn(de,de.return,rt)}if(de===ee){Ye=null;break e}var Ve=de.sibling;if(Ve!==null){Ve.return=de.return,Ye=Ve;break e}Ye=de.return}}if(Qt=z,gl(),ar&&typeof ar.onPostCommitFiberRoot=="function")try{ar.onPostCommitFiberRoot(Wi,a)}catch{}A=!0}return A}finally{Ct=v,Es.transition=h}}return!1}function AE(a,h,v){h=Ku(v,h),h=Hw(a,h,1),a=vl(a,h,1),h=li(),a!==null&&(Fr(a,1,h),Oi(a,h))}function qn(a,h,v){if(a.tag===3)AE(a,a,v);else for(;h!==null;){if(h.tag===3){AE(h,a,v);break}else if(h.tag===1){var A=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof A.componentDidCatch=="function"&&(xl===null||!xl.has(A))){a=Ku(v,a),a=$w(h,a,1),h=vl(h,a,1),a=li(),h!==null&&(Fr(h,1,a),Oi(h,a));break}}h=h.return}}function l5(a,h,v){var A=a.pingCache;A!==null&&A.delete(h),h=li(),a.pingedLanes|=a.suspendedLanes&v,wr===a&&(Or&v)===v&&(dr===4||dr===3&&(Or&130023424)===Or&&500>It()-dv?Rc(a,0):uv|=v),Oi(a,h)}function NE(a,h){h===0&&((a.mode&1)===0?h=1:(h=po,po<<=1,(po&130023424)===0&&(po=4194304)));var v=li();a=ca(a,h),a!==null&&(Fr(a,h,v),Oi(a,v))}function c5(a){var h=a.memoizedState,v=0;h!==null&&(v=h.retryLane),NE(a,v)}function u5(a,h){var v=0;switch(a.tag){case 13:var A=a.stateNode,z=a.memoizedState;z!==null&&(v=z.retryLane);break;case 19:A=a.stateNode;break;default:throw Error(t(314))}A!==null&&A.delete(h),NE(a,v)}var IE;IE=function(a,h,v){if(a!==null)if(a.memoizedProps!==h.pendingProps||Pi.current)Ri=!0;else{if((a.lanes&v)===0&&(h.flags&128)===0)return Ri=!1,QR(a,h,v);Ri=(a.flags&131072)!==0}else Ri=!1,Cn&&(h.flags&1048576)!==0&&aw(h,Gm,h.index);switch(h.lanes=0,h.tag){case 2:var A=h.type;lp(a,h),a=h.pendingProps;var z=zu(h,qr.current);Wu(h,v),z=U0(null,h,A,a,z,v);var H=q0();return h.flags|=1,typeof z=="object"&&z!==null&&typeof z.render=="function"&&z.$$typeof===void 0?(h.tag=1,h.memoizedState=null,h.updateQueue=null,Ci(A)?(H=!0,Hm(h)):H=!1,h.memoizedState=z.state!==null&&z.state!==void 0?z.state:null,M0(h),z.updater=op,h.stateNode=z,z._reactInternals=h,Y0(h,A,a,v),h=J0(null,h,A,!0,H,v)):(h.tag=0,Cn&&H&&T0(h),ai(null,h,z,v),h=h.child),h;case 16:A=h.elementType;e:{switch(lp(a,h),a=h.pendingProps,z=A._init,A=z(A._payload),h.type=A,z=h.tag=h5(A),a=Zs(A,a),z){case 0:h=X0(null,h,A,a,v);break e;case 1:h=eE(null,h,A,a,v);break e;case 11:h=Yw(null,h,A,a,v);break e;case 14:h=Zw(null,h,A,Zs(A.type,a),v);break e}throw Error(t(306,A,""))}return h;case 0:return A=h.type,z=h.pendingProps,z=h.elementType===A?z:Zs(A,z),X0(a,h,A,z,v);case 1:return A=h.type,z=h.pendingProps,z=h.elementType===A?z:Zs(A,z),eE(a,h,A,z,v);case 3:e:{if(tE(h),a===null)throw Error(t(387));A=h.pendingProps,H=h.memoizedState,z=H.element,gw(a,h),Jm(h,A,null,v);var ee=h.memoizedState;if(A=ee.element,H.isDehydrated)if(H={element:A,isDehydrated:!1,cache:ee.cache,pendingSuspenseBoundaries:ee.pendingSuspenseBoundaries,transitions:ee.transitions},h.updateQueue.baseState=H,h.memoizedState=H,h.flags&256){z=Ku(Error(t(423)),h),h=nE(a,h,A,v,z);break e}else if(A!==z){z=Ku(Error(t(424)),h),h=nE(a,h,A,v,z);break e}else for(es=wo(h.stateNode.containerInfo.firstChild),Ji=h,Cn=!0,Ys=null,v=mw(h,null,A,v),h.child=v;v;)v.flags=v.flags&-3|4096,v=v.sibling;else{if(qu(),A===z){h=da(a,h,v);break e}ai(a,h,A,v)}h=h.child}return h;case 5:return _w(h),a===null&&I0(h),A=h.type,z=h.pendingProps,H=a!==null?a.memoizedProps:null,ee=z.children,Pt(A,z)?ee=null:H!==null&&Pt(A,H)&&(h.flags|=32),Jw(a,h),ai(a,h,ee,v),h.child;case 6:return a===null&&I0(h),null;case 13:return rE(a,h,v);case 4:return D0(h,h.stateNode.containerInfo),A=h.pendingProps,a===null?h.child=Hu(h,null,A,v):ai(a,h,A,v),h.child;case 11:return A=h.type,z=h.pendingProps,z=h.elementType===A?z:Zs(A,z),Yw(a,h,A,z,v);case 7:return ai(a,h,h.pendingProps,v),h.child;case 8:return ai(a,h,h.pendingProps.children,v),h.child;case 12:return ai(a,h,h.pendingProps.children,v),h.child;case 10:e:{if(A=h.type._context,z=h.pendingProps,H=h.memoizedProps,ee=z.value,An(Zm,A._currentValue),A._currentValue=ee,H!==null)if(Qi(H.value,ee)){if(H.children===z.children&&!Pi.current){h=da(a,h,v);break e}}else for(H=h.child,H!==null&&(H.return=h);H!==null;){var de=H.dependencies;if(de!==null){ee=H.child;for(var me=de.firstContext;me!==null;){if(me.context===A){if(H.tag===1){me=ua(-1,v&-v),me.tag=2;var Se=H.updateQueue;if(Se!==null){Se=Se.shared;var je=Se.pending;je===null?me.next=me:(me.next=je.next,je.next=me),Se.pending=me}}H.lanes|=v,me=H.alternate,me!==null&&(me.lanes|=v),j0(H.return,v,h),de.lanes|=v;break}me=me.next}}else if(H.tag===10)ee=H.type===h.type?null:H.child;else if(H.tag===18){if(ee=H.return,ee===null)throw Error(t(341));ee.lanes|=v,de=ee.alternate,de!==null&&(de.lanes|=v),j0(ee,v,h),ee=H.sibling}else ee=H.child;if(ee!==null)ee.return=H;else for(ee=H;ee!==null;){if(ee===h){ee=null;break}if(H=ee.sibling,H!==null){H.return=ee.return,ee=H;break}ee=ee.return}H=ee}ai(a,h,z.children,v),h=h.child}return h;case 9:return z=h.type,A=h.pendingProps.children,Wu(h,v),z=bs(z),A=A(z),h.flags|=1,ai(a,h,A,v),h.child;case 14:return A=h.type,z=Zs(A,h.pendingProps),z=Zs(A.type,z),Zw(a,h,A,z,v);case 15:return Qw(a,h,h.type,h.pendingProps,v);case 17:return A=h.type,z=h.pendingProps,z=h.elementType===A?z:Zs(A,z),lp(a,h),h.tag=1,Ci(A)?(a=!0,Hm(h)):a=!1,Wu(h,v),Uw(h,A,z),Y0(h,A,z,v),J0(null,h,A,!0,a,v);case 19:return sE(a,h,v);case 22:return Xw(a,h,v)}throw Error(t(156,h.tag))};function kE(a,h){return pe(a,h)}function d5(a,h,v,A){this.tag=a,this.key=v,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=A,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ss(a,h,v,A){return new d5(a,h,v,A)}function _v(a){return a=a.prototype,!(!a||!a.isReactComponent)}function h5(a){if(typeof a=="function")return _v(a)?1:0;if(a!=null){if(a=a.$$typeof,a===F)return 11;if(a===Y)return 14}return 2}function Sl(a,h){var v=a.alternate;return v===null?(v=Ss(a.tag,h,a.key,a.mode),v.elementType=a.elementType,v.type=a.type,v.stateNode=a.stateNode,v.alternate=a,a.alternate=v):(v.pendingProps=h,v.type=a.type,v.flags=0,v.subtreeFlags=0,v.deletions=null),v.flags=a.flags&14680064,v.childLanes=a.childLanes,v.lanes=a.lanes,v.child=a.child,v.memoizedProps=a.memoizedProps,v.memoizedState=a.memoizedState,v.updateQueue=a.updateQueue,h=a.dependencies,v.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext},v.sibling=a.sibling,v.index=a.index,v.ref=a.ref,v}function _p(a,h,v,A,z,H){var ee=2;if(A=a,typeof a=="function")_v(a)&&(ee=1);else if(typeof a=="string")ee=5;else e:switch(a){case C:return Oc(v.children,z,H,h);case k:ee=8,z|=8;break;case D:return a=Ss(12,v,h,z|2),a.elementType=D,a.lanes=H,a;case M:return a=Ss(13,v,h,z),a.elementType=M,a.lanes=H,a;case $:return a=Ss(19,v,h,z),a.elementType=$,a.lanes=H,a;case oe:return xp(v,z,H,h);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case O:ee=10;break e;case P:ee=9;break e;case F:ee=11;break e;case Y:ee=14;break e;case te:ee=16,A=null;break e}throw Error(t(130,a==null?a:typeof a,""))}return h=Ss(ee,v,h,z),h.elementType=a,h.type=A,h.lanes=H,h}function Oc(a,h,v,A){return a=Ss(7,a,A,h),a.lanes=v,a}function xp(a,h,v,A){return a=Ss(22,a,A,h),a.elementType=oe,a.lanes=v,a.stateNode={isHidden:!1},a}function xv(a,h,v){return a=Ss(6,a,null,h),a.lanes=v,a}function bv(a,h,v){return h=Ss(4,a.children!==null?a.children:[],a.key,h),h.lanes=v,h.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},h}function f5(a,h,v,A,z){this.tag=h,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ki(0),this.expirationTimes=Ki(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ki(0),this.identifierPrefix=A,this.onRecoverableError=z,this.mutableSourceEagerHydrationData=null}function wv(a,h,v,A,z,H,ee,de,me){return a=new f5(a,h,v,de,me),h===1?(h=1,H===!0&&(h|=8)):h=0,H=Ss(3,null,null,h),a.current=H,H.stateNode=a,H.memoizedState={element:A,isDehydrated:v,cache:null,transitions:null,pendingSuspenseBoundaries:null},M0(H),a}function m5(a,h,v){var A=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:U,key:A==null?null:""+A,children:a,containerInfo:h,implementation:v}}function PE(a){if(!a)return pl;a=a._reactInternals;e:{if(Ir(a)!==a||a.tag!==1)throw Error(t(170));var h=a;do{switch(h.tag){case 3:h=h.stateNode.context;break e;case 1:if(Ci(h.type)){h=h.stateNode.__reactInternalMemoizedMergedChildContext;break e}}h=h.return}while(h!==null);throw Error(t(171))}if(a.tag===1){var v=a.type;if(Ci(v))return iw(a,v,h)}return h}function CE(a,h,v,A,z,H,ee,de,me){return a=wv(v,A,!0,a,z,H,ee,de,me),a.context=PE(null),v=a.current,A=li(),z=wl(v),H=ua(A,z),H.callback=h??null,vl(v,H,z),a.current.lanes=z,Fr(a,z,A),Oi(a,A),a}function bp(a,h,v,A){var z=h.current,H=li(),ee=wl(z);return v=PE(v),h.context===null?h.context=v:h.pendingContext=v,h=ua(H,ee),h.payload={element:a},A=A===void 0?null:A,A!==null&&(h.callback=A),a=vl(z,h,ee),a!==null&&(Js(a,z,ee,H),Xm(a,z,ee)),ee}function wp(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return a.child.stateNode;default:return a.child.stateNode}}function RE(a,h){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var v=a.retryLane;a.retryLane=v!==0&&v<h?v:h}}function Ev(a,h){RE(a,h),(a=a.alternate)&&RE(a,h)}function p5(){return null}var jE=typeof reportError=="function"?reportError:function(a){console.error(a)};function Sv(a){this._internalRoot=a}Ep.prototype.render=Sv.prototype.render=function(a){var h=this._internalRoot;if(h===null)throw Error(t(409));bp(a,h,null,null)},Ep.prototype.unmount=Sv.prototype.unmount=function(){var a=this._internalRoot;if(a!==null){this._internalRoot=null;var h=a.containerInfo;Cc(function(){bp(null,a,null,null)}),h[rn]=null}};function Ep(a){this._internalRoot=a}Ep.prototype.unstable_scheduleHydration=function(a){if(a){var h=Wa();a={blockedOn:null,target:a,priority:h};for(var v=0;v<Kn.length&&h!==0&&h<Kn[v].priority;v++);Kn.splice(v,0,a),v===0&&Ga(a)}};function Tv(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function Sp(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11&&(a.nodeType!==8||a.nodeValue!==" react-mount-point-unstable "))}function OE(){}function g5(a,h,v,A,z){if(z){if(typeof A=="function"){var H=A;A=function(){var Se=wp(ee);H.call(Se)}}var ee=CE(h,A,a,0,null,!1,!1,"",OE);return a._reactRootContainer=ee,a[rn]=ee.current,ul(a.nodeType===8?a.parentNode:a),Cc(),ee}for(;z=a.lastChild;)a.removeChild(z);if(typeof A=="function"){var de=A;A=function(){var Se=wp(me);de.call(Se)}}var me=wv(a,0,!1,null,null,!1,!1,"",OE);return a._reactRootContainer=me,a[rn]=me.current,ul(a.nodeType===8?a.parentNode:a),Cc(function(){bp(h,me,v,A)}),me}function Tp(a,h,v,A,z){var H=v._reactRootContainer;if(H){var ee=H;if(typeof z=="function"){var de=z;z=function(){var me=wp(ee);de.call(me)}}bp(h,ee,a,z)}else ee=g5(v,h,a,z,A);return wp(ee)}Ha=function(a){switch(a.tag){case 3:var h=a.stateNode;if(h.current.memoizedState.isDehydrated){var v=xt(h.pendingLanes);v!==0&&(Vr(h,v|1),Oi(h,It()),(Qt&6)===0&&(Qu=It()+500,gl()))}break;case 13:Cc(function(){var A=ca(a,1);if(A!==null){var z=li();Js(A,a,1,z)}}),Ev(a,1)}},hs=function(a){if(a.tag===13){var h=ca(a,134217728);if(h!==null){var v=li();Js(h,a,134217728,v)}Ev(a,134217728)}},$a=function(a){if(a.tag===13){var h=wl(a),v=ca(a,h);if(v!==null){var A=li();Js(v,a,h,A)}Ev(a,h)}},Wa=function(){return Ct},Wo=function(a,h){var v=Ct;try{return Ct=a,h()}finally{Ct=v}},_i=function(a,h,v){switch(h){case"input":if(Yt(a,v),h=v.name,v.type==="radio"&&h!=null){for(v=a;v.parentNode;)v=v.parentNode;for(v=v.querySelectorAll("input[name="+JSON.stringify(""+h)+'][type="radio"]'),h=0;h<v.length;h++){var A=v[h];if(A!==a&&A.form===a.form){var z=Fu(A);if(!z)throw Error(t(90));qe(A),Yt(A,z)}}}break;case"textarea":mt(a,v);break;case"select":h=v.value,h!=null&&ze(a,!!v.multiple,h,!1)}},yn=gv,wi=Cc;var y5={usingClientEntryPoint:!1,Events:[ia,sa,Fu,bi,Bo,gv]},Mh={findFiberByHostInstance:ra,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},v5={bundleType:Mh.bundleType,version:Mh.version,rendererPackageName:Mh.rendererPackageName,rendererConfig:Mh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:I.ReactCurrentDispatcher,findHostInstanceByFiber:function(a){return a=qo(a),a===null?null:a.stateNode},findFiberByHostInstance:Mh.findFiberByHostInstance||p5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ap=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ap.isDisabled&&Ap.supportsFiber)try{Wi=Ap.inject(v5),ar=Ap}catch{}}return Mi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=y5,Mi.createPortal=function(a,h){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Tv(h))throw Error(t(200));return m5(a,h,null,v)},Mi.createRoot=function(a,h){if(!Tv(a))throw Error(t(299));var v=!1,A="",z=jE;return h!=null&&(h.unstable_strictMode===!0&&(v=!0),h.identifierPrefix!==void 0&&(A=h.identifierPrefix),h.onRecoverableError!==void 0&&(z=h.onRecoverableError)),h=wv(a,1,!1,null,null,v,!1,A,z),a[rn]=h.current,ul(a.nodeType===8?a.parentNode:a),new Sv(h)},Mi.findDOMNode=function(a){if(a==null)return null;if(a.nodeType===1)return a;var h=a._reactInternals;if(h===void 0)throw typeof a.render=="function"?Error(t(188)):(a=Object.keys(a).join(","),Error(t(268,a)));return a=qo(h),a=a===null?null:a.stateNode,a},Mi.flushSync=function(a){return Cc(a)},Mi.hydrate=function(a,h,v){if(!Sp(h))throw Error(t(200));return Tp(null,a,h,!0,v)},Mi.hydrateRoot=function(a,h,v){if(!Tv(a))throw Error(t(405));var A=v!=null&&v.hydratedSources||null,z=!1,H="",ee=jE;if(v!=null&&(v.unstable_strictMode===!0&&(z=!0),v.identifierPrefix!==void 0&&(H=v.identifierPrefix),v.onRecoverableError!==void 0&&(ee=v.onRecoverableError)),h=CE(h,null,a,1,v??null,z,!1,H,ee),a[rn]=h.current,ul(a),A)for(a=0;a<A.length;a++)v=A[a],z=v._getVersion,z=z(v._source),h.mutableSourceEagerHydrationData==null?h.mutableSourceEagerHydrationData=[v,z]:h.mutableSourceEagerHydrationData.push(v,z);return new Ep(h)},Mi.render=function(a,h,v){if(!Sp(h))throw Error(t(200));return Tp(null,a,h,!1,v)},Mi.unmountComponentAtNode=function(a){if(!Sp(a))throw Error(t(40));return a._reactRootContainer?(Cc(function(){Tp(null,null,a,!1,function(){a._reactRootContainer=null,a[rn]=null})}),!0):!1},Mi.unstable_batchedUpdates=gv,Mi.unstable_renderSubtreeIntoContainer=function(a,h,v,A){if(!Sp(v))throw Error(t(200));if(a==null||a._reactInternals===void 0)throw Error(t(38));return Tp(a,h,v,!1,A)},Mi.version="18.3.1-next-f1338f8080-20240426",Mi}var UE;function Xx(){if(UE)return Iv.exports;UE=1;function r(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(e){console.error(e)}}return r(),Iv.exports=N5(),Iv.exports}var qE;function I5(){if(qE)return Ip;qE=1;var r=Xx();return Ip.createRoot=r.createRoot,Ip.hydrateRoot=r.hydrateRoot,Ip}var k5=I5();const P5=Qx(k5),C5=()=>{};var HE={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _4=function(r){const e=[];let t=0;for(let n=0;n<r.length;n++){let i=r.charCodeAt(n);i<128?e[t++]=i:i<2048?(e[t++]=i>>6|192,e[t++]=i&63|128):(i&64512)===55296&&n+1<r.length&&(r.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(r.charCodeAt(++n)&1023),e[t++]=i>>18|240,e[t++]=i>>12&63|128,e[t++]=i>>6&63|128,e[t++]=i&63|128):(e[t++]=i>>12|224,e[t++]=i>>6&63|128,e[t++]=i&63|128)}return e},R5=function(r){const e=[];let t=0,n=0;for(;t<r.length;){const i=r[t++];if(i<128)e[n++]=String.fromCharCode(i);else if(i>191&&i<224){const s=r[t++];e[n++]=String.fromCharCode((i&31)<<6|s&63)}else if(i>239&&i<365){const s=r[t++],o=r[t++],l=r[t++],d=((i&7)<<18|(s&63)<<12|(o&63)<<6|l&63)-65536;e[n++]=String.fromCharCode(55296+(d>>10)),e[n++]=String.fromCharCode(56320+(d&1023))}else{const s=r[t++],o=r[t++];e[n++]=String.fromCharCode((i&15)<<12|(s&63)<<6|o&63)}}return e.join("")},x4={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(r,e){if(!Array.isArray(r))throw Error("encodeByteArray takes an array as a parameter");this.init_();const t=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,n=[];for(let i=0;i<r.length;i+=3){const s=r[i],o=i+1<r.length,l=o?r[i+1]:0,d=i+2<r.length,f=d?r[i+2]:0,m=s>>2,y=(s&3)<<4|l>>4;let g=(l&15)<<2|f>>6,_=f&63;d||(_=64,o||(g=64)),n.push(t[m],t[y],t[g],t[_])}return n.join("")},encodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(r):this.encodeByteArray(_4(r),e)},decodeString(r,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(r):R5(this.decodeStringToByteArray(r,e))},decodeStringToByteArray(r,e){this.init_();const t=e?this.charToByteMapWebSafe_:this.charToByteMap_,n=[];for(let i=0;i<r.length;){const s=t[r.charAt(i++)],l=i<r.length?t[r.charAt(i)]:0;++i;const f=i<r.length?t[r.charAt(i)]:64;++i;const y=i<r.length?t[r.charAt(i)]:64;if(++i,s==null||l==null||f==null||y==null)throw new j5;const g=s<<2|l>>4;if(n.push(g),f!==64){const _=l<<4&240|f>>2;if(n.push(_),y!==64){const E=f<<6&192|y;n.push(E)}}}return n},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let r=0;r<this.ENCODED_VALS.length;r++)this.byteToCharMap_[r]=this.ENCODED_VALS.charAt(r),this.charToByteMap_[this.byteToCharMap_[r]]=r,this.byteToCharMapWebSafe_[r]=this.ENCODED_VALS_WEBSAFE.charAt(r),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[r]]=r,r>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(r)]=r,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(r)]=r)}}};class j5 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const O5=function(r){const e=_4(r);return x4.encodeByteArray(e,!0)},Ng=function(r){return O5(r).replace(/\./g,"")},b4=function(r){try{return x4.decodeString(r,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function w4(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const M5=()=>w4().__FIREBASE_DEFAULTS__,D5=()=>{if(typeof process>"u"||typeof HE>"u")return;const r=HE.__FIREBASE_DEFAULTS__;if(r)return JSON.parse(r)},L5=()=>{if(typeof document>"u")return;let r;try{r=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=r&&b4(r[1]);return e&&JSON.parse(e)},_y=()=>{try{return C5()||M5()||D5()||L5()}catch(r){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${r}`);return}},E4=r=>{var e,t;return(t=(e=_y())===null||e===void 0?void 0:e.emulatorHosts)===null||t===void 0?void 0:t[r]},S4=r=>{const e=E4(r);if(!e)return;const t=e.lastIndexOf(":");if(t<=0||t+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const n=parseInt(e.substring(t+1),10);return e[0]==="["?[e.substring(1,t-1),n]:[e.substring(0,t),n]},T4=()=>{var r;return(r=_y())===null||r===void 0?void 0:r.config},A4=r=>{var e;return(e=_y())===null||e===void 0?void 0:e[`_${r}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F5{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(t):e(t,n))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vu(r){return r.endsWith(".cloudworkstations.dev")}async function Jx(r){return(await fetch(r,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V5(r,e){if(r.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const t={alg:"none",type:"JWT"},n=e||"demo-project",i=r.iat||0,s=r.sub||r.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:i,exp:i+3600,auth_time:i,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},r);return[Ng(JSON.stringify(t)),Ng(JSON.stringify(o)),""].join(".")}const bf={};function z5(){const r={prod:[],emulator:[]};for(const e of Object.keys(bf))bf[e]?r.emulator.push(e):r.prod.push(e);return r}function B5(r){let e=document.getElementById(r),t=!1;return e||(e=document.createElement("div"),e.setAttribute("id",r),t=!0),{created:t,element:e}}let $E=!1;function eb(r,e){if(typeof window>"u"||typeof document>"u"||!vu(window.location.host)||bf[r]===e||bf[r]||$E)return;bf[r]=e;function t(g){return`__firebase__banner__${g}`}const n="__firebase__banner",s=z5().prod.length>0;function o(){const g=document.getElementById(n);g&&g.remove()}function l(g){g.style.display="flex",g.style.background="#7faaf0",g.style.position="fixed",g.style.bottom="5px",g.style.left="5px",g.style.padding=".5em",g.style.borderRadius="5px",g.style.alignItems="center"}function d(g,_){g.setAttribute("width","24"),g.setAttribute("id",_),g.setAttribute("height","24"),g.setAttribute("viewBox","0 0 24 24"),g.setAttribute("fill","none"),g.style.marginLeft="-6px"}function f(){const g=document.createElement("span");return g.style.cursor="pointer",g.style.marginLeft="16px",g.style.fontSize="24px",g.innerHTML=" &times;",g.onclick=()=>{$E=!0,o()},g}function m(g,_){g.setAttribute("id",_),g.innerText="Learn more",g.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",g.setAttribute("target","__blank"),g.style.paddingLeft="5px",g.style.textDecoration="underline"}function y(){const g=B5(n),_=t("text"),E=document.getElementById(_)||document.createElement("span"),x=t("learnmore"),b=document.getElementById(x)||document.createElement("a"),T=t("preprendIcon"),N=document.getElementById(T)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(g.created){const R=g.element;l(R),m(b,x);const I=f();d(N,T),R.append(N,E,b,I),document.body.appendChild(R)}s?(E.innerText="Preview backend disconnected.",N.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(N.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,E.innerText="Preview backend running in this workspace."),E.setAttribute("id",_)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function U5(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(pr())}function N4(){var r;const e=(r=_y())===null||r===void 0?void 0:r.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function q5(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function H5(){const r=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof r=="object"&&r.id!==void 0}function $5(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function W5(){const r=pr();return r.indexOf("MSIE ")>=0||r.indexOf("Trident/")>=0}function I4(){return!N4()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function k4(){return!N4()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function P4(){try{return typeof indexedDB=="object"}catch{return!1}}function G5(){return new Promise((r,e)=>{try{let t=!0;const n="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(n);i.onsuccess=()=>{i.result.close(),t||self.indexedDB.deleteDatabase(n),r(!0)},i.onupgradeneeded=()=>{t=!1},i.onerror=()=>{var s;e(((s=i.error)===null||s===void 0?void 0:s.message)||"")}}catch(t){e(t)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const K5="FirebaseError";class Ca extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name=K5,Object.setPrototypeOf(this,Ca.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,dm.prototype.create)}}class dm{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},i=`${this.service}/${e}`,s=this.errors[e],o=s?Y5(s,n):"Error",l=`${this.serviceName}: ${o} (${i}).`;return new Ca(i,l,n)}}function Y5(r,e){return r.replace(Z5,(t,n)=>{const i=e[n];return i!=null?String(i):`<${n}?>`})}const Z5=/\{\$([^}]+)}/g;function Q5(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}function Kl(r,e){if(r===e)return!0;const t=Object.keys(r),n=Object.keys(e);for(const i of t){if(!n.includes(i))return!1;const s=r[i],o=e[i];if(WE(s)&&WE(o)){if(!Kl(s,o))return!1}else if(s!==o)return!1}for(const i of n)if(!t.includes(i))return!1;return!0}function WE(r){return r!==null&&typeof r=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hm(r){const e=[];for(const[t,n]of Object.entries(r))Array.isArray(n)?n.forEach(i=>{e.push(encodeURIComponent(t)+"="+encodeURIComponent(i))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n));return e.length?"&"+e.join("&"):""}function af(r){const e={};return r.replace(/^\?/,"").split("&").forEach(n=>{if(n){const[i,s]=n.split("=");e[decodeURIComponent(i)]=decodeURIComponent(s)}}),e}function lf(r){const e=r.indexOf("?");if(!e)return"";const t=r.indexOf("#",e);return r.substring(e,t>0?t:void 0)}function X5(r,e){const t=new J5(r,e);return t.subscribe.bind(t)}class J5{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then(()=>{e(this)}).catch(n=>{this.error(n)})}next(e){this.forEachObserver(t=>{t.next(e)})}error(e){this.forEachObserver(t=>{t.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,t,n){let i;if(e===void 0&&t===void 0&&n===void 0)throw new Error("Missing Observer.");e7(e,["next","error","complete"])?i=e:i={next:e,error:t,complete:n},i.next===void 0&&(i.next=Cv),i.error===void 0&&(i.error=Cv),i.complete===void 0&&(i.complete=Cv);const s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?i.error(this.finalError):i.complete()}catch{}}),this.observers.push(i),s}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{t(this.observers[e])}catch(n){typeof console<"u"&&console.error&&console.error(n)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function e7(r,e){if(typeof r!="object"||r===null)return!1;for(const t of e)if(t in r&&typeof r[t]=="function")return!0;return!1}function Cv(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jn(r){return r&&r._delegate?r._delegate:r}class Yl{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vc="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t7{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const n=new F5;if(this.instancesDeferred.set(t,n),this.isInitialized(t)||this.shouldAutoInitialize())try{const i=this.getOrInitializeService({instanceIdentifier:t});i&&n.resolve(i)}catch{}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),i=(t=e==null?void 0:e.optional)!==null&&t!==void 0?t:!1;if(this.isInitialized(n)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:n})}catch(s){if(i)return null;throw s}else{if(i)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(r7(e))try{this.getOrInitializeService({instanceIdentifier:Vc})}catch{}for(const[t,n]of this.instancesDeferred.entries()){const i=this.normalizeInstanceIdentifier(t);try{const s=this.getOrInitializeService({instanceIdentifier:i});n.resolve(s)}catch{}}}}clearInstance(e=Vc){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(t=>"INTERNAL"in t).map(t=>t.INTERNAL.delete()),...e.filter(t=>"_delete"in t).map(t=>t._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Vc){return this.instances.has(e)}getOptions(e=Vc){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const i=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[s,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(s);n===l&&o.resolve(i)}return i}onInit(e,t){var n;const i=this.normalizeInstanceIdentifier(t),s=(n=this.onInitCallbacks.get(i))!==null&&n!==void 0?n:new Set;s.add(e),this.onInitCallbacks.set(i,s);const o=this.instances.get(i);return o&&e(o,i),()=>{s.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:n7(e),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}return n||null}normalizeInstanceIdentifier(e=Vc){return this.component?this.component.multipleInstances?e:Vc:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function n7(r){return r===Vc?void 0:r}function r7(r){return r.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i7{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new t7(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ut;(function(r){r[r.DEBUG=0]="DEBUG",r[r.VERBOSE=1]="VERBOSE",r[r.INFO=2]="INFO",r[r.WARN=3]="WARN",r[r.ERROR=4]="ERROR",r[r.SILENT=5]="SILENT"})(Ut||(Ut={}));const s7={debug:Ut.DEBUG,verbose:Ut.VERBOSE,info:Ut.INFO,warn:Ut.WARN,error:Ut.ERROR,silent:Ut.SILENT},o7=Ut.INFO,a7={[Ut.DEBUG]:"log",[Ut.VERBOSE]:"log",[Ut.INFO]:"info",[Ut.WARN]:"warn",[Ut.ERROR]:"error"},l7=(r,e,...t)=>{if(e<r.logLevel)return;const n=new Date().toISOString(),i=a7[e];if(i)console[i](`[${n}]  ${r.name}:`,...t);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class tb{constructor(e){this.name=e,this._logLevel=o7,this._logHandler=l7,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Ut))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?s7[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Ut.DEBUG,...e),this._logHandler(this,Ut.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Ut.VERBOSE,...e),this._logHandler(this,Ut.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Ut.INFO,...e),this._logHandler(this,Ut.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Ut.WARN,...e),this._logHandler(this,Ut.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Ut.ERROR,...e),this._logHandler(this,Ut.ERROR,...e)}}const c7=(r,e)=>e.some(t=>r instanceof t);let GE,KE;function u7(){return GE||(GE=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function d7(){return KE||(KE=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const C4=new WeakMap,Z_=new WeakMap,R4=new WeakMap,Rv=new WeakMap,nb=new WeakMap;function h7(r){const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("success",s),r.removeEventListener("error",o)},s=()=>{t(Ul(r.result)),i()},o=()=>{n(r.error),i()};r.addEventListener("success",s),r.addEventListener("error",o)});return e.then(t=>{t instanceof IDBCursor&&C4.set(t,r)}).catch(()=>{}),nb.set(e,r),e}function f7(r){if(Z_.has(r))return;const e=new Promise((t,n)=>{const i=()=>{r.removeEventListener("complete",s),r.removeEventListener("error",o),r.removeEventListener("abort",o)},s=()=>{t(),i()},o=()=>{n(r.error||new DOMException("AbortError","AbortError")),i()};r.addEventListener("complete",s),r.addEventListener("error",o),r.addEventListener("abort",o)});Z_.set(r,e)}let Q_={get(r,e,t){if(r instanceof IDBTransaction){if(e==="done")return Z_.get(r);if(e==="objectStoreNames")return r.objectStoreNames||R4.get(r);if(e==="store")return t.objectStoreNames[1]?void 0:t.objectStore(t.objectStoreNames[0])}return Ul(r[e])},set(r,e,t){return r[e]=t,!0},has(r,e){return r instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in r}};function m7(r){Q_=r(Q_)}function p7(r){return r===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...t){const n=r.call(jv(this),e,...t);return R4.set(n,e.sort?e.sort():[e]),Ul(n)}:d7().includes(r)?function(...e){return r.apply(jv(this),e),Ul(C4.get(this))}:function(...e){return Ul(r.apply(jv(this),e))}}function g7(r){return typeof r=="function"?p7(r):(r instanceof IDBTransaction&&f7(r),c7(r,u7())?new Proxy(r,Q_):r)}function Ul(r){if(r instanceof IDBRequest)return h7(r);if(Rv.has(r))return Rv.get(r);const e=g7(r);return e!==r&&(Rv.set(r,e),nb.set(e,r)),e}const jv=r=>nb.get(r);function y7(r,e,{blocked:t,upgrade:n,blocking:i,terminated:s}={}){const o=indexedDB.open(r,e),l=Ul(o);return n&&o.addEventListener("upgradeneeded",d=>{n(Ul(o.result),d.oldVersion,d.newVersion,Ul(o.transaction),d)}),t&&o.addEventListener("blocked",d=>t(d.oldVersion,d.newVersion,d)),l.then(d=>{s&&d.addEventListener("close",()=>s()),i&&d.addEventListener("versionchange",f=>i(f.oldVersion,f.newVersion,f))}).catch(()=>{}),l}const v7=["get","getKey","getAll","getAllKeys","count"],_7=["put","add","delete","clear"],Ov=new Map;function YE(r,e){if(!(r instanceof IDBDatabase&&!(e in r)&&typeof e=="string"))return;if(Ov.get(e))return Ov.get(e);const t=e.replace(/FromIndex$/,""),n=e!==t,i=_7.includes(t);if(!(t in(n?IDBIndex:IDBObjectStore).prototype)||!(i||v7.includes(t)))return;const s=async function(o,...l){const d=this.transaction(o,i?"readwrite":"readonly");let f=d.store;return n&&(f=f.index(l.shift())),(await Promise.all([f[t](...l),i&&d.done]))[0]};return Ov.set(e,s),s}m7(r=>({...r,get:(e,t,n)=>YE(e,t)||r.get(e,t,n),has:(e,t)=>!!YE(e,t)||r.has(e,t)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x7{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(t=>{if(b7(t)){const n=t.getImmediate();return`${n.library}/${n.version}`}else return null}).filter(t=>t).join(" ")}}function b7(r){const e=r.getComponent();return(e==null?void 0:e.type)==="VERSION"}const X_="@firebase/app",ZE="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Aa=new tb("@firebase/app"),w7="@firebase/app-compat",E7="@firebase/analytics-compat",S7="@firebase/analytics",T7="@firebase/app-check-compat",A7="@firebase/app-check",N7="@firebase/auth",I7="@firebase/auth-compat",k7="@firebase/database",P7="@firebase/data-connect",C7="@firebase/database-compat",R7="@firebase/functions",j7="@firebase/functions-compat",O7="@firebase/installations",M7="@firebase/installations-compat",D7="@firebase/messaging",L7="@firebase/messaging-compat",F7="@firebase/performance",V7="@firebase/performance-compat",z7="@firebase/remote-config",B7="@firebase/remote-config-compat",U7="@firebase/storage",q7="@firebase/storage-compat",H7="@firebase/firestore",$7="@firebase/ai",W7="@firebase/firestore-compat",G7="firebase",K7="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J_="[DEFAULT]",Y7={[X_]:"fire-core",[w7]:"fire-core-compat",[S7]:"fire-analytics",[E7]:"fire-analytics-compat",[A7]:"fire-app-check",[T7]:"fire-app-check-compat",[N7]:"fire-auth",[I7]:"fire-auth-compat",[k7]:"fire-rtdb",[P7]:"fire-data-connect",[C7]:"fire-rtdb-compat",[R7]:"fire-fn",[j7]:"fire-fn-compat",[O7]:"fire-iid",[M7]:"fire-iid-compat",[D7]:"fire-fcm",[L7]:"fire-fcm-compat",[F7]:"fire-perf",[V7]:"fire-perf-compat",[z7]:"fire-rc",[B7]:"fire-rc-compat",[U7]:"fire-gcs",[q7]:"fire-gcs-compat",[H7]:"fire-fst",[W7]:"fire-fst-compat",[$7]:"fire-vertex","fire-js":"fire-js",[G7]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lf=new Map,Z7=new Map,ex=new Map;function QE(r,e){try{r.container.addComponent(e)}catch(t){Aa.debug(`Component ${e.name} failed to register with FirebaseApp ${r.name}`,t)}}function nu(r){const e=r.name;if(ex.has(e))return Aa.debug(`There were multiple attempts to register component ${e}.`),!1;ex.set(e,r);for(const t of Lf.values())QE(t,r);for(const t of Z7.values())QE(t,r);return!0}function xy(r,e){const t=r.container.getProvider("heartbeat").getImmediate({optional:!0});return t&&t.triggerHeartbeat(),r.container.getProvider(e)}function ui(r){return r==null?!1:r.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q7={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ql=new dm("app","Firebase",Q7);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X7{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new Yl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ql.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Wd=K7;function j4(r,e={}){let t=r;typeof e!="object"&&(e={name:e});const n=Object.assign({name:J_,automaticDataCollectionEnabled:!0},e),i=n.name;if(typeof i!="string"||!i)throw ql.create("bad-app-name",{appName:String(i)});if(t||(t=T4()),!t)throw ql.create("no-options");const s=Lf.get(i);if(s){if(Kl(t,s.options)&&Kl(n,s.config))return s;throw ql.create("duplicate-app",{appName:i})}const o=new i7(i);for(const d of ex.values())o.addComponent(d);const l=new X7(t,n,o);return Lf.set(i,l),l}function by(r=J_){const e=Lf.get(r);if(!e&&r===J_&&T4())return j4();if(!e)throw ql.create("no-app",{appName:r});return e}function J7(){return Array.from(Lf.values())}function jo(r,e,t){var n;let i=(n=Y7[r])!==null&&n!==void 0?n:r;t&&(i+=`-${t}`);const s=i.match(/\s|\//),o=e.match(/\s|\//);if(s||o){const l=[`Unable to register library "${i}" with version "${e}":`];s&&l.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Aa.warn(l.join(" "));return}nu(new Yl(`${i}-version`,()=>({library:i,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ej="firebase-heartbeat-database",tj=1,Ff="firebase-heartbeat-store";let Mv=null;function O4(){return Mv||(Mv=y7(ej,tj,{upgrade:(r,e)=>{switch(e){case 0:try{r.createObjectStore(Ff)}catch(t){console.warn(t)}}}}).catch(r=>{throw ql.create("idb-open",{originalErrorMessage:r.message})})),Mv}async function nj(r){try{const t=(await O4()).transaction(Ff),n=await t.objectStore(Ff).get(M4(r));return await t.done,n}catch(e){if(e instanceof Ca)Aa.warn(e.message);else{const t=ql.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Aa.warn(t.message)}}}async function XE(r,e){try{const n=(await O4()).transaction(Ff,"readwrite");await n.objectStore(Ff).put(e,M4(r)),await n.done}catch(t){if(t instanceof Ca)Aa.warn(t.message);else{const n=ql.create("idb-set",{originalErrorMessage:t==null?void 0:t.message});Aa.warn(n.message)}}}function M4(r){return`${r.name}!${r.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rj=1024,ij=30;class sj{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new aj(t),this._heartbeatsCachePromise=this._storage.read().then(n=>(this._heartbeatsCache=n,n))}async triggerHeartbeat(){var e,t;try{const i=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),s=JE();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((t=this._heartbeatsCache)===null||t===void 0?void 0:t.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===s||this._heartbeatsCache.heartbeats.some(o=>o.date===s))return;if(this._heartbeatsCache.heartbeats.push({date:s,agent:i}),this._heartbeatsCache.heartbeats.length>ij){const o=lj(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(n){Aa.warn(n)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const t=JE(),{heartbeatsToSend:n,unsentEntries:i}=oj(this._heartbeatsCache.heartbeats),s=Ng(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,i.length>0?(this._heartbeatsCache.heartbeats=i,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),s}catch(t){return Aa.warn(t),""}}}function JE(){return new Date().toISOString().substring(0,10)}function oj(r,e=rj){const t=[];let n=r.slice();for(const i of r){const s=t.find(o=>o.agent===i.agent);if(s){if(s.dates.push(i.date),eS(t)>e){s.dates.pop();break}}else if(t.push({agent:i.agent,dates:[i.date]}),eS(t)>e){t.pop();break}n=n.slice(1)}return{heartbeatsToSend:t,unsentEntries:n}}class aj{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return P4()?G5().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const t=await nj(this.app);return t!=null&&t.heartbeats?t:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return XE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var t;if(await this._canUseIndexedDBPromise){const i=await this.read();return XE(this.app,{lastSentHeartbeatDate:(t=e.lastSentHeartbeatDate)!==null&&t!==void 0?t:i.lastSentHeartbeatDate,heartbeats:[...i.heartbeats,...e.heartbeats]})}else return}}function eS(r){return Ng(JSON.stringify({version:2,heartbeats:r})).length}function lj(r){if(r.length===0)return-1;let e=0,t=r[0].date;for(let n=1;n<r.length;n++)r[n].date<t&&(t=r[n].date,e=n);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cj(r){nu(new Yl("platform-logger",e=>new x7(e),"PRIVATE")),nu(new Yl("heartbeat",e=>new sj(e),"PRIVATE")),jo(X_,ZE,r),jo(X_,ZE,"esm2017"),jo("fire-js","")}cj("");function rb(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t}function D4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const uj=D4,L4=new dm("auth","Firebase",D4());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ig=new tb("@firebase/auth");function dj(r,...e){Ig.logLevel<=Ut.WARN&&Ig.warn(`Auth (${Wd}): ${r}`,...e)}function ig(r,...e){Ig.logLevel<=Ut.ERROR&&Ig.error(`Auth (${Wd}): ${r}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Is(r,...e){throw sb(r,...e)}function ao(r,...e){return sb(r,...e)}function ib(r,e,t){const n=Object.assign(Object.assign({},uj()),{[e]:t});return new dm("auth","Firebase",n).create(e,{appName:r.name})}function Oo(r){return ib(r,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function hj(r,e,t){const n=t;if(!(e instanceof n))throw n.name!==e.constructor.name&&Is(r,"argument-error"),ib(r,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function sb(r,...e){if(typeof r!="string"){const t=e[0],n=[...e.slice(1)];return n[0]&&(n[0].appName=r.name),r._errorFactory.create(t,...n)}return L4.create(r,...e)}function at(r,e,...t){if(!r)throw sb(e,...t)}function xa(r){const e="INTERNAL ASSERTION FAILED: "+r;throw ig(e),new Error(e)}function Na(r,e){r||xa(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kg(){var r;return typeof self<"u"&&((r=self.location)===null||r===void 0?void 0:r.href)||""}function fj(){return tS()==="http:"||tS()==="https:"}function tS(){var r;return typeof self<"u"&&((r=self.location)===null||r===void 0?void 0:r.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mj(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(fj()||H5()||"connection"in navigator)?navigator.onLine:!0}function pj(){if(typeof navigator>"u")return null;const r=navigator;return r.languages&&r.languages[0]||r.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fm{constructor(e,t){this.shortDelay=e,this.longDelay=t,Na(t>e,"Short delay should be less than long delay!"),this.isMobile=U5()||$5()}get(){return mj()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ob(r,e){Na(r.emulator,"Emulator should always be set here");const{url:t}=r.emulator;return e?`${t}${e.startsWith("/")?e.slice(1):e}`:t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F4{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;xa("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;xa("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;xa("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gj={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yj=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],vj=new fm(3e4,6e4);function Ra(r,e){return r.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:r.tenantId}):e}async function ja(r,e,t,n,i={}){return V4(r,i,async()=>{let s={},o={};n&&(e==="GET"?o=n:s={body:JSON.stringify(n)});const l=hm(Object.assign({key:r.config.apiKey},o)).slice(1),d=await r._getAdditionalHeaders();d["Content-Type"]="application/json",r.languageCode&&(d["X-Firebase-Locale"]=r.languageCode);const f=Object.assign({method:e,headers:d},s);return q5()||(f.referrerPolicy="no-referrer"),r.emulatorConfig&&vu(r.emulatorConfig.host)&&(f.credentials="include"),F4.fetch()(await z4(r,r.config.apiHost,t,l),f)})}async function V4(r,e,t){r._canInitEmulator=!1;const n=Object.assign(Object.assign({},gj),e);try{const i=new xj(r),s=await Promise.race([t(),i.promise]);i.clearNetworkTimeout();const o=await s.json();if("needConfirmation"in o)throw kp(r,"account-exists-with-different-credential",o);if(s.ok&&!("errorMessage"in o))return o;{const l=s.ok?o.errorMessage:o.error.message,[d,f]=l.split(" : ");if(d==="FEDERATED_USER_ID_ALREADY_LINKED")throw kp(r,"credential-already-in-use",o);if(d==="EMAIL_EXISTS")throw kp(r,"email-already-in-use",o);if(d==="USER_DISABLED")throw kp(r,"user-disabled",o);const m=n[d]||d.toLowerCase().replace(/[_\s]+/g,"-");if(f)throw ib(r,m,f);Is(r,m)}}catch(i){if(i instanceof Ca)throw i;Is(r,"network-request-failed",{message:String(i)})}}async function mm(r,e,t,n,i={}){const s=await ja(r,e,t,n,i);return"mfaPendingCredential"in s&&Is(r,"multi-factor-auth-required",{_serverResponse:s}),s}async function z4(r,e,t,n){const i=`${e}${t}?${n}`,s=r,o=s.config.emulator?ob(r.config,i):`${r.config.apiScheme}://${i}`;return yj.includes(t)&&(await s._persistenceManagerAvailable,s._getPersistenceType()==="COOKIE")?s._getPersistence()._getFinalTarget(o).toString():o}function _j(r){switch(r){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class xj{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((t,n)=>{this.timer=setTimeout(()=>n(ao(this.auth,"network-request-failed")),vj.get())})}}function kp(r,e,t){const n={appName:r.name};t.email&&(n.email=t.email),t.phoneNumber&&(n.phoneNumber=t.phoneNumber);const i=ao(r,e,n);return i.customData._tokenResponse=t,i}function nS(r){return r!==void 0&&r.enterprise!==void 0}class bj{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return _j(t.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function wj(r,e){return ja(r,"GET","/v2/recaptchaConfig",Ra(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ej(r,e){return ja(r,"POST","/v1/accounts:delete",e)}async function Pg(r,e){return ja(r,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wf(r){if(r)try{const e=new Date(Number(r));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Sj(r,e=!1){const t=jn(r),n=await t.getIdToken(e),i=ab(n);at(i&&i.exp&&i.auth_time&&i.iat,t.auth,"internal-error");const s=typeof i.firebase=="object"?i.firebase:void 0,o=s==null?void 0:s.sign_in_provider;return{claims:i,token:n,authTime:wf(Dv(i.auth_time)),issuedAtTime:wf(Dv(i.iat)),expirationTime:wf(Dv(i.exp)),signInProvider:o||null,signInSecondFactor:(s==null?void 0:s.sign_in_second_factor)||null}}function Dv(r){return Number(r)*1e3}function ab(r){const[e,t,n]=r.split(".");if(e===void 0||t===void 0||n===void 0)return ig("JWT malformed, contained fewer than 3 sections"),null;try{const i=b4(t);return i?JSON.parse(i):(ig("Failed to decode base64 JWT payload"),null)}catch(i){return ig("Caught error parsing JWT payload as JSON",i==null?void 0:i.toString()),null}}function rS(r){const e=ab(r);return at(e,"internal-error"),at(typeof e.exp<"u","internal-error"),at(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Vf(r,e,t=!1){if(t)return e;try{return await e}catch(n){throw n instanceof Ca&&Tj(n)&&r.auth.currentUser===r&&await r.auth.signOut(),n}}function Tj({code:r}){return r==="auth/user-disabled"||r==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aj{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const n=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),n}else{this.errorBackoff=3e4;const i=((t=this.user.stsTokenManager.expirationTime)!==null&&t!==void 0?t:0)-Date.now()-3e5;return Math.max(0,i)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tx{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=wf(this.lastLoginAt),this.creationTime=wf(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Cg(r){var e;const t=r.auth,n=await r.getIdToken(),i=await Vf(r,Pg(t,{idToken:n}));at(i==null?void 0:i.users.length,t,"internal-error");const s=i.users[0];r._notifyReloadListener(s);const o=!((e=s.providerUserInfo)===null||e===void 0)&&e.length?B4(s.providerUserInfo):[],l=Ij(r.providerData,o),d=r.isAnonymous,f=!(r.email&&s.passwordHash)&&!(l!=null&&l.length),m=d?f:!1,y={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:l,metadata:new tx(s.createdAt,s.lastLoginAt),isAnonymous:m};Object.assign(r,y)}async function Nj(r){const e=jn(r);await Cg(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Ij(r,e){return[...r.filter(n=>!e.some(i=>i.providerId===n.providerId)),...e]}function B4(r){return r.map(e=>{var{providerId:t}=e,n=rb(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kj(r,e){const t=await V4(r,{},async()=>{const n=hm({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:i,apiKey:s}=r.config,o=await z4(r,i,"/v1/token",`key=${s}`),l=await r._getAdditionalHeaders();l["Content-Type"]="application/x-www-form-urlencoded";const d={method:"POST",headers:l,body:n};return r.emulatorConfig&&vu(r.emulatorConfig.host)&&(d.credentials="include"),F4.fetch()(o,d)});return{accessToken:t.access_token,expiresIn:t.expires_in,refreshToken:t.refresh_token}}async function Pj(r,e){return ja(r,"POST","/v2/accounts:revokeToken",Ra(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yd{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){at(e.idToken,"internal-error"),at(typeof e.idToken<"u","internal-error"),at(typeof e.refreshToken<"u","internal-error");const t="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):rS(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){at(e.length!==0,"internal-error");const t=rS(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return!t&&this.accessToken&&!this.isExpired?this.accessToken:(at(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:i,expiresIn:s}=await kj(e,t);this.updateTokensAndExpiration(n,i,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+n*1e3}static fromJSON(e,t){const{refreshToken:n,accessToken:i,expirationTime:s}=t,o=new yd;return n&&(at(typeof n=="string","internal-error",{appName:e}),o.refreshToken=n),i&&(at(typeof i=="string","internal-error",{appName:e}),o.accessToken=i),s&&(at(typeof s=="number","internal-error",{appName:e}),o.expirationTime=s),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new yd,this.toJSON())}_performRefresh(){return xa("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Al(r,e){at(typeof r=="string"||typeof r>"u","internal-error",{appName:e})}class oo{constructor(e){var{uid:t,auth:n,stsTokenManager:i}=e,s=rb(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Aj(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=i,this.accessToken=i.accessToken,this.displayName=s.displayName||null,this.email=s.email||null,this.emailVerified=s.emailVerified||!1,this.phoneNumber=s.phoneNumber||null,this.photoURL=s.photoURL||null,this.isAnonymous=s.isAnonymous||!1,this.tenantId=s.tenantId||null,this.providerData=s.providerData?[...s.providerData]:[],this.metadata=new tx(s.createdAt||void 0,s.lastLoginAt||void 0)}async getIdToken(e){const t=await Vf(this,this.stsTokenManager.getToken(this.auth,e));return at(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return Sj(this,e)}reload(){return Nj(this)}_assign(e){this!==e&&(at(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(t=>Object.assign({},t)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new oo(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){at(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await Cg(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ui(this.auth.app))return Promise.reject(Oo(this.auth));const e=await this.getIdToken();return await Vf(this,Ej(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,i,s,o,l,d,f,m;const y=(n=t.displayName)!==null&&n!==void 0?n:void 0,g=(i=t.email)!==null&&i!==void 0?i:void 0,_=(s=t.phoneNumber)!==null&&s!==void 0?s:void 0,E=(o=t.photoURL)!==null&&o!==void 0?o:void 0,x=(l=t.tenantId)!==null&&l!==void 0?l:void 0,b=(d=t._redirectEventId)!==null&&d!==void 0?d:void 0,T=(f=t.createdAt)!==null&&f!==void 0?f:void 0,N=(m=t.lastLoginAt)!==null&&m!==void 0?m:void 0,{uid:R,emailVerified:I,isAnonymous:j,providerData:U,stsTokenManager:C}=t;at(R&&C,e,"internal-error");const k=yd.fromJSON(this.name,C);at(typeof R=="string",e,"internal-error"),Al(y,e.name),Al(g,e.name),at(typeof I=="boolean",e,"internal-error"),at(typeof j=="boolean",e,"internal-error"),Al(_,e.name),Al(E,e.name),Al(x,e.name),Al(b,e.name),Al(T,e.name),Al(N,e.name);const D=new oo({uid:R,auth:e,email:g,emailVerified:I,displayName:y,isAnonymous:j,photoURL:E,phoneNumber:_,tenantId:x,stsTokenManager:k,createdAt:T,lastLoginAt:N});return U&&Array.isArray(U)&&(D.providerData=U.map(O=>Object.assign({},O))),b&&(D._redirectEventId=b),D}static async _fromIdTokenResponse(e,t,n=!1){const i=new yd;i.updateFromServerResponse(t);const s=new oo({uid:t.localId,auth:e,stsTokenManager:i,isAnonymous:n});return await Cg(s),s}static async _fromGetAccountInfoResponse(e,t,n){const i=t.users[0];at(i.localId!==void 0,"internal-error");const s=i.providerUserInfo!==void 0?B4(i.providerUserInfo):[],o=!(i.email&&i.passwordHash)&&!(s!=null&&s.length),l=new yd;l.updateFromIdToken(n);const d=new oo({uid:i.localId,auth:e,stsTokenManager:l,isAnonymous:o}),f={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:s,metadata:new tx(i.createdAt,i.lastLoginAt),isAnonymous:!(i.email&&i.passwordHash)&&!(s!=null&&s.length)};return Object.assign(d,f),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iS=new Map;function ba(r){Na(r instanceof Function,"Expected a class definition");let e=iS.get(r);return e?(Na(e instanceof r,"Instance stored in cache mismatched with class"),e):(e=new r,iS.set(r,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class U4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return t===void 0?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}U4.type="NONE";const sS=U4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sg(r,e,t){return`firebase:${r}:${e}:${t}`}class vd{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:i,name:s}=this.auth;this.fullUserKey=sg(this.userKey,i.apiKey,s),this.fullPersistenceKey=sg("persistence",i.apiKey,s),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const t=await Pg(this.auth,{idToken:e}).catch(()=>{});return t?oo._fromGetAccountInfoResponse(this.auth,t,e):null}return oo._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,t)return this.setCurrentUser(t)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new vd(ba(sS),e,n);const i=(await Promise.all(t.map(async f=>{if(await f._isAvailable())return f}))).filter(f=>f);let s=i[0]||ba(sS);const o=sg(n,e.config.apiKey,e.name);let l=null;for(const f of t)try{const m=await f._get(o);if(m){let y;if(typeof m=="string"){const g=await Pg(e,{idToken:m}).catch(()=>{});if(!g)break;y=await oo._fromGetAccountInfoResponse(e,g,m)}else y=oo._fromJSON(e,m);f!==s&&(l=y),s=f;break}}catch{}const d=i.filter(f=>f._shouldAllowMigration);return!s._shouldAllowMigration||!d.length?new vd(s,e,n):(s=d[0],l&&await s._set(o,l.toJSON()),await Promise.all(t.map(async f=>{if(f!==s)try{await f._remove(o)}catch{}})),new vd(s,e,n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oS(r){const e=r.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(W4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(q4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(K4(e))return"Blackberry";if(Y4(e))return"Webos";if(H4(e))return"Safari";if((e.includes("chrome/")||$4(e))&&!e.includes("edge/"))return"Chrome";if(G4(e))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=r.match(t);if((n==null?void 0:n.length)===2)return n[1]}return"Other"}function q4(r=pr()){return/firefox\//i.test(r)}function H4(r=pr()){const e=r.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function $4(r=pr()){return/crios\//i.test(r)}function W4(r=pr()){return/iemobile/i.test(r)}function G4(r=pr()){return/android/i.test(r)}function K4(r=pr()){return/blackberry/i.test(r)}function Y4(r=pr()){return/webos/i.test(r)}function lb(r=pr()){return/iphone|ipad|ipod/i.test(r)||/macintosh/i.test(r)&&/mobile/i.test(r)}function Cj(r=pr()){var e;return lb(r)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Rj(){return W5()&&document.documentMode===10}function Z4(r=pr()){return lb(r)||G4(r)||Y4(r)||K4(r)||/windows phone/i.test(r)||W4(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q4(r,e=[]){let t;switch(r){case"Browser":t=oS(pr());break;case"Worker":t=`${oS(pr())}-${r}`;break;default:t=r}const n=e.length?e.join(","):"FirebaseCore-web";return`${t}/JsCore/${Wd}/${n}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jj{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=s=>new Promise((o,l)=>{try{const d=e(s);o(d)}catch(d){l(d)}});n.onAbort=t,this.queue.push(n);const i=this.queue.length-1;return()=>{this.queue[i]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const i of t)try{i()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n==null?void 0:n.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Oj(r,e={}){return ja(r,"GET","/v2/passwordPolicy",Ra(r,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mj=6;class Dj{constructor(e){var t,n,i,s;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(t=o.minPasswordLength)!==null&&t!==void 0?t:Mj,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(i=(n=e.allowedNonAlphanumericCharacters)===null||n===void 0?void 0:n.join(""))!==null&&i!==void 0?i:"",this.forceUpgradeOnSignin=(s=e.forceUpgradeOnSignin)!==null&&s!==void 0?s:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,i,s,o,l;const d={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,d),this.validatePasswordCharacterOptions(e,d),d.isValid&&(d.isValid=(t=d.meetsMinPasswordLength)!==null&&t!==void 0?t:!0),d.isValid&&(d.isValid=(n=d.meetsMaxPasswordLength)!==null&&n!==void 0?n:!0),d.isValid&&(d.isValid=(i=d.containsLowercaseLetter)!==null&&i!==void 0?i:!0),d.isValid&&(d.isValid=(s=d.containsUppercaseLetter)!==null&&s!==void 0?s:!0),d.isValid&&(d.isValid=(o=d.containsNumericCharacter)!==null&&o!==void 0?o:!0),d.isValid&&(d.isValid=(l=d.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),d}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,i=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),i&&(t.meetsMaxPasswordLength=e.length<=i)}validatePasswordCharacterOptions(e,t){this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);let n;for(let i=0;i<e.length;i++)n=e.charAt(i),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,i,s){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=i)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lj{constructor(e,t,n,i){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=i,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new aS(this),this.idTokenSubscription=new aS(this),this.beforeStateQueue=new jj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=L4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=i.sdkClientVersion,this._persistenceManagerAvailable=new Promise(s=>this._resolvePersistenceManagerAvailable=s)}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ba(t)),this._initializationPromise=this.queue(async()=>{var n,i,s;if(!this._deleted&&(this.persistenceManager=await vd.create(this,e),(n=this._resolvePersistenceManagerAvailable)===null||n===void 0||n.call(this),!this._deleted)){if(!((i=this._popupRedirectResolver)===null||i===void 0)&&i._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(t),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const t=await Pg(this,{idToken:e}),n=await oo._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(ui(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let i=n,s=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(t=this.redirectUser)===null||t===void 0?void 0:t._redirectEventId,l=i==null?void 0:i._redirectEventId,d=await this.tryRedirectSignIn(e);(!o||o===l)&&(d!=null&&d.user)&&(i=d.user,s=!0)}if(!i)return this.directlySetCurrentUser(null);if(!i._redirectEventId){if(s)try{await this.beforeStateQueue.runMiddleware(i)}catch(o){i=n,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return i?this.reloadAndSetCurrentUserOrClear(i):this.directlySetCurrentUser(null)}return at(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===i._redirectEventId?this.directlySetCurrentUser(i):this.reloadAndSetCurrentUserOrClear(i)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await Cg(e)}catch(t){if((t==null?void 0:t.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=pj()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ui(this.app))return Promise.reject(Oo(this));const t=e?jn(e):null;return t&&at(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&at(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return ui(this.app)?Promise.reject(Oo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ui(this.app)?Promise.reject(Oo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(ba(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Oj(this),t=new Dj(e);this.tenantId===null?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new dm("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged(()=>{n(),e()},t)}})}async revokeAccessToken(e){if(this.currentUser){const t=await this.currentUser.getIdToken(),n={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:t};this.tenantId!=null&&(n.tenantId=this.tenantId),await Pj(this,n)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return e===null?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ba(e)||this._popupRedirectResolver;at(t,this,"argument-error"),this.redirectPersistenceManager=await vd.create(this,[ba(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue(async()=>{}),((t=this._currentUser)===null||t===void 0?void 0:t._redirectEventId)===e?this._currentUser:((n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=(t=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&t!==void 0?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,i){if(this._deleted)return()=>{};const s=typeof t=="function"?t:t.next.bind(t);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(at(l,this,"internal-error"),l.then(()=>{o||s(this.currentUser)}),typeof t=="function"){const d=e.addObserver(t,n,i);return()=>{o=!0,d()}}else{const d=e.addObserver(t);return()=>{o=!0,d()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return at(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Q4(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const i=await this._getAppCheckToken();return i&&(t["X-Firebase-AppCheck"]=i),t}async _getAppCheckToken(){var e;if(ui(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const t=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return t!=null&&t.error&&dj(`Error while retrieving App Check token: ${t.error}`),t==null?void 0:t.token}}function zo(r){return jn(r)}class aS{constructor(e){this.auth=e,this.observer=null,this.addObserver=X5(t=>this.observer=t)}get next(){return at(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wy={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Fj(r){wy=r}function X4(r){return wy.loadJS(r)}function Vj(){return wy.recaptchaEnterpriseScript}function zj(){return wy.gapiScript}function Bj(r){return`__${r}${Math.floor(Math.random()*1e6)}`}class Uj{constructor(){this.enterprise=new qj}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class qj{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Hj="recaptcha-enterprise",J4="NO_RECAPTCHA";class $j{constructor(e){this.type=Hj,this.auth=zo(e)}async verify(e="verify",t=!1){async function n(s){if(!t){if(s.tenantId==null&&s._agentRecaptchaConfig!=null)return s._agentRecaptchaConfig.siteKey;if(s.tenantId!=null&&s._tenantRecaptchaConfigs[s.tenantId]!==void 0)return s._tenantRecaptchaConfigs[s.tenantId].siteKey}return new Promise(async(o,l)=>{wj(s,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(d=>{if(d.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const f=new bj(d);return s.tenantId==null?s._agentRecaptchaConfig=f:s._tenantRecaptchaConfigs[s.tenantId]=f,o(f.siteKey)}}).catch(d=>{l(d)})})}function i(s,o,l){const d=window.grecaptcha;nS(d)?d.enterprise.ready(()=>{d.enterprise.execute(s,{action:e}).then(f=>{o(f)}).catch(()=>{o(J4)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new Uj().execute("siteKey",{action:"verify"}):new Promise((s,o)=>{n(this.auth).then(l=>{if(!t&&nS(window.grecaptcha))i(l,s,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let d=Vj();d.length!==0&&(d+=l),X4(d).then(()=>{i(l,s,o)}).catch(f=>{o(f)})}}).catch(l=>{o(l)})})}}async function lS(r,e,t,n=!1,i=!1){const s=new $j(r);let o;if(i)o=J4;else try{o=await s.verify(t)}catch{o=await s.verify(t,!0)}const l=Object.assign({},e);if(t==="mfaSmsEnrollment"||t==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const d=l.phoneEnrollmentInfo.phoneNumber,f=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:d,recaptchaToken:f,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const d=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:d,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return n?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function zf(r,e,t,n,i){var s;if(!((s=r._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const o=await lS(r,e,t,t==="getOobCode");return n(r,o)}else return n(r,e).catch(async o=>{if(o.code==="auth/missing-recaptcha-token"){console.log(`${t} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await lS(r,e,t,t==="getOobCode");return n(r,l)}else return Promise.reject(o)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wj(r,e){const t=xy(r,"auth");if(t.isInitialized()){const i=t.getImmediate(),s=t.getOptions();if(Kl(s,e??{}))return i;Is(i,"already-initialized")}return t.initialize({options:e})}function Gj(r,e){const t=(e==null?void 0:e.persistence)||[],n=(Array.isArray(t)?t:[t]).map(ba);e!=null&&e.errorMap&&r._updateErrorMap(e.errorMap),r._initializeWithPersistence(n,e==null?void 0:e.popupRedirectResolver)}function Kj(r,e,t){const n=zo(r);at(/^https?:\/\//.test(e),n,"invalid-emulator-scheme");const i=!1,s=ek(e),{host:o,port:l}=Yj(e),d=l===null?"":`:${l}`,f={url:`${s}//${o}${d}/`},m=Object.freeze({host:o,port:l,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})});if(!n._canInitEmulator){at(n.config.emulator&&n.emulatorConfig,n,"emulator-config-failed"),at(Kl(f,n.config.emulator)&&Kl(m,n.emulatorConfig),n,"emulator-config-failed");return}n.config.emulator=f,n.emulatorConfig=m,n.settings.appVerificationDisabledForTesting=!0,vu(o)?(Jx(`${s}//${o}${d}`),eb("Auth",!0)):Zj()}function ek(r){const e=r.indexOf(":");return e<0?"":r.substr(0,e+1)}function Yj(r){const e=ek(r),t=/(\/\/)?([^?#/]+)/.exec(r.substr(e.length));if(!t)return{host:"",port:null};const n=t[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(n);if(i){const s=i[1];return{host:s,port:cS(n.substr(s.length+1))}}else{const[s,o]=n.split(":");return{host:s,port:cS(o)}}}function cS(r){if(!r)return null;const e=Number(r);return isNaN(e)?null:e}function Zj(){function r(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",r):r())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cb{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return xa("not implemented")}_getIdTokenResponse(e){return xa("not implemented")}_linkToIdToken(e,t){return xa("not implemented")}_getReauthenticationResolver(e){return xa("not implemented")}}async function Qj(r,e){return ja(r,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Xj(r,e){return mm(r,"POST","/v1/accounts:signInWithPassword",Ra(r,e))}async function tk(r,e){return ja(r,"POST","/v1/accounts:sendOobCode",Ra(r,e))}async function Jj(r,e){return tk(r,e)}async function eO(r,e){return tk(r,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tO(r,e){return mm(r,"POST","/v1/accounts:signInWithEmailLink",Ra(r,e))}async function nO(r,e){return mm(r,"POST","/v1/accounts:signInWithEmailLink",Ra(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bf extends cb{constructor(e,t,n,i=null){super("password",n),this._email=e,this._password=t,this._tenantId=i}static _fromEmailAndPassword(e,t){return new Bf(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Bf(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e;if(t!=null&&t.email&&(t!=null&&t.password)){if(t.signInMethod==="password")return this._fromEmailAndPassword(t.email,t.password);if(t.signInMethod==="emailLink")return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const t={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return zf(e,t,"signInWithPassword",Xj);case"emailLink":return tO(e,{email:this._email,oobCode:this._password});default:Is(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":const n={idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return zf(e,n,"signUpPassword",Qj);case"emailLink":return nO(e,{idToken:t,email:this._email,oobCode:this._password});default:Is(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function _d(r,e){return mm(r,"POST","/v1/accounts:signInWithIdp",Ra(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rO="http://localhost";class ru extends cb{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new ru(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):Is("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t=typeof e=="string"?JSON.parse(e):e,{providerId:n,signInMethod:i}=t,s=rb(t,["providerId","signInMethod"]);if(!n||!i)return null;const o=new ru(n,i);return o.idToken=s.idToken||void 0,o.accessToken=s.accessToken||void 0,o.secret=s.secret,o.nonce=s.nonce,o.pendingToken=s.pendingToken||null,o}_getIdTokenResponse(e){const t=this.buildRequest();return _d(e,t)}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,_d(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,_d(e,t)}buildRequest(){const e={requestUri:rO,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=hm(t)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iO(r){switch(r){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function sO(r){const e=af(lf(r)).link,t=e?af(lf(e)).deep_link_id:null,n=af(lf(r)).deep_link_id;return(n?af(lf(n)).link:null)||n||t||e||r}class Ey{constructor(e){var t,n,i,s,o,l;const d=af(lf(e)),f=(t=d.apiKey)!==null&&t!==void 0?t:null,m=(n=d.oobCode)!==null&&n!==void 0?n:null,y=iO((i=d.mode)!==null&&i!==void 0?i:null);at(f&&m&&y,"argument-error"),this.apiKey=f,this.operation=y,this.code=m,this.continueUrl=(s=d.continueUrl)!==null&&s!==void 0?s:null,this.languageCode=(o=d.lang)!==null&&o!==void 0?o:null,this.tenantId=(l=d.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const t=sO(e);try{return new Ey(t)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _u{constructor(){this.providerId=_u.PROVIDER_ID}static credential(e,t){return Bf._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Ey.parseLink(t);return at(n,"argument-error"),Bf._fromEmailAndCode(e,n.code,n.tenantId)}}_u.PROVIDER_ID="password";_u.EMAIL_PASSWORD_SIGN_IN_METHOD="password";_u.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pm extends ub{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cl extends pm{constructor(){super("facebook.com")}static credential(e){return ru._fromParams({providerId:Cl.PROVIDER_ID,signInMethod:Cl.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Cl.credentialFromTaggedObject(e)}static credentialFromError(e){return Cl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Cl.credential(e.oauthAccessToken)}catch{return null}}}Cl.FACEBOOK_SIGN_IN_METHOD="facebook.com";Cl.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _a extends pm{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return ru._fromParams({providerId:_a.PROVIDER_ID,signInMethod:_a.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return _a.credentialFromTaggedObject(e)}static credentialFromError(e){return _a.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return _a.credential(t,n)}catch{return null}}}_a.GOOGLE_SIGN_IN_METHOD="google.com";_a.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rl extends pm{constructor(){super("github.com")}static credential(e){return ru._fromParams({providerId:Rl.PROVIDER_ID,signInMethod:Rl.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Rl.credentialFromTaggedObject(e)}static credentialFromError(e){return Rl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Rl.credential(e.oauthAccessToken)}catch{return null}}}Rl.GITHUB_SIGN_IN_METHOD="github.com";Rl.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jl extends pm{constructor(){super("twitter.com")}static credential(e,t){return ru._fromParams({providerId:jl.PROVIDER_ID,signInMethod:jl.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return jl.credentialFromTaggedObject(e)}static credentialFromError(e){return jl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return jl.credential(t,n)}catch{return null}}}jl.TWITTER_SIGN_IN_METHOD="twitter.com";jl.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oO(r,e){return mm(r,"POST","/v1/accounts:signUp",Ra(r,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,i=!1){const s=await oo._fromIdTokenResponse(e,n,i),o=uS(n);return new iu({user:s,providerId:o,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const i=uS(n);return new iu({user:e,providerId:i,_tokenResponse:n,operationType:t})}}function uS(r){return r.providerId?r.providerId:"phoneNumber"in r?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rg extends Ca{constructor(e,t,n,i){var s;super(t.code,t.message),this.operationType=n,this.user=i,Object.setPrototypeOf(this,Rg.prototype),this.customData={appName:e.name,tenantId:(s=e.tenantId)!==null&&s!==void 0?s:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,i){return new Rg(e,t,n,i)}}function nk(r,e,t,n){return(e==="reauthenticate"?t._getReauthenticationResolver(r):t._getIdTokenResponse(r)).catch(s=>{throw s.code==="auth/multi-factor-auth-required"?Rg._fromErrorAndOperation(r,s,e,n):s})}async function aO(r,e,t=!1){const n=await Vf(r,e._linkToIdToken(r.auth,await r.getIdToken()),t);return iu._forOperation(r,"link",n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lO(r,e,t=!1){const{auth:n}=r;if(ui(n.app))return Promise.reject(Oo(n));const i="reauthenticate";try{const s=await Vf(r,nk(n,i,e,r),t);at(s.idToken,n,"internal-error");const o=ab(s.idToken);at(o,n,"internal-error");const{sub:l}=o;return at(r.uid===l,n,"user-mismatch"),iu._forOperation(r,i,s)}catch(s){throw(s==null?void 0:s.code)==="auth/user-not-found"&&Is(n,"user-mismatch"),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function rk(r,e,t=!1){if(ui(r.app))return Promise.reject(Oo(r));const n="signIn",i=await nk(r,n,e),s=await iu._fromIdTokenResponse(r,n,i);return t||await r._updateCurrentUser(s.user),s}async function ik(r,e){return rk(zo(r),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cO(r,e,t){var n;at(((n=t.url)===null||n===void 0?void 0:n.length)>0,r,"invalid-continue-uri"),at(typeof t.dynamicLinkDomain>"u"||t.dynamicLinkDomain.length>0,r,"invalid-dynamic-link-domain"),at(typeof t.linkDomain>"u"||t.linkDomain.length>0,r,"invalid-hosting-link-domain"),e.continueUrl=t.url,e.dynamicLinkDomain=t.dynamicLinkDomain,e.linkDomain=t.linkDomain,e.canHandleCodeInApp=t.handleCodeInApp,t.iOS&&(at(t.iOS.bundleId.length>0,r,"missing-ios-bundle-id"),e.iOSBundleId=t.iOS.bundleId),t.android&&(at(t.android.packageName.length>0,r,"missing-android-pkg-name"),e.androidInstallApp=t.android.installApp,e.androidMinimumVersionCode=t.android.minimumVersion,e.androidPackageName=t.android.packageName)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sk(r){const e=zo(r);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function uO(r,e,t){const n=zo(r);await zf(n,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",Jj)}async function dO(r,e,t){if(ui(r.app))return Promise.reject(Oo(r));const n=zo(r),o=await zf(n,{returnSecureToken:!0,email:e,password:t,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",oO).catch(d=>{throw d.code==="auth/password-does-not-meet-requirements"&&sk(r),d}),l=await iu._fromIdTokenResponse(n,"signIn",o);return await n._updateCurrentUser(l.user),l}function hO(r,e,t){return ui(r.app)?Promise.reject(Oo(r)):ik(jn(r),_u.credential(e,t)).catch(async n=>{throw n.code==="auth/password-does-not-meet-requirements"&&sk(r),n})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fO(r,e,t){const n=zo(r),i={requestType:"EMAIL_SIGNIN",email:e,clientType:"CLIENT_TYPE_WEB"};function s(o,l){at(l.handleCodeInApp,n,"argument-error"),l&&cO(n,o,l)}s(i,t),await zf(n,i,"getOobCode",eO)}function ok(r,e){const t=Ey.parseLink(e);return(t==null?void 0:t.operation)==="EMAIL_SIGNIN"}async function mO(r,e,t){if(ui(r.app))return Promise.reject(Oo(r));const n=jn(r),i=_u.credentialWithLink(e,t||kg());return at(i._tenantId===(n.tenantId||null),n,"tenant-id-mismatch"),ik(n,i)}function pO(r,e,t,n){return jn(r).onIdTokenChanged(e,t,n)}function gO(r,e,t){return jn(r).beforeAuthStateChanged(e,t)}function yO(r,e,t,n){return jn(r).onAuthStateChanged(e,t,n)}function vO(r){return jn(r).signOut()}const jg="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ak{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(jg,"1"),this.storage.removeItem(jg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _O=1e3,xO=10;class lk extends ak{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Z4(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),i=this.localCache[t];n!==i&&e(t,i,n)}}onStorageEvent(e,t=!1){if(!e.key){this.forAllChangedKeys((o,l,d)=>{this.notifyListeners(o,d)});return}const n=e.key;t?this.detachListener():this.stopPolling();const i=()=>{const o=this.storage.getItem(n);!t&&this.localCache[n]===o||this.notifyListeners(n,o)},s=this.storage.getItem(n);Rj()&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(i,xO):i()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t&&JSON.parse(t))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)})},_O)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}lk.type="LOCAL";const bO=lk;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ck extends ak{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,t){}_removeListener(e,t){}}ck.type="SESSION";const uk=ck;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wO(r){return Promise.all(r.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sy{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find(i=>i.isListeningto(e));if(t)return t;const n=new Sy(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:i,data:s}=t.data,o=this.handlersMap[i];if(!(o!=null&&o.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:i});const l=Array.from(o).map(async f=>f(t.origin,s)),d=await wO(l);t.ports[0].postMessage({status:"done",eventId:n,eventType:i,response:d})}_subscribe(e,t){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),(!t||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Sy.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function db(r="",e=10){let t="";for(let n=0;n<e;n++)t+=Math.floor(Math.random()*10);return r+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EO{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const i=typeof MessageChannel<"u"?new MessageChannel:null;if(!i)throw new Error("connection_unavailable");let s,o;return new Promise((l,d)=>{const f=db("",20);i.port1.start();const m=setTimeout(()=>{d(new Error("unsupported_event"))},n);o={messageChannel:i,onMessage(y){const g=y;if(g.data.eventId===f)switch(g.data.status){case"ack":clearTimeout(m),s=setTimeout(()=>{d(new Error("timeout"))},3e3);break;case"done":clearTimeout(s),l(g.data.response);break;default:clearTimeout(m),clearTimeout(s),d(new Error("invalid_response"));break}}},this.handlers.add(o),i.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:f,data:t},[i.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mo(){return window}function SO(r){Mo().location.href=r}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dk(){return typeof Mo().WorkerGlobalScope<"u"&&typeof Mo().importScripts=="function"}async function TO(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function AO(){var r;return((r=navigator==null?void 0:navigator.serviceWorker)===null||r===void 0?void 0:r.controller)||null}function NO(){return dk()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hk="firebaseLocalStorageDb",IO=1,Og="firebaseLocalStorage",fk="fbase_key";class gm{constructor(e){this.request=e}toPromise(){return new Promise((e,t)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{t(this.request.error)})})}}function Ty(r,e){return r.transaction([Og],e?"readwrite":"readonly").objectStore(Og)}function kO(){const r=indexedDB.deleteDatabase(hk);return new gm(r).toPromise()}function nx(){const r=indexedDB.open(hk,IO);return new Promise((e,t)=>{r.addEventListener("error",()=>{t(r.error)}),r.addEventListener("upgradeneeded",()=>{const n=r.result;try{n.createObjectStore(Og,{keyPath:fk})}catch(i){t(i)}}),r.addEventListener("success",async()=>{const n=r.result;n.objectStoreNames.contains(Og)?e(n):(n.close(),await kO(),e(await nx()))})})}async function dS(r,e,t){const n=Ty(r,!0).put({[fk]:e,value:t});return new gm(n).toPromise()}async function PO(r,e){const t=Ty(r,!1).get(e),n=await new gm(t).toPromise();return n===void 0?null:n.value}function hS(r,e){const t=Ty(r,!0).delete(e);return new gm(t).toPromise()}const CO=800,RO=3;class mk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await nx(),this.db)}async _withRetries(e){let t=0;for(;;)try{const n=await this._openDb();return await e(n)}catch(n){if(t++>RO)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return dk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Sy._getInstance(NO()),this.receiver._subscribe("keyChanged",async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)})),this.receiver._subscribe("ping",async(e,t)=>["keyChanged"])}async initializeSender(){var e,t;if(this.activeServiceWorker=await TO(),!this.activeServiceWorker)return;this.sender=new EO(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&!((e=n[0])===null||e===void 0)&&e.fulfilled&&!((t=n[0])===null||t===void 0)&&t.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||AO()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await nx();return await dS(e,jg,"1"),await hS(e,jg),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite(async()=>(await this._withRetries(n=>dS(n,e,t)),this.localCache[e]=t,this.notifyServiceWorker(e)))}async _get(e){const t=await this._withRetries(n=>PO(n,e));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(t=>hS(t,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(i=>{const s=Ty(i,!1).getAll();return new gm(s).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const t=[],n=new Set;if(e.length!==0)for(const{fbase_key:i,value:s}of e)n.add(i),JSON.stringify(this.localCache[i])!==JSON.stringify(s)&&(this.notifyListeners(i,s),t.push(i));for(const i of Object.keys(this.localCache))this.localCache[i]&&!n.has(i)&&(this.notifyListeners(i,null),t.push(i));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const i of Array.from(n))i(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),CO)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}mk.type="LOCAL";const jO=mk;new fm(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pk(r,e){return e?ba(e):(at(r._popupRedirectResolver,r,"argument-error"),r._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hb extends cb{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return _d(e,this._buildIdpRequest())}_linkToIdToken(e,t){return _d(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return _d(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function OO(r){return rk(r.auth,new hb(r),r.bypassAuthState)}function MO(r){const{auth:e,user:t}=r;return at(t,e,"internal-error"),lO(t,new hb(r),r.bypassAuthState)}async function DO(r){const{auth:e,user:t}=r;return at(t,e,"internal-error"),aO(t,new hb(r),r.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gk{constructor(e,t,n,i,s=!1){this.auth=e,this.resolver=n,this.user=i,this.bypassAuthState=s,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise(async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}})}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:i,tenantId:s,error:o,type:l}=e;if(o){this.reject(o);return}const d={auth:this.auth,requestUri:t,sessionId:n,tenantId:s||void 0,postBody:i||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(d))}catch(f){this.reject(f)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return OO;case"linkViaPopup":case"linkViaRedirect":return DO;case"reauthViaPopup":case"reauthViaRedirect":return MO;default:Is(this.auth,"internal-error")}}resolve(e){Na(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Na(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LO=new fm(2e3,1e4);async function FO(r,e,t){if(ui(r.app))return Promise.reject(ao(r,"operation-not-supported-in-this-environment"));const n=zo(r);hj(r,e,ub);const i=pk(n,t);return new Kc(n,"signInViaPopup",e,i).executeNotNull()}class Kc extends gk{constructor(e,t,n,i,s){super(e,t,i,s),this.provider=n,this.authWindow=null,this.pollId=null,Kc.currentPopupAction&&Kc.currentPopupAction.cancel(),Kc.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return at(e,this.auth,"internal-error"),e}async onExecution(){Na(this.filter.length===1,"Popup operations only handle one event");const e=db();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(t=>{this.reject(t)}),this.resolver._isIframeWebStorageSupported(this.auth,t=>{t||this.reject(ao(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(ao(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Kc.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;if(!((n=(t=this.authWindow)===null||t===void 0?void 0:t.window)===null||n===void 0)&&n.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(ao(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,LO.get())};e()}}Kc.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VO="pendingRedirect",og=new Map;class zO extends gk{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=og.get(this.auth._key());if(!e){try{const n=await BO(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}og.set(this.auth._key(),e)}return this.bypassAuthState||og.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function BO(r,e){const t=HO(e),n=qO(r);if(!await n._isAvailable())return!1;const i=await n._get(t)==="true";return await n._remove(t),i}function UO(r,e){og.set(r._key(),e)}function qO(r){return ba(r._redirectPersistence)}function HO(r){return sg(VO,r.config.apiKey,r.name)}async function $O(r,e,t=!1){if(ui(r.app))return Promise.reject(Oo(r));const n=zo(r),i=pk(n,e),o=await new zO(n,i,t).execute();return o&&!t&&(delete o.user._redirectEventId,await n._persistUserIfCurrent(o.user),await n._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WO=10*60*1e3;class GO{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach(n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!KO(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!yk(e)){const i=((n=e.error.code)===null||n===void 0?void 0:n.split("auth/")[1])||"internal-error";t.onError(ao(this.auth,i))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=t.eventId===null||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=WO&&this.cachedEventUids.clear(),this.cachedEventUids.has(fS(e))}saveEventToCache(e){this.cachedEventUids.add(fS(e)),this.lastProcessedEventTime=Date.now()}}function fS(r){return[r.type,r.eventId,r.sessionId,r.tenantId].filter(e=>e).join("-")}function yk({type:r,error:e}){return r==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function KO(r){switch(r.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return yk(r);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YO(r,e={}){return ja(r,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZO=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,QO=/^https?/;async function XO(r){if(r.config.emulator)return;const{authorizedDomains:e}=await YO(r);for(const t of e)try{if(JO(t))return}catch{}Is(r,"unauthorized-domain")}function JO(r){const e=kg(),{protocol:t,hostname:n}=new URL(e);if(r.startsWith("chrome-extension://")){const o=new URL(r);return o.hostname===""&&n===""?t==="chrome-extension:"&&r.replace("chrome-extension://","")===e.replace("chrome-extension://",""):t==="chrome-extension:"&&o.hostname===n}if(!QO.test(t))return!1;if(ZO.test(r))return n===r;const i=r.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(n)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eM=new fm(3e4,6e4);function mS(){const r=Mo().___jsl;if(r!=null&&r.H){for(const e of Object.keys(r.H))if(r.H[e].r=r.H[e].r||[],r.H[e].L=r.H[e].L||[],r.H[e].r=[...r.H[e].L],r.CP)for(let t=0;t<r.CP.length;t++)r.CP[t]=null}}function tM(r){return new Promise((e,t)=>{var n,i,s;function o(){mS(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{mS(),t(ao(r,"network-request-failed"))},timeout:eM.get()})}if(!((i=(n=Mo().gapi)===null||n===void 0?void 0:n.iframes)===null||i===void 0)&&i.Iframe)e(gapi.iframes.getContext());else if(!((s=Mo().gapi)===null||s===void 0)&&s.load)o();else{const l=Bj("iframefcb");return Mo()[l]=()=>{gapi.load?o():t(ao(r,"network-request-failed"))},X4(`${zj()}?onload=${l}`).catch(d=>t(d))}}).catch(e=>{throw ag=null,e})}let ag=null;function nM(r){return ag=ag||tM(r),ag}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rM=new fm(5e3,15e3),iM="__/auth/iframe",sM="emulator/auth/iframe",oM={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},aM=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function lM(r){const e=r.config;at(e.authDomain,r,"auth-domain-config-required");const t=e.emulator?ob(e,sM):`https://${r.config.authDomain}/${iM}`,n={apiKey:e.apiKey,appName:r.name,v:Wd},i=aM.get(r.config.apiHost);i&&(n.eid=i);const s=r._getFrameworks();return s.length&&(n.fw=s.join(",")),`${t}?${hm(n).slice(1)}`}async function cM(r){const e=await nM(r),t=Mo().gapi;return at(t,r,"internal-error"),e.open({where:document.body,url:lM(r),messageHandlersFilter:t.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:oM,dontclear:!0},n=>new Promise(async(i,s)=>{await n.restyle({setHideOnLeave:!1});const o=ao(r,"network-request-failed"),l=Mo().setTimeout(()=>{s(o)},rM.get());function d(){Mo().clearTimeout(l),i(n)}n.ping(d).then(d,()=>{s(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uM={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},dM=500,hM=600,fM="_blank",mM="http://localhost";class pS{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function pM(r,e,t,n=dM,i=hM){const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-n)/2,0).toString();let l="";const d=Object.assign(Object.assign({},uM),{width:n.toString(),height:i.toString(),top:s,left:o}),f=pr().toLowerCase();t&&(l=$4(f)?fM:t),q4(f)&&(e=e||mM,d.scrollbars="yes");const m=Object.entries(d).reduce((g,[_,E])=>`${g}${_}=${E},`,"");if(Cj(f)&&l!=="_self")return gM(e||"",l),new pS(null);const y=window.open(e||"",l,m);at(y,r,"popup-blocked");try{y.focus()}catch{}return new pS(y)}function gM(r,e){const t=document.createElement("a");t.href=r,t.target=e;const n=document.createEvent("MouseEvent");n.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),t.dispatchEvent(n)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yM="__/auth/handler",vM="emulator/auth/handler",_M=encodeURIComponent("fac");async function gS(r,e,t,n,i,s){at(r.config.authDomain,r,"auth-domain-config-required"),at(r.config.apiKey,r,"invalid-api-key");const o={apiKey:r.config.apiKey,appName:r.name,authType:t,redirectUrl:n,v:Wd,eventId:i};if(e instanceof ub){e.setDefaultLanguage(r.languageCode),o.providerId=e.providerId||"",Q5(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[m,y]of Object.entries({}))o[m]=y}if(e instanceof pm){const m=e.getScopes().filter(y=>y!=="");m.length>0&&(o.scopes=m.join(","))}r.tenantId&&(o.tid=r.tenantId);const l=o;for(const m of Object.keys(l))l[m]===void 0&&delete l[m];const d=await r._getAppCheckToken(),f=d?`#${_M}=${encodeURIComponent(d)}`:"";return`${xM(r)}?${hm(l).slice(1)}${f}`}function xM({config:r}){return r.emulator?ob(r,vM):`https://${r.authDomain}/${yM}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lv="webStorageSupport";class bM{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=uk,this._completeRedirectFn=$O,this._overrideRedirectResult=UO}async _openPopup(e,t,n,i){var s;Na((s=this.eventManagers[e._key()])===null||s===void 0?void 0:s.manager,"_initialize() not called before _openPopup()");const o=await gS(e,t,n,kg(),i);return pM(e,o,db())}async _openRedirect(e,t,n,i){await this._originValidation(e);const s=await gS(e,t,n,kg(),i);return SO(s),new Promise(()=>{})}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:i,promise:s}=this.eventManagers[t];return i?Promise.resolve(i):(Na(s,"If manager is not set, promise should be"),s)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch(()=>{delete this.eventManagers[t]}),n}async initAndGetManager(e){const t=await cM(e),n=new GO(e);return t.register("authEvent",i=>(at(i==null?void 0:i.authEvent,e,"invalid-auth-event"),{status:n.onEvent(i.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Lv,{type:Lv},i=>{var s;const o=(s=i==null?void 0:i[0])===null||s===void 0?void 0:s[Lv];o!==void 0&&t(!!o),Is(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=XO(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return Z4()||H4()||lb()}}const wM=bM;var yS="@firebase/auth",vS="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class EM{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged(n=>{e((n==null?void 0:n.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){at(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SM(r){switch(r){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function TM(r){nu(new Yl("auth",(e,{options:t})=>{const n=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=n.options;at(o&&!o.includes(":"),"invalid-api-key",{appName:n.name});const d={apiKey:o,authDomain:l,clientPlatform:r,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Q4(r)},f=new Lj(n,i,s,d);return Gj(f,t),f},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,t,n)=>{e.getProvider("auth-internal").initialize()})),nu(new Yl("auth-internal",e=>{const t=zo(e.getProvider("auth").getImmediate());return(n=>new EM(n))(t)},"PRIVATE").setInstantiationMode("EXPLICIT")),jo(yS,vS,SM(r)),jo(yS,vS,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AM=5*60,NM=A4("authIdTokenMaxAge")||AM;let _S=null;const IM=r=>async e=>{const t=e&&await e.getIdTokenResult(),n=t&&(new Date().getTime()-Date.parse(t.issuedAtTime))/1e3;if(n&&n>NM)return;const i=t==null?void 0:t.token;_S!==i&&(_S=i,await fetch(r,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function fb(r=by()){const e=xy(r,"auth");if(e.isInitialized())return e.getImmediate();const t=Wj(r,{popupRedirectResolver:wM,persistence:[jO,bO,uk]}),n=A4("authTokenSyncURL");if(n&&typeof isSecureContext=="boolean"&&isSecureContext){const s=new URL(n,location.origin);if(location.origin===s.origin){const o=IM(s.toString());gO(t,o,()=>o(t.currentUser)),pO(t,l=>o(l))}}const i=E4("auth");return i&&Kj(t,`http://${i}`),t}function kM(){var r,e;return(e=(r=document.getElementsByTagName("head"))===null||r===void 0?void 0:r[0])!==null&&e!==void 0?e:document}Fj({loadJS(r){return new Promise((e,t)=>{const n=document.createElement("script");n.setAttribute("src",r),n.onload=e,n.onerror=i=>{const s=ao("internal-error");s.customData=i,t(s)},n.type="text/javascript",n.charset="UTF-8",kM().appendChild(n)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});TM("Browser");var xS=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Hl,vk;(function(){var r;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(C,k){function D(){}D.prototype=k.prototype,C.D=k.prototype,C.prototype=new D,C.prototype.constructor=C,C.C=function(O,P,F){for(var M=Array(arguments.length-2),$=2;$<arguments.length;$++)M[$-2]=arguments[$];return k.prototype[P].apply(O,M)}}function t(){this.blockSize=-1}function n(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(n,t),n.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function i(C,k,D){D||(D=0);var O=Array(16);if(typeof k=="string")for(var P=0;16>P;++P)O[P]=k.charCodeAt(D++)|k.charCodeAt(D++)<<8|k.charCodeAt(D++)<<16|k.charCodeAt(D++)<<24;else for(P=0;16>P;++P)O[P]=k[D++]|k[D++]<<8|k[D++]<<16|k[D++]<<24;k=C.g[0],D=C.g[1],P=C.g[2];var F=C.g[3],M=k+(F^D&(P^F))+O[0]+3614090360&4294967295;k=D+(M<<7&4294967295|M>>>25),M=F+(P^k&(D^P))+O[1]+3905402710&4294967295,F=k+(M<<12&4294967295|M>>>20),M=P+(D^F&(k^D))+O[2]+606105819&4294967295,P=F+(M<<17&4294967295|M>>>15),M=D+(k^P&(F^k))+O[3]+3250441966&4294967295,D=P+(M<<22&4294967295|M>>>10),M=k+(F^D&(P^F))+O[4]+4118548399&4294967295,k=D+(M<<7&4294967295|M>>>25),M=F+(P^k&(D^P))+O[5]+1200080426&4294967295,F=k+(M<<12&4294967295|M>>>20),M=P+(D^F&(k^D))+O[6]+2821735955&4294967295,P=F+(M<<17&4294967295|M>>>15),M=D+(k^P&(F^k))+O[7]+4249261313&4294967295,D=P+(M<<22&4294967295|M>>>10),M=k+(F^D&(P^F))+O[8]+1770035416&4294967295,k=D+(M<<7&4294967295|M>>>25),M=F+(P^k&(D^P))+O[9]+2336552879&4294967295,F=k+(M<<12&4294967295|M>>>20),M=P+(D^F&(k^D))+O[10]+4294925233&4294967295,P=F+(M<<17&4294967295|M>>>15),M=D+(k^P&(F^k))+O[11]+2304563134&4294967295,D=P+(M<<22&4294967295|M>>>10),M=k+(F^D&(P^F))+O[12]+1804603682&4294967295,k=D+(M<<7&4294967295|M>>>25),M=F+(P^k&(D^P))+O[13]+4254626195&4294967295,F=k+(M<<12&4294967295|M>>>20),M=P+(D^F&(k^D))+O[14]+2792965006&4294967295,P=F+(M<<17&4294967295|M>>>15),M=D+(k^P&(F^k))+O[15]+1236535329&4294967295,D=P+(M<<22&4294967295|M>>>10),M=k+(P^F&(D^P))+O[1]+4129170786&4294967295,k=D+(M<<5&4294967295|M>>>27),M=F+(D^P&(k^D))+O[6]+3225465664&4294967295,F=k+(M<<9&4294967295|M>>>23),M=P+(k^D&(F^k))+O[11]+643717713&4294967295,P=F+(M<<14&4294967295|M>>>18),M=D+(F^k&(P^F))+O[0]+3921069994&4294967295,D=P+(M<<20&4294967295|M>>>12),M=k+(P^F&(D^P))+O[5]+3593408605&4294967295,k=D+(M<<5&4294967295|M>>>27),M=F+(D^P&(k^D))+O[10]+38016083&4294967295,F=k+(M<<9&4294967295|M>>>23),M=P+(k^D&(F^k))+O[15]+3634488961&4294967295,P=F+(M<<14&4294967295|M>>>18),M=D+(F^k&(P^F))+O[4]+3889429448&4294967295,D=P+(M<<20&4294967295|M>>>12),M=k+(P^F&(D^P))+O[9]+568446438&4294967295,k=D+(M<<5&4294967295|M>>>27),M=F+(D^P&(k^D))+O[14]+3275163606&4294967295,F=k+(M<<9&4294967295|M>>>23),M=P+(k^D&(F^k))+O[3]+4107603335&4294967295,P=F+(M<<14&4294967295|M>>>18),M=D+(F^k&(P^F))+O[8]+1163531501&4294967295,D=P+(M<<20&4294967295|M>>>12),M=k+(P^F&(D^P))+O[13]+2850285829&4294967295,k=D+(M<<5&4294967295|M>>>27),M=F+(D^P&(k^D))+O[2]+4243563512&4294967295,F=k+(M<<9&4294967295|M>>>23),M=P+(k^D&(F^k))+O[7]+1735328473&4294967295,P=F+(M<<14&4294967295|M>>>18),M=D+(F^k&(P^F))+O[12]+2368359562&4294967295,D=P+(M<<20&4294967295|M>>>12),M=k+(D^P^F)+O[5]+4294588738&4294967295,k=D+(M<<4&4294967295|M>>>28),M=F+(k^D^P)+O[8]+2272392833&4294967295,F=k+(M<<11&4294967295|M>>>21),M=P+(F^k^D)+O[11]+1839030562&4294967295,P=F+(M<<16&4294967295|M>>>16),M=D+(P^F^k)+O[14]+4259657740&4294967295,D=P+(M<<23&4294967295|M>>>9),M=k+(D^P^F)+O[1]+2763975236&4294967295,k=D+(M<<4&4294967295|M>>>28),M=F+(k^D^P)+O[4]+1272893353&4294967295,F=k+(M<<11&4294967295|M>>>21),M=P+(F^k^D)+O[7]+4139469664&4294967295,P=F+(M<<16&4294967295|M>>>16),M=D+(P^F^k)+O[10]+3200236656&4294967295,D=P+(M<<23&4294967295|M>>>9),M=k+(D^P^F)+O[13]+681279174&4294967295,k=D+(M<<4&4294967295|M>>>28),M=F+(k^D^P)+O[0]+3936430074&4294967295,F=k+(M<<11&4294967295|M>>>21),M=P+(F^k^D)+O[3]+3572445317&4294967295,P=F+(M<<16&4294967295|M>>>16),M=D+(P^F^k)+O[6]+76029189&4294967295,D=P+(M<<23&4294967295|M>>>9),M=k+(D^P^F)+O[9]+3654602809&4294967295,k=D+(M<<4&4294967295|M>>>28),M=F+(k^D^P)+O[12]+3873151461&4294967295,F=k+(M<<11&4294967295|M>>>21),M=P+(F^k^D)+O[15]+530742520&4294967295,P=F+(M<<16&4294967295|M>>>16),M=D+(P^F^k)+O[2]+3299628645&4294967295,D=P+(M<<23&4294967295|M>>>9),M=k+(P^(D|~F))+O[0]+4096336452&4294967295,k=D+(M<<6&4294967295|M>>>26),M=F+(D^(k|~P))+O[7]+1126891415&4294967295,F=k+(M<<10&4294967295|M>>>22),M=P+(k^(F|~D))+O[14]+2878612391&4294967295,P=F+(M<<15&4294967295|M>>>17),M=D+(F^(P|~k))+O[5]+4237533241&4294967295,D=P+(M<<21&4294967295|M>>>11),M=k+(P^(D|~F))+O[12]+1700485571&4294967295,k=D+(M<<6&4294967295|M>>>26),M=F+(D^(k|~P))+O[3]+2399980690&4294967295,F=k+(M<<10&4294967295|M>>>22),M=P+(k^(F|~D))+O[10]+4293915773&4294967295,P=F+(M<<15&4294967295|M>>>17),M=D+(F^(P|~k))+O[1]+2240044497&4294967295,D=P+(M<<21&4294967295|M>>>11),M=k+(P^(D|~F))+O[8]+1873313359&4294967295,k=D+(M<<6&4294967295|M>>>26),M=F+(D^(k|~P))+O[15]+4264355552&4294967295,F=k+(M<<10&4294967295|M>>>22),M=P+(k^(F|~D))+O[6]+2734768916&4294967295,P=F+(M<<15&4294967295|M>>>17),M=D+(F^(P|~k))+O[13]+1309151649&4294967295,D=P+(M<<21&4294967295|M>>>11),M=k+(P^(D|~F))+O[4]+4149444226&4294967295,k=D+(M<<6&4294967295|M>>>26),M=F+(D^(k|~P))+O[11]+3174756917&4294967295,F=k+(M<<10&4294967295|M>>>22),M=P+(k^(F|~D))+O[2]+718787259&4294967295,P=F+(M<<15&4294967295|M>>>17),M=D+(F^(P|~k))+O[9]+3951481745&4294967295,C.g[0]=C.g[0]+k&4294967295,C.g[1]=C.g[1]+(P+(M<<21&4294967295|M>>>11))&4294967295,C.g[2]=C.g[2]+P&4294967295,C.g[3]=C.g[3]+F&4294967295}n.prototype.u=function(C,k){k===void 0&&(k=C.length);for(var D=k-this.blockSize,O=this.B,P=this.h,F=0;F<k;){if(P==0)for(;F<=D;)i(this,C,F),F+=this.blockSize;if(typeof C=="string"){for(;F<k;)if(O[P++]=C.charCodeAt(F++),P==this.blockSize){i(this,O),P=0;break}}else for(;F<k;)if(O[P++]=C[F++],P==this.blockSize){i(this,O),P=0;break}}this.h=P,this.o+=k},n.prototype.v=function(){var C=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);C[0]=128;for(var k=1;k<C.length-8;++k)C[k]=0;var D=8*this.o;for(k=C.length-8;k<C.length;++k)C[k]=D&255,D/=256;for(this.u(C),C=Array(16),k=D=0;4>k;++k)for(var O=0;32>O;O+=8)C[D++]=this.g[k]>>>O&255;return C};function s(C,k){var D=l;return Object.prototype.hasOwnProperty.call(D,C)?D[C]:D[C]=k(C)}function o(C,k){this.h=k;for(var D=[],O=!0,P=C.length-1;0<=P;P--){var F=C[P]|0;O&&F==k||(D[P]=F,O=!1)}this.g=D}var l={};function d(C){return-128<=C&&128>C?s(C,function(k){return new o([k|0],0>k?-1:0)}):new o([C|0],0>C?-1:0)}function f(C){if(isNaN(C)||!isFinite(C))return y;if(0>C)return b(f(-C));for(var k=[],D=1,O=0;C>=D;O++)k[O]=C/D|0,D*=4294967296;return new o(k,0)}function m(C,k){if(C.length==0)throw Error("number format error: empty string");if(k=k||10,2>k||36<k)throw Error("radix out of range: "+k);if(C.charAt(0)=="-")return b(m(C.substring(1),k));if(0<=C.indexOf("-"))throw Error('number format error: interior "-" character');for(var D=f(Math.pow(k,8)),O=y,P=0;P<C.length;P+=8){var F=Math.min(8,C.length-P),M=parseInt(C.substring(P,P+F),k);8>F?(F=f(Math.pow(k,F)),O=O.j(F).add(f(M))):(O=O.j(D),O=O.add(f(M)))}return O}var y=d(0),g=d(1),_=d(16777216);r=o.prototype,r.m=function(){if(x(this))return-b(this).m();for(var C=0,k=1,D=0;D<this.g.length;D++){var O=this.i(D);C+=(0<=O?O:4294967296+O)*k,k*=4294967296}return C},r.toString=function(C){if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(E(this))return"0";if(x(this))return"-"+b(this).toString(C);for(var k=f(Math.pow(C,6)),D=this,O="";;){var P=I(D,k).g;D=T(D,P.j(k));var F=((0<D.g.length?D.g[0]:D.h)>>>0).toString(C);if(D=P,E(D))return F+O;for(;6>F.length;)F="0"+F;O=F+O}},r.i=function(C){return 0>C?0:C<this.g.length?this.g[C]:this.h};function E(C){if(C.h!=0)return!1;for(var k=0;k<C.g.length;k++)if(C.g[k]!=0)return!1;return!0}function x(C){return C.h==-1}r.l=function(C){return C=T(this,C),x(C)?-1:E(C)?0:1};function b(C){for(var k=C.g.length,D=[],O=0;O<k;O++)D[O]=~C.g[O];return new o(D,~C.h).add(g)}r.abs=function(){return x(this)?b(this):this},r.add=function(C){for(var k=Math.max(this.g.length,C.g.length),D=[],O=0,P=0;P<=k;P++){var F=O+(this.i(P)&65535)+(C.i(P)&65535),M=(F>>>16)+(this.i(P)>>>16)+(C.i(P)>>>16);O=M>>>16,F&=65535,M&=65535,D[P]=M<<16|F}return new o(D,D[D.length-1]&-2147483648?-1:0)};function T(C,k){return C.add(b(k))}r.j=function(C){if(E(this)||E(C))return y;if(x(this))return x(C)?b(this).j(b(C)):b(b(this).j(C));if(x(C))return b(this.j(b(C)));if(0>this.l(_)&&0>C.l(_))return f(this.m()*C.m());for(var k=this.g.length+C.g.length,D=[],O=0;O<2*k;O++)D[O]=0;for(O=0;O<this.g.length;O++)for(var P=0;P<C.g.length;P++){var F=this.i(O)>>>16,M=this.i(O)&65535,$=C.i(P)>>>16,Y=C.i(P)&65535;D[2*O+2*P]+=M*Y,N(D,2*O+2*P),D[2*O+2*P+1]+=F*Y,N(D,2*O+2*P+1),D[2*O+2*P+1]+=M*$,N(D,2*O+2*P+1),D[2*O+2*P+2]+=F*$,N(D,2*O+2*P+2)}for(O=0;O<k;O++)D[O]=D[2*O+1]<<16|D[2*O];for(O=k;O<2*k;O++)D[O]=0;return new o(D,0)};function N(C,k){for(;(C[k]&65535)!=C[k];)C[k+1]+=C[k]>>>16,C[k]&=65535,k++}function R(C,k){this.g=C,this.h=k}function I(C,k){if(E(k))throw Error("division by zero");if(E(C))return new R(y,y);if(x(C))return k=I(b(C),k),new R(b(k.g),b(k.h));if(x(k))return k=I(C,b(k)),new R(b(k.g),k.h);if(30<C.g.length){if(x(C)||x(k))throw Error("slowDivide_ only works with positive integers.");for(var D=g,O=k;0>=O.l(C);)D=j(D),O=j(O);var P=U(D,1),F=U(O,1);for(O=U(O,2),D=U(D,2);!E(O);){var M=F.add(O);0>=M.l(C)&&(P=P.add(D),F=M),O=U(O,1),D=U(D,1)}return k=T(C,P.j(k)),new R(P,k)}for(P=y;0<=C.l(k);){for(D=Math.max(1,Math.floor(C.m()/k.m())),O=Math.ceil(Math.log(D)/Math.LN2),O=48>=O?1:Math.pow(2,O-48),F=f(D),M=F.j(k);x(M)||0<M.l(C);)D-=O,F=f(D),M=F.j(k);E(F)&&(F=g),P=P.add(F),C=T(C,M)}return new R(P,C)}r.A=function(C){return I(this,C).h},r.and=function(C){for(var k=Math.max(this.g.length,C.g.length),D=[],O=0;O<k;O++)D[O]=this.i(O)&C.i(O);return new o(D,this.h&C.h)},r.or=function(C){for(var k=Math.max(this.g.length,C.g.length),D=[],O=0;O<k;O++)D[O]=this.i(O)|C.i(O);return new o(D,this.h|C.h)},r.xor=function(C){for(var k=Math.max(this.g.length,C.g.length),D=[],O=0;O<k;O++)D[O]=this.i(O)^C.i(O);return new o(D,this.h^C.h)};function j(C){for(var k=C.g.length+1,D=[],O=0;O<k;O++)D[O]=C.i(O)<<1|C.i(O-1)>>>31;return new o(D,C.h)}function U(C,k){var D=k>>5;k%=32;for(var O=C.g.length-D,P=[],F=0;F<O;F++)P[F]=0<k?C.i(F+D)>>>k|C.i(F+D+1)<<32-k:C.i(F+D);return new o(P,C.h)}n.prototype.digest=n.prototype.v,n.prototype.reset=n.prototype.s,n.prototype.update=n.prototype.u,vk=n,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=f,o.fromString=m,Hl=o}).apply(typeof xS<"u"?xS:typeof self<"u"?self:typeof window<"u"?window:{});var Pp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var _k,cf,xk,lg,rx,bk,wk,Ek;(function(){var r,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(w,q,Z){return w==Array.prototype||w==Object.prototype||(w[q]=Z.value),w};function t(w){w=[typeof globalThis=="object"&&globalThis,w,typeof window=="object"&&window,typeof self=="object"&&self,typeof Pp=="object"&&Pp];for(var q=0;q<w.length;++q){var Z=w[q];if(Z&&Z.Math==Math)return Z}throw Error("Cannot find global object")}var n=t(this);function i(w,q){if(q)e:{var Z=n;w=w.split(".");for(var ae=0;ae<w.length-1;ae++){var ye=w[ae];if(!(ye in Z))break e;Z=Z[ye]}w=w[w.length-1],ae=Z[w],q=q(ae),q!=ae&&q!=null&&e(Z,w,{configurable:!0,writable:!0,value:q})}}function s(w,q){w instanceof String&&(w+="");var Z=0,ae=!1,ye={next:function(){if(!ae&&Z<w.length){var Te=Z++;return{value:q(Te,w[Te]),done:!1}}return ae=!0,{done:!0,value:void 0}}};return ye[Symbol.iterator]=function(){return ye},ye}i("Array.prototype.values",function(w){return w||function(){return s(this,function(q,Z){return Z})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function d(w){var q=typeof w;return q=q!="object"?q:w?Array.isArray(w)?"array":q:"null",q=="array"||q=="object"&&typeof w.length=="number"}function f(w){var q=typeof w;return q=="object"&&w!=null||q=="function"}function m(w,q,Z){return w.call.apply(w.bind,arguments)}function y(w,q,Z){if(!w)throw Error();if(2<arguments.length){var ae=Array.prototype.slice.call(arguments,2);return function(){var ye=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ye,ae),w.apply(q,ye)}}return function(){return w.apply(q,arguments)}}function g(w,q,Z){return g=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?m:y,g.apply(null,arguments)}function _(w,q){var Z=Array.prototype.slice.call(arguments,1);return function(){var ae=Z.slice();return ae.push.apply(ae,arguments),w.apply(this,ae)}}function E(w,q){function Z(){}Z.prototype=q.prototype,w.aa=q.prototype,w.prototype=new Z,w.prototype.constructor=w,w.Qb=function(ae,ye,Te){for(var Be=Array(arguments.length-2),en=2;en<arguments.length;en++)Be[en-2]=arguments[en];return q.prototype[ye].apply(ae,Be)}}function x(w){const q=w.length;if(0<q){const Z=Array(q);for(let ae=0;ae<q;ae++)Z[ae]=w[ae];return Z}return[]}function b(w,q){for(let Z=1;Z<arguments.length;Z++){const ae=arguments[Z];if(d(ae)){const ye=w.length||0,Te=ae.length||0;w.length=ye+Te;for(let Be=0;Be<Te;Be++)w[ye+Be]=ae[Be]}else w.push(ae)}}class T{constructor(q,Z){this.i=q,this.j=Z,this.h=0,this.g=null}get(){let q;return 0<this.h?(this.h--,q=this.g,this.g=q.next,q.next=null):q=this.i(),q}}function N(w){return/^[\s\xa0]*$/.test(w)}function R(){var w=l.navigator;return w&&(w=w.userAgent)?w:""}function I(w){return I[" "](w),w}I[" "]=function(){};var j=R().indexOf("Gecko")!=-1&&!(R().toLowerCase().indexOf("webkit")!=-1&&R().indexOf("Edge")==-1)&&!(R().indexOf("Trident")!=-1||R().indexOf("MSIE")!=-1)&&R().indexOf("Edge")==-1;function U(w,q,Z){for(const ae in w)q.call(Z,w[ae],ae,w)}function C(w,q){for(const Z in w)q.call(void 0,w[Z],Z,w)}function k(w){const q={};for(const Z in w)q[Z]=w[Z];return q}const D="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function O(w,q){let Z,ae;for(let ye=1;ye<arguments.length;ye++){ae=arguments[ye];for(Z in ae)w[Z]=ae[Z];for(let Te=0;Te<D.length;Te++)Z=D[Te],Object.prototype.hasOwnProperty.call(ae,Z)&&(w[Z]=ae[Z])}}function P(w){var q=1;w=w.split(":");const Z=[];for(;0<q&&w.length;)Z.push(w.shift()),q--;return w.length&&Z.push(w.join(":")),Z}function F(w){l.setTimeout(()=>{throw w},0)}function M(){var w=ne;let q=null;return w.g&&(q=w.g,w.g=w.g.next,w.g||(w.h=null),q.next=null),q}class ${constructor(){this.h=this.g=null}add(q,Z){const ae=Y.get();ae.set(q,Z),this.h?this.h.next=ae:this.g=ae,this.h=ae}}var Y=new T(()=>new te,w=>w.reset());class te{constructor(){this.next=this.g=this.h=null}set(q,Z){this.h=q,this.g=Z,this.next=null}reset(){this.next=this.g=this.h=null}}let oe,ie=!1,ne=new $,K=()=>{const w=l.Promise.resolve(void 0);oe=()=>{w.then(B)}};var B=()=>{for(var w;w=M();){try{w.h.call(w.g)}catch(Z){F(Z)}var q=Y;q.j(w),100>q.h&&(q.h++,w.next=q.g,q.g=w)}ie=!1};function G(){this.s=this.s,this.C=this.C}G.prototype.s=!1,G.prototype.ma=function(){this.s||(this.s=!0,this.N())},G.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function X(w,q){this.type=w,this.g=this.target=q,this.defaultPrevented=!1}X.prototype.h=function(){this.defaultPrevented=!0};var se=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var w=!1,q=Object.defineProperty({},"passive",{get:function(){w=!0}});try{const Z=()=>{};l.addEventListener("test",Z,q),l.removeEventListener("test",Z,q)}catch{}return w}();function le(w,q){if(X.call(this,w?w.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,w){var Z=this.type=w.type,ae=w.changedTouches&&w.changedTouches.length?w.changedTouches[0]:null;if(this.target=w.target||w.srcElement,this.g=q,q=w.relatedTarget){if(j){e:{try{I(q.nodeName);var ye=!0;break e}catch{}ye=!1}ye||(q=null)}}else Z=="mouseover"?q=w.fromElement:Z=="mouseout"&&(q=w.toElement);this.relatedTarget=q,ae?(this.clientX=ae.clientX!==void 0?ae.clientX:ae.pageX,this.clientY=ae.clientY!==void 0?ae.clientY:ae.pageY,this.screenX=ae.screenX||0,this.screenY=ae.screenY||0):(this.clientX=w.clientX!==void 0?w.clientX:w.pageX,this.clientY=w.clientY!==void 0?w.clientY:w.pageY,this.screenX=w.screenX||0,this.screenY=w.screenY||0),this.button=w.button,this.key=w.key||"",this.ctrlKey=w.ctrlKey,this.altKey=w.altKey,this.shiftKey=w.shiftKey,this.metaKey=w.metaKey,this.pointerId=w.pointerId||0,this.pointerType=typeof w.pointerType=="string"?w.pointerType:Q[w.pointerType]||"",this.state=w.state,this.i=w,w.defaultPrevented&&le.aa.h.call(this)}}E(le,X);var Q={2:"touch",3:"pen",4:"mouse"};le.prototype.h=function(){le.aa.h.call(this);var w=this.i;w.preventDefault?w.preventDefault():w.returnValue=!1};var ce="closure_listenable_"+(1e6*Math.random()|0),ue=0;function fe(w,q,Z,ae,ye){this.listener=w,this.proxy=null,this.src=q,this.type=Z,this.capture=!!ae,this.ha=ye,this.key=++ue,this.da=this.fa=!1}function _e(w){w.da=!0,w.listener=null,w.proxy=null,w.src=null,w.ha=null}function Oe(w){this.src=w,this.g={},this.h=0}Oe.prototype.add=function(w,q,Z,ae,ye){var Te=w.toString();w=this.g[Te],w||(w=this.g[Te]=[],this.h++);var Be=tt(w,q,ae,ye);return-1<Be?(q=w[Be],Z||(q.fa=!1)):(q=new fe(q,this.src,Te,!!ae,ye),q.fa=Z,w.push(q)),q};function qe(w,q){var Z=q.type;if(Z in w.g){var ae=w.g[Z],ye=Array.prototype.indexOf.call(ae,q,void 0),Te;(Te=0<=ye)&&Array.prototype.splice.call(ae,ye,1),Te&&(_e(q),w.g[Z].length==0&&(delete w.g[Z],w.h--))}}function tt(w,q,Z,ae){for(var ye=0;ye<w.length;++ye){var Te=w[ye];if(!Te.da&&Te.listener==q&&Te.capture==!!Z&&Te.ha==ae)return ye}return-1}var yt="closure_lm_"+(1e6*Math.random()|0),At={};function xn(w,q,Z,ae,ye){if(Array.isArray(q)){for(var Te=0;Te<q.length;Te++)xn(w,q[Te],Z,ae,ye);return null}return Z=pt(Z),w&&w[ce]?w.K(q,Z,f(ae)?!!ae.capture:!1,ye):Yt(w,q,Z,!1,ae,ye)}function Yt(w,q,Z,ae,ye,Te){if(!q)throw Error("Invalid event type");var Be=f(ye)?!!ye.capture:!!ye,en=vt(w);if(en||(w[yt]=en=new Oe(w)),Z=en.add(q,Z,ae,Be,Te),Z.proxy)return Z;if(ae=Ae(),Z.proxy=ae,ae.src=w,ae.listener=Z,w.addEventListener)se||(ye=Be),ye===void 0&&(ye=!1),w.addEventListener(q.toString(),ae,ye);else if(w.attachEvent)w.attachEvent(ze(q.toString()),ae);else if(w.addListener&&w.removeListener)w.addListener(ae);else throw Error("addEventListener and attachEvent are unavailable.");return Z}function Ae(){function w(Z){return q.call(w.src,w.listener,Z)}const q=ke;return w}function Ne(w,q,Z,ae,ye){if(Array.isArray(q))for(var Te=0;Te<q.length;Te++)Ne(w,q[Te],Z,ae,ye);else ae=f(ae)?!!ae.capture:!!ae,Z=pt(Z),w&&w[ce]?(w=w.i,q=String(q).toString(),q in w.g&&(Te=w.g[q],Z=tt(Te,Z,ae,ye),-1<Z&&(_e(Te[Z]),Array.prototype.splice.call(Te,Z,1),Te.length==0&&(delete w.g[q],w.h--)))):w&&(w=vt(w))&&(q=w.g[q.toString()],w=-1,q&&(w=tt(q,Z,ae,ye)),(Z=-1<w?q[w]:null)&&Le(Z))}function Le(w){if(typeof w!="number"&&w&&!w.da){var q=w.src;if(q&&q[ce])qe(q.i,w);else{var Z=w.type,ae=w.proxy;q.removeEventListener?q.removeEventListener(Z,ae,w.capture):q.detachEvent?q.detachEvent(ze(Z),ae):q.addListener&&q.removeListener&&q.removeListener(ae),(Z=vt(q))?(qe(Z,w),Z.h==0&&(Z.src=null,q[yt]=null)):_e(w)}}}function ze(w){return w in At?At[w]:At[w]="on"+w}function ke(w,q){if(w.da)w=!0;else{q=new le(q,this);var Z=w.listener,ae=w.ha||w.src;w.fa&&Le(w),w=Z.call(ae,q)}return w}function vt(w){return w=w[yt],w instanceof Oe?w:null}var mt="__closure_events_fn_"+(1e9*Math.random()>>>0);function pt(w){return typeof w=="function"?w:(w[mt]||(w[mt]=function(q){return w.handleEvent(q)}),w[mt])}function kt(){G.call(this),this.i=new Oe(this),this.M=this,this.F=null}E(kt,G),kt.prototype[ce]=!0,kt.prototype.removeEventListener=function(w,q,Z,ae){Ne(this,w,q,Z,ae)};function Ot(w,q){var Z,ae=w.F;if(ae)for(Z=[];ae;ae=ae.F)Z.push(ae);if(w=w.M,ae=q.type||q,typeof q=="string")q=new X(q,w);else if(q instanceof X)q.target=q.target||w;else{var ye=q;q=new X(ae,w),O(q,ye)}if(ye=!0,Z)for(var Te=Z.length-1;0<=Te;Te--){var Be=q.g=Z[Te];ye=Mt(Be,ae,!0,q)&&ye}if(Be=q.g=w,ye=Mt(Be,ae,!0,q)&&ye,ye=Mt(Be,ae,!1,q)&&ye,Z)for(Te=0;Te<Z.length;Te++)Be=q.g=Z[Te],ye=Mt(Be,ae,!1,q)&&ye}kt.prototype.N=function(){if(kt.aa.N.call(this),this.i){var w=this.i,q;for(q in w.g){for(var Z=w.g[q],ae=0;ae<Z.length;ae++)_e(Z[ae]);delete w.g[q],w.h--}}this.F=null},kt.prototype.K=function(w,q,Z,ae){return this.i.add(String(w),q,!1,Z,ae)},kt.prototype.L=function(w,q,Z,ae){return this.i.add(String(w),q,!0,Z,ae)};function Mt(w,q,Z,ae){if(q=w.i.g[String(q)],!q)return!0;q=q.concat();for(var ye=!0,Te=0;Te<q.length;++Te){var Be=q[Te];if(Be&&!Be.da&&Be.capture==Z){var en=Be.listener,Un=Be.ha||Be.src;Be.fa&&qe(w.i,Be),ye=en.call(Un,ae)!==!1&&ye}}return ye&&!ae.defaultPrevented}function ls(w,q,Z){if(typeof w=="function")Z&&(w=g(w,Z));else if(w&&typeof w.handleEvent=="function")w=g(w.handleEvent,w);else throw Error("Invalid listener argument");return 2147483647<Number(q)?-1:l.setTimeout(w,q||0)}function Ht(w){w.g=ls(()=>{w.g=null,w.i&&(w.i=!1,Ht(w))},w.l);const q=w.h;w.h=null,w.m.apply(null,q)}class Mn extends G{constructor(q,Z){super(),this.m=q,this.l=Z,this.h=null,this.i=!1,this.g=null}j(q){this.h=arguments,this.g?this.i=!0:Ht(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function cs(w){G.call(this),this.h=w,this.g={}}E(cs,G);var Ui=[];function yi(w){U(w.g,function(q,Z){this.g.hasOwnProperty(Z)&&Le(q)},w),w.g={}}cs.prototype.N=function(){cs.aa.N.call(this),yi(this)},cs.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var yr=l.JSON.stringify,vi=l.JSON.parse,ti=class{stringify(w){return l.JSON.stringify(w,void 0)}parse(w){return l.JSON.parse(w,void 0)}};function qi(){}qi.prototype.h=null;function ho(w){return w.h||(w.h=w.i())}function _i(){}var Jn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ni(){X.call(this,"d")}E(ni,X);function xi(){X.call(this,"c")}E(xi,X);var bi={},Bo=null;function yn(){return Bo=Bo||new kt}bi.La="serverreachability";function wi(w){X.call(this,bi.La,w)}E(wi,X);function Hi(w){const q=yn();Ot(q,new wi(q))}bi.STAT_EVENT="statevent";function us(w,q){X.call(this,bi.STAT_EVENT,w),this.stat=q}E(us,X);function bn(w){const q=yn();Ot(q,new us(q,w))}bi.Ma="timingevent";function Fs(w,q){X.call(this,bi.Ma,w),this.size=q}E(Fs,X);function Lr(w,q){if(typeof w!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){w()},q)}function Vs(){this.g=!0}Vs.prototype.xa=function(){this.g=!1};function ln(w,q,Z,ae,ye,Te){w.info(function(){if(w.g)if(Te)for(var Be="",en=Te.split("&"),Un=0;Un<en.length;Un++){var Bt=en[Un].split("=");if(1<Bt.length){var nn=Bt[0];Bt=Bt[1];var En=nn.split("_");Be=2<=En.length&&En[1]=="type"?Be+(nn+"="+Bt+"&"):Be+(nn+"=redacted&")}}else Be=null;else Be=Te;return"XMLHTTP REQ ("+ae+") [attempt "+ye+"]: "+q+`
`+Z+`
`+Be})}function We(w,q,Z,ae,ye,Te,Be){w.info(function(){return"XMLHTTP RESP ("+ae+") [ attempt "+ye+"]: "+q+`
`+Z+`
`+Te+" "+Be})}function Nr(w,q,Z,ae){w.info(function(){return"XMLHTTP TEXT ("+q+"): "+fo(w,Z)+(ae?" "+ae:"")})}function zs(w,q){w.info(function(){return"TIMEOUT: "+q})}Vs.prototype.info=function(){};function fo(w,q){if(!w.g)return q;if(!q)return null;try{var Z=JSON.parse(q);if(Z){for(w=0;w<Z.length;w++)if(Array.isArray(Z[w])){var ae=Z[w];if(!(2>ae.length)){var ye=ae[1];if(Array.isArray(ye)&&!(1>ye.length)){var Te=ye[0];if(Te!="noop"&&Te!="stop"&&Te!="close")for(var Be=1;Be<ye.length;Be++)ye[Be]=""}}}}return yr(Z)}catch{return q}}var ds={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},vr={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ir;function kr(){}E(kr,qi),kr.prototype.g=function(){return new XMLHttpRequest},kr.prototype.i=function(){return{}},Ir=new kr;function Pr(w,q,Z,ae){this.j=w,this.i=q,this.l=Z,this.R=ae||1,this.U=new cs(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Uo}function Uo(){this.i=null,this.g="",this.h=!1}var qo={},Qe={};function pe(w,q,Z){w.L=1,w.v=Vr(Sn(q)),w.m=Z,w.P=!0,Me(w,null)}function Me(w,q){w.F=Date.now(),It(w),w.A=Sn(w.v);var Z=w.A,ae=w.R;Array.isArray(ae)||(ae=[String(ae)]),go(Z.i,"t",ae),w.C=0,Z=w.j.J,w.h=new Uo,w.g=Au(w.j,Z?q:null,!w.m),0<w.O&&(w.M=new Mn(g(w.Y,w,w.g),w.O)),q=w.U,Z=w.g,ae=w.ca;var ye="readystatechange";Array.isArray(ye)||(ye&&(Ui[0]=ye.toString()),ye=Ui);for(var Te=0;Te<ye.length;Te++){var Be=xn(Z,ye[Te],ae||q.handleEvent,!1,q.h||q);if(!Be)break;q.g[Be.key]=Be}q=w.H?k(w.H):{},w.m?(w.u||(w.u="POST"),q["Content-Type"]="application/x-www-form-urlencoded",w.g.ea(w.A,w.u,w.m,q)):(w.u="GET",w.g.ea(w.A,w.u,null,q)),Hi(),ln(w.i,w.u,w.A,w.l,w.R,w.m)}Pr.prototype.ca=function(w){w=w.target;const q=this.M;q&&tr(w)==3?q.j():this.Y(w)},Pr.prototype.Y=function(w){try{if(w==this.g)e:{const En=tr(this.g);var q=this.g.Ba();const ki=this.g.Z();if(!(3>En)&&(En!=3||this.g&&(this.h.h||this.g.oa()||Ka(this.g)))){this.J||En!=4||q==7||(q==8||0>=ki?Hi(3):Hi(2)),Pn(this);var Z=this.g.Z();this.X=Z;t:if(Ke(this)){var ae=Ka(this.g);w="";var ye=ae.length,Te=tr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Gn(this),er(this);var Be="";break t}this.h.i=new l.TextDecoder}for(q=0;q<ye;q++)this.h.h=!0,w+=this.h.i.decode(ae[q],{stream:!(Te&&q==ye-1)});ae.length=0,this.h.g+=w,this.C=0,Be=this.h.g}else Be=this.g.oa();if(this.o=Z==200,We(this.i,this.u,this.A,this.l,this.R,En,Z),this.o){if(this.T&&!this.K){t:{if(this.g){var en,Un=this.g;if((en=Un.g?Un.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!N(en)){var Bt=en;break t}}Bt=null}if(Z=Bt)Nr(this.i,this.l,Z,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,$i(this,Z);else{this.o=!1,this.s=3,bn(12),Gn(this),er(this);break e}}if(this.P){Z=!0;let Dn;for(;!this.J&&this.C<Be.length;)if(Dn=Zt(this,Be),Dn==Qe){En==4&&(this.s=4,bn(14),Z=!1),Nr(this.i,this.l,null,"[Incomplete Response]");break}else if(Dn==qo){this.s=4,bn(15),Nr(this.i,this.l,Be,"[Invalid Chunk]"),Z=!1;break}else Nr(this.i,this.l,Dn,null),$i(this,Dn);if(Ke(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),En!=4||Be.length!=0||this.h.h||(this.s=1,bn(16),Z=!1),this.o=this.o&&Z,!Z)Nr(this.i,this.l,Be,"[Invalid Chunked Response]"),Gn(this),er(this);else if(0<Be.length&&!this.W){this.W=!0;var nn=this.j;nn.g==this&&nn.ba&&!nn.M&&(nn.j.info("Great, no buffering proxy detected. Bytes received: "+Be.length),Qa(nn),nn.M=!0,bn(11))}}else Nr(this.i,this.l,Be,null),$i(this,Be);En==4&&Gn(this),this.o&&!this.J&&(En==4?Xo(this.j,this):(this.o=!1,It(this)))}else Ya(this.g),Z==400&&0<Be.indexOf("Unknown SID")?(this.s=3,bn(12)):(this.s=0,bn(13)),Gn(this),er(this)}}}catch{}finally{}};function Ke(w){return w.g?w.u=="GET"&&w.L!=2&&w.j.Ca:!1}function Zt(w,q){var Z=w.C,ae=q.indexOf(`
`,Z);return ae==-1?Qe:(Z=Number(q.substring(Z,ae)),isNaN(Z)?qo:(ae+=1,ae+Z>q.length?Qe:(q=q.slice(ae,ae+Z),w.C=ae+Z,q)))}Pr.prototype.cancel=function(){this.J=!0,Gn(this)};function It(w){w.S=Date.now()+w.I,wn(w,w.I)}function wn(w,q){if(w.B!=null)throw Error("WatchDog timer not null");w.B=Lr(g(w.ba,w),q)}function Pn(w){w.B&&(l.clearTimeout(w.B),w.B=null)}Pr.prototype.ba=function(){this.B=null;const w=Date.now();0<=w-this.S?(zs(this.i,this.A),this.L!=2&&(Hi(),bn(17)),Gn(this),this.s=2,er(this)):wn(this,this.S-w)};function er(w){w.j.G==0||w.J||Xo(w.j,w)}function Gn(w){Pn(w);var q=w.M;q&&typeof q.ma=="function"&&q.ma(),w.M=null,yi(w.U),w.g&&(q=w.g,w.g=null,q.abort(),q.ma())}function $i(w,q){try{var Z=w.j;if(Z.G!=0&&(Z.g==w||St(Z.h,w))){if(!w.K&&St(Z.h,w)&&Z.G==3){try{var ae=Z.Da.g.parse(q)}catch{ae=null}if(Array.isArray(ae)&&ae.length==3){var ye=ae;if(ye[0]==0){e:if(!Z.u){if(Z.g)if(Z.g.F+3e3<w.F)Ja(Z),Yi(Z);else break e;Qo(Z),bn(18)}}else Z.za=ye[1],0<Z.za-Z.T&&37500>ye[2]&&Z.F&&Z.v==0&&!Z.C&&(Z.C=Lr(g(Z.Za,Z),6e3));if(1>=mo(Z.h)&&Z.ca){try{Z.ca()}catch{}Z.ca=void 0}}else Ws(Z,11)}else if((w.K||Z.g==w)&&Ja(Z),!N(q))for(ye=Z.Da.g.parse(q),q=0;q<ye.length;q++){let Bt=ye[q];if(Z.T=Bt[0],Bt=Bt[1],Z.G==2)if(Bt[0]=="c"){Z.K=Bt[1],Z.ia=Bt[2];const nn=Bt[3];nn!=null&&(Z.la=nn,Z.j.info("VER="+Z.la));const En=Bt[4];En!=null&&(Z.Aa=En,Z.j.info("SVER="+Z.Aa));const ki=Bt[5];ki!=null&&typeof ki=="number"&&0<ki&&(ae=1.5*ki,Z.L=ae,Z.j.info("backChannelRequestTimeoutMs_="+ae)),ae=Z;const Dn=w.g;if(Dn){const ea=Dn.g?Dn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(ea){var Te=ae.h;Te.g||ea.indexOf("spdy")==-1&&ea.indexOf("quic")==-1&&ea.indexOf("h2")==-1||(Te.j=Te.l,Te.g=new Set,Te.h&&(cn(Te,Te.h),Te.h=null))}if(ae.D){const Zi=Dn.g?Dn.g.getResponseHeader("X-HTTP-Session-Id"):null;Zi&&(ae.ya=Zi,Tt(ae.I,ae.D,Zi))}}Z.G=3,Z.l&&Z.l.ua(),Z.ba&&(Z.R=Date.now()-w.F,Z.j.info("Handshake RTT: "+Z.R+"ms")),ae=Z;var Be=w;if(ae.qa=el(ae,ae.J?ae.ia:null,ae.W),Be.K){Ho(ae.h,Be);var en=Be,Un=ae.L;Un&&(en.I=Un),en.B&&(Pn(en),It(en)),ae.g=Be}else zr(ae);0<Z.i.length&&Ii(Z)}else Bt[0]!="stop"&&Bt[0]!="close"||Ws(Z,7);else Z.G==3&&(Bt[0]=="stop"||Bt[0]=="close"?Bt[0]=="stop"?Ws(Z,7):nr(Z):Bt[0]!="noop"&&Z.l&&Z.l.ta(Bt),Z.v=0)}}Hi(4)}catch{}}var vn=class{constructor(w,q){this.g=w,this.map=q}};function Wi(w){this.l=w||10,l.PerformanceNavigationTiming?(w=l.performance.getEntriesByType("navigation"),w=0<w.length&&(w[0].nextHopProtocol=="hq"||w[0].nextHopProtocol=="h2")):w=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=w?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ar(w){return w.h?!0:w.g?w.g.size>=w.j:!1}function mo(w){return w.h?1:w.g?w.g.size:0}function St(w,q){return w.h?w.h==q:w.g?w.g.has(q):!1}function cn(w,q){w.g?w.g.add(q):w.h=q}function Ho(w,q){w.h&&w.h==q?w.h=null:w.g&&w.g.has(q)&&w.g.delete(q)}Wi.prototype.cancel=function(){if(this.i=Bs(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const w of this.g.values())w.cancel();this.g.clear()}};function Bs(w){if(w.h!=null)return w.i.concat(w.h.D);if(w.g!=null&&w.g.size!==0){let q=w.i;for(const Z of w.g.values())q=q.concat(Z.D);return q}return x(w.i)}function Gi(w){if(w.V&&typeof w.V=="function")return w.V();if(typeof Map<"u"&&w instanceof Map||typeof Set<"u"&&w instanceof Set)return Array.from(w.values());if(typeof w=="string")return w.split("");if(d(w)){for(var q=[],Z=w.length,ae=0;ae<Z;ae++)q.push(w[ae]);return q}q=[],Z=0;for(ae in w)q[Z++]=w[ae];return q}function po(w){if(w.na&&typeof w.na=="function")return w.na();if(!w.V||typeof w.V!="function"){if(typeof Map<"u"&&w instanceof Map)return Array.from(w.keys());if(!(typeof Set<"u"&&w instanceof Set)){if(d(w)||typeof w=="string"){var q=[];w=w.length;for(var Z=0;Z<w;Z++)q.push(Z);return q}q=[],Z=0;for(const ae in w)q[Z++]=ae;return q}}}function xt(w,q){if(w.forEach&&typeof w.forEach=="function")w.forEach(q,void 0);else if(d(w)||typeof w=="string")Array.prototype.forEach.call(w,q,void 0);else for(var Z=po(w),ae=Gi(w),ye=ae.length,Te=0;Te<ye;Te++)q.call(void 0,ae[Te],Z&&Z[Te],w)}var un=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function mc(w,q){if(w){w=w.split("&");for(var Z=0;Z<w.length;Z++){var ae=w[Z].indexOf("="),ye=null;if(0<=ae){var Te=w[Z].substring(0,ae);ye=w[Z].substring(ae+1)}else Te=w[Z];q(Te,ye?decodeURIComponent(ye.replace(/\+/g," ")):"")}}}function Ei(w){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,w instanceof Ei){this.h=w.h,$o(this,w.j),this.o=w.o,this.g=w.g,Ki(this,w.s),this.l=w.l;var q=w.i,Z=new Ti;Z.i=q.i,q.g&&(Z.g=new Map(q.g),Z.h=q.h),Fr(this,Z),this.m=w.m}else w&&(q=String(w).match(un))?(this.h=!1,$o(this,q[1]||"",!0),this.o=Ct(q[2]||""),this.g=Ct(q[3]||"",!0),Ki(this,q[4]),this.l=Ct(q[5]||"",!0),Fr(this,q[6]||"",!0),this.m=Ct(q[7]||"")):(this.h=!1,this.i=new Ti(null,this.h))}Ei.prototype.toString=function(){var w=[],q=this.j;q&&w.push(Si(q,hs,!0),":");var Z=this.g;return(Z||q=="file")&&(w.push("//"),(q=this.o)&&w.push(Si(q,hs,!0),"@"),w.push(encodeURIComponent(String(Z)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),Z=this.s,Z!=null&&w.push(":",String(Z))),(Z=this.l)&&(this.g&&Z.charAt(0)!="/"&&w.push("/"),w.push(Si(Z,Z.charAt(0)=="/"?Wa:$a,!0))),(Z=this.i.toString())&&w.push("?",Z),(Z=this.m)&&w.push("#",Si(Z,Go)),w.join("")};function Sn(w){return new Ei(w)}function $o(w,q,Z){w.j=Z?Ct(q,!0):q,w.j&&(w.j=w.j.replace(/:$/,""))}function Ki(w,q){if(q){if(q=Number(q),isNaN(q)||0>q)throw Error("Bad port number "+q);w.s=q}else w.s=null}function Fr(w,q,Z){q instanceof Ti?(w.i=q,Kn(w.i,w.h)):(Z||(q=Si(q,Wo)),w.i=new Ti(q,w.h))}function Tt(w,q,Z){w.i.set(q,Z)}function Vr(w){return Tt(w,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),w}function Ct(w,q){return w?q?decodeURI(w.replace(/%25/g,"%2525")):decodeURIComponent(w):""}function Si(w,q,Z){return typeof w=="string"?(w=encodeURI(w).replace(q,Ha),Z&&(w=w.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),w):null}function Ha(w){return w=w.charCodeAt(0),"%"+(w>>4&15).toString(16)+(w&15).toString(16)}var hs=/[#\/\?@]/g,$a=/[#\?:]/g,Wa=/[#\?]/g,Wo=/[#\?@]/g,Go=/#/g;function Ti(w,q){this.h=this.g=null,this.i=w||null,this.j=!!q}function Bn(w){w.g||(w.g=new Map,w.h=0,w.i&&mc(w.i,function(q,Z){w.add(decodeURIComponent(q.replace(/\+/g," ")),Z)}))}r=Ti.prototype,r.add=function(w,q){Bn(this),this.i=null,w=lt(this,w);var Z=this.g.get(w);return Z||this.g.set(w,Z=[]),Z.push(q),this.h+=1,this};function Ai(w,q){Bn(w),q=lt(w,q),w.g.has(q)&&(w.i=null,w.h-=w.g.get(q).length,w.g.delete(q))}function ri(w,q){return Bn(w),q=lt(w,q),w.g.has(q)}r.forEach=function(w,q){Bn(this),this.g.forEach(function(Z,ae){Z.forEach(function(ye){w.call(q,ye,ae,this)},this)},this)},r.na=function(){Bn(this);const w=Array.from(this.g.values()),q=Array.from(this.g.keys()),Z=[];for(let ae=0;ae<q.length;ae++){const ye=w[ae];for(let Te=0;Te<ye.length;Te++)Z.push(q[ae])}return Z},r.V=function(w){Bn(this);let q=[];if(typeof w=="string")ri(this,w)&&(q=q.concat(this.g.get(lt(this,w))));else{w=Array.from(this.g.values());for(let Z=0;Z<w.length;Z++)q=q.concat(w[Z])}return q},r.set=function(w,q){return Bn(this),this.i=null,w=lt(this,w),ri(this,w)&&(this.h-=this.g.get(w).length),this.g.set(w,[q]),this.h+=1,this},r.get=function(w,q){return w?(w=this.V(w),0<w.length?String(w[0]):q):q};function go(w,q,Z){Ai(w,q),0<Z.length&&(w.i=null,w.g.set(lt(w,q),x(Z)),w.h+=Z.length)}r.toString=function(){if(this.i)return this.i;if(!this.g)return"";const w=[],q=Array.from(this.g.keys());for(var Z=0;Z<q.length;Z++){var ae=q[Z];const Te=encodeURIComponent(String(ae)),Be=this.V(ae);for(ae=0;ae<Be.length;ae++){var ye=Te;Be[ae]!==""&&(ye+="="+encodeURIComponent(String(Be[ae]))),w.push(ye)}}return this.i=w.join("&")};function lt(w,q){return q=String(q),w.j&&(q=q.toLowerCase()),q}function Kn(w,q){q&&!w.j&&(Bn(w),w.i=null,w.g.forEach(function(Z,ae){var ye=ae.toLowerCase();ae!=ye&&(Ai(this,ae),go(this,ye,Z))},w)),w.j=q}function tn(w,q){const Z=new Vs;if(l.Image){const ae=new Image;ae.onload=_(_r,Z,"TestLoadImage: loaded",!0,q,ae),ae.onerror=_(_r,Z,"TestLoadImage: error",!1,q,ae),ae.onabort=_(_r,Z,"TestLoadImage: abort",!1,q,ae),ae.ontimeout=_(_r,Z,"TestLoadImage: timeout",!1,q,ae),l.setTimeout(function(){ae.ontimeout&&ae.ontimeout()},1e4),ae.src=w}else q(!1)}function pc(w,q){const Z=new Vs,ae=new AbortController,ye=setTimeout(()=>{ae.abort(),_r(Z,"TestPingServer: timeout",!1,q)},1e4);fetch(w,{signal:ae.signal}).then(Te=>{clearTimeout(ye),Te.ok?_r(Z,"TestPingServer: ok",!0,q):_r(Z,"TestPingServer: server error",!1,q)}).catch(()=>{clearTimeout(ye),_r(Z,"TestPingServer: error",!1,q)})}function _r(w,q,Z,ae,ye){try{ye&&(ye.onload=null,ye.onerror=null,ye.onabort=null,ye.ontimeout=null),ae(Z)}catch{}}function gc(){this.g=new ti}function Ga(w,q,Z){const ae=Z||"";try{xt(w,function(ye,Te){let Be=ye;f(ye)&&(Be=yr(ye)),q.push(ae+Te+"="+encodeURIComponent(Be))})}catch(ye){throw q.push(ae+"type="+encodeURIComponent("_badmap")),ye}}function Cr(w){this.l=w.Ub||null,this.j=w.eb||!1}E(Cr,qi),Cr.prototype.g=function(){return new Us(this.l,this.j)},Cr.prototype.i=function(w){return function(){return w}}({});function Us(w,q){kt.call(this),this.D=w,this.o=q,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}E(Us,kt),r=Us.prototype,r.open=function(w,q){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=w,this.A=q,this.readyState=1,lr(this)},r.send=function(w){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const q={headers:this.u,method:this.B,credentials:this.m,cache:void 0};w&&(q.body=w),(this.D||l).fetch(new Request(this.A,q)).then(this.Sa.bind(this),this.ga.bind(this))},r.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,dn(this)),this.readyState=0},r.Sa=function(w){if(this.g&&(this.l=w,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=w.headers,this.readyState=2,lr(this)),this.g&&(this.readyState=3,lr(this),this.g)))if(this.responseType==="arraybuffer")w.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in w){if(this.j=w.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;yo(this)}else w.text().then(this.Ra.bind(this),this.ga.bind(this))};function yo(w){w.j.read().then(w.Pa.bind(w)).catch(w.ga.bind(w))}r.Pa=function(w){if(this.g){if(this.o&&w.value)this.response.push(w.value);else if(!this.o){var q=w.value?w.value:new Uint8Array(0);(q=this.v.decode(q,{stream:!w.done}))&&(this.response=this.responseText+=q)}w.done?dn(this):lr(this),this.readyState==3&&yo(this)}},r.Ra=function(w){this.g&&(this.response=this.responseText=w,dn(this))},r.Qa=function(w){this.g&&(this.response=w,dn(this))},r.ga=function(){this.g&&dn(this)};function dn(w){w.readyState=4,w.l=null,w.j=null,w.v=null,lr(w)}r.setRequestHeader=function(w,q){this.u.append(w,q)},r.getResponseHeader=function(w){return this.h&&this.h.get(w.toLowerCase())||""},r.getAllResponseHeaders=function(){if(!this.h)return"";const w=[],q=this.h.entries();for(var Z=q.next();!Z.done;)Z=Z.value,w.push(Z[0]+": "+Z[1]),Z=q.next();return w.join(`\r
`)};function lr(w){w.onreadystatechange&&w.onreadystatechange.call(w)}Object.defineProperty(Us.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(w){this.m=w?"include":"same-origin"}});function fs(w){let q="";return U(w,function(Z,ae){q+=ae,q+=":",q+=Z,q+=`\r
`}),q}function qs(w,q,Z){e:{for(ae in Z){var ae=!1;break e}ae=!0}ae||(Z=fs(Z),typeof w=="string"?Z!=null&&encodeURIComponent(String(Z)):Tt(w,q,Z))}function Tn(w){kt.call(this),this.headers=new Map,this.o=w||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}E(Tn,kt);var Su=/^https?$/i,Ko=["POST","PUT"];r=Tn.prototype,r.Ha=function(w){this.J=w},r.ea=function(w,q,Z,ae){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+w);q=q?q.toUpperCase():"GET",this.D=w,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ir.g(),this.v=this.o?ho(this.o):ho(Ir),this.g.onreadystatechange=g(this.Ea,this);try{this.B=!0,this.g.open(q,String(w),!0),this.B=!1}catch(Te){Yo(this,Te);return}if(w=Z||"",Z=new Map(this.headers),ae)if(Object.getPrototypeOf(ae)===Object.prototype)for(var ye in ae)Z.set(ye,ae[ye]);else if(typeof ae.keys=="function"&&typeof ae.get=="function")for(const Te of ae.keys())Z.set(Te,ae.get(Te));else throw Error("Unknown input type for opt_headers: "+String(ae));ae=Array.from(Z.keys()).find(Te=>Te.toLowerCase()=="content-type"),ye=l.FormData&&w instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Ko,q,void 0))||ae||ye||Z.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Te,Be]of Z)this.g.setRequestHeader(Te,Be);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{xr(this),this.u=!0,this.g.send(w),this.u=!1}catch(Te){Yo(this,Te)}};function Yo(w,q){w.h=!1,w.g&&(w.j=!0,w.g.abort(),w.j=!1),w.l=q,w.m=5,Zo(w),ii(w)}function Zo(w){w.A||(w.A=!0,Ot(w,"complete"),Ot(w,"error"))}r.abort=function(w){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=w||7,Ot(this,"complete"),Ot(this,"abort"),ii(this))},r.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ii(this,!0)),Tn.aa.N.call(this)},r.Ea=function(){this.s||(this.B||this.u||this.j?Rt(this):this.bb())},r.bb=function(){Rt(this)};function Rt(w){if(w.h&&typeof o<"u"&&(!w.v[1]||tr(w)!=4||w.Z()!=2)){if(w.u&&tr(w)==4)ls(w.Ea,0,w);else if(Ot(w,"readystatechange"),tr(w)==4){w.h=!1;try{const Be=w.Z();e:switch(Be){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var q=!0;break e;default:q=!1}var Z;if(!(Z=q)){var ae;if(ae=Be===0){var ye=String(w.D).match(un)[1]||null;!ye&&l.self&&l.self.location&&(ye=l.self.location.protocol.slice(0,-1)),ae=!Su.test(ye?ye.toLowerCase():"")}Z=ae}if(Z)Ot(w,"complete"),Ot(w,"success");else{w.m=6;try{var Te=2<tr(w)?w.g.statusText:""}catch{Te=""}w.l=Te+" ["+w.Z()+"]",Zo(w)}}finally{ii(w)}}}}function ii(w,q){if(w.g){xr(w);const Z=w.g,ae=w.v[0]?()=>{}:null;w.g=null,w.v=null,q||Ot(w,"ready");try{Z.onreadystatechange=ae}catch{}}}function xr(w){w.I&&(l.clearTimeout(w.I),w.I=null)}r.isActive=function(){return!!this.g};function tr(w){return w.g?w.g.readyState:0}r.Z=function(){try{return 2<tr(this)?this.g.status:-1}catch{return-1}},r.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},r.Oa=function(w){if(this.g){var q=this.g.responseText;return w&&q.indexOf(w)==0&&(q=q.substring(w.length)),vi(q)}};function Ka(w){try{if(!w.g)return null;if("response"in w.g)return w.g.response;switch(w.H){case"":case"text":return w.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in w.g)return w.g.mozResponseArrayBuffer}return null}catch{return null}}function Ya(w){const q={};w=(w.g&&2<=tr(w)&&w.g.getAllResponseHeaders()||"").split(`\r
`);for(let ae=0;ae<w.length;ae++){if(N(w[ae]))continue;var Z=P(w[ae]);const ye=Z[0];if(Z=Z[1],typeof Z!="string")continue;Z=Z.trim();const Te=q[ye]||[];q[ye]=Te,Te.push(Z)}C(q,function(ae){return ae.join(", ")})}r.Ba=function(){return this.m},r.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ni(w,q,Z){return Z&&Z.internalChannelParams&&Z.internalChannelParams[w]||q}function yc(w){this.Aa=0,this.i=[],this.j=new Vs,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ni("failFast",!1,w),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ni("baseRetryDelayMs",5e3,w),this.cb=Ni("retryDelaySeedMs",1e4,w),this.Wa=Ni("forwardChannelMaxRetries",2,w),this.wa=Ni("forwardChannelRequestTimeoutMs",2e4,w),this.pa=w&&w.xmlHttpFactory||void 0,this.Xa=w&&w.Tb||void 0,this.Ca=w&&w.useFetchStreams||!1,this.L=void 0,this.J=w&&w.supportsCrossDomainXhr||!1,this.K="",this.h=new Wi(w&&w.concurrentRequestLimit),this.Da=new gc,this.P=w&&w.fastHandshake||!1,this.O=w&&w.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=w&&w.Rb||!1,w&&w.xa&&this.j.xa(),w&&w.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&w&&w.detectBufferingProxy||!1,this.ja=void 0,w&&w.longPollingTimeout&&0<w.longPollingTimeout&&(this.ja=w.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}r=yc.prototype,r.la=8,r.G=1,r.connect=function(w,q,Z,ae){bn(0),this.W=w,this.H=q||{},Z&&ae!==void 0&&(this.H.OSID=Z,this.H.OAID=ae),this.F=this.X,this.I=el(this,null,this.W),Ii(this)};function nr(w){if(Za(w),w.G==3){var q=w.U++,Z=Sn(w.I);if(Tt(Z,"SID",w.K),Tt(Z,"RID",q),Tt(Z,"TYPE","terminate"),Hs(w,Z),q=new Pr(w,w.j,q),q.L=2,q.v=Vr(Sn(Z)),Z=!1,l.navigator&&l.navigator.sendBeacon)try{Z=l.navigator.sendBeacon(q.v.toString(),"")}catch{}!Z&&l.Image&&(new Image().src=q.v,Z=!0),Z||(q.g=Au(q.j,null),q.g.ea(q.v)),q.F=Date.now(),It(q)}Tu(w)}function Yi(w){w.g&&(Qa(w),w.g.cancel(),w.g=null)}function Za(w){Yi(w),w.u&&(l.clearTimeout(w.u),w.u=null),Ja(w),w.h.cancel(),w.s&&(typeof w.s=="number"&&l.clearTimeout(w.s),w.s=null)}function Ii(w){if(!ar(w.h)&&!w.s){w.s=!0;var q=w.Ga;oe||K(),ie||(oe(),ie=!0),ne.add(q,w),w.B=0}}function ch(w,q){return mo(w.h)>=w.h.j-(w.s?1:0)?!1:w.s?(w.i=q.D.concat(w.i),!0):w.G==1||w.G==2||w.B>=(w.Va?0:w.Wa)?!1:(w.s=Lr(g(w.Ga,w,q),vc(w,w.B)),w.B++,!0)}r.Ga=function(w){if(this.s)if(this.s=null,this.G==1){if(!w){this.U=Math.floor(1e5*Math.random()),w=this.U++;const ye=new Pr(this,this.j,w);let Te=this.o;if(this.S&&(Te?(Te=k(Te),O(Te,this.S)):Te=this.S),this.m!==null||this.O||(ye.H=Te,Te=null),this.P)e:{for(var q=0,Z=0;Z<this.i.length;Z++){t:{var ae=this.i[Z];if("__data__"in ae.map&&(ae=ae.map.__data__,typeof ae=="string")){ae=ae.length;break t}ae=void 0}if(ae===void 0)break;if(q+=ae,4096<q){q=Z;break e}if(q===4096||Z===this.i.length-1){q=Z+1;break e}}q=1e3}else q=1e3;q=$s(this,ye,q),Z=Sn(this.I),Tt(Z,"RID",w),Tt(Z,"CVER",22),this.D&&Tt(Z,"X-HTTP-Session-Id",this.D),Hs(this,Z),Te&&(this.O?q="headers="+encodeURIComponent(String(fs(Te)))+"&"+q:this.m&&qs(Z,this.m,Te)),cn(this.h,ye),this.Ua&&Tt(Z,"TYPE","init"),this.P?(Tt(Z,"$req",q),Tt(Z,"SID","null"),ye.T=!0,pe(ye,Z,null)):pe(ye,Z,q),this.G=2}}else this.G==3&&(w?Rr(this,w):this.i.length==0||ar(this.h)||Rr(this))};function Rr(w,q){var Z;q?Z=q.l:Z=w.U++;const ae=Sn(w.I);Tt(ae,"SID",w.K),Tt(ae,"RID",Z),Tt(ae,"AID",w.T),Hs(w,ae),w.m&&w.o&&qs(ae,w.m,w.o),Z=new Pr(w,w.j,Z,w.B+1),w.m===null&&(Z.H=w.o),q&&(w.i=q.D.concat(w.i)),q=$s(w,Z,1e3),Z.I=Math.round(.5*w.wa)+Math.round(.5*w.wa*Math.random()),cn(w.h,Z),pe(Z,ae,q)}function Hs(w,q){w.H&&U(w.H,function(Z,ae){Tt(q,ae,Z)}),w.l&&xt({},function(Z,ae){Tt(q,ae,Z)})}function $s(w,q,Z){Z=Math.min(w.i.length,Z);var ae=w.l?g(w.l.Na,w.l,w):null;e:{var ye=w.i;let Te=-1;for(;;){const Be=["count="+Z];Te==-1?0<Z?(Te=ye[0].g,Be.push("ofs="+Te)):Te=0:Be.push("ofs="+Te);let en=!0;for(let Un=0;Un<Z;Un++){let Bt=ye[Un].g;const nn=ye[Un].map;if(Bt-=Te,0>Bt)Te=Math.max(0,ye[Un].g-100),en=!1;else try{Ga(nn,Be,"req"+Bt+"_")}catch{ae&&ae(nn)}}if(en){ae=Be.join("&");break e}}}return w=w.i.splice(0,Z),q.D=w,ae}function zr(w){if(!w.g&&!w.u){w.Y=1;var q=w.Fa;oe||K(),ie||(oe(),ie=!0),ne.add(q,w),w.v=0}}function Qo(w){return w.g||w.u||3<=w.v?!1:(w.Y++,w.u=Lr(g(w.Fa,w),vc(w,w.v)),w.v++,!0)}r.Fa=function(){if(this.u=null,Xa(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var w=2*this.R;this.j.info("BP detection timer enabled: "+w),this.A=Lr(g(this.ab,this),w)}},r.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,bn(10),Yi(this),Xa(this))};function Qa(w){w.A!=null&&(l.clearTimeout(w.A),w.A=null)}function Xa(w){w.g=new Pr(w,w.j,"rpc",w.Y),w.m===null&&(w.g.H=w.o),w.g.O=0;var q=Sn(w.qa);Tt(q,"RID","rpc"),Tt(q,"SID",w.K),Tt(q,"AID",w.T),Tt(q,"CI",w.F?"0":"1"),!w.F&&w.ja&&Tt(q,"TO",w.ja),Tt(q,"TYPE","xmlhttp"),Hs(w,q),w.m&&w.o&&qs(q,w.m,w.o),w.L&&(w.g.I=w.L);var Z=w.g;w=w.ia,Z.L=1,Z.v=Vr(Sn(q)),Z.m=null,Z.P=!0,Me(Z,w)}r.Za=function(){this.C!=null&&(this.C=null,Yi(this),Qo(this),bn(19))};function Ja(w){w.C!=null&&(l.clearTimeout(w.C),w.C=null)}function Xo(w,q){var Z=null;if(w.g==q){Ja(w),Qa(w),w.g=null;var ae=2}else if(St(w.h,q))Z=q.D,Ho(w.h,q),ae=1;else return;if(w.G!=0){if(q.o)if(ae==1){Z=q.m?q.m.length:0,q=Date.now()-q.F;var ye=w.B;ae=yn(),Ot(ae,new Fs(ae,Z)),Ii(w)}else zr(w);else if(ye=q.s,ye==3||ye==0&&0<q.X||!(ae==1&&ch(w,q)||ae==2&&Qo(w)))switch(Z&&0<Z.length&&(q=w.h,q.i=q.i.concat(Z)),ye){case 1:Ws(w,5);break;case 4:Ws(w,10);break;case 3:Ws(w,6);break;default:Ws(w,2)}}}function vc(w,q){let Z=w.Ta+Math.floor(Math.random()*w.cb);return w.isActive()||(Z*=2),Z*q}function Ws(w,q){if(w.j.info("Error code "+q),q==2){var Z=g(w.fb,w),ae=w.Xa;const ye=!ae;ae=new Ei(ae||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||$o(ae,"https"),Vr(ae),ye?tn(ae.toString(),Z):pc(ae.toString(),Z)}else bn(2);w.G=0,w.l&&w.l.sa(q),Tu(w),Za(w)}r.fb=function(w){w?(this.j.info("Successfully pinged google.com"),bn(2)):(this.j.info("Failed to ping google.com"),bn(1))};function Tu(w){if(w.G=0,w.ka=[],w.l){const q=Bs(w.h);(q.length!=0||w.i.length!=0)&&(b(w.ka,q),b(w.ka,w.i),w.h.i.length=0,x(w.i),w.i.length=0),w.l.ra()}}function el(w,q,Z){var ae=Z instanceof Ei?Sn(Z):new Ei(Z);if(ae.g!="")q&&(ae.g=q+"."+ae.g),Ki(ae,ae.s);else{var ye=l.location;ae=ye.protocol,q=q?q+"."+ye.hostname:ye.hostname,ye=+ye.port;var Te=new Ei(null);ae&&$o(Te,ae),q&&(Te.g=q),ye&&Ki(Te,ye),Z&&(Te.l=Z),ae=Te}return Z=w.D,q=w.ya,Z&&q&&Tt(ae,Z,q),Tt(ae,"VER",w.la),Hs(w,ae),ae}function Au(w,q,Z){if(q&&!w.J)throw Error("Can't create secondary domain capable XhrIo object.");return q=w.Ca&&!w.pa?new Tn(new Cr({eb:Z})):new Tn(w.pa),q.Ha(w.J),q}r.isActive=function(){return!!this.l&&this.l.isActive(this)};function tl(){}r=tl.prototype,r.ua=function(){},r.ta=function(){},r.sa=function(){},r.ra=function(){},r.isActive=function(){return!0},r.Na=function(){};function Jo(){}Jo.prototype.g=function(w,q){return new rr(w,q)};function rr(w,q){kt.call(this),this.g=new yc(q),this.l=w,this.h=q&&q.messageUrlParams||null,w=q&&q.messageHeaders||null,q&&q.clientProtocolHeaderRequired&&(w?w["X-Client-Protocol"]="webchannel":w={"X-Client-Protocol":"webchannel"}),this.g.o=w,w=q&&q.initMessageHeaders||null,q&&q.messageContentType&&(w?w["X-WebChannel-Content-Type"]=q.messageContentType:w={"X-WebChannel-Content-Type":q.messageContentType}),q&&q.va&&(w?w["X-WebChannel-Client-Profile"]=q.va:w={"X-WebChannel-Client-Profile":q.va}),this.g.S=w,(w=q&&q.Sb)&&!N(w)&&(this.g.m=w),this.v=q&&q.supportsCrossDomainXhr||!1,this.u=q&&q.sendRawJson||!1,(q=q&&q.httpSessionIdParam)&&!N(q)&&(this.g.D=q,w=this.h,w!==null&&q in w&&(w=this.h,q in w&&delete w[q])),this.j=new Br(this)}E(rr,kt),rr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},rr.prototype.close=function(){nr(this.g)},rr.prototype.o=function(w){var q=this.g;if(typeof w=="string"){var Z={};Z.__data__=w,w=Z}else this.u&&(Z={},Z.__data__=yr(w),w=Z);q.i.push(new vn(q.Ya++,w)),q.G==3&&Ii(q)},rr.prototype.N=function(){this.g.l=null,delete this.j,nr(this.g),delete this.g,rr.aa.N.call(this)};function ms(w){ni.call(this),w.__headers__&&(this.headers=w.__headers__,this.statusCode=w.__status__,delete w.__headers__,delete w.__status__);var q=w.__sm__;if(q){e:{for(const Z in q){w=Z;break e}w=void 0}(this.i=w)&&(w=this.i,q=q!==null&&w in q?q[w]:void 0),this.data=q}else this.data=w}E(ms,ni);function Nu(){xi.call(this),this.status=1}E(Nu,xi);function Br(w){this.g=w}E(Br,tl),Br.prototype.ua=function(){Ot(this.g,"a")},Br.prototype.ta=function(w){Ot(this.g,new ms(w))},Br.prototype.sa=function(w){Ot(this.g,new Nu)},Br.prototype.ra=function(){Ot(this.g,"b")},Jo.prototype.createWebChannel=Jo.prototype.g,rr.prototype.send=rr.prototype.o,rr.prototype.open=rr.prototype.m,rr.prototype.close=rr.prototype.close,Ek=function(){return new Jo},wk=function(){return yn()},bk=bi,rx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ds.NO_ERROR=0,ds.TIMEOUT=8,ds.HTTP_ERROR=6,lg=ds,vr.COMPLETE="complete",xk=vr,_i.EventType=Jn,Jn.OPEN="a",Jn.CLOSE="b",Jn.ERROR="c",Jn.MESSAGE="d",kt.prototype.listen=kt.prototype.K,cf=_i,Tn.prototype.listenOnce=Tn.prototype.L,Tn.prototype.getLastError=Tn.prototype.Ka,Tn.prototype.getLastErrorCode=Tn.prototype.Ba,Tn.prototype.getStatus=Tn.prototype.Z,Tn.prototype.getResponseJson=Tn.prototype.Oa,Tn.prototype.getResponseText=Tn.prototype.oa,Tn.prototype.send=Tn.prototype.ea,Tn.prototype.setWithCredentials=Tn.prototype.Ha,_k=Tn}).apply(typeof Pp<"u"?Pp:typeof self<"u"?self:typeof window<"u"?window:{});const bS="@firebase/firestore",wS="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tr=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Tr.UNAUTHENTICATED=new Tr(null),Tr.GOOGLE_CREDENTIALS=new Tr("google-credentials-uid"),Tr.FIRST_PARTY=new Tr("first-party-uid"),Tr.MOCK_USER=new Tr("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gd="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const su=new tb("@firebase/firestore");function cd(){return su.logLevel}function Re(r,...e){if(su.logLevel<=Ut.DEBUG){const t=e.map(mb);su.debug(`Firestore (${Gd}): ${r}`,...t)}}function Zn(r,...e){if(su.logLevel<=Ut.ERROR){const t=e.map(mb);su.error(`Firestore (${Gd}): ${r}`,...t)}}function ou(r,...e){if(su.logLevel<=Ut.WARN){const t=e.map(mb);su.warn(`Firestore (${Gd}): ${r}`,...t)}}function mb(r){if(typeof r=="string")return r;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(t){return JSON.stringify(t)}(r)}catch{return r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ze(r,e,t){let n="Unexpected state";typeof e=="string"?n=e:t=e,Sk(r,n,t)}function Sk(r,e,t){let n=`FIRESTORE (${Gd}) INTERNAL ASSERTION FAILED: ${e} (ID: ${r.toString(16)})`;if(t!==void 0)try{n+=" CONTEXT: "+JSON.stringify(t)}catch{n+=" CONTEXT: "+t}throw Zn(n),new Error(n)}function it(r,e,t,n){let i="Unexpected state";typeof t=="string"?i=t:n=t,r||Sk(e,i,n)}function et(r,e){return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Ue extends Ca{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lo{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tk{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class PM{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(Tr.UNAUTHENTICATED))}shutdown(){}}class CM{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class RM{constructor(e){this.t=e,this.currentUser=Tr.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){it(this.o===void 0,42304);let n=this.i;const i=d=>this.i!==n?(n=this.i,t(d)):Promise.resolve();let s=new lo;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new lo,e.enqueueRetryable(()=>i(this.currentUser))};const o=()=>{const d=s;e.enqueueRetryable(async()=>{await d.promise,await i(this.currentUser)})},l=d=>{Re("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(d=>l(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?l(d):(Re("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new lo)}},0),o()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then(n=>this.i!==e?(Re("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):n?(it(typeof n.accessToken=="string",31837,{l:n}),new Tk(n.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return it(e===null||typeof e=="string",2055,{h:e}),new Tr(e)}}class jM{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=Tr.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class OM{constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new jM(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable(()=>t(Tr.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class ES{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class MM{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,ui(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){it(this.o===void 0,3512);const n=s=>{s.error!=null&&Re("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);const o=s.token!==this.m;return this.m=s.token,Re("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?t(s.token):Promise.resolve()};this.o=s=>{e.enqueueRetryable(()=>n(s))};const i=s=>{Re("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(s=>i(s)),setTimeout(()=>{if(!this.appCheck){const s=this.V.getImmediate({optional:!0});s?i(s):Re("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new ES(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(t=>t?(it(typeof t.token=="string",44558,{tokenResult:t}),this.m=t.token,new ES(t.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DM(r){const e=typeof self<"u"&&(self.crypto||self.msCrypto),t=new Uint8Array(r);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(t);else for(let n=0;n<r;n++)t[n]=Math.floor(256*Math.random());return t}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ak(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(4.129032258064516);let n="";for(;n.length<20;){const i=DM(40);for(let s=0;s<i.length;++s)n.length<20&&i[s]<t&&(n+=e.charAt(i[s]%62))}return n}}function bt(r,e){return r<e?-1:r>e?1:0}function ix(r,e){let t=0;for(;t<r.length&&t<e.length;){const n=r.codePointAt(t),i=e.codePointAt(t);if(n!==i){if(n<128&&i<128)return bt(n,i);{const s=Ak(),o=LM(s.encode(SS(r,t)),s.encode(SS(e,t)));return o!==0?o:bt(n,i)}}t+=n>65535?2:1}return bt(r.length,e.length)}function SS(r,e){return r.codePointAt(e)>65535?r.substring(e,e+2):r.substring(e,e+1)}function LM(r,e){for(let t=0;t<r.length&&t<e.length;++t)if(r[t]!==e[t])return bt(r[t],e[t]);return bt(r.length,e.length)}function Sd(r,e,t){return r.length===e.length&&r.every((n,i)=>t(n,e[i]))}function Ik(r){return r+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TS=-62135596800,AS=1e6;class jt{static now(){return jt.fromMillis(Date.now())}static fromDate(e){return jt.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*AS);return new jt(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new Ue(Ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new Ue(Ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<TS)throw new Ue(Ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new Ue(Ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/AS}_compareTo(e){return this.seconds===e.seconds?bt(this.nanoseconds,e.nanoseconds):bt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-TS;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ct{static fromTimestamp(e){return new ct(e)}static min(){return new ct(new jt(0,0))}static max(){return new ct(new jt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sx="__name__";class ko{constructor(e,t,n){t===void 0?t=0:t>e.length&&Ze(637,{offset:t,range:e.length}),n===void 0?n=e.length-t:n>e.length-t&&Ze(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return ko.comparator(this,e)===0}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ko?e.forEach(n=>{t.push(n)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let i=0;i<n;i++){const s=ko.compareSegments(e.get(i),t.get(i));if(s!==0)return s}return bt(e.length,t.length)}static compareSegments(e,t){const n=ko.isNumericId(e),i=ko.isNumericId(t);return n&&!i?-1:!n&&i?1:n&&i?ko.extractNumericId(e).compare(ko.extractNumericId(t)):ix(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Hl.fromString(e.substring(4,e.length-2))}}class sn extends ko{construct(e,t,n){return new sn(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new Ue(Ie.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter(i=>i.length>0))}return new sn(t)}static emptyPath(){return new sn([])}}const FM=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Vn extends ko{construct(e,t,n){return new Vn(e,t,n)}static isValidIdentifier(e){return FM.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Vn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===sx}static keyField(){return new Vn([sx])}static fromServerFormat(e){const t=[];let n="",i=0;const s=()=>{if(n.length===0)throw new Ue(Ie.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let o=!1;for(;i<e.length;){const l=e[i];if(l==="\\"){if(i+1===e.length)throw new Ue(Ie.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[i+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new Ue(Ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=d,i+=2}else l==="`"?(o=!o,i++):l!=="."||o?(n+=l,i++):(s(),i++)}if(s(),o)throw new Ue(Ie.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Vn(t)}static emptyPath(){return new Vn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class He{constructor(e){this.path=e}static fromPath(e){return new He(sn.fromString(e))}static fromName(e){return new He(sn.fromString(e).popFirst(5))}static empty(){return new He(sn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&sn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,t){return sn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new He(new sn(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Td=-1;class Mg{constructor(e,t,n,i){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=i}}function ox(r){return r.fields.find(e=>e.kind===2)}function zc(r){return r.fields.filter(e=>e.kind!==2)}Mg.UNKNOWN_ID=-1;class cg{constructor(e,t){this.fieldPath=e,this.kind=t}}class Uf{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new Uf(0,os.min())}}function kk(r,e){const t=r.toTimestamp().seconds,n=r.toTimestamp().nanoseconds+1,i=ct.fromTimestamp(n===1e9?new jt(t+1,0):new jt(t,n));return new os(i,He.empty(),e)}function Pk(r){return new os(r.readTime,r.key,Td)}class os{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new os(ct.min(),He.empty(),Td)}static max(){return new os(ct.max(),He.empty(),Td)}}function pb(r,e){let t=r.readTime.compareTo(e.readTime);return t!==0?t:(t=He.comparator(r.documentKey,e.documentKey),t!==0?t:bt(r.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ck="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Rk{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ac(r){if(r.code!==Ie.FAILED_PRECONDITION||r.message!==Ck)throw r;Re("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(t=>{this.isDone=!0,this.result=t,this.nextCallback&&this.nextCallback(t)},t=>{this.isDone=!0,this.error=t,this.catchCallback&&this.catchCallback(t)})}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&Ze(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new ve((n,i)=>{this.nextCallback=s=>{this.wrapSuccess(e,s).next(n,i)},this.catchCallback=s=>{this.wrapFailure(t,s).next(n,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{const t=e();return t instanceof ve?t:ve.resolve(t)}catch(t){return ve.reject(t)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):ve.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):ve.reject(t)}static resolve(e){return new ve((t,n)=>{t(e)})}static reject(e){return new ve((t,n)=>{n(e)})}static waitFor(e){return new ve((t,n)=>{let i=0,s=0,o=!1;e.forEach(l=>{++i,l.next(()=>{++s,o&&s===i&&t()},d=>n(d))}),o=!0,s===i&&t()})}static or(e){let t=ve.resolve(!1);for(const n of e)t=t.next(i=>i?ve.resolve(i):n());return t}static forEach(e,t){const n=[];return e.forEach((i,s)=>{n.push(t.call(this,i,s))}),this.waitFor(n)}static mapArray(e,t){return new ve((n,i)=>{const s=e.length,o=new Array(s);let l=0;for(let d=0;d<s;d++){const f=d;t(e[f]).next(m=>{o[f]=m,++l,l===s&&n(o)},m=>i(m))}})}static doWhile(e,t){return new ve((n,i)=>{const s=()=>{e()===!0?t().next(()=>{s()},i):n()};s()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ns="SimpleDb";class Ay{static open(e,t,n,i){try{return new Ay(t,e.transaction(i,n))}catch(s){throw new Ef(t,s)}}constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.S=new lo,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{t.error?this.S.reject(new Ef(e,t.error)):this.S.resolve()},this.transaction.onerror=n=>{const i=gb(n.target.error);this.S.reject(new Ef(e,i))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Re(ns,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const t=this.transaction.objectStore(e);return new zM(t)}}class $l{static delete(e){return Re(ns,"Removing database:",e),Hc(w4().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!P4())return!1;if($l.F())return!0;const e=pr(),t=$l.M(e),n=0<t&&t<10,i=jk(e),s=0<i&&i<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||s)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,t){return e.store(t)}static M(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}constructor(e,t,n){this.name=e,this.version=t,this.B=n,this.L=null,$l.M(pr())===12.2&&Zn("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(Re(ns,"Opening database:",this.name),this.db=await new Promise((t,n)=>{const i=indexedDB.open(this.name,this.version);i.onsuccess=s=>{const o=s.target.result;t(o)},i.onblocked=()=>{n(new Ef(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},i.onerror=s=>{const o=s.target.error;o.name==="VersionError"?n(new Ue(Ie.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?n(new Ue(Ie.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):n(new Ef(e,o))},i.onupgradeneeded=s=>{Re(ns,'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);const o=s.target.result;if(this.L!==null&&this.L!==s.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${s.oldVersion}, event.newVersion=${s.newVersion}, db.version=${o.version}`);this.B.q(o,i.transaction,s.oldVersion,this.version).next(()=>{Re(ns,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",t=>{const n=t.target;this.L=n.version},{passive:!0})),this.$&&(this.db.onversionchange=t=>this.$(t)),this.db}U(e){this.$=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,i){const s=t==="readonly";let o=0;for(;;){++o;try{this.db=await this.k(e);const l=Ay.open(this.db,e,s?"readonly":"readwrite",n),d=i(l).next(f=>(l.v(),f)).catch(f=>(l.abort(f),ve.reject(f))).toPromise();return d.catch(()=>{}),await l.D,d}catch(l){const d=l,f=d.name!=="FirebaseError"&&o<3;if(Re(ns,"Transaction failed with error:",d.message,"Retrying:",f),this.close(),!f)return Promise.reject(d)}}}close(){this.db&&this.db.close(),this.db=void 0}}function jk(r){const e=r.match(/Android ([\d.]+)/i),t=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(t)}class VM{constructor(e){this.K=e,this.W=!1,this.G=null}get isDone(){return this.W}get j(){return this.G}set cursor(e){this.K=e}done(){this.W=!0}H(e){this.G=e}delete(){return Hc(this.K.delete())}}class Ef extends Ue{constructor(e,t){super(Ie.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function lc(r){return r.name==="IndexedDbTransactionError"}class zM{constructor(e){this.store=e}put(e,t){let n;return t!==void 0?(Re(ns,"PUT",this.store.name,e,t),n=this.store.put(t,e)):(Re(ns,"PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Hc(n)}add(e){return Re(ns,"ADD",this.store.name,e,e),Hc(this.store.add(e))}get(e){return Hc(this.store.get(e)).next(t=>(t===void 0&&(t=null),Re(ns,"GET",this.store.name,e,t),t))}delete(e){return Re(ns,"DELETE",this.store.name,e),Hc(this.store.delete(e))}count(){return Re(ns,"COUNT",this.store.name),Hc(this.store.count())}J(e,t){const n=this.options(e,t),i=n.index?this.store.index(n.index):this.store;if(typeof i.getAll=="function"){const s=i.getAll(n.range);return new ve((o,l)=>{s.onerror=d=>{l(d.target.error)},s.onsuccess=d=>{o(d.target.result)}})}{const s=this.cursor(n),o=[];return this.Y(s,(l,d)=>{o.push(d)}).next(()=>o)}}Z(e,t){const n=this.store.getAll(e,t===null?void 0:t);return new ve((i,s)=>{n.onerror=o=>{s(o.target.error)},n.onsuccess=o=>{i(o.target.result)}})}X(e,t){Re(ns,"DELETE ALL",this.store.name);const n=this.options(e,t);n.ee=!1;const i=this.cursor(n);return this.Y(i,(s,o,l)=>l.delete())}te(e,t){let n;t?n=e:(n={},t=e);const i=this.cursor(n);return this.Y(i,t)}ne(e){const t=this.cursor({});return new ve((n,i)=>{t.onerror=s=>{const o=gb(s.target.error);i(o)},t.onsuccess=s=>{const o=s.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():n()}):n()}})}Y(e,t){const n=[];return new ve((i,s)=>{e.onerror=o=>{s(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void i();const d=new VM(l),f=t(l.primaryKey,l.value,d);if(f instanceof ve){const m=f.catch(y=>(d.done(),ve.reject(y)));n.push(m)}d.isDone?i():d.j===null?l.continue():l.continue(d.j)}}).next(()=>ve.waitFor(n))}options(e,t){let n;return e!==void 0&&(typeof e=="string"?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.ee?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Hc(r){return new ve((e,t)=>{r.onsuccess=n=>{const i=n.target.result;e(i)},r.onerror=n=>{const i=gb(n.target.error);t(i)}})}let NS=!1;function gb(r){const e=$l.M(pr());if(e>=12.2&&e<13){const t="An internal error was encountered in the Indexed Database server";if(r.message.indexOf(t)>=0){const n=new Ue("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return NS||(NS=!0,setTimeout(()=>{throw n},0)),n}}return r}const Sf="IndexBackfiller";class BM{constructor(e,t){this.asyncQueue=e,this.re=t,this.task=null}start(){this.ie(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ie(e){Re(Sf,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const t=await this.re.se();Re(Sf,`Documents written: ${t}`)}catch(t){lc(t)?Re(Sf,"Ignoring IndexedDB error during index backfill: ",t):await ac(t)}await this.ie(6e4)})}}class UM{constructor(e,t){this.localStore=e,this.persistence=t}async se(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",t=>this.oe(t,e))}oe(e,t){const n=new Set;let i=t,s=!0;return ve.doWhile(()=>s===!0&&i>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!n.has(o))return Re(Sf,`Processing collection: ${o}`),this._e(e,o,i).next(l=>{i-=l,n.add(o)});s=!1})).next(()=>t-i)}_e(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next(i=>this.localStore.localDocuments.getNextDocuments(e,t,i,n).next(s=>{const o=s.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ae(i,s)).next(l=>(Re(Sf,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,t,l))).next(()=>o.size)}))}ae(e,t){let n=e;return t.changes.forEach((i,s)=>{const o=Pk(s);pb(o,n)>0&&(n=o)}),new os(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zi{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=n=>this.ue(n),this.ce=n=>t.writeSequenceNumber(n))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}zi.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Qc=-1;function Ny(r){return r==null}function qf(r){return r===0&&1/r==-1/0}function Ok(r){return typeof r=="number"&&Number.isInteger(r)&&!qf(r)&&r<=Number.MAX_SAFE_INTEGER&&r>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dg="";function Jr(r){let e="";for(let t=0;t<r.length;t++)e.length>0&&(e=IS(e)),e=qM(r.get(t),e);return IS(e)}function qM(r,e){let t=e;const n=r.length;for(let i=0;i<n;i++){const s=r.charAt(i);switch(s){case"\0":t+="";break;case Dg:t+="";break;default:t+=s}}return t}function IS(r){return r+Dg+""}function Co(r){const e=r.length;if(it(e>=2,64408,{path:r}),e===2)return it(r.charAt(0)===Dg&&r.charAt(1)==="",56145,{path:r}),sn.emptyPath();const t=e-2,n=[];let i="";for(let s=0;s<e;){const o=r.indexOf(Dg,s);switch((o<0||o>t)&&Ze(50515,{path:r}),r.charAt(o+1)){case"":const l=r.substring(s,o);let d;i.length===0?d=l:(i+=l,d=i,i=""),n.push(d);break;case"":i+=r.substring(s,o),i+="\0";break;case"":i+=r.substring(s,o+1);break;default:Ze(61167,{path:r})}s=o+2}return new sn(n)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bc="remoteDocuments",ym="owner",Ju="owner",Hf="mutationQueues",HM="userId",io="mutations",kS="batchId",Yc="userMutationsIndex",PS=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ug(r,e){return[r,Jr(e)]}function Mk(r,e,t){return[r,Jr(e),t]}const $M={},Ad="documentMutations",Lg="remoteDocumentsV14",WM=["prefixPath","collectionGroup","readTime","documentId"],dg="documentKeyIndex",GM=["prefixPath","collectionGroup","documentId"],Dk="collectionGroupIndex",KM=["collectionGroup","readTime","prefixPath","documentId"],$f="remoteDocumentGlobal",ax="remoteDocumentGlobalKey",Nd="targets",Lk="queryTargetsIndex",YM=["canonicalId","targetId"],Id="targetDocuments",ZM=["targetId","path"],yb="documentTargetsIndex",QM=["path","targetId"],Fg="targetGlobalKey",Xc="targetGlobal",Wf="collectionParents",XM=["collectionId","parent"],kd="clientMetadata",JM="clientId",Iy="bundles",eD="bundleId",ky="namedQueries",tD="name",vb="indexConfiguration",nD="indexId",lx="collectionGroupIndex",rD="collectionGroup",Tf="indexState",iD=["indexId","uid"],Fk="sequenceNumberIndex",sD=["uid","sequenceNumber"],Af="indexEntries",oD=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Vk="documentKeyIndex",aD=["indexId","uid","orderedDocumentKey"],Py="documentOverlays",lD=["userId","collectionPath","documentId"],cx="collectionPathOverlayIndex",cD=["userId","collectionPath","largestBatchId"],zk="collectionGroupOverlayIndex",uD=["userId","collectionGroup","largestBatchId"],_b="globals",dD="name",Bk=[Hf,io,Ad,Bc,Nd,ym,Xc,Id,kd,$f,Wf,Iy,ky],hD=[...Bk,Py],Uk=[Hf,io,Ad,Lg,Nd,ym,Xc,Id,kd,$f,Wf,Iy,ky,Py],qk=Uk,xb=[...qk,vb,Tf,Af],fD=xb,Hk=[...xb,_b],mD=Hk;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ux extends Rk{constructor(e,t){super(),this.he=e,this.currentSequenceNumber=t}}function gr(r,e){const t=et(r);return $l.N(t.he,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CS(r){let e=0;for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e++;return e}function cc(r,e){for(const t in r)Object.prototype.hasOwnProperty.call(r,t)&&e(t,r[t])}function pD(r,e){const t=[];for(const n in r)Object.prototype.hasOwnProperty.call(r,n)&&t.push(e(r[n],n,r));return t}function $k(r){for(const e in r)if(Object.prototype.hasOwnProperty.call(r,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nn{constructor(e,t){this.comparator=e,this.root=t||Mr.EMPTY}insert(e,t){return new Nn(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,Mr.BLACK,null,null))}remove(e){return new Nn(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Mr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(n===0)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const i=this.comparator(e,n.key);if(i===0)return t+n.left.size;i<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,n)=>(e(t,n),!1))}toString(){const e=[];return this.inorderTraversal((t,n)=>(e.push(`${t}:${n}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Cp(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Cp(this.root,e,this.comparator,!1)}getReverseIterator(){return new Cp(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Cp(this.root,e,this.comparator,!0)}}class Cp{constructor(e,t,n,i){this.isReverse=i,this.nodeStack=[];let s=1;for(;!e.isEmpty();)if(s=t?n(e.key,t):1,t&&i&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Mr{constructor(e,t,n,i,s){this.key=e,this.value=t,this.color=n??Mr.RED,this.left=i??Mr.EMPTY,this.right=s??Mr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,i,s){return new Mr(e??this.key,t??this.value,n??this.color,i??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let i=this;const s=n(e,i.key);return i=s<0?i.copy(null,null,null,i.left.insert(e,t,n),null):s===0?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,n)),i.fixUp()}removeMin(){if(this.left.isEmpty())return Mr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,i=this;if(t(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),t(e,i.key)===0){if(i.right.isEmpty())return Mr.EMPTY;n=i.right.min(),i=i.copy(n.key,n.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Mr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Mr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ze(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ze(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ze(27949);return e+(this.isRed()?0:1)}}Mr.EMPTY=null,Mr.RED=!0,Mr.BLACK=!1;Mr.EMPTY=new class{constructor(){this.size=0}get key(){throw Ze(57766)}get value(){throw Ze(16141)}get color(){throw Ze(16727)}get left(){throw Ze(29726)}get right(){throw Ze(36894)}copy(e,t,n,i,s){return this}insert(e,t,n){return new Mr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pn{constructor(e){this.comparator=e,this.data=new Nn(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,n)=>(e(t),!1))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const i=n.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let n;for(n=t!==void 0?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new RS(this.data.getIterator())}getIteratorFrom(e){return new RS(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(n=>{t=t.add(n)}),t}isEqual(e){if(!(e instanceof pn)||this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(this.comparator(i,s)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(t=>{e.push(t)}),e}toString(){const e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){const t=new pn(this.comparator);return t.data=e,t}}class RS{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function ed(r){return r.hasNext()?r.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bi{constructor(e){this.fields=e,e.sort(Vn.comparator)}static empty(){return new Bi([])}unionWith(e){let t=new pn(Vn.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Bi(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return Sd(this.fields,e.fields,(t,n)=>t.isEqual(n))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wk extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(i){try{return atob(i)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new Wk("Invalid base64 string: "+s):s}}(e);return new Xn(t)}static fromUint8Array(e){const t=function(i){let s="";for(let o=0;o<i.length;++o)s+=String.fromCharCode(i[o]);return s}(e);return new Xn(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(t){return btoa(t)}(this.binaryString)}toUint8Array(){return function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return bt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Xn.EMPTY_BYTE_STRING=new Xn("");const gD=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ia(r){if(it(!!r,39018),typeof r=="string"){let e=0;const t=gD.exec(r);if(it(!!t,46558,{timestamp:r}),t[1]){let i=t[1];i=(i+"000000000").substr(0,9),e=Number(i)}const n=new Date(r);return{seconds:Math.floor(n.getTime()/1e3),nanos:e}}return{seconds:Rn(r.seconds),nanos:Rn(r.nanos)}}function Rn(r){return typeof r=="number"?r:typeof r=="string"?Number(r):0}function ka(r){return typeof r=="string"?Xn.fromBase64String(r):Xn.fromUint8Array(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gk="server_timestamp",Kk="__type__",Yk="__previous_value__",Zk="__local_write_time__";function bb(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[Kk])===null||t===void 0?void 0:t.stringValue)===Gk}function Cy(r){const e=r.mapValue.fields[Yk];return bb(e)?Cy(e):e}function Gf(r){const e=Ia(r.mapValue.fields[Zk].timestampValue);return new jt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yD{constructor(e,t,n,i,s,o,l,d,f,m){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=i,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=d,this.useFetchStreams=f,this.isUsingEmulator=m}}const Vg="(default)";class au{constructor(e,t){this.projectId=e,this.database=t||Vg}static empty(){return new au("","")}get isDefaultDatabase(){return this.database===Vg}isEqual(e){return e instanceof au&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wb="__type__",Qk="__max__",Ll={mapValue:{fields:{__type__:{stringValue:Qk}}}},Eb="__vector__",Pd="value",hg={nullValue:"NULL_VALUE"};function Zl(r){return"nullValue"in r?0:"booleanValue"in r?1:"integerValue"in r||"doubleValue"in r?2:"timestampValue"in r?3:"stringValue"in r?5:"bytesValue"in r?6:"referenceValue"in r?7:"geoPointValue"in r?8:"arrayValue"in r?9:"mapValue"in r?bb(r)?4:Xk(r)?9007199254740991:Ry(r)?10:11:Ze(28295,{value:r})}function Lo(r,e){if(r===e)return!0;const t=Zl(r);if(t!==Zl(e))return!1;switch(t){case 0:case 9007199254740991:return!0;case 1:return r.booleanValue===e.booleanValue;case 4:return Gf(r).isEqual(Gf(e));case 3:return function(i,s){if(typeof i.timestampValue=="string"&&typeof s.timestampValue=="string"&&i.timestampValue.length===s.timestampValue.length)return i.timestampValue===s.timestampValue;const o=Ia(i.timestampValue),l=Ia(s.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(r,e);case 5:return r.stringValue===e.stringValue;case 6:return function(i,s){return ka(i.bytesValue).isEqual(ka(s.bytesValue))}(r,e);case 7:return r.referenceValue===e.referenceValue;case 8:return function(i,s){return Rn(i.geoPointValue.latitude)===Rn(s.geoPointValue.latitude)&&Rn(i.geoPointValue.longitude)===Rn(s.geoPointValue.longitude)}(r,e);case 2:return function(i,s){if("integerValue"in i&&"integerValue"in s)return Rn(i.integerValue)===Rn(s.integerValue);if("doubleValue"in i&&"doubleValue"in s){const o=Rn(i.doubleValue),l=Rn(s.doubleValue);return o===l?qf(o)===qf(l):isNaN(o)&&isNaN(l)}return!1}(r,e);case 9:return Sd(r.arrayValue.values||[],e.arrayValue.values||[],Lo);case 10:case 11:return function(i,s){const o=i.mapValue.fields||{},l=s.mapValue.fields||{};if(CS(o)!==CS(l))return!1;for(const d in o)if(o.hasOwnProperty(d)&&(l[d]===void 0||!Lo(o[d],l[d])))return!1;return!0}(r,e);default:return Ze(52216,{left:r})}}function Kf(r,e){return(r.values||[]).find(t=>Lo(t,e))!==void 0}function Ql(r,e){if(r===e)return 0;const t=Zl(r),n=Zl(e);if(t!==n)return bt(t,n);switch(t){case 0:case 9007199254740991:return 0;case 1:return bt(r.booleanValue,e.booleanValue);case 2:return function(s,o){const l=Rn(s.integerValue||s.doubleValue),d=Rn(o.integerValue||o.doubleValue);return l<d?-1:l>d?1:l===d?0:isNaN(l)?isNaN(d)?0:-1:1}(r,e);case 3:return jS(r.timestampValue,e.timestampValue);case 4:return jS(Gf(r),Gf(e));case 5:return ix(r.stringValue,e.stringValue);case 6:return function(s,o){const l=ka(s),d=ka(o);return l.compareTo(d)}(r.bytesValue,e.bytesValue);case 7:return function(s,o){const l=s.split("/"),d=o.split("/");for(let f=0;f<l.length&&f<d.length;f++){const m=bt(l[f],d[f]);if(m!==0)return m}return bt(l.length,d.length)}(r.referenceValue,e.referenceValue);case 8:return function(s,o){const l=bt(Rn(s.latitude),Rn(o.latitude));return l!==0?l:bt(Rn(s.longitude),Rn(o.longitude))}(r.geoPointValue,e.geoPointValue);case 9:return OS(r.arrayValue,e.arrayValue);case 10:return function(s,o){var l,d,f,m;const y=s.fields||{},g=o.fields||{},_=(l=y[Pd])===null||l===void 0?void 0:l.arrayValue,E=(d=g[Pd])===null||d===void 0?void 0:d.arrayValue,x=bt(((f=_==null?void 0:_.values)===null||f===void 0?void 0:f.length)||0,((m=E==null?void 0:E.values)===null||m===void 0?void 0:m.length)||0);return x!==0?x:OS(_,E)}(r.mapValue,e.mapValue);case 11:return function(s,o){if(s===Ll.mapValue&&o===Ll.mapValue)return 0;if(s===Ll.mapValue)return 1;if(o===Ll.mapValue)return-1;const l=s.fields||{},d=Object.keys(l),f=o.fields||{},m=Object.keys(f);d.sort(),m.sort();for(let y=0;y<d.length&&y<m.length;++y){const g=ix(d[y],m[y]);if(g!==0)return g;const _=Ql(l[d[y]],f[m[y]]);if(_!==0)return _}return bt(d.length,m.length)}(r.mapValue,e.mapValue);default:throw Ze(23264,{Pe:t})}}function jS(r,e){if(typeof r=="string"&&typeof e=="string"&&r.length===e.length)return bt(r,e);const t=Ia(r),n=Ia(e),i=bt(t.seconds,n.seconds);return i!==0?i:bt(t.nanos,n.nanos)}function OS(r,e){const t=r.values||[],n=e.values||[];for(let i=0;i<t.length&&i<n.length;++i){const s=Ql(t[i],n[i]);if(s)return s}return bt(t.length,n.length)}function Cd(r){return dx(r)}function dx(r){return"nullValue"in r?"null":"booleanValue"in r?""+r.booleanValue:"integerValue"in r?""+r.integerValue:"doubleValue"in r?""+r.doubleValue:"timestampValue"in r?function(t){const n=Ia(t);return`time(${n.seconds},${n.nanos})`}(r.timestampValue):"stringValue"in r?r.stringValue:"bytesValue"in r?function(t){return ka(t).toBase64()}(r.bytesValue):"referenceValue"in r?function(t){return He.fromName(t).toString()}(r.referenceValue):"geoPointValue"in r?function(t){return`geo(${t.latitude},${t.longitude})`}(r.geoPointValue):"arrayValue"in r?function(t){let n="[",i=!0;for(const s of t.values||[])i?i=!1:n+=",",n+=dx(s);return n+"]"}(r.arrayValue):"mapValue"in r?function(t){const n=Object.keys(t.fields||{}).sort();let i="{",s=!0;for(const o of n)s?s=!1:i+=",",i+=`${o}:${dx(t.fields[o])}`;return i+"}"}(r.mapValue):Ze(61005,{value:r})}function fg(r){switch(Zl(r)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Cy(r);return e?16+fg(e):16;case 5:return 2*r.stringValue.length;case 6:return ka(r.bytesValue).approximateByteSize();case 7:return r.referenceValue.length;case 9:return function(n){return(n.values||[]).reduce((i,s)=>i+fg(s),0)}(r.arrayValue);case 10:case 11:return function(n){let i=0;return cc(n.fields,(s,o)=>{i+=s.length+fg(o)}),i}(r.mapValue);default:throw Ze(13486,{value:r})}}function Yf(r,e){return{referenceValue:`projects/${r.projectId}/databases/${r.database}/documents/${e.path.canonicalString()}`}}function hx(r){return!!r&&"integerValue"in r}function Zf(r){return!!r&&"arrayValue"in r}function MS(r){return!!r&&"nullValue"in r}function DS(r){return!!r&&"doubleValue"in r&&isNaN(Number(r.doubleValue))}function mg(r){return!!r&&"mapValue"in r}function Ry(r){var e,t;return((t=(((e=r==null?void 0:r.mapValue)===null||e===void 0?void 0:e.fields)||{})[wb])===null||t===void 0?void 0:t.stringValue)===Eb}function Nf(r){if(r.geoPointValue)return{geoPointValue:Object.assign({},r.geoPointValue)};if(r.timestampValue&&typeof r.timestampValue=="object")return{timestampValue:Object.assign({},r.timestampValue)};if(r.mapValue){const e={mapValue:{fields:{}}};return cc(r.mapValue.fields,(t,n)=>e.mapValue.fields[t]=Nf(n)),e}if(r.arrayValue){const e={arrayValue:{values:[]}};for(let t=0;t<(r.arrayValue.values||[]).length;++t)e.arrayValue.values[t]=Nf(r.arrayValue.values[t]);return e}return Object.assign({},r)}function Xk(r){return(((r.mapValue||{}).fields||{}).__type__||{}).stringValue===Qk}const Jk={mapValue:{fields:{[wb]:{stringValue:Eb},[Pd]:{arrayValue:{}}}}};function vD(r){return"nullValue"in r?hg:"booleanValue"in r?{booleanValue:!1}:"integerValue"in r||"doubleValue"in r?{doubleValue:NaN}:"timestampValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in r?{stringValue:""}:"bytesValue"in r?{bytesValue:""}:"referenceValue"in r?Yf(au.empty(),He.empty()):"geoPointValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in r?{arrayValue:{}}:"mapValue"in r?Ry(r)?Jk:{mapValue:{}}:Ze(35942,{value:r})}function _D(r){return"nullValue"in r?{booleanValue:!1}:"booleanValue"in r?{doubleValue:NaN}:"integerValue"in r||"doubleValue"in r?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in r?{stringValue:""}:"stringValue"in r?{bytesValue:""}:"bytesValue"in r?Yf(au.empty(),He.empty()):"referenceValue"in r?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in r?{arrayValue:{}}:"arrayValue"in r?Jk:"mapValue"in r?Ry(r)?{mapValue:{}}:Ll:Ze(61959,{value:r})}function LS(r,e){const t=Ql(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?-1:!r.inclusive&&e.inclusive?1:0}function FS(r,e){const t=Ql(r.value,e.value);return t!==0?t:r.inclusive&&!e.inclusive?1:!r.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zr{constructor(e){this.value=e}static empty(){return new Zr({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!mg(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=Nf(t)}setAll(e){let t=Vn.emptyPath(),n={},i=[];e.forEach((o,l)=>{if(!t.isImmediateParentOf(l)){const d=this.getFieldsMap(t);this.applyChanges(d,n,i),n={},i=[],t=l.popLast()}o?n[l.lastSegment()]=Nf(o):i.push(l.lastSegment())});const s=this.getFieldsMap(t);this.applyChanges(s,n,i)}delete(e){const t=this.field(e.popLast());mg(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Lo(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let i=t.mapValue.fields[e.get(n)];mg(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,n){cc(t,(i,s)=>e[i]=s);for(const i of n)delete e[i]}clone(){return new Zr(Nf(this.value))}}function eP(r){const e=[];return cc(r.fields,(t,n)=>{const i=new Vn([t]);if(mg(n)){const s=eP(n.mapValue).fields;if(s.length===0)e.push(i);else for(const o of s)e.push(i.child(o))}else e.push(i)}),new Bi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hn{constructor(e,t,n,i,s,o,l){this.key=e,this.documentType=t,this.version=n,this.readTime=i,this.createTime=s,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Hn(e,0,ct.min(),ct.min(),ct.min(),Zr.empty(),0)}static newFoundDocument(e,t,n,i){return new Hn(e,1,t,ct.min(),n,i,0)}static newNoDocument(e,t){return new Hn(e,2,t,ct.min(),ct.min(),Zr.empty(),0)}static newUnknownDocument(e,t){return new Hn(e,3,t,ct.min(),ct.min(),Zr.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(ct.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Zr.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Zr.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=ct.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Hn&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Hn(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rd{constructor(e,t){this.position=e,this.inclusive=t}}function VS(r,e,t){let n=0;for(let i=0;i<r.position.length;i++){const s=e[i],o=r.position[i];if(s.field.isKeyField()?n=He.comparator(He.fromName(o.referenceValue),t.key):n=Ql(o,t.data.field(s.field)),s.dir==="desc"&&(n*=-1),n!==0)break}return n}function zS(r,e){if(r===null)return e===null;if(e===null||r.inclusive!==e.inclusive||r.position.length!==e.position.length)return!1;for(let t=0;t<r.position.length;t++)if(!Lo(r.position[t],e.position[t]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qf{constructor(e,t="asc"){this.field=e,this.dir=t}}function xD(r,e){return r.dir===e.dir&&r.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let tP=class{};class qt extends tP{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?t==="in"||t==="not-in"?this.createKeyFieldInFilter(e,t,n):new bD(e,t,n):t==="array-contains"?new SD(e,n):t==="in"?new aP(e,n):t==="not-in"?new TD(e,n):t==="array-contains-any"?new AD(e,n):new qt(e,t,n)}static createKeyFieldInFilter(e,t,n){return t==="in"?new wD(e,n):new ED(e,n)}matches(e){const t=e.data.field(this.field);return this.op==="!="?t!==null&&t.nullValue===void 0&&this.matchesComparison(Ql(t,this.value)):t!==null&&Zl(this.value)===Zl(t)&&this.matchesComparison(Ql(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ze(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class mn extends tP{constructor(e,t){super(),this.filters=e,this.op=t,this.Te=null}static create(e,t){return new mn(e,t)}matches(e){return jd(this)?this.filters.find(t=>!t.matches(e))===void 0:this.filters.find(t=>t.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function jd(r){return r.op==="and"}function fx(r){return r.op==="or"}function Sb(r){return nP(r)&&jd(r)}function nP(r){for(const e of r.filters)if(e instanceof mn)return!1;return!0}function mx(r){if(r instanceof qt)return r.field.canonicalString()+r.op.toString()+Cd(r.value);if(Sb(r))return r.filters.map(e=>mx(e)).join(",");{const e=r.filters.map(t=>mx(t)).join(",");return`${r.op}(${e})`}}function rP(r,e){return r instanceof qt?function(n,i){return i instanceof qt&&n.op===i.op&&n.field.isEqual(i.field)&&Lo(n.value,i.value)}(r,e):r instanceof mn?function(n,i){return i instanceof mn&&n.op===i.op&&n.filters.length===i.filters.length?n.filters.reduce((s,o,l)=>s&&rP(o,i.filters[l]),!0):!1}(r,e):void Ze(19439)}function iP(r,e){const t=r.filters.concat(e);return mn.create(t,r.op)}function sP(r){return r instanceof qt?function(t){return`${t.field.canonicalString()} ${t.op} ${Cd(t.value)}`}(r):r instanceof mn?function(t){return t.op.toString()+" {"+t.getFilters().map(sP).join(" ,")+"}"}(r):"Filter"}class bD extends qt{constructor(e,t,n){super(e,t,n),this.key=He.fromName(n.referenceValue)}matches(e){const t=He.comparator(e.key,this.key);return this.matchesComparison(t)}}class wD extends qt{constructor(e,t){super(e,"in",t),this.keys=oP("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class ED extends qt{constructor(e,t){super(e,"not-in",t),this.keys=oP("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function oP(r,e){var t;return(((t=e.arrayValue)===null||t===void 0?void 0:t.values)||[]).map(n=>He.fromName(n.referenceValue))}class SD extends qt{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Zf(t)&&Kf(t.arrayValue,this.value)}}class aP extends qt{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return t!==null&&Kf(this.value.arrayValue,t)}}class TD extends qt{constructor(e,t){super(e,"not-in",t)}matches(e){if(Kf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return t!==null&&t.nullValue===void 0&&!Kf(this.value.arrayValue,t)}}class AD extends qt{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Zf(t)||!t.arrayValue.values)&&t.arrayValue.values.some(n=>Kf(this.value.arrayValue,n))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ND{constructor(e,t=null,n=[],i=[],s=null,o=null,l=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=i,this.limit=s,this.startAt=o,this.endAt=l,this.Ie=null}}function px(r,e=null,t=[],n=[],i=null,s=null,o=null){return new ND(r,e,t,n,i,s,o)}function lu(r){const e=et(r);if(e.Ie===null){let t=e.path.canonicalString();e.collectionGroup!==null&&(t+="|cg:"+e.collectionGroup),t+="|f:",t+=e.filters.map(n=>mx(n)).join(","),t+="|ob:",t+=e.orderBy.map(n=>function(s){return s.field.canonicalString()+s.dir}(n)).join(","),Ny(e.limit)||(t+="|l:",t+=e.limit),e.startAt&&(t+="|lb:",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(n=>Cd(n)).join(",")),e.endAt&&(t+="|ub:",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(n=>Cd(n)).join(",")),e.Ie=t}return e.Ie}function vm(r,e){if(r.limit!==e.limit||r.orderBy.length!==e.orderBy.length)return!1;for(let t=0;t<r.orderBy.length;t++)if(!xD(r.orderBy[t],e.orderBy[t]))return!1;if(r.filters.length!==e.filters.length)return!1;for(let t=0;t<r.filters.length;t++)if(!rP(r.filters[t],e.filters[t]))return!1;return r.collectionGroup===e.collectionGroup&&!!r.path.isEqual(e.path)&&!!zS(r.startAt,e.startAt)&&zS(r.endAt,e.endAt)}function zg(r){return He.isDocumentKey(r.path)&&r.collectionGroup===null&&r.filters.length===0}function Bg(r,e){return r.filters.filter(t=>t instanceof qt&&t.field.isEqual(e))}function BS(r,e,t){let n=hg,i=!0;for(const s of Bg(r,e)){let o=hg,l=!0;switch(s.op){case"<":case"<=":o=vD(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,l=!1;break;case"!=":case"not-in":o=hg}LS({value:n,inclusive:i},{value:o,inclusive:l})<0&&(n=o,i=l)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){const o=t.position[s];LS({value:n,inclusive:i},{value:o,inclusive:t.inclusive})<0&&(n=o,i=t.inclusive);break}}return{value:n,inclusive:i}}function US(r,e,t){let n=Ll,i=!0;for(const s of Bg(r,e)){let o=Ll,l=!0;switch(s.op){case">=":case">":o=_D(s.value),l=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,l=!1;break;case"!=":case"not-in":o=Ll}FS({value:n,inclusive:i},{value:o,inclusive:l})>0&&(n=o,i=l)}if(t!==null){for(let s=0;s<r.orderBy.length;++s)if(r.orderBy[s].field.isEqual(e)){const o=t.position[s];FS({value:n,inclusive:i},{value:o,inclusive:t.inclusive})>0&&(n=o,i=t.inclusive);break}}return{value:n,inclusive:i}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kd{constructor(e,t=null,n=[],i=[],s=null,o="F",l=null,d=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=i,this.limit=s,this.limitType=o,this.startAt=l,this.endAt=d,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function lP(r,e,t,n,i,s,o,l){return new Kd(r,e,t,n,i,s,o,l)}function _m(r){return new Kd(r)}function qS(r){return r.filters.length===0&&r.limit===null&&r.startAt==null&&r.endAt==null&&(r.explicitOrderBy.length===0||r.explicitOrderBy.length===1&&r.explicitOrderBy[0].field.isKeyField())}function cP(r){return r.collectionGroup!==null}function If(r){const e=et(r);if(e.Ee===null){e.Ee=[];const t=new Set;for(const s of e.explicitOrderBy)e.Ee.push(s),t.add(s.field.canonicalString());const n=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new pn(Vn.comparator);return o.filters.forEach(d=>{d.getFlattenedFilters().forEach(f=>{f.isInequality()&&(l=l.add(f.field))})}),l})(e).forEach(s=>{t.has(s.canonicalString())||s.isKeyField()||e.Ee.push(new Qf(s,n))}),t.has(Vn.keyField().canonicalString())||e.Ee.push(new Qf(Vn.keyField(),n))}return e.Ee}function is(r){const e=et(r);return e.de||(e.de=uP(e,If(r))),e.de}function ID(r){const e=et(r);return e.Ae||(e.Ae=uP(e,r.explicitOrderBy)),e.Ae}function uP(r,e){if(r.limitType==="F")return px(r.path,r.collectionGroup,e,r.filters,r.limit,r.startAt,r.endAt);{e=e.map(i=>{const s=i.dir==="desc"?"asc":"desc";return new Qf(i.field,s)});const t=r.endAt?new Rd(r.endAt.position,r.endAt.inclusive):null,n=r.startAt?new Rd(r.startAt.position,r.startAt.inclusive):null;return px(r.path,r.collectionGroup,e,r.filters,r.limit,t,n)}}function gx(r,e){const t=r.filters.concat([e]);return new Kd(r.path,r.collectionGroup,r.explicitOrderBy.slice(),t,r.limit,r.limitType,r.startAt,r.endAt)}function Ug(r,e,t){return new Kd(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),e,t,r.startAt,r.endAt)}function jy(r,e){return vm(is(r),is(e))&&r.limitType===e.limitType}function dP(r){return`${lu(is(r))}|lt:${r.limitType}`}function ud(r){return`Query(target=${function(t){let n=t.path.canonicalString();return t.collectionGroup!==null&&(n+=" collectionGroup="+t.collectionGroup),t.filters.length>0&&(n+=`, filters: [${t.filters.map(i=>sP(i)).join(", ")}]`),Ny(t.limit)||(n+=", limit: "+t.limit),t.orderBy.length>0&&(n+=`, orderBy: [${t.orderBy.map(i=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(i)).join(", ")}]`),t.startAt&&(n+=", startAt: ",n+=t.startAt.inclusive?"b:":"a:",n+=t.startAt.position.map(i=>Cd(i)).join(",")),t.endAt&&(n+=", endAt: ",n+=t.endAt.inclusive?"a:":"b:",n+=t.endAt.position.map(i=>Cd(i)).join(",")),`Target(${n})`}(is(r))}; limitType=${r.limitType})`}function xm(r,e){return e.isFoundDocument()&&function(n,i){const s=i.key.path;return n.collectionGroup!==null?i.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(s):He.isDocumentKey(n.path)?n.path.isEqual(s):n.path.isImmediateParentOf(s)}(r,e)&&function(n,i){for(const s of If(n))if(!s.field.isKeyField()&&i.data.field(s.field)===null)return!1;return!0}(r,e)&&function(n,i){for(const s of n.filters)if(!s.matches(i))return!1;return!0}(r,e)&&function(n,i){return!(n.startAt&&!function(o,l,d){const f=VS(o,l,d);return o.inclusive?f<=0:f<0}(n.startAt,If(n),i)||n.endAt&&!function(o,l,d){const f=VS(o,l,d);return o.inclusive?f>=0:f>0}(n.endAt,If(n),i))}(r,e)}function hP(r){return r.collectionGroup||(r.path.length%2==1?r.path.lastSegment():r.path.get(r.path.length-2))}function fP(r){return(e,t)=>{let n=!1;for(const i of If(r)){const s=kD(i,e,t);if(s!==0)return s;n=n||i.field.isKeyField()}return 0}}function kD(r,e,t){const n=r.field.isKeyField()?He.comparator(e.key,t.key):function(s,o,l){const d=o.data.field(s),f=l.data.field(s);return d!==null&&f!==null?Ql(d,f):Ze(42886)}(r.field,e,t);switch(r.dir){case"asc":return n;case"desc":return-1*n;default:return Ze(19790,{direction:r.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oa{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n!==void 0){for(const[i,s]of n)if(this.equalsFn(i,e))return s}}has(e){return this.get(e)!==void 0}set(e,t){const n=this.mapKeyFn(e),i=this.inner[n];if(i===void 0)return this.inner[n]=[[e,t]],void this.innerSize++;for(let s=0;s<i.length;s++)if(this.equalsFn(i[s][0],e))return void(i[s]=[e,t]);i.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(n===void 0)return!1;for(let i=0;i<n.length;i++)if(this.equalsFn(n[i][0],e))return n.length===1?delete this.inner[t]:n.splice(i,1),this.innerSize--,!0;return!1}forEach(e){cc(this.inner,(t,n)=>{for(const[i,s]of n)e(i,s)})}isEmpty(){return $k(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PD=new Nn(He.comparator);function rs(){return PD}const mP=new Nn(He.comparator);function uf(...r){let e=mP;for(const t of r)e=e.insert(t.key,t);return e}function pP(r){let e=mP;return r.forEach((t,n)=>e=e.insert(t,n.overlayedDocument)),e}function Ro(){return kf()}function gP(){return kf()}function kf(){return new Oa(r=>r.toString(),(r,e)=>r.isEqual(e))}const CD=new Nn(He.comparator),RD=new pn(He.comparator);function Lt(...r){let e=RD;for(const t of r)e=e.add(t);return e}const jD=new pn(bt);function Tb(){return jD}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ab(r,e){if(r.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:qf(e)?"-0":e}}function yP(r){return{integerValue:""+r}}function OD(r,e){return Ok(e)?yP(e):Ab(r,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oy{constructor(){this._=void 0}}function MD(r,e,t){return r instanceof Od?function(i,s){const o={fields:{[Kk]:{stringValue:Gk},[Zk]:{timestampValue:{seconds:i.seconds,nanos:i.nanoseconds}}}};return s&&bb(s)&&(s=Cy(s)),s&&(o.fields[Yk]=s),{mapValue:o}}(t,e):r instanceof cu?_P(r,e):r instanceof Md?xP(r,e):function(i,s){const o=vP(i,s),l=HS(o)+HS(i.Re);return hx(o)&&hx(i.Re)?yP(l):Ab(i.serializer,l)}(r,e)}function DD(r,e,t){return r instanceof cu?_P(r,e):r instanceof Md?xP(r,e):t}function vP(r,e){return r instanceof Xf?function(n){return hx(n)||function(s){return!!s&&"doubleValue"in s}(n)}(e)?e:{integerValue:0}:null}class Od extends Oy{}class cu extends Oy{constructor(e){super(),this.elements=e}}function _P(r,e){const t=bP(e);for(const n of r.elements)t.some(i=>Lo(i,n))||t.push(n);return{arrayValue:{values:t}}}class Md extends Oy{constructor(e){super(),this.elements=e}}function xP(r,e){let t=bP(e);for(const n of r.elements)t=t.filter(i=>!Lo(i,n));return{arrayValue:{values:t}}}class Xf extends Oy{constructor(e,t){super(),this.serializer=e,this.Re=t}}function HS(r){return Rn(r.integerValue||r.doubleValue)}function bP(r){return Zf(r)&&r.arrayValue.values?r.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nb{constructor(e,t){this.field=e,this.transform=t}}function LD(r,e){return r.field.isEqual(e.field)&&function(n,i){return n instanceof cu&&i instanceof cu||n instanceof Md&&i instanceof Md?Sd(n.elements,i.elements,Lo):n instanceof Xf&&i instanceof Xf?Lo(n.Re,i.Re):n instanceof Od&&i instanceof Od}(r.transform,e.transform)}class FD{constructor(e,t){this.version=e,this.transformResults=t}}class fr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new fr}static exists(e){return new fr(void 0,e)}static updateTime(e){return new fr(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function pg(r,e){return r.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(r.updateTime):r.exists===void 0||r.exists===e.isFoundDocument()}class My{}function wP(r,e){if(!r.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return r.isNoDocument()?new bm(r.key,fr.none()):new Yd(r.key,r.data,fr.none());{const t=r.data,n=Zr.empty();let i=new pn(Vn.comparator);for(let s of e.fields)if(!i.has(s)){let o=t.field(s);o===null&&s.length>1&&(s=s.popLast(),o=t.field(s)),o===null?n.delete(s):n.set(s,o),i=i.add(s)}return new Ma(r.key,n,new Bi(i.toArray()),fr.none())}}function VD(r,e,t){r instanceof Yd?function(i,s,o){const l=i.value.clone(),d=WS(i.fieldTransforms,s,o.transformResults);l.setAll(d),s.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(r,e,t):r instanceof Ma?function(i,s,o){if(!pg(i.precondition,s))return void s.convertToUnknownDocument(o.version);const l=WS(i.fieldTransforms,s,o.transformResults),d=s.data;d.setAll(EP(i)),d.setAll(l),s.convertToFoundDocument(o.version,d).setHasCommittedMutations()}(r,e,t):function(i,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,t)}function Pf(r,e,t,n){return r instanceof Yd?function(s,o,l,d){if(!pg(s.precondition,o))return l;const f=s.value.clone(),m=GS(s.fieldTransforms,d,o);return f.setAll(m),o.convertToFoundDocument(o.version,f).setHasLocalMutations(),null}(r,e,t,n):r instanceof Ma?function(s,o,l,d){if(!pg(s.precondition,o))return l;const f=GS(s.fieldTransforms,d,o),m=o.data;return m.setAll(EP(s)),m.setAll(f),o.convertToFoundDocument(o.version,m).setHasLocalMutations(),l===null?null:l.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(y=>y.field))}(r,e,t,n):function(s,o,l){return pg(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(r,e,t)}function zD(r,e){let t=null;for(const n of r.fieldTransforms){const i=e.data.field(n.field),s=vP(n.transform,i||null);s!=null&&(t===null&&(t=Zr.empty()),t.set(n.field,s))}return t||null}function $S(r,e){return r.type===e.type&&!!r.key.isEqual(e.key)&&!!r.precondition.isEqual(e.precondition)&&!!function(n,i){return n===void 0&&i===void 0||!(!n||!i)&&Sd(n,i,(s,o)=>LD(s,o))}(r.fieldTransforms,e.fieldTransforms)&&(r.type===0?r.value.isEqual(e.value):r.type!==1||r.data.isEqual(e.data)&&r.fieldMask.isEqual(e.fieldMask))}class Yd extends My{constructor(e,t,n,i=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}class Ma extends My{constructor(e,t,n,i,s=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=i,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}}function EP(r){const e=new Map;return r.fieldMask.fields.forEach(t=>{if(!t.isEmpty()){const n=r.data.field(t);e.set(t,n)}}),e}function WS(r,e,t){const n=new Map;it(r.length===t.length,32656,{Ve:t.length,me:r.length});for(let i=0;i<t.length;i++){const s=r[i],o=s.transform,l=e.data.field(s.field);n.set(s.field,DD(o,l,t[i]))}return n}function GS(r,e,t){const n=new Map;for(const i of r){const s=i.transform,o=t.data.field(i.field);n.set(i.field,MD(s,o,e))}return n}class bm extends My{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class SP extends My{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ib{constructor(e,t,n,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=i}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let i=0;i<this.mutations.length;i++){const s=this.mutations[i];s.key.isEqual(e.key)&&VD(s,e,n[i])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Pf(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Pf(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=gP();return this.mutations.forEach(i=>{const s=e.get(i.key),o=s.overlayedDocument;let l=this.applyToLocalView(o,s.mutatedFields);l=t.has(i.key)?null:l;const d=wP(o,l);d!==null&&n.set(i.key,d),o.isValidDocument()||o.convertToNoDocument(ct.min())}),n}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),Lt())}isEqual(e){return this.batchId===e.batchId&&Sd(this.mutations,e.mutations,(t,n)=>$S(t,n))&&Sd(this.baseMutations,e.baseMutations,(t,n)=>$S(t,n))}}class kb{constructor(e,t,n,i){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=i}static from(e,t,n){it(e.mutations.length===n.length,58842,{fe:e.mutations.length,ge:n.length});let i=function(){return CD}();const s=e.mutations;for(let o=0;o<s.length;o++)i=i.insert(s[o].key,n[o].version);return new kb(e,t,n,i)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BD{constructor(e,t,n){this.alias=e,this.aggregateType=t,this.fieldPath=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UD{constructor(e,t){this.count=e,this.unchangedNames=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var or,Wt;function qD(r){switch(r){case Ie.OK:return Ze(64938);case Ie.CANCELLED:case Ie.UNKNOWN:case Ie.DEADLINE_EXCEEDED:case Ie.RESOURCE_EXHAUSTED:case Ie.INTERNAL:case Ie.UNAVAILABLE:case Ie.UNAUTHENTICATED:return!1;case Ie.INVALID_ARGUMENT:case Ie.NOT_FOUND:case Ie.ALREADY_EXISTS:case Ie.PERMISSION_DENIED:case Ie.FAILED_PRECONDITION:case Ie.ABORTED:case Ie.OUT_OF_RANGE:case Ie.UNIMPLEMENTED:case Ie.DATA_LOSS:return!0;default:return Ze(15467,{code:r})}}function TP(r){if(r===void 0)return Zn("GRPC error has no .code"),Ie.UNKNOWN;switch(r){case or.OK:return Ie.OK;case or.CANCELLED:return Ie.CANCELLED;case or.UNKNOWN:return Ie.UNKNOWN;case or.DEADLINE_EXCEEDED:return Ie.DEADLINE_EXCEEDED;case or.RESOURCE_EXHAUSTED:return Ie.RESOURCE_EXHAUSTED;case or.INTERNAL:return Ie.INTERNAL;case or.UNAVAILABLE:return Ie.UNAVAILABLE;case or.UNAUTHENTICATED:return Ie.UNAUTHENTICATED;case or.INVALID_ARGUMENT:return Ie.INVALID_ARGUMENT;case or.NOT_FOUND:return Ie.NOT_FOUND;case or.ALREADY_EXISTS:return Ie.ALREADY_EXISTS;case or.PERMISSION_DENIED:return Ie.PERMISSION_DENIED;case or.FAILED_PRECONDITION:return Ie.FAILED_PRECONDITION;case or.ABORTED:return Ie.ABORTED;case or.OUT_OF_RANGE:return Ie.OUT_OF_RANGE;case or.UNIMPLEMENTED:return Ie.UNIMPLEMENTED;case or.DATA_LOSS:return Ie.DATA_LOSS;default:return Ze(39323,{code:r})}}(Wt=or||(or={}))[Wt.OK=0]="OK",Wt[Wt.CANCELLED=1]="CANCELLED",Wt[Wt.UNKNOWN=2]="UNKNOWN",Wt[Wt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Wt[Wt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Wt[Wt.NOT_FOUND=5]="NOT_FOUND",Wt[Wt.ALREADY_EXISTS=6]="ALREADY_EXISTS",Wt[Wt.PERMISSION_DENIED=7]="PERMISSION_DENIED",Wt[Wt.UNAUTHENTICATED=16]="UNAUTHENTICATED",Wt[Wt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Wt[Wt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Wt[Wt.ABORTED=10]="ABORTED",Wt[Wt.OUT_OF_RANGE=11]="OUT_OF_RANGE",Wt[Wt.UNIMPLEMENTED=12]="UNIMPLEMENTED",Wt[Wt.INTERNAL=13]="INTERNAL",Wt[Wt.UNAVAILABLE=14]="UNAVAILABLE",Wt[Wt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HD=new Hl([4294967295,4294967295],0);function KS(r){const e=Ak().encode(r),t=new vk;return t.update(e),new Uint8Array(t.digest())}function YS(r){const e=new DataView(r.buffer),t=e.getUint32(0,!0),n=e.getUint32(4,!0),i=e.getUint32(8,!0),s=e.getUint32(12,!0);return[new Hl([t,n],0),new Hl([i,s],0)]}class Cb{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new df(`Invalid padding: ${t}`);if(n<0)throw new df(`Invalid hash count: ${n}`);if(e.length>0&&this.hashCount===0)throw new df(`Invalid hash count: ${n}`);if(e.length===0&&t!==0)throw new df(`Invalid padding when bitmap length is 0: ${t}`);this.pe=8*e.length-t,this.ye=Hl.fromNumber(this.pe)}we(e,t,n){let i=e.add(t.multiply(Hl.fromNumber(n)));return i.compare(HD)===1&&(i=new Hl([i.getBits(0),i.getBits(1)],0)),i.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const t=KS(e),[n,i]=YS(t);for(let s=0;s<this.hashCount;s++){const o=this.we(n,i,s);if(!this.be(o))return!1}return!0}static create(e,t,n){const i=e%8==0?0:8-e%8,s=new Uint8Array(Math.ceil(e/8)),o=new Cb(s,i,t);return n.forEach(l=>o.insert(l)),o}insert(e){if(this.pe===0)return;const t=KS(e),[n,i]=YS(t);for(let s=0;s<this.hashCount;s++){const o=this.we(n,i,s);this.Se(o)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class df extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wm{constructor(e,t,n,i,s){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=i,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const i=new Map;return i.set(e,Em.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new wm(ct.min(),i,new Nn(bt),rs(),Lt())}}class Em{constructor(e,t,n,i,s){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=i,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Em(n,t,Lt(),Lt(),Lt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gg{constructor(e,t,n,i){this.De=e,this.removedTargetIds=t,this.key=n,this.ve=i}}class AP{constructor(e,t){this.targetId=e,this.Ce=t}}class NP{constructor(e,t,n=Xn.EMPTY_BYTE_STRING,i=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=i}}class ZS{constructor(){this.Fe=0,this.Me=QS(),this.xe=Xn.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Lt(),t=Lt(),n=Lt();return this.Me.forEach((i,s)=>{switch(s){case 0:e=e.add(i);break;case 2:t=t.add(i);break;case 1:n=n.add(i);break;default:Ze(38017,{changeType:s})}}),new Em(this.xe,this.Oe,e,t,n)}Qe(){this.Ne=!1,this.Me=QS()}$e(e,t){this.Ne=!0,this.Me=this.Me.insert(e,t)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,it(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class $D{constructor(e){this.ze=e,this.je=new Map,this.He=rs(),this.Je=Rp(),this.Ye=Rp(),this.Ze=new Nn(bt)}Xe(e){for(const t of e.De)e.ve&&e.ve.isFoundDocument()?this.et(t,e.ve):this.tt(t,e.key,e.ve);for(const t of e.removedTargetIds)this.tt(t,e.key,e.ve)}nt(e){this.forEachTarget(e,t=>{const n=this.rt(t);switch(e.state){case 0:this.it(t)&&n.ke(e.resumeToken);break;case 1:n.We(),n.Be||n.Qe(),n.ke(e.resumeToken);break;case 2:n.We(),n.Be||this.removeTarget(t);break;case 3:this.it(t)&&(n.Ge(),n.ke(e.resumeToken));break;case 4:this.it(t)&&(this.st(t),n.ke(e.resumeToken));break;default:Ze(56790,{state:e.state})}})}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.je.forEach((n,i)=>{this.it(i)&&t(i)})}ot(e){const t=e.targetId,n=e.Ce.count,i=this._t(t);if(i){const s=i.target;if(zg(s))if(n===0){const o=new He(s.path);this.tt(t,o,Hn.newNoDocument(o,ct.min()))}else it(n===1,20013,{expectedCount:n});else{const o=this.ut(t);if(o!==n){const l=this.ct(e),d=l?this.lt(l,e,o):1;if(d!==0){this.st(t);const f=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(t,f)}}}}}ct(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:i=0},hashCount:s=0}=t;let o,l;try{o=ka(n).toUint8Array()}catch(d){if(d instanceof Wk)return ou("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{l=new Cb(o,i,s)}catch(d){return ou(d instanceof df?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return l.pe===0?null:l}lt(e,t,n){return t.Ce.count===n-this.Tt(e,t.targetId)?0:2}Tt(e,t){const n=this.ze.getRemoteKeysForTarget(t);let i=0;return n.forEach(s=>{const o=this.ze.Pt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;e.mightContain(l)||(this.tt(t,s,null),i++)}),i}It(e){const t=new Map;this.je.forEach((s,o)=>{const l=this._t(o);if(l){if(s.current&&zg(l.target)){const d=new He(l.target.path);this.Et(d).has(o)||this.dt(o,d)||this.tt(o,d,Hn.newNoDocument(d,e))}s.Le&&(t.set(o,s.qe()),s.Qe())}});let n=Lt();this.Ye.forEach((s,o)=>{let l=!0;o.forEachWhile(d=>{const f=this._t(d);return!f||f.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(n=n.add(s))}),this.He.forEach((s,o)=>o.setReadTime(e));const i=new wm(e,t,this.Ze,this.He,n);return this.He=rs(),this.Je=Rp(),this.Ye=Rp(),this.Ze=new Nn(bt),i}et(e,t){if(!this.it(e))return;const n=this.dt(e,t.key)?2:0;this.rt(e).$e(t.key,n),this.He=this.He.insert(t.key,t),this.Je=this.Je.insert(t.key,this.Et(t.key).add(e)),this.Ye=this.Ye.insert(t.key,this.At(t.key).add(e))}tt(e,t,n){if(!this.it(e))return;const i=this.rt(e);this.dt(e,t)?i.$e(t,1):i.Ue(t),this.Ye=this.Ye.insert(t,this.At(t).delete(e)),this.Ye=this.Ye.insert(t,this.At(t).add(e)),n&&(this.He=this.He.insert(t,n))}removeTarget(e){this.je.delete(e)}ut(e){const t=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let t=this.je.get(e);return t||(t=new ZS,this.je.set(e,t)),t}At(e){let t=this.Ye.get(e);return t||(t=new pn(bt),this.Ye=this.Ye.insert(e,t)),t}Et(e){let t=this.Je.get(e);return t||(t=new pn(bt),this.Je=this.Je.insert(e,t)),t}it(e){const t=this._t(e)!==null;return t||Re("WatchChangeAggregator","Detected inactive target",e),t}_t(e){const t=this.je.get(e);return t&&t.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new ZS),this.ze.getRemoteKeysForTarget(e).forEach(t=>{this.tt(e,t,null)})}dt(e,t){return this.ze.getRemoteKeysForTarget(e).has(t)}}function Rp(){return new Nn(He.comparator)}function QS(){return new Nn(He.comparator)}const WD={asc:"ASCENDING",desc:"DESCENDING"},GD={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},KD={and:"AND",or:"OR"};class YD{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function yx(r,e){return r.useProto3Json||Ny(e)?e:{value:e}}function Dd(r,e){return r.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function IP(r,e){return r.useProto3Json?e.toBase64():e.toUint8Array()}function ZD(r,e){return Dd(r,e.toTimestamp())}function fi(r){return it(!!r,49232),ct.fromTimestamp(function(t){const n=Ia(t);return new jt(n.seconds,n.nanos)}(r))}function Rb(r,e){return vx(r,e).canonicalString()}function vx(r,e){const t=function(i){return new sn(["projects",i.projectId,"databases",i.database])}(r).child("documents");return e===void 0?t:t.child(e)}function kP(r){const e=sn.fromString(r);return it(LP(e),10190,{key:e.toString()}),e}function qg(r,e){return Rb(r.databaseId,e.path)}function Jc(r,e){const t=kP(e);if(t.get(1)!==r.databaseId.projectId)throw new Ue(Ie.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+t.get(1)+" vs "+r.databaseId.projectId);if(t.get(3)!==r.databaseId.database)throw new Ue(Ie.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+t.get(3)+" vs "+r.databaseId.database);return new He(RP(t))}function PP(r,e){return Rb(r.databaseId,e)}function CP(r){const e=kP(r);return e.length===4?sn.emptyPath():RP(e)}function _x(r){return new sn(["projects",r.databaseId.projectId,"databases",r.databaseId.database]).canonicalString()}function RP(r){return it(r.length>4&&r.get(4)==="documents",29091,{key:r.toString()}),r.popFirst(5)}function XS(r,e,t){return{name:qg(r,e),fields:t.value.mapValue.fields}}function QD(r,e,t){const n=Jc(r,e.name),i=fi(e.updateTime),s=e.createTime?fi(e.createTime):ct.min(),o=new Zr({mapValue:{fields:e.fields}}),l=Hn.newFoundDocument(n,i,s,o);return t&&l.setHasCommittedMutations(),t?l.setHasCommittedMutations():l}function XD(r,e){let t;if("targetChange"in e){e.targetChange;const n=function(f){return f==="NO_CHANGE"?0:f==="ADD"?1:f==="REMOVE"?2:f==="CURRENT"?3:f==="RESET"?4:Ze(39313,{state:f})}(e.targetChange.targetChangeType||"NO_CHANGE"),i=e.targetChange.targetIds||[],s=function(f,m){return f.useProto3Json?(it(m===void 0||typeof m=="string",58123),Xn.fromBase64String(m||"")):(it(m===void 0||m instanceof Buffer||m instanceof Uint8Array,16193),Xn.fromUint8Array(m||new Uint8Array))}(r,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(f){const m=f.code===void 0?Ie.UNKNOWN:TP(f.code);return new Ue(m,f.message||"")}(o);t=new NP(n,i,s,l||null)}else if("documentChange"in e){e.documentChange;const n=e.documentChange;n.document,n.document.name,n.document.updateTime;const i=Jc(r,n.document.name),s=fi(n.document.updateTime),o=n.document.createTime?fi(n.document.createTime):ct.min(),l=new Zr({mapValue:{fields:n.document.fields}}),d=Hn.newFoundDocument(i,s,o,l),f=n.targetIds||[],m=n.removedTargetIds||[];t=new gg(f,m,d.key,d)}else if("documentDelete"in e){e.documentDelete;const n=e.documentDelete;n.document;const i=Jc(r,n.document),s=n.readTime?fi(n.readTime):ct.min(),o=Hn.newNoDocument(i,s),l=n.removedTargetIds||[];t=new gg([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const n=e.documentRemove;n.document;const i=Jc(r,n.document),s=n.removedTargetIds||[];t=new gg([],s,i,null)}else{if(!("filter"in e))return Ze(11601,{Vt:e});{e.filter;const n=e.filter;n.targetId;const{count:i=0,unchangedNames:s}=n,o=new UD(i,s),l=n.targetId;t=new AP(l,o)}}return t}function Hg(r,e){let t;if(e instanceof Yd)t={update:XS(r,e.key,e.value)};else if(e instanceof bm)t={delete:qg(r,e.key)};else if(e instanceof Ma)t={update:XS(r,e.key,e.data),updateMask:s6(e.fieldMask)};else{if(!(e instanceof SP))return Ze(16599,{ft:e.type});t={verify:qg(r,e.key)}}return e.fieldTransforms.length>0&&(t.updateTransforms=e.fieldTransforms.map(n=>function(s,o){const l=o.transform;if(l instanceof Od)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof cu)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof Md)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof Xf)return{fieldPath:o.field.canonicalString(),increment:l.Re};throw Ze(20930,{transform:o.transform})}(0,n))),e.precondition.isNone||(t.currentDocument=function(i,s){return s.updateTime!==void 0?{updateTime:ZD(i,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:Ze(27497)}(r,e.precondition)),t}function xx(r,e){const t=e.currentDocument?function(s){return s.updateTime!==void 0?fr.updateTime(fi(s.updateTime)):s.exists!==void 0?fr.exists(s.exists):fr.none()}(e.currentDocument):fr.none(),n=e.updateTransforms?e.updateTransforms.map(i=>function(o,l){let d=null;if("setToServerValue"in l)it(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),d=new Od;else if("appendMissingElements"in l){const m=l.appendMissingElements.values||[];d=new cu(m)}else if("removeAllFromArray"in l){const m=l.removeAllFromArray.values||[];d=new Md(m)}else"increment"in l?d=new Xf(o,l.increment):Ze(16584,{proto:l});const f=Vn.fromServerFormat(l.fieldPath);return new Nb(f,d)}(r,i)):[];if(e.update){e.update.name;const i=Jc(r,e.update.name),s=new Zr({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(d){const f=d.fieldPaths||[];return new Bi(f.map(m=>Vn.fromServerFormat(m)))}(e.updateMask);return new Ma(i,s,o,t,n)}return new Yd(i,s,t,n)}if(e.delete){const i=Jc(r,e.delete);return new bm(i,t)}if(e.verify){const i=Jc(r,e.verify);return new SP(i,t)}return Ze(1463,{proto:e})}function JD(r,e){return r&&r.length>0?(it(e!==void 0,14353),r.map(t=>function(i,s){let o=i.updateTime?fi(i.updateTime):fi(s);return o.isEqual(ct.min())&&(o=fi(s)),new FD(o,i.transformResults||[])}(t,e))):[]}function jP(r,e){return{documents:[PP(r,e.path)]}}function jb(r,e){const t={structuredQuery:{}},n=e.path;let i;e.collectionGroup!==null?(i=n,t.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(i=n.popLast(),t.structuredQuery.from=[{collectionId:n.lastSegment()}]),t.parent=PP(r,i);const s=function(f){if(f.length!==0)return DP(mn.create(f,"and"))}(e.filters);s&&(t.structuredQuery.where=s);const o=function(f){if(f.length!==0)return f.map(m=>function(g){return{field:Ol(g.field),direction:n6(g.dir)}}(m))}(e.orderBy);o&&(t.structuredQuery.orderBy=o);const l=yx(r,e.limit);return l!==null&&(t.structuredQuery.limit=l),e.startAt&&(t.structuredQuery.startAt=function(f){return{before:f.inclusive,values:f.position}}(e.startAt)),e.endAt&&(t.structuredQuery.endAt=function(f){return{before:!f.inclusive,values:f.position}}(e.endAt)),{gt:t,parent:i}}function e6(r,e,t,n){const{gt:i,parent:s}=jb(r,e),o={},l=[];let d=0;return t.forEach(f=>{const m="aggregate_"+d++;o[m]=f.alias,f.aggregateType==="count"?l.push({alias:m,count:{}}):f.aggregateType==="avg"?l.push({alias:m,avg:{field:Ol(f.fieldPath)}}):f.aggregateType==="sum"&&l.push({alias:m,sum:{field:Ol(f.fieldPath)}})}),{request:{structuredAggregationQuery:{aggregations:l,structuredQuery:i.structuredQuery},parent:i.parent},yt:o,parent:s}}function OP(r){let e=CP(r.parent);const t=r.structuredQuery,n=t.from?t.from.length:0;let i=null;if(n>0){it(n===1,65062);const m=t.from[0];m.allDescendants?i=m.collectionId:e=e.child(m.collectionId)}let s=[];t.where&&(s=function(y){const g=MP(y);return g instanceof mn&&Sb(g)?g.getFilters():[g]}(t.where));let o=[];t.orderBy&&(o=function(y){return y.map(g=>function(E){return new Qf(dd(E.field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(E.direction))}(g))}(t.orderBy));let l=null;t.limit&&(l=function(y){let g;return g=typeof y=="object"?y.value:y,Ny(g)?null:g}(t.limit));let d=null;t.startAt&&(d=function(y){const g=!!y.before,_=y.values||[];return new Rd(_,g)}(t.startAt));let f=null;return t.endAt&&(f=function(y){const g=!y.before,_=y.values||[];return new Rd(_,g)}(t.endAt)),lP(e,i,o,s,l,"F",d,f)}function t6(r,e){const t=function(i){switch(i){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ze(28987,{purpose:i})}}(e.purpose);return t==null?null:{"goog-listen-tags":t}}function MP(r){return r.unaryFilter!==void 0?function(t){switch(t.unaryFilter.op){case"IS_NAN":const n=dd(t.unaryFilter.field);return qt.create(n,"==",{doubleValue:NaN});case"IS_NULL":const i=dd(t.unaryFilter.field);return qt.create(i,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const s=dd(t.unaryFilter.field);return qt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=dd(t.unaryFilter.field);return qt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ze(61313);default:return Ze(60726)}}(r):r.fieldFilter!==void 0?function(t){return qt.create(dd(t.fieldFilter.field),function(i){switch(i){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ze(58110);default:return Ze(50506)}}(t.fieldFilter.op),t.fieldFilter.value)}(r):r.compositeFilter!==void 0?function(t){return mn.create(t.compositeFilter.filters.map(n=>MP(n)),function(i){switch(i){case"AND":return"and";case"OR":return"or";default:return Ze(1026)}}(t.compositeFilter.op))}(r):Ze(30097,{filter:r})}function n6(r){return WD[r]}function r6(r){return GD[r]}function i6(r){return KD[r]}function Ol(r){return{fieldPath:r.canonicalString()}}function dd(r){return Vn.fromServerFormat(r.fieldPath)}function DP(r){return r instanceof qt?function(t){if(t.op==="=="){if(DS(t.value))return{unaryFilter:{field:Ol(t.field),op:"IS_NAN"}};if(MS(t.value))return{unaryFilter:{field:Ol(t.field),op:"IS_NULL"}}}else if(t.op==="!="){if(DS(t.value))return{unaryFilter:{field:Ol(t.field),op:"IS_NOT_NAN"}};if(MS(t.value))return{unaryFilter:{field:Ol(t.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ol(t.field),op:r6(t.op),value:t.value}}}(r):r instanceof mn?function(t){const n=t.getFilters().map(i=>DP(i));return n.length===1?n[0]:{compositeFilter:{op:i6(t.op),filters:n}}}(r):Ze(54877,{filter:r})}function s6(r){const e=[];return r.fields.forEach(t=>e.push(t.canonicalString())),{fieldPaths:e}}function LP(r){return r.length>=4&&r.get(0)==="projects"&&r.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(e,t,n,i,s=ct.min(),o=ct.min(),l=Xn.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=i,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=d}withSequenceNumber(e){return new wa(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new wa(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new wa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new wa(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class FP{constructor(e){this.wt=e}}function o6(r,e){let t;if(e.document)t=QD(r.wt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const n=He.fromSegments(e.noDocument.path),i=du(e.noDocument.readTime);t=Hn.newNoDocument(n,i),e.hasCommittedMutations&&t.setHasCommittedMutations()}else{if(!e.unknownDocument)return Ze(56709);{const n=He.fromSegments(e.unknownDocument.path),i=du(e.unknownDocument.version);t=Hn.newUnknownDocument(n,i)}}return e.readTime&&t.setReadTime(function(i){const s=new jt(i[0],i[1]);return ct.fromTimestamp(s)}(e.readTime)),t}function JS(r,e){const t=e.key,n={prefixPath:t.getCollectionPath().popLast().toArray(),collectionGroup:t.collectionGroup,documentId:t.path.lastSegment(),readTime:$g(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())n.document=function(s,o){return{name:qg(s,o.key),fields:o.data.value.mapValue.fields,updateTime:Dd(s,o.version.toTimestamp()),createTime:Dd(s,o.createTime.toTimestamp())}}(r.wt,e);else if(e.isNoDocument())n.noDocument={path:t.path.toArray(),readTime:uu(e.version)};else{if(!e.isUnknownDocument())return Ze(57904,{document:e});n.unknownDocument={path:t.path.toArray(),version:uu(e.version)}}return n}function $g(r){const e=r.toTimestamp();return[e.seconds,e.nanoseconds]}function uu(r){const e=r.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function du(r){const e=new jt(r.seconds,r.nanoseconds);return ct.fromTimestamp(e)}function $c(r,e){const t=(e.baseMutations||[]).map(s=>xx(r.wt,s));for(let s=0;s<e.mutations.length-1;++s){const o=e.mutations[s];if(s+1<e.mutations.length&&e.mutations[s+1].transform!==void 0){const l=e.mutations[s+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(s+1,1),++s}}const n=e.mutations.map(s=>xx(r.wt,s)),i=jt.fromMillis(e.localWriteTimeMs);return new Ib(e.batchId,i,t,n)}function hf(r){const e=du(r.readTime),t=r.lastLimboFreeSnapshotVersion!==void 0?du(r.lastLimboFreeSnapshotVersion):ct.min();let n;return n=function(s){return s.documents!==void 0}(r.query)?function(s){const o=s.documents.length;return it(o===1,1966,{count:o}),is(_m(CP(s.documents[0])))}(r.query):function(s){return is(OP(s))}(r.query),new wa(n,r.targetId,"TargetPurposeListen",r.lastListenSequenceNumber,e,t,Xn.fromBase64String(r.resumeToken))}function VP(r,e){const t=uu(e.snapshotVersion),n=uu(e.lastLimboFreeSnapshotVersion);let i;i=zg(e.target)?jP(r.wt,e.target):jb(r.wt,e.target).gt;const s=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:lu(e.target),readTime:t,resumeToken:s,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:n,query:i}}function zP(r){const e=OP({parent:r.parent,structuredQuery:r.structuredQuery});return r.limitType==="LAST"?Ug(e,e.limit,"L"):e}function Fv(r,e){return new Pb(e.largestBatchId,xx(r.wt,e.overlayMutation))}function eT(r,e){const t=e.path.lastSegment();return[r,Jr(e.path.popLast()),t]}function tT(r,e,t,n){return{indexId:r,uid:e,sequenceNumber:t,readTime:uu(n.readTime),documentKey:Jr(n.documentKey.path),largestBatchId:n.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class a6{getBundleMetadata(e,t){return nT(e).get(t).next(n=>{if(n)return function(s){return{id:s.bundleId,createTime:du(s.createTime),version:s.version}}(n)})}saveBundleMetadata(e,t){return nT(e).put(function(i){return{bundleId:i.id,createTime:uu(fi(i.createTime)),version:i.version}}(t))}getNamedQuery(e,t){return rT(e).get(t).next(n=>{if(n)return function(s){return{name:s.name,query:zP(s.bundledQuery),readTime:du(s.readTime)}}(n)})}saveNamedQuery(e,t){return rT(e).put(function(i){return{name:i.name,readTime:uu(fi(i.readTime)),bundledQuery:i.bundledQuery}}(t))}}function nT(r){return gr(r,Iy)}function rT(r){return gr(r,ky)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dy{constructor(e,t){this.serializer=e,this.userId=t}static bt(e,t){const n=t.uid||"";return new Dy(e,n)}getOverlay(e,t){return Lh(e).get(eT(this.userId,t)).next(n=>n?Fv(this.serializer,n):null)}getOverlays(e,t){const n=Ro();return ve.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){const i=[];return n.forEach((s,o)=>{const l=new Pb(t,o);i.push(this.St(e,l))}),ve.waitFor(i)}removeOverlaysForBatchId(e,t,n){const i=new Set;t.forEach(o=>i.add(Jr(o.getCollectionPath())));const s=[];return i.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,n],[this.userId,o,n+1],!1,!0);s.push(Lh(e).X(cx,l))}),ve.waitFor(s)}getOverlaysForCollection(e,t,n){const i=Ro(),s=Jr(t),o=IDBKeyRange.bound([this.userId,s,n],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Lh(e).J(cx,o).next(l=>{for(const d of l){const f=Fv(this.serializer,d);i.set(f.getKey(),f)}return i})}getOverlaysForCollectionGroup(e,t,n,i){const s=Ro();let o;const l=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return Lh(e).te({index:zk,range:l},(d,f,m)=>{const y=Fv(this.serializer,f);s.size()<i||y.largestBatchId===o?(s.set(y.getKey(),y),o=y.largestBatchId):m.done()}).next(()=>s)}St(e,t){return Lh(e).put(function(i,s,o){const[l,d,f]=eT(s,o.mutation.key);return{userId:s,collectionPath:d,documentId:f,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Hg(i.wt,o.mutation)}}(this.serializer,this.userId,t))}}function Lh(r){return gr(r,Py)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l6{Dt(e){return gr(e,_b)}getSessionToken(e){return this.Dt(e).get("sessionToken").next(t=>{const n=t==null?void 0:t.value;return n?Xn.fromUint8Array(n):Xn.EMPTY_BYTE_STRING})}setSessionToken(e,t){return this.Dt(e).put({name:"sessionToken",value:t.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wc{constructor(){}vt(e,t){this.Ct(e,t),t.Ft()}Ct(e,t){if("nullValue"in e)this.Mt(t,5);else if("booleanValue"in e)this.Mt(t,10),t.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(t,15),t.xt(Rn(e.integerValue));else if("doubleValue"in e){const n=Rn(e.doubleValue);isNaN(n)?this.Mt(t,13):(this.Mt(t,15),qf(n)?t.xt(0):t.xt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Mt(t,20),typeof n=="string"&&(n=Ia(n)),t.Ot(`${n.seconds||""}`),t.xt(n.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,t),this.Bt(t);else if("bytesValue"in e)this.Mt(t,30),t.Lt(ka(e.bytesValue)),this.Bt(t);else if("referenceValue"in e)this.kt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Mt(t,45),t.xt(n.latitude||0),t.xt(n.longitude||0)}else"mapValue"in e?Xk(e)?this.Mt(t,Number.MAX_SAFE_INTEGER):Ry(e)?this.qt(e.mapValue,t):(this.Qt(e.mapValue,t),this.Bt(t)):"arrayValue"in e?(this.$t(e.arrayValue,t),this.Bt(t)):Ze(19022,{Ut:e})}Nt(e,t){this.Mt(t,25),this.Kt(e,t)}Kt(e,t){t.Ot(e)}Qt(e,t){const n=e.fields||{};this.Mt(t,55);for(const i of Object.keys(n))this.Nt(i,t),this.Ct(n[i],t)}qt(e,t){var n,i;const s=e.fields||{};this.Mt(t,53);const o=Pd,l=((i=(n=s[o].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.length)||0;this.Mt(t,15),t.xt(Rn(l)),this.Nt(o,t),this.Ct(s[o],t)}$t(e,t){const n=e.values||[];this.Mt(t,50);for(const i of n)this.Ct(i,t)}kt(e,t){this.Mt(t,37),He.fromName(e).path.forEach(n=>{this.Mt(t,60),this.Kt(n,t)})}Mt(e,t){e.xt(t)}Bt(e){e.xt(2)}}Wc.Wt=new Wc;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const td=255;function c6(r){if(r===0)return 8;let e=0;return r>>4||(e+=4,r<<=4),r>>6||(e+=2,r<<=2),r>>7||(e+=1),e}function iT(r){const e=64-function(n){let i=0;for(let s=0;s<8;++s){const o=c6(255&n[s]);if(i+=o,o!==8)break}return i}(r);return Math.ceil(e/8)}class u6{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Gt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.zt(n.value),n=t.next();this.jt()}Ht(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Jt(n.value),n=t.next();this.Yt()}Zt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.zt(n);else if(n<2048)this.zt(960|n>>>6),this.zt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.zt(480|n>>>12),this.zt(128|63&n>>>6),this.zt(128|63&n);else{const i=t.codePointAt(0);this.zt(240|i>>>18),this.zt(128|63&i>>>12),this.zt(128|63&i>>>6),this.zt(128|63&i)}}this.jt()}Xt(e){for(const t of e){const n=t.charCodeAt(0);if(n<128)this.Jt(n);else if(n<2048)this.Jt(960|n>>>6),this.Jt(128|63&n);else if(t<"\uD800"||"\uDBFF"<t)this.Jt(480|n>>>12),this.Jt(128|63&n>>>6),this.Jt(128|63&n);else{const i=t.codePointAt(0);this.Jt(240|i>>>18),this.Jt(128|63&i>>>12),this.Jt(128|63&i>>>6),this.Jt(128|63&i)}}this.Yt()}en(e){const t=this.tn(e),n=iT(t);this.nn(1+n),this.buffer[this.position++]=255&n;for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=255&t[i]}rn(e){const t=this.tn(e),n=iT(t);this.nn(1+n),this.buffer[this.position++]=~(255&n);for(let i=t.length-n;i<t.length;++i)this.buffer[this.position++]=~(255&t[i])}sn(){this._n(td),this._n(255)}an(){this.un(td),this.un(255)}reset(){this.position=0}seed(e){this.nn(e.length),this.buffer.set(e,this.position),this.position+=e.length}cn(){return this.buffer.slice(0,this.position)}tn(e){const t=function(s){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(e),n=!!(128&t[0]);t[0]^=n?255:128;for(let i=1;i<t.length;++i)t[i]^=n?255:0;return t}zt(e){const t=255&e;t===0?(this._n(0),this._n(255)):t===td?(this._n(td),this._n(0)):this._n(t)}Jt(e){const t=255&e;t===0?(this.un(0),this.un(255)):t===td?(this.un(td),this.un(0)):this.un(e)}jt(){this._n(0),this._n(1)}Yt(){this.un(0),this.un(1)}_n(e){this.nn(1),this.buffer[this.position++]=e}un(e){this.nn(1),this.buffer[this.position++]=~e}nn(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const i=new Uint8Array(n);i.set(this.buffer),this.buffer=i}}class d6{constructor(e){this.ln=e}Lt(e){this.ln.Gt(e)}Ot(e){this.ln.Zt(e)}xt(e){this.ln.en(e)}Ft(){this.ln.sn()}}class h6{constructor(e){this.ln=e}Lt(e){this.ln.Ht(e)}Ot(e){this.ln.Xt(e)}xt(e){this.ln.rn(e)}Ft(){this.ln.an()}}class Fh{constructor(){this.ln=new u6,this.hn=new d6(this.ln),this.Pn=new h6(this.ln)}seed(e){this.ln.seed(e)}Tn(e){return e===0?this.hn:this.Pn}cn(){return this.ln.cn()}reset(){this.ln.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gc{constructor(e,t,n,i){this.In=e,this.En=t,this.dn=n,this.An=i}Rn(){const e=this.An.length,t=e===0||this.An[e-1]===255?e+1:e,n=new Uint8Array(t);return n.set(this.An,0),t!==e?n.set([0],this.An.length):++n[n.length-1],new Gc(this.In,this.En,this.dn,n)}Vn(e,t,n){return{indexId:this.In,uid:e,arrayValue:yg(this.dn),directionalValue:yg(this.An),orderedDocumentKey:yg(t),documentKey:n.path.toArray()}}mn(e,t,n){const i=this.Vn(e,t,n);return[i.indexId,i.uid,i.arrayValue,i.directionalValue,i.orderedDocumentKey,i.documentKey]}}function Nl(r,e){let t=r.In-e.In;return t!==0?t:(t=sT(r.dn,e.dn),t!==0?t:(t=sT(r.An,e.An),t!==0?t:He.comparator(r.En,e.En)))}function sT(r,e){for(let t=0;t<r.length&&t<e.length;++t){const n=r[t]-e[t];if(n!==0)return n}return r.length-e.length}function yg(r){return k4()?function(t){let n="";for(let i=0;i<t.length;i++)n+=String.fromCharCode(t[i]);return n}(r):r}function oT(r){return typeof r!="string"?r:function(t){const n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}(r)}class aT{constructor(e){this.fn=new pn((t,n)=>Vn.comparator(t.field,n.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.gn=e.orderBy,this.pn=[];for(const t of e.filters){const n=t;n.isInequality()?this.fn=this.fn.add(n):this.pn.push(n)}}get yn(){return this.fn.size>1}wn(e){if(it(e.collectionGroup===this.collectionId,49279),this.yn)return!1;const t=ox(e);if(t!==void 0&&!this.bn(t))return!1;const n=zc(e);let i=new Set,s=0,o=0;for(;s<n.length&&this.bn(n[s]);++s)i=i.add(n[s].fieldPath.canonicalString());if(s===n.length)return!0;if(this.fn.size>0){const l=this.fn.getIterator().getNext();if(!i.has(l.field.canonicalString())){const d=n[s];if(!this.Sn(l,d)||!this.Dn(this.gn[o++],d))return!1}++s}for(;s<n.length;++s){const l=n[s];if(o>=this.gn.length||!this.Dn(this.gn[o++],l))return!1}return!0}vn(){if(this.yn)return null;let e=new pn(Vn.comparator);const t=[];for(const n of this.pn)if(!n.field.isKeyField())if(n.op==="array-contains"||n.op==="array-contains-any")t.push(new cg(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new cg(n.field,0))}for(const n of this.gn)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new cg(n.field,n.dir==="asc"?0:1)));return new Mg(Mg.UNKNOWN_ID,this.collectionId,t,Uf.empty())}bn(e){for(const t of this.pn)if(this.Sn(t,e))return!0;return!1}Sn(e,t){if(e===void 0||!e.field.isEqual(t.fieldPath))return!1;const n=e.op==="array-contains"||e.op==="array-contains-any";return t.kind===2===n}Dn(e,t){return!!e.field.isEqual(t.fieldPath)&&(t.kind===0&&e.dir==="asc"||t.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BP(r){var e,t;if(it(r instanceof qt||r instanceof mn,20012),r instanceof qt){if(r instanceof aP){const i=((t=(e=r.value.arrayValue)===null||e===void 0?void 0:e.values)===null||t===void 0?void 0:t.map(s=>qt.create(r.field,"==",s)))||[];return mn.create(i,"or")}return r}const n=r.filters.map(i=>BP(i));return mn.create(n,r.op)}function f6(r){if(r.getFilters().length===0)return[];const e=Ex(BP(r));return it(UP(e),7391),bx(e)||wx(e)?[e]:e.getFilters()}function bx(r){return r instanceof qt}function wx(r){return r instanceof mn&&Sb(r)}function UP(r){return bx(r)||wx(r)||function(t){if(t instanceof mn&&fx(t)){for(const n of t.getFilters())if(!bx(n)&&!wx(n))return!1;return!0}return!1}(r)}function Ex(r){if(it(r instanceof qt||r instanceof mn,34018),r instanceof qt)return r;if(r.filters.length===1)return Ex(r.filters[0]);const e=r.filters.map(n=>Ex(n));let t=mn.create(e,r.op);return t=Wg(t),UP(t)?t:(it(t instanceof mn,64498),it(jd(t),40251),it(t.filters.length>1,57927),t.filters.reduce((n,i)=>Ob(n,i)))}function Ob(r,e){let t;return it(r instanceof qt||r instanceof mn,38388),it(e instanceof qt||e instanceof mn,25473),t=r instanceof qt?e instanceof qt?function(i,s){return mn.create([i,s],"and")}(r,e):lT(r,e):e instanceof qt?lT(e,r):function(i,s){if(it(i.filters.length>0&&s.filters.length>0,48005),jd(i)&&jd(s))return iP(i,s.getFilters());const o=fx(i)?i:s,l=fx(i)?s:i,d=o.filters.map(f=>Ob(f,l));return mn.create(d,"or")}(r,e),Wg(t)}function lT(r,e){if(jd(e))return iP(e,r.getFilters());{const t=e.filters.map(n=>Ob(r,n));return mn.create(t,"or")}}function Wg(r){if(it(r instanceof qt||r instanceof mn,11850),r instanceof qt)return r;const e=r.getFilters();if(e.length===1)return Wg(e[0]);if(nP(r))return r;const t=e.map(i=>Wg(i)),n=[];return t.forEach(i=>{i instanceof qt?n.push(i):i instanceof mn&&(i.op===r.op?n.push(...i.filters):n.push(i))}),n.length===1?n[0]:mn.create(n,r.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m6{constructor(){this.Cn=new Mb}addToCollectionParentIndex(e,t){return this.Cn.add(t),ve.resolve()}getCollectionParents(e,t){return ve.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return ve.resolve()}deleteFieldIndex(e,t){return ve.resolve()}deleteAllFieldIndexes(e){return ve.resolve()}createTargetIndexes(e,t){return ve.resolve()}getDocumentsMatchingTarget(e,t){return ve.resolve(null)}getIndexType(e,t){return ve.resolve(0)}getFieldIndexes(e,t){return ve.resolve([])}getNextCollectionGroupToUpdate(e){return ve.resolve(null)}getMinOffset(e,t){return ve.resolve(os.min())}getMinOffsetFromCollectionGroup(e,t){return ve.resolve(os.min())}updateCollectionGroup(e,t,n){return ve.resolve()}updateIndexEntries(e,t){return ve.resolve()}}class Mb{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t]||new pn(sn.comparator),s=!i.has(n);return this.index[t]=i.add(n),s}has(e){const t=e.lastSegment(),n=e.popLast(),i=this.index[t];return i&&i.has(n)}getEntries(e){return(this.index[e]||new pn(sn.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cT="IndexedDbIndexManager",jp=new Uint8Array(0);class p6{constructor(e,t){this.databaseId=t,this.Fn=new Mb,this.Mn=new Oa(n=>lu(n),(n,i)=>vm(n,i)),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.Fn.has(t)){const n=t.lastSegment(),i=t.popLast();e.addOnCommittedListener(()=>{this.Fn.add(t)});const s={collectionId:n,parent:Jr(i)};return uT(e).put(s)}return ve.resolve()}getCollectionParents(e,t){const n=[],i=IDBKeyRange.bound([t,""],[Ik(t),""],!1,!0);return uT(e).J(i).next(s=>{for(const o of s){if(o.collectionId!==t)break;n.push(Co(o.parent))}return n})}addFieldIndex(e,t){const n=Vh(e),i=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(d=>[d.fieldPath.canonicalString(),d.kind])}}(t);delete i.indexId;const s=n.add(i);if(t.indexState){const o=rd(e);return s.next(l=>{o.put(tT(l,this.uid,t.indexState.sequenceNumber,t.indexState.offset))})}return s.next()}deleteFieldIndex(e,t){const n=Vh(e),i=rd(e),s=nd(e);return n.delete(t.indexId).next(()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const t=Vh(e),n=nd(e),i=rd(e);return t.X().next(()=>n.X()).next(()=>i.X())}createTargetIndexes(e,t){return ve.forEach(this.xn(t),n=>this.getIndexType(e,n).next(i=>{if(i===0||i===1){const s=new aT(n).vn();if(s!=null)return this.addFieldIndex(e,s)}}))}getDocumentsMatchingTarget(e,t){const n=nd(e);let i=!0;const s=new Map;return ve.forEach(this.xn(t),o=>this.On(e,o).next(l=>{i&&(i=!!l),s.set(o,l)})).next(()=>{if(i){let o=Lt();const l=[];return ve.forEach(s,(d,f)=>{Re(cT,`Using index ${function(R){return`id=${R.indexId}|cg=${R.collectionGroup}|f=${R.fields.map(I=>`${I.fieldPath}:${I.kind}`).join(",")}`}(d)} to execute ${lu(t)}`);const m=function(R,I){const j=ox(I);if(j===void 0)return null;for(const U of Bg(R,j.fieldPath))switch(U.op){case"array-contains-any":return U.value.arrayValue.values||[];case"array-contains":return[U.value]}return null}(f,d),y=function(R,I){const j=new Map;for(const U of zc(I))for(const C of Bg(R,U.fieldPath))switch(C.op){case"==":case"in":j.set(U.fieldPath.canonicalString(),C.value);break;case"not-in":case"!=":return j.set(U.fieldPath.canonicalString(),C.value),Array.from(j.values())}return null}(f,d),g=function(R,I){const j=[];let U=!0;for(const C of zc(I)){const k=C.kind===0?BS(R,C.fieldPath,R.startAt):US(R,C.fieldPath,R.startAt);j.push(k.value),U&&(U=k.inclusive)}return new Rd(j,U)}(f,d),_=function(R,I){const j=[];let U=!0;for(const C of zc(I)){const k=C.kind===0?US(R,C.fieldPath,R.endAt):BS(R,C.fieldPath,R.endAt);j.push(k.value),U&&(U=k.inclusive)}return new Rd(j,U)}(f,d),E=this.Nn(d,f,g),x=this.Nn(d,f,_),b=this.Bn(d,f,y),T=this.Ln(d.indexId,m,E,g.inclusive,x,_.inclusive,b);return ve.forEach(T,N=>n.Z(N,t.limit).next(R=>{R.forEach(I=>{const j=He.fromSegments(I.documentKey);o.has(j)||(o=o.add(j),l.push(j))})}))}).next(()=>l)}return ve.resolve(null)})}xn(e){let t=this.Mn.get(e);return t||(e.filters.length===0?t=[e]:t=f6(mn.create(e.filters,"and")).map(n=>px(e.path,e.collectionGroup,e.orderBy,n.getFilters(),e.limit,e.startAt,e.endAt)),this.Mn.set(e,t),t)}Ln(e,t,n,i,s,o,l){const d=(t!=null?t.length:1)*Math.max(n.length,s.length),f=d/(t!=null?t.length:1),m=[];for(let y=0;y<d;++y){const g=t?this.kn(t[y/f]):jp,_=this.qn(e,g,n[y%f],i),E=this.Qn(e,g,s[y%f],o),x=l.map(b=>this.qn(e,g,b,!0));m.push(...this.createRange(_,E,x))}return m}qn(e,t,n,i){const s=new Gc(e,He.empty(),t,n);return i?s:s.Rn()}Qn(e,t,n,i){const s=new Gc(e,He.empty(),t,n);return i?s.Rn():s}On(e,t){const n=new aT(t),i=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,i).next(s=>{let o=null;for(const l of s)n.wn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,t){let n=2;const i=this.xn(t);return ve.forEach(i,s=>this.On(e,s).next(o=>{o?n!==0&&o.fields.length<function(d){let f=new pn(Vn.comparator),m=!1;for(const y of d.filters)for(const g of y.getFlattenedFilters())g.field.isKeyField()||(g.op==="array-contains"||g.op==="array-contains-any"?m=!0:f=f.add(g.field));for(const y of d.orderBy)y.field.isKeyField()||(f=f.add(y.field));return f.size+(m?1:0)}(s)&&(n=1):n=0})).next(()=>function(o){return o.limit!==null}(t)&&i.length>1&&n===2?1:n)}$n(e,t){const n=new Fh;for(const i of zc(e)){const s=t.data.field(i.fieldPath);if(s==null)return null;const o=n.Tn(i.kind);Wc.Wt.vt(s,o)}return n.cn()}kn(e){const t=new Fh;return Wc.Wt.vt(e,t.Tn(0)),t.cn()}Un(e,t){const n=new Fh;return Wc.Wt.vt(Yf(this.databaseId,t),n.Tn(function(s){const o=zc(s);return o.length===0?0:o[o.length-1].kind}(e))),n.cn()}Bn(e,t,n){if(n===null)return[];let i=[];i.push(new Fh);let s=0;for(const o of zc(e)){const l=n[s++];for(const d of i)if(this.Kn(t,o.fieldPath)&&Zf(l))i=this.Wn(i,o,l);else{const f=d.Tn(o.kind);Wc.Wt.vt(l,f)}}return this.Gn(i)}Nn(e,t,n){return this.Bn(e,t,n.position)}Gn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].cn();return t}Wn(e,t,n){const i=[...e],s=[];for(const o of n.arrayValue.values||[])for(const l of i){const d=new Fh;d.seed(l.cn()),Wc.Wt.vt(o,d.Tn(t.kind)),s.push(d)}return s}Kn(e,t){return!!e.filters.find(n=>n instanceof qt&&n.field.isEqual(t)&&(n.op==="in"||n.op==="not-in"))}getFieldIndexes(e,t){const n=Vh(e),i=rd(e);return(t?n.J(lx,IDBKeyRange.bound(t,t)):n.J()).next(s=>{const o=[];return ve.forEach(s,l=>i.get([l.indexId,this.uid]).next(d=>{o.push(function(m,y){const g=y?new Uf(y.sequenceNumber,new os(du(y.readTime),new He(Co(y.documentKey)),y.largestBatchId)):Uf.empty(),_=m.fields.map(([E,x])=>new cg(Vn.fromServerFormat(E),x));return new Mg(m.indexId,m.collectionGroup,_,g)}(l,d))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(t=>t.length===0?null:(t.sort((n,i)=>{const s=n.indexState.sequenceNumber-i.indexState.sequenceNumber;return s!==0?s:bt(n.collectionGroup,i.collectionGroup)}),t[0].collectionGroup))}updateCollectionGroup(e,t,n){const i=Vh(e),s=rd(e);return this.zn(e).next(o=>i.J(lx,IDBKeyRange.bound(t,t)).next(l=>ve.forEach(l,d=>s.put(tT(d.indexId,this.uid,o,n)))))}updateIndexEntries(e,t){const n=new Map;return ve.forEach(t,(i,s)=>{const o=n.get(i.collectionGroup);return(o?ve.resolve(o):this.getFieldIndexes(e,i.collectionGroup)).next(l=>(n.set(i.collectionGroup,l),ve.forEach(l,d=>this.jn(e,i,d).next(f=>{const m=this.Hn(s,d);return f.isEqual(m)?ve.resolve():this.Jn(e,s,d,f,m)}))))})}Yn(e,t,n,i){return nd(e).put(i.Vn(this.uid,this.Un(n,t.key),t.key))}Zn(e,t,n,i){return nd(e).delete(i.mn(this.uid,this.Un(n,t.key),t.key))}jn(e,t,n){const i=nd(e);let s=new pn(Nl);return i.te({index:Vk,range:IDBKeyRange.only([n.indexId,this.uid,yg(this.Un(n,t))])},(o,l)=>{s=s.add(new Gc(n.indexId,t,oT(l.arrayValue),oT(l.directionalValue)))}).next(()=>s)}Hn(e,t){let n=new pn(Nl);const i=this.$n(t,e);if(i==null)return n;const s=ox(t);if(s!=null){const o=e.data.field(s.fieldPath);if(Zf(o))for(const l of o.arrayValue.values||[])n=n.add(new Gc(t.indexId,e.key,this.kn(l),i))}else n=n.add(new Gc(t.indexId,e.key,jp,i));return n}Jn(e,t,n,i,s){Re(cT,"Updating index entries for document '%s'",t.key);const o=[];return function(d,f,m,y,g){const _=d.getIterator(),E=f.getIterator();let x=ed(_),b=ed(E);for(;x||b;){let T=!1,N=!1;if(x&&b){const R=m(x,b);R<0?N=!0:R>0&&(T=!0)}else x!=null?N=!0:T=!0;T?(y(b),b=ed(E)):N?(g(x),x=ed(_)):(x=ed(_),b=ed(E))}}(i,s,Nl,l=>{o.push(this.Yn(e,t,n,l))},l=>{o.push(this.Zn(e,t,n,l))}),ve.waitFor(o)}zn(e){let t=1;return rd(e).te({index:Fk,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(n,i,s)=>{s.done(),t=i.sequenceNumber+1}).next(()=>t)}createRange(e,t,n){n=n.sort((o,l)=>Nl(o,l)).filter((o,l,d)=>!l||Nl(o,d[l-1])!==0);const i=[];i.push(e);for(const o of n){const l=Nl(o,e),d=Nl(o,t);if(l===0)i[0]=e.Rn();else if(l>0&&d<0)i.push(o),i.push(o.Rn());else if(d>0)break}i.push(t);const s=[];for(let o=0;o<i.length;o+=2){if(this.Xn(i[o],i[o+1]))return[];const l=i[o].mn(this.uid,jp,He.empty()),d=i[o+1].mn(this.uid,jp,He.empty());s.push(IDBKeyRange.bound(l,d))}return s}Xn(e,t){return Nl(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(dT)}getMinOffset(e,t){return ve.mapArray(this.xn(t),n=>this.On(e,n).next(i=>i||Ze(44426))).next(dT)}}function uT(r){return gr(r,Wf)}function nd(r){return gr(r,Af)}function Vh(r){return gr(r,vb)}function rd(r){return gr(r,Tf)}function dT(r){it(r.length!==0,28825);let e=r[0].indexState.offset,t=e.largestBatchId;for(let n=1;n<r.length;n++){const i=r[n].indexState.offset;pb(i,e)<0&&(e=i),t<i.largestBatchId&&(t=i.largestBatchId)}return new os(e.readTime,e.documentKey,t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hT={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},qP=41943040;class Yr{static withCacheSize(e){return new Yr(e,Yr.DEFAULT_COLLECTION_PERCENTILE,Yr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HP(r,e,t){const n=r.store(io),i=r.store(Ad),s=[],o=IDBKeyRange.only(t.batchId);let l=0;const d=n.te({range:o},(m,y,g)=>(l++,g.delete()));s.push(d.next(()=>{it(l===1,47070,{batchId:t.batchId})}));const f=[];for(const m of t.mutations){const y=Mk(e,m.key.path,t.batchId);s.push(i.delete(y)),f.push(m.key)}return ve.waitFor(s).next(()=>f)}function Gg(r){if(!r)return 0;let e;if(r.document)e=r.document;else if(r.unknownDocument)e=r.unknownDocument;else{if(!r.noDocument)throw Ze(14731);e=r.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Yr.DEFAULT_COLLECTION_PERCENTILE=10,Yr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Yr.DEFAULT=new Yr(qP,Yr.DEFAULT_COLLECTION_PERCENTILE,Yr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Yr.DISABLED=new Yr(-1,0,0);class Ly{constructor(e,t,n,i){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=i,this.er={}}static bt(e,t,n,i){it(e.uid!=="",64387);const s=e.isAuthenticated()?e.uid:"";return new Ly(s,t,n,i)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Il(e).te({index:Yc,range:n},(i,s,o)=>{t=!1,o.done()}).next(()=>t)}addMutationBatch(e,t,n,i){const s=hd(e),o=Il(e);return o.add({}).next(l=>{it(typeof l=="number",49019);const d=new Ib(l,t,n,i),f=function(_,E,x){const b=x.baseMutations.map(N=>Hg(_.wt,N)),T=x.mutations.map(N=>Hg(_.wt,N));return{userId:E,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:b,mutations:T}}(this.serializer,this.userId,d),m=[];let y=new pn((g,_)=>bt(g.canonicalString(),_.canonicalString()));for(const g of i){const _=Mk(this.userId,g.key.path,l);y=y.add(g.key.path.popLast()),m.push(o.put(f)),m.push(s.put(_,$M))}return y.forEach(g=>{m.push(this.indexManager.addToCollectionParentIndex(e,g))}),e.addOnCommittedListener(()=>{this.er[l]=d.keys()}),ve.waitFor(m).next(()=>d)})}lookupMutationBatch(e,t){return Il(e).get(t).next(n=>n?(it(n.userId===this.userId,48,"Unexpected user for mutation batch",{userId:n.userId,batchId:t}),$c(this.serializer,n)):null)}tr(e,t){return this.er[t]?ve.resolve(this.er[t]):this.lookupMutationBatch(e,t).next(n=>{if(n){const i=n.keys();return this.er[t]=i,i}return null})}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=IDBKeyRange.lowerBound([this.userId,n]);let s=null;return Il(e).te({index:Yc,range:i},(o,l,d)=>{l.userId===this.userId&&(it(l.batchId>=n,47524,{nr:n}),s=$c(this.serializer,l)),d.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=Qc;return Il(e).te({index:Yc,range:t,reverse:!0},(i,s,o)=>{n=s.batchId,o.done()}).next(()=>n)}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,Qc],[this.userId,Number.POSITIVE_INFINITY]);return Il(e).J(Yc,t).next(n=>n.map(i=>$c(this.serializer,i)))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=ug(this.userId,t.path),i=IDBKeyRange.lowerBound(n),s=[];return hd(e).te({range:i},(o,l,d)=>{const[f,m,y]=o,g=Co(m);if(f===this.userId&&t.path.isEqual(g))return Il(e).get(y).next(_=>{if(!_)throw Ze(61480,{rr:o,batchId:y});it(_.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:_.userId,batchId:y}),s.push($c(this.serializer,_))});d.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new pn(bt);const i=[];return t.forEach(s=>{const o=ug(this.userId,s.path),l=IDBKeyRange.lowerBound(o),d=hd(e).te({range:l},(f,m,y)=>{const[g,_,E]=f,x=Co(_);g===this.userId&&s.path.isEqual(x)?n=n.add(E):y.done()});i.push(d)}),ve.waitFor(i).next(()=>this.ir(e,n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1,s=ug(this.userId,n),o=IDBKeyRange.lowerBound(s);let l=new pn(bt);return hd(e).te({range:o},(d,f,m)=>{const[y,g,_]=d,E=Co(g);y===this.userId&&n.isPrefixOf(E)?E.length===i&&(l=l.add(_)):m.done()}).next(()=>this.ir(e,l))}ir(e,t){const n=[],i=[];return t.forEach(s=>{i.push(Il(e).get(s).next(o=>{if(o===null)throw Ze(35274,{batchId:s});it(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:s}),n.push($c(this.serializer,o))}))}),ve.waitFor(i).next(()=>n)}removeMutationBatch(e,t){return HP(e.he,this.userId,t).next(n=>(e.addOnCommittedListener(()=>{this.sr(t.batchId)}),ve.forEach(n,i=>this.referenceDelegate.markPotentiallyOrphaned(e,i))))}sr(e){delete this.er[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(t=>{if(!t)return ve.resolve();const n=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),i=[];return hd(e).te({range:n},(s,o,l)=>{if(s[0]===this.userId){const d=Co(s[1]);i.push(d)}else l.done()}).next(()=>{it(i.length===0,56720,{_r:i.map(s=>s.canonicalString())})})})}containsKey(e,t){return $P(e,this.userId,t)}ar(e){return WP(e).get(this.userId).next(t=>t||{userId:this.userId,lastAcknowledgedBatchId:Qc,lastStreamToken:""})}}function $P(r,e,t){const n=ug(e,t.path),i=n[1],s=IDBKeyRange.lowerBound(n);let o=!1;return hd(r).te({range:s,ee:!0},(l,d,f)=>{const[m,y,g]=l;m===e&&y===i&&(o=!0),f.done()}).next(()=>o)}function Il(r){return gr(r,io)}function hd(r){return gr(r,Ad)}function WP(r){return gr(r,Hf)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hu{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new hu(0)}static lr(){return new hu(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g6{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.hr(e).next(t=>{const n=new hu(t.highestTargetId);return t.highestTargetId=n.next(),this.Pr(e,t).next(()=>t.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.hr(e).next(t=>ct.fromTimestamp(new jt(t.lastRemoteSnapshotVersion.seconds,t.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.hr(e).next(t=>t.highestListenSequenceNumber)}setTargetsMetadata(e,t,n){return this.hr(e).next(i=>(i.highestListenSequenceNumber=t,n&&(i.lastRemoteSnapshotVersion=n.toTimestamp()),t>i.highestListenSequenceNumber&&(i.highestListenSequenceNumber=t),this.Pr(e,i)))}addTargetData(e,t){return this.Tr(e,t).next(()=>this.hr(e).next(n=>(n.targetCount+=1,this.Ir(t,n),this.Pr(e,n))))}updateTargetData(e,t){return this.Tr(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next(()=>id(e).delete(t.targetId)).next(()=>this.hr(e)).next(n=>(it(n.targetCount>0,8065),n.targetCount-=1,this.Pr(e,n)))}removeTargets(e,t,n){let i=0;const s=[];return id(e).te((o,l)=>{const d=hf(l);d.sequenceNumber<=t&&n.get(d.targetId)===null&&(i++,s.push(this.removeTargetData(e,d)))}).next(()=>ve.waitFor(s)).next(()=>i)}forEachTarget(e,t){return id(e).te((n,i)=>{const s=hf(i);t(s)})}hr(e){return fT(e).get(Fg).next(t=>(it(t!==null,2888),t))}Pr(e,t){return fT(e).put(Fg,t)}Tr(e,t){return id(e).put(VP(this.serializer,t))}Ir(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.hr(e).next(t=>t.targetCount)}getTargetData(e,t){const n=lu(t),i=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let s=null;return id(e).te({range:i,index:Lk},(o,l,d)=>{const f=hf(l);vm(t,f.target)&&(s=f,d.done())}).next(()=>s)}addMatchingKeys(e,t,n){const i=[],s=Ml(e);return t.forEach(o=>{const l=Jr(o.path);i.push(s.put({targetId:n,path:l})),i.push(this.referenceDelegate.addReference(e,n,o))}),ve.waitFor(i)}removeMatchingKeys(e,t,n){const i=Ml(e);return ve.forEach(t,s=>{const o=Jr(s.path);return ve.waitFor([i.delete([n,o]),this.referenceDelegate.removeReference(e,n,s)])})}removeMatchingKeysForTargetId(e,t){const n=Ml(e),i=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(i)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),i=Ml(e);let s=Lt();return i.te({range:n,ee:!0},(o,l,d)=>{const f=Co(o[1]),m=new He(f);s=s.add(m)}).next(()=>s)}containsKey(e,t){const n=Jr(t.path),i=IDBKeyRange.bound([n],[Ik(n)],!1,!0);let s=0;return Ml(e).te({index:yb,ee:!0,range:i},([o,l],d,f)=>{o!==0&&(s++,f.done())}).next(()=>s>0)}Rt(e,t){return id(e).get(t).next(n=>n?hf(n):null)}}function id(r){return gr(r,Nd)}function fT(r){return gr(r,Xc)}function Ml(r){return gr(r,Id)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mT="LruGarbageCollector",y6=1048576;function pT([r,e],[t,n]){const i=bt(r,t);return i===0?bt(e,n):i}class v6{constructor(e){this.Er=e,this.buffer=new pn(pT),this.dr=0}Ar(){return++this.dr}Rr(e){const t=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(t);else{const n=this.buffer.last();pT(t,n)<0&&(this.buffer=this.buffer.delete(n).add(t))}}get maxValue(){return this.buffer.last()[0]}}class GP{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){Re(mT,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(t){lc(t)?Re(mT,"Ignoring IndexedDB error during garbage collection: ",t):await ac(t)}await this.mr(3e5)})}}class _6{constructor(e,t){this.gr=e,this.params=t}calculateTargetCount(e,t){return this.gr.pr(e).next(n=>Math.floor(t/100*n))}nthSequenceNumber(e,t){if(t===0)return ve.resolve(zi.le);const n=new v6(t);return this.gr.forEachTarget(e,i=>n.Rr(i.sequenceNumber)).next(()=>this.gr.yr(e,i=>n.Rr(i))).next(()=>n.maxValue)}removeTargets(e,t,n){return this.gr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.gr.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===-1?(Re("LruGarbageCollector","Garbage collection skipped; disabled"),ve.resolve(hT)):this.getCacheSize(e).next(n=>n<this.params.cacheSizeCollectionThreshold?(Re("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),hT):this.wr(e,t))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,t){let n,i,s,o,l,d,f;const m=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(Re("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),i=this.params.maximumSequenceNumbersToCollect):i=y,o=Date.now(),this.nthSequenceNumber(e,i))).next(y=>(n=y,l=Date.now(),this.removeTargets(e,n,t))).next(y=>(s=y,d=Date.now(),this.removeOrphanedDocuments(e,n))).next(y=>(f=Date.now(),cd()<=Ut.DEBUG&&Re("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-m}ms
	Determined least recently used ${i} in `+(l-o)+`ms
	Removed ${s} targets in `+(d-l)+`ms
	Removed ${y} documents in `+(f-d)+`ms
Total Duration: ${f-m}ms`),ve.resolve({didRun:!0,sequenceNumbersCollected:i,targetsRemoved:s,documentsRemoved:y})))}}function KP(r,e){return new _6(r,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x6{constructor(e,t){this.db=e,this.garbageCollector=KP(this,t)}pr(e){const t=this.br(e);return this.db.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}br(e){let t=0;return this.yr(e,n=>{t++}).next(()=>t)}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}yr(e,t){return this.Sr(e,(n,i)=>t(i))}addReference(e,t,n){return Op(e,n)}removeReference(e,t,n){return Op(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Op(e,t)}Dr(e,t){return function(i,s){let o=!1;return WP(i).ne(l=>$P(i,l,s).next(d=>(d&&(o=!0),ve.resolve(!d)))).next(()=>o)}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),i=[];let s=0;return this.Sr(e,(o,l)=>{if(l<=t){const d=this.Dr(e,o).next(f=>{if(!f)return s++,n.getEntry(e,o).next(()=>(n.removeEntry(o,ct.min()),Ml(e).delete(function(y){return[0,Jr(y.path)]}(o))))});i.push(d)}}).next(()=>ve.waitFor(i)).next(()=>n.apply(e)).next(()=>s)}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Op(e,t)}Sr(e,t){const n=Ml(e);let i,s=zi.le;return n.te({index:yb},([o,l],{path:d,sequenceNumber:f})=>{o===0?(s!==zi.le&&t(new He(Co(i)),s),s=f,i=d):s=zi.le}).next(()=>{s!==zi.le&&t(new He(Co(i)),s)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Op(r,e){return Ml(r).put(function(n,i){return{targetId:0,path:Jr(n.path),sequenceNumber:i}}(e,r.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(){this.changes=new Oa(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Hn.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return n!==void 0?ve.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class b6{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Mc(e).put(n)}removeEntry(e,t,n){return Mc(e).delete(function(s,o){const l=s.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],$g(o),l[l.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next(n=>(n.byteSize+=t,this.vr(e,n)))}getEntry(e,t){let n=Hn.newInvalidDocument(t);return Mc(e).te({index:dg,range:IDBKeyRange.only(zh(t))},(i,s)=>{n=this.Cr(t,s)}).next(()=>n)}Fr(e,t){let n={size:0,document:Hn.newInvalidDocument(t)};return Mc(e).te({index:dg,range:IDBKeyRange.only(zh(t))},(i,s)=>{n={document:this.Cr(t,s),size:Gg(s)}}).next(()=>n)}getEntries(e,t){let n=rs();return this.Mr(e,t,(i,s)=>{const o=this.Cr(i,s);n=n.insert(i,o)}).next(()=>n)}Or(e,t){let n=rs(),i=new Nn(He.comparator);return this.Mr(e,t,(s,o)=>{const l=this.Cr(s,o);n=n.insert(s,l),i=i.insert(s,Gg(o))}).next(()=>({documents:n,Nr:i}))}Mr(e,t,n){if(t.isEmpty())return ve.resolve();let i=new pn(vT);t.forEach(d=>i=i.add(d));const s=IDBKeyRange.bound(zh(i.first()),zh(i.last())),o=i.getIterator();let l=o.getNext();return Mc(e).te({index:dg,range:s},(d,f,m)=>{const y=He.fromSegments([...f.prefixPath,f.collectionGroup,f.documentId]);for(;l&&vT(l,y)<0;)n(l,null),l=o.getNext();l&&l.isEqual(y)&&(n(l,f),l=o.hasNext()?o.getNext():null),l?m.H(zh(l)):m.done()}).next(()=>{for(;l;)n(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,t,n,i,s){const o=t.path,l=[o.popLast().toArray(),o.lastSegment(),$g(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],d=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Mc(e).J(IDBKeyRange.bound(l,d,!0)).next(f=>{s==null||s.incrementDocumentReadCount(f.length);let m=rs();for(const y of f){const g=this.Cr(He.fromSegments(y.prefixPath.concat(y.collectionGroup,y.documentId)),y);g.isFoundDocument()&&(xm(t,g)||i.has(g.key))&&(m=m.insert(g.key,g))}return m})}getAllFromCollectionGroup(e,t,n,i){let s=rs();const o=yT(t,n),l=yT(t,os.max());return Mc(e).te({index:Dk,range:IDBKeyRange.bound(o,l,!0)},(d,f,m)=>{const y=this.Cr(He.fromSegments(f.prefixPath.concat(f.collectionGroup,f.documentId)),f);s=s.insert(y.key,y),s.size===i&&m.done()}).next(()=>s)}newChangeBuffer(e){return new w6(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(t=>t.byteSize)}getMetadata(e){return gT(e).get(ax).next(t=>(it(!!t,20021),t))}vr(e,t){return gT(e).put(ax,t)}Cr(e,t){if(t){const n=o6(this.serializer,t);if(!(n.isNoDocument()&&n.version.isEqual(ct.min())))return n}return Hn.newInvalidDocument(e)}}function ZP(r){return new b6(r)}class w6 extends YP{constructor(e,t){super(),this.Br=e,this.trackRemovals=t,this.Lr=new Oa(n=>n.toString(),(n,i)=>n.isEqual(i))}applyChanges(e){const t=[];let n=0,i=new pn((s,o)=>bt(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{const l=this.Lr.get(s);if(t.push(this.Br.removeEntry(e,s,l.readTime)),o.isValidDocument()){const d=JS(this.Br.serializer,o);i=i.add(s.path.popLast());const f=Gg(d);n+=f-l.size,t.push(this.Br.addEntry(e,s,d))}else if(n-=l.size,this.trackRemovals){const d=JS(this.Br.serializer,o.convertToNoDocument(ct.min()));t.push(this.Br.addEntry(e,s,d))}}),i.forEach(s=>{t.push(this.Br.indexManager.addToCollectionParentIndex(e,s))}),t.push(this.Br.updateMetadata(e,n)),ve.waitFor(t)}getFromCache(e,t){return this.Br.Fr(e,t).next(n=>(this.Lr.set(t,{size:n.size,readTime:n.document.readTime}),n.document))}getAllFromCache(e,t){return this.Br.Or(e,t).next(({documents:n,Nr:i})=>(i.forEach((s,o)=>{this.Lr.set(s,{size:o,readTime:n.get(s).readTime})}),n))}}function gT(r){return gr(r,$f)}function Mc(r){return gr(r,Lg)}function zh(r){const e=r.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function yT(r,e){const t=e.documentKey.path.toArray();return[r,$g(e.readTime),t.slice(0,t.length-2),t.length>0?t[t.length-1]:""]}function vT(r,e){const t=r.path.toArray(),n=e.path.toArray();let i=0;for(let s=0;s<t.length-2&&s<n.length-2;++s)if(i=bt(t[s],n[s]),i)return i;return i=bt(t.length,n.length),i||(i=bt(t[t.length-2],n[n.length-2]),i||bt(t[t.length-1],n[n.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E6{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QP{constructor(e,t,n,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=i}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(n=i,this.remoteDocumentCache.getEntry(e,t))).next(i=>(n!==null&&Pf(n.mutation,i,Bi.empty(),jt.now()),i))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.getLocalViewOfDocuments(e,n,Lt()).next(()=>n))}getLocalViewOfDocuments(e,t,n=Lt()){const i=Ro();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,n).next(s=>{let o=uf();return s.forEach((l,d)=>{o=o.insert(l,d.overlayedDocument)}),o}))}getOverlayedDocuments(e,t){const n=Ro();return this.populateOverlays(e,n,t).next(()=>this.computeViews(e,t,n,Lt()))}populateOverlays(e,t,n){const i=[];return n.forEach(s=>{t.has(s)||i.push(s)}),this.documentOverlayCache.getOverlays(e,i).next(s=>{s.forEach((o,l)=>{t.set(o,l)})})}computeViews(e,t,n,i){let s=rs();const o=kf(),l=function(){return kf()}();return t.forEach((d,f)=>{const m=n.get(f.key);i.has(f.key)&&(m===void 0||m.mutation instanceof Ma)?s=s.insert(f.key,f):m!==void 0?(o.set(f.key,m.mutation.getFieldMask()),Pf(m.mutation,f,m.mutation.getFieldMask(),jt.now())):o.set(f.key,Bi.empty())}),this.recalculateAndSaveOverlays(e,s).next(d=>(d.forEach((f,m)=>o.set(f,m)),t.forEach((f,m)=>{var y;return l.set(f,new E6(m,(y=o.get(f))!==null&&y!==void 0?y:null))}),l))}recalculateAndSaveOverlays(e,t){const n=kf();let i=new Nn((o,l)=>o-l),s=Lt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(o=>{for(const l of o)l.keys().forEach(d=>{const f=t.get(d);if(f===null)return;let m=n.get(d)||Bi.empty();m=l.applyToLocalView(f,m),n.set(d,m);const y=(i.get(l.batchId)||Lt()).add(d);i=i.insert(l.batchId,y)})}).next(()=>{const o=[],l=i.getReverseIterator();for(;l.hasNext();){const d=l.getNext(),f=d.key,m=d.value,y=gP();m.forEach(g=>{if(!s.has(g)){const _=wP(t.get(g),n.get(g));_!==null&&y.set(g,_),s=s.add(g)}}),o.push(this.documentOverlayCache.saveOverlays(e,f,y))}return ve.waitFor(o)}).next(()=>n)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(n=>this.recalculateAndSaveOverlays(e,n))}getDocumentsMatchingQuery(e,t,n,i){return function(o){return He.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):cP(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,i):this.getDocumentsMatchingCollectionQuery(e,t,n,i)}getNextDocuments(e,t,n,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,i).next(s=>{const o=i-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,i-s.size):ve.resolve(Ro());let l=Td,d=s;return o.next(f=>ve.forEach(f,(m,y)=>(l<y.largestBatchId&&(l=y.largestBatchId),s.get(m)?ve.resolve():this.remoteDocumentCache.getEntry(e,m).next(g=>{d=d.insert(m,g)}))).next(()=>this.populateOverlays(e,f,s)).next(()=>this.computeViews(e,d,f,Lt())).next(m=>({batchId:l,changes:pP(m)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new He(t)).next(n=>{let i=uf();return n.isFoundDocument()&&(i=i.insert(n.key,n)),i})}getDocumentsMatchingCollectionGroupQuery(e,t,n,i){const s=t.collectionGroup;let o=uf();return this.indexManager.getCollectionParents(e,s).next(l=>ve.forEach(l,d=>{const f=function(y,g){return new Kd(g,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(t,d.child(s));return this.getDocumentsMatchingCollectionQuery(e,f,n,i).next(m=>{m.forEach((y,g)=>{o=o.insert(y,g)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,t,n,i){let s;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,s,i))).next(o=>{s.forEach((d,f)=>{const m=f.getKey();o.get(m)===null&&(o=o.insert(m,Hn.newInvalidDocument(m)))});let l=uf();return o.forEach((d,f)=>{const m=s.get(d);m!==void 0&&Pf(m.mutation,f,Bi.empty(),jt.now()),xm(t,f)&&(l=l.insert(d,f))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S6{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,t){return ve.resolve(this.kr.get(t))}saveBundleMetadata(e,t){return this.kr.set(t.id,function(i){return{id:i.id,version:i.version,createTime:fi(i.createTime)}}(t)),ve.resolve()}getNamedQuery(e,t){return ve.resolve(this.qr.get(t))}saveNamedQuery(e,t){return this.qr.set(t.name,function(i){return{name:i.name,query:zP(i.bundledQuery),readTime:fi(i.readTime)}}(t)),ve.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class T6{constructor(){this.overlays=new Nn(He.comparator),this.Qr=new Map}getOverlay(e,t){return ve.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Ro();return ve.forEach(t,i=>this.getOverlay(e,i).next(s=>{s!==null&&n.set(i,s)})).next(()=>n)}saveOverlays(e,t,n){return n.forEach((i,s)=>{this.St(e,t,s)}),ve.resolve()}removeOverlaysForBatchId(e,t,n){const i=this.Qr.get(n);return i!==void 0&&(i.forEach(s=>this.overlays=this.overlays.remove(s)),this.Qr.delete(n)),ve.resolve()}getOverlaysForCollection(e,t,n){const i=Ro(),s=t.length+1,o=new He(t.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const d=l.getNext().value,f=d.getKey();if(!t.isPrefixOf(f.path))break;f.path.length===s&&d.largestBatchId>n&&i.set(d.getKey(),d)}return ve.resolve(i)}getOverlaysForCollectionGroup(e,t,n,i){let s=new Nn((f,m)=>f-m);const o=this.overlays.getIterator();for(;o.hasNext();){const f=o.getNext().value;if(f.getKey().getCollectionGroup()===t&&f.largestBatchId>n){let m=s.get(f.largestBatchId);m===null&&(m=Ro(),s=s.insert(f.largestBatchId,m)),m.set(f.getKey(),f)}}const l=Ro(),d=s.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((f,m)=>l.set(f,m)),!(l.size()>=i)););return ve.resolve(l)}St(e,t,n){const i=this.overlays.get(n.key);if(i!==null){const o=this.Qr.get(i.largestBatchId).delete(n.key);this.Qr.set(i.largestBatchId,o)}this.overlays=this.overlays.insert(n.key,new Pb(t,n));let s=this.Qr.get(t);s===void 0&&(s=Lt(),this.Qr.set(t,s)),this.Qr.set(t,s.add(n.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class A6{constructor(){this.sessionToken=Xn.EMPTY_BYTE_STRING}getSessionToken(e){return ve.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,ve.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Db{constructor(){this.$r=new pn(Sr.Ur),this.Kr=new pn(Sr.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,t){const n=new Sr(e,t);this.$r=this.$r.add(n),this.Kr=this.Kr.add(n)}Gr(e,t){e.forEach(n=>this.addReference(n,t))}removeReference(e,t){this.zr(new Sr(e,t))}jr(e,t){e.forEach(n=>this.removeReference(n,t))}Hr(e){const t=new He(new sn([])),n=new Sr(t,e),i=new Sr(t,e+1),s=[];return this.Kr.forEachInRange([n,i],o=>{this.zr(o),s.push(o.key)}),s}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const t=new He(new sn([])),n=new Sr(t,e),i=new Sr(t,e+1);let s=Lt();return this.Kr.forEachInRange([n,i],o=>{s=s.add(o.key)}),s}containsKey(e){const t=new Sr(e,0),n=this.$r.firstAfterOrEqual(t);return n!==null&&e.isEqual(n.key)}}class Sr{constructor(e,t){this.key=e,this.Zr=t}static Ur(e,t){return He.comparator(e.key,t.key)||bt(e.Zr,t.Zr)}static Wr(e,t){return bt(e.Zr,t.Zr)||He.comparator(e.key,t.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N6{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nr=1,this.Xr=new pn(Sr.Ur)}checkEmpty(e){return ve.resolve(this.mutationQueue.length===0)}addMutationBatch(e,t,n,i){const s=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new Ib(s,t,n,i);this.mutationQueue.push(o);for(const l of i)this.Xr=this.Xr.add(new Sr(l.key,s)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return ve.resolve(o)}lookupMutationBatch(e,t){return ve.resolve(this.ei(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,i=this.ti(n),s=i<0?0:i;return ve.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return ve.resolve(this.mutationQueue.length===0?Qc:this.nr-1)}getAllMutationBatches(e){return ve.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Sr(t,0),i=new Sr(t,Number.POSITIVE_INFINITY),s=[];return this.Xr.forEachInRange([n,i],o=>{const l=this.ei(o.Zr);s.push(l)}),ve.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new pn(bt);return t.forEach(i=>{const s=new Sr(i,0),o=new Sr(i,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([s,o],l=>{n=n.add(l.Zr)})}),ve.resolve(this.ni(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,i=n.length+1;let s=n;He.isDocumentKey(s)||(s=s.child(""));const o=new Sr(new He(s),0);let l=new pn(bt);return this.Xr.forEachWhile(d=>{const f=d.key.path;return!!n.isPrefixOf(f)&&(f.length===i&&(l=l.add(d.Zr)),!0)},o),ve.resolve(this.ni(l))}ni(e){const t=[];return e.forEach(n=>{const i=this.ei(n);i!==null&&t.push(i)}),t}removeMutationBatch(e,t){it(this.ri(t.batchId,"removed")===0,55003),this.mutationQueue.shift();let n=this.Xr;return ve.forEach(t.mutations,i=>{const s=new Sr(i.key,t.batchId);return n=n.delete(s),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.Xr=n})}sr(e){}containsKey(e,t){const n=new Sr(t,0),i=this.Xr.firstAfterOrEqual(n);return ve.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,ve.resolve()}ri(e,t){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const t=this.ti(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class I6{constructor(e){this.ii=e,this.docs=function(){return new Nn(He.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,i=this.docs.get(n),s=i?i.size:0,o=this.ii(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return ve.resolve(n?n.document.mutableCopy():Hn.newInvalidDocument(t))}getEntries(e,t){let n=rs();return t.forEach(i=>{const s=this.docs.get(i);n=n.insert(i,s?s.document.mutableCopy():Hn.newInvalidDocument(i))}),ve.resolve(n)}getDocumentsMatchingQuery(e,t,n,i){let s=rs();const o=t.path,l=new He(o.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(l);for(;d.hasNext();){const{key:f,value:{document:m}}=d.getNext();if(!o.isPrefixOf(f.path))break;f.path.length>o.length+1||pb(Pk(m),n)<=0||(i.has(m.key)||xm(t,m))&&(s=s.insert(m.key,m.mutableCopy()))}return ve.resolve(s)}getAllFromCollectionGroup(e,t,n,i){Ze(9500)}si(e,t){return ve.forEach(this.docs,n=>t(n))}newChangeBuffer(e){return new k6(this)}getSize(e){return ve.resolve(this.size)}}class k6 extends YP{constructor(e){super(),this.Br=e}applyChanges(e){const t=[];return this.changes.forEach((n,i)=>{i.isValidDocument()?t.push(this.Br.addEntry(e,i)):this.Br.removeEntry(n)}),ve.waitFor(t)}getFromCache(e,t){return this.Br.getEntry(e,t)}getAllFromCache(e,t){return this.Br.getEntries(e,t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P6{constructor(e){this.persistence=e,this.oi=new Oa(t=>lu(t),vm),this.lastRemoteSnapshotVersion=ct.min(),this.highestTargetId=0,this._i=0,this.ai=new Db,this.targetCount=0,this.ui=hu.cr()}forEachTarget(e,t){return this.oi.forEach((n,i)=>t(i)),ve.resolve()}getLastRemoteSnapshotVersion(e){return ve.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ve.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),ve.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this._i&&(this._i=t),ve.resolve()}Tr(e){this.oi.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ui=new hu(t),this.highestTargetId=t),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,t){return this.Tr(t),this.targetCount+=1,ve.resolve()}updateTargetData(e,t){return this.Tr(t),ve.resolve()}removeTargetData(e,t){return this.oi.delete(t.target),this.ai.Hr(t.targetId),this.targetCount-=1,ve.resolve()}removeTargets(e,t,n){let i=0;const s=[];return this.oi.forEach((o,l)=>{l.sequenceNumber<=t&&n.get(l.targetId)===null&&(this.oi.delete(o),s.push(this.removeMatchingKeysForTargetId(e,l.targetId)),i++)}),ve.waitFor(s).next(()=>i)}getTargetCount(e){return ve.resolve(this.targetCount)}getTargetData(e,t){const n=this.oi.get(t)||null;return ve.resolve(n)}addMatchingKeys(e,t,n){return this.ai.Gr(t,n),ve.resolve()}removeMatchingKeys(e,t,n){this.ai.jr(t,n);const i=this.persistence.referenceDelegate,s=[];return i&&t.forEach(o=>{s.push(i.markPotentiallyOrphaned(e,o))}),ve.waitFor(s)}removeMatchingKeysForTargetId(e,t){return this.ai.Hr(t),ve.resolve()}getMatchingKeysForTargetId(e,t){const n=this.ai.Yr(t);return ve.resolve(n)}containsKey(e,t){return ve.resolve(this.ai.containsKey(t))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lb{constructor(e,t){this.ci={},this.overlays={},this.li=new zi(0),this.hi=!1,this.hi=!0,this.Pi=new A6,this.referenceDelegate=e(this),this.Ti=new P6(this),this.indexManager=new m6,this.remoteDocumentCache=function(i){return new I6(i)}(n=>this.referenceDelegate.Ii(n)),this.serializer=new FP(t),this.Ei=new S6(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new T6,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ci[e.toKey()];return n||(n=new N6(t,this.referenceDelegate),this.ci[e.toKey()]=n),n}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,t,n){Re("MemoryPersistence","Starting transaction:",e);const i=new C6(this.li.next());return this.referenceDelegate.di(),n(i).next(s=>this.referenceDelegate.Ai(i).next(()=>s)).toPromise().then(s=>(i.raiseOnCommittedEvent(),s))}Ri(e,t){return ve.or(Object.values(this.ci).map(n=>()=>n.containsKey(e,t)))}}class C6 extends Rk{constructor(e){super(),this.currentSequenceNumber=e}}class Fy{constructor(e){this.persistence=e,this.Vi=new Db,this.mi=null}static fi(e){return new Fy(e)}get gi(){if(this.mi)return this.mi;throw Ze(60996)}addReference(e,t,n){return this.Vi.addReference(n,t),this.gi.delete(n.toString()),ve.resolve()}removeReference(e,t,n){return this.Vi.removeReference(n,t),this.gi.add(n.toString()),ve.resolve()}markPotentiallyOrphaned(e,t){return this.gi.add(t.toString()),ve.resolve()}removeTarget(e,t){this.Vi.Hr(t.targetId).forEach(i=>this.gi.add(i.toString()));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next(i=>{i.forEach(s=>this.gi.add(s.toString()))}).next(()=>n.removeTargetData(e,t))}di(){this.mi=new Set}Ai(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ve.forEach(this.gi,n=>{const i=He.fromPath(n);return this.pi(e,i).next(s=>{s||t.removeEntry(i,ct.min())})}).next(()=>(this.mi=null,t.apply(e)))}updateLimboDocument(e,t){return this.pi(e,t).next(n=>{n?this.gi.delete(t.toString()):this.gi.add(t.toString())})}Ii(e){return 0}pi(e,t){return ve.or([()=>ve.resolve(this.Vi.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ri(e,t)])}}class Kg{constructor(e,t){this.persistence=e,this.yi=new Oa(n=>Jr(n.path),(n,i)=>n.isEqual(i)),this.garbageCollector=KP(this,t)}static fi(e,t){return new Kg(e,t)}di(){}Ai(e){return ve.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}pr(e){const t=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(n=>t.next(i=>n+i))}br(e){let t=0;return this.yr(e,n=>{t++}).next(()=>t)}yr(e,t){return ve.forEach(this.yi,(n,i)=>this.Dr(e,n,i).next(s=>s?ve.resolve():t(i)))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const i=this.persistence.getRemoteDocumentCache(),s=i.newChangeBuffer();return i.si(e,o=>this.Dr(e,o,t).next(l=>{l||(n++,s.removeEntry(o,ct.min()))})).next(()=>s.apply(e)).next(()=>n)}markPotentiallyOrphaned(e,t){return this.yi.set(t,e.currentSequenceNumber),ve.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.yi.set(n,e.currentSequenceNumber),ve.resolve()}removeReference(e,t,n){return this.yi.set(n,e.currentSequenceNumber),ve.resolve()}updateLimboDocument(e,t){return this.yi.set(t,e.currentSequenceNumber),ve.resolve()}Ii(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=fg(e.data.value)),t}Dr(e,t,n){return ve.or([()=>this.persistence.Ri(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const i=this.yi.get(t);return ve.resolve(i!==void 0&&i>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class R6{constructor(e){this.serializer=e}q(e,t,n,i){const s=new Ay("createOrUpgrade",t);n<1&&i>=1&&(function(d){d.createObjectStore(ym)}(e),function(d){d.createObjectStore(Hf,{keyPath:HM}),d.createObjectStore(io,{keyPath:kS,autoIncrement:!0}).createIndex(Yc,PS,{unique:!0}),d.createObjectStore(Ad)}(e),_T(e),function(d){d.createObjectStore(Bc)}(e));let o=ve.resolve();return n<3&&i>=3&&(n!==0&&(function(d){d.deleteObjectStore(Id),d.deleteObjectStore(Nd),d.deleteObjectStore(Xc)}(e),_T(e)),o=o.next(()=>function(d){const f=d.store(Xc),m={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:ct.min().toTimestamp(),targetCount:0};return f.put(Fg,m)}(s))),n<4&&i>=4&&(n!==0&&(o=o.next(()=>function(d,f){return f.store(io).J().next(y=>{d.deleteObjectStore(io),d.createObjectStore(io,{keyPath:kS,autoIncrement:!0}).createIndex(Yc,PS,{unique:!0});const g=f.store(io),_=y.map(E=>g.put(E));return ve.waitFor(_)})}(e,s))),o=o.next(()=>{(function(d){d.createObjectStore(kd,{keyPath:JM})})(e)})),n<5&&i>=5&&(o=o.next(()=>this.wi(s))),n<6&&i>=6&&(o=o.next(()=>(function(d){d.createObjectStore($f)}(e),this.bi(s)))),n<7&&i>=7&&(o=o.next(()=>this.Si(s))),n<8&&i>=8&&(o=o.next(()=>this.Di(e,s))),n<9&&i>=9&&(o=o.next(()=>{(function(d){d.objectStoreNames.contains("remoteDocumentChanges")&&d.deleteObjectStore("remoteDocumentChanges")})(e)})),n<10&&i>=10&&(o=o.next(()=>this.Ci(s))),n<11&&i>=11&&(o=o.next(()=>{(function(d){d.createObjectStore(Iy,{keyPath:eD})})(e),function(d){d.createObjectStore(ky,{keyPath:tD})}(e)})),n<12&&i>=12&&(o=o.next(()=>{(function(d){const f=d.createObjectStore(Py,{keyPath:lD});f.createIndex(cx,cD,{unique:!1}),f.createIndex(zk,uD,{unique:!1})})(e)})),n<13&&i>=13&&(o=o.next(()=>function(d){const f=d.createObjectStore(Lg,{keyPath:WM});f.createIndex(dg,GM),f.createIndex(Dk,KM)}(e)).next(()=>this.Fi(e,s)).next(()=>e.deleteObjectStore(Bc))),n<14&&i>=14&&(o=o.next(()=>this.Mi(e,s))),n<15&&i>=15&&(o=o.next(()=>function(d){d.createObjectStore(vb,{keyPath:nD,autoIncrement:!0}).createIndex(lx,rD,{unique:!1}),d.createObjectStore(Tf,{keyPath:iD}).createIndex(Fk,sD,{unique:!1}),d.createObjectStore(Af,{keyPath:oD}).createIndex(Vk,aD,{unique:!1})}(e))),n<16&&i>=16&&(o=o.next(()=>{t.objectStore(Tf).clear()}).next(()=>{t.objectStore(Af).clear()})),n<17&&i>=17&&(o=o.next(()=>{(function(d){d.createObjectStore(_b,{keyPath:dD})})(e)})),n<18&&i>=18&&k4()&&(o=o.next(()=>{t.objectStore(Tf).clear()}).next(()=>{t.objectStore(Af).clear()})),o}bi(e){let t=0;return e.store(Bc).te((n,i)=>{t+=Gg(i)}).next(()=>{const n={byteSize:t};return e.store($f).put(ax,n)})}wi(e){const t=e.store(Hf),n=e.store(io);return t.J().next(i=>ve.forEach(i,s=>{const o=IDBKeyRange.bound([s.userId,Qc],[s.userId,s.lastAcknowledgedBatchId]);return n.J(Yc,o).next(l=>ve.forEach(l,d=>{it(d.userId===s.userId,18650,"Cannot process batch from unexpected user",{batchId:d.batchId});const f=$c(this.serializer,d);return HP(e,s.userId,f).next(()=>{})}))}))}Si(e){const t=e.store(Id),n=e.store(Bc);return e.store(Xc).get(Fg).next(i=>{const s=[];return n.te((o,l)=>{const d=new sn(o),f=function(y){return[0,Jr(y)]}(d);s.push(t.get(f).next(m=>m?ve.resolve():(y=>t.put({targetId:0,path:Jr(y),sequenceNumber:i.highestListenSequenceNumber}))(d)))}).next(()=>ve.waitFor(s))})}Di(e,t){e.createObjectStore(Wf,{keyPath:XM});const n=t.store(Wf),i=new Mb,s=o=>{if(i.add(o)){const l=o.lastSegment(),d=o.popLast();return n.put({collectionId:l,parent:Jr(d)})}};return t.store(Bc).te({ee:!0},(o,l)=>{const d=new sn(o);return s(d.popLast())}).next(()=>t.store(Ad).te({ee:!0},([o,l,d],f)=>{const m=Co(l);return s(m.popLast())}))}Ci(e){const t=e.store(Nd);return t.te((n,i)=>{const s=hf(i),o=VP(this.serializer,s);return t.put(o)})}Fi(e,t){const n=t.store(Bc),i=[];return n.te((s,o)=>{const l=t.store(Lg),d=function(y){return y.document?new He(sn.fromString(y.document.name).popFirst(5)):y.noDocument?He.fromSegments(y.noDocument.path):y.unknownDocument?He.fromSegments(y.unknownDocument.path):Ze(36783)}(o).path.toArray(),f={prefixPath:d.slice(0,d.length-2),collectionGroup:d[d.length-2],documentId:d[d.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};i.push(l.put(f))}).next(()=>ve.waitFor(i))}Mi(e,t){const n=t.store(io),i=ZP(this.serializer),s=new Lb(Fy.fi,this.serializer.wt);return n.J().next(o=>{const l=new Map;return o.forEach(d=>{var f;let m=(f=l.get(d.userId))!==null&&f!==void 0?f:Lt();$c(this.serializer,d).keys().forEach(y=>m=m.add(y)),l.set(d.userId,m)}),ve.forEach(l,(d,f)=>{const m=new Tr(f),y=Dy.bt(this.serializer,m),g=s.getIndexManager(m),_=Ly.bt(m,this.serializer,g,s.referenceDelegate);return new QP(i,_,y,g).recalculateAndSaveOverlaysForDocumentKeys(new ux(t,zi.le),d).next()})})}}function _T(r){r.createObjectStore(Id,{keyPath:ZM}).createIndex(yb,QM,{unique:!0}),r.createObjectStore(Nd,{keyPath:"targetId"}).createIndex(Lk,YM,{unique:!0}),r.createObjectStore(Xc)}const kl="IndexedDbPersistence",Vv=18e5,zv=5e3,Bv="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",j6="main";class Fb{constructor(e,t,n,i,s,o,l,d,f,m,y=18){if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.xi=s,this.window=o,this.document=l,this.Oi=f,this.Ni=m,this.Bi=y,this.li=null,this.hi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Li=null,this.inForeground=!1,this.ki=null,this.qi=null,this.Qi=Number.NEGATIVE_INFINITY,this.$i=g=>Promise.resolve(),!Fb.C())throw new Ue(Ie.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new x6(this,i),this.Ui=t+j6,this.serializer=new FP(d),this.Ki=new $l(this.Ui,this.Bi,new R6(this.serializer)),this.Pi=new l6,this.Ti=new g6(this.referenceDelegate,this.serializer),this.remoteDocumentCache=ZP(this.serializer),this.Ei=new a6,this.window&&this.window.localStorage?this.Wi=this.window.localStorage:(this.Wi=null,m===!1&&Zn(kl,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Gi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new Ue(Ie.FAILED_PRECONDITION,Bv);return this.zi(),this.ji(),this.Hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ti.getHighestSequenceNumber(e))}).then(e=>{this.li=new zi(e,this.Oi)}).then(()=>{this.hi=!0}).catch(e=>(this.Ki&&this.Ki.close(),Promise.reject(e)))}Ji(e){return this.$i=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ki.U(async t=>{t.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.xi.enqueueAndForget(async()=>{this.started&&await this.Gi()}))}Gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>Mp(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Yi(e).next(t=>{t||(this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)))})}).next(()=>this.Zi(e)).next(t=>this.isPrimary&&!t?this.Xi(e).next(()=>!1):!!t&&this.es(e).next(()=>!0))).catch(e=>{if(lc(e))return Re(kl,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Re(kl,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.xi.enqueueRetryable(()=>this.$i(e)),this.isPrimary=e})}Yi(e){return Bh(e).get(Ju).next(t=>ve.resolve(this.ts(t)))}ns(e){return Mp(e).delete(this.clientId)}async rs(){if(this.isPrimary&&!this.ss(this.Qi,Vv)){this.Qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",t=>{const n=gr(t,kd);return n.J().next(i=>{const s=this._s(i,Vv),o=i.filter(l=>s.indexOf(l)===-1);return ve.forEach(o,l=>n.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Wi)for(const t of e)this.Wi.removeItem(this.us(t.clientId))}}Hi(){this.qi=this.xi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Gi().then(()=>this.rs()).then(()=>this.Hi()))}ts(e){return!!e&&e.ownerId===this.clientId}Zi(e){return this.Ni?ve.resolve(!0):Bh(e).get(Ju).next(t=>{if(t!==null&&this.ss(t.leaseTimestampMs,zv)&&!this.cs(t.ownerId)){if(this.ts(t)&&this.networkEnabled)return!0;if(!this.ts(t)){if(!t.allowTabSynchronization)throw new Ue(Ie.FAILED_PRECONDITION,Bv);return!1}}return!(!this.networkEnabled||!this.inForeground)||Mp(e).J().next(n=>this._s(n,zv).find(i=>{if(this.clientId!==i.clientId){const s=!this.networkEnabled&&i.networkEnabled,o=!this.inForeground&&i.inForeground,l=this.networkEnabled===i.networkEnabled;if(s||o&&l)return!0}return!1})===void 0)}).next(t=>(this.isPrimary!==t&&Re(kl,`Client ${t?"is":"is not"} eligible for a primary lease.`),t))}async shutdown(){this.hi=!1,this.ls(),this.qi&&(this.qi.cancel(),this.qi=null),this.hs(),this.Ps(),await this.Ki.runTransaction("shutdown","readwrite",[ym,kd],e=>{const t=new ux(e,zi.le);return this.Xi(t).next(()=>this.ns(t))}),this.Ki.close(),this.Ts()}_s(e,t){return e.filter(n=>this.ss(n.updateTimeMs,t)&&!this.cs(n.clientId))}Is(){return this.runTransaction("getActiveClients","readonly",e=>Mp(e).J().next(t=>this._s(t,Vv).map(n=>n.clientId)))}get started(){return this.hi}getGlobalsCache(){return this.Pi}getMutationQueue(e,t){return Ly.bt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new p6(e,this.serializer.wt.databaseId)}getDocumentOverlayCache(e){return Dy.bt(this.serializer,e)}getBundleCache(){return this.Ei}runTransaction(e,t,n){Re(kl,"Starting transaction:",e);const i=t==="readonly"?"readonly":"readwrite",s=function(d){return d===18?mD:d===17?Hk:d===16?fD:d===15?xb:d===14?qk:d===13?Uk:d===12?hD:d===11?Bk:void Ze(60245)}(this.Bi);let o;return this.Ki.runTransaction(e,i,s,l=>(o=new ux(l,this.li?this.li.next():zi.le),t==="readwrite-primary"?this.Yi(o).next(d=>!!d||this.Zi(o)).next(d=>{if(!d)throw Zn(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)),new Ue(Ie.FAILED_PRECONDITION,Ck);return n(o)}).next(d=>this.es(o).next(()=>d)):this.Es(o).next(()=>n(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Es(e){return Bh(e).get(Ju).next(t=>{if(t!==null&&this.ss(t.leaseTimestampMs,zv)&&!this.cs(t.ownerId)&&!this.ts(t)&&!(this.Ni||this.allowTabSynchronization&&t.allowTabSynchronization))throw new Ue(Ie.FAILED_PRECONDITION,Bv)})}es(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return Bh(e).put(Ju,t)}static C(){return $l.C()}Xi(e){const t=Bh(e);return t.get(Ju).next(n=>this.ts(n)?(Re(kl,"Releasing primary lease."),t.delete(Ju)):ve.resolve())}ss(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(Zn(`Detected an update time that is in the future: ${e} > ${n}`),!1))}zi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ki=()=>{this.xi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Gi()))},this.document.addEventListener("visibilitychange",this.ki),this.inForeground=this.document.visibilityState==="visible")}hs(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)}ji(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Li=()=>{this.ls();const t=/(?:Version|Mobile)\/1[456]/;I4()&&(navigator.appVersion.match(t)||navigator.userAgent.match(t))&&this.xi.enterRestrictedMode(!0),this.xi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Li))}Ps(){this.Li&&(this.window.removeEventListener("pagehide",this.Li),this.Li=null)}cs(e){var t;try{const n=((t=this.Wi)===null||t===void 0?void 0:t.getItem(this.us(e)))!==null;return Re(kl,`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(n){return Zn(kl,"Failed to get zombied client id.",n),!1}}ls(){if(this.Wi)try{this.Wi.setItem(this.us(this.clientId),String(Date.now()))}catch(e){Zn("Failed to set zombie client id.",e)}}Ts(){if(this.Wi)try{this.Wi.removeItem(this.us(this.clientId))}catch{}}us(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function Bh(r){return gr(r,ym)}function Mp(r){return gr(r,kd)}function XP(r,e){let t=r.projectId;return r.isDefaultDatabase||(t+="."+r.database),"firestore/"+e+"/"+t+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vb{constructor(e,t,n,i){this.targetId=e,this.fromCache=t,this.ds=n,this.As=i}static Rs(e,t){let n=Lt(),i=Lt();for(const s of t.docChanges)switch(s.type){case 0:n=n.add(s.doc.key);break;case 1:i=i.add(s.doc.key)}return new Vb(e,t.fromCache,n,i)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class O6{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return I4()?8:jk(pr())>0?6:4}()}initialize(e,t){this.ys=e,this.indexManager=t,this.Vs=!0}getDocumentsMatchingQuery(e,t,n,i){const s={result:null};return this.ws(e,t).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.bs(e,t,i,n).next(o=>{s.result=o})}).next(()=>{if(s.result)return;const o=new O6;return this.Ss(e,t,o).next(l=>{if(s.result=l,this.fs)return this.Ds(e,t,o,l.size)})}).next(()=>s.result)}Ds(e,t,n,i){return n.documentReadCount<this.gs?(cd()<=Ut.DEBUG&&Re("QueryEngine","SDK will not create cache indexes for query:",ud(t),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),ve.resolve()):(cd()<=Ut.DEBUG&&Re("QueryEngine","Query:",ud(t),"scans",n.documentReadCount,"local documents and returns",i,"documents as results."),n.documentReadCount>this.ps*i?(cd()<=Ut.DEBUG&&Re("QueryEngine","The SDK decides to create cache indexes for query:",ud(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,is(t))):ve.resolve())}ws(e,t){if(qS(t))return ve.resolve(null);let n=is(t);return this.indexManager.getIndexType(e,n).next(i=>i===0?null:(t.limit!==null&&i===1&&(t=Ug(t,null,"F"),n=is(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next(s=>{const o=Lt(...s);return this.ys.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,n).next(d=>{const f=this.vs(t,l);return this.Cs(t,f,o,d.readTime)?this.ws(e,Ug(t,null,"F")):this.Fs(e,f,t,d)}))})))}bs(e,t,n,i){return qS(t)||i.isEqual(ct.min())?ve.resolve(null):this.ys.getDocuments(e,n).next(s=>{const o=this.vs(t,s);return this.Cs(t,o,n,i)?ve.resolve(null):(cd()<=Ut.DEBUG&&Re("QueryEngine","Re-using previous result from %s to execute query: %s",i.toString(),ud(t)),this.Fs(e,o,t,kk(i,Td)).next(l=>l))})}vs(e,t){let n=new pn(fP(e));return t.forEach((i,s)=>{xm(e,s)&&(n=n.add(s))}),n}Cs(e,t,n,i){if(e.limit===null)return!1;if(n.size!==t.size)return!0;const s=e.limitType==="F"?t.last():t.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(i)>0)}Ss(e,t,n){return cd()<=Ut.DEBUG&&Re("QueryEngine","Using full collection scan to execute query:",ud(t)),this.ys.getDocumentsMatchingQuery(e,t,os.min(),n)}Fs(e,t,n,i){return this.ys.getDocumentsMatchingQuery(e,n,i).next(s=>(t.forEach(o=>{s=s.insert(o.key,o)}),s))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zb="LocalStore",M6=3e8;class D6{constructor(e,t,n,i){this.persistence=e,this.Ms=t,this.serializer=i,this.xs=new Nn(bt),this.Os=new Oa(s=>lu(s),vm),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(n)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new QP(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.xs))}}function eC(r,e,t,n){return new D6(r,e,t,n)}async function tC(r,e){const t=et(r);return await t.persistence.runTransaction("Handle user change","readonly",n=>{let i;return t.mutationQueue.getAllMutationBatches(n).next(s=>(i=s,t.Ls(e),t.mutationQueue.getAllMutationBatches(n))).next(s=>{const o=[],l=[];let d=Lt();for(const f of i){o.push(f.batchId);for(const m of f.mutations)d=d.add(m.key)}for(const f of s){l.push(f.batchId);for(const m of f.mutations)d=d.add(m.key)}return t.localDocuments.getDocuments(n,d).next(f=>({ks:f,removedBatchIds:o,addedBatchIds:l}))})})}function L6(r,e){const t=et(r);return t.persistence.runTransaction("Acknowledge batch","readwrite-primary",n=>{const i=e.batch.keys(),s=t.Bs.newChangeBuffer({trackRemovals:!0});return function(l,d,f,m){const y=f.batch,g=y.keys();let _=ve.resolve();return g.forEach(E=>{_=_.next(()=>m.getEntry(d,E)).next(x=>{const b=f.docVersions.get(E);it(b!==null,48541),x.version.compareTo(b)<0&&(y.applyToRemoteDocument(x,f),x.isValidDocument()&&(x.setReadTime(f.commitVersion),m.addEntry(x)))})}),_.next(()=>l.mutationQueue.removeMutationBatch(d,y))}(t,n,e,s).next(()=>s.apply(n)).next(()=>t.mutationQueue.performConsistencyCheck(n)).next(()=>t.documentOverlayCache.removeOverlaysForBatchId(n,i,e.batch.batchId)).next(()=>t.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(n,function(l){let d=Lt();for(let f=0;f<l.mutationResults.length;++f)l.mutationResults[f].transformResults.length>0&&(d=d.add(l.batch.mutations[f].key));return d}(e))).next(()=>t.localDocuments.getDocuments(n,i))})}function nC(r){const e=et(r);return e.persistence.runTransaction("Get last remote snapshot version","readonly",t=>e.Ti.getLastRemoteSnapshotVersion(t))}function F6(r,e){const t=et(r),n=e.snapshotVersion;let i=t.xs;return t.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{const o=t.Bs.newChangeBuffer({trackRemovals:!0});i=t.xs;const l=[];e.targetChanges.forEach((m,y)=>{const g=i.get(y);if(!g)return;l.push(t.Ti.removeMatchingKeys(s,m.removedDocuments,y).next(()=>t.Ti.addMatchingKeys(s,m.addedDocuments,y)));let _=g.withSequenceNumber(s.currentSequenceNumber);e.targetMismatches.get(y)!==null?_=_.withResumeToken(Xn.EMPTY_BYTE_STRING,ct.min()).withLastLimboFreeSnapshotVersion(ct.min()):m.resumeToken.approximateByteSize()>0&&(_=_.withResumeToken(m.resumeToken,n)),i=i.insert(y,_),function(x,b,T){return x.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=M6?!0:T.addedDocuments.size+T.modifiedDocuments.size+T.removedDocuments.size>0}(g,_,m)&&l.push(t.Ti.updateTargetData(s,_))});let d=rs(),f=Lt();if(e.documentUpdates.forEach(m=>{e.resolvedLimboDocuments.has(m)&&l.push(t.persistence.referenceDelegate.updateLimboDocument(s,m))}),l.push(V6(s,o,e.documentUpdates).next(m=>{d=m.qs,f=m.Qs})),!n.isEqual(ct.min())){const m=t.Ti.getLastRemoteSnapshotVersion(s).next(y=>t.Ti.setTargetsMetadata(s,s.currentSequenceNumber,n));l.push(m)}return ve.waitFor(l).next(()=>o.apply(s)).next(()=>t.localDocuments.getLocalViewOfDocuments(s,d,f)).next(()=>d)}).then(s=>(t.xs=i,s))}function V6(r,e,t){let n=Lt(),i=Lt();return t.forEach(s=>n=n.add(s)),e.getEntries(r,n).next(s=>{let o=rs();return t.forEach((l,d)=>{const f=s.get(l);d.isFoundDocument()!==f.isFoundDocument()&&(i=i.add(l)),d.isNoDocument()&&d.version.isEqual(ct.min())?(e.removeEntry(l,d.readTime),o=o.insert(l,d)):!f.isValidDocument()||d.version.compareTo(f.version)>0||d.version.compareTo(f.version)===0&&f.hasPendingWrites?(e.addEntry(d),o=o.insert(l,d)):Re(zb,"Ignoring outdated watch update for ",l,". Current version:",f.version," Watch version:",d.version)}),{qs:o,Qs:i}})}function z6(r,e){const t=et(r);return t.persistence.runTransaction("Get next mutation batch","readonly",n=>(e===void 0&&(e=Qc),t.mutationQueue.getNextMutationBatchAfterBatchId(n,e)))}function Yg(r,e){const t=et(r);return t.persistence.runTransaction("Allocate target","readwrite",n=>{let i;return t.Ti.getTargetData(n,e).next(s=>s?(i=s,ve.resolve(i)):t.Ti.allocateTargetId(n).next(o=>(i=new wa(e,o,"TargetPurposeListen",n.currentSequenceNumber),t.Ti.addTargetData(n,i).next(()=>i))))}).then(n=>{const i=t.xs.get(n.targetId);return(i===null||n.snapshotVersion.compareTo(i.snapshotVersion)>0)&&(t.xs=t.xs.insert(n.targetId,n),t.Os.set(e,n.targetId)),n})}async function Ld(r,e,t){const n=et(r),i=n.xs.get(e),s=t?"readwrite":"readwrite-primary";try{t||await n.persistence.runTransaction("Release target",s,o=>n.persistence.referenceDelegate.removeTarget(o,i))}catch(o){if(!lc(o))throw o;Re(zb,`Failed to update sequence numbers for target ${e}: ${o}`)}n.xs=n.xs.remove(e),n.Os.delete(i.target)}function Sx(r,e,t){const n=et(r);let i=ct.min(),s=Lt();return n.persistence.runTransaction("Execute query","readwrite",o=>function(d,f,m){const y=et(d),g=y.Os.get(m);return g!==void 0?ve.resolve(y.xs.get(g)):y.Ti.getTargetData(f,m)}(n,o,is(e)).next(l=>{if(l)return i=l.lastLimboFreeSnapshotVersion,n.Ti.getMatchingKeysForTargetId(o,l.targetId).next(d=>{s=d})}).next(()=>n.Ms.getDocumentsMatchingQuery(o,e,t?i:ct.min(),t?s:Lt())).next(l=>(sC(n,hP(e),l),{documents:l,$s:s})))}function rC(r,e){const t=et(r),n=et(t.Ti),i=t.xs.get(e);return i?Promise.resolve(i.target):t.persistence.runTransaction("Get target data","readonly",s=>n.Rt(s,e).next(o=>o?o.target:null))}function iC(r,e){const t=et(r),n=t.Ns.get(e)||ct.min();return t.persistence.runTransaction("Get new document changes","readonly",i=>t.Bs.getAllFromCollectionGroup(i,e,kk(n,Td),Number.MAX_SAFE_INTEGER)).then(i=>(sC(t,e,i),i))}function sC(r,e,t){let n=r.Ns.get(e)||ct.min();t.forEach((i,s)=>{s.readTime.compareTo(n)>0&&(n=s.readTime)}),r.Ns.set(e,n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const oC="firestore_clients";function xT(r,e){return`${oC}_${r}_${e}`}const aC="firestore_mutations";function bT(r,e,t){let n=`${aC}_${r}_${t}`;return e.isAuthenticated()&&(n+=`_${e.uid}`),n}const lC="firestore_targets";function Uv(r,e){return`${lC}_${r}_${e}`}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Po="SharedClientState";class Zg{constructor(e,t,n,i){this.user=e,this.batchId=t,this.state=n,this.error=i}static Gs(e,t,n){const i=JSON.parse(n);let s,o=typeof i=="object"&&["pending","acknowledged","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return o&&i.error&&(o=typeof i.error.message=="string"&&typeof i.error.code=="string",o&&(s=new Ue(i.error.code,i.error.message))),o?new Zg(e,t,i.state,s):(Zn(Po,`Failed to parse mutation state for ID '${t}': ${n}`),null)}zs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Cf{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Gs(e,t){const n=JSON.parse(t);let i,s=typeof n=="object"&&["not-current","current","rejected"].indexOf(n.state)!==-1&&(n.error===void 0||typeof n.error=="object");return s&&n.error&&(s=typeof n.error.message=="string"&&typeof n.error.code=="string",s&&(i=new Ue(n.error.code,n.error.message))),s?new Cf(e,n.state,i):(Zn(Po,`Failed to parse target state for ID '${e}': ${t}`),null)}zs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Qg{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Gs(e,t){const n=JSON.parse(t);let i=typeof n=="object"&&n.activeTargetIds instanceof Array,s=Tb();for(let o=0;i&&o<n.activeTargetIds.length;++o)i=Ok(n.activeTargetIds[o]),s=s.add(n.activeTargetIds[o]);return i?new Qg(e,s):(Zn(Po,`Failed to parse client data for instance '${e}': ${t}`),null)}}class Bb{constructor(e,t){this.clientId=e,this.onlineState=t}static Gs(e){const t=JSON.parse(e);return typeof t=="object"&&["Unknown","Online","Offline"].indexOf(t.onlineState)!==-1&&typeof t.clientId=="string"?new Bb(t.clientId,t.onlineState):(Zn(Po,`Failed to parse online state: ${e}`),null)}}class Tx{constructor(){this.activeTargetIds=Tb()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class qv{constructor(e,t,n,i,s){this.window=e,this.xi=t,this.persistenceKey=n,this.Js=i,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.Ys=this.Zs.bind(this),this.Xs=new Nn(bt),this.started=!1,this.eo=[];const o=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.no=xT(this.persistenceKey,this.Js),this.ro=function(d){return`firestore_sequence_number_${d}`}(this.persistenceKey),this.Xs=this.Xs.insert(this.Js,new Tx),this.io=new RegExp(`^${oC}_${o}_([^_]*)$`),this.so=new RegExp(`^${aC}_${o}_(\\d+)(?:_(.*))?$`),this.oo=new RegExp(`^${lC}_${o}_(\\d+)$`),this._o=function(d){return`firestore_online_state_${d}`}(this.persistenceKey),this.ao=function(d){return`firestore_bundle_loaded_v2_${d}`}(this.persistenceKey),this.window.addEventListener("storage",this.Ys)}static C(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Is();for(const n of e){if(n===this.Js)continue;const i=this.getItem(xT(this.persistenceKey,n));if(i){const s=Qg.Gs(n,i);s&&(this.Xs=this.Xs.insert(s.clientId,s))}}this.uo();const t=this.storage.getItem(this._o);if(t){const n=this.co(t);n&&this.lo(n)}for(const n of this.eo)this.Zs(n);this.eo=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0}writeSequenceNumber(e){this.setItem(this.ro,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ho(this.Xs)}isActiveQueryTarget(e){let t=!1;return this.Xs.forEach((n,i)=>{i.activeTargetIds.has(e)&&(t=!0)}),t}addPendingMutation(e){this.Po(e,"pending")}updateMutationState(e,t,n){this.Po(e,t,n),this.To(e)}addLocalQueryTarget(e,t=!0){let n="not-current";if(this.isActiveQueryTarget(e)){const i=this.storage.getItem(Uv(this.persistenceKey,e));if(i){const s=Cf.Gs(e,i);s&&(n=s.state)}}return t&&this.Io.js(e),this.uo(),n}removeLocalQueryTarget(e){this.Io.Hs(e),this.uo()}isLocalQueryTarget(e){return this.Io.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Uv(this.persistenceKey,e))}updateQueryState(e,t,n){this.Eo(e,t,n)}handleUserChange(e,t,n){t.forEach(i=>{this.To(i)}),this.currentUser=e,n.forEach(i=>{this.addPendingMutation(i)})}setOnlineState(e){this.Ao(e)}notifyBundleLoaded(e){this.Ro(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.Ys),this.removeItem(this.no),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Re(Po,"READ",e,t),t}setItem(e,t){Re(Po,"SET",e,t),this.storage.setItem(e,t)}removeItem(e){Re(Po,"REMOVE",e),this.storage.removeItem(e)}Zs(e){const t=e;if(t.storageArea===this.storage){if(Re(Po,"EVENT",t.key,t.newValue),t.key===this.no)return void Zn("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.xi.enqueueRetryable(async()=>{if(this.started){if(t.key!==null){if(this.io.test(t.key)){if(t.newValue==null){const n=this.Vo(t.key);return this.mo(n,null)}{const n=this.fo(t.key,t.newValue);if(n)return this.mo(n.clientId,n)}}else if(this.so.test(t.key)){if(t.newValue!==null){const n=this.po(t.key,t.newValue);if(n)return this.yo(n)}}else if(this.oo.test(t.key)){if(t.newValue!==null){const n=this.wo(t.key,t.newValue);if(n)return this.bo(n)}}else if(t.key===this._o){if(t.newValue!==null){const n=this.co(t.newValue);if(n)return this.lo(n)}}else if(t.key===this.ro){const n=function(s){let o=zi.le;if(s!=null)try{const l=JSON.parse(s);it(typeof l=="number",30636,{So:s}),o=l}catch(l){Zn(Po,"Failed to read sequence number from WebStorage",l)}return o}(t.newValue);n!==zi.le&&this.sequenceNumberHandler(n)}else if(t.key===this.ao){const n=this.Do(t.newValue);await Promise.all(n.map(i=>this.syncEngine.vo(i)))}}}else this.eo.push(t)})}}get Io(){return this.Xs.get(this.Js)}uo(){this.setItem(this.no,this.Io.zs())}Po(e,t,n){const i=new Zg(this.currentUser,e,t,n),s=bT(this.persistenceKey,this.currentUser,e);this.setItem(s,i.zs())}To(e){const t=bT(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Ao(e){const t={clientId:this.Js,onlineState:e};this.storage.setItem(this._o,JSON.stringify(t))}Eo(e,t,n){const i=Uv(this.persistenceKey,e),s=new Cf(e,t,n);this.setItem(i,s.zs())}Ro(e){const t=JSON.stringify(Array.from(e));this.setItem(this.ao,t)}Vo(e){const t=this.io.exec(e);return t?t[1]:null}fo(e,t){const n=this.Vo(e);return Qg.Gs(n,t)}po(e,t){const n=this.so.exec(e),i=Number(n[1]),s=n[2]!==void 0?n[2]:null;return Zg.Gs(new Tr(s),i,t)}wo(e,t){const n=this.oo.exec(e),i=Number(n[1]);return Cf.Gs(i,t)}co(e){return Bb.Gs(e)}Do(e){return JSON.parse(e)}async yo(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.Co(e.batchId,e.state,e.error);Re(Po,`Ignoring mutation for non-active user ${e.user.uid}`)}bo(e){return this.syncEngine.Fo(e.targetId,e.state,e.error)}mo(e,t){const n=t?this.Xs.insert(e,t):this.Xs.remove(e),i=this.ho(this.Xs),s=this.ho(n),o=[],l=[];return s.forEach(d=>{i.has(d)||o.push(d)}),i.forEach(d=>{s.has(d)||l.push(d)}),this.syncEngine.Mo(o,l).then(()=>{this.Xs=n})}lo(e){this.Xs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ho(e){let t=Tb();return e.forEach((n,i)=>{t=t.unionWith(i.activeTargetIds)}),t}}class cC{constructor(){this.xo=new Tx,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,t,n){this.Oo[e]=t}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new Tx,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B6{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wT="ConnectivityMonitor";class ET{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){Re(wT,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){Re(wT,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Dp=null;function Ax(){return Dp===null?Dp=function(){return 268435456+Math.round(2147483648*Math.random())}():Dp++,"0x"+Dp.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hv="RestConnection",U6={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class q6{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Ko=t+"://"+e.host,this.Wo=`projects/${n}/databases/${i}`,this.Go=this.databaseId.database===Vg?`project_id=${n}`:`project_id=${n}&database_id=${i}`}zo(e,t,n,i,s){const o=Ax(),l=this.jo(e,t.toUriEncodedString());Re(Hv,`Sending RPC '${e}' ${o}:`,l,n);const d={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(d,i,s);const{host:f}=new URL(l),m=vu(f);return this.Jo(e,l,d,n,m).then(y=>(Re(Hv,`Received RPC '${e}' ${o}: `,y),y),y=>{throw ou(Hv,`RPC '${e}' ${o} failed with error: `,y,"url: ",l,"request:",n),y})}Yo(e,t,n,i,s,o){return this.zo(e,t,n,i,s)}Ho(e,t,n){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Gd}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach((i,s)=>e[s]=i),n&&n.headers.forEach((i,s)=>e[s]=i)}jo(e,t){const n=U6[e];return`${this.Ko}/v1/${t}:${n}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H6{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gr="WebChannelConnection";class $6 extends q6{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,i,s){const o=Ax();return new Promise((l,d)=>{const f=new _k;f.setWithCredentials(!0),f.listenOnce(xk.COMPLETE,()=>{try{switch(f.getLastErrorCode()){case lg.NO_ERROR:const y=f.getResponseJson();Re(Gr,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(y)),l(y);break;case lg.TIMEOUT:Re(Gr,`RPC '${e}' ${o} timed out`),d(new Ue(Ie.DEADLINE_EXCEEDED,"Request time out"));break;case lg.HTTP_ERROR:const g=f.getStatus();if(Re(Gr,`RPC '${e}' ${o} failed with status:`,g,"response text:",f.getResponseText()),g>0){let _=f.getResponseJson();Array.isArray(_)&&(_=_[0]);const E=_==null?void 0:_.error;if(E&&E.status&&E.message){const x=function(T){const N=T.toLowerCase().replace(/_/g,"-");return Object.values(Ie).indexOf(N)>=0?N:Ie.UNKNOWN}(E.status);d(new Ue(x,E.message))}else d(new Ue(Ie.UNKNOWN,"Server responded with status "+f.getStatus()))}else d(new Ue(Ie.UNAVAILABLE,"Connection failed."));break;default:Ze(9055,{h_:e,streamId:o,P_:f.getLastErrorCode(),T_:f.getLastError()})}}finally{Re(Gr,`RPC '${e}' ${o} completed.`)}});const m=JSON.stringify(i);Re(Gr,`RPC '${e}' ${o} sending request:`,i),f.send(t,"POST",m,n,15)})}I_(e,t,n){const i=Ax(),s=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Ek(),l=wk(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},f=this.longPollingOptions.timeoutSeconds;f!==void 0&&(d.longPollingTimeout=Math.round(1e3*f)),this.useFetchStreams&&(d.useFetchStreams=!0),this.Ho(d.initMessageHeaders,t,n),d.encodeInitMessageHeaders=!0;const m=s.join("");Re(Gr,`Creating RPC '${e}' stream ${i}: ${m}`,d);const y=o.createWebChannel(m,d);this.E_(y);let g=!1,_=!1;const E=new H6({Zo:b=>{_?Re(Gr,`Not sending because RPC '${e}' stream ${i} is closed:`,b):(g||(Re(Gr,`Opening RPC '${e}' stream ${i} transport.`),y.open(),g=!0),Re(Gr,`RPC '${e}' stream ${i} sending:`,b),y.send(b))},Xo:()=>y.close()}),x=(b,T,N)=>{b.listen(T,R=>{try{N(R)}catch(I){setTimeout(()=>{throw I},0)}})};return x(y,cf.EventType.OPEN,()=>{_||(Re(Gr,`RPC '${e}' stream ${i} transport opened.`),E.__())}),x(y,cf.EventType.CLOSE,()=>{_||(_=!0,Re(Gr,`RPC '${e}' stream ${i} transport closed`),E.u_(),this.d_(y))}),x(y,cf.EventType.ERROR,b=>{_||(_=!0,ou(Gr,`RPC '${e}' stream ${i} transport errored. Name:`,b.name,"Message:",b.message),E.u_(new Ue(Ie.UNAVAILABLE,"The operation could not be completed")))}),x(y,cf.EventType.MESSAGE,b=>{var T;if(!_){const N=b.data[0];it(!!N,16349);const R=N,I=(R==null?void 0:R.error)||((T=R[0])===null||T===void 0?void 0:T.error);if(I){Re(Gr,`RPC '${e}' stream ${i} received error:`,I);const j=I.status;let U=function(D){const O=or[D];if(O!==void 0)return TP(O)}(j),C=I.message;U===void 0&&(U=Ie.INTERNAL,C="Unknown error status: "+j+" with message "+I.message),_=!0,E.u_(new Ue(U,C)),y.close()}else Re(Gr,`RPC '${e}' stream ${i} received:`,N),E.c_(N)}}),x(l,bk.STAT_EVENT,b=>{b.stat===rx.PROXY?Re(Gr,`RPC '${e}' stream ${i} detected buffering proxy`):b.stat===rx.NOPROXY&&Re(Gr,`RPC '${e}' stream ${i} detected no buffering proxy`)}),setTimeout(()=>{E.a_()},0),E}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(t=>t===e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uC(){return typeof window<"u"?window:null}function vg(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vy(r){return new YD(r,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dC{constructor(e,t,n=1e3,i=1.5,s=6e4){this.xi=e,this.timerId=t,this.A_=n,this.R_=i,this.V_=s,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const t=Math.floor(this.m_+this.w_()),n=Math.max(0,Date.now()-this.g_),i=Math.max(0,t-n);i>0&&Re("ExponentialBackoff",`Backing off for ${i} ms (base delay: ${this.m_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,i,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ST="PersistentStream";class hC{constructor(e,t,n,i,s,o,l,d){this.xi=e,this.S_=n,this.D_=i,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=d,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new dC(e,t)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,t){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():t&&t.code===Ie.RESOURCE_EXHAUSTED?(Zn(t.toString()),Zn("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):t&&t.code===Ie.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(t)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),t=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([n,i])=>{this.v_===t&&this.z_(n,i)},n=>{e(()=>{const i=new Ue(Ie.UNKNOWN,"Fetching auth token failed: "+n.message);return this.j_(i)})})}z_(e,t){const n=this.G_(this.v_);this.stream=this.H_(e,t),this.stream.e_(()=>{n(()=>this.listener.e_())}),this.stream.n_(()=>{n(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(i=>{n(()=>this.j_(i))}),this.stream.onMessage(i=>{n(()=>++this.M_==1?this.J_(i):this.onNext(i))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return Re(ST,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return t=>{this.xi.enqueueAndForget(()=>this.v_===e?t():(Re(ST,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class W6 extends hC{constructor(e,t,n,i,s,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s}H_(e,t){return this.connection.I_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const t=XD(this.serializer,e),n=function(s){if(!("targetChange"in s))return ct.min();const o=s.targetChange;return o.targetIds&&o.targetIds.length?ct.min():o.readTime?fi(o.readTime):ct.min()}(e);return this.listener.Y_(t,n)}Z_(e){const t={};t.database=_x(this.serializer),t.addTarget=function(s,o){let l;const d=o.target;if(l=zg(d)?{documents:jP(s,d)}:{query:jb(s,d).gt},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=IP(s,o.resumeToken);const f=yx(s,o.expectedCount);f!==null&&(l.expectedCount=f)}else if(o.snapshotVersion.compareTo(ct.min())>0){l.readTime=Dd(s,o.snapshotVersion.toTimestamp());const f=yx(s,o.expectedCount);f!==null&&(l.expectedCount=f)}return l}(this.serializer,e);const n=t6(this.serializer,e);n&&(t.labels=n),this.Q_(t)}X_(e){const t={};t.database=_x(this.serializer),t.removeTarget=e,this.Q_(t)}}class G6 extends hC{constructor(e,t,n,i,s,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,i,o),this.serializer=s}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,t){return this.connection.I_("Write",e,t)}J_(e){return it(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,it(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){it(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const t=JD(e.writeResults,e.commitTime),n=fi(e.commitTime);return this.listener.ra(n,t)}ia(){const e={};e.database=_x(this.serializer),this.Q_(e)}ta(e){const t={streamToken:this.lastStreamToken,writes:e.map(n=>Hg(this.serializer,n))};this.Q_(t)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K6{}class Y6 extends K6{constructor(e,t,n,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=i,this.sa=!1}oa(){if(this.sa)throw new Ue(Ie.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,t,n,i){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.zo(e,vx(t,n),i,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===Ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new Ue(Ie.UNKNOWN,s.toString())})}Yo(e,t,n,i,s){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Yo(e,vx(t,n),i,o,l,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Ie.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new Ue(Ie.UNKNOWN,o.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class Z6{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(Zn(t),this.ua=!1):Re("OnlineStateTracker",t)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fu="RemoteStore";class Q6{constructor(e,t,n,i,s){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=s,this.Ra.No(o=>{n.enqueueAndForget(async()=>{xu(this)&&(Re(fu,"Restarting streams for network reachability change."),await async function(d){const f=et(d);f.da.add(4),await Sm(f),f.Va.set("Unknown"),f.da.delete(4),await zy(f)}(this))})}),this.Va=new Z6(n,i)}}async function zy(r){if(xu(r))for(const e of r.Aa)await e(!0)}async function Sm(r){for(const e of r.Aa)await e(!1)}function By(r,e){const t=et(r);t.Ea.has(e.targetId)||(t.Ea.set(e.targetId,e),Hb(t)?qb(t):Qd(t).N_()&&Ub(t,e))}function Fd(r,e){const t=et(r),n=Qd(t);t.Ea.delete(e),n.N_()&&fC(t,e),t.Ea.size===0&&(n.N_()?n.k_():xu(t)&&t.Va.set("Unknown"))}function Ub(r,e){if(r.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(ct.min())>0){const t=r.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(t)}Qd(r).Z_(e)}function fC(r,e){r.ma.Ke(e),Qd(r).X_(e)}function qb(r){r.ma=new $D({getRemoteKeysForTarget:e=>r.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>r.Ea.get(e)||null,Pt:()=>r.datastore.serializer.databaseId}),Qd(r).start(),r.Va.ca()}function Hb(r){return xu(r)&&!Qd(r).O_()&&r.Ea.size>0}function xu(r){return et(r).da.size===0}function mC(r){r.ma=void 0}async function X6(r){r.Va.set("Online")}async function J6(r){r.Ea.forEach((e,t)=>{Ub(r,e)})}async function eL(r,e){mC(r),Hb(r)?(r.Va.Pa(e),qb(r)):r.Va.set("Unknown")}async function tL(r,e,t){if(r.Va.set("Online"),e instanceof NP&&e.state===2&&e.cause)try{await async function(i,s){const o=s.cause;for(const l of s.targetIds)i.Ea.has(l)&&(await i.remoteSyncer.rejectListen(l,o),i.Ea.delete(l),i.ma.removeTarget(l))}(r,e)}catch(n){Re(fu,"Failed to remove targets %s: %s ",e.targetIds.join(","),n),await Xg(r,n)}else if(e instanceof gg?r.ma.Xe(e):e instanceof AP?r.ma.ot(e):r.ma.nt(e),!t.isEqual(ct.min()))try{const n=await nC(r.localStore);t.compareTo(n)>=0&&await function(s,o){const l=s.ma.It(o);return l.targetChanges.forEach((d,f)=>{if(d.resumeToken.approximateByteSize()>0){const m=s.Ea.get(f);m&&s.Ea.set(f,m.withResumeToken(d.resumeToken,o))}}),l.targetMismatches.forEach((d,f)=>{const m=s.Ea.get(d);if(!m)return;s.Ea.set(d,m.withResumeToken(Xn.EMPTY_BYTE_STRING,m.snapshotVersion)),fC(s,d);const y=new wa(m.target,d,f,m.sequenceNumber);Ub(s,y)}),s.remoteSyncer.applyRemoteEvent(l)}(r,t)}catch(n){Re(fu,"Failed to raise snapshot:",n),await Xg(r,n)}}async function Xg(r,e,t){if(!lc(e))throw e;r.da.add(1),await Sm(r),r.Va.set("Offline"),t||(t=()=>nC(r.localStore)),r.asyncQueue.enqueueRetryable(async()=>{Re(fu,"Retrying IndexedDB access"),await t(),r.da.delete(1),await zy(r)})}function pC(r,e){return e().catch(t=>Xg(r,t,e))}async function Zd(r){const e=et(r),t=Xl(e);let n=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:Qc;for(;nL(e);)try{const i=await z6(e.localStore,n);if(i===null){e.Ia.length===0&&t.k_();break}n=i.batchId,rL(e,i)}catch(i){await Xg(e,i)}gC(e)&&yC(e)}function nL(r){return xu(r)&&r.Ia.length<10}function rL(r,e){r.Ia.push(e);const t=Xl(r);t.N_()&&t.ea&&t.ta(e.mutations)}function gC(r){return xu(r)&&!Xl(r).O_()&&r.Ia.length>0}function yC(r){Xl(r).start()}async function iL(r){Xl(r).ia()}async function sL(r){const e=Xl(r);for(const t of r.Ia)e.ta(t.mutations)}async function oL(r,e,t){const n=r.Ia.shift(),i=kb.from(n,e,t);await pC(r,()=>r.remoteSyncer.applySuccessfulWrite(i)),await Zd(r)}async function aL(r,e){e&&Xl(r).ea&&await async function(n,i){if(function(o){return qD(o)&&o!==Ie.ABORTED}(i.code)){const s=n.Ia.shift();Xl(n).L_(),await pC(n,()=>n.remoteSyncer.rejectFailedWrite(s.batchId,i)),await Zd(n)}}(r,e),gC(r)&&yC(r)}async function TT(r,e){const t=et(r);t.asyncQueue.verifyOperationInProgress(),Re(fu,"RemoteStore received new credentials");const n=xu(t);t.da.add(3),await Sm(t),n&&t.Va.set("Unknown"),await t.remoteSyncer.handleCredentialChange(e),t.da.delete(3),await zy(t)}async function Nx(r,e){const t=et(r);e?(t.da.delete(2),await zy(t)):e||(t.da.add(2),await Sm(t),t.Va.set("Unknown"))}function Qd(r){return r.fa||(r.fa=function(t,n,i){const s=et(t);return s.oa(),new W6(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{e_:X6.bind(null,r),n_:J6.bind(null,r),i_:eL.bind(null,r),Y_:tL.bind(null,r)}),r.Aa.push(async e=>{e?(r.fa.L_(),Hb(r)?qb(r):r.Va.set("Unknown")):(await r.fa.stop(),mC(r))})),r.fa}function Xl(r){return r.ga||(r.ga=function(t,n,i){const s=et(t);return s.oa(),new G6(n,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,i)}(r.datastore,r.asyncQueue,{e_:()=>Promise.resolve(),n_:iL.bind(null,r),i_:aL.bind(null,r),na:sL.bind(null,r),ra:oL.bind(null,r)}),r.Aa.push(async e=>{e?(r.ga.L_(),await Zd(r)):(await r.ga.stop(),r.Ia.length>0&&(Re(fu,`Stopping write stream with ${r.Ia.length} pending writes`),r.Ia=[]))})),r.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $b{constructor(e,t,n,i,s){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=i,this.removalCallback=s,this.deferred=new lo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,i,s){const o=Date.now()+n,l=new $b(e,t,o,i,s);return l.start(n),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new Ue(Ie.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Wb(r,e){if(Zn("AsyncQueue",`${e}: ${r}`),lc(r))return new Ue(Ie.UNAVAILABLE,`${e}: ${r}`);throw r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xd{static emptySet(e){return new xd(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||He.comparator(t.key,n.key):(t,n)=>He.comparator(t.key,n.key),this.keyedMap=uf(),this.sortedSet=new Nn(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((t,n)=>(e(t),!1))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof xd)||this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const i=t.getNext().key,s=n.getNext().key;if(!i.isEqual(s))return!1}return!0}toString(){const e=[];return this.forEach(t=>{e.push(t.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,t){const n=new xd;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AT{constructor(){this.pa=new Nn(He.comparator)}track(e){const t=e.doc.key,n=this.pa.get(t);n?e.type!==0&&n.type===3?this.pa=this.pa.insert(t,e):e.type===3&&n.type!==1?this.pa=this.pa.insert(t,{type:n.type,doc:e.doc}):e.type===2&&n.type===2?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):e.type===2&&n.type===0?this.pa=this.pa.insert(t,{type:0,doc:e.doc}):e.type===1&&n.type===0?this.pa=this.pa.remove(t):e.type===1&&n.type===2?this.pa=this.pa.insert(t,{type:1,doc:n.doc}):e.type===0&&n.type===1?this.pa=this.pa.insert(t,{type:2,doc:e.doc}):Ze(63341,{Vt:e,ya:n}):this.pa=this.pa.insert(t,e)}wa(){const e=[];return this.pa.inorderTraversal((t,n)=>{e.push(n)}),e}}class Vd{constructor(e,t,n,i,s,o,l,d,f){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=i,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=d,this.hasCachedResults=f}static fromInitialDocuments(e,t,n,i,s){const o=[];return t.forEach(l=>{o.push({type:0,doc:l})}),new Vd(e,t,xd.emptySet(t),o,n,i,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&jy(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t[i].type!==n[i].type||!t[i].doc.isEqual(n[i].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lL{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class cL{constructor(){this.queries=NT(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(t,n){const i=et(t),s=i.queries;i.queries=NT(),s.forEach((o,l)=>{for(const d of l.Sa)d.onError(n)})})(this,new Ue(Ie.ABORTED,"Firestore shutting down"))}}function NT(){return new Oa(r=>dP(r),jy)}async function Gb(r,e){const t=et(r);let n=3;const i=e.query;let s=t.queries.get(i);s?!s.Da()&&e.va()&&(n=2):(s=new lL,n=e.va()?0:1);try{switch(n){case 0:s.ba=await t.onListen(i,!0);break;case 1:s.ba=await t.onListen(i,!1);break;case 2:await t.onFirstRemoteStoreListen(i)}}catch(o){const l=Wb(o,`Initialization of query '${ud(e.query)}' failed`);return void e.onError(l)}t.queries.set(i,s),s.Sa.push(e),e.Fa(t.onlineState),s.ba&&e.Ma(s.ba)&&Yb(t)}async function Kb(r,e){const t=et(r),n=e.query;let i=3;const s=t.queries.get(n);if(s){const o=s.Sa.indexOf(e);o>=0&&(s.Sa.splice(o,1),s.Sa.length===0?i=e.va()?0:1:!s.Da()&&e.va()&&(i=2))}switch(i){case 0:return t.queries.delete(n),t.onUnlisten(n,!0);case 1:return t.queries.delete(n),t.onUnlisten(n,!1);case 2:return t.onLastRemoteStoreUnlisten(n);default:return}}function uL(r,e){const t=et(r);let n=!1;for(const i of e){const s=i.query,o=t.queries.get(s);if(o){for(const l of o.Sa)l.Ma(i)&&(n=!0);o.ba=i}}n&&Yb(t)}function dL(r,e,t){const n=et(r),i=n.queries.get(e);if(i)for(const s of i.Sa)s.onError(t);n.queries.delete(e)}function Yb(r){r.Ca.forEach(e=>{e.next()})}var Ix,IT;(IT=Ix||(Ix={})).xa="default",IT.Cache="cache";class Zb{constructor(e,t,n){this.query=e,this.Oa=t,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=n||{}}Ma(e){if(!this.options.includeMetadataChanges){const n=[];for(const i of e.docChanges)i.type!==3&&n.push(i);e=new Vd(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Na?this.La(e)&&(this.Oa.next(e),t=!0):this.ka(e,this.onlineState)&&(this.qa(e),t=!0),this.Ba=e,t}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let t=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),t=!0),t}ka(e,t){if(!e.fromCache||!this.va())return!0;const n=t!=="Offline";return(!this.options.Qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||t==="Offline")}La(e){if(e.docChanges.length>0)return!0;const t=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&this.options.includeMetadataChanges===!0}qa(e){e=Vd.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==Ix.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vC{constructor(e){this.key=e}}class _C{constructor(e){this.key=e}}class hL{constructor(e,t){this.query=e,this.Ha=t,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Lt(),this.mutatedKeys=Lt(),this.Za=fP(e),this.Xa=new xd(this.Za)}get eu(){return this.Ha}tu(e,t){const n=t?t.nu:new AT,i=t?t.Xa:this.Xa;let s=t?t.mutatedKeys:this.mutatedKeys,o=i,l=!1;const d=this.query.limitType==="F"&&i.size===this.query.limit?i.last():null,f=this.query.limitType==="L"&&i.size===this.query.limit?i.first():null;if(e.inorderTraversal((m,y)=>{const g=i.get(m),_=xm(this.query,y)?y:null,E=!!g&&this.mutatedKeys.has(g.key),x=!!_&&(_.hasLocalMutations||this.mutatedKeys.has(_.key)&&_.hasCommittedMutations);let b=!1;g&&_?g.data.isEqual(_.data)?E!==x&&(n.track({type:3,doc:_}),b=!0):this.ru(g,_)||(n.track({type:2,doc:_}),b=!0,(d&&this.Za(_,d)>0||f&&this.Za(_,f)<0)&&(l=!0)):!g&&_?(n.track({type:0,doc:_}),b=!0):g&&!_&&(n.track({type:1,doc:g}),b=!0,(d||f)&&(l=!0)),b&&(_?(o=o.add(_),s=x?s.add(m):s.delete(m)):(o=o.delete(m),s=s.delete(m)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const m=this.query.limitType==="F"?o.last():o.first();o=o.delete(m.key),s=s.delete(m.key),n.track({type:1,doc:m})}return{Xa:o,nu:n,Cs:l,mutatedKeys:s}}ru(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,i){const s=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const o=e.nu.wa();o.sort((m,y)=>function(_,E){const x=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ze(20277,{Vt:b})}};return x(_)-x(E)}(m.type,y.type)||this.Za(m.doc,y.doc)),this.iu(n),i=i!=null&&i;const l=t&&!i?this.su():[],d=this.Ya.size===0&&this.current&&!i?1:0,f=d!==this.Ja;return this.Ja=d,o.length!==0||f?{snapshot:new Vd(this.query,e.Xa,s,o,e.mutatedKeys,d===0,f,!1,!!n&&n.resumeToken.approximateByteSize()>0),ou:l}:{ou:l}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new AT,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(t=>this.Ha=this.Ha.add(t)),e.modifiedDocuments.forEach(t=>{}),e.removedDocuments.forEach(t=>this.Ha=this.Ha.delete(t)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=Lt(),this.Xa.forEach(n=>{this._u(n.key)&&(this.Ya=this.Ya.add(n.key))});const t=[];return e.forEach(n=>{this.Ya.has(n)||t.push(new _C(n))}),this.Ya.forEach(n=>{e.has(n)||t.push(new vC(n))}),t}au(e){this.Ha=e.$s,this.Ya=Lt();const t=this.tu(e.documents);return this.applyChanges(t,!0)}uu(){return Vd.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const Xd="SyncEngine";class fL{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class mL{constructor(e){this.key=e,this.cu=!1}}class pL{constructor(e,t,n,i,s,o){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=i,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.lu={},this.hu=new Oa(l=>dP(l),jy),this.Pu=new Map,this.Tu=new Set,this.Iu=new Nn(He.comparator),this.Eu=new Map,this.du=new Db,this.Au={},this.Ru=new Map,this.Vu=hu.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function gL(r,e,t=!0){const n=Uy(r);let i;const s=n.hu.get(e);return s?(n.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.uu()):i=await xC(n,e,t,!0),i}async function yL(r,e){const t=Uy(r);await xC(t,e,!0,!1)}async function xC(r,e,t,n){const i=await Yg(r.localStore,is(e)),s=i.targetId,o=r.sharedClientState.addLocalQueryTarget(s,t);let l;return n&&(l=await Qb(r,e,s,o==="current",i.resumeToken)),r.isPrimaryClient&&t&&By(r.remoteStore,i),l}async function Qb(r,e,t,n,i){r.fu=(y,g,_)=>async function(x,b,T,N){let R=b.view.tu(T);R.Cs&&(R=await Sx(x.localStore,b.query,!1).then(({documents:C})=>b.view.tu(C,R)));const I=N&&N.targetChanges.get(b.targetId),j=N&&N.targetMismatches.get(b.targetId)!=null,U=b.view.applyChanges(R,x.isPrimaryClient,I,j);return kx(x,b.targetId,U.ou),U.snapshot}(r,y,g,_);const s=await Sx(r.localStore,e,!0),o=new hL(e,s.$s),l=o.tu(s.documents),d=Em.createSynthesizedTargetChangeForCurrentChange(t,n&&r.onlineState!=="Offline",i),f=o.applyChanges(l,r.isPrimaryClient,d);kx(r,t,f.ou);const m=new fL(e,t,o);return r.hu.set(e,m),r.Pu.has(t)?r.Pu.get(t).push(e):r.Pu.set(t,[e]),f.snapshot}async function vL(r,e,t){const n=et(r),i=n.hu.get(e),s=n.Pu.get(i.targetId);if(s.length>1)return n.Pu.set(i.targetId,s.filter(o=>!jy(o,e))),void n.hu.delete(e);n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(i.targetId),n.sharedClientState.isActiveQueryTarget(i.targetId)||await Ld(n.localStore,i.targetId,!1).then(()=>{n.sharedClientState.clearQueryState(i.targetId),t&&Fd(n.remoteStore,i.targetId),zd(n,i.targetId)}).catch(ac)):(zd(n,i.targetId),await Ld(n.localStore,i.targetId,!0))}async function _L(r,e){const t=et(r),n=t.hu.get(e),i=t.Pu.get(n.targetId);t.isPrimaryClient&&i.length===1&&(t.sharedClientState.removeLocalQueryTarget(n.targetId),Fd(t.remoteStore,n.targetId))}async function xL(r,e,t){const n=t2(r);try{const i=await function(o,l){const d=et(o),f=jt.now(),m=l.reduce((_,E)=>_.add(E.key),Lt());let y,g;return d.persistence.runTransaction("Locally write mutations","readwrite",_=>{let E=rs(),x=Lt();return d.Bs.getEntries(_,m).next(b=>{E=b,E.forEach((T,N)=>{N.isValidDocument()||(x=x.add(T))})}).next(()=>d.localDocuments.getOverlayedDocuments(_,E)).next(b=>{y=b;const T=[];for(const N of l){const R=zD(N,y.get(N.key).overlayedDocument);R!=null&&T.push(new Ma(N.key,R,eP(R.value.mapValue),fr.exists(!0)))}return d.mutationQueue.addMutationBatch(_,f,T,l)}).next(b=>{g=b;const T=b.applyToLocalDocumentSet(y,x);return d.documentOverlayCache.saveOverlays(_,b.batchId,T)})}).then(()=>({batchId:g.batchId,changes:pP(y)}))}(n.localStore,e);n.sharedClientState.addPendingMutation(i.batchId),function(o,l,d){let f=o.Au[o.currentUser.toKey()];f||(f=new Nn(bt)),f=f.insert(l,d),o.Au[o.currentUser.toKey()]=f}(n,i.batchId,t),await uc(n,i.changes),await Zd(n.remoteStore)}catch(i){const s=Wb(i,"Failed to persist write");t.reject(s)}}async function bC(r,e){const t=et(r);try{const n=await F6(t.localStore,e);e.targetChanges.forEach((i,s)=>{const o=t.Eu.get(s);o&&(it(i.addedDocuments.size+i.modifiedDocuments.size+i.removedDocuments.size<=1,22616),i.addedDocuments.size>0?o.cu=!0:i.modifiedDocuments.size>0?it(o.cu,14607):i.removedDocuments.size>0&&(it(o.cu,42227),o.cu=!1))}),await uc(t,n,e)}catch(n){await ac(n)}}function kT(r,e,t){const n=et(r);if(n.isPrimaryClient&&t===0||!n.isPrimaryClient&&t===1){const i=[];n.hu.forEach((s,o)=>{const l=o.view.Fa(e);l.snapshot&&i.push(l.snapshot)}),function(o,l){const d=et(o);d.onlineState=l;let f=!1;d.queries.forEach((m,y)=>{for(const g of y.Sa)g.Fa(l)&&(f=!0)}),f&&Yb(d)}(n.eventManager,e),i.length&&n.lu.Y_(i),n.onlineState=e,n.isPrimaryClient&&n.sharedClientState.setOnlineState(e)}}async function bL(r,e,t){const n=et(r);n.sharedClientState.updateQueryState(e,"rejected",t);const i=n.Eu.get(e),s=i&&i.key;if(s){let o=new Nn(He.comparator);o=o.insert(s,Hn.newNoDocument(s,ct.min()));const l=Lt().add(s),d=new wm(ct.min(),new Map,new Nn(bt),o,l);await bC(n,d),n.Iu=n.Iu.remove(s),n.Eu.delete(e),e2(n)}else await Ld(n.localStore,e,!1).then(()=>zd(n,e,t)).catch(ac)}async function wL(r,e){const t=et(r),n=e.batch.batchId;try{const i=await L6(t.localStore,e);Jb(t,n,null),Xb(t,n),t.sharedClientState.updateMutationState(n,"acknowledged"),await uc(t,i)}catch(i){await ac(i)}}async function EL(r,e,t){const n=et(r);try{const i=await function(o,l){const d=et(o);return d.persistence.runTransaction("Reject batch","readwrite-primary",f=>{let m;return d.mutationQueue.lookupMutationBatch(f,l).next(y=>(it(y!==null,37113),m=y.keys(),d.mutationQueue.removeMutationBatch(f,y))).next(()=>d.mutationQueue.performConsistencyCheck(f)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(f,m,l)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(f,m)).next(()=>d.localDocuments.getDocuments(f,m))})}(n.localStore,e);Jb(n,e,t),Xb(n,e),n.sharedClientState.updateMutationState(e,"rejected",t),await uc(n,i)}catch(i){await ac(i)}}function Xb(r,e){(r.Ru.get(e)||[]).forEach(t=>{t.resolve()}),r.Ru.delete(e)}function Jb(r,e,t){const n=et(r);let i=n.Au[n.currentUser.toKey()];if(i){const s=i.get(e);s&&(t?s.reject(t):s.resolve(),i=i.remove(e)),n.Au[n.currentUser.toKey()]=i}}function zd(r,e,t=null){r.sharedClientState.removeLocalQueryTarget(e);for(const n of r.Pu.get(e))r.hu.delete(n),t&&r.lu.gu(n,t);r.Pu.delete(e),r.isPrimaryClient&&r.du.Hr(e).forEach(n=>{r.du.containsKey(n)||wC(r,n)})}function wC(r,e){r.Tu.delete(e.path.canonicalString());const t=r.Iu.get(e);t!==null&&(Fd(r.remoteStore,t),r.Iu=r.Iu.remove(e),r.Eu.delete(t),e2(r))}function kx(r,e,t){for(const n of t)n instanceof vC?(r.du.addReference(n.key,e),SL(r,n)):n instanceof _C?(Re(Xd,"Document no longer in limbo: "+n.key),r.du.removeReference(n.key,e),r.du.containsKey(n.key)||wC(r,n.key)):Ze(19791,{pu:n})}function SL(r,e){const t=e.key,n=t.path.canonicalString();r.Iu.get(t)||r.Tu.has(n)||(Re(Xd,"New document in limbo: "+t),r.Tu.add(n),e2(r))}function e2(r){for(;r.Tu.size>0&&r.Iu.size<r.maxConcurrentLimboResolutions;){const e=r.Tu.values().next().value;r.Tu.delete(e);const t=new He(sn.fromString(e)),n=r.Vu.next();r.Eu.set(n,new mL(t)),r.Iu=r.Iu.insert(t,n),By(r.remoteStore,new wa(is(_m(t.path)),n,"TargetPurposeLimboResolution",zi.le))}}async function uc(r,e,t){const n=et(r),i=[],s=[],o=[];n.hu.isEmpty()||(n.hu.forEach((l,d)=>{o.push(n.fu(d,e,t).then(f=>{var m;if((f||t)&&n.isPrimaryClient){const y=f?!f.fromCache:(m=t==null?void 0:t.targetChanges.get(d.targetId))===null||m===void 0?void 0:m.current;n.sharedClientState.updateQueryState(d.targetId,y?"current":"not-current")}if(f){i.push(f);const y=Vb.Rs(d.targetId,f);s.push(y)}}))}),await Promise.all(o),n.lu.Y_(i),await async function(d,f){const m=et(d);try{await m.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>ve.forEach(f,g=>ve.forEach(g.ds,_=>m.persistence.referenceDelegate.addReference(y,g.targetId,_)).next(()=>ve.forEach(g.As,_=>m.persistence.referenceDelegate.removeReference(y,g.targetId,_)))))}catch(y){if(!lc(y))throw y;Re(zb,"Failed to update sequence numbers: "+y)}for(const y of f){const g=y.targetId;if(!y.fromCache){const _=m.xs.get(g),E=_.snapshotVersion,x=_.withLastLimboFreeSnapshotVersion(E);m.xs=m.xs.insert(g,x)}}}(n.localStore,s))}async function TL(r,e){const t=et(r);if(!t.currentUser.isEqual(e)){Re(Xd,"User change. New user:",e.toKey());const n=await tC(t.localStore,e);t.currentUser=e,function(s,o){s.Ru.forEach(l=>{l.forEach(d=>{d.reject(new Ue(Ie.CANCELLED,o))})}),s.Ru.clear()}(t,"'waitForPendingWrites' promise is rejected due to a user change."),t.sharedClientState.handleUserChange(e,n.removedBatchIds,n.addedBatchIds),await uc(t,n.ks)}}function AL(r,e){const t=et(r),n=t.Eu.get(e);if(n&&n.cu)return Lt().add(n.key);{let i=Lt();const s=t.Pu.get(e);if(!s)return i;for(const o of s){const l=t.hu.get(o);i=i.unionWith(l.view.eu)}return i}}async function NL(r,e){const t=et(r),n=await Sx(t.localStore,e.query,!0),i=e.view.au(n);return t.isPrimaryClient&&kx(t,e.targetId,i.ou),i}async function IL(r,e){const t=et(r);return iC(t.localStore,e).then(n=>uc(t,n))}async function kL(r,e,t,n){const i=et(r),s=await function(l,d){const f=et(l),m=et(f.mutationQueue);return f.persistence.runTransaction("Lookup mutation documents","readonly",y=>m.tr(y,d).next(g=>g?f.localDocuments.getDocuments(y,g):ve.resolve(null)))}(i.localStore,e);s!==null?(t==="pending"?await Zd(i.remoteStore):t==="acknowledged"||t==="rejected"?(Jb(i,e,n||null),Xb(i,e),function(l,d){et(et(l).mutationQueue).sr(d)}(i.localStore,e)):Ze(6720,"Unknown batchState",{yu:t}),await uc(i,s)):Re(Xd,"Cannot apply mutation batch with id: "+e)}async function PL(r,e){const t=et(r);if(Uy(t),t2(t),e===!0&&t.mu!==!0){const n=t.sharedClientState.getAllActiveQueryTargets(),i=await PT(t,n.toArray());t.mu=!0,await Nx(t.remoteStore,!0);for(const s of i)By(t.remoteStore,s)}else if(e===!1&&t.mu!==!1){const n=[];let i=Promise.resolve();t.Pu.forEach((s,o)=>{t.sharedClientState.isLocalQueryTarget(o)?n.push(o):i=i.then(()=>(zd(t,o),Ld(t.localStore,o,!0))),Fd(t.remoteStore,o)}),await i,await PT(t,n),function(o){const l=et(o);l.Eu.forEach((d,f)=>{Fd(l.remoteStore,f)}),l.du.Jr(),l.Eu=new Map,l.Iu=new Nn(He.comparator)}(t),t.mu=!1,await Nx(t.remoteStore,!1)}}async function PT(r,e,t){const n=et(r),i=[],s=[];for(const o of e){let l;const d=n.Pu.get(o);if(d&&d.length!==0){l=await Yg(n.localStore,is(d[0]));for(const f of d){const m=n.hu.get(f),y=await NL(n,m);y.snapshot&&s.push(y.snapshot)}}else{const f=await rC(n.localStore,o);l=await Yg(n.localStore,f),await Qb(n,EC(f),o,!1,l.resumeToken)}i.push(l)}return n.lu.Y_(s),i}function EC(r){return lP(r.path,r.collectionGroup,r.orderBy,r.filters,r.limit,"F",r.startAt,r.endAt)}function CL(r){return function(t){return et(et(t).persistence).Is()}(et(r).localStore)}async function RL(r,e,t,n){const i=et(r);if(i.mu)return void Re(Xd,"Ignoring unexpected query state notification.");const s=i.Pu.get(e);if(s&&s.length>0)switch(t){case"current":case"not-current":{const o=await iC(i.localStore,hP(s[0])),l=wm.createSynthesizedRemoteEventForCurrentChange(e,t==="current",Xn.EMPTY_BYTE_STRING);await uc(i,o,l);break}case"rejected":await Ld(i.localStore,e,!0),zd(i,e,n);break;default:Ze(64155,t)}}async function jL(r,e,t){const n=Uy(r);if(n.mu){for(const i of e){if(n.Pu.has(i)&&n.sharedClientState.isActiveQueryTarget(i)){Re(Xd,"Adding an already active target "+i);continue}const s=await rC(n.localStore,i),o=await Yg(n.localStore,s);await Qb(n,EC(s),o.targetId,!1,o.resumeToken),By(n.remoteStore,o)}for(const i of t)n.Pu.has(i)&&await Ld(n.localStore,i,!1).then(()=>{Fd(n.remoteStore,i),zd(n,i)}).catch(ac)}}function Uy(r){const e=et(r);return e.remoteStore.remoteSyncer.applyRemoteEvent=bC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=AL.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=bL.bind(null,e),e.lu.Y_=uL.bind(null,e.eventManager),e.lu.gu=dL.bind(null,e.eventManager),e}function t2(r){const e=et(r);return e.remoteStore.remoteSyncer.applySuccessfulWrite=wL.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=EL.bind(null,e),e}class Jf{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Vy(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,t){return null}Cu(e,t){return null}Du(e){return eC(this.persistence,new JP,e.initialUser,this.serializer)}Su(e){return new Lb(Fy.fi,this.serializer)}bu(e){return new cC}async terminate(){var e,t;(e=this.gcScheduler)===null||e===void 0||e.stop(),(t=this.indexBackfillerScheduler)===null||t===void 0||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Jf.provider={build:()=>new Jf};class OL extends Jf{constructor(e){super(),this.cacheSizeBytes=e}vu(e,t){it(this.persistence.referenceDelegate instanceof Kg,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new GP(n,e.asyncQueue,t)}Su(e){const t=this.cacheSizeBytes!==void 0?Yr.withCacheSize(this.cacheSizeBytes):Yr.DEFAULT;return new Lb(n=>Kg.fi(n,t),this.serializer)}}class ML extends Jf{constructor(e,t,n){super(),this.Fu=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Fu.initialize(this,e),await t2(this.Fu.syncEngine),await Zd(this.Fu.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}Du(e){return eC(this.persistence,new JP,e.initialUser,this.serializer)}vu(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new GP(n,e.asyncQueue,t)}Cu(e,t){const n=new UM(t,this.persistence);return new BM(e.asyncQueue,n)}Su(e){const t=XP(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=this.cacheSizeBytes!==void 0?Yr.withCacheSize(this.cacheSizeBytes):Yr.DEFAULT;return new Fb(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,uC(),vg(),this.serializer,this.sharedClientState,!!this.forceOwnership)}bu(e){return new cC}}class DL extends ML{constructor(e,t){super(e,t,!1),this.Fu=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Fu.syncEngine;this.sharedClientState instanceof qv&&(this.sharedClientState.syncEngine={Co:kL.bind(null,t),Fo:RL.bind(null,t),Mo:jL.bind(null,t),Is:CL.bind(null,t),vo:IL.bind(null,t)},await this.sharedClientState.start()),await this.persistence.Ji(async n=>{await PL(this.Fu.syncEngine,n),this.gcScheduler&&(n&&!this.gcScheduler.started?this.gcScheduler.start():n||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(n&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():n||this.indexBackfillerScheduler.stop())})}bu(e){const t=uC();if(!qv.C(t))throw new Ue(Ie.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=XP(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new qv(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class Jg{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=n=>kT(this.syncEngine,n,1),this.remoteStore.remoteSyncer.handleCredentialChange=TL.bind(null,this.syncEngine),await Nx(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new cL}()}createDatastore(e){const t=Vy(e.databaseInfo.databaseId),n=function(s){return new $6(s)}(e.databaseInfo);return function(s,o,l,d){return new Y6(s,o,l,d)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(n,i,s,o,l){return new Q6(n,i,s,o,l)}(this.localStore,this.datastore,e.asyncQueue,t=>kT(this.syncEngine,t,0),function(){return ET.C()?new ET:new B6}())}createSyncEngine(e,t){return function(i,s,o,l,d,f,m){const y=new pL(i,s,o,l,d,f);return m&&(y.mu=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(i){const s=et(i);Re(fu,"RemoteStore shutting down."),s.da.add(5),await Sm(s),s.Ra.shutdown(),s.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(t=this.eventManager)===null||t===void 0||t.terminate()}}Jg.provider={build:()=>new Jg};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n2{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):Zn("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,t){setTimeout(()=>{this.muted||e(t)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jl="FirestoreClient";class LL{constructor(e,t,n,i,s){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=i,this.user=Tr.UNAUTHENTICATED,this.clientId=Nk.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=s,this.authCredentials.start(n,async o=>{Re(Jl,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(n,o=>(Re(Jl,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new lo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Wb(t,"Failed to shutdown persistence");e.reject(n)}}),e.promise}}async function $v(r,e){r.asyncQueue.verifyOperationInProgress(),Re(Jl,"Initializing OfflineComponentProvider");const t=r.configuration;await e.initialize(t);let n=t.initialUser;r.setCredentialChangeListener(async i=>{n.isEqual(i)||(await tC(e.localStore,i),n=i)}),e.persistence.setDatabaseDeletedListener(()=>r.terminate()),r._offlineComponents=e}async function CT(r,e){r.asyncQueue.verifyOperationInProgress();const t=await FL(r);Re(Jl,"Initializing OnlineComponentProvider"),await e.initialize(t,r.configuration),r.setCredentialChangeListener(n=>TT(e.remoteStore,n)),r.setAppCheckTokenChangeListener((n,i)=>TT(e.remoteStore,i)),r._onlineComponents=e}async function FL(r){if(!r._offlineComponents)if(r._uninitializedComponentsProvider){Re(Jl,"Using user provided OfflineComponentProvider");try{await $v(r,r._uninitializedComponentsProvider._offline)}catch(e){const t=e;if(!function(i){return i.name==="FirebaseError"?i.code===Ie.FAILED_PRECONDITION||i.code===Ie.UNIMPLEMENTED:!(typeof DOMException<"u"&&i instanceof DOMException)||i.code===22||i.code===20||i.code===11}(t))throw t;ou("Error using user provided cache. Falling back to memory cache: "+t),await $v(r,new Jf)}}else Re(Jl,"Using default OfflineComponentProvider"),await $v(r,new OL(void 0));return r._offlineComponents}async function r2(r){return r._onlineComponents||(r._uninitializedComponentsProvider?(Re(Jl,"Using user provided OnlineComponentProvider"),await CT(r,r._uninitializedComponentsProvider._online)):(Re(Jl,"Using default OnlineComponentProvider"),await CT(r,new Jg))),r._onlineComponents}function VL(r){return r2(r).then(e=>e.syncEngine)}function zL(r){return r2(r).then(e=>e.datastore)}async function ey(r){const e=await r2(r),t=e.eventManager;return t.onListen=gL.bind(null,e.syncEngine),t.onUnlisten=vL.bind(null,e.syncEngine),t.onFirstRemoteStoreListen=yL.bind(null,e.syncEngine),t.onLastRemoteStoreUnlisten=_L.bind(null,e.syncEngine),t}function BL(r,e,t={}){const n=new lo;return r.asyncQueue.enqueueAndForget(async()=>function(s,o,l,d,f){const m=new n2({next:g=>{m.xu(),o.enqueueAndForget(()=>Kb(s,y));const _=g.docs.has(l);!_&&g.fromCache?f.reject(new Ue(Ie.UNAVAILABLE,"Failed to get document because the client is offline.")):_&&g.fromCache&&d&&d.source==="server"?f.reject(new Ue(Ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):f.resolve(g)},error:g=>f.reject(g)}),y=new Zb(_m(l.path),m,{includeMetadataChanges:!0,Qa:!0});return Gb(s,y)}(await ey(r),r.asyncQueue,e,t,n)),n.promise}function UL(r,e,t={}){const n=new lo;return r.asyncQueue.enqueueAndForget(async()=>function(s,o,l,d,f){const m=new n2({next:g=>{m.xu(),o.enqueueAndForget(()=>Kb(s,y)),g.fromCache&&d.source==="server"?f.reject(new Ue(Ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):f.resolve(g)},error:g=>f.reject(g)}),y=new Zb(l,m,{includeMetadataChanges:!0,Qa:!0});return Gb(s,y)}(await ey(r),r.asyncQueue,e,t,n)),n.promise}function qL(r,e,t){const n=new lo;return r.asyncQueue.enqueueAndForget(async()=>{try{const i=await zL(r);n.resolve(async function(o,l,d){var f;const m=et(o),{request:y,yt:g,parent:_}=e6(m.serializer,ID(l),d);m.connection.Uo||delete y.parent;const E=(await m.Yo("RunAggregationQuery",m.serializer.databaseId,_,y,1)).filter(b=>!!b.result);it(E.length===1,64727);const x=(f=E[0].result)===null||f===void 0?void 0:f.aggregateFields;return Object.keys(x).reduce((b,T)=>(b[g[T]]=x[T],b),{})}(i,e,t))}catch(i){n.reject(i)}}),n.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SC(r){const e={};return r.timeoutSeconds!==void 0&&(e.timeoutSeconds=r.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RT=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TC(r,e,t){if(!t)throw new Ue(Ie.INVALID_ARGUMENT,`Function ${r}() cannot be called with an empty ${e}.`)}function HL(r,e,t,n){if(e===!0&&n===!0)throw new Ue(Ie.INVALID_ARGUMENT,`${r} and ${t} cannot be used together.`)}function jT(r){if(!He.isDocumentKey(r))throw new Ue(Ie.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${r} has ${r.length}.`)}function OT(r){if(He.isDocumentKey(r))throw new Ue(Ie.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${r} has ${r.length}.`)}function qy(r){if(r===void 0)return"undefined";if(r===null)return"null";if(typeof r=="string")return r.length>20&&(r=`${r.substring(0,20)}...`),JSON.stringify(r);if(typeof r=="number"||typeof r=="boolean")return""+r;if(typeof r=="object"){if(r instanceof Array)return"an array";{const e=function(n){return n.constructor?n.constructor.name:null}(r);return e?`a custom ${e} object`:"an object"}}return typeof r=="function"?"a function":Ze(12329,{type:typeof r})}function Dr(r,e){if("_delegate"in r&&(r=r._delegate),!(r instanceof e)){if(e.name===r.constructor.name)throw new Ue(Ie.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const t=qy(r);throw new Ue(Ie.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${t}`)}}return r}function $L(r,e){if(e<=0)throw new Ue(Ie.INVALID_ARGUMENT,`Function ${r}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const AC="firestore.googleapis.com",MT=!0;class DT{constructor(e){var t,n;if(e.host===void 0){if(e.ssl!==void 0)throw new Ue(Ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=AC,this.ssl=MT}else this.host=e.host,this.ssl=(t=e.ssl)!==null&&t!==void 0?t:MT;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=qP;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<y6)throw new Ue(Ie.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}HL("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=SC((n=e.experimentalLongPollingOptions)!==null&&n!==void 0?n:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new Ue(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new Ue(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new Ue(Ie.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(n,i){return n.timeoutSeconds===i.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Hy{constructor(e,t,n,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new DT({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new Ue(Ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new Ue(Ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new DT(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(n){if(!n)return new PM;switch(n.type){case"firstParty":return new OM(n.sessionIndex||"0",n.iamToken||null,n.authTokenFactory||null);case"provider":return n.client;default:throw new Ue(Ie.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(t){const n=RT.get(t);n&&(Re("ComponentProvider","Removing Datastore"),RT.delete(t),n.terminate())}(this),Promise.resolve()}}function WL(r,e,t,n={}){var i;r=Dr(r,Hy);const s=vu(e),o=r._getSettings(),l=Object.assign(Object.assign({},o),{emulatorOptions:r._getEmulatorOptions()}),d=`${e}:${t}`;s&&(Jx(`https://${d}`),eb("Firestore",!0)),o.host!==AC&&o.host!==d&&ou("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const f=Object.assign(Object.assign({},o),{host:d,ssl:s,emulatorOptions:n});if(!Kl(f,l)&&(r._setSettings(f),n.mockUserToken)){let m,y;if(typeof n.mockUserToken=="string")m=n.mockUserToken,y=Tr.MOCK_USER;else{m=V5(n.mockUserToken,(i=r._app)===null||i===void 0?void 0:i.options.projectId);const g=n.mockUserToken.sub||n.mockUserToken.user_id;if(!g)throw new Ue(Ie.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new Tr(g)}r._authCredentials=new CM(new Tk(m,y))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Da{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Da(this.firestore,e,this._query)}}class ei{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Wl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new ei(this.firestore,e,this._key)}}class Wl extends Da{constructor(e,t,n){super(e,t,_m(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new ei(this.firestore,null,new He(e))}withConverter(e){return new Wl(this.firestore,e,this._path)}}function ot(r,e,...t){if(r=jn(r),TC("collection","path",e),r instanceof Hy){const n=sn.fromString(e,...t);return OT(n),new Wl(r,null,n)}{if(!(r instanceof ei||r instanceof Wl))throw new Ue(Ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(sn.fromString(e,...t));return OT(n),new Wl(r.firestore,null,n)}}function zt(r,e,...t){if(r=jn(r),arguments.length===1&&(e=Nk.newId()),TC("doc","path",e),r instanceof Hy){const n=sn.fromString(e,...t);return jT(n),new ei(r,null,new He(n))}{if(!(r instanceof ei||r instanceof Wl))throw new Ue(Ie.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=r._path.child(sn.fromString(e,...t));return jT(n),new ei(r.firestore,r instanceof Wl?r.converter:null,new He(n))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const LT="AsyncQueue";class FT{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new dC(this,"async_queue_retry"),this.rc=()=>{const n=vg();n&&Re(LT,"Visibility state changed to "+n.visibilityState),this.x_.b_()},this.sc=e;const t=vg();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const t=vg();t&&typeof t.removeEventListener=="function"&&t.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const t=new lo;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!lc(e))throw e;Re(LT,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const t=this.sc.then(()=>(this.ec=!0,e().catch(n=>{throw this.Xu=n,this.ec=!1,Zn("INTERNAL UNHANDLED ERROR: ",VT(n)),n}).then(n=>(this.ec=!1,n))));return this.sc=t,t}enqueueAfterDelay(e,t,n){this.oc(),this.nc.indexOf(e)>-1&&(t=0);const i=$b.createAndSchedule(this,e,t,n,s=>this.uc(s));return this.Zu.push(i),i}oc(){this.Xu&&Ze(47125,{cc:VT(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const t of this.Zu)if(t.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((t,n)=>t.targetTimeMs-n.targetTimeMs);for(const t of this.Zu)if(t.skipDelay(),e!=="all"&&t.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const t=this.Zu.indexOf(e);this.Zu.splice(t,1)}}function VT(r){let e=r.message||"";return r.stack&&(e=r.stack.includes(r.message)?r.stack:r.message+`
`+r.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zT(r){return function(t,n){if(typeof t!="object"||t===null)return!1;const i=t;for(const s of n)if(s in i&&typeof i[s]=="function")return!0;return!1}(r,["next","error","complete"])}class ks extends Hy{constructor(e,t,n,i){super(e,t,n,i),this.type="firestore",this._queue=new FT,this._persistenceKey=(i==null?void 0:i.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new FT(e),this._firestoreClient=void 0,await e}}}function GL(r,e){const t=typeof r=="object"?r:by(),n=typeof r=="string"?r:Vg,i=xy(t,"firestore").getImmediate({identifier:n});if(!i._initialized){const s=S4("firestore");s&&WL(i,...s)}return i}function Jd(r){if(r._terminated)throw new Ue(Ie.FAILED_PRECONDITION,"The client has already been terminated.");return r._firestoreClient||NC(r),r._firestoreClient}function NC(r){var e,t,n;const i=r._freezeSettings(),s=function(l,d,f,m){return new yD(l,d,f,m.host,m.ssl,m.experimentalForceLongPolling,m.experimentalAutoDetectLongPolling,SC(m.experimentalLongPollingOptions),m.useFetchStreams,m.isUsingEmulator)}(r._databaseId,((e=r._app)===null||e===void 0?void 0:e.options.appId)||"",r._persistenceKey,i);r._componentsProvider||!((t=i.localCache)===null||t===void 0)&&t._offlineComponentProvider&&(!((n=i.localCache)===null||n===void 0)&&n._onlineComponentProvider)&&(r._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),r._firestoreClient=new LL(r._authCredentials,r._appCheckCredentials,r._queue,s,r._componentsProvider&&function(l){const d=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(d),_online:d}}(r._componentsProvider))}async function KL(r){ou("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const e=r._freezeSettings();YL(r,Jg.provider,{build:t=>new DL(t,e.cacheSizeBytes)})}function YL(r,e,t){if((r=Dr(r,ks))._firestoreClient||r._terminated)throw new Ue(Ie.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(r._componentsProvider||r._getSettings().localCache)throw new Ue(Ie.FAILED_PRECONDITION,"SDK cache is already specified.");r._componentsProvider={_online:e,_offline:t},NC(r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZL{constructor(e="count",t){this._internalFieldPath=t,this.type="AggregateField",this.aggregateType=e}}class QL{constructor(e,t,n){this._userDataWriter=t,this._data=n,this.type="AggregateQuerySnapshot",this.query=e}data(){return this._userDataWriter.convertObjectMap(this._data)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Bd(Xn.fromBase64String(e))}catch(t){throw new Ue(Ie.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+t)}}static fromUint8Array(e){return new Bd(Xn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eh{constructor(...e){for(let t=0;t<e.length;++t)if(e[t].length===0)throw new Ue(Ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Vn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}function IC(){return new eh(sx)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tm{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new Ue(Ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new Ue(Ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return bt(this._lat,e._lat)||bt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class s2{constructor(e){this._values=(e||[]).map(t=>t)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(n,i){if(n.length!==i.length)return!1;for(let s=0;s<n.length;++s)if(n[s]!==i[s])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XL=/^__.*__$/;class JL{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return this.fieldMask!==null?new Ma(e,this.data,this.fieldMask,t,this.fieldTransforms):new Yd(e,this.data,t,this.fieldTransforms)}}class kC{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Ma(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function PC(r){switch(r){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ze(40011,{Ic:r})}}class $y{constructor(e,t,n,i,s,o){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=i,s===void 0&&this.Ec(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new $y(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.dc({path:n,Rc:!1});return i.Vc(e),i}mc(e){var t;const n=(t=this.path)===null||t===void 0?void 0:t.child(e),i=this.dc({path:n,Rc:!1});return i.Ec(),i}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return ty(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(t=>e.isPrefixOf(t))!==void 0||this.fieldTransforms.find(t=>e.isPrefixOf(t.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(PC(this.Ic)&&XL.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class e8{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Vy(e)}bc(e,t,n,i=!1){return new $y({Ic:e,methodName:t,wc:n,path:Vn.emptyPath(),Rc:!1,yc:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Am(r){const e=r._freezeSettings(),t=Vy(r._databaseId);return new e8(r._databaseId,!!e.ignoreUndefinedProperties,t)}function o2(r,e,t,n,i,s={}){const o=r.bc(s.merge||s.mergeFields?2:0,e,t,i);c2("Data must be an object, but it was:",o,n);const l=jC(n,o);let d,f;if(s.merge)d=new Bi(o.fieldMask),f=o.fieldTransforms;else if(s.mergeFields){const m=[];for(const y of s.mergeFields){const g=Px(e,y,t);if(!o.contains(g))throw new Ue(Ie.INVALID_ARGUMENT,`Field '${g}' is specified in your field mask but missing from your input data.`);MC(m,g)||m.push(g)}d=new Bi(m),f=o.fieldTransforms.filter(y=>d.covers(y.field))}else d=null,f=o.fieldTransforms;return new JL(new Zr(l),d,f)}class Wy extends Tm{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Wy}}function t8(r,e,t){return new $y({Ic:3,wc:e.settings.wc,methodName:r._methodName,Rc:t},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class a2 extends Tm{_toFieldTransform(e){return new Nb(e.path,new Od)}isEqual(e){return e instanceof a2}}class l2 extends Tm{constructor(e,t){super(e),this.Sc=t}_toFieldTransform(e){const t=t8(this,e,!0),n=this.Sc.map(s=>th(s,t)),i=new cu(n);return new Nb(e.path,i)}isEqual(e){return e instanceof l2&&Kl(this.Sc,e.Sc)}}function CC(r,e,t,n){const i=r.bc(1,e,t);c2("Data must be an object, but it was:",i,n);const s=[],o=Zr.empty();cc(n,(d,f)=>{const m=u2(e,d,t);f=jn(f);const y=i.mc(m);if(f instanceof Wy)s.push(m);else{const g=th(f,y);g!=null&&(s.push(m),o.set(m,g))}});const l=new Bi(s);return new kC(o,l,i.fieldTransforms)}function RC(r,e,t,n,i,s){const o=r.bc(1,e,t),l=[Px(e,n,t)],d=[i];if(s.length%2!=0)throw new Ue(Ie.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let g=0;g<s.length;g+=2)l.push(Px(e,s[g])),d.push(s[g+1]);const f=[],m=Zr.empty();for(let g=l.length-1;g>=0;--g)if(!MC(f,l[g])){const _=l[g];let E=d[g];E=jn(E);const x=o.mc(_);if(E instanceof Wy)f.push(_);else{const b=th(E,x);b!=null&&(f.push(_),m.set(_,b))}}const y=new Bi(f);return new kC(m,y,o.fieldTransforms)}function n8(r,e,t,n=!1){return th(t,r.bc(n?4:3,e))}function th(r,e){if(OC(r=jn(r)))return c2("Unsupported field value:",e,r),jC(r,e);if(r instanceof Tm)return function(n,i){if(!PC(i.Ic))throw i.gc(`${n._methodName}() can only be used with update() and set()`);if(!i.path)throw i.gc(`${n._methodName}() is not currently supported inside arrays`);const s=n._toFieldTransform(i);s&&i.fieldTransforms.push(s)}(r,e),null;if(r===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),r instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(n,i){const s=[];let o=0;for(const l of n){let d=th(l,i.fc(o));d==null&&(d={nullValue:"NULL_VALUE"}),s.push(d),o++}return{arrayValue:{values:s}}}(r,e)}return function(n,i){if((n=jn(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return OD(i.serializer,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){const s=jt.fromDate(n);return{timestampValue:Dd(i.serializer,s)}}if(n instanceof jt){const s=new jt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3));return{timestampValue:Dd(i.serializer,s)}}if(n instanceof i2)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Bd)return{bytesValue:IP(i.serializer,n._byteString)};if(n instanceof ei){const s=i.databaseId,o=n.firestore._databaseId;if(!o.isEqual(s))throw i.gc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Rb(n.firestore._databaseId||i.databaseId,n._key.path)}}if(n instanceof s2)return function(o,l){return{mapValue:{fields:{[wb]:{stringValue:Eb},[Pd]:{arrayValue:{values:o.toArray().map(f=>{if(typeof f!="number")throw l.gc("VectorValues must only contain numeric values.");return Ab(l.serializer,f)})}}}}}}(n,i);throw i.gc(`Unsupported field value: ${qy(n)}`)}(r,e)}function jC(r,e){const t={};return $k(r)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):cc(r,(n,i)=>{const s=th(i,e.Ac(n));s!=null&&(t[n]=s)}),{mapValue:{fields:t}}}function OC(r){return!(typeof r!="object"||r===null||r instanceof Array||r instanceof Date||r instanceof jt||r instanceof i2||r instanceof Bd||r instanceof ei||r instanceof Tm||r instanceof s2)}function c2(r,e,t){if(!OC(t)||!function(i){return typeof i=="object"&&i!==null&&(Object.getPrototypeOf(i)===Object.prototype||Object.getPrototypeOf(i)===null)}(t)){const n=qy(t);throw n==="an object"?e.gc(r+" a custom object"):e.gc(r+" "+n)}}function Px(r,e,t){if((e=jn(e))instanceof eh)return e._internalPath;if(typeof e=="string")return u2(r,e);throw ty("Field path arguments must be of type string or ",r,!1,void 0,t)}const r8=new RegExp("[~\\*/\\[\\]]");function u2(r,e,t){if(e.search(r8)>=0)throw ty(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,r,!1,void 0,t);try{return new eh(...e.split("."))._internalPath}catch{throw ty(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,r,!1,void 0,t)}}function ty(r,e,t,n,i){const s=n&&!n.isEmpty(),o=i!==void 0;let l=`Function ${e}() called with invalid data`;t&&(l+=" (via `toFirestore()`)"),l+=". ";let d="";return(s||o)&&(d+=" (found",s&&(d+=` in field ${n}`),o&&(d+=` in document ${i}`),d+=")"),new Ue(Ie.INVALID_ARGUMENT,l+r+d)}function MC(r,e){return r.some(t=>t.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DC{constructor(e,t,n,i,s){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=i,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new ei(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new i8(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(Gy("DocumentSnapshot.get",e));if(t!==null)return this._userDataWriter.convertValue(t)}}}class i8 extends DC{data(){return super.data()}}function Gy(r,e){return typeof e=="string"?u2(r,e):e instanceof eh?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LC(r){if(r.limitType==="L"&&r.explicitOrderBy.length===0)throw new Ue(Ie.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class d2{}class h2 extends d2{}function ft(r,e,...t){let n=[];e instanceof d2&&n.push(e),n=n.concat(t),function(s){const o=s.filter(d=>d instanceof f2).length,l=s.filter(d=>d instanceof Ky).length;if(o>1||o>0&&l>0)throw new Ue(Ie.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const i of n)r=i._apply(r);return r}class Ky extends h2{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Ky(e,t,n)}_apply(e){const t=this._parse(e);return FC(e._query,t),new Da(e.firestore,e.converter,gx(e._query,t))}_parse(e){const t=Am(e.firestore);return function(s,o,l,d,f,m,y){let g;if(f.isKeyField()){if(m==="array-contains"||m==="array-contains-any")throw new Ue(Ie.INVALID_ARGUMENT,`Invalid Query. You can't perform '${m}' queries on documentId().`);if(m==="in"||m==="not-in"){UT(y,m);const E=[];for(const x of y)E.push(BT(d,s,x));g={arrayValue:{values:E}}}else g=BT(d,s,y)}else m!=="in"&&m!=="not-in"&&m!=="array-contains-any"||UT(y,m),g=n8(l,o,y,m==="in"||m==="not-in");return qt.create(f,m,g)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value)}}function wt(r,e,t){const n=e,i=Gy("where",r);return Ky._create(i,n,t)}class f2 extends d2{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new f2(e,t)}_parse(e){const t=this._queryConstraints.map(n=>n._parse(e)).filter(n=>n.getFilters().length>0);return t.length===1?t[0]:mn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return t.getFilters().length===0?e:(function(i,s){let o=i;const l=s.getFlattenedFilters();for(const d of l)FC(o,d),o=gx(o,d)}(e._query,t),new Da(e.firestore,e.converter,gx(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class m2 extends h2{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new m2(e,t)}_apply(e){const t=function(i,s,o){if(i.startAt!==null)throw new Ue(Ie.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(i.endAt!==null)throw new Ue(Ie.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Qf(s,o)}(e._query,this._field,this._direction);return new Da(e.firestore,e.converter,function(i,s){const o=i.explicitOrderBy.concat([s]);return new Kd(i.path,i.collectionGroup,o,i.filters.slice(),i.limit,i.limitType,i.startAt,i.endAt)}(e._query,t))}}function Wn(r,e="asc"){const t=e,n=Gy("orderBy",r);return m2._create(n,t)}class p2 extends h2{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new p2(e,t,n)}_apply(e){return new Da(e.firestore,e.converter,Ug(e._query,this._limit,this._limitType))}}function mu(r){return $L("limit",r),p2._create("limit",r,"F")}function BT(r,e,t){if(typeof(t=jn(t))=="string"){if(t==="")throw new Ue(Ie.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!cP(e)&&t.indexOf("/")!==-1)throw new Ue(Ie.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${t}' contains a '/' character.`);const n=e.path.child(sn.fromString(t));if(!He.isDocumentKey(n))throw new Ue(Ie.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${n}' is not because it has an odd number of segments (${n.length}).`);return Yf(r,new He(n))}if(t instanceof ei)return Yf(r,t._key);throw new Ue(Ie.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${qy(t)}.`)}function UT(r,e){if(!Array.isArray(r)||r.length===0)throw new Ue(Ie.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function FC(r,e){const t=function(i,s){for(const o of i)for(const l of o.getFlattenedFilters())if(s.indexOf(l.op)>=0)return l.op;return null}(r.filters,function(i){switch(i){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(t!==null)throw t===e.op?new Ue(Ie.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new Ue(Ie.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${t.toString()}' filters.`)}class s8{convertValue(e,t="none"){switch(Zl(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Rn(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(ka(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw Ze(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return cc(e,(i,s)=>{n[i]=this.convertValue(s,t)}),n}convertVectorValue(e){var t,n,i;const s=(i=(n=(t=e.fields)===null||t===void 0?void 0:t[Pd].arrayValue)===null||n===void 0?void 0:n.values)===null||i===void 0?void 0:i.map(o=>Rn(o.doubleValue));return new s2(s)}convertGeoPoint(e){return new i2(Rn(e.latitude),Rn(e.longitude))}convertArray(e,t){return(e.values||[]).map(n=>this.convertValue(n,t))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Cy(e);return n==null?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Gf(e));default:return null}}convertTimestamp(e){const t=Ia(e);return new jt(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=sn.fromString(e);it(LP(n),9688,{name:e});const i=new au(n.get(1),n.get(3)),s=new He(n.popFirst(5));return i.isEqual(t)||Zn(`Document ${s} contains a document reference within a different database (${i.projectId}/${i.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),s}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g2(r,e,t){let n;return n=r?t&&(t.merge||t.mergeFields)?r.toFirestore(e,t):r.toFirestore(e):e,n}function o8(){return new ZL("count")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ff{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class VC extends DC{constructor(e,t,n,i,s,o){super(e,t,n,i,o),this._firestore=e,this._firestoreImpl=e,this.metadata=s}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new _g(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(Gy("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class _g extends VC{data(e={}){return super.data(e)}}class zC{constructor(e,t,n,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new ff(i.hasPendingWrites,i.fromCache),this.query=n}get docs(){const e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,t){this._snapshot.docs.forEach(n=>{e.call(t,new _g(this._firestore,this._userDataWriter,n.key,n,new ff(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new Ue(Ie.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(i,s){if(i._snapshot.oldDocs.isEmpty()){let o=0;return i._snapshot.docChanges.map(l=>{const d=new _g(i._firestore,i._userDataWriter,l.doc.key,l.doc,new ff(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);return l.doc,{type:"added",doc:d,oldIndex:-1,newIndex:o++}})}{let o=i._snapshot.oldDocs;return i._snapshot.docChanges.filter(l=>s||l.type!==3).map(l=>{const d=new _g(i._firestore,i._userDataWriter,l.doc.key,l.doc,new ff(i._snapshot.mutatedKeys.has(l.doc.key),i._snapshot.fromCache),i.query.converter);let f=-1,m=-1;return l.type!==0&&(f=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),m=o.indexOf(l.doc.key)),{type:a8(l.type),doc:d,oldIndex:f,newIndex:m}})}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}}function a8(r){switch(r){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ze(61501,{type:r})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sa(r){r=Dr(r,ei);const e=Dr(r.firestore,ks);return BL(Jd(e),r._key).then(t=>BC(e,r,t))}class Yy extends s8{constructor(e){super(),this.firestore=e}convertBytes(e){return new Bd(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new ei(this.firestore,null,t)}}function gt(r){r=Dr(r,Da);const e=Dr(r.firestore,ks),t=Jd(e),n=new Yy(e);return LC(r._query),UL(t,r._query).then(i=>new zC(e,n,r,i))}function l8(r,e,t){r=Dr(r,ei);const n=Dr(r.firestore,ks),i=g2(r.converter,e,t);return Im(n,[o2(Am(n),"setDoc",r._key,i,r.converter!==null,t).toMutation(r._key,fr.none())])}function as(r,e,t,...n){r=Dr(r,ei);const i=Dr(r.firestore,ks),s=Am(i);let o;return o=typeof(e=jn(e))=="string"||e instanceof eh?RC(s,"updateDoc",r._key,e,t,n):CC(s,"updateDoc",r._key,e),Im(i,[o.toMutation(r._key,fr.exists(!0))])}function Nm(r){return Im(Dr(r.firestore,ks),[new bm(r._key,fr.none())])}function nh(r,e){const t=Dr(r.firestore,ks),n=zt(r),i=g2(r.converter,e);return Im(t,[o2(Am(r.firestore),"addDoc",n._key,i,r.converter!==null,{}).toMutation(n._key,fr.exists(!1))]).then(()=>n)}function Cx(r,...e){var t,n,i;r=jn(r);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||zT(e[o])||(s=e[o],o++);const l={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(zT(e[o])){const y=e[o];e[o]=(t=y.next)===null||t===void 0?void 0:t.bind(y),e[o+1]=(n=y.error)===null||n===void 0?void 0:n.bind(y),e[o+2]=(i=y.complete)===null||i===void 0?void 0:i.bind(y)}let d,f,m;if(r instanceof ei)f=Dr(r.firestore,ks),m=_m(r._key.path),d={next:y=>{e[o]&&e[o](BC(f,r,y))},error:e[o+1],complete:e[o+2]};else{const y=Dr(r,Da);f=Dr(y.firestore,ks),m=y._query;const g=new Yy(f);d={next:_=>{e[o]&&e[o](new zC(f,g,y,_))},error:e[o+1],complete:e[o+2]},LC(r._query)}return function(g,_,E,x){const b=new n2(x),T=new Zb(_,b,E);return g.asyncQueue.enqueueAndForget(async()=>Gb(await ey(g),T)),()=>{b.xu(),g.asyncQueue.enqueueAndForget(async()=>Kb(await ey(g),T))}}(Jd(f),m,l,d)}function Im(r,e){return function(n,i){const s=new lo;return n.asyncQueue.enqueueAndForget(async()=>xL(await VL(n),i,s)),s.promise}(Jd(r),e)}function BC(r,e,t){const n=t.docs.get(e._key),i=new Yy(r);return new VC(r,i,e._key,n,new ff(t.hasPendingWrites,t.fromCache),e.converter)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rx(r){return c8(r,{count:o8()})}function c8(r,e){const t=Dr(r.firestore,ks),n=Jd(t),i=pD(e,(s,o)=>new BD(o,s.aggregateType,s._internalFieldPath));return qL(n,r._query,i).then(s=>function(l,d,f){const m=new Yy(l);return new QL(d,m,f)}(t,r,s))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u8{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Am(e)}set(e,t,n){this._verifyNotCommitted();const i=Wv(e,this._firestore),s=g2(i.converter,t,n),o=o2(this._dataReader,"WriteBatch.set",i._key,s,i.converter!==null,n);return this._mutations.push(o.toMutation(i._key,fr.none())),this}update(e,t,n,...i){this._verifyNotCommitted();const s=Wv(e,this._firestore);let o;return o=typeof(t=jn(t))=="string"||t instanceof eh?RC(this._dataReader,"WriteBatch.update",s._key,t,n,i):CC(this._dataReader,"WriteBatch.update",s._key,t),this._mutations.push(o.toMutation(s._key,fr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Wv(e,this._firestore);return this._mutations=this._mutations.concat(new bm(t._key,fr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Ue(Ie.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Wv(r,e){if((r=jn(r)).firestore!==e)throw new Ue(Ie.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return r}function On(){return new a2("serverTimestamp")}function d8(...r){return new l2("arrayUnion",r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function La(r){return Jd(r=Dr(r,ks)),new u8(r,e=>Im(r,e))}(function(e,t=!0){(function(i){Gd=i})(Wd),nu(new Yl("firestore",(n,{instanceIdentifier:i,options:s})=>{const o=n.getProvider("app").getImmediate(),l=new ks(new RM(n.getProvider("auth-internal")),new MM(o,n.getProvider("app-check-internal")),function(f,m){if(!Object.prototype.hasOwnProperty.apply(f.options,["projectId"]))throw new Ue(Ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new au(f.options.projectId,m)}(o,i),o);return s=Object.assign({useFetchStreams:t},s),l._setSettings(s),l},"PUBLIC").setMultipleInstances(!0)),jo(bS,wS,e),jo(bS,wS,"esm2017")})();var h8="firebase",f8="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jo(h8,f8,"app");/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class m8{constructor(e,t,n,i){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,ui(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||t.get().then(s=>this.auth=s,()=>{}),this.messaging||n.get().then(s=>this.messaging=s,()=>{}),this.appCheck||i==null||i.get().then(s=>this.appCheck=s,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){const t=await this.getAuthToken(),n=await this.getMessagingToken(),i=await this.getAppCheckToken(e);return{authToken:t,messagingToken:n,appCheckToken:i}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jx="us-central1";class p8{constructor(e,t,n,i,s=jx,o=(...l)=>fetch(...l)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new m8(e,t,n,i),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(s);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=jx}catch{this.customDomain=null,this.region=s}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${t}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}function g8(r,e,t){const n=vu(e);r.emulatorOrigin=`http${n?"s":""}://${e}:${t}`,n&&(Jx(r.emulatorOrigin),eb("Functions",!0))}const qT="@firebase/functions",HT="0.12.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y8="auth-internal",v8="app-check-internal",_8="messaging-internal";function x8(r){const e=(t,{instanceIdentifier:n})=>{const i=t.getProvider("app").getImmediate(),s=t.getProvider(y8),o=t.getProvider(_8),l=t.getProvider(v8);return new p8(i,s,o,l,n)};nu(new Yl(UC,e,"PUBLIC").setMultipleInstances(!0)),jo(qT,HT,r),jo(qT,HT,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b8(r=by(),e=jx){const n=xy(jn(r),UC).getImmediate({identifier:e}),i=S4("functions");return i&&w8(n,...i),n}function w8(r,e,t){g8(jn(r),e,t)}x8();const E8={apiKey:"",authDomain:"",projectId:"agwa-wsi",storageBucket:"",messagingSenderId:"",appId:"",measurementId:""};let em;J7().length?em=by():em=j4(E8);const Uh=fb(em),Gt=GL(em);b8(em);console.log(" Connecting to Production Firebase Services ");KL(Gt).then(()=>{console.log("Firestore offline persistence enabled for multiple tabs.")}).catch(r=>{r.code==="failed-precondition"?console.warn("Firestore offline persistence failed: Multiple tabs open or other issues."):r.code==="unimplemented"?console.warn("Firestore offline persistence failed: Browser does not support all features."):console.warn("Firestore persistence error:",r.message)});function S8(){return"users"}function Fa(r){return`${S8()}/${r}/profile/data`}function dc(){return"public/data"}function zn(){return`${dc()}/profiles`}function hc(){return`${dc()}/support_tickets`}function Zy(r){return`${hc()}/${r}`}function km(){return`${dc()}/announcements`}function qC(r){return`${km()}/${r}`}function Ud(){return`${dc()}/system_config/settings`}function mi(){return`${dc()}/all_bills`}function T8(r){return`${mi()}/${r}`}function Va(){return`${dc()}/all_meter_readings`}function HC(r){return`${Va()}/${r}`}function ec(){return`${dc()}/meter_routes`}function bu(){return`${dc()}/service_interruptions`}function $C(r){return`${bu()}/${r}`}const fc=r=>{let e=r.message||"An unknown authentication error occurred.";return r.code&&(e=r.code.replace("auth/","").replace(/-/g," "),e=e.charAt(0).toUpperCase()+e.slice(1)+".",(r.code==="auth/invalid-credential"||r.code==="auth/wrong-password"||r.code==="auth/user-not-found")&&(e="Invalid credentials. Please check your email and password."),r.code==="auth/email-already-in-use"&&(e="This email address is already registered. Please try logging in.")),console.error("Auth Service Error:",r.code,r.message),e},A8=async(r,e,t)=>{try{return{success:!0,userCredential:await dO(r,e,t)}}catch(n){return{success:!1,error:fc(n)}}},N8=async(r,e,t)=>{try{return{success:!0,userCredential:await hO(r,e,t)}}catch(n){return{success:!1,error:fc(n)}}},I8=async r=>{try{const e=new _a;return{success:!0,userCredential:await FO(r,e)}}catch(e){return{success:!1,error:fc(e)}}},k8=async(r,e,t)=>{try{return await fO(r,e,t),window.localStorage.setItem("emailForSignIn",e),{success:!0,message:`Sign-in link sent to ${e}!`}}catch(n){return{success:!1,error:fc(n)}}},P8=async(r,e,t)=>{if(ok(r,t))try{const n=await mO(r,e,t);return window.localStorage.removeItem("emailForSignIn"),{success:!0,userCredential:n}}catch(n){return{success:!1,error:fc(n)}}return{success:!1,error:"Not a valid sign-in-with-email-link request."}},C8=async(r,e)=>{try{return await uO(r,e),{success:!0,message:"Password reset email sent!"}}catch(t){return{success:!1,error:fc(t)}}},R8=async r=>{try{return await vO(r),{success:!0,message:"Logged out successfully."}}catch(e){return{success:!1,error:fc(e)}}},WC=(r,e,t='1/2"',n={})=>{let i=0,s=0,o=0,l=0,d=0,f=0,m=0,y=0;const g=parseFloat(r)||0,_={fcdaPercentage:1.29,environmentalChargePercentage:25,sewerageChargePercentageCommercial:32.85,governmentTaxPercentage:2,vatPercentage:12},E={..._,...n},x=(E.fcdaPercentage||_.fcdaPercentage)/100,b=(E.environmentalChargePercentage||_.environmentalChargePercentage)/100,T=(E.sewerageChargePercentageCommercial||_.sewerageChargePercentageCommercial)/100,N=(E.governmentTaxPercentage||_.governmentTaxPercentage)/100,R=(E.vatPercentage||_.vatPercentage)/100,I=String(t).replace(/["]/g,"").trim();if(I==="1/2"||I==="15mm"?d=1.5:I==="3/4"||I==="20mm"?d=2:I==="1"||I==="25mm"?d=3:I==="1 1/4"||I==="40mm"||I==="1 1/2"||I==="32mm"?d=4:I==="2"||I==="50mm"?d=6:I==="3"||I==="75mm"?d=10:I==="4"||I==="100mm"?d=20:I==="6"||I==="150mm"?d=35:I==="8"||I==="200mm"?d=50:d=1.5,e==="Residential Low-Income")if(g<=10)i=70.07;else if(g<=20)i=70.07+(g-10)*14.29;else{i=70.07+10*14.29;let k=g-20;k>0&&(k<=10?i+=k*23.82:k<=20?i+=10*23.82+(k-10)*45.17:i+=10*23.82+10*45.17+(k-20)*59.54)}else if(e==="Residential")g<=10?i=195.49:g<=20?i=195.49+(g-10)*23.82:g<=30?i=195.49+10*23.82+(g-20)*45.17:g<=50?i=195.49+10*23.82+10*45.17+(g-30)*59.54:g<=70?i=195.49+10*23.82+10*45.17+20*59.54+(g-50)*69.52:g<=90?i=195.49+10*23.82+10*45.17+20*59.54+20*69.52+(g-70)*72.89:g<=140?i=195.49+10*23.82+10*45.17+20*59.54+20*69.52+20*72.89+(g-90)*76.14:g<=200?i=195.49+10*23.82+10*45.17+20*59.54+20*69.52+20*72.89+50*76.14+(g-140)*79.42:i=195.49+10*23.82+10*45.17+20*59.54+20*69.52+20*72.89+50*76.14+60*79.42+(g-200)*82.67;else if(e==="Semi-Business")if(g<=10)i=195.49;else{i=195.49;let k=g-10;k<=10?i+=k*39.9:k<=30?i+=10*39.9+(k-10)*49.22:k<=50?i+=10*39.9+20*49.22+(k-30)*62.55:k<=70?i+=10*39.9+20*49.22+20*62.55+(k-50)*72.88:k<=120?i+=10*39.9+20*49.22+20*62.55+20*72.88+(k-70)*76.14:k<=170?i+=10*39.9+20*49.22+20*62.55+20*72.88+50*76.14+(k-120)*79.42:i+=10*39.9+20*49.22+20*62.55+20*72.88+50*76.14+50*79.42+(k-170)*82.67}else if(e==="Commercial"||e==="Admin"){const k=[{limit:10,rate:0,fixed:512.3},{limit:20,rate:53.61},{limit:40,rate:58.98},{limit:60,rate:64.33},{limit:80,rate:69.69},{limit:100,rate:72.88},{limit:150,rate:76.14},{limit:200,rate:79.42},{limit:1/0,rate:82.67}];let D=g;i=0,D>0&&k[0].fixed&&(i+=k[0].fixed,D-=k[0].limit);for(let O=1;O<k.length&&!(D<=0);O++){const P=k[O-1].limit,F=k[O].limit-P,M=Math.min(D,F);i+=M*k[O].rate,D-=M}}else e==="Industrial"||e==="Meter Reading Personnel"?i=g*72.68:g<=10?i=195.49:i=195.49+(g-10)*23.82;s=i*x,y=i+s,o=y*b,e==="Commercial"||e==="Industrial"||e==="Admin"||e==="Meter Reading Personnel"?l=y*T:l=0;const j=y+o+l+d;f=j*N;const U=j;m=U*R;const C=U+f+m;return{consumption:g,serviceType:e,meterSize:I,basicCharge:parseFloat(i.toFixed(2)),fcda:parseFloat(s.toFixed(2)),waterCharge:parseFloat(y.toFixed(2)),environmentalCharge:parseFloat(o.toFixed(2)),sewerageCharge:parseFloat(l.toFixed(2)),maintenanceServiceCharge:parseFloat(d.toFixed(2)),subTotalBeforeTaxes:parseFloat(U.toFixed(2)),governmentTaxes:parseFloat(f.toFixed(2)),vatableSales:parseFloat(U.toFixed(2)),vat:parseFloat(m.toFixed(2)),totalCalculatedCharges:parseFloat(C.toFixed(2))}},y2=r=>{if(!r||typeof r!="string")return{serviceType:"Residential",role:"customer"};const e=r.toUpperCase().trim();return e.startsWith("ADM")?{serviceType:"Admin",role:"admin"}:e.startsWith("PER")?{serviceType:"Meter Reading Personnel",role:"meter_reader"}:e.startsWith("CLE")?{serviceType:"Clerk Operations",role:"clerk_cashier"}:e.startsWith("RES-LI")?{serviceType:"Residential Low-Income",role:"customer"}:e.startsWith("RES")?{serviceType:"Residential",role:"customer"}:e.startsWith("COM")?{serviceType:"Commercial",role:"customer"}:e.startsWith("IND")?{serviceType:"Industrial",role:"customer"}:{serviceType:"Residential",role:"customer"}},j8=r=>`https://placehold.co/100x100/3b82f6/FFFFFF?text=${r?r.charAt(0).toUpperCase():"A"}`,$t=(r,e={year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})=>{if(!r)return"N/A";let t;if(r.toDate&&typeof r.toDate=="function")t=r.toDate();else if(r instanceof Date)t=r;else if(typeof r=="string"||typeof r=="number")t=new Date(r);else return"Invalid Date";if(isNaN(t.getTime()))return"Invalid Date";try{return new Intl.DateTimeFormat("en-US",e).format(t)}catch{return"Invalid Date"}},O8=(r,e)=>{if(!r||!e)return 0;if(r.penaltyAmount&&r.penaltyAmount>0)return r.penaltyAmount;const t=(e.latePaymentPenaltyPercentage||2)/100,n=r.totalCalculatedCharges||0;return n>0&&t>0?parseFloat((n*t).toFixed(2)):0},v2=(r,e)=>{var i;if(!r||!e||r.status==="Paid")return 0;const t=new Date,n=(i=r.dueDate)!=null&&i.toDate?r.dueDate.toDate():null;if(!n)return 0;if(t>n){if(r.penaltyAmount&&r.penaltyAmount>0)return r.penaltyAmount;const s=(e.latePaymentPenaltyPercentage||2)/100,o=r.totalCalculatedCharges||0;if(o>0&&s>0)return parseFloat((o*s).toFixed(2))}return 0};function st(r,e){console.error(`Firestore Error [${r}]:`,e);const t=e.code||"unknown",n=e.message||"An unexpected error occurred.";let i=`An error occurred while ${r.replace(/([A-Z])/g," $1").toLowerCase()}. Code: ${t}.`;return t==="failed-precondition"?i=`Query failed: ${n}. This almost always means you are missing a Firestore index. Check the console logs (on your server or browser) for a link to create the required index.`:t==="permission-denied"?i=`An error occurred: Permission denied. You don't have permission for this action. Please check your Firestore rules. (Function: ${r})`:i=`An error occurred in ${r}: ${n} (Code: ${t}). Please check your connection or contact support if the issue persists.`,{success:!1,error:i}}async function M8(r,e,t){if(!e||e.length===0)return{success:!0};try{const n=La(r);return e.forEach(i=>{const s=zt(r,Zy(i));n.update(s,{status:t,lastUpdatedAt:On()})}),await n.commit(),{success:!0,count:e.length}}catch(n){return st("batch updating ticket status",n)}}async function D8(r,e){if(!e)return{success:!1,error:"User ID is required."};try{const t=La(r),n=zt(r,zn(),e),i=zt(r,Fa(e));return t.delete(n),t.delete(i),await t.commit(),{success:!0}}catch(t){return st(`deleting user profile ${e}`,t)}}async function rh(r,e){try{const t=await gt(ft(ot(r,e),mu(500)));if(t.empty)return{success:!0,count:0};let n=0,i=t;for(;!i.empty;){const s=La(r);if(i.docs.forEach(o=>{s.delete(o.ref)}),await s.commit(),n+=i.size,i.size<500)break;i=await gt(ft(ot(r,e),mu(500)))}return{success:!0,count:n}}catch(t){return st(`deleting all from ${e}`,t)}}function L8(r){return rh(r,hc())}function F8(r){return rh(r,mi())}function V8(r){return rh(r,Va())}function z8(r){return rh(r,km())}function B8(r){return rh(r,bu())}function U8(r){return rh(r,ec())}async function q8(r){try{const e=ot(r,zn()),t=await gt(ft(e,mu(500)));if(t.empty)return{success:!0,count:0};let n=0,i=t;const s={rebatePoints:0,rebateTier:"Bronze"};for(;!i.empty;){const o=La(r);if(i.docs.forEach(d=>{o.update(d.ref,s);const f=zt(r,Fa(d.id));o.update(f,s)}),await o.commit(),n+=i.size,i.size<500)break;const l=i.docs[i.docs.length-1];i=await gt(ft(e,Wn(IC()),startAfter(l),mu(500)))}return{success:!0,count:n}}catch(e){return st("clearing all rebate points",e)}}async function H8(r){try{const e=await gt(ft(ot(r,zn())));if(e.empty)return{success:!0,count:0};const t=La(r);return e.docs.forEach(n=>{t.delete(zt(r,zn(),n.id)),t.delete(zt(r,Fa(n.id)))}),await t.commit(),{success:!0,count:e.size}}catch(e){return st("deleting all users",e)}}async function $8(r,e,t){if(!t||!e)return{success:!1,error:"User ID and Account Number required."};const n=t.trim().toUpperCase();if(!n)return{success:!1,error:"Account Number cannot be empty."};try{const i=ot(r,zn()),s=ft(i,wt("accountNumber","==",n)),o=await gt(s);if(o.empty)return{success:!1,error:`Account Number "${n}" not found.`};const l=o.docs[0],d=l.data(),f=l.id;if(f===e)return{success:!0};if(d.uid&&d.uid!==e)return{success:!1,error:"Account already linked to another user."};const{role:m,serviceType:y}=y2(n),g={uid:e,accountNumber:n,role:m,serviceType:y,meterSerialNumber:d.meterSerialNumber||"",meterSize:d.meterSize||'1/2"',serviceAddress:d.serviceAddress||{}},_=La(r);return _.update(zt(r,zn(),f),g),_.update(zt(r,Fa(e)),g),await _.commit(),{success:!0}}catch(i){return st("linking account number",i)}}async function W8(r){try{const e=ot(r,zn()),t=await gt(e),n=new Set;return t.docs.forEach(i=>{var o;const s=(o=i.data().serviceAddress)==null?void 0:o.barangay;s&&n.add(s)}),{success:!0,data:Array.from(n).sort()}}catch(e){return st("getting unique service locations",e)}}async function G8(r,e){if(!e)return{success:!0,data:[]};try{const t=ot(r,zn()),n=ft(t,wt("serviceAddress.barangay","==",e));return{success:!0,data:(await gt(n)).docs.map(o=>o.data().accountNumber).filter(Boolean)}}catch(t){return st(`getting accounts in ${e}`,t)}}async function K8(r,e,t=null){try{const n={...e,updatedAt:On()};return t?await as(zt(r,ec(),t),n):(n.createdAt=On(),await nh(ot(r,ec()),n)),{success:!0}}catch(n){return st("saving meter route",n)}}async function Y8(r){try{const e=ft(ot(r,ec()),Wn("name","asc"));return{success:!0,data:(await gt(e)).docs.map(n=>({id:n.id,...n.data()}))}}catch(e){return st("getting all meter routes",e)}}async function Z8(r,e){try{return await Nm(zt(r,ec(),e)),{success:!0}}catch(t){return st("deleting meter route",t)}}async function Q8(r){try{const e=ft(ot(r,zn()),wt("role","==","meter_reader"),Wn("displayName","asc"));return{success:!0,data:(await gt(e)).docs.map(n=>({id:n.id,...n.data()}))}}catch(e){return st("getting all meter readers",e)}}async function X8(r){try{const e=ft(ot(r,mi()),wt("status","==","Paid")),t=await gt(e),n={};t.forEach(s=>{var f;const o=s.data(),l=(f=o.paymentDate)!=null&&f.toDate?o.paymentDate.toDate():null;if(!l)return;const d=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`;n[d]=(n[d]||0)+(o.amountPaid||0)});const i=Object.entries(n).sort(([s],[o])=>s.localeCompare(o)).slice(-12);return{success:!0,data:Object.fromEntries(i)}}catch(e){return st("getting revenue stats",e)}}async function J8(r){try{const e=ft(ot(r,mi()),wt("status","==","Paid")),t=await gt(e);if(t.empty)return{success:!0,data:{}};const n={},i=[...new Set(t.docs.map(o=>o.data().userId).filter(Boolean))],s={};for(let o=0;o<i.length;o+=30){const l=i.slice(o,o+30);if(l.length===0)continue;const d=ft(ot(r,zn()),wt(IC(),"in",l));(await gt(d)).forEach(m=>s[m.id]=m.data())}return t.forEach(o=>{var m;const l=o.data(),d=s[l.userId];if(!d)return;const f=((m=d.serviceAddress)==null?void 0:m.barangay)||"Unknown Barangay";n[f]=(n[f]||0)+(l.amountPaid||0)}),{success:!0,data:n}}catch(e){return st("getting revenue by location",e)}}async function e9(r){try{const e=ft(ot(r,mi()),wt("status","==","Unpaid")),t=await gt(e);let n=0;return t.forEach(i=>{n+=i.data().amount||0}),{success:!0,data:{totalOutstanding:n}}}catch(e){return st("getting outstanding balance",e)}}async function t9(r,e){const t=e==null?void 0:e.accountNumbers;if(!Array.isArray(t)||t.length===0)return{success:!0,data:[]};try{const n=ot(r,zn()),i=[];for(let s=0;s<t.length;s+=30){const o=t.slice(s,s+30);if(o.length===0)continue;const l=ft(n,wt("accountNumber","in",o));(await gt(l)).forEach(f=>i.push({id:f.id,...f.data()}))}return{success:!0,data:i}}catch(n){return st("getting accounts in route",n)}}async function _2(r,e){if(!e)return{success:!1,error:"User ID required."};try{const t=zt(r,zn(),e),n=await Sa(t);if(n.exists())return{success:!0,data:{id:n.id,...n.data()}};{const i=zt(r,Fa(e)),s=await Sa(i);return s.exists()?{success:!0,data:{id:s.id,...s.data()}}:{success:!1,error:"User profile not found."}}}catch(t){return st(`getting user profile ${e}`,t)}}async function Qy(r,e){const t=e==null?void 0:e.trim().toLowerCase();if(!t)return{success:!1,error:"Search term required."};const n=e.trim().toUpperCase();try{const i=ot(r,zn()),s=[ft(i,wt("accountNumber","==",n)),ft(i,wt("email","==",t)),ft(i,wt("meterSerialNumber","==",n)),ft(i,Wn("displayNameLower"),wt("displayNameLower",">=",t),wt("displayNameLower","<=",t+""))],o=await Promise.allSettled(s.map(d=>gt(d))),l=new Map;return o.forEach(d=>{d.status==="fulfilled"?d.value.forEach(f=>{l.has(f.id)||l.set(f.id,{id:f.id,...f.data()})}):console.error("Search query failed:",d.reason)}),{success:!0,data:Array.from(l.values())}}catch(i){return st("searching user profiles",i)}}function $T(r){return r?r.toLocaleDateString("en-CA"):"N/A"}async function GC(r,e,t){if(!e||!t)return{success:!1,error:"User ID and profile required."};try{const n=await Xy(r),i=n.success?n.data:{},s=i.latePaymentPenaltyDelayDays||15,o=ft(ot(r,Va()),wt("userId","==",e),Wn("readingDate","desc"),mu(2)),l=await gt(o);if(l.docs.length<2)return{success:!1,error:"At least two readings needed."};const d=l.docs[0],f=l.docs[1],m=d.data(),y=f.data(),g=m.readingValue-y.readingValue;if(g<0)return{success:!1,error:"Latest reading is lower than previous."};const _=m.readingDate.toDate(),E=_.toLocaleString("en-US",{month:"long",year:"numeric"}),x=ft(ot(r,mi()),wt("userId","==",e),wt("monthYear","==",E));if(!(await gt(x)).empty)return{success:!1,error:`Bill for ${E} already exists.`};const T=WC(g,t.serviceType,t.meterSize,i),N=T.totalCalculatedCharges||0,R=t.discountStatus==="verified"&&(i.seniorCitizenDiscountPercentage||0)>0?parseFloat((N*(i.seniorCitizenDiscountPercentage/100)).toFixed(2)):0;let I=0,j=0;const U=ft(ot(r,mi()),wt("userId","==",e),wt("status","==","Unpaid"),Wn("dueDate","desc")),C=await gt(U);C.empty||C.docs.forEach(M=>{const $=M.data();I+=$.amount||0});const k=N+I-R,D=new Date(_);D.setDate(D.getDate()+s);const O={userId:e,accountNumber:t.accountNumber,userName:t.displayName,billingPeriod:`${$T(y.readingDate.toDate())} - ${$T(m.readingDate.toDate())}`,monthYear:E,billDate:jt.fromDate(_),dueDate:jt.fromDate(D),previousReading:y.readingValue,currentReading:m.readingValue,consumption:g,...T,penaltyAmount:0,previousUnpaidAmount:parseFloat(I.toFixed(2)),seniorCitizenDiscount:parseFloat(R.toFixed(2)),amount:parseFloat(k.toFixed(2)),status:"Unpaid",createdAt:On(),previousReadingId:f.id,currentReadingId:d.id},P=await nh(ot(r,mi()),O),F=`AGWA-${P.id.slice(0,4).toUpperCase()}-${_.getFullYear()}${String(_.getMonth()+1).padStart(2,"0")}${String(_.getDate()).padStart(2,"0")}`;return await as(P,{billId:P.id,invoiceNumber:F}),{success:!0,message:`Bill for ${E} generated.`,billId:P.id}}catch(n){return st(`generating bill for ${t==null?void 0:t.accountNumber}`,n)}}async function n9(r,e){if(!e)return{success:!1,error:"Location required."};try{const t=ot(r,bu()),n=ft(t,wt("affectedAreas","array-contains",e),wt("status","in",["Scheduled","Ongoing"]),wt("isBillingPaused","==",!0));if(!(await gt(n)).empty)return{success:!0,data:[]};const s=ft(ot(r,zn()),wt("serviceAddress.barangay","==",e),Wn("displayName","asc")),o=await gt(s);if(o.empty)return{success:!0,data:[]};const l=[],d=new Date;d.setDate(d.getDate()-30);for(const f of o.docs){const m={id:f.id,...f.data()};if(!m.accountNumber)continue;const y=ft(ot(r,Va()),wt("userId","==",m.id),Wn("readingDate","desc"),mu(2)),g=await gt(y);if(g.docs.length<2)continue;const E=g.docs[0].data().readingDate.toDate().toLocaleString("default",{month:"long",year:"numeric"}),x=ft(ot(r,mi()),wt("userId","==",m.id),wt("monthYear","==",E),mu(1));(await gt(x)).empty&&l.push(m)}return{success:!0,data:l}}catch(t){return st(`getting billable accounts in ${e}`,t)}}async function r9(r,e){const t=[];let n=0,i=0;for(const s of e){const o=await GC(r,s.id,s);t.push({success:o.success,message:`${o.success?"SUCCESS":"FAILED"} [${s.accountNumber}]: ${o.message||o.error}`}),o.success?n++:i++}return{logs:t,successCount:n,failCount:i}}async function i9(r,e,t){if(!e)return{success:!1,error:"User ID required."};try{const n=La(r),i={...t,accountNumber:t.accountNumber?t.accountNumber.toUpperCase():"",uid:e,createdAt:On(),lastLoginAt:On(),displayNameLower:t.displayName?t.displayName.toLowerCase():"",rebatePoints:0,rebateTier:"Bronze",discountStatus:"none"};return n.set(zt(r,Fa(e)),i),n.set(zt(r,zn(),e),i),await n.commit(),{success:!0}}catch(n){return st("creating user profile",n)}}async function fd(r,e,t){if(!e)return{success:!1,error:"User ID required."};try{const n=La(r),i={...t,updatedAt:On()};return i.accountNumber&&(i.accountNumber=i.accountNumber.toUpperCase()),i.displayName&&(i.displayNameLower=i.displayName.toLowerCase()),t.discountStatus!==void 0&&(i.discountStatus=t.discountStatus),n.update(zt(r,Fa(e)),i),n.update(zt(r,zn(),e),i),await n.commit(),{success:!0}}catch(n){return st(`updating user profile ${e}`,n)}}async function s9(r){try{return{success:!0,data:(await gt(ft(ot(r,zn()),Wn("displayNameLower","asc")))).docs.map(t=>({id:t.id,...t.data()}))}}catch(e){return st("getting all users profiles",e)}}async function o9(r,e){try{const t=await nh(ot(r,hc()),{...e,status:"Open",submittedAt:On(),lastUpdatedAt:On(),conversation:[]});return await as(t,{ticketId:t.id}),{success:!0,id:t.id}}catch(t){return st("creating support ticket",t)}}async function a9(r,e){try{return await Nm(zt(r,Zy(e))),{success:!0}}catch(t){return st("deleting support ticket",t)}}async function KC(r,e,t){var n;if(!e||!(t!=null&&t.text))return{success:!1,error:"Ticket ID and reply text required."};try{const i=zt(r,Zy(e)),s={conversation:d8(t),lastUpdatedAt:On()},l=(n=(await Sa(i)).data())==null?void 0:n.status;return t.authorRole!=="admin"&&(l==="Resolved"||l==="Closed")?s.status="Open":(t.authorRole==="admin"&&l==="Open"||t.authorRole!=="admin"&&l==="Awaiting Customer")&&(s.status="In Progress"),await as(i,s),{success:!0}}catch(i){return st("adding ticket reply",i)}}async function WT(r){try{const e=ft(ot(r,hc()),Wn("lastUpdatedAt","desc"));return{success:!0,data:(await gt(e)).docs.map(n=>({id:n.id,...n.data()}))}}catch(e){return st("getting all support tickets",e)}}async function YC(r,e){try{const t=ft(ot(r,hc()),wt("userId","==",e),Wn("lastUpdatedAt","desc"));return{success:!0,data:(await gt(t)).docs.map(i=>({id:i.id,...i.data()}))}}catch(t){return st("getting tickets by reporter",t)}}async function l9(r,e,t){try{return await as(zt(r,Zy(e)),{...t,lastUpdatedAt:On()}),{success:!0}}catch(n){return st("updating support ticket",n)}}async function c9(r,e){try{const t=await nh(ot(r,km()),{...e,createdAt:On(),updatedAt:On()});return await as(t,{announcementId:t.id}),{success:!0,id:t.id}}catch(t){return st("creating announcement",t)}}async function u9(r,e=!1){try{const t=e?[wt("status","==","active"),Wn("startDate","desc")]:[Wn("createdAt","desc")],n=ft(ot(r,km()),...t);return{success:!0,data:(await gt(n)).docs.map(s=>({id:s.id,...s.data()}))}}catch(t){return st("getting announcements",t)}}async function GT(r,e,t){try{return await as(zt(r,qC(e)),{...t,updatedAt:On()}),{success:!0}}catch(n){return st("updating announcement",n)}}async function d9(r,e){try{return await Nm(zt(r,qC(e))),{success:!0}}catch(t){return st("deleting announcement",t)}}async function Xy(r){try{const e=await Sa(zt(r,Ud()));return{success:!0,data:e.exists()?e.data():null}}catch(e){return st("getting system settings",e)}}async function h9(r,e){try{return await l8(zt(r,Ud()),e,{merge:!0}),{success:!0}}catch(t){return st("updating system settings",t)}}async function ih(r,e){try{const t=ft(ot(r,mi()),wt("userId","==",e),Wn("billDate","desc"));return{success:!0,data:(await gt(t)).docs.map(s=>({id:s.id,...s.data()}))}}catch(t){return st("getting bills for user",t)}}async function f9(r,e,t,n,i){var s,o,l,d;if(!(!(i!=null&&i.isRebateProgramEnabled)||!e))try{const f=parseFloat(i.pointsPerPeso);if(isNaN(f)||f<=0)return;const m=parseInt(i.earlyPaymentDaysThreshold,10)||7,y=parseInt(i.earlyPaymentBonusPoints,10)||10;let g=n*f;const _=(s=t.dueDate)!=null&&s.toDate?t.dueDate.toDate():(o=t.dueDate)!=null&&o.seconds?new Date(t.dueDate.seconds*1e3):null,E=(l=t.paymentDate)!=null&&l.toDate?t.paymentDate.toDate():t.paymentDate instanceof Date?t.paymentDate:(d=t.paymentDate)!=null&&d.seconds?t.paymentDate.toDate():new Date;_&&(_.getTime()-E.getTime())/864e5>=m&&(g+=y);const x=Math.round(g);if(x<=0)return;const b=zt(r,zn(),e),T=await Sa(b);if(!T.exists()){console.error(`dataService: CRITICAL! Public profile ${e} not found. Cannot award points.`);return}const N=zt(r,Fa(e)),I=(T.data().rebatePoints||0)+x;let j="Bronze";I>=3e3?j="Platinum":I>=1500?j="Gold":I>=500&&(j="Silver");const U={rebatePoints:I,rebateTier:j,updatedAt:On()},C=La(r);C.update(b,U),C.update(N,U),await C.commit()}catch(f){console.error("dataService: Failed to award rebate points:",f)}}async function ZC(r,e,t){var n;try{const i=zt(r,T8(e)),s=t.amountPaid;let o={};if(t.status==="Paid"){const l=await Sa(i);if(l.exists()){const d=l.data(),f=t.paymentDate||new Date,m=(n=d.dueDate)!=null&&n.toDate?d.dueDate.toDate():null,y={...t,lastUpdatedAt:On()};if(m&&f>m&&!d.penaltyAmount){const g=await Sa(zt(r,Ud())),E=((g.exists()?g.data():{}).latePaymentPenaltyPercentage||2)/100,x=d.totalCalculatedCharges||0;if(x>0&&E>0){const b=parseFloat((x*E).toFixed(2));y.penaltyAmount=b;const T=d.amount||d.totalCalculatedCharges+(d.previousUnpaidAmount||0)-(d.seniorCitizenDiscount||0);y.amount=T+b,(!y.amountPaid||y.amountPaid<y.amount)&&(y.amountPaid=y.amount)}}if(o={...d,...y},await as(i,y),d.userId&&s>0){const g=await Sa(zt(r,Ud())),_=g.exists()?g.data():{};await f9(r,d.userId,o,s,_)}return{success:!0}}else throw new Error("Bill document not found.")}return await as(i,{...t,lastUpdatedAt:On()}),{success:!0}}catch(i){return st("updating bill",i)}}async function QC(r,e){try{const t=new Date(e.readingDate);if(isNaN(t))throw new Error("Invalid reading date format.");const n={...e,readingValue:parseFloat(e.readingValue)||0,readingDate:jt.fromDate(t),readingDateString:e.readingDate,recordedAt:On()},i=await nh(ot(r,Va()),n);return await as(i,{readingId:i.id}),{success:!0,id:i.id}}catch(t){return st("adding meter reading",t)}}async function m9(r,e,t){try{const n=zt(r,HC(e)),i={...t,lastUpdatedAt:On()};if(i.readingDate&&typeof i.readingDate=="string"){const s=new Date(i.readingDate);isNaN(s)?(delete i.readingDate,delete i.readingDateString):(i.readingDate=jt.fromDate(s),i.readingDateString=i.readingDate)}return i.readingValue!==void 0&&(i.readingValue=parseFloat(i.readingValue)||0),await as(n,i),{success:!0}}catch(n){return st("updating meter reading",n)}}async function p9(r,e){try{return await Nm(zt(r,HC(e))),{success:!0}}catch(t){return st("deleting meter reading",t)}}async function g9(r,e){try{const t=ft(ot(r,Va()),wt("accountNumber","==",e),Wn("readingDate","desc"));return{success:!0,data:(await gt(t)).docs.map(i=>({id:i.id,...i.data()}))}}catch(t){return st("getting meter readings for account",t)}}async function XC(r,e){try{const t=ft(ot(r,ec()),wt("assignedReaderId","==",e),Wn("name"));return{success:!0,data:(await gt(t)).docs.map(i=>({id:i.id,...i.data()}))}}catch(t){return st("getting routes for reader",t)}}async function y9(r,e,t=[]){try{const n=ft(ot(r,e),...t);return{success:!0,data:(await gt(n)).docs.map(s=>({id:s.id,...s.data()}))}}catch(n){return st(`getting documents from ${e.split("/").pop()}`,n)}}async function JC(r){try{const e=ot(r,zn()),t=await Rx(e),i=(await gt(e)).docs.reduce((s,o)=>{const l=o.data().role||"unknown";return s[l]=(s[l]||0)+1,s},{});return{success:!0,data:{total:t.data().count,byRole:i}}}catch(e){return st("getting users stats",e)}}async function e3(r){try{const e=ot(r,hc()),t=ft(e,Wn("lastUpdatedAt","asc")),n=await gt(t);let i=0;const s={total:n.size,byStatus:{},byType:{}};return n.forEach(o=>{const l=o.data(),d=l.status||"Unknown",f=l.issueType||"Other Concern";s.byStatus[d]=(s.byStatus[d]||0)+1,s.byType[f]=(s.byType[f]||0)+1,d!=="Closed"&&d!=="Resolved"&&i++}),s.openCount=i,{success:!0,data:s}}catch(e){return st("getting tickets stats",e)}}async function v9(r){try{const e=ot(r,km()),t=await Rx(e),n=ft(e,wt("status","==","active")),i=await Rx(n).catch(()=>({data:()=>({count:0})}));return{success:!0,data:{total:t.data().count,active:i.data().count}}}catch(e){return st("getting announcements stats",e)}}async function _9(r,e){if(!e)return{success:!1,error:"Clerk ID required."};try{const t=new Date;t.setHours(0,0,0,0);const n=new Date;n.setHours(23,59,59,999);const i=jt.fromDate(t),s=jt.fromDate(n),o=ft(ot(r,mi()),wt("processedByClerkId","==",e),wt("paymentTimestamp",">=",i),wt("paymentTimestamp","<=",s)),l=await gt(o);let d=0;const f=l.docs.map(m=>{const y=m.data();return d+=y.amountPaid||0,{id:m.id,...y}});return{success:!0,data:{paymentsTodayCount:l.size,totalCollectedToday:d,transactions:f.sort((m,y)=>y.paymentTimestamp.toDate()-m.paymentTimestamp.toDate())}}}catch(t){return st("getting payments by clerk for today",t)}}async function x9(r,e){try{const t=await nh(ot(r,bu()),{...e,startDate:jt.fromDate(new Date(e.startDate)),estimatedEndDate:e.estimatedEndDate?jt.fromDate(new Date(e.estimatedEndDate)):null,isBillingPaused:e.isBillingPaused||!1,createdAt:On(),updatedAt:On()});return await as(t,{interruptionId:t.id}),{success:!0,id:t.id}}catch(t){return st("creating service interruption",t)}}async function b9(r,e,t){try{const n={...t,updatedAt:On()};return n.startDate&&typeof n.startDate=="string"&&(n.startDate=jt.fromDate(new Date(n.startDate))),n.estimatedEndDate&&typeof n.estimatedEndDate=="string"&&(n.estimatedEndDate=jt.fromDate(new Date(n.estimatedEndDate))),n.status==="Resolved"&&!n.resolvedAt&&(n.resolvedAt=On()),await as(zt(r,$C(e)),n),{success:!0}}catch(n){return st("updating service interruption",n)}}async function w9(r,e){try{return await Nm(zt(r,$C(e))),{success:!0}}catch(t){return st("deleting service interruption",t)}}async function x2(r){try{const e=jt.now(),t=ft(ot(r,bu()),wt("status","in",["Ongoing","Scheduled"]),Wn("startDate","desc"));return{success:!0,data:(await gt(t)).docs.map(s=>({id:s.id,...s.data()})).filter(s=>s.status==="Scheduled"&&s.startDate.toMillis()>e.toMillis()?!0:s.status==="Ongoing"?s.estimatedEndDate?s.estimatedEndDate.toMillis()>e.toMillis():!0:s.status!=="Resolved"&&s.startDate.toMillis()<=e.toMillis()&&(!s.estimatedEndDate||s.estimatedEndDate.toMillis()>e.toMillis()))}}catch(e){return st("getting active service interruptions",e)}}async function E9(r){try{const e=ft(ot(r,bu()),Wn("createdAt","desc"));return{success:!0,data:(await gt(e)).docs.map(n=>({id:n.id,...n.data()}))}}catch(e){return st("getting all service interruptions",e)}}async function S9(r){try{const e=new Date,t=new Date(e.getFullYear(),e.getMonth(),e.getDate()),n=jt.fromDate(t),[i,s,o]=await Promise.all([gt(ft(ot(r,hc()),wt("submittedAt",">=",n))),gt(ft(ot(r,Va()),wt("recordedAt",">=",n))),gt(ft(ot(r,mi()),wt("paymentTimestamp",">=",n)))]),l=Array(24).fill(0).map(()=>({tickets:0,readings:0,payments:0}));return i.forEach(d=>{const f=d.data().submittedAt.toDate().getHours();l[f].tickets++}),s.forEach(d=>{const f=d.data().recordedAt.toDate().getHours();l[f].payments++}),o.forEach(d=>{const f=d.data().paymentTimestamp.toDate().getHours();l[f].payments++}),{success:!0,data:l}}catch(e){return st("getting hourly activity stats",e)}}async function T9(r){try{const e=new Date;e.setHours(0,0,0,0);const t=jt.fromDate(e),[n,i,s]=await Promise.all([gt(ft(ot(r,Va()),wt("recordedAt",">=",t))),gt(ft(ot(r,mi()),wt("processedByClerkId",">",""),wt("paymentTimestamp",">=",t))),gt(ft(ot(r,hc()),wt("lastUpdatedAt",">=",t)))]),o=n.docs.reduce((f,m)=>{const y=m.data().readBy||"Unknown Reader";return f[y]=(f[y]||0)+1,f},{}),l=i.docs.reduce((f,m)=>{const y=m.data().processedByClerkName||"Unknown Clerk";return f[y]=(f[y]||0)+1,f},{}),d=s.docs.reduce((f,m)=>{const y=m.data();if(y.status==="Resolved"||y.status==="Closed"){const g=y.lastUpdatedByAdminName||"Unknown Admin";f[g]=(f[g]||0)+1}return f},{});return{success:!0,data:{readerActivity:o,clerkActivity:l,adminActivity:d}}}catch(e){return st("getting staff activity stats",e)}}async function A9(r){try{const[e,t,n]=await Promise.all([gt(ot(r,ec())),gt(ft(ot(r,bu()),wt("status","in",["Scheduled","Ongoing"]),Wn("startDate","desc"))),gt(ft(ot(r,ec()),wt("assignedReaderId","==",""),Wn("name","asc")))]),i=e.size,s=e.docs.reduce((d,f)=>{var m;return d+(((m=f.data().accountNumbers)==null?void 0:m.length)||0)},0),o=t.size,l=n.size;return{success:!0,data:{totalRoutes:i,totalAccounts:s,activeInterrupts:o,unassignedRoutes:l}}}catch(e){return st("getting technical stats",e)}}async function N9(r){try{const e=ft(ot(r,mi())),t=await gt(e),n={};t.forEach(s=>{var f;const o=s.data(),l=(f=o.billDate)!=null&&f.toDate?o.billDate.toDate():null;if(!l||typeof o.consumption!="number")return;const d=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`;n[d]=(n[d]||0)+(o.consumption||0)});const i=Object.entries(n).sort(([s],[o])=>s.localeCompare(o)).slice(-12);return{success:!0,data:Object.fromEntries(i)}}catch(e){return st("getting consumption stats",e)}}async function I9(r){try{const e=ft(ot(r,mi()),wt("status","==","Paid")),t=await gt(e),n={};return t.forEach(i=>{const s=i.data().paymentMethod||"Unknown";n[s]=(n[s]||0)+1}),{success:!0,data:n}}catch(e){return st("getting payment method stats",e)}}async function k9(r){try{const e=ft(ot(r,zn()),wt("createdAt","!=",null)),t=await gt(e),n={};t.forEach(s=>{var f;const o=s.data(),l=(f=o.createdAt)!=null&&f.toDate?o.createdAt.toDate():null;if(!l)return;const d=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`;n[d]=(n[d]||0)+1});const i=Object.entries(n).sort(([s],[o])=>s.localeCompare(o)).slice(-12);return{success:!0,data:Object.fromEntries(i)}}catch(e){return st("getting user growth stats",e)}}async function P9(r){try{const e=ot(r,zn()),t=await gt(ft(e,wt("role","==","customer"))),n={none:0,pending:0,verified:0};return t.forEach(i=>{const s=i.data().discountStatus||"none";n.hasOwnProperty(s)&&n[s]++}),{success:!0,data:n}}catch(e){return st("getting discount stats",e)}}/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C9=r=>r.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),t3=(...r)=>r.filter((e,t,n)=>!!e&&n.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var R9={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const j9=J.forwardRef(({color:r="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:n,className:i="",children:s,iconNode:o,...l},d)=>J.createElement("svg",{ref:d,...R9,width:e,height:e,stroke:r,strokeWidth:n?Number(t)*24/Number(e):t,className:t3("lucide",i),...l},[...o.map(([f,m])=>J.createElement(f,m)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=(r,e)=>{const t=J.forwardRef(({className:n,...i},s)=>J.createElement(j9,{ref:s,iconNode:e,className:t3(`lucide-${C9(r)}`,n),...i}));return t.displayName=`${r}`,t};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ny=Fe("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KT=Fe("AtSign",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M16 8v5a3 3 0 0 0 6 0v-1a10 10 0 1 0-4 8",key:"7n84p3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ry=Fe("Banknote",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O9=Fe("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b2=Fe("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ox=Fe("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w2=Fe("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pu=Fe("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mx=Fe("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M9=Fe("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E2=Fe("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D9=Fe("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ps=Fe("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S2=Fe("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L9=Fe("CirclePause",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"10",x2:"10",y1:"15",y2:"9",key:"c1nkhi"}],["line",{x1:"14",x2:"14",y1:"15",y2:"9",key:"h65svq"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F9=Fe("CirclePlay",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polygon",{points:"10 8 16 12 10 16 10 8",key:"1cimsy"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jy=Fe("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cs=Fe("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V9=Fe("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const z9=Fe("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T2=Fe("ClipboardPen",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",key:"1oijnt"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-5.5",key:"cereej"}],["path",{d:"M4 13.5V6a2 2 0 0 1 2-2h2",key:"5ua5vh"}],["path",{d:"M13.378 15.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"1y4qbx"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const di=Fe("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B9=Fe("Compass",[["path",{d:"m16.24 7.76-1.804 5.411a2 2 0 0 1-1.265 1.265L7.76 16.24l1.804-5.411a2 2 0 0 1 1.265-1.265z",key:"9ktpf1"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e0=Fe("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dl=Fe("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U9=Fe("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q9=Fe("Droplets",[["path",{d:"M7 16.3c2.2 0 4-1.83 4-4.05 0-1.16-.57-2.26-1.71-3.19S7.29 6.75 7 5.3c-.29 1.45-1.14 2.84-2.29 3.76S3 11.1 3 12.25c0 2.22 1.8 4.05 4 4.05z",key:"1ptgy4"}],["path",{d:"M12.56 6.6A10.97 10.97 0 0 0 14 3.02c.5 2.5 2 4.9 4 6.5s3 3.5 3 5.5a6.98 6.98 0 0 1-11.91 4.97",key:"1sl1rz"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iy=Fe("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tc=Fe("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H9=Fe("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $9=Fe("FilePlus",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M9 15h6",key:"cctwl0"}],["path",{d:"M12 18v-6",key:"17g6i2"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const A2=Fe("FileSearch",[["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M4.268 21a2 2 0 0 0 1.727 1H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"ms7g94"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}],["circle",{cx:"5",cy:"14",r:"3",key:"ufru5t"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nc=Fe("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const W9=Fe("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rc=Fe("Gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sy=Fe("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G9=Fe("HardHat",[["path",{d:"M2 18a1 1 0 0 0 1 1h18a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v2z",key:"1dej2m"}],["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6",key:"9ciidu"}],["path",{d:"M14 6a6 6 0 0 1 6 6v3",key:"1hnv84"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rs=Fe("Hash",[["line",{x1:"4",x2:"20",y1:"9",y2:"9",key:"4lhtct"}],["line",{x1:"4",x2:"20",y1:"15",y2:"15",key:"vyu0kd"}],["line",{x1:"10",x2:"8",y1:"3",y2:"21",key:"1ggp8o"}],["line",{x1:"16",x2:"14",y1:"3",y2:"21",key:"weycgp"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N2=Fe("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gn=Fe("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const K9=Fe("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oy=Fe("KeyRound",[["path",{d:"M2 18v3c0 .6.4 1 1 1h4v-3h3v-3h2l1.4-1.4a6.5 6.5 0 1 0-4-4Z",key:"167ctg"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I2=Fe("Link",[["path",{d:"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71",key:"1cjeqo"}],["path",{d:"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71",key:"19qd67"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n3=Fe("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y9=Fe("ListFilter",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M7 12h10",key:"b7w52i"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z9=Fe("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Et=Fe("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t0=Fe("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fo=Fe("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const co=Fe("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ic=Fe("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bd=Fe("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q9=Fe("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X9=Fe("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pa=Fe("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r3=Fe("OctagonAlert",[["polygon",{points:"7.86 2 16.14 2 22 7.86 22 16.14 16.14 22 7.86 22 2 16.14 2 7.86 7.86 2",key:"h1p8hx"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const k2=Fe("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J9=Fe("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ya=Fe("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i3=Fe("PhoneCall",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}],["path",{d:"M14.05 2a9 9 0 0 1 8 7.94",key:"vmijpz"}],["path",{d:"M14.05 6A5 5 0 0 1 18 10",key:"13nbpp"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eF=Fe("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P2=Fe("Printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tF=Fe("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const za=Fe("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ba=Fe("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const js=Fe("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n0=Fe("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r0=Fe("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sh=Fe("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nF=Fe("ShieldQuestion",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Os=Fe("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s3=Fe("SquareCheckBig",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tm=Fe("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rF=Fe("SquareX",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const md=Fe("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iF=Fe("StickyNote",[["path",{d:"M16 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8Z",key:"qazsjp"}],["path",{d:"M15 3v4a2 2 0 0 0 2 2h4",key:"40519r"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sF=Fe("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oh=Fe("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o3=Fe("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kt=Fe("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oF=Fe("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a3=Fe("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aF=Fe("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const l3=Fe("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c3=Fe("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gv=Fe("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lF=Fe("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cF=Fe("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ta=Fe("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YT=Fe("Wind",[["path",{d:"M17.7 7.7a2.5 2.5 0 1 1 1.8 4.3H2",key:"1k4u03"}],["path",{d:"M9.6 4.6A2 2 0 1 1 11 8H2",key:"b7d0fd"}],["path",{d:"M12.6 19.4A2 2 0 1 0 14 16H2",key:"1p5cb3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i0=Fe("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u3=Fe("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),Dx=ss.memo(({message:r,type:e,onClose:t})=>{if(J.useEffect(()=>{if(!r)return;const s=setTimeout(()=>{t()},5e3);return()=>clearTimeout(s)},[t,r,e]),!r)return null;let n="bg-red-500",i=Kt;return e==="success"?(n="bg-green-500",i=Ps):e==="warning"?(n="bg-yellow-500",i=Kt):e==="info"&&(n="bg-blue-500",i=Kt),u.jsxs("div",{className:`fixed top-5 right-5 ${n} text-white p-4 rounded-lg shadow-xl flex items-center space-x-3 z-[200] animate-slide-in-right`,role:"alert",children:[u.jsx(i,{size:24,"aria-hidden":"true"}),u.jsx("span",{className:"text-sm font-medium",children:r}),u.jsx("button",{onClick:t,className:"ml-auto p-1 rounded-full hover:bg-white/20 transition-colors","aria-label":"Close notification",children:u.jsx(i0,{size:18})}),u.jsx("style",{children:`
        @keyframes slide-in-right {
          from {
            transform: translateX(100%);
            opacity: 0;
          }
          to {
            transform: translateX(0);
            opacity: 1;
          }
        }
        .animate-slide-in-right {
          animation: slide-in-right 0.5s cubic-bezier(0.25, 0.8, 0.25, 1) forwards;
        }
      `})]})});Dx.displayName="Notification";const ZT=({message:r="Loading..."})=>u.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-700 to-indigo-800 flex flex-col justify-center items-center p-4 font-inter text-white selection:bg-blue-300 selection:text-blue-900",children:[u.jsxs("div",{className:"text-center",children:[u.jsx("h1",{className:"text-6xl font-bold tracking-tight mb-2 animate-pulse",children:"AGWA"}),u.jsx("p",{className:"text-blue-200 text-lg italic mb-8",children:"Ensuring Clarity, Sustaining Life."}),u.jsx(Et,{className:"h-12 w-12 mx-auto animate-spin text-blue-300"}),u.jsx("p",{className:"text-blue-300 text-sm mt-4",children:r})]}),u.jsxs("p",{className:"text-center text-xs text-blue-400 mt-12 absolute bottom-6",children:[" ",new Date().getFullYear()," AGWA Water Services, Inc."]})]}),Ar=ss.memo(({isOpen:r,onClose:e,title:t="",children:n,size:i="md",hideCloseButton:s=!1,modalDialogClassName:o="",contentClassName:l=""})=>{const d=J.useCallback(y=>{y.key==="Escape"&&e()},[e]);if(J.useEffect(()=>(r?(window.addEventListener("keydown",d),document.body.style.overflow="hidden"):(window.removeEventListener("keydown",d),document.body.style.overflow="unset"),()=>{window.removeEventListener("keydown",d),document.body.style.overflow="unset"}),[r,d]),!r)return null;const f={sm:"max-w-sm",md:"max-w-md",lg:"max-w-lg",xl:"max-w-xl","2xl":"max-w-2xl","3xl":"max-w-3xl","4xl":"max-w-4xl","5xl":"max-w-5xl",full:"max-w-full h-full sm:h-auto sm:max-h-[95vh]"},m=`bg-white rounded-xl shadow-2xl w-full ${f[i]||f.md} transform transition-all duration-300 ease-out scale-95 opacity-0 animate-modal-appear flex flex-col max-h-[90vh] ${o}`;return u.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-70 backdrop-blur-sm flex justify-center items-center z-[100] p-4 overflow-y-auto animate-fadeIn",onClick:s?void 0:e,role:"dialog","aria-modal":"true","aria-labelledby":t?"modal-title":void 0,children:[u.jsxs("div",{className:m,onClick:y=>y.stopPropagation(),role:"document",children:[t&&u.jsxs("div",{className:"flex justify-between items-center p-4 sm:p-5 border-b border-gray-200 sticky top-0 bg-white z-10 rounded-t-xl",children:[u.jsx("h3",{id:"modal-title",className:"text-lg sm:text-xl font-semibold text-gray-800",children:t}),!s&&u.jsx("button",{type:"button",onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors p-1 rounded-full hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500","aria-label":"Close modal",children:u.jsx(i0,{size:24})})]}),u.jsx("div",{className:`p-4 sm:p-6 flex-grow overflow-y-auto ${l}`,children:n})]}),u.jsx("style",{children:`
                @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
                .animate-fadeIn { animation: fadeIn 0.2s ease-out forwards; }
                @keyframes modal-appear { 0% { transform: scale(0.95) translateY(10px); opacity: 0; } 100% { transform: scale(1) translateY(0); opacity: 1; } }
                .animate-modal-appear { animation: modal-appear 0.25s cubic-bezier(0.25, 0.8, 0.25, 1) forwards; }
                `})]})});Ar.displayName="Modal";const uF=({isOpen:r,onClose:e})=>u.jsx(Ar,{isOpen:r,onClose:e,title:"Terms of Service",size:"3xl",children:u.jsxs("div",{className:"prose prose-sm max-w-none max-h-[70vh] overflow-y-auto pr-2",children:[u.jsx("p",{children:u.jsx("strong",{children:"Last Updated: October 31, 2025"})}),u.jsx("p",{children:'Please read these Terms of Service ("Terms", "Terms of Service") carefully before using the AGWA Water Services, Inc. ("AGWA", "us", "we", or "our") customer portal (the "Service").'}),u.jsx("p",{children:"Your access to and use of the Service is conditioned on your acceptance of and compliance with these Terms. These Terms apply to all visitors, users, and others who access or use the Service."}),u.jsx("h4",{children:"1. Account Registration and Security"}),u.jsxs("ul",{children:[u.jsx("li",{children:"To use this Service, you must be a registered customer of AGWA Water Services, Inc. You agree to provide information that is accurate, complete, and current at all times. Failure to do so constitutes a breach of the Terms, which may result in immediate termination of your account on our Service."}),u.jsx("li",{children:"You are responsible for safeguarding the password that you use to access the Service and for any activities or actions under your password."}),u.jsx("li",{children:"You agree not to disclose your password to any third party. You must notify us immediately upon becoming aware of any breach of security or unauthorized use of your account."})]}),u.jsx("h4",{children:"2. Use of the Service"}),u.jsx("p",{children:"You agree to use the Service only for lawful purposes. You are responsible for all of your activity in connection with the Service. You shall not (and shall not permit any third party to):"}),u.jsxs("ul",{children:[u.jsx("li",{children:"Take any action that imposes or may impose (as determined by us in our sole discretion) an unreasonable or disproportionately large load on our infrastructure."}),u.jsx("li",{children:"Interfere or attempt to interfere with the proper working of the Service or any activities conducted on the Service."}),u.jsx("li",{children:"Bypass any measures we may use to prevent or restrict access to the Service."})]}),u.jsx("h4",{children:"3. Online Payments"}),u.jsxs("ul",{children:[u.jsx("li",{children:"The Service provides a platform to facilitate payments for your water bills using third-party payment gateways (e.g., Stripe)."}),u.jsx("li",{children:"AGWA is not a bank or financial institution. All payment transactions are processed by our third-party payment partners. You agree to abide by the terms and conditions of these partners."}),u.jsx("li",{children:"You are responsible for ensuring that your payment information is correct and that you have sufficient funds to cover your payment."})]}),u.jsx("h4",{children:"4. Disclaimers"}),u.jsx("p",{children:'The Service is provided on an "AS IS" and "AS AVAILABLE" basis. Your use of the Service is at your sole risk.'}),u.jsx("p",{children:"AGWA does not warrant that (a) the Service will function uninterrupted, secure, or available at any particular time or location; (b) any errors or defects will be corrected; (c) the Service is free of viruses or other harmful components."}),u.jsx("p",{children:"All data presented in the Portal (including consumption, billing amounts, and payment status) is provided for convenience. In the event of any discrepancy, the official records held by AGWA Water Services, Inc. shall be deemed correct."}),u.jsx("h4",{children:"5. Limitation of Liability"}),u.jsx("p",{children:"In no event shall AGWA, nor its directors, employees, partners, or agents, be liable for any indirect, incidental, special, consequential, or punitive damages, including without limitation, loss of profits, data, use, goodwill, or other intangible losses, resulting from your access to or use of or inability to access or use the Service."}),u.jsx("h4",{children:"6. Governing Law"}),u.jsx("p",{children:"These Terms shall be governed and construed in accordance with the laws of the Republic of the Philippines, without regard to its conflict of law provisions."}),u.jsx("h4",{children:"7. Changes to Terms"}),u.jsx("p",{children:"We reserve the right, at our sole discretion, to modify or replace these Terms at any time. We will provide notice of any changes by posting the new Terms on this page. Your continued use of the Service after any such changes constitutes your acceptance of the new Terms."}),u.jsx("h4",{children:"8. Contact Us"}),u.jsx("p",{children:'If you have any questions about these Terms, please contact us through the "Contact Us" page available after logging in.'})]})}),dF=({isOpen:r,onClose:e})=>u.jsx(Ar,{isOpen:r,onClose:e,title:"Data Privacy Notice",size:"3xl",children:u.jsxs("div",{className:"prose prose-sm max-w-none max-h-[70vh] overflow-y-auto pr-2",children:[u.jsx("p",{children:u.jsx("strong",{children:"Last Updated: October 31, 2025"})}),u.jsx("h4",{children:"Our Commitment to Privacy"}),u.jsx("p",{children:'AGWA Water Services, Inc. ("AGWA") is committed to protecting your privacy in accordance with Republic Act No. 10173, also known as the Data Privacy Act of 2012 (DPA), its Implementing Rules and Regulations (IRR), and other relevant data privacy laws.'}),u.jsx("h4",{children:"1. What Personal Information We Collect"}),u.jsx("p",{children:"We collect, store, and process your personal information when you register for an account, use our services, pay your bills, or interact with our customer support. This information may include:"}),u.jsxs("ul",{children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Personal Identification Data:"})," Full name, email address, phone number, and service address."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Account and Service Data:"})," AGWA Account Number, meter serial number, service type, account status, and account creation date."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Financial and Transaction Data:"})," Billing history, payment history, consumption data, payment method details (which are securely processed by our third-party payment partners), and rebate point information."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Communication Data:"})," Records of your correspondence with us, such as support tickets, chat logs, and issue reports."]})]}),u.jsx("h4",{children:"2. How We Use Your Information"}),u.jsx("p",{children:"Your personal data is used for the following legitimate business purposes:"}),u.jsxs("ul",{children:[u.jsx("li",{children:"To create, maintain, and secure your AGWA Portal account."}),u.jsx("li",{children:"To provide and manage your water services, including meter reading, billing, and maintenance."}),u.jsx("li",{children:"To process your bill payments and manage your account transactions."}),u.jsx("li",{children:"To respond to your inquiries, concerns, and support tickets, and to provide customer support."}),u.jsx("li",{children:"To send you essential service advisories, billing reminders, and other system notifications."}),u.jsx("li",{children:"To manage your participation in programs such as the AGWA Rewards Program."}),u.jsx("li",{children:"To analyze portal and service usage to improve our operations, services, and user experience."}),u.jsx("li",{children:"To comply with our legal and regulatory obligations as a public utility."})]}),u.jsx("h4",{children:"3. Data Sharing and Disclosure"}),u.jsx("p",{children:"We do not sell or rent your personal information. We may share your data in the following limited circumstances:"}),u.jsxs("ul",{children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Third-Party Service Providers:"})," With trusted partners who perform services on our behalf, such as payment gateways (e.g., Stripe) and data hosting (e.g., Firebase). These partners are contractually bound to protect your data and use it only for the purposes we specify."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Legal and Regulatory Requirements:"})," When required by law, such as in response to a subpoena, court order, or formal request from government authorities."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Emergency:"})," To protect the vital interests of any individual, such as during emergencies or service-related safety incidents."]})]}),u.jsx("h4",{children:"4. Data Security and Retention"}),u.jsx("p",{children:"We implement robust technical, physical, and organizational security measures to protect your personal information from unauthorized access, use, alteration, or disclosure. This includes data encryption, access controls, and secure server environments."}),u.jsx("p",{children:"We retain your personal data only for as long as your account is active or as necessary to fulfill the purposes outlined in this notice, and as required by law for auditing and regulatory record-keeping."}),u.jsx("h4",{children:"5. Your Rights as a Data Subject"}),u.jsx("p",{children:"In accordance with the Data Privacy Act, you have the right to:"}),u.jsxs("ul",{children:[u.jsxs("li",{children:[u.jsx("strong",{children:"Be Informed"})," that your personal data will be, are being, or were processed."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Access"})," your personal information we hold."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Rectify"})," any inaccuracies or errors in your data."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Erase or Block"})," your data from our systems, subject to legal and contractual limitations."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Object"})," to the processing of your personal data."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Data Portability"})," to obtain a copy of your data in a machine-readable format."]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Lodge a Complaint"})," with the National Privacy Commission (NPC) if you feel your data privacy rights have been violated."]})]}),u.jsx("h4",{children:"6. Contacting Us"}),u.jsx("p",{children:"To exercise any of these rights or if you have any questions about this privacy notice, please contact our Data Privacy Officer at:"}),u.jsxs("p",{children:[u.jsx("strong",{children:"Email:"})," ",u.jsx("a",{href:"mailto:dpo@agwa-waterservices.com.ph",children:"dpo@agwa-waterservices.com.ph"}),u.jsx("br",{}),u.jsx("strong",{children:"Hotline:"})," 1627-AGWA (Attn: Data Privacy Officer)"]}),u.jsx("h4",{children:"7. Changes to This Notice"}),u.jsx("p",{children:'We may update this Data Privacy Notice from time to time. We will notify you of any significant changes by posting the new notice on this page and updating the "Last Updated" date.'})]})}),d3=ss.memo(({children:r,authError:e,appIdForPaths:t,systemSettings:n={}})=>{const[i,s]=J.useState(!1),[o,l]=J.useState(!1);return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-700 to-indigo-800 flex flex-col justify-center items-center p-4 font-sans selection:bg-blue-300 selection:text-blue-900",children:[u.jsxs("div",{className:"bg-white p-8 sm:p-10 md:p-12 rounded-xl shadow-2xl w-full max-w-md transform transition-all duration-500 ease-out animate-fadeInUp",children:[u.jsxs("div",{className:"text-center mb-8",children:[u.jsx("h1",{className:"text-5xl font-bold text-blue-600 tracking-tight",children:"AGWA"}),u.jsx("p",{className:"text-sm text-gray-500 mt-1 italic",children:"Ensuring Clarity, Sustaining Life."})]}),e&&u.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-300 text-red-700 rounded-lg text-sm text-center animate-shake",role:"alert",children:e}),ss.cloneElement(r,{systemSettings:n}),u.jsxs("p",{className:"text-xs text-gray-400 text-center mt-6",children:["By continuing, you agree to our ",u.jsx("br",{}),u.jsx("button",{type:"button",onClick:()=>s(!0),className:"font-medium text-blue-600 hover:underline",children:"Terms of Service"})," ","and"," ",u.jsx("button",{type:"button",onClick:()=>l(!0),className:"font-medium text-blue-600 hover:underline",children:"Data Privacy Notice"}),"."]})]}),t&&u.jsxs("p",{className:"text-center text-xs text-blue-200 mt-8",children:["App ID (DB): ",u.jsx("span",{className:"font-semibold opacity-80",children:t})]}),u.jsxs("p",{className:"text-center text-xs text-blue-300 mt-2",children:[" ",new Date().getFullYear()," AGWA Water Services, Inc."]}),u.jsx("div",{id:"recaptcha-container",className:"my-2 mx-auto"}),u.jsx("style",{children:`
          @keyframes fadeInUp {
            from {
              opacity: 0;
              transform: translateY(20px);
            }
            to {
              opacity: 1;
              transform: translateY(0);
            }
          }
          .animate-fadeInUp {
            animation: fadeInUp 0.6s ease-out forwards;
          }

          @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-5px); }
            20%, 40%, 60%, 80% { transform: translateX(5px); }
          }
          .animate-shake {
            animation: shake 0.5s cubic-bezier(.36,.07,.19,.97) both;
          }
        `})]}),u.jsx(uF,{isOpen:i,onClose:()=>s(!1)}),u.jsx(dF,{isOpen:o,onClose:()=>l(!1)})]})});d3.displayName="AuthFormContainer";function h3(r){var e,t,n="";if(typeof r=="string"||typeof r=="number")n+=r;else if(typeof r=="object")if(Array.isArray(r)){var i=r.length;for(e=0;e<i;e++)r[e]&&(t=h3(r[e]))&&(n&&(n+=" "),n+=t)}else for(t in r)r[t]&&(n&&(n+=" "),n+=t);return n}function C2(){for(var r,e,t=0,n="",i=arguments.length;t<i;t++)(r=arguments[t])&&(e=h3(r))&&(n&&(n+=" "),n+=e);return n}const Fi="w-full px-4 py-3 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 focus:outline-none transition duration-200 text-gray-900 placeholder-gray-400 disabled:bg-gray-200 disabled:cursor-not-allowed",nm=r=>C2("w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50 active:scale-95 flex items-center justify-center",{"opacity-60 cursor-not-allowed":r}),f3=r=>C2("w-full bg-white hover:bg-gray-100 text-gray-700 font-semibold py-3 px-4 rounded-lg border border-gray-300 shadow-sm hover:shadow transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-gray-300 focus:ring-opacity-50 flex items-center justify-center space-x-2 active:scale-95",{"opacity-50 cursor-not-allowed":r}),m3=r=>C2("w-full bg-teal-500 hover:bg-teal-600 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-teal-400 focus:ring-opacity-50 flex items-center justify-center space-x-2 active:scale-95",{"opacity-50 cursor-not-allowed":r}),hF=({navigateTo:r,authActionLoading:e,handleLoginExternal:t,handleGoogleSignIn:n,setAuthError:i,systemSettings:s={}})=>{const[o,l]=J.useState(""),[d,f]=J.useState(""),[m,y]=J.useState(!1),g=async T=>{if(T.preventDefault(),!o||!d){i&&i("Please enter both email and password.");return}i&&i(""),await t(o,d)},_=async()=>{i&&i(""),await n()},{isGoogleLoginEnabled:E=!0,isPasswordlessLoginEnabled:x=!0,isSignupEnabled:b=!0}=s;return u.jsxs("form",{onSubmit:g,className:"space-y-5",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Fo,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"email",placeholder:"Email Address *",value:o,onChange:T=>l(T.target.value),className:`${Fi} pl-11`,required:!0,disabled:e,"aria-label":"Email Address"})]}),u.jsxs("div",{className:"relative",children:[u.jsx(oy,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:m?"text":"password",placeholder:"Password *",value:d,onChange:T=>f(T.target.value),className:`${Fi} pl-11`,required:!0,disabled:e,"aria-label":"Password"}),u.jsx("button",{type:"button",onClick:()=>y(!m),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 p-1 focus:outline-none","aria-label":m?"Hide password":"Show password",disabled:e,children:m?u.jsx(iy,{size:20}):u.jsx(tc,{size:20})})]}),u.jsxs("button",{type:"submit",className:nm(e),disabled:e,children:[e&&u.jsx(Et,{className:"animate-spin inline mr-2",size:18}),e?"Logging In...":"Login"]}),(E||x)&&u.jsxs("div",{className:"relative my-4",children:[u.jsx("div",{className:"absolute inset-0 flex items-center",children:u.jsx("div",{className:"w-full border-t border-gray-300"})}),u.jsx("div",{className:"relative flex justify-center text-sm",children:u.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with"})})]}),E&&u.jsxs("button",{type:"button",onClick:_,className:f3(e),disabled:e,children:[u.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",className:"h-5 w-5",onError:T=>T.target.style.display="none"}),u.jsx("span",{children:"Sign in with Google"})]}),x&&u.jsxs("button",{type:"button",onClick:()=>r("passwordlessLogin"),className:m3(e),disabled:e,children:[u.jsx(I2,{size:18,className:"mr-2"}),u.jsx("span",{children:"Sign in with Email Link"})]}),u.jsxs("div",{className:"text-sm text-center mt-5 space-y-1.5",children:[b&&u.jsxs("p",{className:"text-gray-600",children:["Don't have an account?"," ",u.jsx("button",{type:"button",onClick:()=>r("signup"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-70",disabled:e,children:"Sign Up"})]}),u.jsx("p",{className:"text-gray-600",children:u.jsx("button",{type:"button",onClick:()=>r("forgotPassword"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-70",disabled:e,children:"Forgot Password?"})})]})]})},fF=({navigateTo:r,authActionLoading:e,handleSignupExternal:t,handleGoogleSignIn:n,setAuthError:i,showNotification:s,systemSettings:o={}})=>{const[l,d]=J.useState(""),[f,m]=J.useState(""),[y,g]=J.useState(""),[_,E]=J.useState(""),[x,b]=J.useState(""),[T,N]=J.useState(!1),[R,I]=J.useState(!1),j=async k=>{if(k.preventDefault(),i(""),!_.trim()){i("Full Name is required."),s("Full Name is required.","warning");return}if(!x.trim()){i("AGWA Account Number is required (e.g., RES-12345, ADM-001)."),s("AGWA Account Number is required.","warning");return}if(f.length<6){i("Password must be at least 6 characters long."),s("Password too short (min. 6 chars).","warning");return}if(f!==y){i("Passwords do not match."),s("Passwords don't match.","warning");return}await t(l,f,_,x)},U=async()=>{await n()},{isGoogleLoginEnabled:C=!0}=o;return u.jsxs("form",{onSubmit:j,className:"space-y-5",children:[u.jsxs("div",{className:"relative",children:[u.jsx(Cs,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"Full Name *",value:_,onChange:k=>E(k.target.value),className:`${Fi} pl-11`,required:!0,disabled:e,"aria-label":"Full Name"})]}),u.jsxs("div",{className:"relative",children:[u.jsx(Rs,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"AGWA Account Number (e.g., RES-12345) *",value:x,onChange:k=>b(k.target.value),className:`${Fi} pl-11`,required:!0,disabled:e,"aria-label":"AGWA Account Number"})]}),u.jsxs("div",{className:"relative",children:[u.jsx(Fo,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"email",placeholder:"Email Address *",value:l,onChange:k=>d(k.target.value),className:`${Fi} pl-11`,required:!0,disabled:e,"aria-label":"Email Address"})]}),u.jsxs("div",{className:"relative",children:[u.jsx(oy,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:T?"text":"password",placeholder:"Password (min. 6 chars) *",value:f,onChange:k=>m(k.target.value),className:`${Fi} pl-11`,required:!0,disabled:e,"aria-label":"Password"}),u.jsx("button",{type:"button",onClick:()=>N(!T),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 p-1 focus:outline-none","aria-label":T?"Hide password":"Show password",disabled:e,children:T?u.jsx(iy,{size:20}):u.jsx(tc,{size:20})})]}),u.jsxs("div",{className:"relative",children:[u.jsx(oy,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:R?"text":"password",placeholder:"Confirm Password *",value:y,onChange:k=>g(k.target.value),className:`${Fi} pl-11`,required:!0,disabled:e,"aria-label":"Confirm Password"}),u.jsx("button",{type:"button",onClick:()=>I(!R),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 p-1 focus:outline-none","aria-label":R?"Hide confirm password":"Show confirm password",disabled:e,children:R?u.jsx(iy,{size:20}):u.jsx(tc,{size:20})})]}),u.jsxs("button",{type:"submit",className:nm(e),disabled:e,children:[e&&u.jsx(Et,{className:"animate-spin inline mr-2",size:18}),e?"Creating Account...":"Create My Account"]}),C&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"relative my-4",children:[u.jsx("div",{className:"absolute inset-0 flex items-center",children:u.jsx("div",{className:"w-full border-t border-gray-300"})}),u.jsx("div",{className:"relative flex justify-center text-sm",children:u.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or sign up with"})})]}),u.jsxs("button",{type:"button",onClick:U,className:f3(e),disabled:e,children:[u.jsx("img",{src:"https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg",alt:"Google",className:"h-5 w-5",onError:k=>k.target.style.display="none"}),u.jsx("span",{children:"Sign up with Google"})]})]}),u.jsxs("p",{className:"text-sm text-center text-gray-600 mt-5",children:["Already have an account?"," ",u.jsx("button",{type:"button",onClick:()=>r("login"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-70",disabled:e,children:"Login"})]})]})},mF=({handleForgotPasswordExternal:r,navigateTo:e,authActionLoading:t})=>{const[n,i]=J.useState(""),[s,o]=J.useState(!1),l=async d=>{if(d.preventDefault(),!n.trim()){alert("Please enter your email address.");return}await r(n)&&o(!0)};return s?u.jsxs("div",{className:"space-y-5 text-center",children:[u.jsx(Fo,{size:48,className:"mx-auto text-green-500 mb-3"}),u.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Password Reset Email Sent"}),u.jsxs("p",{className:"text-sm text-gray-600",children:["If an account exists for ",u.jsx("strong",{children:n}),", you will receive an email with instructions to reset your password. Please check your inbox (and spam folder)."]}),u.jsxs("button",{type:"button",onClick:()=>e("login"),className:`${nm(!1)} bg-green-600 hover:bg-green-700 focus:ring-green-500 mt-4`,children:[u.jsx(ny,{size:18,className:"mr-2"})," Back to Login"]})]}):u.jsxs("form",{onSubmit:l,className:"space-y-5",children:[u.jsx("p",{className:"text-sm text-gray-600 mb-4 text-center",children:"Enter your email address below, and we'll send you a link to reset your password."}),u.jsxs("div",{className:"relative",children:[u.jsx(Fo,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"email",placeholder:"Enter your Email Address",value:n,onChange:d=>i(d.target.value),className:`${Fi} pl-11`,required:!0,disabled:t,"aria-label":"Email for password reset"})]}),u.jsxs("button",{type:"submit",className:nm(t||!n.trim()),disabled:t||!n.trim(),children:[t?u.jsx(Et,{className:"animate-spin mr-2",size:20}):null,t?"Sending Link...":"Send Password Reset Link"]}),u.jsx("div",{className:"text-sm text-center mt-6",children:u.jsxs("button",{type:"button",onClick:()=>e("login"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-50",disabled:t,children:[u.jsx(ny,{size:16,className:"inline mr-1"})," Remembered your password? Login"]})})]})},pF=({handlePasswordlessSignInExternal:r,navigateTo:e,authActionLoading:t})=>{const[n,i]=J.useState(""),[s,o]=J.useState(!1),l=async d=>{if(d.preventDefault(),!n.trim()){alert("Please enter your email address.");return}const f=await r(n);f&&f.success&&o(!0)};return s?u.jsxs("div",{className:"space-y-5 text-center",children:[u.jsx(Ps,{size:48,className:"mx-auto text-green-500 mb-3"}),u.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:"Sign-in Link Sent!"}),u.jsxs("p",{className:"text-sm text-gray-600",children:["A magic sign-in link has been sent to ",u.jsx("strong",{children:n}),". Please check your email and click the link to sign in. The link is valid for a limited time."]}),u.jsxs("button",{type:"button",onClick:()=>e("login"),className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50 flex items-center justify-center mt-4",children:[u.jsx(ny,{size:18,className:"mr-2"})," Okay, Got It!"]})]}):u.jsxs("form",{onSubmit:l,className:"space-y-5",children:[u.jsx("p",{className:"text-sm text-gray-600 mb-4 text-center",children:"Enter your email address, and we'll send you a magic link to sign in instantly. No password needed!"}),u.jsxs("div",{className:"relative",children:[u.jsx(Fo,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"email",placeholder:"Enter your Email Address",value:n,onChange:d=>i(d.target.value),className:`${Fi} pl-11`,required:!0,disabled:t,"aria-label":"Email for passwordless sign-in"})]}),u.jsxs("button",{type:"submit",className:m3(t||!n.trim()),disabled:t||!n.trim(),children:[t?u.jsx(Et,{className:"animate-spin mr-2",size:20}):u.jsx(I2,{size:20,className:"mr-2"}),t?"Sending Link...":"Send Sign-in Link"]}),u.jsx("div",{className:"text-sm text-center mt-6",children:u.jsxs("button",{type:"button",onClick:()=>e("login"),className:"font-semibold text-blue-600 hover:text-blue-700 hover:underline disabled:opacity-50",disabled:t,children:[u.jsx(ny,{size:16,className:"inline mr-1"})," Prefer a password? Login"]})})]})},gF={Home:N2,UserCog:c3,FileText:nc,AlertTriangle:Kt,Users:Ta,MessageSquare:Pa,Settings:r0,HelpCircle:S2,Info:gn,PhoneCall:i3,LogOut:t0,ShieldCheck:sh,Megaphone:bd,BarChart3:b2,Edit:tm,Gauge:rc,Map:ic,ClipboardEdit:T2,Search:js,Banknote:ry,FileSearch:A2,TrendingUp:o3,Gift:sy,AlertIcon:Kt,EditIcon:tm,Eye:tc},yF=({userData:r,navItems:e,activeSection:t,onNavigate:n,onLogout:i,isMobileOpen:s,setMobileOpen:o})=>{var y;const l=`https://placehold.co/40x40/FFFFFF/3B82F6?text=${((r==null?void 0:r.displayName)||(r==null?void 0:r.email)||"U").charAt(0).toUpperCase()}`,d=e.reduce((g,_)=>{const E=_.group||"General";return g[E]||(g[E]=[]),g[E].push(_),g},{}),f=["Main","Account","Operations","Administration","Support","Information","Help & Info"],m=u.jsxs("div",{className:"h-full flex flex-col bg-gradient-to-b from-blue-700 to-blue-900 text-white shadow-2xl",children:[u.jsxs("div",{className:"p-5 pt-6 text-center border-b border-blue-600",children:[u.jsx("h1",{className:"text-3xl sm:text-4xl font-bold text-white tracking-tight",children:"AGWA"}),u.jsx("p",{className:"text-xs text-blue-200 font-light mt-0.5 italic",children:"Ensuring Clarity, Sustaining Life."})]}),u.jsx("nav",{className:"flex-grow p-3 space-y-1.5 overflow-y-auto scrollbar-thin scrollbar-thumb-blue-500 scrollbar-track-blue-800",children:f.map(g=>{const _=d[g];return _?u.jsxs("div",{className:"space-y-1.5",children:[f.length>1&&u.jsx("h3",{className:"px-3.5 pt-3 pb-1 text-xs font-semibold text-blue-300 uppercase tracking-wider",children:g}),_.map(E=>{const x=gF[E.iconName]||S2,b=t===E.section;return u.jsxs("button",{onClick:()=>{n(E.section),o&&o(!1)},className:`w-full flex items-center space-x-3 px-3.5 py-2.5 rounded-lg transition-all duration-200 ease-in-out text-sm font-medium focus:outline-none focus:ring-2 focus:ring-opacity-50 focus:ring-sky-300 group
                                            ${b?"bg-sky-500 text-white shadow-md transform scale-105 font-semibold":"text-blue-100 hover:bg-blue-600/70 hover:text-white hover:translate-x-1"}`,title:E.name,children:[u.jsx(x,{size:20,className:`${b?"text-white":"text-blue-300 group-hover:text-white transition-colors"}`}),u.jsx("span",{className:"truncate",children:E.name})]},E.section||E.name)})]},g):null})}),u.jsxs("div",{className:"p-4 border-t border-blue-600",children:[r&&u.jsxs("div",{className:"flex items-center mb-3 p-2.5 bg-blue-800/50 rounded-lg shadow-inner",children:[u.jsx("img",{src:r.photoURL||l,alt:"User",className:"h-10 w-10 rounded-full border-2 border-blue-400 object-cover bg-gray-200 flex-shrink-0",onError:g=>{g.target.onerror=null,g.target.src=l}}),u.jsxs("div",{className:"ml-3 overflow-hidden",children:[u.jsx("p",{className:"text-sm font-semibold leading-tight truncate text-white",title:r.displayName||r.email,children:r.displayName||r.email}),u.jsxs("p",{className:"text-xs text-blue-200 leading-tight capitalize truncate",title:`Role: ${r.role}`,children:["Role: ",((y=r.role)==null?void 0:y.replace("_"," "))||"N/A"]}),r.role==="customer"&&u.jsxs("p",{className:"text-xs text-blue-300 leading-tight truncate",title:`Account: ${r.accountNumber||"N/A"}`,children:["Acc: ",r.accountNumber||"N/A"]})]})]}),u.jsxs("button",{onClick:i,className:"w-full flex items-center justify-center space-x-2 bg-red-600 hover:bg-red-700 text-white font-semibold py-2.5 px-4 rounded-lg transition-all duration-150 active:scale-95 focus:outline-none focus:ring-2 focus:ring-red-400 ring-offset-2 ring-offset-blue-800",children:[u.jsx(t0,{size:20}),u.jsx("span",{children:"Logout"})]})]})]});return u.jsxs(u.Fragment,{children:[u.jsx("div",{className:`fixed inset-0 bg-black bg-opacity-60 z-40 lg:hidden transition-opacity duration-300 ${s?"opacity-100":"opacity-0 pointer-events-none"} no-print`,onClick:()=>o(!1),"aria-hidden":"true"}),u.jsx("aside",{className:`fixed top-0 left-0 h-full w-64 z-50 transform transition-transform duration-300 ease-in-out lg:translate-x-0 ${s?"translate-x-0 shadow-xl":"-translate-x-full"} no-print`,children:m}),u.jsx("style",{children:`
                .scrollbar-thin { scrollbar-width: thin; scrollbar-color: #3b82f6 #1e40af; }
                .scrollbar-thin::-webkit-scrollbar { width: 6px; height: 6px; }
                .scrollbar-thin::-webkit-scrollbar-track { background: #1e40af; border-radius: 3px;}
                .scrollbar-thin::-webkit-scrollbar-thumb { background-color: #3b82f6; border-radius: 3px; border: 1px solid #1e40af; }
                .scrollbar-thin::-webkit-scrollbar-thumb:hover { background-color: #2563eb; }
             `})]})},vF=({title:r,value:e,icon:t,iconColor:n="text-blue-600",borderColor:i="border-blue-600",subtext:s,onClick:o,className:l=""})=>{const d="bg-white p-5 rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-0.5 transition-all duration-300 ease-in-out flex items-start space-x-4 border-l-4",f=o?"cursor-pointer":"";return u.jsxs("div",{className:`${d} ${i} ${f} ${l}`,onClick:o,role:o?"button":"figure",tabIndex:o?0:-1,onKeyDown:o?m=>{(m.key==="Enter"||m.key===" ")&&o()}:void 0,children:[t&&u.jsx("div",{className:"p-2 bg-gray-100 rounded-full",children:u.jsx(t,{className:`w-7 h-7 ${n}`,"aria-hidden":"true"})}),u.jsxs("div",{className:"flex-1 overflow-hidden",children:[u.jsx("p",{className:"text-sm font-medium text-gray-500 uppercase tracking-wider truncate",title:r,children:r}),u.jsx("p",{className:"text-2xl sm:text-3xl font-bold text-gray-800 truncate",title:String(e),children:e}),s&&u.jsx("p",{className:"text-xs text-gray-500 mt-1 truncate",title:s,children:s})]})]})},hi=ss.memo(vF),an=({size:r="h-8 w-8",color:e="text-blue-600",className:t="",message:n="",messageClassName:i="text-sm text-gray-500 mt-2"})=>u.jsxs("div",{className:`flex flex-col items-center justify-center ${t}`,children:[u.jsx(Et,{className:`animate-spin ${r} ${e}`}),n&&u.jsx("p",{className:i,children:n})]}),Vo=async(r,e="llama-3.1-8b-instant")=>{throw new Error("Groq API key is missing. Please check your .env file for VITE_GROQ_API_KEY.")},_F=async(r,e)=>{const t=r.map(i=>({role:i.role==="assistant"?"assistant":"user",content:i.text})),n=[{role:"system",content:e},...t];return Vo(n,"llama-3.1-8b-instant")},xF=async({title:r,reason:e,area:t,time:n})=>Vo(),p3=async({ticketDescription:r,conversationHistory:e,draftReply:t,customerName:n})=>Vo(),bF=async({billDetails:r,charges:e,customerName:t,serviceType:n})=>(`${t}${r.monthYear}${r.amount.toFixed(2)}${$t(r.dueDate)}${r.consumption}${r.monthYear}${e.basicCharge.toFixed(2)}${r.consumption}${n}${e.fcda.toFixed(2)}${e.environmentalCharge.toFixed(2)}${e.maintenanceServiceCharge.toFixed(2)}`,e.sewerageCharge>0&&`${e.sewerageCharge.toFixed(2)}`,`${e.vat.toFixed(2)}`,r.previousUnpaidAmount>0&&`${(r.previousUnpaidAmount||0).toFixed(2)}`,r.seniorCitizenDiscount>0&&`${(r.seniorCitizenDiscount||0).toFixed(2)}`,`${r.amount.toFixed(2)}${$t(r.dueDate)}`,Vo()),Ts=async(r,e)=>{const t=Array.isArray(e)?JSON.stringify(e):JSON.stringify(Object.entries(e).map(([s,o])=>({[s]:o}))),i=[{role:"user",content:`
        You are a formal, senior business analyst for AGWA Water Services, writing an internal technical report.
        The currency for all financial data is Philippine Pesos (PHP).
        
        Analyze the following dataset for a specific chart. Provide a concise, data-driven analysis (2-3 sentences).

        **CRITICAL FORMATTING RULES:**
        1.  Your ENTIRE response MUST be a single HTML block.
        2.  The response MUST start with \`<p><strong>Analysis:</strong>\`.
        3.  You MUST NOT use any markdown (e.g., \`**\` or \`##\`). All emphasis MUST use \`<strong>\` or \`<em>\` tags.

        **TONE & CONTENT INSTRUCTIONS:**
        -   Use a professional, corporate, and technical tone.
        -   Do not simply state what the chart shows (e.g., "Cash is 60%").
        -   Explain what the data *implies* for business operations, revenue impact, or operational efficiency. Provide inferences.

        Chart Title: "${r}"
        Data: ${t}
        
        Output ONLY the HTML, starting with <p>.
    `}];return Vo(i,"llama-3.1-8b-instant")},wF=({user:r,userData:e,db:t,showNotification:n,setActiveSection:i,billingService:s,systemSettings:o})=>{const[l,d]=J.useState([]),[f,m]=J.useState(!0),[y,g]=J.useState(""),[_,E]=J.useState(0),[x,b]=J.useState(""),[T,N]=J.useState(""),[R,I]=J.useState(!1),[j,U]=J.useState(!1),C=J.useCallback(async()=>{if(!r||!r.uid||!e||!s){m(!1),g("User data or essential services are unavailable.");return}m(!0),g("");try{const M=await ih(t,r.uid);if(M.success){const $=M.data.map(te=>{var K;const oe=s(te.consumption,e.serviceType,e.meterSize,o||{}),ie=v2(te,o),ne=(te.amount||0)+ie;return{...te,calculatedCharges:oe,amount:ne,displayPenalty:ie,billDateTimestamp:(K=te.billDate)!=null&&K.toDate?te.billDate.toDate():new Date(te.billDate)}}).sort((te,oe)=>oe.billDateTimestamp-te.billDateTimestamp);d($.slice(0,3));const Y=$.filter(te=>te.status==="Unpaid");if(Y.length>0){const oe=Y.sort((ne,K)=>{var B,G;return new Date(((B=ne.dueDate)==null?void 0:B.toDate())||0)-new Date(((G=K.dueDate)==null?void 0:G.toDate())||0)})[0],ie=Y.reduce((ne,K)=>ne+(K.amount||0),0);E(ie),b(oe.dueDate)}else E(0),b("")}else g(M.error||"Failed to fetch recent bills."),n(M.error||"Failed to fetch recent bills.","error")}catch(M){console.error("Error fetching customer dashboard data:",M);const $="An error occurred while loading your dashboard information.";g($),n($,"error")}m(!1)},[r,e,t,n,s,o]);J.useEffect(()=>{C()},[C]);const k=async()=>{I(!0),U(!0),N("");try{const M=e.serviceAddress&&e.serviceAddress.barangay?`for a household in ${e.serviceAddress.barangay}`:"for a household",te=await Vo([{role:"user",content:`
                You are Agie, a professional and helpful AI assistant for AGWA Water Services.
                Please provide 8 practical water-saving tips and 2 surprising water trivia facts for a customer in the Philippines.
                
                Instructions:
                1.  Provide a short, friendly opening paragraph (e.g., "Hello! I'm Agie...").
                2.  Create a section titled "<strong>Practical Water-Saving Tips</strong>".
                3.  List 8 tips using a <ul> with <li> elements.
                4.  Include at least one Philippines-specific tip (like using a "tabo" or "timba" / pail).
                5.  Create a second section titled "<strong>Water Trivia</strong>".
                6.  List 2 surprising facts, also in a <ul>.
                7.  Wrap all content in simple HTML tags: <p>, <ul>, <li>, <strong>.
                8.  Do NOT use any markdown (like *, **, or #).
            `}]);N(te)}catch(M){const $=(M==null?void 0:M.message)||"Could not fetch water saving tips at the moment.";n($,"error"),N("<p>Sorry, couldn't fetch tips right now. A simple tip: Always check for leaky faucets and toilets, as they are the most common sources of water waste!</p>")}finally{I(!1)}},D=`${_.toFixed(2)}`,O=_>0&&x?`Next Due: ${$t(x,{month:"short",day:"numeric",year:"numeric"})}`:_===0?"All bills settled!":"",P="p-5 bg-white rounded-xl shadow-lg hover:shadow-xl transform hover:-translate-y-1 transition-all duration-300 ease-in-out text-left focus:outline-none focus:ring-2 focus:ring-opacity-75 flex flex-col items-start h-full",F=()=>u.jsx("span",{className:"font-bold",children:""});return u.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-5",children:[u.jsx(hi,{title:"Account Status",value:f&&!e.accountStatus?u.jsx(Et,{className:"animate-spin h-5 w-5"}):e.accountStatus||"Active",icon:sh,borderColor:"border-green-500",iconColor:"text-green-500"}),u.jsx(hi,{title:"Current Balance",value:f&&_===0&&x===""?u.jsx(Et,{className:"animate-spin h-5 w-5"}):D,subtext:O,icon:F,borderColor:_>0?"border-red-500":"border-green-500",iconColor:_>0?"text-red-500":"text-green-500"}),u.jsx(hi,{title:"Account Number",value:e.accountNumber||"N/A",icon:Cs,borderColor:"border-blue-500",iconColor:"text-blue-500"}),u.jsx(hi,{title:"Service Type",value:e.serviceType||"Residential",icon:N2,borderColor:"border-purple-500",iconColor:"text-purple-500"})]}),y&&u.jsxs("div",{className:"p-4 bg-red-50 text-red-700 border border-red-200 rounded-lg text-sm flex items-center justify-center",children:[u.jsx(Kt,{size:20,className:"mr-2"})," ",y]}),u.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:u.jsxs("div",{className:"lg:col-span-3 bg-white p-5 rounded-xl shadow-lg",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-3 flex items-center",children:[u.jsx(nc,{size:22,className:"mr-2 text-gray-500"}),"Recent Bills Summary"]}),f?u.jsx(an,{message:"Loading recent bills..."}):l.length>0?u.jsxs("div",{className:"space-y-3",children:[l.map(M=>{const $=M.status==="Paid",Y=$&&M.amountPaid||M.amount;return u.jsxs("div",{className:`flex flex-col sm:flex-row justify-between items-start sm:items-center p-3.5 border rounded-lg hover:bg-gray-50/70 transition-colors duration-150 ${$?"border-green-200 bg-green-50/50":"border-yellow-200 bg-yellow-50/30"}`,children:[u.jsxs("div",{children:[u.jsxs("p",{className:"font-medium text-gray-800 text-sm",children:[M.monthYear||M.billingPeriod," - ",u.jsxs("span",{className:"font-bold",children:["",Y==null?void 0:Y.toFixed(2)]})]}),u.jsxs("p",{className:`text-xs mt-0.5 font-semibold ${$?"text-green-600":"text-orange-600"}`,children:["Status: ",M.status," ",!$&&`(Due: ${$t(M.dueDate,{month:"short",day:"numeric"})})`,M.displayPenalty>0&&!$&&u.jsxs("span",{className:"text-xs text-red-500 font-semibold block",children:["(Includes ",M.displayPenalty.toFixed(2)," penalty)"]})]})]}),u.jsxs("div",{className:"flex gap-2 mt-2 sm:mt-0",children:[!$&&u.jsx("button",{onClick:()=>i("myBills"),className:"text-xs bg-red-500 hover:bg-red-600 text-white py-1.5 px-3 rounded-md transition-all active:scale-95 font-medium",children:"Pay Now"}),u.jsx("button",{onClick:()=>i("myBills"),className:"text-xs bg-blue-100 hover:bg-blue-200 text-blue-700 py-1.5 px-3 rounded-md transition-all font-medium",children:"View Details"})]})]},M.id)}),u.jsx("button",{onClick:()=>i("myBills"),className:"mt-3 text-sm text-blue-600 hover:text-blue-800 font-medium hover:underline",children:"View All Bills & Payment History "})]}):u.jsxs("div",{className:"text-sm text-gray-500 py-4 text-center",children:[u.jsx(gn,{size:24,className:"mx-auto mb-1 text-gray-400"}),"No recent bills to display. All up to date!"]})]})}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[u.jsxs("button",{onClick:()=>i("myBills"),className:`${P} focus:ring-green-500 border-l-4 border-green-500`,children:[u.jsx(e0,{size:26,className:"mb-2 text-green-500"}),u.jsx("h4",{className:"font-semibold text-green-700 text-md",children:"Pay My Bill"}),u.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"View outstanding bills and make (simulated) payments."})]}),u.jsxs("button",{onClick:()=>i("reportIssue"),className:`${P} focus:ring-orange-500 border-l-4 border-orange-500`,children:[u.jsx(Kt,{size:26,className:"mb-2 text-orange-500"}),u.jsx("h4",{className:"font-semibold text-orange-700 text-md",children:"Report an Issue"}),u.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Report leaks, service interruptions, or other concerns."})]}),u.jsxs("button",{onClick:k,className:`${P} focus:ring-teal-500 border-l-4 border-teal-500`,disabled:R,children:[u.jsxs("div",{className:"flex items-center justify-between w-full",children:[u.jsx(Os,{size:26,className:"mb-2 text-teal-500"}),R&&u.jsx(Et,{className:"animate-spin text-teal-500",size:20})]}),u.jsx("h4",{className:"font-semibold text-teal-700 text-md",children:R?"Getting Tips...":" Get Water Saving Tips"}),u.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Discover ways to conserve water and save money."})]})]}),u.jsx(Ar,{isOpen:j,onClose:()=>U(!1),title:" Water Saving Tips by Agie",size:"lg",children:R?u.jsx("div",{className:"flex justify-center items-center h-40",children:u.jsx(an,{message:"Agie is thinking of the best tips for you..."})}):u.jsx("div",{className:"prose prose-sm sm:prose max-w-none p-2 leading-relaxed text-gray-700",dangerouslySetInnerHTML:{__html:T||"<p>No tips available at the moment. Please try again!</p>"}})})]})};var g3="clover",EF=function(e){return e===3?"v3":e},y3="https://js.stripe.com",SF="".concat(y3,"/").concat(g3,"/stripe.js"),TF=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,AF=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var NF=function(e){return TF.test(e)||AF.test(e)},IF=function(){for(var e=document.querySelectorAll('script[src^="'.concat(y3,'"]')),t=0;t<e.length;t++){var n=e[t];if(NF(n.src))return n}return null},QT=function(e){var t="",n=document.createElement("script");n.src="".concat(SF).concat(t);var i=document.head||document.body;if(!i)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return i.appendChild(n),n},kF=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"8.2.0",startTime:t})},qh=null,Lp=null,Fp=null,PF=function(e){return function(t){e(new Error("Failed to load Stripe.js",{cause:t}))}},CF=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},RF=function(e){return qh!==null?qh:(qh=new Promise(function(t,n){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe){t(window.Stripe);return}try{var i=IF();if(!(i&&e)){if(!i)i=QT(e);else if(i&&Fp!==null&&Lp!==null){var s;i.removeEventListener("load",Fp),i.removeEventListener("error",Lp),(s=i.parentNode)===null||s===void 0||s.removeChild(i),i=QT(e)}}Fp=CF(t,n),Lp=PF(n),i.addEventListener("load",Fp),i.addEventListener("error",Lp)}catch(o){n(o);return}}),qh.catch(function(t){return qh=null,Promise.reject(t)}))},jF=function(e,t,n){if(e===null)return null;var i=t[0],s=i.match(/^pk_test/),o=EF(e.version),l=g3;s&&o!==l&&console.warn("Stripe.js@".concat(o," was loaded on the page, but @stripe/stripe-js@").concat("8.2.0"," expected Stripe.js@").concat(l,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var d=e.apply(void 0,t);return kF(d,n),d},Hh,v3=!1,_3=function(){return Hh||(Hh=RF(null).catch(function(e){return Hh=null,Promise.reject(e)}),Hh)};Promise.resolve().then(function(){return _3()}).catch(function(r){v3||console.warn(r)});var OF=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];v3=!0;var i=Date.now();return _3().then(function(s){return jF(s,t,i)})};const MF=OF(void 0),DF=()=>MF,LF=async(r,e,t,n,i)=>{try{const o=fb().currentUser;if(!o)throw new Error("User not authenticated.");const l=await o.getIdToken(),d=Math.round(e*100),f=`${window.location.origin}/?payment=success&session_id={CHECKOUT_SESSION_ID}`,m=`${window.location.origin}/?payment=cancel`,y=await fetch("/api/createStripeCheckoutSession",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({billId:r,amount:d,userEmail:t,userId:n,accountNumber:i,successUrl:f,cancelUrl:m})});if(!y.ok){let _=`API Error: ${y.statusText}`;try{_=(await y.json()).error||"Failed to create session from API"}catch{_=`API route returned an invalid or empty response. Status: ${y.status}.`}throw new Error(_)}const g=await y.json();if(!g||!g.sessionUrl)throw new Error("Invalid response from checkout session API. Missing sessionUrl.");return g.sessionUrl}catch(s){throw console.error("Error creating checkout session:",s),new Error(s.message||"Could not connect to payment service.")}},FF=async(r,e)=>{try{const n=fb().currentUser;if(!n)throw new Error("User not authenticated.");const i=await n.getIdToken(),s=await fetch("/api/verifyStripePayment",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({sessionId:r})});if(!s.ok){const l=await s.json();throw new Error(l.error||"Payment verification failed.")}const o=await s.json();if(o.success&&o.paymentDetails){const{billId:l,amount:d,amountPaid:f,paymentMethod:m,paymentReference:y}=o.paymentDetails,_=parseFloat(d||f)/100,x=await ZC(e,l,{status:"Paid",paymentDate:new Date,paymentTimestamp:new Date,amountPaid:_,paymentMethod:m||"Stripe",paymentReference:y});if(!x.success)throw new Error(x.error||"Failed to update bill after payment verification.");return{success:!0}}else throw new Error(o.error||"Invalid verification response from server.")}catch(t){return console.error("Error verifying checkout session:",t),{success:!1,error:"An error occurred while verifying your payment. Please try again."}}},VF=({isOpen:r,onClose:e,billToPay:t,userData:n,showNotification:i,stripePromise:s})=>{var y;const[o,l]=J.useState(!1),[d,f]=J.useState(""),m=async()=>{if(l(!0),f(""),!s||!t||!n){f("Payment system is not initialized."),l(!1);return}try{const g=await LF(t.id,t.amount,n.email,n.uid,n.accountNumber);if(g&&(g.startsWith("https://checkout.stripe.com/")||g.startsWith("https://test.stripe.com/")))window.location.href=g;else throw console.error("Invalid or untrusted session URL received:",g),new Error("Received an invalid payment URL. Please try again.")}catch(g){const _="Failed to create payment session. This could be a temporary network issue or a problem with the payment service. Please try again in a moment. (Error: "+(g.message||"Unknown")+")";f(_),i("Failed to create payment session. Please try again.","error"),l(!1)}};return r?u.jsx(Ar,{isOpen:r,onClose:e,title:"Secure Payment with Stripe",size:"md",children:u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg text-center",children:[u.jsx("p",{className:"text-sm text-blue-700",children:"You are paying for bill:"}),u.jsx("p",{className:"font-bold text-lg text-blue-800",children:t.monthYear}),u.jsxs("div",{className:"mt-2 text-3xl font-bold text-gray-800",children:["",((y=t.amount)==null?void 0:y.toFixed(2))||"0.00"]})]}),d&&u.jsxs("div",{className:"p-3 bg-red-100 border border-red-300 text-red-700 rounded-lg text-sm flex items-center gap-2",children:[u.jsx(Kt,{size:18}),u.jsx("span",{children:d})]}),u.jsxs("div",{className:"pt-6 border-t border-gray-200",children:[u.jsx("button",{onClick:m,className:"w-full flex items-center justify-center py-3 px-4 bg-blue-600 text-white font-bold rounded-lg text-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors",disabled:o,children:o?u.jsxs(u.Fragment,{children:[u.jsx(Et,{className:"animate-spin mr-2"})," Processing..."]}):u.jsxs(u.Fragment,{children:[" ",u.jsx(e0,{className:"mr-2",size:20})," Proceed to Secure Checkout"]})}),u.jsx("p",{className:"text-xs text-center text-gray-500 mt-2",children:"You will be redirected to Stripe to complete your payment."})]})]})}):null},x3=({value:r})=>{if(!r)return null;const e=n=>{const i={0:"1101100",1:"1100110",2:"1001101",3:"1011001",4:"1010011",5:"1100101",6:"1000111",7:"1011100",8:"1110100",9:"1110010","-":"1001011"},s="10100",o="10100";let l=s;for(const d of n)i[d]&&(l+=i[d]);return l+=o,l.split("").map((d,f)=>u.jsx("div",{style:{height:"100%",width:"1px",backgroundColor:d==="1"?"#000":"transparent"}},f))},t=r.replace(/[^0-9-]/g,"");return u.jsxs("div",{style:{width:"100%",display:"flex",flexDirection:"column",alignItems:"center"},children:[u.jsx("div",{style:{display:"flex",height:"48px",alignItems:"stretch"},"aria-label":`Barcode for ${t}`,children:e(t)}),u.jsx("p",{style:{letterSpacing:"0.1em",fontSize:"10px",fontFamily:"monospace",marginTop:"4px"},children:t})]})};/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:b3,setPrototypeOf:XT,isFrozen:zF,getPrototypeOf:BF,getOwnPropertyDescriptor:UF}=Object;let{freeze:pi,seal:Ms,create:Lx}=Object,{apply:Fx,construct:Vx}=typeof Reflect<"u"&&Reflect;pi||(pi=function(e){return e});Ms||(Ms=function(e){return e});Fx||(Fx=function(e,t){for(var n=arguments.length,i=new Array(n>2?n-2:0),s=2;s<n;s++)i[s-2]=arguments[s];return e.apply(t,i)});Vx||(Vx=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return new e(...n)});const Vp=gi(Array.prototype.forEach),qF=gi(Array.prototype.lastIndexOf),JT=gi(Array.prototype.pop),$h=gi(Array.prototype.push),HF=gi(Array.prototype.splice),xg=gi(String.prototype.toLowerCase),Kv=gi(String.prototype.toString),Yv=gi(String.prototype.match),Wh=gi(String.prototype.replace),$F=gi(String.prototype.indexOf),WF=gi(String.prototype.trim),ro=gi(Object.prototype.hasOwnProperty),ci=gi(RegExp.prototype.test),Gh=GF(TypeError);function gi(r){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return Fx(r,e,n)}}function GF(r){return function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Vx(r,t)}}function Vt(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:xg;XT&&XT(r,null);let n=e.length;for(;n--;){let i=e[n];if(typeof i=="string"){const s=t(i);s!==i&&(zF(e)||(e[n]=s),i=s)}r[i]=!0}return r}function KF(r){for(let e=0;e<r.length;e++)ro(r,e)||(r[e]=null);return r}function ma(r){const e=Lx(null);for(const[t,n]of b3(r))ro(r,t)&&(Array.isArray(n)?e[t]=KF(n):n&&typeof n=="object"&&n.constructor===Object?e[t]=ma(n):e[t]=n);return e}function Kh(r,e){for(;r!==null;){const n=UF(r,e);if(n){if(n.get)return gi(n.get);if(typeof n.value=="function")return gi(n.value)}r=BF(r)}function t(){return null}return t}const eA=pi(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Zv=pi(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Qv=pi(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),YF=pi(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),Xv=pi(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),ZF=pi(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),tA=pi(["#text"]),nA=pi(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),Jv=pi(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),rA=pi(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),zp=pi(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),QF=Ms(/\{\{[\w\W]*|[\w\W]*\}\}/gm),XF=Ms(/<%[\w\W]*|[\w\W]*%>/gm),JF=Ms(/\$\{[\w\W]*/gm),eV=Ms(/^data-[\-\w.\u00B7-\uFFFF]+$/),tV=Ms(/^aria-[\-\w]+$/),w3=Ms(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),nV=Ms(/^(?:\w+script|data):/i),rV=Ms(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),E3=Ms(/^html$/i),iV=Ms(/^[a-z][.\w]*(-[.\w]+)+$/i);var iA=Object.freeze({__proto__:null,ARIA_ATTR:tV,ATTR_WHITESPACE:rV,CUSTOM_ELEMENT:iV,DATA_ATTR:eV,DOCTYPE_NAME:E3,ERB_EXPR:XF,IS_ALLOWED_URI:w3,IS_SCRIPT_OR_DATA:nV,MUSTACHE_EXPR:QF,TMPLIT_EXPR:JF});const Yh={element:1,text:3,progressingInstruction:7,comment:8,document:9},sV=function(){return typeof window>"u"?null:window},oV=function(e,t){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let n=null;const i="data-tt-policy-suffix";t&&t.hasAttribute(i)&&(n=t.getAttribute(i));const s="dompurify"+(n?"#"+n:"");try{return e.createPolicy(s,{createHTML(o){return o},createScriptURL(o){return o}})}catch{return console.warn("TrustedTypes policy "+s+" could not be created."),null}},sA=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function S3(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:sV();const e=Qe=>S3(Qe);if(e.version="3.3.0",e.removed=[],!r||!r.document||r.document.nodeType!==Yh.document||!r.Element)return e.isSupported=!1,e;let{document:t}=r;const n=t,i=n.currentScript,{DocumentFragment:s,HTMLTemplateElement:o,Node:l,Element:d,NodeFilter:f,NamedNodeMap:m=r.NamedNodeMap||r.MozNamedAttrMap,HTMLFormElement:y,DOMParser:g,trustedTypes:_}=r,E=d.prototype,x=Kh(E,"cloneNode"),b=Kh(E,"remove"),T=Kh(E,"nextSibling"),N=Kh(E,"childNodes"),R=Kh(E,"parentNode");if(typeof o=="function"){const Qe=t.createElement("template");Qe.content&&Qe.content.ownerDocument&&(t=Qe.content.ownerDocument)}let I,j="";const{implementation:U,createNodeIterator:C,createDocumentFragment:k,getElementsByTagName:D}=t,{importNode:O}=n;let P=sA();e.isSupported=typeof b3=="function"&&typeof R=="function"&&U&&U.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:F,ERB_EXPR:M,TMPLIT_EXPR:$,DATA_ATTR:Y,ARIA_ATTR:te,IS_SCRIPT_OR_DATA:oe,ATTR_WHITESPACE:ie,CUSTOM_ELEMENT:ne}=iA;let{IS_ALLOWED_URI:K}=iA,B=null;const G=Vt({},[...eA,...Zv,...Qv,...Xv,...tA]);let X=null;const se=Vt({},[...nA,...Jv,...rA,...zp]);let le=Object.seal(Lx(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Q=null,ce=null;const ue=Object.seal(Lx(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let fe=!0,_e=!0,Oe=!1,qe=!0,tt=!1,yt=!0,At=!1,xn=!1,Yt=!1,Ae=!1,Ne=!1,Le=!1,ze=!0,ke=!1;const vt="user-content-";let mt=!0,pt=!1,kt={},Ot=null;const Mt=Vt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let ls=null;const Ht=Vt({},["audio","video","img","source","image","track"]);let Mn=null;const cs=Vt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Ui="http://www.w3.org/1998/Math/MathML",yi="http://www.w3.org/2000/svg",yr="http://www.w3.org/1999/xhtml";let vi=yr,ti=!1,qi=null;const ho=Vt({},[Ui,yi,yr],Kv);let _i=Vt({},["mi","mo","mn","ms","mtext"]),Jn=Vt({},["annotation-xml"]);const ni=Vt({},["title","style","font","a","script"]);let xi=null;const bi=["application/xhtml+xml","text/html"],Bo="text/html";let yn=null,wi=null;const Hi=t.createElement("form"),us=function(pe){return pe instanceof RegExp||pe instanceof Function},bn=function(){let pe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(wi&&wi===pe)){if((!pe||typeof pe!="object")&&(pe={}),pe=ma(pe),xi=bi.indexOf(pe.PARSER_MEDIA_TYPE)===-1?Bo:pe.PARSER_MEDIA_TYPE,yn=xi==="application/xhtml+xml"?Kv:xg,B=ro(pe,"ALLOWED_TAGS")?Vt({},pe.ALLOWED_TAGS,yn):G,X=ro(pe,"ALLOWED_ATTR")?Vt({},pe.ALLOWED_ATTR,yn):se,qi=ro(pe,"ALLOWED_NAMESPACES")?Vt({},pe.ALLOWED_NAMESPACES,Kv):ho,Mn=ro(pe,"ADD_URI_SAFE_ATTR")?Vt(ma(cs),pe.ADD_URI_SAFE_ATTR,yn):cs,ls=ro(pe,"ADD_DATA_URI_TAGS")?Vt(ma(Ht),pe.ADD_DATA_URI_TAGS,yn):Ht,Ot=ro(pe,"FORBID_CONTENTS")?Vt({},pe.FORBID_CONTENTS,yn):Mt,Q=ro(pe,"FORBID_TAGS")?Vt({},pe.FORBID_TAGS,yn):ma({}),ce=ro(pe,"FORBID_ATTR")?Vt({},pe.FORBID_ATTR,yn):ma({}),kt=ro(pe,"USE_PROFILES")?pe.USE_PROFILES:!1,fe=pe.ALLOW_ARIA_ATTR!==!1,_e=pe.ALLOW_DATA_ATTR!==!1,Oe=pe.ALLOW_UNKNOWN_PROTOCOLS||!1,qe=pe.ALLOW_SELF_CLOSE_IN_ATTR!==!1,tt=pe.SAFE_FOR_TEMPLATES||!1,yt=pe.SAFE_FOR_XML!==!1,At=pe.WHOLE_DOCUMENT||!1,Ae=pe.RETURN_DOM||!1,Ne=pe.RETURN_DOM_FRAGMENT||!1,Le=pe.RETURN_TRUSTED_TYPE||!1,Yt=pe.FORCE_BODY||!1,ze=pe.SANITIZE_DOM!==!1,ke=pe.SANITIZE_NAMED_PROPS||!1,mt=pe.KEEP_CONTENT!==!1,pt=pe.IN_PLACE||!1,K=pe.ALLOWED_URI_REGEXP||w3,vi=pe.NAMESPACE||yr,_i=pe.MATHML_TEXT_INTEGRATION_POINTS||_i,Jn=pe.HTML_INTEGRATION_POINTS||Jn,le=pe.CUSTOM_ELEMENT_HANDLING||{},pe.CUSTOM_ELEMENT_HANDLING&&us(pe.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(le.tagNameCheck=pe.CUSTOM_ELEMENT_HANDLING.tagNameCheck),pe.CUSTOM_ELEMENT_HANDLING&&us(pe.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(le.attributeNameCheck=pe.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),pe.CUSTOM_ELEMENT_HANDLING&&typeof pe.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(le.allowCustomizedBuiltInElements=pe.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),tt&&(_e=!1),Ne&&(Ae=!0),kt&&(B=Vt({},tA),X=[],kt.html===!0&&(Vt(B,eA),Vt(X,nA)),kt.svg===!0&&(Vt(B,Zv),Vt(X,Jv),Vt(X,zp)),kt.svgFilters===!0&&(Vt(B,Qv),Vt(X,Jv),Vt(X,zp)),kt.mathMl===!0&&(Vt(B,Xv),Vt(X,rA),Vt(X,zp))),pe.ADD_TAGS&&(typeof pe.ADD_TAGS=="function"?ue.tagCheck=pe.ADD_TAGS:(B===G&&(B=ma(B)),Vt(B,pe.ADD_TAGS,yn))),pe.ADD_ATTR&&(typeof pe.ADD_ATTR=="function"?ue.attributeCheck=pe.ADD_ATTR:(X===se&&(X=ma(X)),Vt(X,pe.ADD_ATTR,yn))),pe.ADD_URI_SAFE_ATTR&&Vt(Mn,pe.ADD_URI_SAFE_ATTR,yn),pe.FORBID_CONTENTS&&(Ot===Mt&&(Ot=ma(Ot)),Vt(Ot,pe.FORBID_CONTENTS,yn)),mt&&(B["#text"]=!0),At&&Vt(B,["html","head","body"]),B.table&&(Vt(B,["tbody"]),delete Q.tbody),pe.TRUSTED_TYPES_POLICY){if(typeof pe.TRUSTED_TYPES_POLICY.createHTML!="function")throw Gh('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof pe.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Gh('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');I=pe.TRUSTED_TYPES_POLICY,j=I.createHTML("")}else I===void 0&&(I=oV(_,i)),I!==null&&typeof j=="string"&&(j=I.createHTML(""));pi&&pi(pe),wi=pe}},Fs=Vt({},[...Zv,...Qv,...YF]),Lr=Vt({},[...Xv,...ZF]),Vs=function(pe){let Me=R(pe);(!Me||!Me.tagName)&&(Me={namespaceURI:vi,tagName:"template"});const Ke=xg(pe.tagName),Zt=xg(Me.tagName);return qi[pe.namespaceURI]?pe.namespaceURI===yi?Me.namespaceURI===yr?Ke==="svg":Me.namespaceURI===Ui?Ke==="svg"&&(Zt==="annotation-xml"||_i[Zt]):!!Fs[Ke]:pe.namespaceURI===Ui?Me.namespaceURI===yr?Ke==="math":Me.namespaceURI===yi?Ke==="math"&&Jn[Zt]:!!Lr[Ke]:pe.namespaceURI===yr?Me.namespaceURI===yi&&!Jn[Zt]||Me.namespaceURI===Ui&&!_i[Zt]?!1:!Lr[Ke]&&(ni[Ke]||!Fs[Ke]):!!(xi==="application/xhtml+xml"&&qi[pe.namespaceURI]):!1},ln=function(pe){$h(e.removed,{element:pe});try{R(pe).removeChild(pe)}catch{b(pe)}},We=function(pe,Me){try{$h(e.removed,{attribute:Me.getAttributeNode(pe),from:Me})}catch{$h(e.removed,{attribute:null,from:Me})}if(Me.removeAttribute(pe),pe==="is")if(Ae||Ne)try{ln(Me)}catch{}else try{Me.setAttribute(pe,"")}catch{}},Nr=function(pe){let Me=null,Ke=null;if(Yt)pe="<remove></remove>"+pe;else{const wn=Yv(pe,/^[\r\n\t ]+/);Ke=wn&&wn[0]}xi==="application/xhtml+xml"&&vi===yr&&(pe='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+pe+"</body></html>");const Zt=I?I.createHTML(pe):pe;if(vi===yr)try{Me=new g().parseFromString(Zt,xi)}catch{}if(!Me||!Me.documentElement){Me=U.createDocument(vi,"template",null);try{Me.documentElement.innerHTML=ti?j:Zt}catch{}}const It=Me.body||Me.documentElement;return pe&&Ke&&It.insertBefore(t.createTextNode(Ke),It.childNodes[0]||null),vi===yr?D.call(Me,At?"html":"body")[0]:At?Me.documentElement:It},zs=function(pe){return C.call(pe.ownerDocument||pe,pe,f.SHOW_ELEMENT|f.SHOW_COMMENT|f.SHOW_TEXT|f.SHOW_PROCESSING_INSTRUCTION|f.SHOW_CDATA_SECTION,null)},fo=function(pe){return pe instanceof y&&(typeof pe.nodeName!="string"||typeof pe.textContent!="string"||typeof pe.removeChild!="function"||!(pe.attributes instanceof m)||typeof pe.removeAttribute!="function"||typeof pe.setAttribute!="function"||typeof pe.namespaceURI!="string"||typeof pe.insertBefore!="function"||typeof pe.hasChildNodes!="function")},ds=function(pe){return typeof l=="function"&&pe instanceof l};function vr(Qe,pe,Me){Vp(Qe,Ke=>{Ke.call(e,pe,Me,wi)})}const Ir=function(pe){let Me=null;if(vr(P.beforeSanitizeElements,pe,null),fo(pe))return ln(pe),!0;const Ke=yn(pe.nodeName);if(vr(P.uponSanitizeElement,pe,{tagName:Ke,allowedTags:B}),yt&&pe.hasChildNodes()&&!ds(pe.firstElementChild)&&ci(/<[/\w!]/g,pe.innerHTML)&&ci(/<[/\w!]/g,pe.textContent)||pe.nodeType===Yh.progressingInstruction||yt&&pe.nodeType===Yh.comment&&ci(/<[/\w]/g,pe.data))return ln(pe),!0;if(!(ue.tagCheck instanceof Function&&ue.tagCheck(Ke))&&(!B[Ke]||Q[Ke])){if(!Q[Ke]&&Pr(Ke)&&(le.tagNameCheck instanceof RegExp&&ci(le.tagNameCheck,Ke)||le.tagNameCheck instanceof Function&&le.tagNameCheck(Ke)))return!1;if(mt&&!Ot[Ke]){const Zt=R(pe)||pe.parentNode,It=N(pe)||pe.childNodes;if(It&&Zt){const wn=It.length;for(let Pn=wn-1;Pn>=0;--Pn){const er=x(It[Pn],!0);er.__removalCount=(pe.__removalCount||0)+1,Zt.insertBefore(er,T(pe))}}}return ln(pe),!0}return pe instanceof d&&!Vs(pe)||(Ke==="noscript"||Ke==="noembed"||Ke==="noframes")&&ci(/<\/no(script|embed|frames)/i,pe.innerHTML)?(ln(pe),!0):(tt&&pe.nodeType===Yh.text&&(Me=pe.textContent,Vp([F,M,$],Zt=>{Me=Wh(Me,Zt," ")}),pe.textContent!==Me&&($h(e.removed,{element:pe.cloneNode()}),pe.textContent=Me)),vr(P.afterSanitizeElements,pe,null),!1)},kr=function(pe,Me,Ke){if(ze&&(Me==="id"||Me==="name")&&(Ke in t||Ke in Hi))return!1;if(!(_e&&!ce[Me]&&ci(Y,Me))){if(!(fe&&ci(te,Me))){if(!(ue.attributeCheck instanceof Function&&ue.attributeCheck(Me,pe))){if(!X[Me]||ce[Me]){if(!(Pr(pe)&&(le.tagNameCheck instanceof RegExp&&ci(le.tagNameCheck,pe)||le.tagNameCheck instanceof Function&&le.tagNameCheck(pe))&&(le.attributeNameCheck instanceof RegExp&&ci(le.attributeNameCheck,Me)||le.attributeNameCheck instanceof Function&&le.attributeNameCheck(Me,pe))||Me==="is"&&le.allowCustomizedBuiltInElements&&(le.tagNameCheck instanceof RegExp&&ci(le.tagNameCheck,Ke)||le.tagNameCheck instanceof Function&&le.tagNameCheck(Ke))))return!1}else if(!Mn[Me]){if(!ci(K,Wh(Ke,ie,""))){if(!((Me==="src"||Me==="xlink:href"||Me==="href")&&pe!=="script"&&$F(Ke,"data:")===0&&ls[pe])){if(!(Oe&&!ci(oe,Wh(Ke,ie,"")))){if(Ke)return!1}}}}}}}return!0},Pr=function(pe){return pe!=="annotation-xml"&&Yv(pe,ne)},Uo=function(pe){vr(P.beforeSanitizeAttributes,pe,null);const{attributes:Me}=pe;if(!Me||fo(pe))return;const Ke={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:X,forceKeepAttr:void 0};let Zt=Me.length;for(;Zt--;){const It=Me[Zt],{name:wn,namespaceURI:Pn,value:er}=It,Gn=yn(wn),$i=er;let vn=wn==="value"?$i:WF($i);if(Ke.attrName=Gn,Ke.attrValue=vn,Ke.keepAttr=!0,Ke.forceKeepAttr=void 0,vr(P.uponSanitizeAttribute,pe,Ke),vn=Ke.attrValue,ke&&(Gn==="id"||Gn==="name")&&(We(wn,pe),vn=vt+vn),yt&&ci(/((--!?|])>)|<\/(style|title|textarea)/i,vn)){We(wn,pe);continue}if(Gn==="attributename"&&Yv(vn,"href")){We(wn,pe);continue}if(Ke.forceKeepAttr)continue;if(!Ke.keepAttr){We(wn,pe);continue}if(!qe&&ci(/\/>/i,vn)){We(wn,pe);continue}tt&&Vp([F,M,$],ar=>{vn=Wh(vn,ar," ")});const Wi=yn(pe.nodeName);if(!kr(Wi,Gn,vn)){We(wn,pe);continue}if(I&&typeof _=="object"&&typeof _.getAttributeType=="function"&&!Pn)switch(_.getAttributeType(Wi,Gn)){case"TrustedHTML":{vn=I.createHTML(vn);break}case"TrustedScriptURL":{vn=I.createScriptURL(vn);break}}if(vn!==$i)try{Pn?pe.setAttributeNS(Pn,wn,vn):pe.setAttribute(wn,vn),fo(pe)?ln(pe):JT(e.removed)}catch{We(wn,pe)}}vr(P.afterSanitizeAttributes,pe,null)},qo=function Qe(pe){let Me=null;const Ke=zs(pe);for(vr(P.beforeSanitizeShadowDOM,pe,null);Me=Ke.nextNode();)vr(P.uponSanitizeShadowNode,Me,null),Ir(Me),Uo(Me),Me.content instanceof s&&Qe(Me.content);vr(P.afterSanitizeShadowDOM,pe,null)};return e.sanitize=function(Qe){let pe=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Me=null,Ke=null,Zt=null,It=null;if(ti=!Qe,ti&&(Qe="<!-->"),typeof Qe!="string"&&!ds(Qe))if(typeof Qe.toString=="function"){if(Qe=Qe.toString(),typeof Qe!="string")throw Gh("dirty is not a string, aborting")}else throw Gh("toString is not a function");if(!e.isSupported)return Qe;if(xn||bn(pe),e.removed=[],typeof Qe=="string"&&(pt=!1),pt){if(Qe.nodeName){const er=yn(Qe.nodeName);if(!B[er]||Q[er])throw Gh("root node is forbidden and cannot be sanitized in-place")}}else if(Qe instanceof l)Me=Nr("<!---->"),Ke=Me.ownerDocument.importNode(Qe,!0),Ke.nodeType===Yh.element&&Ke.nodeName==="BODY"||Ke.nodeName==="HTML"?Me=Ke:Me.appendChild(Ke);else{if(!Ae&&!tt&&!At&&Qe.indexOf("<")===-1)return I&&Le?I.createHTML(Qe):Qe;if(Me=Nr(Qe),!Me)return Ae?null:Le?j:""}Me&&Yt&&ln(Me.firstChild);const wn=zs(pt?Qe:Me);for(;Zt=wn.nextNode();)Ir(Zt),Uo(Zt),Zt.content instanceof s&&qo(Zt.content);if(pt)return Qe;if(Ae){if(Ne)for(It=k.call(Me.ownerDocument);Me.firstChild;)It.appendChild(Me.firstChild);else It=Me;return(X.shadowroot||X.shadowrootmode)&&(It=O.call(n,It,!0)),It}let Pn=At?Me.outerHTML:Me.innerHTML;return At&&B["!doctype"]&&Me.ownerDocument&&Me.ownerDocument.doctype&&Me.ownerDocument.doctype.name&&ci(E3,Me.ownerDocument.doctype.name)&&(Pn="<!DOCTYPE "+Me.ownerDocument.doctype.name+`>
`+Pn),tt&&Vp([F,M,$],er=>{Pn=Wh(Pn,er," ")}),I&&Le?I.createHTML(Pn):Pn},e.setConfig=function(){let Qe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};bn(Qe),xn=!0},e.clearConfig=function(){wi=null,xn=!1},e.isValidAttribute=function(Qe,pe,Me){wi||bn({});const Ke=yn(Qe),Zt=yn(pe);return kr(Ke,Zt,Me)},e.addHook=function(Qe,pe){typeof pe=="function"&&$h(P[Qe],pe)},e.removeHook=function(Qe,pe){if(pe!==void 0){const Me=qF(P[Qe],pe);return Me===-1?void 0:HF(P[Qe],Me,1)[0]}return JT(P[Qe])},e.removeHooks=function(Qe){P[Qe]=[]},e.removeAllHooks=function(){P=sA()},e}var uo=S3();const T3=({isOpen:r,onClose:e,bill:t,userData:n,calculateBillDetails:i,showNotification:s,systemSettings:o={}})=>{var U,C,k,D,O,P,F,M,$,Y,te,oe,ie;if(!r||!t||!n)return null;const l=t.calculatedCharges||i(t.consumption,n.serviceType,n.meterSize||'1/2"');(o.latePaymentPenaltyPercentage||2)/100;const d=parseFloat(((U=t.totalCalculatedCharges)==null?void 0:U.toFixed(2))||0),f=parseFloat((t.previousUnpaidAmount||0).toFixed(2)),m=parseFloat((t.penaltyAmount||0).toFixed(2)),y=parseFloat((t.seniorCitizenDiscount||0).toFixed(2)),g=t.baseAmount||d+f+m-y;t.potentialPenalty;const _=t.amount||0,E=(C=t.billDate)!=null&&C.toDate?t.billDate.toDate():null,x=E?`${E.getFullYear()}${String(E.getMonth()+1).padStart(2,"0")}${String(E.getDate()).padStart(2,"0")}`:Date.now().toString().slice(-6),b=t.invoiceNumber||`AGWA-${(k=t.id)==null?void 0:k.slice(0,4).toUpperCase()}-${x}`,N=(ne=>!ne||typeof ne!="object"?ne||"N/A":[ne.street,ne.barangay,ne.district,"Naic, Cavite"].filter(B=>B&&B.trim()).join(", "))(n.serviceAddress),R=()=>{const ne=document.getElementById("invoice-content-to-print-modal-fullscreen"),K=document.getElementById("invoice-print-styles");if(!ne||!K){s("Print content not found.","error");return}const B=window.open("","_blank","height=800,width=1000,scrollbars=yes");B.document.write("<html><head><title>AGWA Invoice "+b+"</title>"),B.document.write('<script src="https://cdn.tailwindcss.com"><\/script>');const G=B.document.createElement("style");G.innerHTML=K.innerHTML,B.document.head.appendChild(G),B.document.write("</head><body>"),B.document.write(ne.innerHTML),B.document.write(`
            <script>
                window.onload = function() {
                    setTimeout(function() { 
                        window.print();
                        window.close();
                    }, 1000); 
                };
            <\/script>
        `),B.document.write("</body></html>"),B.document.close()},I=({label:ne,value:K,isBold:B=!1,isTotal:G=!1,isVat:X=!1})=>u.jsxs("tr",{className:X?"text-xs":"",children:[u.jsx("td",{className:`py-1 ${G?"pt-2":""} ${B?"font-semibold":"pl-4"}`,children:ne}),u.jsx("td",{className:`py-1 ${G?"pt-2":""} text-right ${B?"font-semibold":""}`,children:K})]}),j=()=>u.jsxs("div",{className:"w-full border-t-2 border-dashed border-gray-400 mt-4 pt-4",children:[u.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[u.jsxs("div",{className:"col-span-2",children:[u.jsx("p",{className:"text-xs font-semibold",children:"Contract Account Number:"}),u.jsx("p",{className:"text-lg font-mono font-bold tracking-wider",children:n.accountNumber}),u.jsx("p",{className:"text-sm font-semibold mt-1",children:n.displayName}),u.jsx("p",{className:"text-xs",children:N})]}),u.jsxs("div",{className:"text-right",children:[u.jsx("div",{className:"text-3xl font-bold text-blue-700",children:"AGWA"}),u.jsx("p",{className:"text-xxs text-blue-600 italic -mt-1",children:"Ensuring Clarity, Sustaining Life."})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-2",children:[u.jsxs("div",{className:"text-xs",children:[u.jsxs("p",{children:["INVOICE No.: ",u.jsx("span",{className:"font-semibold",children:b})]}),u.jsxs("p",{children:["Billing Period: ",u.jsx("span",{className:"font-semibold",children:t.billingPeriod||t.monthYear})]}),u.jsxs("p",{children:["Bill Date: ",u.jsx("span",{className:"font-semibold",children:$t(t.billDate,{month:"short",day:"numeric",year:"numeric"})})]})]}),u.jsxs("div",{className:"text-xs text-right",children:[u.jsx("p",{children:"Total Amount Due:"}),u.jsxs("p",{className:"text-lg font-bold",children:["",g.toFixed(2)]}),u.jsx("p",{children:"Due Date:"}),u.jsx("p",{className:"text-lg font-bold",children:$t(t.dueDate,{month:"short",day:"numeric",year:"numeric"})})]})]}),u.jsxs("div",{className:"p-4 bg-blue-100 rounded-lg mt-4 flex justify-between items-center text-center",children:[u.jsxs("div",{className:"text-left",children:[u.jsx("p",{className:"text-xs font-bold text-blue-800",children:"TOTAL AMOUNT DUE"}),u.jsxs("p",{className:"text-2xl font-bold text-blue-800",children:["",g.toFixed(2)]})]}),u.jsxs("div",{className:"text-right",children:[u.jsx("p",{className:"text-xs font-bold text-blue-800",children:"DUE DATE"}),u.jsx("p",{className:"text-2xl font-bold text-blue-800",children:$t(t.dueDate,{month:"short",day:"numeric",year:"numeric"})})]})]}),u.jsx("div",{className:"max-w-xs mx-auto mt-2",children:u.jsx(x3,{value:b})}),u.jsx("p",{className:"text-center text-xs text-gray-600 mt-2 font-semibold",children:"CUSTOMER SERVICE HOTLINE: 1627-AGWA"}),u.jsx("p",{className:"text-center text-xs text-gray-600 mt-1",children:"PLEASE PAY VIA GCASH OR THROUGH OTHER ACCREDITED PAYMENT CENTERS. METER READERS AND CONTRACTORS ARE NOT ALLOWED TO ACCEPT PAYMENTS."})]});return u.jsxs(Ar,{isOpen:r,onClose:e,title:"",size:"full",modalDialogClassName:"sm:max-w-4xl w-[95vw] h-[95vh]",contentClassName:"p-0 bg-gray-200",children:[u.jsx("style",{id:"invoice-print-styles",dangerouslySetInnerHTML:{__html:`
                @media print {
                    @page {
                        size: A4 portrait;
                        margin: 0.5in;
                    }
                    body { 
                        font-family: 'Times New Roman', Times, serif; 
                        -webkit-print-color-adjust: exact !important; 
                        print-color-adjust: exact !important;
                        color: #000;
                        font-size: 10pt; 
                    }
                    .no-print { display: none !important; }
                    .printable-area { padding: 0 !important; max-width: 100%; margin: auto; box-shadow: none !important; border: none !important; }
                    .invoice-header-print {
                        display: flex;
                        justify-content: space-between;
                        align-items: flex-start;
                        padding-bottom: 0.5rem;
                        border-bottom: 2px solid #000;
                    }
                    .invoice-header-print .logo-print { font-size: 2rem; font-weight: 700; color: #1e3a8a !important; line-height: 1; }
                    .invoice-header-print .tagline-print { font-size: 0.7rem; color: #1d4ed8 !important; font-style: italic; }
                    .invoice-header-print .company-address-print { text-align: right; font-size: 0.75rem; line-height: 1.3; color: #374151 !important; }
                    .invoice-title-print { text-align: center; margin: 0.75rem 0; font-size: 1.25rem; font-weight: 700; }
                    .invoice-grid-print { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
                    .invoice-grid-print > div { border: 1px solid #000; padding: 0.5rem; }
                    .invoice-grid-print h2 { font-weight: 700; font-size: 0.9rem; border-bottom: 1px solid #000; padding-bottom: 0.25rem; margin-bottom: 0.25rem; }
                    .invoice-grid-print p { margin: 0.15rem 0; font-size: 0.9rem; }
                    .invoice-grid-print p span { font-weight: 600; }
                    .charges-table-print { width: 100%; margin-top: 1rem; border-collapse: collapse; }
                    .charges-table-print th, .charges-table-print td { padding: 0.25rem 0.5rem; font-size: 0.9rem; }
                    .charges-table-print th { text-align: left; font-weight: 700; border-bottom: 1px solid #000; }
                    .charges-table-print td:last-child { text-align: right; }
                    .charges-table-print .subtotal-row td { border-top: 1px solid #999; padding-top: 0.5rem; font-weight: 600; }
                    .charges-table-print .vat-row td { font-size: 0.8rem; }
                    .grand-total-print { text-align: right; margin-top: 1rem; }
                    .grand-total-print p { margin: 0; font-size: 0.9rem; }
                    .grand-total-print h3 { margin: 0; font-size: 1.2rem; font-weight: 700; }
                    .tear-off-slip-print { border-top: 2px dashed #000; margin-top: 1rem; padding-top: 1rem; page-break-before: always; }
                    .tear-off-slip-print .text-xxs { font-size: 0.6rem; }
                    .tear-off-slip-print .text-lg { font-size: 1.25rem; }
                    .tear-off-slip-print .text-2xl { font-size: 1.5rem; }
                    .tear-off-slip-print .text-3xl { font-size: 1.875rem; }
                    .barcode-container-print { max-width: 260px; margin: 0.25rem auto 0 auto; }
                    .paid-stamp-print {
                        position: absolute;
                        top: 35%;
                        left: 50%;
                        transform: translate(-50%, -50%) rotate(-25deg);
                        color: rgba(220, 38, 38, 0.15) !important;
                        border: 8px double rgba(220, 38, 38, 0.15) !important;
                        padding: 0.5rem 1rem;
                        border-radius: 8px;
                        font-family: 'Arial', sans-serif;
                        text-align: center;
                        opacity: 1;
                        z-index: 10;
                        pointer-events: none;
                    }
                    .paid-stamp-main-print { font-size: 3.5rem; font-weight: 700; line-height: 1; }
                    .paid-stamp-date-print { font-size: 1rem; font-weight: 600; margin-top: 4px; display: block; }
                }
            `}}),u.jsxs("div",{className:"flex justify-between items-center p-3 sm:p-4 border-b border-gray-300 bg-gray-100 rounded-t-xl sticky top-0 z-20 no-print",children:[u.jsxs("h3",{className:"text-md sm:text-lg font-semibold text-gray-800 truncate",title:b,children:[u.jsx(nc,{size:22,className:"mr-2.5 text-blue-600 inline-block"}),"Invoice: ",b]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsxs("button",{onClick:R,className:"p-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg transition-colors flex items-center focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50",title:"Print/Download Invoice",children:[u.jsx(U9,{size:16,className:"mr-0 sm:mr-1.5"})," ",u.jsx("span",{className:"hidden sm:inline",children:"Print/Save"})]}),u.jsx("button",{onClick:e,className:"p-2 text-gray-500 hover:text-gray-700 bg-gray-200 hover:bg-gray-300 rounded-lg transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500",title:"Close Invoice View",children:u.jsx(i0,{size:18})})]})]}),u.jsx("div",{className:"overflow-y-auto flex-grow p-1",children:u.jsxs("div",{id:"invoice-content-to-print-modal-fullscreen",className:"printable-area bg-white p-4 sm:p-8 max-w-4xl mx-auto my-4 shadow-lg font-sans",children:[((D=t.status)==null?void 0:D.toLowerCase())==="paid"&&u.jsxs("div",{className:"paid-stamp-print",children:[u.jsx("div",{className:"paid-stamp-main-print",children:"PAID"}),u.jsx("div",{className:"paid-stamp-date-print",children:$t(t.paymentDate,{year:"numeric",month:"short",day:"numeric"})})]}),u.jsxs("div",{className:"relative z-0",children:[u.jsxs("header",{className:"invoice-header-print mb-4",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"logo-print text-4xl font-bold text-blue-700",children:"AGWA"}),u.jsx("p",{className:"tagline-print text-sm text-blue-600 italic -mt-1",children:"Ensuring Clarity, Sustaining Life."})]}),u.jsxs("div",{className:"company-address-print text-right text-xs",children:[u.jsx("strong",{children:"AGWA Water Services, Inc."}),u.jsx("br",{}),"123 Aqua Drive, Hydro Business Park",u.jsx("br",{}),"Naic, Cavite, Philippines 4110",u.jsx("br",{}),"VAT Reg. TIN: 000-123-456-789"]})]}),u.jsx("h1",{className:"invoice-title-print text-center my-4 text-2xl font-bold",children:"INVOICE"}),u.jsxs("div",{className:"invoice-grid-print grid grid-cols-2 gap-4 text-sm",children:[u.jsxs("div",{className:"invoice-grid-box border border-black p-3",children:[u.jsx("h2",{className:"font-bold text-sm border-b border-black pb-1 mb-1",children:"CUSTOMER INFORMATION"}),u.jsx("p",{className:"font-bold text-base",children:n.displayName}),u.jsx("p",{children:N}),u.jsxs("p",{className:"mt-2",children:["CAN: ",u.jsx("span",{className:"font-semibold",children:n.accountNumber})]}),u.jsxs("p",{children:["Rate Class: ",u.jsx("span",{className:"font-semibold",children:n.serviceType})]}),u.jsxs("p",{children:["Meter Number: ",u.jsx("span",{className:"font-semibold",children:n.meterSerialNumber})]})]}),u.jsxs("div",{className:"invoice-grid-box border border-black p-3",children:[u.jsx("h2",{className:"font-bold text-sm border-b border-black pb-1 mb-1",children:"BILLING INFORMATION"}),u.jsxs("p",{children:["Billing Date: ",u.jsx("span",{className:"font-semibold",children:$t(t.billDate,{month:"long",day:"numeric",year:"numeric"})})]}),u.jsxs("p",{children:["Billing Period: ",u.jsx("span",{className:"font-semibold",children:t.billingPeriod||t.monthYear})]}),u.jsxs("p",{className:"mt-2",children:["Current Reading: ",u.jsxs("span",{className:"font-semibold",children:[t.currentReading," m"]})]}),u.jsxs("p",{children:["Previous Reading: ",u.jsxs("span",{className:"font-semibold",children:[t.previousReading," m"]})]}),u.jsxs("p",{children:["Consumption: ",u.jsxs("span",{className:"font-semibold",children:[t.consumption," m"]})]})]})]}),u.jsxs("div",{className:"grid grid-cols-5 gap-4 mt-4",children:[u.jsx("div",{className:"col-span-3",children:u.jsxs("table",{className:"charges-table-print w-full text-sm",children:[u.jsx("thead",{children:u.jsxs("tr",{children:[u.jsx("th",{className:"text-left font-bold border-b-2 border-black pb-1",children:"BILLING SUMMARY"}),u.jsx("th",{className:"text-right font-bold border-b-2 border-black pb-1",children:"AMOUNT (PHP)"})]})}),u.jsxs("tbody",{children:[u.jsx(I,{label:"Basic Charge",value:(O=l.basicCharge)==null?void 0:O.toFixed(2)}),u.jsx(I,{label:"FCDA",value:(P=l.fcda)==null?void 0:P.toFixed(2)}),u.jsx(I,{label:"Environmental Charge",value:(F=l.environmentalCharge)==null?void 0:F.toFixed(2)}),u.jsx(I,{label:"Sewer Charge",value:(M=l.sewerageCharge)==null?void 0:M.toFixed(2)}),u.jsx(I,{label:"Maintenance Service Charge",value:($=l.maintenanceServiceCharge)==null?void 0:$.toFixed(2)}),u.jsx(I,{label:"Senior Citizen Discount",value:y>0?`(${y.toFixed(2)})`:"0.00"}),u.jsx(I,{label:"Government Taxes",value:(Y=l.governmentTaxes)==null?void 0:Y.toFixed(2)}),u.jsx(I,{label:"SUBTOTAL",value:(te=l.subTotalBeforeTaxes)==null?void 0:te.toFixed(2),isBold:!0,isTotal:!0}),u.jsx("tr",{className:"h-4",children:u.jsx("td",{colSpan:"2"})}),u.jsx(I,{label:"Other Charges",value:"0.00"}),u.jsx(I,{label:"SUBTOTAL",value:"0.00",isBold:!0,isTotal:!0}),u.jsx("tr",{className:"h-4",children:u.jsx("td",{colSpan:"2"})}),u.jsx(I,{label:"TOTAL CURRENT CHARGES",value:d.toFixed(2),isBold:!0}),u.jsx(I,{label:"VATable Sales",value:(oe=l.vatableSales)==null?void 0:oe.toFixed(2),isVat:!0}),u.jsx(I,{label:"VAT (12%)",value:(ie=l.vat)==null?void 0:ie.toFixed(2),isVat:!0}),u.jsx(I,{label:"VAT Exempt",value:"0.00",isVat:!0}),u.jsx("tr",{className:"h-4",children:u.jsx("td",{colSpan:"2"})}),u.jsx(I,{label:"Previous Unpaid Amount",value:f.toFixed(2)}),u.jsx(I,{label:"Penalties",value:m.toFixed(2)})]})]})}),u.jsxs("div",{className:"col-span-2 pt-8",children:[u.jsxs("div",{className:"text-right",children:[u.jsx("p",{className:"text-gray-600",children:"TOTAL AMOUNT DUE"}),u.jsxs("h3",{className:"text-4xl font-bold",children:["",_.toFixed(2)]}),u.jsxs("p",{className:"font-semibold mt-1",children:["DUE DATE: ",$t(t.dueDate,{month:"long",day:"numeric",year:"numeric"})]})]}),t.status==="Paid"&&u.jsxs("div",{className:"mt-4 text-right p-3 bg-green-100 border border-green-300 rounded-lg",children:[u.jsx("p",{className:"font-bold text-green-700",children:"AMOUNT PAID"}),u.jsxs("h3",{className:"text-2xl font-bold text-green-700",children:["",(t.amountPaid||t.amount).toFixed(2)]}),u.jsxs("p",{className:"text-sm text-gray-700",children:["Paid on: ",$t(t.paymentDate,{month:"short",day:"numeric",year:"numeric"})]})]})]})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-6 text-sm",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold border-b border-black pb-1 mb-1",children:"PAYMENT HISTORY"}),u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"text-left text-xs text-gray-600",children:[u.jsx("th",{children:"Posting Date"}),u.jsx("th",{children:"Reference Number"}),u.jsx("th",{className:"text-right",children:"Amount"})]})}),u.jsx("tbody",{children:u.jsx("tr",{children:u.jsx("td",{colSpan:"3",className:"text-center py-2 text-gray-500",children:"No recent payments."})})})]})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"font-bold border-b border-black pb-1 mb-1",children:"CREDIT AND DEBIT MEMO"}),u.jsxs("table",{className:"w-full",children:[u.jsx("thead",{children:u.jsxs("tr",{className:"text-left text-xs text-gray-600",children:[u.jsx("th",{children:"Posting Date"}),u.jsx("th",{children:"Reference Number"}),u.jsx("th",{className:"text-right",children:"Amount"})]})}),u.jsx("tbody",{children:u.jsx("tr",{children:u.jsx("td",{colSpan:"3",className:"text-center py-2 text-gray-500",children:"No adjustments."})})})]})]})]}),u.jsx("div",{className:"text-center text-xs text-gray-600 mt-8 pt-4 border-t border-black",children:u.jsx("p",{children:"BIR PERMIT NO.: AC_116_102024_000436 DATE OF ISSUE: 10/17/2024 SERIES RANGE: 0000000001 - 9999999999"})})]}),u.jsx(j,{})]})})]})},aV=({user:r,userData:e,setUserData:t,db:n,showNotification:i,billingService:s,systemSettings:o={}})=>{const[l,d]=J.useState([]),[f,m]=J.useState(!0),[y,g]=J.useState(""),[_,E]=J.useState(null),[x,b]=J.useState(!1),[T,N]=J.useState(!1),[R,I]=J.useState(null),[j,U]=J.useState(""),[C,k]=J.useState(!1),[D,O]=J.useState(null),[P,F]=J.useState(!1),{isOnlinePaymentsEnabled:M=!0}=o,$=DF(),Y=JSON.stringify(o),te=JSON.stringify(e),oe=J.useCallback(async()=>{m(!0),g("");const G=JSON.parse(te),X=JSON.parse(Y);if(!(r!=null&&r.uid)||!(G!=null&&G.serviceType)){g("Missing user data for fetching bills."),m(!1);return}const se=await ih(n,r.uid);if(se.success){const Q=se.data.sort((ce,ue)=>{var Oe,qe;const fe=(Oe=ce.billDate)!=null&&Oe.toDate?ce.billDate.toDate():new Date(0);return((qe=ue.billDate)!=null&&qe.toDate?ue.billDate.toDate():new Date(0))-fe}).map(ce=>{const ue=s(ce.consumption??0,G.serviceType,G.meterSize,X),fe=(ce.totalCalculatedCharges||0)+(ce.previousUnpaidAmount||0)-(ce.seniorCitizenDiscount||0),_e=O8(ce,X),Oe=v2(ce,X),qe=fe+Oe;return{...ce,calculatedCharges:ue,baseAmount:fe,potentialPenalty:_e,amount:qe,displayPenalty:Oe}}).filter(ce=>ce.amount!==void 0);d(Q)}else g(se.error||"Failed to fetch your bills."),i(se.error||"Failed to fetch bills.","error");m(!1)},[n,r==null?void 0:r.uid,i,s,te,Y]);J.useEffect(()=>{oe()},[oe]),J.useEffect(()=>{const G=new URLSearchParams(window.location.search),X=G.get("payment"),se=G.get("session_id"),le=window.location.pathname,Q=async()=>{if(r!=null&&r.uid&&t){const ce=await _2(n,r.uid);ce.success&&t(ce.data)}};X==="success"&&se?(N(!0),i("Payment successful, verifying transaction...","info"),FF(se,n).then(ce=>{ce.success?i("Payment verified! Your bill and points are updated.","success"):i(`Payment verification failed: ${ce.error}`,"error")}).catch(ce=>{i(`An error occurred during verification: ${ce.message}`,"error")}).finally(()=>{N(!1),oe(),Q(),window.history.replaceState({},document.title,le)})):X==="cancel"&&(i("Payment was cancelled. Your bill remains unpaid.","warning"),window.history.replaceState({},document.title,le))},[oe,i,n,r,t]);const ie=G=>{E(G),b(!0)},ne=async G=>{if(!G||!G.calculatedCharges){i("Bill details unavailable for explanation.","warning");return}I(G),U(""),k(!0);try{const X={...G,amount:G.baseAmount},se=await bF({billDetails:X,charges:G.calculatedCharges,customerName:e.displayName||"Valued Customer",serviceType:e.serviceType||"Residential"}),le=G.potentialPenalty>0&&G.status==="Unpaid"?`<p><strong>Note on Late Payment:</strong> A penalty of <strong>${G.potentialPenalty.toFixed(2)}</strong> will be applied if not paid by the due date.</p>`:"";U(se+le)}catch(X){const se=(X==null?void 0:X.message)||"AI explanation failed.";U("<p>Sorry, an error occurred while generating the explanation. Please view the detailed invoice instead.</p>"),i(se,"error")}finally{k(!1)}},K=G=>{O(G),F(!0)},B=G=>{var le,Q;if(G.invoiceNumber)return G.invoiceNumber;const X=(le=G.billDate)!=null&&le.toDate?G.billDate.toDate():null,se=X?`${X.getFullYear()}${String(X.getMonth()+1).padStart(2,"0")}${String(X.getDate()).padStart(2,"0")}`:Date.now().toString().slice(-6);return`AGWA-${(Q=G.id)==null?void 0:Q.slice(0,4).toUpperCase()}-${se}`};if(f||T){const G=T?"Verifying your payment...":"Loading your bills...";return u.jsx(an,{message:G})}return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center mb-6 pb-4 border-b border-gray-200",children:[u.jsx(nc,{size:30,className:"mr-3 text-blue-600"})," My Bills & Payment History"]}),y&&u.jsx("div",{className:"text-red-500 bg-red-50 p-3 rounded-md text-center",children:y}),l.length===0&&!y&&u.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner",children:[u.jsx(gn,{size:48,className:"mx-auto text-gray-400 mb-4"}),u.jsx("p",{className:"text-gray-600 text-lg",children:"No billing history found."})]}),u.jsx("div",{className:"space-y-4",children:l.map(G=>{var Q,ce,ue;const X=B(G),se=G.status==="Paid",le=(G.baseAmount+G.potentialPenalty).toFixed(2);return u.jsxs("div",{className:`p-4 rounded-lg shadow-md border-l-4 ${se?"bg-green-50 border-green-400":"bg-yellow-50 border-yellow-400"}`,children:[u.jsxs("div",{className:"flex flex-wrap justify-between items-center gap-2",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:G.monthYear||G.billingPeriod||"N/A"}),u.jsxs("p",{className:`text-sm font-semibold ${se?"text-green-600":"text-red-600"}`,children:["Due: ",$t(G.dueDate,{month:"long",day:"numeric"})]}),u.jsxs("p",{className:"text-xs text-gray-500 mt-1",title:X,children:["Invoice No: ",X]})]}),u.jsx("div",{className:"text-right",children:se?u.jsxs(u.Fragment,{children:[u.jsxs("p",{className:"text-2xl font-bold text-gray-700",children:["",((Q=G.amountPaid)==null?void 0:Q.toFixed(2))??((ce=G.amount)==null?void 0:ce.toFixed(2))]}),u.jsxs("p",{className:"text-sm font-semibold text-green-600",children:["Paid on ",$t(G.paymentDate,{month:"short",day:"numeric"})]})]}):u.jsxs(u.Fragment,{children:[u.jsxs("p",{className:"text-2xl font-bold text-gray-700",children:["",(ue=G.baseAmount)==null?void 0:ue.toFixed(2)]}),u.jsxs("p",{className:"text-sm font-semibold text-red-600",children:["(After Due Date: ",le,")"]}),G.displayPenalty>0&&u.jsxs("span",{className:"text-xs text-red-500 font-semibold block",children:["(Currently includes ",G.displayPenalty.toFixed(2)," penalty)"]})]})})]}),u.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200/80 flex flex-wrap gap-2 justify-end",children:[u.jsxs("button",{onClick:()=>K(G),className:"text-xs font-medium bg-blue-100 text-blue-700 hover:bg-blue-200 px-3 py-1.5 rounded-md transition flex items-center",children:[u.jsx(tc,{size:14,className:"mr-1"}),"View Invoice"]}),u.jsxs("button",{onClick:()=>ne(G),className:"text-xs font-medium bg-purple-100 text-purple-700 hover:bg-purple-200 px-3 py-1.5 rounded-md transition flex items-center",disabled:C&&(R==null?void 0:R.id)===G.id,children:[C&&(R==null?void 0:R.id)===G.id?u.jsx(Et,{size:14,className:"animate-spin mr-1"}):u.jsx(Os,{size:14,className:"mr-1"})," Explain Bill (AI)"]}),!se&&M&&u.jsxs("button",{onClick:()=>ie(G),className:"text-xs font-bold bg-green-500 text-white hover:bg-green-600 px-4 py-1.5 rounded-md transition flex items-center",children:[u.jsx("span",{className:"mr-1 font-bold",children:""})," Pay Now (",G.amount.toFixed(2),")"]})]})]},G.id)})}),u.jsx(Ar,{isOpen:!!R,onClose:()=>I(null),title:` AI Explanation for ${(R==null?void 0:R.monthYear)||"Bill"}`,size:"lg",children:C?u.jsx(an,{message:"Agie is analyzing your bill..."}):u.jsx("div",{className:"prose prose-sm max-w-none leading-relaxed p-2",dangerouslySetInnerHTML:{__html:uo.sanitize(j||"")}})}),x&&_&&u.jsx(VF,{isOpen:x,onClose:()=>b(!1),billToPay:_,userData:e,showNotification:i,stripePromise:$}),P&&D&&u.jsx(T3,{isOpen:P,onClose:()=>F(!1),bill:D,userData:e,calculateBillDetails:s,showNotification:i,systemSettings:o})]})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function Pm(r){return r+.5|0}const Fl=(r,e,t)=>Math.max(Math.min(r,t),e);function mf(r){return Fl(Pm(r*2.55),0,255)}function Gl(r){return Fl(Pm(r*255),0,255)}function va(r){return Fl(Pm(r/2.55)/100,0,1)}function oA(r){return Fl(Pm(r*100),0,100)}const As={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},zx=[..."0123456789ABCDEF"],lV=r=>zx[r&15],cV=r=>zx[(r&240)>>4]+zx[r&15],Bp=r=>(r&240)>>4===(r&15),uV=r=>Bp(r.r)&&Bp(r.g)&&Bp(r.b)&&Bp(r.a);function dV(r){var e=r.length,t;return r[0]==="#"&&(e===4||e===5?t={r:255&As[r[1]]*17,g:255&As[r[2]]*17,b:255&As[r[3]]*17,a:e===5?As[r[4]]*17:255}:(e===7||e===9)&&(t={r:As[r[1]]<<4|As[r[2]],g:As[r[3]]<<4|As[r[4]],b:As[r[5]]<<4|As[r[6]],a:e===9?As[r[7]]<<4|As[r[8]]:255})),t}const hV=(r,e)=>r<255?e(r):"";function fV(r){var e=uV(r)?lV:cV;return r?"#"+e(r.r)+e(r.g)+e(r.b)+hV(r.a,e):void 0}const mV=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function A3(r,e,t){const n=e*Math.min(t,1-t),i=(s,o=(s+r/30)%12)=>t-n*Math.max(Math.min(o-3,9-o,1),-1);return[i(0),i(8),i(4)]}function pV(r,e,t){const n=(i,s=(i+r/60)%6)=>t-t*e*Math.max(Math.min(s,4-s,1),0);return[n(5),n(3),n(1)]}function gV(r,e,t){const n=A3(r,1,.5);let i;for(e+t>1&&(i=1/(e+t),e*=i,t*=i),i=0;i<3;i++)n[i]*=1-e-t,n[i]+=e;return n}function yV(r,e,t,n,i){return r===i?(e-t)/n+(e<t?6:0):e===i?(t-r)/n+2:(r-e)/n+4}function R2(r){const t=r.r/255,n=r.g/255,i=r.b/255,s=Math.max(t,n,i),o=Math.min(t,n,i),l=(s+o)/2;let d,f,m;return s!==o&&(m=s-o,f=l>.5?m/(2-s-o):m/(s+o),d=yV(t,n,i,m,s),d=d*60+.5),[d|0,f||0,l]}function j2(r,e,t,n){return(Array.isArray(e)?r(e[0],e[1],e[2]):r(e,t,n)).map(Gl)}function O2(r,e,t){return j2(A3,r,e,t)}function vV(r,e,t){return j2(gV,r,e,t)}function _V(r,e,t){return j2(pV,r,e,t)}function N3(r){return(r%360+360)%360}function xV(r){const e=mV.exec(r);let t=255,n;if(!e)return;e[5]!==n&&(t=e[6]?mf(+e[5]):Gl(+e[5]));const i=N3(+e[2]),s=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?n=vV(i,s,o):e[1]==="hsv"?n=_V(i,s,o):n=O2(i,s,o),{r:n[0],g:n[1],b:n[2],a:t}}function bV(r,e){var t=R2(r);t[0]=N3(t[0]+e),t=O2(t),r.r=t[0],r.g=t[1],r.b=t[2]}function wV(r){if(!r)return;const e=R2(r),t=e[0],n=oA(e[1]),i=oA(e[2]);return r.a<255?`hsla(${t}, ${n}%, ${i}%, ${va(r.a)})`:`hsl(${t}, ${n}%, ${i}%)`}const aA={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},lA={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function EV(){const r={},e=Object.keys(lA),t=Object.keys(aA);let n,i,s,o,l;for(n=0;n<e.length;n++){for(o=l=e[n],i=0;i<t.length;i++)s=t[i],l=l.replace(s,aA[s]);s=parseInt(lA[o],16),r[l]=[s>>16&255,s>>8&255,s&255]}return r}let Up;function SV(r){Up||(Up=EV(),Up.transparent=[0,0,0,0]);const e=Up[r.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const TV=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function AV(r){const e=TV.exec(r);let t=255,n,i,s;if(e){if(e[7]!==n){const o=+e[7];t=e[8]?mf(o):Fl(o*255,0,255)}return n=+e[1],i=+e[3],s=+e[5],n=255&(e[2]?mf(n):Fl(n,0,255)),i=255&(e[4]?mf(i):Fl(i,0,255)),s=255&(e[6]?mf(s):Fl(s,0,255)),{r:n,g:i,b:s,a:t}}}function NV(r){return r&&(r.a<255?`rgba(${r.r}, ${r.g}, ${r.b}, ${va(r.a)})`:`rgb(${r.r}, ${r.g}, ${r.b})`)}const e1=r=>r<=.0031308?r*12.92:Math.pow(r,1/2.4)*1.055-.055,sd=r=>r<=.04045?r/12.92:Math.pow((r+.055)/1.055,2.4);function IV(r,e,t){const n=sd(va(r.r)),i=sd(va(r.g)),s=sd(va(r.b));return{r:Gl(e1(n+t*(sd(va(e.r))-n))),g:Gl(e1(i+t*(sd(va(e.g))-i))),b:Gl(e1(s+t*(sd(va(e.b))-s))),a:r.a+t*(e.a-r.a)}}function qp(r,e,t){if(r){let n=R2(r);n[e]=Math.max(0,Math.min(n[e]+n[e]*t,e===0?360:1)),n=O2(n),r.r=n[0],r.g=n[1],r.b=n[2]}}function I3(r,e){return r&&Object.assign(e||{},r)}function cA(r){var e={r:0,g:0,b:0,a:255};return Array.isArray(r)?r.length>=3&&(e={r:r[0],g:r[1],b:r[2],a:255},r.length>3&&(e.a=Gl(r[3]))):(e=I3(r,{r:0,g:0,b:0,a:1}),e.a=Gl(e.a)),e}function kV(r){return r.charAt(0)==="r"?AV(r):xV(r)}class rm{constructor(e){if(e instanceof rm)return e;const t=typeof e;let n;t==="object"?n=cA(e):t==="string"&&(n=dV(e)||SV(e)||kV(e)),this._rgb=n,this._valid=!!n}get valid(){return this._valid}get rgb(){var e=I3(this._rgb);return e&&(e.a=va(e.a)),e}set rgb(e){this._rgb=cA(e)}rgbString(){return this._valid?NV(this._rgb):void 0}hexString(){return this._valid?fV(this._rgb):void 0}hslString(){return this._valid?wV(this._rgb):void 0}mix(e,t){if(e){const n=this.rgb,i=e.rgb;let s;const o=t===s?.5:t,l=2*o-1,d=n.a-i.a,f=((l*d===-1?l:(l+d)/(1+l*d))+1)/2;s=1-f,n.r=255&f*n.r+s*i.r+.5,n.g=255&f*n.g+s*i.g+.5,n.b=255&f*n.b+s*i.b+.5,n.a=o*n.a+(1-o)*i.a,this.rgb=n}return this}interpolate(e,t){return e&&(this._rgb=IV(this._rgb,e._rgb,t)),this}clone(){return new rm(this.rgb)}alpha(e){return this._rgb.a=Gl(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=Pm(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return qp(this._rgb,2,e),this}darken(e){return qp(this._rgb,2,-e),this}saturate(e){return qp(this._rgb,1,e),this}desaturate(e){return qp(this._rgb,1,-e),this}rotate(e){return bV(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function fa(){}const PV=(()=>{let r=0;return()=>r++})();function on(r){return r==null}function hr(r){if(Array.isArray&&Array.isArray(r))return!0;const e=Object.prototype.toString.call(r);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function Xt(r){return r!==null&&Object.prototype.toString.call(r)==="[object Object]"}function Ds(r){return(typeof r=="number"||r instanceof Number)&&isFinite(+r)}function Ao(r,e){return Ds(r)?r:e}function Dt(r,e){return typeof r>"u"?e:r}const CV=(r,e)=>typeof r=="string"&&r.endsWith("%")?parseFloat(r)/100:+r/e,k3=(r,e)=>typeof r=="string"&&r.endsWith("%")?parseFloat(r)/100*e:+r;function kn(r,e,t){if(r&&typeof r.call=="function")return r.apply(t,e)}function hn(r,e,t,n){let i,s,o;if(hr(r))for(s=r.length,i=0;i<s;i++)e.call(t,r[i],i);else if(Xt(r))for(o=Object.keys(r),s=o.length,i=0;i<s;i++)e.call(t,r[o[i]],o[i])}function ay(r,e){let t,n,i,s;if(!r||!e||r.length!==e.length)return!1;for(t=0,n=r.length;t<n;++t)if(i=r[t],s=e[t],i.datasetIndex!==s.datasetIndex||i.index!==s.index)return!1;return!0}function ly(r){if(hr(r))return r.map(ly);if(Xt(r)){const e=Object.create(null),t=Object.keys(r),n=t.length;let i=0;for(;i<n;++i)e[t[i]]=ly(r[t[i]]);return e}return r}function P3(r){return["__proto__","prototype","constructor"].indexOf(r)===-1}function RV(r,e,t,n){if(!P3(r))return;const i=e[r],s=t[r];Xt(i)&&Xt(s)?im(i,s,n):e[r]=ly(s)}function im(r,e,t){const n=hr(e)?e:[e],i=n.length;if(!Xt(r))return r;t=t||{};const s=t.merger||RV;let o;for(let l=0;l<i;++l){if(o=n[l],!Xt(o))continue;const d=Object.keys(o);for(let f=0,m=d.length;f<m;++f)s(d[f],r,o,t)}return r}function Rf(r,e){return im(r,e,{merger:jV})}function jV(r,e,t){if(!P3(r))return;const n=e[r],i=t[r];Xt(n)&&Xt(i)?Rf(n,i):Object.prototype.hasOwnProperty.call(e,r)||(e[r]=ly(i))}const uA={"":r=>r,x:r=>r.x,y:r=>r.y};function OV(r){const e=r.split("."),t=[];let n="";for(const i of e)n+=i,n.endsWith("\\")?n=n.slice(0,-1)+".":(t.push(n),n="");return t}function MV(r){const e=OV(r);return t=>{for(const n of e){if(n==="")break;t=t&&t[n]}return t}}function gu(r,e){return(uA[e]||(uA[e]=MV(e)))(r)}function M2(r){return r.charAt(0).toUpperCase()+r.slice(1)}const sm=r=>typeof r<"u",sc=r=>typeof r=="function",dA=(r,e)=>{if(r.size!==e.size)return!1;for(const t of r)if(!e.has(t))return!1;return!0};function DV(r){return r.type==="mouseup"||r.type==="click"||r.type==="contextmenu"}const fn=Math.PI,$n=2*fn,LV=$n+fn,cy=Number.POSITIVE_INFINITY,FV=fn/180,mr=fn/2,Dc=fn/4,hA=fn*2/3,C3=Math.log10,Do=Math.sign;function jf(r,e,t){return Math.abs(r-e)<t}function fA(r){const e=Math.round(r);r=jf(r,e,r/1e3)?e:r;const t=Math.pow(10,Math.floor(C3(r))),n=r/t;return(n<=1?1:n<=2?2:n<=5?5:10)*t}function VV(r){const e=[],t=Math.sqrt(r);let n;for(n=1;n<t;n++)r%n===0&&(e.push(n),e.push(r/n));return t===(t|0)&&e.push(t),e.sort((i,s)=>i-s).pop(),e}function zV(r){return typeof r=="symbol"||typeof r=="object"&&r!==null&&!(Symbol.toPrimitive in r||"toString"in r||"valueOf"in r)}function om(r){return!zV(r)&&!isNaN(parseFloat(r))&&isFinite(r)}function BV(r,e){const t=Math.round(r);return t-e<=r&&t+e>=r}function UV(r,e,t){let n,i,s;for(n=0,i=r.length;n<i;n++)s=r[n][t],isNaN(s)||(e.min=Math.min(e.min,s),e.max=Math.max(e.max,s))}function Ea(r){return r*(fn/180)}function qV(r){return r*(180/fn)}function mA(r){if(!Ds(r))return;let e=1,t=0;for(;Math.round(r*e)/e!==r;)e*=10,t++;return t}function R3(r,e){const t=e.x-r.x,n=e.y-r.y,i=Math.sqrt(t*t+n*n);let s=Math.atan2(n,t);return s<-.5*fn&&(s+=$n),{angle:s,distance:i}}function Bx(r,e){return Math.sqrt(Math.pow(e.x-r.x,2)+Math.pow(e.y-r.y,2))}function HV(r,e){return(r-e+LV)%$n-fn}function so(r){return(r%$n+$n)%$n}function am(r,e,t,n){const i=so(r),s=so(e),o=so(t),l=so(s-i),d=so(o-i),f=so(i-s),m=so(i-o);return i===s||i===o||n&&s===o||l>d&&f<m}function Qr(r,e,t){return Math.max(e,Math.min(t,r))}function $V(r){return Qr(r,-32768,32767)}function Vl(r,e,t,n=1e-6){return r>=Math.min(e,t)-n&&r<=Math.max(e,t)+n}function D2(r,e,t){t=t||(o=>r[o]<e);let n=r.length-1,i=0,s;for(;n-i>1;)s=i+n>>1,t(s)?i=s:n=s;return{lo:i,hi:n}}const Zc=(r,e,t,n)=>D2(r,t,n?i=>{const s=r[i][e];return s<t||s===t&&r[i+1][e]===t}:i=>r[i][e]<t),WV=(r,e,t)=>D2(r,t,n=>r[n][e]>=t);function GV(r,e,t){let n=0,i=r.length;for(;n<i&&r[n]<e;)n++;for(;i>n&&r[i-1]>t;)i--;return n>0||i<r.length?r.slice(n,i):r}const j3=["push","pop","shift","splice","unshift"];function KV(r,e){if(r._chartjs){r._chartjs.listeners.push(e);return}Object.defineProperty(r,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),j3.forEach(t=>{const n="_onData"+M2(t),i=r[t];Object.defineProperty(r,t,{configurable:!0,enumerable:!1,value(...s){const o=i.apply(this,s);return r._chartjs.listeners.forEach(l=>{typeof l[n]=="function"&&l[n](...s)}),o}})})}function pA(r,e){const t=r._chartjs;if(!t)return;const n=t.listeners,i=n.indexOf(e);i!==-1&&n.splice(i,1),!(n.length>0)&&(j3.forEach(s=>{delete r[s]}),delete r._chartjs)}function O3(r){const e=new Set(r);return e.size===r.length?r:Array.from(e)}const M3=function(){return typeof window>"u"?function(r){return r()}:window.requestAnimationFrame}();function D3(r,e){let t=[],n=!1;return function(...i){t=i,n||(n=!0,M3.call(window,()=>{n=!1,r.apply(e,t)}))}}function YV(r,e){let t;return function(...n){return e?(clearTimeout(t),t=setTimeout(r,e,n)):r.apply(this,n),e}}const L2=r=>r==="start"?"left":r==="end"?"right":"center",Kr=(r,e,t)=>r==="start"?e:r==="end"?t:(e+t)/2,ZV=(r,e,t,n)=>r===(n?"left":"right")?t:r==="center"?(e+t)/2:e;function QV(r,e,t){const n=e.length;let i=0,s=n;if(r._sorted){const{iScale:o,vScale:l,_parsed:d}=r,f=r.dataset&&r.dataset.options?r.dataset.options.spanGaps:null,m=o.axis,{min:y,max:g,minDefined:_,maxDefined:E}=o.getUserBounds();if(_){if(i=Math.min(Zc(d,m,y).lo,t?n:Zc(e,m,o.getPixelForValue(y)).lo),f){const x=d.slice(0,i+1).reverse().findIndex(b=>!on(b[l.axis]));i-=Math.max(0,x)}i=Qr(i,0,n-1)}if(E){let x=Math.max(Zc(d,o.axis,g,!0).hi+1,t?0:Zc(e,m,o.getPixelForValue(g),!0).hi+1);if(f){const b=d.slice(x-1).findIndex(T=>!on(T[l.axis]));x+=Math.max(0,b)}s=Qr(x,i,n)-i}else s=n-i}return{start:i,count:s}}function XV(r){const{xScale:e,yScale:t,_scaleRanges:n}=r,i={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!n)return r._scaleRanges=i,!0;const s=n.xmin!==e.min||n.xmax!==e.max||n.ymin!==t.min||n.ymax!==t.max;return Object.assign(n,i),s}const Hp=r=>r===0||r===1,gA=(r,e,t)=>-(Math.pow(2,10*(r-=1))*Math.sin((r-e)*$n/t)),yA=(r,e,t)=>Math.pow(2,-10*r)*Math.sin((r-e)*$n/t)+1,Of={linear:r=>r,easeInQuad:r=>r*r,easeOutQuad:r=>-r*(r-2),easeInOutQuad:r=>(r/=.5)<1?.5*r*r:-.5*(--r*(r-2)-1),easeInCubic:r=>r*r*r,easeOutCubic:r=>(r-=1)*r*r+1,easeInOutCubic:r=>(r/=.5)<1?.5*r*r*r:.5*((r-=2)*r*r+2),easeInQuart:r=>r*r*r*r,easeOutQuart:r=>-((r-=1)*r*r*r-1),easeInOutQuart:r=>(r/=.5)<1?.5*r*r*r*r:-.5*((r-=2)*r*r*r-2),easeInQuint:r=>r*r*r*r*r,easeOutQuint:r=>(r-=1)*r*r*r*r+1,easeInOutQuint:r=>(r/=.5)<1?.5*r*r*r*r*r:.5*((r-=2)*r*r*r*r+2),easeInSine:r=>-Math.cos(r*mr)+1,easeOutSine:r=>Math.sin(r*mr),easeInOutSine:r=>-.5*(Math.cos(fn*r)-1),easeInExpo:r=>r===0?0:Math.pow(2,10*(r-1)),easeOutExpo:r=>r===1?1:-Math.pow(2,-10*r)+1,easeInOutExpo:r=>Hp(r)?r:r<.5?.5*Math.pow(2,10*(r*2-1)):.5*(-Math.pow(2,-10*(r*2-1))+2),easeInCirc:r=>r>=1?r:-(Math.sqrt(1-r*r)-1),easeOutCirc:r=>Math.sqrt(1-(r-=1)*r),easeInOutCirc:r=>(r/=.5)<1?-.5*(Math.sqrt(1-r*r)-1):.5*(Math.sqrt(1-(r-=2)*r)+1),easeInElastic:r=>Hp(r)?r:gA(r,.075,.3),easeOutElastic:r=>Hp(r)?r:yA(r,.075,.3),easeInOutElastic(r){return Hp(r)?r:r<.5?.5*gA(r*2,.1125,.45):.5+.5*yA(r*2-1,.1125,.45)},easeInBack(r){return r*r*((1.70158+1)*r-1.70158)},easeOutBack(r){return(r-=1)*r*((1.70158+1)*r+1.70158)+1},easeInOutBack(r){let e=1.70158;return(r/=.5)<1?.5*(r*r*(((e*=1.525)+1)*r-e)):.5*((r-=2)*r*(((e*=1.525)+1)*r+e)+2)},easeInBounce:r=>1-Of.easeOutBounce(1-r),easeOutBounce(r){return r<1/2.75?7.5625*r*r:r<2/2.75?7.5625*(r-=1.5/2.75)*r+.75:r<2.5/2.75?7.5625*(r-=2.25/2.75)*r+.9375:7.5625*(r-=2.625/2.75)*r+.984375},easeInOutBounce:r=>r<.5?Of.easeInBounce(r*2)*.5:Of.easeOutBounce(r*2-1)*.5+.5};function F2(r){if(r&&typeof r=="object"){const e=r.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function vA(r){return F2(r)?r:new rm(r)}function t1(r){return F2(r)?r:new rm(r).saturate(.5).darken(.1).hexString()}const JV=["x","y","borderWidth","radius","tension"],ez=["color","borderColor","backgroundColor"];function tz(r){r.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),r.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),r.set("animations",{colors:{type:"color",properties:ez},numbers:{type:"number",properties:JV}}),r.describe("animations",{_fallback:"animation"}),r.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function nz(r){r.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const _A=new Map;function rz(r,e){e=e||{};const t=r+JSON.stringify(e);let n=_A.get(t);return n||(n=new Intl.NumberFormat(r,e),_A.set(t,n)),n}function V2(r,e,t){return rz(e,t).format(r)}const iz={values(r){return hr(r)?r:""+r},numeric(r,e,t){if(r===0)return"0";const n=this.chart.options.locale;let i,s=r;if(t.length>1){const f=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(f<1e-4||f>1e15)&&(i="scientific"),s=sz(r,t)}const o=C3(Math.abs(s)),l=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),d={notation:i,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(d,this.options.ticks.format),V2(r,n,d)}};function sz(r,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&r!==Math.floor(r)&&(t=r-Math.floor(r)),t}var L3={formatters:iz};function oz(r){r.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:L3.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),r.route("scale.ticks","color","","color"),r.route("scale.grid","color","","borderColor"),r.route("scale.border","color","","borderColor"),r.route("scale.title","color","","color"),r.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),r.describe("scales",{_fallback:"scale"}),r.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const yu=Object.create(null),Ux=Object.create(null);function Mf(r,e){if(!e)return r;const t=e.split(".");for(let n=0,i=t.length;n<i;++n){const s=t[n];r=r[s]||(r[s]=Object.create(null))}return r}function n1(r,e,t){return typeof e=="string"?im(Mf(r,e),t):im(Mf(r,""),e)}class az{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=n=>n.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(n,i)=>t1(i.backgroundColor),this.hoverBorderColor=(n,i)=>t1(i.borderColor),this.hoverColor=(n,i)=>t1(i.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return n1(this,e,t)}get(e){return Mf(this,e)}describe(e,t){return n1(Ux,e,t)}override(e,t){return n1(yu,e,t)}route(e,t,n,i){const s=Mf(this,e),o=Mf(this,n),l="_"+t;Object.defineProperties(s,{[l]:{value:s[t],writable:!0},[t]:{enumerable:!0,get(){const d=this[l],f=o[i];return Xt(d)?Object.assign({},f,d):Dt(d,f)},set(d){this[l]=d}}})}apply(e){e.forEach(t=>t(this))}}var Qn=new az({_scriptable:r=>!r.startsWith("on"),_indexable:r=>r!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[tz,nz,oz]);function lz(r){return!r||on(r.size)||on(r.family)?null:(r.style?r.style+" ":"")+(r.weight?r.weight+" ":"")+r.size+"px "+r.family}function xA(r,e,t,n,i){let s=e[i];return s||(s=e[i]=r.measureText(i).width,t.push(i)),s>n&&(n=s),n}function Lc(r,e,t){const n=r.currentDevicePixelRatio,i=t!==0?Math.max(t/2,.5):0;return Math.round((e-i)*n)/n+i}function bA(r,e){!e&&!r||(e=e||r.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,r.width,r.height),e.restore())}function qx(r,e,t,n){F3(r,e,t,n,null)}function F3(r,e,t,n,i){let s,o,l,d,f,m,y,g;const _=e.pointStyle,E=e.rotation,x=e.radius;let b=(E||0)*FV;if(_&&typeof _=="object"&&(s=_.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){r.save(),r.translate(t,n),r.rotate(b),r.drawImage(_,-_.width/2,-_.height/2,_.width,_.height),r.restore();return}if(!(isNaN(x)||x<=0)){switch(r.beginPath(),_){default:i?r.ellipse(t,n,i/2,x,0,0,$n):r.arc(t,n,x,0,$n),r.closePath();break;case"triangle":m=i?i/2:x,r.moveTo(t+Math.sin(b)*m,n-Math.cos(b)*x),b+=hA,r.lineTo(t+Math.sin(b)*m,n-Math.cos(b)*x),b+=hA,r.lineTo(t+Math.sin(b)*m,n-Math.cos(b)*x),r.closePath();break;case"rectRounded":f=x*.516,d=x-f,o=Math.cos(b+Dc)*d,y=Math.cos(b+Dc)*(i?i/2-f:d),l=Math.sin(b+Dc)*d,g=Math.sin(b+Dc)*(i?i/2-f:d),r.arc(t-y,n-l,f,b-fn,b-mr),r.arc(t+g,n-o,f,b-mr,b),r.arc(t+y,n+l,f,b,b+mr),r.arc(t-g,n+o,f,b+mr,b+fn),r.closePath();break;case"rect":if(!E){d=Math.SQRT1_2*x,m=i?i/2:d,r.rect(t-m,n-d,2*m,2*d);break}b+=Dc;case"rectRot":y=Math.cos(b)*(i?i/2:x),o=Math.cos(b)*x,l=Math.sin(b)*x,g=Math.sin(b)*(i?i/2:x),r.moveTo(t-y,n-l),r.lineTo(t+g,n-o),r.lineTo(t+y,n+l),r.lineTo(t-g,n+o),r.closePath();break;case"crossRot":b+=Dc;case"cross":y=Math.cos(b)*(i?i/2:x),o=Math.cos(b)*x,l=Math.sin(b)*x,g=Math.sin(b)*(i?i/2:x),r.moveTo(t-y,n-l),r.lineTo(t+y,n+l),r.moveTo(t+g,n-o),r.lineTo(t-g,n+o);break;case"star":y=Math.cos(b)*(i?i/2:x),o=Math.cos(b)*x,l=Math.sin(b)*x,g=Math.sin(b)*(i?i/2:x),r.moveTo(t-y,n-l),r.lineTo(t+y,n+l),r.moveTo(t+g,n-o),r.lineTo(t-g,n+o),b+=Dc,y=Math.cos(b)*(i?i/2:x),o=Math.cos(b)*x,l=Math.sin(b)*x,g=Math.sin(b)*(i?i/2:x),r.moveTo(t-y,n-l),r.lineTo(t+y,n+l),r.moveTo(t+g,n-o),r.lineTo(t-g,n+o);break;case"line":o=i?i/2:Math.cos(b)*x,l=Math.sin(b)*x,r.moveTo(t-o,n-l),r.lineTo(t+o,n+l);break;case"dash":r.moveTo(t,n),r.lineTo(t+Math.cos(b)*(i?i/2:x),n+Math.sin(b)*x);break;case!1:r.closePath();break}r.fill(),e.borderWidth>0&&r.stroke()}}function lm(r,e,t){return t=t||.5,!e||r&&r.x>e.left-t&&r.x<e.right+t&&r.y>e.top-t&&r.y<e.bottom+t}function z2(r,e){r.save(),r.beginPath(),r.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),r.clip()}function B2(r){r.restore()}function cz(r,e,t,n,i){if(!e)return r.lineTo(t.x,t.y);if(i==="middle"){const s=(e.x+t.x)/2;r.lineTo(s,e.y),r.lineTo(s,t.y)}else i==="after"!=!!n?r.lineTo(e.x,t.y):r.lineTo(t.x,e.y);r.lineTo(t.x,t.y)}function uz(r,e,t,n){if(!e)return r.lineTo(t.x,t.y);r.bezierCurveTo(n?e.cp1x:e.cp2x,n?e.cp1y:e.cp2y,n?t.cp2x:t.cp1x,n?t.cp2y:t.cp1y,t.x,t.y)}function dz(r,e){e.translation&&r.translate(e.translation[0],e.translation[1]),on(e.rotation)||r.rotate(e.rotation),e.color&&(r.fillStyle=e.color),e.textAlign&&(r.textAlign=e.textAlign),e.textBaseline&&(r.textBaseline=e.textBaseline)}function hz(r,e,t,n,i){if(i.strikethrough||i.underline){const s=r.measureText(n),o=e-s.actualBoundingBoxLeft,l=e+s.actualBoundingBoxRight,d=t-s.actualBoundingBoxAscent,f=t+s.actualBoundingBoxDescent,m=i.strikethrough?(d+f)/2:f;r.strokeStyle=r.fillStyle,r.beginPath(),r.lineWidth=i.decorationWidth||2,r.moveTo(o,m),r.lineTo(l,m),r.stroke()}}function fz(r,e){const t=r.fillStyle;r.fillStyle=e.color,r.fillRect(e.left,e.top,e.width,e.height),r.fillStyle=t}function cm(r,e,t,n,i,s={}){const o=hr(e)?e:[e],l=s.strokeWidth>0&&s.strokeColor!=="";let d,f;for(r.save(),r.font=i.string,dz(r,s),d=0;d<o.length;++d)f=o[d],s.backdrop&&fz(r,s.backdrop),l&&(s.strokeColor&&(r.strokeStyle=s.strokeColor),on(s.strokeWidth)||(r.lineWidth=s.strokeWidth),r.strokeText(f,t,n,s.maxWidth)),r.fillText(f,t,n,s.maxWidth),hz(r,t,n,f,s),n+=Number(i.lineHeight);r.restore()}function uy(r,e){const{x:t,y:n,w:i,h:s,radius:o}=e;r.arc(t+o.topLeft,n+o.topLeft,o.topLeft,1.5*fn,fn,!0),r.lineTo(t,n+s-o.bottomLeft),r.arc(t+o.bottomLeft,n+s-o.bottomLeft,o.bottomLeft,fn,mr,!0),r.lineTo(t+i-o.bottomRight,n+s),r.arc(t+i-o.bottomRight,n+s-o.bottomRight,o.bottomRight,mr,0,!0),r.lineTo(t+i,n+o.topRight),r.arc(t+i-o.topRight,n+o.topRight,o.topRight,0,-mr,!0),r.lineTo(t+o.topLeft,n)}const mz=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,pz=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function gz(r,e){const t=(""+r).match(mz);if(!t||t[1]==="normal")return e*1.2;switch(r=+t[2],t[3]){case"px":return r;case"%":r/=100;break}return e*r}const yz=r=>+r||0;function U2(r,e){const t={},n=Xt(e),i=n?Object.keys(e):e,s=Xt(r)?n?o=>Dt(r[o],r[e[o]]):o=>r[o]:()=>r;for(const o of i)t[o]=yz(s(o));return t}function V3(r){return U2(r,{top:"y",right:"x",bottom:"y",left:"x"})}function wd(r){return U2(r,["topLeft","topRight","bottomLeft","bottomRight"])}function Ls(r){const e=V3(r);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Xr(r,e){r=r||{},e=e||Qn.font;let t=Dt(r.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let n=Dt(r.style,e.style);n&&!(""+n).match(pz)&&(console.warn('Invalid font style specified: "'+n+'"'),n=void 0);const i={family:Dt(r.family,e.family),lineHeight:gz(Dt(r.lineHeight,e.lineHeight),t),size:t,style:n,weight:Dt(r.weight,e.weight),string:""};return i.string=lz(i),i}function $p(r,e,t,n){let i,s,o;for(i=0,s=r.length;i<s;++i)if(o=r[i],o!==void 0&&o!==void 0)return o}function vz(r,e,t){const{min:n,max:i}=r,s=k3(e,(i-n)/2),o=(l,d)=>t&&l===0?0:l+d;return{min:o(n,-Math.abs(s)),max:o(i,s)}}function wu(r,e){return Object.assign(Object.create(r),e)}function q2(r,e=[""],t,n,i=()=>r[0]){const s=t||r;typeof n>"u"&&(n=q3("_fallback",r));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:r,_rootScopes:s,_fallback:n,_getTarget:i,override:l=>q2([l,...r],e,s,n)};return new Proxy(o,{deleteProperty(l,d){return delete l[d],delete l._keys,delete r[0][d],!0},get(l,d){return B3(l,d,()=>Az(d,e,r,l))},getOwnPropertyDescriptor(l,d){return Reflect.getOwnPropertyDescriptor(l._scopes[0],d)},getPrototypeOf(){return Reflect.getPrototypeOf(r[0])},has(l,d){return EA(l).includes(d)},ownKeys(l){return EA(l)},set(l,d,f){const m=l._storage||(l._storage=i());return l[d]=m[d]=f,delete l._keys,!0}})}function qd(r,e,t,n){const i={_cacheable:!1,_proxy:r,_context:e,_subProxy:t,_stack:new Set,_descriptors:z3(r,n),setContext:s=>qd(r,s,t,n),override:s=>qd(r.override(s),e,t,n)};return new Proxy(i,{deleteProperty(s,o){return delete s[o],delete r[o],!0},get(s,o,l){return B3(s,o,()=>xz(s,o,l))},getOwnPropertyDescriptor(s,o){return s._descriptors.allKeys?Reflect.has(r,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(r,o)},getPrototypeOf(){return Reflect.getPrototypeOf(r)},has(s,o){return Reflect.has(r,o)},ownKeys(){return Reflect.ownKeys(r)},set(s,o,l){return r[o]=l,delete s[o],!0}})}function z3(r,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:n=e.indexable,_allKeys:i=e.allKeys}=r;return{allKeys:i,scriptable:t,indexable:n,isScriptable:sc(t)?t:()=>t,isIndexable:sc(n)?n:()=>n}}const _z=(r,e)=>r?r+M2(e):e,H2=(r,e)=>Xt(e)&&r!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function B3(r,e,t){if(Object.prototype.hasOwnProperty.call(r,e)||e==="constructor")return r[e];const n=t();return r[e]=n,n}function xz(r,e,t){const{_proxy:n,_context:i,_subProxy:s,_descriptors:o}=r;let l=n[e];return sc(l)&&o.isScriptable(e)&&(l=bz(e,l,r,t)),hr(l)&&l.length&&(l=wz(e,l,r,o.isIndexable)),H2(e,l)&&(l=qd(l,i,s&&s[e],o)),l}function bz(r,e,t,n){const{_proxy:i,_context:s,_subProxy:o,_stack:l}=t;if(l.has(r))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+r);l.add(r);let d=e(s,o||n);return l.delete(r),H2(r,d)&&(d=$2(i._scopes,i,r,d)),d}function wz(r,e,t,n){const{_proxy:i,_context:s,_subProxy:o,_descriptors:l}=t;if(typeof s.index<"u"&&n(r))return e[s.index%e.length];if(Xt(e[0])){const d=e,f=i._scopes.filter(m=>m!==d);e=[];for(const m of d){const y=$2(f,i,r,m);e.push(qd(y,s,o&&o[r],l))}}return e}function U3(r,e,t){return sc(r)?r(e,t):r}const Ez=(r,e)=>r===!0?e:typeof r=="string"?gu(e,r):void 0;function Sz(r,e,t,n,i){for(const s of e){const o=Ez(t,s);if(o){r.add(o);const l=U3(o._fallback,t,i);if(typeof l<"u"&&l!==t&&l!==n)return l}else if(o===!1&&typeof n<"u"&&t!==n)return null}return!1}function $2(r,e,t,n){const i=e._rootScopes,s=U3(e._fallback,t,n),o=[...r,...i],l=new Set;l.add(n);let d=wA(l,o,t,s||t,n);return d===null||typeof s<"u"&&s!==t&&(d=wA(l,o,s,d,n),d===null)?!1:q2(Array.from(l),[""],i,s,()=>Tz(e,t,n))}function wA(r,e,t,n,i){for(;t;)t=Sz(r,e,t,n,i);return t}function Tz(r,e,t){const n=r._getTarget();e in n||(n[e]={});const i=n[e];return hr(i)&&Xt(t)?t:i||{}}function Az(r,e,t,n){let i;for(const s of e)if(i=q3(_z(s,r),t),typeof i<"u")return H2(r,i)?$2(t,n,r,i):i}function q3(r,e){for(const t of e){if(!t)continue;const n=t[r];if(typeof n<"u")return n}}function EA(r){let e=r._keys;return e||(e=r._keys=Nz(r._scopes)),e}function Nz(r){const e=new Set;for(const t of r)for(const n of Object.keys(t).filter(i=>!i.startsWith("_")))e.add(n);return Array.from(e)}const Iz=Number.EPSILON||1e-14,Hd=(r,e)=>e<r.length&&!r[e].skip&&r[e],H3=r=>r==="x"?"y":"x";function kz(r,e,t,n){const i=r.skip?e:r,s=e,o=t.skip?e:t,l=Bx(s,i),d=Bx(o,s);let f=l/(l+d),m=d/(l+d);f=isNaN(f)?0:f,m=isNaN(m)?0:m;const y=n*f,g=n*m;return{previous:{x:s.x-y*(o.x-i.x),y:s.y-y*(o.y-i.y)},next:{x:s.x+g*(o.x-i.x),y:s.y+g*(o.y-i.y)}}}function Pz(r,e,t){const n=r.length;let i,s,o,l,d,f=Hd(r,0);for(let m=0;m<n-1;++m)if(d=f,f=Hd(r,m+1),!(!d||!f)){if(jf(e[m],0,Iz)){t[m]=t[m+1]=0;continue}i=t[m]/e[m],s=t[m+1]/e[m],l=Math.pow(i,2)+Math.pow(s,2),!(l<=9)&&(o=3/Math.sqrt(l),t[m]=i*o*e[m],t[m+1]=s*o*e[m])}}function Cz(r,e,t="x"){const n=H3(t),i=r.length;let s,o,l,d=Hd(r,0);for(let f=0;f<i;++f){if(o=l,l=d,d=Hd(r,f+1),!l)continue;const m=l[t],y=l[n];o&&(s=(m-o[t])/3,l[`cp1${t}`]=m-s,l[`cp1${n}`]=y-s*e[f]),d&&(s=(d[t]-m)/3,l[`cp2${t}`]=m+s,l[`cp2${n}`]=y+s*e[f])}}function Rz(r,e="x"){const t=H3(e),n=r.length,i=Array(n).fill(0),s=Array(n);let o,l,d,f=Hd(r,0);for(o=0;o<n;++o)if(l=d,d=f,f=Hd(r,o+1),!!d){if(f){const m=f[e]-d[e];i[o]=m!==0?(f[t]-d[t])/m:0}s[o]=l?f?Do(i[o-1])!==Do(i[o])?0:(i[o-1]+i[o])/2:i[o-1]:i[o]}Pz(r,i,s),Cz(r,s,e)}function Wp(r,e,t){return Math.max(Math.min(r,t),e)}function jz(r,e){let t,n,i,s,o,l=lm(r[0],e);for(t=0,n=r.length;t<n;++t)o=s,s=l,l=t<n-1&&lm(r[t+1],e),s&&(i=r[t],o&&(i.cp1x=Wp(i.cp1x,e.left,e.right),i.cp1y=Wp(i.cp1y,e.top,e.bottom)),l&&(i.cp2x=Wp(i.cp2x,e.left,e.right),i.cp2y=Wp(i.cp2y,e.top,e.bottom)))}function Oz(r,e,t,n,i){let s,o,l,d;if(e.spanGaps&&(r=r.filter(f=>!f.skip)),e.cubicInterpolationMode==="monotone")Rz(r,i);else{let f=n?r[r.length-1]:r[0];for(s=0,o=r.length;s<o;++s)l=r[s],d=kz(f,l,r[Math.min(s+1,o-(n?0:1))%o],e.tension),l.cp1x=d.previous.x,l.cp1y=d.previous.y,l.cp2x=d.next.x,l.cp2y=d.next.y,f=l}e.capBezierPoints&&jz(r,t)}function W2(){return typeof window<"u"&&typeof document<"u"}function G2(r){let e=r.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function dy(r,e,t){let n;return typeof r=="string"?(n=parseInt(r,10),r.indexOf("%")!==-1&&(n=n/100*e.parentNode[t])):n=r,n}const s0=r=>r.ownerDocument.defaultView.getComputedStyle(r,null);function Mz(r,e){return s0(r).getPropertyValue(e)}const Dz=["top","right","bottom","left"];function eu(r,e,t){const n={};t=t?"-"+t:"";for(let i=0;i<4;i++){const s=Dz[i];n[s]=parseFloat(r[e+"-"+s+t])||0}return n.width=n.left+n.right,n.height=n.top+n.bottom,n}const Lz=(r,e,t)=>(r>0||e>0)&&(!t||!t.shadowRoot);function Fz(r,e){const t=r.touches,n=t&&t.length?t[0]:r,{offsetX:i,offsetY:s}=n;let o=!1,l,d;if(Lz(i,s,r.target))l=i,d=s;else{const f=e.getBoundingClientRect();l=n.clientX-f.left,d=n.clientY-f.top,o=!0}return{x:l,y:d,box:o}}function Uc(r,e){if("native"in r)return r;const{canvas:t,currentDevicePixelRatio:n}=e,i=s0(t),s=i.boxSizing==="border-box",o=eu(i,"padding"),l=eu(i,"border","width"),{x:d,y:f,box:m}=Fz(r,t),y=o.left+(m&&l.left),g=o.top+(m&&l.top);let{width:_,height:E}=e;return s&&(_-=o.width+l.width,E-=o.height+l.height),{x:Math.round((d-y)/_*t.width/n),y:Math.round((f-g)/E*t.height/n)}}function Vz(r,e,t){let n,i;if(e===void 0||t===void 0){const s=r&&G2(r);if(!s)e=r.clientWidth,t=r.clientHeight;else{const o=s.getBoundingClientRect(),l=s0(s),d=eu(l,"border","width"),f=eu(l,"padding");e=o.width-f.width-d.width,t=o.height-f.height-d.height,n=dy(l.maxWidth,s,"clientWidth"),i=dy(l.maxHeight,s,"clientHeight")}}return{width:e,height:t,maxWidth:n||cy,maxHeight:i||cy}}const zl=r=>Math.round(r*10)/10;function zz(r,e,t,n){const i=s0(r),s=eu(i,"margin"),o=dy(i.maxWidth,r,"clientWidth")||cy,l=dy(i.maxHeight,r,"clientHeight")||cy,d=Vz(r,e,t);let{width:f,height:m}=d;if(i.boxSizing==="content-box"){const g=eu(i,"border","width"),_=eu(i,"padding");f-=_.width+g.width,m-=_.height+g.height}return f=Math.max(0,f-s.width),m=Math.max(0,n?f/n:m-s.height),f=zl(Math.min(f,o,d.maxWidth)),m=zl(Math.min(m,l,d.maxHeight)),f&&!m&&(m=zl(f/2)),(e!==void 0||t!==void 0)&&n&&d.height&&m>d.height&&(m=d.height,f=zl(Math.floor(m*n))),{width:f,height:m}}function SA(r,e,t){const n=e||1,i=zl(r.height*n),s=zl(r.width*n);r.height=zl(r.height),r.width=zl(r.width);const o=r.canvas;return o.style&&(t||!o.style.height&&!o.style.width)&&(o.style.height=`${r.height}px`,o.style.width=`${r.width}px`),r.currentDevicePixelRatio!==n||o.height!==i||o.width!==s?(r.currentDevicePixelRatio=n,o.height=i,o.width=s,r.ctx.setTransform(n,0,0,n,0,0),!0):!1}const Bz=function(){let r=!1;try{const e={get passive(){return r=!0,!1}};W2()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return r}();function TA(r,e){const t=Mz(r,e),n=t&&t.match(/^(\d+)(\.\d+)?px$/);return n?+n[1]:void 0}function qc(r,e,t,n){return{x:r.x+t*(e.x-r.x),y:r.y+t*(e.y-r.y)}}function Uz(r,e,t,n){return{x:r.x+t*(e.x-r.x),y:n==="middle"?t<.5?r.y:e.y:n==="after"?t<1?r.y:e.y:t>0?e.y:r.y}}function qz(r,e,t,n){const i={x:r.cp2x,y:r.cp2y},s={x:e.cp1x,y:e.cp1y},o=qc(r,i,t),l=qc(i,s,t),d=qc(s,e,t),f=qc(o,l,t),m=qc(l,d,t);return qc(f,m,t)}const Hz=function(r,e){return{x(t){return r+r+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,n){return t-n},leftForLtr(t,n){return t-n}}},$z=function(){return{x(r){return r},setWidth(r){},textAlign(r){return r},xPlus(r,e){return r+e},leftForLtr(r,e){return r}}};function Ed(r,e,t){return r?Hz(e,t):$z()}function $3(r,e){let t,n;(e==="ltr"||e==="rtl")&&(t=r.canvas.style,n=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),r.prevTextDirection=n)}function W3(r,e){e!==void 0&&(delete r.prevTextDirection,r.canvas.style.setProperty("direction",e[0],e[1]))}function G3(r){return r==="angle"?{between:am,compare:HV,normalize:so}:{between:Vl,compare:(e,t)=>e-t,normalize:e=>e}}function AA({start:r,end:e,count:t,loop:n,style:i}){return{start:r%t,end:e%t,loop:n&&(e-r+1)%t===0,style:i}}function Wz(r,e,t){const{property:n,start:i,end:s}=t,{between:o,normalize:l}=G3(n),d=e.length;let{start:f,end:m,loop:y}=r,g,_;if(y){for(f+=d,m+=d,g=0,_=d;g<_&&o(l(e[f%d][n]),i,s);++g)f--,m--;f%=d,m%=d}return m<f&&(m+=d),{start:f,end:m,loop:y,style:r.style}}function Gz(r,e,t){if(!t)return[r];const{property:n,start:i,end:s}=t,o=e.length,{compare:l,between:d,normalize:f}=G3(n),{start:m,end:y,loop:g,style:_}=Wz(r,e,t),E=[];let x=!1,b=null,T,N,R;const I=()=>d(i,R,T)&&l(i,R)!==0,j=()=>l(s,T)===0||d(s,R,T),U=()=>x||I(),C=()=>!x||j();for(let k=m,D=m;k<=y;++k)N=e[k%o],!N.skip&&(T=f(N[n]),T!==R&&(x=d(T,i,s),b===null&&U()&&(b=l(T,i)===0?k:D),b!==null&&C()&&(E.push(AA({start:b,end:k,loop:g,count:o,style:_})),b=null),D=k,R=T));return b!==null&&E.push(AA({start:b,end:y,loop:g,count:o,style:_})),E}function Kz(r,e){const t=[],n=r.segments;for(let i=0;i<n.length;i++){const s=Gz(n[i],r.points,e);s.length&&t.push(...s)}return t}function Yz(r,e,t,n){let i=0,s=e-1;if(t&&!n)for(;i<e&&!r[i].skip;)i++;for(;i<e&&r[i].skip;)i++;for(i%=e,t&&(s+=i);s>i&&r[s%e].skip;)s--;return s%=e,{start:i,end:s}}function Zz(r,e,t,n){const i=r.length,s=[];let o=e,l=r[e],d;for(d=e+1;d<=t;++d){const f=r[d%i];f.skip||f.stop?l.skip||(n=!1,s.push({start:e%i,end:(d-1)%i,loop:n}),e=o=f.stop?d:null):(o=d,l.skip&&(e=d)),l=f}return o!==null&&s.push({start:e%i,end:o%i,loop:n}),s}function Qz(r,e){const t=r.points,n=r.options.spanGaps,i=t.length;if(!i)return[];const s=!!r._loop,{start:o,end:l}=Yz(t,i,s,n);if(n===!0)return NA(r,[{start:o,end:l,loop:s}],t,e);const d=l<o?l+i:l,f=!!r._fullLoop&&o===0&&l===i-1;return NA(r,Zz(t,o,d,f),t,e)}function NA(r,e,t,n){return!n||!n.setContext||!t?e:Xz(r,e,t,n)}function Xz(r,e,t,n){const i=r._chart.getContext(),s=IA(r.options),{_datasetIndex:o,options:{spanGaps:l}}=r,d=t.length,f=[];let m=s,y=e[0].start,g=y;function _(E,x,b,T){const N=l?-1:1;if(E!==x){for(E+=d;t[E%d].skip;)E-=N;for(;t[x%d].skip;)x+=N;E%d!==x%d&&(f.push({start:E%d,end:x%d,loop:b,style:T}),m=T,y=x%d)}}for(const E of e){y=l?y:E.start;let x=t[y%d],b;for(g=y+1;g<=E.end;g++){const T=t[g%d];b=IA(n.setContext(wu(i,{type:"segment",p0:x,p1:T,p0DataIndex:(g-1)%d,p1DataIndex:g%d,datasetIndex:o}))),Jz(b,m)&&_(y,g-1,E.loop,m),x=T,m=b}y<g-1&&_(y,g-1,E.loop,m)}return f}function IA(r){return{backgroundColor:r.backgroundColor,borderCapStyle:r.borderCapStyle,borderDash:r.borderDash,borderDashOffset:r.borderDashOffset,borderJoinStyle:r.borderJoinStyle,borderWidth:r.borderWidth,borderColor:r.borderColor}}function Jz(r,e){if(!e)return!1;const t=[],n=function(i,s){return F2(s)?(t.includes(s)||t.push(s),t.indexOf(s)):s};return JSON.stringify(r,n)!==JSON.stringify(e,n)}function Gp(r,e,t){return r.options.clip?r[t]:e[t]}function eB(r,e){const{xScale:t,yScale:n}=r;return t&&n?{left:Gp(t,e,"left"),right:Gp(t,e,"right"),top:Gp(n,e,"top"),bottom:Gp(n,e,"bottom")}:e}function tB(r,e){const t=e._clip;if(t.disabled)return!1;const n=eB(e,r.chartArea);return{left:t.left===!1?0:n.left-(t.left===!0?0:t.left),right:t.right===!1?r.width:n.right+(t.right===!0?0:t.right),top:t.top===!1?0:n.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?r.height:n.bottom+(t.bottom===!0?0:t.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class nB{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,n,i){const s=t.listeners[i],o=t.duration;s.forEach(l=>l({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(n-t.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=M3.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((n,i)=>{if(!n.running||!n.items.length)return;const s=n.items;let o=s.length-1,l=!1,d;for(;o>=0;--o)d=s[o],d._active?(d._total>n.duration&&(n.duration=d._total),d.tick(e),l=!0):(s[o]=s[s.length-1],s.pop());l&&(i.draw(),this._notify(i,n,e,"progress")),s.length||(n.running=!1,this._notify(i,n,e,"complete"),n.initial=!1),t+=s.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let n=t.get(e);return n||(n={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,n)),n}listen(e,t,n){this._getAnims(e).listeners[t].push(n)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((n,i)=>Math.max(n,i._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const n=t.items;let i=n.length-1;for(;i>=0;--i)n[i].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var pa=new nB;const kA="transparent",rB={boolean(r,e,t){return t>.5?e:r},color(r,e,t){const n=vA(r||kA),i=n.valid&&vA(e||kA);return i&&i.valid?i.mix(n,t).hexString():e},number(r,e,t){return r+(e-r)*t}};class iB{constructor(e,t,n,i){const s=t[n];i=$p([e.to,i,s,e.from]);const o=$p([e.from,s,i]);this._active=!0,this._fn=e.fn||rB[e.type||typeof o],this._easing=Of[e.easing]||Of.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=n,this._from=o,this._to=i,this._promises=void 0}active(){return this._active}update(e,t,n){if(this._active){this._notify(!1);const i=this._target[this._prop],s=n-this._start,o=this._duration-s;this._start=n,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=s,this._loop=!!e.loop,this._to=$p([e.to,t,i,e.from]),this._from=$p([e.from,i,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,n=this._duration,i=this._prop,s=this._from,o=this._loop,l=this._to;let d;if(this._active=s!==l&&(o||t<n),!this._active){this._target[i]=l,this._notify(!0);return}if(t<0){this._target[i]=s;return}d=t/n%2,d=o&&d>1?2-d:d,d=this._easing(Math.min(1,Math.max(0,d))),this._target[i]=this._fn(s,l,d)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,n)=>{e.push({res:t,rej:n})})}_notify(e){const t=e?"res":"rej",n=this._promises||[];for(let i=0;i<n.length;i++)n[i][t]()}}class K3{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!Xt(e))return;const t=Object.keys(Qn.animation),n=this._properties;Object.getOwnPropertyNames(e).forEach(i=>{const s=e[i];if(!Xt(s))return;const o={};for(const l of t)o[l]=s[l];(hr(s.properties)&&s.properties||[i]).forEach(l=>{(l===i||!n.has(l))&&n.set(l,o)})})}_animateOptions(e,t){const n=t.options,i=oB(e,n);if(!i)return[];const s=this._createAnimations(i,n);return n.$shared&&sB(e.options.$animations,n).then(()=>{e.options=n},()=>{}),s}_createAnimations(e,t){const n=this._properties,i=[],s=e.$animations||(e.$animations={}),o=Object.keys(t),l=Date.now();let d;for(d=o.length-1;d>=0;--d){const f=o[d];if(f.charAt(0)==="$")continue;if(f==="options"){i.push(...this._animateOptions(e,t));continue}const m=t[f];let y=s[f];const g=n.get(f);if(y)if(g&&y.active()){y.update(g,m,l);continue}else y.cancel();if(!g||!g.duration){e[f]=m;continue}s[f]=y=new iB(g,e,f,m),i.push(y)}return i}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const n=this._createAnimations(e,t);if(n.length)return pa.add(this._chart,n),!0}}function sB(r,e){const t=[],n=Object.keys(e);for(let i=0;i<n.length;i++){const s=r[n[i]];s&&s.active()&&t.push(s.wait())}return Promise.all(t)}function oB(r,e){if(!e)return;let t=r.options;if(!t){r.options=e;return}return t.$shared&&(r.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function PA(r,e){const t=r&&r.options||{},n=t.reverse,i=t.min===void 0?e:0,s=t.max===void 0?e:0;return{start:n?s:i,end:n?i:s}}function aB(r,e,t){if(t===!1)return!1;const n=PA(r,t),i=PA(e,t);return{top:i.end,right:n.end,bottom:i.start,left:n.start}}function lB(r){let e,t,n,i;return Xt(r)?(e=r.top,t=r.right,n=r.bottom,i=r.left):e=t=n=i=r,{top:e,right:t,bottom:n,left:i,disabled:r===!1}}function Y3(r,e){const t=[],n=r._getSortedDatasetMetas(e);let i,s;for(i=0,s=n.length;i<s;++i)t.push(n[i].index);return t}function CA(r,e,t,n={}){const i=r.keys,s=n.mode==="single";let o,l,d,f;if(e===null)return;let m=!1;for(o=0,l=i.length;o<l;++o){if(d=+i[o],d===t){if(m=!0,n.all)continue;break}f=r.values[d],Ds(f)&&(s||e===0||Do(e)===Do(f))&&(e+=f)}return!m&&!n.all?0:e}function cB(r,e){const{iScale:t,vScale:n}=e,i=t.axis==="x"?"x":"y",s=n.axis==="x"?"x":"y",o=Object.keys(r),l=new Array(o.length);let d,f,m;for(d=0,f=o.length;d<f;++d)m=o[d],l[d]={[i]:m,[s]:r[m]};return l}function r1(r,e){const t=r&&r.options.stacked;return t||t===void 0&&e.stack!==void 0}function uB(r,e,t){return`${r.id}.${e.id}.${t.stack||t.type}`}function dB(r){const{min:e,max:t,minDefined:n,maxDefined:i}=r.getUserBounds();return{min:n?e:Number.NEGATIVE_INFINITY,max:i?t:Number.POSITIVE_INFINITY}}function hB(r,e,t){const n=r[e]||(r[e]={});return n[t]||(n[t]={})}function RA(r,e,t,n){for(const i of e.getMatchingVisibleMetas(n).reverse()){const s=r[i.index];if(t&&s>0||!t&&s<0)return i.index}return null}function jA(r,e){const{chart:t,_cachedMeta:n}=r,i=t._stacks||(t._stacks={}),{iScale:s,vScale:o,index:l}=n,d=s.axis,f=o.axis,m=uB(s,o,n),y=e.length;let g;for(let _=0;_<y;++_){const E=e[_],{[d]:x,[f]:b}=E,T=E._stacks||(E._stacks={});g=T[f]=hB(i,m,x),g[l]=b,g._top=RA(g,o,!0,n.type),g._bottom=RA(g,o,!1,n.type);const N=g._visualValues||(g._visualValues={});N[l]=b}}function i1(r,e){const t=r.scales;return Object.keys(t).filter(n=>t[n].axis===e).shift()}function fB(r,e){return wu(r,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function mB(r,e,t){return wu(r,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function Zh(r,e){const t=r.controller.index,n=r.vScale&&r.vScale.axis;if(n){e=e||r._parsed;for(const i of e){const s=i._stacks;if(!s||s[n]===void 0||s[n][t]===void 0)return;delete s[n][t],s[n]._visualValues!==void 0&&s[n]._visualValues[t]!==void 0&&delete s[n]._visualValues[t]}}}const s1=r=>r==="reset"||r==="none",OA=(r,e)=>e?r:Object.assign({},r),pB=(r,e,t)=>r&&!e.hidden&&e._stacked&&{keys:Y3(t,!0),values:null};class tu{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=r1(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Zh(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,n=this.getDataset(),i=(y,g,_,E)=>y==="x"?g:y==="r"?E:_,s=t.xAxisID=Dt(n.xAxisID,i1(e,"x")),o=t.yAxisID=Dt(n.yAxisID,i1(e,"y")),l=t.rAxisID=Dt(n.rAxisID,i1(e,"r")),d=t.indexAxis,f=t.iAxisID=i(d,s,o,l),m=t.vAxisID=i(d,o,s,l);t.xScale=this.getScaleForId(s),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(l),t.iScale=this.getScaleForId(f),t.vScale=this.getScaleForId(m)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&pA(this._data,this),e._stacked&&Zh(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),n=this._data;if(Xt(t)){const i=this._cachedMeta;this._data=cB(t,i)}else if(n!==t){if(n){pA(n,this);const i=this._cachedMeta;Zh(i),i._parsed=[]}t&&Object.isExtensible(t)&&KV(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,n=this.getDataset();let i=!1;this._dataCheck();const s=t._stacked;t._stacked=r1(t.vScale,t),t.stack!==n.stack&&(i=!0,Zh(t),t.stack=n.stack),this._resyncElements(e),(i||s!==t._stacked)&&(jA(this,t._parsed),t._stacked=r1(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),n=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(n,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:n,_data:i}=this,{iScale:s,_stacked:o}=n,l=s.axis;let d=e===0&&t===i.length?!0:n._sorted,f=e>0&&n._parsed[e-1],m,y,g;if(this._parsing===!1)n._parsed=i,n._sorted=!0,g=i;else{hr(i[e])?g=this.parseArrayData(n,i,e,t):Xt(i[e])?g=this.parseObjectData(n,i,e,t):g=this.parsePrimitiveData(n,i,e,t);const _=()=>y[l]===null||f&&y[l]<f[l];for(m=0;m<t;++m)n._parsed[m+e]=y=g[m],d&&(_()&&(d=!1),f=y);n._sorted=d}o&&jA(this,g)}parsePrimitiveData(e,t,n,i){const{iScale:s,vScale:o}=e,l=s.axis,d=o.axis,f=s.getLabels(),m=s===o,y=new Array(i);let g,_,E;for(g=0,_=i;g<_;++g)E=g+n,y[g]={[l]:m||s.parse(f[E],E),[d]:o.parse(t[E],E)};return y}parseArrayData(e,t,n,i){const{xScale:s,yScale:o}=e,l=new Array(i);let d,f,m,y;for(d=0,f=i;d<f;++d)m=d+n,y=t[m],l[d]={x:s.parse(y[0],m),y:o.parse(y[1],m)};return l}parseObjectData(e,t,n,i){const{xScale:s,yScale:o}=e,{xAxisKey:l="x",yAxisKey:d="y"}=this._parsing,f=new Array(i);let m,y,g,_;for(m=0,y=i;m<y;++m)g=m+n,_=t[g],f[m]={x:s.parse(gu(_,l),g),y:o.parse(gu(_,d),g)};return f}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,n){const i=this.chart,s=this._cachedMeta,o=t[e.axis],l={keys:Y3(i,!0),values:t._stacks[e.axis]._visualValues};return CA(l,o,s.index,{mode:n})}updateRangeFromParsed(e,t,n,i){const s=n[t.axis];let o=s===null?NaN:s;const l=i&&n._stacks[t.axis];i&&l&&(i.values=l,o=CA(i,s,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const n=this._cachedMeta,i=n._parsed,s=n._sorted&&e===n.iScale,o=i.length,l=this._getOtherScale(e),d=pB(t,n,this.chart),f={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:m,max:y}=dB(l);let g,_;function E(){_=i[g];const x=_[l.axis];return!Ds(_[e.axis])||m>x||y<x}for(g=0;g<o&&!(!E()&&(this.updateRangeFromParsed(f,e,_,d),s));++g);if(s){for(g=o-1;g>=0;--g)if(!E()){this.updateRangeFromParsed(f,e,_,d);break}}return f}getAllParsedValues(e){const t=this._cachedMeta._parsed,n=[];let i,s,o;for(i=0,s=t.length;i<s;++i)o=t[i][e.axis],Ds(o)&&n.push(o);return n}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,n=t.iScale,i=t.vScale,s=this.getParsed(e);return{label:n?""+n.getLabelForValue(s[n.axis]):"",value:i?""+i.getLabelForValue(s[i.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=lB(Dt(this.options.clip,aB(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,n=this._cachedMeta,i=n.data||[],s=t.chartArea,o=[],l=this._drawStart||0,d=this._drawCount||i.length-l,f=this.options.drawActiveElementsOnTop;let m;for(n.dataset&&n.dataset.draw(e,s,l,d),m=l;m<l+d;++m){const y=i[m];y.hidden||(y.active&&f?o.push(y):y.draw(e,s))}for(m=0;m<o.length;++m)o[m].draw(e,s)}getStyle(e,t){const n=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(n):this.resolveDataElementOptions(e||0,n)}getContext(e,t,n){const i=this.getDataset();let s;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];s=o.$context||(o.$context=mB(this.getContext(),e,o)),s.parsed=this.getParsed(e),s.raw=i.data[e],s.index=s.dataIndex=e}else s=this.$context||(this.$context=fB(this.chart.getContext(),this.index)),s.dataset=i,s.index=s.datasetIndex=this.index;return s.active=!!t,s.mode=n,s}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",n){const i=t==="active",s=this._cachedDataOpts,o=e+"-"+t,l=s[o],d=this.enableOptionSharing&&sm(n);if(l)return OA(l,d);const f=this.chart.config,m=f.datasetElementScopeKeys(this._type,e),y=i?[`${e}Hover`,"hover",e,""]:[e,""],g=f.getOptionScopes(this.getDataset(),m),_=Object.keys(Qn.elements[e]),E=()=>this.getContext(n,i,t),x=f.resolveNamedOptions(g,_,E,y);return x.$shared&&(x.$shared=d,s[o]=Object.freeze(OA(x,d))),x}_resolveAnimations(e,t,n){const i=this.chart,s=this._cachedDataOpts,o=`animation-${t}`,l=s[o];if(l)return l;let d;if(i.options.animation!==!1){const m=this.chart.config,y=m.datasetAnimationScopeKeys(this._type,t),g=m.getOptionScopes(this.getDataset(),y);d=m.createResolver(g,this.getContext(e,n,t))}const f=new K3(i,d&&d.animations);return d&&d._cacheable&&(s[o]=Object.freeze(f)),f}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||s1(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const n=this.resolveDataElementOptions(e,t),i=this._sharedOptions,s=this.getSharedOptions(n),o=this.includeOptions(t,s)||s!==i;return this.updateSharedOptions(s,t,n),{sharedOptions:s,includeOptions:o}}updateElement(e,t,n,i){s1(i)?Object.assign(e,n):this._resolveAnimations(t,i).update(e,n)}updateSharedOptions(e,t,n){e&&!s1(t)&&this._resolveAnimations(void 0,t).update(e,n)}_setStyle(e,t,n,i){e.active=i;const s=this.getStyle(t,i);this._resolveAnimations(t,n,i).update(e,{options:!i&&this.getSharedOptions(s)||s})}removeHoverStyle(e,t,n){this._setStyle(e,n,"active",!1)}setHoverStyle(e,t,n){this._setStyle(e,n,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,n=this._cachedMeta.data;for(const[l,d,f]of this._syncList)this[l](d,f);this._syncList=[];const i=n.length,s=t.length,o=Math.min(s,i);o&&this.parse(0,o),s>i?this._insertElements(i,s-i,e):s<i&&this._removeElements(s,i-s)}_insertElements(e,t,n=!0){const i=this._cachedMeta,s=i.data,o=e+t;let l;const d=f=>{for(f.length+=t,l=f.length-1;l>=o;l--)f[l]=f[l-t]};for(d(s),l=e;l<o;++l)s[l]=new this.dataElementType;this._parsing&&d(i._parsed),this.parse(e,t),n&&this.updateElements(s,e,t,"reset")}updateElements(e,t,n,i){}_removeElements(e,t){const n=this._cachedMeta;if(this._parsing){const i=n._parsed.splice(e,t);n._stacked&&Zh(n,i)}n.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,n,i]=e;this[t](n,i)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const n=arguments.length-2;n&&this._sync(["_insertElements",e,n])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Je(tu,"defaults",{}),Je(tu,"datasetElementType",null),Je(tu,"dataElementType",null);function gB(r,e){if(!r._cache.$bar){const t=r.getMatchingVisibleMetas(e);let n=[];for(let i=0,s=t.length;i<s;i++)n=n.concat(t[i].controller.getAllParsedValues(r));r._cache.$bar=O3(n.sort((i,s)=>i-s))}return r._cache.$bar}function yB(r){const e=r.iScale,t=gB(e,r.type);let n=e._length,i,s,o,l;const d=()=>{o===32767||o===-32768||(sm(l)&&(n=Math.min(n,Math.abs(o-l)||n)),l=o)};for(i=0,s=t.length;i<s;++i)o=e.getPixelForValue(t[i]),d();for(l=void 0,i=0,s=e.ticks.length;i<s;++i)o=e.getPixelForTick(i),d();return n}function vB(r,e,t,n){const i=t.barThickness;let s,o;return on(i)?(s=e.min*t.categoryPercentage,o=t.barPercentage):(s=i*n,o=1),{chunk:s/n,ratio:o,start:e.pixels[r]-s/2}}function _B(r,e,t,n){const i=e.pixels,s=i[r];let o=r>0?i[r-1]:null,l=r<i.length-1?i[r+1]:null;const d=t.categoryPercentage;o===null&&(o=s-(l===null?e.end-e.start:l-s)),l===null&&(l=s+s-o);const f=s-(s-Math.min(o,l))/2*d;return{chunk:Math.abs(l-o)/2*d/n,ratio:t.barPercentage,start:f}}function xB(r,e,t,n){const i=t.parse(r[0],n),s=t.parse(r[1],n),o=Math.min(i,s),l=Math.max(i,s);let d=o,f=l;Math.abs(o)>Math.abs(l)&&(d=l,f=o),e[t.axis]=f,e._custom={barStart:d,barEnd:f,start:i,end:s,min:o,max:l}}function Z3(r,e,t,n){return hr(r)?xB(r,e,t,n):e[t.axis]=t.parse(r,n),e}function MA(r,e,t,n){const i=r.iScale,s=r.vScale,o=i.getLabels(),l=i===s,d=[];let f,m,y,g;for(f=t,m=t+n;f<m;++f)g=e[f],y={},y[i.axis]=l||i.parse(o[f],f),d.push(Z3(g,y,s,f));return d}function o1(r){return r&&r.barStart!==void 0&&r.barEnd!==void 0}function bB(r,e,t){return r!==0?Do(r):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function wB(r){let e,t,n,i,s;return r.horizontal?(e=r.base>r.x,t="left",n="right"):(e=r.base<r.y,t="bottom",n="top"),e?(i="end",s="start"):(i="start",s="end"),{start:t,end:n,reverse:e,top:i,bottom:s}}function EB(r,e,t,n){let i=e.borderSkipped;const s={};if(!i){r.borderSkipped=s;return}if(i===!0){r.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:l,reverse:d,top:f,bottom:m}=wB(r);i==="middle"&&t&&(r.enableBorderRadius=!0,(t._top||0)===n?i=f:(t._bottom||0)===n?i=m:(s[DA(m,o,l,d)]=!0,i=f)),s[DA(i,o,l,d)]=!0,r.borderSkipped=s}function DA(r,e,t,n){return n?(r=SB(r,e,t),r=LA(r,t,e)):r=LA(r,e,t),r}function SB(r,e,t){return r===e?t:r===t?e:r}function LA(r,e,t){return r==="start"?e:r==="end"?t:r}function TB(r,{inflateAmount:e},t){r.inflateAmount=e==="auto"?t===1?.33:0:e}class bg extends tu{parsePrimitiveData(e,t,n,i){return MA(e,t,n,i)}parseArrayData(e,t,n,i){return MA(e,t,n,i)}parseObjectData(e,t,n,i){const{iScale:s,vScale:o}=e,{xAxisKey:l="x",yAxisKey:d="y"}=this._parsing,f=s.axis==="x"?l:d,m=o.axis==="x"?l:d,y=[];let g,_,E,x;for(g=n,_=n+i;g<_;++g)x=t[g],E={},E[s.axis]=s.parse(gu(x,f),g),y.push(Z3(gu(x,m),E,o,g));return y}updateRangeFromParsed(e,t,n,i){super.updateRangeFromParsed(e,t,n,i);const s=n._custom;s&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,s.min),e.max=Math.max(e.max,s.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:n,vScale:i}=t,s=this.getParsed(e),o=s._custom,l=o1(o)?"["+o.start+", "+o.end+"]":""+i.getLabelForValue(s[i.axis]);return{label:""+n.getLabelForValue(s[n.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,n,i){const s=i==="reset",{index:o,_cachedMeta:{vScale:l}}=this,d=l.getBasePixel(),f=l.isHorizontal(),m=this._getRuler(),{sharedOptions:y,includeOptions:g}=this._getSharedOptions(t,i);for(let _=t;_<t+n;_++){const E=this.getParsed(_),x=s||on(E[l.axis])?{base:d,head:d}:this._calculateBarValuePixels(_),b=this._calculateBarIndexPixels(_,m),T=(E._stacks||{})[l.axis],N={horizontal:f,base:x.base,enableBorderRadius:!T||o1(E._custom)||o===T._top||o===T._bottom,x:f?x.head:b.center,y:f?b.center:x.head,height:f?b.size:Math.abs(x.size),width:f?Math.abs(x.size):b.size};g&&(N.options=y||this.resolveDataElementOptions(_,e[_].active?"active":i));const R=N.options||e[_].options;EB(N,R,T,o),TB(N,R,m.ratio),this.updateElement(e[_],_,N,i)}}_getStacks(e,t){const{iScale:n}=this._cachedMeta,i=n.getMatchingVisibleMetas(this._type).filter(m=>m.controller.options.grouped),s=n.options.stacked,o=[],l=this._cachedMeta.controller.getParsed(t),d=l&&l[n.axis],f=m=>{const y=m._parsed.find(_=>_[n.axis]===d),g=y&&y[m.vScale.axis];if(on(g)||isNaN(g))return!0};for(const m of i)if(!(t!==void 0&&f(m))&&((s===!1||o.indexOf(m.stack)===-1||s===void 0&&m.stack===void 0)&&o.push(m.stack),m.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(n=>e[n].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const n of this.chart.data.datasets)e[Dt(this.chart.options.indexAxis==="x"?n.xAxisID:n.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,n){const i=this._getStacks(e,n),s=t!==void 0?i.indexOf(t):-1;return s===-1?i.length-1:s}_getRuler(){const e=this.options,t=this._cachedMeta,n=t.iScale,i=[];let s,o;for(s=0,o=t.data.length;s<o;++s)i.push(n.getPixelForValue(this.getParsed(s)[n.axis],s));const l=e.barThickness;return{min:l||yB(t),pixels:i,start:n._startPixel,end:n._endPixel,stackCount:this._getStackCount(),scale:n,grouped:e.grouped,ratio:l?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:n,index:i},options:{base:s,minBarLength:o}}=this,l=s||0,d=this.getParsed(e),f=d._custom,m=o1(f);let y=d[t.axis],g=0,_=n?this.applyStack(t,d,n):y,E,x;_!==y&&(g=_-y,_=y),m&&(y=f.barStart,_=f.barEnd-f.barStart,y!==0&&Do(y)!==Do(f.barEnd)&&(g=0),g+=y);const b=!on(s)&&!m?s:g;let T=t.getPixelForValue(b);if(this.chart.getDataVisibility(e)?E=t.getPixelForValue(g+_):E=T,x=E-T,Math.abs(x)<o){x=bB(x,t,l)*o,y===l&&(T-=x/2);const N=t.getPixelForDecimal(0),R=t.getPixelForDecimal(1),I=Math.min(N,R),j=Math.max(N,R);T=Math.max(Math.min(T,j),I),E=T+x,n&&!m&&(d._stacks[t.axis]._visualValues[i]=t.getValueForPixel(E)-t.getValueForPixel(T))}if(T===t.getPixelForValue(l)){const N=Do(x)*t.getLineWidthForValue(l)/2;T+=N,x-=N}return{size:x,base:T,head:E,center:E+x/2}}_calculateBarIndexPixels(e,t){const n=t.scale,i=this.options,s=i.skipNull,o=Dt(i.maxBarThickness,1/0);let l,d;const f=this._getAxisCount();if(t.grouped){const m=s?this._getStackCount(e):t.stackCount,y=i.barThickness==="flex"?_B(e,t,i,m*f):vB(e,t,i,m*f),g=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,_=this._getAxis().indexOf(Dt(g,this.getFirstScaleIdForIndexAxis())),E=this._getStackIndex(this.index,this._cachedMeta.stack,s?e:void 0)+_;l=y.start+y.chunk*E+y.chunk/2,d=Math.min(o,y.chunk*y.ratio)}else l=n.getPixelForValue(this.getParsed(e)[n.axis],e),d=Math.min(o,t.min*t.ratio);return{base:l-d/2,head:l+d/2,center:l,size:d}}draw(){const e=this._cachedMeta,t=e.vScale,n=e.data,i=n.length;let s=0;for(;s<i;++s)this.getParsed(s)[t.axis]!==null&&!n[s].hidden&&n[s].draw(this._ctx)}}Je(bg,"id","bar"),Je(bg,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),Je(bg,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function AB(r,e,t){let n=1,i=1,s=0,o=0;if(e<$n){const l=r,d=l+e,f=Math.cos(l),m=Math.sin(l),y=Math.cos(d),g=Math.sin(d),_=(R,I,j)=>am(R,l,d,!0)?1:Math.max(I,I*t,j,j*t),E=(R,I,j)=>am(R,l,d,!0)?-1:Math.min(I,I*t,j,j*t),x=_(0,f,y),b=_(mr,m,g),T=E(fn,f,y),N=E(fn+mr,m,g);n=(x-T)/2,i=(b-N)/2,s=-(x+T)/2,o=-(b+N)/2}return{ratioX:n,ratioY:i,offsetX:s,offsetY:o}}class pd extends tu{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const n=this.getDataset().data,i=this._cachedMeta;if(this._parsing===!1)i._parsed=n;else{let s=d=>+n[d];if(Xt(n[e])){const{key:d="value"}=this._parsing;s=f=>+gu(n[f],d)}let o,l;for(o=e,l=e+t;o<l;++o)i._parsed[o]=s(o)}}_getRotation(){return Ea(this.options.rotation-90)}_getCircumference(){return Ea(this.options.circumference)}_getRotationExtents(){let e=$n,t=-$n;for(let n=0;n<this.chart.data.datasets.length;++n)if(this.chart.isDatasetVisible(n)&&this.chart.getDatasetMeta(n).type===this._type){const i=this.chart.getDatasetMeta(n).controller,s=i._getRotation(),o=i._getCircumference();e=Math.min(e,s),t=Math.max(t,s+o)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:n}=t,i=this._cachedMeta,s=i.data,o=this.getMaxBorderWidth()+this.getMaxOffset(s)+this.options.spacing,l=Math.max((Math.min(n.width,n.height)-o)/2,0),d=Math.min(CV(this.options.cutout,l),1),f=this._getRingWeight(this.index),{circumference:m,rotation:y}=this._getRotationExtents(),{ratioX:g,ratioY:_,offsetX:E,offsetY:x}=AB(y,m,d),b=(n.width-o)/g,T=(n.height-o)/_,N=Math.max(Math.min(b,T)/2,0),R=k3(this.options.radius,N),I=Math.max(R*d,0),j=(R-I)/this._getVisibleDatasetWeightTotal();this.offsetX=E*R,this.offsetY=x*R,i.total=this.calculateTotal(),this.outerRadius=R-j*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-j*f,0),this.updateElements(s,0,s.length,e)}_circumference(e,t){const n=this.options,i=this._cachedMeta,s=this._getCircumference();return t&&n.animation.animateRotate||!this.chart.getDataVisibility(e)||i._parsed[e]===null||i.data[e].hidden?0:this.calculateCircumference(i._parsed[e]*s/$n)}updateElements(e,t,n,i){const s=i==="reset",o=this.chart,l=o.chartArea,f=o.options.animation,m=(l.left+l.right)/2,y=(l.top+l.bottom)/2,g=s&&f.animateScale,_=g?0:this.innerRadius,E=g?0:this.outerRadius,{sharedOptions:x,includeOptions:b}=this._getSharedOptions(t,i);let T=this._getRotation(),N;for(N=0;N<t;++N)T+=this._circumference(N,s);for(N=t;N<t+n;++N){const R=this._circumference(N,s),I=e[N],j={x:m+this.offsetX,y:y+this.offsetY,startAngle:T,endAngle:T+R,circumference:R,outerRadius:E,innerRadius:_};b&&(j.options=x||this.resolveDataElementOptions(N,I.active?"active":i)),T+=R,this.updateElement(I,N,j,i)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let n=0,i;for(i=0;i<t.length;i++){const s=e._parsed[i];s!==null&&!isNaN(s)&&this.chart.getDataVisibility(i)&&!t[i].hidden&&(n+=Math.abs(s))}return n}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?$n*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,n=this.chart,i=n.data.labels||[],s=V2(t._parsed[e],n.options.locale);return{label:i[e]||"",value:s}}getMaxBorderWidth(e){let t=0;const n=this.chart;let i,s,o,l,d;if(!e){for(i=0,s=n.data.datasets.length;i<s;++i)if(n.isDatasetVisible(i)){o=n.getDatasetMeta(i),e=o.data,l=o.controller;break}}if(!e)return 0;for(i=0,s=e.length;i<s;++i)d=l.resolveDataElementOptions(i),d.borderAlign!=="inner"&&(t=Math.max(t,d.borderWidth||0,d.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let n=0,i=e.length;n<i;++n){const s=this.resolveDataElementOptions(n);t=Math.max(t,s.offset||0,s.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let n=0;n<e;++n)this.chart.isDatasetVisible(n)&&(t+=this._getRingWeight(n));return t}_getRingWeight(e){return Math.max(Dt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}Je(pd,"id","doughnut"),Je(pd,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),Je(pd,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),Je(pd,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data,{labels:{pointStyle:n,textAlign:i,color:s,useBorderRadius:o,borderRadius:l}}=e.legend.options;return t.labels.length&&t.datasets.length?t.labels.map((d,f)=>{const y=e.getDatasetMeta(0).controller.getStyle(f);return{text:d,fillStyle:y.backgroundColor,fontColor:s,hidden:!e.getDataVisibility(f),lineDash:y.borderDash,lineDashOffset:y.borderDashOffset,lineJoin:y.borderJoinStyle,lineWidth:y.borderWidth,strokeStyle:y.borderColor,textAlign:i,pointStyle:n,borderRadius:o&&(l||y.borderRadius),index:f}}):[]}},onClick(e,t,n){n.chart.toggleDataVisibility(t.index),n.chart.update()}}}});class wg extends tu{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:n,data:i=[],_dataset:s}=t,o=this.chart._animationsDisabled;let{start:l,count:d}=QV(t,i,o);this._drawStart=l,this._drawCount=d,XV(t)&&(l=0,d=i.length),n._chart=this.chart,n._datasetIndex=this.index,n._decimated=!!s._decimated,n.points=i;const f=this.resolveDatasetElementOptions(e);this.options.showLine||(f.borderWidth=0),f.segment=this.options.segment,this.updateElement(n,void 0,{animated:!o,options:f},e),this.updateElements(i,l,d,e)}updateElements(e,t,n,i){const s=i==="reset",{iScale:o,vScale:l,_stacked:d,_dataset:f}=this._cachedMeta,{sharedOptions:m,includeOptions:y}=this._getSharedOptions(t,i),g=o.axis,_=l.axis,{spanGaps:E,segment:x}=this.options,b=om(E)?E:Number.POSITIVE_INFINITY,T=this.chart._animationsDisabled||s||i==="none",N=t+n,R=e.length;let I=t>0&&this.getParsed(t-1);for(let j=0;j<R;++j){const U=e[j],C=T?U:{};if(j<t||j>=N){C.skip=!0;continue}const k=this.getParsed(j),D=on(k[_]),O=C[g]=o.getPixelForValue(k[g],j),P=C[_]=s||D?l.getBasePixel():l.getPixelForValue(d?this.applyStack(l,k,d):k[_],j);C.skip=isNaN(O)||isNaN(P)||D,C.stop=j>0&&Math.abs(k[g]-I[g])>b,x&&(C.parsed=k,C.raw=f.data[j]),y&&(C.options=m||this.resolveDataElementOptions(j,U.active?"active":i)),T||this.updateElement(U,j,C,i),I=k}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,n=t.options&&t.options.borderWidth||0,i=e.data||[];if(!i.length)return n;const s=i[0].size(this.resolveDataElementOptions(0)),o=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(n,s,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}Je(wg,"id","line"),Je(wg,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Je(wg,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});class Hx extends pd{}Je(Hx,"id","pie"),Je(Hx,"defaults",{cutout:0,rotation:0,circumference:360,radius:"100%"});function Fc(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class K2{constructor(e){Je(this,"options");this.options=e||{}}static override(e){Object.assign(K2.prototype,e)}init(){}formats(){return Fc()}parse(){return Fc()}format(){return Fc()}add(){return Fc()}diff(){return Fc()}startOf(){return Fc()}endOf(){return Fc()}}var NB={_date:K2};function IB(r,e,t,n){const{controller:i,data:s,_sorted:o}=r,l=i._cachedMeta.iScale,d=r.dataset&&r.dataset.options?r.dataset.options.spanGaps:null;if(l&&e===l.axis&&e!=="r"&&o&&s.length){const f=l._reversePixels?WV:Zc;if(n){if(i._sharedOptions){const m=s[0],y=typeof m.getRange=="function"&&m.getRange(e);if(y){const g=f(s,e,t-y),_=f(s,e,t+y);return{lo:g.lo,hi:_.hi}}}}else{const m=f(s,e,t);if(d){const{vScale:y}=i._cachedMeta,{_parsed:g}=r,_=g.slice(0,m.lo+1).reverse().findIndex(x=>!on(x[y.axis]));m.lo-=Math.max(0,_);const E=g.slice(m.hi).findIndex(x=>!on(x[y.axis]));m.hi+=Math.max(0,E)}return m}}return{lo:0,hi:s.length-1}}function o0(r,e,t,n,i){const s=r.getSortedVisibleDatasetMetas(),o=t[e];for(let l=0,d=s.length;l<d;++l){const{index:f,data:m}=s[l],{lo:y,hi:g}=IB(s[l],e,o,i);for(let _=y;_<=g;++_){const E=m[_];E.skip||n(E,f,_)}}}function kB(r){const e=r.indexOf("x")!==-1,t=r.indexOf("y")!==-1;return function(n,i){const s=e?Math.abs(n.x-i.x):0,o=t?Math.abs(n.y-i.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(o,2))}}function a1(r,e,t,n,i){const s=[];return!i&&!r.isPointInArea(e)||o0(r,t,e,function(l,d,f){!i&&!lm(l,r.chartArea,0)||l.inRange(e.x,e.y,n)&&s.push({element:l,datasetIndex:d,index:f})},!0),s}function PB(r,e,t,n){let i=[];function s(o,l,d){const{startAngle:f,endAngle:m}=o.getProps(["startAngle","endAngle"],n),{angle:y}=R3(o,{x:e.x,y:e.y});am(y,f,m)&&i.push({element:o,datasetIndex:l,index:d})}return o0(r,t,e,s),i}function CB(r,e,t,n,i,s){let o=[];const l=kB(t);let d=Number.POSITIVE_INFINITY;function f(m,y,g){const _=m.inRange(e.x,e.y,i);if(n&&!_)return;const E=m.getCenterPoint(i);if(!(!!s||r.isPointInArea(E))&&!_)return;const b=l(e,E);b<d?(o=[{element:m,datasetIndex:y,index:g}],d=b):b===d&&o.push({element:m,datasetIndex:y,index:g})}return o0(r,t,e,f),o}function l1(r,e,t,n,i,s){return!s&&!r.isPointInArea(e)?[]:t==="r"&&!n?PB(r,e,t,i):CB(r,e,t,n,i,s)}function FA(r,e,t,n,i){const s=[],o=t==="x"?"inXRange":"inYRange";let l=!1;return o0(r,t,e,(d,f,m)=>{d[o]&&d[o](e[t],i)&&(s.push({element:d,datasetIndex:f,index:m}),l=l||d.inRange(e.x,e.y,i))}),n&&!l?[]:s}var RB={modes:{index(r,e,t,n){const i=Uc(e,r),s=t.axis||"x",o=t.includeInvisible||!1,l=t.intersect?a1(r,i,s,n,o):l1(r,i,s,!1,n,o),d=[];return l.length?(r.getSortedVisibleDatasetMetas().forEach(f=>{const m=l[0].index,y=f.data[m];y&&!y.skip&&d.push({element:y,datasetIndex:f.index,index:m})}),d):[]},dataset(r,e,t,n){const i=Uc(e,r),s=t.axis||"xy",o=t.includeInvisible||!1;let l=t.intersect?a1(r,i,s,n,o):l1(r,i,s,!1,n,o);if(l.length>0){const d=l[0].datasetIndex,f=r.getDatasetMeta(d).data;l=[];for(let m=0;m<f.length;++m)l.push({element:f[m],datasetIndex:d,index:m})}return l},point(r,e,t,n){const i=Uc(e,r),s=t.axis||"xy",o=t.includeInvisible||!1;return a1(r,i,s,n,o)},nearest(r,e,t,n){const i=Uc(e,r),s=t.axis||"xy",o=t.includeInvisible||!1;return l1(r,i,s,t.intersect,n,o)},x(r,e,t,n){const i=Uc(e,r);return FA(r,i,"x",t.intersect,n)},y(r,e,t,n){const i=Uc(e,r);return FA(r,i,"y",t.intersect,n)}}};const Q3=["left","top","right","bottom"];function Qh(r,e){return r.filter(t=>t.pos===e)}function VA(r,e){return r.filter(t=>Q3.indexOf(t.pos)===-1&&t.box.axis===e)}function Xh(r,e){return r.sort((t,n)=>{const i=e?n:t,s=e?t:n;return i.weight===s.weight?i.index-s.index:i.weight-s.weight})}function jB(r){const e=[];let t,n,i,s,o,l;for(t=0,n=(r||[]).length;t<n;++t)i=r[t],{position:s,options:{stack:o,stackWeight:l=1}}=i,e.push({index:t,box:i,pos:s,horizontal:i.isHorizontal(),weight:i.weight,stack:o&&s+o,stackWeight:l});return e}function OB(r){const e={};for(const t of r){const{stack:n,pos:i,stackWeight:s}=t;if(!n||!Q3.includes(i))continue;const o=e[n]||(e[n]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=s}return e}function MB(r,e){const t=OB(r),{vBoxMaxWidth:n,hBoxMaxHeight:i}=e;let s,o,l;for(s=0,o=r.length;s<o;++s){l=r[s];const{fullSize:d}=l.box,f=t[l.stack],m=f&&l.stackWeight/f.weight;l.horizontal?(l.width=m?m*n:d&&e.availableWidth,l.height=i):(l.width=n,l.height=m?m*i:d&&e.availableHeight)}return t}function DB(r){const e=jB(r),t=Xh(e.filter(f=>f.box.fullSize),!0),n=Xh(Qh(e,"left"),!0),i=Xh(Qh(e,"right")),s=Xh(Qh(e,"top"),!0),o=Xh(Qh(e,"bottom")),l=VA(e,"x"),d=VA(e,"y");return{fullSize:t,leftAndTop:n.concat(s),rightAndBottom:i.concat(d).concat(o).concat(l),chartArea:Qh(e,"chartArea"),vertical:n.concat(i).concat(d),horizontal:s.concat(o).concat(l)}}function zA(r,e,t,n){return Math.max(r[t],e[t])+Math.max(r[n],e[n])}function X3(r,e){r.top=Math.max(r.top,e.top),r.left=Math.max(r.left,e.left),r.bottom=Math.max(r.bottom,e.bottom),r.right=Math.max(r.right,e.right)}function LB(r,e,t,n){const{pos:i,box:s}=t,o=r.maxPadding;if(!Xt(i)){t.size&&(r[i]-=t.size);const y=n[t.stack]||{size:0,count:1};y.size=Math.max(y.size,t.horizontal?s.height:s.width),t.size=y.size/y.count,r[i]+=t.size}s.getPadding&&X3(o,s.getPadding());const l=Math.max(0,e.outerWidth-zA(o,r,"left","right")),d=Math.max(0,e.outerHeight-zA(o,r,"top","bottom")),f=l!==r.w,m=d!==r.h;return r.w=l,r.h=d,t.horizontal?{same:f,other:m}:{same:m,other:f}}function FB(r){const e=r.maxPadding;function t(n){const i=Math.max(e[n]-r[n],0);return r[n]+=i,i}r.y+=t("top"),r.x+=t("left"),t("right"),t("bottom")}function VB(r,e){const t=e.maxPadding;function n(i){const s={left:0,top:0,right:0,bottom:0};return i.forEach(o=>{s[o]=Math.max(e[o],t[o])}),s}return n(r?["left","right"]:["top","bottom"])}function pf(r,e,t,n){const i=[];let s,o,l,d,f,m;for(s=0,o=r.length,f=0;s<o;++s){l=r[s],d=l.box,d.update(l.width||e.w,l.height||e.h,VB(l.horizontal,e));const{same:y,other:g}=LB(e,t,l,n);f|=y&&i.length,m=m||g,d.fullSize||i.push(l)}return f&&pf(i,e,t,n)||m}function Kp(r,e,t,n,i){r.top=t,r.left=e,r.right=e+n,r.bottom=t+i,r.width=n,r.height=i}function BA(r,e,t,n){const i=t.padding;let{x:s,y:o}=e;for(const l of r){const d=l.box,f=n[l.stack]||{placed:0,weight:1},m=l.stackWeight/f.weight||1;if(l.horizontal){const y=e.w*m,g=f.size||d.height;sm(f.start)&&(o=f.start),d.fullSize?Kp(d,i.left,o,t.outerWidth-i.right-i.left,g):Kp(d,e.left+f.placed,o,y,g),f.start=o,f.placed+=y,o=d.bottom}else{const y=e.h*m,g=f.size||d.width;sm(f.start)&&(s=f.start),d.fullSize?Kp(d,s,i.top,g,t.outerHeight-i.bottom-i.top):Kp(d,s,e.top+f.placed,g,y),f.start=s,f.placed+=y,s=d.right}}e.x=s,e.y=o}var Ns={addBox(r,e){r.boxes||(r.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},r.boxes.push(e)},removeBox(r,e){const t=r.boxes?r.boxes.indexOf(e):-1;t!==-1&&r.boxes.splice(t,1)},configure(r,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(r,e,t,n){if(!r)return;const i=Ls(r.options.layout.padding),s=Math.max(e-i.width,0),o=Math.max(t-i.height,0),l=DB(r.boxes),d=l.vertical,f=l.horizontal;hn(r.boxes,x=>{typeof x.beforeLayout=="function"&&x.beforeLayout()});const m=d.reduce((x,b)=>b.box.options&&b.box.options.display===!1?x:x+1,0)||1,y=Object.freeze({outerWidth:e,outerHeight:t,padding:i,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/m,hBoxMaxHeight:o/2}),g=Object.assign({},i);X3(g,Ls(n));const _=Object.assign({maxPadding:g,w:s,h:o,x:i.left,y:i.top},i),E=MB(d.concat(f),y);pf(l.fullSize,_,y,E),pf(d,_,y,E),pf(f,_,y,E)&&pf(d,_,y,E),FB(_),BA(l.leftAndTop,_,y,E),_.x+=_.w,_.y+=_.h,BA(l.rightAndBottom,_,y,E),r.chartArea={left:_.left,top:_.top,right:_.left+_.w,bottom:_.top+_.h,height:_.h,width:_.w},hn(l.chartArea,x=>{const b=x.box;Object.assign(b,r.chartArea),b.update(_.w,_.h,{left:0,top:0,right:0,bottom:0})})}};class J3{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,n){}removeEventListener(e,t,n){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,n,i){return t=Math.max(0,t||e.width),n=n||e.height,{width:t,height:Math.max(0,i?Math.floor(t/i):n)}}isAttached(e){return!0}updateConfig(e){}}class zB extends J3{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Eg="$chartjs",BB={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},UA=r=>r===null||r==="";function UB(r,e){const t=r.style,n=r.getAttribute("height"),i=r.getAttribute("width");if(r[Eg]={initial:{height:n,width:i,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",UA(i)){const s=TA(r,"width");s!==void 0&&(r.width=s)}if(UA(n))if(r.style.height==="")r.height=r.width/(e||2);else{const s=TA(r,"height");s!==void 0&&(r.height=s)}return r}const eR=Bz?{passive:!0}:!1;function qB(r,e,t){r&&r.addEventListener(e,t,eR)}function HB(r,e,t){r&&r.canvas&&r.canvas.removeEventListener(e,t,eR)}function $B(r,e){const t=BB[r.type]||r.type,{x:n,y:i}=Uc(r,e);return{type:t,chart:e,native:r,x:n!==void 0?n:null,y:i!==void 0?i:null}}function hy(r,e){for(const t of r)if(t===e||t.contains(e))return!0}function WB(r,e,t){const n=r.canvas,i=new MutationObserver(s=>{let o=!1;for(const l of s)o=o||hy(l.addedNodes,n),o=o&&!hy(l.removedNodes,n);o&&t()});return i.observe(document,{childList:!0,subtree:!0}),i}function GB(r,e,t){const n=r.canvas,i=new MutationObserver(s=>{let o=!1;for(const l of s)o=o||hy(l.removedNodes,n),o=o&&!hy(l.addedNodes,n);o&&t()});return i.observe(document,{childList:!0,subtree:!0}),i}const um=new Map;let qA=0;function tR(){const r=window.devicePixelRatio;r!==qA&&(qA=r,um.forEach((e,t)=>{t.currentDevicePixelRatio!==r&&e()}))}function KB(r,e){um.size||window.addEventListener("resize",tR),um.set(r,e)}function YB(r){um.delete(r),um.size||window.removeEventListener("resize",tR)}function ZB(r,e,t){const n=r.canvas,i=n&&G2(n);if(!i)return;const s=D3((l,d)=>{const f=i.clientWidth;t(l,d),f<i.clientWidth&&t()},window),o=new ResizeObserver(l=>{const d=l[0],f=d.contentRect.width,m=d.contentRect.height;f===0&&m===0||s(f,m)});return o.observe(i),KB(r,s),o}function c1(r,e,t){t&&t.disconnect(),e==="resize"&&YB(r)}function QB(r,e,t){const n=r.canvas,i=D3(s=>{r.ctx!==null&&t($B(s,r))},r);return qB(n,e,i),i}class XB extends J3{acquireContext(e,t){const n=e&&e.getContext&&e.getContext("2d");return n&&n.canvas===e?(UB(e,t),n):null}releaseContext(e){const t=e.canvas;if(!t[Eg])return!1;const n=t[Eg].initial;["height","width"].forEach(s=>{const o=n[s];on(o)?t.removeAttribute(s):t.setAttribute(s,o)});const i=n.style||{};return Object.keys(i).forEach(s=>{t.style[s]=i[s]}),t.width=t.width,delete t[Eg],!0}addEventListener(e,t,n){this.removeEventListener(e,t);const i=e.$proxies||(e.$proxies={}),o={attach:WB,detach:GB,resize:ZB}[t]||QB;i[t]=o(e,t,n)}removeEventListener(e,t){const n=e.$proxies||(e.$proxies={}),i=n[t];if(!i)return;({attach:c1,detach:c1,resize:c1}[t]||HB)(e,t,i),n[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,n,i){return zz(e,t,n,i)}isAttached(e){const t=e&&G2(e);return!!(t&&t.isConnected)}}function JB(r){return!W2()||typeof OffscreenCanvas<"u"&&r instanceof OffscreenCanvas?zB:XB}var rg;let Ua=(rg=class{constructor(){Je(this,"x");Je(this,"y");Je(this,"active",!1);Je(this,"options");Je(this,"$animations")}tooltipPosition(e){const{x:t,y:n}=this.getProps(["x","y"],e);return{x:t,y:n}}hasValue(){return om(this.x)&&om(this.y)}getProps(e,t){const n=this.$animations;if(!t||!n)return this;const i={};return e.forEach(s=>{i[s]=n[s]&&n[s].active()?n[s]._to:this[s]}),i}},Je(rg,"defaults",{}),Je(rg,"defaultRoutes"),rg);function eU(r,e){const t=r.options.ticks,n=tU(r),i=Math.min(t.maxTicksLimit||n,n),s=t.major.enabled?rU(e):[],o=s.length,l=s[0],d=s[o-1],f=[];if(o>i)return iU(e,f,s,o/i),f;const m=nU(s,e,i);if(o>0){let y,g;const _=o>1?Math.round((d-l)/(o-1)):null;for(Yp(e,f,m,on(_)?0:l-_,l),y=0,g=o-1;y<g;y++)Yp(e,f,m,s[y],s[y+1]);return Yp(e,f,m,d,on(_)?e.length:d+_),f}return Yp(e,f,m),f}function tU(r){const e=r.options.offset,t=r._tickSize(),n=r._length/t+(e?0:1),i=r._maxLength/t;return Math.floor(Math.min(n,i))}function nU(r,e,t){const n=sU(r),i=e.length/t;if(!n)return Math.max(i,1);const s=VV(n);for(let o=0,l=s.length-1;o<l;o++){const d=s[o];if(d>i)return d}return Math.max(i,1)}function rU(r){const e=[];let t,n;for(t=0,n=r.length;t<n;t++)r[t].major&&e.push(t);return e}function iU(r,e,t,n){let i=0,s=t[0],o;for(n=Math.ceil(n),o=0;o<r.length;o++)o===s&&(e.push(r[o]),i++,s=t[i*n])}function Yp(r,e,t,n,i){const s=Dt(n,0),o=Math.min(Dt(i,r.length),r.length);let l=0,d,f,m;for(t=Math.ceil(t),i&&(d=i-n,t=d/Math.floor(d/t)),m=s;m<0;)l++,m=Math.round(s+l*t);for(f=Math.max(s,0);f<o;f++)f===m&&(e.push(r[f]),l++,m=Math.round(s+l*t))}function sU(r){const e=r.length;let t,n;if(e<2)return!1;for(n=r[0],t=1;t<e;++t)if(r[t]-r[t-1]!==n)return!1;return n}const oU=r=>r==="left"?"right":r==="right"?"left":r,HA=(r,e,t)=>e==="top"||e==="left"?r[e]+t:r[e]-t,$A=(r,e)=>Math.min(e||r,r);function WA(r,e){const t=[],n=r.length/e,i=r.length;let s=0;for(;s<i;s+=n)t.push(r[Math.floor(s)]);return t}function aU(r,e,t){const n=r.ticks.length,i=Math.min(e,n-1),s=r._startPixel,o=r._endPixel,l=1e-6;let d=r.getPixelForTick(i),f;if(!(t&&(n===1?f=Math.max(d-s,o-d):e===0?f=(r.getPixelForTick(1)-d)/2:f=(d-r.getPixelForTick(i-1))/2,d+=i<e?f:-f,d<s-l||d>o+l)))return d}function lU(r,e){hn(r,t=>{const n=t.gc,i=n.length/2;let s;if(i>e){for(s=0;s<i;++s)delete t.data[n[s]];n.splice(0,i)}})}function Jh(r){return r.drawTicks?r.tickLength:0}function GA(r,e){if(!r.display)return 0;const t=Xr(r.font,e),n=Ls(r.padding);return(hr(r.text)?r.text.length:1)*t.lineHeight+n.height}function cU(r,e){return wu(r,{scale:e,type:"scale"})}function uU(r,e,t){return wu(r,{tick:t,index:e,type:"tick"})}function dU(r,e,t){let n=L2(r);return(t&&e!=="right"||!t&&e==="right")&&(n=oU(n)),n}function hU(r,e,t,n){const{top:i,left:s,bottom:o,right:l,chart:d}=r,{chartArea:f,scales:m}=d;let y=0,g,_,E;const x=o-i,b=l-s;if(r.isHorizontal()){if(_=Kr(n,s,l),Xt(t)){const T=Object.keys(t)[0],N=t[T];E=m[T].getPixelForValue(N)+x-e}else t==="center"?E=(f.bottom+f.top)/2+x-e:E=HA(r,t,e);g=l-s}else{if(Xt(t)){const T=Object.keys(t)[0],N=t[T];_=m[T].getPixelForValue(N)-b+e}else t==="center"?_=(f.left+f.right)/2-b+e:_=HA(r,t,e);E=Kr(n,o,i),y=t==="left"?-mr:mr}return{titleX:_,titleY:E,maxWidth:g,rotation:y}}class ah extends Ua{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:n,_suggestedMax:i}=this;return e=Ao(e,Number.POSITIVE_INFINITY),t=Ao(t,Number.NEGATIVE_INFINITY),n=Ao(n,Number.POSITIVE_INFINITY),i=Ao(i,Number.NEGATIVE_INFINITY),{min:Ao(e,n),max:Ao(t,i),minDefined:Ds(e),maxDefined:Ds(t)}}getMinMax(e){let{min:t,max:n,minDefined:i,maxDefined:s}=this.getUserBounds(),o;if(i&&s)return{min:t,max:n};const l=this.getMatchingVisibleMetas();for(let d=0,f=l.length;d<f;++d)o=l[d].controller.getMinMax(this,e),i||(t=Math.min(t,o.min)),s||(n=Math.max(n,o.max));return t=s&&t>n?n:t,n=i&&t>n?t:n,{min:Ao(t,Ao(n,t)),max:Ao(n,Ao(t,n))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){kn(this.options.beforeUpdate,[this])}update(e,t,n){const{beginAtZero:i,grace:s,ticks:o}=this.options,l=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=n=Object.assign({left:0,right:0,top:0,bottom:0},n),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+n.left+n.right:this.height+n.top+n.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=vz(this,s,i),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const d=l<this.ticks.length;this._convertTicksToLabels(d?WA(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=eU(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),d&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,n;this.isHorizontal()?(t=this.left,n=this.right):(t=this.top,n=this.bottom,e=!e),this._startPixel=t,this._endPixel=n,this._reversePixels=e,this._length=n-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){kn(this.options.afterUpdate,[this])}beforeSetDimensions(){kn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){kn(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),kn(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){kn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let n,i,s;for(n=0,i=e.length;n<i;n++)s=e[n],s.label=kn(t.callback,[s.value,n,e],this)}afterTickToLabelConversion(){kn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){kn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,n=$A(this.ticks.length,e.ticks.maxTicksLimit),i=t.minRotation||0,s=t.maxRotation;let o=i,l,d,f;if(!this._isVisible()||!t.display||i>=s||n<=1||!this.isHorizontal()){this.labelRotation=i;return}const m=this._getLabelSizes(),y=m.widest.width,g=m.highest.height,_=Qr(this.chart.width-y,0,this.maxWidth);l=e.offset?this.maxWidth/n:_/(n-1),y+6>l&&(l=_/(n-(e.offset?.5:1)),d=this.maxHeight-Jh(e.grid)-t.padding-GA(e.title,this.chart.options.font),f=Math.sqrt(y*y+g*g),o=qV(Math.min(Math.asin(Qr((m.highest.height+6)/l,-1,1)),Math.asin(Qr(d/f,-1,1))-Math.asin(Qr(g/f,-1,1)))),o=Math.max(i,Math.min(s,o))),this.labelRotation=o}afterCalculateLabelRotation(){kn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){kn(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:n,title:i,grid:s}}=this,o=this._isVisible(),l=this.isHorizontal();if(o){const d=GA(i,t.options.font);if(l?(e.width=this.maxWidth,e.height=Jh(s)+d):(e.height=this.maxHeight,e.width=Jh(s)+d),n.display&&this.ticks.length){const{first:f,last:m,widest:y,highest:g}=this._getLabelSizes(),_=n.padding*2,E=Ea(this.labelRotation),x=Math.cos(E),b=Math.sin(E);if(l){const T=n.mirror?0:b*y.width+x*g.height;e.height=Math.min(this.maxHeight,e.height+T+_)}else{const T=n.mirror?0:x*y.width+b*g.height;e.width=Math.min(this.maxWidth,e.width+T+_)}this._calculatePadding(f,m,b,x)}}this._handleMargins(),l?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,n,i){const{ticks:{align:s,padding:o},position:l}=this.options,d=this.labelRotation!==0,f=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const m=this.getPixelForTick(0)-this.left,y=this.right-this.getPixelForTick(this.ticks.length-1);let g=0,_=0;d?f?(g=i*e.width,_=n*t.height):(g=n*e.height,_=i*t.width):s==="start"?_=t.width:s==="end"?g=e.width:s!=="inner"&&(g=e.width/2,_=t.width/2),this.paddingLeft=Math.max((g-m+o)*this.width/(this.width-m),0),this.paddingRight=Math.max((_-y+o)*this.width/(this.width-y),0)}else{let m=t.height/2,y=e.height/2;s==="start"?(m=0,y=e.height):s==="end"&&(m=t.height,y=0),this.paddingTop=m+o,this.paddingBottom=y+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){kn(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,n;for(t=0,n=e.length;t<n;t++)on(e[t].label)&&(e.splice(t,1),n--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let n=this.ticks;t<n.length&&(n=WA(n,t)),this._labelSizes=e=this._computeLabelSizes(n,n.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,n){const{ctx:i,_longestTextCache:s}=this,o=[],l=[],d=Math.floor(t/$A(t,n));let f=0,m=0,y,g,_,E,x,b,T,N,R,I,j;for(y=0;y<t;y+=d){if(E=e[y].label,x=this._resolveTickFontOptions(y),i.font=b=x.string,T=s[b]=s[b]||{data:{},gc:[]},N=x.lineHeight,R=I=0,!on(E)&&!hr(E))R=xA(i,T.data,T.gc,R,E),I=N;else if(hr(E))for(g=0,_=E.length;g<_;++g)j=E[g],!on(j)&&!hr(j)&&(R=xA(i,T.data,T.gc,R,j),I+=N);o.push(R),l.push(I),f=Math.max(R,f),m=Math.max(I,m)}lU(s,t);const U=o.indexOf(f),C=l.indexOf(m),k=D=>({width:o[D]||0,height:l[D]||0});return{first:k(0),last:k(t-1),widest:k(U),highest:k(C),widths:o,heights:l}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return $V(this._alignToPixels?Lc(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const n=t[e];return n.$context||(n.$context=uU(this.getContext(),e,n))}return this.$context||(this.$context=cU(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=Ea(this.labelRotation),n=Math.abs(Math.cos(t)),i=Math.abs(Math.sin(t)),s=this._getLabelSizes(),o=e.autoSkipPadding||0,l=s?s.widest.width+o:0,d=s?s.highest.height+o:0;return this.isHorizontal()?d*n>l*i?l/n:d/i:d*i<l*n?d/n:l/i}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,n=this.chart,i=this.options,{grid:s,position:o,border:l}=i,d=s.offset,f=this.isHorizontal(),y=this.ticks.length+(d?1:0),g=Jh(s),_=[],E=l.setContext(this.getContext()),x=E.display?E.width:0,b=x/2,T=function(te){return Lc(n,te,x)};let N,R,I,j,U,C,k,D,O,P,F,M;if(o==="top")N=T(this.bottom),C=this.bottom-g,D=N-b,P=T(e.top)+b,M=e.bottom;else if(o==="bottom")N=T(this.top),P=e.top,M=T(e.bottom)-b,C=N+b,D=this.top+g;else if(o==="left")N=T(this.right),U=this.right-g,k=N-b,O=T(e.left)+b,F=e.right;else if(o==="right")N=T(this.left),O=e.left,F=T(e.right)-b,U=N+b,k=this.left+g;else if(t==="x"){if(o==="center")N=T((e.top+e.bottom)/2+.5);else if(Xt(o)){const te=Object.keys(o)[0],oe=o[te];N=T(this.chart.scales[te].getPixelForValue(oe))}P=e.top,M=e.bottom,C=N+b,D=C+g}else if(t==="y"){if(o==="center")N=T((e.left+e.right)/2);else if(Xt(o)){const te=Object.keys(o)[0],oe=o[te];N=T(this.chart.scales[te].getPixelForValue(oe))}U=N-b,k=U-g,O=e.left,F=e.right}const $=Dt(i.ticks.maxTicksLimit,y),Y=Math.max(1,Math.ceil(y/$));for(R=0;R<y;R+=Y){const te=this.getContext(R),oe=s.setContext(te),ie=l.setContext(te),ne=oe.lineWidth,K=oe.color,B=ie.dash||[],G=ie.dashOffset,X=oe.tickWidth,se=oe.tickColor,le=oe.tickBorderDash||[],Q=oe.tickBorderDashOffset;I=aU(this,R,d),I!==void 0&&(j=Lc(n,I,ne),f?U=k=O=F=j:C=D=P=M=j,_.push({tx1:U,ty1:C,tx2:k,ty2:D,x1:O,y1:P,x2:F,y2:M,width:ne,color:K,borderDash:B,borderDashOffset:G,tickWidth:X,tickColor:se,tickBorderDash:le,tickBorderDashOffset:Q}))}return this._ticksLength=y,this._borderValue=N,_}_computeLabelItems(e){const t=this.axis,n=this.options,{position:i,ticks:s}=n,o=this.isHorizontal(),l=this.ticks,{align:d,crossAlign:f,padding:m,mirror:y}=s,g=Jh(n.grid),_=g+m,E=y?-m:_,x=-Ea(this.labelRotation),b=[];let T,N,R,I,j,U,C,k,D,O,P,F,M="middle";if(i==="top")U=this.bottom-E,C=this._getXAxisLabelAlignment();else if(i==="bottom")U=this.top+E,C=this._getXAxisLabelAlignment();else if(i==="left"){const Y=this._getYAxisLabelAlignment(g);C=Y.textAlign,j=Y.x}else if(i==="right"){const Y=this._getYAxisLabelAlignment(g);C=Y.textAlign,j=Y.x}else if(t==="x"){if(i==="center")U=(e.top+e.bottom)/2+_;else if(Xt(i)){const Y=Object.keys(i)[0],te=i[Y];U=this.chart.scales[Y].getPixelForValue(te)+_}C=this._getXAxisLabelAlignment()}else if(t==="y"){if(i==="center")j=(e.left+e.right)/2-_;else if(Xt(i)){const Y=Object.keys(i)[0],te=i[Y];j=this.chart.scales[Y].getPixelForValue(te)}C=this._getYAxisLabelAlignment(g).textAlign}t==="y"&&(d==="start"?M="top":d==="end"&&(M="bottom"));const $=this._getLabelSizes();for(T=0,N=l.length;T<N;++T){R=l[T],I=R.label;const Y=s.setContext(this.getContext(T));k=this.getPixelForTick(T)+s.labelOffset,D=this._resolveTickFontOptions(T),O=D.lineHeight,P=hr(I)?I.length:1;const te=P/2,oe=Y.color,ie=Y.textStrokeColor,ne=Y.textStrokeWidth;let K=C;o?(j=k,C==="inner"&&(T===N-1?K=this.options.reverse?"left":"right":T===0?K=this.options.reverse?"right":"left":K="center"),i==="top"?f==="near"||x!==0?F=-P*O+O/2:f==="center"?F=-$.highest.height/2-te*O+O:F=-$.highest.height+O/2:f==="near"||x!==0?F=O/2:f==="center"?F=$.highest.height/2-te*O:F=$.highest.height-P*O,y&&(F*=-1),x!==0&&!Y.showLabelBackdrop&&(j+=O/2*Math.sin(x))):(U=k,F=(1-P)*O/2);let B;if(Y.showLabelBackdrop){const G=Ls(Y.backdropPadding),X=$.heights[T],se=$.widths[T];let le=F-G.top,Q=0-G.left;switch(M){case"middle":le-=X/2;break;case"bottom":le-=X;break}switch(C){case"center":Q-=se/2;break;case"right":Q-=se;break;case"inner":T===N-1?Q-=se:T>0&&(Q-=se/2);break}B={left:Q,top:le,width:se+G.width,height:X+G.height,color:Y.backdropColor}}b.push({label:I,font:D,textOffset:F,options:{rotation:x,color:oe,strokeColor:ie,strokeWidth:ne,textAlign:K,textBaseline:M,translation:[j,U],backdrop:B}})}return b}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-Ea(this.labelRotation))return e==="top"?"left":"right";let i="center";return t.align==="start"?i="left":t.align==="end"?i="right":t.align==="inner"&&(i="inner"),i}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:n,mirror:i,padding:s}}=this.options,o=this._getLabelSizes(),l=e+s,d=o.widest.width;let f,m;return t==="left"?i?(m=this.right+s,n==="near"?f="left":n==="center"?(f="center",m+=d/2):(f="right",m+=d)):(m=this.right-l,n==="near"?f="right":n==="center"?(f="center",m-=d/2):(f="left",m=this.left)):t==="right"?i?(m=this.left+s,n==="near"?f="right":n==="center"?(f="center",m-=d/2):(f="left",m-=d)):(m=this.left+l,n==="near"?f="left":n==="center"?(f="center",m+=d/2):(f="right",m=this.right)):f="right",{textAlign:f,x:m}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:n,top:i,width:s,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(n,i,s,o),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const i=this.ticks.findIndex(s=>s.value===e);return i>=0?t.setContext(this.getContext(i)).lineWidth:0}drawGrid(e){const t=this.options.grid,n=this.ctx,i=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let s,o;const l=(d,f,m)=>{!m.width||!m.color||(n.save(),n.lineWidth=m.width,n.strokeStyle=m.color,n.setLineDash(m.borderDash||[]),n.lineDashOffset=m.borderDashOffset,n.beginPath(),n.moveTo(d.x,d.y),n.lineTo(f.x,f.y),n.stroke(),n.restore())};if(t.display)for(s=0,o=i.length;s<o;++s){const d=i[s];t.drawOnChartArea&&l({x:d.x1,y:d.y1},{x:d.x2,y:d.y2},d),t.drawTicks&&l({x:d.tx1,y:d.ty1},{x:d.tx2,y:d.ty2},{color:d.tickColor,width:d.tickWidth,borderDash:d.tickBorderDash,borderDashOffset:d.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:n,grid:i}}=this,s=n.setContext(this.getContext()),o=n.display?s.width:0;if(!o)return;const l=i.setContext(this.getContext(0)).lineWidth,d=this._borderValue;let f,m,y,g;this.isHorizontal()?(f=Lc(e,this.left,o)-o/2,m=Lc(e,this.right,l)+l/2,y=g=d):(y=Lc(e,this.top,o)-o/2,g=Lc(e,this.bottom,l)+l/2,f=m=d),t.save(),t.lineWidth=s.width,t.strokeStyle=s.color,t.beginPath(),t.moveTo(f,y),t.lineTo(m,g),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const n=this.ctx,i=this._computeLabelArea();i&&z2(n,i);const s=this.getLabelItems(e);for(const o of s){const l=o.options,d=o.font,f=o.label,m=o.textOffset;cm(n,f,0,m,d,l)}i&&B2(n)}drawTitle(){const{ctx:e,options:{position:t,title:n,reverse:i}}=this;if(!n.display)return;const s=Xr(n.font),o=Ls(n.padding),l=n.align;let d=s.lineHeight/2;t==="bottom"||t==="center"||Xt(t)?(d+=o.bottom,hr(n.text)&&(d+=s.lineHeight*(n.text.length-1))):d+=o.top;const{titleX:f,titleY:m,maxWidth:y,rotation:g}=hU(this,d,t,l);cm(e,n.text,0,0,s,{color:n.color,maxWidth:y,rotation:g,textAlign:dU(l,t,i),textBaseline:"middle",translation:[f,m]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,n=Dt(e.grid&&e.grid.z,-1),i=Dt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==ah.prototype.draw?[{z:t,draw:s=>{this.draw(s)}}]:[{z:n,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:i,draw:()=>{this.drawBorder()}},{z:t,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),n=this.axis+"AxisID",i=[];let s,o;for(s=0,o=t.length;s<o;++s){const l=t[s];l[n]===this.id&&(!e||l.type===e)&&i.push(l)}return i}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return Xr(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Zp{constructor(e,t,n){this.type=e,this.scope=t,this.override=n,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let n;pU(t)&&(n=this.register(t));const i=this.items,s=e.id,o=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+e);return s in i||(i[s]=e,fU(e,o,n),this.override&&Qn.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,n=e.id,i=this.scope;n in t&&delete t[n],i&&n in Qn[i]&&(delete Qn[i][n],this.override&&delete yu[n])}}function fU(r,e,t){const n=im(Object.create(null),[t?Qn.get(t):{},Qn.get(e),r.defaults]);Qn.set(e,n),r.defaultRoutes&&mU(e,r.defaultRoutes),r.descriptors&&Qn.describe(e,r.descriptors)}function mU(r,e){Object.keys(e).forEach(t=>{const n=t.split("."),i=n.pop(),s=[r].concat(n).join("."),o=e[t].split("."),l=o.pop(),d=o.join(".");Qn.route(s,i,d,l)})}function pU(r){return"id"in r&&"defaults"in r}class gU{constructor(){this.controllers=new Zp(tu,"datasets",!0),this.elements=new Zp(Ua,"elements"),this.plugins=new Zp(Object,"plugins"),this.scales=new Zp(ah,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,n){[...t].forEach(i=>{const s=n||this._getRegistryForType(i);n||s.isForType(i)||s===this.plugins&&i.id?this._exec(e,s,i):hn(i,o=>{const l=n||this._getRegistryForType(o);this._exec(e,l,o)})})}_exec(e,t,n){const i=M2(e);kn(n["before"+i],[],n),t[e](n),kn(n["after"+i],[],n)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const n=this._typedRegistries[t];if(n.isForType(e))return n}return this.plugins}_get(e,t,n){const i=t.get(e);if(i===void 0)throw new Error('"'+e+'" is not a registered '+n+".");return i}}var Io=new gU;class yU{constructor(){this._init=void 0}notify(e,t,n,i){if(t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const s=i?this._descriptors(e).filter(i):this._descriptors(e),o=this._notify(s,e,t,n);return t==="afterDestroy"&&(this._notify(s,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),o}_notify(e,t,n,i){i=i||{};for(const s of e){const o=s.plugin,l=o[n],d=[t,i,s.options];if(kn(l,d,o)===!1&&i.cancelable)return!1}return!0}invalidate(){on(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const n=e&&e.config,i=Dt(n.options&&n.options.plugins,{}),s=vU(n);return i===!1&&!t?[]:xU(e,s,i,t)}_notifyStateChanges(e){const t=this._oldCache||[],n=this._cache,i=(s,o)=>s.filter(l=>!o.some(d=>l.plugin.id===d.plugin.id));this._notify(i(t,n),e,"stop"),this._notify(i(n,t),e,"start")}}function vU(r){const e={},t=[],n=Object.keys(Io.plugins.items);for(let s=0;s<n.length;s++)t.push(Io.getPlugin(n[s]));const i=r.plugins||[];for(let s=0;s<i.length;s++){const o=i[s];t.indexOf(o)===-1&&(t.push(o),e[o.id]=!0)}return{plugins:t,localIds:e}}function _U(r,e){return!e&&r===!1?null:r===!0?{}:r}function xU(r,{plugins:e,localIds:t},n,i){const s=[],o=r.getContext();for(const l of e){const d=l.id,f=_U(n[d],i);f!==null&&s.push({plugin:l,options:bU(r.config,{plugin:l,local:t[d]},f,o)})}return s}function bU(r,{plugin:e,local:t},n,i){const s=r.pluginScopeKeys(e),o=r.getOptionScopes(n,s);return t&&e.defaults&&o.push(e.defaults),r.createResolver(o,i,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function $x(r,e){const t=Qn.datasets[r]||{};return((e.datasets||{})[r]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function wU(r,e){let t=r;return r==="_index_"?t=e:r==="_value_"&&(t=e==="x"?"y":"x"),t}function EU(r,e){return r===e?"_index_":"_value_"}function KA(r){if(r==="x"||r==="y"||r==="r")return r}function SU(r){if(r==="top"||r==="bottom")return"x";if(r==="left"||r==="right")return"y"}function Wx(r,...e){if(KA(r))return r;for(const t of e){const n=t.axis||SU(t.position)||r.length>1&&KA(r[0].toLowerCase());if(n)return n}throw new Error(`Cannot determine type of '${r}' axis. Please provide 'axis' or 'position' option.`)}function YA(r,e,t){if(t[e+"AxisID"]===r)return{axis:e}}function TU(r,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(n=>n.xAxisID===r||n.yAxisID===r);if(t.length)return YA(r,"x",t[0])||YA(r,"y",t[0])}return{}}function AU(r,e){const t=yu[r.type]||{scales:{}},n=e.scales||{},i=$x(r.type,e),s=Object.create(null);return Object.keys(n).forEach(o=>{const l=n[o];if(!Xt(l))return console.error(`Invalid scale configuration for scale: ${o}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const d=Wx(o,l,TU(o,r),Qn.scales[l.type]),f=EU(d,i),m=t.scales||{};s[o]=Rf(Object.create(null),[{axis:d},l,m[d],m[f]])}),r.data.datasets.forEach(o=>{const l=o.type||r.type,d=o.indexAxis||$x(l,e),m=(yu[l]||{}).scales||{};Object.keys(m).forEach(y=>{const g=wU(y,d),_=o[g+"AxisID"]||g;s[_]=s[_]||Object.create(null),Rf(s[_],[{axis:g},n[_],m[y]])})}),Object.keys(s).forEach(o=>{const l=s[o];Rf(l,[Qn.scales[l.type],Qn.scale])}),s}function nR(r){const e=r.options||(r.options={});e.plugins=Dt(e.plugins,{}),e.scales=AU(r,e)}function rR(r){return r=r||{},r.datasets=r.datasets||[],r.labels=r.labels||[],r}function NU(r){return r=r||{},r.data=rR(r.data),nR(r),r}const ZA=new Map,iR=new Set;function Qp(r,e){let t=ZA.get(r);return t||(t=e(),ZA.set(r,t),iR.add(t)),t}const ef=(r,e,t)=>{const n=gu(e,t);n!==void 0&&r.add(n)};class IU{constructor(e){this._config=NU(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=rR(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),nR(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Qp(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return Qp(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return Qp(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,n=this.type;return Qp(`${n}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const n=this._scopeCache;let i=n.get(e);return(!i||t)&&(i=new Map,n.set(e,i)),i}getOptionScopes(e,t,n){const{options:i,type:s}=this,o=this._cachedScopes(e,n),l=o.get(t);if(l)return l;const d=new Set;t.forEach(m=>{e&&(d.add(e),m.forEach(y=>ef(d,e,y))),m.forEach(y=>ef(d,i,y)),m.forEach(y=>ef(d,yu[s]||{},y)),m.forEach(y=>ef(d,Qn,y)),m.forEach(y=>ef(d,Ux,y))});const f=Array.from(d);return f.length===0&&f.push(Object.create(null)),iR.has(t)&&o.set(t,f),f}chartOptionScopes(){const{options:e,type:t}=this;return[e,yu[t]||{},Qn.datasets[t]||{},{type:t},Qn,Ux]}resolveNamedOptions(e,t,n,i=[""]){const s={$shared:!0},{resolver:o,subPrefixes:l}=QA(this._resolverCache,e,i);let d=o;if(PU(o,t)){s.$shared=!1,n=sc(n)?n():n;const f=this.createResolver(e,n,l);d=qd(o,n,f)}for(const f of t)s[f]=d[f];return s}createResolver(e,t,n=[""],i){const{resolver:s}=QA(this._resolverCache,e,n);return Xt(t)?qd(s,t,void 0,i):s}}function QA(r,e,t){let n=r.get(e);n||(n=new Map,r.set(e,n));const i=t.join();let s=n.get(i);return s||(s={resolver:q2(e,t),subPrefixes:t.filter(l=>!l.toLowerCase().includes("hover"))},n.set(i,s)),s}const kU=r=>Xt(r)&&Object.getOwnPropertyNames(r).some(e=>sc(r[e]));function PU(r,e){const{isScriptable:t,isIndexable:n}=z3(r);for(const i of e){const s=t(i),o=n(i),l=(o||s)&&r[i];if(s&&(sc(l)||kU(l))||o&&hr(l))return!0}return!1}var CU="4.5.1";const RU=["top","bottom","left","right","chartArea"];function XA(r,e){return r==="top"||r==="bottom"||RU.indexOf(r)===-1&&e==="x"}function JA(r,e){return function(t,n){return t[r]===n[r]?t[e]-n[e]:t[r]-n[r]}}function eN(r){const e=r.chart,t=e.options.animation;e.notifyPlugins("afterRender"),kn(t&&t.onComplete,[r],e)}function jU(r){const e=r.chart,t=e.options.animation;kn(t&&t.onProgress,[r],e)}function sR(r){return W2()&&typeof r=="string"?r=document.getElementById(r):r&&r.length&&(r=r[0]),r&&r.canvas&&(r=r.canvas),r}const Sg={},tN=r=>{const e=sR(r);return Object.values(Sg).filter(t=>t.canvas===e).pop()};function OU(r,e,t){const n=Object.keys(r);for(const i of n){const s=+i;if(s>=e){const o=r[i];delete r[i],(t>0||s>e)&&(r[s+t]=o)}}}function MU(r,e,t,n){return!t||r.type==="mouseout"?null:n?e:r}var Pl;let Eu=(Pl=class{static register(...e){Io.add(...e),nN()}static unregister(...e){Io.remove(...e),nN()}constructor(e,t){const n=this.config=new IU(t),i=sR(e),s=tN(i);if(s)throw new Error("Canvas is already in use. Chart with ID '"+s.id+"' must be destroyed before the canvas with ID '"+s.canvas.id+"' can be reused.");const o=n.createResolver(n.chartOptionScopes(),this.getContext());this.platform=new(n.platform||JB(i)),this.platform.updateConfig(n);const l=this.platform.acquireContext(i,o.aspectRatio),d=l&&l.canvas,f=d&&d.height,m=d&&d.width;if(this.id=PV(),this.ctx=l,this.canvas=d,this.width=m,this.height=f,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new yU,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=YV(y=>this.update(y),o.resizeDelay||0),this._dataChanges=[],Sg[this.id]=this,!l||!d){console.error("Failed to create chart: can't acquire context from the given item");return}pa.listen(this,"complete",eN),pa.listen(this,"progress",jU),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:n,height:i,_aspectRatio:s}=this;return on(e)?t&&s?s:i?n/i:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Io}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():SA(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return bA(this.canvas,this.ctx),this}stop(){return pa.stop(this),this}resize(e,t){pa.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const n=this.options,i=this.canvas,s=n.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(i,e,t,s),l=n.devicePixelRatio||this.platform.getDevicePixelRatio(),d=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,SA(this,l,!0)&&(this.notifyPlugins("resize",{size:o}),kn(n.onResize,[this,o],this),this.attached&&this._doResize(d)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};hn(t,(n,i)=>{n.id=i})}buildOrUpdateScales(){const e=this.options,t=e.scales,n=this.scales,i=Object.keys(n).reduce((o,l)=>(o[l]=!1,o),{});let s=[];t&&(s=s.concat(Object.keys(t).map(o=>{const l=t[o],d=Wx(o,l),f=d==="r",m=d==="x";return{options:l,dposition:f?"chartArea":m?"bottom":"left",dtype:f?"radialLinear":m?"category":"linear"}}))),hn(s,o=>{const l=o.options,d=l.id,f=Wx(d,l),m=Dt(l.type,o.dtype);(l.position===void 0||XA(l.position,f)!==XA(o.dposition))&&(l.position=o.dposition),i[d]=!0;let y=null;if(d in n&&n[d].type===m)y=n[d];else{const g=Io.getScale(m);y=new g({id:d,type:m,ctx:this.ctx,chart:this}),n[y.id]=y}y.init(l,e)}),hn(i,(o,l)=>{o||delete n[l]}),hn(n,o=>{Ns.configure(this,o,o.options),Ns.addBox(this,o)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,n=e.length;if(e.sort((i,s)=>i.index-s.index),n>t){for(let i=t;i<n;++i)this._destroyDatasetMeta(i);e.splice(t,n-t)}this._sortedMetasets=e.slice(0).sort(JA("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((n,i)=>{t.filter(s=>s===n._dataset).length===0&&this._destroyDatasetMeta(i)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let n,i;for(this._removeUnreferencedMetasets(),n=0,i=t.length;n<i;n++){const s=t[n];let o=this.getDatasetMeta(n);const l=s.type||this.config.type;if(o.type&&o.type!==l&&(this._destroyDatasetMeta(n),o=this.getDatasetMeta(n)),o.type=l,o.indexAxis=s.indexAxis||$x(l,this.options),o.order=s.order||0,o.index=n,o.label=""+s.label,o.visible=this.isDatasetVisible(n),o.controller)o.controller.updateIndex(n),o.controller.linkScales();else{const d=Io.getController(l),{datasetElementType:f,dataElementType:m}=Qn.datasets[l];Object.assign(d,{dataElementType:Io.getElement(m),datasetElementType:f&&Io.getElement(f)}),o.controller=new d(this,n),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){hn(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const n=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),i=this._animationsDisabled=!n.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const s=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let f=0,m=this.data.datasets.length;f<m;f++){const{controller:y}=this.getDatasetMeta(f),g=!i&&s.indexOf(y)===-1;y.buildOrUpdateElements(g),o=Math.max(+y.getMaxOverflow(),o)}o=this._minPadding=n.layout.autoPadding?o:0,this._updateLayout(o),i||hn(s,f=>{f.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(JA("z","_idx"));const{_active:l,_lastEvent:d}=this;d?this._eventHandler(d,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){hn(this.scales,e=>{Ns.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),n=new Set(e.events);(!dA(t,n)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:n,start:i,count:s}of t){const o=n==="_removeElements"?-s:s;OU(e,i,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,n=s=>new Set(e.filter(o=>o[0]===s).map((o,l)=>l+","+o.splice(1).join(","))),i=n(0);for(let s=1;s<t;s++)if(!dA(i,n(s)))return;return Array.from(i).map(s=>s.split(",")).map(s=>({method:s[1],start:+s[2],count:+s[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Ns.update(this,this.width,this.height,e);const t=this.chartArea,n=t.width<=0||t.height<=0;this._layers=[],hn(this.boxes,i=>{n&&i.position==="chartArea"||(i.configure&&i.configure(),this._layers.push(...i._layers()))},this),this._layers.forEach((i,s)=>{i._idx=s}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,n=this.data.datasets.length;t<n;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,n=this.data.datasets.length;t<n;++t)this._updateDataset(t,sc(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const n=this.getDatasetMeta(e),i={meta:n,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",i)!==!1&&(n.controller._update(t),i.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",i))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(pa.has(this)?this.attached&&!pa.running(this)&&pa.start(this):(this.draw(),eN({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:n,height:i}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(n,i)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,n=[];let i,s;for(i=0,s=t.length;i<s;++i){const o=t[i];(!e||o.visible)&&n.push(o)}return n}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,n={meta:e,index:e.index,cancelable:!0},i=tB(this,e);this.notifyPlugins("beforeDatasetDraw",n)!==!1&&(i&&z2(t,i),e.controller.draw(),i&&B2(t),n.cancelable=!1,this.notifyPlugins("afterDatasetDraw",n))}isPointInArea(e){return lm(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,n,i){const s=RB.modes[t];return typeof s=="function"?s(this,e,n,i):[]}getDatasetMeta(e){const t=this.data.datasets[e],n=this._metasets;let i=n.filter(s=>s&&s._dataset===t).pop();return i||(i={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},n.push(i)),i}getContext(){return this.$context||(this.$context=wu(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const n=this.getDatasetMeta(e);return typeof n.hidden=="boolean"?!n.hidden:!t.hidden}setDatasetVisibility(e,t){const n=this.getDatasetMeta(e);n.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,n){const i=n?"show":"hide",s=this.getDatasetMeta(e),o=s.controller._resolveAnimations(void 0,i);sm(t)?(s.data[t].hidden=!n,this.update()):(this.setDatasetVisibility(e,n),o.update(s,{visible:n}),this.update(l=>l.datasetIndex===e?i:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),pa.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),bA(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete Sg[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,n=(s,o)=>{t.addEventListener(this,s,o),e[s]=o},i=(s,o,l)=>{s.offsetX=o,s.offsetY=l,this._eventHandler(s)};hn(this.options.events,s=>n(s,i))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,n=(d,f)=>{t.addEventListener(this,d,f),e[d]=f},i=(d,f)=>{e[d]&&(t.removeEventListener(this,d,f),delete e[d])},s=(d,f)=>{this.canvas&&this.resize(d,f)};let o;const l=()=>{i("attach",l),this.attached=!0,this.resize(),n("resize",s),n("detach",o)};o=()=>{this.attached=!1,i("resize",s),this._stop(),this._resize(0,0),n("attach",l)},t.isAttached(this.canvas)?l():o()}unbindEvents(){hn(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},hn(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,n){const i=n?"set":"remove";let s,o,l,d;for(t==="dataset"&&(s=this.getDatasetMeta(e[0].datasetIndex),s.controller["_"+i+"DatasetHoverStyle"]()),l=0,d=e.length;l<d;++l){o=e[l];const f=o&&this.getDatasetMeta(o.datasetIndex).controller;f&&f[i+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],n=e.map(({datasetIndex:s,index:o})=>{const l=this.getDatasetMeta(s);if(!l)throw new Error("No dataset found at index "+s);return{datasetIndex:s,element:l.data[o],index:o}});!ay(n,t)&&(this._active=n,this._lastEvent=null,this._updateHoverStyles(n,t))}notifyPlugins(e,t,n){return this._plugins.notify(this,e,t,n)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,n){const i=this.options.hover,s=(d,f)=>d.filter(m=>!f.some(y=>m.datasetIndex===y.datasetIndex&&m.index===y.index)),o=s(t,e),l=n?e:s(e,t);o.length&&this.updateHoverStyle(o,i.mode,!1),l.length&&i.mode&&this.updateHoverStyle(l,i.mode,!0)}_eventHandler(e,t){const n={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},i=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",n,i)===!1)return;const s=this._handleEvent(e,t,n.inChartArea);return n.cancelable=!1,this.notifyPlugins("afterEvent",n,i),(s||n.changed)&&this.render(),this}_handleEvent(e,t,n){const{_active:i=[],options:s}=this,o=t,l=this._getActiveElements(e,i,n,o),d=DV(e),f=MU(e,this._lastEvent,n,d);n&&(this._lastEvent=null,kn(s.onHover,[e,l,this],this),d&&kn(s.onClick,[e,l,this],this));const m=!ay(l,i);return(m||t)&&(this._active=l,this._updateHoverStyles(l,i,t)),this._lastEvent=f,m}_getActiveElements(e,t,n,i){if(e.type==="mouseout")return[];if(!n)return t;const s=this.options.hover;return this.getElementsAtEventForMode(e,s.mode,s,i)}},Je(Pl,"defaults",Qn),Je(Pl,"instances",Sg),Je(Pl,"overrides",yu),Je(Pl,"registry",Io),Je(Pl,"version",CU),Je(Pl,"getChart",tN),Pl);function nN(){return hn(Eu.instances,r=>r._plugins.invalidate())}function DU(r,e,t){const{startAngle:n,x:i,y:s,outerRadius:o,innerRadius:l,options:d}=e,{borderWidth:f,borderJoinStyle:m}=d,y=Math.min(f/o,so(n-t));if(r.beginPath(),r.arc(i,s,o-f/2,n+y/2,t-y/2),l>0){const g=Math.min(f/l,so(n-t));r.arc(i,s,l+f/2,t-g/2,n+g/2,!0)}else{const g=Math.min(f/2,o*so(n-t));if(m==="round")r.arc(i,s,g,t-fn/2,n+fn/2,!0);else if(m==="bevel"){const _=2*g*g,E=-_*Math.cos(t+fn/2)+i,x=-_*Math.sin(t+fn/2)+s,b=_*Math.cos(n+fn/2)+i,T=_*Math.sin(n+fn/2)+s;r.lineTo(E,x),r.lineTo(b,T)}}r.closePath(),r.moveTo(0,0),r.rect(0,0,r.canvas.width,r.canvas.height),r.clip("evenodd")}function LU(r,e,t){const{startAngle:n,pixelMargin:i,x:s,y:o,outerRadius:l,innerRadius:d}=e;let f=i/l;r.beginPath(),r.arc(s,o,l,n-f,t+f),d>i?(f=i/d,r.arc(s,o,d,t+f,n-f,!0)):r.arc(s,o,i,t+mr,n-mr),r.closePath(),r.clip()}function FU(r){return U2(r,["outerStart","outerEnd","innerStart","innerEnd"])}function VU(r,e,t,n){const i=FU(r.options.borderRadius),s=(t-e)/2,o=Math.min(s,n*e/2),l=d=>{const f=(t-Math.min(s,d))*n/2;return Qr(d,0,Math.min(s,f))};return{outerStart:l(i.outerStart),outerEnd:l(i.outerEnd),innerStart:Qr(i.innerStart,0,o),innerEnd:Qr(i.innerEnd,0,o)}}function od(r,e,t,n){return{x:t+r*Math.cos(e),y:n+r*Math.sin(e)}}function fy(r,e,t,n,i,s){const{x:o,y:l,startAngle:d,pixelMargin:f,innerRadius:m}=e,y=Math.max(e.outerRadius+n+t-f,0),g=m>0?m+n+t+f:0;let _=0;const E=i-d;if(n){const Y=m>0?m-n:0,te=y>0?y-n:0,oe=(Y+te)/2,ie=oe!==0?E*oe/(oe+n):E;_=(E-ie)/2}const x=Math.max(.001,E*y-t/fn)/y,b=(E-x)/2,T=d+b+_,N=i-b-_,{outerStart:R,outerEnd:I,innerStart:j,innerEnd:U}=VU(e,g,y,N-T),C=y-R,k=y-I,D=T+R/C,O=N-I/k,P=g+j,F=g+U,M=T+j/P,$=N-U/F;if(r.beginPath(),s){const Y=(D+O)/2;if(r.arc(o,l,y,D,Y),r.arc(o,l,y,Y,O),I>0){const ne=od(k,O,o,l);r.arc(ne.x,ne.y,I,O,N+mr)}const te=od(F,N,o,l);if(r.lineTo(te.x,te.y),U>0){const ne=od(F,$,o,l);r.arc(ne.x,ne.y,U,N+mr,$+Math.PI)}const oe=(N-U/g+(T+j/g))/2;if(r.arc(o,l,g,N-U/g,oe,!0),r.arc(o,l,g,oe,T+j/g,!0),j>0){const ne=od(P,M,o,l);r.arc(ne.x,ne.y,j,M+Math.PI,T-mr)}const ie=od(C,T,o,l);if(r.lineTo(ie.x,ie.y),R>0){const ne=od(C,D,o,l);r.arc(ne.x,ne.y,R,T-mr,D)}}else{r.moveTo(o,l);const Y=Math.cos(D)*y+o,te=Math.sin(D)*y+l;r.lineTo(Y,te);const oe=Math.cos(O)*y+o,ie=Math.sin(O)*y+l;r.lineTo(oe,ie)}r.closePath()}function zU(r,e,t,n,i){const{fullCircles:s,startAngle:o,circumference:l}=e;let d=e.endAngle;if(s){fy(r,e,t,n,d,i);for(let f=0;f<s;++f)r.fill();isNaN(l)||(d=o+(l%$n||$n))}return fy(r,e,t,n,d,i),r.fill(),d}function BU(r,e,t,n,i){const{fullCircles:s,startAngle:o,circumference:l,options:d}=e,{borderWidth:f,borderJoinStyle:m,borderDash:y,borderDashOffset:g,borderRadius:_}=d,E=d.borderAlign==="inner";if(!f)return;r.setLineDash(y||[]),r.lineDashOffset=g,E?(r.lineWidth=f*2,r.lineJoin=m||"round"):(r.lineWidth=f,r.lineJoin=m||"bevel");let x=e.endAngle;if(s){fy(r,e,t,n,x,i);for(let b=0;b<s;++b)r.stroke();isNaN(l)||(x=o+(l%$n||$n))}E&&LU(r,e,x),d.selfJoin&&x-o>=fn&&_===0&&m!=="miter"&&DU(r,e,x),s||(fy(r,e,t,n,x,i),r.stroke())}class gd extends Ua{constructor(t){super();Je(this,"circumference");Je(this,"endAngle");Je(this,"fullCircles");Je(this,"innerRadius");Je(this,"outerRadius");Je(this,"pixelMargin");Je(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,n,i){const s=this.getProps(["x","y"],i),{angle:o,distance:l}=R3(s,{x:t,y:n}),{startAngle:d,endAngle:f,innerRadius:m,outerRadius:y,circumference:g}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),_=(this.options.spacing+this.options.borderWidth)/2,E=Dt(g,f-d),x=am(o,d,f)&&d!==f,b=E>=$n||x,T=Vl(l,m+_,y+_);return b&&T}getCenterPoint(t){const{x:n,y:i,startAngle:s,endAngle:o,innerRadius:l,outerRadius:d}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:f,spacing:m}=this.options,y=(s+o)/2,g=(l+d+m+f)/2;return{x:n+Math.cos(y)*g,y:i+Math.sin(y)*g}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:n,circumference:i}=this,s=(n.offset||0)/4,o=(n.spacing||0)/2,l=n.circular;if(this.pixelMargin=n.borderAlign==="inner"?.33:0,this.fullCircles=i>$n?Math.floor(i/$n):0,i===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const d=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(d)*s,Math.sin(d)*s);const f=1-Math.sin(Math.min(fn,i||0)),m=s*f;t.fillStyle=n.backgroundColor,t.strokeStyle=n.borderColor,zU(t,this,m,o,l),BU(t,this,m,o,l),t.restore()}}Je(gd,"id","arc"),Je(gd,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),Je(gd,"defaultRoutes",{backgroundColor:"backgroundColor"}),Je(gd,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"});function oR(r,e,t=e){r.lineCap=Dt(t.borderCapStyle,e.borderCapStyle),r.setLineDash(Dt(t.borderDash,e.borderDash)),r.lineDashOffset=Dt(t.borderDashOffset,e.borderDashOffset),r.lineJoin=Dt(t.borderJoinStyle,e.borderJoinStyle),r.lineWidth=Dt(t.borderWidth,e.borderWidth),r.strokeStyle=Dt(t.borderColor,e.borderColor)}function UU(r,e,t){r.lineTo(t.x,t.y)}function qU(r){return r.stepped?cz:r.tension||r.cubicInterpolationMode==="monotone"?uz:UU}function aR(r,e,t={}){const n=r.length,{start:i=0,end:s=n-1}=t,{start:o,end:l}=e,d=Math.max(i,o),f=Math.min(s,l),m=i<o&&s<o||i>l&&s>l;return{count:n,start:d,loop:e.loop,ilen:f<d&&!m?n+f-d:f-d}}function HU(r,e,t,n){const{points:i,options:s}=e,{count:o,start:l,loop:d,ilen:f}=aR(i,t,n),m=qU(s);let{move:y=!0,reverse:g}=n||{},_,E,x;for(_=0;_<=f;++_)E=i[(l+(g?f-_:_))%o],!E.skip&&(y?(r.moveTo(E.x,E.y),y=!1):m(r,x,E,g,s.stepped),x=E);return d&&(E=i[(l+(g?f:0))%o],m(r,x,E,g,s.stepped)),!!d}function $U(r,e,t,n){const i=e.points,{count:s,start:o,ilen:l}=aR(i,t,n),{move:d=!0,reverse:f}=n||{};let m=0,y=0,g,_,E,x,b,T;const N=I=>(o+(f?l-I:I))%s,R=()=>{x!==b&&(r.lineTo(m,b),r.lineTo(m,x),r.lineTo(m,T))};for(d&&(_=i[N(0)],r.moveTo(_.x,_.y)),g=0;g<=l;++g){if(_=i[N(g)],_.skip)continue;const I=_.x,j=_.y,U=I|0;U===E?(j<x?x=j:j>b&&(b=j),m=(y*m+I)/++y):(R(),r.lineTo(I,j),E=U,y=0,x=b=j),T=j}R()}function Gx(r){const e=r.options,t=e.borderDash&&e.borderDash.length;return!r._decimated&&!r._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?$U:HU}function WU(r){return r.stepped?Uz:r.tension||r.cubicInterpolationMode==="monotone"?qz:qc}function GU(r,e,t,n){let i=e._path;i||(i=e._path=new Path2D,e.path(i,t,n)&&i.closePath()),oR(r,e.options),r.stroke(i)}function KU(r,e,t,n){const{segments:i,options:s}=e,o=Gx(e);for(const l of i)oR(r,s,l.style),r.beginPath(),o(r,e,l,{start:t,end:t+n-1})&&r.closePath(),r.stroke()}const YU=typeof Path2D=="function";function ZU(r,e,t,n){YU&&!e.options.segment?GU(r,e,t,n):KU(r,e,t,n)}class gf extends Ua{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const n=this.options;if((n.tension||n.cubicInterpolationMode==="monotone")&&!n.stepped&&!this._pointsUpdated){const i=n.spanGaps?this._loop:this._fullLoop;Oz(this._points,n,e,i,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Qz(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,n=e.length;return n&&t[e[n-1].end]}interpolate(e,t){const n=this.options,i=e[t],s=this.points,o=Kz(this,{property:t,start:i,end:i});if(!o.length)return;const l=[],d=WU(n);let f,m;for(f=0,m=o.length;f<m;++f){const{start:y,end:g}=o[f],_=s[y],E=s[g];if(_===E){l.push(_);continue}const x=Math.abs((i-_[t])/(E[t]-_[t])),b=d(_,E,x,n.stepped);b[t]=e[t],l.push(b)}return l.length===1?l[0]:l}pathSegment(e,t,n){return Gx(this)(e,this,t,n)}path(e,t,n){const i=this.segments,s=Gx(this);let o=this._loop;t=t||0,n=n||this.points.length-t;for(const l of i)o&=s(e,this,l,{start:t,end:t+n-1});return!!o}draw(e,t,n,i){const s=this.options||{};(this.points||[]).length&&s.borderWidth&&(e.save(),ZU(e,this,n,i),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Je(gf,"id","line"),Je(gf,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Je(gf,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Je(gf,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function rN(r,e,t,n){const i=r.options,{[t]:s}=r.getProps([t],n);return Math.abs(e-s)<i.radius+i.hitRadius}class Tg extends Ua{constructor(t){super();Je(this,"parsed");Je(this,"skip");Je(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,n,i){const s=this.options,{x:o,y:l}=this.getProps(["x","y"],i);return Math.pow(t-o,2)+Math.pow(n-l,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(t,n){return rN(this,t,"x",n)}inYRange(t,n){return rN(this,t,"y",n)}getCenterPoint(t){const{x:n,y:i}=this.getProps(["x","y"],t);return{x:n,y:i}}size(t){t=t||this.options||{};let n=t.radius||0;n=Math.max(n,n&&t.hoverRadius||0);const i=n&&t.borderWidth||0;return(n+i)*2}draw(t,n){const i=this.options;this.skip||i.radius<.1||!lm(this,n,this.size(i)/2)||(t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.fillStyle=i.backgroundColor,qx(t,i,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}Je(Tg,"id","point"),Je(Tg,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Je(Tg,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function lR(r,e){const{x:t,y:n,base:i,width:s,height:o}=r.getProps(["x","y","base","width","height"],e);let l,d,f,m,y;return r.horizontal?(y=o/2,l=Math.min(t,i),d=Math.max(t,i),f=n-y,m=n+y):(y=s/2,l=t-y,d=t+y,f=Math.min(n,i),m=Math.max(n,i)),{left:l,top:f,right:d,bottom:m}}function Bl(r,e,t,n){return r?0:Qr(e,t,n)}function QU(r,e,t){const n=r.options.borderWidth,i=r.borderSkipped,s=V3(n);return{t:Bl(i.top,s.top,0,t),r:Bl(i.right,s.right,0,e),b:Bl(i.bottom,s.bottom,0,t),l:Bl(i.left,s.left,0,e)}}function XU(r,e,t){const{enableBorderRadius:n}=r.getProps(["enableBorderRadius"]),i=r.options.borderRadius,s=wd(i),o=Math.min(e,t),l=r.borderSkipped,d=n||Xt(i);return{topLeft:Bl(!d||l.top||l.left,s.topLeft,0,o),topRight:Bl(!d||l.top||l.right,s.topRight,0,o),bottomLeft:Bl(!d||l.bottom||l.left,s.bottomLeft,0,o),bottomRight:Bl(!d||l.bottom||l.right,s.bottomRight,0,o)}}function JU(r){const e=lR(r),t=e.right-e.left,n=e.bottom-e.top,i=QU(r,t/2,n/2),s=XU(r,t/2,n/2);return{outer:{x:e.left,y:e.top,w:t,h:n,radius:s},inner:{x:e.left+i.l,y:e.top+i.t,w:t-i.l-i.r,h:n-i.t-i.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(i.t,i.l)),topRight:Math.max(0,s.topRight-Math.max(i.t,i.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(i.b,i.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(i.b,i.r))}}}}function u1(r,e,t,n){const i=e===null,s=t===null,l=r&&!(i&&s)&&lR(r,n);return l&&(i||Vl(e,l.left,l.right))&&(s||Vl(t,l.top,l.bottom))}function eq(r){return r.topLeft||r.topRight||r.bottomLeft||r.bottomRight}function tq(r,e){r.rect(e.x,e.y,e.w,e.h)}function d1(r,e,t={}){const n=r.x!==t.x?-e:0,i=r.y!==t.y?-e:0,s=(r.x+r.w!==t.x+t.w?e:0)-n,o=(r.y+r.h!==t.y+t.h?e:0)-i;return{x:r.x+n,y:r.y+i,w:r.w+s,h:r.h+o,radius:r.radius}}class Df extends Ua{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:n,backgroundColor:i}}=this,{inner:s,outer:o}=JU(this),l=eq(o.radius)?uy:tq;e.save(),(o.w!==s.w||o.h!==s.h)&&(e.beginPath(),l(e,d1(o,t,s)),e.clip(),l(e,d1(s,-t,o)),e.fillStyle=n,e.fill("evenodd")),e.beginPath(),l(e,d1(s,t)),e.fillStyle=i,e.fill(),e.restore()}inRange(e,t,n){return u1(this,e,t,n)}inXRange(e,t){return u1(this,e,null,t)}inYRange(e,t){return u1(this,null,e,t)}getCenterPoint(e){const{x:t,y:n,base:i,horizontal:s}=this.getProps(["x","y","base","horizontal"],e);return{x:s?(t+i)/2:t,y:s?n:(n+i)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}Je(Df,"id","bar"),Je(Df,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),Je(Df,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const iN=(r,e)=>{let{boxHeight:t=e,boxWidth:n=e}=r;return r.usePointStyle&&(t=Math.min(t,e),n=r.pointStyleWidth||Math.min(n,e)),{boxWidth:n,boxHeight:t,itemHeight:Math.max(e,t)}},nq=(r,e)=>r!==null&&e!==null&&r.datasetIndex===e.datasetIndex&&r.index===e.index;class sN extends Ua{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,n){this.maxWidth=e,this.maxHeight=t,this._margins=n,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=kn(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(n=>e.filter(n,this.chart.data))),e.sort&&(t=t.sort((n,i)=>e.sort(n,i,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const n=e.labels,i=Xr(n.font),s=i.size,o=this._computeTitleHeight(),{boxWidth:l,itemHeight:d}=iN(n,s);let f,m;t.font=i.string,this.isHorizontal()?(f=this.maxWidth,m=this._fitRows(o,s,l,d)+10):(m=this.maxHeight,f=this._fitCols(o,i,l,d)+10),this.width=Math.min(f,e.maxWidth||this.maxWidth),this.height=Math.min(m,e.maxHeight||this.maxHeight)}_fitRows(e,t,n,i){const{ctx:s,maxWidth:o,options:{labels:{padding:l}}}=this,d=this.legendHitBoxes=[],f=this.lineWidths=[0],m=i+l;let y=e;s.textAlign="left",s.textBaseline="middle";let g=-1,_=-m;return this.legendItems.forEach((E,x)=>{const b=n+t/2+s.measureText(E.text).width;(x===0||f[f.length-1]+b+2*l>o)&&(y+=m,f[f.length-(x>0?0:1)]=0,_+=m,g++),d[x]={left:0,top:_,row:g,width:b,height:i},f[f.length-1]+=b+l}),y}_fitCols(e,t,n,i){const{ctx:s,maxHeight:o,options:{labels:{padding:l}}}=this,d=this.legendHitBoxes=[],f=this.columnSizes=[],m=o-e;let y=l,g=0,_=0,E=0,x=0;return this.legendItems.forEach((b,T)=>{const{itemWidth:N,itemHeight:R}=rq(n,t,s,b,i);T>0&&_+R+2*l>m&&(y+=g+l,f.push({width:g,height:_}),E+=g+l,x++,g=_=0),d[T]={left:E,top:_,col:x,width:N,height:R},g=Math.max(g,N),_+=R+l}),y+=g,f.push({width:g,height:_}),y}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:n,labels:{padding:i},rtl:s}}=this,o=Ed(s,this.left,this.width);if(this.isHorizontal()){let l=0,d=Kr(n,this.left+i,this.right-this.lineWidths[l]);for(const f of t)l!==f.row&&(l=f.row,d=Kr(n,this.left+i,this.right-this.lineWidths[l])),f.top+=this.top+e+i,f.left=o.leftForLtr(o.x(d),f.width),d+=f.width+i}else{let l=0,d=Kr(n,this.top+e+i,this.bottom-this.columnSizes[l].height);for(const f of t)f.col!==l&&(l=f.col,d=Kr(n,this.top+e+i,this.bottom-this.columnSizes[l].height)),f.top=d,f.left+=this.left+i,f.left=o.leftForLtr(o.x(f.left),f.width),d+=f.height+i}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;z2(e,this),this._draw(),B2(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:n,ctx:i}=this,{align:s,labels:o}=e,l=Qn.color,d=Ed(e.rtl,this.left,this.width),f=Xr(o.font),{padding:m}=o,y=f.size,g=y/2;let _;this.drawTitle(),i.textAlign=d.textAlign("left"),i.textBaseline="middle",i.lineWidth=.5,i.font=f.string;const{boxWidth:E,boxHeight:x,itemHeight:b}=iN(o,y),T=function(U,C,k){if(isNaN(E)||E<=0||isNaN(x)||x<0)return;i.save();const D=Dt(k.lineWidth,1);if(i.fillStyle=Dt(k.fillStyle,l),i.lineCap=Dt(k.lineCap,"butt"),i.lineDashOffset=Dt(k.lineDashOffset,0),i.lineJoin=Dt(k.lineJoin,"miter"),i.lineWidth=D,i.strokeStyle=Dt(k.strokeStyle,l),i.setLineDash(Dt(k.lineDash,[])),o.usePointStyle){const O={radius:x*Math.SQRT2/2,pointStyle:k.pointStyle,rotation:k.rotation,borderWidth:D},P=d.xPlus(U,E/2),F=C+g;F3(i,O,P,F,o.pointStyleWidth&&E)}else{const O=C+Math.max((y-x)/2,0),P=d.leftForLtr(U,E),F=wd(k.borderRadius);i.beginPath(),Object.values(F).some(M=>M!==0)?uy(i,{x:P,y:O,w:E,h:x,radius:F}):i.rect(P,O,E,x),i.fill(),D!==0&&i.stroke()}i.restore()},N=function(U,C,k){cm(i,k.text,U,C+b/2,f,{strikethrough:k.hidden,textAlign:d.textAlign(k.textAlign)})},R=this.isHorizontal(),I=this._computeTitleHeight();R?_={x:Kr(s,this.left+m,this.right-n[0]),y:this.top+m+I,line:0}:_={x:this.left+m,y:Kr(s,this.top+I+m,this.bottom-t[0].height),line:0},$3(this.ctx,e.textDirection);const j=b+m;this.legendItems.forEach((U,C)=>{i.strokeStyle=U.fontColor,i.fillStyle=U.fontColor;const k=i.measureText(U.text).width,D=d.textAlign(U.textAlign||(U.textAlign=o.textAlign)),O=E+g+k;let P=_.x,F=_.y;d.setWidth(this.width),R?C>0&&P+O+m>this.right&&(F=_.y+=j,_.line++,P=_.x=Kr(s,this.left+m,this.right-n[_.line])):C>0&&F+j>this.bottom&&(P=_.x=P+t[_.line].width+m,_.line++,F=_.y=Kr(s,this.top+I+m,this.bottom-t[_.line].height));const M=d.x(P);if(T(M,F,U),P=ZV(D,P+E+g,R?P+O:this.right,e.rtl),N(d.x(P),F,U),R)_.x+=O+m;else if(typeof U.text!="string"){const $=f.lineHeight;_.y+=cR(U,$)+m}else _.y+=j}),W3(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,n=Xr(t.font),i=Ls(t.padding);if(!t.display)return;const s=Ed(e.rtl,this.left,this.width),o=this.ctx,l=t.position,d=n.size/2,f=i.top+d;let m,y=this.left,g=this.width;if(this.isHorizontal())g=Math.max(...this.lineWidths),m=this.top+f,y=Kr(e.align,y,this.right-g);else{const E=this.columnSizes.reduce((x,b)=>Math.max(x,b.height),0);m=f+Kr(e.align,this.top,this.bottom-E-e.labels.padding-this._computeTitleHeight())}const _=Kr(l,y,y+g);o.textAlign=s.textAlign(L2(l)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=n.string,cm(o,t.text,_,m,n)}_computeTitleHeight(){const e=this.options.title,t=Xr(e.font),n=Ls(e.padding);return e.display?t.lineHeight+n.height:0}_getLegendItemAt(e,t){let n,i,s;if(Vl(e,this.left,this.right)&&Vl(t,this.top,this.bottom)){for(s=this.legendHitBoxes,n=0;n<s.length;++n)if(i=s[n],Vl(e,i.left,i.left+i.width)&&Vl(t,i.top,i.top+i.height))return this.legendItems[n]}return null}handleEvent(e){const t=this.options;if(!oq(e.type,t))return;const n=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const i=this._hoveredItem,s=nq(i,n);i&&!s&&kn(t.onLeave,[e,i,this],this),this._hoveredItem=n,n&&!s&&kn(t.onHover,[e,n,this],this)}else n&&kn(t.onClick,[e,n,this],this)}}function rq(r,e,t,n,i){const s=iq(n,r,e,t),o=sq(i,n,e.lineHeight);return{itemWidth:s,itemHeight:o}}function iq(r,e,t,n){let i=r.text;return i&&typeof i!="string"&&(i=i.reduce((s,o)=>s.length>o.length?s:o)),e+t.size/2+n.measureText(i).width}function sq(r,e,t){let n=r;return typeof e.text!="string"&&(n=cR(e,t)),n}function cR(r,e){const t=r.text?r.text.length:0;return e*t}function oq(r,e){return!!((r==="mousemove"||r==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(r==="click"||r==="mouseup"))}var Y2={id:"legend",_element:sN,start(r,e,t){const n=r.legend=new sN({ctx:r.ctx,options:t,chart:r});Ns.configure(r,n,t),Ns.addBox(r,n)},stop(r){Ns.removeBox(r,r.legend),delete r.legend},beforeUpdate(r,e,t){const n=r.legend;Ns.configure(r,n,t),n.options=t},afterUpdate(r){const e=r.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(r,e){e.replay||r.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(r,e,t){const n=e.datasetIndex,i=t.chart;i.isDatasetVisible(n)?(i.hide(n),e.hidden=!0):(i.show(n),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:r=>r.chart.options.color,boxWidth:40,padding:10,generateLabels(r){const e=r.data.datasets,{labels:{usePointStyle:t,pointStyle:n,textAlign:i,color:s,useBorderRadius:o,borderRadius:l}}=r.legend.options;return r._getSortedDatasetMetas().map(d=>{const f=d.controller.getStyle(t?0:void 0),m=Ls(f.borderWidth);return{text:e[d.index].label,fillStyle:f.backgroundColor,fontColor:s,hidden:!d.visible,lineCap:f.borderCapStyle,lineDash:f.borderDash,lineDashOffset:f.borderDashOffset,lineJoin:f.borderJoinStyle,lineWidth:(m.width+m.height)/4,strokeStyle:f.borderColor,pointStyle:n||f.pointStyle,rotation:f.rotation,textAlign:i||f.textAlign,borderRadius:o&&(l||f.borderRadius),datasetIndex:d.index}},this)}},title:{color:r=>r.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:r=>!r.startsWith("on"),labels:{_scriptable:r=>!["generateLabels","filter","sort"].includes(r)}}};class uR extends Ua{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t){const n=this.options;if(this.left=0,this.top=0,!n.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=t;const i=hr(n.text)?n.text.length:1;this._padding=Ls(n.padding);const s=i*Xr(n.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:t,left:n,bottom:i,right:s,options:o}=this,l=o.align;let d=0,f,m,y;return this.isHorizontal()?(m=Kr(l,n,s),y=t+e,f=s-n):(o.position==="left"?(m=n+e,y=Kr(l,i,t),d=fn*-.5):(m=s-e,y=Kr(l,t,i),d=fn*.5),f=i-t),{titleX:m,titleY:y,maxWidth:f,rotation:d}}draw(){const e=this.ctx,t=this.options;if(!t.display)return;const n=Xr(t.font),s=n.lineHeight/2+this._padding.top,{titleX:o,titleY:l,maxWidth:d,rotation:f}=this._drawArgs(s);cm(e,t.text,0,0,n,{color:t.color,maxWidth:d,rotation:f,textAlign:L2(t.align),textBaseline:"middle",translation:[o,l]})}}function aq(r,e){const t=new uR({ctx:r.ctx,options:e,chart:r});Ns.configure(r,t,e),Ns.addBox(r,t),r.titleBlock=t}var Z2={id:"title",_element:uR,start(r,e,t){aq(r,t)},stop(r){const e=r.titleBlock;Ns.removeBox(r,e),delete r.titleBlock},beforeUpdate(r,e,t){const n=r.titleBlock;Ns.configure(r,n,t),n.options=t},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const yf={average(r){if(!r.length)return!1;let e,t,n=new Set,i=0,s=0;for(e=0,t=r.length;e<t;++e){const l=r[e].element;if(l&&l.hasValue()){const d=l.tooltipPosition();n.add(d.x),i+=d.y,++s}}return s===0||n.size===0?!1:{x:[...n].reduce((l,d)=>l+d)/n.size,y:i/s}},nearest(r,e){if(!r.length)return!1;let t=e.x,n=e.y,i=Number.POSITIVE_INFINITY,s,o,l;for(s=0,o=r.length;s<o;++s){const d=r[s].element;if(d&&d.hasValue()){const f=d.getCenterPoint(),m=Bx(e,f);m<i&&(i=m,l=d)}}if(l){const d=l.tooltipPosition();t=d.x,n=d.y}return{x:t,y:n}}};function No(r,e){return e&&(hr(e)?Array.prototype.push.apply(r,e):r.push(e)),r}function ga(r){return(typeof r=="string"||r instanceof String)&&r.indexOf(`
`)>-1?r.split(`
`):r}function lq(r,e){const{element:t,datasetIndex:n,index:i}=e,s=r.getDatasetMeta(n).controller,{label:o,value:l}=s.getLabelAndValue(i);return{chart:r,label:o,parsed:s.getParsed(i),raw:r.data.datasets[n].data[i],formattedValue:l,dataset:s.getDataset(),dataIndex:i,datasetIndex:n,element:t}}function oN(r,e){const t=r.chart.ctx,{body:n,footer:i,title:s}=r,{boxWidth:o,boxHeight:l}=e,d=Xr(e.bodyFont),f=Xr(e.titleFont),m=Xr(e.footerFont),y=s.length,g=i.length,_=n.length,E=Ls(e.padding);let x=E.height,b=0,T=n.reduce((I,j)=>I+j.before.length+j.lines.length+j.after.length,0);if(T+=r.beforeBody.length+r.afterBody.length,y&&(x+=y*f.lineHeight+(y-1)*e.titleSpacing+e.titleMarginBottom),T){const I=e.displayColors?Math.max(l,d.lineHeight):d.lineHeight;x+=_*I+(T-_)*d.lineHeight+(T-1)*e.bodySpacing}g&&(x+=e.footerMarginTop+g*m.lineHeight+(g-1)*e.footerSpacing);let N=0;const R=function(I){b=Math.max(b,t.measureText(I).width+N)};return t.save(),t.font=f.string,hn(r.title,R),t.font=d.string,hn(r.beforeBody.concat(r.afterBody),R),N=e.displayColors?o+2+e.boxPadding:0,hn(n,I=>{hn(I.before,R),hn(I.lines,R),hn(I.after,R)}),N=0,t.font=m.string,hn(r.footer,R),t.restore(),b+=E.width,{width:b,height:x}}function cq(r,e){const{y:t,height:n}=e;return t<n/2?"top":t>r.height-n/2?"bottom":"center"}function uq(r,e,t,n){const{x:i,width:s}=n,o=t.caretSize+t.caretPadding;if(r==="left"&&i+s+o>e.width||r==="right"&&i-s-o<0)return!0}function dq(r,e,t,n){const{x:i,width:s}=t,{width:o,chartArea:{left:l,right:d}}=r;let f="center";return n==="center"?f=i<=(l+d)/2?"left":"right":i<=s/2?f="left":i>=o-s/2&&(f="right"),uq(f,r,e,t)&&(f="center"),f}function aN(r,e,t){const n=t.yAlign||e.yAlign||cq(r,t);return{xAlign:t.xAlign||e.xAlign||dq(r,e,t,n),yAlign:n}}function hq(r,e){let{x:t,width:n}=r;return e==="right"?t-=n:e==="center"&&(t-=n/2),t}function fq(r,e,t){let{y:n,height:i}=r;return e==="top"?n+=t:e==="bottom"?n-=i+t:n-=i/2,n}function lN(r,e,t,n){const{caretSize:i,caretPadding:s,cornerRadius:o}=r,{xAlign:l,yAlign:d}=t,f=i+s,{topLeft:m,topRight:y,bottomLeft:g,bottomRight:_}=wd(o);let E=hq(e,l);const x=fq(e,d,f);return d==="center"?l==="left"?E+=f:l==="right"&&(E-=f):l==="left"?E-=Math.max(m,g)+i:l==="right"&&(E+=Math.max(y,_)+i),{x:Qr(E,0,n.width-e.width),y:Qr(x,0,n.height-e.height)}}function Xp(r,e,t){const n=Ls(t.padding);return e==="center"?r.x+r.width/2:e==="right"?r.x+r.width-n.right:r.x+n.left}function cN(r){return No([],ga(r))}function mq(r,e,t){return wu(r,{tooltip:e,tooltipItems:t,type:"tooltip"})}function uN(r,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?r.override(t):r}const dR={beforeTitle:fa,title(r){if(r.length>0){const e=r[0],t=e.chart.data.labels,n=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(n>0&&e.dataIndex<n)return t[e.dataIndex]}return""},afterTitle:fa,beforeBody:fa,beforeLabel:fa,label(r){if(this&&this.options&&this.options.mode==="dataset")return r.label+": "+r.formattedValue||r.formattedValue;let e=r.dataset.label||"";e&&(e+=": ");const t=r.formattedValue;return on(t)||(e+=t),e},labelColor(r){const t=r.chart.getDatasetMeta(r.datasetIndex).controller.getStyle(r.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(r){const t=r.chart.getDatasetMeta(r.datasetIndex).controller.getStyle(r.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:fa,afterBody:fa,beforeFooter:fa,footer:fa,afterFooter:fa};function Di(r,e,t,n){const i=r[e].call(t,n);return typeof i>"u"?dR[e].call(t,n):i}var Y_;let dN=(Y_=class extends Ua{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,n=this.options.setContext(this.getContext()),i=n.enabled&&t.options.animation&&n.animations,s=new K3(this.chart,i);return i._cacheable&&(this._cachedAnimations=Object.freeze(s)),s}getContext(){return this.$context||(this.$context=mq(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:n}=t,i=Di(n,"beforeTitle",this,e),s=Di(n,"title",this,e),o=Di(n,"afterTitle",this,e);let l=[];return l=No(l,ga(i)),l=No(l,ga(s)),l=No(l,ga(o)),l}getBeforeBody(e,t){return cN(Di(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:n}=t,i=[];return hn(e,s=>{const o={before:[],lines:[],after:[]},l=uN(n,s);No(o.before,ga(Di(l,"beforeLabel",this,s))),No(o.lines,Di(l,"label",this,s)),No(o.after,ga(Di(l,"afterLabel",this,s))),i.push(o)}),i}getAfterBody(e,t){return cN(Di(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:n}=t,i=Di(n,"beforeFooter",this,e),s=Di(n,"footer",this,e),o=Di(n,"afterFooter",this,e);let l=[];return l=No(l,ga(i)),l=No(l,ga(s)),l=No(l,ga(o)),l}_createItems(e){const t=this._active,n=this.chart.data,i=[],s=[],o=[];let l=[],d,f;for(d=0,f=t.length;d<f;++d)l.push(lq(this.chart,t[d]));return e.filter&&(l=l.filter((m,y,g)=>e.filter(m,y,g,n))),e.itemSort&&(l=l.sort((m,y)=>e.itemSort(m,y,n))),hn(l,m=>{const y=uN(e.callbacks,m);i.push(Di(y,"labelColor",this,m)),s.push(Di(y,"labelPointStyle",this,m)),o.push(Di(y,"labelTextColor",this,m))}),this.labelColors=i,this.labelPointStyles=s,this.labelTextColors=o,this.dataPoints=l,l}update(e,t){const n=this.options.setContext(this.getContext()),i=this._active;let s,o=[];if(!i.length)this.opacity!==0&&(s={opacity:0});else{const l=yf[n.position].call(this,i,this._eventPosition);o=this._createItems(n),this.title=this.getTitle(o,n),this.beforeBody=this.getBeforeBody(o,n),this.body=this.getBody(o,n),this.afterBody=this.getAfterBody(o,n),this.footer=this.getFooter(o,n);const d=this._size=oN(this,n),f=Object.assign({},l,d),m=aN(this.chart,n,f),y=lN(n,f,m,this.chart);this.xAlign=m.xAlign,this.yAlign=m.yAlign,s={opacity:1,x:y.x,y:y.y,width:d.width,height:d.height,caretX:l.x,caretY:l.y}}this._tooltipItems=o,this.$context=void 0,s&&this._resolveAnimations().update(this,s),e&&n.external&&n.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,n,i){const s=this.getCaretPosition(e,n,i);t.lineTo(s.x1,s.y1),t.lineTo(s.x2,s.y2),t.lineTo(s.x3,s.y3)}getCaretPosition(e,t,n){const{xAlign:i,yAlign:s}=this,{caretSize:o,cornerRadius:l}=n,{topLeft:d,topRight:f,bottomLeft:m,bottomRight:y}=wd(l),{x:g,y:_}=e,{width:E,height:x}=t;let b,T,N,R,I,j;return s==="center"?(I=_+x/2,i==="left"?(b=g,T=b-o,R=I+o,j=I-o):(b=g+E,T=b+o,R=I-o,j=I+o),N=b):(i==="left"?T=g+Math.max(d,m)+o:i==="right"?T=g+E-Math.max(f,y)-o:T=this.caretX,s==="top"?(R=_,I=R-o,b=T-o,N=T+o):(R=_+x,I=R+o,b=T+o,N=T-o),j=R),{x1:b,x2:T,x3:N,y1:R,y2:I,y3:j}}drawTitle(e,t,n){const i=this.title,s=i.length;let o,l,d;if(s){const f=Ed(n.rtl,this.x,this.width);for(e.x=Xp(this,n.titleAlign,n),t.textAlign=f.textAlign(n.titleAlign),t.textBaseline="middle",o=Xr(n.titleFont),l=n.titleSpacing,t.fillStyle=n.titleColor,t.font=o.string,d=0;d<s;++d)t.fillText(i[d],f.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+l,d+1===s&&(e.y+=n.titleMarginBottom-l)}}_drawColorBox(e,t,n,i,s){const o=this.labelColors[n],l=this.labelPointStyles[n],{boxHeight:d,boxWidth:f}=s,m=Xr(s.bodyFont),y=Xp(this,"left",s),g=i.x(y),_=d<m.lineHeight?(m.lineHeight-d)/2:0,E=t.y+_;if(s.usePointStyle){const x={radius:Math.min(f,d)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},b=i.leftForLtr(g,f)+f/2,T=E+d/2;e.strokeStyle=s.multiKeyBackground,e.fillStyle=s.multiKeyBackground,qx(e,x,b,T),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,qx(e,x,b,T)}else{e.lineWidth=Xt(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const x=i.leftForLtr(g,f),b=i.leftForLtr(i.xPlus(g,1),f-2),T=wd(o.borderRadius);Object.values(T).some(N=>N!==0)?(e.beginPath(),e.fillStyle=s.multiKeyBackground,uy(e,{x,y:E,w:f,h:d,radius:T}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),uy(e,{x:b,y:E+1,w:f-2,h:d-2,radius:T}),e.fill()):(e.fillStyle=s.multiKeyBackground,e.fillRect(x,E,f,d),e.strokeRect(x,E,f,d),e.fillStyle=o.backgroundColor,e.fillRect(b,E+1,f-2,d-2))}e.fillStyle=this.labelTextColors[n]}drawBody(e,t,n){const{body:i}=this,{bodySpacing:s,bodyAlign:o,displayColors:l,boxHeight:d,boxWidth:f,boxPadding:m}=n,y=Xr(n.bodyFont);let g=y.lineHeight,_=0;const E=Ed(n.rtl,this.x,this.width),x=function(k){t.fillText(k,E.x(e.x+_),e.y+g/2),e.y+=g+s},b=E.textAlign(o);let T,N,R,I,j,U,C;for(t.textAlign=o,t.textBaseline="middle",t.font=y.string,e.x=Xp(this,b,n),t.fillStyle=n.bodyColor,hn(this.beforeBody,x),_=l&&b!=="right"?o==="center"?f/2+m:f+2+m:0,I=0,U=i.length;I<U;++I){for(T=i[I],N=this.labelTextColors[I],t.fillStyle=N,hn(T.before,x),R=T.lines,l&&R.length&&(this._drawColorBox(t,e,I,E,n),g=Math.max(y.lineHeight,d)),j=0,C=R.length;j<C;++j)x(R[j]),g=y.lineHeight;hn(T.after,x)}_=0,g=y.lineHeight,hn(this.afterBody,x),e.y-=s}drawFooter(e,t,n){const i=this.footer,s=i.length;let o,l;if(s){const d=Ed(n.rtl,this.x,this.width);for(e.x=Xp(this,n.footerAlign,n),e.y+=n.footerMarginTop,t.textAlign=d.textAlign(n.footerAlign),t.textBaseline="middle",o=Xr(n.footerFont),t.fillStyle=n.footerColor,t.font=o.string,l=0;l<s;++l)t.fillText(i[l],d.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+n.footerSpacing}}drawBackground(e,t,n,i){const{xAlign:s,yAlign:o}=this,{x:l,y:d}=e,{width:f,height:m}=n,{topLeft:y,topRight:g,bottomLeft:_,bottomRight:E}=wd(i.cornerRadius);t.fillStyle=i.backgroundColor,t.strokeStyle=i.borderColor,t.lineWidth=i.borderWidth,t.beginPath(),t.moveTo(l+y,d),o==="top"&&this.drawCaret(e,t,n,i),t.lineTo(l+f-g,d),t.quadraticCurveTo(l+f,d,l+f,d+g),o==="center"&&s==="right"&&this.drawCaret(e,t,n,i),t.lineTo(l+f,d+m-E),t.quadraticCurveTo(l+f,d+m,l+f-E,d+m),o==="bottom"&&this.drawCaret(e,t,n,i),t.lineTo(l+_,d+m),t.quadraticCurveTo(l,d+m,l,d+m-_),o==="center"&&s==="left"&&this.drawCaret(e,t,n,i),t.lineTo(l,d+y),t.quadraticCurveTo(l,d,l+y,d),t.closePath(),t.fill(),i.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,n=this.$animations,i=n&&n.x,s=n&&n.y;if(i||s){const o=yf[e.position].call(this,this._active,this._eventPosition);if(!o)return;const l=this._size=oN(this,e),d=Object.assign({},o,this._size),f=aN(t,e,d),m=lN(e,d,f,t);(i._to!==m.x||s._to!==m.y)&&(this.xAlign=f.xAlign,this.yAlign=f.yAlign,this.width=l.width,this.height=l.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,m))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let n=this.opacity;if(!n)return;this._updateAnimationTarget(t);const i={width:this.width,height:this.height},s={x:this.x,y:this.y};n=Math.abs(n)<.001?0:n;const o=Ls(t.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&l&&(e.save(),e.globalAlpha=n,this.drawBackground(s,e,i,t),$3(e,t.textDirection),s.y+=o.top,this.drawTitle(s,e,t),this.drawBody(s,e,t),this.drawFooter(s,e,t),W3(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const n=this._active,i=e.map(({datasetIndex:l,index:d})=>{const f=this.chart.getDatasetMeta(l);if(!f)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:f.data[d],index:d}}),s=!ay(n,i),o=this._positionChanged(i,t);(s||o)&&(this._active=i,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,n=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const i=this.options,s=this._active||[],o=this._getActiveElements(e,s,t,n),l=this._positionChanged(o,e),d=t||!ay(o,s)||l;return d&&(this._active=o,(i.enabled||i.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),d}_getActiveElements(e,t,n,i){const s=this.options;if(e.type==="mouseout")return[];if(!i)return t.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,s.mode,s,n);return s.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:n,caretY:i,options:s}=this,o=yf[s.position].call(this,e,t);return o!==!1&&(n!==o.x||i!==o.y)}},Je(Y_,"positioners",yf),Y_);var Q2={id:"tooltip",_element:dN,positioners:yf,afterInit(r,e,t){t&&(r.tooltip=new dN({chart:r,options:t}))},beforeUpdate(r,e,t){r.tooltip&&r.tooltip.initialize(t)},reset(r,e,t){r.tooltip&&r.tooltip.initialize(t)},afterDraw(r){const e=r.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(r.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(r.ctx),r.notifyPlugins("afterTooltipDraw",t)}},afterEvent(r,e){if(r.tooltip){const t=e.replay;r.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(r,e)=>e.bodyFont.size,boxWidth:(r,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:dR},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:r=>r!=="filter"&&r!=="itemSort"&&r!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const pq=(r,e,t,n)=>(typeof e=="string"?(t=r.push(e)-1,n.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function gq(r,e,t,n){const i=r.indexOf(e);if(i===-1)return pq(r,e,t,n);const s=r.lastIndexOf(e);return i!==s?t:i}const yq=(r,e)=>r===null?null:Qr(Math.round(r),0,e);function hN(r){const e=this.getLabels();return r>=0&&r<e.length?e[r]:r}class my extends ah{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const n=this.getLabels();for(const{index:i,label:s}of t)n[i]===s&&n.splice(i,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(on(e))return null;const n=this.getLabels();return t=isFinite(t)&&n[t]===e?t:gq(n,e,Dt(t,e),this._addedLabels),yq(t,n.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:n,max:i}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(n=0),t||(i=this.getLabels().length-1)),this.min=n,this.max=i}buildTicks(){const e=this.min,t=this.max,n=this.options.offset,i=[];let s=this.getLabels();s=e===0&&t===s.length-1?s:s.slice(e,t+1),this._valueRange=Math.max(s.length-(n?0:1),1),this._startValue=this.min-(n?.5:0);for(let o=e;o<=t;o++)i.push({value:o});return i}getLabelForValue(e){return hN.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}Je(my,"id","category"),Je(my,"defaults",{ticks:{callback:hN}});function vq(r,e){const t=[],{bounds:i,step:s,min:o,max:l,precision:d,count:f,maxTicks:m,maxDigits:y,includeBounds:g}=r,_=s||1,E=m-1,{min:x,max:b}=e,T=!on(o),N=!on(l),R=!on(f),I=(b-x)/(y+1);let j=fA((b-x)/E/_)*_,U,C,k,D;if(j<1e-14&&!T&&!N)return[{value:x},{value:b}];D=Math.ceil(b/j)-Math.floor(x/j),D>E&&(j=fA(D*j/E/_)*_),on(d)||(U=Math.pow(10,d),j=Math.ceil(j*U)/U),i==="ticks"?(C=Math.floor(x/j)*j,k=Math.ceil(b/j)*j):(C=x,k=b),T&&N&&s&&BV((l-o)/s,j/1e3)?(D=Math.round(Math.min((l-o)/j,m)),j=(l-o)/D,C=o,k=l):R?(C=T?o:C,k=N?l:k,D=f-1,j=(k-C)/D):(D=(k-C)/j,jf(D,Math.round(D),j/1e3)?D=Math.round(D):D=Math.ceil(D));const O=Math.max(mA(j),mA(C));U=Math.pow(10,on(d)?O:d),C=Math.round(C*U)/U,k=Math.round(k*U)/U;let P=0;for(T&&(g&&C!==o?(t.push({value:o}),C<o&&P++,jf(Math.round((C+P*j)*U)/U,o,fN(o,I,r))&&P++):C<o&&P++);P<D;++P){const F=Math.round((C+P*j)*U)/U;if(N&&F>l)break;t.push({value:F})}return N&&g&&k!==l?t.length&&jf(t[t.length-1].value,l,fN(l,I,r))?t[t.length-1].value=l:t.push({value:l}):(!N||k===l)&&t.push({value:k}),t}function fN(r,e,{horizontal:t,minRotation:n}){const i=Ea(n),s=(t?Math.sin(i):Math.cos(i))||.001,o=.75*e*(""+r).length;return Math.min(e/s,o)}class _q extends ah{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return on(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:n}=this.getUserBounds();let{min:i,max:s}=this;const o=d=>i=t?i:d,l=d=>s=n?s:d;if(e){const d=Do(i),f=Do(s);d<0&&f<0?l(0):d>0&&f>0&&o(0)}if(i===s){let d=s===0?1:Math.abs(s*.05);l(s+d),e||o(i-d)}this.min=i,this.max=s}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:n}=e,i;return n?(i=Math.ceil(this.max/n)-Math.floor(this.min/n)+1,i>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${n} would result generating up to ${i} ticks. Limiting to 1000.`),i=1e3)):(i=this.computeTickLimit(),t=t||11),t&&(i=Math.min(t,i)),i}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let n=this.getTickLimit();n=Math.max(2,n);const i={maxTicks:n,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},s=this._range||this,o=vq(i,s);return e.bounds==="ticks"&&UV(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let t=this.min,n=this.max;if(super.configure(),this.options.offset&&e.length){const i=(n-t)/Math.max(e.length-1,1)/2;t-=i,n+=i}this._startValue=t,this._endValue=n,this._valueRange=n-t}getLabelForValue(e){return V2(e,this.chart.options.locale,this.options.ticks.format)}}class py extends _q{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=Ds(e)?e:0,this.max=Ds(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,n=Ea(this.options.ticks.minRotation),i=(e?Math.sin(n):Math.cos(n))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,s.lineHeight/i))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}Je(py,"id","linear"),Je(py,"defaults",{ticks:{callback:L3.formatters.numeric}});const a0={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Vi=Object.keys(a0);function mN(r,e){return r-e}function pN(r,e){if(on(e))return null;const t=r._adapter,{parser:n,round:i,isoWeekday:s}=r._parseOpts;let o=e;return typeof n=="function"&&(o=n(o)),Ds(o)||(o=typeof n=="string"?t.parse(o,n):t.parse(o)),o===null?null:(i&&(o=i==="week"&&(om(s)||s===!0)?t.startOf(o,"isoWeek",s):t.startOf(o,i)),+o)}function gN(r,e,t,n){const i=Vi.length;for(let s=Vi.indexOf(r);s<i-1;++s){const o=a0[Vi[s]],l=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((t-e)/(l*o.size))<=n)return Vi[s]}return Vi[i-1]}function xq(r,e,t,n,i){for(let s=Vi.length-1;s>=Vi.indexOf(t);s--){const o=Vi[s];if(a0[o].common&&r._adapter.diff(i,n,o)>=e-1)return o}return Vi[t?Vi.indexOf(t):0]}function bq(r){for(let e=Vi.indexOf(r)+1,t=Vi.length;e<t;++e)if(a0[Vi[e]].common)return Vi[e]}function yN(r,e,t){if(!t)r[e]=!0;else if(t.length){const{lo:n,hi:i}=D2(t,e),s=t[n]>=e?t[n]:t[i];r[s]=!0}}function wq(r,e,t,n){const i=r._adapter,s=+i.startOf(e[0].value,n),o=e[e.length-1].value;let l,d;for(l=s;l<=o;l=+i.add(l,1,n))d=t[l],d>=0&&(e[d].major=!0);return e}function vN(r,e,t){const n=[],i={},s=e.length;let o,l;for(o=0;o<s;++o)l=e[o],i[l]=o,n.push({value:l,major:!1});return s===0||!t?n:wq(r,n,i,t)}class gy extends ah{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const n=e.time||(e.time={}),i=this._adapter=new NB._date(e.adapters.date);i.init(t),Rf(n.displayFormats,i.formats()),this._parseOpts={parser:n.parser,round:n.round,isoWeekday:n.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:pN(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,n=e.time.unit||"day";let{min:i,max:s,minDefined:o,maxDefined:l}=this.getUserBounds();function d(f){!o&&!isNaN(f.min)&&(i=Math.min(i,f.min)),!l&&!isNaN(f.max)&&(s=Math.max(s,f.max))}(!o||!l)&&(d(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&d(this.getMinMax(!1))),i=Ds(i)&&!isNaN(i)?i:+t.startOf(Date.now(),n),s=Ds(s)&&!isNaN(s)?s:+t.endOf(Date.now(),n)+1,this.min=Math.min(i,s-1),this.max=Math.max(i+1,s)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],n=e[e.length-1]),{min:t,max:n}}buildTicks(){const e=this.options,t=e.time,n=e.ticks,i=n.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&i.length&&(this.min=this._userMin||i[0],this.max=this._userMax||i[i.length-1]);const s=this.min,o=this.max,l=GV(i,s,o);return this._unit=t.unit||(n.autoSkip?gN(t.minUnit,this.min,this.max,this._getLabelCapacity(s)):xq(this,l.length,t.minUnit,this.min,this.max)),this._majorUnit=!n.major.enabled||this._unit==="year"?void 0:bq(this._unit),this.initOffsets(i),e.reverse&&l.reverse(),vN(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,n=0,i,s;this.options.offset&&e.length&&(i=this.getDecimalForValue(e[0]),e.length===1?t=1-i:t=(this.getDecimalForValue(e[1])-i)/2,s=this.getDecimalForValue(e[e.length-1]),e.length===1?n=s:n=(s-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;t=Qr(t,0,o),n=Qr(n,0,o),this._offsets={start:t,end:n,factor:1/(t+1+n)}}_generate(){const e=this._adapter,t=this.min,n=this.max,i=this.options,s=i.time,o=s.unit||gN(s.minUnit,t,n,this._getLabelCapacity(t)),l=Dt(i.ticks.stepSize,1),d=o==="week"?s.isoWeekday:!1,f=om(d)||d===!0,m={};let y=t,g,_;if(f&&(y=+e.startOf(y,"isoWeek",d)),y=+e.startOf(y,f?"day":o),e.diff(n,t,o)>1e5*l)throw new Error(t+" and "+n+" are too far apart with stepSize of "+l+" "+o);const E=i.ticks.source==="data"&&this.getDataTimestamps();for(g=y,_=0;g<n;g=+e.add(g,l,o),_++)yN(m,g,E);return(g===n||i.bounds==="ticks"||_===1)&&yN(m,g,E),Object.keys(m).sort(mN).map(x=>+x)}getLabelForValue(e){const t=this._adapter,n=this.options.time;return n.tooltipFormat?t.format(e,n.tooltipFormat):t.format(e,n.displayFormats.datetime)}format(e,t){const i=this.options.time.displayFormats,s=this._unit,o=t||i[s];return this._adapter.format(e,o)}_tickFormatFunction(e,t,n,i){const s=this.options,o=s.ticks.callback;if(o)return kn(o,[e,t,n],this);const l=s.time.displayFormats,d=this._unit,f=this._majorUnit,m=d&&l[d],y=f&&l[f],g=n[t],_=f&&y&&g&&g.major;return this._adapter.format(e,i||(_?y:m))}generateTickLabels(e){let t,n,i;for(t=0,n=e.length;t<n;++t)i=e[t],i.label=this._tickFormatFunction(i.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,n=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+n)*t.factor)}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+n*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,n=this.ctx.measureText(e).width,i=Ea(this.isHorizontal()?t.maxRotation:t.minRotation),s=Math.cos(i),o=Math.sin(i),l=this._resolveTickFontOptions(0).size;return{w:n*s+l*o,h:n*o+l*s}}_getLabelCapacity(e){const t=this.options.time,n=t.displayFormats,i=n[t.unit]||n.millisecond,s=this._tickFormatFunction(e,0,vN(this,[e],this._majorUnit),i),o=this._getLabelSize(s),l=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return l>0?l:1}getDataTimestamps(){let e=this._cache.data||[],t,n;if(e.length)return e;const i=this.getMatchingVisibleMetas();if(this._normalized&&i.length)return this._cache.data=i[0].controller.getAllParsedValues(this);for(t=0,n=i.length;t<n;++t)e=e.concat(i[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,n;if(e.length)return e;const i=this.getLabels();for(t=0,n=i.length;t<n;++t)e.push(pN(this,i[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return O3(e.sort(mN))}}Je(gy,"id","time"),Je(gy,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function Jp(r,e,t){let n=0,i=r.length-1,s,o,l,d;t?(e>=r[n].pos&&e<=r[i].pos&&({lo:n,hi:i}=Zc(r,"pos",e)),{pos:s,time:l}=r[n],{pos:o,time:d}=r[i]):(e>=r[n].time&&e<=r[i].time&&({lo:n,hi:i}=Zc(r,"time",e)),{time:s,pos:l}=r[n],{time:o,pos:d}=r[i]);const f=o-s;return f?l+(d-l)*(e-s)/f:l}class _N extends gy{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=Jp(t,this.min),this._tableRange=Jp(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:n}=this,i=[],s=[];let o,l,d,f,m;for(o=0,l=e.length;o<l;++o)f=e[o],f>=t&&f<=n&&i.push(f);if(i.length<2)return[{time:t,pos:0},{time:n,pos:1}];for(o=0,l=i.length;o<l;++o)m=i[o+1],d=i[o-1],f=i[o],Math.round((m+d)/2)!==f&&s.push({time:f,pos:o/(l-1)});return s}_generate(){const e=this.min,t=this.max;let n=super.getDataTimestamps();return(!n.includes(e)||!n.length)&&n.splice(0,0,e),(!n.includes(t)||n.length===1)&&n.push(t),n.sort((i,s)=>i-s)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),n=this.getLabelTimestamps();return t.length&&n.length?e=this.normalize(t.concat(n)):e=t.length?t:n,e=this._cache.all=e,e}getDecimalForValue(e){return(Jp(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,n=this.getDecimalForPixel(e)/t.factor-t.end;return Jp(this._table,n*this._tableRange+this._minPos,!0)}}Je(_N,"id","timeseries"),Je(_N,"defaults",gy.defaults);const hR="label";function xN(r,e){typeof r=="function"?r(e):r&&(r.current=e)}function Eq(r,e){const t=r.options;t&&e&&Object.assign(t,e)}function fR(r,e){r.labels=e}function mR(r,e){let t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:hR;const n=[];r.datasets=e.map(i=>{const s=r.datasets.find(o=>o[t]===i[t]);return!s||!i.data||n.includes(s)?{...i}:(n.push(s),Object.assign(s,i),s)})}function Sq(r){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:hR;const t={labels:[],datasets:[]};return fR(t,r.labels),mR(t,r.datasets,e),t}function Tq(r,e){const{height:t=150,width:n=300,redraw:i=!1,datasetIdKey:s,type:o,data:l,options:d,plugins:f=[],fallbackContent:m,updateMode:y,...g}=r,_=J.useRef(null),E=J.useRef(null),x=()=>{_.current&&(E.current=new Eu(_.current,{type:o,data:Sq(l,s),options:d&&{...d},plugins:f}),xN(e,E.current))},b=()=>{xN(e,null),E.current&&(E.current.destroy(),E.current=null)};return J.useEffect(()=>{!i&&E.current&&d&&Eq(E.current,d)},[i,d]),J.useEffect(()=>{!i&&E.current&&fR(E.current.config.data,l.labels)},[i,l.labels]),J.useEffect(()=>{!i&&E.current&&l.datasets&&mR(E.current.config.data,l.datasets,s)},[i,l.datasets]),J.useEffect(()=>{E.current&&(i?(b(),setTimeout(x)):E.current.update(y))},[i,d,l.labels,l.datasets,y]),J.useEffect(()=>{E.current&&(b(),setTimeout(x))},[o]),J.useEffect(()=>(x(),()=>b()),[]),ss.createElement("canvas",{ref:_,role:"img",height:t,width:n,...g},m)}const Aq=J.forwardRef(Tq);function l0(r,e){return Eu.register(e),J.forwardRef((t,n)=>ss.createElement(Aq,{...t,ref:n,type:r}))}const Nq=l0("line",wg),pR=l0("bar",bg),Iq=l0("doughnut",pd),gR=l0("pie",Hx);Eu.register(my,py,Df,Z2,Q2,Y2);const kq=()=>{const r=new Date;return r.setMonth(r.getMonth()-6),r.toISOString().split("T")[0]},bN=()=>new Date().toISOString().split("T")[0],Pq=({user:r,userData:e,db:t,showNotification:n})=>{const[i,s]=J.useState([]),[o,l]=J.useState("monthly"),[d,f]=J.useState(kq()),[m,y]=J.useState(bN()),[g,_]=J.useState(!0),[E,x]=J.useState(""),b=J.useCallback(async()=>{if(!r||!r.uid){x("User data not available."),_(!1);return}_(!0),x("");try{const C=await ih(t,r.uid);if(C.success){const k=C.data.filter(D=>{var O;return((O=D.billDate)==null?void 0:O.toDate)&&typeof D.consumption=="number"&&D.consumption>=0}).sort((D,O)=>D.billDate.toDate()-O.billDate.toDate());s(k)}else throw new Error(C.error||"Failed to fetch billing data.")}catch(C){x(C.message||"An unexpected error occurred fetching data."),n(C.message||"Could not load consumption data.","error")}finally{_(!1)}},[t,r,n]);J.useEffect(()=>{b()},[b]);const N=((C,k,D,O)=>{const P={},F=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],M=new Date(D).getTime(),$=new Date(O).getTime()+(24*60*60*1e3-1);return C.filter(oe=>{const ie=oe.billDate.toDate().getTime();return ie>=M&&ie<=$}).forEach(oe=>{const ie=oe.billDate.toDate(),ne=ie.getFullYear(),K=ie.getMonth();let B;switch(k){case"yearly":B=`${ne}`;break;case"daily":B=`${ne}-${String(K+1).padStart(2,"0")}-${String(ie.getDate()).padStart(2,"0")}`;break;case"monthly":default:B=`${ne}-${String(K+1).padStart(2,"0")}`;break}P[B]=(P[B]||0)+(oe.consumption||0)}),Object.keys(P).sort().reduce((oe,ie)=>{let ne=ie;if(k==="monthly"){const[K,B]=ie.split("-");B&&F[parseInt(B)-1]&&(ne=`${F[parseInt(B)-1]} '${K.slice(-2)}`)}else if(k==="daily"){const[K,B,G]=ie.split("-");B&&G&&(ne=`${F[parseInt(B)-1]} ${G}, '${K.slice(-2)}`)}return oe[ne]=P[ie],oe},{})})(i,o,d,m),R={labels:Object.keys(N),datasets:[{label:"Consumption (m)",data:Object.values(N),backgroundColor:"rgba(59, 130, 246, 0.7)",borderColor:"rgba(37, 99, 235, 1)",borderWidth:1,borderRadius:4,hoverBackgroundColor:"rgba(37, 99, 235, 0.8)"}]},I={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:`Water Consumption Trend (${o.charAt(0).toUpperCase()+o.slice(1)})`,font:{size:16},color:"#374151",padding:{bottom:15}},tooltip:{backgroundColor:"#1F2937",titleColor:"#E5E7EB",bodyColor:"#D1D5DB",borderColor:"#4B5563",borderWidth:1,padding:10,callbacks:{label:function(C){return` Consumption: ${C.parsed.y.toFixed(2)} m`}}}},scales:{y:{beginAtZero:!0,title:{display:!0,text:"Consumption (m)",color:"#4B5563"},grid:{color:"#E5E7EB"},ticks:{color:"#6B7280"}},x:{title:{display:!0,text:"Period",color:"#4B5563"},grid:{display:!1},ticks:{color:"#6B7280"}}}},j=i.length>0?i.reduce((C,k)=>C+(k.consumption||0),0)/i.length:0,U=C=>{const k=Object.values(C),D=Object.keys(C);if(k.length<2)return"Not enough data for comparison in the selected range.";const O=k[k.length-1],P=k[k.length-2],F=D[k.length-1],M=O-P,$=P!==0?M/P*100:O>0?1/0:0;let Y=`Consumption in ${F} was ${O.toFixed(2)} m. `;return $===1/0?Y+="This is up from 0 in the previous period.":M>0?(Y+=`This is ${$>=.1?"+":""}${$.toFixed(1)}% (${M>=0?"+":""}${M.toFixed(2)} m) compared to the previous period.`,$>25&&(Y+=" Consider checking for potential leaks or reviewing usage patterns.")):M<0?Y+=`This is a ${Math.abs($).toFixed(1)}% decrease (${M.toFixed(2)} m) compared to the previous period.`:Y+="Consumption remained stable compared to the previous period.",Y};return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200 gap-4",children:[u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(o3,{size:30,className:"mr-3 text-blue-600"})," Water Consumption Analytics"]}),u.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3 w-full sm:w-auto",children:[u.jsxs("div",{className:"flex items-center gap-2 w-full",children:[u.jsx(O9,{size:18,className:"text-gray-500"}),u.jsxs("select",{value:o,onChange:C=>l(C.target.value),className:"p-2 border rounded-md text-sm bg-gray-50 focus:ring-blue-500 focus:border-blue-500 w-full",disabled:g,children:[u.jsx("option",{value:"daily",children:"Group by Day"}),u.jsx("option",{value:"monthly",children:"Group by Month"}),u.jsx("option",{value:"yearly",children:"Group by Year"})]})]}),u.jsxs("div",{className:"flex items-center gap-2 w-full",children:[u.jsx(Mx,{size:18,className:"text-gray-500"}),u.jsx("input",{type:"date",value:d,onChange:C=>f(C.target.value),className:"p-2 border rounded-md text-sm bg-gray-50 focus:ring-blue-500 focus:border-blue-500 w-full",disabled:g,max:m}),u.jsx("span",{className:"text-gray-500",children:"-"}),u.jsx("input",{type:"date",value:m,onChange:C=>y(C.target.value),className:"p-2 border rounded-md text-sm bg-gray-50 focus:ring-blue-500 focus:border-blue-500 w-full",disabled:g,min:d,max:bN()})]})]})]}),g&&u.jsx(an,{message:"Loading consumption data..."}),E&&!g&&u.jsxs("div",{className:"text-center py-10 bg-red-50 p-4 rounded-lg",children:[u.jsx(Kt,{size:48,className:"mx-auto text-red-400 mb-3"}),u.jsx("p",{className:"text-red-600 text-lg font-semibold",children:"Error Loading Data"}),u.jsx("p",{className:"text-sm text-red-500 mt-1",children:E})]}),!g&&!E&&i.length===0&&u.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner",children:[u.jsx(gn,{size:48,className:"mx-auto text-gray-400 mb-4"}),u.jsx("p",{className:"text-gray-600 text-lg",children:"No consumption data found yet."}),u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Analytics will appear after your first few bills."})]}),!g&&!E&&i.length>0&&Object.keys(N).length>0&&u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{className:"text-sm text-center text-gray-700 bg-blue-50 p-3 rounded-md border border-blue-200 shadow-sm",children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Insight:"})," ",U(N)]}),u.jsxs("p",{className:"mt-1",children:["Average monthly use (all data): ",u.jsxs("strong",{children:[j.toFixed(2)," m"]}),"."]})]}),u.jsx("div",{className:"h-64 md:h-80 lg:h-96 w-full p-4 border rounded-lg bg-gray-50 shadow-inner",children:u.jsx(pR,{options:I,data:R})})]}),!g&&!E&&i.length>0&&Object.keys(N).length===0&&u.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner",children:[u.jsx(gn,{size:48,className:"mx-auto text-gray-400 mb-4"}),u.jsx("p",{className:"text-gray-600 text-lg",children:"No data found for the selected date range and grouping."}),u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Try expanding your date range or changing the grouping."})]})]})};Eu.register(gd,Q2,Y2,Z2);const wN={Cash:"rgba(16, 185, 129, 0.7)",Stripe:"rgba(59, 130, 246, 0.7)",Card:"rgba(59, 130, 246, 0.7)",Check:"rgba(249, 115, 22, 0.7)","E-wallet (GCash/Maya)":"rgba(139, 92, 246, 0.7)",Unknown:"rgba(107, 114, 128, 0.7)"},EN={Cash:"rgba(16, 185, 129, 1)",Stripe:"rgba(59, 130, 246, 1)",Card:"rgba(59, 130, 246, 1)",Check:"rgba(249, 115, 22, 1)","E-wallet (GCash/Maya)":"rgba(139, 92, 246, 1)",Unknown:"rgba(107, 114, 128, 1)"},Cq=({user:r,db:e,showNotification:t})=>{const[n,i]=J.useState(null),[s,o]=J.useState(!0),[l,d]=J.useState(""),f=J.useCallback(async()=>{if(!r||!r.uid){d("User data not available."),o(!1);return}o(!0),d("");try{const y=await ih(e,r.uid);if(y.success){const g=y.data.filter(_=>_.status==="Paid");if(g.length===0)i(null);else{const _={};g.forEach(b=>{let T=b.paymentMethod||"Unknown";T==="card"&&(T="Stripe"),T==="Card (Debit/Credit)"&&(T="Card"),_[T]=(_[T]||0)+1});const E=Object.keys(_),x=Object.values(_);i({labels:E,datasets:[{label:"Number of Payments",data:x,backgroundColor:E.map(b=>wN[b]||wN.Unknown),borderColor:E.map(b=>EN[b]||EN.Unknown),borderWidth:1}]})}}else throw new Error(y.error||"Failed to fetch billing data.")}catch(y){d(y.message||"An unexpected error occurred fetching data."),t(y.message||"Could not load payment data.","error")}finally{o(!1)}},[e,r,t]);J.useEffect(()=>{f()},[f]);const m={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom"},title:{display:!0,text:"Your Payment Methods (by count)",font:{size:18},color:"#374151",padding:{bottom:20}},tooltip:{callbacks:{label:function(y){let g=y.label||"";return g&&(g+=": "),y.parsed!==null&&(g+=`${y.parsed} payment(s)`),g}}}}};return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200 gap-4",children:u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(e0,{size:30,className:"mr-3 text-purple-600"})," Payment Analytics"]})}),s&&u.jsx(an,{message:"Loading your payment history..."}),l&&u.jsxs("div",{className:"text-center py-10 bg-red-50 p-4 rounded-lg",children:[u.jsx(gn,{size:48,className:"mx-auto text-red-400 mb-3"}),u.jsx("p",{className:"text-red-600 text-lg font-semibold",children:"Error Loading Data"}),u.jsx("p",{className:"text-sm text-red-500 mt-1",children:l})]}),!s&&!l&&!n&&u.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner",children:[u.jsx(gn,{size:48,className:"mx-auto text-gray-400 mb-4"}),u.jsx("p",{className:"text-gray-600 text-lg",children:"No Payment Data Found"}),u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Your payment analytics will appear here once you pay a bill."})]}),!s&&!l&&n&&u.jsx("div",{className:"h-80 md:h-96 w-full p-4 border rounded-lg bg-gray-50 shadow-inner",children:u.jsx(gR,{data:n,options:m})})]})},ad={Bronze:{points:0,color:"text-yellow-700",iconColor:"#cd7f32",benefits:["Standard Support Access","Basic Portal Features","Regular Service Updates"]},Silver:{points:500,color:"text-gray-600",iconColor:"#c0c0c0",benefits:["Priority Support Queue","Eligibility for 1% Annual Bill Rebate*","Early Access to Water Saving Tips","+ Bronze Benefits"]},Gold:{points:1500,color:"text-amber-500",iconColor:"#ffd700",benefits:["Dedicated Support Agent Option","Eligibility for 2.5% Annual Bill Rebate*","Exclusive Conservation Workshop Invites","+ Silver Benefits"]},Platinum:{points:3e3,color:"text-blue-700",iconColor:"#e5e4e2",benefits:["Highest Priority Support Escalation","Eligibility for 5% Annual Bill Rebate*","Free Annual Water Audit Consultation (On Request)","+ Gold Benefits"]}},Rq=({userData:r,systemSettings:e={}})=>{const t=(r==null?void 0:r.rebatePoints)||0,i=(x=>x>=ad.Platinum.points?"Platinum":x>=ad.Gold.points?"Gold":x>=ad.Silver.points?"Silver":"Bronze")(t),s=ad[i],l=(x=>{const b=Object.keys(ad),T=b.indexOf(x);if(T>=0&&T<b.length-1){const N=b[T+1];return{name:N,...ad[N]}}return null})(i),d=l?l.points-t:0,f=l?Math.max(0,Math.min(100,t/l.points*100)):100,{isRebateProgramEnabled:m=!1,pointsPerPeso:y=.01,earlyPaymentBonusPoints:g=10,earlyPaymentDaysThreshold:_=7}=e,E=y*100;return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(sy,{size:30,className:"mr-3 text-amber-500"})," AGWA Rewards Program"]})}),u.jsxs("section",{className:"mb-8 p-6 bg-gradient-to-r from-blue-600 to-indigo-700 text-white rounded-lg shadow-xl text-center",children:[u.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Your Rewards Status"}),u.jsxs("div",{className:"text-4xl font-bold mb-1 flex items-center justify-center gap-2",children:[u.jsx(md,{size:36,fill:s.iconColor,stroke:s.iconColor}),u.jsxs("span",{style:{color:s.iconColor},children:[i," Tier"]})]}),u.jsxs("p",{className:"text-2xl font-semibold text-blue-100 mb-3",children:[t.toLocaleString()," Points"]}),l&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"w-full max-w-md mx-auto bg-blue-400 rounded-full h-3 mb-1 overflow-hidden shadow-inner",children:u.jsx("div",{className:"bg-yellow-400 h-3 rounded-full transition-all duration-500 ease-out",style:{width:`${f}%`}})}),u.jsx("p",{className:"text-xs text-blue-100",children:d>0?`${d.toLocaleString()} points needed for ${l.name} tier (${l.points.toLocaleString()} total).`:`You've reached the ${l.name} tier!`})]}),i==="Platinum"&&u.jsx("p",{className:"text-sm text-yellow-300 font-semibold mt-2",children:" You are a Platinum member! Enjoy the highest rewards."})]}),u.jsxs("section",{className:"mb-8",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:["Benefits for ",i," Tier"]}),u.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50 shadow-inner",children:[u.jsx("ul",{className:"list-disc list-inside space-y-1.5 text-sm text-gray-700 pl-4",children:s.benefits.map((x,b)=>u.jsx("li",{children:x.replace("*","")},b))}),u.jsx("p",{className:"text-xs text-gray-500 mt-3",children:"*Annual Bill Rebate eligibility requires 12 consecutive months of good standing within the tier. Rebate applied as bill credit. See terms."})]})]}),u.jsxs("section",{className:"mb-8 p-4 bg-blue-50 border border-blue-200 rounded-lg shadow-sm",children:[u.jsxs("h3",{className:"text-lg font-semibold text-blue-800 mb-3 flex items-center",children:[u.jsx(S2,{size:20,className:"mr-2"})," How to Earn Points (Mechanics)"]}),m?u.jsxs("div",{className:"space-y-3 text-sm text-gray-700",children:[u.jsx("p",{children:"Earning points is simple! Points are awarded automatically for diligent payments:"}),u.jsxs("ul",{className:"list-none space-y-2 pl-2",children:[u.jsxs("li",{className:"flex items-start",children:[u.jsx(md,{size:16,className:"text-yellow-500 mr-2 mt-0.5 flex-shrink-0"}),u.jsxs("div",{children:[u.jsx("strong",{children:"Pay Your Bill:"})," Earn ",u.jsxs("strong",{children:[E.toLocaleString()," point",E!==1?"s":""]})," for every ",u.jsx("strong",{children:"100.00"})," paid on your water bill."]})]}),u.jsxs("li",{className:"flex items-start",children:[u.jsx(md,{size:16,className:"text-yellow-500 mr-2 mt-0.5 flex-shrink-0"}),u.jsxs("div",{children:[u.jsx("strong",{children:"Pay Early:"})," Earn a ",u.jsxs("strong",{children:[g," point bonus"]})," when you pay your bill in full at least ",u.jsxs("strong",{children:[_," day",_!==1?"s":""]})," before your due date."]})]}),u.jsxs("li",{className:"flex items-start",children:[u.jsx(md,{size:16,className:"text-gray-400 mr-2 mt-0.5 flex-shrink-0"}),u.jsxs("div",{children:[u.jsx("strong",{children:"Stay Tuned:"})," Look out for special promotions and events to earn even more bonus points!"]})]})]}),u.jsx("p",{className:"text-xs text-gray-500",children:"Points are automatically credited to your account after your payment is successfully posted (usually within 24-48 hours)."})]}):u.jsx("p",{className:"text-sm text-gray-700",children:"The AGWA Rewards Program is not currently active."})]}),u.jsxs("section",{children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-3 flex items-center",children:[u.jsx(sh,{size:20,className:"mr-2 text-gray-500"})," Program Terms & Conditions"]}),u.jsxs("details",{className:"text-xs text-gray-500 space-y-2 border p-3 rounded bg-gray-50 cursor-pointer group hover:bg-gray-100 transition-colors",children:[u.jsxs("summary",{className:"font-medium text-gray-700 group-hover:text-blue-600 list-none flex justify-between items-center",children:["Click to view Terms & Conditions",u.jsx("span",{className:"transition-transform duration-200 group-open:rotate-180",children:""})]}),u.jsxs("div",{className:"mt-2 space-y-1.5 max-h-0 overflow-hidden group-open:max-h-[500px] transition-all duration-500 ease-in-out pt-2 border-t",children:[u.jsxs("p",{children:[u.jsx("strong",{children:"1. Eligibility:"}),' All AGWA Water Services, Inc. customers with an active residential or commercial account in good standing are eligible to participate in the AGWA Rewards Program ("Program").']}),u.jsxs("p",{children:[u.jsx("strong",{children:"2. Earning Points:"}),' Points are earned based on (a) the total amount paid for water bills and (b) bonuses for early payments, as specified in the "How to Earn Points" section. Earning rates are determined by AGWA and may be subject to change based on system settings.']}),u.jsxs("p",{children:[u.jsx("strong",{children:"3. Point Crediting:"})," Points will be credited to the customer's account after a payment is successfully processed and posted. This may take up to 48 hours."]}),u.jsxs("p",{children:[u.jsx("strong",{children:"4. Tiers and Benefits:"})," Tier status (Bronze, Silver, Gold, Platinum) is determined by the total accumulated points. Benefits are associated with each tier and are non-transferable. AGWA reserves the right to modify, add, or remove benefits at any time."]}),u.jsxs("p",{children:[u.jsx("strong",{children:"5. Annual Bill Rebate:"}),' Rebates mentioned in tier benefits (e.g., "Eligibility for 1% Annual Bill Rebate") are not automatic. To qualify, a customer must maintain their tier status (Silver or higher) and remain in good standing (no service disconnections due to non-payment) for 12 consecutive months. The rebate is calculated on the total basic charges paid within that 12-month period and will be applied as a credit to a future bill, not as a cash payout.']}),u.jsxs("p",{children:[u.jsx("strong",{children:"6. Point Expiration:"})," Points do not expire as long as the customer's account remains active. If an account is closed or becomes inactive for a period of 24 consecutive months, all accumulated points may be forfeited."]}),u.jsxs("p",{children:[u.jsx("strong",{children:"7. No Cash Value:"})," Points have no cash value, are non-transferable, and cannot be sold, bartered, or redeemed for cash."]}),u.jsxs("p",{children:[u.jsx("strong",{children:"8. Program Modification/Termination:"})," AGWA Water Services, Inc. reserves the right to modify, suspend, or terminate the AGWA Rewards Program, its rules, tiers, benefits, or earning mechanics at any time, with or without prior notice."]}),u.jsxs("p",{children:[u.jsx("strong",{children:"9. Account Status:"})," Customers must be in good standing to enjoy tier benefits. Accounts that are suspended or disconnected may have their benefits temporarily revoked."]}),u.jsxs("p",{children:[u.jsx("strong",{children:"10. Disputes:"})," Any discrepancies in point calculation must be reported to AGWA customer service within 60 days of the payment date. AGWA's decision on point disputes is final."]}),u.jsxs("p",{children:[u.jsx("strong",{children:"11. Acceptance of Terms:"})," Continued participation in the Program, including earning and redeeming benefits, constitutes acceptance of these Terms & Conditions."]})]})]})]})]})},yR={Poblacion:["Capt. C. Nazareno","Gombalza","Kanluran","Ibayo Silangan","Humbac","Balsahan"],"Baybayin Bayan-Hilaga":["Timalan Balsahan","Timalan Concepcion","Munting Mapino","Ibayo Estacion","Latoria","Bucana Sasahan"],"Baybayin Timog":["Bagong Kalsada","Bucana Malaki","Bancaan","Mabulo","Labac","Sapa"],"Ilayang Hilaga":["Calubcob","Halang","Palangue Central","Palangue 2&3","Sabang","Makina"],"Ilayang Timog":["Muzon","Malainen Bago","Malainen Luma","Molino","San Roque","Santulan"]},c0=()=>Object.keys(yR),$d=r=>yR[r]||[],jq=({isOpen:r,onClose:e,onSubmit:t,isSaving:n})=>u.jsx(Ar,{isOpen:r,onClose:e,title:"Apply for Senior/PWD Discount",size:"lg",children:u.jsxs("div",{className:"space-y-6",children:[u.jsx("p",{className:"text-sm text-gray-600",children:"To apply for your Senior Citizen or PWD discount, you must provide a valid ID for verification. Please choose one of the following methods to submit your application."}),u.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[u.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center mb-2",children:[u.jsx(Fo,{size:18,className:"mr-2 text-blue-600"}),"Option 1: Online Submission (Email)"]}),u.jsx("p",{className:"text-sm text-gray-600 mb-3",children:"Email a clear photo of your valid Senior Citizen or PWD ID to our verification team."}),u.jsxs("ul",{className:"text-sm space-y-1 mb-3",children:[u.jsxs("li",{children:[u.jsx("strong",{children:"To:"})," ",u.jsx("a",{href:"mailto:admin@agwa.ph",className:"text-blue-600 hover:underline",children:"admin@agwa.ph"})]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Cc:"})," ",u.jsx("a",{href:"mailto:benjamesduag.edu@gmail.com",className:"text-blue-600 hover:underline",children:"benjamesduag.edu@gmail.com"})]}),u.jsxs("li",{children:[u.jsx("strong",{children:"Subject:"})," Discount Application - ","{Your Account Number}"]})]}),u.jsx("p",{className:"text-xs text-gray-500 bg-yellow-50 p-2 border border-yellow-200 rounded-md",children:'After emailing, click "Submit Application" below. Our team will review your email and update your account status within 2-3 business days.'})]}),u.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[u.jsxs("h3",{className:"font-semibold text-gray-800 flex items-center mb-2",children:[u.jsx(w2,{size:18,className:"mr-2 text-green-600"}),"Option 2: In-Person Verification"]}),u.jsx("p",{className:"text-sm text-gray-600",children:"Visit any AGWA business office and present your valid ID to a customer service representative. Your account will be updated on the spot."})]}),u.jsxs("div",{className:"pt-4 flex flex-col sm:flex-row-reverse gap-3",children:[u.jsxs("button",{type:"button",onClick:t,className:"w-full sm:w-auto flex items-center justify-center px-6 py-2.5 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg",disabled:n,children:[n?u.jsx(Et,{size:18,className:"animate-spin mr-2"}):u.jsx(aF,{size:18,className:"mr-2"}),n?"Submitting...":"Submit Application (Set to Pending)"]}),u.jsx("button",{type:"button",onClick:e,className:"w-full sm:w-auto px-6 py-2.5 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg border",disabled:n,children:"Cancel"})]})]})}),eo="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",tf="bg-gray-200 cursor-not-allowed text-gray-500",Oq=({user:r,userData:e,setUserData:t,auth:n,db:i,showNotification:s})=>{var Y;const[o,l]=J.useState(!1),[d,f]=J.useState({}),[m,y]=J.useState({district:"",barangay:"",street:"",landmark:""}),[g,_]=J.useState(!1),[E,x]=J.useState(""),[b,T]=J.useState([]),[N,R]=J.useState([]),[I,j]=J.useState(!1),U=(e==null?void 0:e.role)==="customer";J.useEffect(()=>{if(T(c0()),e)if(f({...e}),U&&e.serviceAddress&&typeof e.serviceAddress=="object"){const te=e.serviceAddress.district||"";y(e.serviceAddress),te&&R($d(te))}else y({district:"",barangay:"",street:"",landmark:""})},[e,U]);const C=te=>!te||typeof te!="object"?"N/A":[te.street,te.barangay,te.district,"Naic, Cavite"].filter(ie=>ie&&ie.trim()).join(", "),k=te=>{const{name:oe,value:ie}=te.target;y(ne=>{const K={...ne,[oe]:ie};return oe==="district"&&(K.barangay="",R($d(ie))),K})},D=te=>{const{name:oe,value:ie,type:ne,checked:K}=te.target;f(B=>({...B,[oe]:ne==="checkbox"?K:ie}))},O=async te=>{var ne,K;if(te.preventDefault(),x(""),!((ne=d.displayName)!=null&&ne.trim())){x("Display Name cannot be empty.");return}_(!0);const oe={displayName:d.displayName.trim(),photoURL:((K=d.photoURL)==null?void 0:K.trim())||"",serviceAddress:U?m:e.serviceAddress||{}},ie=await fd(i,r.uid,oe);if(!ie.success){s(ie.error||"Failed to update profile in database.","error"),_(!1);return}t(B=>({...B,...oe})),s("Profile updated successfully!","success"),l(!1),_(!1)},P=()=>{l(!1),x(""),f({...e}),U&&e.serviceAddress&&typeof e.serviceAddress=="object"&&y(e.serviceAddress)},F=async()=>{_(!0);const te={discountStatus:"pending"},oe=await fd(i,r.uid,te);oe.success?(t(ie=>({...ie,...te})),f(ie=>({...ie,...te})),s("Application submitted! Your status is now 'Pending Verification'.","success"),j(!1)):s(oe.error||"Failed to submit application.","error"),_(!1)};if(!e)return u.jsx(an,{message:"Loading profile..."});const M=d.photoURL||j8(d.displayName),$=d.discountStatus||"none";return u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[u.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center",children:[u.jsx(c3,{size:30,className:"mr-3 text-blue-600"})," My Profile"]}),!o&&u.jsxs("button",{onClick:()=>l(!0),className:"flex items-center bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg",children:[u.jsx(k2,{size:18,className:"mr-2"})," Edit Profile"]})]}),E&&u.jsxs("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg text-sm flex items-center",children:[u.jsx(Kt,{size:20,className:"mr-2"})," ",E]}),u.jsxs("form",{onSubmit:O,className:"space-y-5",children:[u.jsxs("div",{className:"text-center space-y-3",children:[u.jsx("img",{src:M,alt:"Profile",className:"h-28 w-28 rounded-full object-cover border-4 border-blue-200 shadow-md bg-gray-200 mx-auto"}),o&&u.jsx("input",{type:"url",name:"photoURL",value:d.photoURL||"",onChange:D,className:`${eo} max-w-sm mx-auto text-center`,placeholder:"Image URL"})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"text-xs font-medium text-gray-600 mb-1 flex items-center",children:[u.jsx(Cs,{size:14,className:"mr-1.5"}),"Full Name"]}),o?u.jsx("input",{type:"text",name:"displayName",value:d.displayName||"",onChange:D,className:eo}):u.jsx("p",{className:`${eo} ${tf}`,children:d.displayName})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"text-xs font-medium text-gray-600 mb-1 flex items-center",children:[u.jsx(Fo,{size:14,className:"mr-1.5"}),"Email Address"]}),u.jsx("p",{className:`${eo} ${tf}`,children:d.email})]}),U&&u.jsxs("div",{children:[u.jsxs("label",{className:"text-xs font-medium text-gray-600 mb-1 flex items-center",children:[u.jsx(Rs,{size:14,className:"mr-1.5"}),"Account Number"]}),u.jsx("p",{className:`${eo} ${tf}`,children:d.accountNumber})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"text-xs font-medium text-gray-600 mb-1 flex items-center",children:[u.jsx(Ox,{size:14,className:"mr-1.5"}),"User Role"]}),u.jsx("p",{className:`${eo} ${tf} capitalize`,children:(Y=d.role)==null?void 0:Y.replace("_"," ")})]})]}),U&&u.jsxs("div",{className:"pt-4 mt-4 border-t",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Service Address"}),o?u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1",children:"District"}),u.jsxs("select",{name:"district",value:m.district,onChange:k,className:eo,children:[u.jsx("option",{value:"",children:"Select District"}),b.map(te=>u.jsx("option",{value:te,children:te},te))]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1",children:"Barangay"}),u.jsxs("select",{name:"barangay",value:m.barangay,onChange:k,className:eo,disabled:!m.district,children:[u.jsx("option",{value:"",children:"Select Barangay"}),N.map(te=>u.jsx("option",{value:te,children:te},te))]})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1",children:"Street Name, Building, House No."}),u.jsx("input",{type:"text",name:"street",value:m.street,onChange:k,className:eo})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"text-xs font-medium text-gray-600 mb-1",children:"Landmark"}),u.jsx("input",{type:"text",name:"landmark",value:m.landmark,onChange:k,className:eo})]})]}):u.jsx("p",{className:`${eo} ${tf}`,children:C(d.serviceAddress)})]}),U&&u.jsxs("div",{className:"pt-4 mt-4 border-t",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-2",children:"Discount Status"}),u.jsxs("div",{className:"flex items-center justify-between p-4 rounded-lg border bg-gray-50",children:[$==="none"&&u.jsxs("div",{className:"flex-grow",children:[u.jsx("p",{className:"font-medium text-gray-700",children:"No discount applied."}),u.jsx("p",{className:"text-xs text-gray-500",children:"Apply for a Senior Citizen / PWD discount."})]}),$==="pending"&&u.jsxs("div",{className:"flex-grow",children:[u.jsxs("p",{className:"font-medium text-yellow-700 flex items-center",children:[u.jsx(di,{size:16,className:"mr-2"})," Application Pending Verification"]}),u.jsx("p",{className:"text-xs text-gray-500",children:"We are reviewing your application. Please wait for an admin to approve it."})]}),$==="verified"&&u.jsxs("div",{className:"flex-grow",children:[u.jsxs("p",{className:"font-medium text-green-700 flex items-center",children:[u.jsx(s3,{size:16,className:"mr-2"})," Discount Active"]}),u.jsx("p",{className:"text-xs text-gray-500",children:"Your Senior/PWD discount is active and will be applied to new bills."})]}),!o&&$==="none"&&u.jsx("button",{type:"button",onClick:()=>j(!0),className:"bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg text-sm",children:"Apply Now"})]})]}),o&&u.jsxs("div",{className:"flex justify-end space-x-4 pt-5",children:[u.jsx("button",{type:"button",onClick:P,className:"px-6 py-2.5 text-sm font-medium bg-gray-100 rounded-lg",disabled:g,children:"Cancel"}),u.jsxs("button",{type:"submit",className:"px-6 py-2.5 text-sm font-medium text-white bg-green-600 rounded-lg flex items-center",disabled:g,children:[g?u.jsx(Et,{size:18,className:"animate-spin mr-2"}):u.jsx(Ba,{size:18,className:"mr-2"}),g?"Saving...":"Save Changes"]})]})]})]}),u.jsx(jq,{isOpen:I,onClose:()=>j(!1),onSubmit:F,isSaving:g})]})};function Mq(r,e,t){const[n,i]=J.useState(r),[s,o]=J.useState({}),[l,d]=J.useState(!1),[f,m]=J.useState(!1),y=J.useCallback(x=>{const{name:b,value:T,type:N,checked:R}=x.target;i(I=>({...I,[b]:N==="checkbox"?R:T})),s[b]&&o(I=>({...I,[b]:void 0}))},[s]),g=J.useCallback((x,b)=>{i(T=>({...T,[x]:b})),s[x]&&o(T=>({...T,[x]:void 0}))},[s]),_=J.useCallback(()=>{i(r),o({}),d(!1),m(!1)},[r]);return{values:n,setValues:i,setFieldValue:g,errors:s,setErrors:o,isLoading:l,handleChange:y,handleSubmit:async x=>{if(x&&x.preventDefault(),f)return;m(!0),d(!0),o({});let b={};if(e&&(b=e(n),o(b)),Object.keys(b).length===0)try{t&&await t(n,_)}catch(T){console.error("Form submission error:",T),o(N=>({...N,submit:T.message||"An unexpected error occurred during submission."}))}d(!1),m(!1)},resetForm:_}}const yy=({children:r,text:e,position:t="top",className:n="",delay:i=100})=>{const[s,o]=J.useState(!1),[l,d]=J.useState(null),f=()=>{const _=setTimeout(()=>{o(!0)},i);d(_)},m=()=>{l&&(clearTimeout(l),d(null)),o(!1)},y={top:"bottom-full left-1/2 -translate-x-1/2 mb-2",bottom:"top-full left-1/2 -translate-x-1/2 mt-2",left:"right-full top-1/2 -translate-y-1/2 mr-2",right:"left-full top-1/2 -translate-y-1/2 ml-2"},g={top:"absolute left-1/2 -translate-x-1/2 top-full h-0 w-0 border-x-4 border-x-transparent border-t-4 border-t-gray-800",bottom:"absolute left-1/2 -translate-x-1/2 bottom-full h-0 w-0 border-x-4 border-x-transparent border-b-4 border-b-gray-800",left:"absolute top-1/2 -translate-y-1/2 left-full h-0 w-0 border-y-4 border-y-transparent border-l-4 border-l-gray-800",right:"absolute top-1/2 -translate-y-1/2 right-full h-0 w-0 border-y-4 border-y-transparent border-r-4 border-r-gray-800"};return e?u.jsxs("div",{className:"relative inline-flex",onMouseEnter:f,onMouseLeave:m,onFocus:f,onBlur:m,tabIndex:0,children:[r,s&&u.jsxs("div",{role:"tooltip",className:`absolute z-50 whitespace-nowrap px-3 py-1.5 text-xs font-medium text-white bg-gray-800 rounded-md shadow-lg transition-opacity duration-150 ease-in-out opacity-100 ${y[t]} ${n}`,children:[e,u.jsx("div",{className:g[t]})]})]}):u.jsx(u.Fragment,{children:r})},h1="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",f1="flex items-center justify-center px-5 py-2.5 rounded-lg font-semibold transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95 text-sm",Dq=r=>!r||typeof r!="object"?"":[r.street,r.barangay,r.district].filter(t=>t&&t.trim()).join(", "),Lq=({user:r,userData:e,db:t,auth:n,showNotification:i})=>{const s=()=>e!=null&&e.serviceAddress&&typeof e.serviceAddress=="object"?Dq(e.serviceAddress):(e==null?void 0:e.accountNumber)||"",o={issueType:"",description:"",issueAddress:s()},[l,d]=J.useState(!1),[f,m]=J.useState(!1),y=P=>{const F={};return P.issueType||(F.issueType="Please select an issue type."),P.description.trim()||(F.description="Description cannot be empty."),P.issueAddress.trim()||(F.issueAddress="Please specify the location of the issue."),F},g=async(P,F)=>{const M={...P,userId:r.uid,userName:e.displayName,userEmail:e.email,accountNumber:e.accountNumber||"N/A"},$=await o9(t,M);$.success?(i("Support ticket submitted successfully!","success"),F()):i($.error||"Failed to submit ticket.","error")},{values:_,errors:E,isLoading:x,handleChange:b,handleSubmit:T,setFieldValue:N}=Mq(o,y,g),R=["Billing Discrepancy or Inquiry","Water Leak (Before Meter)","Water Leak (After Meter - Your Property)","No Water Supply / Low Pressure","Water Quality Issue (Color, Odor, Taste)","Meter Problem (Damaged, Stuck, Inaccurate)","Online Portal Issue / Account Access","Request for Service (Disconnection/Reconnection)","Chatbot Assistance Follow-up","Other Concern"],I=["Unable to Access Meter","Damaged or Tampered Meter Found","Suspected Illegal Connection","Route Data Inaccuracy","Safety Concern on Route","Device or App Problem","Customer Inquiry on Field","Other Field Report"],j=["Payment Posting Issue","Customer Account Inquiry","Bill Printing Problem","System Access/Login Issue","Other Office Concern"],U=["User Role/Permission Change Request","Data Correction Request","System Bug Report","Feature Request","Urgent System Alert"],[C,k]=J.useState(R);J.useEffect(()=>{switch(e==null?void 0:e.role){case"meter_reader":k(I);break;case"clerk_cashier":k(j);break;case"admin":k(U);break;default:k(R)}N("issueType","")},[e.role,N]),J.useEffect(()=>{N("issueAddress",s())},[e,N]);const D=async()=>{if(!_.description.trim()){i("Please describe your issue first before using the AI categorizer.","warning");return}d(!0);try{const M=[{role:"user",content:`Based on the following user complaint, which of these categories does it best fit into? Categories: [${C.join(", ")}]. Respond with only the exact category name from the list and nothing else. Complaint: "${_.description}"`}];let $=await Vo(M);$=$.replace(/["'.*]/g,"").trim(),C.includes($)?(N("issueType",$),i(`AI suggested category: "${$}"`,"success")):i("AI could not determine a matching category. Please select one manually.","info")}catch(P){const F=(P==null?void 0:P.message)||"AI categorization failed.";i(F,"error")}finally{d(!1)}},O=async()=>{if(!_.description.trim()){i("Please provide some keywords or a brief description for the AI to expand upon.","warning");return}m(!0);try{const F=[{role:"user",content:`You are helping a user report an issue to AGWA Water Services. Elaborate on the following user-provided details to create a clear, detailed, and formal issue description. Be polite and include any relevant questions the user might need to answer. Do not add any extra commentary, just provide the refined description.

User's input: "${_.description}"`}],M=await Vo(F);N("description",M),i("AI has helped draft your issue description!","success")}catch(P){const F=(P==null?void 0:P.message)||"AI assistance failed.";i(F,"error")}finally{m(!1)}};return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(Kt,{size:30,className:"mr-3 text-orange-500"})," Report an Issue or Concern"]})}),u.jsxs("form",{onSubmit:T,className:"space-y-6",children:[u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"issueType",className:"text-sm font-medium text-gray-700 mb-1 flex items-center",children:[u.jsx(n3,{size:16,className:"mr-1.5 text-gray-500"})," Issue Type / Category *"]}),u.jsxs("div",{className:"flex gap-2 items-center",children:[u.jsxs("select",{id:"issueType",name:"issueType",value:_.issueType,onChange:b,className:`${h1} ${E.issueType?"border-red-500":""}`,children:[u.jsx("option",{value:"",disabled:!0,children:"Select the type of issue..."}),C.map(P=>u.jsx("option",{value:P,children:P},P))]}),u.jsx(yy,{text:"Let AI suggest a category based on your description below.",children:u.jsx("button",{type:"button",onClick:D,className:`${f1} w-auto bg-blue-100 text-blue-700 hover:bg-blue-200 focus:ring-blue-300 px-3`,disabled:l||x,children:l?u.jsx(Et,{size:16,className:"animate-spin"}):u.jsx(Os,{size:16})})})]}),E.issueType&&u.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.issueType})]}),u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"issueAddress",className:"text-sm font-medium text-gray-700 mb-1 flex items-center",children:[u.jsx(co,{size:16,className:"mr-1.5 text-gray-500"})," Address / Location of Issue *"]}),u.jsx("input",{type:"text",id:"issueAddress",name:"issueAddress",value:_.issueAddress,onChange:b,className:`${h1} ${E.issueAddress?"border-red-500":""}`,placeholder:"E.g., Your service address, specific street, or account number if general"}),E.issueAddress&&u.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.issueAddress})]}),u.jsxs("div",{children:[u.jsxs("div",{className:"flex justify-between items-center mb-1",children:[u.jsxs("label",{htmlFor:"description",className:"text-sm font-medium text-gray-700 flex items-center",children:[u.jsx(X9,{size:16,className:"mr-1.5 text-gray-500"})," Detailed Description of Issue *"]}),u.jsx(yy,{text:_.description.trim()?"Use AI to help draft or refine your description.":"Write a description first to enable AI Assist",children:u.jsxs("button",{type:"button",onClick:O,className:`${f1} text-xs bg-purple-100 text-purple-700 hover:bg-purple-200 focus:ring-purple-300 py-1.5 px-3`,disabled:f||x||!_.description.trim(),children:[f?u.jsx(Et,{size:16,className:"animate-spin mr-1.5"}):u.jsx(Os,{size:16,className:"mr-1.5"}),f?"Drafting...":"AI Assist"]})})]}),u.jsx("textarea",{id:"description",name:"description",value:_.description,onChange:b,rows:"6",className:`${h1} ${E.description?"border-red-500":""}`,placeholder:"Please provide as much detail as possible: What is the problem? When did it start? Any specific error messages or observations?"}),E.description&&u.jsx("p",{className:"text-red-500 text-xs mt-1",children:E.description})]}),u.jsx("div",{className:"pt-3",children:u.jsxs("button",{type:"submit",className:`${f1} w-full bg-orange-500 hover:bg-orange-600 text-white focus:ring-orange-400`,disabled:x||f||l,children:[x?u.jsx(Et,{size:20,className:"animate-spin mr-2"}):u.jsx(n0,{size:18,className:"mr-2"}),x?"Submitting Report...":"Submit Issue Report"]})})]})]})},Fq=[{q:"How do I register for an online account?",a:"Click 'Sign Up' on the login page. Provide your full name, AGWA account number (e.g., RES-12345), a valid email address, and create a password of at least 6 characters."},{q:"I forgot my password. How can I reset it?",a:"On the login page, click the 'Forgot Password?' link. Enter the email address associated with your AGWA account, and we'll send you a link to reset your password."},{q:"How can I pay my water bill through this portal?",a:"Once logged in, navigate to 'My Bills'. Select an unpaid bill, click 'Pay Now', and choose a simulated payment option (e.g., GCash, Maya, Bank Transfer, Credit Card). Please note that payments in this portal are for demonstration purposes only. For actual payments, please use AGWA's officially accredited payment channels."},{q:"How is my water consumption calculated?",a:"Your consumption is the difference between your current meter reading and your previous meter reading, measured in cubic meters (m). This consumption is then used with the tariff rates applicable to your service type to calculate your water bill charges."},{q:"What are the different charges on my bill?",a:"Your bill typically includes a Basic Charge (based on consumption and service type), Foreign Currency Differential Adjustment (FCDA), Environmental Charge (EC), Sewerage Charge (SC, if applicable), Maintenance Service Charge (based on your meter size), Government Taxes, and Value Added Tax (VAT). You can use the ' Explain Bill' feature in the 'My Bills' section for a personalized breakdown of a specific bill."},{q:"How can I view my past bills and payment history?",a:"Navigate to the 'My Bills' section after logging in. You'll find a history of your past bills, their status (Paid/Unpaid), and payment details if paid via the portal (simulated). You can also view a detailed invoice for each bill."},{q:"What should I do if I suspect a water leak at my premises?",a:"If it's safe to do so, try to identify the source of the leak and turn off your main water shut-off valve (usually located near your meter). Immediately report the suspected leak to AGWA via the 'Report Issue' section in the portal or by calling our 24/7 emergency hotline: 1627-AGWA (1627-2492)."},{q:"My water supply is interrupted. What should I do?",a:"First, check for any service advisories on our official AGWA website or social media channels. If there are no posted advisories for your area, please report the interruption via the 'Report Issue' section in the portal or call our customer service hotline with your account details."},{q:"Can I change my registered email address or other profile details?",a:"You can update your Display Name, Photo URL, Service Address, and Meter Size in the 'My Profile' section. For changes to critical information like your registered email address (if it's your primary login ID), account number, or assigned role, please contact AGWA customer support for assistance and verification."},{q:"What is FCDA (Foreign Currency Differential Adjustment)?",a:"FCDA is a tariff mechanism approved by regulatory bodies that allows water utilities like AGWA to recover or pass on to customers the gains or losses arising from fluctuations in foreign exchange rates. These fluctuations affect the cost of foreign currency-denominated loans and expenses used for service improvements and operational needs."},{q:"Why is there an Environmental Charge (EC) on my bill?",a:"The Environmental Charge (EC) is a fee collected to fund projects and initiatives related to wastewater treatment, septage management, and other environmental protection programs. This helps ensure that water resources are used sustainably and that wastewater is treated properly before being discharged back into the environment."},{q:"What if I think my water meter is malfunctioning or inaccurate?",a:"If you suspect your water meter is not recording your consumption accurately, please report it immediately. You can do this through the 'Report Issue' section of the portal (select 'Meter Problem') or by contacting AGWA customer service. We will arrange for an inspection and testing of your meter."},{q:"How often are water meters read?",a:"Water meters are typically read on a monthly cycle. The specific reading schedule can vary by area. Your billing statement will indicate the period covered by the meter reading (e.g., 'Billing Period: 01 Jan 2025 to 31 Jan 2025')."},{q:"Are there discounts for senior citizens or Persons with Disabilities (PWDs)?",a:"Yes, AGWA Water Services adheres to Republic Act No. 9994 (Expanded Senior Citizens Act) and Republic Act No. 10754 (Act Expanding the Benefits and Privileges of Persons with Disability). Qualified senior citizens and PWDs are entitled to a discount on their water consumption, subject to certain conditions (e.g., the account must be registered in their name, consumption limits). Please update your details in 'My Profile' or contact customer service with the necessary identification to apply for these discounts."},{q:"How do I update my contact number or service address on file with AGWA?",a:"You can update your Service Address directly in the 'My Profile' section of this portal. For changes to your primary contact number, especially if it's used for OTPs or critical alerts, it's best to contact AGWA customer service or visit one of our business offices to ensure your records are accurately updated and verified."},{q:"What are the accepted payment methods for my water bill?",a:"This portal simulates payments via various methods for demonstration. For actual payments, AGWA accepts payments through a wide range of accredited channels, including: AGWA Business Offices, Bayad Centers, 7-Eleven, SM Bills Payment, selected banks (over-the-counter and online banking), and mobile wallets like GCash and Maya. Please refer to the official AGWA website or your bill statement for a complete list of authorized payment partners."},{q:"How can I get an official receipt (OR) after making a payment?",a:"For payments made through this portal (which are simulated), a transaction reference is provided. For actual payments made via AGWA's accredited channels, an official receipt or proof of payment will be issued by that specific channel (e.g., a bank validation slip, a payment center receipt, a digital receipt from an e-wallet). AGWA is continuously working on enhancing digital services, including the future provision of consolidated digital ORs through the portal."},{q:"What is a 'meter deposit' for new service connections?",a:"A meter deposit is a one-time charge collected from customers upon application for a new water service connection. This deposit serves as a security against potential unpaid bills or damages to the water meter. It is refundable, with interest (if applicable by law), upon termination of the service contract, provided all outstanding obligations to AGWA have been settled."},{q:"How do I report a damaged, leaking, or stolen water meter?",a:"Report any instance of a damaged, leaking, or stolen water meter to AGWA immediately. You can use the 'Report Issue' section in this portal (select 'Meter Problem') or call our emergency hotline. Tampering with or unauthorized removal of water meters is illegal and may result in penalties."},{q:"Can I request for a temporary disconnection of my water service if I'll be away for an extended period?",a:"Yes, you can request a temporary or voluntary disconnection of your water service. To do this, please visit any AGWA business office to file your formal request. There might be applicable fees for the disconnection and subsequent reconnection process. Please inquire about the specific requirements and charges."}],Vq=()=>u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(nF,{size:30,className:"mr-3 text-blue-600"}),"Frequently Asked Questions"]})}),u.jsx("div",{className:"space-y-4",children:Fq.map((r,e)=>u.jsxs("details",{className:"group bg-gray-50 hover:bg-gray-100 p-4 rounded-lg shadow-sm hover:shadow-md transition-all duration-200 ease-in-out",children:[u.jsxs("summary",{className:"flex justify-between items-center font-medium cursor-pointer list-none text-gray-900 text-sm sm:text-base",children:[u.jsx("span",{className:"group-open:text-blue-700 group-open:font-semibold",children:r.q}),u.jsx("span",{className:"transition-transform duration-300 transform group-open:rotate-180 text-blue-600 group-open:text-blue-700",children:u.jsx(E2,{size:24})})]}),u.jsx("div",{className:"text-gray-600 mt-3 prose prose-sm max-w-none grid grid-rows-[0fr] group-open:grid-rows-[1fr] transition-all duration-500 ease-in-out",children:u.jsx("div",{className:"overflow-hidden",children:u.jsx("p",{className:"pb-2",children:r.a})})})]},e))})]}),zq=()=>{const r=[{letter:"C",word:"Customer-Centricity",desc:"Our customers are at the heart of every decision and action we take, ensuring their needs are met with utmost priority and care.",icon:Cs},{letter:"R",word:"Responsibility",desc:"We hold ourselves accountable for our impact on the communities we serve and the environment, operating with integrity and a commitment to social good.",icon:sh},{letter:"E",word:"Excellence",desc:"We relentlessly pursue the highest standards in all aspects of our service, operations, and innovation, striving for continuous improvement.",icon:Os},{letter:"S",word:"Sustainability",desc:"We are dedicated to the long-term health and viability of our precious water resources and the planet, implementing eco-friendly practices.",icon:rc},{letter:"T",word:"Teamwork & Integrity",desc:"We foster a collaborative environment built on mutual respect, honesty, and transparency, working together to achieve our common goals.",icon:Ta}],e=[{title:"Deliver Quality",description:"Consistently provide safe, reliable, and affordable water and wastewater services that exceed customer expectations and meet stringent regulatory standards."},{title:"Innovate & Adapt",description:"Embrace technological advancements and innovative practices to enhance operational efficiency, service delivery, and resource management in an ever-changing world."},{title:"Customer First",description:"Cultivate a culture of exceptional customer care through responsive, transparent, fair, and easily accessible service channels, including this advanced digital portal."},{title:"Protect Resources",description:"Champion water conservation, actively work to reduce non-revenue water, and promote environmental protection through sustainable practices and robust community engagement."},{title:"Empower People",description:"Invest in the growth, professional development, and overall well-being of our employees, fostering a skilled, motivated, diverse, and safety-conscious workforce."},{title:"Community Partnership",description:"Actively contribute to the socio-economic development, health, and resilience of the communities we serve through targeted corporate social responsibility programs and collaborative partnerships."}];return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn leading-relaxed text-gray-700",children:[u.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(gn,{size:30,className:"mr-3 text-blue-600"}),"About AGWA Water Services, Inc."]})}),u.jsxs("section",{className:"mb-8",children:[u.jsxs("h3",{className:"text-xl font-semibold text-blue-700 mb-2 flex items-center",children:[u.jsx(w2,{size:22,className:"mr-2.5 text-blue-600/80"})," Our Genesis & Enduring Commitment"]}),u.jsx("p",{children:"AGWA Water Services, Inc. was established in 2005 with a singular, profound vision: to ensure every Filipino has access to clean, safe, and sustainable water. Recognizing water as the cornerstone of life, health, and economic progress, AGWA embarked on a mission to become a leading force in the Philippine water utility sector. From humble beginnings, we have grown through unwavering dedication, strategic investments in infrastructure and technology, and a deep-rooted commitment to the communities we are privileged to serve. Our journey has been one of continuous learning, adaptation, and an ever-stronger resolve to meet the evolving water needs of a dynamic nation."})]}),u.jsxs("section",{className:"mb-8",children:[u.jsxs("h3",{className:"text-xl font-semibold text-blue-700 mb-2 flex items-center",children:[u.jsx(Os,{size:22,className:"mr-2.5 text-blue-600/80"})," Operational Excellence & Innovation"]}),u.jsx("p",{children:"At the heart of AGWA lies a relentless pursuit of excellence. We employ state-of-the-art water sourcing techniques, advanced multi-stage treatment processes, and smart distribution networks, all managed by a team of highly skilled engineers, certified technicians, and dedicated customer service professionals. Our operations strictly adhere to, and often exceed, national and international quality standards (PNSDW, WHO guidelines), ensuring that the water reaching your taps is not just potable but of the highest purity and reliability. We continuously invest in research and development to innovate and improve our services, from leak detection technologies and pressure management systems to digital customer interfaces and data-driven resource planning."})]}),u.jsxs("section",{className:"mb-8",children:[u.jsxs("h3",{className:"text-xl font-semibold text-blue-700 mb-2 flex items-center",children:[u.jsx(rc,{size:22,className:"mr-2.5 text-blue-600/80"})," Sustainability and Environmental Stewardship: Our Pledge"]}),u.jsx("p",{children:"AGWA is profoundly aware of its responsibility as a steward of one of Earth's most precious resources. Sustainability is not just a buzzword for us; it's integrated into every facet of our operations. This includes responsible water abstraction from diverse sources, active participation in watershed protection and reforestation programs, and the implementation of advanced wastewater treatment and water recycling initiatives to minimize our environmental footprint. We actively promote water conservation education among our consumers and invest in projects that enhance climate resilience and mitigate environmental impact, ensuring that future generations can also enjoy the gift of clean water."})]}),u.jsxs("div",{className:"my-10 p-6 bg-gradient-to-r from-blue-600 to-indigo-700 text-white rounded-xl shadow-xl text-center",children:[u.jsx(tc,{size:36,className:"mx-auto mb-3 text-blue-200"}),u.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Our Vision"}),u.jsx("p",{className:"italic text-lg text-blue-100 leading-relaxed max-w-3xl mx-auto",children:`"To be the Philippines' most trusted and innovative water solutions provider, empowering communities with sustainable access to life-enhancing water services and championing environmental stewardship for a resilient future."`})]}),u.jsxs("div",{className:"my-10",children:[u.jsxs("h3",{className:"text-2xl font-bold text-blue-700 mb-6 text-center flex items-center justify-center",children:[u.jsx(sF,{size:28,className:"mr-3 text-blue-600"})," Our Mission"]}),u.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 gap-5",children:e.map((t,n)=>u.jsxs("div",{className:"bg-blue-50 p-5 rounded-lg shadow-md hover:shadow-lg transition-shadow h-full flex flex-col",children:[u.jsx("strong",{className:"text-blue-700 block text-md mb-1.5",children:t.title}),u.jsx("p",{className:"text-sm text-gray-600 leading-normal flex-grow",children:t.description})]},n))})]}),u.jsxs("div",{className:"my-12 pt-8 border-t border-gray-200",children:[u.jsx("h3",{className:"text-2xl font-bold text-blue-700 mb-8 text-center",children:"Our Core Values: The AGWA C.R.E.S.T."}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-5 gap-5",children:r.map(t=>{const n=t.icon;return u.jsxs("div",{className:"p-5 border border-blue-100 rounded-xl bg-white shadow-lg hover:shadow-2xl transition-all duration-300 flex flex-col items-center text-center h-full hover:border-blue-300 transform hover:-translate-y-1",children:[u.jsx("div",{className:"p-3 rounded-full bg-gradient-to-br from-blue-500 to-indigo-600 text-white mb-3 shadow-md",children:u.jsx(n,{className:"",size:32})}),u.jsx("p",{className:"text-4xl font-bold text-blue-600 mb-1",children:t.letter}),u.jsx("strong",{className:"text-blue-700 block text-md mb-1.5",children:t.word}),u.jsx("p",{className:"text-xs text-gray-600 mt-1 leading-snug flex-grow",children:t.desc})]},t.letter)})})]}),u.jsx("p",{className:"pt-8 mt-8 text-gray-800 font-medium text-center text-lg border-t border-gray-200",children:"AGWA Water Services, Inc.  Ensuring Clarity, Sustaining Life."})]})},Bq=({type:r,href:e})=>{let t,n="hover:text-blue-700";switch(r){case"Facebook":t=H9,n="hover:text-blue-600";break;case"Twitter":t=oF,n="hover:text-sky-500";break;case"Instagram":t=K9,n="hover:text-pink-600";break;default:return null}return u.jsx("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:`text-gray-500 transition-colors duration-200 ${n}`,title:r,children:u.jsx(t,{size:28})})},Uq=({systemSettings:r={}})=>{const{supportHotline:e="1627-AGWA (24/7 Emergency)",supportEmail:t="support@agwa-waterservices.com.ph"}=r,n=[{icon:i3,title:"Customer Service Hotlines",lines:[{text:e,valueClass:"text-2xl font-semibold text-blue-700 tracking-tight"},{text:"(+63 2) 8162-2492 (Outside Metro Manila / Standard Hours)",valueClass:"text-lg text-gray-700"}],note:"Emergency reports are handled 24/7. General inquiries: Mon - Fri, 8 AM - 5 PM PHT.",bgColor:"bg-blue-50",iconColor:"text-blue-600"},{icon:Fo,title:"Email Support",lines:[{text:t,valueClass:"text-lg text-green-700 hover:underline"}],note:"For general inquiries, billing concerns, feedback, and non-urgent requests. Expect a response within 1-2 business days.",href:`mailto:${t}`,bgColor:"bg-green-50",iconColor:"text-green-600"}],i={title:"AGWA Head Office",addressLines:["AGWA Water Services Tower","123 Aqua Drive, Hydro Business Park","Naic, Cavite, Philippines 4110"],hours:"Mon - Fri, 8:00 AM - 5:00 PM PHT (Closed on weekends & public holidays)",note:"Walk-ins are welcome for payments and specific services. For complex concerns, an appointment is recommended to ensure specialist availability.",mapLink:"https://maps.google.com/?q=AGWA+Water+Services+Tower,Quezon+City",bgColor:"bg-gray-100",iconColor:"text-gray-600"},s=[{type:"Facebook",href:"https://facebook.com/AGWAwaterservices"},{type:"Twitter",href:"https://twitter.com/AGWAwaterserv"},{type:"Instagram",href:"https://instagram.com/AGWAwater"}];return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(Pa,{size:30,className:"mr-3 text-blue-600"}),"Get In Touch With AGWA"]})}),u.jsx("p",{className:"text-gray-700 mb-8 leading-relaxed text-sm sm:text-base",children:"We value your feedback and are dedicated to assisting you with your water service needs. For immediate assistance, especially during emergencies like major leaks or widespread service interruptions, please use our 24/7 hotline. For other inquiries, choose the most convenient channel below."}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:n.map((o,l)=>{const d=o.icon;return u.jsxs("div",{className:`p-5 rounded-xl shadow-lg hover:shadow-xl transition-shadow ${o.bgColor} border border-gray-200`,children:[u.jsxs("div",{className:"flex items-start mb-3",children:[u.jsx(d,{size:28,className:`mr-4 mt-1 flex-shrink-0 ${o.iconColor}`}),u.jsxs("div",{children:[u.jsx("h3",{className:`text-lg font-semibold ${o.iconColor}`,children:o.title}),o.lines.map((f,m)=>o.href&&m===0?u.jsx("a",{href:o.href,className:f.valueClass,children:f.text},m):u.jsx("p",{className:f.valueClass,children:f.text},m))]})]}),u.jsx("p",{className:"text-xs text-gray-500 leading-normal",children:o.note})]},l)})}),u.jsxs("div",{className:`p-5 rounded-xl shadow-lg hover:shadow-xl transition-shadow mb-8 ${i.bgColor} border border-gray-200`,children:[u.jsxs("div",{className:"flex items-start mb-3",children:[u.jsx(w2,{size:28,className:`mr-4 mt-1 flex-shrink-0 ${i.iconColor}`}),u.jsxs("div",{children:[u.jsx("h3",{className:`text-lg font-semibold ${i.iconColor}`,children:i.title}),i.addressLines.map((o,l)=>u.jsx("p",{className:"text-sm text-gray-700 leading-snug",children:o},l))]})]}),u.jsxs("div",{className:"text-sm text-gray-600 space-y-1 mt-2",children:[u.jsxs("p",{className:"flex items-center",children:[u.jsx(di,{size:14,className:"mr-2 text-gray-500"}),u.jsx("strong",{children:"Hours:"})," ",i.hours]}),u.jsxs("p",{className:"flex items-start",children:[u.jsx(co,{size:14,className:"mr-2 mt-0.5 text-gray-500 flex-shrink-0"}),u.jsx("strong",{children:"Location Note:"})," ",i.note]})]}),u.jsxs("a",{href:i.mapLink,target:"_blank",rel:"noopener noreferrer",className:"mt-3 inline-flex items-center text-xs text-blue-600 hover:text-blue-800 hover:underline font-medium",children:["View on Map ",u.jsx(co,{size:12,className:"ml-1"})]})]}),u.jsxs("div",{className:"mt-10 text-center border-t border-gray-200 pt-8",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-3",children:"Stay Connected"}),u.jsx("p",{className:"text-sm text-gray-600 mb-5 max-w-md mx-auto",children:"Follow us on our official social media channels for the latest news, service advisories, water conservation tips, and community program updates."}),u.jsx("div",{className:"flex justify-center space-x-6 sm:space-x-8",children:s.map(o=>u.jsx(Bq,{type:o.type,href:o.href},o.type))}),u.jsxs("p",{className:"mt-8 text-xs text-gray-500",children:["For online self-service options, please ",u.jsx("button",{onClick:()=>{alert("Please log in to access self-service options.")},className:"text-blue-600 hover:underline font-medium",children:"log in"})," to your account. ",u.jsx("br",{}),"General information is also available on our official website: ",u.jsx("a",{href:"https://www.agwa-waterservices.com.ph",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline font-medium",children:"www.agwa-waterservices.com.ph"})]})]})]})},qq=({user:r,userData:e,db:t,showNotification:n,setActiveSection:i})=>{const[s,o]=J.useState({totalUsers:0,openTickets:0,activeAnnouncements:0,systemStatus:"Operational"}),[l,d]=J.useState(!0),[f,m]=J.useState(""),y=J.useCallback(async()=>{d(!0),m("");try{const _=await Promise.allSettled([JC(t),e3(t),v9(t)]),[E,x,b]=_,T={systemStatus:"Operational"};let N="";E.status==="fulfilled"&&E.value.success?T.totalUsers=E.value.data.total:N+="Users data unavailable. ",x.status==="fulfilled"&&x.value.success?T.openTickets=x.value.data.openCount||0:N+="Tickets data unavailable. ",b.status==="fulfilled"&&b.value.success?T.activeAnnouncements=b.value.data.active:N+="Announcements data unavailable. ",o(R=>({...R,...T})),N.trim()&&(m(N.trim()),n(`Partial data load: ${N}`,"warning"))}catch{const E="A critical error occurred while fetching dashboard statistics.";m(E),n(E,"error"),o(x=>({...x,systemStatus:"Error"}))}finally{d(!1)}},[t,n]);J.useEffect(()=>{y()},[y]);const g=[{title:"User Management",icon:Ta,section:"userManagement",description:"View, edit, and manage all user accounts.",color:"blue"},{title:"Support Tickets",icon:Pa,section:"supportTickets",description:"Address and manage user-submitted issues.",color:"purple"},{title:"Announcements",icon:bd,section:"manageAnnouncements",description:"Create and publish portal-wide announcements.",color:"teal"},{title:"System Analytics",icon:b2,section:"systemAnalytics",description:"View key metrics and system performance data.",color:"orange"},{title:"Meter Readings Mgt.",icon:rc,section:"editMeterReadingsAdmin",description:"Oversee and manage meter reading entries.",color:"sky"},{title:"System Settings",icon:r0,section:"systemSettings",description:"Configure application parameters and settings.",color:"gray"}];return l?u.jsx(an,{message:"Loading admin dashboard statistics...",className:"mt-10 h-48"}):u.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[u.jsx("div",{className:"p-6 bg-gradient-to-r from-slate-700 to-slate-900 text-white rounded-xl shadow-2xl",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl sm:text-3xl font-bold",children:"Administrator Dashboard"}),u.jsxs("p",{className:"mt-1 text-slate-300",children:["Welcome, ",(e==null?void 0:e.displayName)||"Admin",". Oversee portal operations."]})]}),u.jsxs("button",{onClick:y,className:"text-sm flex items-center bg-slate-600 hover:bg-slate-500 text-white font-medium py-2 px-3 rounded-lg transition-colors disabled:opacity-70",disabled:l,title:"Refresh Statistics",children:[l?u.jsx(Et,{size:16,className:"animate-spin"}):u.jsx(za,{size:16}),u.jsx("span",{className:"ml-2 hidden sm:inline",children:"Refresh"})]})]})}),f&&u.jsxs("p",{className:"text-sm text-yellow-600 bg-yellow-50 p-3 rounded-md text-center flex items-center justify-center gap-2",children:[u.jsx(gn,{size:16})," ",f]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-5",children:[u.jsx(hi,{title:"Total Users",value:s.totalUsers??"N/A",icon:Ta,borderColor:"border-blue-500",iconColor:"text-blue-500",onClick:()=>i("userManagement")}),u.jsx(hi,{title:"Open Support Tickets",value:s.openTickets,icon:Kt,borderColor:"border-red-500",iconColor:"text-red-500",onClick:()=>i("supportTickets")}),u.jsx(hi,{title:"Active Announcements",value:s.activeAnnouncements??"N/A",icon:bd,borderColor:"border-teal-500",iconColor:"text-teal-500",onClick:()=>i("viewAnnouncements")}),u.jsx(hi,{title:"System Status",value:s.systemStatus,icon:sh,borderColor:s.systemStatus==="Error"?"border-red-500":"border-green-500",iconColor:s.systemStatus==="Error"?"text-red-500":"text-green-500"})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-5 mt-8 pt-5 border-t border-gray-200",children:"Administrative Tools"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map(_=>u.jsxs("button",{onClick:()=>i(_.section),className:`p-6 bg-white rounded-xl shadow-lg hover:shadow-2xl transform hover:-translate-y-1.5 transition-all duration-300 ease-in-out text-left focus:outline-none focus:ring-2 focus:ring-${_.color}-500 focus:ring-opacity-75 group h-full flex flex-col`,children:[u.jsx("div",{className:`p-3 bg-${_.color}-100 rounded-full inline-block mb-3 self-start group-hover:scale-110 transition-transform`,children:u.jsx(_.icon,{size:28,className:`text-${_.color}-600`})}),u.jsx("h4",{className:`text-lg font-semibold text-gray-800 group-hover:text-${_.color}-700 transition-colors`,children:_.title}),u.jsx("p",{className:"text-sm text-gray-500 mt-1 leading-normal flex-grow",children:_.description})]},_.section))})]})]})},Li="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",SN="bg-gray-200 cursor-not-allowed text-gray-500",Hq=({user:r,isOpen:e,onClose:t,onSave:n,isSaving:i,determineServiceTypeAndRole:s})=>{const[o,l]=J.useState({displayName:"",email:"",accountNumber:"",accountStatus:"Active",role:"customer",serviceType:"Residential",meterSerialNumber:"",meterSize:'1/2"',discountStatus:"none",photoURL:""}),[d,f]=J.useState({district:"",barangay:"",street:"",landmark:""}),[m,y]=J.useState([]),[g,_]=J.useState([]),E=o.role==="customer";J.useEffect(()=>{if(y(c0()),r){const N=r.role||"customer",R=N==="customer";if(l({displayName:r.displayName||"",email:r.email||"",accountNumber:r.accountNumber||"",accountStatus:r.accountStatus||"Active",role:N,serviceType:r.serviceType||"Residential",meterSerialNumber:r.meterSerialNumber||"",meterSize:r.meterSize||'1/2"',discountStatus:r.discountStatus||"none",photoURL:r.photoURL||""}),R&&r.serviceAddress&&typeof r.serviceAddress=="object"){const I=r.serviceAddress.district||"";f({district:r.serviceAddress.district||"",barangay:r.serviceAddress.barangay||"",street:r.serviceAddress.street||"",landmark:r.serviceAddress.landmark||""}),I&&_($d(I))}else f({district:"",barangay:"",street:"",landmark:""})}},[r]);const x=N=>{const{name:R,value:I}=N.target;f(j=>{const U={...j,[R]:I};return R==="district"&&(U.barangay="",_($d(I))),U})},b=N=>{const{name:R,value:I,type:j,checked:U}=N.target;let C={...o,[R]:j==="checkbox"?U:I};if(R==="accountNumber"&&s){const{role:k,serviceType:D}=s(I);C={...C,role:k,serviceType:D}}if(R==="role"&&I!=="customer"){C.accountNumber="",C.meterSerialNumber="",C.meterSize="",C.discountStatus="none";const{serviceType:k}=s("");C.serviceType=k,f({district:"",barangay:"",street:"",landmark:""})}l(C)},T=N=>{N.preventDefault();const R={...o,serviceAddress:E?d:{}};E||(delete R.meterSerialNumber,delete R.meterSize,delete R.serviceAddress,delete R.discountStatus),n(R)};return u.jsx(Ar,{isOpen:e,onClose:t,title:`Edit User: ${r.displayName||r.email}`,size:"3xl",children:u.jsxs("form",{onSubmit:T,className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsx("input",{type:"text",name:"displayName",value:o.displayName,onChange:b,className:Li,placeholder:"Full Name"}),u.jsx("input",{type:"email",name:"email",value:o.email,className:`${Li} ${SN}`,disabled:!0}),u.jsx("select",{name:"role",value:o.role,onChange:b,className:`${Li} capitalize`,children:["customer","admin","meter_reader","clerk_cashier"].map(N=>u.jsx("option",{value:N,children:N.replace("_"," ")},N))}),u.jsxs("select",{name:"accountStatus",value:o.accountStatus,onChange:b,className:Li,children:[u.jsx("option",{value:"Active",children:"Active"}),u.jsx("option",{value:"Inactive",children:"Inactive"}),u.jsx("option",{value:"Suspended",children:"Suspended"})]}),u.jsx("input",{type:"text",name:"accountNumber",value:o.accountNumber,onChange:b,className:Li,placeholder:"Account Number",disabled:!E}),u.jsx("input",{type:"text",name:"serviceType",value:o.serviceType,className:`${Li} ${SN}`,disabled:!0}),E&&u.jsxs(u.Fragment,{children:[u.jsx("input",{type:"text",name:"meterSerialNumber",value:o.meterSerialNumber,onChange:b,className:Li,placeholder:"Meter Serial Number"}),u.jsx("input",{type:"text",name:"meterSize",value:o.meterSize,onChange:b,className:Li,placeholder:"Meter Size"})]})]}),u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"photoURL",className:"block text-sm font-medium text-gray-700 mb-1",children:[u.jsx(M9,{size:14,className:"inline mr-1.5"}),"Photo URL"]}),u.jsx("input",{type:"url",name:"photoURL",value:o.photoURL,onChange:b,className:Li,placeholder:"https://example.com/image.png"})]}),E&&u.jsxs("div",{className:"pt-4 mt-4 border-t",children:[u.jsx("h3",{className:"text-md font-semibold text-gray-700 mb-2",children:"Service Address"}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("select",{name:"district",value:d.district,onChange:x,className:Li,children:[u.jsx("option",{value:"",children:"Select District"}),m.map(N=>u.jsx("option",{value:N,children:N},N))]}),u.jsxs("select",{name:"barangay",value:d.barangay,onChange:x,className:Li,disabled:!d.district,children:[u.jsx("option",{value:"",children:"Select Barangay"}),g.map(N=>u.jsx("option",{value:N,children:N},N))]}),u.jsx("div",{className:"md:col-span-2",children:u.jsx("input",{type:"text",name:"street",value:d.street,onChange:x,className:Li,placeholder:"Street Name, Building, House No."})}),u.jsx("div",{className:"md:col-span-2",children:u.jsx("input",{type:"text",name:"landmark",value:d.landmark,onChange:x,className:Li,placeholder:"Landmark"})})]})]}),E&&u.jsxs("div",{className:"pt-4 mt-4 border-t",children:[u.jsx("h3",{className:"text-md font-semibold text-gray-700 mb-2",children:"Discount Status"}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"discountStatus",className:"block text-xs font-medium text-gray-600 mb-1",children:"Set Verification Status"}),u.jsxs("select",{id:"discountStatus",name:"discountStatus",value:o.discountStatus,onChange:b,className:Li,children:[u.jsx("option",{value:"none",children:"None"}),u.jsx("option",{value:"pending",children:"Pending Verification"}),u.jsx("option",{value:"verified",children:"Verified (Active)"})]}),u.jsxs("p",{className:"text-xs text-gray-500 mt-1 p-2 bg-yellow-50 border border-yellow-200 rounded-md",children:[u.jsx(gn,{size:14,className:"inline mr-1.5"}),u.jsx("strong",{children:"Admin Only:"}),' Set to "Verified" only after seeing a valid Senior/PWD ID.']})]})]}),u.jsxs("div",{className:"pt-4 flex justify-end space-x-3",children:[u.jsx("button",{type:"button",onClick:t,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-lg border",disabled:i,children:"Cancel"}),u.jsxs("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg flex items-center",disabled:i,children:[i?u.jsx(Et,{size:18,className:"animate-spin mr-2"}):u.jsx(Ba,{size:18,className:"mr-2"}),i?"Saving...":"Save Changes"]})]})]})})},oc=({isOpen:r,onClose:e,onConfirm:t,title:n,children:i,confirmText:s="Confirm",cancelText:o="Cancel",confirmButtonClass:l="bg-red-600 hover:bg-red-700 focus:ring-red-500",cancelButtonClass:d="bg-gray-200 hover:bg-gray-300 text-gray-700 focus:ring-gray-400",iconType:f="warning",isConfirming:m=!1})=>{if(!r)return null;let y,g="";switch(f){case"success":y=Ps,g="text-green-500";break;case"danger":y=V9,g="text-red-500";break;case"warning":default:y=Kt,g="text-yellow-500";break}return u.jsxs(Ar,{isOpen:r,onClose:e,title:n,size:"md",children:[u.jsxs("div",{className:"text-center",children:[y&&u.jsx("div",{className:`mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-${f==="warning"?"yellow":f==="success"?"green":"red"}-100 mb-4`,children:u.jsx(y,{className:`h-6 w-6 ${g}`,"aria-hidden":"true"})}),u.jsx("div",{className:"text-sm text-gray-600 mb-6",children:i})]}),u.jsxs("div",{className:"mt-5 sm:mt-6 flex flex-col sm:flex-row-reverse gap-3",children:[u.jsxs("button",{type:"button",className:`w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 text-base font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 sm:text-sm ${l} ${m?"opacity-50 cursor-not-allowed":""}`,onClick:t,disabled:m,children:[m?u.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):null,m?"Processing...":s]}),u.jsx("button",{type:"button",className:`w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 text-base font-medium focus:outline-none focus:ring-2 focus:ring-offset-2 sm:text-sm ${d}`,onClick:e,disabled:m,children:o})]})]})};function Kx(){return Kx=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)({}).hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Kx.apply(null,arguments)}function TN(r){if(r===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return r}function Yx(r,e){return Yx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,n){return t.__proto__=n,t},Yx(r,e)}function $q(r,e){r.prototype=Object.create(e.prototype),r.prototype.constructor=r,Yx(r,e)}var AN=Number.isNaN||function(e){return typeof e=="number"&&e!==e};function Wq(r,e){return!!(r===e||AN(r)&&AN(e))}function Gq(r,e){if(r.length!==e.length)return!1;for(var t=0;t<r.length;t++)if(!Wq(r[t],e[t]))return!1;return!0}function m1(r,e){e===void 0&&(e=Gq);var t,n=[],i,s=!1;function o(){for(var l=[],d=0;d<arguments.length;d++)l[d]=arguments[d];return s&&t===this&&e(l,n)||(i=r.apply(this,l),s=!0,t=this,n=l),i}return o}var Kq=typeof performance=="object"&&typeof performance.now=="function",NN=Kq?function(){return performance.now()}:function(){return Date.now()};function IN(r){cancelAnimationFrame(r.id)}function Yq(r,e){var t=NN();function n(){NN()-t>=e?r.call(null):i.id=requestAnimationFrame(n)}var i={id:requestAnimationFrame(n)};return i}var p1=-1;function kN(r){if(r===void 0&&(r=!1),p1===-1||r){var e=document.createElement("div"),t=e.style;t.width="50px",t.height="50px",t.overflow="scroll",document.body.appendChild(e),p1=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return p1}var ld=null;function PN(r){if(r===void 0&&(r=!1),ld===null||r){var e=document.createElement("div"),t=e.style;t.width="50px",t.height="50px",t.overflow="scroll",t.direction="rtl";var n=document.createElement("div"),i=n.style;return i.width="100px",i.height="100px",e.appendChild(n),document.body.appendChild(e),e.scrollLeft>0?ld="positive-descending":(e.scrollLeft=1,e.scrollLeft===0?ld="negative":ld="positive-ascending"),document.body.removeChild(e),ld}return ld}var Zq=150,Qq=function(e,t){return e};function Xq(r){var e,t=r.getItemOffset,n=r.getEstimatedTotalSize,i=r.getItemSize,s=r.getOffsetForIndexAndAlignment,o=r.getStartIndexForOffset,l=r.getStopIndexForStartIndex,d=r.initInstanceProps,f=r.shouldResetStyleCacheOnItemSizeChange,m=r.validateProps;return e=function(y){$q(g,y);function g(E){var x;return x=y.call(this,E)||this,x._instanceProps=d(x.props,TN(x)),x._outerRef=void 0,x._resetIsScrollingTimeoutId=null,x.state={instance:TN(x),isScrolling:!1,scrollDirection:"forward",scrollOffset:typeof x.props.initialScrollOffset=="number"?x.props.initialScrollOffset:0,scrollUpdateWasRequested:!1},x._callOnItemsRendered=void 0,x._callOnItemsRendered=m1(function(b,T,N,R){return x.props.onItemsRendered({overscanStartIndex:b,overscanStopIndex:T,visibleStartIndex:N,visibleStopIndex:R})}),x._callOnScroll=void 0,x._callOnScroll=m1(function(b,T,N){return x.props.onScroll({scrollDirection:b,scrollOffset:T,scrollUpdateWasRequested:N})}),x._getItemStyle=void 0,x._getItemStyle=function(b){var T=x.props,N=T.direction,R=T.itemSize,I=T.layout,j=x._getItemStyleCache(f&&R,f&&I,f&&N),U;if(j.hasOwnProperty(b))U=j[b];else{var C=t(x.props,b,x._instanceProps),k=i(x.props,b,x._instanceProps),D=N==="horizontal"||I==="horizontal",O=N==="rtl",P=D?C:0;j[b]=U={position:"absolute",left:O?void 0:P,right:O?P:void 0,top:D?0:C,height:D?"100%":k,width:D?k:"100%"}}return U},x._getItemStyleCache=void 0,x._getItemStyleCache=m1(function(b,T,N){return{}}),x._onScrollHorizontal=function(b){var T=b.currentTarget,N=T.clientWidth,R=T.scrollLeft,I=T.scrollWidth;x.setState(function(j){if(j.scrollOffset===R)return null;var U=x.props.direction,C=R;if(U==="rtl")switch(PN()){case"negative":C=-R;break;case"positive-descending":C=I-N-R;break}return C=Math.max(0,Math.min(C,I-N)),{isScrolling:!0,scrollDirection:j.scrollOffset<C?"forward":"backward",scrollOffset:C,scrollUpdateWasRequested:!1}},x._resetIsScrollingDebounced)},x._onScrollVertical=function(b){var T=b.currentTarget,N=T.clientHeight,R=T.scrollHeight,I=T.scrollTop;x.setState(function(j){if(j.scrollOffset===I)return null;var U=Math.max(0,Math.min(I,R-N));return{isScrolling:!0,scrollDirection:j.scrollOffset<U?"forward":"backward",scrollOffset:U,scrollUpdateWasRequested:!1}},x._resetIsScrollingDebounced)},x._outerRefSetter=function(b){var T=x.props.outerRef;x._outerRef=b,typeof T=="function"?T(b):T!=null&&typeof T=="object"&&T.hasOwnProperty("current")&&(T.current=b)},x._resetIsScrollingDebounced=function(){x._resetIsScrollingTimeoutId!==null&&IN(x._resetIsScrollingTimeoutId),x._resetIsScrollingTimeoutId=Yq(x._resetIsScrolling,Zq)},x._resetIsScrolling=function(){x._resetIsScrollingTimeoutId=null,x.setState({isScrolling:!1},function(){x._getItemStyleCache(-1,null)})},x}g.getDerivedStateFromProps=function(x,b){return Jq(x,b),m(x),null};var _=g.prototype;return _.scrollTo=function(x){x=Math.max(0,x),this.setState(function(b){return b.scrollOffset===x?null:{scrollDirection:b.scrollOffset<x?"forward":"backward",scrollOffset:x,scrollUpdateWasRequested:!0}},this._resetIsScrollingDebounced)},_.scrollToItem=function(x,b){b===void 0&&(b="auto");var T=this.props,N=T.itemCount,R=T.layout,I=this.state.scrollOffset;x=Math.max(0,Math.min(x,N-1));var j=0;if(this._outerRef){var U=this._outerRef;R==="vertical"?j=U.scrollWidth>U.clientWidth?kN():0:j=U.scrollHeight>U.clientHeight?kN():0}this.scrollTo(s(this.props,x,b,I,this._instanceProps,j))},_.componentDidMount=function(){var x=this.props,b=x.direction,T=x.initialScrollOffset,N=x.layout;if(typeof T=="number"&&this._outerRef!=null){var R=this._outerRef;b==="horizontal"||N==="horizontal"?R.scrollLeft=T:R.scrollTop=T}this._callPropsCallbacks()},_.componentDidUpdate=function(){var x=this.props,b=x.direction,T=x.layout,N=this.state,R=N.scrollOffset,I=N.scrollUpdateWasRequested;if(I&&this._outerRef!=null){var j=this._outerRef;if(b==="horizontal"||T==="horizontal")if(b==="rtl")switch(PN()){case"negative":j.scrollLeft=-R;break;case"positive-ascending":j.scrollLeft=R;break;default:var U=j.clientWidth,C=j.scrollWidth;j.scrollLeft=C-U-R;break}else j.scrollLeft=R;else j.scrollTop=R}this._callPropsCallbacks()},_.componentWillUnmount=function(){this._resetIsScrollingTimeoutId!==null&&IN(this._resetIsScrollingTimeoutId)},_.render=function(){var x=this.props,b=x.children,T=x.className,N=x.direction,R=x.height,I=x.innerRef,j=x.innerElementType,U=x.innerTagName,C=x.itemCount,k=x.itemData,D=x.itemKey,O=D===void 0?Qq:D,P=x.layout,F=x.outerElementType,M=x.outerTagName,$=x.style,Y=x.useIsScrolling,te=x.width,oe=this.state.isScrolling,ie=N==="horizontal"||P==="horizontal",ne=ie?this._onScrollHorizontal:this._onScrollVertical,K=this._getRangeToRender(),B=K[0],G=K[1],X=[];if(C>0)for(var se=B;se<=G;se++)X.push(J.createElement(b,{data:k,key:O(se,k),index:se,isScrolling:Y?oe:void 0,style:this._getItemStyle(se)}));var le=n(this.props,this._instanceProps);return J.createElement(F||M||"div",{className:T,onScroll:ne,ref:this._outerRefSetter,style:Kx({position:"relative",height:R,width:te,overflow:"auto",WebkitOverflowScrolling:"touch",willChange:"transform",direction:N},$)},J.createElement(j||U||"div",{children:X,ref:I,style:{height:ie?"100%":le,pointerEvents:oe?"none":void 0,width:ie?le:"100%"}}))},_._callPropsCallbacks=function(){if(typeof this.props.onItemsRendered=="function"){var x=this.props.itemCount;if(x>0){var b=this._getRangeToRender(),T=b[0],N=b[1],R=b[2],I=b[3];this._callOnItemsRendered(T,N,R,I)}}if(typeof this.props.onScroll=="function"){var j=this.state,U=j.scrollDirection,C=j.scrollOffset,k=j.scrollUpdateWasRequested;this._callOnScroll(U,C,k)}},_._getRangeToRender=function(){var x=this.props,b=x.itemCount,T=x.overscanCount,N=this.state,R=N.isScrolling,I=N.scrollDirection,j=N.scrollOffset;if(b===0)return[0,0,0,0];var U=o(this.props,j,this._instanceProps),C=l(this.props,U,j,this._instanceProps),k=!R||I==="backward"?Math.max(1,T):1,D=!R||I==="forward"?Math.max(1,T):1;return[Math.max(0,U-k),Math.max(0,Math.min(b-1,C+D)),U,C]},g}(J.PureComponent),e.defaultProps={direction:"ltr",itemData:void 0,layout:"vertical",overscanCount:2,useIsScrolling:!1},e}var Jq=function(e,t){e.children,e.direction,e.height,e.layout,e.innerTagName,e.outerTagName,e.width,t.instance},eH=Xq({getItemOffset:function(e,t){var n=e.itemSize;return t*n},getItemSize:function(e,t){var n=e.itemSize;return n},getEstimatedTotalSize:function(e){var t=e.itemCount,n=e.itemSize;return n*t},getOffsetForIndexAndAlignment:function(e,t,n,i,s,o){var l=e.direction,d=e.height,f=e.itemCount,m=e.itemSize,y=e.layout,g=e.width,_=l==="horizontal"||y==="horizontal",E=_?g:d,x=Math.max(0,f*m-E),b=Math.min(x,t*m),T=Math.max(0,t*m-E+m+o);switch(n==="smart"&&(i>=T-E&&i<=b+E?n="auto":n="center"),n){case"start":return b;case"end":return T;case"center":{var N=Math.round(T+(b-T)/2);return N<Math.ceil(E/2)?0:N>x+Math.floor(E/2)?x:N}case"auto":default:return i>=T&&i<=b?i:i<T?T:b}},getStartIndexForOffset:function(e,t){var n=e.itemCount,i=e.itemSize;return Math.max(0,Math.min(n-1,Math.floor(t/i)))},getStopIndexForStartIndex:function(e,t,n){var i=e.direction,s=e.height,o=e.itemCount,l=e.itemSize,d=e.layout,f=e.width,m=i==="horizontal"||d==="horizontal",y=t*l,g=m?f:s,_=Math.ceil((g+n-y)/l);return Math.max(0,Math.min(o-1,t+_-1))},initInstanceProps:function(e){},shouldResetStyleCacheOnItemSizeChange:!0,validateProps:function(e){e.itemSize}});const eg="w-full px-3 py-2 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",tH=({db:r,showNotification:e,determineServiceTypeAndRole:t,userData:n})=>{const[i,s]=J.useState([]),[o,l]=J.useState(!0),[d,f]=J.useState(null),[m,y]=J.useState(null),[g,_]=J.useState(""),[E,x]=J.useState(!1),[b,T]=J.useState(!1),[N,R]=J.useState(""),[I,j]=J.useState(""),[U,C]=J.useState(""),[k,D]=J.useState(""),[O,P]=J.useState(!1),[F,M]=J.useState(""),$=J.useCallback(async()=>{l(!0),M("");const ue=await s9(r);if(ue.success)s(ue.data.sort((fe,_e)=>(fe.displayName||fe.email||"").localeCompare(_e.displayName||_e.email||"")));else{const fe=ue.error||"Failed to fetch user list. Please try again.";M(fe)}l(!1)},[r]);J.useEffect(()=>{$()},[$]);const Y=ue=>f(ue),te=()=>f(null),oe=async ue=>{if(!d)return;P(!0);const fe=await fd(r,d.id,ue);fe.success?(e("User profile updated successfully!","success"),te(),$()):e(fe.error||"Failed to update user profile.","error"),P(!1)},ie=(ue,fe)=>{y(ue),_(fe),x(!0)},ne=async()=>{!m||!g||(P(!0),await fd(r,m.id,{accountStatus:g}),e(`User account status changed to ${g}.`,"success"),$(),x(!1),y(null),_(""),P(!1))},K=ue=>{y(ue),T(!0)},B=async()=>{if(!m)return;P(!0),await fd(r,m.id,{accountStatus:"Suspended"});const ue=await D8(r,m.id);ue.success?(e(`User ${m.displayName} has been permanently deleted.`,"success"),$()):(e(ue.error||"Failed to delete user profile.","error"),await fd(r,m.id,{accountStatus:m.accountStatus})),T(!1),y(null),P(!1)},G=i.filter(ue=>{var _e,Oe,qe;const fe=N.toLowerCase();return(((_e=ue.displayName)==null?void 0:_e.toLowerCase().includes(fe))||((Oe=ue.email)==null?void 0:Oe.toLowerCase().includes(fe))||((qe=ue.accountNumber)==null?void 0:qe.toLowerCase().includes(fe)))&&(I?ue.role===I:!0)&&(U?ue.accountStatus===U:!0)&&(k?(ue.discountStatus||"none")===k:!0)}),X={admin:"bg-purple-100 text-purple-700",customer:"bg-blue-100 text-blue-700",meter_reader:"bg-teal-100 text-teal-700",clerk_cashier:"bg-indigo-100 text-indigo-700",unknown:"bg-gray-100 text-gray-700"},se={Active:"bg-green-100 text-green-700",Inactive:"bg-gray-200 text-gray-600",Suspended:"bg-red-100 text-red-700","Profile Missing":"bg-yellow-100 text-yellow-700",Unknown:"bg-gray-100 text-gray-600"},le={none:"bg-gray-100 text-gray-600",pending:"bg-yellow-100 text-yellow-700",verified:"bg-green-100 text-green-700"},Q={none:"None",pending:"Pending",verified:"Verified"},ce=({index:ue,style:fe})=>{var qe;const _e=G[ue],Oe=_e.discountStatus||"none";return u.jsxs("div",{style:fe,className:"flex items-center border-b border-gray-200 text-sm",children:[u.jsx("div",{className:"px-4 py-2 whitespace-nowrap text-gray-800 font-medium flex-1",children:_e.displayName||"N/A"}),u.jsx("div",{className:"px-4 py-2 whitespace-nowrap text-gray-500 truncate flex-1",title:_e.email||_e.phoneNumber,children:_e.email||_e.phoneNumber||"N/A"}),u.jsx("div",{className:"px-4 py-2 flex-1",children:u.jsx("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full capitalize ${X[_e.role||"unknown"]}`,children:((qe=_e.role)==null?void 0:qe.replace("_"," "))||"Unknown"})}),u.jsx("div",{className:"px-4 py-2 whitespace-nowrap text-gray-500 font-mono text-xs flex-1",children:_e.accountNumber||"N/A"}),u.jsx("div",{className:"px-4 py-2 flex-1",children:u.jsx("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full ${se[_e.accountStatus||"Unknown"]}`,children:_e.accountStatus||"Unknown"})}),u.jsx("div",{className:"px-4 py-2 flex-1",children:u.jsx("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full ${le[Oe]}`,children:Q[Oe]})}),u.jsxs("div",{className:"px-4 py-2 whitespace-nowrap text-sm text-center space-x-1.5 flex-1",children:[u.jsx("button",{onClick:()=>Y(_e),className:"text-blue-600 hover:text-blue-800 p-1 hover:bg-blue-100 rounded-md",title:"Edit User",children:u.jsx(k2,{size:16})}),_e.accountStatus!=="Suspended"&&u.jsx("button",{onClick:()=>ie(_e,"Suspended"),className:"text-orange-500 hover:text-orange-700 p-1 hover:bg-orange-100 rounded-md",title:"Suspend User",children:u.jsx(lF,{size:16})}),(_e.accountStatus==="Suspended"||_e.accountStatus==="Inactive")&&u.jsx("button",{onClick:()=>ie(_e,"Active"),className:"text-green-500 hover:text-green-700 p-1 hover:bg-green-100 rounded-md",title:"Activate User",children:u.jsx(l3,{size:16})}),(n==null?void 0:n.uid)!==_e.id&&u.jsx("button",{onClick:()=>K(_e),className:"text-red-600 hover:text-red-800 p-1 hover:bg-red-100 rounded-md",title:"Delete User",children:u.jsx(oh,{size:16})})]})]})};return o?u.jsx(an,{message:"Loading user accounts...",className:"mt-10 h-64"}):u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(Ta,{size:30,className:"mr-3 text-blue-600"})," User Account Management"]}),u.jsxs("button",{onClick:$,className:"mt-3 sm:mt-0 text-sm flex items-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-3 rounded-lg border border-gray-300 transition-colors",disabled:o,title:"Refresh User List",children:[o?u.jsx(Et,{size:16,className:"animate-spin mr-1.5"}):u.jsx(za,{size:16,className:"mr-1.5"})," Refresh List"]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6 p-4 bg-gray-50 rounded-lg shadow-sm",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"userMgmtSearchTerm",className:"block text-xs font-medium text-gray-600 mb-1",children:"Search Users"}),u.jsxs("div",{className:"relative",children:[u.jsx(js,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsx("input",{type:"text",id:"userMgmtSearchTerm",placeholder:"Name, Email, Account No...",className:`${eg} pl-9`,value:N,onChange:ue=>R(ue.target.value)})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"userMgmtFilterRole",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Role"}),u.jsxs("div",{className:"relative",children:[u.jsx(W9,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsxs("select",{id:"userMgmtFilterRole",className:`${eg} pl-9`,value:I,onChange:ue=>j(ue.target.value),children:[u.jsx("option",{value:"",children:"All Roles"}),u.jsx("option",{value:"customer",children:"Customer"}),u.jsx("option",{value:"admin",children:"Admin"}),u.jsx("option",{value:"meter_reader",children:"Meter Reader"}),u.jsx("option",{value:"clerk_cashier",children:"Clerk/Cashier"})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"userMgmtFilterStatus",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Status"}),u.jsxs("div",{className:"relative",children:[u.jsx(sh,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsxs("select",{id:"userMgmtFilterStatus",className:`${eg} pl-9`,value:U,onChange:ue=>C(ue.target.value),children:[u.jsx("option",{value:"",children:"All Statuses"}),u.jsx("option",{value:"Active",children:"Active"}),u.jsx("option",{value:"Inactive",children:"Inactive"}),u.jsx("option",{value:"Suspended",children:"Suspended"}),u.jsx("option",{value:"Profile Missing",children:"Profile Missing"})]})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"userMgmtFilterDiscount",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Discount"}),u.jsxs("div",{className:"relative",children:[u.jsx(ya,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsxs("select",{id:"userMgmtFilterDiscount",className:`${eg} pl-9`,value:k,onChange:ue=>D(ue.target.value),children:[u.jsx("option",{value:"",children:"All"}),u.jsx("option",{value:"none",children:"None"}),u.jsx("option",{value:"pending",children:"Pending"}),u.jsx("option",{value:"verified",children:"Verified"})]})]})]})]}),!o&&G.length===0&&u.jsxs("div",{className:"text-center py-10",children:[u.jsx(gn,{size:48,className:"mx-auto text-gray-400 mb-3"}),u.jsx("p",{className:"text-gray-500 text-lg",children:i.length===0&&!F?"No users found.":"No users match your filters."})]}),!o&&G.length>0&&u.jsxs("div",{className:"overflow-x-auto shadow-md rounded-lg border border-gray-200",children:[u.jsxs("div",{className:"flex bg-gray-100 text-xs font-medium text-gray-500 uppercase tracking-wider",children:[u.jsx("div",{className:"px-4 py-3 flex-1",children:"Name"}),u.jsx("div",{className:"px-4 py-3 flex-1",children:"Email / Contact"}),u.jsx("div",{className:"px-4 py-3 flex-1",children:"Role"}),u.jsx("div",{className:"px-4 py-3 flex-1",children:"Account No."}),u.jsx("div",{className:"px-4 py-3 flex-1",children:"Status"}),u.jsx("div",{className:"px-4 py-3 flex-1",children:"Discount"}),u.jsx("div",{className:"px-4 py-3 text-center flex-1",children:"Actions"})]}),u.jsx(eH,{height:400,itemCount:G.length,itemSize:60,width:"100%",children:ce})]}),d&&u.jsx(Hq,{user:d,isOpen:!!d,onClose:te,onSave:oe,isSaving:O,determineServiceTypeAndRole:t,showNotification:e}),E&&m&&u.jsx(oc,{isOpen:E,onClose:()=>x(!1),onConfirm:ne,title:"Confirm Status Change",confirmText:O?"Updating...":`Set to ${g}`,isConfirming:O,iconType:g==="Active"?"success":"danger",confirmButtonClass:g==="Active"?"bg-green-600 hover:bg-green-700 focus:ring-green-500":"bg-red-600 hover:bg-red-700 focus:ring-red-500",children:u.jsxs("p",{children:["Change status for ",u.jsx("strong",{children:m.displayName||m.email})," to ",u.jsx("strong",{className:g==="Active"?"text-green-600":"text-red-600",children:g}),"?"]})}),b&&m&&u.jsxs(oc,{isOpen:b,onClose:()=>T(!1),onConfirm:B,title:"Confirm User Deletion",confirmText:"Yes, Permanently Delete",isConfirming:O,iconType:"danger",children:[u.jsxs("p",{children:["Are you sure you want to delete ",u.jsx("strong",{children:m.displayName||m.email}),"?"]}),u.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"This will permanently delete the user's profile and data. Their authentication account will be disabled. This action cannot be undone."})]})]})};var g1,CN;function nH(){if(CN)return g1;CN=1;function r(){this.__data__=[],this.size=0}return g1=r,g1}var y1,RN;function vR(){if(RN)return y1;RN=1;function r(e,t){return e===t||e!==e&&t!==t}return y1=r,y1}var v1,jN;function u0(){if(jN)return v1;jN=1;var r=vR();function e(t,n){for(var i=t.length;i--;)if(r(t[i][0],n))return i;return-1}return v1=e,v1}var _1,ON;function rH(){if(ON)return _1;ON=1;var r=u0(),e=Array.prototype,t=e.splice;function n(i){var s=this.__data__,o=r(s,i);if(o<0)return!1;var l=s.length-1;return o==l?s.pop():t.call(s,o,1),--this.size,!0}return _1=n,_1}var x1,MN;function iH(){if(MN)return x1;MN=1;var r=u0();function e(t){var n=this.__data__,i=r(n,t);return i<0?void 0:n[i][1]}return x1=e,x1}var b1,DN;function sH(){if(DN)return b1;DN=1;var r=u0();function e(t){return r(this.__data__,t)>-1}return b1=e,b1}var w1,LN;function oH(){if(LN)return w1;LN=1;var r=u0();function e(t,n){var i=this.__data__,s=r(i,t);return s<0?(++this.size,i.push([t,n])):i[s][1]=n,this}return w1=e,w1}var E1,FN;function d0(){if(FN)return E1;FN=1;var r=nH(),e=rH(),t=iH(),n=sH(),i=oH();function s(o){var l=-1,d=o==null?0:o.length;for(this.clear();++l<d;){var f=o[l];this.set(f[0],f[1])}}return s.prototype.clear=r,s.prototype.delete=e,s.prototype.get=t,s.prototype.has=n,s.prototype.set=i,E1=s,E1}var S1,VN;function aH(){if(VN)return S1;VN=1;var r=d0();function e(){this.__data__=new r,this.size=0}return S1=e,S1}var T1,zN;function lH(){if(zN)return T1;zN=1;function r(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}return T1=r,T1}var A1,BN;function cH(){if(BN)return A1;BN=1;function r(e){return this.__data__.get(e)}return A1=r,A1}var N1,UN;function uH(){if(UN)return N1;UN=1;function r(e){return this.__data__.has(e)}return N1=r,N1}var I1,qN;function _R(){if(qN)return I1;qN=1;var r=typeof Np=="object"&&Np&&Np.Object===Object&&Np;return I1=r,I1}var k1,HN;function qa(){if(HN)return k1;HN=1;var r=_R(),e=typeof self=="object"&&self&&self.Object===Object&&self,t=r||e||Function("return this")();return k1=t,k1}var P1,$N;function X2(){if($N)return P1;$N=1;var r=qa(),e=r.Symbol;return P1=e,P1}var C1,WN;function dH(){if(WN)return C1;WN=1;var r=X2(),e=Object.prototype,t=e.hasOwnProperty,n=e.toString,i=r?r.toStringTag:void 0;function s(o){var l=t.call(o,i),d=o[i];try{o[i]=void 0;var f=!0}catch{}var m=n.call(o);return f&&(l?o[i]=d:delete o[i]),m}return C1=s,C1}var R1,GN;function hH(){if(GN)return R1;GN=1;var r=Object.prototype,e=r.toString;function t(n){return e.call(n)}return R1=t,R1}var j1,KN;function h0(){if(KN)return j1;KN=1;var r=X2(),e=dH(),t=hH(),n="[object Null]",i="[object Undefined]",s=r?r.toStringTag:void 0;function o(l){return l==null?l===void 0?i:n:s&&s in Object(l)?e(l):t(l)}return j1=o,j1}var O1,YN;function xR(){if(YN)return O1;YN=1;function r(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}return O1=r,O1}var M1,ZN;function bR(){if(ZN)return M1;ZN=1;var r=h0(),e=xR(),t="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",s="[object Proxy]";function o(l){if(!e(l))return!1;var d=r(l);return d==n||d==i||d==t||d==s}return M1=o,M1}var D1,QN;function fH(){if(QN)return D1;QN=1;var r=qa(),e=r["__core-js_shared__"];return D1=e,D1}var L1,XN;function mH(){if(XN)return L1;XN=1;var r=fH(),e=function(){var n=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function t(n){return!!e&&e in n}return L1=t,L1}var F1,JN;function wR(){if(JN)return F1;JN=1;var r=Function.prototype,e=r.toString;function t(n){if(n!=null){try{return e.call(n)}catch{}try{return n+""}catch{}}return""}return F1=t,F1}var V1,eI;function pH(){if(eI)return V1;eI=1;var r=bR(),e=mH(),t=xR(),n=wR(),i=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,o=Function.prototype,l=Object.prototype,d=o.toString,f=l.hasOwnProperty,m=RegExp("^"+d.call(f).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function y(g){if(!t(g)||e(g))return!1;var _=r(g)?m:s;return _.test(n(g))}return V1=y,V1}var z1,tI;function gH(){if(tI)return z1;tI=1;function r(e,t){return e==null?void 0:e[t]}return z1=r,z1}var B1,nI;function lh(){if(nI)return B1;nI=1;var r=pH(),e=gH();function t(n,i){var s=e(n,i);return r(s)?s:void 0}return B1=t,B1}var U1,rI;function J2(){if(rI)return U1;rI=1;var r=lh(),e=qa(),t=r(e,"Map");return U1=t,U1}var q1,iI;function f0(){if(iI)return q1;iI=1;var r=lh(),e=r(Object,"create");return q1=e,q1}var H1,sI;function yH(){if(sI)return H1;sI=1;var r=f0();function e(){this.__data__=r?r(null):{},this.size=0}return H1=e,H1}var $1,oI;function vH(){if(oI)return $1;oI=1;function r(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}return $1=r,$1}var W1,aI;function _H(){if(aI)return W1;aI=1;var r=f0(),e="__lodash_hash_undefined__",t=Object.prototype,n=t.hasOwnProperty;function i(s){var o=this.__data__;if(r){var l=o[s];return l===e?void 0:l}return n.call(o,s)?o[s]:void 0}return W1=i,W1}var G1,lI;function xH(){if(lI)return G1;lI=1;var r=f0(),e=Object.prototype,t=e.hasOwnProperty;function n(i){var s=this.__data__;return r?s[i]!==void 0:t.call(s,i)}return G1=n,G1}var K1,cI;function bH(){if(cI)return K1;cI=1;var r=f0(),e="__lodash_hash_undefined__";function t(n,i){var s=this.__data__;return this.size+=this.has(n)?0:1,s[n]=r&&i===void 0?e:i,this}return K1=t,K1}var Y1,uI;function wH(){if(uI)return Y1;uI=1;var r=yH(),e=vH(),t=_H(),n=xH(),i=bH();function s(o){var l=-1,d=o==null?0:o.length;for(this.clear();++l<d;){var f=o[l];this.set(f[0],f[1])}}return s.prototype.clear=r,s.prototype.delete=e,s.prototype.get=t,s.prototype.has=n,s.prototype.set=i,Y1=s,Y1}var Z1,dI;function EH(){if(dI)return Z1;dI=1;var r=wH(),e=d0(),t=J2();function n(){this.size=0,this.__data__={hash:new r,map:new(t||e),string:new r}}return Z1=n,Z1}var Q1,hI;function SH(){if(hI)return Q1;hI=1;function r(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}return Q1=r,Q1}var X1,fI;function m0(){if(fI)return X1;fI=1;var r=SH();function e(t,n){var i=t.__data__;return r(n)?i[typeof n=="string"?"string":"hash"]:i.map}return X1=e,X1}var J1,mI;function TH(){if(mI)return J1;mI=1;var r=m0();function e(t){var n=r(this,t).delete(t);return this.size-=n?1:0,n}return J1=e,J1}var e_,pI;function AH(){if(pI)return e_;pI=1;var r=m0();function e(t){return r(this,t).get(t)}return e_=e,e_}var t_,gI;function NH(){if(gI)return t_;gI=1;var r=m0();function e(t){return r(this,t).has(t)}return t_=e,t_}var n_,yI;function IH(){if(yI)return n_;yI=1;var r=m0();function e(t,n){var i=r(this,t),s=i.size;return i.set(t,n),this.size+=i.size==s?0:1,this}return n_=e,n_}var r_,vI;function ER(){if(vI)return r_;vI=1;var r=EH(),e=TH(),t=AH(),n=NH(),i=IH();function s(o){var l=-1,d=o==null?0:o.length;for(this.clear();++l<d;){var f=o[l];this.set(f[0],f[1])}}return s.prototype.clear=r,s.prototype.delete=e,s.prototype.get=t,s.prototype.has=n,s.prototype.set=i,r_=s,r_}var i_,_I;function kH(){if(_I)return i_;_I=1;var r=d0(),e=J2(),t=ER(),n=200;function i(s,o){var l=this.__data__;if(l instanceof r){var d=l.__data__;if(!e||d.length<n-1)return d.push([s,o]),this.size=++l.size,this;l=this.__data__=new t(d)}return l.set(s,o),this.size=l.size,this}return i_=i,i_}var s_,xI;function PH(){if(xI)return s_;xI=1;var r=d0(),e=aH(),t=lH(),n=cH(),i=uH(),s=kH();function o(l){var d=this.__data__=new r(l);this.size=d.size}return o.prototype.clear=e,o.prototype.delete=t,o.prototype.get=n,o.prototype.has=i,o.prototype.set=s,s_=o,s_}var o_,bI;function CH(){if(bI)return o_;bI=1;var r="__lodash_hash_undefined__";function e(t){return this.__data__.set(t,r),this}return o_=e,o_}var a_,wI;function RH(){if(wI)return a_;wI=1;function r(e){return this.__data__.has(e)}return a_=r,a_}var l_,EI;function jH(){if(EI)return l_;EI=1;var r=ER(),e=CH(),t=RH();function n(i){var s=-1,o=i==null?0:i.length;for(this.__data__=new r;++s<o;)this.add(i[s])}return n.prototype.add=n.prototype.push=e,n.prototype.has=t,l_=n,l_}var c_,SI;function OH(){if(SI)return c_;SI=1;function r(e,t){for(var n=-1,i=e==null?0:e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}return c_=r,c_}var u_,TI;function MH(){if(TI)return u_;TI=1;function r(e,t){return e.has(t)}return u_=r,u_}var d_,AI;function SR(){if(AI)return d_;AI=1;var r=jH(),e=OH(),t=MH(),n=1,i=2;function s(o,l,d,f,m,y){var g=d&n,_=o.length,E=l.length;if(_!=E&&!(g&&E>_))return!1;var x=y.get(o),b=y.get(l);if(x&&b)return x==l&&b==o;var T=-1,N=!0,R=d&i?new r:void 0;for(y.set(o,l),y.set(l,o);++T<_;){var I=o[T],j=l[T];if(f)var U=g?f(j,I,T,l,o,y):f(I,j,T,o,l,y);if(U!==void 0){if(U)continue;N=!1;break}if(R){if(!e(l,function(C,k){if(!t(R,k)&&(I===C||m(I,C,d,f,y)))return R.push(k)})){N=!1;break}}else if(!(I===j||m(I,j,d,f,y))){N=!1;break}}return y.delete(o),y.delete(l),N}return d_=s,d_}var h_,NI;function DH(){if(NI)return h_;NI=1;var r=qa(),e=r.Uint8Array;return h_=e,h_}var f_,II;function LH(){if(II)return f_;II=1;function r(e){var t=-1,n=Array(e.size);return e.forEach(function(i,s){n[++t]=[s,i]}),n}return f_=r,f_}var m_,kI;function FH(){if(kI)return m_;kI=1;function r(e){var t=-1,n=Array(e.size);return e.forEach(function(i){n[++t]=i}),n}return m_=r,m_}var p_,PI;function VH(){if(PI)return p_;PI=1;var r=X2(),e=DH(),t=vR(),n=SR(),i=LH(),s=FH(),o=1,l=2,d="[object Boolean]",f="[object Date]",m="[object Error]",y="[object Map]",g="[object Number]",_="[object RegExp]",E="[object Set]",x="[object String]",b="[object Symbol]",T="[object ArrayBuffer]",N="[object DataView]",R=r?r.prototype:void 0,I=R?R.valueOf:void 0;function j(U,C,k,D,O,P,F){switch(k){case N:if(U.byteLength!=C.byteLength||U.byteOffset!=C.byteOffset)return!1;U=U.buffer,C=C.buffer;case T:return!(U.byteLength!=C.byteLength||!P(new e(U),new e(C)));case d:case f:case g:return t(+U,+C);case m:return U.name==C.name&&U.message==C.message;case _:case x:return U==C+"";case y:var M=i;case E:var $=D&o;if(M||(M=s),U.size!=C.size&&!$)return!1;var Y=F.get(U);if(Y)return Y==C;D|=l,F.set(U,C);var te=n(M(U),M(C),D,O,P,F);return F.delete(U),te;case b:if(I)return I.call(U)==I.call(C)}return!1}return p_=j,p_}var g_,CI;function zH(){if(CI)return g_;CI=1;function r(e,t){for(var n=-1,i=t.length,s=e.length;++n<i;)e[s+n]=t[n];return e}return g_=r,g_}var y_,RI;function ew(){if(RI)return y_;RI=1;var r=Array.isArray;return y_=r,y_}var v_,jI;function BH(){if(jI)return v_;jI=1;var r=zH(),e=ew();function t(n,i,s){var o=i(n);return e(n)?o:r(o,s(n))}return v_=t,v_}var __,OI;function UH(){if(OI)return __;OI=1;function r(e,t){for(var n=-1,i=e==null?0:e.length,s=0,o=[];++n<i;){var l=e[n];t(l,n,e)&&(o[s++]=l)}return o}return __=r,__}var x_,MI;function qH(){if(MI)return x_;MI=1;function r(){return[]}return x_=r,x_}var b_,DI;function HH(){if(DI)return b_;DI=1;var r=UH(),e=qH(),t=Object.prototype,n=t.propertyIsEnumerable,i=Object.getOwnPropertySymbols,s=i?function(o){return o==null?[]:(o=Object(o),r(i(o),function(l){return n.call(o,l)}))}:e;return b_=s,b_}var w_,LI;function $H(){if(LI)return w_;LI=1;function r(e,t){for(var n=-1,i=Array(e);++n<e;)i[n]=t(n);return i}return w_=r,w_}var E_,FI;function p0(){if(FI)return E_;FI=1;function r(e){return e!=null&&typeof e=="object"}return E_=r,E_}var S_,VI;function WH(){if(VI)return S_;VI=1;var r=h0(),e=p0(),t="[object Arguments]";function n(i){return e(i)&&r(i)==t}return S_=n,S_}var T_,zI;function GH(){if(zI)return T_;zI=1;var r=WH(),e=p0(),t=Object.prototype,n=t.hasOwnProperty,i=t.propertyIsEnumerable,s=r(function(){return arguments}())?r:function(o){return e(o)&&n.call(o,"callee")&&!i.call(o,"callee")};return T_=s,T_}var vf={exports:{}},A_,BI;function KH(){if(BI)return A_;BI=1;function r(){return!1}return A_=r,A_}vf.exports;var UI;function TR(){return UI||(UI=1,function(r,e){var t=qa(),n=KH(),i=e&&!e.nodeType&&e,s=i&&!0&&r&&!r.nodeType&&r,o=s&&s.exports===i,l=o?t.Buffer:void 0,d=l?l.isBuffer:void 0,f=d||n;r.exports=f}(vf,vf.exports)),vf.exports}var N_,qI;function YH(){if(qI)return N_;qI=1;var r=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function t(n,i){var s=typeof n;return i=i??r,!!i&&(s=="number"||s!="symbol"&&e.test(n))&&n>-1&&n%1==0&&n<i}return N_=t,N_}var I_,HI;function AR(){if(HI)return I_;HI=1;var r=9007199254740991;function e(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=r}return I_=e,I_}var k_,$I;function ZH(){if($I)return k_;$I=1;var r=h0(),e=AR(),t=p0(),n="[object Arguments]",i="[object Array]",s="[object Boolean]",o="[object Date]",l="[object Error]",d="[object Function]",f="[object Map]",m="[object Number]",y="[object Object]",g="[object RegExp]",_="[object Set]",E="[object String]",x="[object WeakMap]",b="[object ArrayBuffer]",T="[object DataView]",N="[object Float32Array]",R="[object Float64Array]",I="[object Int8Array]",j="[object Int16Array]",U="[object Int32Array]",C="[object Uint8Array]",k="[object Uint8ClampedArray]",D="[object Uint16Array]",O="[object Uint32Array]",P={};P[N]=P[R]=P[I]=P[j]=P[U]=P[C]=P[k]=P[D]=P[O]=!0,P[n]=P[i]=P[b]=P[s]=P[T]=P[o]=P[l]=P[d]=P[f]=P[m]=P[y]=P[g]=P[_]=P[E]=P[x]=!1;function F(M){return t(M)&&e(M.length)&&!!P[r(M)]}return k_=F,k_}var P_,WI;function QH(){if(WI)return P_;WI=1;function r(e){return function(t){return e(t)}}return P_=r,P_}var _f={exports:{}};_f.exports;var GI;function XH(){return GI||(GI=1,function(r,e){var t=_R(),n=e&&!e.nodeType&&e,i=n&&!0&&r&&!r.nodeType&&r,s=i&&i.exports===n,o=s&&t.process,l=function(){try{var d=i&&i.require&&i.require("util").types;return d||o&&o.binding&&o.binding("util")}catch{}}();r.exports=l}(_f,_f.exports)),_f.exports}var C_,KI;function NR(){if(KI)return C_;KI=1;var r=ZH(),e=QH(),t=XH(),n=t&&t.isTypedArray,i=n?e(n):r;return C_=i,C_}var R_,YI;function JH(){if(YI)return R_;YI=1;var r=$H(),e=GH(),t=ew(),n=TR(),i=YH(),s=NR(),o=Object.prototype,l=o.hasOwnProperty;function d(f,m){var y=t(f),g=!y&&e(f),_=!y&&!g&&n(f),E=!y&&!g&&!_&&s(f),x=y||g||_||E,b=x?r(f.length,String):[],T=b.length;for(var N in f)(m||l.call(f,N))&&!(x&&(N=="length"||_&&(N=="offset"||N=="parent")||E&&(N=="buffer"||N=="byteLength"||N=="byteOffset")||i(N,T)))&&b.push(N);return b}return R_=d,R_}var j_,ZI;function e$(){if(ZI)return j_;ZI=1;var r=Object.prototype;function e(t){var n=t&&t.constructor,i=typeof n=="function"&&n.prototype||r;return t===i}return j_=e,j_}var O_,QI;function t$(){if(QI)return O_;QI=1;function r(e,t){return function(n){return e(t(n))}}return O_=r,O_}var M_,XI;function n$(){if(XI)return M_;XI=1;var r=t$(),e=r(Object.keys,Object);return M_=e,M_}var D_,JI;function r$(){if(JI)return D_;JI=1;var r=e$(),e=n$(),t=Object.prototype,n=t.hasOwnProperty;function i(s){if(!r(s))return e(s);var o=[];for(var l in Object(s))n.call(s,l)&&l!="constructor"&&o.push(l);return o}return D_=i,D_}var L_,e4;function i$(){if(e4)return L_;e4=1;var r=bR(),e=AR();function t(n){return n!=null&&e(n.length)&&!r(n)}return L_=t,L_}var F_,t4;function s$(){if(t4)return F_;t4=1;var r=JH(),e=r$(),t=i$();function n(i){return t(i)?r(i):e(i)}return F_=n,F_}var V_,n4;function o$(){if(n4)return V_;n4=1;var r=BH(),e=HH(),t=s$();function n(i){return r(i,t,e)}return V_=n,V_}var z_,r4;function a$(){if(r4)return z_;r4=1;var r=o$(),e=1,t=Object.prototype,n=t.hasOwnProperty;function i(s,o,l,d,f,m){var y=l&e,g=r(s),_=g.length,E=r(o),x=E.length;if(_!=x&&!y)return!1;for(var b=_;b--;){var T=g[b];if(!(y?T in o:n.call(o,T)))return!1}var N=m.get(s),R=m.get(o);if(N&&R)return N==o&&R==s;var I=!0;m.set(s,o),m.set(o,s);for(var j=y;++b<_;){T=g[b];var U=s[T],C=o[T];if(d)var k=y?d(C,U,T,o,s,m):d(U,C,T,s,o,m);if(!(k===void 0?U===C||f(U,C,l,d,m):k)){I=!1;break}j||(j=T=="constructor")}if(I&&!j){var D=s.constructor,O=o.constructor;D!=O&&"constructor"in s&&"constructor"in o&&!(typeof D=="function"&&D instanceof D&&typeof O=="function"&&O instanceof O)&&(I=!1)}return m.delete(s),m.delete(o),I}return z_=i,z_}var B_,i4;function l$(){if(i4)return B_;i4=1;var r=lh(),e=qa(),t=r(e,"DataView");return B_=t,B_}var U_,s4;function c$(){if(s4)return U_;s4=1;var r=lh(),e=qa(),t=r(e,"Promise");return U_=t,U_}var q_,o4;function u$(){if(o4)return q_;o4=1;var r=lh(),e=qa(),t=r(e,"Set");return q_=t,q_}var H_,a4;function d$(){if(a4)return H_;a4=1;var r=lh(),e=qa(),t=r(e,"WeakMap");return H_=t,H_}var $_,l4;function h$(){if(l4)return $_;l4=1;var r=l$(),e=J2(),t=c$(),n=u$(),i=d$(),s=h0(),o=wR(),l="[object Map]",d="[object Object]",f="[object Promise]",m="[object Set]",y="[object WeakMap]",g="[object DataView]",_=o(r),E=o(e),x=o(t),b=o(n),T=o(i),N=s;return(r&&N(new r(new ArrayBuffer(1)))!=g||e&&N(new e)!=l||t&&N(t.resolve())!=f||n&&N(new n)!=m||i&&N(new i)!=y)&&(N=function(R){var I=s(R),j=I==d?R.constructor:void 0,U=j?o(j):"";if(U)switch(U){case _:return g;case E:return l;case x:return f;case b:return m;case T:return y}return I}),$_=N,$_}var W_,c4;function f$(){if(c4)return W_;c4=1;var r=PH(),e=SR(),t=VH(),n=a$(),i=h$(),s=ew(),o=TR(),l=NR(),d=1,f="[object Arguments]",m="[object Array]",y="[object Object]",g=Object.prototype,_=g.hasOwnProperty;function E(x,b,T,N,R,I){var j=s(x),U=s(b),C=j?m:i(x),k=U?m:i(b);C=C==f?y:C,k=k==f?y:k;var D=C==y,O=k==y,P=C==k;if(P&&o(x)){if(!o(b))return!1;j=!0,D=!1}if(P&&!D)return I||(I=new r),j||l(x)?e(x,b,T,N,R,I):t(x,b,C,T,N,R,I);if(!(T&d)){var F=D&&_.call(x,"__wrapped__"),M=O&&_.call(b,"__wrapped__");if(F||M){var $=F?x.value():x,Y=M?b.value():b;return I||(I=new r),R($,Y,T,N,I)}}return P?(I||(I=new r),n(x,b,T,N,R,I)):!1}return W_=E,W_}var G_,u4;function m$(){if(u4)return G_;u4=1;var r=f$(),e=p0();function t(n,i,s,o,l){return n===i?!0:n==null||i==null||!e(n)&&!e(i)?n!==n&&i!==i:r(n,i,s,o,t,l)}return G_=t,G_}var K_,d4;function p$(){if(d4)return K_;d4=1;var r=m$();function e(t,n){return r(t,n)}return K_=e,K_}var Ag={exports:{}};/*!
 * Quill Editor v1.3.7
 * https://quilljs.com/
 * Copyright (c) 2014, Jason Chen
 * Copyright (c) 2013, salesforce.com
 */var g$=Ag.exports,h4;function y$(){return h4||(h4=1,function(r,e){(function(n,i){r.exports=i()})(typeof self<"u"?self:g$,function(){return function(t){var n={};function i(s){if(n[s])return n[s].exports;var o=n[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}return i.m=t,i.c=n,i.d=function(s,o,l){i.o(s,o)||Object.defineProperty(s,o,{configurable:!1,enumerable:!0,get:l})},i.n=function(s){var o=s&&s.__esModule?function(){return s.default}:function(){return s};return i.d(o,"a",o),o},i.o=function(s,o){return Object.prototype.hasOwnProperty.call(s,o)},i.p="",i(i.s=109)}([function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(17),o=i(18),l=i(19),d=i(45),f=i(46),m=i(47),y=i(48),g=i(49),_=i(12),E=i(32),x=i(33),b=i(31),T=i(1),N={Scope:T.Scope,create:T.create,find:T.find,query:T.query,register:T.register,Container:s.default,Format:o.default,Leaf:l.default,Embed:y.default,Scroll:d.default,Block:m.default,Inline:f.default,Text:g.default,Attributor:{Attribute:_.default,Class:E.default,Style:x.default,Store:b.default}};n.default=N},function(t,n,i){var s=this&&this.__extends||function(){var b=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(T,N){T.__proto__=N}||function(T,N){for(var R in N)N.hasOwnProperty(R)&&(T[R]=N[R])};return function(T,N){b(T,N);function R(){this.constructor=T}T.prototype=N===null?Object.create(N):(R.prototype=N.prototype,new R)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=function(b){s(T,b);function T(N){var R=this;return N="[Parchment] "+N,R=b.call(this,N)||this,R.message=N,R.name=R.constructor.name,R}return T}(Error);n.ParchmentError=o;var l={},d={},f={},m={};n.DATA_KEY="__blot";var y;(function(b){b[b.TYPE=3]="TYPE",b[b.LEVEL=12]="LEVEL",b[b.ATTRIBUTE=13]="ATTRIBUTE",b[b.BLOT=14]="BLOT",b[b.INLINE=7]="INLINE",b[b.BLOCK=11]="BLOCK",b[b.BLOCK_BLOT=10]="BLOCK_BLOT",b[b.INLINE_BLOT=6]="INLINE_BLOT",b[b.BLOCK_ATTRIBUTE=9]="BLOCK_ATTRIBUTE",b[b.INLINE_ATTRIBUTE=5]="INLINE_ATTRIBUTE",b[b.ANY=15]="ANY"})(y=n.Scope||(n.Scope={}));function g(b,T){var N=E(b);if(N==null)throw new o("Unable to create "+b+" blot");var R=N,I=b instanceof Node||b.nodeType===Node.TEXT_NODE?b:R.create(T);return new R(I,T)}n.create=g;function _(b,T){return T===void 0&&(T=!1),b==null?null:b[n.DATA_KEY]!=null?b[n.DATA_KEY].blot:T?_(b.parentNode,T):null}n.find=_;function E(b,T){T===void 0&&(T=y.ANY);var N;if(typeof b=="string")N=m[b]||l[b];else if(b instanceof Text||b.nodeType===Node.TEXT_NODE)N=m.text;else if(typeof b=="number")b&y.LEVEL&y.BLOCK?N=m.block:b&y.LEVEL&y.INLINE&&(N=m.inline);else if(b instanceof HTMLElement){var R=(b.getAttribute("class")||"").split(/\s+/);for(var I in R)if(N=d[R[I]],N)break;N=N||f[b.tagName]}return N==null?null:T&y.LEVEL&N.scope&&T&y.TYPE&N.scope?N:null}n.query=E;function x(){for(var b=[],T=0;T<arguments.length;T++)b[T]=arguments[T];if(b.length>1)return b.map(function(I){return x(I)});var N=b[0];if(typeof N.blotName!="string"&&typeof N.attrName!="string")throw new o("Invalid definition");if(N.blotName==="abstract")throw new o("Cannot register abstract class");if(m[N.blotName||N.attrName]=N,typeof N.keyName=="string")l[N.keyName]=N;else if(N.className!=null&&(d[N.className]=N),N.tagName!=null){Array.isArray(N.tagName)?N.tagName=N.tagName.map(function(I){return I.toUpperCase()}):N.tagName=N.tagName.toUpperCase();var R=Array.isArray(N.tagName)?N.tagName:[N.tagName];R.forEach(function(I){(f[I]==null||N.className==null)&&(f[I]=N)})}return N}n.register=x},function(t,n,i){var s=i(51),o=i(11),l=i(3),d=i(20),f="\0",m=function(y){Array.isArray(y)?this.ops=y:y!=null&&Array.isArray(y.ops)?this.ops=y.ops:this.ops=[]};m.prototype.insert=function(y,g){var _={};return y.length===0?this:(_.insert=y,g!=null&&typeof g=="object"&&Object.keys(g).length>0&&(_.attributes=g),this.push(_))},m.prototype.delete=function(y){return y<=0?this:this.push({delete:y})},m.prototype.retain=function(y,g){if(y<=0)return this;var _={retain:y};return g!=null&&typeof g=="object"&&Object.keys(g).length>0&&(_.attributes=g),this.push(_)},m.prototype.push=function(y){var g=this.ops.length,_=this.ops[g-1];if(y=l(!0,{},y),typeof _=="object"){if(typeof y.delete=="number"&&typeof _.delete=="number")return this.ops[g-1]={delete:_.delete+y.delete},this;if(typeof _.delete=="number"&&y.insert!=null&&(g-=1,_=this.ops[g-1],typeof _!="object"))return this.ops.unshift(y),this;if(o(y.attributes,_.attributes)){if(typeof y.insert=="string"&&typeof _.insert=="string")return this.ops[g-1]={insert:_.insert+y.insert},typeof y.attributes=="object"&&(this.ops[g-1].attributes=y.attributes),this;if(typeof y.retain=="number"&&typeof _.retain=="number")return this.ops[g-1]={retain:_.retain+y.retain},typeof y.attributes=="object"&&(this.ops[g-1].attributes=y.attributes),this}}return g===this.ops.length?this.ops.push(y):this.ops.splice(g,0,y),this},m.prototype.chop=function(){var y=this.ops[this.ops.length-1];return y&&y.retain&&!y.attributes&&this.ops.pop(),this},m.prototype.filter=function(y){return this.ops.filter(y)},m.prototype.forEach=function(y){this.ops.forEach(y)},m.prototype.map=function(y){return this.ops.map(y)},m.prototype.partition=function(y){var g=[],_=[];return this.forEach(function(E){var x=y(E)?g:_;x.push(E)}),[g,_]},m.prototype.reduce=function(y,g){return this.ops.reduce(y,g)},m.prototype.changeLength=function(){return this.reduce(function(y,g){return g.insert?y+d.length(g):g.delete?y-g.delete:y},0)},m.prototype.length=function(){return this.reduce(function(y,g){return y+d.length(g)},0)},m.prototype.slice=function(y,g){y=y||0,typeof g!="number"&&(g=1/0);for(var _=[],E=d.iterator(this.ops),x=0;x<g&&E.hasNext();){var b;x<y?b=E.next(y-x):(b=E.next(g-x),_.push(b)),x+=d.length(b)}return new m(_)},m.prototype.compose=function(y){var g=d.iterator(this.ops),_=d.iterator(y.ops),E=[],x=_.peek();if(x!=null&&typeof x.retain=="number"&&x.attributes==null){for(var b=x.retain;g.peekType()==="insert"&&g.peekLength()<=b;)b-=g.peekLength(),E.push(g.next());x.retain-b>0&&_.next(x.retain-b)}for(var T=new m(E);g.hasNext()||_.hasNext();)if(_.peekType()==="insert")T.push(_.next());else if(g.peekType()==="delete")T.push(g.next());else{var N=Math.min(g.peekLength(),_.peekLength()),R=g.next(N),I=_.next(N);if(typeof I.retain=="number"){var j={};typeof R.retain=="number"?j.retain=N:j.insert=R.insert;var U=d.attributes.compose(R.attributes,I.attributes,typeof R.retain=="number");if(U&&(j.attributes=U),T.push(j),!_.hasNext()&&o(T.ops[T.ops.length-1],j)){var C=new m(g.rest());return T.concat(C).chop()}}else typeof I.delete=="number"&&typeof R.retain=="number"&&T.push(I)}return T.chop()},m.prototype.concat=function(y){var g=new m(this.ops.slice());return y.ops.length>0&&(g.push(y.ops[0]),g.ops=g.ops.concat(y.ops.slice(1))),g},m.prototype.diff=function(y,g){if(this.ops===y.ops)return new m;var _=[this,y].map(function(N){return N.map(function(R){if(R.insert!=null)return typeof R.insert=="string"?R.insert:f;var I=N===y?"on":"with";throw new Error("diff() called "+I+" non-document")}).join("")}),E=new m,x=s(_[0],_[1],g),b=d.iterator(this.ops),T=d.iterator(y.ops);return x.forEach(function(N){for(var R=N[1].length;R>0;){var I=0;switch(N[0]){case s.INSERT:I=Math.min(T.peekLength(),R),E.push(T.next(I));break;case s.DELETE:I=Math.min(R,b.peekLength()),b.next(I),E.delete(I);break;case s.EQUAL:I=Math.min(b.peekLength(),T.peekLength(),R);var j=b.next(I),U=T.next(I);o(j.insert,U.insert)?E.retain(I,d.attributes.diff(j.attributes,U.attributes)):E.push(U).delete(I);break}R-=I}}),E.chop()},m.prototype.eachLine=function(y,g){g=g||`
`;for(var _=d.iterator(this.ops),E=new m,x=0;_.hasNext();){if(_.peekType()!=="insert")return;var b=_.peek(),T=d.length(b)-_.peekLength(),N=typeof b.insert=="string"?b.insert.indexOf(g,T)-T:-1;if(N<0)E.push(_.next());else if(N>0)E.push(_.next(N));else{if(y(E,_.next(1).attributes||{},x)===!1)return;x+=1,E=new m}}E.length()>0&&y(E,{},x)},m.prototype.transform=function(y,g){if(g=!!g,typeof y=="number")return this.transformPosition(y,g);for(var _=d.iterator(this.ops),E=d.iterator(y.ops),x=new m;_.hasNext()||E.hasNext();)if(_.peekType()==="insert"&&(g||E.peekType()!=="insert"))x.retain(d.length(_.next()));else if(E.peekType()==="insert")x.push(E.next());else{var b=Math.min(_.peekLength(),E.peekLength()),T=_.next(b),N=E.next(b);if(T.delete)continue;N.delete?x.push(N):x.retain(b,d.attributes.transform(T.attributes,N.attributes,g))}return x.chop()},m.prototype.transformPosition=function(y,g){g=!!g;for(var _=d.iterator(this.ops),E=0;_.hasNext()&&E<=y;){var x=_.peekLength(),b=_.peekType();if(_.next(),b==="delete"){y-=Math.min(x,y-E);continue}else b==="insert"&&(E<y||!g)&&(y+=x);E+=x}return y},t.exports=m},function(t,n){var i=Object.prototype.hasOwnProperty,s=Object.prototype.toString,o=Object.defineProperty,l=Object.getOwnPropertyDescriptor,d=function(_){return typeof Array.isArray=="function"?Array.isArray(_):s.call(_)==="[object Array]"},f=function(_){if(!_||s.call(_)!=="[object Object]")return!1;var E=i.call(_,"constructor"),x=_.constructor&&_.constructor.prototype&&i.call(_.constructor.prototype,"isPrototypeOf");if(_.constructor&&!E&&!x)return!1;var b;for(b in _);return typeof b>"u"||i.call(_,b)},m=function(_,E){o&&E.name==="__proto__"?o(_,E.name,{enumerable:!0,configurable:!0,value:E.newValue,writable:!0}):_[E.name]=E.newValue},y=function(_,E){if(E==="__proto__")if(i.call(_,E)){if(l)return l(_,E).value}else return;return _[E]};t.exports=function g(){var _,E,x,b,T,N,R=arguments[0],I=1,j=arguments.length,U=!1;for(typeof R=="boolean"&&(U=R,R=arguments[1]||{},I=2),(R==null||typeof R!="object"&&typeof R!="function")&&(R={});I<j;++I)if(_=arguments[I],_!=null)for(E in _)x=y(R,E),b=y(_,E),R!==b&&(U&&b&&(f(b)||(T=d(b)))?(T?(T=!1,N=x&&d(x)?x:[]):N=x&&f(x)?x:{},m(R,{name:E,newValue:g(U,N,b)})):typeof b<"u"&&m(R,{name:E,newValue:b}));return R}},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BlockEmbed=n.bubbleFormats=void 0;var s=function(){function P(F,M){for(var $=0;$<M.length;$++){var Y=M[$];Y.enumerable=Y.enumerable||!1,Y.configurable=!0,"value"in Y&&(Y.writable=!0),Object.defineProperty(F,Y.key,Y)}}return function(F,M,$){return M&&P(F.prototype,M),$&&P(F,$),F}}(),o=function P(F,M,$){F===null&&(F=Function.prototype);var Y=Object.getOwnPropertyDescriptor(F,M);if(Y===void 0){var te=Object.getPrototypeOf(F);return te===null?void 0:P(te,M,$)}else{if("value"in Y)return Y.value;var oe=Y.get;return oe===void 0?void 0:oe.call($)}},l=i(3),d=R(l),f=i(2),m=R(f),y=i(0),g=R(y),_=i(16),E=R(_),x=i(6),b=R(x),T=i(7),N=R(T);function R(P){return P&&P.__esModule?P:{default:P}}function I(P,F){if(!(P instanceof F))throw new TypeError("Cannot call a class as a function")}function j(P,F){if(!P)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F&&(typeof F=="object"||typeof F=="function")?F:P}function U(P,F){if(typeof F!="function"&&F!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof F);P.prototype=Object.create(F&&F.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),F&&(Object.setPrototypeOf?Object.setPrototypeOf(P,F):P.__proto__=F)}var C=1,k=function(P){U(F,P);function F(){return I(this,F),j(this,(F.__proto__||Object.getPrototypeOf(F)).apply(this,arguments))}return s(F,[{key:"attach",value:function(){o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"attach",this).call(this),this.attributes=new g.default.Attributor.Store(this.domNode)}},{key:"delta",value:function(){return new m.default().insert(this.value(),(0,d.default)(this.formats(),this.attributes.values()))}},{key:"format",value:function($,Y){var te=g.default.query($,g.default.Scope.BLOCK_ATTRIBUTE);te!=null&&this.attributes.attribute(te,Y)}},{key:"formatAt",value:function($,Y,te,oe){this.format(te,oe)}},{key:"insertAt",value:function($,Y,te){if(typeof Y=="string"&&Y.endsWith(`
`)){var oe=g.default.create(D.blotName);this.parent.insertBefore(oe,$===0?this:this.next),oe.insertAt(0,Y.slice(0,-1))}else o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"insertAt",this).call(this,$,Y,te)}}]),F}(g.default.Embed);k.scope=g.default.Scope.BLOCK_BLOT;var D=function(P){U(F,P);function F(M){I(this,F);var $=j(this,(F.__proto__||Object.getPrototypeOf(F)).call(this,M));return $.cache={},$}return s(F,[{key:"delta",value:function(){return this.cache.delta==null&&(this.cache.delta=this.descendants(g.default.Leaf).reduce(function($,Y){return Y.length()===0?$:$.insert(Y.value(),O(Y))},new m.default).insert(`
`,O(this))),this.cache.delta}},{key:"deleteAt",value:function($,Y){o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"deleteAt",this).call(this,$,Y),this.cache={}}},{key:"formatAt",value:function($,Y,te,oe){Y<=0||(g.default.query(te,g.default.Scope.BLOCK)?$+Y===this.length()&&this.format(te,oe):o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"formatAt",this).call(this,$,Math.min(Y,this.length()-$-1),te,oe),this.cache={})}},{key:"insertAt",value:function($,Y,te){if(te!=null)return o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"insertAt",this).call(this,$,Y,te);if(Y.length!==0){var oe=Y.split(`
`),ie=oe.shift();ie.length>0&&($<this.length()-1||this.children.tail==null?o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"insertAt",this).call(this,Math.min($,this.length()-1),ie):this.children.tail.insertAt(this.children.tail.length(),ie),this.cache={});var ne=this;oe.reduce(function(K,B){return ne=ne.split(K,!0),ne.insertAt(0,B),B.length},$+ie.length)}}},{key:"insertBefore",value:function($,Y){var te=this.children.head;o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"insertBefore",this).call(this,$,Y),te instanceof E.default&&te.remove(),this.cache={}}},{key:"length",value:function(){return this.cache.length==null&&(this.cache.length=o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"length",this).call(this)+C),this.cache.length}},{key:"moveChildren",value:function($,Y){o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"moveChildren",this).call(this,$,Y),this.cache={}}},{key:"optimize",value:function($){o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"optimize",this).call(this,$),this.cache={}}},{key:"path",value:function($){return o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"path",this).call(this,$,!0)}},{key:"removeChild",value:function($){o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"removeChild",this).call(this,$),this.cache={}}},{key:"split",value:function($){var Y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(Y&&($===0||$>=this.length()-C)){var te=this.clone();return $===0?(this.parent.insertBefore(te,this),this):(this.parent.insertBefore(te,this.next),te)}else{var oe=o(F.prototype.__proto__||Object.getPrototypeOf(F.prototype),"split",this).call(this,$,Y);return this.cache={},oe}}}]),F}(g.default.Block);D.blotName="block",D.tagName="P",D.defaultChild="break",D.allowedChildren=[b.default,g.default.Embed,N.default];function O(P){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return P==null||(typeof P.formats=="function"&&(F=(0,d.default)(F,P.formats())),P.parent==null||P.parent.blotName=="scroll"||P.parent.statics.scope!==P.statics.scope)?F:O(P.parent,F)}n.bubbleFormats=O,n.BlockEmbed=k,n.default=D},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.overload=n.expandConfig=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ne){return typeof ne}:function(ne){return ne&&typeof Symbol=="function"&&ne.constructor===Symbol&&ne!==Symbol.prototype?"symbol":typeof ne},o=function(){function ne(K,B){var G=[],X=!0,se=!1,le=void 0;try{for(var Q=K[Symbol.iterator](),ce;!(X=(ce=Q.next()).done)&&(G.push(ce.value),!(B&&G.length===B));X=!0);}catch(ue){se=!0,le=ue}finally{try{!X&&Q.return&&Q.return()}finally{if(se)throw le}}return G}return function(K,B){if(Array.isArray(K))return K;if(Symbol.iterator in Object(K))return ne(K,B);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function ne(K,B){for(var G=0;G<B.length;G++){var X=B[G];X.enumerable=X.enumerable||!1,X.configurable=!0,"value"in X&&(X.writable=!0),Object.defineProperty(K,X.key,X)}}return function(K,B,G){return B&&ne(K.prototype,B),G&&ne(K,G),K}}();i(50);var d=i(2),f=O(d),m=i(14),y=O(m),g=i(8),_=O(g),E=i(9),x=O(E),b=i(0),T=O(b),N=i(15),R=O(N),I=i(3),j=O(I),U=i(10),C=O(U),k=i(34),D=O(k);function O(ne){return ne&&ne.__esModule?ne:{default:ne}}function P(ne,K,B){return K in ne?Object.defineProperty(ne,K,{value:B,enumerable:!0,configurable:!0,writable:!0}):ne[K]=B,ne}function F(ne,K){if(!(ne instanceof K))throw new TypeError("Cannot call a class as a function")}var M=(0,C.default)("quill"),$=function(){l(ne,null,[{key:"debug",value:function(B){B===!0&&(B="log"),C.default.level(B)}},{key:"find",value:function(B){return B.__quill||T.default.find(B)}},{key:"import",value:function(B){return this.imports[B]==null&&M.error("Cannot import "+B+". Are you sure it was registered?"),this.imports[B]}},{key:"register",value:function(B,G){var X=this,se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(typeof B!="string"){var le=B.attrName||B.blotName;typeof le=="string"?this.register("formats/"+le,B,G):Object.keys(B).forEach(function(Q){X.register(Q,B[Q],G)})}else this.imports[B]!=null&&!se&&M.warn("Overwriting "+B+" with",G),this.imports[B]=G,(B.startsWith("blots/")||B.startsWith("formats/"))&&G.blotName!=="abstract"?T.default.register(G):B.startsWith("modules")&&typeof G.register=="function"&&G.register()}}]);function ne(K){var B=this,G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(F(this,ne),this.options=Y(K,G),this.container=this.options.container,this.container==null)return M.error("Invalid Quill container",K);this.options.debug&&ne.debug(this.options.debug);var X=this.container.innerHTML.trim();this.container.classList.add("ql-container"),this.container.innerHTML="",this.container.__quill=this,this.root=this.addContainer("ql-editor"),this.root.classList.add("ql-blank"),this.root.setAttribute("data-gramm",!1),this.scrollingContainer=this.options.scrollingContainer||this.root,this.emitter=new _.default,this.scroll=T.default.create(this.root,{emitter:this.emitter,whitelist:this.options.formats}),this.editor=new y.default(this.scroll),this.selection=new R.default(this.scroll,this.emitter),this.theme=new this.options.theme(this,this.options),this.keyboard=this.theme.addModule("keyboard"),this.clipboard=this.theme.addModule("clipboard"),this.history=this.theme.addModule("history"),this.theme.init(),this.emitter.on(_.default.events.EDITOR_CHANGE,function(le){le===_.default.events.TEXT_CHANGE&&B.root.classList.toggle("ql-blank",B.editor.isBlank())}),this.emitter.on(_.default.events.SCROLL_UPDATE,function(le,Q){var ce=B.selection.lastRange,ue=ce&&ce.length===0?ce.index:void 0;te.call(B,function(){return B.editor.update(null,Q,ue)},le)});var se=this.clipboard.convert(`<div class='ql-editor' style="white-space: normal;">`+X+"<p><br></p></div>");this.setContents(se),this.history.clear(),this.options.placeholder&&this.root.setAttribute("data-placeholder",this.options.placeholder),this.options.readOnly&&this.disable()}return l(ne,[{key:"addContainer",value:function(B){var G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(typeof B=="string"){var X=B;B=document.createElement("div"),B.classList.add(X)}return this.container.insertBefore(B,G),B}},{key:"blur",value:function(){this.selection.setRange(null)}},{key:"deleteText",value:function(B,G,X){var se=this,le=oe(B,G,X),Q=o(le,4);return B=Q[0],G=Q[1],X=Q[3],te.call(this,function(){return se.editor.deleteText(B,G)},X,B,-1*G)}},{key:"disable",value:function(){this.enable(!1)}},{key:"enable",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.scroll.enable(B),this.container.classList.toggle("ql-disabled",!B)}},{key:"focus",value:function(){var B=this.scrollingContainer.scrollTop;this.selection.focus(),this.scrollingContainer.scrollTop=B,this.scrollIntoView()}},{key:"format",value:function(B,G){var X=this,se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:_.default.sources.API;return te.call(this,function(){var le=X.getSelection(!0),Q=new f.default;if(le==null)return Q;if(T.default.query(B,T.default.Scope.BLOCK))Q=X.editor.formatLine(le.index,le.length,P({},B,G));else{if(le.length===0)return X.selection.format(B,G),Q;Q=X.editor.formatText(le.index,le.length,P({},B,G))}return X.setSelection(le,_.default.sources.SILENT),Q},se)}},{key:"formatLine",value:function(B,G,X,se,le){var Q=this,ce=void 0,ue=oe(B,G,X,se,le),fe=o(ue,4);return B=fe[0],G=fe[1],ce=fe[2],le=fe[3],te.call(this,function(){return Q.editor.formatLine(B,G,ce)},le,B,0)}},{key:"formatText",value:function(B,G,X,se,le){var Q=this,ce=void 0,ue=oe(B,G,X,se,le),fe=o(ue,4);return B=fe[0],G=fe[1],ce=fe[2],le=fe[3],te.call(this,function(){return Q.editor.formatText(B,G,ce)},le,B,0)}},{key:"getBounds",value:function(B){var G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,X=void 0;typeof B=="number"?X=this.selection.getBounds(B,G):X=this.selection.getBounds(B.index,B.length);var se=this.container.getBoundingClientRect();return{bottom:X.bottom-se.top,height:X.height,left:X.left-se.left,right:X.right-se.left,top:X.top-se.top,width:X.width}}},{key:"getContents",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-B,X=oe(B,G),se=o(X,2);return B=se[0],G=se[1],this.editor.getContents(B,G)}},{key:"getFormat",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getSelection(!0),G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return typeof B=="number"?this.editor.getFormat(B,G):this.editor.getFormat(B.index,B.length)}},{key:"getIndex",value:function(B){return B.offset(this.scroll)}},{key:"getLength",value:function(){return this.scroll.length()}},{key:"getLeaf",value:function(B){return this.scroll.leaf(B)}},{key:"getLine",value:function(B){return this.scroll.line(B)}},{key:"getLines",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE;return typeof B!="number"?this.scroll.lines(B.index,B.length):this.scroll.lines(B,G)}},{key:"getModule",value:function(B){return this.theme.modules[B]}},{key:"getSelection",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return B&&this.focus(),this.update(),this.selection.getRange()[0]}},{key:"getText",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLength()-B,X=oe(B,G),se=o(X,2);return B=se[0],G=se[1],this.editor.getText(B,G)}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"insertEmbed",value:function(B,G,X){var se=this,le=arguments.length>3&&arguments[3]!==void 0?arguments[3]:ne.sources.API;return te.call(this,function(){return se.editor.insertEmbed(B,G,X)},le,B)}},{key:"insertText",value:function(B,G,X,se,le){var Q=this,ce=void 0,ue=oe(B,0,X,se,le),fe=o(ue,4);return B=fe[0],ce=fe[2],le=fe[3],te.call(this,function(){return Q.editor.insertText(B,G,ce)},le,B,G.length)}},{key:"isEnabled",value:function(){return!this.container.classList.contains("ql-disabled")}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments)}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments)}},{key:"once",value:function(){return this.emitter.once.apply(this.emitter,arguments)}},{key:"pasteHTML",value:function(B,G,X){this.clipboard.dangerouslyPasteHTML(B,G,X)}},{key:"removeFormat",value:function(B,G,X){var se=this,le=oe(B,G,X),Q=o(le,4);return B=Q[0],G=Q[1],X=Q[3],te.call(this,function(){return se.editor.removeFormat(B,G)},X,B)}},{key:"scrollIntoView",value:function(){this.selection.scrollIntoView(this.scrollingContainer)}},{key:"setContents",value:function(B){var G=this,X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.default.sources.API;return te.call(this,function(){B=new f.default(B);var se=G.getLength(),le=G.editor.deleteText(0,se),Q=G.editor.applyDelta(B),ce=Q.ops[Q.ops.length-1];ce!=null&&typeof ce.insert=="string"&&ce.insert[ce.insert.length-1]===`
`&&(G.editor.deleteText(G.getLength()-1,1),Q.delete(1));var ue=le.compose(Q);return ue},X)}},{key:"setSelection",value:function(B,G,X){if(B==null)this.selection.setRange(null,G||ne.sources.API);else{var se=oe(B,G,X),le=o(se,4);B=le[0],G=le[1],X=le[3],this.selection.setRange(new N.Range(B,G),X),X!==_.default.sources.SILENT&&this.selection.scrollIntoView(this.scrollingContainer)}}},{key:"setText",value:function(B){var G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.default.sources.API,X=new f.default().insert(B);return this.setContents(X,G)}},{key:"update",value:function(){var B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:_.default.sources.USER,G=this.scroll.update(B);return this.selection.update(B),G}},{key:"updateContents",value:function(B){var G=this,X=arguments.length>1&&arguments[1]!==void 0?arguments[1]:_.default.sources.API;return te.call(this,function(){return B=new f.default(B),G.editor.applyDelta(B,X)},X,!0)}}]),ne}();$.DEFAULTS={bounds:null,formats:null,modules:{},placeholder:"",readOnly:!1,scrollingContainer:null,strict:!0,theme:"default"},$.events=_.default.events,$.sources=_.default.sources,$.version="1.3.7",$.imports={delta:f.default,parchment:T.default,"core/module":x.default,"core/theme":D.default};function Y(ne,K){if(K=(0,j.default)(!0,{container:ne,modules:{clipboard:!0,keyboard:!0,history:!0}},K),!K.theme||K.theme===$.DEFAULTS.theme)K.theme=D.default;else if(K.theme=$.import("themes/"+K.theme),K.theme==null)throw new Error("Invalid theme "+K.theme+". Did you register it?");var B=(0,j.default)(!0,{},K.theme.DEFAULTS);[B,K].forEach(function(se){se.modules=se.modules||{},Object.keys(se.modules).forEach(function(le){se.modules[le]===!0&&(se.modules[le]={})})});var G=Object.keys(B.modules).concat(Object.keys(K.modules)),X=G.reduce(function(se,le){var Q=$.import("modules/"+le);return Q==null?M.error("Cannot load "+le+" module. Are you sure you registered it?"):se[le]=Q.DEFAULTS||{},se},{});return K.modules!=null&&K.modules.toolbar&&K.modules.toolbar.constructor!==Object&&(K.modules.toolbar={container:K.modules.toolbar}),K=(0,j.default)(!0,{},$.DEFAULTS,{modules:X},B,K),["bounds","container","scrollingContainer"].forEach(function(se){typeof K[se]=="string"&&(K[se]=document.querySelector(K[se]))}),K.modules=Object.keys(K.modules).reduce(function(se,le){return K.modules[le]&&(se[le]=K.modules[le]),se},{}),K}function te(ne,K,B,G){if(this.options.strict&&!this.isEnabled()&&K===_.default.sources.USER)return new f.default;var X=B==null?null:this.getSelection(),se=this.editor.delta,le=ne();if(X!=null&&(B===!0&&(B=X.index),G==null?X=ie(X,le,K):G!==0&&(X=ie(X,B,G,K)),this.setSelection(X,_.default.sources.SILENT)),le.length()>0){var Q,ce=[_.default.events.TEXT_CHANGE,le,se,K];if((Q=this.emitter).emit.apply(Q,[_.default.events.EDITOR_CHANGE].concat(ce)),K!==_.default.sources.SILENT){var ue;(ue=this.emitter).emit.apply(ue,ce)}}return le}function oe(ne,K,B,G,X){var se={};return typeof ne.index=="number"&&typeof ne.length=="number"?typeof K!="number"?(X=G,G=B,B=K,K=ne.length,ne=ne.index):(K=ne.length,ne=ne.index):typeof K!="number"&&(X=G,G=B,B=K,K=0),(typeof B>"u"?"undefined":s(B))==="object"?(se=B,X=G):typeof B=="string"&&(G!=null?se[B]=G:X=B),X=X||_.default.sources.API,[ne,K,se,X]}function ie(ne,K,B,G){if(ne==null)return null;var X=void 0,se=void 0;if(K instanceof f.default){var le=[ne.index,ne.index+ne.length].map(function(fe){return K.transformPosition(fe,G!==_.default.sources.USER)}),Q=o(le,2);X=Q[0],se=Q[1]}else{var ce=[ne.index,ne.index+ne.length].map(function(fe){return fe<K||fe===K&&G===_.default.sources.USER?fe:B>=0?fe+B:Math.max(K,fe+B)}),ue=o(ce,2);X=ue[0],se=ue[1]}return new N.Range(X,se-X)}n.expandConfig=Y,n.overload=oe,n.default=$},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function b(T,N){for(var R=0;R<N.length;R++){var I=N[R];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(T,I.key,I)}}return function(T,N,R){return N&&b(T.prototype,N),R&&b(T,R),T}}(),o=function b(T,N,R){T===null&&(T=Function.prototype);var I=Object.getOwnPropertyDescriptor(T,N);if(I===void 0){var j=Object.getPrototypeOf(T);return j===null?void 0:b(j,N,R)}else{if("value"in I)return I.value;var U=I.get;return U===void 0?void 0:U.call(R)}},l=i(7),d=y(l),f=i(0),m=y(f);function y(b){return b&&b.__esModule?b:{default:b}}function g(b,T){if(!(b instanceof T))throw new TypeError("Cannot call a class as a function")}function _(b,T){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T&&(typeof T=="object"||typeof T=="function")?T:b}function E(b,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof T);b.prototype=Object.create(T&&T.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(b,T):b.__proto__=T)}var x=function(b){E(T,b);function T(){return g(this,T),_(this,(T.__proto__||Object.getPrototypeOf(T)).apply(this,arguments))}return s(T,[{key:"formatAt",value:function(R,I,j,U){if(T.compare(this.statics.blotName,j)<0&&m.default.query(j,m.default.Scope.BLOT)){var C=this.isolate(R,I);U&&C.wrap(j,U)}else o(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"formatAt",this).call(this,R,I,j,U)}},{key:"optimize",value:function(R){if(o(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"optimize",this).call(this,R),this.parent instanceof T&&T.compare(this.statics.blotName,this.parent.statics.blotName)>0){var I=this.parent.isolate(this.offset(),this.length());this.moveChildren(I),I.wrap(this)}}}],[{key:"compare",value:function(R,I){var j=T.order.indexOf(R),U=T.order.indexOf(I);return j>=0||U>=0?j-U:R===I?0:R<I?-1:1}}]),T}(m.default.Inline);x.allowedChildren=[x,m.default.Embed,d.default],x.order=["cursor","inline","underline","strike","italic","bold","script","link","code"],n.default=x},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(0),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}function d(g,_){if(!(g instanceof _))throw new TypeError("Cannot call a class as a function")}function f(g,_){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:g}function m(g,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);g.prototype=Object.create(_&&_.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(g,_):g.__proto__=_)}var y=function(g){m(_,g);function _(){return d(this,_),f(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return _}(o.default.Text);n.default=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function N(R,I){for(var j=0;j<I.length;j++){var U=I[j];U.enumerable=U.enumerable||!1,U.configurable=!0,"value"in U&&(U.writable=!0),Object.defineProperty(R,U.key,U)}}return function(R,I,j){return I&&N(R.prototype,I),j&&N(R,j),R}}(),o=function N(R,I,j){R===null&&(R=Function.prototype);var U=Object.getOwnPropertyDescriptor(R,I);if(U===void 0){var C=Object.getPrototypeOf(R);return C===null?void 0:N(C,I,j)}else{if("value"in U)return U.value;var k=U.get;return k===void 0?void 0:k.call(j)}},l=i(54),d=y(l),f=i(10),m=y(f);function y(N){return N&&N.__esModule?N:{default:N}}function g(N,R){if(!(N instanceof R))throw new TypeError("Cannot call a class as a function")}function _(N,R){if(!N)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return R&&(typeof R=="object"||typeof R=="function")?R:N}function E(N,R){if(typeof R!="function"&&R!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof R);N.prototype=Object.create(R&&R.prototype,{constructor:{value:N,enumerable:!1,writable:!0,configurable:!0}}),R&&(Object.setPrototypeOf?Object.setPrototypeOf(N,R):N.__proto__=R)}var x=(0,m.default)("quill:events"),b=["selectionchange","mousedown","mouseup","click"];b.forEach(function(N){document.addEventListener(N,function(){for(var R=arguments.length,I=Array(R),j=0;j<R;j++)I[j]=arguments[j];[].slice.call(document.querySelectorAll(".ql-container")).forEach(function(U){if(U.__quill&&U.__quill.emitter){var C;(C=U.__quill.emitter).handleDOM.apply(C,I)}})})});var T=function(N){E(R,N);function R(){g(this,R);var I=_(this,(R.__proto__||Object.getPrototypeOf(R)).call(this));return I.listeners={},I.on("error",x.error),I}return s(R,[{key:"emit",value:function(){x.log.apply(x,arguments),o(R.prototype.__proto__||Object.getPrototypeOf(R.prototype),"emit",this).apply(this,arguments)}},{key:"handleDOM",value:function(j){for(var U=arguments.length,C=Array(U>1?U-1:0),k=1;k<U;k++)C[k-1]=arguments[k];(this.listeners[j.type]||[]).forEach(function(D){var O=D.node,P=D.handler;(j.target===O||O.contains(j.target))&&P.apply(void 0,[j].concat(C))})}},{key:"listenDOM",value:function(j,U,C){this.listeners[j]||(this.listeners[j]=[]),this.listeners[j].push({node:U,handler:C})}}]),R}(d.default);T.events={EDITOR_CHANGE:"editor-change",SCROLL_BEFORE_UPDATE:"scroll-before-update",SCROLL_OPTIMIZE:"scroll-optimize",SCROLL_UPDATE:"scroll-update",SELECTION_CHANGE:"selection-change",TEXT_CHANGE:"text-change"},T.sources={API:"api",SILENT:"silent",USER:"user"},n.default=T},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});function s(l,d){if(!(l instanceof d))throw new TypeError("Cannot call a class as a function")}var o=function l(d){var f=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};s(this,l),this.quill=d,this.options=f};o.DEFAULTS={},n.default=o},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=["error","warn","log","info"],o="warn";function l(f){if(s.indexOf(f)<=s.indexOf(o)){for(var m,y=arguments.length,g=Array(y>1?y-1:0),_=1;_<y;_++)g[_-1]=arguments[_];(m=console)[f].apply(m,g)}}function d(f){return s.reduce(function(m,y){return m[y]=l.bind(console,y,f),m},{})}l.level=d.level=function(f){o=f},n.default=d},function(t,n,i){var s=Array.prototype.slice,o=i(52),l=i(53),d=t.exports=function(g,_,E){return E||(E={}),g===_?!0:g instanceof Date&&_ instanceof Date?g.getTime()===_.getTime():!g||!_||typeof g!="object"&&typeof _!="object"?E.strict?g===_:g==_:y(g,_,E)};function f(g){return g==null}function m(g){return!(!g||typeof g!="object"||typeof g.length!="number"||typeof g.copy!="function"||typeof g.slice!="function"||g.length>0&&typeof g[0]!="number")}function y(g,_,E){var x,b;if(f(g)||f(_)||g.prototype!==_.prototype)return!1;if(l(g))return l(_)?(g=s.call(g),_=s.call(_),d(g,_,E)):!1;if(m(g)){if(!m(_)||g.length!==_.length)return!1;for(x=0;x<g.length;x++)if(g[x]!==_[x])return!1;return!0}try{var T=o(g),N=o(_)}catch{return!1}if(T.length!=N.length)return!1;for(T.sort(),N.sort(),x=T.length-1;x>=0;x--)if(T[x]!=N[x])return!1;for(x=T.length-1;x>=0;x--)if(b=T[x],!d(g[b],_[b],E))return!1;return typeof g==typeof _}},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(1),o=function(){function l(d,f,m){m===void 0&&(m={}),this.attrName=d,this.keyName=f;var y=s.Scope.TYPE&s.Scope.ATTRIBUTE;m.scope!=null?this.scope=m.scope&s.Scope.LEVEL|y:this.scope=s.Scope.ATTRIBUTE,m.whitelist!=null&&(this.whitelist=m.whitelist)}return l.keys=function(d){return[].map.call(d.attributes,function(f){return f.name})},l.prototype.add=function(d,f){return this.canAdd(d,f)?(d.setAttribute(this.keyName,f),!0):!1},l.prototype.canAdd=function(d,f){var m=s.query(d,s.Scope.BLOT&(this.scope|s.Scope.TYPE));return m==null?!1:this.whitelist==null?!0:typeof f=="string"?this.whitelist.indexOf(f.replace(/["']/g,""))>-1:this.whitelist.indexOf(f)>-1},l.prototype.remove=function(d){d.removeAttribute(this.keyName)},l.prototype.value=function(d){var f=d.getAttribute(this.keyName);return this.canAdd(d,f)&&f?f:""},l}();n.default=o},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Code=void 0;var s=function(){function k(D,O){var P=[],F=!0,M=!1,$=void 0;try{for(var Y=D[Symbol.iterator](),te;!(F=(te=Y.next()).done)&&(P.push(te.value),!(O&&P.length===O));F=!0);}catch(oe){M=!0,$=oe}finally{try{!F&&Y.return&&Y.return()}finally{if(M)throw $}}return P}return function(D,O){if(Array.isArray(D))return D;if(Symbol.iterator in Object(D))return k(D,O);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function k(D,O){for(var P=0;P<O.length;P++){var F=O[P];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(D,F.key,F)}}return function(D,O,P){return O&&k(D.prototype,O),P&&k(D,P),D}}(),l=function k(D,O,P){D===null&&(D=Function.prototype);var F=Object.getOwnPropertyDescriptor(D,O);if(F===void 0){var M=Object.getPrototypeOf(D);return M===null?void 0:k(M,O,P)}else{if("value"in F)return F.value;var $=F.get;return $===void 0?void 0:$.call(P)}},d=i(2),f=N(d),m=i(0),y=N(m),g=i(4),_=N(g),E=i(6),x=N(E),b=i(7),T=N(b);function N(k){return k&&k.__esModule?k:{default:k}}function R(k,D){if(!(k instanceof D))throw new TypeError("Cannot call a class as a function")}function I(k,D){if(!k)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return D&&(typeof D=="object"||typeof D=="function")?D:k}function j(k,D){if(typeof D!="function"&&D!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof D);k.prototype=Object.create(D&&D.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),D&&(Object.setPrototypeOf?Object.setPrototypeOf(k,D):k.__proto__=D)}var U=function(k){j(D,k);function D(){return R(this,D),I(this,(D.__proto__||Object.getPrototypeOf(D)).apply(this,arguments))}return D}(x.default);U.blotName="code",U.tagName="CODE";var C=function(k){j(D,k);function D(){return R(this,D),I(this,(D.__proto__||Object.getPrototypeOf(D)).apply(this,arguments))}return o(D,[{key:"delta",value:function(){var P=this,F=this.domNode.textContent;return F.endsWith(`
`)&&(F=F.slice(0,-1)),F.split(`
`).reduce(function(M,$){return M.insert($).insert(`
`,P.formats())},new f.default)}},{key:"format",value:function(P,F){if(!(P===this.statics.blotName&&F)){var M=this.descendant(T.default,this.length()-1),$=s(M,1),Y=$[0];Y!=null&&Y.deleteAt(Y.length()-1,1),l(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"format",this).call(this,P,F)}}},{key:"formatAt",value:function(P,F,M,$){if(F!==0&&!(y.default.query(M,y.default.Scope.BLOCK)==null||M===this.statics.blotName&&$===this.statics.formats(this.domNode))){var Y=this.newlineIndex(P);if(!(Y<0||Y>=P+F)){var te=this.newlineIndex(P,!0)+1,oe=Y-te+1,ie=this.isolate(te,oe),ne=ie.next;ie.format(M,$),ne instanceof D&&ne.formatAt(0,P-te+F-oe,M,$)}}}},{key:"insertAt",value:function(P,F,M){if(M==null){var $=this.descendant(T.default,P),Y=s($,2),te=Y[0],oe=Y[1];te.insertAt(oe,F)}}},{key:"length",value:function(){var P=this.domNode.textContent.length;return this.domNode.textContent.endsWith(`
`)?P:P+1}},{key:"newlineIndex",value:function(P){var F=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;if(F)return this.domNode.textContent.slice(0,P).lastIndexOf(`
`);var M=this.domNode.textContent.slice(P).indexOf(`
`);return M>-1?P+M:-1}},{key:"optimize",value:function(P){this.domNode.textContent.endsWith(`
`)||this.appendChild(y.default.create("text",`
`)),l(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"optimize",this).call(this,P);var F=this.next;F!=null&&F.prev===this&&F.statics.blotName===this.statics.blotName&&this.statics.formats(this.domNode)===F.statics.formats(F.domNode)&&(F.optimize(P),F.moveChildren(this),F.remove())}},{key:"replace",value:function(P){l(D.prototype.__proto__||Object.getPrototypeOf(D.prototype),"replace",this).call(this,P),[].slice.call(this.domNode.querySelectorAll("*")).forEach(function(F){var M=y.default.find(F);M==null?F.parentNode.removeChild(F):M instanceof y.default.Embed?M.remove():M.unwrap()})}}],[{key:"create",value:function(P){var F=l(D.__proto__||Object.getPrototypeOf(D),"create",this).call(this,P);return F.setAttribute("spellcheck",!1),F}},{key:"formats",value:function(){return!0}}]),D}(_.default);C.blotName="code-block",C.tagName="PRE",C.TAB="  ",n.Code=U,n.default=C},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ne){return typeof ne}:function(ne){return ne&&typeof Symbol=="function"&&ne.constructor===Symbol&&ne!==Symbol.prototype?"symbol":typeof ne},o=function(){function ne(K,B){var G=[],X=!0,se=!1,le=void 0;try{for(var Q=K[Symbol.iterator](),ce;!(X=(ce=Q.next()).done)&&(G.push(ce.value),!(B&&G.length===B));X=!0);}catch(ue){se=!0,le=ue}finally{try{!X&&Q.return&&Q.return()}finally{if(se)throw le}}return G}return function(K,B){if(Array.isArray(K))return K;if(Symbol.iterator in Object(K))return ne(K,B);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function ne(K,B){for(var G=0;G<B.length;G++){var X=B[G];X.enumerable=X.enumerable||!1,X.configurable=!0,"value"in X&&(X.writable=!0),Object.defineProperty(K,X.key,X)}}return function(K,B,G){return B&&ne(K.prototype,B),G&&ne(K,G),K}}(),d=i(2),f=F(d),m=i(20),y=F(m),g=i(0),_=F(g),E=i(13),x=F(E),b=i(24),T=F(b),N=i(4),R=F(N),I=i(16),j=F(I),U=i(21),C=F(U),k=i(11),D=F(k),O=i(3),P=F(O);function F(ne){return ne&&ne.__esModule?ne:{default:ne}}function M(ne,K,B){return K in ne?Object.defineProperty(ne,K,{value:B,enumerable:!0,configurable:!0,writable:!0}):ne[K]=B,ne}function $(ne,K){if(!(ne instanceof K))throw new TypeError("Cannot call a class as a function")}var Y=/^[ -~]*$/,te=function(){function ne(K){$(this,ne),this.scroll=K,this.delta=this.getDelta()}return l(ne,[{key:"applyDelta",value:function(B){var G=this,X=!1;this.scroll.update();var se=this.scroll.length();return this.scroll.batchStart(),B=ie(B),B.reduce(function(le,Q){var ce=Q.retain||Q.delete||Q.insert.length||1,ue=Q.attributes||{};if(Q.insert!=null){if(typeof Q.insert=="string"){var fe=Q.insert;fe.endsWith(`
`)&&X&&(X=!1,fe=fe.slice(0,-1)),le>=se&&!fe.endsWith(`
`)&&(X=!0),G.scroll.insertAt(le,fe);var _e=G.scroll.line(le),Oe=o(_e,2),qe=Oe[0],tt=Oe[1],yt=(0,P.default)({},(0,N.bubbleFormats)(qe));if(qe instanceof R.default){var At=qe.descendant(_.default.Leaf,tt),xn=o(At,1),Yt=xn[0];yt=(0,P.default)(yt,(0,N.bubbleFormats)(Yt))}ue=y.default.attributes.diff(yt,ue)||{}}else if(s(Q.insert)==="object"){var Ae=Object.keys(Q.insert)[0];if(Ae==null)return le;G.scroll.insertAt(le,Ae,Q.insert[Ae])}se+=ce}return Object.keys(ue).forEach(function(Ne){G.scroll.formatAt(le,ce,Ne,ue[Ne])}),le+ce},0),B.reduce(function(le,Q){return typeof Q.delete=="number"?(G.scroll.deleteAt(le,Q.delete),le):le+(Q.retain||Q.insert.length||1)},0),this.scroll.batchEnd(),this.update(B)}},{key:"deleteText",value:function(B,G){return this.scroll.deleteAt(B,G),this.update(new f.default().retain(B).delete(G))}},{key:"formatLine",value:function(B,G){var X=this,se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.scroll.update(),Object.keys(se).forEach(function(le){if(!(X.scroll.whitelist!=null&&!X.scroll.whitelist[le])){var Q=X.scroll.lines(B,Math.max(G,1)),ce=G;Q.forEach(function(ue){var fe=ue.length();if(!(ue instanceof x.default))ue.format(le,se[le]);else{var _e=B-ue.offset(X.scroll),Oe=ue.newlineIndex(_e+ce)-_e+1;ue.formatAt(_e,Oe,le,se[le])}ce-=fe})}}),this.scroll.optimize(),this.update(new f.default().retain(B).retain(G,(0,C.default)(se)))}},{key:"formatText",value:function(B,G){var X=this,se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return Object.keys(se).forEach(function(le){X.scroll.formatAt(B,G,le,se[le])}),this.update(new f.default().retain(B).retain(G,(0,C.default)(se)))}},{key:"getContents",value:function(B,G){return this.delta.slice(B,B+G)}},{key:"getDelta",value:function(){return this.scroll.lines().reduce(function(B,G){return B.concat(G.delta())},new f.default)}},{key:"getFormat",value:function(B){var G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,X=[],se=[];G===0?this.scroll.path(B).forEach(function(Q){var ce=o(Q,1),ue=ce[0];ue instanceof R.default?X.push(ue):ue instanceof _.default.Leaf&&se.push(ue)}):(X=this.scroll.lines(B,G),se=this.scroll.descendants(_.default.Leaf,B,G));var le=[X,se].map(function(Q){if(Q.length===0)return{};for(var ce=(0,N.bubbleFormats)(Q.shift());Object.keys(ce).length>0;){var ue=Q.shift();if(ue==null)return ce;ce=oe((0,N.bubbleFormats)(ue),ce)}return ce});return P.default.apply(P.default,le)}},{key:"getText",value:function(B,G){return this.getContents(B,G).filter(function(X){return typeof X.insert=="string"}).map(function(X){return X.insert}).join("")}},{key:"insertEmbed",value:function(B,G,X){return this.scroll.insertAt(B,G,X),this.update(new f.default().retain(B).insert(M({},G,X)))}},{key:"insertText",value:function(B,G){var X=this,se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return G=G.replace(/\r\n/g,`
`).replace(/\r/g,`
`),this.scroll.insertAt(B,G),Object.keys(se).forEach(function(le){X.scroll.formatAt(B,G.length,le,se[le])}),this.update(new f.default().retain(B).insert(G,(0,C.default)(se)))}},{key:"isBlank",value:function(){if(this.scroll.children.length==0)return!0;if(this.scroll.children.length>1)return!1;var B=this.scroll.children.head;return B.statics.blotName!==R.default.blotName||B.children.length>1?!1:B.children.head instanceof j.default}},{key:"removeFormat",value:function(B,G){var X=this.getText(B,G),se=this.scroll.line(B+G),le=o(se,2),Q=le[0],ce=le[1],ue=0,fe=new f.default;Q!=null&&(Q instanceof x.default?ue=Q.newlineIndex(ce)-ce+1:ue=Q.length()-ce,fe=Q.delta().slice(ce,ce+ue-1).insert(`
`));var _e=this.getContents(B,G+ue),Oe=_e.diff(new f.default().insert(X).concat(fe)),qe=new f.default().retain(B).concat(Oe);return this.applyDelta(qe)}},{key:"update",value:function(B){var G=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],X=arguments.length>2&&arguments[2]!==void 0?arguments[2]:void 0,se=this.delta;if(G.length===1&&G[0].type==="characterData"&&G[0].target.data.match(Y)&&_.default.find(G[0].target)){var le=_.default.find(G[0].target),Q=(0,N.bubbleFormats)(le),ce=le.offset(this.scroll),ue=G[0].oldValue.replace(T.default.CONTENTS,""),fe=new f.default().insert(ue),_e=new f.default().insert(le.value()),Oe=new f.default().retain(ce).concat(fe.diff(_e,X));B=Oe.reduce(function(qe,tt){return tt.insert?qe.insert(tt.insert,Q):qe.push(tt)},new f.default),this.delta=se.compose(B)}else this.delta=this.getDelta(),(!B||!(0,D.default)(se.compose(B),this.delta))&&(B=se.diff(this.delta,X));return B}}]),ne}();function oe(ne,K){return Object.keys(K).reduce(function(B,G){return ne[G]==null||(K[G]===ne[G]?B[G]=K[G]:Array.isArray(K[G])?K[G].indexOf(ne[G])<0&&(B[G]=K[G].concat([ne[G]])):B[G]=[K[G],ne[G]]),B},{})}function ie(ne){return ne.reduce(function(K,B){if(B.insert===1){var G=(0,C.default)(B.attributes);return delete G.image,K.insert({image:B.attributes.image},G)}if(B.attributes!=null&&(B.attributes.list===!0||B.attributes.bullet===!0)&&(B=(0,C.default)(B),B.attributes.list?B.attributes.list="ordered":(B.attributes.list="bullet",delete B.attributes.bullet)),typeof B.insert=="string"){var X=B.insert.replace(/\r\n/g,`
`).replace(/\r/g,`
`);return K.insert(X,B.attributes)}return K.push(B)},new f.default)}n.default=te},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.Range=void 0;var s=function(){function k(D,O){var P=[],F=!0,M=!1,$=void 0;try{for(var Y=D[Symbol.iterator](),te;!(F=(te=Y.next()).done)&&(P.push(te.value),!(O&&P.length===O));F=!0);}catch(oe){M=!0,$=oe}finally{try{!F&&Y.return&&Y.return()}finally{if(M)throw $}}return P}return function(D,O){if(Array.isArray(D))return D;if(Symbol.iterator in Object(D))return k(D,O);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function k(D,O){for(var P=0;P<O.length;P++){var F=O[P];F.enumerable=F.enumerable||!1,F.configurable=!0,"value"in F&&(F.writable=!0),Object.defineProperty(D,F.key,F)}}return function(D,O,P){return O&&k(D.prototype,O),P&&k(D,P),D}}(),l=i(0),d=T(l),f=i(21),m=T(f),y=i(11),g=T(y),_=i(8),E=T(_),x=i(10),b=T(x);function T(k){return k&&k.__esModule?k:{default:k}}function N(k){if(Array.isArray(k)){for(var D=0,O=Array(k.length);D<k.length;D++)O[D]=k[D];return O}else return Array.from(k)}function R(k,D){if(!(k instanceof D))throw new TypeError("Cannot call a class as a function")}var I=(0,b.default)("quill:selection"),j=function k(D){var O=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;R(this,k),this.index=D,this.length=O},U=function(){function k(D,O){var P=this;R(this,k),this.emitter=O,this.scroll=D,this.composing=!1,this.mouseDown=!1,this.root=this.scroll.domNode,this.cursor=d.default.create("cursor",this),this.lastRange=this.savedRange=new j(0,0),this.handleComposition(),this.handleDragging(),this.emitter.listenDOM("selectionchange",document,function(){P.mouseDown||setTimeout(P.update.bind(P,E.default.sources.USER),1)}),this.emitter.on(E.default.events.EDITOR_CHANGE,function(F,M){F===E.default.events.TEXT_CHANGE&&M.length()>0&&P.update(E.default.sources.SILENT)}),this.emitter.on(E.default.events.SCROLL_BEFORE_UPDATE,function(){if(P.hasFocus()){var F=P.getNativeRange();F!=null&&F.start.node!==P.cursor.textNode&&P.emitter.once(E.default.events.SCROLL_UPDATE,function(){try{P.setNativeRange(F.start.node,F.start.offset,F.end.node,F.end.offset)}catch{}})}}),this.emitter.on(E.default.events.SCROLL_OPTIMIZE,function(F,M){if(M.range){var $=M.range,Y=$.startNode,te=$.startOffset,oe=$.endNode,ie=$.endOffset;P.setNativeRange(Y,te,oe,ie)}}),this.update(E.default.sources.SILENT)}return o(k,[{key:"handleComposition",value:function(){var O=this;this.root.addEventListener("compositionstart",function(){O.composing=!0}),this.root.addEventListener("compositionend",function(){if(O.composing=!1,O.cursor.parent){var P=O.cursor.restore();if(!P)return;setTimeout(function(){O.setNativeRange(P.startNode,P.startOffset,P.endNode,P.endOffset)},1)}})}},{key:"handleDragging",value:function(){var O=this;this.emitter.listenDOM("mousedown",document.body,function(){O.mouseDown=!0}),this.emitter.listenDOM("mouseup",document.body,function(){O.mouseDown=!1,O.update(E.default.sources.USER)})}},{key:"focus",value:function(){this.hasFocus()||(this.root.focus(),this.setRange(this.savedRange))}},{key:"format",value:function(O,P){if(!(this.scroll.whitelist!=null&&!this.scroll.whitelist[O])){this.scroll.update();var F=this.getNativeRange();if(!(F==null||!F.native.collapsed||d.default.query(O,d.default.Scope.BLOCK))){if(F.start.node!==this.cursor.textNode){var M=d.default.find(F.start.node,!1);if(M==null)return;if(M instanceof d.default.Leaf){var $=M.split(F.start.offset);M.parent.insertBefore(this.cursor,$)}else M.insertBefore(this.cursor,F.start.node);this.cursor.attach()}this.cursor.format(O,P),this.scroll.optimize(),this.setNativeRange(this.cursor.textNode,this.cursor.textNode.data.length),this.update()}}}},{key:"getBounds",value:function(O){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,F=this.scroll.length();O=Math.min(O,F-1),P=Math.min(O+P,F-1)-O;var M=void 0,$=this.scroll.leaf(O),Y=s($,2),te=Y[0],oe=Y[1];if(te==null)return null;var ie=te.position(oe,!0),ne=s(ie,2);M=ne[0],oe=ne[1];var K=document.createRange();if(P>0){K.setStart(M,oe);var B=this.scroll.leaf(O+P),G=s(B,2);if(te=G[0],oe=G[1],te==null)return null;var X=te.position(oe,!0),se=s(X,2);return M=se[0],oe=se[1],K.setEnd(M,oe),K.getBoundingClientRect()}else{var le="left",Q=void 0;return M instanceof Text?(oe<M.data.length?(K.setStart(M,oe),K.setEnd(M,oe+1)):(K.setStart(M,oe-1),K.setEnd(M,oe),le="right"),Q=K.getBoundingClientRect()):(Q=te.domNode.getBoundingClientRect(),oe>0&&(le="right")),{bottom:Q.top+Q.height,height:Q.height,left:Q[le],right:Q[le],top:Q.top,width:0}}}},{key:"getNativeRange",value:function(){var O=document.getSelection();if(O==null||O.rangeCount<=0)return null;var P=O.getRangeAt(0);if(P==null)return null;var F=this.normalizeNative(P);return I.info("getNativeRange",F),F}},{key:"getRange",value:function(){var O=this.getNativeRange();if(O==null)return[null,null];var P=this.normalizedToRange(O);return[P,O]}},{key:"hasFocus",value:function(){return document.activeElement===this.root}},{key:"normalizedToRange",value:function(O){var P=this,F=[[O.start.node,O.start.offset]];O.native.collapsed||F.push([O.end.node,O.end.offset]);var M=F.map(function(te){var oe=s(te,2),ie=oe[0],ne=oe[1],K=d.default.find(ie,!0),B=K.offset(P.scroll);return ne===0?B:K instanceof d.default.Container?B+K.length():B+K.index(ie,ne)}),$=Math.min(Math.max.apply(Math,N(M)),this.scroll.length()-1),Y=Math.min.apply(Math,[$].concat(N(M)));return new j(Y,$-Y)}},{key:"normalizeNative",value:function(O){if(!C(this.root,O.startContainer)||!O.collapsed&&!C(this.root,O.endContainer))return null;var P={start:{node:O.startContainer,offset:O.startOffset},end:{node:O.endContainer,offset:O.endOffset},native:O};return[P.start,P.end].forEach(function(F){for(var M=F.node,$=F.offset;!(M instanceof Text)&&M.childNodes.length>0;)if(M.childNodes.length>$)M=M.childNodes[$],$=0;else if(M.childNodes.length===$)M=M.lastChild,$=M instanceof Text?M.data.length:M.childNodes.length+1;else break;F.node=M,F.offset=$}),P}},{key:"rangeToNative",value:function(O){var P=this,F=O.collapsed?[O.index]:[O.index,O.index+O.length],M=[],$=this.scroll.length();return F.forEach(function(Y,te){Y=Math.min($-1,Y);var oe=void 0,ie=P.scroll.leaf(Y),ne=s(ie,2),K=ne[0],B=ne[1],G=K.position(B,te!==0),X=s(G,2);oe=X[0],B=X[1],M.push(oe,B)}),M.length<2&&(M=M.concat(M)),M}},{key:"scrollIntoView",value:function(O){var P=this.lastRange;if(P!=null){var F=this.getBounds(P.index,P.length);if(F!=null){var M=this.scroll.length()-1,$=this.scroll.line(Math.min(P.index,M)),Y=s($,1),te=Y[0],oe=te;if(P.length>0){var ie=this.scroll.line(Math.min(P.index+P.length,M)),ne=s(ie,1);oe=ne[0]}if(!(te==null||oe==null)){var K=O.getBoundingClientRect();F.top<K.top?O.scrollTop-=K.top-F.top:F.bottom>K.bottom&&(O.scrollTop+=F.bottom-K.bottom)}}}}},{key:"setNativeRange",value:function(O,P){var F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:O,M=arguments.length>3&&arguments[3]!==void 0?arguments[3]:P,$=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(I.info("setNativeRange",O,P,F,M),!(O!=null&&(this.root.parentNode==null||O.parentNode==null||F.parentNode==null))){var Y=document.getSelection();if(Y!=null)if(O!=null){this.hasFocus()||this.root.focus();var te=(this.getNativeRange()||{}).native;if(te==null||$||O!==te.startContainer||P!==te.startOffset||F!==te.endContainer||M!==te.endOffset){O.tagName=="BR"&&(P=[].indexOf.call(O.parentNode.childNodes,O),O=O.parentNode),F.tagName=="BR"&&(M=[].indexOf.call(F.parentNode.childNodes,F),F=F.parentNode);var oe=document.createRange();oe.setStart(O,P),oe.setEnd(F,M),Y.removeAllRanges(),Y.addRange(oe)}}else Y.removeAllRanges(),this.root.blur(),document.body.focus()}}},{key:"setRange",value:function(O){var P=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:E.default.sources.API;if(typeof P=="string"&&(F=P,P=!1),I.info("setRange",O),O!=null){var M=this.rangeToNative(O);this.setNativeRange.apply(this,N(M).concat([P]))}else this.setNativeRange(null);this.update(F)}},{key:"update",value:function(){var O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:E.default.sources.USER,P=this.lastRange,F=this.getRange(),M=s(F,2),$=M[0],Y=M[1];if(this.lastRange=$,this.lastRange!=null&&(this.savedRange=this.lastRange),!(0,g.default)(P,this.lastRange)){var te;!this.composing&&Y!=null&&Y.native.collapsed&&Y.start.node!==this.cursor.textNode&&this.cursor.restore();var oe=[E.default.events.SELECTION_CHANGE,(0,m.default)(this.lastRange),(0,m.default)(P),O];if((te=this.emitter).emit.apply(te,[E.default.events.EDITOR_CHANGE].concat(oe)),O!==E.default.sources.SILENT){var ie;(ie=this.emitter).emit.apply(ie,oe)}}}}]),k}();function C(k,D){try{D.parentNode}catch{return!1}return D instanceof Text&&(D=D.parentNode),k.contains(D)}n.Range=j,n.default=U},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function E(x,b){for(var T=0;T<b.length;T++){var N=b[T];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(x,N.key,N)}}return function(x,b,T){return b&&E(x.prototype,b),T&&E(x,T),x}}(),o=function E(x,b,T){x===null&&(x=Function.prototype);var N=Object.getOwnPropertyDescriptor(x,b);if(N===void 0){var R=Object.getPrototypeOf(x);return R===null?void 0:E(R,b,T)}else{if("value"in N)return N.value;var I=N.get;return I===void 0?void 0:I.call(T)}},l=i(0),d=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function y(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var _=function(E){g(x,E);function x(){return m(this,x),y(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return s(x,[{key:"insertInto",value:function(T,N){T.children.length===0?o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"insertInto",this).call(this,T,N):this.remove()}},{key:"length",value:function(){return 0}},{key:"value",value:function(){return""}}],[{key:"value",value:function(){}}]),x}(d.default.Embed);_.blotName="break",_.tagName="BR",n.default=_},function(t,n,i){var s=this&&this.__extends||function(){var y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,_){g.__proto__=_}||function(g,_){for(var E in _)_.hasOwnProperty(E)&&(g[E]=_[E])};return function(g,_){y(g,_);function E(){this.constructor=g}g.prototype=_===null?Object.create(_):(E.prototype=_.prototype,new E)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(44),l=i(30),d=i(1),f=function(y){s(g,y);function g(_){var E=y.call(this,_)||this;return E.build(),E}return g.prototype.appendChild=function(_){this.insertBefore(_)},g.prototype.attach=function(){y.prototype.attach.call(this),this.children.forEach(function(_){_.attach()})},g.prototype.build=function(){var _=this;this.children=new o.default,[].slice.call(this.domNode.childNodes).reverse().forEach(function(E){try{var x=m(E);_.insertBefore(x,_.children.head||void 0)}catch(b){if(b instanceof d.ParchmentError)return;throw b}})},g.prototype.deleteAt=function(_,E){if(_===0&&E===this.length())return this.remove();this.children.forEachAt(_,E,function(x,b,T){x.deleteAt(b,T)})},g.prototype.descendant=function(_,E){var x=this.children.find(E),b=x[0],T=x[1];return _.blotName==null&&_(b)||_.blotName!=null&&b instanceof _?[b,T]:b instanceof g?b.descendant(_,T):[null,-1]},g.prototype.descendants=function(_,E,x){E===void 0&&(E=0),x===void 0&&(x=Number.MAX_VALUE);var b=[],T=x;return this.children.forEachAt(E,x,function(N,R,I){(_.blotName==null&&_(N)||_.blotName!=null&&N instanceof _)&&b.push(N),N instanceof g&&(b=b.concat(N.descendants(_,R,T))),T-=I}),b},g.prototype.detach=function(){this.children.forEach(function(_){_.detach()}),y.prototype.detach.call(this)},g.prototype.formatAt=function(_,E,x,b){this.children.forEachAt(_,E,function(T,N,R){T.formatAt(N,R,x,b)})},g.prototype.insertAt=function(_,E,x){var b=this.children.find(_),T=b[0],N=b[1];if(T)T.insertAt(N,E,x);else{var R=x==null?d.create("text",E):d.create(E,x);this.appendChild(R)}},g.prototype.insertBefore=function(_,E){if(this.statics.allowedChildren!=null&&!this.statics.allowedChildren.some(function(x){return _ instanceof x}))throw new d.ParchmentError("Cannot insert "+_.statics.blotName+" into "+this.statics.blotName);_.insertInto(this,E)},g.prototype.length=function(){return this.children.reduce(function(_,E){return _+E.length()},0)},g.prototype.moveChildren=function(_,E){this.children.forEach(function(x){_.insertBefore(x,E)})},g.prototype.optimize=function(_){if(y.prototype.optimize.call(this,_),this.children.length===0)if(this.statics.defaultChild!=null){var E=d.create(this.statics.defaultChild);this.appendChild(E),E.optimize(_)}else this.remove()},g.prototype.path=function(_,E){E===void 0&&(E=!1);var x=this.children.find(_,E),b=x[0],T=x[1],N=[[this,_]];return b instanceof g?N.concat(b.path(T,E)):(b!=null&&N.push([b,T]),N)},g.prototype.removeChild=function(_){this.children.remove(_)},g.prototype.replace=function(_){_ instanceof g&&_.moveChildren(this),y.prototype.replace.call(this,_)},g.prototype.split=function(_,E){if(E===void 0&&(E=!1),!E){if(_===0)return this;if(_===this.length())return this.next}var x=this.clone();return this.parent.insertBefore(x,this.next),this.children.forEachAt(_,this.length(),function(b,T,N){b=b.split(T,E),x.appendChild(b)}),x},g.prototype.unwrap=function(){this.moveChildren(this.parent,this.next),this.remove()},g.prototype.update=function(_,E){var x=this,b=[],T=[];_.forEach(function(N){N.target===x.domNode&&N.type==="childList"&&(b.push.apply(b,N.addedNodes),T.push.apply(T,N.removedNodes))}),T.forEach(function(N){if(!(N.parentNode!=null&&N.tagName!=="IFRAME"&&document.body.compareDocumentPosition(N)&Node.DOCUMENT_POSITION_CONTAINED_BY)){var R=d.find(N);R!=null&&(R.domNode.parentNode==null||R.domNode.parentNode===x.domNode)&&R.detach()}}),b.filter(function(N){return N.parentNode==x.domNode}).sort(function(N,R){return N===R?0:N.compareDocumentPosition(R)&Node.DOCUMENT_POSITION_FOLLOWING?1:-1}).forEach(function(N){var R=null;N.nextSibling!=null&&(R=d.find(N.nextSibling));var I=m(N);(I.next!=R||I.next==null)&&(I.parent!=null&&I.parent.removeChild(x),x.insertBefore(I,R||void 0))})},g}(l.default);function m(y){var g=d.find(y);if(g==null)try{g=d.create(y)}catch{g=d.create(d.Scope.INLINE),[].slice.call(y.childNodes).forEach(function(E){g.domNode.appendChild(E)}),y.parentNode&&y.parentNode.replaceChild(g.domNode,y),g.attach()}return g}n.default=f},function(t,n,i){var s=this&&this.__extends||function(){var y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,_){g.__proto__=_}||function(g,_){for(var E in _)_.hasOwnProperty(E)&&(g[E]=_[E])};return function(g,_){y(g,_);function E(){this.constructor=g}g.prototype=_===null?Object.create(_):(E.prototype=_.prototype,new E)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12),l=i(31),d=i(17),f=i(1),m=function(y){s(g,y);function g(_){var E=y.call(this,_)||this;return E.attributes=new l.default(E.domNode),E}return g.formats=function(_){if(typeof this.tagName=="string")return!0;if(Array.isArray(this.tagName))return _.tagName.toLowerCase()},g.prototype.format=function(_,E){var x=f.query(_);x instanceof o.default?this.attributes.attribute(x,E):E&&x!=null&&(_!==this.statics.blotName||this.formats()[_]!==E)&&this.replaceWith(_,E)},g.prototype.formats=function(){var _=this.attributes.values(),E=this.statics.formats(this.domNode);return E!=null&&(_[this.statics.blotName]=E),_},g.prototype.replaceWith=function(_,E){var x=y.prototype.replaceWith.call(this,_,E);return this.attributes.copy(x),x},g.prototype.update=function(_,E){var x=this;y.prototype.update.call(this,_,E),_.some(function(b){return b.target===x.domNode&&b.type==="attributes"})&&this.attributes.build()},g.prototype.wrap=function(_,E){var x=y.prototype.wrap.call(this,_,E);return x instanceof g&&x.statics.scope===this.statics.scope&&this.attributes.move(x),x},g}(d.default);n.default=m},function(t,n,i){var s=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var g in y)y.hasOwnProperty(g)&&(m[g]=y[g])};return function(m,y){f(m,y);function g(){this.constructor=m}m.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(30),l=i(1),d=function(f){s(m,f);function m(){return f!==null&&f.apply(this,arguments)||this}return m.value=function(y){return!0},m.prototype.index=function(y,g){return this.domNode===y||this.domNode.compareDocumentPosition(y)&Node.DOCUMENT_POSITION_CONTAINED_BY?Math.min(g,1):-1},m.prototype.position=function(y,g){var _=[].indexOf.call(this.parent.domNode.childNodes,this.domNode);return y>0&&(_+=1),[this.parent.domNode,_]},m.prototype.value=function(){var y;return y={},y[this.statics.blotName]=this.statics.value(this.domNode)||!0,y},m.scope=l.Scope.INLINE_BLOT,m}(o.default);n.default=d},function(t,n,i){var s=i(11),o=i(3),l={attributes:{compose:function(f,m,y){typeof f!="object"&&(f={}),typeof m!="object"&&(m={});var g=o(!0,{},m);y||(g=Object.keys(g).reduce(function(E,x){return g[x]!=null&&(E[x]=g[x]),E},{}));for(var _ in f)f[_]!==void 0&&m[_]===void 0&&(g[_]=f[_]);return Object.keys(g).length>0?g:void 0},diff:function(f,m){typeof f!="object"&&(f={}),typeof m!="object"&&(m={});var y=Object.keys(f).concat(Object.keys(m)).reduce(function(g,_){return s(f[_],m[_])||(g[_]=m[_]===void 0?null:m[_]),g},{});return Object.keys(y).length>0?y:void 0},transform:function(f,m,y){if(typeof f!="object")return m;if(typeof m=="object"){if(!y)return m;var g=Object.keys(m).reduce(function(_,E){return f[E]===void 0&&(_[E]=m[E]),_},{});return Object.keys(g).length>0?g:void 0}}},iterator:function(f){return new d(f)},length:function(f){return typeof f.delete=="number"?f.delete:typeof f.retain=="number"?f.retain:typeof f.insert=="string"?f.insert.length:1}};function d(f){this.ops=f,this.index=0,this.offset=0}d.prototype.hasNext=function(){return this.peekLength()<1/0},d.prototype.next=function(f){f||(f=1/0);var m=this.ops[this.index];if(m){var y=this.offset,g=l.length(m);if(f>=g-y?(f=g-y,this.index+=1,this.offset=0):this.offset+=f,typeof m.delete=="number")return{delete:f};var _={};return m.attributes&&(_.attributes=m.attributes),typeof m.retain=="number"?_.retain=f:typeof m.insert=="string"?_.insert=m.insert.substr(y,f):_.insert=m.insert,_}else return{retain:1/0}},d.prototype.peek=function(){return this.ops[this.index]},d.prototype.peekLength=function(){return this.ops[this.index]?l.length(this.ops[this.index])-this.offset:1/0},d.prototype.peekType=function(){return this.ops[this.index]?typeof this.ops[this.index].delete=="number"?"delete":typeof this.ops[this.index].retain=="number"?"retain":"insert":"retain"},d.prototype.rest=function(){if(this.hasNext()){if(this.offset===0)return this.ops.slice(this.index);var f=this.offset,m=this.index,y=this.next(),g=this.ops.slice(this.index);return this.offset=f,this.index=m,[y].concat(g)}else return[]},t.exports=l},function(t,n){var i=function(){function s(x,b){return b!=null&&x instanceof b}var o;try{o=Map}catch{o=function(){}}var l;try{l=Set}catch{l=function(){}}var d;try{d=Promise}catch{d=function(){}}function f(x,b,T,N,R){typeof b=="object"&&(T=b.depth,N=b.prototype,R=b.includeNonEnumerable,b=b.circular);var I=[],j=[],U=typeof Buffer<"u";typeof b>"u"&&(b=!0),typeof T>"u"&&(T=1/0);function C(k,D){if(k===null)return null;if(D===0)return k;var O,P;if(typeof k!="object")return k;if(s(k,o))O=new o;else if(s(k,l))O=new l;else if(s(k,d))O=new d(function(K,B){k.then(function(G){K(C(G,D-1))},function(G){B(C(G,D-1))})});else if(f.__isArray(k))O=[];else if(f.__isRegExp(k))O=new RegExp(k.source,E(k)),k.lastIndex&&(O.lastIndex=k.lastIndex);else if(f.__isDate(k))O=new Date(k.getTime());else{if(U&&Buffer.isBuffer(k))return Buffer.allocUnsafe?O=Buffer.allocUnsafe(k.length):O=new Buffer(k.length),k.copy(O),O;s(k,Error)?O=Object.create(k):typeof N>"u"?(P=Object.getPrototypeOf(k),O=Object.create(P)):(O=Object.create(N),P=N)}if(b){var F=I.indexOf(k);if(F!=-1)return j[F];I.push(k),j.push(O)}s(k,o)&&k.forEach(function(K,B){var G=C(B,D-1),X=C(K,D-1);O.set(G,X)}),s(k,l)&&k.forEach(function(K){var B=C(K,D-1);O.add(B)});for(var M in k){var $;P&&($=Object.getOwnPropertyDescriptor(P,M)),!($&&$.set==null)&&(O[M]=C(k[M],D-1))}if(Object.getOwnPropertySymbols)for(var Y=Object.getOwnPropertySymbols(k),M=0;M<Y.length;M++){var te=Y[M],oe=Object.getOwnPropertyDescriptor(k,te);oe&&!oe.enumerable&&!R||(O[te]=C(k[te],D-1),oe.enumerable||Object.defineProperty(O,te,{enumerable:!1}))}if(R)for(var ie=Object.getOwnPropertyNames(k),M=0;M<ie.length;M++){var ne=ie[M],oe=Object.getOwnPropertyDescriptor(k,ne);oe&&oe.enumerable||(O[ne]=C(k[ne],D-1),Object.defineProperty(O,ne,{enumerable:!1}))}return O}return C(x,T)}f.clonePrototype=function(b){if(b===null)return null;var T=function(){};return T.prototype=b,new T};function m(x){return Object.prototype.toString.call(x)}f.__objToStr=m;function y(x){return typeof x=="object"&&m(x)==="[object Date]"}f.__isDate=y;function g(x){return typeof x=="object"&&m(x)==="[object Array]"}f.__isArray=g;function _(x){return typeof x=="object"&&m(x)==="[object RegExp]"}f.__isRegExp=_;function E(x){var b="";return x.global&&(b+="g"),x.ignoreCase&&(b+="i"),x.multiline&&(b+="m"),b}return f.__getRegExpFlags=E,f}();typeof t=="object"&&t.exports&&(t.exports=i)},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function O(P,F){var M=[],$=!0,Y=!1,te=void 0;try{for(var oe=P[Symbol.iterator](),ie;!($=(ie=oe.next()).done)&&(M.push(ie.value),!(F&&M.length===F));$=!0);}catch(ne){Y=!0,te=ne}finally{try{!$&&oe.return&&oe.return()}finally{if(Y)throw te}}return M}return function(P,F){if(Array.isArray(P))return P;if(Symbol.iterator in Object(P))return O(P,F);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function O(P,F){for(var M=0;M<F.length;M++){var $=F[M];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(P,$.key,$)}}return function(P,F,M){return F&&O(P.prototype,F),M&&O(P,M),P}}(),l=function O(P,F,M){P===null&&(P=Function.prototype);var $=Object.getOwnPropertyDescriptor(P,F);if($===void 0){var Y=Object.getPrototypeOf(P);return Y===null?void 0:O(Y,F,M)}else{if("value"in $)return $.value;var te=$.get;return te===void 0?void 0:te.call(M)}},d=i(0),f=I(d),m=i(8),y=I(m),g=i(4),_=I(g),E=i(16),x=I(E),b=i(13),T=I(b),N=i(25),R=I(N);function I(O){return O&&O.__esModule?O:{default:O}}function j(O,P){if(!(O instanceof P))throw new TypeError("Cannot call a class as a function")}function U(O,P){if(!O)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P&&(typeof P=="object"||typeof P=="function")?P:O}function C(O,P){if(typeof P!="function"&&P!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof P);O.prototype=Object.create(P&&P.prototype,{constructor:{value:O,enumerable:!1,writable:!0,configurable:!0}}),P&&(Object.setPrototypeOf?Object.setPrototypeOf(O,P):O.__proto__=P)}function k(O){return O instanceof _.default||O instanceof g.BlockEmbed}var D=function(O){C(P,O);function P(F,M){j(this,P);var $=U(this,(P.__proto__||Object.getPrototypeOf(P)).call(this,F));return $.emitter=M.emitter,Array.isArray(M.whitelist)&&($.whitelist=M.whitelist.reduce(function(Y,te){return Y[te]=!0,Y},{})),$.domNode.addEventListener("DOMNodeInserted",function(){}),$.optimize(),$.enable(),$}return o(P,[{key:"batchStart",value:function(){this.batch=!0}},{key:"batchEnd",value:function(){this.batch=!1,this.optimize()}},{key:"deleteAt",value:function(M,$){var Y=this.line(M),te=s(Y,2),oe=te[0],ie=te[1],ne=this.line(M+$),K=s(ne,1),B=K[0];if(l(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"deleteAt",this).call(this,M,$),B!=null&&oe!==B&&ie>0){if(oe instanceof g.BlockEmbed||B instanceof g.BlockEmbed){this.optimize();return}if(oe instanceof T.default){var G=oe.newlineIndex(oe.length(),!0);if(G>-1&&(oe=oe.split(G+1),oe===B)){this.optimize();return}}else if(B instanceof T.default){var X=B.newlineIndex(0);X>-1&&B.split(X+1)}var se=B.children.head instanceof x.default?null:B.children.head;oe.moveChildren(B,se),oe.remove()}this.optimize()}},{key:"enable",value:function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.domNode.setAttribute("contenteditable",M)}},{key:"formatAt",value:function(M,$,Y,te){this.whitelist!=null&&!this.whitelist[Y]||(l(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"formatAt",this).call(this,M,$,Y,te),this.optimize())}},{key:"insertAt",value:function(M,$,Y){if(!(Y!=null&&this.whitelist!=null&&!this.whitelist[$])){if(M>=this.length())if(Y==null||f.default.query($,f.default.Scope.BLOCK)==null){var te=f.default.create(this.statics.defaultChild);this.appendChild(te),Y==null&&$.endsWith(`
`)&&($=$.slice(0,-1)),te.insertAt(0,$,Y)}else{var oe=f.default.create($,Y);this.appendChild(oe)}else l(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"insertAt",this).call(this,M,$,Y);this.optimize()}}},{key:"insertBefore",value:function(M,$){if(M.statics.scope===f.default.Scope.INLINE_BLOT){var Y=f.default.create(this.statics.defaultChild);Y.appendChild(M),M=Y}l(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"insertBefore",this).call(this,M,$)}},{key:"leaf",value:function(M){return this.path(M).pop()||[null,-1]}},{key:"line",value:function(M){return M===this.length()?this.line(M-1):this.descendant(k,M)}},{key:"lines",value:function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Number.MAX_VALUE,Y=function te(oe,ie,ne){var K=[],B=ne;return oe.children.forEachAt(ie,ne,function(G,X,se){k(G)?K.push(G):G instanceof f.default.Container&&(K=K.concat(te(G,X,B))),B-=se}),K};return Y(this,M,$)}},{key:"optimize",value:function(){var M=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],$=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.batch!==!0&&(l(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"optimize",this).call(this,M,$),M.length>0&&this.emitter.emit(y.default.events.SCROLL_OPTIMIZE,M,$))}},{key:"path",value:function(M){return l(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"path",this).call(this,M).slice(1)}},{key:"update",value:function(M){if(this.batch!==!0){var $=y.default.sources.USER;typeof M=="string"&&($=M),Array.isArray(M)||(M=this.observer.takeRecords()),M.length>0&&this.emitter.emit(y.default.events.SCROLL_BEFORE_UPDATE,$,M),l(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"update",this).call(this,M.concat([])),M.length>0&&this.emitter.emit(y.default.events.SCROLL_UPDATE,$,M)}}}]),P}(f.default.Scroll);D.blotName="scroll",D.className="ql-editor",D.tagName="DIV",D.defaultChild="block",D.allowedChildren=[_.default,g.BlockEmbed,R.default],n.default=D},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SHORTKEY=n.default=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Q){return typeof Q}:function(Q){return Q&&typeof Symbol=="function"&&Q.constructor===Symbol&&Q!==Symbol.prototype?"symbol":typeof Q},o=function(){function Q(ce,ue){var fe=[],_e=!0,Oe=!1,qe=void 0;try{for(var tt=ce[Symbol.iterator](),yt;!(_e=(yt=tt.next()).done)&&(fe.push(yt.value),!(ue&&fe.length===ue));_e=!0);}catch(At){Oe=!0,qe=At}finally{try{!_e&&tt.return&&tt.return()}finally{if(Oe)throw qe}}return fe}return function(ce,ue){if(Array.isArray(ce))return ce;if(Symbol.iterator in Object(ce))return Q(ce,ue);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function Q(ce,ue){for(var fe=0;fe<ue.length;fe++){var _e=ue[fe];_e.enumerable=_e.enumerable||!1,_e.configurable=!0,"value"in _e&&(_e.writable=!0),Object.defineProperty(ce,_e.key,_e)}}return function(ce,ue,fe){return ue&&Q(ce.prototype,ue),fe&&Q(ce,fe),ce}}(),d=i(21),f=O(d),m=i(11),y=O(m),g=i(3),_=O(g),E=i(2),x=O(E),b=i(20),T=O(b),N=i(0),R=O(N),I=i(5),j=O(I),U=i(10),C=O(U),k=i(9),D=O(k);function O(Q){return Q&&Q.__esModule?Q:{default:Q}}function P(Q,ce,ue){return ce in Q?Object.defineProperty(Q,ce,{value:ue,enumerable:!0,configurable:!0,writable:!0}):Q[ce]=ue,Q}function F(Q,ce){if(!(Q instanceof ce))throw new TypeError("Cannot call a class as a function")}function M(Q,ce){if(!Q)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return ce&&(typeof ce=="object"||typeof ce=="function")?ce:Q}function $(Q,ce){if(typeof ce!="function"&&ce!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof ce);Q.prototype=Object.create(ce&&ce.prototype,{constructor:{value:Q,enumerable:!1,writable:!0,configurable:!0}}),ce&&(Object.setPrototypeOf?Object.setPrototypeOf(Q,ce):Q.__proto__=ce)}var Y=(0,C.default)("quill:keyboard"),te=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",oe=function(Q){$(ce,Q),l(ce,null,[{key:"match",value:function(fe,_e){return _e=le(_e),["altKey","ctrlKey","metaKey","shiftKey"].some(function(Oe){return!!_e[Oe]!==fe[Oe]&&_e[Oe]!==null})?!1:_e.key===(fe.which||fe.keyCode)}}]);function ce(ue,fe){F(this,ce);var _e=M(this,(ce.__proto__||Object.getPrototypeOf(ce)).call(this,ue,fe));return _e.bindings={},Object.keys(_e.options.bindings).forEach(function(Oe){Oe==="list autofill"&&ue.scroll.whitelist!=null&&!ue.scroll.whitelist.list||_e.options.bindings[Oe]&&_e.addBinding(_e.options.bindings[Oe])}),_e.addBinding({key:ce.keys.ENTER,shiftKey:null},G),_e.addBinding({key:ce.keys.ENTER,metaKey:null,ctrlKey:null,altKey:null},function(){}),/Firefox/i.test(navigator.userAgent)?(_e.addBinding({key:ce.keys.BACKSPACE},{collapsed:!0},ne),_e.addBinding({key:ce.keys.DELETE},{collapsed:!0},K)):(_e.addBinding({key:ce.keys.BACKSPACE},{collapsed:!0,prefix:/^.?$/},ne),_e.addBinding({key:ce.keys.DELETE},{collapsed:!0,suffix:/^.?$/},K)),_e.addBinding({key:ce.keys.BACKSPACE},{collapsed:!1},B),_e.addBinding({key:ce.keys.DELETE},{collapsed:!1},B),_e.addBinding({key:ce.keys.BACKSPACE,altKey:null,ctrlKey:null,metaKey:null,shiftKey:null},{collapsed:!0,offset:0},ne),_e.listen(),_e}return l(ce,[{key:"addBinding",value:function(fe){var _e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Oe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},qe=le(fe);if(qe==null||qe.key==null)return Y.warn("Attempted to add invalid keyboard binding",qe);typeof _e=="function"&&(_e={handler:_e}),typeof Oe=="function"&&(Oe={handler:Oe}),qe=(0,_.default)(qe,_e,Oe),this.bindings[qe.key]=this.bindings[qe.key]||[],this.bindings[qe.key].push(qe)}},{key:"listen",value:function(){var fe=this;this.quill.root.addEventListener("keydown",function(_e){if(!_e.defaultPrevented){var Oe=_e.which||_e.keyCode,qe=(fe.bindings[Oe]||[]).filter(function(Ht){return ce.match(_e,Ht)});if(qe.length!==0){var tt=fe.quill.getSelection();if(!(tt==null||!fe.quill.hasFocus())){var yt=fe.quill.getLine(tt.index),At=o(yt,2),xn=At[0],Yt=At[1],Ae=fe.quill.getLeaf(tt.index),Ne=o(Ae,2),Le=Ne[0],ze=Ne[1],ke=tt.length===0?[Le,ze]:fe.quill.getLeaf(tt.index+tt.length),vt=o(ke,2),mt=vt[0],pt=vt[1],kt=Le instanceof R.default.Text?Le.value().slice(0,ze):"",Ot=mt instanceof R.default.Text?mt.value().slice(pt):"",Mt={collapsed:tt.length===0,empty:tt.length===0&&xn.length()<=1,format:fe.quill.getFormat(tt),offset:Yt,prefix:kt,suffix:Ot},ls=qe.some(function(Ht){if(Ht.collapsed!=null&&Ht.collapsed!==Mt.collapsed||Ht.empty!=null&&Ht.empty!==Mt.empty||Ht.offset!=null&&Ht.offset!==Mt.offset)return!1;if(Array.isArray(Ht.format)){if(Ht.format.every(function(Mn){return Mt.format[Mn]==null}))return!1}else if(s(Ht.format)==="object"&&!Object.keys(Ht.format).every(function(Mn){return Ht.format[Mn]===!0?Mt.format[Mn]!=null:Ht.format[Mn]===!1?Mt.format[Mn]==null:(0,y.default)(Ht.format[Mn],Mt.format[Mn])}))return!1;return Ht.prefix!=null&&!Ht.prefix.test(Mt.prefix)||Ht.suffix!=null&&!Ht.suffix.test(Mt.suffix)?!1:Ht.handler.call(fe,tt,Mt)!==!0});ls&&_e.preventDefault()}}}})}}]),ce}(D.default);oe.keys={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46},oe.DEFAULTS={bindings:{bold:se("bold"),italic:se("italic"),underline:se("underline"),indent:{key:oe.keys.TAB,format:["blockquote","indent","list"],handler:function(ce,ue){if(ue.collapsed&&ue.offset!==0)return!0;this.quill.format("indent","+1",j.default.sources.USER)}},outdent:{key:oe.keys.TAB,shiftKey:!0,format:["blockquote","indent","list"],handler:function(ce,ue){if(ue.collapsed&&ue.offset!==0)return!0;this.quill.format("indent","-1",j.default.sources.USER)}},"outdent backspace":{key:oe.keys.BACKSPACE,collapsed:!0,shiftKey:null,metaKey:null,ctrlKey:null,altKey:null,format:["indent","list"],offset:0,handler:function(ce,ue){ue.format.indent!=null?this.quill.format("indent","-1",j.default.sources.USER):ue.format.list!=null&&this.quill.format("list",!1,j.default.sources.USER)}},"indent code-block":X(!0),"outdent code-block":X(!1),"remove tab":{key:oe.keys.TAB,shiftKey:!0,collapsed:!0,prefix:/\t$/,handler:function(ce){this.quill.deleteText(ce.index-1,1,j.default.sources.USER)}},tab:{key:oe.keys.TAB,handler:function(ce){this.quill.history.cutoff();var ue=new x.default().retain(ce.index).delete(ce.length).insert("	");this.quill.updateContents(ue,j.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(ce.index+1,j.default.sources.SILENT)}},"list empty enter":{key:oe.keys.ENTER,collapsed:!0,format:["list"],empty:!0,handler:function(ce,ue){this.quill.format("list",!1,j.default.sources.USER),ue.format.indent&&this.quill.format("indent",!1,j.default.sources.USER)}},"checklist enter":{key:oe.keys.ENTER,collapsed:!0,format:{list:"checked"},handler:function(ce){var ue=this.quill.getLine(ce.index),fe=o(ue,2),_e=fe[0],Oe=fe[1],qe=(0,_.default)({},_e.formats(),{list:"checked"}),tt=new x.default().retain(ce.index).insert(`
`,qe).retain(_e.length()-Oe-1).retain(1,{list:"unchecked"});this.quill.updateContents(tt,j.default.sources.USER),this.quill.setSelection(ce.index+1,j.default.sources.SILENT),this.quill.scrollIntoView()}},"header enter":{key:oe.keys.ENTER,collapsed:!0,format:["header"],suffix:/^$/,handler:function(ce,ue){var fe=this.quill.getLine(ce.index),_e=o(fe,2),Oe=_e[0],qe=_e[1],tt=new x.default().retain(ce.index).insert(`
`,ue.format).retain(Oe.length()-qe-1).retain(1,{header:null});this.quill.updateContents(tt,j.default.sources.USER),this.quill.setSelection(ce.index+1,j.default.sources.SILENT),this.quill.scrollIntoView()}},"list autofill":{key:" ",collapsed:!0,format:{list:!1},prefix:/^\s*?(\d+\.|-|\*|\[ ?\]|\[x\])$/,handler:function(ce,ue){var fe=ue.prefix.length,_e=this.quill.getLine(ce.index),Oe=o(_e,2),qe=Oe[0],tt=Oe[1];if(tt>fe)return!0;var yt=void 0;switch(ue.prefix.trim()){case"[]":case"[ ]":yt="unchecked";break;case"[x]":yt="checked";break;case"-":case"*":yt="bullet";break;default:yt="ordered"}this.quill.insertText(ce.index," ",j.default.sources.USER),this.quill.history.cutoff();var At=new x.default().retain(ce.index-tt).delete(fe+1).retain(qe.length()-2-tt).retain(1,{list:yt});this.quill.updateContents(At,j.default.sources.USER),this.quill.history.cutoff(),this.quill.setSelection(ce.index-fe,j.default.sources.SILENT)}},"code exit":{key:oe.keys.ENTER,collapsed:!0,format:["code-block"],prefix:/\n\n$/,suffix:/^\s+$/,handler:function(ce){var ue=this.quill.getLine(ce.index),fe=o(ue,2),_e=fe[0],Oe=fe[1],qe=new x.default().retain(ce.index+_e.length()-Oe-2).retain(1,{"code-block":null}).delete(1);this.quill.updateContents(qe,j.default.sources.USER)}},"embed left":ie(oe.keys.LEFT,!1),"embed left shift":ie(oe.keys.LEFT,!0),"embed right":ie(oe.keys.RIGHT,!1),"embed right shift":ie(oe.keys.RIGHT,!0)}};function ie(Q,ce){var ue,fe=Q===oe.keys.LEFT?"prefix":"suffix";return ue={key:Q,shiftKey:ce,altKey:null},P(ue,fe,/^$/),P(ue,"handler",function(Oe){var qe=Oe.index;Q===oe.keys.RIGHT&&(qe+=Oe.length+1);var tt=this.quill.getLeaf(qe),yt=o(tt,1),At=yt[0];return At instanceof R.default.Embed?(Q===oe.keys.LEFT?ce?this.quill.setSelection(Oe.index-1,Oe.length+1,j.default.sources.USER):this.quill.setSelection(Oe.index-1,j.default.sources.USER):ce?this.quill.setSelection(Oe.index,Oe.length+1,j.default.sources.USER):this.quill.setSelection(Oe.index+Oe.length+1,j.default.sources.USER),!1):!0}),ue}function ne(Q,ce){if(!(Q.index===0||this.quill.getLength()<=1)){var ue=this.quill.getLine(Q.index),fe=o(ue,1),_e=fe[0],Oe={};if(ce.offset===0){var qe=this.quill.getLine(Q.index-1),tt=o(qe,1),yt=tt[0];if(yt!=null&&yt.length()>1){var At=_e.formats(),xn=this.quill.getFormat(Q.index-1,1);Oe=T.default.attributes.diff(At,xn)||{}}}var Yt=/[\uD800-\uDBFF][\uDC00-\uDFFF]$/.test(ce.prefix)?2:1;this.quill.deleteText(Q.index-Yt,Yt,j.default.sources.USER),Object.keys(Oe).length>0&&this.quill.formatLine(Q.index-Yt,Yt,Oe,j.default.sources.USER),this.quill.focus()}}function K(Q,ce){var ue=/^[\uD800-\uDBFF][\uDC00-\uDFFF]/.test(ce.suffix)?2:1;if(!(Q.index>=this.quill.getLength()-ue)){var fe={},_e=0,Oe=this.quill.getLine(Q.index),qe=o(Oe,1),tt=qe[0];if(ce.offset>=tt.length()-1){var yt=this.quill.getLine(Q.index+1),At=o(yt,1),xn=At[0];if(xn){var Yt=tt.formats(),Ae=this.quill.getFormat(Q.index,1);fe=T.default.attributes.diff(Yt,Ae)||{},_e=xn.length()}}this.quill.deleteText(Q.index,ue,j.default.sources.USER),Object.keys(fe).length>0&&this.quill.formatLine(Q.index+_e-1,ue,fe,j.default.sources.USER)}}function B(Q){var ce=this.quill.getLines(Q),ue={};if(ce.length>1){var fe=ce[0].formats(),_e=ce[ce.length-1].formats();ue=T.default.attributes.diff(_e,fe)||{}}this.quill.deleteText(Q,j.default.sources.USER),Object.keys(ue).length>0&&this.quill.formatLine(Q.index,1,ue,j.default.sources.USER),this.quill.setSelection(Q.index,j.default.sources.SILENT),this.quill.focus()}function G(Q,ce){var ue=this;Q.length>0&&this.quill.scroll.deleteAt(Q.index,Q.length);var fe=Object.keys(ce.format).reduce(function(_e,Oe){return R.default.query(Oe,R.default.Scope.BLOCK)&&!Array.isArray(ce.format[Oe])&&(_e[Oe]=ce.format[Oe]),_e},{});this.quill.insertText(Q.index,`
`,fe,j.default.sources.USER),this.quill.setSelection(Q.index+1,j.default.sources.SILENT),this.quill.focus(),Object.keys(ce.format).forEach(function(_e){fe[_e]==null&&(Array.isArray(ce.format[_e])||_e!=="link"&&ue.quill.format(_e,ce.format[_e],j.default.sources.USER))})}function X(Q){return{key:oe.keys.TAB,shiftKey:!Q,format:{"code-block":!0},handler:function(ue){var fe=R.default.query("code-block"),_e=ue.index,Oe=ue.length,qe=this.quill.scroll.descendant(fe,_e),tt=o(qe,2),yt=tt[0],At=tt[1];if(yt!=null){var xn=this.quill.getIndex(yt),Yt=yt.newlineIndex(At,!0)+1,Ae=yt.newlineIndex(xn+At+Oe),Ne=yt.domNode.textContent.slice(Yt,Ae).split(`
`);At=0,Ne.forEach(function(Le,ze){Q?(yt.insertAt(Yt+At,fe.TAB),At+=fe.TAB.length,ze===0?_e+=fe.TAB.length:Oe+=fe.TAB.length):Le.startsWith(fe.TAB)&&(yt.deleteAt(Yt+At,fe.TAB.length),At-=fe.TAB.length,ze===0?_e-=fe.TAB.length:Oe-=fe.TAB.length),At+=Le.length+1}),this.quill.update(j.default.sources.USER),this.quill.setSelection(_e,Oe,j.default.sources.SILENT)}}}}function se(Q){return{key:Q[0].toUpperCase(),shortKey:!0,handler:function(ue,fe){this.quill.format(Q,!fe.format[Q],j.default.sources.USER)}}}function le(Q){if(typeof Q=="string"||typeof Q=="number")return le({key:Q});if((typeof Q>"u"?"undefined":s(Q))==="object"&&(Q=(0,f.default)(Q,!1)),typeof Q.key=="string")if(oe.keys[Q.key.toUpperCase()]!=null)Q.key=oe.keys[Q.key.toUpperCase()];else if(Q.key.length===1)Q.key=Q.key.toUpperCase().charCodeAt(0);else return null;return Q.shortKey&&(Q[te]=Q.shortKey,delete Q.shortKey),Q}n.default=oe,n.SHORTKEY=te},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function T(N,R){var I=[],j=!0,U=!1,C=void 0;try{for(var k=N[Symbol.iterator](),D;!(j=(D=k.next()).done)&&(I.push(D.value),!(R&&I.length===R));j=!0);}catch(O){U=!0,C=O}finally{try{!j&&k.return&&k.return()}finally{if(U)throw C}}return I}return function(N,R){if(Array.isArray(N))return N;if(Symbol.iterator in Object(N))return T(N,R);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function T(N,R,I){N===null&&(N=Function.prototype);var j=Object.getOwnPropertyDescriptor(N,R);if(j===void 0){var U=Object.getPrototypeOf(N);return U===null?void 0:T(U,R,I)}else{if("value"in j)return j.value;var C=j.get;return C===void 0?void 0:C.call(I)}},l=function(){function T(N,R){for(var I=0;I<R.length;I++){var j=R[I];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(N,j.key,j)}}return function(N,R,I){return R&&T(N.prototype,R),I&&T(N,I),N}}(),d=i(0),f=g(d),m=i(7),y=g(m);function g(T){return T&&T.__esModule?T:{default:T}}function _(T,N){if(!(T instanceof N))throw new TypeError("Cannot call a class as a function")}function E(T,N){if(!T)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:T}function x(T,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);T.prototype=Object.create(N&&N.prototype,{constructor:{value:T,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(T,N):T.__proto__=N)}var b=function(T){x(N,T),l(N,null,[{key:"value",value:function(){}}]);function N(R,I){_(this,N);var j=E(this,(N.__proto__||Object.getPrototypeOf(N)).call(this,R));return j.selection=I,j.textNode=document.createTextNode(N.CONTENTS),j.domNode.appendChild(j.textNode),j._length=0,j}return l(N,[{key:"detach",value:function(){this.parent!=null&&this.parent.removeChild(this)}},{key:"format",value:function(I,j){if(this._length!==0)return o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"format",this).call(this,I,j);for(var U=this,C=0;U!=null&&U.statics.scope!==f.default.Scope.BLOCK_BLOT;)C+=U.offset(U.parent),U=U.parent;U!=null&&(this._length=N.CONTENTS.length,U.optimize(),U.formatAt(C,N.CONTENTS.length,I,j),this._length=0)}},{key:"index",value:function(I,j){return I===this.textNode?0:o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"index",this).call(this,I,j)}},{key:"length",value:function(){return this._length}},{key:"position",value:function(){return[this.textNode,this.textNode.data.length]}},{key:"remove",value:function(){o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"remove",this).call(this),this.parent=null}},{key:"restore",value:function(){if(!(this.selection.composing||this.parent==null)){var I=this.textNode,j=this.selection.getNativeRange(),U=void 0,C=void 0,k=void 0;if(j!=null&&j.start.node===I&&j.end.node===I){var D=[I,j.start.offset,j.end.offset];U=D[0],C=D[1],k=D[2]}for(;this.domNode.lastChild!=null&&this.domNode.lastChild!==this.textNode;)this.domNode.parentNode.insertBefore(this.domNode.lastChild,this.domNode);if(this.textNode.data!==N.CONTENTS){var O=this.textNode.data.split(N.CONTENTS).join("");this.next instanceof y.default?(U=this.next.domNode,this.next.insertAt(0,O),this.textNode.data=N.CONTENTS):(this.textNode.data=O,this.parent.insertBefore(f.default.create(this.textNode),this),this.textNode=document.createTextNode(N.CONTENTS),this.domNode.appendChild(this.textNode))}if(this.remove(),C!=null){var P=[C,k].map(function(M){return Math.max(0,Math.min(U.data.length,M-1))}),F=s(P,2);return C=F[0],k=F[1],{startNode:U,startOffset:C,endNode:U,endOffset:k}}}}},{key:"update",value:function(I,j){var U=this;if(I.some(function(k){return k.type==="characterData"&&k.target===U.textNode})){var C=this.restore();C&&(j.range=C)}}},{key:"value",value:function(){return""}}]),N}(f.default.Embed);b.blotName="cursor",b.className="ql-cursor",b.tagName="span",b.CONTENTS="\uFEFF",n.default=b},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(0),o=f(s),l=i(4),d=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function y(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var _=function(E){g(x,E);function x(){return m(this,x),y(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return x}(o.default.Container);_.allowedChildren=[d.default,l.BlockEmbed,_],n.default=_},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.ColorStyle=n.ColorClass=n.ColorAttributor=void 0;var s=function(){function b(T,N){for(var R=0;R<N.length;R++){var I=N[R];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(T,I.key,I)}}return function(T,N,R){return N&&b(T.prototype,N),R&&b(T,R),T}}(),o=function b(T,N,R){T===null&&(T=Function.prototype);var I=Object.getOwnPropertyDescriptor(T,N);if(I===void 0){var j=Object.getPrototypeOf(T);return j===null?void 0:b(j,N,R)}else{if("value"in I)return I.value;var U=I.get;return U===void 0?void 0:U.call(R)}},l=i(0),d=f(l);function f(b){return b&&b.__esModule?b:{default:b}}function m(b,T){if(!(b instanceof T))throw new TypeError("Cannot call a class as a function")}function y(b,T){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T&&(typeof T=="object"||typeof T=="function")?T:b}function g(b,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof T);b.prototype=Object.create(T&&T.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(b,T):b.__proto__=T)}var _=function(b){g(T,b);function T(){return m(this,T),y(this,(T.__proto__||Object.getPrototypeOf(T)).apply(this,arguments))}return s(T,[{key:"value",value:function(R){var I=o(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"value",this).call(this,R);return I.startsWith("rgb(")?(I=I.replace(/^[^\d]+/,"").replace(/[^\d]+$/,""),"#"+I.split(",").map(function(j){return("00"+parseInt(j).toString(16)).slice(-2)}).join("")):I}}]),T}(d.default.Attributor.Style),E=new d.default.Attributor.Class("color","ql-color",{scope:d.default.Scope.INLINE}),x=new _("color","color",{scope:d.default.Scope.INLINE});n.ColorAttributor=_,n.ColorClass=E,n.ColorStyle=x},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.sanitize=n.default=void 0;var s=function(){function x(b,T){for(var N=0;N<T.length;N++){var R=T[N];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(b,R.key,R)}}return function(b,T,N){return T&&x(b.prototype,T),N&&x(b,N),b}}(),o=function x(b,T,N){b===null&&(b=Function.prototype);var R=Object.getOwnPropertyDescriptor(b,T);if(R===void 0){var I=Object.getPrototypeOf(b);return I===null?void 0:x(I,T,N)}else{if("value"in R)return R.value;var j=R.get;return j===void 0?void 0:j.call(N)}},l=i(6),d=f(l);function f(x){return x&&x.__esModule?x:{default:x}}function m(x,b){if(!(x instanceof b))throw new TypeError("Cannot call a class as a function")}function y(x,b){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:x}function g(x,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);x.prototype=Object.create(b&&b.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(x,b):x.__proto__=b)}var _=function(x){g(b,x);function b(){return m(this,b),y(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return s(b,[{key:"format",value:function(N,R){if(N!==this.statics.blotName||!R)return o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"format",this).call(this,N,R);R=this.constructor.sanitize(R),this.domNode.setAttribute("href",R)}}],[{key:"create",value:function(N){var R=o(b.__proto__||Object.getPrototypeOf(b),"create",this).call(this,N);return N=this.sanitize(N),R.setAttribute("href",N),R.setAttribute("rel","noopener noreferrer"),R.setAttribute("target","_blank"),R}},{key:"formats",value:function(N){return N.getAttribute("href")}},{key:"sanitize",value:function(N){return E(N,this.PROTOCOL_WHITELIST)?N:this.SANITIZED_URL}}]),b}(d.default);_.blotName="link",_.tagName="A",_.SANITIZED_URL="about:blank",_.PROTOCOL_WHITELIST=["http","https","mailto","tel"];function E(x,b){var T=document.createElement("a");T.href=x;var N=T.href.slice(0,T.href.indexOf(":"));return b.indexOf(N)>-1}n.default=_,n.sanitize=E},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(b){return typeof b}:function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},o=function(){function b(T,N){for(var R=0;R<N.length;R++){var I=N[R];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(T,I.key,I)}}return function(T,N,R){return N&&b(T.prototype,N),R&&b(T,R),T}}(),l=i(23),d=y(l),f=i(107),m=y(f);function y(b){return b&&b.__esModule?b:{default:b}}function g(b,T){if(!(b instanceof T))throw new TypeError("Cannot call a class as a function")}var _=0;function E(b,T){b.setAttribute(T,b.getAttribute(T)!=="true")}var x=function(){function b(T){var N=this;g(this,b),this.select=T,this.container=document.createElement("span"),this.buildPicker(),this.select.style.display="none",this.select.parentNode.insertBefore(this.container,this.select),this.label.addEventListener("mousedown",function(){N.togglePicker()}),this.label.addEventListener("keydown",function(R){switch(R.keyCode){case d.default.keys.ENTER:N.togglePicker();break;case d.default.keys.ESCAPE:N.escape(),R.preventDefault();break}}),this.select.addEventListener("change",this.update.bind(this))}return o(b,[{key:"togglePicker",value:function(){this.container.classList.toggle("ql-expanded"),E(this.label,"aria-expanded"),E(this.options,"aria-hidden")}},{key:"buildItem",value:function(N){var R=this,I=document.createElement("span");return I.tabIndex="0",I.setAttribute("role","button"),I.classList.add("ql-picker-item"),N.hasAttribute("value")&&I.setAttribute("data-value",N.getAttribute("value")),N.textContent&&I.setAttribute("data-label",N.textContent),I.addEventListener("click",function(){R.selectItem(I,!0)}),I.addEventListener("keydown",function(j){switch(j.keyCode){case d.default.keys.ENTER:R.selectItem(I,!0),j.preventDefault();break;case d.default.keys.ESCAPE:R.escape(),j.preventDefault();break}}),I}},{key:"buildLabel",value:function(){var N=document.createElement("span");return N.classList.add("ql-picker-label"),N.innerHTML=m.default,N.tabIndex="0",N.setAttribute("role","button"),N.setAttribute("aria-expanded","false"),this.container.appendChild(N),N}},{key:"buildOptions",value:function(){var N=this,R=document.createElement("span");R.classList.add("ql-picker-options"),R.setAttribute("aria-hidden","true"),R.tabIndex="-1",R.id="ql-picker-options-"+_,_+=1,this.label.setAttribute("aria-controls",R.id),this.options=R,[].slice.call(this.select.options).forEach(function(I){var j=N.buildItem(I);R.appendChild(j),I.selected===!0&&N.selectItem(j)}),this.container.appendChild(R)}},{key:"buildPicker",value:function(){var N=this;[].slice.call(this.select.attributes).forEach(function(R){N.container.setAttribute(R.name,R.value)}),this.container.classList.add("ql-picker"),this.label=this.buildLabel(),this.buildOptions()}},{key:"escape",value:function(){var N=this;this.close(),setTimeout(function(){return N.label.focus()},1)}},{key:"close",value:function(){this.container.classList.remove("ql-expanded"),this.label.setAttribute("aria-expanded","false"),this.options.setAttribute("aria-hidden","true")}},{key:"selectItem",value:function(N){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,I=this.container.querySelector(".ql-selected");if(N!==I&&(I!=null&&I.classList.remove("ql-selected"),N!=null&&(N.classList.add("ql-selected"),this.select.selectedIndex=[].indexOf.call(N.parentNode.children,N),N.hasAttribute("data-value")?this.label.setAttribute("data-value",N.getAttribute("data-value")):this.label.removeAttribute("data-value"),N.hasAttribute("data-label")?this.label.setAttribute("data-label",N.getAttribute("data-label")):this.label.removeAttribute("data-label"),R))){if(typeof Event=="function")this.select.dispatchEvent(new Event("change"));else if((typeof Event>"u"?"undefined":s(Event))==="object"){var j=document.createEvent("Event");j.initEvent("change",!0,!0),this.select.dispatchEvent(j)}this.close()}}},{key:"update",value:function(){var N=void 0;if(this.select.selectedIndex>-1){var R=this.container.querySelector(".ql-picker-options").children[this.select.selectedIndex];N=this.select.options[this.select.selectedIndex],this.selectItem(R)}else this.selectItem(null);var I=N!=null&&N!==this.select.querySelector("option[selected]");this.label.classList.toggle("ql-active",I)}}]),b}();n.default=x},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(0),o=Y(s),l=i(5),d=Y(l),f=i(4),m=Y(f),y=i(16),g=Y(y),_=i(25),E=Y(_),x=i(24),b=Y(x),T=i(35),N=Y(T),R=i(6),I=Y(R),j=i(22),U=Y(j),C=i(7),k=Y(C),D=i(55),O=Y(D),P=i(42),F=Y(P),M=i(23),$=Y(M);function Y(te){return te&&te.__esModule?te:{default:te}}d.default.register({"blots/block":m.default,"blots/block/embed":f.BlockEmbed,"blots/break":g.default,"blots/container":E.default,"blots/cursor":b.default,"blots/embed":N.default,"blots/inline":I.default,"blots/scroll":U.default,"blots/text":k.default,"modules/clipboard":O.default,"modules/history":F.default,"modules/keyboard":$.default}),o.default.register(m.default,g.default,b.default,I.default,U.default,k.default),n.default=d.default},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(1),o=function(){function l(d){this.domNode=d,this.domNode[s.DATA_KEY]={blot:this}}return Object.defineProperty(l.prototype,"statics",{get:function(){return this.constructor},enumerable:!0,configurable:!0}),l.create=function(d){if(this.tagName==null)throw new s.ParchmentError("Blot definition missing tagName");var f;return Array.isArray(this.tagName)?(typeof d=="string"&&(d=d.toUpperCase(),parseInt(d).toString()===d&&(d=parseInt(d))),typeof d=="number"?f=document.createElement(this.tagName[d-1]):this.tagName.indexOf(d)>-1?f=document.createElement(d):f=document.createElement(this.tagName[0])):f=document.createElement(this.tagName),this.className&&f.classList.add(this.className),f},l.prototype.attach=function(){this.parent!=null&&(this.scroll=this.parent.scroll)},l.prototype.clone=function(){var d=this.domNode.cloneNode(!1);return s.create(d)},l.prototype.detach=function(){this.parent!=null&&this.parent.removeChild(this),delete this.domNode[s.DATA_KEY]},l.prototype.deleteAt=function(d,f){var m=this.isolate(d,f);m.remove()},l.prototype.formatAt=function(d,f,m,y){var g=this.isolate(d,f);if(s.query(m,s.Scope.BLOT)!=null&&y)g.wrap(m,y);else if(s.query(m,s.Scope.ATTRIBUTE)!=null){var _=s.create(this.statics.scope);g.wrap(_),_.format(m,y)}},l.prototype.insertAt=function(d,f,m){var y=m==null?s.create("text",f):s.create(f,m),g=this.split(d);this.parent.insertBefore(y,g)},l.prototype.insertInto=function(d,f){f===void 0&&(f=null),this.parent!=null&&this.parent.children.remove(this);var m=null;d.children.insertBefore(this,f),f!=null&&(m=f.domNode),(this.domNode.parentNode!=d.domNode||this.domNode.nextSibling!=m)&&d.domNode.insertBefore(this.domNode,m),this.parent=d,this.attach()},l.prototype.isolate=function(d,f){var m=this.split(d);return m.split(f),m},l.prototype.length=function(){return 1},l.prototype.offset=function(d){return d===void 0&&(d=this.parent),this.parent==null||this==d?0:this.parent.children.offset(this)+this.parent.offset(d)},l.prototype.optimize=function(d){this.domNode[s.DATA_KEY]!=null&&delete this.domNode[s.DATA_KEY].mutations},l.prototype.remove=function(){this.domNode.parentNode!=null&&this.domNode.parentNode.removeChild(this.domNode),this.detach()},l.prototype.replace=function(d){d.parent!=null&&(d.parent.insertBefore(this,d.next),d.remove())},l.prototype.replaceWith=function(d,f){var m=typeof d=="string"?s.create(d,f):d;return m.replace(this),m},l.prototype.split=function(d,f){return d===0?this:this.next},l.prototype.update=function(d,f){},l.prototype.wrap=function(d,f){var m=typeof d=="string"?s.create(d,f):d;return this.parent!=null&&this.parent.insertBefore(m,this.next),m.appendChild(this),m},l.blotName="abstract",l}();n.default=o},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(12),o=i(32),l=i(33),d=i(1),f=function(){function m(y){this.attributes={},this.domNode=y,this.build()}return m.prototype.attribute=function(y,g){g?y.add(this.domNode,g)&&(y.value(this.domNode)!=null?this.attributes[y.attrName]=y:delete this.attributes[y.attrName]):(y.remove(this.domNode),delete this.attributes[y.attrName])},m.prototype.build=function(){var y=this;this.attributes={};var g=s.default.keys(this.domNode),_=o.default.keys(this.domNode),E=l.default.keys(this.domNode);g.concat(_).concat(E).forEach(function(x){var b=d.query(x,d.Scope.ATTRIBUTE);b instanceof s.default&&(y.attributes[b.attrName]=b)})},m.prototype.copy=function(y){var g=this;Object.keys(this.attributes).forEach(function(_){var E=g.attributes[_].value(g.domNode);y.format(_,E)})},m.prototype.move=function(y){var g=this;this.copy(y),Object.keys(this.attributes).forEach(function(_){g.attributes[_].remove(g.domNode)}),this.attributes={}},m.prototype.values=function(){var y=this;return Object.keys(this.attributes).reduce(function(g,_){return g[_]=y.attributes[_].value(y.domNode),g},{})},m}();n.default=f},function(t,n,i){var s=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var g in y)y.hasOwnProperty(g)&&(m[g]=y[g])};return function(m,y){f(m,y);function g(){this.constructor=m}m.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12);function l(f,m){var y=f.getAttribute("class")||"";return y.split(/\s+/).filter(function(g){return g.indexOf(m+"-")===0})}var d=function(f){s(m,f);function m(){return f!==null&&f.apply(this,arguments)||this}return m.keys=function(y){return(y.getAttribute("class")||"").split(/\s+/).map(function(g){return g.split("-").slice(0,-1).join("-")})},m.prototype.add=function(y,g){return this.canAdd(y,g)?(this.remove(y),y.classList.add(this.keyName+"-"+g),!0):!1},m.prototype.remove=function(y){var g=l(y,this.keyName);g.forEach(function(_){y.classList.remove(_)}),y.classList.length===0&&y.removeAttribute("class")},m.prototype.value=function(y){var g=l(y,this.keyName)[0]||"",_=g.slice(this.keyName.length+1);return this.canAdd(y,_)?_:""},m}(o.default);n.default=d},function(t,n,i){var s=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var g in y)y.hasOwnProperty(g)&&(m[g]=y[g])};return function(m,y){f(m,y);function g(){this.constructor=m}m.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(12);function l(f){var m=f.split("-"),y=m.slice(1).map(function(g){return g[0].toUpperCase()+g.slice(1)}).join("");return m[0]+y}var d=function(f){s(m,f);function m(){return f!==null&&f.apply(this,arguments)||this}return m.keys=function(y){return(y.getAttribute("style")||"").split(";").map(function(g){var _=g.split(":");return _[0].trim()})},m.prototype.add=function(y,g){return this.canAdd(y,g)?(y.style[l(this.keyName)]=g,!0):!1},m.prototype.remove=function(y){y.style[l(this.keyName)]="",y.getAttribute("style")||y.removeAttribute("style")},m.prototype.value=function(y){var g=y.style[l(this.keyName)];return this.canAdd(y,g)?g:""},m}(o.default);n.default=d},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function d(f,m){for(var y=0;y<m.length;y++){var g=m[y];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(f,m,y){return m&&d(f.prototype,m),y&&d(f,y),f}}();function o(d,f){if(!(d instanceof f))throw new TypeError("Cannot call a class as a function")}var l=function(){function d(f,m){o(this,d),this.quill=f,this.options=m,this.modules={}}return s(d,[{key:"init",value:function(){var m=this;Object.keys(this.options.modules).forEach(function(y){m.modules[y]==null&&m.addModule(y)})}},{key:"addModule",value:function(m){var y=this.quill.constructor.import("modules/"+m);return this.modules[m]=new y(this.quill,this.options.modules[m]||{}),this.modules[m]}}]),d}();l.DEFAULTS={modules:{}},l.themes={default:l},n.default=l},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function T(N,R){for(var I=0;I<R.length;I++){var j=R[I];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(N,j.key,j)}}return function(N,R,I){return R&&T(N.prototype,R),I&&T(N,I),N}}(),o=function T(N,R,I){N===null&&(N=Function.prototype);var j=Object.getOwnPropertyDescriptor(N,R);if(j===void 0){var U=Object.getPrototypeOf(N);return U===null?void 0:T(U,R,I)}else{if("value"in j)return j.value;var C=j.get;return C===void 0?void 0:C.call(I)}},l=i(0),d=y(l),f=i(7),m=y(f);function y(T){return T&&T.__esModule?T:{default:T}}function g(T,N){if(!(T instanceof N))throw new TypeError("Cannot call a class as a function")}function _(T,N){if(!T)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:T}function E(T,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);T.prototype=Object.create(N&&N.prototype,{constructor:{value:T,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(T,N):T.__proto__=N)}var x="\uFEFF",b=function(T){E(N,T);function N(R){g(this,N);var I=_(this,(N.__proto__||Object.getPrototypeOf(N)).call(this,R));return I.contentNode=document.createElement("span"),I.contentNode.setAttribute("contenteditable",!1),[].slice.call(I.domNode.childNodes).forEach(function(j){I.contentNode.appendChild(j)}),I.leftGuard=document.createTextNode(x),I.rightGuard=document.createTextNode(x),I.domNode.appendChild(I.leftGuard),I.domNode.appendChild(I.contentNode),I.domNode.appendChild(I.rightGuard),I}return s(N,[{key:"index",value:function(I,j){return I===this.leftGuard?0:I===this.rightGuard?1:o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"index",this).call(this,I,j)}},{key:"restore",value:function(I){var j=void 0,U=void 0,C=I.data.split(x).join("");if(I===this.leftGuard)if(this.prev instanceof m.default){var k=this.prev.length();this.prev.insertAt(k,C),j={startNode:this.prev.domNode,startOffset:k+C.length}}else U=document.createTextNode(C),this.parent.insertBefore(d.default.create(U),this),j={startNode:U,startOffset:C.length};else I===this.rightGuard&&(this.next instanceof m.default?(this.next.insertAt(0,C),j={startNode:this.next.domNode,startOffset:C.length}):(U=document.createTextNode(C),this.parent.insertBefore(d.default.create(U),this.next),j={startNode:U,startOffset:C.length}));return I.data=x,j}},{key:"update",value:function(I,j){var U=this;I.forEach(function(C){if(C.type==="characterData"&&(C.target===U.leftGuard||C.target===U.rightGuard)){var k=U.restore(C.target);k&&(j.range=k)}})}}]),N}(d.default.Embed);n.default=b},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.AlignStyle=n.AlignClass=n.AlignAttribute=void 0;var s=i(0),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}var d={scope:o.default.Scope.BLOCK,whitelist:["right","center","justify"]},f=new o.default.Attributor.Attribute("align","align",d),m=new o.default.Attributor.Class("align","ql-align",d),y=new o.default.Attributor.Style("align","text-align",d);n.AlignAttribute=f,n.AlignClass=m,n.AlignStyle=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.BackgroundStyle=n.BackgroundClass=void 0;var s=i(0),o=d(s),l=i(26);function d(y){return y&&y.__esModule?y:{default:y}}var f=new o.default.Attributor.Class("background","ql-bg",{scope:o.default.Scope.INLINE}),m=new l.ColorAttributor("background","background-color",{scope:o.default.Scope.INLINE});n.BackgroundClass=f,n.BackgroundStyle=m},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.DirectionStyle=n.DirectionClass=n.DirectionAttribute=void 0;var s=i(0),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}var d={scope:o.default.Scope.BLOCK,whitelist:["rtl"]},f=new o.default.Attributor.Attribute("direction","dir",d),m=new o.default.Attributor.Class("direction","ql-direction",d),y=new o.default.Attributor.Style("direction","direction",d);n.DirectionAttribute=f,n.DirectionClass=m,n.DirectionStyle=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.FontClass=n.FontStyle=void 0;var s=function(){function T(N,R){for(var I=0;I<R.length;I++){var j=R[I];j.enumerable=j.enumerable||!1,j.configurable=!0,"value"in j&&(j.writable=!0),Object.defineProperty(N,j.key,j)}}return function(N,R,I){return R&&T(N.prototype,R),I&&T(N,I),N}}(),o=function T(N,R,I){N===null&&(N=Function.prototype);var j=Object.getOwnPropertyDescriptor(N,R);if(j===void 0){var U=Object.getPrototypeOf(N);return U===null?void 0:T(U,R,I)}else{if("value"in j)return j.value;var C=j.get;return C===void 0?void 0:C.call(I)}},l=i(0),d=f(l);function f(T){return T&&T.__esModule?T:{default:T}}function m(T,N){if(!(T instanceof N))throw new TypeError("Cannot call a class as a function")}function y(T,N){if(!T)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return N&&(typeof N=="object"||typeof N=="function")?N:T}function g(T,N){if(typeof N!="function"&&N!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof N);T.prototype=Object.create(N&&N.prototype,{constructor:{value:T,enumerable:!1,writable:!0,configurable:!0}}),N&&(Object.setPrototypeOf?Object.setPrototypeOf(T,N):T.__proto__=N)}var _={scope:d.default.Scope.INLINE,whitelist:["serif","monospace"]},E=new d.default.Attributor.Class("font","ql-font",_),x=function(T){g(N,T);function N(){return m(this,N),y(this,(N.__proto__||Object.getPrototypeOf(N)).apply(this,arguments))}return s(N,[{key:"value",value:function(I){return o(N.prototype.__proto__||Object.getPrototypeOf(N.prototype),"value",this).call(this,I).replace(/["']/g,"")}}]),N}(d.default.Attributor.Style),b=new x("font","font-family",_);n.FontStyle=b,n.FontClass=E},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.SizeStyle=n.SizeClass=void 0;var s=i(0),o=l(s);function l(m){return m&&m.__esModule?m:{default:m}}var d=new o.default.Attributor.Class("size","ql-size",{scope:o.default.Scope.INLINE,whitelist:["small","large","huge"]}),f=new o.default.Attributor.Style("size","font-size",{scope:o.default.Scope.INLINE,whitelist:["10px","18px","32px"]});n.SizeClass=d,n.SizeStyle=f},function(t,n,i){t.exports={align:{"":i(76),center:i(77),right:i(78),justify:i(79)},background:i(80),blockquote:i(81),bold:i(82),clean:i(83),code:i(58),"code-block":i(58),color:i(84),direction:{"":i(85),rtl:i(86)},float:{center:i(87),full:i(88),left:i(89),right:i(90)},formula:i(91),header:{1:i(92),2:i(93)},italic:i(94),image:i(95),indent:{"+1":i(96),"-1":i(97)},link:i(98),list:{ordered:i(99),bullet:i(100),check:i(101)},script:{sub:i(102),super:i(103)},strike:i(104),underline:i(105),video:i(106)}},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.getLastChangeIndex=n.default=void 0;var s=function(){function R(I,j){for(var U=0;U<j.length;U++){var C=j[U];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(I,C.key,C)}}return function(I,j,U){return j&&R(I.prototype,j),U&&R(I,U),I}}(),o=i(0),l=g(o),d=i(5),f=g(d),m=i(9),y=g(m);function g(R){return R&&R.__esModule?R:{default:R}}function _(R,I){if(!(R instanceof I))throw new TypeError("Cannot call a class as a function")}function E(R,I){if(!R)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I&&(typeof I=="object"||typeof I=="function")?I:R}function x(R,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof I);R.prototype=Object.create(I&&I.prototype,{constructor:{value:R,enumerable:!1,writable:!0,configurable:!0}}),I&&(Object.setPrototypeOf?Object.setPrototypeOf(R,I):R.__proto__=I)}var b=function(R){x(I,R);function I(j,U){_(this,I);var C=E(this,(I.__proto__||Object.getPrototypeOf(I)).call(this,j,U));return C.lastRecorded=0,C.ignoreChange=!1,C.clear(),C.quill.on(f.default.events.EDITOR_CHANGE,function(k,D,O,P){k!==f.default.events.TEXT_CHANGE||C.ignoreChange||(!C.options.userOnly||P===f.default.sources.USER?C.record(D,O):C.transform(D))}),C.quill.keyboard.addBinding({key:"Z",shortKey:!0},C.undo.bind(C)),C.quill.keyboard.addBinding({key:"Z",shortKey:!0,shiftKey:!0},C.redo.bind(C)),/Win/i.test(navigator.platform)&&C.quill.keyboard.addBinding({key:"Y",shortKey:!0},C.redo.bind(C)),C}return s(I,[{key:"change",value:function(U,C){if(this.stack[U].length!==0){var k=this.stack[U].pop();this.stack[C].push(k),this.lastRecorded=0,this.ignoreChange=!0,this.quill.updateContents(k[U],f.default.sources.USER),this.ignoreChange=!1;var D=N(k[U]);this.quill.setSelection(D)}}},{key:"clear",value:function(){this.stack={undo:[],redo:[]}}},{key:"cutoff",value:function(){this.lastRecorded=0}},{key:"record",value:function(U,C){if(U.ops.length!==0){this.stack.redo=[];var k=this.quill.getContents().diff(C),D=Date.now();if(this.lastRecorded+this.options.delay>D&&this.stack.undo.length>0){var O=this.stack.undo.pop();k=k.compose(O.undo),U=O.redo.compose(U)}else this.lastRecorded=D;this.stack.undo.push({redo:U,undo:k}),this.stack.undo.length>this.options.maxStack&&this.stack.undo.shift()}}},{key:"redo",value:function(){this.change("redo","undo")}},{key:"transform",value:function(U){this.stack.undo.forEach(function(C){C.undo=U.transform(C.undo,!0),C.redo=U.transform(C.redo,!0)}),this.stack.redo.forEach(function(C){C.undo=U.transform(C.undo,!0),C.redo=U.transform(C.redo,!0)})}},{key:"undo",value:function(){this.change("undo","redo")}}]),I}(y.default);b.DEFAULTS={delay:1e3,maxStack:100,userOnly:!1};function T(R){var I=R.ops[R.ops.length-1];return I==null?!1:I.insert!=null?typeof I.insert=="string"&&I.insert.endsWith(`
`):I.attributes!=null?Object.keys(I.attributes).some(function(j){return l.default.query(j,l.default.Scope.BLOCK)!=null}):!1}function N(R){var I=R.reduce(function(U,C){return U+=C.delete||0,U},0),j=R.length()-I;return T(R)&&(j-=1),j}n.default=b,n.getLastChangeIndex=N},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BaseTooltip=void 0;var s=function(){function G(X,se){for(var le=0;le<se.length;le++){var Q=se[le];Q.enumerable=Q.enumerable||!1,Q.configurable=!0,"value"in Q&&(Q.writable=!0),Object.defineProperty(X,Q.key,Q)}}return function(X,se,le){return se&&G(X.prototype,se),le&&G(X,le),X}}(),o=function G(X,se,le){X===null&&(X=Function.prototype);var Q=Object.getOwnPropertyDescriptor(X,se);if(Q===void 0){var ce=Object.getPrototypeOf(X);return ce===null?void 0:G(ce,se,le)}else{if("value"in Q)return Q.value;var ue=Q.get;return ue===void 0?void 0:ue.call(le)}},l=i(3),d=D(l),f=i(2),m=D(f),y=i(8),g=D(y),_=i(23),E=D(_),x=i(34),b=D(x),T=i(59),N=D(T),R=i(60),I=D(R),j=i(28),U=D(j),C=i(61),k=D(C);function D(G){return G&&G.__esModule?G:{default:G}}function O(G,X){if(!(G instanceof X))throw new TypeError("Cannot call a class as a function")}function P(G,X){if(!G)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return X&&(typeof X=="object"||typeof X=="function")?X:G}function F(G,X){if(typeof X!="function"&&X!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof X);G.prototype=Object.create(X&&X.prototype,{constructor:{value:G,enumerable:!1,writable:!0,configurable:!0}}),X&&(Object.setPrototypeOf?Object.setPrototypeOf(G,X):G.__proto__=X)}var M=[!1,"center","right","justify"],$=["#000000","#e60000","#ff9900","#ffff00","#008a00","#0066cc","#9933ff","#ffffff","#facccc","#ffebcc","#ffffcc","#cce8cc","#cce0f5","#ebd6ff","#bbbbbb","#f06666","#ffc266","#ffff66","#66b966","#66a3e0","#c285ff","#888888","#a10000","#b26b00","#b2b200","#006100","#0047b2","#6b24b2","#444444","#5c0000","#663d00","#666600","#003700","#002966","#3d1466"],Y=[!1,"serif","monospace"],te=["1","2","3",!1],oe=["small",!1,"large","huge"],ie=function(G){F(X,G);function X(se,le){O(this,X);var Q=P(this,(X.__proto__||Object.getPrototypeOf(X)).call(this,se,le)),ce=function ue(fe){if(!document.body.contains(se.root))return document.body.removeEventListener("click",ue);Q.tooltip!=null&&!Q.tooltip.root.contains(fe.target)&&document.activeElement!==Q.tooltip.textbox&&!Q.quill.hasFocus()&&Q.tooltip.hide(),Q.pickers!=null&&Q.pickers.forEach(function(_e){_e.container.contains(fe.target)||_e.close()})};return se.emitter.listenDOM("click",document.body,ce),Q}return s(X,[{key:"addModule",value:function(le){var Q=o(X.prototype.__proto__||Object.getPrototypeOf(X.prototype),"addModule",this).call(this,le);return le==="toolbar"&&this.extendToolbar(Q),Q}},{key:"buildButtons",value:function(le,Q){le.forEach(function(ce){var ue=ce.getAttribute("class")||"";ue.split(/\s+/).forEach(function(fe){if(fe.startsWith("ql-")&&(fe=fe.slice(3),Q[fe]!=null))if(fe==="direction")ce.innerHTML=Q[fe][""]+Q[fe].rtl;else if(typeof Q[fe]=="string")ce.innerHTML=Q[fe];else{var _e=ce.value||"";_e!=null&&Q[fe][_e]&&(ce.innerHTML=Q[fe][_e])}})})}},{key:"buildPickers",value:function(le,Q){var ce=this;this.pickers=le.map(function(fe){if(fe.classList.contains("ql-align"))return fe.querySelector("option")==null&&B(fe,M),new I.default(fe,Q.align);if(fe.classList.contains("ql-background")||fe.classList.contains("ql-color")){var _e=fe.classList.contains("ql-background")?"background":"color";return fe.querySelector("option")==null&&B(fe,$,_e==="background"?"#ffffff":"#000000"),new N.default(fe,Q[_e])}else return fe.querySelector("option")==null&&(fe.classList.contains("ql-font")?B(fe,Y):fe.classList.contains("ql-header")?B(fe,te):fe.classList.contains("ql-size")&&B(fe,oe)),new U.default(fe)});var ue=function(){ce.pickers.forEach(function(_e){_e.update()})};this.quill.on(g.default.events.EDITOR_CHANGE,ue)}}]),X}(b.default);ie.DEFAULTS=(0,d.default)(!0,{},b.default.DEFAULTS,{modules:{toolbar:{handlers:{formula:function(){this.quill.theme.tooltip.edit("formula")},image:function(){var X=this,se=this.container.querySelector("input.ql-image[type=file]");se==null&&(se=document.createElement("input"),se.setAttribute("type","file"),se.setAttribute("accept","image/png, image/gif, image/jpeg, image/bmp, image/x-icon"),se.classList.add("ql-image"),se.addEventListener("change",function(){if(se.files!=null&&se.files[0]!=null){var le=new FileReader;le.onload=function(Q){var ce=X.quill.getSelection(!0);X.quill.updateContents(new m.default().retain(ce.index).delete(ce.length).insert({image:Q.target.result}),g.default.sources.USER),X.quill.setSelection(ce.index+1,g.default.sources.SILENT),se.value=""},le.readAsDataURL(se.files[0])}}),this.container.appendChild(se)),se.click()},video:function(){this.quill.theme.tooltip.edit("video")}}}}});var ne=function(G){F(X,G);function X(se,le){O(this,X);var Q=P(this,(X.__proto__||Object.getPrototypeOf(X)).call(this,se,le));return Q.textbox=Q.root.querySelector('input[type="text"]'),Q.listen(),Q}return s(X,[{key:"listen",value:function(){var le=this;this.textbox.addEventListener("keydown",function(Q){E.default.match(Q,"enter")?(le.save(),Q.preventDefault()):E.default.match(Q,"escape")&&(le.cancel(),Q.preventDefault())})}},{key:"cancel",value:function(){this.hide()}},{key:"edit",value:function(){var le=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"link",Q=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;this.root.classList.remove("ql-hidden"),this.root.classList.add("ql-editing"),Q!=null?this.textbox.value=Q:le!==this.root.getAttribute("data-mode")&&(this.textbox.value=""),this.position(this.quill.getBounds(this.quill.selection.savedRange)),this.textbox.select(),this.textbox.setAttribute("placeholder",this.textbox.getAttribute("data-"+le)||""),this.root.setAttribute("data-mode",le)}},{key:"restoreFocus",value:function(){var le=this.quill.scrollingContainer.scrollTop;this.quill.focus(),this.quill.scrollingContainer.scrollTop=le}},{key:"save",value:function(){var le=this.textbox.value;switch(this.root.getAttribute("data-mode")){case"link":{var Q=this.quill.root.scrollTop;this.linkRange?(this.quill.formatText(this.linkRange,"link",le,g.default.sources.USER),delete this.linkRange):(this.restoreFocus(),this.quill.format("link",le,g.default.sources.USER)),this.quill.root.scrollTop=Q;break}case"video":le=K(le);case"formula":{if(!le)break;var ce=this.quill.getSelection(!0);if(ce!=null){var ue=ce.index+ce.length;this.quill.insertEmbed(ue,this.root.getAttribute("data-mode"),le,g.default.sources.USER),this.root.getAttribute("data-mode")==="formula"&&this.quill.insertText(ue+1," ",g.default.sources.USER),this.quill.setSelection(ue+2,g.default.sources.USER)}break}}this.textbox.value="",this.hide()}}]),X}(k.default);function K(G){var X=G.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtube\.com\/watch.*v=([a-zA-Z0-9_-]+)/)||G.match(/^(?:(https?):\/\/)?(?:(?:www|m)\.)?youtu\.be\/([a-zA-Z0-9_-]+)/);return X?(X[1]||"https")+"://www.youtube.com/embed/"+X[2]+"?showinfo=0":(X=G.match(/^(?:(https?):\/\/)?(?:www\.)?vimeo\.com\/(\d+)/))?(X[1]||"https")+"://player.vimeo.com/video/"+X[2]+"/":G}function B(G,X){var se=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;X.forEach(function(le){var Q=document.createElement("option");le===se?Q.setAttribute("selected","selected"):Q.setAttribute("value",le),G.appendChild(Q)})}n.BaseTooltip=ne,n.default=ie},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function o(){this.head=this.tail=null,this.length=0}return o.prototype.append=function(){for(var l=[],d=0;d<arguments.length;d++)l[d]=arguments[d];this.insertBefore(l[0],null),l.length>1&&this.append.apply(this,l.slice(1))},o.prototype.contains=function(l){for(var d,f=this.iterator();d=f();)if(d===l)return!0;return!1},o.prototype.insertBefore=function(l,d){l&&(l.next=d,d!=null?(l.prev=d.prev,d.prev!=null&&(d.prev.next=l),d.prev=l,d===this.head&&(this.head=l)):this.tail!=null?(this.tail.next=l,l.prev=this.tail,this.tail=l):(l.prev=null,this.head=this.tail=l),this.length+=1)},o.prototype.offset=function(l){for(var d=0,f=this.head;f!=null;){if(f===l)return d;d+=f.length(),f=f.next}return-1},o.prototype.remove=function(l){this.contains(l)&&(l.prev!=null&&(l.prev.next=l.next),l.next!=null&&(l.next.prev=l.prev),l===this.head&&(this.head=l.next),l===this.tail&&(this.tail=l.prev),this.length-=1)},o.prototype.iterator=function(l){return l===void 0&&(l=this.head),function(){var d=l;return l!=null&&(l=l.next),d}},o.prototype.find=function(l,d){d===void 0&&(d=!1);for(var f,m=this.iterator();f=m();){var y=f.length();if(l<y||d&&l===y&&(f.next==null||f.next.length()!==0))return[f,l];l-=y}return[null,0]},o.prototype.forEach=function(l){for(var d,f=this.iterator();d=f();)l(d)},o.prototype.forEachAt=function(l,d,f){if(!(d<=0))for(var m=this.find(l),y=m[0],g=m[1],_,E=l-g,x=this.iterator(y);(_=x())&&E<l+d;){var b=_.length();l>E?f(_,l-E,Math.min(d,E+b-l)):f(_,0,Math.min(b,l+d-E)),E+=b}},o.prototype.map=function(l){return this.reduce(function(d,f){return d.push(l(f)),d},[])},o.prototype.reduce=function(l,d){for(var f,m=this.iterator();f=m();)d=l(d,f);return d},o}();n.default=s},function(t,n,i){var s=this&&this.__extends||function(){var y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(g,_){g.__proto__=_}||function(g,_){for(var E in _)_.hasOwnProperty(E)&&(g[E]=_[E])};return function(g,_){y(g,_);function E(){this.constructor=g}g.prototype=_===null?Object.create(_):(E.prototype=_.prototype,new E)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(17),l=i(1),d={attributes:!0,characterData:!0,characterDataOldValue:!0,childList:!0,subtree:!0},f=100,m=function(y){s(g,y);function g(_){var E=y.call(this,_)||this;return E.scroll=E,E.observer=new MutationObserver(function(x){E.update(x)}),E.observer.observe(E.domNode,d),E.attach(),E}return g.prototype.detach=function(){y.prototype.detach.call(this),this.observer.disconnect()},g.prototype.deleteAt=function(_,E){this.update(),_===0&&E===this.length()?this.children.forEach(function(x){x.remove()}):y.prototype.deleteAt.call(this,_,E)},g.prototype.formatAt=function(_,E,x,b){this.update(),y.prototype.formatAt.call(this,_,E,x,b)},g.prototype.insertAt=function(_,E,x){this.update(),y.prototype.insertAt.call(this,_,E,x)},g.prototype.optimize=function(_,E){var x=this;_===void 0&&(_=[]),E===void 0&&(E={}),y.prototype.optimize.call(this,E);for(var b=[].slice.call(this.observer.takeRecords());b.length>0;)_.push(b.pop());for(var T=function(j,U){U===void 0&&(U=!0),!(j==null||j===x)&&j.domNode.parentNode!=null&&(j.domNode[l.DATA_KEY].mutations==null&&(j.domNode[l.DATA_KEY].mutations=[]),U&&T(j.parent))},N=function(j){j.domNode[l.DATA_KEY]==null||j.domNode[l.DATA_KEY].mutations==null||(j instanceof o.default&&j.children.forEach(N),j.optimize(E))},R=_,I=0;R.length>0;I+=1){if(I>=f)throw new Error("[Parchment] Maximum optimize iterations reached");for(R.forEach(function(j){var U=l.find(j.target,!0);U!=null&&(U.domNode===j.target&&(j.type==="childList"?(T(l.find(j.previousSibling,!1)),[].forEach.call(j.addedNodes,function(C){var k=l.find(C,!1);T(k,!1),k instanceof o.default&&k.children.forEach(function(D){T(D,!1)})})):j.type==="attributes"&&T(U.prev)),T(U))}),this.children.forEach(N),R=[].slice.call(this.observer.takeRecords()),b=R.slice();b.length>0;)_.push(b.pop())}},g.prototype.update=function(_,E){var x=this;E===void 0&&(E={}),_=_||this.observer.takeRecords(),_.map(function(b){var T=l.find(b.target,!0);return T==null?null:T.domNode[l.DATA_KEY].mutations==null?(T.domNode[l.DATA_KEY].mutations=[b],T):(T.domNode[l.DATA_KEY].mutations.push(b),null)}).forEach(function(b){b==null||b===x||b.domNode[l.DATA_KEY]==null||b.update(b.domNode[l.DATA_KEY].mutations||[],E)}),this.domNode[l.DATA_KEY].mutations!=null&&y.prototype.update.call(this,this.domNode[l.DATA_KEY].mutations,E),this.optimize(_,E)},g.blotName="scroll",g.defaultChild="block",g.scope=l.Scope.BLOCK_BLOT,g.tagName="DIV",g}(o.default);n.default=m},function(t,n,i){var s=this&&this.__extends||function(){var m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(y,g){y.__proto__=g}||function(y,g){for(var _ in g)g.hasOwnProperty(_)&&(y[_]=g[_])};return function(y,g){m(y,g);function _(){this.constructor=y}y.prototype=g===null?Object.create(g):(_.prototype=g.prototype,new _)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(18),l=i(1);function d(m,y){if(Object.keys(m).length!==Object.keys(y).length)return!1;for(var g in m)if(m[g]!==y[g])return!1;return!0}var f=function(m){s(y,m);function y(){return m!==null&&m.apply(this,arguments)||this}return y.formats=function(g){if(g.tagName!==y.tagName)return m.formats.call(this,g)},y.prototype.format=function(g,_){var E=this;g===this.statics.blotName&&!_?(this.children.forEach(function(x){x instanceof o.default||(x=x.wrap(y.blotName,!0)),E.attributes.copy(x)}),this.unwrap()):m.prototype.format.call(this,g,_)},y.prototype.formatAt=function(g,_,E,x){if(this.formats()[E]!=null||l.query(E,l.Scope.ATTRIBUTE)){var b=this.isolate(g,_);b.format(E,x)}else m.prototype.formatAt.call(this,g,_,E,x)},y.prototype.optimize=function(g){m.prototype.optimize.call(this,g);var _=this.formats();if(Object.keys(_).length===0)return this.unwrap();var E=this.next;E instanceof y&&E.prev===this&&d(_,E.formats())&&(E.moveChildren(this),E.remove())},y.blotName="inline",y.scope=l.Scope.INLINE_BLOT,y.tagName="SPAN",y}(o.default);n.default=f},function(t,n,i){var s=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var g in y)y.hasOwnProperty(g)&&(m[g]=y[g])};return function(m,y){f(m,y);function g(){this.constructor=m}m.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(18),l=i(1),d=function(f){s(m,f);function m(){return f!==null&&f.apply(this,arguments)||this}return m.formats=function(y){var g=l.query(m.blotName).tagName;if(y.tagName!==g)return f.formats.call(this,y)},m.prototype.format=function(y,g){l.query(y,l.Scope.BLOCK)!=null&&(y===this.statics.blotName&&!g?this.replaceWith(m.blotName):f.prototype.format.call(this,y,g))},m.prototype.formatAt=function(y,g,_,E){l.query(_,l.Scope.BLOCK)!=null?this.format(_,E):f.prototype.formatAt.call(this,y,g,_,E)},m.prototype.insertAt=function(y,g,_){if(_==null||l.query(g,l.Scope.INLINE)!=null)f.prototype.insertAt.call(this,y,g,_);else{var E=this.split(y),x=l.create(g,_);E.parent.insertBefore(x,E)}},m.prototype.update=function(y,g){navigator.userAgent.match(/Trident/)?this.build():f.prototype.update.call(this,y,g)},m.blotName="block",m.scope=l.Scope.BLOCK_BLOT,m.tagName="P",m}(o.default);n.default=d},function(t,n,i){var s=this&&this.__extends||function(){var d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(f,m){f.__proto__=m}||function(f,m){for(var y in m)m.hasOwnProperty(y)&&(f[y]=m[y])};return function(f,m){d(f,m);function y(){this.constructor=f}f.prototype=m===null?Object.create(m):(y.prototype=m.prototype,new y)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(19),l=function(d){s(f,d);function f(){return d!==null&&d.apply(this,arguments)||this}return f.formats=function(m){},f.prototype.format=function(m,y){d.prototype.formatAt.call(this,0,this.length(),m,y)},f.prototype.formatAt=function(m,y,g,_){m===0&&y===this.length()?this.format(g,_):d.prototype.formatAt.call(this,m,y,g,_)},f.prototype.formats=function(){return this.statics.formats(this.domNode)},f}(o.default);n.default=l},function(t,n,i){var s=this&&this.__extends||function(){var f=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(m,y){m.__proto__=y}||function(m,y){for(var g in y)y.hasOwnProperty(g)&&(m[g]=y[g])};return function(m,y){f(m,y);function g(){this.constructor=m}m.prototype=y===null?Object.create(y):(g.prototype=y.prototype,new g)}}();Object.defineProperty(n,"__esModule",{value:!0});var o=i(19),l=i(1),d=function(f){s(m,f);function m(y){var g=f.call(this,y)||this;return g.text=g.statics.value(g.domNode),g}return m.create=function(y){return document.createTextNode(y)},m.value=function(y){var g=y.data;return g.normalize&&(g=g.normalize()),g},m.prototype.deleteAt=function(y,g){this.domNode.data=this.text=this.text.slice(0,y)+this.text.slice(y+g)},m.prototype.index=function(y,g){return this.domNode===y?g:-1},m.prototype.insertAt=function(y,g,_){_==null?(this.text=this.text.slice(0,y)+g+this.text.slice(y),this.domNode.data=this.text):f.prototype.insertAt.call(this,y,g,_)},m.prototype.length=function(){return this.text.length},m.prototype.optimize=function(y){f.prototype.optimize.call(this,y),this.text=this.statics.value(this.domNode),this.text.length===0?this.remove():this.next instanceof m&&this.next.prev===this&&(this.insertAt(this.length(),this.next.value()),this.next.remove())},m.prototype.position=function(y,g){return[this.domNode,y]},m.prototype.split=function(y,g){if(g===void 0&&(g=!1),!g){if(y===0)return this;if(y===this.length())return this.next}var _=l.create(this.domNode.splitText(y));return this.parent.insertBefore(_,this.next),this.text=this.statics.value(this.domNode),_},m.prototype.update=function(y,g){var _=this;y.some(function(E){return E.type==="characterData"&&E.target===_.domNode})&&(this.text=this.statics.value(this.domNode))},m.prototype.value=function(){return this.text},m.blotName="text",m.scope=l.Scope.INLINE_BLOT,m}(o.default);n.default=d},function(t,n,i){var s=document.createElement("div");if(s.classList.toggle("test-class",!1),s.classList.contains("test-class")){var o=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(l,d){return arguments.length>1&&!this.contains(l)==!d?d:o.call(this,l)}}String.prototype.startsWith||(String.prototype.startsWith=function(l,d){return d=d||0,this.substr(d,l.length)===l}),String.prototype.endsWith||(String.prototype.endsWith=function(l,d){var f=this.toString();(typeof d!="number"||!isFinite(d)||Math.floor(d)!==d||d>f.length)&&(d=f.length),d-=l.length;var m=f.indexOf(l,d);return m!==-1&&m===d}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(d){if(this===null)throw new TypeError("Array.prototype.find called on null or undefined");if(typeof d!="function")throw new TypeError("predicate must be a function");for(var f=Object(this),m=f.length>>>0,y=arguments[1],g,_=0;_<m;_++)if(g=f[_],d.call(y,g,_,f))return g}}),document.addEventListener("DOMContentLoaded",function(){document.execCommand("enableObjectResizing",!1,!1),document.execCommand("autoUrlDetect",!1,!1)})},function(t,n){var i=-1,s=1,o=0;function l(I,j,U){if(I==j)return I?[[o,I]]:[];(U<0||I.length<U)&&(U=null);var C=y(I,j),k=I.substring(0,C);I=I.substring(C),j=j.substring(C),C=g(I,j);var D=I.substring(I.length-C);I=I.substring(0,I.length-C),j=j.substring(0,j.length-C);var O=d(I,j);return k&&O.unshift([o,k]),D&&O.push([o,D]),E(O),U!=null&&(O=T(O,U)),O=N(O),O}function d(I,j){var U;if(!I)return[[s,j]];if(!j)return[[i,I]];var C=I.length>j.length?I:j,k=I.length>j.length?j:I,D=C.indexOf(k);if(D!=-1)return U=[[s,C.substring(0,D)],[o,k],[s,C.substring(D+k.length)]],I.length>j.length&&(U[0][0]=U[2][0]=i),U;if(k.length==1)return[[i,I],[s,j]];var O=_(I,j);if(O){var P=O[0],F=O[1],M=O[2],$=O[3],Y=O[4],te=l(P,M),oe=l(F,$);return te.concat([[o,Y]],oe)}return f(I,j)}function f(I,j){for(var U=I.length,C=j.length,k=Math.ceil((U+C)/2),D=k,O=2*k,P=new Array(O),F=new Array(O),M=0;M<O;M++)P[M]=-1,F[M]=-1;P[D+1]=0,F[D+1]=0;for(var $=U-C,Y=$%2!=0,te=0,oe=0,ie=0,ne=0,K=0;K<k;K++){for(var B=-K+te;B<=K-oe;B+=2){var G=D+B,X;B==-K||B!=K&&P[G-1]<P[G+1]?X=P[G+1]:X=P[G-1]+1;for(var se=X-B;X<U&&se<C&&I.charAt(X)==j.charAt(se);)X++,se++;if(P[G]=X,X>U)oe+=2;else if(se>C)te+=2;else if(Y){var le=D+$-B;if(le>=0&&le<O&&F[le]!=-1){var Q=U-F[le];if(X>=Q)return m(I,j,X,se)}}}for(var ce=-K+ie;ce<=K-ne;ce+=2){var le=D+ce,Q;ce==-K||ce!=K&&F[le-1]<F[le+1]?Q=F[le+1]:Q=F[le-1]+1;for(var ue=Q-ce;Q<U&&ue<C&&I.charAt(U-Q-1)==j.charAt(C-ue-1);)Q++,ue++;if(F[le]=Q,Q>U)ne+=2;else if(ue>C)ie+=2;else if(!Y){var G=D+$-ce;if(G>=0&&G<O&&P[G]!=-1){var X=P[G],se=D+X-G;if(Q=U-Q,X>=Q)return m(I,j,X,se)}}}}return[[i,I],[s,j]]}function m(I,j,U,C){var k=I.substring(0,U),D=j.substring(0,C),O=I.substring(U),P=j.substring(C),F=l(k,D),M=l(O,P);return F.concat(M)}function y(I,j){if(!I||!j||I.charAt(0)!=j.charAt(0))return 0;for(var U=0,C=Math.min(I.length,j.length),k=C,D=0;U<k;)I.substring(D,k)==j.substring(D,k)?(U=k,D=U):C=k,k=Math.floor((C-U)/2+U);return k}function g(I,j){if(!I||!j||I.charAt(I.length-1)!=j.charAt(j.length-1))return 0;for(var U=0,C=Math.min(I.length,j.length),k=C,D=0;U<k;)I.substring(I.length-k,I.length-D)==j.substring(j.length-k,j.length-D)?(U=k,D=U):C=k,k=Math.floor((C-U)/2+U);return k}function _(I,j){var U=I.length>j.length?I:j,C=I.length>j.length?j:I;if(U.length<4||C.length*2<U.length)return null;function k(oe,ie,ne){for(var K=oe.substring(ne,ne+Math.floor(oe.length/4)),B=-1,G="",X,se,le,Q;(B=ie.indexOf(K,B+1))!=-1;){var ce=y(oe.substring(ne),ie.substring(B)),ue=g(oe.substring(0,ne),ie.substring(0,B));G.length<ue+ce&&(G=ie.substring(B-ue,B)+ie.substring(B,B+ce),X=oe.substring(0,ne-ue),se=oe.substring(ne+ce),le=ie.substring(0,B-ue),Q=ie.substring(B+ce))}return G.length*2>=oe.length?[X,se,le,Q,G]:null}var D=k(U,C,Math.ceil(U.length/4)),O=k(U,C,Math.ceil(U.length/2)),P;if(!D&&!O)return null;O?D?P=D[4].length>O[4].length?D:O:P=O:P=D;var F,M,$,Y;I.length>j.length?(F=P[0],M=P[1],$=P[2],Y=P[3]):($=P[0],Y=P[1],F=P[2],M=P[3]);var te=P[4];return[F,M,$,Y,te]}function E(I){I.push([o,""]);for(var j=0,U=0,C=0,k="",D="",O;j<I.length;)switch(I[j][0]){case s:C++,D+=I[j][1],j++;break;case i:U++,k+=I[j][1],j++;break;case o:U+C>1?(U!==0&&C!==0&&(O=y(D,k),O!==0&&(j-U-C>0&&I[j-U-C-1][0]==o?I[j-U-C-1][1]+=D.substring(0,O):(I.splice(0,0,[o,D.substring(0,O)]),j++),D=D.substring(O),k=k.substring(O)),O=g(D,k),O!==0&&(I[j][1]=D.substring(D.length-O)+I[j][1],D=D.substring(0,D.length-O),k=k.substring(0,k.length-O))),U===0?I.splice(j-C,U+C,[s,D]):C===0?I.splice(j-U,U+C,[i,k]):I.splice(j-U-C,U+C,[i,k],[s,D]),j=j-U-C+(U?1:0)+(C?1:0)+1):j!==0&&I[j-1][0]==o?(I[j-1][1]+=I[j][1],I.splice(j,1)):j++,C=0,U=0,k="",D="";break}I[I.length-1][1]===""&&I.pop();var P=!1;for(j=1;j<I.length-1;)I[j-1][0]==o&&I[j+1][0]==o&&(I[j][1].substring(I[j][1].length-I[j-1][1].length)==I[j-1][1]?(I[j][1]=I[j-1][1]+I[j][1].substring(0,I[j][1].length-I[j-1][1].length),I[j+1][1]=I[j-1][1]+I[j+1][1],I.splice(j-1,1),P=!0):I[j][1].substring(0,I[j+1][1].length)==I[j+1][1]&&(I[j-1][1]+=I[j+1][1],I[j][1]=I[j][1].substring(I[j+1][1].length)+I[j+1][1],I.splice(j+1,1),P=!0)),j++;P&&E(I)}var x=l;x.INSERT=s,x.DELETE=i,x.EQUAL=o,t.exports=x;function b(I,j){if(j===0)return[o,I];for(var U=0,C=0;C<I.length;C++){var k=I[C];if(k[0]===i||k[0]===o){var D=U+k[1].length;if(j===D)return[C+1,I];if(j<D){I=I.slice();var O=j-U,P=[k[0],k[1].slice(0,O)],F=[k[0],k[1].slice(O)];return I.splice(C,1,P,F),[C+1,I]}else U=D}}throw new Error("cursor_pos is out of bounds!")}function T(I,j){var U=b(I,j),C=U[1],k=U[0],D=C[k],O=C[k+1];if(D==null)return I;if(D[0]!==o)return I;if(O!=null&&D[1]+O[1]===O[1]+D[1])return C.splice(k,2,O,D),R(C,k,2);if(O!=null&&O[1].indexOf(D[1])===0){C.splice(k,2,[O[0],D[1]],[0,D[1]]);var P=O[1].slice(D[1].length);return P.length>0&&C.splice(k+2,0,[O[0],P]),R(C,k,3)}else return I}function N(I){for(var j=!1,U=function(O){return O.charCodeAt(0)>=56320&&O.charCodeAt(0)<=57343},C=function(O){return O.charCodeAt(O.length-1)>=55296&&O.charCodeAt(O.length-1)<=56319},k=2;k<I.length;k+=1)I[k-2][0]===o&&C(I[k-2][1])&&I[k-1][0]===i&&U(I[k-1][1])&&I[k][0]===s&&U(I[k][1])&&(j=!0,I[k-1][1]=I[k-2][1].slice(-1)+I[k-1][1],I[k][1]=I[k-2][1].slice(-1)+I[k][1],I[k-2][1]=I[k-2][1].slice(0,-1));if(!j)return I;for(var D=[],k=0;k<I.length;k+=1)I[k][1].length>0&&D.push(I[k]);return D}function R(I,j,U){for(var C=j+U-1;C>=0&&C>=j-1;C--)if(C+1<I.length){var k=I[C],D=I[C+1];k[0]===D[1]&&I.splice(C,2,[k[0],k[1]+D[1]])}return I}},function(t,n){n=t.exports=typeof Object.keys=="function"?Object.keys:i,n.shim=i;function i(s){var o=[];for(var l in s)o.push(l);return o}},function(t,n){var i=function(){return Object.prototype.toString.call(arguments)}()=="[object Arguments]";n=t.exports=i?s:o,n.supported=s;function s(l){return Object.prototype.toString.call(l)=="[object Arguments]"}n.unsupported=o;function o(l){return l&&typeof l=="object"&&typeof l.length=="number"&&Object.prototype.hasOwnProperty.call(l,"callee")&&!Object.prototype.propertyIsEnumerable.call(l,"callee")||!1}},function(t,n){var i=Object.prototype.hasOwnProperty,s="~";function o(){}Object.create&&(o.prototype=Object.create(null),new o().__proto__||(s=!1));function l(f,m,y){this.fn=f,this.context=m,this.once=y||!1}function d(){this._events=new o,this._eventsCount=0}d.prototype.eventNames=function(){var m=[],y,g;if(this._eventsCount===0)return m;for(g in y=this._events)i.call(y,g)&&m.push(s?g.slice(1):g);return Object.getOwnPropertySymbols?m.concat(Object.getOwnPropertySymbols(y)):m},d.prototype.listeners=function(m,y){var g=s?s+m:m,_=this._events[g];if(y)return!!_;if(!_)return[];if(_.fn)return[_.fn];for(var E=0,x=_.length,b=new Array(x);E<x;E++)b[E]=_[E].fn;return b},d.prototype.emit=function(m,y,g,_,E,x){var b=s?s+m:m;if(!this._events[b])return!1;var T=this._events[b],N=arguments.length,R,I;if(T.fn){switch(T.once&&this.removeListener(m,T.fn,void 0,!0),N){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,y),!0;case 3:return T.fn.call(T.context,y,g),!0;case 4:return T.fn.call(T.context,y,g,_),!0;case 5:return T.fn.call(T.context,y,g,_,E),!0;case 6:return T.fn.call(T.context,y,g,_,E,x),!0}for(I=1,R=new Array(N-1);I<N;I++)R[I-1]=arguments[I];T.fn.apply(T.context,R)}else{var j=T.length,U;for(I=0;I<j;I++)switch(T[I].once&&this.removeListener(m,T[I].fn,void 0,!0),N){case 1:T[I].fn.call(T[I].context);break;case 2:T[I].fn.call(T[I].context,y);break;case 3:T[I].fn.call(T[I].context,y,g);break;case 4:T[I].fn.call(T[I].context,y,g,_);break;default:if(!R)for(U=1,R=new Array(N-1);U<N;U++)R[U-1]=arguments[U];T[I].fn.apply(T[I].context,R)}}return!0},d.prototype.on=function(m,y,g){var _=new l(y,g||this),E=s?s+m:m;return this._events[E]?this._events[E].fn?this._events[E]=[this._events[E],_]:this._events[E].push(_):(this._events[E]=_,this._eventsCount++),this},d.prototype.once=function(m,y,g){var _=new l(y,g||this,!0),E=s?s+m:m;return this._events[E]?this._events[E].fn?this._events[E]=[this._events[E],_]:this._events[E].push(_):(this._events[E]=_,this._eventsCount++),this},d.prototype.removeListener=function(m,y,g,_){var E=s?s+m:m;if(!this._events[E])return this;if(!y)return--this._eventsCount===0?this._events=new o:delete this._events[E],this;var x=this._events[E];if(x.fn)x.fn===y&&(!_||x.once)&&(!g||x.context===g)&&(--this._eventsCount===0?this._events=new o:delete this._events[E]);else{for(var b=0,T=[],N=x.length;b<N;b++)(x[b].fn!==y||_&&!x[b].once||g&&x[b].context!==g)&&T.push(x[b]);T.length?this._events[E]=T.length===1?T[0]:T:--this._eventsCount===0?this._events=new o:delete this._events[E]}return this},d.prototype.removeAllListeners=function(m){var y;return m?(y=s?s+m:m,this._events[y]&&(--this._eventsCount===0?this._events=new o:delete this._events[y])):(this._events=new o,this._eventsCount=0),this},d.prototype.off=d.prototype.removeListener,d.prototype.addListener=d.prototype.on,d.prototype.setMaxListeners=function(){return this},d.prefixed=s,d.EventEmitter=d,typeof t<"u"&&(t.exports=d)},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.matchText=n.matchSpacing=n.matchNewline=n.matchBlot=n.matchAttributor=n.default=void 0;var s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Ae){return typeof Ae}:function(Ae){return Ae&&typeof Symbol=="function"&&Ae.constructor===Symbol&&Ae!==Symbol.prototype?"symbol":typeof Ae},o=function(){function Ae(Ne,Le){var ze=[],ke=!0,vt=!1,mt=void 0;try{for(var pt=Ne[Symbol.iterator](),kt;!(ke=(kt=pt.next()).done)&&(ze.push(kt.value),!(Le&&ze.length===Le));ke=!0);}catch(Ot){vt=!0,mt=Ot}finally{try{!ke&&pt.return&&pt.return()}finally{if(vt)throw mt}}return ze}return function(Ne,Le){if(Array.isArray(Ne))return Ne;if(Symbol.iterator in Object(Ne))return Ae(Ne,Le);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(){function Ae(Ne,Le){for(var ze=0;ze<Le.length;ze++){var ke=Le[ze];ke.enumerable=ke.enumerable||!1,ke.configurable=!0,"value"in ke&&(ke.writable=!0),Object.defineProperty(Ne,ke.key,ke)}}return function(Ne,Le,ze){return Le&&Ae(Ne.prototype,Le),ze&&Ae(Ne,ze),Ne}}(),d=i(3),f=F(d),m=i(2),y=F(m),g=i(0),_=F(g),E=i(5),x=F(E),b=i(10),T=F(b),N=i(9),R=F(N),I=i(36),j=i(37),U=i(13),C=F(U),k=i(26),D=i(38),O=i(39),P=i(40);function F(Ae){return Ae&&Ae.__esModule?Ae:{default:Ae}}function M(Ae,Ne,Le){return Ne in Ae?Object.defineProperty(Ae,Ne,{value:Le,enumerable:!0,configurable:!0,writable:!0}):Ae[Ne]=Le,Ae}function $(Ae,Ne){if(!(Ae instanceof Ne))throw new TypeError("Cannot call a class as a function")}function Y(Ae,Ne){if(!Ae)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return Ne&&(typeof Ne=="object"||typeof Ne=="function")?Ne:Ae}function te(Ae,Ne){if(typeof Ne!="function"&&Ne!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof Ne);Ae.prototype=Object.create(Ne&&Ne.prototype,{constructor:{value:Ae,enumerable:!1,writable:!0,configurable:!0}}),Ne&&(Object.setPrototypeOf?Object.setPrototypeOf(Ae,Ne):Ae.__proto__=Ne)}var oe=(0,T.default)("quill:clipboard"),ie="__ql-matcher",ne=[[Node.TEXT_NODE,Yt],[Node.TEXT_NODE,yt],["br",Oe],[Node.ELEMENT_NODE,yt],[Node.ELEMENT_NODE,_e],[Node.ELEMENT_NODE,At],[Node.ELEMENT_NODE,fe],[Node.ELEMENT_NODE,xn],["li",tt],["b",ue.bind(ue,"bold")],["i",ue.bind(ue,"italic")],["style",qe]],K=[I.AlignAttribute,D.DirectionAttribute].reduce(function(Ae,Ne){return Ae[Ne.keyName]=Ne,Ae},{}),B=[I.AlignStyle,j.BackgroundStyle,k.ColorStyle,D.DirectionStyle,O.FontStyle,P.SizeStyle].reduce(function(Ae,Ne){return Ae[Ne.keyName]=Ne,Ae},{}),G=function(Ae){te(Ne,Ae);function Ne(Le,ze){$(this,Ne);var ke=Y(this,(Ne.__proto__||Object.getPrototypeOf(Ne)).call(this,Le,ze));return ke.quill.root.addEventListener("paste",ke.onPaste.bind(ke)),ke.container=ke.quill.addContainer("ql-clipboard"),ke.container.setAttribute("contenteditable",!0),ke.container.setAttribute("tabindex",-1),ke.matchers=[],ne.concat(ke.options.matchers).forEach(function(vt){var mt=o(vt,2),pt=mt[0],kt=mt[1];!ze.matchVisual&&kt===At||ke.addMatcher(pt,kt)}),ke}return l(Ne,[{key:"addMatcher",value:function(ze,ke){this.matchers.push([ze,ke])}},{key:"convert",value:function(ze){if(typeof ze=="string")return this.container.innerHTML=ze.replace(/\>\r?\n +\</g,"><"),this.convert();var ke=this.quill.getFormat(this.quill.selection.savedRange.index);if(ke[C.default.blotName]){var vt=this.container.innerText;return this.container.innerHTML="",new y.default().insert(vt,M({},C.default.blotName,ke[C.default.blotName]))}var mt=this.prepareMatching(),pt=o(mt,2),kt=pt[0],Ot=pt[1],Mt=ce(this.container,kt,Ot);return le(Mt,`
`)&&Mt.ops[Mt.ops.length-1].attributes==null&&(Mt=Mt.compose(new y.default().retain(Mt.length()-1).delete(1))),oe.log("convert",this.container.innerHTML,Mt),this.container.innerHTML="",Mt}},{key:"dangerouslyPasteHTML",value:function(ze,ke){var vt=arguments.length>2&&arguments[2]!==void 0?arguments[2]:x.default.sources.API;if(typeof ze=="string")this.quill.setContents(this.convert(ze),ke),this.quill.setSelection(0,x.default.sources.SILENT);else{var mt=this.convert(ke);this.quill.updateContents(new y.default().retain(ze).concat(mt),vt),this.quill.setSelection(ze+mt.length(),x.default.sources.SILENT)}}},{key:"onPaste",value:function(ze){var ke=this;if(!(ze.defaultPrevented||!this.quill.isEnabled())){var vt=this.quill.getSelection(),mt=new y.default().retain(vt.index),pt=this.quill.scrollingContainer.scrollTop;this.container.focus(),this.quill.selection.update(x.default.sources.SILENT),setTimeout(function(){mt=mt.concat(ke.convert()).delete(vt.length),ke.quill.updateContents(mt,x.default.sources.USER),ke.quill.setSelection(mt.length()-vt.length,x.default.sources.SILENT),ke.quill.scrollingContainer.scrollTop=pt,ke.quill.focus()},1)}}},{key:"prepareMatching",value:function(){var ze=this,ke=[],vt=[];return this.matchers.forEach(function(mt){var pt=o(mt,2),kt=pt[0],Ot=pt[1];switch(kt){case Node.TEXT_NODE:vt.push(Ot);break;case Node.ELEMENT_NODE:ke.push(Ot);break;default:[].forEach.call(ze.container.querySelectorAll(kt),function(Mt){Mt[ie]=Mt[ie]||[],Mt[ie].push(Ot)});break}}),[ke,vt]}}]),Ne}(R.default);G.DEFAULTS={matchers:[],matchVisual:!0};function X(Ae,Ne,Le){return(typeof Ne>"u"?"undefined":s(Ne))==="object"?Object.keys(Ne).reduce(function(ze,ke){return X(ze,ke,Ne[ke])},Ae):Ae.reduce(function(ze,ke){return ke.attributes&&ke.attributes[Ne]?ze.push(ke):ze.insert(ke.insert,(0,f.default)({},M({},Ne,Le),ke.attributes))},new y.default)}function se(Ae){if(Ae.nodeType!==Node.ELEMENT_NODE)return{};var Ne="__ql-computed-style";return Ae[Ne]||(Ae[Ne]=window.getComputedStyle(Ae))}function le(Ae,Ne){for(var Le="",ze=Ae.ops.length-1;ze>=0&&Le.length<Ne.length;--ze){var ke=Ae.ops[ze];if(typeof ke.insert!="string")break;Le=ke.insert+Le}return Le.slice(-1*Ne.length)===Ne}function Q(Ae){if(Ae.childNodes.length===0)return!1;var Ne=se(Ae);return["block","list-item"].indexOf(Ne.display)>-1}function ce(Ae,Ne,Le){return Ae.nodeType===Ae.TEXT_NODE?Le.reduce(function(ze,ke){return ke(Ae,ze)},new y.default):Ae.nodeType===Ae.ELEMENT_NODE?[].reduce.call(Ae.childNodes||[],function(ze,ke){var vt=ce(ke,Ne,Le);return ke.nodeType===Ae.ELEMENT_NODE&&(vt=Ne.reduce(function(mt,pt){return pt(ke,mt)},vt),vt=(ke[ie]||[]).reduce(function(mt,pt){return pt(ke,mt)},vt)),ze.concat(vt)},new y.default):new y.default}function ue(Ae,Ne,Le){return X(Le,Ae,!0)}function fe(Ae,Ne){var Le=_.default.Attributor.Attribute.keys(Ae),ze=_.default.Attributor.Class.keys(Ae),ke=_.default.Attributor.Style.keys(Ae),vt={};return Le.concat(ze).concat(ke).forEach(function(mt){var pt=_.default.query(mt,_.default.Scope.ATTRIBUTE);pt!=null&&(vt[pt.attrName]=pt.value(Ae),vt[pt.attrName])||(pt=K[mt],pt!=null&&(pt.attrName===mt||pt.keyName===mt)&&(vt[pt.attrName]=pt.value(Ae)||void 0),pt=B[mt],pt!=null&&(pt.attrName===mt||pt.keyName===mt)&&(pt=B[mt],vt[pt.attrName]=pt.value(Ae)||void 0))}),Object.keys(vt).length>0&&(Ne=X(Ne,vt)),Ne}function _e(Ae,Ne){var Le=_.default.query(Ae);if(Le==null)return Ne;if(Le.prototype instanceof _.default.Embed){var ze={},ke=Le.value(Ae);ke!=null&&(ze[Le.blotName]=ke,Ne=new y.default().insert(ze,Le.formats(Ae)))}else typeof Le.formats=="function"&&(Ne=X(Ne,Le.blotName,Le.formats(Ae)));return Ne}function Oe(Ae,Ne){return le(Ne,`
`)||Ne.insert(`
`),Ne}function qe(){return new y.default}function tt(Ae,Ne){var Le=_.default.query(Ae);if(Le==null||Le.blotName!=="list-item"||!le(Ne,`
`))return Ne;for(var ze=-1,ke=Ae.parentNode;!ke.classList.contains("ql-clipboard");)(_.default.query(ke)||{}).blotName==="list"&&(ze+=1),ke=ke.parentNode;return ze<=0?Ne:Ne.compose(new y.default().retain(Ne.length()-1).retain(1,{indent:ze}))}function yt(Ae,Ne){return le(Ne,`
`)||(Q(Ae)||Ne.length()>0&&Ae.nextSibling&&Q(Ae.nextSibling))&&Ne.insert(`
`),Ne}function At(Ae,Ne){if(Q(Ae)&&Ae.nextElementSibling!=null&&!le(Ne,`

`)){var Le=Ae.offsetHeight+parseFloat(se(Ae).marginTop)+parseFloat(se(Ae).marginBottom);Ae.nextElementSibling.offsetTop>Ae.offsetTop+Le*1.5&&Ne.insert(`
`)}return Ne}function xn(Ae,Ne){var Le={},ze=Ae.style||{};return ze.fontStyle&&se(Ae).fontStyle==="italic"&&(Le.italic=!0),ze.fontWeight&&(se(Ae).fontWeight.startsWith("bold")||parseInt(se(Ae).fontWeight)>=700)&&(Le.bold=!0),Object.keys(Le).length>0&&(Ne=X(Ne,Le)),parseFloat(ze.textIndent||0)>0&&(Ne=new y.default().insert("	").concat(Ne)),Ne}function Yt(Ae,Ne){var Le=Ae.data;if(Ae.parentNode.tagName==="O:P")return Ne.insert(Le.trim());if(Le.trim().length===0&&Ae.parentNode.classList.contains("ql-clipboard"))return Ne;if(!se(Ae.parentNode).whiteSpace.startsWith("pre")){var ze=function(vt,mt){return mt=mt.replace(/[^\u00a0]/g,""),mt.length<1&&vt?" ":mt};Le=Le.replace(/\r\n/g," ").replace(/\n/g," "),Le=Le.replace(/\s\s+/g,ze.bind(ze,!0)),(Ae.previousSibling==null&&Q(Ae.parentNode)||Ae.previousSibling!=null&&Q(Ae.previousSibling))&&(Le=Le.replace(/^\s+/,ze.bind(ze,!1))),(Ae.nextSibling==null&&Q(Ae.parentNode)||Ae.nextSibling!=null&&Q(Ae.nextSibling))&&(Le=Le.replace(/\s+$/,ze.bind(ze,!1)))}return Ne.insert(Le)}n.default=G,n.matchAttributor=fe,n.matchBlot=_e,n.matchNewline=yt,n.matchSpacing=At,n.matchText=Yt},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function E(x,b){for(var T=0;T<b.length;T++){var N=b[T];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(x,N.key,N)}}return function(x,b,T){return b&&E(x.prototype,b),T&&E(x,T),x}}(),o=function E(x,b,T){x===null&&(x=Function.prototype);var N=Object.getOwnPropertyDescriptor(x,b);if(N===void 0){var R=Object.getPrototypeOf(x);return R===null?void 0:E(R,b,T)}else{if("value"in N)return N.value;var I=N.get;return I===void 0?void 0:I.call(T)}},l=i(6),d=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function y(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var _=function(E){g(x,E);function x(){return m(this,x),y(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return s(x,[{key:"optimize",value:function(T){o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"optimize",this).call(this,T),this.domNode.tagName!==this.statics.tagName[0]&&this.replaceWith(this.statics.blotName)}}],[{key:"create",value:function(){return o(x.__proto__||Object.getPrototypeOf(x),"create",this).call(this)}},{key:"formats",value:function(){return!0}}]),x}(d.default);_.blotName="bold",_.tagName=["STRONG","B"],n.default=_},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.addControls=n.default=void 0;var s=function(){function P(F,M){var $=[],Y=!0,te=!1,oe=void 0;try{for(var ie=F[Symbol.iterator](),ne;!(Y=(ne=ie.next()).done)&&($.push(ne.value),!(M&&$.length===M));Y=!0);}catch(K){te=!0,oe=K}finally{try{!Y&&ie.return&&ie.return()}finally{if(te)throw oe}}return $}return function(F,M){if(Array.isArray(F))return F;if(Symbol.iterator in Object(F))return P(F,M);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function(){function P(F,M){for(var $=0;$<M.length;$++){var Y=M[$];Y.enumerable=Y.enumerable||!1,Y.configurable=!0,"value"in Y&&(Y.writable=!0),Object.defineProperty(F,Y.key,Y)}}return function(F,M,$){return M&&P(F.prototype,M),$&&P(F,$),F}}(),l=i(2),d=T(l),f=i(0),m=T(f),y=i(5),g=T(y),_=i(10),E=T(_),x=i(9),b=T(x);function T(P){return P&&P.__esModule?P:{default:P}}function N(P,F,M){return F in P?Object.defineProperty(P,F,{value:M,enumerable:!0,configurable:!0,writable:!0}):P[F]=M,P}function R(P,F){if(!(P instanceof F))throw new TypeError("Cannot call a class as a function")}function I(P,F){if(!P)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return F&&(typeof F=="object"||typeof F=="function")?F:P}function j(P,F){if(typeof F!="function"&&F!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof F);P.prototype=Object.create(F&&F.prototype,{constructor:{value:P,enumerable:!1,writable:!0,configurable:!0}}),F&&(Object.setPrototypeOf?Object.setPrototypeOf(P,F):P.__proto__=F)}var U=(0,E.default)("quill:toolbar"),C=function(P){j(F,P);function F(M,$){R(this,F);var Y=I(this,(F.__proto__||Object.getPrototypeOf(F)).call(this,M,$));if(Array.isArray(Y.options.container)){var te=document.createElement("div");D(te,Y.options.container),M.container.parentNode.insertBefore(te,M.container),Y.container=te}else typeof Y.options.container=="string"?Y.container=document.querySelector(Y.options.container):Y.container=Y.options.container;if(!(Y.container instanceof HTMLElement)){var oe;return oe=U.error("Container required for toolbar",Y.options),I(Y,oe)}return Y.container.classList.add("ql-toolbar"),Y.controls=[],Y.handlers={},Object.keys(Y.options.handlers).forEach(function(ie){Y.addHandler(ie,Y.options.handlers[ie])}),[].forEach.call(Y.container.querySelectorAll("button, select"),function(ie){Y.attach(ie)}),Y.quill.on(g.default.events.EDITOR_CHANGE,function(ie,ne){ie===g.default.events.SELECTION_CHANGE&&Y.update(ne)}),Y.quill.on(g.default.events.SCROLL_OPTIMIZE,function(){var ie=Y.quill.selection.getRange(),ne=s(ie,1),K=ne[0];Y.update(K)}),Y}return o(F,[{key:"addHandler",value:function($,Y){this.handlers[$]=Y}},{key:"attach",value:function($){var Y=this,te=[].find.call($.classList,function(ie){return ie.indexOf("ql-")===0});if(te){if(te=te.slice(3),$.tagName==="BUTTON"&&$.setAttribute("type","button"),this.handlers[te]==null){if(this.quill.scroll.whitelist!=null&&this.quill.scroll.whitelist[te]==null){U.warn("ignoring attaching to disabled format",te,$);return}if(m.default.query(te)==null){U.warn("ignoring attaching to nonexistent format",te,$);return}}var oe=$.tagName==="SELECT"?"change":"click";$.addEventListener(oe,function(ie){var ne=void 0;if($.tagName==="SELECT"){if($.selectedIndex<0)return;var K=$.options[$.selectedIndex];K.hasAttribute("selected")?ne=!1:ne=K.value||!1}else $.classList.contains("ql-active")?ne=!1:ne=$.value||!$.hasAttribute("value"),ie.preventDefault();Y.quill.focus();var B=Y.quill.selection.getRange(),G=s(B,1),X=G[0];if(Y.handlers[te]!=null)Y.handlers[te].call(Y,ne);else if(m.default.query(te).prototype instanceof m.default.Embed){if(ne=prompt("Enter "+te),!ne)return;Y.quill.updateContents(new d.default().retain(X.index).delete(X.length).insert(N({},te,ne)),g.default.sources.USER)}else Y.quill.format(te,ne,g.default.sources.USER);Y.update(X)}),this.controls.push([te,$])}}},{key:"update",value:function($){var Y=$==null?{}:this.quill.getFormat($);this.controls.forEach(function(te){var oe=s(te,2),ie=oe[0],ne=oe[1];if(ne.tagName==="SELECT"){var K=void 0;if($==null)K=null;else if(Y[ie]==null)K=ne.querySelector("option[selected]");else if(!Array.isArray(Y[ie])){var B=Y[ie];typeof B=="string"&&(B=B.replace(/\"/g,'\\"')),K=ne.querySelector('option[value="'+B+'"]')}K==null?(ne.value="",ne.selectedIndex=-1):K.selected=!0}else if($==null)ne.classList.remove("ql-active");else if(ne.hasAttribute("value")){var G=Y[ie]===ne.getAttribute("value")||Y[ie]!=null&&Y[ie].toString()===ne.getAttribute("value")||Y[ie]==null&&!ne.getAttribute("value");ne.classList.toggle("ql-active",G)}else ne.classList.toggle("ql-active",Y[ie]!=null)})}}]),F}(b.default);C.DEFAULTS={};function k(P,F,M){var $=document.createElement("button");$.setAttribute("type","button"),$.classList.add("ql-"+F),M!=null&&($.value=M),P.appendChild($)}function D(P,F){Array.isArray(F[0])||(F=[F]),F.forEach(function(M){var $=document.createElement("span");$.classList.add("ql-formats"),M.forEach(function(Y){if(typeof Y=="string")k($,Y);else{var te=Object.keys(Y)[0],oe=Y[te];Array.isArray(oe)?O($,te,oe):k($,te,oe)}}),P.appendChild($)})}function O(P,F,M){var $=document.createElement("select");$.classList.add("ql-"+F),M.forEach(function(Y){var te=document.createElement("option");Y!==!1?te.setAttribute("value",Y):te.setAttribute("selected","selected"),$.appendChild(te)}),P.appendChild($)}C.DEFAULTS={container:null,handlers:{clean:function(){var F=this,M=this.quill.getSelection();if(M!=null)if(M.length==0){var $=this.quill.getFormat();Object.keys($).forEach(function(Y){m.default.query(Y,m.default.Scope.INLINE)!=null&&F.quill.format(Y,!1)})}else this.quill.removeFormat(M,g.default.sources.USER)},direction:function(F){var M=this.quill.getFormat().align;F==="rtl"&&M==null?this.quill.format("align","right",g.default.sources.USER):!F&&M==="right"&&this.quill.format("align",!1,g.default.sources.USER),this.quill.format("direction",F,g.default.sources.USER)},indent:function(F){var M=this.quill.getSelection(),$=this.quill.getFormat(M),Y=parseInt($.indent||0);if(F==="+1"||F==="-1"){var te=F==="+1"?1:-1;$.direction==="rtl"&&(te*=-1),this.quill.format("indent",Y+te,g.default.sources.USER)}},link:function(F){F===!0&&(F=prompt("Enter link URL:")),this.quill.format("link",F,g.default.sources.USER)},list:function(F){var M=this.quill.getSelection(),$=this.quill.getFormat(M);F==="check"?$.list==="checked"||$.list==="unchecked"?this.quill.format("list",!1,g.default.sources.USER):this.quill.format("list","unchecked",g.default.sources.USER):this.quill.format("list",F,g.default.sources.USER)}}},n.default=C,n.addControls=D},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polyline class="ql-even ql-stroke" points="5 7 3 9 5 11"></polyline> <polyline class="ql-even ql-stroke" points="13 7 15 9 13 11"></polyline> <line class=ql-stroke x1=10 x2=8 y1=5 y2=13></line> </svg>'},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function E(x,b){for(var T=0;T<b.length;T++){var N=b[T];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(x,N.key,N)}}return function(x,b,T){return b&&E(x.prototype,b),T&&E(x,T),x}}(),o=function E(x,b,T){x===null&&(x=Function.prototype);var N=Object.getOwnPropertyDescriptor(x,b);if(N===void 0){var R=Object.getPrototypeOf(x);return R===null?void 0:E(R,b,T)}else{if("value"in N)return N.value;var I=N.get;return I===void 0?void 0:I.call(T)}},l=i(28),d=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function y(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var _=function(E){g(x,E);function x(b,T){m(this,x);var N=y(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,b));return N.label.innerHTML=T,N.container.classList.add("ql-color-picker"),[].slice.call(N.container.querySelectorAll(".ql-picker-item"),0,7).forEach(function(R){R.classList.add("ql-primary")}),N}return s(x,[{key:"buildItem",value:function(T){var N=o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"buildItem",this).call(this,T);return N.style.backgroundColor=T.getAttribute("value")||"",N}},{key:"selectItem",value:function(T,N){o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"selectItem",this).call(this,T,N);var R=this.label.querySelector(".ql-color-label"),I=T&&T.getAttribute("data-value")||"";R&&(R.tagName==="line"?R.style.stroke=I:R.style.fill=I)}}]),x}(d.default);n.default=_},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function E(x,b){for(var T=0;T<b.length;T++){var N=b[T];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(x,N.key,N)}}return function(x,b,T){return b&&E(x.prototype,b),T&&E(x,T),x}}(),o=function E(x,b,T){x===null&&(x=Function.prototype);var N=Object.getOwnPropertyDescriptor(x,b);if(N===void 0){var R=Object.getPrototypeOf(x);return R===null?void 0:E(R,b,T)}else{if("value"in N)return N.value;var I=N.get;return I===void 0?void 0:I.call(T)}},l=i(28),d=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function y(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var _=function(E){g(x,E);function x(b,T){m(this,x);var N=y(this,(x.__proto__||Object.getPrototypeOf(x)).call(this,b));return N.container.classList.add("ql-icon-picker"),[].forEach.call(N.container.querySelectorAll(".ql-picker-item"),function(R){R.innerHTML=T[R.getAttribute("data-value")||""]}),N.defaultItem=N.container.querySelector(".ql-selected"),N.selectItem(N.defaultItem),N}return s(x,[{key:"selectItem",value:function(T,N){o(x.prototype.__proto__||Object.getPrototypeOf(x.prototype),"selectItem",this).call(this,T,N),T=T||this.defaultItem,this.label.innerHTML=T.innerHTML}}]),x}(d.default);n.default=_},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function d(f,m){for(var y=0;y<m.length;y++){var g=m[y];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(f,g.key,g)}}return function(f,m,y){return m&&d(f.prototype,m),y&&d(f,y),f}}();function o(d,f){if(!(d instanceof f))throw new TypeError("Cannot call a class as a function")}var l=function(){function d(f,m){var y=this;o(this,d),this.quill=f,this.boundsContainer=m||document.body,this.root=f.addContainer("ql-tooltip"),this.root.innerHTML=this.constructor.TEMPLATE,this.quill.root===this.quill.scrollingContainer&&this.quill.root.addEventListener("scroll",function(){y.root.style.marginTop=-1*y.quill.root.scrollTop+"px"}),this.hide()}return s(d,[{key:"hide",value:function(){this.root.classList.add("ql-hidden")}},{key:"position",value:function(m){var y=m.left+m.width/2-this.root.offsetWidth/2,g=m.bottom+this.quill.root.scrollTop;this.root.style.left=y+"px",this.root.style.top=g+"px",this.root.classList.remove("ql-flip");var _=this.boundsContainer.getBoundingClientRect(),E=this.root.getBoundingClientRect(),x=0;if(E.right>_.right&&(x=_.right-E.right,this.root.style.left=y+x+"px"),E.left<_.left&&(x=_.left-E.left,this.root.style.left=y+x+"px"),E.bottom>_.bottom){var b=E.bottom-E.top,T=m.bottom-m.top+b;this.root.style.top=g-T+"px",this.root.classList.add("ql-flip")}return x}},{key:"show",value:function(){this.root.classList.remove("ql-editing"),this.root.classList.remove("ql-hidden")}}]),d}();n.default=l},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function O(P,F){var M=[],$=!0,Y=!1,te=void 0;try{for(var oe=P[Symbol.iterator](),ie;!($=(ie=oe.next()).done)&&(M.push(ie.value),!(F&&M.length===F));$=!0);}catch(ne){Y=!0,te=ne}finally{try{!$&&oe.return&&oe.return()}finally{if(Y)throw te}}return M}return function(P,F){if(Array.isArray(P))return P;if(Symbol.iterator in Object(P))return O(P,F);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),o=function O(P,F,M){P===null&&(P=Function.prototype);var $=Object.getOwnPropertyDescriptor(P,F);if($===void 0){var Y=Object.getPrototypeOf(P);return Y===null?void 0:O(Y,F,M)}else{if("value"in $)return $.value;var te=$.get;return te===void 0?void 0:te.call(M)}},l=function(){function O(P,F){for(var M=0;M<F.length;M++){var $=F[M];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(P,$.key,$)}}return function(P,F,M){return F&&O(P.prototype,F),M&&O(P,M),P}}(),d=i(3),f=R(d),m=i(8),y=R(m),g=i(43),_=R(g),E=i(27),x=R(E),b=i(15),T=i(41),N=R(T);function R(O){return O&&O.__esModule?O:{default:O}}function I(O,P){if(!(O instanceof P))throw new TypeError("Cannot call a class as a function")}function j(O,P){if(!O)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return P&&(typeof P=="object"||typeof P=="function")?P:O}function U(O,P){if(typeof P!="function"&&P!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof P);O.prototype=Object.create(P&&P.prototype,{constructor:{value:O,enumerable:!1,writable:!0,configurable:!0}}),P&&(Object.setPrototypeOf?Object.setPrototypeOf(O,P):O.__proto__=P)}var C=[[{header:["1","2","3",!1]}],["bold","italic","underline","link"],[{list:"ordered"},{list:"bullet"}],["clean"]],k=function(O){U(P,O);function P(F,M){I(this,P),M.modules.toolbar!=null&&M.modules.toolbar.container==null&&(M.modules.toolbar.container=C);var $=j(this,(P.__proto__||Object.getPrototypeOf(P)).call(this,F,M));return $.quill.container.classList.add("ql-snow"),$}return l(P,[{key:"extendToolbar",value:function(M){M.container.classList.add("ql-snow"),this.buildButtons([].slice.call(M.container.querySelectorAll("button")),N.default),this.buildPickers([].slice.call(M.container.querySelectorAll("select")),N.default),this.tooltip=new D(this.quill,this.options.bounds),M.container.querySelector(".ql-link")&&this.quill.keyboard.addBinding({key:"K",shortKey:!0},function($,Y){M.handlers.link.call(M,!Y.format.link)})}}]),P}(_.default);k.DEFAULTS=(0,f.default)(!0,{},_.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(P){if(P){var F=this.quill.getSelection();if(F==null||F.length==0)return;var M=this.quill.getText(F);/^\S+@\S+\.\S+$/.test(M)&&M.indexOf("mailto:")!==0&&(M="mailto:"+M);var $=this.quill.theme.tooltip;$.edit("link",M)}else this.quill.format("link",!1)}}}}});var D=function(O){U(P,O);function P(F,M){I(this,P);var $=j(this,(P.__proto__||Object.getPrototypeOf(P)).call(this,F,M));return $.preview=$.root.querySelector("a.ql-preview"),$}return l(P,[{key:"listen",value:function(){var M=this;o(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"listen",this).call(this),this.root.querySelector("a.ql-action").addEventListener("click",function($){M.root.classList.contains("ql-editing")?M.save():M.edit("link",M.preview.textContent),$.preventDefault()}),this.root.querySelector("a.ql-remove").addEventListener("click",function($){if(M.linkRange!=null){var Y=M.linkRange;M.restoreFocus(),M.quill.formatText(Y,"link",!1,y.default.sources.USER),delete M.linkRange}$.preventDefault(),M.hide()}),this.quill.on(y.default.events.SELECTION_CHANGE,function($,Y,te){if($!=null){if($.length===0&&te===y.default.sources.USER){var oe=M.quill.scroll.descendant(x.default,$.index),ie=s(oe,2),ne=ie[0],K=ie[1];if(ne!=null){M.linkRange=new b.Range($.index-K,ne.length());var B=x.default.formats(ne.domNode);M.preview.textContent=B,M.preview.setAttribute("href",B),M.show(),M.position(M.quill.getBounds(M.linkRange));return}}else delete M.linkRange;M.hide()}})}},{key:"show",value:function(){o(P.prototype.__proto__||Object.getPrototypeOf(P.prototype),"show",this).call(this),this.root.removeAttribute("data-mode")}}]),P}(g.BaseTooltip);D.TEMPLATE=['<a class="ql-preview" rel="noopener noreferrer" target="_blank" href="about:blank"></a>','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-action"></a>','<a class="ql-remove"></a>'].join(""),n.default=k},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(29),o=ke(s),l=i(36),d=i(38),f=i(64),m=i(65),y=ke(m),g=i(66),_=ke(g),E=i(67),x=ke(E),b=i(37),T=i(26),N=i(39),R=i(40),I=i(56),j=ke(I),U=i(68),C=ke(U),k=i(27),D=ke(k),O=i(69),P=ke(O),F=i(70),M=ke(F),$=i(71),Y=ke($),te=i(72),oe=ke(te),ie=i(73),ne=ke(ie),K=i(13),B=ke(K),G=i(74),X=ke(G),se=i(75),le=ke(se),Q=i(57),ce=ke(Q),ue=i(41),fe=ke(ue),_e=i(28),Oe=ke(_e),qe=i(59),tt=ke(qe),yt=i(60),At=ke(yt),xn=i(61),Yt=ke(xn),Ae=i(108),Ne=ke(Ae),Le=i(62),ze=ke(Le);function ke(vt){return vt&&vt.__esModule?vt:{default:vt}}o.default.register({"attributors/attribute/direction":d.DirectionAttribute,"attributors/class/align":l.AlignClass,"attributors/class/background":b.BackgroundClass,"attributors/class/color":T.ColorClass,"attributors/class/direction":d.DirectionClass,"attributors/class/font":N.FontClass,"attributors/class/size":R.SizeClass,"attributors/style/align":l.AlignStyle,"attributors/style/background":b.BackgroundStyle,"attributors/style/color":T.ColorStyle,"attributors/style/direction":d.DirectionStyle,"attributors/style/font":N.FontStyle,"attributors/style/size":R.SizeStyle},!0),o.default.register({"formats/align":l.AlignClass,"formats/direction":d.DirectionClass,"formats/indent":f.IndentClass,"formats/background":b.BackgroundStyle,"formats/color":T.ColorStyle,"formats/font":N.FontClass,"formats/size":R.SizeClass,"formats/blockquote":y.default,"formats/code-block":B.default,"formats/header":_.default,"formats/list":x.default,"formats/bold":j.default,"formats/code":K.Code,"formats/italic":C.default,"formats/link":D.default,"formats/script":P.default,"formats/strike":M.default,"formats/underline":Y.default,"formats/image":oe.default,"formats/video":ne.default,"formats/list/item":E.ListItem,"modules/formula":X.default,"modules/syntax":le.default,"modules/toolbar":ce.default,"themes/bubble":Ne.default,"themes/snow":ze.default,"ui/icons":fe.default,"ui/picker":Oe.default,"ui/icon-picker":At.default,"ui/color-picker":tt.default,"ui/tooltip":Yt.default},!0),n.default=o.default},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.IndentClass=void 0;var s=function(){function x(b,T){for(var N=0;N<T.length;N++){var R=T[N];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(b,R.key,R)}}return function(b,T,N){return T&&x(b.prototype,T),N&&x(b,N),b}}(),o=function x(b,T,N){b===null&&(b=Function.prototype);var R=Object.getOwnPropertyDescriptor(b,T);if(R===void 0){var I=Object.getPrototypeOf(b);return I===null?void 0:x(I,T,N)}else{if("value"in R)return R.value;var j=R.get;return j===void 0?void 0:j.call(N)}},l=i(0),d=f(l);function f(x){return x&&x.__esModule?x:{default:x}}function m(x,b){if(!(x instanceof b))throw new TypeError("Cannot call a class as a function")}function y(x,b){if(!x)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&(typeof b=="object"||typeof b=="function")?b:x}function g(x,b){if(typeof b!="function"&&b!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof b);x.prototype=Object.create(b&&b.prototype,{constructor:{value:x,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(x,b):x.__proto__=b)}var _=function(x){g(b,x);function b(){return m(this,b),y(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}return s(b,[{key:"add",value:function(N,R){if(R==="+1"||R==="-1"){var I=this.value(N)||0;R=R==="+1"?I+1:I-1}return R===0?(this.remove(N),!0):o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"add",this).call(this,N,R)}},{key:"canAdd",value:function(N,R){return o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"canAdd",this).call(this,N,R)||o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"canAdd",this).call(this,N,parseInt(R))}},{key:"value",value:function(N){return parseInt(o(b.prototype.__proto__||Object.getPrototypeOf(b.prototype),"value",this).call(this,N))||void 0}}]),b}(d.default.Attributor.Class),E=new _("indent","ql-indent",{scope:d.default.Scope.BLOCK,whitelist:[1,2,3,4,5,6,7,8]});n.IndentClass=E},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(4),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}function d(g,_){if(!(g instanceof _))throw new TypeError("Cannot call a class as a function")}function f(g,_){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:g}function m(g,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);g.prototype=Object.create(_&&_.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(g,_):g.__proto__=_)}var y=function(g){m(_,g);function _(){return d(this,_),f(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return _}(o.default);y.blotName="blockquote",y.tagName="blockquote",n.default=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function _(E,x){for(var b=0;b<x.length;b++){var T=x[b];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(E,T.key,T)}}return function(E,x,b){return x&&_(E.prototype,x),b&&_(E,b),E}}(),o=i(4),l=d(o);function d(_){return _&&_.__esModule?_:{default:_}}function f(_,E){if(!(_ instanceof E))throw new TypeError("Cannot call a class as a function")}function m(_,E){if(!_)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return E&&(typeof E=="object"||typeof E=="function")?E:_}function y(_,E){if(typeof E!="function"&&E!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof E);_.prototype=Object.create(E&&E.prototype,{constructor:{value:_,enumerable:!1,writable:!0,configurable:!0}}),E&&(Object.setPrototypeOf?Object.setPrototypeOf(_,E):_.__proto__=E)}var g=function(_){y(E,_);function E(){return f(this,E),m(this,(E.__proto__||Object.getPrototypeOf(E)).apply(this,arguments))}return s(E,null,[{key:"formats",value:function(b){return this.tagName.indexOf(b.tagName)+1}}]),E}(l.default);g.blotName="header",g.tagName=["H1","H2","H3","H4","H5","H6"],n.default=g},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.ListItem=void 0;var s=function(){function I(j,U){for(var C=0;C<U.length;C++){var k=U[C];k.enumerable=k.enumerable||!1,k.configurable=!0,"value"in k&&(k.writable=!0),Object.defineProperty(j,k.key,k)}}return function(j,U,C){return U&&I(j.prototype,U),C&&I(j,C),j}}(),o=function I(j,U,C){j===null&&(j=Function.prototype);var k=Object.getOwnPropertyDescriptor(j,U);if(k===void 0){var D=Object.getPrototypeOf(j);return D===null?void 0:I(D,U,C)}else{if("value"in k)return k.value;var O=k.get;return O===void 0?void 0:O.call(C)}},l=i(0),d=_(l),f=i(4),m=_(f),y=i(25),g=_(y);function _(I){return I&&I.__esModule?I:{default:I}}function E(I,j,U){return j in I?Object.defineProperty(I,j,{value:U,enumerable:!0,configurable:!0,writable:!0}):I[j]=U,I}function x(I,j){if(!(I instanceof j))throw new TypeError("Cannot call a class as a function")}function b(I,j){if(!I)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return j&&(typeof j=="object"||typeof j=="function")?j:I}function T(I,j){if(typeof j!="function"&&j!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof j);I.prototype=Object.create(j&&j.prototype,{constructor:{value:I,enumerable:!1,writable:!0,configurable:!0}}),j&&(Object.setPrototypeOf?Object.setPrototypeOf(I,j):I.__proto__=j)}var N=function(I){T(j,I);function j(){return x(this,j),b(this,(j.__proto__||Object.getPrototypeOf(j)).apply(this,arguments))}return s(j,[{key:"format",value:function(C,k){C===R.blotName&&!k?this.replaceWith(d.default.create(this.statics.scope)):o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"format",this).call(this,C,k)}},{key:"remove",value:function(){this.prev==null&&this.next==null?this.parent.remove():o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"remove",this).call(this)}},{key:"replaceWith",value:function(C,k){return this.parent.isolate(this.offset(this.parent),this.length()),C===this.parent.statics.blotName?(this.parent.replaceWith(C,k),this):(this.parent.unwrap(),o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"replaceWith",this).call(this,C,k))}}],[{key:"formats",value:function(C){return C.tagName===this.tagName?void 0:o(j.__proto__||Object.getPrototypeOf(j),"formats",this).call(this,C)}}]),j}(m.default);N.blotName="list-item",N.tagName="LI";var R=function(I){T(j,I),s(j,null,[{key:"create",value:function(C){var k=C==="ordered"?"OL":"UL",D=o(j.__proto__||Object.getPrototypeOf(j),"create",this).call(this,k);return(C==="checked"||C==="unchecked")&&D.setAttribute("data-checked",C==="checked"),D}},{key:"formats",value:function(C){if(C.tagName==="OL")return"ordered";if(C.tagName==="UL")return C.hasAttribute("data-checked")?C.getAttribute("data-checked")==="true"?"checked":"unchecked":"bullet"}}]);function j(U){x(this,j);var C=b(this,(j.__proto__||Object.getPrototypeOf(j)).call(this,U)),k=function(O){if(O.target.parentNode===U){var P=C.statics.formats(U),F=d.default.find(O.target);P==="checked"?F.format("list","unchecked"):P==="unchecked"&&F.format("list","checked")}};return U.addEventListener("touchstart",k),U.addEventListener("mousedown",k),C}return s(j,[{key:"format",value:function(C,k){this.children.length>0&&this.children.tail.format(C,k)}},{key:"formats",value:function(){return E({},this.statics.blotName,this.statics.formats(this.domNode))}},{key:"insertBefore",value:function(C,k){if(C instanceof N)o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"insertBefore",this).call(this,C,k);else{var D=k==null?this.length():k.offset(this),O=this.split(D);O.parent.insertBefore(C,O)}}},{key:"optimize",value:function(C){o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"optimize",this).call(this,C);var k=this.next;k!=null&&k.prev===this&&k.statics.blotName===this.statics.blotName&&k.domNode.tagName===this.domNode.tagName&&k.domNode.getAttribute("data-checked")===this.domNode.getAttribute("data-checked")&&(k.moveChildren(this),k.remove())}},{key:"replace",value:function(C){if(C.statics.blotName!==this.statics.blotName){var k=d.default.create(this.statics.defaultChild);C.moveChildren(k),this.appendChild(k)}o(j.prototype.__proto__||Object.getPrototypeOf(j.prototype),"replace",this).call(this,C)}}]),j}(g.default);R.blotName="list",R.scope=d.default.Scope.BLOCK_BLOT,R.tagName=["OL","UL"],R.defaultChild="list-item",R.allowedChildren=[N],n.ListItem=N,n.default=R},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(56),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}function d(g,_){if(!(g instanceof _))throw new TypeError("Cannot call a class as a function")}function f(g,_){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:g}function m(g,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);g.prototype=Object.create(_&&_.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(g,_):g.__proto__=_)}var y=function(g){m(_,g);function _(){return d(this,_),f(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return _}(o.default);y.blotName="italic",y.tagName=["EM","I"],n.default=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function E(x,b){for(var T=0;T<b.length;T++){var N=b[T];N.enumerable=N.enumerable||!1,N.configurable=!0,"value"in N&&(N.writable=!0),Object.defineProperty(x,N.key,N)}}return function(x,b,T){return b&&E(x.prototype,b),T&&E(x,T),x}}(),o=function E(x,b,T){x===null&&(x=Function.prototype);var N=Object.getOwnPropertyDescriptor(x,b);if(N===void 0){var R=Object.getPrototypeOf(x);return R===null?void 0:E(R,b,T)}else{if("value"in N)return N.value;var I=N.get;return I===void 0?void 0:I.call(T)}},l=i(6),d=f(l);function f(E){return E&&E.__esModule?E:{default:E}}function m(E,x){if(!(E instanceof x))throw new TypeError("Cannot call a class as a function")}function y(E,x){if(!E)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return x&&(typeof x=="object"||typeof x=="function")?x:E}function g(E,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof x);E.prototype=Object.create(x&&x.prototype,{constructor:{value:E,enumerable:!1,writable:!0,configurable:!0}}),x&&(Object.setPrototypeOf?Object.setPrototypeOf(E,x):E.__proto__=x)}var _=function(E){g(x,E);function x(){return m(this,x),y(this,(x.__proto__||Object.getPrototypeOf(x)).apply(this,arguments))}return s(x,null,[{key:"create",value:function(T){return T==="super"?document.createElement("sup"):T==="sub"?document.createElement("sub"):o(x.__proto__||Object.getPrototypeOf(x),"create",this).call(this,T)}},{key:"formats",value:function(T){if(T.tagName==="SUB")return"sub";if(T.tagName==="SUP")return"super"}}]),x}(d.default);_.blotName="script",_.tagName=["SUB","SUP"],n.default=_},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(6),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}function d(g,_){if(!(g instanceof _))throw new TypeError("Cannot call a class as a function")}function f(g,_){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:g}function m(g,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);g.prototype=Object.create(_&&_.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(g,_):g.__proto__=_)}var y=function(g){m(_,g);function _(){return d(this,_),f(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return _}(o.default);y.blotName="strike",y.tagName="S",n.default=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=i(6),o=l(s);function l(g){return g&&g.__esModule?g:{default:g}}function d(g,_){if(!(g instanceof _))throw new TypeError("Cannot call a class as a function")}function f(g,_){if(!g)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return _&&(typeof _=="object"||typeof _=="function")?_:g}function m(g,_){if(typeof _!="function"&&_!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof _);g.prototype=Object.create(_&&_.prototype,{constructor:{value:g,enumerable:!1,writable:!0,configurable:!0}}),_&&(Object.setPrototypeOf?Object.setPrototypeOf(g,_):g.__proto__=_)}var y=function(g){m(_,g);function _(){return d(this,_),f(this,(_.__proto__||Object.getPrototypeOf(_)).apply(this,arguments))}return _}(o.default);y.blotName="underline",y.tagName="U",n.default=y},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function b(T,N){for(var R=0;R<N.length;R++){var I=N[R];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(T,I.key,I)}}return function(T,N,R){return N&&b(T.prototype,N),R&&b(T,R),T}}(),o=function b(T,N,R){T===null&&(T=Function.prototype);var I=Object.getOwnPropertyDescriptor(T,N);if(I===void 0){var j=Object.getPrototypeOf(T);return j===null?void 0:b(j,N,R)}else{if("value"in I)return I.value;var U=I.get;return U===void 0?void 0:U.call(R)}},l=i(0),d=m(l),f=i(27);function m(b){return b&&b.__esModule?b:{default:b}}function y(b,T){if(!(b instanceof T))throw new TypeError("Cannot call a class as a function")}function g(b,T){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T&&(typeof T=="object"||typeof T=="function")?T:b}function _(b,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof T);b.prototype=Object.create(T&&T.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(b,T):b.__proto__=T)}var E=["alt","height","width"],x=function(b){_(T,b);function T(){return y(this,T),g(this,(T.__proto__||Object.getPrototypeOf(T)).apply(this,arguments))}return s(T,[{key:"format",value:function(R,I){E.indexOf(R)>-1?I?this.domNode.setAttribute(R,I):this.domNode.removeAttribute(R):o(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"format",this).call(this,R,I)}}],[{key:"create",value:function(R){var I=o(T.__proto__||Object.getPrototypeOf(T),"create",this).call(this,R);return typeof R=="string"&&I.setAttribute("src",this.sanitize(R)),I}},{key:"formats",value:function(R){return E.reduce(function(I,j){return R.hasAttribute(j)&&(I[j]=R.getAttribute(j)),I},{})}},{key:"match",value:function(R){return/\.(jpe?g|gif|png)$/.test(R)||/^data:image\/.+;base64/.test(R)}},{key:"sanitize",value:function(R){return(0,f.sanitize)(R,["http","https","data"])?R:"//:0"}},{key:"value",value:function(R){return R.getAttribute("src")}}]),T}(d.default.Embed);x.blotName="image",x.tagName="IMG",n.default=x},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0});var s=function(){function b(T,N){for(var R=0;R<N.length;R++){var I=N[R];I.enumerable=I.enumerable||!1,I.configurable=!0,"value"in I&&(I.writable=!0),Object.defineProperty(T,I.key,I)}}return function(T,N,R){return N&&b(T.prototype,N),R&&b(T,R),T}}(),o=function b(T,N,R){T===null&&(T=Function.prototype);var I=Object.getOwnPropertyDescriptor(T,N);if(I===void 0){var j=Object.getPrototypeOf(T);return j===null?void 0:b(j,N,R)}else{if("value"in I)return I.value;var U=I.get;return U===void 0?void 0:U.call(R)}},l=i(4),d=i(27),f=m(d);function m(b){return b&&b.__esModule?b:{default:b}}function y(b,T){if(!(b instanceof T))throw new TypeError("Cannot call a class as a function")}function g(b,T){if(!b)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return T&&(typeof T=="object"||typeof T=="function")?T:b}function _(b,T){if(typeof T!="function"&&T!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof T);b.prototype=Object.create(T&&T.prototype,{constructor:{value:b,enumerable:!1,writable:!0,configurable:!0}}),T&&(Object.setPrototypeOf?Object.setPrototypeOf(b,T):b.__proto__=T)}var E=["height","width"],x=function(b){_(T,b);function T(){return y(this,T),g(this,(T.__proto__||Object.getPrototypeOf(T)).apply(this,arguments))}return s(T,[{key:"format",value:function(R,I){E.indexOf(R)>-1?I?this.domNode.setAttribute(R,I):this.domNode.removeAttribute(R):o(T.prototype.__proto__||Object.getPrototypeOf(T.prototype),"format",this).call(this,R,I)}}],[{key:"create",value:function(R){var I=o(T.__proto__||Object.getPrototypeOf(T),"create",this).call(this,R);return I.setAttribute("frameborder","0"),I.setAttribute("allowfullscreen",!0),I.setAttribute("src",this.sanitize(R)),I}},{key:"formats",value:function(R){return E.reduce(function(I,j){return R.hasAttribute(j)&&(I[j]=R.getAttribute(j)),I},{})}},{key:"sanitize",value:function(R){return f.default.sanitize(R)}},{key:"value",value:function(R){return R.getAttribute("src")}}]),T}(l.BlockEmbed);x.blotName="video",x.className="ql-video",x.tagName="IFRAME",n.default=x},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.FormulaBlot=void 0;var s=function(){function R(I,j){for(var U=0;U<j.length;U++){var C=j[U];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(I,C.key,C)}}return function(I,j,U){return j&&R(I.prototype,j),U&&R(I,U),I}}(),o=function R(I,j,U){I===null&&(I=Function.prototype);var C=Object.getOwnPropertyDescriptor(I,j);if(C===void 0){var k=Object.getPrototypeOf(I);return k===null?void 0:R(k,j,U)}else{if("value"in C)return C.value;var D=C.get;return D===void 0?void 0:D.call(U)}},l=i(35),d=_(l),f=i(5),m=_(f),y=i(9),g=_(y);function _(R){return R&&R.__esModule?R:{default:R}}function E(R,I){if(!(R instanceof I))throw new TypeError("Cannot call a class as a function")}function x(R,I){if(!R)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return I&&(typeof I=="object"||typeof I=="function")?I:R}function b(R,I){if(typeof I!="function"&&I!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof I);R.prototype=Object.create(I&&I.prototype,{constructor:{value:R,enumerable:!1,writable:!0,configurable:!0}}),I&&(Object.setPrototypeOf?Object.setPrototypeOf(R,I):R.__proto__=I)}var T=function(R){b(I,R);function I(){return E(this,I),x(this,(I.__proto__||Object.getPrototypeOf(I)).apply(this,arguments))}return s(I,null,[{key:"create",value:function(U){var C=o(I.__proto__||Object.getPrototypeOf(I),"create",this).call(this,U);return typeof U=="string"&&(window.katex.render(U,C,{throwOnError:!1,errorColor:"#f00"}),C.setAttribute("data-value",U)),C}},{key:"value",value:function(U){return U.getAttribute("data-value")}}]),I}(d.default);T.blotName="formula",T.className="ql-formula",T.tagName="SPAN";var N=function(R){b(I,R),s(I,null,[{key:"register",value:function(){m.default.register(T,!0)}}]);function I(){E(this,I);var j=x(this,(I.__proto__||Object.getPrototypeOf(I)).call(this));if(window.katex==null)throw new Error("Formula module requires KaTeX.");return j}return I}(g.default);n.FormulaBlot=T,n.default=N},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.CodeToken=n.CodeBlock=void 0;var s=function(){function U(C,k){for(var D=0;D<k.length;D++){var O=k[D];O.enumerable=O.enumerable||!1,O.configurable=!0,"value"in O&&(O.writable=!0),Object.defineProperty(C,O.key,O)}}return function(C,k,D){return k&&U(C.prototype,k),D&&U(C,D),C}}(),o=function U(C,k,D){C===null&&(C=Function.prototype);var O=Object.getOwnPropertyDescriptor(C,k);if(O===void 0){var P=Object.getPrototypeOf(C);return P===null?void 0:U(P,k,D)}else{if("value"in O)return O.value;var F=O.get;return F===void 0?void 0:F.call(D)}},l=i(0),d=x(l),f=i(5),m=x(f),y=i(9),g=x(y),_=i(13),E=x(_);function x(U){return U&&U.__esModule?U:{default:U}}function b(U,C){if(!(U instanceof C))throw new TypeError("Cannot call a class as a function")}function T(U,C){if(!U)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return C&&(typeof C=="object"||typeof C=="function")?C:U}function N(U,C){if(typeof C!="function"&&C!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof C);U.prototype=Object.create(C&&C.prototype,{constructor:{value:U,enumerable:!1,writable:!0,configurable:!0}}),C&&(Object.setPrototypeOf?Object.setPrototypeOf(U,C):U.__proto__=C)}var R=function(U){N(C,U);function C(){return b(this,C),T(this,(C.__proto__||Object.getPrototypeOf(C)).apply(this,arguments))}return s(C,[{key:"replaceWith",value:function(D){this.domNode.textContent=this.domNode.textContent,this.attach(),o(C.prototype.__proto__||Object.getPrototypeOf(C.prototype),"replaceWith",this).call(this,D)}},{key:"highlight",value:function(D){var O=this.domNode.textContent;this.cachedText!==O&&((O.trim().length>0||this.cachedText==null)&&(this.domNode.innerHTML=D(O),this.domNode.normalize(),this.attach()),this.cachedText=O)}}]),C}(E.default);R.className="ql-syntax";var I=new d.default.Attributor.Class("token","hljs",{scope:d.default.Scope.INLINE}),j=function(U){N(C,U),s(C,null,[{key:"register",value:function(){m.default.register(I,!0),m.default.register(R,!0)}}]);function C(k,D){b(this,C);var O=T(this,(C.__proto__||Object.getPrototypeOf(C)).call(this,k,D));if(typeof O.options.highlight!="function")throw new Error("Syntax module requires highlight.js. Please include the library on the page before Quill.");var P=null;return O.quill.on(m.default.events.SCROLL_OPTIMIZE,function(){clearTimeout(P),P=setTimeout(function(){O.highlight(),P=null},O.options.interval)}),O.highlight(),O}return s(C,[{key:"highlight",value:function(){var D=this;if(!this.quill.selection.composing){this.quill.update(m.default.sources.USER);var O=this.quill.getSelection();this.quill.scroll.descendants(R).forEach(function(P){P.highlight(D.options.highlight)}),this.quill.update(m.default.sources.SILENT),O!=null&&this.quill.setSelection(O,m.default.sources.SILENT)}}}]),C}(g.default);j.DEFAULTS={highlight:function(){return window.hljs==null?null:function(U){var C=window.hljs.highlightAuto(U);return C.value}}(),interval:1e3},n.CodeBlock=R,n.CodeToken=I,n.default=j},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=13 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=9 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=14 x2=4 y1=14 y2=14></line> <line class=ql-stroke x1=12 x2=6 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=5 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=9 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=15 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=15 x2=3 y1=14 y2=14></line> <line class=ql-stroke x1=15 x2=3 y1=4 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <g class="ql-fill ql-color-label"> <polygon points="6 6.868 6 6 5 6 5 7 5.942 7 6 6.868"></polygon> <rect height=1 width=1 x=4 y=4></rect> <polygon points="6.817 5 6 5 6 6 6.38 6 6.817 5"></polygon> <rect height=1 width=1 x=2 y=6></rect> <rect height=1 width=1 x=3 y=5></rect> <rect height=1 width=1 x=4 y=7></rect> <polygon points="4 11.439 4 11 3 11 3 12 3.755 12 4 11.439"></polygon> <rect height=1 width=1 x=2 y=12></rect> <rect height=1 width=1 x=2 y=9></rect> <rect height=1 width=1 x=2 y=15></rect> <polygon points="4.63 10 4 10 4 11 4.192 11 4.63 10"></polygon> <rect height=1 width=1 x=3 y=8></rect> <path d=M10.832,4.2L11,4.582V4H10.708A1.948,1.948,0,0,1,10.832,4.2Z></path> <path d=M7,4.582L7.168,4.2A1.929,1.929,0,0,1,7.292,4H7V4.582Z></path> <path d=M8,13H7.683l-0.351.8a1.933,1.933,0,0,1-.124.2H8V13Z></path> <rect height=1 width=1 x=12 y=2></rect> <rect height=1 width=1 x=11 y=3></rect> <path d=M9,3H8V3.282A1.985,1.985,0,0,1,9,3Z></path> <rect height=1 width=1 x=2 y=3></rect> <rect height=1 width=1 x=6 y=2></rect> <rect height=1 width=1 x=3 y=2></rect> <rect height=1 width=1 x=5 y=3></rect> <rect height=1 width=1 x=9 y=2></rect> <rect height=1 width=1 x=15 y=14></rect> <polygon points="13.447 10.174 13.469 10.225 13.472 10.232 13.808 11 14 11 14 10 13.37 10 13.447 10.174"></polygon> <rect height=1 width=1 x=13 y=7></rect> <rect height=1 width=1 x=15 y=5></rect> <rect height=1 width=1 x=14 y=6></rect> <rect height=1 width=1 x=15 y=8></rect> <rect height=1 width=1 x=14 y=9></rect> <path d=M3.775,14H3v1H4V14.314A1.97,1.97,0,0,1,3.775,14Z></path> <rect height=1 width=1 x=14 y=3></rect> <polygon points="12 6.868 12 6 11.62 6 12 6.868"></polygon> <rect height=1 width=1 x=15 y=2></rect> <rect height=1 width=1 x=12 y=5></rect> <rect height=1 width=1 x=13 y=4></rect> <polygon points="12.933 9 13 9 13 8 12.495 8 12.933 9"></polygon> <rect height=1 width=1 x=9 y=14></rect> <rect height=1 width=1 x=8 y=15></rect> <path d=M6,14.926V15H7V14.316A1.993,1.993,0,0,1,6,14.926Z></path> <rect height=1 width=1 x=5 y=15></rect> <path d=M10.668,13.8L10.317,13H10v1h0.792A1.947,1.947,0,0,1,10.668,13.8Z></path> <rect height=1 width=1 x=11 y=15></rect> <path d=M14.332,12.2a1.99,1.99,0,0,1,.166.8H15V12H14.245Z></path> <rect height=1 width=1 x=14 y=15></rect> <rect height=1 width=1 x=15 y=11></rect> </g> <polyline class=ql-stroke points="5.5 13 9 5 12.5 13"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=11 y2=11></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class="ql-fill ql-stroke" height=3 width=3 x=4 y=5></rect> <rect class="ql-fill ql-stroke" height=3 width=3 x=11 y=5></rect> <path class="ql-even ql-fill ql-stroke" d=M7,8c0,4.031-3,5-3,5></path> <path class="ql-even ql-fill ql-stroke" d=M14,8c0,4.031-3,5-3,5></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,4H9.5A2.5,2.5,0,0,1,12,6.5v0A2.5,2.5,0,0,1,9.5,9H5A0,0,0,0,1,5,9V4A0,0,0,0,1,5,4Z></path> <path class=ql-stroke d=M5,9h5.5A2.5,2.5,0,0,1,13,11.5v0A2.5,2.5,0,0,1,10.5,14H5a0,0,0,0,1,0,0V9A0,0,0,0,1,5,9Z></path> </svg>'},function(t,n){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=5 x2=13 y1=3 y2=3></line> <line class=ql-stroke x1=6 x2=9.35 y1=12 y2=3></line> <line class=ql-stroke x1=11 x2=15 y1=11 y2=15></line> <line class=ql-stroke x1=15 x2=11 y1=11 y2=15></line> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=7 x=2 y=14></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-color-label ql-stroke ql-transparent" x1=3 x2=15 y1=15 y2=15></line> <polyline class=ql-stroke points="5.5 11 9 3 12.5 11"></polyline> <line class=ql-stroke x1=11.63 x2=6.38 y1=9 y2=9></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="3 11 5 9 3 7 3 11"></polygon> <line class="ql-stroke ql-fill" x1=15 x2=11 y1=4 y2=4></line> <path class=ql-fill d=M11,3a3,3,0,0,0,0,6h1V3H11Z></path> <rect class=ql-fill height=11 width=1 x=11 y=4></rect> <rect class=ql-fill height=11 width=1 x=13 y=4></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class="ql-stroke ql-fill" points="15 12 13 10 15 8 15 12"></polygon> <line class="ql-stroke ql-fill" x1=9 x2=5 y1=4 y2=4></line> <path class=ql-fill d=M5,3A3,3,0,0,0,5,9H6V3H5Z></path> <rect class=ql-fill height=11 width=1 x=5 y=4></rect> <rect class=ql-fill height=11 width=1 x=7 y=4></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M14,16H4a1,1,0,0,1,0-2H14A1,1,0,0,1,14,16Z /> <path class=ql-fill d=M14,4H4A1,1,0,0,1,4,2H14A1,1,0,0,1,14,4Z /> <rect class=ql-fill x=3 y=6 width=12 height=6 rx=1 ry=1 /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M13,16H5a1,1,0,0,1,0-2h8A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H5A1,1,0,0,1,5,2h8A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=2 y=6 width=14 height=6 rx=1 ry=1 /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15,8H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,8Z /> <path class=ql-fill d=M15,12H13a1,1,0,0,1,0-2h2A1,1,0,0,1,15,12Z /> <path class=ql-fill d=M15,16H5a1,1,0,0,1,0-2H15A1,1,0,0,1,15,16Z /> <path class=ql-fill d=M15,4H5A1,1,0,0,1,5,2H15A1,1,0,0,1,15,4Z /> <rect class=ql-fill x=2 y=6 width=8 height=6 rx=1 ry=1 /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M5,8H3A1,1,0,0,1,3,6H5A1,1,0,0,1,5,8Z /> <path class=ql-fill d=M5,12H3a1,1,0,0,1,0-2H5A1,1,0,0,1,5,12Z /> <path class=ql-fill d=M13,16H3a1,1,0,0,1,0-2H13A1,1,0,0,1,13,16Z /> <path class=ql-fill d=M13,4H3A1,1,0,0,1,3,2H13A1,1,0,0,1,13,4Z /> <rect class=ql-fill x=8 y=6 width=8 height=6 rx=1 ry=1 transform="translate(24 18) rotate(-180)"/> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M11.759,2.482a2.561,2.561,0,0,0-3.53.607A7.656,7.656,0,0,0,6.8,6.2C6.109,9.188,5.275,14.677,4.15,14.927a1.545,1.545,0,0,0-1.3-.933A0.922,0.922,0,0,0,2,15.036S1.954,16,4.119,16s3.091-2.691,3.7-5.553c0.177-.826.36-1.726,0.554-2.6L8.775,6.2c0.381-1.421.807-2.521,1.306-2.676a1.014,1.014,0,0,0,1.02.56A0.966,0.966,0,0,0,11.759,2.482Z></path> <rect class=ql-fill height=1.6 rx=0.8 ry=0.8 width=5 x=5.15 y=6.2></rect> <path class=ql-fill d=M13.663,12.027a1.662,1.662,0,0,1,.266-0.276q0.193,0.069.456,0.138a2.1,2.1,0,0,0,.535.069,1.075,1.075,0,0,0,.767-0.3,1.044,1.044,0,0,0,.314-0.8,0.84,0.84,0,0,0-.238-0.619,0.8,0.8,0,0,0-.594-0.239,1.154,1.154,0,0,0-.781.3,4.607,4.607,0,0,0-.781,1q-0.091.15-.218,0.346l-0.246.38c-0.068-.288-0.137-0.582-0.212-0.885-0.459-1.847-2.494-.984-2.941-0.8-0.482.2-.353,0.647-0.094,0.529a0.869,0.869,0,0,1,1.281.585c0.217,0.751.377,1.436,0.527,2.038a5.688,5.688,0,0,1-.362.467,2.69,2.69,0,0,1-.264.271q-0.221-.08-0.471-0.147a2.029,2.029,0,0,0-.522-0.066,1.079,1.079,0,0,0-.768.3A1.058,1.058,0,0,0,9,15.131a0.82,0.82,0,0,0,.832.852,1.134,1.134,0,0,0,.787-0.3,5.11,5.11,0,0,0,.776-0.993q0.141-.219.215-0.34c0.046-.076.122-0.194,0.223-0.346a2.786,2.786,0,0,0,.918,1.726,2.582,2.582,0,0,0,2.376-.185c0.317-.181.212-0.565,0-0.494A0.807,0.807,0,0,1,14.176,15a5.159,5.159,0,0,1-.913-2.446l0,0Q13.487,12.24,13.663,12.027Z></path> </svg>'},function(t,n){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M10,4V14a1,1,0,0,1-2,0V10H3v4a1,1,0,0,1-2,0V4A1,1,0,0,1,3,4V8H8V4a1,1,0,0,1,2,0Zm6.06787,9.209H14.98975V7.59863a.54085.54085,0,0,0-.605-.60547h-.62744a1.01119,1.01119,0,0,0-.748.29688L11.645,8.56641a.5435.5435,0,0,0-.022.8584l.28613.30762a.53861.53861,0,0,0,.84717.0332l.09912-.08789a1.2137,1.2137,0,0,0,.2417-.35254h.02246s-.01123.30859-.01123.60547V13.209H12.041a.54085.54085,0,0,0-.605.60547v.43945a.54085.54085,0,0,0,.605.60547h4.02686a.54085.54085,0,0,0,.605-.60547v-.43945A.54085.54085,0,0,0,16.06787,13.209Z /> </svg>'},function(t,n){t.exports='<svg viewBox="0 0 18 18"> <path class=ql-fill d=M16.73975,13.81445v.43945a.54085.54085,0,0,1-.605.60547H11.855a.58392.58392,0,0,1-.64893-.60547V14.0127c0-2.90527,3.39941-3.42187,3.39941-4.55469a.77675.77675,0,0,0-.84717-.78125,1.17684,1.17684,0,0,0-.83594.38477c-.2749.26367-.561.374-.85791.13184l-.4292-.34082c-.30811-.24219-.38525-.51758-.1543-.81445a2.97155,2.97155,0,0,1,2.45361-1.17676,2.45393,2.45393,0,0,1,2.68408,2.40918c0,2.45312-3.1792,2.92676-3.27832,3.93848h2.79443A.54085.54085,0,0,1,16.73975,13.81445ZM9,3A.99974.99974,0,0,0,8,4V8H3V4A1,1,0,0,0,1,4V14a1,1,0,0,0,2,0V10H8v4a1,1,0,0,0,2,0V4A.99974.99974,0,0,0,9,3Z /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=13 y1=4 y2=4></line> <line class=ql-stroke x1=5 x2=11 y1=14 y2=14></line> <line class=ql-stroke x1=8 x2=10 y1=14 y2=4></line> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=10 width=12 x=3 y=4></rect> <circle class=ql-fill cx=6 cy=7 r=1></circle> <polyline class="ql-even ql-fill" points="5 12 5 11 7 9 8 10 11 7 13 9 13 12 5 12"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class="ql-fill ql-stroke" points="3 7 3 11 5 9 3 7"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=3 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="5 7 5 11 3 9 5 7"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=11 y1=7 y2=11></line> <path class="ql-even ql-stroke" d=M8.9,4.577a3.476,3.476,0,0,1,.36,4.679A3.476,3.476,0,0,1,4.577,8.9C3.185,7.5,2.035,6.4,4.217,4.217S7.5,3.185,8.9,4.577Z></path> <path class="ql-even ql-stroke" d=M13.423,9.1a3.476,3.476,0,0,0-4.679-.36,3.476,3.476,0,0,0,.36,4.679c1.392,1.392,2.5,2.542,4.679.36S14.815,10.5,13.423,9.1Z></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=7 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=7 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=7 x2=15 y1=14 y2=14></line> <line class="ql-stroke ql-thin" x1=2.5 x2=4.5 y1=5.5 y2=5.5></line> <path class=ql-fill d=M3.5,6A0.5,0.5,0,0,1,3,5.5V3.085l-0.276.138A0.5,0.5,0,0,1,2.053,3c-0.124-.247-0.023-0.324.224-0.447l1-.5A0.5,0.5,0,0,1,4,2.5v3A0.5,0.5,0,0,1,3.5,6Z></path> <path class="ql-stroke ql-thin" d=M4.5,10.5h-2c0-.234,1.85-1.076,1.85-2.234A0.959,0.959,0,0,0,2.5,8.156></path> <path class="ql-stroke ql-thin" d=M2.5,14.846a0.959,0.959,0,0,0,1.85-.109A0.7,0.7,0,0,0,3.75,14a0.688,0.688,0,0,0,.6-0.736,0.959,0.959,0,0,0-1.85-.109></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class=ql-stroke x1=6 x2=15 y1=4 y2=4></line> <line class=ql-stroke x1=6 x2=15 y1=9 y2=9></line> <line class=ql-stroke x1=6 x2=15 y1=14 y2=14></line> <line class=ql-stroke x1=3 x2=3 y1=4 y2=4></line> <line class=ql-stroke x1=3 x2=3 y1=9 y2=9></line> <line class=ql-stroke x1=3 x2=3 y1=14 y2=14></line> </svg>'},function(t,n){t.exports='<svg class="" viewbox="0 0 18 18"> <line class=ql-stroke x1=9 x2=15 y1=4 y2=4></line> <polyline class=ql-stroke points="3 4 4 5 6 3"></polyline> <line class=ql-stroke x1=9 x2=15 y1=14 y2=14></line> <polyline class=ql-stroke points="3 14 4 15 6 13"></polyline> <line class=ql-stroke x1=9 x2=15 y1=9 y2=9></line> <polyline class=ql-stroke points="3 9 4 10 6 8"></polyline> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,15H13.861a3.858,3.858,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.921,1.921,0,0,0,12.021,11.7a0.50013,0.50013,0,1,0,.957.291h0a0.914,0.914,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.076-1.16971,1.86982-1.93971,2.43082A1.45639,1.45639,0,0,0,12,15.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,15Z /> <path class=ql-fill d=M9.65,5.241a1,1,0,0,0-1.409.108L6,7.964,3.759,5.349A1,1,0,0,0,2.192,6.59178Q2.21541,6.6213,2.241,6.649L4.684,9.5,2.241,12.35A1,1,0,0,0,3.71,13.70722q0.02557-.02768.049-0.05722L6,11.036,8.241,13.65a1,1,0,1,0,1.567-1.24277Q9.78459,12.3777,9.759,12.35L7.316,9.5,9.759,6.651A1,1,0,0,0,9.65,5.241Z /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-fill d=M15.5,7H13.861a4.015,4.015,0,0,0,1.914-2.975,1.8,1.8,0,0,0-1.6-1.751A1.922,1.922,0,0,0,12.021,3.7a0.5,0.5,0,1,0,.957.291,0.917,0.917,0,0,1,1.053-.725,0.81,0.81,0,0,1,.744.762c0,1.077-1.164,1.925-1.934,2.486A1.423,1.423,0,0,0,12,7.5a0.5,0.5,0,0,0,.5.5h3A0.5,0.5,0,0,0,15.5,7Z /> <path class=ql-fill d=M9.651,5.241a1,1,0,0,0-1.41.108L6,7.964,3.759,5.349a1,1,0,1,0-1.519,1.3L4.683,9.5,2.241,12.35a1,1,0,1,0,1.519,1.3L6,11.036,8.241,13.65a1,1,0,0,0,1.519-1.3L7.317,9.5,9.759,6.651A1,1,0,0,0,9.651,5.241Z /> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <line class="ql-stroke ql-thin" x1=15.5 x2=2.5 y1=8.5 y2=9.5></line> <path class=ql-fill d=M9.007,8C6.542,7.791,6,7.519,6,6.5,6,5.792,7.283,5,9,5c1.571,0,2.765.679,2.969,1.309a1,1,0,0,0,1.9-.617C13.356,4.106,11.354,3,9,3,6.2,3,4,4.538,4,6.5a3.2,3.2,0,0,0,.5,1.843Z></path> <path class=ql-fill d=M8.984,10C11.457,10.208,12,10.479,12,11.5c0,0.708-1.283,1.5-3,1.5-1.571,0-2.765-.679-2.969-1.309a1,1,0,1,0-1.9.617C4.644,13.894,6.646,15,9,15c2.8,0,5-1.538,5-3.5a3.2,3.2,0,0,0-.5-1.843Z></path> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <path class=ql-stroke d=M5,3V9a4.012,4.012,0,0,0,4,4H9a4.012,4.012,0,0,0,4-4V3></path> <rect class=ql-fill height=1 rx=0.5 ry=0.5 width=12 x=3 y=15></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <rect class=ql-stroke height=12 width=12 x=3 y=3></rect> <rect class=ql-fill height=12 width=1 x=5 y=3></rect> <rect class=ql-fill height=12 width=1 x=12 y=3></rect> <rect class=ql-fill height=2 width=8 x=5 y=8></rect> <rect class=ql-fill height=1 width=3 x=3 y=5></rect> <rect class=ql-fill height=1 width=3 x=3 y=7></rect> <rect class=ql-fill height=1 width=3 x=3 y=10></rect> <rect class=ql-fill height=1 width=3 x=3 y=12></rect> <rect class=ql-fill height=1 width=3 x=12 y=5></rect> <rect class=ql-fill height=1 width=3 x=12 y=7></rect> <rect class=ql-fill height=1 width=3 x=12 y=10></rect> <rect class=ql-fill height=1 width=3 x=12 y=12></rect> </svg>'},function(t,n){t.exports='<svg viewbox="0 0 18 18"> <polygon class=ql-stroke points="7 11 9 13 11 11 7 11"></polygon> <polygon class=ql-stroke points="7 7 9 5 11 7 7 7"></polygon> </svg>'},function(t,n,i){Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.BubbleTooltip=void 0;var s=function C(k,D,O){k===null&&(k=Function.prototype);var P=Object.getOwnPropertyDescriptor(k,D);if(P===void 0){var F=Object.getPrototypeOf(k);return F===null?void 0:C(F,D,O)}else{if("value"in P)return P.value;var M=P.get;return M===void 0?void 0:M.call(O)}},o=function(){function C(k,D){for(var O=0;O<D.length;O++){var P=D[O];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(k,P.key,P)}}return function(k,D,O){return D&&C(k.prototype,D),O&&C(k,O),k}}(),l=i(3),d=b(l),f=i(8),m=b(f),y=i(43),g=b(y),_=i(15),E=i(41),x=b(E);function b(C){return C&&C.__esModule?C:{default:C}}function T(C,k){if(!(C instanceof k))throw new TypeError("Cannot call a class as a function")}function N(C,k){if(!C)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return k&&(typeof k=="object"||typeof k=="function")?k:C}function R(C,k){if(typeof k!="function"&&k!==null)throw new TypeError("Super expression must either be null or a function, not "+typeof k);C.prototype=Object.create(k&&k.prototype,{constructor:{value:C,enumerable:!1,writable:!0,configurable:!0}}),k&&(Object.setPrototypeOf?Object.setPrototypeOf(C,k):C.__proto__=k)}var I=[["bold","italic","link"],[{header:1},{header:2},"blockquote"]],j=function(C){R(k,C);function k(D,O){T(this,k),O.modules.toolbar!=null&&O.modules.toolbar.container==null&&(O.modules.toolbar.container=I);var P=N(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,D,O));return P.quill.container.classList.add("ql-bubble"),P}return o(k,[{key:"extendToolbar",value:function(O){this.tooltip=new U(this.quill,this.options.bounds),this.tooltip.root.appendChild(O.container),this.buildButtons([].slice.call(O.container.querySelectorAll("button")),x.default),this.buildPickers([].slice.call(O.container.querySelectorAll("select")),x.default)}}]),k}(g.default);j.DEFAULTS=(0,d.default)(!0,{},g.default.DEFAULTS,{modules:{toolbar:{handlers:{link:function(k){k?this.quill.theme.tooltip.edit():this.quill.format("link",!1)}}}}});var U=function(C){R(k,C);function k(D,O){T(this,k);var P=N(this,(k.__proto__||Object.getPrototypeOf(k)).call(this,D,O));return P.quill.on(m.default.events.EDITOR_CHANGE,function(F,M,$,Y){if(F===m.default.events.SELECTION_CHANGE)if(M!=null&&M.length>0&&Y===m.default.sources.USER){P.show(),P.root.style.left="0px",P.root.style.width="",P.root.style.width=P.root.offsetWidth+"px";var te=P.quill.getLines(M.index,M.length);if(te.length===1)P.position(P.quill.getBounds(M));else{var oe=te[te.length-1],ie=P.quill.getIndex(oe),ne=Math.min(oe.length()-1,M.index+M.length-ie),K=P.quill.getBounds(new _.Range(ie,ne));P.position(K)}}else document.activeElement!==P.textbox&&P.quill.hasFocus()&&P.hide()}),P}return o(k,[{key:"listen",value:function(){var O=this;s(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"listen",this).call(this),this.root.querySelector(".ql-close").addEventListener("click",function(){O.root.classList.remove("ql-editing")}),this.quill.on(m.default.events.SCROLL_OPTIMIZE,function(){setTimeout(function(){if(!O.root.classList.contains("ql-hidden")){var P=O.quill.getSelection();P!=null&&O.position(O.quill.getBounds(P))}},1)})}},{key:"cancel",value:function(){this.show()}},{key:"position",value:function(O){var P=s(k.prototype.__proto__||Object.getPrototypeOf(k.prototype),"position",this).call(this,O),F=this.root.querySelector(".ql-tooltip-arrow");if(F.style.marginLeft="",P===0)return P;F.style.marginLeft=-1*P-F.offsetWidth/2+"px"}}]),k}(y.BaseTooltip);U.TEMPLATE=['<span class="ql-tooltip-arrow"></span>','<div class="ql-tooltip-editor">','<input type="text" data-formula="e=mc^2" data-link="https://quilljs.com" data-video="Embed URL">','<a class="ql-close"></a>',"</div>"].join(""),n.BubbleTooltip=U,n.default=j},function(t,n,i){t.exports=i(63)}]).default})}(Ag)),Ag.exports}var to,f4;function v$(){if(f4)return to;f4=1;var r=to&&to.__extends||function(){var m=function(y,g){return m=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(_,E){_.__proto__=E}||function(_,E){for(var x in E)E.hasOwnProperty(x)&&(_[x]=E[x])},m(y,g)};return function(y,g){m(y,g);function _(){this.constructor=y}y.prototype=g===null?Object.create(g):(_.prototype=g.prototype,new _)}}(),e=to&&to.__assign||function(){return e=Object.assign||function(m){for(var y,g=1,_=arguments.length;g<_;g++){y=arguments[g];for(var E in y)Object.prototype.hasOwnProperty.call(y,E)&&(m[E]=y[E])}return m},e.apply(this,arguments)},t=to&&to.__spreadArrays||function(){for(var m=0,y=0,g=arguments.length;y<g;y++)m+=arguments[y].length;for(var _=Array(m),E=0,y=0;y<g;y++)for(var x=arguments[y],b=0,T=x.length;b<T;b++,E++)_[E]=x[b];return _},n=to&&to.__importDefault||function(m){return m&&m.__esModule?m:{default:m}},i=n(vy()),s=n(Xx()),o=n(p$()),l=n(y$()),d=function(m){r(y,m);function y(g){var _=m.call(this,g)||this;_.dirtyProps=["modules","formats","bounds","theme","children"],_.cleanProps=["id","className","style","placeholder","tabIndex","onChange","onChangeSelection","onFocus","onBlur","onKeyPress","onKeyDown","onKeyUp"],_.state={generation:0},_.selection=null,_.onEditorChange=function(x,b,T,N){var R,I,j,U;x==="text-change"?(I=(R=_).onEditorChangeText)===null||I===void 0||I.call(R,_.editor.root.innerHTML,b,N,_.unprivilegedEditor):x==="selection-change"&&((U=(j=_).onEditorChangeSelection)===null||U===void 0||U.call(j,b,N,_.unprivilegedEditor))};var E=_.isControlled()?g.value:g.defaultValue;return _.value=E??"",_}return y.prototype.validateProps=function(g){var _;if(i.default.Children.count(g.children)>1)throw new Error("The Quill editing area can only be composed of a single React element.");if(i.default.Children.count(g.children)){var E=i.default.Children.only(g.children);if(((_=E)===null||_===void 0?void 0:_.type)==="textarea")throw new Error("Quill does not support editing on a <textarea>. Use a <div> instead.")}if(this.lastDeltaChangeSet&&g.value===this.lastDeltaChangeSet)throw new Error("You are passing the `delta` object from the `onChange` event back as `value`. You most probably want `editor.getContents()` instead. See: https://github.com/zenoamaro/react-quill#using-deltas")},y.prototype.shouldComponentUpdate=function(g,_){var E=this,x;if(this.validateProps(g),!this.editor||this.state.generation!==_.generation)return!0;if("value"in g){var b=this.getEditorContents(),T=(x=g.value,x??"");this.isEqualValue(T,b)||this.setEditorContents(this.editor,T)}return g.readOnly!==this.props.readOnly&&this.setEditorReadOnly(this.editor,g.readOnly),t(this.cleanProps,this.dirtyProps).some(function(N){return!o.default(g[N],E.props[N])})},y.prototype.shouldComponentRegenerate=function(g){var _=this;return this.dirtyProps.some(function(E){return!o.default(g[E],_.props[E])})},y.prototype.componentDidMount=function(){this.instantiateEditor(),this.setEditorContents(this.editor,this.getEditorContents())},y.prototype.componentWillUnmount=function(){this.destroyEditor()},y.prototype.componentDidUpdate=function(g,_){var E=this;if(this.editor&&this.shouldComponentRegenerate(g)){var x=this.editor.getContents(),b=this.editor.getSelection();this.regenerationSnapshot={delta:x,selection:b},this.setState({generation:this.state.generation+1}),this.destroyEditor()}if(this.state.generation!==_.generation){var T=this.regenerationSnapshot,x=T.delta,N=T.selection;delete this.regenerationSnapshot,this.instantiateEditor();var R=this.editor;R.setContents(x),f(function(){return E.setEditorSelection(R,N)})}},y.prototype.instantiateEditor=function(){this.editor?this.hookEditor(this.editor):this.editor=this.createEditor(this.getEditingArea(),this.getEditorConfig())},y.prototype.destroyEditor=function(){this.editor&&this.unhookEditor(this.editor)},y.prototype.isControlled=function(){return"value"in this.props},y.prototype.getEditorConfig=function(){return{bounds:this.props.bounds,formats:this.props.formats,modules:this.props.modules,placeholder:this.props.placeholder,readOnly:this.props.readOnly,scrollingContainer:this.props.scrollingContainer,tabIndex:this.props.tabIndex,theme:this.props.theme}},y.prototype.getEditor=function(){if(!this.editor)throw new Error("Accessing non-instantiated editor");return this.editor},y.prototype.createEditor=function(g,_){var E=new l.default(g,_);return _.tabIndex!=null&&this.setEditorTabIndex(E,_.tabIndex),this.hookEditor(E),E},y.prototype.hookEditor=function(g){this.unprivilegedEditor=this.makeUnprivilegedEditor(g),g.on("editor-change",this.onEditorChange)},y.prototype.unhookEditor=function(g){g.off("editor-change",this.onEditorChange)},y.prototype.getEditorContents=function(){return this.value},y.prototype.getEditorSelection=function(){return this.selection},y.prototype.isDelta=function(g){return g&&g.ops},y.prototype.isEqualValue=function(g,_){return this.isDelta(g)&&this.isDelta(_)?o.default(g.ops,_.ops):o.default(g,_)},y.prototype.setEditorContents=function(g,_){var E=this;this.value=_;var x=this.getEditorSelection();typeof _=="string"?g.setContents(g.clipboard.convert(_)):g.setContents(_),f(function(){return E.setEditorSelection(g,x)})},y.prototype.setEditorSelection=function(g,_){if(this.selection=_,_){var E=g.getLength();_.index=Math.max(0,Math.min(_.index,E-1)),_.length=Math.max(0,Math.min(_.length,E-1-_.index)),g.setSelection(_)}},y.prototype.setEditorTabIndex=function(g,_){var E,x;!((x=(E=g)===null||E===void 0?void 0:E.scroll)===null||x===void 0)&&x.domNode&&(g.scroll.domNode.tabIndex=_)},y.prototype.setEditorReadOnly=function(g,_){_?g.disable():g.enable()},y.prototype.makeUnprivilegedEditor=function(g){var _=g;return{getHTML:function(){return _.root.innerHTML},getLength:_.getLength.bind(_),getText:_.getText.bind(_),getContents:_.getContents.bind(_),getSelection:_.getSelection.bind(_),getBounds:_.getBounds.bind(_)}},y.prototype.getEditingArea=function(){if(!this.editingArea)throw new Error("Instantiating on missing editing area");var g=s.default.findDOMNode(this.editingArea);if(!g)throw new Error("Cannot find element for editing area");if(g.nodeType===3)throw new Error("Editing area cannot be a text node");return g},y.prototype.renderEditingArea=function(){var g=this,_=this.props,E=_.children,x=_.preserveWhitespace,b=this.state.generation,T={key:b,ref:function(N){g.editingArea=N}};return i.default.Children.count(E)?i.default.cloneElement(i.default.Children.only(E),T):x?i.default.createElement("pre",e({},T)):i.default.createElement("div",e({},T))},y.prototype.render=function(){var g;return i.default.createElement("div",{id:this.props.id,style:this.props.style,key:this.state.generation,className:"quill "+(g=this.props.className,g??""),onKeyPress:this.props.onKeyPress,onKeyDown:this.props.onKeyDown,onKeyUp:this.props.onKeyUp},this.renderEditingArea())},y.prototype.onEditorChangeText=function(g,_,E,x){var b,T;if(this.editor){var N=this.isDelta(this.value)?x.getContents():x.getHTML();N!==this.getEditorContents()&&(this.lastDeltaChangeSet=_,this.value=N,(T=(b=this.props).onChange)===null||T===void 0||T.call(b,g,_,E,x))}},y.prototype.onEditorChangeSelection=function(g,_,E){var x,b,T,N,R,I;if(this.editor){var j=this.getEditorSelection(),U=!j&&g,C=j&&!g;o.default(g,j)||(this.selection=g,(b=(x=this.props).onChangeSelection)===null||b===void 0||b.call(x,g,_,E),U?(N=(T=this.props).onFocus)===null||N===void 0||N.call(T,g,_,E):C&&((I=(R=this.props).onBlur)===null||I===void 0||I.call(R,j,_,E)))}},y.prototype.focus=function(){this.editor&&this.editor.focus()},y.prototype.blur=function(){this.editor&&(this.selection=null,this.editor.blur())},y.displayName="React Quill",y.Quill=l.default,y.defaultProps={theme:"snow",modules:{},readOnly:!1},y}(i.default.Component);function f(m){Promise.resolve().then(m)}return to=d,to}var _$=v$();const x$=Qx(_$),b$={toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["link"],[{color:[]},{background:[]}],[{align:[]}],["clean"]]},w$=["header","bold","italic","underline","strike","list","bullet","link","color","background","align"],g0=({value:r,onChange:e,placeholder:t,readOnly:n=!1,theme:i="snow",className:s=""})=>u.jsx(x$,{theme:i,value:r||"",onChange:e,modules:b$,formats:w$,placeholder:t,readOnly:n,className:s}),E$=({isOpen:r,onClose:e,ticket:t,db:n,adminUserData:i,showNotification:s,onTicketUpdate:o})=>{const[l,d]=J.useState(null),[f,m]=J.useState(""),[y,g]=J.useState(""),[_,E]=J.useState(!1),[x,b]=J.useState(!1),[T,N]=J.useState(!1),R=J.useRef(null);if(J.useEffect(()=>{t?(d(t),m(t.status||"Open"),g("")):d(null)},[t]),J.useEffect(()=>{var M;(M=R.current)==null||M.scrollIntoView({behavior:"smooth",block:"end"})},[l==null?void 0:l.conversation]),!r||!l)return null;const I="w-full px-3 py-2 rounded-md bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm",j="flex items-center justify-center px-4 py-2 rounded-md font-semibold text-sm transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95",U=async()=>{if(!f||f===l.status){s("Status is unchanged or invalid.","info");return}E(!0);const M={status:f,lastUpdatedByAdminName:i.displayName||"Admin",lastUpdatedByAdminId:i.uid},$=await l9(n,l.id,M);if($.success){s("Ticket status updated!","success");const Y={...l,...M,status:f,lastUpdatedAt:jt.now()};d(Y),o&&o(Y)}else s($.error||"Failed to update status.","error");E(!1)},C=M=>{g(M)},k=async()=>{if(!y.replace(/<[^>]*>?/gm,"").trim()){s("Reply cannot be empty.","warning");return}b(!0);const Y={text:uo.sanitize(y),authorId:i.uid,authorName:i.displayName||"Admin",authorRole:i.role||"admin",timestamp:jt.now()},te=await KC(n,l.id,Y);if(te.success){s("Reply sent!","success");const oe=[...l.conversation||[],Y],ie=f==="Open"||f==="Awaiting Customer"?"In Progress":f,ne={...l,conversation:oe,lastUpdatedAt:jt.now(),status:ie};ie!==f&&m(ie),d(ne),o&&o(ne),g("")}else s(te.error||"Failed to send reply.","error");b(!1)},D=async()=>{const M=y.replace(/<[^>]*>?/gm,"").trim();if(!M){s("Write a draft or keywords first.","warning");return}N(!0);try{const $=(l.conversation||[]).map(te=>`${te.authorRole==="admin"?"Support":"Customer"}: ${te.text.replace(/<[^>]*>?/gm,"")}`).join(`

`),Y=await p3({ticketDescription:l.description,conversationHistory:$,draftReply:M,customerName:l.userName});g(Y),s("AI refined your reply.","success")}catch($){const Y=($==null?void 0:$.message)||"AI assistance failed.";s(Y,"error")}finally{N(!1)}},O=({label:M,value:$,icon:Y,valueClass:te="text-gray-700"})=>u.jsxs("div",{className:"flex items-start py-2 border-b border-slate-100 last:border-b-0",children:[u.jsxs("span",{className:"text-xs font-semibold text-slate-500 w-32 flex items-center shrink-0",children:[Y&&u.jsx(Y,{size:14,className:"mr-2 text-slate-400"}),M,":"]}),u.jsx("span",{className:`text-sm ${te} flex-1 break-words`,children:$||"N/A"})]}),P=M=>{switch(M){case"Open":return"bg-red-100 text-red-700";case"In Progress":return"bg-yellow-100 text-yellow-700";case"Resolved":return"bg-green-100 text-green-700";case"Closed":return"bg-purple-100 text-purple-700";case"Awaiting Customer":return"bg-blue-100 text-blue-700";default:return"bg-gray-100 text-gray-600"}},F=["Open","In Progress","Awaiting Customer","Resolved","Closed"];return u.jsxs(Ar,{isOpen:r,onClose:e,title:"Ticket Details",size:"full",modalDialogClassName:"sm:max-w-4xl w-[95vw] h-[95vh]",contentClassName:"p-0 flex flex-col",children:[u.jsxs("div",{className:"flex justify-between items-center p-4 border-b border-gray-200 bg-slate-50 rounded-t-xl sticky top-0 z-10",children:[u.jsxs("h3",{className:"text-lg font-semibold text-slate-800 truncate",title:l.issueType,children:[l.issueType," - ID: ",l.id.substring(0,8),"..."]}),u.jsx("button",{onClick:e,className:"p-2 text-gray-500 hover:text-gray-700 rounded-lg",children:u.jsx(i0,{size:18})})]}),u.jsxs("div",{className:"overflow-y-auto flex-grow p-4 space-y-4",children:[u.jsx("div",{className:"p-4 border rounded-lg bg-slate-50/70",children:u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4",children:[u.jsx(O,{label:"User",value:`${l.userName} (${l.userEmail||"N/A"})`,icon:Cs}),u.jsx(O,{label:"Account No",value:l.accountNumber||"N/A",icon:Rs}),u.jsx(O,{label:"Submitted",value:$t(l.submittedAt),icon:pu}),u.jsx(O,{label:"Last Update",value:$t(l.lastUpdatedAt),icon:di}),u.jsx(O,{label:"Status",value:u.jsx("span",{className:`px-2 py-0.5 text-xs font-semibold rounded-full ${P(l.status)}`,children:l.status}),icon:Kt}),u.jsx(O,{label:"Ticket ID",value:l.id,icon:Rs,valueClass:"font-mono text-xs"})]})}),u.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[u.jsx("h4",{className:"text-sm font-semibold text-slate-600 mb-1",children:"Initial Description:"}),u.jsx("div",{className:"p-3 bg-slate-100 rounded-md text-sm text-slate-800 whitespace-pre-line prose prose-sm max-w-none",children:l.description})]}),u.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[u.jsx("h4",{className:"text-sm font-semibold text-slate-600 mb-2",children:"Conversation History"}),u.jsxs("div",{className:"max-h-60 overflow-y-auto space-y-3 p-3 bg-slate-50 border rounded-md",children:[l.conversation&&l.conversation.length>0?l.conversation.map((M,$)=>u.jsxs("div",{className:`p-2.5 rounded-lg ${M.authorRole==="admin"?"bg-blue-100":"bg-green-50"}`,children:[u.jsxs("p",{className:"text-xs font-bold text-gray-800",children:[M.authorName," (",M.authorRole,")"]}),u.jsx("div",{className:"text-sm text-gray-700 prose prose-sm max-w-none break-words",dangerouslySetInnerHTML:{__html:uo.sanitize(M.text||"")}}),u.jsx("p",{className:"text-right text-xs text-gray-500 mt-1",children:$t(M.timestamp)})]},$)):u.jsx("p",{className:"text-sm text-center text-gray-500 py-4",children:"No replies yet."}),u.jsx("div",{ref:R})]})]}),u.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[u.jsx("h4",{className:"text-sm font-semibold text-slate-600 mb-2",children:"Send Reply"}),u.jsxs("div",{className:"flex items-start gap-2 mb-2",children:[u.jsx(g0,{value:y,onChange:C,placeholder:"Type your reply...",className:"flex-grow bg-white rounded-lg border border-gray-300 min-h-[120px]",readOnly:x||T}),u.jsx("button",{onClick:D,className:`${j} bg-purple-100 text-purple-700 hover:bg-purple-200 self-start p-2`,disabled:T||!y.replace(/<[^>]*>?/gm,"").trim(),title:"Refine reply with AI",children:T?u.jsx(Et,{size:18,className:"animate-spin"}):u.jsx(Os,{size:18})})]}),u.jsxs("button",{onClick:k,className:`${j} bg-blue-600 hover:bg-blue-700 text-white`,disabled:x||!y.replace(/<[^>]*>?/gm,"").trim(),children:[x?u.jsx(Et,{size:18,className:"animate-spin mr-2"}):u.jsx(n0,{size:16,className:"mr-2"}),"Send Reply"]})]}),u.jsxs("div",{className:"p-4 border rounded-lg bg-white",children:[u.jsx("label",{htmlFor:"ticketStatusUpdate",className:"block text-sm font-semibold text-slate-600 mb-1.5",children:"Update Ticket Status:"}),u.jsxs("div",{className:"flex items-center gap-3",children:[u.jsx("select",{id:"ticketStatusUpdate",value:f,onChange:M=>m(M.target.value),className:`${I} flex-grow`,disabled:_,children:F.map(M=>u.jsx("option",{value:M,children:M},M))}),u.jsxs("button",{onClick:U,className:`${j} bg-green-600 hover:bg-green-700 text-white`,disabled:_||f===l.status,children:[_?u.jsx(Et,{size:18,className:"animate-spin mr-2"}):u.jsx(Ba,{size:18,className:"mr-2"}),"Update Status"]})]})]})]})]})},S$=({db:r,appId:e,userData:t,showNotification:n})=>{const[i,s]=J.useState([]),[o,l]=J.useState(!0),[d,f]=J.useState(null),[m,y]=J.useState(null),[g,_]=J.useState(!1),[E,x]=J.useState(""),[b,T]=J.useState(""),[N,R]=J.useState(""),I="w-full sm:w-auto text-sm px-3 py-2 rounded-md bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150",j=`${I} placeholder-gray-400`,U=J.useCallback(async(Y,te)=>{const oe=te==null?void 0:te.autoCloseTicketsDays;if(!oe||isNaN(oe)||oe<=0)return;const ie=new Date,ne=[];if(Y.forEach(K=>{var B;if(K.status==="Resolved"){const G=(B=K.lastUpdatedAt)!=null&&B.toDate?K.lastUpdatedAt.toDate():new Date(0);(ie-G)/(1e3*60*60*24)>oe&&ne.push(K.id)}}),ne.length>0){const K=await M8(r,ne,"Closed");K.success?n(`Successfully auto-closed ${ne.length} inactive ticket(s).`,"success"):n(`Failed to auto-close tickets: ${K.error}`,"error")}},[r,n]),C=J.useCallback(async()=>{l(!0);const[Y,te]=await Promise.all([WT(r),Xy(r)]);if(Y.success){if(s(Y.data),te.success&&te.data&&(await U(Y.data,te.data),Y.data.some(oe=>oe.status==="Resolved"))){const oe=await WT(r);oe.success&&s(oe.data)}}else n(Y.error||"Failed to fetch support tickets.","error"),s([]);l(!1)},[r,n,U]);J.useEffect(()=>{C()},[C]);const k=Y=>{f(Y)},D=()=>{f(null)},O=Y=>{s(te=>te.map(oe=>oe.id===Y.id?Y:oe))},P=async()=>{if(!m)return;_(!0);const Y=await a9(r,m.id);Y.success?(n("Support ticket deleted successfully.","success"),C()):n(Y.error||"Failed to delete ticket.","error"),_(!1),y(null)},F=Y=>{switch(Y){case"Open":return"bg-red-100 text-red-700";case"In Progress":return"bg-yellow-100 text-yellow-700";case"On Hold":return"bg-gray-200 text-gray-700";case"Awaiting Customer":return"bg-blue-100 text-blue-700";case"Resolved":return"bg-green-100 text-green-700";case"Closed":return"bg-purple-100 text-purple-700";default:return"bg-gray-100 text-gray-600"}},M=i.filter(Y=>{var K,B,G,X,se;const te=N.toLowerCase(),oe=N?((K=Y.id)==null?void 0:K.toLowerCase().includes(te))||((B=Y.userName)==null?void 0:B.toLowerCase().includes(te))||((G=Y.userEmail)==null?void 0:G.toLowerCase().includes(te))||((X=Y.accountNumber)==null?void 0:X.toLowerCase().includes(te))||((se=Y.description)==null?void 0:se.toLowerCase().includes(te)):!0,ie=E?Y.status===E:!0,ne=b?Y.issueType===b:!0;return oe&&ie&&ne}),$=Array.from(new Set(i.map(Y=>Y.issueType))).sort();return o&&i.length===0?u.jsx(an,{message:"Loading support tickets...",className:"mt-10 h-64"}):u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(Pa,{size:30,className:"mr-3 text-purple-600"})," Support Ticket Management"]}),u.jsxs("button",{onClick:C,className:"mt-3 sm:mt-0 text-sm flex items-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-3 rounded-lg border border-gray-300 transition-colors",disabled:o,title:"Refresh Ticket List",children:[o?u.jsx(Et,{size:16,className:"animate-spin mr-1.5"}):u.jsx(za,{size:16,className:"mr-1.5"}),"Refresh"]})]}),u.jsxs("div",{className:"mb-5 p-4 bg-gray-50 rounded-lg shadow-sm grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 items-end",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"searchTerm",className:"block text-xs font-medium text-gray-600 mb-1",children:"Search Tickets"}),u.jsx("input",{type:"text",id:"searchTerm",placeholder:"ID, Name, Email, Account#, Keyword...",value:N,onChange:Y=>R(Y.target.value),className:j})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"filterStatus",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Status"}),u.jsxs("select",{id:"filterStatus",value:E,onChange:Y=>x(Y.target.value),className:I,children:[u.jsx("option",{value:"",children:"All Statuses"}),["Open","In Progress","On Hold","Awaiting Customer","Resolved","Closed"].map(Y=>u.jsx("option",{value:Y,children:Y},Y))]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"filterIssueType",className:"block text-xs font-medium text-gray-600 mb-1",children:"Filter by Issue Type"}),u.jsxs("select",{id:"filterIssueType",value:b,onChange:Y=>T(Y.target.value),className:I,children:[u.jsx("option",{value:"",children:"All Issue Types"}),$.map(Y=>u.jsx("option",{value:Y,children:Y},Y))]})]})]}),!o&&M.length===0&&u.jsxs("div",{className:"text-center py-10",children:[u.jsx(gn,{size:48,className:"mx-auto text-gray-400 mb-3"}),u.jsx("p",{className:"text-gray-500 text-lg",children:i.length===0?"No support tickets found in the system.":"No tickets match your current filters."})]}),M.length>0&&u.jsx("div",{className:"overflow-x-auto shadow-md rounded-lg border border-gray-200",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[u.jsx("thead",{className:"bg-gray-100",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ticket ID"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Submitted"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Issue Type"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Update"}),u.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:M.map(Y=>u.jsxs("tr",{className:"hover:bg-gray-50/80 transition-colors duration-100",children:[u.jsxs("td",{className:"px-4 py-3 whitespace-nowrap font-mono text-xs text-gray-600",title:Y.id,children:[Y.id.substring(0,8),"..."]}),u.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-500",children:$t(Y.submittedAt,{month:"short",day:"numeric",year:"2-digit"})}),u.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-800 font-medium truncate max-w-[150px]",title:Y.userName||Y.userEmail,children:Y.userName||Y.userEmail}),u.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-600 truncate max-w-[180px]",title:Y.issueType,children:Y.issueType}),u.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:u.jsx("span",{className:`px-2.5 py-1 inline-flex text-xs leading-tight font-semibold rounded-full ${F(Y.status)}`,children:Y.status})}),u.jsx("td",{className:"px-4 py-3 whitespace-nowrap text-gray-500",children:$t(Y.lastUpdatedAt||Y.lastUpdatedByAdmin||Y.submittedAt,{month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}),u.jsxs("td",{className:"px-4 py-3 whitespace-nowrap text-center space-x-2",children:[u.jsx("button",{onClick:()=>k(Y),className:"text-indigo-600 hover:text-indigo-800 p-1.5 rounded-md hover:bg-indigo-50 transition-colors",title:"View & Manage Ticket",children:u.jsx(tc,{size:18})}),u.jsx("button",{onClick:()=>y(Y),className:"text-red-600 hover:text-red-800 p-1.5 rounded-md hover:bg-red-50 transition-colors",title:"Delete Ticket",children:u.jsx(oh,{size:18})})]})]},Y.id))})]})}),d&&t&&u.jsx(E$,{isOpen:!!d,onClose:D,ticket:d,db:r,appId:e,adminUserData:t,showNotification:n,onTicketUpdate:O}),m&&u.jsxs(oc,{isOpen:!!m,onClose:()=>y(null),onConfirm:P,title:"Confirm Ticket Deletion",confirmText:"Yes, Delete Ticket",isConfirming:g,iconType:"danger",children:[u.jsxs("p",{children:["Are you sure you want to permanently delete ticket ",u.jsxs("strong",{children:[m.id.substring(0,8),"..."]}),"?"]}),u.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"This action cannot be undone."})]})]})},m4="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",T$="flex items-center justify-center px-5 py-2.5 rounded-lg font-semibold text-sm transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95",nf=({field:r,settings:e,handleChange:t})=>{const n=r.icon;return u.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50/50",children:[u.jsxs("label",{className:`block text-sm font-medium text-gray-700 mb-1.5 ${r.type!=="checkbox"?"flex items-center":""}`,children:[n&&u.jsx(n,{size:16,className:"mr-2 text-gray-500"}),r.label]}),r.type==="textarea"?u.jsx("textarea",{name:r.name,rows:r.rows||3,value:e[r.name]||"",onChange:t,className:m4,placeholder:r.placeholder}):r.type==="checkbox"?u.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer p-2",children:[u.jsx("input",{type:"checkbox",name:r.name,checked:!!e[r.name],onChange:t,className:"h-5 w-5 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),u.jsx("span",{className:"text-sm text-gray-600 select-none",children:r.description||"Enable/Disable"})]}):u.jsx("input",{type:r.type,name:r.name,value:e[r.name]??"",onChange:t,className:m4,step:r.step||"0.01",placeholder:r.placeholder})]},r.name)},A$=({showNotification:r=console.log})=>{const[e,t]=J.useState({portalName:"AGWA Water Services, Inc.",portalAnnouncement:"",isBannerEnabled:!1,maintenanceMode:!1,sessionTimeoutMinutes:60,isSignupEnabled:!0,isGoogleLoginEnabled:!0,isPasswordlessLoginEnabled:!0,isOnlinePaymentsEnabled:!0,isChatbotEnabled:!0,isRebateProgramEnabled:!0,minimumChargeResidential:195.49,minimumChargeCommercial:888.4,minimumChargeResLowIncome:70.07,minimumChargeSemiBusiness:195.49,minimumChargeIndustrial:961.26,sewerageChargeResidential:0,billingCycleDay:1,latePaymentPenaltyPercentage:2,latePaymentPenaltyDelayDays:15,reconnectionFee:290,fcdaPercentage:1.29,environmentalChargePercentage:25,sewerageChargePercentageCommercial:32.85,governmentTaxPercentage:2,vatPercentage:12,seniorCitizenDiscountPercentage:5,pointsPerPeso:.01,earlyPaymentBonusPoints:10,earlyPaymentDaysThreshold:7,supportHotline:"1627-AGWA (24/7)",supportEmail:"support@agwa-waterservices.com.ph",adminEmailForNotifications:"admin@agwa.ph",autoCloseTicketsDays:14,defaultInterruptionMsg:"AGWA is conducting emergency maintenance. Water service may be temporarily unavailable in your area.",readingReminderDaysBefore:3}),[n,i]=J.useState(!0),[s,o]=J.useState(!1),[l,d]=J.useState(""),[f,m]=J.useState(null),[y,g]=J.useState(!1),_=J.useCallback(async()=>{i(!0),d("");const k=await Xy(Gt);k.success&&k.data?t(D=>({...D,...k.data})):d("Could not load existing settings. Default values are shown. Click 'Save' to create the settings document."),i(!1)},[]);J.useEffect(()=>{_()},[_]);const E=k=>{const{name:D,value:O,type:P,checked:F}=k.target;t(M=>({...M,[D]:P==="checkbox"?F:P==="number"&&O!==""?parseFloat(O):O}))},x=async k=>{k.preventDefault(),o(!0),d("");const D={...e};for(const P in D)typeof D[P]=="string"&&!isNaN(parseFloat(D[P]))&&P!=="supportHotline"&&P!=="portalAnnouncement"&&P!=="supportEmail"&&P!=="defaultInterruptionMsg"&&P!=="portalName"&&P!=="adminEmailForNotifications"&&(D[P]===""?D[P]=0:D[P]=parseFloat(D[P]));const O=await h9(Gt,D);O.success?(r("System settings updated successfully!","success"),t(D)):(d(O.error||"Failed to save system settings."),r(O.error||"Failed to save system settings.","error")),o(!1)},b=async()=>{if(!f)return;g(!0);let k,D=f;try{switch(D){case"tickets":k=await L8(Gt);break;case"bills":k=await F8(Gt);break;case"readings":k=await V8(Gt);break;case"announcements":k=await z8(Gt);break;case"interruptions":k=await B8(Gt);break;case"routes":k=await U8(Gt);break;case"rebatePoints":k=await q8(Gt);break;case"users":k=await H8(Gt);break;default:k={success:!1,error:"Unknown data type."}}k.success?r(`Successfully deleted ${k.count} ${D}.`,"success"):r(k.error||`Failed to delete ${D}.`,"error")}catch(O){r(O.message||`An error occurred deleting ${D}.`,"error")}g(!1),m(null)},T=[{name:"portalName",label:"Portal Name",type:"text",icon:Ox,placeholder:"AGWA Water Services, Inc."},{name:"sessionTimeoutMinutes",label:"Session Timeout (Minutes)",type:"number",icon:di,step:"1",placeholder:"60"},{name:"maintenanceMode",label:"Enable Portal Maintenance Mode",type:"checkbox",icon:Kt,description:"If enabled, only Admins can log in."},{name:"portalAnnouncement",label:"Portal-Wide Announcement Banner Text",type:"textarea",icon:bd,rows:2},{name:"isBannerEnabled",label:"Enable Announcement Banner",type:"checkbox",icon:bd}],N=[{name:"isSignupEnabled",label:"Enable New User Sign-ups",type:"checkbox",icon:Gv},{name:"isGoogleLoginEnabled",label:"Enable Sign-in with Google",type:"checkbox",icon:Gv},{name:"isPasswordlessLoginEnabled",label:"Enable Passwordless (Email Link) Sign-in",type:"checkbox",icon:Gv},{name:"isOnlinePaymentsEnabled",label:"Enable Online Payments",type:"checkbox",icon:e0},{name:"isChatbotEnabled",label:"Enable Chatbot",type:"checkbox",icon:Pa},{name:"isRebateProgramEnabled",label:"Enable Rebate Program",type:"checkbox",icon:sy,description:"Enable customer rewards."}],R=[{name:"minimumChargeResidential",label:"Min. Charge Residential (PHP)",type:"number",icon:Dl,placeholder:"195.49"},{name:"minimumChargeResLowIncome",label:"Min. Charge Res. Low-Income (PHP)",type:"number",icon:Dl,placeholder:"70.07"},{name:"minimumChargeSemiBusiness",label:"Min. Charge Semi-Business (PHP)",type:"number",icon:Dl,placeholder:"195.49"},{name:"minimumChargeCommercial",label:"Min. Charge Commercial (PHP)",type:"number",icon:Dl,placeholder:"888.40"},{name:"minimumChargeIndustrial",label:"Min. Charge Industrial (PHP)",type:"number",icon:Dl,placeholder:"961.26"},{name:"billingCycleDay",label:"Billing Cycle Day (e.g., 1)",type:"number",icon:Mx,step:"1",placeholder:"1"},{name:"latePaymentPenaltyDelayDays",label:"Late Payment Grace Period (Days)",type:"number",icon:di,step:"1",placeholder:"15"},{name:"latePaymentPenaltyPercentage",label:"Late Payment Penalty (%)",type:"number",icon:ya,placeholder:"2.0"},{name:"reconnectionFee",label:"Reconnection Fee (PHP)",type:"number",icon:oy,placeholder:"290.00"},{name:"fcdaPercentage",label:"FCDA (%)",type:"number",icon:ya,placeholder:"1.29"},{name:"environmentalChargePercentage",label:"Environmental Charge (%)",type:"number",icon:YT,placeholder:"25.0"},{name:"sewerageChargeResidential",label:"Sewerage Charge (Res. %)",type:"number",icon:ya,placeholder:"0"},{name:"sewerageChargePercentageCommercial",label:"Sewerage Charge (Comm. %)",type:"number",icon:ya,placeholder:"32.85"},{name:"governmentTaxPercentage",label:"Government Taxes (%)",type:"number",icon:ya,placeholder:"2.0"},{name:"vatPercentage",label:"VAT (%)",type:"number",icon:ya,placeholder:"12.0"},{name:"seniorCitizenDiscountPercentage",label:"Senior/PWD Discount (%)",type:"number",icon:ya,placeholder:"5.0"}],I=[{name:"pointsPerPeso",label:"Points Awarded per 1.00 Paid",type:"number",icon:md,placeholder:"e.g., 0.01",step:"0.001"},{name:"earlyPaymentBonusPoints",label:"Early Payment Bonus (Points)",type:"number",icon:md,placeholder:"e.g., 10",step:"1"},{name:"earlyPaymentDaysThreshold",label:"Early Payment Threshold (Days)",type:"number",icon:Mx,placeholder:"e.g., 7",step:"1"}],j=[{name:"supportHotline",label:"Support Hotline Number",type:"text",icon:eF,placeholder:"e.g., 1627-AGWA"},{name:"supportEmail",label:"Support Email Address",type:"email",icon:KT,placeholder:"e.g., support@agos.com"},{name:"adminEmailForNotifications",label:"Admin Email (for system alerts)",type:"email",icon:KT,placeholder:"e.g., admin@agos.com"},{name:"autoCloseTicketsDays",label:"Auto-close Resolved Tickets After (Days)",type:"number",icon:di,step:"1",placeholder:"14"},{name:"readingReminderDaysBefore",label:"Reading Reminder (Days Before)",type:"number",icon:di,step:"1",placeholder:"3"},{name:"defaultInterruptionMsg",label:"Default Interruption Message",type:"textarea",icon:Kt,rows:2,placeholder:"Service interruption ongoing..."}],U=[{label:"Clear All Support Tickets",action:"tickets",icon:Pa},{label:"Clear All Bills",action:"bills",icon:Ox},{label:"Clear All Meter Readings",action:"readings",icon:YT},{label:"Clear All Announcements",action:"announcements",icon:bd},{label:"Clear All Interruptions",action:"interruptions",icon:Kt},{label:"Clear All Meter Routes",action:"routes",icon:ic},{label:"Clear All Rebate Points",action:"rebatePoints",icon:sy}],C={label:"Clear All User Profiles",action:"users",icon:Ta};return n?u.jsx(an,{message:"Loading system settings...",className:"mt-10 h-64"}):u.jsxs("form",{onSubmit:x,className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(r0,{size:30,className:"mr-3 text-gray-600"})," System Configuration"]}),u.jsxs("button",{type:"submit",className:`${T$} bg-blue-600 hover:bg-blue-700 text-white focus:ring-blue-500 w-auto mt-4 sm:mt-0`,disabled:s||n,children:[s?u.jsx(Et,{size:18,className:"animate-spin mr-2"}):u.jsx(Ba,{size:18,className:"mr-2"}),s?"Saving...":"Save All Settings"]})]}),l&&u.jsxs("div",{className:"mb-4 p-3 bg-yellow-100 border border-yellow-400 text-yellow-800 rounded-lg text-sm flex items-center",children:[u.jsx(Kt,{size:20,className:"mr-2"})," ",l]}),u.jsxs("div",{className:"space-y-8",children:[u.jsxs("section",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"General & Maintenance"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:T.map(k=>u.jsx(nf,{field:k,settings:e,handleChange:E},k.name))})]}),u.jsxs("section",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"Portal Features & Authentication"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:N.map(k=>u.jsx(nf,{field:k,settings:e,handleChange:E},k.name))})]}),u.jsxs("section",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"Billing & Financial"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:R.map(k=>u.jsx(nf,{field:k,settings:e,handleChange:E},k.name))})]}),u.jsxs("section",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"Rewards Program"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:I.map(k=>u.jsx(nf,{field:k,settings:e,handleChange:E},k.name))})]}),u.jsxs("section",{children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"Communication & Support"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:j.map(k=>u.jsx(nf,{field:k,settings:e,handleChange:E},k.name))})]})]}),u.jsxs("div",{className:"mt-12 pt-6 border-t-2 border-red-300",children:[u.jsxs("h3",{className:"text-xl font-bold text-red-700 flex items-center",children:[u.jsx(Kt,{size:24,className:"mr-2"})," Danger Zone"]}),u.jsx("p",{className:"text-sm text-gray-600 mt-1 mb-4",children:"These actions are destructive and cannot be undone. This will permanently delete transactional data from the database, effectively resetting parts of your system."}),u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:U.map(k=>{const D=k.icon;return u.jsxs("button",{type:"button",onClick:()=>m(k.action),className:"p-4 border border-red-200 rounded-lg bg-red-50 hover:bg-red-100 hover:border-red-400 transition-colors text-left",children:[u.jsxs("p",{className:"font-semibold text-red-800 flex items-center",children:[u.jsx(D,{size:16,className:"mr-2"}),k.label]}),u.jsxs("p",{className:"text-xs text-red-600 mt-1",children:["Permanently delete all ",k.action," from the database."]})]},k.action)})}),u.jsx("div",{className:"mt-4",children:u.jsxs("button",{type:"button",onClick:()=>m(C.action),className:"p-4 border border-red-300 w-full rounded-lg bg-red-100 hover:bg-red-200 hover:border-red-500 transition-colors text-left",children:[u.jsxs("p",{className:"font-semibold text-red-900 flex items-center",children:[u.jsx(C.icon,{size:16,className:"mr-2"}),C.label]}),u.jsx("p",{className:"text-xs text-red-700 mt-1",children:"Permanently delete all user profiles. This is the most destructive action and will force all users to sign up again."})]},C.action)})]}),f&&u.jsx(oc,{isOpen:!!f,onClose:()=>m(null),onConfirm:b,title:`Confirm Deletion of All ${f.charAt(0).toUpperCase()+f.slice(1)}`,confirmText:`Yes, delete all ${f}`,isConfirming:y,iconType:"danger",children:u.jsxs("p",{children:["Are you absolutely sure you want to proceed? All ",u.jsx("strong",{children:f})," data will be permanently erased. This action cannot be undone."]})})]})},N$=({initialData:r=null,onSubmit:e,onCancel:t,isSaving:n,showNotification:i})=>{const[s,o]=J.useState(""),[l,d]=J.useState(""),[f,m]=J.useState("info"),[y,g]=J.useState("active"),[_,E]=J.useState(""),[x,b]=J.useState(""),[T,N]=J.useState(["all"]),[R,I]=J.useState(""),[j,U]=J.useState(!1),[C,k]=J.useState("");J.useEffect(()=>{var $,Y;if(r)o(r.title||""),d(r.content||""),m(r.type||"info"),g(r.status||"active"),E(($=r.startDate)!=null&&$.toDate?r.startDate.toDate().toISOString().split("T")[0]:""),b((Y=r.endDate)!=null&&Y.toDate?r.endDate.toDate().toISOString().split("T")[0]:""),N(r.targetRoles||["all"]);else{const te=new Date().toISOString().split("T")[0];E(te),g("active"),o(""),d(""),m("info"),b(""),N(["all"]),I("")}},[r]);const D=$=>{d($),C&&$.replace(/<[^>]*>?/gm,"").trim()&&k("")},O=async()=>{const $=l.replace(/<[^>]*>?/gm,"").trim();if(R.trim()){U(!0);try{const Y=await xF({title:s||R,reason:R,area:"",time:""});d(Y),!s.trim()&&R.trim()&&o(R.trim()),i("AI generated a new draft!","success")}catch(Y){const te=(Y==null?void 0:Y.message)||"AI generation failed.";i(te,"error")}finally{U(!1)}}else if($){U(!0);try{const te=[{role:"user",content:`Refine this announcement draft for AGWA Water Services. Make it clear, professional, concise, using simple HTML (<p>, <strong>, <ul>, <li>). Announcement Type: ${f}. Title: "${s}". Original Content (may contain HTML): "${l}". Respond only with the refined HTML content.`}],oe=await Vo(te);d(oe),i("AI has refined your content!","success")}catch(Y){const te=(Y==null?void 0:Y.message)||"AI assistance failed.";i(te,"error")}finally{U(!1)}}else i("Please provide a prompt or write some content for the AI to assist with.","warning")},P=$=>{$.preventDefault(),k("");const Y=l.replace(/<[^>]*>?/gm,"").trim();if(!s.trim()||!Y||!_){k("Title, Content, and Start Date are required.");return}if(x&&new Date(x)<new Date(_)){k("End date cannot be before start date.");return}const te=uo.sanitize(l),oe={title:s.trim(),content:te,type:f,status:y,startDate:new Date(_),endDate:x?new Date(x):null,targetRoles:T.length===0||T.includes("all")?["all"]:T};e(oe)},F="w-full px-4 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-2 focus:ring-blue-200 focus:outline-none transition duration-200 text-gray-900",M="flex items-center justify-center px-4 py-2.5 rounded-lg font-semibold transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95";return u.jsx("div",{className:"p-1",children:u.jsxs("form",{onSubmit:P,className:"space-y-6",id:"announcementForm",children:[C&&u.jsxs("div",{className:"p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg text-sm flex items-center",children:[u.jsx(D9,{size:20,className:"mr-2"})," ",C]}),u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"announcementTitle",className:"block text-sm font-medium text-gray-700 mb-1",children:[u.jsx(a3,{size:16,className:"inline mr-1.5"}),"Title *"]}),u.jsx("input",{type:"text",id:"announcementTitle",value:s,onChange:$=>o($.target.value),className:F,placeholder:"E.g., Scheduled Maintenance in Poblacion",required:!0})]}),u.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg space-y-3",children:[u.jsxs("label",{htmlFor:"aiPrompt",className:"block text-sm font-medium text-blue-800",children:[u.jsx(Os,{size:16,className:"inline mr-1.5"}),"AI Assistant"]}),u.jsx("input",{type:"text",id:"aiPrompt",value:R,onChange:$=>I($.target.value),className:F,placeholder:"Type a prompt to generate new content (e.g., 'Emergency repair in Muzon')"}),u.jsxs("button",{type:"button",onClick:O,className:`${M} text-sm bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-300 py-2 px-4`,disabled:j||n,children:[j?u.jsx(Et,{size:16,className:"animate-spin mr-1.5"}):u.jsx(Os,{size:16,className:"mr-1.5"}),R.trim()?"Generate Content":"Refine Existing Content"]}),u.jsx("p",{className:"text-xs text-gray-500",children:"If the prompt is filled, AI will generate new content. If the prompt is empty and the editor has content, AI will refine it."})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Content *"}),u.jsx(g0,{value:l,onChange:D,placeholder:"Describe the announcement, or use the AI Assistant above to generate content.",className:"bg-white rounded-lg border border-gray-300 min-h-[250px]"}),C&&!l.replace(/<[^>]*>?/gm,"").trim()&&u.jsx("p",{className:"text-red-500 text-xs mt-1",children:"Content is required."})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"announcementType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Type"}),u.jsxs("select",{id:"announcementType",value:f,onChange:$=>m($.target.value),className:F,children:[u.jsx("option",{value:"info",children:"Info"}),u.jsx("option",{value:"warning",children:"Warning"}),u.jsx("option",{value:"critical",children:"Critical"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),u.jsxs("button",{type:"button",onClick:()=>g(y==="active"?"archived":"active"),className:`${M} w-full ${y==="active"?"bg-green-500 hover:bg-green-600 text-white focus:ring-green-400":"bg-gray-200 hover:bg-gray-300 text-gray-700 focus:ring-gray-300"}`,children:[y==="active"?u.jsx(s3,{size:18,className:"mr-2"}):u.jsx(rF,{size:18,className:"mr-2"}),y==="active"?"Active":"Archived"]})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"startDate",className:"block text-sm font-medium text-gray-700 mb-1",children:[u.jsx(pu,{size:16,className:"inline mr-1.5"}),"Start Date *"]}),u.jsx("input",{type:"date",id:"startDate",value:_,onChange:$=>E($.target.value),className:F,required:!0})]}),u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"endDate",className:"block text-sm font-medium text-gray-700 mb-1",children:[u.jsx(pu,{size:16,className:"inline mr-1.5"}),"End Date (Optional)"]}),u.jsx("input",{type:"date",id:"endDate",value:x,onChange:$=>b($.target.value),className:F,min:_})]})]}),u.jsxs("div",{className:"pt-6 border-t mt-6 flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-4",children:[u.jsx("button",{type:"button",onClick:t,className:`${M} bg-gray-100 hover:bg-gray-200 text-gray-700 border border-gray-300 focus:ring-gray-300 w-full sm:w-auto order-2 sm:order-1`,disabled:n||j,children:"Cancel"}),u.jsxs("button",{type:"submit",form:"announcementForm",className:`${M} bg-green-600 hover:bg-green-700 text-white focus:ring-green-500 w-full sm:w-auto order-1 sm:order-2`,disabled:n||j||!s.trim()||!l.replace(/<[^>]*>?/gm,"").trim(),children:[n?u.jsx(Et,{size:20,className:"animate-spin mr-2"}):u.jsx(Ba,{size:20,className:"mr-2"}),n?"Saving...":r?"Update Announcement":"Create Announcement"]})]})]})})},I$=({announcements:r,onEdit:e,onDelete:t,onToggleStatus:n,actionLoadingId:i,viewOnly:s=!1})=>{const o=l=>{if(!l)return"N/A";let d;try{if(l.toDate&&typeof l.toDate=="function")d=l.toDate();else if(l instanceof Date)d=l;else if(typeof l=="string"||typeof l=="number")d=new Date(l);else return"Invalid Date";return isNaN(d.getTime())?"Invalid Date":d.toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Invalid Date"}};return!r||r.length===0?u.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner border border-gray-200",children:[u.jsx(gn,{size:48,className:"mx-auto text-gray-400 mb-4"}),u.jsx("p",{className:"text-gray-600 text-lg",children:"No announcements found."}),!s&&u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Create one using the 'New Announcement' button."})]}):u.jsx("div",{className:"space-y-4",children:r.map(l=>{var f,m;const d=uo.sanitize(l.content||"");return u.jsxs("div",{className:`p-4 rounded-lg shadow-md border-l-4 transition-opacity ${l.status==="active"?"border-green-500 bg-white hover:shadow-lg":"border-gray-400 bg-gray-50 opacity-80 hover:opacity-100 hover:shadow-md"}`,children:[u.jsxs("div",{className:"flex justify-between items-start gap-3",children:[u.jsxs("div",{className:"flex-grow pr-4",children:[u.jsx("h4",{className:"text-lg font-semibold text-gray-800",children:l.title}),u.jsxs("div",{className:"flex items-center flex-wrap gap-2 text-xs mt-1",children:[u.jsx("span",{className:`px-2 py-0.5 font-semibold uppercase tracking-wider rounded-full ${l.status==="active"?"bg-green-100 text-green-800":"bg-gray-200 text-gray-600"}`,children:l.status}),u.jsx("span",{className:`px-2 py-0.5 font-semibold uppercase tracking-wider rounded-full ${l.type==="critical"?"bg-red-100 text-red-800":l.type==="warning"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:l.type}),u.jsxs("span",{className:"text-gray-400 font-mono flex items-center",children:[u.jsx(Rs,{size:12,className:"mr-0.5"}),l.id.substring(0,8),"..."]})]})]}),!s&&u.jsx("div",{className:"flex space-x-2 items-center flex-shrink-0",children:i===l.id?u.jsx(Et,{className:"animate-spin text-gray-500"}):u.jsxs(u.Fragment,{children:[n&&u.jsx("button",{onClick:()=>n(l),className:`p-1.5 rounded-md hover:bg-opacity-20 transition-colors ${l.status==="active"?"text-yellow-600 hover:bg-yellow-100":"text-green-600 hover:bg-green-100"}`,title:l.status==="active"?"Archive":"Activate",children:l.status==="active"?u.jsx(iy,{size:18}):u.jsx(tc,{size:18})}),e&&u.jsx("button",{onClick:()=>e(l),className:"text-blue-600 hover:text-blue-800 p-1.5 rounded-md hover:bg-blue-100 transition-colors",title:"Edit",children:u.jsx(J9,{size:18})}),t&&u.jsx("button",{onClick:()=>t(l.id),className:"text-red-600 hover:text-red-800 p-1.5 rounded-md hover:bg-red-100 transition-colors",title:"Delete",children:u.jsx(oh,{size:18})})]})})]}),u.jsx("div",{className:"prose prose-sm max-w-none text-gray-700 mt-3 pt-3 border-t border-gray-200/80 leading-relaxed",dangerouslySetInnerHTML:{__html:d}}),u.jsxs("div",{className:"text-xs text-gray-500 mt-3 pt-2 border-t border-gray-200/80",children:[u.jsxs("p",{children:["Author: ",l.authorName||"Admin"]}),u.jsxs("p",{children:["Created: ",o(l.createdAt)]}),l.updatedAt&&((f=l.updatedAt)==null?void 0:f.seconds)!==((m=l.createdAt)==null?void 0:m.seconds)&&u.jsxs("p",{children:["Updated: ",o(l.updatedAt)]}),u.jsxs("p",{children:["Display: ",o(l.startDate)," to ",l.endDate?o(l.endDate):"Ongoing"]})]})]},l.id)})})},p4=({db:r,userData:e,showNotification:t,viewOnly:n=!1})=>{const[i,s]=J.useState([]),[o,l]=J.useState(!0),[d,f]=J.useState(!1),[m,y]=J.useState(null),[g,_]=J.useState(!1),[E,x]=J.useState(null),[b,T]=J.useState(!1),[N,R]=J.useState(null),I=J.useCallback(async()=>{l(!0);try{const P=await u9(r,n);if(P.success)s(P.data||[]);else throw new Error(P.error)}catch{t("Failed to load announcements.","error")}finally{l(!1)}},[r,t,n]);J.useEffect(()=>{I()},[I]);const j=()=>{y(null),f(!0)},U=P=>{y(P),f(!0)},C=async P=>{_(!0);const M=await(m?GT(r,m.id,{...P,updatedBy:e.uid}):c9(r,{...P,createdBy:e.uid,authorName:e.displayName}));M.success?(t(`Announcement ${m?"updated":"created"} successfully!`,"success"),I(),f(!1)):t(`Failed to save announcement: ${M.error}`,"error"),_(!1)},k=P=>{R(P),T(!0)},D=async()=>{if(!N)return;x(N);const P=await d9(r,N);P.success?(t("Announcement deleted successfully!","success"),I()):t(`Failed to delete announcement: ${P.error}`,"error"),T(!1),R(null),x(null)},O=async P=>{x(P.id);const F=P.status==="active"?"archived":"active",M=await GT(r,P.id,{status:F,updatedBy:e.uid});M.success?(t(`Announcement status changed to ${F}.`,"success"),I()):t("Failed to update status: "+M.error,"error"),x(null)};return u.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-xl",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[u.jsx("h3",{className:"text-2xl font-semibold",children:n?"Company Announcements":"Manage Announcements"}),!n&&u.jsxs("button",{onClick:j,className:"bg-blue-600 text-white font-medium py-2 px-4 rounded-lg flex items-center",children:[u.jsx(Jy,{size:18,className:"mr-2"})," New Announcement"]})]}),o?u.jsx(an,{message:"Loading Announcements..."}):u.jsx(I$,{announcements:i,onEdit:n?void 0:U,onDelete:n?void 0:k,onToggleStatus:n?void 0:O,actionLoadingId:E,viewOnly:n}),!n&&d&&u.jsx(Ar,{isOpen:d,onClose:()=>f(!1),title:m?"Edit Announcement":"Create Announcement",size:"full",children:u.jsx(N$,{initialData:m,onSubmit:C,onCancel:()=>f(!1),isSaving:g,showNotification:t})}),!n&&b&&u.jsx(oc,{isOpen:b,onClose:()=>T(!1),onConfirm:D,title:"Confirm Deletion",isConfirming:!!E,children:"Are you sure you want to delete this announcement? This action cannot be undone."})]})},k$=({initialData:r=null,onSubmit:e,onCancel:t,isSaving:n,showNotification:i})=>{const[s,o]=J.useState(""),[l,d]=J.useState(""),[f,m]=J.useState("Maintenance"),[y,g]=J.useState("Scheduled"),[_,E]=J.useState(""),[x,b]=J.useState("08:00"),[T,N]=J.useState(""),[R,I]=J.useState("17:00"),[j,U]=J.useState([]),[C,k]=J.useState(!1),[D,O]=J.useState(""),[P,F]=J.useState({}),[M,$]=J.useState([]);J.useEffect(()=>{const se=c0(),le=[],Q=se.reduce((ce,ue)=>{const fe=$d(ue).sort();return ce[ue]=fe,le.push(...fe),ce},{});F(Q),$(le.sort())},[]),J.useEffect(()=>{var se,le;if(r){o(r.title||""),d(r.description||""),m(r.type||"Maintenance"),g(r.status||"Scheduled"),U(r.affectedAreas||[]),k(r.isBillingPaused||!1);const Q=(se=r.startDate)!=null&&se.toDate?r.startDate.toDate():null,ce=(le=r.estimatedEndDate)!=null&&le.toDate?r.estimatedEndDate.toDate():null;E(Q?Q.toISOString().split("T")[0]:""),b(Q?`${String(Q.getHours()).padStart(2,"0")}:${String(Q.getMinutes()).padStart(2,"0")}`:"08:00"),N(ce?ce.toISOString().split("T")[0]:""),I(ce?`${String(ce.getHours()).padStart(2,"0")}:${String(ce.getMinutes()).padStart(2,"0")}`:"17:00")}else{const ce=new Date().toISOString().split("T")[0];o(""),d(""),m("Maintenance"),g("Scheduled"),E(ce),b("08:00"),N(ce),I("17:00"),U([]),k(!1)}},[r]);const Y=se=>{d(se),D&&se.replace(/<[^>]*>?/gm,"").trim()&&O("")},te=se=>{U(le=>le.includes(se)?le.filter(Q=>Q!==se):[...le,se]),D&&j.length>0&&O("")},oe=()=>{j.length===M.length?U([]):(U([...M]),D&&O(""))},ie=(se,le)=>{const Q=le.every(ce=>j.includes(ce));U(Q?ce=>ce.filter(ue=>!le.includes(ue)):ce=>[...new Set([...ce,...le])])},ne=se=>{se.preventDefault(),O("");const le=l.replace(/<[^>]*>?/gm,"").trim();if(!s.trim()||!le||!_||!x||j.length===0){O("Title, Description, Affected Area(s), Start Date/Time are required.");return}const Q=new Date(`${_}T${x}`);if(isNaN(Q)){O("Invalid Start Date or Time.");return}let ce=null;if(T&&R){if(ce=new Date(`${T}T${R}`),isNaN(ce)){O("Invalid Estimated End Date or Time.");return}if(ce<=Q){O("Estimated End must be after Start.");return}}const ue=uo.sanitize(l),fe={title:s.trim(),description:ue,type:f,status:y,startDate:Q,estimatedEndDate:ce,affectedAreas:j.sort(),isBillingPaused:C};e(fe)},K="w-full px-4 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm text-gray-900",B="flex items-center justify-center px-4 py-2.5 rounded-lg font-semibold transition-all duration-200 ease-in-out focus:outline-none focus:ring-2 focus:ring-opacity-50 disabled:opacity-60 active:scale-95 text-sm",G=["Maintenance","Emergency Repair","System Upgrade","Leak Detection","Other"],X=["Scheduled","Ongoing","Resolved"];return u.jsxs("form",{onSubmit:ne,className:"space-y-6 p-1",children:[D&&u.jsxs("div",{className:"p-3 bg-red-100 border border-red-400 text-red-700 rounded-lg text-sm flex items-center",children:[u.jsx(Kt,{size:20,className:"mr-2"})," ",D]}),u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"interruptionTitle",className:"block text-sm font-medium text-gray-700 mb-1",children:[u.jsx(a3,{size:16,className:"inline mr-1.5"}),"Title *"]}),u.jsx("input",{type:"text",id:"interruptionTitle",value:s,onChange:se=>o(se.target.value),className:K,placeholder:"E.g., Water Interruption in Brgy. Muzon",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),u.jsx(g0,{value:l,onChange:Y,placeholder:"Provide details...",className:"bg-white rounded-lg border border-gray-300 min-h-[150px]"}),D&&!l.replace(/<[^>]*>?/gm,"").trim()&&u.jsx("p",{className:"text-red-500 text-xs mt-1",children:"Description is required."})]}),u.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50 max-h-72 overflow-y-auto scrollbar-thin",children:[u.jsxs("div",{className:"flex justify-between items-center mb-2 sticky top-0 bg-gray-50 py-1 -mt-1 border-b border-gray-200",children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[u.jsx(co,{size:16,className:"inline mr-1.5"}),"Affected Area(s) *"]}),u.jsx("button",{type:"button",onClick:oe,className:"text-xs font-medium text-blue-600 hover:underline",children:j.length===M.length?"Deselect All":`Select All (${M.length})`})]}),u.jsx("div",{className:"space-y-2",children:Object.entries(P).map(([se,le])=>u.jsxs("details",{className:"group bg-white border rounded-md",children:[u.jsxs("summary",{className:"flex justify-between items-center p-2 cursor-pointer list-none",children:[u.jsx("span",{className:"font-semibold text-sm text-blue-700",children:se}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("button",{type:"button",onClick:Q=>{Q.preventDefault(),ie(se,le)},className:"text-xs text-blue-600 hover:underline mr-2",children:"Toggle District"}),u.jsx(E2,{size:18,className:"text-gray-500 group-open:rotate-180 transition-transform"})]})]}),u.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 p-3 border-t border-gray-100",children:le.map(Q=>u.jsxs("label",{className:"flex items-center space-x-2 p-1.5 rounded bg-gray-50 border border-gray-200 hover:bg-blue-50 cursor-pointer text-xs has-[:checked]:bg-blue-100 has-[:checked]:border-blue-300",children:[u.jsx("input",{type:"checkbox",checked:j.includes(Q),onChange:()=>te(Q),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 shrink-0"}),u.jsx("span",{className:"truncate",title:Q,children:Q})]},Q))})]},se))}),D&&j.length===0&&u.jsx("p",{className:"text-red-500 text-xs mt-2",children:"Select at least one area."})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"interruptionType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Type *"}),u.jsx("select",{id:"interruptionType",value:f,onChange:se=>m(se.target.value),className:K,required:!0,children:G.map(se=>u.jsx("option",{value:se,children:se},se))})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"interruptionStatus",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status *"}),u.jsx("select",{id:"interruptionStatus",value:y,onChange:se=>g(se.target.value),className:K,required:!0,children:X.map(se=>u.jsx("option",{value:se,children:se},se))})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),u.jsxs("label",{className:"flex items-center space-x-2 p-2.5 rounded-lg bg-yellow-50 border border-yellow-200 cursor-pointer hover:bg-yellow-100",children:[u.jsx("input",{type:"checkbox",checked:C,onChange:se=>k(se.target.checked),className:"h-4 w-4 text-yellow-600 border-gray-300 rounded focus:ring-yellow-500"}),u.jsxs("span",{className:"text-sm font-medium text-yellow-800 flex items-center",children:[u.jsx(L9,{size:16,className:"mr-1.5"})," Pause Billing"]})]})]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[u.jsx(pu,{size:16,className:"inline mr-1.5"}),"Start Date & Time *"]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"date",id:"startDate",value:_,onChange:se=>E(se.target.value),className:K,required:!0}),u.jsx("input",{type:"time",id:"startTime",value:x,onChange:se=>b(se.target.value),className:K,required:!0})]})]}),u.jsxs("div",{children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[u.jsx(di,{size:16,className:"inline mr-1.5"}),"Estimated End Date & Time"]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("input",{type:"date",id:"estimatedEndDate",value:T,onChange:se=>N(se.target.value),className:K,min:_}),u.jsx("input",{type:"time",id:"estimatedEndTime",value:R,onChange:se=>I(se.target.value),className:K})]}),D.includes("End Date/Time")&&u.jsx("p",{className:"text-red-500 text-xs mt-1",children:D})]})]}),u.jsxs("div",{className:"pt-6 border-t mt-6 flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-4",children:[u.jsx("button",{type:"button",onClick:t,className:`${B} bg-gray-100 hover:bg-gray-200 text-gray-700 border border-gray-300 focus:ring-gray-300 w-full sm:w-auto order-2 sm:order-1`,disabled:n,children:"Cancel"}),u.jsxs("button",{type:"submit",className:`${B} bg-green-600 hover:bg-green-700 text-white focus:ring-green-500 w-full sm:w-auto order-1 sm:order-2`,disabled:n,children:[n?u.jsx(Et,{size:20,className:"animate-spin mr-2"}):u.jsx(Ba,{size:20,className:"mr-2"}),n?"Saving...":r?"Update Advisory":"Create Advisory"]})]}),u.jsx("style",{children:`
                .scrollbar-thin { scrollbar-width: thin; scrollbar-color: #9ca3af #f3f4f6; }
                .scrollbar-thin::-webkit-scrollbar { width: 6px; height: 6px;}
                .scrollbar-thin::-webkit-scrollbar-track { background: #f3f4f6; border-radius:3px; }
                .scrollbar-thin::-webkit-scrollbar-thumb { background-color: #9ca3af; border-radius: 3px; border: 1px solid #f3f4f6;}
                .scrollbar-thin::-webkit-scrollbar-thumb:hover { background-color: #6b7280; }
             `})]})},P$=({db:r,userData:e,showNotification:t})=>{const[n,i]=J.useState([]),[s,o]=J.useState(!0),[l,d]=J.useState(!1),[f,m]=J.useState(null),[y,g]=J.useState(!1),[_,E]=J.useState(null),[x,b]=J.useState(!1),[T,N]=J.useState(null),R=J.useCallback(async()=>{o(!0);try{const O=await E9(r);if(O.success)i(O.data||[]);else throw new Error(O.error)}catch(O){t(O.message||"Failed to load interruptions.","error")}finally{o(!1)}},[r,t]);J.useEffect(()=>{R()},[R]);const I=()=>{m(null),d(!0)},j=O=>{m(O),d(!0)},U=async O=>{g(!0);const F=await(f?b9(r,f.id,O):x9(r,O));F.success?(t(`Advisory ${f?"updated":"created"} successfully!`,"success"),R(),d(!1)):t(F.error||"Failed to save advisory.","error"),g(!1)},C=O=>{N(O),b(!0)},k=async()=>{if(!T)return;E(T.id);const O=await w9(r,T.id);O.success?(t("Advisory deleted successfully!","success"),R()):t(O.error||"Failed to delete advisory.","error"),b(!1),N(null),E(null)},D=(O,P)=>{if((P==="Emergency Repair"||P==="Leak Detection")&&O!=="Resolved")return{icon:u3,color:"text-red-700",bgColor:"bg-red-100",label:"Emergency"};switch(O){case"Ongoing":return{icon:Kt,color:"text-orange-600",bgColor:"bg-orange-100",label:"Ongoing"};case"Scheduled":return{icon:di,color:"text-blue-600",bgColor:"bg-blue-100",label:"Scheduled"};case"Resolved":return{icon:Ps,color:"text-green-600",bgColor:"bg-green-100",label:"Resolved"};default:return{icon:gn,color:"text-gray-500",bgColor:"bg-gray-100",label:O||"Unknown"}}};return u.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-xl shadow-xl",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[u.jsxs("h3",{className:"text-2xl font-semibold flex items-center",children:[u.jsx(Kt,{className:"mr-3 text-orange-500"})," Manage Service Advisories"]}),u.jsxs("button",{onClick:I,className:"bg-blue-600 text-white font-medium py-2 px-4 rounded-lg flex items-center text-sm",children:[u.jsx(Jy,{size:16,className:"mr-2"})," New Advisory"]})]}),s?u.jsx(an,{message:"Loading Advisories..."}):u.jsxs("div",{className:"space-y-3",children:[n.length===0&&u.jsxs("div",{className:"text-center py-10 bg-gray-50 rounded-lg",children:[u.jsx(gn,{size:32,className:"mx-auto text-gray-400 mb-2"}),u.jsx("p",{className:"text-gray-500",children:"No advisories found."})]}),n.map(O=>{var M,$,Y;const P=D(O.status,O.type),F=P.icon;return u.jsxs("div",{className:`p-4 rounded-lg shadow border-l-4 flex justify-between items-start gap-4 ${P.bgColor.replace("bg-","border-")}`,children:[u.jsxs("div",{className:"flex-grow",children:[u.jsx("h4",{className:"font-semibold text-gray-800",children:O.title}),u.jsxs("div",{className:"text-xs text-gray-600 mt-1 space-y-0.5",children:[u.jsxs("p",{className:"flex items-center",children:[u.jsx(co,{size:12,className:"mr-1.5"})," Areas: ",(M=O.affectedAreas)==null?void 0:M.slice(0,3).join(", "),(($=O.affectedAreas)==null?void 0:$.length)>3?"...":""," (",((Y=O.affectedAreas)==null?void 0:Y.length)||0,")"]}),u.jsxs("p",{className:"flex items-center",children:[u.jsx(di,{size:12,className:"mr-1.5"})," Start: ",$t(O.startDate)]}),O.estimatedEndDate&&u.jsxs("p",{className:"flex items-center",children:[u.jsx(di,{size:12,className:"mr-1.5"})," End: ",$t(O.estimatedEndDate)]}),u.jsxs("p",{className:"text-gray-400",children:["ID: ",O.id.substring(0,8),"..."]})]})]}),u.jsxs("div",{className:"flex flex-col items-end gap-2 shrink-0",children:[u.jsxs("span",{className:`px-2 py-0.5 text-xs font-semibold rounded-full flex items-center ${P.bgColor} ${P.color}`,children:[u.jsx(F,{size:12,className:"mr-1"})," ",P.label]}),u.jsxs("div",{className:"flex space-x-1",children:[u.jsx("button",{onClick:()=>j(O),className:"p-1.5 text-blue-600 hover:bg-blue-100 rounded-md disabled:opacity-50",disabled:_===O.id,children:u.jsx(tm,{size:16})}),u.jsx("button",{onClick:()=>C(O),className:"p-1.5 text-red-600 hover:bg-red-100 rounded-md disabled:opacity-50",disabled:_===O.id,children:_===O.id?u.jsx(Et,{className:"animate-spin",size:16}):u.jsx(oh,{size:16})})]})]})]},O.id)})]}),l&&u.jsx(Ar,{isOpen:l,onClose:()=>d(!1),title:f?"Edit Advisory":"Create New Advisory",size:"2xl",children:u.jsx(k$,{initialData:f,onSubmit:U,onCancel:()=>d(!1),isSaving:y,showNotification:t})}),x&&T&&u.jsxs(oc,{isOpen:x,onClose:()=>b(!1),onConfirm:k,title:"Confirm Deletion",isConfirming:!!_,confirmText:"Yes, Delete",iconType:"danger",children:['Delete advisory "',T.title,'"? This cannot be undone.']})]})};Eu.register(my,py,Df,gf,Tg,gd,Z2,Q2,Y2);const _t={blue:"rgba(59, 130, 246, 0.6)",blueBorder:"rgba(59, 130, 246, 1)",green:"rgba(16, 185, 129, 0.6)",greenBorder:"rgba(16, 185, 129, 1)",purple:"rgba(139, 92, 246, 0.6)",purpleBorder:"rgba(139, 92, 246, 1)",red:"rgba(239, 68, 68, 0.6)",redBorder:"rgba(239, 68, 68, 1)",orange:"rgba(249, 115, 22, 0.6)",orangeBorder:"rgba(249, 115, 22, 1)",teal:"rgba(20, 184, 166, 0.6)",tealBorder:"rgba(20, 184, 166, 1)",sky:"rgba(14, 165, 233, 0.6)",skyBorder:"rgba(14, 165, 233, 1)",pink:"rgba(236, 72, 153, 0.6)",yellow:"rgba(234, 179, 8, 0.6)",gray:"rgba(107, 114, 128, 0.6)"},IR=r=>({responsive:!0,maintainAspectRatio:!1,animation:!1,plugins:{legend:{display:!0,position:"bottom"},title:{display:!0,text:r,font:{size:16},color:"#374151",padding:{bottom:15}},tooltip:{backgroundColor:"#1F2937",titleColor:"#E5E7EB",bodyColor:"#D1D5DB",borderColor:"#4B5563",borderWidth:1,padding:10,boxPadding:3}},scales:{y:{beginAtZero:!0,grid:{color:"#E5E7EB"},ticks:{color:"#6B7280"}},x:{grid:{display:!1},ticks:{color:"#6B7280"}}}}),tg=({data:r,title:e,label:t,color:n,borderColor:i})=>{if(!r||Object.keys(r).length===0)return u.jsxs("p",{className:"text-sm text-gray-500 text-center py-10",children:["No data available for ",e,"."]});const s={labels:Object.keys(r),datasets:[{label:t,data:Object.values(r),backgroundColor:n,borderColor:i,borderWidth:1,borderRadius:4}]};return u.jsx("div",{className:"h-72 w-full",children:u.jsx(pR,{options:IR(e),data:s})})},g4=({data:r,title:e,datasets:t})=>{if(!r||Array.isArray(r)&&r.length===0||typeof r=="object"&&Object.keys(r).length===0)return u.jsxs("p",{className:"text-sm text-gray-500 text-center py-10",children:["No data available for ",e,"."]});let n;return t?n={labels:Object.keys(r),datasets:t.map(i=>({...i,data:Object.values(r).map(s=>s[i.key]||s||0)}))}:n={labels:Array.from({length:24},(s,o)=>`${o}:00`),datasets:[{label:"Tickets",data:r.map(s=>s.tickets),borderColor:_t.blueBorder,backgroundColor:_t.blue,tension:.1},{label:"Readings",data:r.map(s=>s.readings),borderColor:_t.greenBorder,backgroundColor:_t.green,tension:.1},{label:"Payments",data:r.map(s=>s.payments),borderColor:_t.purpleBorder,backgroundColor:_t.purple,tension:.1}]},u.jsx("div",{className:"h-72 w-full",children:u.jsx(Nq,{options:IR(e),data:n})})},rf=({data:r,title:e,colorMap:t})=>{if(!r||Object.keys(r).length===0)return u.jsxs("p",{className:"text-sm text-gray-500 text-center py-10",children:["No data for ",e,"."]});const n=[_t.blue,_t.green,_t.purple,_t.orange,_t.red,_t.teal,_t.sky,_t.pink,_t.yellow,_t.gray],i=t?Object.keys(r).map(l=>t[l]||_t.gray):n.slice(0,Object.keys(r).length),s={labels:Object.keys(r).map(l=>l.charAt(0).toUpperCase()+l.slice(1)),datasets:[{data:Object.values(r),backgroundColor:i,borderColor:"#FFFFFF",borderWidth:2}]},o={responsive:!0,maintainAspectRatio:!1,animation:!1,plugins:{legend:{display:!0,position:"bottom",labels:{boxWidth:12,padding:15}},title:{display:!0,text:e,font:{size:16},color:"#374151",padding:{bottom:15}},tooltip:{backgroundColor:"#1F2937",titleColor:"#E5E7EB",bodyColor:"#D1D5DB",borderColor:"#4B5563",borderWidth:1,padding:10,boxPadding:3}}};return u.jsx("div",{className:"h-72 w-full",children:u.jsx(Iq,{options:o,data:s})})},C$=({data:r,title:e})=>{if(!r||Object.keys(r).length===0)return u.jsxs("p",{className:"text-sm text-gray-500 text-center py-10",children:["No data for ",e,"."]});const t={labels:Object.keys(r),datasets:[{data:Object.values(r),backgroundColor:[_t.teal,_t.orange,_t.pink,_t.yellow,_t.sky,_t.blue,_t.green,_t.purple,_t.red],borderColor:"#FFFFFF",borderWidth:2}]},n={responsive:!0,maintainAspectRatio:!1,animation:!1,plugins:{legend:{display:!0,position:"bottom",labels:{boxWidth:12,padding:15}},title:{display:!0,text:e,font:{size:16},color:"#374151",padding:{bottom:15}},tooltip:{backgroundColor:"#1F2937",titleColor:"#E5E7EB",bodyColor:"#D1D5DB",borderColor:"#4B5563",borderWidth:1,padding:10,boxPadding:3}}};return u.jsx("div",{className:"h-72 w-full",children:u.jsx(gR,{options:n,data:t})})},no=({title:r,value:e,icon:t,color:n})=>u.jsx("div",{className:"bg-gray-50 p-4 rounded-lg shadow border-l-4",style:{borderColor:n},children:u.jsxs("div",{className:"flex items-center",children:[u.jsx("div",{className:"p-2 rounded-full mr-3",style:{backgroundColor:`${n}20`},children:u.jsx(t,{size:20,style:{color:n}})}),u.jsxs("div",{children:[u.jsx("p",{className:"text-xs font-medium text-gray-500 uppercase",children:r}),u.jsx("p",{className:"text-xl font-bold text-gray-800",children:e})]})]})}),R$=({showNotification:r=console.log})=>{var E,x,b,T,N,R,I;const[e,t]=J.useState(null),[n,i]=J.useState(!0),[s,o]=J.useState(""),[l,d]=J.useState(!1),f=J.useCallback(async()=>{i(!0),o("");try{const j=await Promise.allSettled([JC(Gt),e3(Gt),X8(Gt),S9(Gt),T9(Gt),A9(Gt),J8(Gt),e9(Gt),N9(Gt),I9(Gt),k9(Gt),P9(Gt)]),[U,C,k,D,O,P,F,M,$,Y,te,oe]=j;let ie="";const ne={},K=(B,G,X)=>{var se,le;if(B.status==="fulfilled"&&B.value.success)ne[X]=B.value.data,G==="User"&&(ne.totalUsers=B.value.data.total,ne.usersByRole=B.value.data.byRole),G==="Ticket"&&(ne.ticketStats=B.value.data.byStatus,ne.ticketsByType=B.value.data.byType,ne.totalTickets=B.value.data.total,ne.openTickets=B.value.data.openCount),G==="Outstanding balance"&&(ne.outstandingBalance=B.value.data.totalOutstanding);else{let Q="Unknown error";B.status==="rejected"?Q=((se=B.reason)==null?void 0:se.message)||B.reason.toString():(le=B.value)!=null&&le.error&&(Q=B.value.error),ie+=`${G} stats failed: ${Q} | `}};K(U,"User","users"),K(C,"Ticket","tickets"),K(k,"Monthly revenue","monthlyRevenue"),K(D,"Hourly activity","hourlyActivity"),K(O,"Staff activity","staffActivity"),K(P,"Technical","techStats"),K(F,"Location revenue","revenueByLocation"),K(M,"Outstanding balance","outstanding"),K($,"Consumption","monthlyConsumption"),K(Y,"Payment methods","paymentMethods"),K(te,"User growth","userGrowth"),K(oe,"Discount","discountStats"),ie&&o(ie.trim().slice(0,-1)),t(ne)}catch(j){o("Critical error fetching statistics."),console.error("fetchStatistics error:",j)}finally{i(!1)}},[r]);J.useEffect(()=>{f()},[f]);const m=async j=>{const U=`
            You are 'Agie', an AI analyst for AGWA Water Services. The currency is **Philippine Pesos (PHP)**.
            Analyze the following JSON data and generate a professional, high-level "Executive Summary" narrative for a printed report.
            - Start with "<h3 class='print-section-title'>Executive Summary</h3>".
            - Use simple HTML for formatting: <p>, <strong>, <ul>, <li>.
            - Write 2-3 short paragraphs.
            - Paragraph 1: Cover Business Analytics (Revenue, Outstanding Balance in PHP).
            - Paragraph 2: Cover User & Support Analytics (User totals, ticket status).
            - Paragraph 3: Cover Technical & Staff Operations (Routes, Interruptions, Staff Activity).
            - Be concise and highlight the most important numbers (e.g., total users, total revenue (PHP), open tickets, active interruptions).
            - Data: ${JSON.stringify(j)}
        `;try{return await Vo([{role:"user",content:U}],"llama-3.1-8b-instant")}catch(C){return console.error("AI Executive Summary Generation Failed:",C),"<h3 class='print-section-title'>Executive Summary</h3><p><strong>Analysis:</strong> <em>AI narrative generation failed. Please check the API connection or key.</em></p>"}},y=async()=>{var j,U,C,k,D,O,P,F,M;if(!(l||!e)){d(!0),r("Generating report... This may take a moment.","info");try{const $=document.getElementById("stats-print-area").querySelectorAll("canvas"),Y=Array.from($).map(ue=>new Promise(fe=>{var Oe;const _e=Object.values(Eu.instances).find(qe=>qe.canvas===ue);if(_e){const qe=(Oe=ue.closest("[data-chart-id]"))==null?void 0:Oe.dataset.chartId;fe(qe?{id:qe,dataUrl:_e.toBase64Image("image/png",1)}:null)}else fe(null)})),oe=(await Promise.all(Y)).filter(Boolean).reduce((ue,fe)=>(ue[fe.id]=fe.dataUrl,ue),{}),ie={business:{totalRevenue_12mo_PHP:g,totalOutstanding_PHP:e.outstandingBalance,totalConsumption_12mo_m3:_,revenueByLocation_PHP:e.revenueByLocation,paymentMethods:e.paymentMethods},userSupport:{totalUsers:e.totalUsers,usersByRole:e.usersByRole,totalTickets:e.totalTickets,openTickets:e.openTickets,ticketsByStatus:e.ticketStats,ticketsByType:e.ticketsByType,discountStats:e.discountStats},technical:{totalRoutes:(j=e.techStats)==null?void 0:j.totalRoutes,totalAccounts:(U=e.techStats)==null?void 0:U.totalAccounts,activeInterrupts:(C=e.techStats)==null?void 0:C.activeInterrupts,unassignedRoutes:(k=e.techStats)==null?void 0:k.unassignedRoutes},activity:{staffReadings:(D=e.staffActivity)==null?void 0:D.readerActivity,staffPayments:(O=e.staffActivity)==null?void 0:O.clerkActivity}},ne=[m(ie),Ts("Monthly Collected Revenue (Last 12 Months)",e.monthlyRevenue||{}),Ts("Monthly Water Consumption (Last 12 Months)",e.monthlyConsumption||{}),Ts("Revenue by Location",e.revenueByLocation||{}),Ts("Payments by Method",e.paymentMethods||{}),Ts("New User Signups (Last 12 Months)",e.userGrowth||{}),Ts("Users by Role",e.usersByRole||{}),Ts("Tickets by Type",e.ticketsByType||{}),Ts("Support Tickets by Status",e.ticketStats||{}),Ts("Customer Discount Status",e.discountStats||{}),Ts("Readings Submitted Today (by Staff)",((P=e.staffActivity)==null?void 0:P.readerActivity)||{}),Ts("Payments Processed Today (by Staff)",((F=e.staffActivity)==null?void 0:F.clerkActivity)||{}),Ts("Hourly Portal Activity (Today)",e.hourlyActivity||[])],K=await Promise.allSettled(ne),B=(ue,fe)=>K[ue].status==="fulfilled"?K[ue].value:`<p><strong>Analysis:</strong> <em>${fe}</em></p>`,G={summary:B(0,"Executive summary generation failed."),revenue:B(1,"Revenue analysis failed."),consumption:B(2,"Consumption analysis failed."),locationRevenue:B(3,"Location revenue analysis failed."),paymentMethods:B(4,"Payment method analysis failed."),userGrowth:B(5,"User growth analysis failed."),userRoles:B(6,"User role analysis failed."),ticketTypes:B(7,"Ticket type analysis failed."),ticketStatus:B(8,"Ticket status analysis failed."),discountStatus:B(9,"Discount status analysis failed."),staffReadings:B(10,"Staff reading analysis failed."),staffPayments:B(11,"Staff payment analysis failed."),hourlyActivity:B(12,"Hourly activity analysis failed.")},X=((M=document.getElementById("stats-print-styles"))==null?void 0:M.innerHTML)||"",se=window.open("","","height=800,width=1200");se.document.write("<html><head><title>System Analytics Report</title>"),se.document.write('<script src="https://cdn.tailwindcss.com"><\/script>'),se.document.write(`<style>${X}</style>`),se.document.write('</head><body class="bg-white">');const le=`
                <div class="printable-area p-8">
                    <header class="report-header">
                        <div>
                            <h1 class="logo-print">AGWA</h1>
                            <p class="tagline-print">Ensuring Clarity, Sustaining Life.</p>
                        </div>
                        <div class="company-address-print">
                            <strong>AGWA Water Services, Inc.</strong><br/>
                            123 Aqua Drive, Hydro Business Park<br/>
                            Naic, Cavite, Philippines 4110
                        </div>
                    </header>
                    <h1 class="report-title">SYSTEM ANALYTICS REPORT</h1>
                    <p class="report-generated-date">Generated: ${new Date().toLocaleString()}</p>
                    
                    <section class="print-section" id="ai-summary">
                        ${uo.sanitize(G.summary)}
                    </section>
            `;se.document.write(le);const Q=(ue,fe,_e="lg:col-span-1")=>{const Oe=oe[ue];return Oe?`
                    <div class="chart-container ${_e}">
                        <img src="${Oe}" alt="${ue} Chart" />
                        <div class="analysis-narrative">
                            ${uo.sanitize(fe)}
                        </div>
                    </div>
                `:`<div class="chart-container ${_e}"><div class="analysis-narrative"><p><strong>Analysis:</strong> <em>Chart data not found.</em></p></div></div>`};let ce=`
                <section class="print-section">
                    <h3 class="print-section-title">Business Analytics</h3>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        ${Q("revenue",G.revenue)}
                        ${Q("consumption",G.consumption)}
                        ${Q("locationRevenue",G.locationRevenue)}
                        ${Q("paymentMethods",G.paymentMethods)}
                    </div>
                </section>

                <section class="print-section">
                    <h3 class="print-section-title">User & Support Analytics</h3>
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        ${Q("userGrowth",G.userGrowth)}
                        ${Q("userRoles",G.userRoles)}
                        ${Q("ticketTypes",G.ticketTypes)}
                        ${Q("ticketStatus",G.ticketStatus)}
                        ${Q("discountStatus",G.discountStatus,"lg:col-span-2")}
                    </div>
                </section>

                <section class="print-section">
                    <h3 class="print-section-title">Staff & Technical Analytics</h3>
                     <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        ${Q("staffReadings",G.staffReadings)}
                        ${Q("staffPayments",G.staffPayments)}
                        ${Q("hourlyActivity",G.hourlyActivity)}
                    </div>
                </section>
            `;se.document.write(ce),se.document.write(`
                    <script>
                        window.onload = function() {
                            setTimeout(function() { 
                                window.print();
                                window.close();
                            }, 1500); 
                        };
                    <\/script>
                </div></body></html>
            `),se.document.close()}catch($){console.error("Print Report Error:",$),r("Failed to generate the full report.","error")}finally{d(!1)}}},g=J.useMemo(()=>e!=null&&e.monthlyRevenue?Object.values(e.monthlyRevenue).reduce((j,U)=>j+U,0):0,[e==null?void 0:e.monthlyRevenue]),_=J.useMemo(()=>e!=null&&e.monthlyConsumption?Object.values(e.monthlyConsumption).reduce((j,U)=>j+U,0):0,[e==null?void 0:e.monthlyConsumption]);return n?u.jsx(an,{message:"Loading system analytics...",className:"mt-10 h-64"}):u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsx("style",{id:"stats-print-styles",dangerouslySetInnerHTML:{__html:`
                @media print {
                    @page {
                        size: A4 portrait;
                        margin: 0.75in;
                    }
                    body { 
                        font-family: 'Times New Roman', Times, serif; 
                        -webkit-print-color-adjust: exact !important; 
                        print-color-adjust: exact !important;
                        color: #000;
                        font-size: 11pt; 
                    }
                    .no-print { display: none !important; }
                    .printable-area { padding: 0 !important; max-width: 100%; margin: auto; }
                    .report-header { display: flex; justify-content: space-between; align-items: flex-start; text-align: left; border-bottom: 2px solid #000; padding-bottom: 1rem; }
                    .report-header .logo-print { font-size: 2.5rem; font-weight: 700; color: #1e3a8a !important; line-height: 1; margin: 0; }
                    .report-header .tagline-print { font-size: 0.8rem; color: #1d4ed8 !important; font-style: italic; margin: 0; }
                    .report-header .company-address-print { text-align: right; font-size: 0.8rem; line-height: 1.4; color: #374151 !important; }
                    h1.report-title { font-size: 1.5rem; font-weight: 700; color: #000 !important; margin-top: 1.5rem; margin-bottom: 0.5rem; text-align: center; text-transform: uppercase; }
                    p.report-generated-date { text-align: center; font-size: 0.9rem; color: #4b5563; margin-bottom: 1.5rem; }
                    
                    .print-section { 
                        page-break-inside: avoid !important; 
                        margin-top: 1.5rem; 
                        padding-top: 1.5rem !important;
                        border-top: 1px solid #d1d5db !important;
                    }
                    #ai-summary {
                        background-color: #f3f4f6 !important;
                        border: 1px solid #e5e7eb !important;
                        border-radius: 8px;
                        padding: 1.25rem;
                        font-size: 10.5pt;
                        line-height: 1.6;
                        color: #374151 !important;
                    }
                    #ai-summary p { margin-bottom: 0.75rem; }
                    #ai-summary strong { color: #111827 !important; }
                    #ai-summary ul { margin-left: 1.25rem; list-style-type: disc; }

                    h3.print-section-title {
                        font-size: 1.3rem; 
                        font-weight: 700; 
                        border-bottom: 1px solid #4b5563; 
                        padding-bottom: 0.25rem; 
                        margin-bottom: 1rem; 
                        color: #111827 !important;
                    }
                    h3.print-section-title svg { display: none; }

                    .chart-container {
                        page-break-inside: avoid !important;
                        margin-bottom: 1.5rem;
                        border: 1px solid #e5e7eb;
                        border-radius: 8px;
                        padding: 1rem;
                        background-color: #F9FAFB !important;
                    }
                    .chart-container img {
                        width: 100%;
                        height: auto;
                        border-bottom: 1px solid #e5e7eb;
                        padding-bottom: 1rem;
                        margin-bottom: 1rem;
                    }
                    .analysis-narrative {
                        font-size: 10pt;
                        color: #374151 !important;
                        font-family: 'Georgia', serif;
                    }
                    .analysis-narrative p { margin-bottom: 0.5rem; }
                    .analysis-narrative strong { color: #111827 !important; font-weight: 600; }
                    .analysis-narrative em { font-style: italic; }

                    .shadow-xl, .shadow-md, .shadow-lg, .border { 
                        box-shadow: none !important; 
                    }
                    .bg-gray-50, .bg-white { background-color: transparent !important; }
                    .h-72 { height: auto !important; }
                }
             `}}),u.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-200 no-print",children:[u.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center",children:[u.jsx(b2,{size:30,className:"mr-3 text-orange-600"})," System Analytics"]}),u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsxs("button",{onClick:f,disabled:n||l,className:"flex items-center text-sm bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-3 rounded-lg border border-gray-300 disabled:opacity-50",children:[n?u.jsx(Et,{size:16,className:"animate-spin mr-2"}):u.jsx(za,{size:16,className:"mr-2"}),"Refresh"]}),u.jsxs("button",{onClick:y,disabled:n||l,className:"flex items-center text-sm bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-3 rounded-lg disabled:bg-gray-400",children:[l?u.jsx(Et,{size:16,className:"animate-spin mr-2"}):u.jsx(P2,{size:16,className:"mr-2"}),l?"Generating Report...":"Print Report"]})]})]}),s&&u.jsxs("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 p-4 my-4 flex items-start no-print",role:"alert",children:[u.jsx(gn,{size:20,className:"mr-3 mt-1 flex-shrink-0"}),u.jsxs("p",{className:"text-sm",children:["Could not load all statistics: ",u.jsx("span",{className:"font-mono text-xs break-all",children:s})]})]}),u.jsx("div",{id:"stats-print-area",className:"printable-area",children:u.jsxs("div",{className:"space-y-8",children:[u.jsxs("section",{className:"print-section",children:[u.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center print-section-title",children:[u.jsx(Dl,{size:22,className:"mr-2 text-green-600"}),"Business Analytics"]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6 no-print",children:[u.jsx(no,{title:"Total Revenue (12 Mo.)",value:`${g.toLocaleString("en-US",{minimumFractionDigits:0})}`,icon:Dl,color:_t.greenBorder}),u.jsx(no,{title:"Total Outstanding",value:`${((e==null?void 0:e.outstandingBalance)??0).toLocaleString("en-US",{minimumFractionDigits:0})}`,icon:r3,color:_t.redBorder}),u.jsx(no,{title:"Total Consumption (12 Mo.)",value:`${_.toLocaleString("en-US")} m`,icon:q9,color:_t.blueBorder})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"revenue",children:u.jsx(tg,{data:(e==null?void 0:e.monthlyRevenue)||{},title:"Monthly Collected Revenue (Last 12 Months)",label:"Revenue",color:_t.green,borderColor:_t.greenBorder})}),u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"consumption",children:u.jsx(tg,{data:(e==null?void 0:e.monthlyConsumption)||{},title:"Monthly Water Consumption (Last 12 Months)",label:"Consumption (m)",color:_t.blue,borderColor:_t.blueBorder})}),u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"locationRevenue",children:u.jsx(rf,{data:e==null?void 0:e.revenueByLocation,title:"Revenue by Location"})}),u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"paymentMethods",children:u.jsx(rf,{data:e==null?void 0:e.paymentMethods,title:"Payments by Method"})})]})]}),u.jsxs("section",{className:"print-section pt-6 border-t",children:[u.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center print-section-title",children:[u.jsx(Ta,{size:22,className:"mr-2 text-purple-600"}),"User & Support Analytics"]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6 no-print",children:[u.jsx(no,{title:"Total Users",value:(e==null?void 0:e.totalUsers)??"N/A",icon:Ta,color:_t.purpleBorder}),u.jsx(no,{title:"Total Tickets",value:(e==null?void 0:e.totalTickets)??"N/A",icon:Pa,color:_t.orangeBorder}),u.jsx(no,{title:"Open Tickets",value:(e==null?void 0:e.openTickets)??"0",icon:Kt,color:_t.redBorder}),u.jsx(no,{title:"Verified Discounts",value:((E=e==null?void 0:e.discountStats)==null?void 0:E.verified)??"N/A",icon:ya,color:_t.greenBorder})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"userGrowth",children:u.jsx(g4,{data:(e==null?void 0:e.userGrowth)||{},title:"New User Signups (Last 12 Months)",datasets:[{label:"New Users",key:"users",borderColor:_t.purpleBorder,backgroundColor:_t.purple,tension:.1}]})}),u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"userRoles",children:u.jsx(rf,{data:e==null?void 0:e.usersByRole,title:"Users by Role"})}),u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"ticketTypes",children:u.jsx(C$,{data:e==null?void 0:e.ticketsByType,title:"Tickets by Type"})}),u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"ticketStatus",children:u.jsx(rf,{data:e==null?void 0:e.ticketStats,title:"Support Tickets by Status"})}),u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border lg:col-span-2","data-chart-id":"discountStatus",children:u.jsx(rf,{data:e==null?void 0:e.discountStats,title:"Customer Discount Status",colorMap:{none:_t.gray,pending:_t.yellow,verified:_t.green}})})]})]}),u.jsxs("section",{className:"print-section pt-6 border-t",children:[u.jsxs("h3",{className:"text-xl font-semibold text-gray-800 mb-4 flex items-center print-section-title",children:[u.jsx(l3,{size:22,className:"mr-2 text-sky-600"}),"Staff & Technical Analytics"]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6 no-print",children:[u.jsx(no,{title:"Total Routes",value:((x=e==null?void 0:e.techStats)==null?void 0:x.totalRoutes)??"N/A",icon:co,color:_t.tealBorder}),u.jsx(no,{title:"Total Accounts",value:((b=e==null?void 0:e.techStats)==null?void 0:b.totalAccounts)??"N/A",icon:Ta,color:_t.tealBorder}),u.jsx(no,{title:"Active Interruptions",value:((T=e==null?void 0:e.techStats)==null?void 0:T.activeInterrupts)??"N/A",icon:Kt,color:_t.redBorder}),u.jsx(no,{title:"Unassigned Routes",value:((N=e==null?void 0:e.techStats)==null?void 0:N.unassignedRoutes)??"N/A",icon:r0,color:_t.orangeBorder})]}),u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"staffReadings",children:u.jsx(tg,{data:((R=e==null?void 0:e.staffActivity)==null?void 0:R.readerActivity)||{},title:"Readings Submitted Today (by Staff)",label:"Readings",color:_t.sky,borderColor:_t.skyBorder})}),u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"staffPayments",children:u.jsx(tg,{data:((I=e==null?void 0:e.staffActivity)==null?void 0:I.clerkActivity)||{},title:"Payments Processed Today (by Staff)",label:"Payments",color:_t.purple,borderColor:_t.purpleBorder})}),u.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border","data-chart-id":"hourlyActivity",children:u.jsx(g4,{data:(e==null?void 0:e.hourlyActivity)||[],title:"Hourly Portal Activity (Today)"})})]})]})]})})]})},j$=({isOpen:r,onClose:e,onSave:t,reading:n,isSaving:i,accountNumber:s})=>{const[o,l]=J.useState({});J.useEffect(()=>{var f;if(n){const m=(f=n.readingDate)!=null&&f.toDate?n.readingDate.toDate():new Date(n.readingDate),y=m.getFullYear(),g=String(m.getMonth()+1).padStart(2,"0"),_=String(m.getDate()).padStart(2,"0");l({readingValue:n.readingValue||"",readingDate:`${y}-${g}-${_}`,readingType:n.readingType||"Actual",notes:n.notes||""})}else l({readingValue:"",readingDate:new Date().toISOString().split("T")[0],readingType:"Actual",notes:""})},[n]);const d=f=>{f.preventDefault(),t(n==null?void 0:n.id,o)};return r?u.jsx(Ar,{isOpen:r,onClose:e,title:n?`Edit Reading for ${n.accountNumber}`:`Create New Reading for ${s}`,children:u.jsxs("form",{onSubmit:d,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"readingValue",className:"text-sm font-medium text-gray-700 flex items-center mb-1",children:[u.jsx(rc,{size:14,className:"mr-1.5"}),"Reading Value (m)"]}),u.jsx("input",{type:"number",name:"readingValue",value:o.readingValue,onChange:f=>l({...o,readingValue:f.target.value}),className:Fi,step:"0.01",required:!0})]}),u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"readingDate",className:"text-sm font-medium text-gray-700 flex items-center mb-1",children:[u.jsx(pu,{size:14,className:"mr-1.5"}),"Reading Date"]}),u.jsx("input",{type:"date",name:"readingDate",value:o.readingDate,onChange:f=>l({...o,readingDate:f.target.value}),className:Fi,required:!0})]}),u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"readingType",className:"text-sm font-medium text-gray-700 flex items-center mb-1",children:[u.jsx(z9,{size:14,className:"mr-1.5"}),"Reading Type"]}),u.jsxs("select",{name:"readingType",value:o.readingType,onChange:f=>l({...o,readingType:f.target.value}),className:Fi,children:[u.jsx("option",{value:"Actual",children:"Actual"}),u.jsx("option",{value:"Estimated",children:"Estimated"}),u.jsx("option",{value:"No Reading",children:"No Reading"})]})]}),u.jsxs("div",{children:[u.jsxs("label",{htmlFor:"notes",className:"text-sm font-medium text-gray-700 flex items-center mb-1",children:[u.jsx(iF,{size:14,className:"mr-1.5"}),"Notes"]}),u.jsx("textarea",{name:"notes",rows:"3",value:o.notes,onChange:f=>l({...o,notes:f.target.value}),className:Fi})]}),u.jsxs("div",{className:"pt-4 flex justify-end space-x-3",children:[u.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg border",disabled:i,children:"Cancel"}),u.jsxs("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 rounded-lg flex items-center",disabled:i,children:[i?u.jsx(Et,{size:18,className:"animate-spin mr-2"}):u.jsx(Ba,{size:18,className:"mr-2"}),i?"Saving...":"Save Changes"]})]})]})}):null},O$=({showNotification:r,userData:e})=>{var te,oe,ie;const[t,n]=J.useState(""),[i,s]=J.useState(null),[o,l]=J.useState(!1),[d,f]=J.useState(""),[m,y]=J.useState(!1),[g,_]=J.useState(null),[E,x]=J.useState(!1),[b,T]=J.useState(null),[N,R]=J.useState(!1),[I,j]=J.useState(!1),U=async ne=>{if(ne.preventDefault(),!t.trim()){f("Please enter an account number.");return}l(!0),f(""),y(!0),s(null);try{const K=ot(Gt,zn()),B=ft(K,wt("accountNumber","==",t.trim().toUpperCase())),G=await gt(B);if(G.empty){f("No user found with the provided account number."),l(!1);return}const X=G.docs[0];await C({id:X.id,...X.data()})}catch(K){console.error("Error searching for user or readings:",K),f("An error occurred during the search. Check Firestore rules and indexes."),l(!1)}},C=async ne=>{const K=ot(Gt,Va()),B=ft(K,wt("userId","==",ne.id),Wn("readingDate","desc")),X=(await gt(B)).docs.map(se=>({id:se.id,...se.data()}));s({user:ne,readings:X}),l(!1)},k=ne=>{x(!1),_(ne)},D=()=>{if(!(i!=null&&i.user)){r("Please search for a user first before creating a reading.","warning");return}_(null),x(!0)},O=()=>{_(null),x(!1)},P=async(ne,K)=>{R(!0);const B=await m9(Gt,ne,K);B.success?(r("Meter reading updated successfully!","success"),await C(i.user),O()):r(B.error||"Failed to update reading.","error"),R(!1)},F=async(ne,K)=>{R(!0);const B={...K,userId:i.user.id,accountNumber:i.user.accountNumber,meterSerialNumber:i.user.meterSerialNumber||"N/A",readBy:e.displayName||"Admin",readerId:e.uid},G=await QC(Gt,B);G.success?(r("New meter reading created successfully!","success"),await C(i.user),O()):r(G.error||"Failed to create reading.","error"),R(!1)},M=async()=>{if(!(i!=null&&i.user)){r("Please search for a user first.","error");return}j(!0);const ne=await GC(Gt,i.user.id,i.user);ne.success?r(ne.message,"success"):r(ne.error,"error"),j(!1)},$=ne=>{T(ne)},Y=async()=>{if(!b)return;R(!0);const ne=await p9(Gt,b);ne.success?(r("Meter reading deleted successfully!","success"),await C(i.user)):r(ne.error||"Failed to delete reading.","error"),T(null),R(!1)};return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl",children:[u.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Meter Reading & Billing"}),u.jsxs("form",{onSubmit:U,className:"mb-6 flex flex-col sm:flex-row gap-2 items-center bg-gray-50 p-4 rounded-lg shadow-sm",children:[u.jsx("input",{type:"text",value:t,onChange:ne=>n(ne.target.value),placeholder:"Enter user account number...",className:"w-full p-2 border rounded-md focus:ring-blue-500 focus:border-blue-500"}),u.jsxs("button",{type:"submit",disabled:o,className:"bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 disabled:bg-blue-400 flex items-center justify-center w-full sm:w-auto",children:[o?u.jsx(Et,{className:"animate-spin mr-2"}):u.jsx(js,{className:"mr-2",size:18}),o?"Searching...":"Search"]})]}),d&&u.jsx("p",{className:"text-red-500 text-center mb-4",children:d}),o&&u.jsx(an,{message:"Fetching data..."}),(i==null?void 0:i.user)&&u.jsxs("div",{className:"bg-white p-4 sm:p-6 rounded-lg shadow-md mt-6 border border-gray-200",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-4 gap-3",children:[u.jsxs("h2",{className:"text-xl font-semibold",children:["Data for ",i.user.displayName," (",i.user.accountNumber,")"]}),u.jsxs("div",{className:"flex gap-2 flex-wrap",children:[u.jsxs("button",{onClick:D,className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 flex items-center text-sm",children:[u.jsx(Jy,{size:16,className:"mr-2"})," Create Reading"]}),u.jsxs("button",{onClick:M,className:"bg-cyan-600 text-white px-4 py-2 rounded-md hover:bg-cyan-700 flex items-center text-sm disabled:bg-gray-400",disabled:I||i.readings.length<2,title:i.readings.length<2?"At least 2 readings are required to generate a bill":"Generate bill from latest reading",children:[I?u.jsx(Et,{size:16,className:"animate-spin mr-2"}):u.jsx(nc,{size:16,className:"mr-2"}),I?"Generating...":"Generate Bill"]})]})]}),u.jsxs("div",{className:"overflow-x-auto",children:[u.jsxs("table",{className:"min-w-full divide-y divide-gray-200 text-sm",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reading (m)"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Reader"}),u.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),u.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:(te=i.readings)==null?void 0:te.map(ne=>u.jsxs("tr",{children:[u.jsx("td",{className:"px-4 py-4 whitespace-nowrap font-medium",children:ne.readingValue}),u.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:$t(ne.readingDate,{year:"numeric",month:"short",day:"numeric"})}),u.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:ne.readBy||"N/A"}),u.jsx("td",{className:"px-4 py-4 whitespace-nowrap",children:ne.readingType||"N/A"}),u.jsxs("td",{className:"px-4 py-4 whitespace-nowrap text-center space-x-2",children:[u.jsx("button",{onClick:()=>k(ne),className:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-100 rounded-md transition-colors",title:"Edit Reading",children:u.jsx(tm,{size:16})}),u.jsx("button",{onClick:()=>$(ne.id),className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-100 rounded-md transition-colors",title:"Delete Reading",children:u.jsx(oh,{size:16})})]})]},ne.id))})]}),((oe=i.readings)==null?void 0:oe.length)<2&&u.jsx("p",{className:"text-xs text-center text-yellow-600 bg-yellow-50 p-2 mt-2 rounded-md",children:"Note: At least two readings are needed before a bill can be generated."})]})]}),(g||E)&&u.jsx(j$,{isOpen:!0,onClose:O,onSave:E?F:P,reading:g,isSaving:N,accountNumber:(ie=i==null?void 0:i.user)==null?void 0:ie.accountNumber}),b&&u.jsx(oc,{isOpen:!!b,onClose:()=>T(null),onConfirm:Y,title:"Confirm Deletion",confirmText:"Yes, Delete",isConfirming:N,iconType:"danger",children:"Are you sure you want to permanently delete this meter reading? This action cannot be undone."})]})},ng="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition-150 text-sm",M$=({isOpen:r,onClose:e,onSave:t,route:n,readers:i,isSaving:s,db:o})=>{const[l,d]=J.useState({name:"",areaCode:"",description:"",assignedReaderId:""}),[f,m]=J.useState([]),[y,g]=J.useState([]),[_,E]=J.useState({}),[x,b]=J.useState([]),[T,N]=J.useState(!1);J.useEffect(()=>{const P=c0(),F=[],M=P.reduce(($,Y)=>{const te=$d(Y).sort();return $[Y]=te,F.push(...te),$},{});E(M),b(F.sort())},[]),J.useEffect(()=>{if(r)if(n){d({name:n.name||"",areaCode:n.areaCode||"",description:n.description||"",assignedReaderId:n.assignedReaderId||""});const P=Array.isArray(n.barangays)?n.barangays:n.barangay?[n.barangay]:[];m(P),g(n.accountNumbers||[])}else d({name:"",areaCode:"",description:"",assignedReaderId:""}),m([]),g([])},[n,r]);const R=J.useCallback(async P=>{if(!P||P.length===0){g([]);return}N(!0);let F=[];for(const M of P){const $=await G8(o,M);$.success&&(F=[...F,...$.data])}g([...new Set(F)]),N(!1)},[o]);J.useEffect(()=>{R(f)},[f,R]);const I=P=>{m(F=>F.includes(P)?F.filter(M=>M!==P):[...F,P])},j=()=>{f.length===x.length?m([]):m([...x])},U=(P,F)=>{const M=F.every($=>f.includes($));m(M?$=>$.filter(Y=>!F.includes(Y)):$=>[...new Set([...$,...F])])},C=P=>P?P.split(" ").map(F=>F[0]).join("").toUpperCase():"",k=P=>{const F=P.target.value;d(M=>({...M,name:F,areaCode:C(F)}))},D=P=>{const{name:F,value:M}=P.target;d($=>({...$,[F]:M}))},O=P=>{P.preventDefault(),t({name:l.name,areaCode:l.areaCode,description:l.description,assignedReaderId:l.assignedReaderId,barangays:f,accountNumbers:y})};return u.jsxs(Ar,{isOpen:r,onClose:e,title:n?"Edit Meter Route":"Create New Meter Route",size:"2xl",children:[u.jsxs("form",{onSubmit:O,className:"space-y-4",children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"name",className:"block text-sm font-medium mb-1",children:"Route Name"}),u.jsx("input",{type:"text",name:"name",value:l.name,onChange:k,className:ng,required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"areaCode",className:"block text-sm font-medium mb-1",children:"Generated Area Code"}),u.jsx("input",{type:"text",name:"areaCode",value:l.areaCode,className:`${ng} bg-gray-200`,readOnly:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"assignedReaderId",className:"block text-sm font-medium mb-1",children:"Assign to Meter Reader"}),u.jsxs("select",{name:"assignedReaderId",value:l.assignedReaderId,onChange:D,className:ng,children:[u.jsx("option",{value:"",children:"Unassigned"}),i.map(P=>u.jsxs("option",{value:P.id,children:[P.displayName," (",P.email,")"]},P.id))]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"description",className:"block text-sm font-medium mb-1",children:"Description"}),u.jsx("textarea",{name:"description",value:l.description,onChange:D,rows:"2",className:ng})]}),u.jsxs("div",{className:"p-4 border rounded-lg bg-gray-50 max-h-72 overflow-y-auto scrollbar-thin",children:[u.jsxs("div",{className:"flex justify-between items-center mb-2 sticky top-0 bg-gray-50 py-1 -mt-1 border-b border-gray-200",children:[u.jsxs("label",{className:"block text-sm font-medium text-gray-700",children:[u.jsx(co,{size:16,className:"inline mr-1.5"}),"Assigned Area(s) *"]}),u.jsx("button",{type:"button",onClick:j,className:"text-xs font-medium text-blue-600 hover:underline",children:f.length===x.length?"Deselect All":`Select All (${x.length})`})]}),u.jsx("div",{className:"space-y-2",children:Object.entries(_).map(([P,F])=>u.jsxs("details",{className:"group bg-white border rounded-md",children:[u.jsxs("summary",{className:"flex justify-between items-center p-2 cursor-pointer list-none",children:[u.jsx("span",{className:"font-semibold text-sm text-blue-700",children:P}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("button",{type:"button",onClick:M=>{M.preventDefault(),U(P,F)},className:"text-xs text-blue-600 hover:underline mr-2",children:"Toggle District"}),u.jsx(E2,{size:18,className:"text-gray-500 group-open:rotate-180 transition-transform"})]})]}),u.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-2 p-3 border-t border-gray-100",children:F.map(M=>u.jsxs("label",{className:"flex items-center space-x-2 p-1.5 rounded bg-gray-50 border border-gray-200 hover:bg-blue-50 cursor-pointer text-xs has-[:checked]:bg-blue-100 has-[:checked]:border-blue-300",children:[u.jsx("input",{type:"checkbox",checked:f.includes(M),onChange:()=>I(M),className:"h-4 w-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500 shrink-0"}),u.jsx("span",{className:"truncate",title:M,children:M})]},M))})]},P))})]}),u.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[u.jsxs("p",{className:"text-sm font-medium text-blue-800 flex items-center",children:[u.jsx(Z9,{size:16,className:"mr-2"}),"Auto-Assigned Accounts"]}),T?u.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[u.jsx(Et,{className:"animate-spin h-4 w-4 mr-2"}),"Searching for accounts..."]}):f.length>0&&y.length>0?u.jsxs("p",{className:"text-sm text-gray-700",children:[y.length," total accounts found in ",f.length," selected area(s)."]}):f.length>0&&y.length===0?u.jsxs("p",{className:"text-sm text-orange-700 bg-orange-100 p-2 rounded-md flex items-center",children:[u.jsx(gn,{size:14,className:"mr-2"}),"No accounts found for this location. You cannot save an empty route."]}):u.jsx("p",{className:"text-xs text-gray-500",children:"Select at least one area to find and assign accounts."})]}),u.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[u.jsx("button",{type:"button",onClick:e,className:"px-4 py-2 text-sm font-medium bg-gray-200 rounded-lg",disabled:s,children:"Cancel"}),u.jsxs("button",{type:"submit",className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-lg flex items-center disabled:bg-gray-400 disabled:cursor-not-allowed",disabled:s||T||y.length===0,children:[s?u.jsx(Et,{size:18,className:"animate-spin mr-2"}):u.jsx(Ba,{size:18,className:"mr-2"}),s?"Saving...":"Save Route"]})]})]}),u.jsx("style",{children:`
                .scrollbar-thin { scrollbar-width: thin; scrollbar-color: #9ca3af #f3f4f6; }
                .scrollbar-thin::-webkit-scrollbar { width: 6px; height: 6px;}
                .scrollbar-thin::-webkit-scrollbar-track { background: #f3f4f6; border-radius:3px; }
                .scrollbar-thin::-webkit-scrollbar-thumb { background-color: #9ca3af; border-radius: 3px; border: 1px solid #f3f4f6;}
                .scrollbar-thin::-webkit-scrollbar-thumb:hover { background-color: #6b7280; }
             `})]})},D$=({db:r,showNotification:e})=>{const[t,n]=J.useState([]),[i,s]=J.useState([]),[o,l]=J.useState(!0),[d,f]=J.useState(""),[m,y]=J.useState(!1),[g,_]=J.useState(null),[E,x]=J.useState(!1),[b,T]=J.useState(null),N=J.useCallback(async()=>{l(!0),f("");try{const[k,D]=await Promise.all([Y8(r),Q8(r)]);k.success?n(k.data):f(k.error||"Failed to load routes."),D.success?s(D.data):f(O=>O+(D.error||" Failed to load meter readers."))}catch{f("An unexpected error occurred while fetching data.")}l(!1)},[r]);J.useEffect(()=>{N()},[N]);const R=(k=null)=>{_(k),y(!0)},I=()=>{_(null),y(!1)},j=async k=>{x(!0);const D=await K8(r,k,g==null?void 0:g.id);D.success?(e(`Route ${g?"updated":"created"} successfully!`,"success"),N(),I()):e(D.error||"Failed to save route.","error"),x(!1)},U=async()=>{if(!b)return;x(!0);const k=await Z8(r,b.id);k.success?(e("Route deleted successfully!","success"),T(null),N()):e(k.error||"Failed to delete route.","error"),x(!1)},C=k=>{var D;return((D=i.find(O=>O.id===k))==null?void 0:D.displayName)||"Unassigned"};return o?u.jsx(an,{message:"Loading route data..."}):u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b",children:[u.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center",children:[u.jsx(ic,{size:30,className:"mr-3 text-blue-600"})," Meter Route Management"]}),u.jsxs("button",{onClick:()=>R(),className:"bg-blue-600 text-white font-medium py-2 px-4 rounded-lg flex items-center",children:[u.jsx(Jy,{size:18,className:"mr-2"})," Add New Route"]})]}),d&&u.jsx("p",{className:"text-red-500 mb-4",children:d}),u.jsx("div",{className:"space-y-3",children:t.length>0?t.map(k=>{var D;return u.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border border-gray-200 flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"font-bold text-gray-800",children:[k.name," ",u.jsxs("span",{className:"text-sm font-normal text-gray-500",children:["(",k.areaCode,")"]})]}),u.jsxs("p",{className:"text-xs text-gray-600 flex items-center mt-1",children:[u.jsx(cF,{size:12,className:"mr-1.5"}),"Assigned to: ",u.jsx("span",{className:"font-medium ml-1",children:C(k.assignedReaderId)})]}),u.jsxs("p",{className:"text-xs text-gray-600 mt-1",children:["Accounts: ",((D=k.accountNumbers)==null?void 0:D.length)||0]})]}),u.jsxs("div",{className:"flex items-center space-x-2",children:[u.jsx("button",{onClick:()=>R(k),className:"p-2 text-blue-600 hover:bg-blue-100 rounded-full",children:u.jsx(tm,{size:18})}),u.jsx("button",{onClick:()=>T(k),className:"p-2 text-red-600 hover:bg-red-100 rounded-full",children:u.jsx(oh,{size:18})})]})]},k.id)}):u.jsxs("div",{className:"text-center py-10",children:[u.jsx(gn,{size:48,className:"mx-auto text-gray-400 mb-3"}),u.jsx("p",{className:"text-gray-500",children:"No routes found. Click 'Add New Route' to create one."})]})}),m&&u.jsx(M$,{isOpen:m,onClose:I,onSave:j,route:g,readers:i,isSaving:E,db:r}),b&&u.jsxs(oc,{isOpen:!!b,onClose:()=>T(null),onConfirm:U,title:"Confirm Route Deletion",isConfirming:E,children:['Are you sure you want to delete the route "',b.name,'"? This action cannot be undone.']})]})},L$=({db:r,showNotification:e})=>{const[t,n]=J.useState([]),[i,s]=J.useState(""),[o,l]=J.useState([]),[d,f]=J.useState(!1),[m,y]=J.useState(!1),[g,_]=J.useState([]);J.useEffect(()=>{(async()=>{const T=await W8(r);T.success?n(T.data):e(T.error,"error")})()},[r,e]);const E=async b=>{if(s(b),!b){l([]);return}f(!0),l([]);const T=await n9(r,b);T.success?l(T.data):e(T.error,"error"),f(!1)},x=async()=>{if(o.length===0){e("No billable accounts in the selected area.","warning");return}y(!0),_([]);const b=await r9(r,o);_(b),y(!1),e("Batch billing process completed. Check logs for details.","success"),E(i)};return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl",children:[u.jsxs("h2",{className:"text-2xl font-semibold text-gray-800 flex items-center mb-4",children:[u.jsx(nc,{size:30,className:"mr-3 text-green-600"})," Batch Bill Generation"]}),u.jsx("p",{className:"text-sm text-gray-500 mb-6",children:"Select a service area to find eligible accounts and generate bills in bulk. An account is eligible if it has a new reading that has not yet been billed."}),u.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg border",children:[u.jsx("label",{htmlFor:"location",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Service Area (Barangay)"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[u.jsxs("select",{id:"location",value:i,onChange:b=>E(b.target.value),className:"w-full p-2 border rounded-md bg-white",children:[u.jsx("option",{value:"",children:"-- Select an Area --"}),t.map(b=>u.jsx("option",{value:b,children:b},b))]}),u.jsxs("button",{onClick:x,className:"bg-green-600 text-white px-5 py-2 rounded-md flex items-center justify-center whitespace-nowrap disabled:bg-gray-400",disabled:d||m||o.length===0,children:[m?u.jsx(Et,{size:18,className:"animate-spin mr-2"}):u.jsx(F9,{size:18,className:"mr-2"}),m?"Processing...":`Generate ${o.length} Bills`]})]})]}),u.jsxs("div",{className:"mt-6",children:[u.jsxs("h3",{className:"font-semibold",children:["Eligible Accounts in ",i||"..."]}),d&&u.jsx(an,{message:"Finding billable accounts..."}),!d&&i&&o.length===0&&u.jsxs("div",{className:"text-center py-6 bg-gray-50 mt-2 rounded-md",children:[u.jsx(gn,{size:32,className:"mx-auto text-gray-400 mb-2"}),u.jsx("p",{className:"text-gray-600",children:"No new readings eligible for billing in this area."})]}),!d&&o.length>0&&u.jsxs("p",{className:"text-green-700 font-medium my-2",children:[o.length," accounts ready for billing."]})]}),g.length>0&&u.jsxs("div",{className:"mt-6 pt-4 border-t",children:[u.jsx("h3",{className:"font-semibold mb-2",children:"Processing Log"}),u.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto bg-gray-900 text-white font-mono text-xs p-4 rounded-md",children:g.map((b,T)=>u.jsxs("div",{className:`flex items-start ${b.success?"text-green-400":"text-red-400"}`,children:[b.success?u.jsx(Ps,{size:14,className:"mr-2 mt-0.5 flex-shrink-0"}):u.jsx(Kt,{size:14,className:"mr-2 mt-0.5 flex-shrink-0"}),u.jsx("span",{children:b.message})]},T))})]})]})},F$=({userData:r,db:e,showNotification:t,setActiveSection:n})=>{const[i,s]=J.useState({assignedRoutesCount:0,totalAccountsInRoutes:0,pendingReadingsInRoutes:0,readingsCompletedToday:0,issuesReportedByMe:0}),[o,l]=J.useState([]),[d,f]=J.useState(new Set),[m,y]=J.useState(!0),[g,_]=J.useState(""),E=J.useCallback(async()=>{if(!r||!r.uid){t("Meter reader data not available.","error"),y(!1);return}y(!0),_(""),l([]);try{const[b,T,N]=await Promise.allSettled([XC(e,r.uid),YC(e,r.uid),x2(e)]),R={};let I="",j=new Set;if(b.status==="fulfilled"&&b.value.success){const U=b.value.data.map(C=>{var k,D;return{...C,accountCount:C.accountCount||((k=C.accountNumbers)==null?void 0:k.length)||0,completedCount:C.completedReadingsToday||0,pendingCount:Math.max(0,(C.accountCount||((D=C.accountNumbers)==null?void 0:D.length)||0)-(C.completedReadingsToday||0))}});R.assignedRoutesCount=U.length,R.totalAccountsInRoutes=U.reduce((C,k)=>C+k.accountCount,0),R.pendingReadingsInRoutes=U.reduce((C,k)=>C+k.pendingCount,0),R.readingsCompletedToday=U.reduce((C,k)=>C+k.completedCount,0),j=new Set(U.flatMap(C=>C.barangays||[])),f(j)}else I+="Route data unavailable. ";if(N.status==="fulfilled"&&N.value.success){if(j.size>0){const U=N.value.data.filter(C=>C.affectedAreas&&C.affectedAreas.some(k=>j.has(k)));l(U)}}else I+="Interruption data unavailable. ";T.status==="fulfilled"&&T.value.success?R.issuesReportedByMe=T.value.data.length:I+="Reported issues data unavailable. ",s(U=>({...U,...R})),I.trim()&&(_(I.trim()),t("Some dashboard statistics could not be loaded.","warning"))}catch{const T="Could not load meter reader dashboard statistics. Please try refreshing.";_(T),t(T,"error")}finally{y(!1)}},[e,r,t]);J.useEffect(()=>{E()},[E]);const x=[{title:"View Assigned Routes",icon:ic,section:"assignedRoutes",description:"Check your daily routes and assigned accounts for reading.",color:"blue"},{title:"Manual Reading Entry",icon:T2,section:"searchAndSubmitReading",description:"Submit a reading for an account not on your immediate list.",color:"green"},{title:"Search Customer Info",icon:js,section:"searchCustomerMeterReader",description:"Look up customer or meter details for verification.",color:"teal"},{title:"Report Field Issue",icon:Kt,section:"reportIssue",description:"Log issues like meter damage, leaks, or access problems.",color:"orange"}];return m?u.jsx(an,{message:"Loading your dashboard...",className:"mt-10 h-48"}):u.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[u.jsx("div",{className:"p-6 bg-gradient-to-r from-sky-600 to-cyan-700 text-white rounded-xl shadow-xl",children:u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl sm:text-3xl font-bold",children:"Meter Reader Dashboard"}),u.jsxs("p",{className:"mt-1 text-sky-100",children:["Welcome, ",r.displayName||"Meter Reader","! Your tasks and tools are below."]})]}),u.jsxs("button",{onClick:E,className:"mt-3 sm:mt-0 text-sm flex items-center bg-sky-500 hover:bg-sky-400 text-white font-medium py-2 px-3 rounded-lg transition-colors disabled:opacity-70 self-start sm:self-center",disabled:m,title:"Refresh Statistics",children:[m?u.jsx(Et,{size:16,className:"animate-spin"}):u.jsx(za,{size:16}),u.jsx("span",{className:"ml-2 hidden sm:inline",children:"Refresh"})]})]})}),g&&u.jsxs("p",{className:"text-sm text-yellow-600 bg-yellow-50 p-3 rounded-md text-center my-4 flex items-center justify-center gap-2",children:[u.jsx(gn,{size:16})," ",g]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5",children:[u.jsx(hi,{title:"Assigned Routes",value:i.assignedRoutesCount,icon:ic,borderColor:"border-blue-500",iconColor:"text-blue-500",onClick:()=>n("assignedRoutes")}),u.jsx(hi,{title:"Pending Readings",value:i.pendingReadingsInRoutes,icon:Y9,borderColor:"border-orange-500",iconColor:"text-orange-500",subtext:`Across ${i.totalAccountsInRoutes} total accounts`,onClick:()=>n("assignedRoutes")}),u.jsx(hi,{title:"Readings Done Today",value:i.readingsCompletedToday,icon:Ps,borderColor:"border-green-500",iconColor:"text-green-500"}),u.jsx(hi,{title:"My Reported Issues",value:i.issuesReportedByMe,icon:Kt,borderColor:"border-red-500",iconColor:"text-red-500",onClick:()=>n("myTickets")})]}),u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-5 mt-8 pt-5 border-t border-gray-200",children:"Your Tools & Actions"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:x.map(b=>u.jsxs("button",{onClick:()=>n(b.section),className:`p-6 bg-white rounded-xl shadow-lg hover:shadow-2xl transform hover:-translate-y-1.5 transition-all duration-300 ease-in-out text-left focus:outline-none focus:ring-2 focus:ring-${b.color}-500 focus:ring-opacity-75 group h-full flex flex-col`,children:[u.jsx("div",{className:`p-3 bg-${b.color}-100 rounded-full inline-block mb-3 self-start group-hover:scale-110 transition-transform`,children:u.jsx(b.icon,{size:28,className:`text-${b.color}-600`})}),u.jsx("h4",{className:`text-lg font-semibold text-gray-800 group-hover:text-${b.color}-700 transition-colors`,children:b.title}),u.jsx("p",{className:"text-sm text-gray-500 mt-1 leading-normal flex-grow",children:b.description})]},b.section))})]}),u.jsxs("div",{className:"mt-8 p-5 bg-gray-50 rounded-xl shadow",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-700 mb-3 flex items-center",children:[u.jsx(Kt,{size:20,className:"mr-2 text-yellow-500"})," Important Notices / Route Highlights"]}),o.length>0?u.jsx("div",{className:"space-y-3 mb-4",children:o.map(b=>u.jsxs("div",{className:"p-3 bg-yellow-100 border-l-4 border-yellow-500 text-yellow-800 rounded-r-lg",children:[u.jsx("p",{className:"font-semibold text-sm",children:b.title}),u.jsxs("p",{className:"text-xs mt-1 flex items-center",children:[u.jsx(co,{size:12,className:"mr-1.5"}),u.jsx("strong",{children:"Affected Areas on your route:"})," ",b.affectedAreas.filter(T=>d.has(T)).join(", ")]})]},b.id))}):u.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"No specific system notices for your routes today."}),u.jsx("p",{className:"text-sm text-gray-500 border-t border-gray-200 pt-3 mt-3",children:"Please ensure all readings are accurate and submitted on time. Report any discrepancies or issues immediately. Stay safe and hydrated!"})]})]})},sf="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",kR=({db:r,userData:e,showNotification:t,customerToRead:n,onReadingSubmitted:i,isModalMode:s=!1,onCloseModal:o})=>{const[l,d]=J.useState(""),[f,m]=J.useState(!1),[y,g]=J.useState(""),[_,E]=J.useState(n||null),[x,b]=J.useState(""),[T,N]=J.useState(new Date().toISOString().split("T")[0]),[R,I]=J.useState("Actual"),[j,U]=J.useState(""),[C,k]=J.useState(!1),D=async F=>{if(F.preventDefault(),!l.trim()){t("Please enter a search term.","warning");return}m(!0),g(""),E(null);const M=await Qy(r,l);M.success&&M.data.length>0?E(M.data[0]):M.success?g(`No customer found matching "${l}".`):g(M.error||"Failed to execute user search."),m(!1)},O=async F=>{if(F.preventDefault(),!_){t("No customer selected. Please search for a customer first.","error");return}if(!x||isNaN(parseFloat(x))||parseFloat(x)<0){t("Meter reading must be a valid, non-negative number.","warning");return}k(!0);const M={userId:_.id,accountNumber:_.accountNumber,meterSerialNumber:_.meterSerialNumber||"N/A",readingValue:parseFloat(x),readingDate:T,readingDateString:T,readingType:R,notes:j.trim(),readBy:e.displayName||e.email,readerId:e.uid},$=await QC(r,M);$.success?s&&i?i($.id,M):(t(`Reading for ${_.accountNumber} submitted successfully!`,"success"),d(""),E(null),b(""),U(""),I("Actual")):t($.error||"Failed to submit meter reading.","error"),k(!1)},P=["Actual","Estimated","No Reading","Customer Refused","Unable to Access Meter"];return u.jsxs("div",{className:s?"":"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[!s&&u.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(T2,{size:30,className:"mr-3 text-blue-600"})," Search & Submit Reading"]})}),!_&&!s&&u.jsxs("form",{onSubmit:D,className:"mb-6 p-4 bg-gray-50 rounded-lg shadow-sm",children:[u.jsx("label",{htmlFor:"customerSearchTerm",className:"block text-sm font-medium text-gray-700 mb-1",children:"Find Customer to Read"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[u.jsxs("div",{className:"relative flex-grow",children:[u.jsx(js,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsx("input",{type:"text",id:"customerSearchTerm",value:l,onChange:F=>d(F.target.value),className:`${sf} pl-9`,placeholder:"Search by Account No, Name, or Meter No...",disabled:f})]}),u.jsxs("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2.5 px-6 rounded-lg flex items-center justify-center",disabled:f,children:[f?u.jsx(Et,{size:18,className:"animate-spin mr-2"}):u.jsx(js,{size:18,className:"mr-2"}),"Find"]})]}),y&&u.jsx("p",{className:"text-red-500 text-xs mt-2",children:y})]}),f&&u.jsx(an,{message:"Searching..."}),_&&u.jsxs("form",{onSubmit:O,className:"space-y-5 p-4 border-t-4 border-blue-500 bg-blue-50 rounded-lg shadow-md animate-fadeIn",children:[u.jsxs("div",{className:"p-3 border border-blue-200 bg-white rounded-md text-sm space-y-1",children:[u.jsxs("p",{className:"font-semibold text-blue-800 flex items-center",children:[u.jsx(Cs,{size:16,className:"mr-2"}),_.displayName]}),u.jsxs("p",{className:"text-gray-600 flex items-center",children:[u.jsx(Rs,{size:14,className:"mr-2"}),"Account No: ",_.accountNumber]}),u.jsxs("p",{className:"text-gray-600 flex items-center",children:[u.jsx(rc,{size:14,className:"mr-2"}),"Meter No: ",_.meterSerialNumber||"N/A"]})]}),u.jsxs("fieldset",{disabled:C,className:"space-y-5",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"readingValue",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Meter Reading (m)*"}),u.jsx("input",{type:"number",id:"readingValue",value:x,onChange:F=>b(F.target.value),className:sf,step:"0.01",required:!0})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"readingDate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Reading Date*"}),u.jsx("input",{type:"date",id:"readingDate",value:T,onChange:F=>N(F.target.value),className:sf,required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"readingType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Reading Type*"}),u.jsx("select",{id:"readingType",value:R,onChange:F=>I(F.target.value),className:sf,required:!0,children:P.map(F=>u.jsx("option",{value:F,children:F},F))})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes / Remarks"}),u.jsx("textarea",{id:"notes",value:j,onChange:F=>U(F.target.value),rows:"3",className:sf,placeholder:"e.g., Meter obstructed, Dog on premises..."})]})]}),u.jsxs("div",{className:"flex gap-3",children:[s&&u.jsx("button",{type:"button",onClick:o,className:"w-full bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2.5 px-6 rounded-lg",disabled:C,children:"Cancel"}),u.jsxs("button",{type:"submit",className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-2.5 px-6 rounded-lg flex items-center justify-center disabled:opacity-60",disabled:C,children:[C?u.jsx(Et,{size:20,className:"animate-spin mr-2"}):u.jsx(Ba,{size:20,className:"mr-2"}),C?"Submitting...":"Submit Reading"]})]})]})]})},V$="w-full px-3 py-2 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",z$=({db:r,userData:e,showNotification:t})=>{const[n,i]=J.useState([]),[s,o]=J.useState(null),[l,d]=J.useState([]),[f,m]=J.useState(!0),[y,g]=J.useState(!1),[_,E]=J.useState(""),[x,b]=J.useState(""),[T,N]=J.useState(null),[R,I]=J.useState(!1),[j,U]=J.useState(""),C=J.useCallback(async($=!0)=>{if(!e||!e.uid){E("Meter reader ID not available. Cannot fetch routes."),m(!1);return}$&&m(!0),E("");const Y=await XC(r,e.uid);if(Y.success){const te=Y.data.map(oe=>{var ie,ne,K;return{...oe,accountCount:oe.accountCount||((ie=oe.accountNumbers)==null?void 0:ie.length)||((ne=oe.accountIds)==null?void 0:ne.length)||0,completedCount:oe.completedReadingsToday||0,pendingCount:Math.max(0,(oe.accountCount||((K=oe.accountNumbers)==null?void 0:K.length)||0)-(oe.completedReadingsToday||0))}});i(te.sort((oe,ie)=>(oe.name||"").localeCompare(ie.name||"")))}else{const te=Y.error||"Failed to fetch assigned routes.";E(te),i([])}$&&m(!1)},[r,e]);J.useEffect(()=>{C()},[C]);const k=J.useCallback(async $=>{if(!$)return;g(!0),b("");const Y=await t9(r,$);if(Y.success){const te=new Date().toISOString().split("T")[0],oe=await Promise.all(Y.data.map(async ie=>{var G;let ne={readingValue:"N/A",readingDate:null},K=!1;const B=await g9(r,ie.accountNumber);if(B.success&&B.data.length>0){const X=B.data[0];ne.readingValue=X.readingValue,ne.readingDate=(G=X.readingDate)!=null&&G.toDate?X.readingDate.toDate():new Date(X.readingDate),X.readingDate.toDate().toISOString().split("T")[0]===te&&(K=!0)}return{...ie,lastReading:ne.readingValue,lastReadingDateDisplay:ne.readingDate?$t(ne.readingDate,{month:"short",day:"numeric"}):"N/A",readingStatus:K?"Completed Today":"Pending"}}));d(oe.sort((ie,ne)=>{var K,B;return(((K=ie.serviceAddress)==null?void 0:K.street)||"").localeCompare(((B=ne.serviceAddress)==null?void 0:B.street)||"")}))}else{const te=Y.error||`Failed to fetch accounts for route ${$.name}.`;b(te),d([])}g(!1)},[r]),D=$=>{(s==null?void 0:s.id)!==($==null?void 0:$.id)&&(o($),U(""),d([]),$&&k($))},O=$=>{N($),I(!0)},P=($,Y)=>{if(t(`Reading for ${Y.accountNumber} submitted successfully.`,"success"),d(te=>te.map(oe=>oe.accountNumber===Y.accountNumber?{...oe,readingStatus:"Completed Today",lastReading:Y.readingValue,lastReadingDateDisplay:$t(new Date,{month:"short",day:"numeric"})}:oe)),s){const te=n.map(ie=>{if(ie.id===s.id){const ne=(ie.completedCount||0)+1;return{...ie,completedCount:ne,pendingCount:Math.max(0,ie.accountCount-ne)}}return ie});i(te);const oe=te.find(ie=>ie.id===s.id);oe&&o(oe)}I(!1),N(null)},F=$=>!$||typeof $!="object"?"N/A":[$.street,$.barangay,$.district].filter(te=>te&&te.trim()).join(", "),M=l.filter($=>{var oe,ie,ne;const Y=j.toLowerCase(),te=F($.serviceAddress).toLowerCase();return((oe=$.displayName)==null?void 0:oe.toLowerCase().includes(Y))||((ie=$.accountNumber)==null?void 0:ie.toLowerCase().includes(Y))||te.includes(Y)||((ne=$.meterSerialNumber)==null?void 0:ne.toLowerCase().includes(Y))});return f?u.jsx(an,{message:"Loading your assigned routes...",className:"mt-10 h-64"}):_&&n.length===0?u.jsxs("div",{className:"text-center py-10 bg-red-50 p-4 rounded-lg",children:[u.jsx(Kt,{size:48,className:"mx-auto text-red-400 mb-3"}),u.jsx("p",{className:"text-red-600 text-lg font-semibold",children:"Error Loading Routes"}),u.jsx("p",{className:"text-sm text-red-500 mt-1",children:_})]}):u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(ic,{size:30,className:"mr-3 text-blue-600"})," Assigned Routes & Meter Reading"]}),u.jsxs("button",{onClick:()=>C(!1),className:"mt-3 sm:mt-0 text-sm flex items-center bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-2 px-3 rounded-lg border border-gray-300 transition-colors",disabled:f||y,title:"Refresh Route List",children:[u.jsx(za,{size:16,className:`mr-1.5 ${f?"animate-spin":""}`}),"Refresh Routes"]})]}),n.length===0&&!f&&!_&&u.jsxs("div",{className:"text-center py-10 bg-gray-50 rounded-lg p-4",children:[u.jsx(gn,{size:48,className:"mx-auto text-gray-400 mb-3"}),u.jsx("p",{className:"text-gray-500 text-lg",children:"No routes are currently assigned to you."})]}),n.length>0&&u.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[u.jsxs("div",{className:"lg:col-span-1 bg-slate-50 p-3.5 rounded-lg shadow-md max-h-[75vh] overflow-y-auto",children:[u.jsxs("h3",{className:"text-md font-semibold text-slate-700 mb-3 sticky top-0 bg-slate-50 py-2 z-10 border-b border-slate-200",children:["My Routes (",n.length,")"]}),u.jsx("div",{className:"space-y-2.5",children:n.map($=>u.jsxs("button",{onClick:()=>D($),className:`w-full text-left p-3 rounded-lg border-2 transition-all duration-200 transform hover:scale-[1.02] focus:outline-none focus:ring-2 focus:ring-offset-1
                                        ${(s==null?void 0:s.id)===$.id?"bg-blue-600 text-white shadow-lg border-blue-700 ring-blue-500":"bg-white hover:bg-blue-50 border-gray-200 hover:border-blue-400"}`,children:[u.jsx("p",{className:`font-semibold text-sm ${(s==null?void 0:s.id)===$.id?"text-white":"text-blue-700"}`,children:$.name}),u.jsxs("p",{className:`text-xs mt-0.5 ${(s==null?void 0:s.id)===$.id?"text-blue-100":"text-gray-500"}`,children:["Area: ",$.areaCode||"N/A"]}),u.jsxs("div",{className:"mt-1.5 text-xs",children:[u.jsx("span",{className:`px-1.5 py-0.5 rounded-full text-white text-[10px] ${($.pendingCount||0)>0?"bg-orange-500":"bg-green-500"}`,children:($.pendingCount||0)===0&&$.accountCount>0?"All Read":`${$.pendingCount} Pending`}),u.jsxs("span",{className:`ml-1.5 ${(s==null?void 0:s.id)===$.id?"text-blue-200":"text-gray-400"}`,children:["(",$.completedCount||0," / ",$.accountCount||0,")"]})]})]},$.id))})]}),u.jsxs("div",{className:"lg:col-span-3",children:[!s&&!y&&u.jsxs("div",{className:"p-6 text-center text-gray-400 bg-slate-50 rounded-lg shadow-inner h-full flex flex-col justify-center items-center min-h-[300px]",children:[u.jsx(n3,{size:48,className:"mb-3 opacity-70"}),u.jsx("p",{className:"text-lg",children:"Please select a route to view accounts."})]}),s&&y&&u.jsx(an,{message:`Loading accounts for ${s.name}...`,className:"min-h-[300px]"}),s&&!y&&u.jsxs("div",{className:"bg-slate-50 p-4 rounded-lg shadow-md",children:[u.jsxs("div",{className:"pb-2 mb-3 border-b border-slate-200",children:[u.jsxs("h3",{className:"text-lg font-semibold text-slate-700",children:["Accounts in: ",s.name]}),u.jsx("p",{className:"text-xs text-slate-500",children:s.description||"No route description provided."})]}),u.jsxs("div",{className:"relative mb-4",children:[u.jsx(js,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400 pointer-events-none"}),u.jsx("input",{type:"text",placeholder:"Search by Name, Account No, Address...",value:j,onChange:$=>U($.target.value),className:`${V$} pl-9`})]}),x&&u.jsx("p",{className:"text-sm text-red-500 text-center py-3 bg-red-50 rounded-md",children:x}),u.jsx("div",{className:"space-y-3 max-h-[65vh] overflow-y-auto pr-1 pb-2",children:M.length>0?M.map($=>u.jsxs("div",{className:`p-3.5 border rounded-lg flex flex-col sm:flex-row justify-between items-start sm:items-center transition-shadow hover:shadow-md 
                                            ${$.readingStatus==="Completed Today"?"bg-green-50 border-green-300":"bg-white border-gray-200 hover:border-blue-400"}`,children:[u.jsxs("div",{className:"flex-grow mb-2 sm:mb-0",children:[u.jsxs("p",{className:"font-medium text-slate-800 text-sm",children:[$.displayName," ",u.jsxs("span",{className:"text-xs text-slate-500 font-mono",children:["(",$.accountNumber,")"]})]}),u.jsx("p",{className:"text-xs text-slate-600 mt-0.5",children:F($.serviceAddress)}),u.jsxs("p",{className:"text-xs text-slate-500 mt-0.5",children:["Meter: ",$.meterSerialNumber," | Last Reading: ",$.lastReading||"N/A"," on ",$.lastReadingDateDisplay]}),u.jsxs("p",{className:`text-xs font-semibold mt-1 ${$.readingStatus==="Completed Today"?"text-green-600":"text-orange-600"}`,children:["Status: ",$.readingStatus]})]}),u.jsxs("button",{onClick:()=>O($),className:`text-xs font-medium py-1.5 px-3.5 rounded-md flex items-center transition-colors active:scale-95 whitespace-nowrap
                                                    ${$.readingStatus==="Completed Today"?"bg-yellow-500 hover:bg-yellow-600 text-white":"bg-blue-600 hover:bg-blue-700 text-white"}`,title:$.readingStatus==="Completed Today"?"Review or Edit Reading":"Submit New Reading",children:[u.jsx(k2,{size:13,className:"mr-1.5"})," ",$.readingStatus==="Completed Today"?"Edit":"Enter Reading"]})]},$.id||$.accountNumber)):u.jsxs("div",{className:"py-6 text-center text-gray-500",children:[u.jsx(Cs,{size:36,className:"mx-auto mb-2 text-gray-400"}),"No accounts ",j?"match your search.":"found for this route."]})})]})]})]}),R&&T&&u.jsx(Ar,{isOpen:R,onClose:()=>{I(!1),N(null)},title:`Meter Reading: ${T.displayName} (${T.accountNumber})`,size:"lg",children:u.jsx(kR,{db:r,userData:e,showNotification:t,customerToRead:T,onReadingSubmitted:P,isModalMode:!0,onCloseModal:()=>{I(!1),N(null)}})})]})},B$="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",U$=({db:r,showNotification:e})=>{const[t,n]=J.useState(""),[i,s]=J.useState(null),[o,l]=J.useState(!1),[d,f]=J.useState(""),m=async _=>{if(_.preventDefault(),!t.trim()){e("Please enter a search term (Account No., Name, or Meter No.).","warning");return}l(!0),f(""),s(null);try{const E=await Qy(r,t);E.success&&E.data.length>0?s(E.data[0]):E.success?f(`No customer found matching "${t}".`):f(E.error||"Failed to search for users.")}catch{f("An error occurred during the search.")}l(!1)},y=_=>!_||typeof _!="object"?_||"N/A":[_.street,_.barangay,_.district,"Naic, Cavite"].filter(x=>x&&x.trim()).join(", "),g=({label:_,value:E,icon:x})=>u.jsxs("div",{className:"flex items-start py-2 border-b border-gray-100",children:[x&&u.jsx(x,{size:16,className:"mr-2.5 text-blue-500 flex-shrink-0 mt-0.5"}),u.jsxs("span",{className:"text-xs font-medium text-gray-500 w-32 sm:w-40",children:[_,":"]}),u.jsx("span",{className:"text-sm text-gray-800 flex-1 break-words",children:E||"N/A"})]});return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(js,{size:30,className:"mr-3 text-blue-600"})," Search Customer Profile"]})}),u.jsxs("form",{onSubmit:m,className:"mb-8 p-4 bg-gray-50 rounded-lg shadow",children:[u.jsx("label",{htmlFor:"customerSearchTerm",className:"block text-sm font-medium text-gray-700 mb-1",children:"Find Customer"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[u.jsxs("div",{className:"relative flex-grow",children:[u.jsx(Cs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsx("input",{type:"text",id:"customerSearchTerm",value:t,onChange:_=>n(_.target.value),className:`${B$} pl-9`,placeholder:"Account No, Name, or Meter No."})]}),u.jsxs("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2.5 px-6 rounded-lg flex items-center justify-center sm:w-auto w-full",disabled:o,children:[o?u.jsx(Et,{size:18,className:"animate-spin mr-2"}):u.jsx(js,{size:18,className:"mr-2"}),"Search Customer"]})]}),d&&u.jsx("p",{className:"text-red-600 text-xs mt-2",children:d})]}),o&&u.jsx(an,{message:"Searching for customer..."}),!o&&i&&u.jsxs("div",{className:"mt-6 p-5 border border-blue-200 bg-blue-50 rounded-lg shadow-md animate-fadeIn",children:[u.jsx("h3",{className:"text-xl font-semibold text-blue-700 mb-4 border-b border-blue-200 pb-2",children:"Customer Details"}),u.jsxs("div",{className:"space-y-1",children:[u.jsx(g,{label:"Account Name",value:i.displayName,icon:Cs}),u.jsx(g,{label:"Account Number",value:i.accountNumber,icon:Rs}),u.jsx(g,{label:"Email Address",value:i.email,icon:Fo}),u.jsx(g,{label:"Service Address",value:y(i.serviceAddress),icon:co}),u.jsx(g,{label:"Meter Serial No.",value:i.meterSerialNumber,icon:rc}),u.jsx(g,{label:"Meter Size",value:i.meterSize,icon:rc}),u.jsx(g,{label:"Service Type",value:i.serviceType,icon:gn}),u.jsx(g,{label:"Account Status",value:i.accountStatus,icon:i.accountStatus==="Active"?Ps:Kt})]})]})]})},q$=({userData:r,showNotification:e,setActiveSection:t,db:n})=>{const[i,s]=J.useState({paymentsTodayCount:0,totalCollectedToday:0,avgPaymentAmount:0}),[o,l]=J.useState([]),[d,f]=J.useState(!0),[m,y]=J.useState(""),g=J.useCallback(async()=>{if(!r||!r.uid){f(!1),y("Clerk user data is not available.");return}f(!0),y("");try{const b=await _9(n,r.uid);if(b.success&&b.data){const{paymentsTodayCount:T,totalCollectedToday:N,transactions:R}=b.data,I=R.reduce((j,U)=>{const C=U.paymentMethod||"Other";return j[C]=(j[C]||0)+(U.amountPaid||0),j},{});s({paymentsTodayCount:T,totalCollectedToday:N,avgPaymentAmount:T>0?N/T:0,paymentMethodSummary:I}),l(R)}else y(b.error||"Today's payment data unavailable.")}catch{y("Could not load clerk dashboard statistics. Please try refreshing.")}finally{f(!1)}},[r,n]);J.useEffect(()=>{g()},[g]);const _=()=>{const b=document.getElementById("eod-report-content"),T=document.getElementById("clerk-print-styles");if(b&&T){const N=window.open("","","height=800,width=1000");N.document.write("<html><head><title>Cashier Daily Collection Report</title>"),N.document.write("<style>"+T.innerHTML+"</style>"),N.document.write('</head><body><div class="printable-area">'),N.document.write(b.innerHTML),N.document.write("</div><script>"),N.document.write("window.onload = function() { setTimeout(function() { window.print(); window.close(); }, 750); };"),N.document.write("<\/script></body></html>"),N.document.close()}},E=[{title:"Process Walk-in Payment",icon:ry,section:"walkInPayments",description:"Record payments for customers paying in person at the counter.",color:"blue"},{title:"Search Account / Bill",icon:A2,section:"searchAccountOrBill",description:"Look up customer account details, outstanding bills, or payment history.",color:"teal"}],x=()=>u.jsx("span",{className:"font-bold",children:""});return d?u.jsx(an,{message:"Loading clerk dashboard...",className:"mt-10 h-48"}):u.jsxs("div",{className:"space-y-8 animate-fadeIn",children:[u.jsx("style",{id:"clerk-print-styles",children:`
                @page {
                    size: A4 portrait;
                    margin: 0.75in;
                }
                body { 
                    font-family: 'Times New Roman', Times, serif; 
                    -webkit-print-color-adjust: exact !important; 
                    print-color-adjust: exact !important; 
                    color: #000;
                    font-size: 10pt;
                }
                .printable-area { 
                    max-width: 100%;
                    margin: auto; 
                }
                .report-header { 
                    display: flex;
                    justify-content: space-between;
                    align-items: flex-start;
                    text-align: left;
                    border-bottom: 2px solid #000; 
                    padding-bottom: 1rem; 
                }
                .report-header .logo-print { 
                    font-size: 2.5rem; 
                    font-weight: 700; 
                    color: #1e3a8a !important; 
                    line-height: 1;
                    margin: 0; 
                }
                .report-header .tagline-print { 
                    font-size: 0.8rem; 
                    color: #1d4ed8 !important; 
                    font-style: italic;
                    margin: 0;
                }
                .report-header .company-address-print {
                    text-align: right;
                    font-size: 0.8rem;
                    line-height: 1.4;
                    color: #374151 !important;
                }
                h1.report-title { 
                    font-size: 1.5rem; 
                    font-weight: 700; 
                    color: #000 !important; 
                    margin-top: 1.5rem; 
                    margin-bottom: 1rem; 
                    text-align: center;
                    text-transform: uppercase;
                }
                .report-section { 
                    margin-top: 1.5rem; 
                    page-break-inside: avoid;
                }
                .report-section h2 { 
                    font-size: 1.25rem; 
                    font-weight: 700; 
                    border-bottom: 1px solid #4b5563; 
                    padding-bottom: 0.25rem; 
                    margin-bottom: 1rem; 
                    color: #111827 !important;
                }
                .info-table { 
                    width: 100%; 
                    font-size: 10pt;
                }
                .info-table td { 
                    padding: 4px 0; 
                    vertical-align: top;
                }
                .info-table td:nth-child(odd) { 
                    font-weight: 700; 
                    color: #374151 !important; 
                    width: auto; 
                    white-space: nowrap; 
                    padding-right: 1rem; 
                }
                .summary-grid { 
                    display: grid !important; 
                    grid-template-columns: repeat(3, 1fr) !important; 
                    gap: 1.5rem; 
                }
                .summary-card { 
                    background-color: #f9fafb !important; 
                    border: 1px solid #e5e7eb; 
                    padding: 1.25rem; 
                    border-radius: 0.5rem; 
                    text-align: center; 
                }
                .summary-card p { 
                    margin: 0; 
                    font-size: 0.875rem; 
                    font-weight: 600;
                    text-transform: uppercase; 
                    color: #4b5563 !important; 
                }
                .summary-card span { 
                    font-size: 1.875rem; 
                    font-weight: 700; 
                    color: #000 !important; 
                    display: block; 
                    margin-top: 0.25rem;
                }
                table.data-table { 
                    width: 100%; 
                    border-collapse: collapse; 
                    margin-top: 1rem; 
                    font-size: 9.5pt;
                }
                .data-table th, .data-table td { 
                    border: 1px solid #d1d5db; 
                    padding: 0.5rem 0.75rem; 
                    text-align: left; 
                }
                .data-table th { 
                    background-color: #f3f4f6 !important; 
                    font-weight: 700; 
                    text-transform: uppercase;
                    font-size: 0.75rem;
                    color: #374151 !important;
                }
                .data-table .text-right { text-align: right; }
                .data-table .font-mono { font-family: "Courier New", Courier, monospace; }
                .data-table .font-semibold { font-weight: 600; }
                .data-table .total-row td {
                    font-weight: 700;
                    font-size: 1.125rem;
                    background-color: #f3f4f6 !important;
                    border-top: 2px solid #374151;
                }
                .report-footer { 
                    margin-top: 4rem; 
                    padding-top: 2rem; 
                    border-top: 1px solid #9ca3af; 
                }
                .signature-line { 
                    width: 60%; 
                    margin: 2rem auto 0 auto; 
                    border-top: 1px solid #333; 
                    padding-top: 8px; 
                    text-align: center; 
                }
                @media print {
                    .no-print { display: none !important; }
                    body { margin: 0; font-size: 10pt; }
                    .printable-area { padding: 0 !important; box-shadow: none !important; border: none !important; }
                }
            `}),u.jsx("div",{className:"p-6 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-xl shadow-xl no-print",children:u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center",children:[u.jsxs("div",{children:[u.jsx("h2",{className:"text-2xl sm:text-3xl font-bold",children:"Clerk / Cashier Dashboard"}),u.jsxs("p",{className:"mt-1 text-indigo-100",children:["Welcome, ",r.displayName||"Clerk","! Manage payments and customer inquiries."]})]}),u.jsxs("button",{onClick:g,className:"mt-3 sm:mt-0 text-sm flex items-center bg-indigo-400 hover:bg-indigo-300 text-white font-medium py-2 px-3 rounded-lg transition-colors disabled:opacity-70 self-start sm:self-center",disabled:d,title:"Refresh Statistics",children:[d?u.jsx(Et,{size:16,className:"animate-spin"}):u.jsx(za,{size:16}),u.jsx("span",{className:"ml-2 hidden sm:inline",children:"Refresh"})]})]})}),m&&u.jsxs("p",{className:"text-sm text-yellow-600 bg-yellow-50 p-3 rounded-md text-center my-4 flex items-center justify-center gap-2 no-print",children:[u.jsx(gn,{size:16})," ",m]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5 no-print",children:[u.jsx(hi,{title:"Payments Today",value:i.paymentsTodayCount,icon:ry,borderColor:"border-green-500",iconColor:"text-green-500",onClick:()=>{var b;return(b=document.getElementById("eod-report-wrapper"))==null?void 0:b.scrollIntoView({behavior:"smooth"})}}),u.jsx(hi,{title:"Total Collected Today",value:`${i.totalCollectedToday.toLocaleString("en-US",{minimumFractionDigits:2})}`,icon:x,borderColor:"border-emerald-500",iconColor:"text-emerald-500"}),u.jsx(hi,{title:"Avg. Payment Today",value:`${i.avgPaymentAmount.toLocaleString("en-US",{minimumFractionDigits:2})}`,icon:x,borderColor:"border-teal-500",iconColor:"text-teal-500"})]}),u.jsxs("div",{className:"no-print",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-700 mb-5 mt-8 pt-5 border-t border-gray-200",children:"Primary Tasks"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:E.map(b=>u.jsxs("button",{onClick:()=>t(b.section),className:`p-6 bg-white rounded-xl shadow-lg hover:shadow-2xl transform hover:-translate-y-1.5 transition-all duration-300 ease-in-out text-left focus:outline-none focus:ring-2 focus:ring-${b.color}-500 focus:ring-opacity-75 group h-full flex flex-col`,children:[u.jsx("div",{className:`p-3 bg-${b.color}-100 rounded-full inline-block mb-3 self-start group-hover:scale-110 transition-transform`,children:u.jsx(b.icon,{size:28,className:`text-${b.color}-600`})}),u.jsx("h4",{className:`text-lg font-semibold text-gray-800 group-hover:text-${b.color}-700 transition-colors`,children:b.title}),u.jsx("p",{className:"text-sm text-gray-500 mt-1 leading-normal flex-grow",children:b.description})]},b.section))})]}),u.jsxs("div",{id:"eod-report-wrapper",className:"mt-8 p-3 sm:p-5 bg-gray-50 rounded-xl shadow",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4 no-print",children:[u.jsxs("h3",{className:"text-lg font-semibold text-gray-700 flex items-center",children:[u.jsx(di,{size:20,className:"mr-2 text-gray-500"})," Shift Summary / End-of-Day Report"]}),u.jsxs("button",{onClick:_,className:"flex items-center bg-blue-500 text-white text-xs font-semibold px-3 py-1.5 rounded-lg hover:bg-blue-600 transition-colors",children:[u.jsx(P2,{size:14,className:"mr-1.5"})," Print Report"]})]}),u.jsxs("div",{id:"eod-report-content",className:"bg-white p-6 sm:p-10 rounded-lg border border-gray-200 text-gray-800 text-[10pt] leading-normal printable-area",children:[u.jsxs("div",{className:"report-header",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"logo-print",children:"AGWA"}),u.jsx("p",{className:"tagline-print",children:"Ensuring Clarity, Sustaining Life."})]}),u.jsxs("div",{className:"company-address-print",children:[u.jsx("strong",{children:"AGWA Water Services, Inc."}),u.jsx("br",{}),"123 Aqua Drive, Hydro Business Park",u.jsx("br",{}),"Naic, Cavite, Philippines 4110",u.jsx("br",{}),"VAT Reg. TIN: 000-123-456-789"]})]}),u.jsx("h1",{className:"report-title",children:"CASHIER'S DAILY COLLECTION REPORT"}),u.jsx("div",{className:"report-section mt-6",children:u.jsx("table",{className:"info-table w-full",children:u.jsxs("tbody",{children:[u.jsxs("tr",{className:"!border-none",children:[u.jsx("td",{className:"font-semibold text-gray-600 !pr-4 !border-none !p-1",children:"Cashier Name:"}),u.jsx("td",{className:"font-medium !border-none !p-1",children:r.displayName}),u.jsx("td",{className:"font-semibold text-gray-600 !pr-4 !border-none !p-1",children:"Report Date:"}),u.jsx("td",{className:"font-medium !border-none !p-1",children:$t(new Date,{year:"numeric",month:"long",day:"numeric"})})]}),u.jsxs("tr",{className:"!border-none",children:[u.jsx("td",{className:"font-semibold text-gray-600 !pr-4 !border-none !p-1",children:"Cashier ID:"}),u.jsx("td",{className:"font-mono !border-none !p-1",children:r.accountNumber||r.uid.substring(0,10)}),u.jsx("td",{className:"font-semibold text-gray-600 !pr-4 !border-none !p-1",children:"Time Generated:"}),u.jsx("td",{className:"font-medium !border-none !p-1",children:$t(new Date,{hour:"2-digit",minute:"2-digit",hour12:!0})})]})]})})}),u.jsxs("section",{className:"report-section mt-8",children:[u.jsx("h2",{className:"text-lg font-semibold border-b border-gray-300 pb-2 mb-4 text-gray-700",children:"Collection Summary"}),u.jsxs("div",{className:"summary-grid grid grid-cols-1 sm:grid-cols-3 gap-4",children:[u.jsxs("div",{className:"summary-card bg-gray-50 border border-gray-200 p-4 rounded-lg text-center",children:[u.jsx("p",{className:"text-sm font-medium text-gray-500 uppercase",children:"Total Collected"}),u.jsxs("span",{className:"text-2xl font-bold text-gray-800",children:["",i.totalCollectedToday.toLocaleString("en-US",{minimumFractionDigits:2})]})]}),u.jsxs("div",{className:"summary-card bg-gray-50 border border-gray-200 p-4 rounded-lg text-center",children:[u.jsx("p",{className:"text-sm font-medium text-gray-500 uppercase",children:"Total Transactions"}),u.jsx("span",{className:"text-2xl font-bold text-gray-800",children:i.paymentsTodayCount})]}),u.jsxs("div",{className:"summary-card bg-gray-50 border border-gray-200 p-4 rounded-lg text-center",children:[u.jsx("p",{className:"text-sm font-medium text-gray-500 uppercase",children:"Average Transaction"}),u.jsxs("span",{className:"text-2xl font-bold text-gray-800",children:["",i.avgPaymentAmount.toLocaleString("en-US",{minimumFractionDigits:2})]})]})]})]}),i.paymentMethodSummary&&Object.keys(i.paymentMethodSummary).length>0&&u.jsxs("section",{className:"report-section mt-8",children:[u.jsx("h2",{className:"text-lg font-semibold border-b border-gray-300 pb-2 mb-4 text-gray-700",children:"Breakdown by Payment Method"}),u.jsxs("table",{className:"data-table w-full border-collapse text-sm",children:[u.jsx("thead",{className:"bg-gray-100",children:u.jsxs("tr",{children:[u.jsx("th",{className:"border p-2 text-left text-xs font-semibold text-gray-600 uppercase",children:"Payment Method"}),u.jsx("th",{className:"border p-2 text-right text-xs font-semibold text-gray-600 uppercase",children:"Total Amount (PHP)"})]})}),u.jsxs("tbody",{children:[Object.entries(i.paymentMethodSummary).map(([b,T])=>u.jsxs("tr",{className:"border-b",children:[u.jsx("td",{className:"border p-2.5",children:b}),u.jsxs("td",{className:"border p-2.5 text-right font-semibold",children:["",T.toLocaleString("en-US",{minimumFractionDigits:2})]})]},b)),u.jsxs("tr",{className:"total-row bg-gray-100",children:[u.jsx("td",{className:"border p-3 font-bold text-base",children:"GRAND TOTAL"}),u.jsxs("td",{className:"border p-3 text-right font-bold text-base",children:["",i.totalCollectedToday.toLocaleString("en-US",{minimumFractionDigits:2})]})]})]})]})]}),u.jsxs("section",{className:"report-section mt-8",children:[u.jsx("h2",{className:"text-lg font-semibold border-b border-gray-300 pb-2 mb-4 text-gray-700",children:"Transaction Log (Today)"}),o.length>0?u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"data-table w-full border-collapse text-sm",children:[u.jsx("thead",{className:"bg-gray-100",children:u.jsxs("tr",{children:[u.jsx("th",{className:"border p-2 text-left text-xs font-semibold text-gray-600 uppercase",children:"Time"}),u.jsx("th",{className:"border p-2 text-left text-xs font-semibold text-gray-600 uppercase",children:"Account #"}),u.jsx("th",{className:"border p-2 text-left text-xs font-semibold text-gray-600 uppercase",children:"Reference #"}),u.jsx("th",{className:"border p-2 text-right text-xs font-semibold text-gray-600 uppercase",children:"Amount (PHP)"})]})}),u.jsx("tbody",{children:o.map(b=>{var T,N;return u.jsxs("tr",{className:"border-b",children:[u.jsx("td",{className:"border p-2.5 whitespace-nowrap",children:$t((T=b.paymentTimestamp)==null?void 0:T.toDate(),{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!0})}),u.jsx("td",{className:"border p-2.5 whitespace-nowrap font-mono",children:b.accountNumber}),u.jsx("td",{className:"border p-2.5 whitespace-nowrap font-mono",children:b.paymentReference}),u.jsxs("td",{className:"border p-2.5 whitespace-nowrap text-right font-semibold",children:["",(N=b.amountPaid)==null?void 0:N.toFixed(2)]})]},b.id)})})]})}):u.jsxs("div",{className:"text-center py-10 bg-gray-50 rounded-md border",children:[u.jsx(gn,{size:32,className:"mx-auto text-gray-400 mb-2"}),u.jsx("p",{className:"text-gray-500",children:"No payments have been processed yet today."})]})]}),u.jsx("footer",{className:"report-footer mt-16 pt-8 border-t border-gray-400",children:u.jsxs("div",{className:"signature-line w-3/5 mx-auto border-t border-gray-700 pt-2 text-center",children:[u.jsx("p",{className:"text-sm font-semibold",children:r.displayName}),u.jsx("p",{className:"text-xs text-gray-600",children:"Cashier's Signature Over Printed Name"})]})})]})]})]})},of="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition duration-150 text-sm placeholder-gray-400",H$=({db:r,userData:e,showNotification:t,billingService:n})=>{const[i,s]=J.useState(""),[o,l]=J.useState(null),[d,f]=J.useState([]),[m,y]=J.useState(null),[g,_]=J.useState(""),[E,x]=J.useState("Cash"),[b,T]=J.useState(""),[N,R]=J.useState({}),[I,j]=J.useState(!1),[U,C]=J.useState(!1),[k,D]=J.useState(!1),[O,P]=J.useState(null),[F,M]=J.useState("");J.useEffect(()=>{Xy(r).then(K=>{K.success&&R(K.data||{})})},[r]);const $=async K=>{if(K&&K.preventDefault(),!i.trim()){t("Please enter an Account Number to search.","warning");return}j(!0),M(""),l(null),f([]),y(null),_(""),P(null);try{const B=await Qy(r,i.trim());if(B.success&&B.data.length>0){const G=B.data.find(X=>X.accountNumber.toLowerCase()===i.trim().toLowerCase());G?(l(G),Y(G)):M(`No customer found with Account Number: "${i}".`)}else M(`No customer found with Account Number: "${i}".`)}catch{M("An error occurred during customer search.")}j(!1)},Y=async K=>{C(!0);const B=await ih(r,K.id);if(B.success){const G=B.data.filter(X=>X.status==="Unpaid").map(X=>{const le=((X.calculatedCharges||n(X.consumption,K.serviceType,K.meterSize,N)).totalCalculatedCharges||0)+(X.previousUnpaidAmount||0)-(X.seniorCitizenDiscount||0),Q=v2(X,N),ce=le+Q;return{...X,amount:ce,displayPenalty:Q}}).sort((X,se)=>{var le,Q;return new Date(((le=X.dueDate)==null?void 0:le.toDate())||0)-new Date(((Q=se.dueDate)==null?void 0:Q.toDate())||0)});f(G),G.length===0&&t(`No unpaid bills found for Account #${K.accountNumber}.`,"info")}else t(B.error||"Failed to fetch customer bills.","error");C(!1)};J.useEffect(()=>{var K;if(m)_(((K=m.amount)==null?void 0:K.toFixed(2))||"");else if(d.length===0)_("");else if(d.length>0&&!d.find(B=>B.id===(m==null?void 0:m.id))){const B=d.reduce((G,X)=>G+(X.amount||0),0);_(B>0?B.toFixed(2):"")}},[m,d]);const te=async K=>{if(K.preventDefault(),!m&&d.length===0){t("No bill selected or available for payment.","warning");return}const B=parseFloat(g);if(isNaN(B)||B<=0){t("Please enter a valid payment amount.","warning");return}if(E!=="Cash"&&!b.trim()){t("Reference number is required for this payment method.","warning");return}D(!0),P(null);const G=m||d.find(X=>X.status==="Unpaid");if(!G){t("Cannot determine which bill to pay. Please select a bill.","warning"),D(!1);return}if(B<G.amount){t(`Partial payments are not supported. Amount must be ${G.amount.toFixed(2)}.`,"warning"),D(!1);return}try{const X=On(),se=new Date,le=await ZC(r,G.id,{status:"Paid",paymentDate:se,paymentTimestamp:X,amountPaid:B,paymentMethod:E,paymentReference:b.trim()||`CASH-${Date.now().toString().slice(-8)}`,processedByClerkId:e.uid,processedByClerkName:e.displayName});if(!le.success)throw new Error(le.error||"Failed to update bill status.");const Q={customerName:o.displayName,accountNumber:o.accountNumber,serviceAddress:o.serviceAddress,billId:G.id,billMonthYear:G.monthYear||G.billingPeriod,amountPaid:B,paymentDate:se,paymentMethod:E,referenceNumber:b.trim()||`CASH-${Date.now().toString().slice(-8)}`,processedBy:e.displayName,receiptId:`OR-${Date.now()}`};P(Q),t(`Payment of ${B.toFixed(2)} processed successfully!`,"success"),_(""),T(""),y(null),Y(o)}catch(X){t(X.message||"An error occurred while processing the payment.","error")}D(!1)},oe=()=>{const K=document.getElementById("payment-receipt-content");if(K){const B=window.open("","_blank","height=800,width=1000");B.document.write("<html><head><title>AGWA Payment Receipt</title>"),B.document.write('<script src="https://cdn.tailwindcss.com"><\/script>'),B.document.write(`
                <style>
                    body { font-family: 'Inter', sans-serif; -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
                    .paid-stamp {
                        position: absolute;
                        top: 50%;
                        left: 50%;
                        transform: translate(-50%, -50%) rotate(-30deg);
                        font-size: 4rem;
                        font-weight: bold;
                        color: rgba(0, 128, 0, 0.15);
                        z-index: -1;
                        letter-spacing: 0.1em;
                        border: 8px solid rgba(0, 128, 0, 0.15);
                        padding: 0.5em 1em;
                        border-radius: 10px;
                        text-transform: uppercase;
                    }
                    .no-print { display: none; }
                </style>
            `),B.document.write('</head><body class="bg-gray-100 p-4">'),B.document.write(K.innerHTML),B.document.write("</body></html>"),B.document.close(),setTimeout(()=>B.print(),700)}},ie=["Cash","Check","Card (Debit/Credit)","E-wallet (GCash/Maya)"],ne=({label:K,value:B})=>u.jsxs("div",{className:"flex justify-between py-1.5 text-sm border-b border-gray-200 last:border-b-0",children:[u.jsxs("span",{className:"text-gray-500",children:[K,":"]}),u.jsx("span",{className:"font-medium text-gray-800 text-right",children:B})]});return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[!O&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(ry,{size:30,className:"mr-3 text-green-600"})," Process Walk-in Payment"]})}),u.jsxs("form",{onSubmit:$,className:"mb-6 p-4 bg-gray-50 rounded-lg shadow",children:[u.jsx("label",{htmlFor:"accountNumberSearch",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search Customer by Account Number"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[u.jsxs("div",{className:"relative flex-grow",children:[u.jsx(Rs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsx("input",{type:"text",id:"accountNumberSearch",value:i,onChange:K=>s(K.target.value),className:`${of} pl-9`,placeholder:"Enter Account Number"})]}),u.jsxs("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2.5 px-5 rounded-lg flex items-center justify-center sm:w-auto w-full",disabled:I,children:[I?u.jsx(Et,{size:18,className:"animate-spin mr-2"}):u.jsx(js,{size:18,className:"mr-2"})," Find Customer"]})]}),F&&!I&&u.jsx("p",{className:"text-red-500 text-xs mt-2",children:F})]})]}),I&&u.jsx(an,{message:"Searching for customer..."}),o&&!O&&u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:"mb-6 p-4 border border-blue-200 bg-blue-50 rounded-lg shadow",children:[u.jsxs("h3",{className:"text-lg font-semibold text-blue-700 mb-2 flex items-center",children:[u.jsx(Cs,{size:20,className:"mr-2"})," ",o.displayName,u.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["(",o.accountNumber,")"]})]}),U&&u.jsx(an,{message:"Loading bills..."}),!U&&d.length===0&&u.jsx("p",{className:"text-sm text-green-600 mt-2",children:"No unpaid bills found for this customer."}),!U&&d.length>0&&u.jsxs("div",{className:"mt-3",children:[u.jsx("label",{htmlFor:"selectBill",className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Bill to Pay (or pay total outstanding):"}),u.jsxs("select",{id:"selectBill",className:of,value:m?m.id:"",onChange:K=>{const B=d.find(G=>G.id===K.target.value);y(B||null)},children:[u.jsx("option",{value:"",children:"Pay Total Unpaid / Select Specific Bill"}),d.map(K=>{var B,G;return u.jsxs("option",{value:K.id,children:[K.monthYear||K.billingPeriod," - ",(B=K.amount)==null?void 0:B.toFixed(2)," (Due: ",$t((G=K.dueDate)==null?void 0:G.toDate(),{month:"short",day:"numeric"}),")",K.displayPenalty>0&&` (Penalty: ${K.displayPenalty.toFixed(2)})`]},K.id)})]})]})]}),d.length>0&&u.jsxs("form",{onSubmit:te,className:"space-y-5 p-4 border border-gray-200 rounded-lg",children:[u.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-1",children:"Payment Details"}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"paymentAmount",className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount to Pay (PHP) *"}),u.jsxs("div",{className:"relative",children:[u.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",children:""}),u.jsx("input",{type:"number",id:"paymentAmount",value:g,onChange:K=>_(K.target.value),className:`${of} pl-7`,step:"0.01",required:!0})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"paymentMethod",className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method *"}),u.jsx("select",{id:"paymentMethod",value:E,onChange:K=>x(K.target.value),className:of,required:!0,children:ie.map(K=>u.jsx("option",{value:K,children:K},K))})]}),E!=="Cash"&&u.jsxs("div",{children:[u.jsx("label",{htmlFor:"referenceNumber",className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference / Transaction No. *"}),u.jsx("input",{type:"text",id:"referenceNumber",value:b,onChange:K=>T(K.target.value),className:of,placeholder:"e.g., Check No., Card Approval Code",required:!0})]}),u.jsxs("button",{type:"submit",className:"w-full bg-green-600 hover:bg-green-700 text-white font-semibold py-2.5 px-5 rounded-lg flex items-center justify-center transition-colors active:scale-95",disabled:k||!g||parseFloat(g)<=0,children:[k?u.jsx(Et,{size:20,className:"animate-spin mr-2"}):u.jsx(Ps,{size:20,className:"mr-2"}),k?"Processing...":"Process Payment"]})]})]}),O&&u.jsxs("div",{className:"mt-6 p-6 bg-green-50 rounded-lg",children:[u.jsxs("div",{className:"text-center mb-5",children:[u.jsx(Ps,{size:48,className:"mx-auto text-green-500 mb-2"}),u.jsx("h3",{className:"text-2xl font-semibold text-green-800",children:"Payment Successful!"}),u.jsx("p",{className:"text-sm text-gray-600",children:"Official Receipt has been generated."})]}),u.jsxs("div",{id:"payment-receipt-content",className:"p-6 bg-white rounded-lg shadow-lg max-w-2xl mx-auto font-sans relative overflow-hidden",children:[u.jsx("div",{className:"paid-stamp",children:"PAID"}),u.jsxs("div",{className:"flex justify-between items-start mb-5 pb-4 border-b-2 border-blue-700",children:[u.jsxs("div",{children:[u.jsx("div",{className:"text-3xl font-bold text-blue-700",children:"AGWA"}),u.jsx("div",{className:"text-xs text-blue-600 italic",children:"Ensuring Clarity, Sustaining Life."})]}),u.jsxs("div",{className:"text-right text-xs",children:[u.jsx("p",{className:"font-semibold",children:"AGWA Water Services, Inc."}),u.jsx("p",{children:"123 Aqua Drive, Hydro Business Park"}),u.jsx("p",{children:"Naic, Cavite, Philippines 4110"})]})]}),u.jsxs("div",{className:"text-center mb-6",children:[u.jsx("h4",{className:"text-xl font-bold text-gray-800",children:"OFFICIAL RECEIPT"}),u.jsxs("p",{className:"text-sm text-gray-500",children:["Receipt No: ",O.receiptId]})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx(ne,{label:"Received From",value:O.customerName}),u.jsx(ne,{label:"Account Number",value:O.accountNumber})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx(ne,{label:"Payment For",value:`Water Bill - ${O.billMonthYear}`}),u.jsx(ne,{label:"Payment Date",value:$t(O.paymentDate,{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"})}),u.jsx(ne,{label:"Payment Method",value:O.paymentMethod}),O.referenceNumber&&!O.referenceNumber.startsWith("CASH-")&&u.jsx(ne,{label:"Reference No.",value:O.referenceNumber})]}),u.jsxs("div",{className:"mt-4 p-3 bg-gray-100 rounded-lg flex justify-between items-center",children:[u.jsx("span",{className:"text-lg font-semibold text-gray-800",children:"AMOUNT PAID"}),u.jsxs("span",{className:"text-2xl font-bold text-green-600",children:["",O.amountPaid.toFixed(2)]})]}),u.jsx("div",{className:"mt-4 pt-4 border-t border-dashed",children:u.jsx(x3,{value:O.receiptId})}),u.jsxs("div",{className:"text-xs text-gray-500 mt-4",children:[u.jsxs("p",{children:["Cashier: ",O.processedBy]}),u.jsx("p",{children:"This is a system-generated receipt. Thank you for your payment."})]})]}),u.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-3 mt-6 no-print",children:[u.jsxs("button",{onClick:oe,className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded-lg flex items-center justify-center",children:[u.jsx(P2,{size:18,className:"mr-2"})," Print Receipt"]}),u.jsx("button",{onClick:()=>{P(null),s(""),l(null),f([]),y(null)},className:"bg-gray-600 hover:bg-gray-700 text-white font-medium py-2 px-4 rounded-lg flex items-center justify-center",children:"Process Another Payment"})]})]})]})},$$=({db:r,showNotification:e,billingService:t})=>{var k;const[n,i]=J.useState("account"),[s,o]=J.useState(""),[l,d]=J.useState(null),[f,m]=J.useState([]),[y,g]=J.useState(!1),[_,E]=J.useState(""),[x,b]=J.useState(null),[T,N]=J.useState(null),R="w-full px-3 py-2.5 rounded-lg bg-gray-50 border border-gray-300 focus:border-blue-500 focus:ring-1 focus:ring-blue-200 focus:outline-none transition-150 text-sm placeholder-gray-400",I=async D=>{if(D.preventDefault(),!s.trim()){e("Please enter a search term.","warning");return}g(!0),E(""),d(null),m([]),b(null),N(null);try{if(n==="account"){const O=await Qy(r,s.trim());if(O.success&&O.data.length>0){const P=O.data[0];d(P);const F=await ih(r,P.id);F.success?m(F.data.sort((M,$)=>{var Y,te;return(((Y=$.billDate)==null?void 0:Y.toDate())||0)-(((te=M.billDate)==null?void 0:te.toDate())||0)})):e("Could not fetch bills for the user.","warning")}else O.success?E(`No account found matching "${s}".`):E(O.error||"Failed to search accounts.")}else{const O=await y9(r,(void 0)(),[where("id","==",s.trim())]);if(O.success&&O.data.length>0){const P=O.data[0];if(d(P),P.userId){const F=await _2(r,P.userId);F.success&&N(F.data)}}else O.success?E(`No bill found matching invoice/bill ID "${s}".`):E(O.error||"Failed to search bills.")}}catch{E("An error occurred during the search.")}g(!1)},j=(D,O)=>{b(D),N(O||(l&&n==="account"?l:null))},U=D=>!D||typeof D!="object"?D||"N/A":[D.street,D.barangay,D.district,"Naic, Cavite"].filter(P=>P&&P.trim()).join(", "),C=({label:D,value:O,icon:P,valueClass:F="text-gray-800"})=>u.jsxs("div",{className:"flex items-start py-1.5",children:[P&&u.jsx(P,{size:16,className:"mr-2.5 text-blue-500 flex-shrink-0 mt-0.5"}),u.jsxs("span",{className:"text-xs font-medium text-gray-500 w-32 sm:w-40",children:[D,":"]}),u.jsx("span",{className:`text-sm ${F} flex-1 break-words`,children:O||"N/A"})]});return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsx("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 pb-4 border-b border-gray-200",children:u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(A2,{size:30,className:"mr-3 text-indigo-600"})," Search Account / Bill"]})}),u.jsxs("form",{onSubmit:I,className:"mb-6 p-4 bg-gray-50 rounded-lg shadow",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-end",children:[u.jsxs("div",{className:"flex-grow",children:[u.jsx("label",{htmlFor:"searchType",className:"block text-sm font-medium text-gray-700 mb-1",children:"Search For"}),u.jsxs("select",{id:"searchType",value:n,onChange:D=>{i(D.target.value),o(""),d(null),m([]),E("")},className:R,children:[u.jsx("option",{value:"account",children:"Customer Account"}),u.jsx("option",{value:"bill",children:"Specific Bill (Invoice #)"})]})]}),u.jsxs("div",{className:"flex-grow-[2]",children:[u.jsx("label",{htmlFor:"searchTerm",className:"block text-sm font-medium text-gray-700 mb-1",children:n==="account"?"Account No, Name, or Email":"Invoice Number or Bill ID"}),u.jsxs("div",{className:"relative",children:[u.jsx(js,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),u.jsx("input",{type:"text",id:"searchTerm",value:s,onChange:D=>o(D.target.value),className:`${R} pl-9`,placeholder:`Enter ${n==="account"?"details...":"invoice #..."}`})]})]}),u.jsxs("button",{type:"submit",className:"bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-2.5 px-6 rounded-lg flex items-center justify-center sm:w-auto w-full transition-colors",disabled:y,children:[y?u.jsx(Et,{size:18,className:"animate-spin mr-2"}):u.jsx(js,{size:18,className:"mr-2"}),"Search"]})]}),_&&!y&&u.jsx("p",{className:"text-red-500 text-xs mt-2",children:_})]}),y&&u.jsx(an,{message:"Searching..."}),!y&&l&&u.jsxs("div",{className:"mt-6 p-5 border border-indigo-200 bg-indigo-50 rounded-lg shadow-md animate-fadeIn",children:[n==="account"&&u.jsxs(u.Fragment,{children:[u.jsx("h3",{className:"text-xl font-semibold text-indigo-700 mb-3 border-b border-indigo-200 pb-2",children:"Account Details"}),u.jsxs("div",{className:"space-y-1 mb-4",children:[u.jsx(C,{label:"Name",value:l.displayName,icon:Cs}),u.jsx(C,{label:"Account No",value:l.accountNumber,icon:Rs,valueClass:"font-mono"}),u.jsx(C,{label:"Email",value:l.email,icon:Fo}),u.jsx(C,{label:"Status",value:l.accountStatus,icon:gn,valueClass:`font-semibold ${l.accountStatus==="Active"?"text-green-600":"text-red-600"}`}),u.jsx(C,{label:"Service Address",value:U(l.serviceAddress),icon:co})]}),u.jsxs("h4",{className:"text-md font-semibold text-indigo-600 mt-4 mb-2",children:["Recent Bills (",f.length,")"]}),f.length>0?u.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 pr-2",children:f.map(D=>{var O;return u.jsxs("div",{className:`p-2.5 border rounded-md flex justify-between items-center text-xs ${D.status==="Paid"?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:[u.jsxs("div",{children:[u.jsxs("p",{children:[u.jsx("strong",{children:"Period:"})," ",D.monthYear||D.billingPeriod]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Amount:"})," ",(O=D.amount)==null?void 0:O.toFixed(2)]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Due:"})," ",$t(D.dueDate,{month:"short",day:"numeric",year:"numeric"})]}),u.jsxs("p",{children:[u.jsx("strong",{children:"Status:"})," ",u.jsx("span",{className:`font-semibold ${D.status==="Paid"?"text-green-700":"text-red-700"}`,children:D.status})]})]}),u.jsxs("button",{onClick:()=>j(D,l),className:"text-indigo-600 hover:text-indigo-800 hover:bg-indigo-100 p-1.5 rounded-md text-xs",children:[u.jsx(nc,{size:16,className:"inline mr-1"}),"View Invoice"]})]},D.id)})}):u.jsx("p",{className:"text-sm text-gray-500",children:"No bills found for this account."})]}),n==="bill"&&u.jsxs(u.Fragment,{children:[u.jsxs("h3",{className:"text-xl font-semibold text-indigo-700 mb-3 border-b border-indigo-200 pb-2",children:["Bill Details (Invoice: ",l.invoiceNumber||l.id,")"]}),u.jsxs("div",{className:"space-y-1",children:[u.jsx(C,{label:"Account No",value:l.accountNumber,icon:Rs,valueClass:"font-mono"}),T&&u.jsx(C,{label:"Customer Name",value:T.displayName,icon:Cs}),u.jsx(C,{label:"Bill Period",value:l.monthYear||l.billingPeriod,icon:pu}),u.jsx(C,{label:"Amount Due",value:`${(k=l.amount)==null?void 0:k.toFixed(2)}`,icon:Dl,valueClass:"font-bold"}),u.jsx(C,{label:"Due Date",value:$t(l.dueDate,{month:"long",day:"numeric",year:"numeric"}),icon:pu}),u.jsx(C,{label:"Status",value:l.status,icon:gn,valueClass:`font-semibold ${l.status==="Paid"?"text-green-600":"text-red-600"}`}),l.status==="Paid"&&u.jsx(C,{label:"Paid Date",value:$t(l.paymentDate),icon:Ps})]}),u.jsxs("button",{onClick:()=>j(l,T),className:"mt-4 bg-indigo-500 hover:bg-indigo-600 text-white font-medium py-2 px-4 rounded-lg flex items-center text-sm",children:[u.jsx(nc,{size:16,className:"mr-2"})," View Full Invoice"]})]})]}),!y&&!l&&s&&!_&&u.jsxs("div",{className:"mt-6 p-5 text-center text-gray-500 bg-gray-50 rounded-lg",children:[u.jsx(gn,{size:32,className:"mx-auto mb-2 text-gray-400"}),'No results found for "',s,'". Please refine your search.']}),x&&T&&u.jsx(T3,{isOpen:!!x,onClose:()=>{b(null)},bill:x,userData:T,calculateBillDetails:t})]})},W$=({db:r,user:e,userData:t,showNotification:n})=>{const[i,s]=J.useState([]),[o,l]=J.useState(!0),[d,f]=J.useState(""),[m,y]=J.useState({}),[g,_]=J.useState(null),[E,x]=J.useState(null),b=J.useCallback(async()=>{l(!0),f("");const j=await YC(r,e.uid);j.success?s(j.data):(f(j.error||"Failed fetching tickets."),n(j.error||"Failed fetching tickets.","error")),l(!1)},[r,e.uid,n]);J.useEffect(()=>{b()},[b]);const T=(j,U)=>{y(C=>({...C,[j]:U}))},N=async j=>{const U=m[j]||"";if(!U.replace(/<[^>]*>?/gm,"").trim()){n("Reply cannot be empty.","warning");return}_(j);const D={text:uo.sanitize(U),authorId:e.uid,authorName:t.displayName||"Customer",authorRole:t.role||"customer",timestamp:jt.now()},O=await KC(r,j,D);O.success?(n("Reply sent!","success"),y(P=>({...P,[j]:""})),b()):n(O.error||"Failed to send reply.","error"),_(null)},R=async j=>{const C=(m[j]||"").replace(/<[^>]*>?/gm,"").trim();if(!C){n("Write a draft or keywords first.","warning");return}x(j);const k=i.find(D=>D.id===j);if(!k){x(null);return}try{const D=(k.conversation||[]).map(P=>`${P.authorRole==="admin"?"Support":"You"}: ${P.text.replace(/<[^>]*>?/gm,"")}`).join(`

`),O=await p3({ticketDescription:k.description,conversationHistory:D,draftReply:C,customerName:t.displayName});T(j,O),n("AI refined your reply.","success")}catch(D){const O=(D==null?void 0:D.message)||"AI assistance failed.";n(O,"error")}finally{x(null)}},I=j=>{switch(j){case"Open":return"bg-red-100 text-red-700";case"In Progress":return"bg-yellow-100 text-yellow-700";case"Awaiting Customer":return"bg-blue-100 text-blue-700";case"Resolved":case"Closed":return"bg-green-100 text-green-700";default:return"bg-gray-100 text-gray-600"}};return o?u.jsx(an,{message:"Loading your support tickets..."}):u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(Pa,{size:30,className:"mr-3 text-purple-600"})," My Support Tickets"]}),u.jsxs("button",{onClick:b,disabled:o,className:"flex items-center text-sm p-2 bg-gray-100 rounded-lg hover:bg-gray-200 border border-gray-300",children:[u.jsx(za,{size:16,className:o?"animate-spin":""}),u.jsx("span",{className:"ml-1.5 hidden sm:inline",children:"Refresh"})]})]}),d&&u.jsx("div",{className:"text-red-500 bg-red-50 p-3 rounded-md text-center border border-red-200",children:d}),i.length===0&&!d&&u.jsxs("div",{className:"text-center py-10 bg-gray-50 p-6 rounded-lg shadow-inner border border-gray-200",children:[u.jsx(gn,{size:48,className:"mx-auto text-gray-400 mb-4"}),u.jsx("p",{className:"text-gray-600 text-lg",children:"No support tickets found."}),u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Use 'Report an Issue' to create one."})]}),u.jsx("div",{className:"space-y-4",children:i.map(j=>u.jsxs("details",{className:"p-4 rounded-lg shadow-md border-l-4 bg-gray-50 border-purple-400 group hover:shadow-lg transition-shadow",children:[u.jsxs("summary",{className:"flex flex-wrap justify-between items-center gap-2 cursor-pointer list-none",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-md font-semibold text-gray-800",children:j.issueType||"Support Ticket"}),u.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["Submitted: ",$t(j.submittedAt,{month:"short",day:"numeric",year:"2-digit"})]}),u.jsx(yy,{text:`Ticket ID: ${j.id}`,position:"bottom",children:u.jsxs("p",{className:"text-xs text-gray-400 font-mono mt-0.5 flex items-center",children:[u.jsx(Rs,{size:12,className:"mr-1"}),j.id.substring(0,8),"..."]})})]}),u.jsx("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full ${I(j.status)} shrink-0`,children:j.status||"Unknown"}),u.jsx("span",{className:"ml-auto transition-transform duration-300 transform group-open:rotate-180 text-purple-600",children:""})]}),u.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200 text-sm text-gray-700 space-y-4 grid grid-rows-[0fr] group-open:grid-rows-[1fr] transition-all duration-500 ease-in-out",children:u.jsxs("div",{className:"overflow-hidden space-y-4",children:[u.jsxs("div",{children:[u.jsx("strong",{className:"text-xs text-gray-500 block mb-1",children:"Your Initial Report:"}),u.jsx("div",{className:"p-2 bg-white border rounded-md whitespace-pre-line text-xs prose prose-xs max-w-none",children:j.description})]}),j.conversation&&j.conversation.length>0&&u.jsxs("div",{className:"space-y-2",children:[u.jsx("strong",{className:"text-xs text-gray-500 block mb-1",children:"Conversation:"}),u.jsx("div",{className:"max-h-60 overflow-y-auto space-y-2 border bg-white p-2 rounded-md scrollbar-thin",children:j.conversation.map((U,C)=>u.jsxs("div",{className:`p-2 rounded-lg text-xs ${U.authorRole==="admin"?"bg-blue-50":"bg-green-50"}`,children:[u.jsxs("p",{className:"font-bold text-gray-800",children:[U.authorName," (",U.authorRole,"):"]}),u.jsx("div",{className:"text-gray-700 prose prose-xs max-w-none break-words",dangerouslySetInnerHTML:{__html:uo.sanitize(U.text||"")}}),u.jsx("p",{className:"text-right text-gray-500 mt-1",children:$t(U.timestamp)})]},C))})]}),j.status!=="Resolved"&&j.status!=="Closed"&&u.jsxs("div",{className:"pt-2",children:[u.jsx("label",{className:"text-xs font-semibold text-gray-600 block mb-1",children:"Send a Reply:"}),u.jsxs("div",{className:"flex items-start gap-2",children:[u.jsx(g0,{value:m[j.id]||"",onChange:U=>T(j.id,U),placeholder:"Type your reply...",className:"flex-grow bg-white rounded-lg border border-gray-300 min-h-[100px]",readOnly:g===j.id||E===j.id}),u.jsx(yy,{text:"Refine draft with AI",children:u.jsx("button",{onClick:()=>R(j.id),className:"p-2 bg-purple-100 text-purple-700 rounded-md hover:bg-purple-200 disabled:opacity-50 disabled:cursor-not-allowed",disabled:E===j.id||!(m[j.id]||"").replace(/<[^>]*>?/gm,"").trim(),children:E===j.id?u.jsx(Et,{size:20,className:"animate-spin"}):u.jsx(Os,{size:20})})})]}),u.jsxs("button",{onClick:()=>N(j.id),className:"mt-2 w-full sm:w-auto flex items-center justify-center bg-blue-600 text-white font-semibold py-2 px-4 rounded-md text-xs hover:bg-blue-700 disabled:opacity-60",disabled:g===j.id||!(m[j.id]||"").replace(/<[^>]*>?/gm,"").trim(),children:[g===j.id?u.jsx(Et,{size:14,className:"animate-spin mr-2"}):u.jsx(n0,{size:14,className:"mr-2"}),"Send Reply"]})]}),j.status==="Resolved"&&u.jsx("p",{className:"text-xs text-green-700 bg-green-50 p-2 rounded border border-green-200",children:"This ticket is marked as resolved. Replying will reopen it."}),j.status==="Closed"&&u.jsx("p",{className:"text-xs text-purple-700 bg-purple-50 p-2 rounded border border-purple-200",children:"This ticket is closed. Please create a new ticket if you need further assistance."})]})})]},j.id))})]})};function G$(r,e){const t=J.useRef(e);J.useEffect(function(){e!==t.current&&r.attributionControl!=null&&(t.current!=null&&r.attributionControl.removeAttribution(t.current),e!=null&&r.attributionControl.addAttribution(e)),t.current=e},[r,e])}Xx();const K$=1;function Y$(r){return Object.freeze({__version:K$,map:r})}function Z$(r,e){return Object.freeze({...r,...e})}const PR=J.createContext(null),CR=PR.Provider;function RR(){const r=J.useContext(PR);if(r==null)throw new Error("No context provided: useLeafletContext() can only be used in a descendant of <MapContainer>");return r}function Q$(r){function e(t,n){const{instance:i,context:s}=r(t).current;return J.useImperativeHandle(n,()=>i),t.children==null?null:ss.createElement(CR,{value:s},t.children)}return J.forwardRef(e)}function X$(r){function e(t,n){const{instance:i}=r(t).current;return J.useImperativeHandle(n,()=>i),null}return J.forwardRef(e)}function jR(r,e){const t=J.useRef();J.useEffect(function(){return e!=null&&r.instance.on(e),t.current=e,function(){t.current!=null&&r.instance.off(t.current),t.current=null}},[r,e])}function tw(r,e){const t=r.pane??e.pane;return t?{...r,pane:t}:r}var xf={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */var J$=xf.exports,y4;function eW(){return y4||(y4=1,function(r,e){(function(t,n){n(e)})(J$,function(t){var n="1.9.4";function i(c){var p,S,V,W;for(S=1,V=arguments.length;S<V;S++){W=arguments[S];for(p in W)c[p]=W[p]}return c}var s=Object.create||function(){function c(){}return function(p){return c.prototype=p,new c}}();function o(c,p){var S=Array.prototype.slice;if(c.bind)return c.bind.apply(c,S.call(arguments,1));var V=S.call(arguments,2);return function(){return c.apply(p,V.length?V.concat(S.call(arguments)):arguments)}}var l=0;function d(c){return"_leaflet_id"in c||(c._leaflet_id=++l),c._leaflet_id}function f(c,p,S){var V,W,re,he;return he=function(){V=!1,W&&(re.apply(S,W),W=!1)},re=function(){V?W=arguments:(c.apply(S,arguments),setTimeout(he,p),V=!0)},re}function m(c,p,S){var V=p[1],W=p[0],re=V-W;return c===V&&S?c:((c-W)%re+re)%re+W}function y(){return!1}function g(c,p){if(p===!1)return c;var S=Math.pow(10,p===void 0?6:p);return Math.round(c*S)/S}function _(c){return c.trim?c.trim():c.replace(/^\s+|\s+$/g,"")}function E(c){return _(c).split(/\s+/)}function x(c,p){Object.prototype.hasOwnProperty.call(c,"options")||(c.options=c.options?s(c.options):{});for(var S in p)c.options[S]=p[S];return c.options}function b(c,p,S){var V=[];for(var W in c)V.push(encodeURIComponent(S?W.toUpperCase():W)+"="+encodeURIComponent(c[W]));return(!p||p.indexOf("?")===-1?"?":"&")+V.join("&")}var T=/\{ *([\w_ -]+) *\}/g;function N(c,p){return c.replace(T,function(S,V){var W=p[V];if(W===void 0)throw new Error("No value provided for variable "+S);return typeof W=="function"&&(W=W(p)),W})}var R=Array.isArray||function(c){return Object.prototype.toString.call(c)==="[object Array]"};function I(c,p){for(var S=0;S<c.length;S++)if(c[S]===p)return S;return-1}var j="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function U(c){return window["webkit"+c]||window["moz"+c]||window["ms"+c]}var C=0;function k(c){var p=+new Date,S=Math.max(0,16-(p-C));return C=p+S,window.setTimeout(c,S)}var D=window.requestAnimationFrame||U("RequestAnimationFrame")||k,O=window.cancelAnimationFrame||U("CancelAnimationFrame")||U("CancelRequestAnimationFrame")||function(c){window.clearTimeout(c)};function P(c,p,S){if(S&&D===k)c.call(p);else return D.call(window,o(c,p))}function F(c){c&&O.call(window,c)}var M={__proto__:null,extend:i,create:s,bind:o,get lastId(){return l},stamp:d,throttle:f,wrapNum:m,falseFn:y,formatNum:g,trim:_,splitWords:E,setOptions:x,getParamString:b,template:N,isArray:R,indexOf:I,emptyImageUrl:j,requestFn:D,cancelFn:O,requestAnimFrame:P,cancelAnimFrame:F};function $(){}$.extend=function(c){var p=function(){x(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},S=p.__super__=this.prototype,V=s(S);V.constructor=p,p.prototype=V;for(var W in this)Object.prototype.hasOwnProperty.call(this,W)&&W!=="prototype"&&W!=="__super__"&&(p[W]=this[W]);return c.statics&&i(p,c.statics),c.includes&&(Y(c.includes),i.apply(null,[V].concat(c.includes))),i(V,c),delete V.statics,delete V.includes,V.options&&(V.options=S.options?s(S.options):{},i(V.options,c.options)),V._initHooks=[],V.callInitHooks=function(){if(!this._initHooksCalled){S.callInitHooks&&S.callInitHooks.call(this),this._initHooksCalled=!0;for(var re=0,he=V._initHooks.length;re<he;re++)V._initHooks[re].call(this)}},p},$.include=function(c){var p=this.prototype.options;return i(this.prototype,c),c.options&&(this.prototype.options=p,this.mergeOptions(c.options)),this},$.mergeOptions=function(c){return i(this.prototype.options,c),this},$.addInitHook=function(c){var p=Array.prototype.slice.call(arguments,1),S=typeof c=="function"?c:function(){this[c].apply(this,p)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(S),this};function Y(c){if(!(typeof L>"u"||!L||!L.Mixin)){c=R(c)?c:[c];for(var p=0;p<c.length;p++)c[p]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var te={on:function(c,p,S){if(typeof c=="object")for(var V in c)this._on(V,c[V],p);else{c=E(c);for(var W=0,re=c.length;W<re;W++)this._on(c[W],p,S)}return this},off:function(c,p,S){if(!arguments.length)delete this._events;else if(typeof c=="object")for(var V in c)this._off(V,c[V],p);else{c=E(c);for(var W=arguments.length===1,re=0,he=c.length;re<he;re++)W?this._off(c[re]):this._off(c[re],p,S)}return this},_on:function(c,p,S,V){if(typeof p!="function"){console.warn("wrong listener type: "+typeof p);return}if(this._listens(c,p,S)===!1){S===this&&(S=void 0);var W={fn:p,ctx:S};V&&(W.once=!0),this._events=this._events||{},this._events[c]=this._events[c]||[],this._events[c].push(W)}},_off:function(c,p,S){var V,W,re;if(this._events&&(V=this._events[c],!!V)){if(arguments.length===1){if(this._firingCount)for(W=0,re=V.length;W<re;W++)V[W].fn=y;delete this._events[c];return}if(typeof p!="function"){console.warn("wrong listener type: "+typeof p);return}var he=this._listens(c,p,S);if(he!==!1){var xe=V[he];this._firingCount&&(xe.fn=y,this._events[c]=V=V.slice()),V.splice(he,1)}}},fire:function(c,p,S){if(!this.listens(c,S))return this;var V=i({},p,{type:c,target:this,sourceTarget:p&&p.sourceTarget||this});if(this._events){var W=this._events[c];if(W){this._firingCount=this._firingCount+1||1;for(var re=0,he=W.length;re<he;re++){var xe=W[re],Ee=xe.fn;xe.once&&this.off(c,Ee,xe.ctx),Ee.call(xe.ctx||this,V)}this._firingCount--}}return S&&this._propagateEvent(V),this},listens:function(c,p,S,V){typeof c!="string"&&console.warn('"string" type argument expected');var W=p;typeof p!="function"&&(V=!!p,W=void 0,S=void 0);var re=this._events&&this._events[c];if(re&&re.length&&this._listens(c,W,S)!==!1)return!0;if(V){for(var he in this._eventParents)if(this._eventParents[he].listens(c,p,S,V))return!0}return!1},_listens:function(c,p,S){if(!this._events)return!1;var V=this._events[c]||[];if(!p)return!!V.length;S===this&&(S=void 0);for(var W=0,re=V.length;W<re;W++)if(V[W].fn===p&&V[W].ctx===S)return W;return!1},once:function(c,p,S){if(typeof c=="object")for(var V in c)this._on(V,c[V],p,!0);else{c=E(c);for(var W=0,re=c.length;W<re;W++)this._on(c[W],p,S,!0)}return this},addEventParent:function(c){return this._eventParents=this._eventParents||{},this._eventParents[d(c)]=c,this},removeEventParent:function(c){return this._eventParents&&delete this._eventParents[d(c)],this},_propagateEvent:function(c){for(var p in this._eventParents)this._eventParents[p].fire(c.type,i({layer:c.target,propagatedFrom:c.target},c),!0)}};te.addEventListener=te.on,te.removeEventListener=te.clearAllEventListeners=te.off,te.addOneTimeEventListener=te.once,te.fireEvent=te.fire,te.hasEventListeners=te.listens;var oe=$.extend(te);function ie(c,p,S){this.x=S?Math.round(c):c,this.y=S?Math.round(p):p}var ne=Math.trunc||function(c){return c>0?Math.floor(c):Math.ceil(c)};ie.prototype={clone:function(){return new ie(this.x,this.y)},add:function(c){return this.clone()._add(K(c))},_add:function(c){return this.x+=c.x,this.y+=c.y,this},subtract:function(c){return this.clone()._subtract(K(c))},_subtract:function(c){return this.x-=c.x,this.y-=c.y,this},divideBy:function(c){return this.clone()._divideBy(c)},_divideBy:function(c){return this.x/=c,this.y/=c,this},multiplyBy:function(c){return this.clone()._multiplyBy(c)},_multiplyBy:function(c){return this.x*=c,this.y*=c,this},scaleBy:function(c){return new ie(this.x*c.x,this.y*c.y)},unscaleBy:function(c){return new ie(this.x/c.x,this.y/c.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=ne(this.x),this.y=ne(this.y),this},distanceTo:function(c){c=K(c);var p=c.x-this.x,S=c.y-this.y;return Math.sqrt(p*p+S*S)},equals:function(c){return c=K(c),c.x===this.x&&c.y===this.y},contains:function(c){return c=K(c),Math.abs(c.x)<=Math.abs(this.x)&&Math.abs(c.y)<=Math.abs(this.y)},toString:function(){return"Point("+g(this.x)+", "+g(this.y)+")"}};function K(c,p,S){return c instanceof ie?c:R(c)?new ie(c[0],c[1]):c==null?c:typeof c=="object"&&"x"in c&&"y"in c?new ie(c.x,c.y):new ie(c,p,S)}function B(c,p){if(c)for(var S=p?[c,p]:c,V=0,W=S.length;V<W;V++)this.extend(S[V])}B.prototype={extend:function(c){var p,S;if(!c)return this;if(c instanceof ie||typeof c[0]=="number"||"x"in c)p=S=K(c);else if(c=G(c),p=c.min,S=c.max,!p||!S)return this;return!this.min&&!this.max?(this.min=p.clone(),this.max=S.clone()):(this.min.x=Math.min(p.x,this.min.x),this.max.x=Math.max(S.x,this.max.x),this.min.y=Math.min(p.y,this.min.y),this.max.y=Math.max(S.y,this.max.y)),this},getCenter:function(c){return K((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,c)},getBottomLeft:function(){return K(this.min.x,this.max.y)},getTopRight:function(){return K(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(c){var p,S;return typeof c[0]=="number"||c instanceof ie?c=K(c):c=G(c),c instanceof B?(p=c.min,S=c.max):p=S=c,p.x>=this.min.x&&S.x<=this.max.x&&p.y>=this.min.y&&S.y<=this.max.y},intersects:function(c){c=G(c);var p=this.min,S=this.max,V=c.min,W=c.max,re=W.x>=p.x&&V.x<=S.x,he=W.y>=p.y&&V.y<=S.y;return re&&he},overlaps:function(c){c=G(c);var p=this.min,S=this.max,V=c.min,W=c.max,re=W.x>p.x&&V.x<S.x,he=W.y>p.y&&V.y<S.y;return re&&he},isValid:function(){return!!(this.min&&this.max)},pad:function(c){var p=this.min,S=this.max,V=Math.abs(p.x-S.x)*c,W=Math.abs(p.y-S.y)*c;return G(K(p.x-V,p.y-W),K(S.x+V,S.y+W))},equals:function(c){return c?(c=G(c),this.min.equals(c.getTopLeft())&&this.max.equals(c.getBottomRight())):!1}};function G(c,p){return!c||c instanceof B?c:new B(c,p)}function X(c,p){if(c)for(var S=p?[c,p]:c,V=0,W=S.length;V<W;V++)this.extend(S[V])}X.prototype={extend:function(c){var p=this._southWest,S=this._northEast,V,W;if(c instanceof le)V=c,W=c;else if(c instanceof X){if(V=c._southWest,W=c._northEast,!V||!W)return this}else return c?this.extend(Q(c)||se(c)):this;return!p&&!S?(this._southWest=new le(V.lat,V.lng),this._northEast=new le(W.lat,W.lng)):(p.lat=Math.min(V.lat,p.lat),p.lng=Math.min(V.lng,p.lng),S.lat=Math.max(W.lat,S.lat),S.lng=Math.max(W.lng,S.lng)),this},pad:function(c){var p=this._southWest,S=this._northEast,V=Math.abs(p.lat-S.lat)*c,W=Math.abs(p.lng-S.lng)*c;return new X(new le(p.lat-V,p.lng-W),new le(S.lat+V,S.lng+W))},getCenter:function(){return new le((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new le(this.getNorth(),this.getWest())},getSouthEast:function(){return new le(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(c){typeof c[0]=="number"||c instanceof le||"lat"in c?c=Q(c):c=se(c);var p=this._southWest,S=this._northEast,V,W;return c instanceof X?(V=c.getSouthWest(),W=c.getNorthEast()):V=W=c,V.lat>=p.lat&&W.lat<=S.lat&&V.lng>=p.lng&&W.lng<=S.lng},intersects:function(c){c=se(c);var p=this._southWest,S=this._northEast,V=c.getSouthWest(),W=c.getNorthEast(),re=W.lat>=p.lat&&V.lat<=S.lat,he=W.lng>=p.lng&&V.lng<=S.lng;return re&&he},overlaps:function(c){c=se(c);var p=this._southWest,S=this._northEast,V=c.getSouthWest(),W=c.getNorthEast(),re=W.lat>p.lat&&V.lat<S.lat,he=W.lng>p.lng&&V.lng<S.lng;return re&&he},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(c,p){return c?(c=se(c),this._southWest.equals(c.getSouthWest(),p)&&this._northEast.equals(c.getNorthEast(),p)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function se(c,p){return c instanceof X?c:new X(c,p)}function le(c,p,S){if(isNaN(c)||isNaN(p))throw new Error("Invalid LatLng object: ("+c+", "+p+")");this.lat=+c,this.lng=+p,S!==void 0&&(this.alt=+S)}le.prototype={equals:function(c,p){if(!c)return!1;c=Q(c);var S=Math.max(Math.abs(this.lat-c.lat),Math.abs(this.lng-c.lng));return S<=(p===void 0?1e-9:p)},toString:function(c){return"LatLng("+g(this.lat,c)+", "+g(this.lng,c)+")"},distanceTo:function(c){return ue.distance(this,Q(c))},wrap:function(){return ue.wrapLatLng(this)},toBounds:function(c){var p=180*c/40075017,S=p/Math.cos(Math.PI/180*this.lat);return se([this.lat-p,this.lng-S],[this.lat+p,this.lng+S])},clone:function(){return new le(this.lat,this.lng,this.alt)}};function Q(c,p,S){return c instanceof le?c:R(c)&&typeof c[0]!="object"?c.length===3?new le(c[0],c[1],c[2]):c.length===2?new le(c[0],c[1]):null:c==null?c:typeof c=="object"&&"lat"in c?new le(c.lat,"lng"in c?c.lng:c.lon,c.alt):p===void 0?null:new le(c,p,S)}var ce={latLngToPoint:function(c,p){var S=this.projection.project(c),V=this.scale(p);return this.transformation._transform(S,V)},pointToLatLng:function(c,p){var S=this.scale(p),V=this.transformation.untransform(c,S);return this.projection.unproject(V)},project:function(c){return this.projection.project(c)},unproject:function(c){return this.projection.unproject(c)},scale:function(c){return 256*Math.pow(2,c)},zoom:function(c){return Math.log(c/256)/Math.LN2},getProjectedBounds:function(c){if(this.infinite)return null;var p=this.projection.bounds,S=this.scale(c),V=this.transformation.transform(p.min,S),W=this.transformation.transform(p.max,S);return new B(V,W)},infinite:!1,wrapLatLng:function(c){var p=this.wrapLng?m(c.lng,this.wrapLng,!0):c.lng,S=this.wrapLat?m(c.lat,this.wrapLat,!0):c.lat,V=c.alt;return new le(S,p,V)},wrapLatLngBounds:function(c){var p=c.getCenter(),S=this.wrapLatLng(p),V=p.lat-S.lat,W=p.lng-S.lng;if(V===0&&W===0)return c;var re=c.getSouthWest(),he=c.getNorthEast(),xe=new le(re.lat-V,re.lng-W),Ee=new le(he.lat-V,he.lng-W);return new X(xe,Ee)}},ue=i({},ce,{wrapLng:[-180,180],R:6371e3,distance:function(c,p){var S=Math.PI/180,V=c.lat*S,W=p.lat*S,re=Math.sin((p.lat-c.lat)*S/2),he=Math.sin((p.lng-c.lng)*S/2),xe=re*re+Math.cos(V)*Math.cos(W)*he*he,Ee=2*Math.atan2(Math.sqrt(xe),Math.sqrt(1-xe));return this.R*Ee}}),fe=6378137,_e={R:fe,MAX_LATITUDE:85.0511287798,project:function(c){var p=Math.PI/180,S=this.MAX_LATITUDE,V=Math.max(Math.min(S,c.lat),-S),W=Math.sin(V*p);return new ie(this.R*c.lng*p,this.R*Math.log((1+W)/(1-W))/2)},unproject:function(c){var p=180/Math.PI;return new le((2*Math.atan(Math.exp(c.y/this.R))-Math.PI/2)*p,c.x*p/this.R)},bounds:function(){var c=fe*Math.PI;return new B([-c,-c],[c,c])}()};function Oe(c,p,S,V){if(R(c)){this._a=c[0],this._b=c[1],this._c=c[2],this._d=c[3];return}this._a=c,this._b=p,this._c=S,this._d=V}Oe.prototype={transform:function(c,p){return this._transform(c.clone(),p)},_transform:function(c,p){return p=p||1,c.x=p*(this._a*c.x+this._b),c.y=p*(this._c*c.y+this._d),c},untransform:function(c,p){return p=p||1,new ie((c.x/p-this._b)/this._a,(c.y/p-this._d)/this._c)}};function qe(c,p,S,V){return new Oe(c,p,S,V)}var tt=i({},ue,{code:"EPSG:3857",projection:_e,transformation:function(){var c=.5/(Math.PI*_e.R);return qe(c,.5,-c,.5)}()}),yt=i({},tt,{code:"EPSG:900913"});function At(c){return document.createElementNS("http://www.w3.org/2000/svg",c)}function xn(c,p){var S="",V,W,re,he,xe,Ee;for(V=0,re=c.length;V<re;V++){for(xe=c[V],W=0,he=xe.length;W<he;W++)Ee=xe[W],S+=(W?"L":"M")+Ee.x+" "+Ee.y;S+=p?We.svg?"z":"x":""}return S||"M0 0"}var Yt=document.documentElement.style,Ae="ActiveXObject"in window,Ne=Ae&&!document.addEventListener,Le="msLaunchUri"in navigator&&!("documentMode"in document),ze=ln("webkit"),ke=ln("android"),vt=ln("android 2")||ln("android 3"),mt=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),pt=ke&&ln("Google")&&mt<537&&!("AudioNode"in window),kt=!!window.opera,Ot=!Le&&ln("chrome"),Mt=ln("gecko")&&!ze&&!kt&&!Ae,ls=!Ot&&ln("safari"),Ht=ln("phantom"),Mn="OTransition"in Yt,cs=navigator.platform.indexOf("Win")===0,Ui=Ae&&"transition"in Yt,yi="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!vt,yr="MozPerspective"in Yt,vi=!window.L_DISABLE_3D&&(Ui||yi||yr)&&!Mn&&!Ht,ti=typeof orientation<"u"||ln("mobile"),qi=ti&&ze,ho=ti&&yi,_i=!window.PointerEvent&&window.MSPointerEvent,Jn=!!(window.PointerEvent||_i),ni="ontouchstart"in window||!!window.TouchEvent,xi=!window.L_NO_TOUCH&&(ni||Jn),bi=ti&&kt,Bo=ti&&Mt,yn=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,wi=function(){var c=!1;try{var p=Object.defineProperty({},"passive",{get:function(){c=!0}});window.addEventListener("testPassiveEventSupport",y,p),window.removeEventListener("testPassiveEventSupport",y,p)}catch{}return c}(),Hi=function(){return!!document.createElement("canvas").getContext}(),us=!!(document.createElementNS&&At("svg").createSVGRect),bn=!!us&&function(){var c=document.createElement("div");return c.innerHTML="<svg/>",(c.firstChild&&c.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),Fs=!us&&function(){try{var c=document.createElement("div");c.innerHTML='<v:shape adj="1"/>';var p=c.firstChild;return p.style.behavior="url(#default#VML)",p&&typeof p.adj=="object"}catch{return!1}}(),Lr=navigator.platform.indexOf("Mac")===0,Vs=navigator.platform.indexOf("Linux")===0;function ln(c){return navigator.userAgent.toLowerCase().indexOf(c)>=0}var We={ie:Ae,ielt9:Ne,edge:Le,webkit:ze,android:ke,android23:vt,androidStock:pt,opera:kt,chrome:Ot,gecko:Mt,safari:ls,phantom:Ht,opera12:Mn,win:cs,ie3d:Ui,webkit3d:yi,gecko3d:yr,any3d:vi,mobile:ti,mobileWebkit:qi,mobileWebkit3d:ho,msPointer:_i,pointer:Jn,touch:xi,touchNative:ni,mobileOpera:bi,mobileGecko:Bo,retina:yn,passiveEvents:wi,canvas:Hi,svg:us,vml:Fs,inlineSvg:bn,mac:Lr,linux:Vs},Nr=We.msPointer?"MSPointerDown":"pointerdown",zs=We.msPointer?"MSPointerMove":"pointermove",fo=We.msPointer?"MSPointerUp":"pointerup",ds=We.msPointer?"MSPointerCancel":"pointercancel",vr={touchstart:Nr,touchmove:zs,touchend:fo,touchcancel:ds},Ir={touchstart:It,touchmove:Zt,touchend:Zt,touchcancel:Zt},kr={},Pr=!1;function Uo(c,p,S){return p==="touchstart"&&Ke(),Ir[p]?(S=Ir[p].bind(this,S),c.addEventListener(vr[p],S,!1),S):(console.warn("wrong event specified:",p),y)}function qo(c,p,S){if(!vr[p]){console.warn("wrong event specified:",p);return}c.removeEventListener(vr[p],S,!1)}function Qe(c){kr[c.pointerId]=c}function pe(c){kr[c.pointerId]&&(kr[c.pointerId]=c)}function Me(c){delete kr[c.pointerId]}function Ke(){Pr||(document.addEventListener(Nr,Qe,!0),document.addEventListener(zs,pe,!0),document.addEventListener(fo,Me,!0),document.addEventListener(ds,Me,!0),Pr=!0)}function Zt(c,p){if(p.pointerType!==(p.MSPOINTER_TYPE_MOUSE||"mouse")){p.touches=[];for(var S in kr)p.touches.push(kr[S]);p.changedTouches=[p],c(p)}}function It(c,p){p.MSPOINTER_TYPE_TOUCH&&p.pointerType===p.MSPOINTER_TYPE_TOUCH&&dn(p),Zt(c,p)}function wn(c){var p={},S,V;for(V in c)S=c[V],p[V]=S&&S.bind?S.bind(c):S;return c=p,p.type="dblclick",p.detail=2,p.isTrusted=!1,p._simulated=!0,p}var Pn=200;function er(c,p){c.addEventListener("dblclick",p);var S=0,V;function W(re){if(re.detail!==1){V=re.detail;return}if(!(re.pointerType==="mouse"||re.sourceCapabilities&&!re.sourceCapabilities.firesTouchEvents)){var he=fs(re);if(!(he.some(function(Ee){return Ee instanceof HTMLLabelElement&&Ee.attributes.for})&&!he.some(function(Ee){return Ee instanceof HTMLInputElement||Ee instanceof HTMLSelectElement}))){var xe=Date.now();xe-S<=Pn?(V++,V===2&&p(wn(re))):V=1,S=xe}}}return c.addEventListener("click",W),{dblclick:p,simDblclick:W}}function Gn(c,p){c.removeEventListener("dblclick",p.dblclick),c.removeEventListener("click",p.simDblclick)}var $i=Ki(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),vn=Ki(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Wi=vn==="webkitTransition"||vn==="OTransition"?vn+"End":"transitionend";function ar(c){return typeof c=="string"?document.getElementById(c):c}function mo(c,p){var S=c.style[p]||c.currentStyle&&c.currentStyle[p];if((!S||S==="auto")&&document.defaultView){var V=document.defaultView.getComputedStyle(c,null);S=V?V[p]:null}return S==="auto"?null:S}function St(c,p,S){var V=document.createElement(c);return V.className=p||"",S&&S.appendChild(V),V}function cn(c){var p=c.parentNode;p&&p.removeChild(c)}function Ho(c){for(;c.firstChild;)c.removeChild(c.firstChild)}function Bs(c){var p=c.parentNode;p&&p.lastChild!==c&&p.appendChild(c)}function Gi(c){var p=c.parentNode;p&&p.firstChild!==c&&p.insertBefore(c,p.firstChild)}function po(c,p){if(c.classList!==void 0)return c.classList.contains(p);var S=Ei(c);return S.length>0&&new RegExp("(^|\\s)"+p+"(\\s|$)").test(S)}function xt(c,p){if(c.classList!==void 0)for(var S=E(p),V=0,W=S.length;V<W;V++)c.classList.add(S[V]);else if(!po(c,p)){var re=Ei(c);mc(c,(re?re+" ":"")+p)}}function un(c,p){c.classList!==void 0?c.classList.remove(p):mc(c,_((" "+Ei(c)+" ").replace(" "+p+" "," ")))}function mc(c,p){c.className.baseVal===void 0?c.className=p:c.className.baseVal=p}function Ei(c){return c.correspondingElement&&(c=c.correspondingElement),c.className.baseVal===void 0?c.className:c.className.baseVal}function Sn(c,p){"opacity"in c.style?c.style.opacity=p:"filter"in c.style&&$o(c,p)}function $o(c,p){var S=!1,V="DXImageTransform.Microsoft.Alpha";try{S=c.filters.item(V)}catch{if(p===1)return}p=Math.round(p*100),S?(S.Enabled=p!==100,S.Opacity=p):c.style.filter+=" progid:"+V+"(opacity="+p+")"}function Ki(c){for(var p=document.documentElement.style,S=0;S<c.length;S++)if(c[S]in p)return c[S];return!1}function Fr(c,p,S){var V=p||new ie(0,0);c.style[$i]=(We.ie3d?"translate("+V.x+"px,"+V.y+"px)":"translate3d("+V.x+"px,"+V.y+"px,0)")+(S?" scale("+S+")":"")}function Tt(c,p){c._leaflet_pos=p,We.any3d?Fr(c,p):(c.style.left=p.x+"px",c.style.top=p.y+"px")}function Vr(c){return c._leaflet_pos||new ie(0,0)}var Ct,Si,Ha;if("onselectstart"in document)Ct=function(){lt(window,"selectstart",dn)},Si=function(){tn(window,"selectstart",dn)};else{var hs=Ki(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Ct=function(){if(hs){var c=document.documentElement.style;Ha=c[hs],c[hs]="none"}},Si=function(){hs&&(document.documentElement.style[hs]=Ha,Ha=void 0)}}function $a(){lt(window,"dragstart",dn)}function Wa(){tn(window,"dragstart",dn)}var Wo,Go;function Ti(c){for(;c.tabIndex===-1;)c=c.parentNode;c.style&&(Bn(),Wo=c,Go=c.style.outlineStyle,c.style.outlineStyle="none",lt(window,"keydown",Bn))}function Bn(){Wo&&(Wo.style.outlineStyle=Go,Wo=void 0,Go=void 0,tn(window,"keydown",Bn))}function Ai(c){do c=c.parentNode;while((!c.offsetWidth||!c.offsetHeight)&&c!==document.body);return c}function ri(c){var p=c.getBoundingClientRect();return{x:p.width/c.offsetWidth||1,y:p.height/c.offsetHeight||1,boundingClientRect:p}}var go={__proto__:null,TRANSFORM:$i,TRANSITION:vn,TRANSITION_END:Wi,get:ar,getStyle:mo,create:St,remove:cn,empty:Ho,toFront:Bs,toBack:Gi,hasClass:po,addClass:xt,removeClass:un,setClass:mc,getClass:Ei,setOpacity:Sn,testProp:Ki,setTransform:Fr,setPosition:Tt,getPosition:Vr,get disableTextSelection(){return Ct},get enableTextSelection(){return Si},disableImageDrag:$a,enableImageDrag:Wa,preventOutline:Ti,restoreOutline:Bn,getSizedParentNode:Ai,getScale:ri};function lt(c,p,S,V){if(p&&typeof p=="object")for(var W in p)gc(c,W,p[W],S);else{p=E(p);for(var re=0,he=p.length;re<he;re++)gc(c,p[re],S,V)}return this}var Kn="_leaflet_events";function tn(c,p,S,V){if(arguments.length===1)pc(c),delete c[Kn];else if(p&&typeof p=="object")for(var W in p)Ga(c,W,p[W],S);else if(p=E(p),arguments.length===2)pc(c,function(xe){return I(p,xe)!==-1});else for(var re=0,he=p.length;re<he;re++)Ga(c,p[re],S,V);return this}function pc(c,p){for(var S in c[Kn]){var V=S.split(/\d/)[0];(!p||p(V))&&Ga(c,V,null,null,S)}}var _r={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function gc(c,p,S,V){var W=p+d(S)+(V?"_"+d(V):"");if(c[Kn]&&c[Kn][W])return this;var re=function(xe){return S.call(V||c,xe||window.event)},he=re;!We.touchNative&&We.pointer&&p.indexOf("touch")===0?re=Uo(c,p,re):We.touch&&p==="dblclick"?re=er(c,re):"addEventListener"in c?p==="touchstart"||p==="touchmove"||p==="wheel"||p==="mousewheel"?c.addEventListener(_r[p]||p,re,We.passiveEvents?{passive:!1}:!1):p==="mouseenter"||p==="mouseleave"?(re=function(xe){xe=xe||window.event,Ko(c,xe)&&he(xe)},c.addEventListener(_r[p],re,!1)):c.addEventListener(p,he,!1):c.attachEvent("on"+p,re),c[Kn]=c[Kn]||{},c[Kn][W]=re}function Ga(c,p,S,V,W){W=W||p+d(S)+(V?"_"+d(V):"");var re=c[Kn]&&c[Kn][W];if(!re)return this;!We.touchNative&&We.pointer&&p.indexOf("touch")===0?qo(c,p,re):We.touch&&p==="dblclick"?Gn(c,re):"removeEventListener"in c?c.removeEventListener(_r[p]||p,re,!1):c.detachEvent("on"+p,re),c[Kn][W]=null}function Cr(c){return c.stopPropagation?c.stopPropagation():c.originalEvent?c.originalEvent._stopped=!0:c.cancelBubble=!0,this}function Us(c){return gc(c,"wheel",Cr),this}function yo(c){return lt(c,"mousedown touchstart dblclick contextmenu",Cr),c._leaflet_disable_click=!0,this}function dn(c){return c.preventDefault?c.preventDefault():c.returnValue=!1,this}function lr(c){return dn(c),Cr(c),this}function fs(c){if(c.composedPath)return c.composedPath();for(var p=[],S=c.target;S;)p.push(S),S=S.parentNode;return p}function qs(c,p){if(!p)return new ie(c.clientX,c.clientY);var S=ri(p),V=S.boundingClientRect;return new ie((c.clientX-V.left)/S.x-p.clientLeft,(c.clientY-V.top)/S.y-p.clientTop)}var Tn=We.linux&&We.chrome?window.devicePixelRatio:We.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Su(c){return We.edge?c.wheelDeltaY/2:c.deltaY&&c.deltaMode===0?-c.deltaY/Tn:c.deltaY&&c.deltaMode===1?-c.deltaY*20:c.deltaY&&c.deltaMode===2?-c.deltaY*60:c.deltaX||c.deltaZ?0:c.wheelDelta?(c.wheelDeltaY||c.wheelDelta)/2:c.detail&&Math.abs(c.detail)<32765?-c.detail*20:c.detail?c.detail/-32765*60:0}function Ko(c,p){var S=p.relatedTarget;if(!S)return!0;try{for(;S&&S!==c;)S=S.parentNode}catch{return!1}return S!==c}var Yo={__proto__:null,on:lt,off:tn,stopPropagation:Cr,disableScrollPropagation:Us,disableClickPropagation:yo,preventDefault:dn,stop:lr,getPropagationPath:fs,getMousePosition:qs,getWheelDelta:Su,isExternalTarget:Ko,addListener:lt,removeListener:tn},Zo=oe.extend({run:function(c,p,S,V){this.stop(),this._el=c,this._inProgress=!0,this._duration=S||.25,this._easeOutPower=1/Math.max(V||.5,.2),this._startPos=Vr(c),this._offset=p.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=P(this._animate,this),this._step()},_step:function(c){var p=+new Date-this._startTime,S=this._duration*1e3;p<S?this._runFrame(this._easeOut(p/S),c):(this._runFrame(1),this._complete())},_runFrame:function(c,p){var S=this._startPos.add(this._offset.multiplyBy(c));p&&S._round(),Tt(this._el,S),this.fire("step")},_complete:function(){F(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(c){return 1-Math.pow(1-c,this._easeOutPower)}}),Rt=oe.extend({options:{crs:tt,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(c,p){p=x(this,p),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(c),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),p.maxBounds&&this.setMaxBounds(p.maxBounds),p.zoom!==void 0&&(this._zoom=this._limitZoom(p.zoom)),p.center&&p.zoom!==void 0&&this.setView(Q(p.center),p.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=vn&&We.any3d&&!We.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),lt(this._proxy,Wi,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(c,p,S){if(p=p===void 0?this._zoom:this._limitZoom(p),c=this._limitCenter(Q(c),p,this.options.maxBounds),S=S||{},this._stop(),this._loaded&&!S.reset&&S!==!0){S.animate!==void 0&&(S.zoom=i({animate:S.animate},S.zoom),S.pan=i({animate:S.animate,duration:S.duration},S.pan));var V=this._zoom!==p?this._tryAnimatedZoom&&this._tryAnimatedZoom(c,p,S.zoom):this._tryAnimatedPan(c,S.pan);if(V)return clearTimeout(this._sizeTimer),this}return this._resetView(c,p,S.pan&&S.pan.noMoveStart),this},setZoom:function(c,p){return this._loaded?this.setView(this.getCenter(),c,{zoom:p}):(this._zoom=c,this)},zoomIn:function(c,p){return c=c||(We.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+c,p)},zoomOut:function(c,p){return c=c||(We.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-c,p)},setZoomAround:function(c,p,S){var V=this.getZoomScale(p),W=this.getSize().divideBy(2),re=c instanceof ie?c:this.latLngToContainerPoint(c),he=re.subtract(W).multiplyBy(1-1/V),xe=this.containerPointToLatLng(W.add(he));return this.setView(xe,p,{zoom:S})},_getBoundsCenterZoom:function(c,p){p=p||{},c=c.getBounds?c.getBounds():se(c);var S=K(p.paddingTopLeft||p.padding||[0,0]),V=K(p.paddingBottomRight||p.padding||[0,0]),W=this.getBoundsZoom(c,!1,S.add(V));if(W=typeof p.maxZoom=="number"?Math.min(p.maxZoom,W):W,W===1/0)return{center:c.getCenter(),zoom:W};var re=V.subtract(S).divideBy(2),he=this.project(c.getSouthWest(),W),xe=this.project(c.getNorthEast(),W),Ee=this.unproject(he.add(xe).divideBy(2).add(re),W);return{center:Ee,zoom:W}},fitBounds:function(c,p){if(c=se(c),!c.isValid())throw new Error("Bounds are not valid.");var S=this._getBoundsCenterZoom(c,p);return this.setView(S.center,S.zoom,p)},fitWorld:function(c){return this.fitBounds([[-90,-180],[90,180]],c)},panTo:function(c,p){return this.setView(c,this._zoom,{pan:p})},panBy:function(c,p){if(c=K(c).round(),p=p||{},!c.x&&!c.y)return this.fire("moveend");if(p.animate!==!0&&!this.getSize().contains(c))return this._resetView(this.unproject(this.project(this.getCenter()).add(c)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Zo,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),p.noMoveStart||this.fire("movestart"),p.animate!==!1){xt(this._mapPane,"leaflet-pan-anim");var S=this._getMapPanePos().subtract(c).round();this._panAnim.run(this._mapPane,S,p.duration||.25,p.easeLinearity)}else this._rawPanBy(c),this.fire("move").fire("moveend");return this},flyTo:function(c,p,S){if(S=S||{},S.animate===!1||!We.any3d)return this.setView(c,p,S);this._stop();var V=this.project(this.getCenter()),W=this.project(c),re=this.getSize(),he=this._zoom;c=Q(c),p=p===void 0?he:p;var xe=Math.max(re.x,re.y),Ee=xe*this.getZoomScale(he,p),Pe=W.distanceTo(V)||1,$e=1.42,ut=$e*$e;function Pt(rn){var fl=rn?-1:1,b0=rn?Ee:xe,w0=Ee*Ee-xe*xe+fl*ut*ut*Pe*Pe,ra=2*b0*ut*Pe,ia=w0/ra,sa=Math.sqrt(ia*ia+1)-ia,Fu=sa<1e-9?-18:Math.log(sa);return Fu}function cr(rn){return(Math.exp(rn)-Math.exp(-rn))/2}function ir(rn){return(Math.exp(rn)+Math.exp(-rn))/2}function oi(rn){return cr(rn)/ir(rn)}var Ur=Pt(0);function dl(rn){return xe*(ir(Ur)/ir(Ur+$e*rn))}function bh(rn){return xe*(ir(Ur)*oi(Ur+$e*rn)-cr(Ur))/ut}function wo(rn){return 1-Math.pow(1-rn,1.5)}var Um=Date.now(),na=(Pt(1)-Ur)/$e,vs=S.duration?1e3*S.duration:1e3*na*.8;function hl(){var rn=(Date.now()-Um)/vs,fl=wo(rn)*na;rn<=1?(this._flyToFrame=P(hl,this),this._move(this.unproject(V.add(W.subtract(V).multiplyBy(bh(fl)/Pe)),he),this.getScaleZoom(xe/dl(fl),he),{flyTo:!0})):this._move(c,p)._moveEnd(!0)}return this._moveStart(!0,S.noMoveStart),hl.call(this),this},flyToBounds:function(c,p){var S=this._getBoundsCenterZoom(c,p);return this.flyTo(S.center,S.zoom,p)},setMaxBounds:function(c){return c=se(c),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),c.isValid()?(this.options.maxBounds=c,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(c){var p=this.options.minZoom;return this.options.minZoom=c,this._loaded&&p!==c&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(c):this},setMaxZoom:function(c){var p=this.options.maxZoom;return this.options.maxZoom=c,this._loaded&&p!==c&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(c):this},panInsideBounds:function(c,p){this._enforcingBounds=!0;var S=this.getCenter(),V=this._limitCenter(S,this._zoom,se(c));return S.equals(V)||this.panTo(V,p),this._enforcingBounds=!1,this},panInside:function(c,p){p=p||{};var S=K(p.paddingTopLeft||p.padding||[0,0]),V=K(p.paddingBottomRight||p.padding||[0,0]),W=this.project(this.getCenter()),re=this.project(c),he=this.getPixelBounds(),xe=G([he.min.add(S),he.max.subtract(V)]),Ee=xe.getSize();if(!xe.contains(re)){this._enforcingBounds=!0;var Pe=re.subtract(xe.getCenter()),$e=xe.extend(re).getSize().subtract(Ee);W.x+=Pe.x<0?-$e.x:$e.x,W.y+=Pe.y<0?-$e.y:$e.y,this.panTo(this.unproject(W),p),this._enforcingBounds=!1}return this},invalidateSize:function(c){if(!this._loaded)return this;c=i({animate:!1,pan:!0},c===!0?{animate:!0}:c);var p=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var S=this.getSize(),V=p.divideBy(2).round(),W=S.divideBy(2).round(),re=V.subtract(W);return!re.x&&!re.y?this:(c.animate&&c.pan?this.panBy(re):(c.pan&&this._rawPanBy(re),this.fire("move"),c.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:p,newSize:S}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(c){if(c=this._locateOptions=i({timeout:1e4,watch:!1},c),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var p=o(this._handleGeolocationResponse,this),S=o(this._handleGeolocationError,this);return c.watch?this._locationWatchId=navigator.geolocation.watchPosition(p,S,c):navigator.geolocation.getCurrentPosition(p,S,c),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(c){if(this._container._leaflet_id){var p=c.code,S=c.message||(p===1?"permission denied":p===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:p,message:"Geolocation error: "+S+"."})}},_handleGeolocationResponse:function(c){if(this._container._leaflet_id){var p=c.coords.latitude,S=c.coords.longitude,V=new le(p,S),W=V.toBounds(c.coords.accuracy*2),re=this._locateOptions;if(re.setView){var he=this.getBoundsZoom(W);this.setView(V,re.maxZoom?Math.min(he,re.maxZoom):he)}var xe={latlng:V,bounds:W,timestamp:c.timestamp};for(var Ee in c.coords)typeof c.coords[Ee]=="number"&&(xe[Ee]=c.coords[Ee]);this.fire("locationfound",xe)}},addHandler:function(c,p){if(!p)return this;var S=this[c]=new p(this);return this._handlers.push(S),this.options[c]&&S.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),cn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(F(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var c;for(c in this._layers)this._layers[c].remove();for(c in this._panes)cn(this._panes[c]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(c,p){var S="leaflet-pane"+(c?" leaflet-"+c.replace("Pane","")+"-pane":""),V=St("div",S,p||this._mapPane);return c&&(this._panes[c]=V),V},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var c=this.getPixelBounds(),p=this.unproject(c.getBottomLeft()),S=this.unproject(c.getTopRight());return new X(p,S)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(c,p,S){c=se(c),S=K(S||[0,0]);var V=this.getZoom()||0,W=this.getMinZoom(),re=this.getMaxZoom(),he=c.getNorthWest(),xe=c.getSouthEast(),Ee=this.getSize().subtract(S),Pe=G(this.project(xe,V),this.project(he,V)).getSize(),$e=We.any3d?this.options.zoomSnap:1,ut=Ee.x/Pe.x,Pt=Ee.y/Pe.y,cr=p?Math.max(ut,Pt):Math.min(ut,Pt);return V=this.getScaleZoom(cr,V),$e&&(V=Math.round(V/($e/100))*($e/100),V=p?Math.ceil(V/$e)*$e:Math.floor(V/$e)*$e),Math.max(W,Math.min(re,V))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new ie(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(c,p){var S=this._getTopLeftPoint(c,p);return new B(S,S.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(c){return this.options.crs.getProjectedBounds(c===void 0?this.getZoom():c)},getPane:function(c){return typeof c=="string"?this._panes[c]:c},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(c,p){var S=this.options.crs;return p=p===void 0?this._zoom:p,S.scale(c)/S.scale(p)},getScaleZoom:function(c,p){var S=this.options.crs;p=p===void 0?this._zoom:p;var V=S.zoom(c*S.scale(p));return isNaN(V)?1/0:V},project:function(c,p){return p=p===void 0?this._zoom:p,this.options.crs.latLngToPoint(Q(c),p)},unproject:function(c,p){return p=p===void 0?this._zoom:p,this.options.crs.pointToLatLng(K(c),p)},layerPointToLatLng:function(c){var p=K(c).add(this.getPixelOrigin());return this.unproject(p)},latLngToLayerPoint:function(c){var p=this.project(Q(c))._round();return p._subtract(this.getPixelOrigin())},wrapLatLng:function(c){return this.options.crs.wrapLatLng(Q(c))},wrapLatLngBounds:function(c){return this.options.crs.wrapLatLngBounds(se(c))},distance:function(c,p){return this.options.crs.distance(Q(c),Q(p))},containerPointToLayerPoint:function(c){return K(c).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(c){return K(c).add(this._getMapPanePos())},containerPointToLatLng:function(c){var p=this.containerPointToLayerPoint(K(c));return this.layerPointToLatLng(p)},latLngToContainerPoint:function(c){return this.layerPointToContainerPoint(this.latLngToLayerPoint(Q(c)))},mouseEventToContainerPoint:function(c){return qs(c,this._container)},mouseEventToLayerPoint:function(c){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(c))},mouseEventToLatLng:function(c){return this.layerPointToLatLng(this.mouseEventToLayerPoint(c))},_initContainer:function(c){var p=this._container=ar(c);if(p){if(p._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");lt(p,"scroll",this._onScroll,this),this._containerId=d(p)},_initLayout:function(){var c=this._container;this._fadeAnimated=this.options.fadeAnimation&&We.any3d,xt(c,"leaflet-container"+(We.touch?" leaflet-touch":"")+(We.retina?" leaflet-retina":"")+(We.ielt9?" leaflet-oldie":"")+(We.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var p=mo(c,"position");p!=="absolute"&&p!=="relative"&&p!=="fixed"&&p!=="sticky"&&(c.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var c=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),Tt(this._mapPane,new ie(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(xt(c.markerPane,"leaflet-zoom-hide"),xt(c.shadowPane,"leaflet-zoom-hide"))},_resetView:function(c,p,S){Tt(this._mapPane,new ie(0,0));var V=!this._loaded;this._loaded=!0,p=this._limitZoom(p),this.fire("viewprereset");var W=this._zoom!==p;this._moveStart(W,S)._move(c,p)._moveEnd(W),this.fire("viewreset"),V&&this.fire("load")},_moveStart:function(c,p){return c&&this.fire("zoomstart"),p||this.fire("movestart"),this},_move:function(c,p,S,V){p===void 0&&(p=this._zoom);var W=this._zoom!==p;return this._zoom=p,this._lastCenter=c,this._pixelOrigin=this._getNewPixelOrigin(c),V?S&&S.pinch&&this.fire("zoom",S):((W||S&&S.pinch)&&this.fire("zoom",S),this.fire("move",S)),this},_moveEnd:function(c){return c&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return F(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(c){Tt(this._mapPane,this._getMapPanePos().subtract(c))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(c){this._targets={},this._targets[d(this._container)]=this;var p=c?tn:lt;p(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&p(window,"resize",this._onResize,this),We.any3d&&this.options.transform3DLimit&&(c?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){F(this._resizeRequest),this._resizeRequest=P(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var c=this._getMapPanePos();Math.max(Math.abs(c.x),Math.abs(c.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(c,p){for(var S=[],V,W=p==="mouseout"||p==="mouseover",re=c.target||c.srcElement,he=!1;re;){if(V=this._targets[d(re)],V&&(p==="click"||p==="preclick")&&this._draggableMoved(V)){he=!0;break}if(V&&V.listens(p,!0)&&(W&&!Ko(re,c)||(S.push(V),W))||re===this._container)break;re=re.parentNode}return!S.length&&!he&&!W&&this.listens(p,!0)&&(S=[this]),S},_isClickDisabled:function(c){for(;c&&c!==this._container;){if(c._leaflet_disable_click)return!0;c=c.parentNode}},_handleDOMEvent:function(c){var p=c.target||c.srcElement;if(!(!this._loaded||p._leaflet_disable_events||c.type==="click"&&this._isClickDisabled(p))){var S=c.type;S==="mousedown"&&Ti(p),this._fireDOMEvent(c,S)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(c,p,S){if(c.type==="click"){var V=i({},c);V.type="preclick",this._fireDOMEvent(V,V.type,S)}var W=this._findEventTargets(c,p);if(S){for(var re=[],he=0;he<S.length;he++)S[he].listens(p,!0)&&re.push(S[he]);W=re.concat(W)}if(W.length){p==="contextmenu"&&dn(c);var xe=W[0],Ee={originalEvent:c};if(c.type!=="keypress"&&c.type!=="keydown"&&c.type!=="keyup"){var Pe=xe.getLatLng&&(!xe._radius||xe._radius<=10);Ee.containerPoint=Pe?this.latLngToContainerPoint(xe.getLatLng()):this.mouseEventToContainerPoint(c),Ee.layerPoint=this.containerPointToLayerPoint(Ee.containerPoint),Ee.latlng=Pe?xe.getLatLng():this.layerPointToLatLng(Ee.layerPoint)}for(he=0;he<W.length;he++)if(W[he].fire(p,Ee,!0),Ee.originalEvent._stopped||W[he].options.bubblingMouseEvents===!1&&I(this._mouseEvents,p)!==-1)return}},_draggableMoved:function(c){return c=c.dragging&&c.dragging.enabled()?c:this,c.dragging&&c.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var c=0,p=this._handlers.length;c<p;c++)this._handlers[c].disable()},whenReady:function(c,p){return this._loaded?c.call(p||this,{target:this}):this.on("load",c,p),this},_getMapPanePos:function(){return Vr(this._mapPane)||new ie(0,0)},_moved:function(){var c=this._getMapPanePos();return c&&!c.equals([0,0])},_getTopLeftPoint:function(c,p){var S=c&&p!==void 0?this._getNewPixelOrigin(c,p):this.getPixelOrigin();return S.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(c,p){var S=this.getSize()._divideBy(2);return this.project(c,p)._subtract(S)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(c,p,S){var V=this._getNewPixelOrigin(S,p);return this.project(c,p)._subtract(V)},_latLngBoundsToNewLayerBounds:function(c,p,S){var V=this._getNewPixelOrigin(S,p);return G([this.project(c.getSouthWest(),p)._subtract(V),this.project(c.getNorthWest(),p)._subtract(V),this.project(c.getSouthEast(),p)._subtract(V),this.project(c.getNorthEast(),p)._subtract(V)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(c){return this.latLngToLayerPoint(c).subtract(this._getCenterLayerPoint())},_limitCenter:function(c,p,S){if(!S)return c;var V=this.project(c,p),W=this.getSize().divideBy(2),re=new B(V.subtract(W),V.add(W)),he=this._getBoundsOffset(re,S,p);return Math.abs(he.x)<=1&&Math.abs(he.y)<=1?c:this.unproject(V.add(he),p)},_limitOffset:function(c,p){if(!p)return c;var S=this.getPixelBounds(),V=new B(S.min.add(c),S.max.add(c));return c.add(this._getBoundsOffset(V,p))},_getBoundsOffset:function(c,p,S){var V=G(this.project(p.getNorthEast(),S),this.project(p.getSouthWest(),S)),W=V.min.subtract(c.min),re=V.max.subtract(c.max),he=this._rebound(W.x,-re.x),xe=this._rebound(W.y,-re.y);return new ie(he,xe)},_rebound:function(c,p){return c+p>0?Math.round(c-p)/2:Math.max(0,Math.ceil(c))-Math.max(0,Math.floor(p))},_limitZoom:function(c){var p=this.getMinZoom(),S=this.getMaxZoom(),V=We.any3d?this.options.zoomSnap:1;return V&&(c=Math.round(c/V)*V),Math.max(p,Math.min(S,c))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){un(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(c,p){var S=this._getCenterOffset(c)._trunc();return(p&&p.animate)!==!0&&!this.getSize().contains(S)?!1:(this.panBy(S,p),!0)},_createAnimProxy:function(){var c=this._proxy=St("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(c),this.on("zoomanim",function(p){var S=$i,V=this._proxy.style[S];Fr(this._proxy,this.project(p.center,p.zoom),this.getZoomScale(p.zoom,1)),V===this._proxy.style[S]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){cn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var c=this.getCenter(),p=this.getZoom();Fr(this._proxy,this.project(c,p),this.getZoomScale(p,1))},_catchTransitionEnd:function(c){this._animatingZoom&&c.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(c,p,S){if(this._animatingZoom)return!0;if(S=S||{},!this._zoomAnimated||S.animate===!1||this._nothingToAnimate()||Math.abs(p-this._zoom)>this.options.zoomAnimationThreshold)return!1;var V=this.getZoomScale(p),W=this._getCenterOffset(c)._divideBy(1-1/V);return S.animate!==!0&&!this.getSize().contains(W)?!1:(P(function(){this._moveStart(!0,S.noMoveStart||!1)._animateZoom(c,p,!0)},this),!0)},_animateZoom:function(c,p,S,V){this._mapPane&&(S&&(this._animatingZoom=!0,this._animateToCenter=c,this._animateToZoom=p,xt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:c,zoom:p,noUpdate:V}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&un(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function ii(c,p){return new Rt(c,p)}var xr=$.extend({options:{position:"topright"},initialize:function(c){x(this,c)},getPosition:function(){return this.options.position},setPosition:function(c){var p=this._map;return p&&p.removeControl(this),this.options.position=c,p&&p.addControl(this),this},getContainer:function(){return this._container},addTo:function(c){this.remove(),this._map=c;var p=this._container=this.onAdd(c),S=this.getPosition(),V=c._controlCorners[S];return xt(p,"leaflet-control"),S.indexOf("bottom")!==-1?V.insertBefore(p,V.firstChild):V.appendChild(p),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(cn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(c){this._map&&c&&c.screenX>0&&c.screenY>0&&this._map.getContainer().focus()}}),tr=function(c){return new xr(c)};Rt.include({addControl:function(c){return c.addTo(this),this},removeControl:function(c){return c.remove(),this},_initControlPos:function(){var c=this._controlCorners={},p="leaflet-",S=this._controlContainer=St("div",p+"control-container",this._container);function V(W,re){var he=p+W+" "+p+re;c[W+re]=St("div",he,S)}V("top","left"),V("top","right"),V("bottom","left"),V("bottom","right")},_clearControlPos:function(){for(var c in this._controlCorners)cn(this._controlCorners[c]);cn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var Ka=xr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(c,p,S,V){return S<V?-1:V<S?1:0}},initialize:function(c,p,S){x(this,S),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var V in c)this._addLayer(c[V],V);for(V in p)this._addLayer(p[V],V,!0)},onAdd:function(c){this._initLayout(),this._update(),this._map=c,c.on("zoomend",this._checkDisabledLayers,this);for(var p=0;p<this._layers.length;p++)this._layers[p].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(c){return xr.prototype.addTo.call(this,c),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var c=0;c<this._layers.length;c++)this._layers[c].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(c,p){return this._addLayer(c,p),this._map?this._update():this},addOverlay:function(c,p){return this._addLayer(c,p,!0),this._map?this._update():this},removeLayer:function(c){c.off("add remove",this._onLayerChange,this);var p=this._getLayer(d(c));return p&&this._layers.splice(this._layers.indexOf(p),1),this._map?this._update():this},expand:function(){xt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var c=this._map.getSize().y-(this._container.offsetTop+50);return c<this._section.clientHeight?(xt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=c+"px"):un(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return un(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var c="leaflet-control-layers",p=this._container=St("div",c),S=this.options.collapsed;p.setAttribute("aria-haspopup",!0),yo(p),Us(p);var V=this._section=St("section",c+"-list");S&&(this._map.on("click",this.collapse,this),lt(p,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var W=this._layersLink=St("a",c+"-toggle",p);W.href="#",W.title="Layers",W.setAttribute("role","button"),lt(W,{keydown:function(re){re.keyCode===13&&this._expandSafely()},click:function(re){dn(re),this._expandSafely()}},this),S||this.expand(),this._baseLayersList=St("div",c+"-base",V),this._separator=St("div",c+"-separator",V),this._overlaysList=St("div",c+"-overlays",V),p.appendChild(V)},_getLayer:function(c){for(var p=0;p<this._layers.length;p++)if(this._layers[p]&&d(this._layers[p].layer)===c)return this._layers[p]},_addLayer:function(c,p,S){this._map&&c.on("add remove",this._onLayerChange,this),this._layers.push({layer:c,name:p,overlay:S}),this.options.sortLayers&&this._layers.sort(o(function(V,W){return this.options.sortFunction(V.layer,W.layer,V.name,W.name)},this)),this.options.autoZIndex&&c.setZIndex&&(this._lastZIndex++,c.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Ho(this._baseLayersList),Ho(this._overlaysList),this._layerControlInputs=[];var c,p,S,V,W=0;for(S=0;S<this._layers.length;S++)V=this._layers[S],this._addItem(V),p=p||V.overlay,c=c||!V.overlay,W+=V.overlay?0:1;return this.options.hideSingleBase&&(c=c&&W>1,this._baseLayersList.style.display=c?"":"none"),this._separator.style.display=p&&c?"":"none",this},_onLayerChange:function(c){this._handlingClick||this._update();var p=this._getLayer(d(c.target)),S=p.overlay?c.type==="add"?"overlayadd":"overlayremove":c.type==="add"?"baselayerchange":null;S&&this._map.fire(S,p)},_createRadioElement:function(c,p){var S='<input type="radio" class="leaflet-control-layers-selector" name="'+c+'"'+(p?' checked="checked"':"")+"/>",V=document.createElement("div");return V.innerHTML=S,V.firstChild},_addItem:function(c){var p=document.createElement("label"),S=this._map.hasLayer(c.layer),V;c.overlay?(V=document.createElement("input"),V.type="checkbox",V.className="leaflet-control-layers-selector",V.defaultChecked=S):V=this._createRadioElement("leaflet-base-layers_"+d(this),S),this._layerControlInputs.push(V),V.layerId=d(c.layer),lt(V,"click",this._onInputClick,this);var W=document.createElement("span");W.innerHTML=" "+c.name;var re=document.createElement("span");p.appendChild(re),re.appendChild(V),re.appendChild(W);var he=c.overlay?this._overlaysList:this._baseLayersList;return he.appendChild(p),this._checkDisabledLayers(),p},_onInputClick:function(){if(!this._preventClick){var c=this._layerControlInputs,p,S,V=[],W=[];this._handlingClick=!0;for(var re=c.length-1;re>=0;re--)p=c[re],S=this._getLayer(p.layerId).layer,p.checked?V.push(S):p.checked||W.push(S);for(re=0;re<W.length;re++)this._map.hasLayer(W[re])&&this._map.removeLayer(W[re]);for(re=0;re<V.length;re++)this._map.hasLayer(V[re])||this._map.addLayer(V[re]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var c=this._layerControlInputs,p,S,V=this._map.getZoom(),W=c.length-1;W>=0;W--)p=c[W],S=this._getLayer(p.layerId).layer,p.disabled=S.options.minZoom!==void 0&&V<S.options.minZoom||S.options.maxZoom!==void 0&&V>S.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var c=this._section;this._preventClick=!0,lt(c,"click",dn),this.expand();var p=this;setTimeout(function(){tn(c,"click",dn),p._preventClick=!1})}}),Ya=function(c,p,S){return new Ka(c,p,S)},Ni=xr.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(c){var p="leaflet-control-zoom",S=St("div",p+" leaflet-bar"),V=this.options;return this._zoomInButton=this._createButton(V.zoomInText,V.zoomInTitle,p+"-in",S,this._zoomIn),this._zoomOutButton=this._createButton(V.zoomOutText,V.zoomOutTitle,p+"-out",S,this._zoomOut),this._updateDisabled(),c.on("zoomend zoomlevelschange",this._updateDisabled,this),S},onRemove:function(c){c.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(c){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(c.shiftKey?3:1))},_zoomOut:function(c){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(c.shiftKey?3:1))},_createButton:function(c,p,S,V,W){var re=St("a",S,V);return re.innerHTML=c,re.href="#",re.title=p,re.setAttribute("role","button"),re.setAttribute("aria-label",p),yo(re),lt(re,"click",lr),lt(re,"click",W,this),lt(re,"click",this._refocusOnMap,this),re},_updateDisabled:function(){var c=this._map,p="leaflet-disabled";un(this._zoomInButton,p),un(this._zoomOutButton,p),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||c._zoom===c.getMinZoom())&&(xt(this._zoomOutButton,p),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||c._zoom===c.getMaxZoom())&&(xt(this._zoomInButton,p),this._zoomInButton.setAttribute("aria-disabled","true"))}});Rt.mergeOptions({zoomControl:!0}),Rt.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Ni,this.addControl(this.zoomControl))});var yc=function(c){return new Ni(c)},nr=xr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(c){var p="leaflet-control-scale",S=St("div",p),V=this.options;return this._addScales(V,p+"-line",S),c.on(V.updateWhenIdle?"moveend":"move",this._update,this),c.whenReady(this._update,this),S},onRemove:function(c){c.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(c,p,S){c.metric&&(this._mScale=St("div",p,S)),c.imperial&&(this._iScale=St("div",p,S))},_update:function(){var c=this._map,p=c.getSize().y/2,S=c.distance(c.containerPointToLatLng([0,p]),c.containerPointToLatLng([this.options.maxWidth,p]));this._updateScales(S)},_updateScales:function(c){this.options.metric&&c&&this._updateMetric(c),this.options.imperial&&c&&this._updateImperial(c)},_updateMetric:function(c){var p=this._getRoundNum(c),S=p<1e3?p+" m":p/1e3+" km";this._updateScale(this._mScale,S,p/c)},_updateImperial:function(c){var p=c*3.2808399,S,V,W;p>5280?(S=p/5280,V=this._getRoundNum(S),this._updateScale(this._iScale,V+" mi",V/S)):(W=this._getRoundNum(p),this._updateScale(this._iScale,W+" ft",W/p))},_updateScale:function(c,p,S){c.style.width=Math.round(this.options.maxWidth*S)+"px",c.innerHTML=p},_getRoundNum:function(c){var p=Math.pow(10,(Math.floor(c)+"").length-1),S=c/p;return S=S>=10?10:S>=5?5:S>=3?3:S>=2?2:1,p*S}}),Yi=function(c){return new nr(c)},Za='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',Ii=xr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(We.inlineSvg?Za+" ":"")+"Leaflet</a>"},initialize:function(c){x(this,c),this._attributions={}},onAdd:function(c){c.attributionControl=this,this._container=St("div","leaflet-control-attribution"),yo(this._container);for(var p in c._layers)c._layers[p].getAttribution&&this.addAttribution(c._layers[p].getAttribution());return this._update(),c.on("layeradd",this._addAttribution,this),this._container},onRemove:function(c){c.off("layeradd",this._addAttribution,this)},_addAttribution:function(c){c.layer.getAttribution&&(this.addAttribution(c.layer.getAttribution()),c.layer.once("remove",function(){this.removeAttribution(c.layer.getAttribution())},this))},setPrefix:function(c){return this.options.prefix=c,this._update(),this},addAttribution:function(c){return c?(this._attributions[c]||(this._attributions[c]=0),this._attributions[c]++,this._update(),this):this},removeAttribution:function(c){return c?(this._attributions[c]&&(this._attributions[c]--,this._update()),this):this},_update:function(){if(this._map){var c=[];for(var p in this._attributions)this._attributions[p]&&c.push(p);var S=[];this.options.prefix&&S.push(this.options.prefix),c.length&&S.push(c.join(", ")),this._container.innerHTML=S.join(' <span aria-hidden="true">|</span> ')}}});Rt.mergeOptions({attributionControl:!0}),Rt.addInitHook(function(){this.options.attributionControl&&new Ii().addTo(this)});var ch=function(c){return new Ii(c)};xr.Layers=Ka,xr.Zoom=Ni,xr.Scale=nr,xr.Attribution=Ii,tr.layers=Ya,tr.zoom=yc,tr.scale=Yi,tr.attribution=ch;var Rr=$.extend({initialize:function(c){this._map=c},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Rr.addTo=function(c,p){return c.addHandler(p,this),this};var Hs={Events:te},$s=We.touch?"touchstart mousedown":"mousedown",zr=oe.extend({options:{clickTolerance:3},initialize:function(c,p,S,V){x(this,V),this._element=c,this._dragStartTarget=p||c,this._preventOutline=S},enable:function(){this._enabled||(lt(this._dragStartTarget,$s,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(zr._dragging===this&&this.finishDrag(!0),tn(this._dragStartTarget,$s,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(c){if(this._enabled&&(this._moved=!1,!po(this._element,"leaflet-zoom-anim"))){if(c.touches&&c.touches.length!==1){zr._dragging===this&&this.finishDrag();return}if(!(zr._dragging||c.shiftKey||c.which!==1&&c.button!==1&&!c.touches)&&(zr._dragging=this,this._preventOutline&&Ti(this._element),$a(),Ct(),!this._moving)){this.fire("down");var p=c.touches?c.touches[0]:c,S=Ai(this._element);this._startPoint=new ie(p.clientX,p.clientY),this._startPos=Vr(this._element),this._parentScale=ri(S);var V=c.type==="mousedown";lt(document,V?"mousemove":"touchmove",this._onMove,this),lt(document,V?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(c){if(this._enabled){if(c.touches&&c.touches.length>1){this._moved=!0;return}var p=c.touches&&c.touches.length===1?c.touches[0]:c,S=new ie(p.clientX,p.clientY)._subtract(this._startPoint);!S.x&&!S.y||Math.abs(S.x)+Math.abs(S.y)<this.options.clickTolerance||(S.x/=this._parentScale.x,S.y/=this._parentScale.y,dn(c),this._moved||(this.fire("dragstart"),this._moved=!0,xt(document.body,"leaflet-dragging"),this._lastTarget=c.target||c.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),xt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(S),this._moving=!0,this._lastEvent=c,this._updatePosition())}},_updatePosition:function(){var c={originalEvent:this._lastEvent};this.fire("predrag",c),Tt(this._element,this._newPos),this.fire("drag",c)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(c){un(document.body,"leaflet-dragging"),this._lastTarget&&(un(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),tn(document,"mousemove touchmove",this._onMove,this),tn(document,"mouseup touchend touchcancel",this._onUp,this),Wa(),Si();var p=this._moved&&this._moving;this._moving=!1,zr._dragging=!1,p&&this.fire("dragend",{noInertia:c,distance:this._newPos.distanceTo(this._startPos)})}});function Qo(c,p,S){var V,W=[1,4,2,8],re,he,xe,Ee,Pe,$e,ut,Pt;for(re=0,$e=c.length;re<$e;re++)c[re]._code=ms(c[re],p);for(xe=0;xe<4;xe++){for(ut=W[xe],V=[],re=0,$e=c.length,he=$e-1;re<$e;he=re++)Ee=c[re],Pe=c[he],Ee._code&ut?Pe._code&ut||(Pt=rr(Pe,Ee,ut,p,S),Pt._code=ms(Pt,p),V.push(Pt)):(Pe._code&ut&&(Pt=rr(Pe,Ee,ut,p,S),Pt._code=ms(Pt,p),V.push(Pt)),V.push(Ee));c=V}return c}function Qa(c,p){var S,V,W,re,he,xe,Ee,Pe,$e;if(!c||c.length===0)throw new Error("latlngs not passed");w(c)||(console.warn("latlngs are not flat! Only the first ring will be used"),c=c[0]);var ut=Q([0,0]),Pt=se(c),cr=Pt.getNorthWest().distanceTo(Pt.getSouthWest())*Pt.getNorthEast().distanceTo(Pt.getNorthWest());cr<1700&&(ut=Xa(c));var ir=c.length,oi=[];for(S=0;S<ir;S++){var Ur=Q(c[S]);oi.push(p.project(Q([Ur.lat-ut.lat,Ur.lng-ut.lng])))}for(xe=Ee=Pe=0,S=0,V=ir-1;S<ir;V=S++)W=oi[S],re=oi[V],he=W.y*re.x-re.y*W.x,Ee+=(W.x+re.x)*he,Pe+=(W.y+re.y)*he,xe+=he*3;xe===0?$e=oi[0]:$e=[Ee/xe,Pe/xe];var dl=p.unproject(K($e));return Q([dl.lat+ut.lat,dl.lng+ut.lng])}function Xa(c){for(var p=0,S=0,V=0,W=0;W<c.length;W++){var re=Q(c[W]);p+=re.lat,S+=re.lng,V++}return Q([p/V,S/V])}var Ja={__proto__:null,clipPolygon:Qo,polygonCenter:Qa,centroid:Xa};function Xo(c,p){if(!p||!c.length)return c.slice();var S=p*p;return c=Au(c,S),c=Tu(c,S),c}function vc(c,p,S){return Math.sqrt(Br(c,p,S,!0))}function Ws(c,p,S){return Br(c,p,S)}function Tu(c,p){var S=c.length,V=typeof Uint8Array<"u"?Uint8Array:Array,W=new V(S);W[0]=W[S-1]=1,el(c,W,p,0,S-1);var re,he=[];for(re=0;re<S;re++)W[re]&&he.push(c[re]);return he}function el(c,p,S,V,W){var re=0,he,xe,Ee;for(xe=V+1;xe<=W-1;xe++)Ee=Br(c[xe],c[V],c[W],!0),Ee>re&&(he=xe,re=Ee);re>S&&(p[he]=1,el(c,p,S,V,he),el(c,p,S,he,W))}function Au(c,p){for(var S=[c[0]],V=1,W=0,re=c.length;V<re;V++)Nu(c[V],c[W])>p&&(S.push(c[V]),W=V);return W<re-1&&S.push(c[re-1]),S}var tl;function Jo(c,p,S,V,W){var re=V?tl:ms(c,S),he=ms(p,S),xe,Ee,Pe;for(tl=he;;){if(!(re|he))return[c,p];if(re&he)return!1;xe=re||he,Ee=rr(c,p,xe,S,W),Pe=ms(Ee,S),xe===re?(c=Ee,re=Pe):(p=Ee,he=Pe)}}function rr(c,p,S,V,W){var re=p.x-c.x,he=p.y-c.y,xe=V.min,Ee=V.max,Pe,$e;return S&8?(Pe=c.x+re*(Ee.y-c.y)/he,$e=Ee.y):S&4?(Pe=c.x+re*(xe.y-c.y)/he,$e=xe.y):S&2?(Pe=Ee.x,$e=c.y+he*(Ee.x-c.x)/re):S&1&&(Pe=xe.x,$e=c.y+he*(xe.x-c.x)/re),new ie(Pe,$e,W)}function ms(c,p){var S=0;return c.x<p.min.x?S|=1:c.x>p.max.x&&(S|=2),c.y<p.min.y?S|=4:c.y>p.max.y&&(S|=8),S}function Nu(c,p){var S=p.x-c.x,V=p.y-c.y;return S*S+V*V}function Br(c,p,S,V){var W=p.x,re=p.y,he=S.x-W,xe=S.y-re,Ee=he*he+xe*xe,Pe;return Ee>0&&(Pe=((c.x-W)*he+(c.y-re)*xe)/Ee,Pe>1?(W=S.x,re=S.y):Pe>0&&(W+=he*Pe,re+=xe*Pe)),he=c.x-W,xe=c.y-re,V?he*he+xe*xe:new ie(W,re)}function w(c){return!R(c[0])||typeof c[0][0]!="object"&&typeof c[0][0]<"u"}function q(c){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),w(c)}function Z(c,p){var S,V,W,re,he,xe,Ee,Pe;if(!c||c.length===0)throw new Error("latlngs not passed");w(c)||(console.warn("latlngs are not flat! Only the first ring will be used"),c=c[0]);var $e=Q([0,0]),ut=se(c),Pt=ut.getNorthWest().distanceTo(ut.getSouthWest())*ut.getNorthEast().distanceTo(ut.getNorthWest());Pt<1700&&($e=Xa(c));var cr=c.length,ir=[];for(S=0;S<cr;S++){var oi=Q(c[S]);ir.push(p.project(Q([oi.lat-$e.lat,oi.lng-$e.lng])))}for(S=0,V=0;S<cr-1;S++)V+=ir[S].distanceTo(ir[S+1])/2;if(V===0)Pe=ir[0];else for(S=0,re=0;S<cr-1;S++)if(he=ir[S],xe=ir[S+1],W=he.distanceTo(xe),re+=W,re>V){Ee=(re-V)/W,Pe=[xe.x-Ee*(xe.x-he.x),xe.y-Ee*(xe.y-he.y)];break}var Ur=p.unproject(K(Pe));return Q([Ur.lat+$e.lat,Ur.lng+$e.lng])}var ae={__proto__:null,simplify:Xo,pointToSegmentDistance:vc,closestPointOnSegment:Ws,clipSegment:Jo,_getEdgeIntersection:rr,_getBitCode:ms,_sqClosestPointOnSegment:Br,isFlat:w,_flat:q,polylineCenter:Z},ye={project:function(c){return new ie(c.lng,c.lat)},unproject:function(c){return new le(c.y,c.x)},bounds:new B([-180,-90],[180,90])},Te={R:6378137,R_MINOR:6356752314245179e-9,bounds:new B([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(c){var p=Math.PI/180,S=this.R,V=c.lat*p,W=this.R_MINOR/S,re=Math.sqrt(1-W*W),he=re*Math.sin(V),xe=Math.tan(Math.PI/4-V/2)/Math.pow((1-he)/(1+he),re/2);return V=-S*Math.log(Math.max(xe,1e-10)),new ie(c.lng*p*S,V)},unproject:function(c){for(var p=180/Math.PI,S=this.R,V=this.R_MINOR/S,W=Math.sqrt(1-V*V),re=Math.exp(-c.y/S),he=Math.PI/2-2*Math.atan(re),xe=0,Ee=.1,Pe;xe<15&&Math.abs(Ee)>1e-7;xe++)Pe=W*Math.sin(he),Pe=Math.pow((1-Pe)/(1+Pe),W/2),Ee=Math.PI/2-2*Math.atan(re*Pe)-he,he+=Ee;return new le(he*p,c.x*p/S)}},Be={__proto__:null,LonLat:ye,Mercator:Te,SphericalMercator:_e},en=i({},ue,{code:"EPSG:3395",projection:Te,transformation:function(){var c=.5/(Math.PI*Te.R);return qe(c,.5,-c,.5)}()}),Un=i({},ue,{code:"EPSG:4326",projection:ye,transformation:qe(1/180,1,-1/180,.5)}),Bt=i({},ce,{projection:ye,transformation:qe(1,0,-1,0),scale:function(c){return Math.pow(2,c)},zoom:function(c){return Math.log(c)/Math.LN2},distance:function(c,p){var S=p.lng-c.lng,V=p.lat-c.lat;return Math.sqrt(S*S+V*V)},infinite:!0});ce.Earth=ue,ce.EPSG3395=en,ce.EPSG3857=tt,ce.EPSG900913=yt,ce.EPSG4326=Un,ce.Simple=Bt;var nn=oe.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(c){return c.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(c){return c&&c.removeLayer(this),this},getPane:function(c){return this._map.getPane(c?this.options[c]||c:this.options.pane)},addInteractiveTarget:function(c){return this._map._targets[d(c)]=this,this},removeInteractiveTarget:function(c){return delete this._map._targets[d(c)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(c){var p=c.target;if(p.hasLayer(this)){if(this._map=p,this._zoomAnimated=p._zoomAnimated,this.getEvents){var S=this.getEvents();p.on(S,this),this.once("remove",function(){p.off(S,this)},this)}this.onAdd(p),this.fire("add"),p.fire("layeradd",{layer:this})}}});Rt.include({addLayer:function(c){if(!c._layerAdd)throw new Error("The provided object is not a Layer.");var p=d(c);return this._layers[p]?this:(this._layers[p]=c,c._mapToAdd=this,c.beforeAdd&&c.beforeAdd(this),this.whenReady(c._layerAdd,c),this)},removeLayer:function(c){var p=d(c);return this._layers[p]?(this._loaded&&c.onRemove(this),delete this._layers[p],this._loaded&&(this.fire("layerremove",{layer:c}),c.fire("remove")),c._map=c._mapToAdd=null,this):this},hasLayer:function(c){return d(c)in this._layers},eachLayer:function(c,p){for(var S in this._layers)c.call(p,this._layers[S]);return this},_addLayers:function(c){c=c?R(c)?c:[c]:[];for(var p=0,S=c.length;p<S;p++)this.addLayer(c[p])},_addZoomLimit:function(c){(!isNaN(c.options.maxZoom)||!isNaN(c.options.minZoom))&&(this._zoomBoundLayers[d(c)]=c,this._updateZoomLevels())},_removeZoomLimit:function(c){var p=d(c);this._zoomBoundLayers[p]&&(delete this._zoomBoundLayers[p],this._updateZoomLevels())},_updateZoomLevels:function(){var c=1/0,p=-1/0,S=this._getZoomSpan();for(var V in this._zoomBoundLayers){var W=this._zoomBoundLayers[V].options;c=W.minZoom===void 0?c:Math.min(c,W.minZoom),p=W.maxZoom===void 0?p:Math.max(p,W.maxZoom)}this._layersMaxZoom=p===-1/0?void 0:p,this._layersMinZoom=c===1/0?void 0:c,S!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var En=nn.extend({initialize:function(c,p){x(this,p),this._layers={};var S,V;if(c)for(S=0,V=c.length;S<V;S++)this.addLayer(c[S])},addLayer:function(c){var p=this.getLayerId(c);return this._layers[p]=c,this._map&&this._map.addLayer(c),this},removeLayer:function(c){var p=c in this._layers?c:this.getLayerId(c);return this._map&&this._layers[p]&&this._map.removeLayer(this._layers[p]),delete this._layers[p],this},hasLayer:function(c){var p=typeof c=="number"?c:this.getLayerId(c);return p in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(c){var p=Array.prototype.slice.call(arguments,1),S,V;for(S in this._layers)V=this._layers[S],V[c]&&V[c].apply(V,p);return this},onAdd:function(c){this.eachLayer(c.addLayer,c)},onRemove:function(c){this.eachLayer(c.removeLayer,c)},eachLayer:function(c,p){for(var S in this._layers)c.call(p,this._layers[S]);return this},getLayer:function(c){return this._layers[c]},getLayers:function(){var c=[];return this.eachLayer(c.push,c),c},setZIndex:function(c){return this.invoke("setZIndex",c)},getLayerId:function(c){return d(c)}}),ki=function(c,p){return new En(c,p)},Dn=En.extend({addLayer:function(c){return this.hasLayer(c)?this:(c.addEventParent(this),En.prototype.addLayer.call(this,c),this.fire("layeradd",{layer:c}))},removeLayer:function(c){return this.hasLayer(c)?(c in this._layers&&(c=this._layers[c]),c.removeEventParent(this),En.prototype.removeLayer.call(this,c),this.fire("layerremove",{layer:c})):this},setStyle:function(c){return this.invoke("setStyle",c)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var c=new X;for(var p in this._layers){var S=this._layers[p];c.extend(S.getBounds?S.getBounds():S.getLatLng())}return c}}),ea=function(c,p){return new Dn(c,p)},Zi=$.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(c){x(this,c)},createIcon:function(c){return this._createIcon("icon",c)},createShadow:function(c){return this._createIcon("shadow",c)},_createIcon:function(c,p){var S=this._getIconUrl(c);if(!S){if(c==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var V=this._createImg(S,p&&p.tagName==="IMG"?p:null);return this._setIconStyles(V,c),(this.options.crossOrigin||this.options.crossOrigin==="")&&(V.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),V},_setIconStyles:function(c,p){var S=this.options,V=S[p+"Size"];typeof V=="number"&&(V=[V,V]);var W=K(V),re=K(p==="shadow"&&S.shadowAnchor||S.iconAnchor||W&&W.divideBy(2,!0));c.className="leaflet-marker-"+p+" "+(S.className||""),re&&(c.style.marginLeft=-re.x+"px",c.style.marginTop=-re.y+"px"),W&&(c.style.width=W.x+"px",c.style.height=W.y+"px")},_createImg:function(c,p){return p=p||document.createElement("img"),p.src=c,p},_getIconUrl:function(c){return We.retina&&this.options[c+"RetinaUrl"]||this.options[c+"Url"]}});function Cm(c){return new Zi(c)}var nl=Zi.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(c){return typeof nl.imagePath!="string"&&(nl.imagePath=this._detectIconPath()),(this.options.imagePath||nl.imagePath)+Zi.prototype._getIconUrl.call(this,c)},_stripUrl:function(c){var p=function(S,V,W){var re=V.exec(S);return re&&re[W]};return c=p(c,/^url\((['"])?(.+)\1\)$/,2),c&&p(c,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var c=St("div","leaflet-default-icon-path",document.body),p=mo(c,"background-image")||mo(c,"backgroundImage");if(document.body.removeChild(c),p=this._stripUrl(p),p)return p;var S=document.querySelector('link[href$="leaflet.css"]');return S?S.href.substring(0,S.href.length-11-1):""}}),uh=Rr.extend({initialize:function(c){this._marker=c},addHooks:function(){var c=this._marker._icon;this._draggable||(this._draggable=new zr(c,c,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),xt(c,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&un(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(c){var p=this._marker,S=p._map,V=this._marker.options.autoPanSpeed,W=this._marker.options.autoPanPadding,re=Vr(p._icon),he=S.getPixelBounds(),xe=S.getPixelOrigin(),Ee=G(he.min._subtract(xe).add(W),he.max._subtract(xe).subtract(W));if(!Ee.contains(re)){var Pe=K((Math.max(Ee.max.x,re.x)-Ee.max.x)/(he.max.x-Ee.max.x)-(Math.min(Ee.min.x,re.x)-Ee.min.x)/(he.min.x-Ee.min.x),(Math.max(Ee.max.y,re.y)-Ee.max.y)/(he.max.y-Ee.max.y)-(Math.min(Ee.min.y,re.y)-Ee.min.y)/(he.min.y-Ee.min.y)).multiplyBy(V);S.panBy(Pe,{animate:!1}),this._draggable._newPos._add(Pe),this._draggable._startPos._add(Pe),Tt(p._icon,this._draggable._newPos),this._onDrag(c),this._panRequest=P(this._adjustPan.bind(this,c))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(c){this._marker.options.autoPan&&(F(this._panRequest),this._panRequest=P(this._adjustPan.bind(this,c)))},_onDrag:function(c){var p=this._marker,S=p._shadow,V=Vr(p._icon),W=p._map.layerPointToLatLng(V);S&&Tt(S,V),p._latlng=W,c.latlng=W,c.oldLatLng=this._oldLatLng,p.fire("move",c).fire("drag",c)},_onDragEnd:function(c){F(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",c)}}),Gs=nn.extend({options:{icon:new nl,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(c,p){x(this,p),this._latlng=Q(c)},onAdd:function(c){this._zoomAnimated=this._zoomAnimated&&c.options.markerZoomAnimation,this._zoomAnimated&&c.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(c){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&c.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(c){var p=this._latlng;return this._latlng=Q(c),this.update(),this.fire("move",{oldLatLng:p,latlng:this._latlng})},setZIndexOffset:function(c){return this.options.zIndexOffset=c,this.update()},getIcon:function(){return this.options.icon},setIcon:function(c){return this.options.icon=c,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var c=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(c)}return this},_initIcon:function(){var c=this.options,p="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),S=c.icon.createIcon(this._icon),V=!1;S!==this._icon&&(this._icon&&this._removeIcon(),V=!0,c.title&&(S.title=c.title),S.tagName==="IMG"&&(S.alt=c.alt||"")),xt(S,p),c.keyboard&&(S.tabIndex="0",S.setAttribute("role","button")),this._icon=S,c.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&lt(S,"focus",this._panOnFocus,this);var W=c.icon.createShadow(this._shadow),re=!1;W!==this._shadow&&(this._removeShadow(),re=!0),W&&(xt(W,p),W.alt=""),this._shadow=W,c.opacity<1&&this._updateOpacity(),V&&this.getPane().appendChild(this._icon),this._initInteraction(),W&&re&&this.getPane(c.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&tn(this._icon,"focus",this._panOnFocus,this),cn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&cn(this._shadow),this._shadow=null},_setPos:function(c){this._icon&&Tt(this._icon,c),this._shadow&&Tt(this._shadow,c),this._zIndex=c.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(c){this._icon&&(this._icon.style.zIndex=this._zIndex+c)},_animateZoom:function(c){var p=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center).round();this._setPos(p)},_initInteraction:function(){if(this.options.interactive&&(xt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),uh)){var c=this.options.draggable;this.dragging&&(c=this.dragging.enabled(),this.dragging.disable()),this.dragging=new uh(this),c&&this.dragging.enable()}},setOpacity:function(c){return this.options.opacity=c,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var c=this.options.opacity;this._icon&&Sn(this._icon,c),this._shadow&&Sn(this._shadow,c)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var c=this._map;if(c){var p=this.options.icon.options,S=p.iconSize?K(p.iconSize):K(0,0),V=p.iconAnchor?K(p.iconAnchor):K(0,0);c.panInside(this._latlng,{paddingTopLeft:V,paddingBottomRight:S.subtract(V)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function y0(c,p){return new Gs(c,p)}var vo=nn.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(c){this._renderer=c.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(c){return x(this,c),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&c&&Object.prototype.hasOwnProperty.call(c,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Iu=vo.extend({options:{fill:!0,radius:10},initialize:function(c,p){x(this,p),this._latlng=Q(c),this._radius=this.options.radius},setLatLng:function(c){var p=this._latlng;return this._latlng=Q(c),this.redraw(),this.fire("move",{oldLatLng:p,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(c){return this.options.radius=this._radius=c,this.redraw()},getRadius:function(){return this._radius},setStyle:function(c){var p=c&&c.radius||this._radius;return vo.prototype.setStyle.call(this,c),this.setRadius(p),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var c=this._radius,p=this._radiusY||c,S=this._clickTolerance(),V=[c+S,p+S];this._pxBounds=new B(this._point.subtract(V),this._point.add(V))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(c){return c.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Rm(c,p){return new Iu(c,p)}var ku=Iu.extend({initialize:function(c,p,S){if(typeof p=="number"&&(p=i({},S,{radius:p})),x(this,p),this._latlng=Q(c),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(c){return this._mRadius=c,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var c=[this._radius,this._radiusY||this._radius];return new X(this._map.layerPointToLatLng(this._point.subtract(c)),this._map.layerPointToLatLng(this._point.add(c)))},setStyle:vo.prototype.setStyle,_project:function(){var c=this._latlng.lng,p=this._latlng.lat,S=this._map,V=S.options.crs;if(V.distance===ue.distance){var W=Math.PI/180,re=this._mRadius/ue.R/W,he=S.project([p+re,c]),xe=S.project([p-re,c]),Ee=he.add(xe).divideBy(2),Pe=S.unproject(Ee).lat,$e=Math.acos((Math.cos(re*W)-Math.sin(p*W)*Math.sin(Pe*W))/(Math.cos(p*W)*Math.cos(Pe*W)))/W;(isNaN($e)||$e===0)&&($e=re/Math.cos(Math.PI/180*p)),this._point=Ee.subtract(S.getPixelOrigin()),this._radius=isNaN($e)?0:Ee.x-S.project([Pe,c-$e]).x,this._radiusY=Ee.y-he.y}else{var ut=V.unproject(V.project(this._latlng).subtract([this._mRadius,0]));this._point=S.latLngToLayerPoint(this._latlng),this._radius=this._point.x-S.latLngToLayerPoint(ut).x}this._updateBounds()}});function _c(c,p,S){return new ku(c,p,S)}var si=vo.extend({options:{smoothFactor:1,noClip:!1},initialize:function(c,p){x(this,p),this._setLatLngs(c)},getLatLngs:function(){return this._latlngs},setLatLngs:function(c){return this._setLatLngs(c),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(c){for(var p=1/0,S=null,V=Br,W,re,he=0,xe=this._parts.length;he<xe;he++)for(var Ee=this._parts[he],Pe=1,$e=Ee.length;Pe<$e;Pe++){W=Ee[Pe-1],re=Ee[Pe];var ut=V(c,W,re,!0);ut<p&&(p=ut,S=V(c,W,re))}return S&&(S.distance=Math.sqrt(p)),S},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Z(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(c,p){return p=p||this._defaultShape(),c=Q(c),p.push(c),this._bounds.extend(c),this.redraw()},_setLatLngs:function(c){this._bounds=new X,this._latlngs=this._convertLatLngs(c)},_defaultShape:function(){return w(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(c){for(var p=[],S=w(c),V=0,W=c.length;V<W;V++)S?(p[V]=Q(c[V]),this._bounds.extend(p[V])):p[V]=this._convertLatLngs(c[V]);return p},_project:function(){var c=new B;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,c),this._bounds.isValid()&&c.isValid()&&(this._rawPxBounds=c,this._updateBounds())},_updateBounds:function(){var c=this._clickTolerance(),p=new ie(c,c);this._rawPxBounds&&(this._pxBounds=new B([this._rawPxBounds.min.subtract(p),this._rawPxBounds.max.add(p)]))},_projectLatlngs:function(c,p,S){var V=c[0]instanceof le,W=c.length,re,he;if(V){for(he=[],re=0;re<W;re++)he[re]=this._map.latLngToLayerPoint(c[re]),S.extend(he[re]);p.push(he)}else for(re=0;re<W;re++)this._projectLatlngs(c[re],p,S)},_clipPoints:function(){var c=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(c))){if(this.options.noClip){this._parts=this._rings;return}var p=this._parts,S,V,W,re,he,xe,Ee;for(S=0,W=0,re=this._rings.length;S<re;S++)for(Ee=this._rings[S],V=0,he=Ee.length;V<he-1;V++)xe=Jo(Ee[V],Ee[V+1],c,V,!0),xe&&(p[W]=p[W]||[],p[W].push(xe[0]),(xe[1]!==Ee[V+1]||V===he-2)&&(p[W].push(xe[1]),W++))}},_simplifyPoints:function(){for(var c=this._parts,p=this.options.smoothFactor,S=0,V=c.length;S<V;S++)c[S]=Xo(c[S],p)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(c,p){var S,V,W,re,he,xe,Ee=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(c))return!1;for(S=0,re=this._parts.length;S<re;S++)for(xe=this._parts[S],V=0,he=xe.length,W=he-1;V<he;W=V++)if(!(!p&&V===0)&&vc(c,xe[W],xe[V])<=Ee)return!0;return!1}});function v0(c,p){return new si(c,p)}si._flat=q;var Ks=si.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Qa(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(c){var p=si.prototype._convertLatLngs.call(this,c),S=p.length;return S>=2&&p[0]instanceof le&&p[0].equals(p[S-1])&&p.pop(),p},_setLatLngs:function(c){si.prototype._setLatLngs.call(this,c),w(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return w(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var c=this._renderer._bounds,p=this.options.weight,S=new ie(p,p);if(c=new B(c.min.subtract(S),c.max.add(S)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(c))){if(this.options.noClip){this._parts=this._rings;return}for(var V=0,W=this._rings.length,re;V<W;V++)re=Qo(this._rings[V],c,!0),re.length&&this._parts.push(re)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(c){var p=!1,S,V,W,re,he,xe,Ee,Pe;if(!this._pxBounds||!this._pxBounds.contains(c))return!1;for(re=0,Ee=this._parts.length;re<Ee;re++)for(S=this._parts[re],he=0,Pe=S.length,xe=Pe-1;he<Pe;xe=he++)V=S[he],W=S[xe],V.y>c.y!=W.y>c.y&&c.x<(W.x-V.x)*(c.y-V.y)/(W.y-V.y)+V.x&&(p=!p);return p||si.prototype._containsPoint.call(this,c,!0)}});function _0(c,p){return new Ks(c,p)}var ps=Dn.extend({initialize:function(c,p){x(this,p),this._layers={},c&&this.addData(c)},addData:function(c){var p=R(c)?c:c.features,S,V,W;if(p){for(S=0,V=p.length;S<V;S++)W=p[S],(W.geometries||W.geometry||W.features||W.coordinates)&&this.addData(W);return this}var re=this.options;if(re.filter&&!re.filter(c))return this;var he=rl(c,re);return he?(he.feature=Ou(c),he.defaultOptions=he.options,this.resetStyle(he),re.onEachFeature&&re.onEachFeature(c,he),this.addLayer(he)):this},resetStyle:function(c){return c===void 0?this.eachLayer(this.resetStyle,this):(c.options=i({},c.defaultOptions),this._setLayerStyle(c,this.options.style),this)},setStyle:function(c){return this.eachLayer(function(p){this._setLayerStyle(p,c)},this)},_setLayerStyle:function(c,p){c.setStyle&&(typeof p=="function"&&(p=p(c.feature)),c.setStyle(p))}});function rl(c,p){var S=c.type==="Feature"?c.geometry:c,V=S?S.coordinates:null,W=[],re=p&&p.pointToLayer,he=p&&p.coordsToLatLng||Cu,xe,Ee,Pe,$e;if(!V&&!S)return null;switch(S.type){case"Point":return xe=he(V),Pu(re,c,xe,p);case"MultiPoint":for(Pe=0,$e=V.length;Pe<$e;Pe++)xe=he(V[Pe]),W.push(Pu(re,c,xe,p));return new Dn(W);case"LineString":case"MultiLineString":return Ee=xc(V,S.type==="LineString"?0:1,he),new si(Ee,p);case"Polygon":case"MultiPolygon":return Ee=xc(V,S.type==="Polygon"?1:2,he),new Ks(Ee,p);case"GeometryCollection":for(Pe=0,$e=S.geometries.length;Pe<$e;Pe++){var ut=rl({geometry:S.geometries[Pe],type:"Feature",properties:c.properties},p);ut&&W.push(ut)}return new Dn(W);case"FeatureCollection":for(Pe=0,$e=S.features.length;Pe<$e;Pe++){var Pt=rl(S.features[Pe],p);Pt&&W.push(Pt)}return new Dn(W);default:throw new Error("Invalid GeoJSON object.")}}function Pu(c,p,S,V){return c?c(p,S):new Gs(S,V&&V.markersInheritOptions&&V)}function Cu(c){return new le(c[1],c[0],c[2])}function xc(c,p,S){for(var V=[],W=0,re=c.length,he;W<re;W++)he=p?xc(c[W],p-1,S):(S||Cu)(c[W]),V.push(he);return V}function Ru(c,p){return c=Q(c),c.alt!==void 0?[g(c.lng,p),g(c.lat,p),g(c.alt,p)]:[g(c.lng,p),g(c.lat,p)]}function ju(c,p,S,V){for(var W=[],re=0,he=c.length;re<he;re++)W.push(p?ju(c[re],w(c[re])?0:p-1,S,V):Ru(c[re],V));return!p&&S&&W.length>0&&W.push(W[0].slice()),W}function il(c,p){return c.feature?i({},c.feature,{geometry:p}):Ou(p)}function Ou(c){return c.type==="Feature"||c.type==="FeatureCollection"?c:{type:"Feature",properties:{},geometry:c}}var dh={toGeoJSON:function(c){return il(this,{type:"Point",coordinates:Ru(this.getLatLng(),c)})}};Gs.include(dh),ku.include(dh),Iu.include(dh),si.include({toGeoJSON:function(c){var p=!w(this._latlngs),S=ju(this._latlngs,p?1:0,!1,c);return il(this,{type:(p?"Multi":"")+"LineString",coordinates:S})}}),Ks.include({toGeoJSON:function(c){var p=!w(this._latlngs),S=p&&!w(this._latlngs[0]),V=ju(this._latlngs,S?2:p?1:0,!0,c);return p||(V=[V]),il(this,{type:(S?"Multi":"")+"Polygon",coordinates:V})}}),En.include({toMultiPoint:function(c){var p=[];return this.eachLayer(function(S){p.push(S.toGeoJSON(c).geometry.coordinates)}),il(this,{type:"MultiPoint",coordinates:p})},toGeoJSON:function(c){var p=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(p==="MultiPoint")return this.toMultiPoint(c);var S=p==="GeometryCollection",V=[];return this.eachLayer(function(W){if(W.toGeoJSON){var re=W.toGeoJSON(c);if(S)V.push(re.geometry);else{var he=Ou(re);he.type==="FeatureCollection"?V.push.apply(V,he.features):V.push(he)}}}),S?il(this,{geometries:V,type:"GeometryCollection"}):{type:"FeatureCollection",features:V}}});function jm(c,p){return new ps(c,p)}var Qi=jm,_o=nn.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(c,p,S){this._url=c,this._bounds=se(p),x(this,S)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(xt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){cn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(c){return this.options.opacity=c,this._image&&this._updateOpacity(),this},setStyle:function(c){return c.opacity&&this.setOpacity(c.opacity),this},bringToFront:function(){return this._map&&Bs(this._image),this},bringToBack:function(){return this._map&&Gi(this._image),this},setUrl:function(c){return this._url=c,this._image&&(this._image.src=c),this},setBounds:function(c){return this._bounds=se(c),this._map&&this._reset(),this},getEvents:function(){var c={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},setZIndex:function(c){return this.options.zIndex=c,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var c=this._url.tagName==="IMG",p=this._image=c?this._url:St("img");if(xt(p,"leaflet-image-layer"),this._zoomAnimated&&xt(p,"leaflet-zoom-animated"),this.options.className&&xt(p,this.options.className),p.onselectstart=y,p.onmousemove=y,p.onload=o(this.fire,this,"load"),p.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(p.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),c){this._url=p.src;return}p.src=this._url,p.alt=this.options.alt},_animateZoom:function(c){var p=this._map.getZoomScale(c.zoom),S=this._map._latLngBoundsToNewLayerBounds(this._bounds,c.zoom,c.center).min;Fr(this._image,S,p)},_reset:function(){var c=this._image,p=new B(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),S=p.getSize();Tt(c,p.min),c.style.width=S.x+"px",c.style.height=S.y+"px"},_updateOpacity:function(){Sn(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var c=this.options.errorOverlayUrl;c&&this._url!==c&&(this._url=c,this._image.src=c)},getCenter:function(){return this._bounds.getCenter()}}),Om=function(c,p,S){return new _o(c,p,S)},hh=_o.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var c=this._url.tagName==="VIDEO",p=this._image=c?this._url:St("video");if(xt(p,"leaflet-image-layer"),this._zoomAnimated&&xt(p,"leaflet-zoom-animated"),this.options.className&&xt(p,this.options.className),p.onselectstart=y,p.onmousemove=y,p.onloadeddata=o(this.fire,this,"load"),c){for(var S=p.getElementsByTagName("source"),V=[],W=0;W<S.length;W++)V.push(S[W].src);this._url=S.length>0?V:[p.src];return}R(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(p.style,"objectFit")&&(p.style.objectFit="fill"),p.autoplay=!!this.options.autoplay,p.loop=!!this.options.loop,p.muted=!!this.options.muted,p.playsInline=!!this.options.playsInline;for(var re=0;re<this._url.length;re++){var he=St("source");he.src=this._url[re],p.appendChild(he)}}});function Mm(c,p,S){return new hh(c,p,S)}var fh=_o.extend({_initImage:function(){var c=this._image=this._url;xt(c,"leaflet-image-layer"),this._zoomAnimated&&xt(c,"leaflet-zoom-animated"),this.options.className&&xt(c,this.options.className),c.onselectstart=y,c.onmousemove=y}});function mh(c,p,S){return new fh(c,p,S)}var gs=nn.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(c,p){c&&(c instanceof le||R(c))?(this._latlng=Q(c),x(this,p)):(x(this,c),this._source=p),this.options.content&&(this._content=this.options.content)},openOn:function(c){return c=arguments.length?c:this._source._map,c.hasLayer(this)||c.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(c){return this._map?this.close():(arguments.length?this._source=c:c=this._source,this._prepareOpen(),this.openOn(c._map)),this},onAdd:function(c){this._zoomAnimated=c._zoomAnimated,this._container||this._initLayout(),c._fadeAnimated&&Sn(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),c._fadeAnimated&&Sn(this._container,1),this.bringToFront(),this.options.interactive&&(xt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(c){c._fadeAnimated?(Sn(this._container,0),this._removeTimeout=setTimeout(o(cn,void 0,this._container),200)):cn(this._container),this.options.interactive&&(un(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(c){return this._latlng=Q(c),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(c){return this._content=c,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var c={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Bs(this._container),this},bringToBack:function(){return this._map&&Gi(this._container),this},_prepareOpen:function(c){var p=this._source;if(!p._map)return!1;if(p instanceof Dn){p=null;var S=this._source._layers;for(var V in S)if(S[V]._map){p=S[V];break}if(!p)return!1;this._source=p}if(!c)if(p.getCenter)c=p.getCenter();else if(p.getLatLng)c=p.getLatLng();else if(p.getBounds)c=p.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(c),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var c=this._contentNode,p=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof p=="string")c.innerHTML=p;else{for(;c.hasChildNodes();)c.removeChild(c.firstChild);c.appendChild(p)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var c=this._map.latLngToLayerPoint(this._latlng),p=K(this.options.offset),S=this._getAnchor();this._zoomAnimated?Tt(this._container,c.add(S)):p=p.add(c).add(S);var V=this._containerBottom=-p.y,W=this._containerLeft=-Math.round(this._containerWidth/2)+p.x;this._container.style.bottom=V+"px",this._container.style.left=W+"px"}},_getAnchor:function(){return[0,0]}});Rt.include({_initOverlay:function(c,p,S,V){var W=p;return W instanceof c||(W=new c(V).setContent(p)),S&&W.setLatLng(S),W}}),nn.include({_initOverlay:function(c,p,S,V){var W=S;return W instanceof c?(x(W,V),W._source=this):(W=p&&!V?p:new c(V,this),W.setContent(S)),W}});var Mu=gs.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(c){return c=arguments.length?c:this._source._map,!c.hasLayer(this)&&c._popup&&c._popup.options.autoClose&&c.removeLayer(c._popup),c._popup=this,gs.prototype.openOn.call(this,c)},onAdd:function(c){gs.prototype.onAdd.call(this,c),c.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof vo||this._source.on("preclick",Cr))},onRemove:function(c){gs.prototype.onRemove.call(this,c),c.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof vo||this._source.off("preclick",Cr))},getEvents:function(){var c=gs.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(c.preclick=this.close),this.options.keepInView&&(c.moveend=this._adjustPan),c},_initLayout:function(){var c="leaflet-popup",p=this._container=St("div",c+" "+(this.options.className||"")+" leaflet-zoom-animated"),S=this._wrapper=St("div",c+"-content-wrapper",p);if(this._contentNode=St("div",c+"-content",S),yo(p),Us(this._contentNode),lt(p,"contextmenu",Cr),this._tipContainer=St("div",c+"-tip-container",p),this._tip=St("div",c+"-tip",this._tipContainer),this.options.closeButton){var V=this._closeButton=St("a",c+"-close-button",p);V.setAttribute("role","button"),V.setAttribute("aria-label","Close popup"),V.href="#close",V.innerHTML='<span aria-hidden="true">&#215;</span>',lt(V,"click",function(W){dn(W),this.close()},this)}},_updateLayout:function(){var c=this._contentNode,p=c.style;p.width="",p.whiteSpace="nowrap";var S=c.offsetWidth;S=Math.min(S,this.options.maxWidth),S=Math.max(S,this.options.minWidth),p.width=S+1+"px",p.whiteSpace="",p.height="";var V=c.offsetHeight,W=this.options.maxHeight,re="leaflet-popup-scrolled";W&&V>W?(p.height=W+"px",xt(c,re)):un(c,re),this._containerWidth=this._container.offsetWidth},_animateZoom:function(c){var p=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center),S=this._getAnchor();Tt(this._container,p.add(S))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var c=this._map,p=parseInt(mo(this._container,"marginBottom"),10)||0,S=this._container.offsetHeight+p,V=this._containerWidth,W=new ie(this._containerLeft,-S-this._containerBottom);W._add(Vr(this._container));var re=c.layerPointToContainerPoint(W),he=K(this.options.autoPanPadding),xe=K(this.options.autoPanPaddingTopLeft||he),Ee=K(this.options.autoPanPaddingBottomRight||he),Pe=c.getSize(),$e=0,ut=0;re.x+V+Ee.x>Pe.x&&($e=re.x+V-Pe.x+Ee.x),re.x-$e-xe.x<0&&($e=re.x-xe.x),re.y+S+Ee.y>Pe.y&&(ut=re.y+S-Pe.y+Ee.y),re.y-ut-xe.y<0&&(ut=re.y-xe.y),($e||ut)&&(this.options.keepInView&&(this._autopanning=!0),c.fire("autopanstart").panBy([$e,ut]))}},_getAnchor:function(){return K(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),sl=function(c,p){return new Mu(c,p)};Rt.mergeOptions({closePopupOnClick:!0}),Rt.include({openPopup:function(c,p,S){return this._initOverlay(Mu,c,p,S).openOn(this),this},closePopup:function(c){return c=arguments.length?c:this._popup,c&&c.close(),this}}),nn.include({bindPopup:function(c,p){return this._popup=this._initOverlay(Mu,this._popup,c,p),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(c){return this._popup&&(this instanceof Dn||(this._popup._source=this),this._popup._prepareOpen(c||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(c){return this._popup&&this._popup.setContent(c),this},getPopup:function(){return this._popup},_openPopup:function(c){if(!(!this._popup||!this._map)){lr(c);var p=c.layer||c.target;if(this._popup._source===p&&!(p instanceof vo)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(c.latlng);return}this._popup._source=p,this.openPopup(c.latlng)}},_movePopup:function(c){this._popup.setLatLng(c.latlng)},_onKeyPress:function(c){c.originalEvent.keyCode===13&&this._openPopup(c)}});var ol=gs.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(c){gs.prototype.onAdd.call(this,c),this.setOpacity(this.options.opacity),c.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(c){gs.prototype.onRemove.call(this,c),c.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var c=gs.prototype.getEvents.call(this);return this.options.permanent||(c.preclick=this.close),c},_initLayout:function(){var c="leaflet-tooltip",p=c+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=St("div",p),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+d(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(c){var p,S,V=this._map,W=this._container,re=V.latLngToContainerPoint(V.getCenter()),he=V.layerPointToContainerPoint(c),xe=this.options.direction,Ee=W.offsetWidth,Pe=W.offsetHeight,$e=K(this.options.offset),ut=this._getAnchor();xe==="top"?(p=Ee/2,S=Pe):xe==="bottom"?(p=Ee/2,S=0):xe==="center"?(p=Ee/2,S=Pe/2):xe==="right"?(p=0,S=Pe/2):xe==="left"?(p=Ee,S=Pe/2):he.x<re.x?(xe="right",p=0,S=Pe/2):(xe="left",p=Ee+($e.x+ut.x)*2,S=Pe/2),c=c.subtract(K(p,S,!0)).add($e).add(ut),un(W,"leaflet-tooltip-right"),un(W,"leaflet-tooltip-left"),un(W,"leaflet-tooltip-top"),un(W,"leaflet-tooltip-bottom"),xt(W,"leaflet-tooltip-"+xe),Tt(W,c)},_updatePosition:function(){var c=this._map.latLngToLayerPoint(this._latlng);this._setPosition(c)},setOpacity:function(c){this.options.opacity=c,this._container&&Sn(this._container,c)},_animateZoom:function(c){var p=this._map._latLngToNewLayerPoint(this._latlng,c.zoom,c.center);this._setPosition(p)},_getAnchor:function(){return K(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),bc=function(c,p){return new ol(c,p)};Rt.include({openTooltip:function(c,p,S){return this._initOverlay(ol,c,p,S).openOn(this),this},closeTooltip:function(c){return c.close(),this}}),nn.include({bindTooltip:function(c,p){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(ol,this._tooltip,c,p),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(c){if(!(!c&&this._tooltipHandlersAdded)){var p=c?"off":"on",S={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?S.add=this._openTooltip:(S.mouseover=this._openTooltip,S.mouseout=this.closeTooltip,S.click=this._openTooltip,this._map?this._addFocusListeners():S.add=this._addFocusListeners),this._tooltip.options.sticky&&(S.mousemove=this._moveTooltip),this[p](S),this._tooltipHandlersAdded=!c}},openTooltip:function(c){return this._tooltip&&(this instanceof Dn||(this._tooltip._source=this),this._tooltip._prepareOpen(c)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(c){return this._tooltip&&this._tooltip.setContent(c),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(c){var p=typeof c.getElement=="function"&&c.getElement();p&&(lt(p,"focus",function(){this._tooltip._source=c,this.openTooltip()},this),lt(p,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(c){var p=typeof c.getElement=="function"&&c.getElement();p&&p.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(c){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var p=this;this._map.once("moveend",function(){p._openOnceFlag=!1,p._openTooltip(c)});return}this._tooltip._source=c.layer||c.target,this.openTooltip(this._tooltip.options.sticky?c.latlng:void 0)}},_moveTooltip:function(c){var p=c.latlng,S,V;this._tooltip.options.sticky&&c.originalEvent&&(S=this._map.mouseEventToContainerPoint(c.originalEvent),V=this._map.containerPointToLayerPoint(S),p=this._map.layerPointToLatLng(V)),this._tooltip.setLatLng(p)}});var Du=Zi.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(c){var p=c&&c.tagName==="DIV"?c:document.createElement("div"),S=this.options;if(S.html instanceof Element?(Ho(p),p.appendChild(S.html)):p.innerHTML=S.html!==!1?S.html:"",S.bgPos){var V=K(S.bgPos);p.style.backgroundPosition=-V.x+"px "+-V.y+"px"}return this._setIconStyles(p,"icon"),p},createShadow:function(){return null}});function Dm(c){return new Du(c)}Zi.Default=nl;var xo=nn.extend({options:{tileSize:256,opacity:1,updateWhenIdle:We.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(c){x(this,c)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(c){c._addZoomLimit(this)},onRemove:function(c){this._removeAllTiles(),cn(this._container),c._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Bs(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(Gi(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(c){return this.options.opacity=c,this._updateOpacity(),this},setZIndex:function(c){return this.options.zIndex=c,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var c=this._clampZoom(this._map.getZoom());c!==this._tileZoom&&(this._tileZoom=c,this._updateLevels()),this._update()}return this},getEvents:function(){var c={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=f(this._onMoveEnd,this.options.updateInterval,this)),c.move=this._onMove),this._zoomAnimated&&(c.zoomanim=this._animateZoom),c},createTile:function(){return document.createElement("div")},getTileSize:function(){var c=this.options.tileSize;return c instanceof ie?c:new ie(c,c)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(c){for(var p=this.getPane().children,S=-c(-1/0,1/0),V=0,W=p.length,re;V<W;V++)re=p[V].style.zIndex,p[V]!==this._container&&re&&(S=c(S,+re));isFinite(S)&&(this.options.zIndex=S+c(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!We.ielt9){Sn(this._container,this.options.opacity);var c=+new Date,p=!1,S=!1;for(var V in this._tiles){var W=this._tiles[V];if(!(!W.current||!W.loaded)){var re=Math.min(1,(c-W.loaded)/200);Sn(W.el,re),re<1?p=!0:(W.active?S=!0:this._onOpaqueTile(W),W.active=!0)}}S&&!this._noPrune&&this._pruneTiles(),p&&(F(this._fadeFrame),this._fadeFrame=P(this._updateOpacity,this))}},_onOpaqueTile:y,_initContainer:function(){this._container||(this._container=St("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var c=this._tileZoom,p=this.options.maxZoom;if(c!==void 0){for(var S in this._levels)S=Number(S),this._levels[S].el.children.length||S===c?(this._levels[S].el.style.zIndex=p-Math.abs(c-S),this._onUpdateLevel(S)):(cn(this._levels[S].el),this._removeTilesAtZoom(S),this._onRemoveLevel(S),delete this._levels[S]);var V=this._levels[c],W=this._map;return V||(V=this._levels[c]={},V.el=St("div","leaflet-tile-container leaflet-zoom-animated",this._container),V.el.style.zIndex=p,V.origin=W.project(W.unproject(W.getPixelOrigin()),c).round(),V.zoom=c,this._setZoomTransform(V,W.getCenter(),W.getZoom()),y(V.el.offsetWidth),this._onCreateLevel(V)),this._level=V,V}},_onUpdateLevel:y,_onRemoveLevel:y,_onCreateLevel:y,_pruneTiles:function(){if(this._map){var c,p,S=this._map.getZoom();if(S>this.options.maxZoom||S<this.options.minZoom){this._removeAllTiles();return}for(c in this._tiles)p=this._tiles[c],p.retain=p.current;for(c in this._tiles)if(p=this._tiles[c],p.current&&!p.active){var V=p.coords;this._retainParent(V.x,V.y,V.z,V.z-5)||this._retainChildren(V.x,V.y,V.z,V.z+2)}for(c in this._tiles)this._tiles[c].retain||this._removeTile(c)}},_removeTilesAtZoom:function(c){for(var p in this._tiles)this._tiles[p].coords.z===c&&this._removeTile(p)},_removeAllTiles:function(){for(var c in this._tiles)this._removeTile(c)},_invalidateAll:function(){for(var c in this._levels)cn(this._levels[c].el),this._onRemoveLevel(Number(c)),delete this._levels[c];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(c,p,S,V){var W=Math.floor(c/2),re=Math.floor(p/2),he=S-1,xe=new ie(+W,+re);xe.z=+he;var Ee=this._tileCoordsToKey(xe),Pe=this._tiles[Ee];return Pe&&Pe.active?(Pe.retain=!0,!0):(Pe&&Pe.loaded&&(Pe.retain=!0),he>V?this._retainParent(W,re,he,V):!1)},_retainChildren:function(c,p,S,V){for(var W=2*c;W<2*c+2;W++)for(var re=2*p;re<2*p+2;re++){var he=new ie(W,re);he.z=S+1;var xe=this._tileCoordsToKey(he),Ee=this._tiles[xe];if(Ee&&Ee.active){Ee.retain=!0;continue}else Ee&&Ee.loaded&&(Ee.retain=!0);S+1<V&&this._retainChildren(W,re,S+1,V)}},_resetView:function(c){var p=c&&(c.pinch||c.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),p,p)},_animateZoom:function(c){this._setView(c.center,c.zoom,!0,c.noUpdate)},_clampZoom:function(c){var p=this.options;return p.minNativeZoom!==void 0&&c<p.minNativeZoom?p.minNativeZoom:p.maxNativeZoom!==void 0&&p.maxNativeZoom<c?p.maxNativeZoom:c},_setView:function(c,p,S,V){var W=Math.round(p);this.options.maxZoom!==void 0&&W>this.options.maxZoom||this.options.minZoom!==void 0&&W<this.options.minZoom?W=void 0:W=this._clampZoom(W);var re=this.options.updateWhenZooming&&W!==this._tileZoom;(!V||re)&&(this._tileZoom=W,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),W!==void 0&&this._update(c),S||this._pruneTiles(),this._noPrune=!!S),this._setZoomTransforms(c,p)},_setZoomTransforms:function(c,p){for(var S in this._levels)this._setZoomTransform(this._levels[S],c,p)},_setZoomTransform:function(c,p,S){var V=this._map.getZoomScale(S,c.zoom),W=c.origin.multiplyBy(V).subtract(this._map._getNewPixelOrigin(p,S)).round();We.any3d?Fr(c.el,W,V):Tt(c.el,W)},_resetGrid:function(){var c=this._map,p=c.options.crs,S=this._tileSize=this.getTileSize(),V=this._tileZoom,W=this._map.getPixelWorldBounds(this._tileZoom);W&&(this._globalTileRange=this._pxBoundsToTileRange(W)),this._wrapX=p.wrapLng&&!this.options.noWrap&&[Math.floor(c.project([0,p.wrapLng[0]],V).x/S.x),Math.ceil(c.project([0,p.wrapLng[1]],V).x/S.y)],this._wrapY=p.wrapLat&&!this.options.noWrap&&[Math.floor(c.project([p.wrapLat[0],0],V).y/S.x),Math.ceil(c.project([p.wrapLat[1],0],V).y/S.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(c){var p=this._map,S=p._animatingZoom?Math.max(p._animateToZoom,p.getZoom()):p.getZoom(),V=p.getZoomScale(S,this._tileZoom),W=p.project(c,this._tileZoom).floor(),re=p.getSize().divideBy(V*2);return new B(W.subtract(re),W.add(re))},_update:function(c){var p=this._map;if(p){var S=this._clampZoom(p.getZoom());if(c===void 0&&(c=p.getCenter()),this._tileZoom!==void 0){var V=this._getTiledPixelBounds(c),W=this._pxBoundsToTileRange(V),re=W.getCenter(),he=[],xe=this.options.keepBuffer,Ee=new B(W.getBottomLeft().subtract([xe,-xe]),W.getTopRight().add([xe,-xe]));if(!(isFinite(W.min.x)&&isFinite(W.min.y)&&isFinite(W.max.x)&&isFinite(W.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Pe in this._tiles){var $e=this._tiles[Pe].coords;($e.z!==this._tileZoom||!Ee.contains(new ie($e.x,$e.y)))&&(this._tiles[Pe].current=!1)}if(Math.abs(S-this._tileZoom)>1){this._setView(c,S);return}for(var ut=W.min.y;ut<=W.max.y;ut++)for(var Pt=W.min.x;Pt<=W.max.x;Pt++){var cr=new ie(Pt,ut);if(cr.z=this._tileZoom,!!this._isValidTile(cr)){var ir=this._tiles[this._tileCoordsToKey(cr)];ir?ir.current=!0:he.push(cr)}}if(he.sort(function(Ur,dl){return Ur.distanceTo(re)-dl.distanceTo(re)}),he.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var oi=document.createDocumentFragment();for(Pt=0;Pt<he.length;Pt++)this._addTile(he[Pt],oi);this._level.el.appendChild(oi)}}}},_isValidTile:function(c){var p=this._map.options.crs;if(!p.infinite){var S=this._globalTileRange;if(!p.wrapLng&&(c.x<S.min.x||c.x>S.max.x)||!p.wrapLat&&(c.y<S.min.y||c.y>S.max.y))return!1}if(!this.options.bounds)return!0;var V=this._tileCoordsToBounds(c);return se(this.options.bounds).overlaps(V)},_keyToBounds:function(c){return this._tileCoordsToBounds(this._keyToTileCoords(c))},_tileCoordsToNwSe:function(c){var p=this._map,S=this.getTileSize(),V=c.scaleBy(S),W=V.add(S),re=p.unproject(V,c.z),he=p.unproject(W,c.z);return[re,he]},_tileCoordsToBounds:function(c){var p=this._tileCoordsToNwSe(c),S=new X(p[0],p[1]);return this.options.noWrap||(S=this._map.wrapLatLngBounds(S)),S},_tileCoordsToKey:function(c){return c.x+":"+c.y+":"+c.z},_keyToTileCoords:function(c){var p=c.split(":"),S=new ie(+p[0],+p[1]);return S.z=+p[2],S},_removeTile:function(c){var p=this._tiles[c];p&&(cn(p.el),delete this._tiles[c],this.fire("tileunload",{tile:p.el,coords:this._keyToTileCoords(c)}))},_initTile:function(c){xt(c,"leaflet-tile");var p=this.getTileSize();c.style.width=p.x+"px",c.style.height=p.y+"px",c.onselectstart=y,c.onmousemove=y,We.ielt9&&this.options.opacity<1&&Sn(c,this.options.opacity)},_addTile:function(c,p){var S=this._getTilePos(c),V=this._tileCoordsToKey(c),W=this.createTile(this._wrapCoords(c),o(this._tileReady,this,c));this._initTile(W),this.createTile.length<2&&P(o(this._tileReady,this,c,null,W)),Tt(W,S),this._tiles[V]={el:W,coords:c,current:!0},p.appendChild(W),this.fire("tileloadstart",{tile:W,coords:c})},_tileReady:function(c,p,S){p&&this.fire("tileerror",{error:p,tile:S,coords:c});var V=this._tileCoordsToKey(c);S=this._tiles[V],S&&(S.loaded=+new Date,this._map._fadeAnimated?(Sn(S.el,0),F(this._fadeFrame),this._fadeFrame=P(this._updateOpacity,this)):(S.active=!0,this._pruneTiles()),p||(xt(S.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:S.el,coords:c})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),We.ielt9||!this._map._fadeAnimated?P(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(c){return c.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(c){var p=new ie(this._wrapX?m(c.x,this._wrapX):c.x,this._wrapY?m(c.y,this._wrapY):c.y);return p.z=c.z,p},_pxBoundsToTileRange:function(c){var p=this.getTileSize();return new B(c.min.unscaleBy(p).floor(),c.max.unscaleBy(p).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var c in this._tiles)if(!this._tiles[c].loaded)return!1;return!0}});function al(c){return new xo(c)}var bo=xo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(c,p){this._url=c,p=x(this,p),p.detectRetina&&We.retina&&p.maxZoom>0?(p.tileSize=Math.floor(p.tileSize/2),p.zoomReverse?(p.zoomOffset--,p.minZoom=Math.min(p.maxZoom,p.minZoom+1)):(p.zoomOffset++,p.maxZoom=Math.max(p.minZoom,p.maxZoom-1)),p.minZoom=Math.max(0,p.minZoom)):p.zoomReverse?p.minZoom=Math.min(p.maxZoom,p.minZoom):p.maxZoom=Math.max(p.minZoom,p.maxZoom),typeof p.subdomains=="string"&&(p.subdomains=p.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(c,p){return this._url===c&&p===void 0&&(p=!0),this._url=c,p||this.redraw(),this},createTile:function(c,p){var S=document.createElement("img");return lt(S,"load",o(this._tileOnLoad,this,p,S)),lt(S,"error",o(this._tileOnError,this,p,S)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(S.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(S.referrerPolicy=this.options.referrerPolicy),S.alt="",S.src=this.getTileUrl(c),S},getTileUrl:function(c){var p={r:We.retina?"@2x":"",s:this._getSubdomain(c),x:c.x,y:c.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var S=this._globalTileRange.max.y-c.y;this.options.tms&&(p.y=S),p["-y"]=S}return N(this._url,i(p,this.options))},_tileOnLoad:function(c,p){We.ielt9?setTimeout(o(c,this,null,p),0):c(null,p)},_tileOnError:function(c,p,S){var V=this.options.errorTileUrl;V&&p.getAttribute("src")!==V&&(p.src=V),c(S,p)},_onTileRemove:function(c){c.tile.onload=null},_getZoomForUrl:function(){var c=this._tileZoom,p=this.options.maxZoom,S=this.options.zoomReverse,V=this.options.zoomOffset;return S&&(c=p-c),c+V},_getSubdomain:function(c){var p=Math.abs(c.x+c.y)%this.options.subdomains.length;return this.options.subdomains[p]},_abortLoading:function(){var c,p;for(c in this._tiles)if(this._tiles[c].coords.z!==this._tileZoom&&(p=this._tiles[c].el,p.onload=y,p.onerror=y,!p.complete)){p.src=j;var S=this._tiles[c].coords;cn(p),delete this._tiles[c],this.fire("tileabort",{tile:p,coords:S})}},_removeTile:function(c){var p=this._tiles[c];if(p)return p.el.setAttribute("src",j),xo.prototype._removeTile.call(this,c)},_tileReady:function(c,p,S){if(!(!this._map||S&&S.getAttribute("src")===j))return xo.prototype._tileReady.call(this,c,p,S)}});function ph(c,p){return new bo(c,p)}var wc=bo.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(c,p){this._url=c;var S=i({},this.defaultWmsParams);for(var V in p)V in this.options||(S[V]=p[V]);p=x(this,p);var W=p.detectRetina&&We.retina?2:1,re=this.getTileSize();S.width=re.x*W,S.height=re.y*W,this.wmsParams=S},onAdd:function(c){this._crs=this.options.crs||c.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var p=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[p]=this._crs.code,bo.prototype.onAdd.call(this,c)},getTileUrl:function(c){var p=this._tileCoordsToNwSe(c),S=this._crs,V=G(S.project(p[0]),S.project(p[1])),W=V.min,re=V.max,he=(this._wmsVersion>=1.3&&this._crs===Un?[W.y,W.x,re.y,re.x]:[W.x,W.y,re.x,re.y]).join(","),xe=bo.prototype.getTileUrl.call(this,c);return xe+b(this.wmsParams,xe,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+he},setParams:function(c,p){return i(this.wmsParams,c),p||this.redraw(),this}});function Lm(c,p){return new wc(c,p)}bo.WMS=wc,ph.wms=Lm;var ys=nn.extend({options:{padding:.1},initialize:function(c){x(this,c),d(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),xt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var c={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(c.zoomanim=this._onAnimZoom),c},_onAnimZoom:function(c){this._updateTransform(c.center,c.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(c,p){var S=this._map.getZoomScale(p,this._zoom),V=this._map.getSize().multiplyBy(.5+this.options.padding),W=this._map.project(this._center,p),re=V.multiplyBy(-S).add(W).subtract(this._map._getNewPixelOrigin(c,p));We.any3d?Fr(this._container,re,S):Tt(this._container,re)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var c in this._layers)this._layers[c]._reset()},_onZoomEnd:function(){for(var c in this._layers)this._layers[c]._project()},_updatePaths:function(){for(var c in this._layers)this._layers[c]._update()},_update:function(){var c=this.options.padding,p=this._map.getSize(),S=this._map.containerPointToLayerPoint(p.multiplyBy(-c)).round();this._bounds=new B(S,S.add(p.multiplyBy(1+c*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),gh=ys.extend({options:{tolerance:0},getEvents:function(){var c=ys.prototype.getEvents.call(this);return c.viewprereset=this._onViewPreReset,c},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){ys.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var c=this._container=document.createElement("canvas");lt(c,"mousemove",this._onMouseMove,this),lt(c,"click dblclick mousedown mouseup contextmenu",this._onClick,this),lt(c,"mouseout",this._handleMouseOut,this),c._leaflet_disable_events=!0,this._ctx=c.getContext("2d")},_destroyContainer:function(){F(this._redrawRequest),delete this._ctx,cn(this._container),tn(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var c;this._redrawBounds=null;for(var p in this._layers)c=this._layers[p],c._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ys.prototype._update.call(this);var c=this._bounds,p=this._container,S=c.getSize(),V=We.retina?2:1;Tt(p,c.min),p.width=V*S.x,p.height=V*S.y,p.style.width=S.x+"px",p.style.height=S.y+"px",We.retina&&this._ctx.scale(2,2),this._ctx.translate(-c.min.x,-c.min.y),this.fire("update")}},_reset:function(){ys.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(c){this._updateDashArray(c),this._layers[d(c)]=c;var p=c._order={layer:c,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=p),this._drawLast=p,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(c){this._requestRedraw(c)},_removePath:function(c){var p=c._order,S=p.next,V=p.prev;S?S.prev=V:this._drawLast=V,V?V.next=S:this._drawFirst=S,delete c._order,delete this._layers[d(c)],this._requestRedraw(c)},_updatePath:function(c){this._extendRedrawBounds(c),c._project(),c._update(),this._requestRedraw(c)},_updateStyle:function(c){this._updateDashArray(c),this._requestRedraw(c)},_updateDashArray:function(c){if(typeof c.options.dashArray=="string"){var p=c.options.dashArray.split(/[, ]+/),S=[],V,W;for(W=0;W<p.length;W++){if(V=Number(p[W]),isNaN(V))return;S.push(V)}c.options._dashArray=S}else c.options._dashArray=c.options.dashArray},_requestRedraw:function(c){this._map&&(this._extendRedrawBounds(c),this._redrawRequest=this._redrawRequest||P(this._redraw,this))},_extendRedrawBounds:function(c){if(c._pxBounds){var p=(c.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new B,this._redrawBounds.extend(c._pxBounds.min.subtract([p,p])),this._redrawBounds.extend(c._pxBounds.max.add([p,p]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var c=this._redrawBounds;if(c){var p=c.getSize();this._ctx.clearRect(c.min.x,c.min.y,p.x,p.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var c,p=this._redrawBounds;if(this._ctx.save(),p){var S=p.getSize();this._ctx.beginPath(),this._ctx.rect(p.min.x,p.min.y,S.x,S.y),this._ctx.clip()}this._drawing=!0;for(var V=this._drawFirst;V;V=V.next)c=V.layer,(!p||c._pxBounds&&c._pxBounds.intersects(p))&&c._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(c,p){if(this._drawing){var S,V,W,re,he=c._parts,xe=he.length,Ee=this._ctx;if(xe){for(Ee.beginPath(),S=0;S<xe;S++){for(V=0,W=he[S].length;V<W;V++)re=he[S][V],Ee[V?"lineTo":"moveTo"](re.x,re.y);p&&Ee.closePath()}this._fillStroke(Ee,c)}}},_updateCircle:function(c){if(!(!this._drawing||c._empty())){var p=c._point,S=this._ctx,V=Math.max(Math.round(c._radius),1),W=(Math.max(Math.round(c._radiusY),1)||V)/V;W!==1&&(S.save(),S.scale(1,W)),S.beginPath(),S.arc(p.x,p.y/W,V,0,Math.PI*2,!1),W!==1&&S.restore(),this._fillStroke(S,c)}},_fillStroke:function(c,p){var S=p.options;S.fill&&(c.globalAlpha=S.fillOpacity,c.fillStyle=S.fillColor||S.color,c.fill(S.fillRule||"evenodd")),S.stroke&&S.weight!==0&&(c.setLineDash&&c.setLineDash(p.options&&p.options._dashArray||[]),c.globalAlpha=S.opacity,c.lineWidth=S.weight,c.strokeStyle=S.color,c.lineCap=S.lineCap,c.lineJoin=S.lineJoin,c.stroke())},_onClick:function(c){for(var p=this._map.mouseEventToLayerPoint(c),S,V,W=this._drawFirst;W;W=W.next)S=W.layer,S.options.interactive&&S._containsPoint(p)&&(!(c.type==="click"||c.type==="preclick")||!this._map._draggableMoved(S))&&(V=S);this._fireEvent(V?[V]:!1,c)},_onMouseMove:function(c){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var p=this._map.mouseEventToLayerPoint(c);this._handleMouseHover(c,p)}},_handleMouseOut:function(c){var p=this._hoveredLayer;p&&(un(this._container,"leaflet-interactive"),this._fireEvent([p],c,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(c,p){if(!this._mouseHoverThrottled){for(var S,V,W=this._drawFirst;W;W=W.next)S=W.layer,S.options.interactive&&S._containsPoint(p)&&(V=S);V!==this._hoveredLayer&&(this._handleMouseOut(c),V&&(xt(this._container,"leaflet-interactive"),this._fireEvent([V],c,"mouseover"),this._hoveredLayer=V)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,c),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(c,p,S){this._map._fireDOMEvent(p,S||p.type,c)},_bringToFront:function(c){var p=c._order;if(p){var S=p.next,V=p.prev;if(S)S.prev=V;else return;V?V.next=S:S&&(this._drawFirst=S),p.prev=this._drawLast,this._drawLast.next=p,p.next=null,this._drawLast=p,this._requestRedraw(c)}},_bringToBack:function(c){var p=c._order;if(p){var S=p.next,V=p.prev;if(V)V.next=S;else return;S?S.prev=V:V&&(this._drawLast=V),p.prev=null,p.next=this._drawFirst,this._drawFirst.prev=p,this._drawFirst=p,this._requestRedraw(c)}}});function yh(c){return We.canvas?new gh(c):null}var ll=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(c){return document.createElement("<lvml:"+c+' class="lvml">')}}catch{}return function(c){return document.createElement("<"+c+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),Fm={_initContainer:function(){this._container=St("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(ys.prototype._update.call(this),this.fire("update"))},_initPath:function(c){var p=c._container=ll("shape");xt(p,"leaflet-vml-shape "+(this.options.className||"")),p.coordsize="1 1",c._path=ll("path"),p.appendChild(c._path),this._updateStyle(c),this._layers[d(c)]=c},_addPath:function(c){var p=c._container;this._container.appendChild(p),c.options.interactive&&c.addInteractiveTarget(p)},_removePath:function(c){var p=c._container;cn(p),c.removeInteractiveTarget(p),delete this._layers[d(c)]},_updateStyle:function(c){var p=c._stroke,S=c._fill,V=c.options,W=c._container;W.stroked=!!V.stroke,W.filled=!!V.fill,V.stroke?(p||(p=c._stroke=ll("stroke")),W.appendChild(p),p.weight=V.weight+"px",p.color=V.color,p.opacity=V.opacity,V.dashArray?p.dashStyle=R(V.dashArray)?V.dashArray.join(" "):V.dashArray.replace(/( *, *)/g," "):p.dashStyle="",p.endcap=V.lineCap.replace("butt","flat"),p.joinstyle=V.lineJoin):p&&(W.removeChild(p),c._stroke=null),V.fill?(S||(S=c._fill=ll("fill")),W.appendChild(S),S.color=V.fillColor||V.color,S.opacity=V.fillOpacity):S&&(W.removeChild(S),c._fill=null)},_updateCircle:function(c){var p=c._point.round(),S=Math.round(c._radius),V=Math.round(c._radiusY||S);this._setPath(c,c._empty()?"M0 0":"AL "+p.x+","+p.y+" "+S+","+V+" 0,"+65535*360)},_setPath:function(c,p){c._path.v=p},_bringToFront:function(c){Bs(c._container)},_bringToBack:function(c){Gi(c._container)}},Xi=We.vml?ll:At,ta=ys.extend({_initContainer:function(){this._container=Xi("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=Xi("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){cn(this._container),tn(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){ys.prototype._update.call(this);var c=this._bounds,p=c.getSize(),S=this._container;(!this._svgSize||!this._svgSize.equals(p))&&(this._svgSize=p,S.setAttribute("width",p.x),S.setAttribute("height",p.y)),Tt(S,c.min),S.setAttribute("viewBox",[c.min.x,c.min.y,p.x,p.y].join(" ")),this.fire("update")}},_initPath:function(c){var p=c._path=Xi("path");c.options.className&&xt(p,c.options.className),c.options.interactive&&xt(p,"leaflet-interactive"),this._updateStyle(c),this._layers[d(c)]=c},_addPath:function(c){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(c._path),c.addInteractiveTarget(c._path)},_removePath:function(c){cn(c._path),c.removeInteractiveTarget(c._path),delete this._layers[d(c)]},_updatePath:function(c){c._project(),c._update()},_updateStyle:function(c){var p=c._path,S=c.options;p&&(S.stroke?(p.setAttribute("stroke",S.color),p.setAttribute("stroke-opacity",S.opacity),p.setAttribute("stroke-width",S.weight),p.setAttribute("stroke-linecap",S.lineCap),p.setAttribute("stroke-linejoin",S.lineJoin),S.dashArray?p.setAttribute("stroke-dasharray",S.dashArray):p.removeAttribute("stroke-dasharray"),S.dashOffset?p.setAttribute("stroke-dashoffset",S.dashOffset):p.removeAttribute("stroke-dashoffset")):p.setAttribute("stroke","none"),S.fill?(p.setAttribute("fill",S.fillColor||S.color),p.setAttribute("fill-opacity",S.fillOpacity),p.setAttribute("fill-rule",S.fillRule||"evenodd")):p.setAttribute("fill","none"))},_updatePoly:function(c,p){this._setPath(c,xn(c._parts,p))},_updateCircle:function(c){var p=c._point,S=Math.max(Math.round(c._radius),1),V=Math.max(Math.round(c._radiusY),1)||S,W="a"+S+","+V+" 0 1,0 ",re=c._empty()?"M0 0":"M"+(p.x-S)+","+p.y+W+S*2+",0 "+W+-S*2+",0 ";this._setPath(c,re)},_setPath:function(c,p){c._path.setAttribute("d",p)},_bringToFront:function(c){Bs(c._path)},_bringToBack:function(c){Gi(c._path)}});We.vml&&ta.include(Fm);function Lu(c){return We.svg||We.vml?new ta(c):null}Rt.include({getRenderer:function(c){var p=c.options.renderer||this._getPaneRenderer(c.options.pane)||this.options.renderer||this._renderer;return p||(p=this._renderer=this._createRenderer()),this.hasLayer(p)||this.addLayer(p),p},_getPaneRenderer:function(c){if(c==="overlayPane"||c===void 0)return!1;var p=this._paneRenderers[c];return p===void 0&&(p=this._createRenderer({pane:c}),this._paneRenderers[c]=p),p},_createRenderer:function(c){return this.options.preferCanvas&&yh(c)||Lu(c)}});var Vm=Ks.extend({initialize:function(c,p){Ks.prototype.initialize.call(this,this._boundsToLatLngs(c),p)},setBounds:function(c){return this.setLatLngs(this._boundsToLatLngs(c))},_boundsToLatLngs:function(c){return c=se(c),[c.getSouthWest(),c.getNorthWest(),c.getNorthEast(),c.getSouthEast()]}});function x0(c,p){return new Vm(c,p)}ta.create=Xi,ta.pointsToPath=xn,ps.geometryToLayer=rl,ps.coordsToLatLng=Cu,ps.coordsToLatLngs=xc,ps.latLngToCoords=Ru,ps.latLngsToCoords=ju,ps.getFeature=il,ps.asFeature=Ou,Rt.mergeOptions({boxZoom:!0});var cl=Rr.extend({initialize:function(c){this._map=c,this._container=c._container,this._pane=c._panes.overlayPane,this._resetStateTimeout=0,c.on("unload",this._destroy,this)},addHooks:function(){lt(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){tn(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){cn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(c){if(!c.shiftKey||c.which!==1&&c.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Ct(),$a(),this._startPoint=this._map.mouseEventToContainerPoint(c),lt(document,{contextmenu:lr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(c){this._moved||(this._moved=!0,this._box=St("div","leaflet-zoom-box",this._container),xt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(c);var p=new B(this._point,this._startPoint),S=p.getSize();Tt(this._box,p.min),this._box.style.width=S.x+"px",this._box.style.height=S.y+"px"},_finish:function(){this._moved&&(cn(this._box),un(this._container,"leaflet-crosshair")),Si(),Wa(),tn(document,{contextmenu:lr,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(c){if(!(c.which!==1&&c.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var p=new X(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(p).fire("boxzoomend",{boxZoomBounds:p})}},_onKeyDown:function(c){c.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Rt.addInitHook("addHandler","boxZoom",cl),Rt.mergeOptions({doubleClickZoom:!0});var zm=Rr.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(c){var p=this._map,S=p.getZoom(),V=p.options.zoomDelta,W=c.originalEvent.shiftKey?S-V:S+V;p.options.doubleClickZoom==="center"?p.setZoom(W):p.setZoomAround(c.containerPoint,W)}});Rt.addInitHook("addHandler","doubleClickZoom",zm),Rt.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var vh=Rr.extend({addHooks:function(){if(!this._draggable){var c=this._map;this._draggable=new zr(c._mapPane,c._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),c.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),c.on("zoomend",this._onZoomEnd,this),c.whenReady(this._onZoomEnd,this))}xt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){un(this._map._container,"leaflet-grab"),un(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var c=this._map;if(c._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var p=se(this._map.options.maxBounds);this._offsetLimit=G(this._map.latLngToContainerPoint(p.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(p.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;c.fire("movestart").fire("dragstart"),c.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(c){if(this._map.options.inertia){var p=this._lastTime=+new Date,S=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(S),this._times.push(p),this._prunePositions(p)}this._map.fire("move",c).fire("drag",c)},_prunePositions:function(c){for(;this._positions.length>1&&c-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var c=this._map.getSize().divideBy(2),p=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=p.subtract(c).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(c,p){return c-(c-p)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var c=this._draggable._newPos.subtract(this._draggable._startPos),p=this._offsetLimit;c.x<p.min.x&&(c.x=this._viscousLimit(c.x,p.min.x)),c.y<p.min.y&&(c.y=this._viscousLimit(c.y,p.min.y)),c.x>p.max.x&&(c.x=this._viscousLimit(c.x,p.max.x)),c.y>p.max.y&&(c.y=this._viscousLimit(c.y,p.max.y)),this._draggable._newPos=this._draggable._startPos.add(c)}},_onPreDragWrap:function(){var c=this._worldWidth,p=Math.round(c/2),S=this._initialWorldOffset,V=this._draggable._newPos.x,W=(V-p+S)%c+p-S,re=(V+p+S)%c-p-S,he=Math.abs(W+S)<Math.abs(re+S)?W:re;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=he},_onDragEnd:function(c){var p=this._map,S=p.options,V=!S.inertia||c.noInertia||this._times.length<2;if(p.fire("dragend",c),V)p.fire("moveend");else{this._prunePositions(+new Date);var W=this._lastPos.subtract(this._positions[0]),re=(this._lastTime-this._times[0])/1e3,he=S.easeLinearity,xe=W.multiplyBy(he/re),Ee=xe.distanceTo([0,0]),Pe=Math.min(S.inertiaMaxSpeed,Ee),$e=xe.multiplyBy(Pe/Ee),ut=Pe/(S.inertiaDeceleration*he),Pt=$e.multiplyBy(-ut/2).round();!Pt.x&&!Pt.y?p.fire("moveend"):(Pt=p._limitOffset(Pt,p.options.maxBounds),P(function(){p.panBy(Pt,{duration:ut,easeLinearity:he,noMoveStart:!0,animate:!0})}))}}});Rt.addInitHook("addHandler","dragging",vh),Rt.mergeOptions({keyboard:!0,keyboardPanDelta:80});var _h=Rr.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(c){this._map=c,this._setPanDelta(c.options.keyboardPanDelta),this._setZoomDelta(c.options.zoomDelta)},addHooks:function(){var c=this._map._container;c.tabIndex<=0&&(c.tabIndex="0"),lt(c,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),tn(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var c=document.body,p=document.documentElement,S=c.scrollTop||p.scrollTop,V=c.scrollLeft||p.scrollLeft;this._map._container.focus(),window.scrollTo(V,S)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(c){var p=this._panKeys={},S=this.keyCodes,V,W;for(V=0,W=S.left.length;V<W;V++)p[S.left[V]]=[-1*c,0];for(V=0,W=S.right.length;V<W;V++)p[S.right[V]]=[c,0];for(V=0,W=S.down.length;V<W;V++)p[S.down[V]]=[0,c];for(V=0,W=S.up.length;V<W;V++)p[S.up[V]]=[0,-1*c]},_setZoomDelta:function(c){var p=this._zoomKeys={},S=this.keyCodes,V,W;for(V=0,W=S.zoomIn.length;V<W;V++)p[S.zoomIn[V]]=c;for(V=0,W=S.zoomOut.length;V<W;V++)p[S.zoomOut[V]]=-c},_addHooks:function(){lt(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){tn(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(c){if(!(c.altKey||c.ctrlKey||c.metaKey)){var p=c.keyCode,S=this._map,V;if(p in this._panKeys){if(!S._panAnim||!S._panAnim._inProgress)if(V=this._panKeys[p],c.shiftKey&&(V=K(V).multiplyBy(3)),S.options.maxBounds&&(V=S._limitOffset(K(V),S.options.maxBounds)),S.options.worldCopyJump){var W=S.wrapLatLng(S.unproject(S.project(S.getCenter()).add(V)));S.panTo(W)}else S.panBy(V)}else if(p in this._zoomKeys)S.setZoom(S.getZoom()+(c.shiftKey?3:1)*this._zoomKeys[p]);else if(p===27&&S._popup&&S._popup.options.closeOnEscapeKey)S.closePopup();else return;lr(c)}}});Rt.addInitHook("addHandler","keyboard",_h),Rt.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var _n=Rr.extend({addHooks:function(){lt(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){tn(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(c){var p=Su(c),S=this._map.options.wheelDebounceTime;this._delta+=p,this._lastMousePos=this._map.mouseEventToContainerPoint(c),this._startTime||(this._startTime=+new Date);var V=Math.max(S-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),V),lr(c)},_performZoom:function(){var c=this._map,p=c.getZoom(),S=this._map.options.zoomSnap||0;c._stop();var V=this._delta/(this._map.options.wheelPxPerZoomLevel*4),W=4*Math.log(2/(1+Math.exp(-Math.abs(V))))/Math.LN2,re=S?Math.ceil(W/S)*S:W,he=c._limitZoom(p+(this._delta>0?re:-re))-p;this._delta=0,this._startTime=null,he&&(c.options.scrollWheelZoom==="center"?c.setZoom(p+he):c.setZoomAround(this._lastMousePos,p+he))}});Rt.addInitHook("addHandler","scrollWheelZoom",_n);var xh=600;Rt.mergeOptions({tapHold:We.touchNative&&We.safari&&We.mobile,tapTolerance:15});var Ec=Rr.extend({addHooks:function(){lt(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){tn(this._map._container,"touchstart",this._onDown,this)},_onDown:function(c){if(clearTimeout(this._holdTimeout),c.touches.length===1){var p=c.touches[0];this._startPos=this._newPos=new ie(p.clientX,p.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(lt(document,"touchend",dn),lt(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",p))},this),xh),lt(document,"touchend touchcancel contextmenu",this._cancel,this),lt(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function c(){tn(document,"touchend",dn),tn(document,"touchend touchcancel",c)},_cancel:function(){clearTimeout(this._holdTimeout),tn(document,"touchend touchcancel contextmenu",this._cancel,this),tn(document,"touchmove",this._onMove,this)},_onMove:function(c){var p=c.touches[0];this._newPos=new ie(p.clientX,p.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(c,p){var S=new MouseEvent(c,{bubbles:!0,cancelable:!0,view:window,screenX:p.screenX,screenY:p.screenY,clientX:p.clientX,clientY:p.clientY});S._simulated=!0,p.target.dispatchEvent(S)}});Rt.addInitHook("addHandler","tapHold",Ec),Rt.mergeOptions({touchZoom:We.touch,bounceAtZoomLimits:!0});var ul=Rr.extend({addHooks:function(){xt(this._map._container,"leaflet-touch-zoom"),lt(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){un(this._map._container,"leaflet-touch-zoom"),tn(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(c){var p=this._map;if(!(!c.touches||c.touches.length!==2||p._animatingZoom||this._zooming)){var S=p.mouseEventToContainerPoint(c.touches[0]),V=p.mouseEventToContainerPoint(c.touches[1]);this._centerPoint=p.getSize()._divideBy(2),this._startLatLng=p.containerPointToLatLng(this._centerPoint),p.options.touchZoom!=="center"&&(this._pinchStartLatLng=p.containerPointToLatLng(S.add(V)._divideBy(2))),this._startDist=S.distanceTo(V),this._startZoom=p.getZoom(),this._moved=!1,this._zooming=!0,p._stop(),lt(document,"touchmove",this._onTouchMove,this),lt(document,"touchend touchcancel",this._onTouchEnd,this),dn(c)}},_onTouchMove:function(c){if(!(!c.touches||c.touches.length!==2||!this._zooming)){var p=this._map,S=p.mouseEventToContainerPoint(c.touches[0]),V=p.mouseEventToContainerPoint(c.touches[1]),W=S.distanceTo(V)/this._startDist;if(this._zoom=p.getScaleZoom(W,this._startZoom),!p.options.bounceAtZoomLimits&&(this._zoom<p.getMinZoom()&&W<1||this._zoom>p.getMaxZoom()&&W>1)&&(this._zoom=p._limitZoom(this._zoom)),p.options.touchZoom==="center"){if(this._center=this._startLatLng,W===1)return}else{var re=S._add(V)._divideBy(2)._subtract(this._centerPoint);if(W===1&&re.x===0&&re.y===0)return;this._center=p.unproject(p.project(this._pinchStartLatLng,this._zoom).subtract(re),this._zoom)}this._moved||(p._moveStart(!0,!1),this._moved=!0),F(this._animRequest);var he=o(p._move,p,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=P(he,this,!0),dn(c)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,F(this._animRequest),tn(document,"touchmove",this._onTouchMove,this),tn(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Rt.addInitHook("addHandler","touchZoom",ul),Rt.BoxZoom=cl,Rt.DoubleClickZoom=zm,Rt.Drag=vh,Rt.Keyboard=_h,Rt.ScrollWheelZoom=_n,Rt.TapHold=Ec,Rt.TouchZoom=ul,t.Bounds=B,t.Browser=We,t.CRS=ce,t.Canvas=gh,t.Circle=ku,t.CircleMarker=Iu,t.Class=$,t.Control=xr,t.DivIcon=Du,t.DivOverlay=gs,t.DomEvent=Yo,t.DomUtil=go,t.Draggable=zr,t.Evented=oe,t.FeatureGroup=Dn,t.GeoJSON=ps,t.GridLayer=xo,t.Handler=Rr,t.Icon=Zi,t.ImageOverlay=_o,t.LatLng=le,t.LatLngBounds=X,t.Layer=nn,t.LayerGroup=En,t.LineUtil=ae,t.Map=Rt,t.Marker=Gs,t.Mixin=Hs,t.Path=vo,t.Point=ie,t.PolyUtil=Ja,t.Polygon=Ks,t.Polyline=si,t.Popup=Mu,t.PosAnimation=Zo,t.Projection=Be,t.Rectangle=Vm,t.Renderer=ys,t.SVG=ta,t.SVGOverlay=fh,t.TileLayer=bo,t.Tooltip=ol,t.Transformation=Oe,t.Util=M,t.VideoOverlay=hh,t.bind=o,t.bounds=G,t.canvas=yh,t.circle=_c,t.circleMarker=Rm,t.control=tr,t.divIcon=Dm,t.extend=i,t.featureGroup=ea,t.geoJSON=jm,t.geoJson=Qi,t.gridLayer=al,t.icon=Cm,t.imageOverlay=Om,t.latLng=Q,t.latLngBounds=se,t.layerGroup=ki,t.map=ii,t.marker=y0,t.point=K,t.polygon=_0,t.polyline=v0,t.popup=sl,t.rectangle=x0,t.setOptions=x,t.stamp=d,t.svg=Lu,t.svgOverlay=mh,t.tileLayer=ph,t.tooltip=bc,t.transformation=qe,t.version=n,t.videoOverlay=Mm;var Bm=window.L;t.noConflict=function(){return window.L=Bm,this},window.L=t})}(xf,xf.exports)),xf.exports}var nw=eW();function OR(r,e,t){return Object.freeze({instance:r,context:e,container:t})}function MR(r,e){return e==null?function(n,i){const s=J.useRef();return s.current||(s.current=r(n,i)),s}:function(n,i){const s=J.useRef();s.current||(s.current=r(n,i));const o=J.useRef(n),{instance:l}=s.current;return J.useEffect(function(){o.current!==n&&(e(l,n,o.current),o.current=n)},[l,n,i]),s}}function DR(r,e){J.useEffect(function(){return(e.layerContainer??e.map).addLayer(r.instance),function(){var s;(s=e.layerContainer)==null||s.removeLayer(r.instance),e.map.removeLayer(r.instance)}},[e,r])}function tW(r){return function(t){const n=RR(),i=r(tw(t,n),n);return G$(n.map,t.attribution),jR(i.current,t.eventHandlers),DR(i.current,n),i}}function nW(r,e){const t=J.useRef();J.useEffect(function(){if(e.pathOptions!==t.current){const i=e.pathOptions??{};r.instance.setStyle(i),t.current=i}},[r,e])}function rW(r){return function(t){const n=RR(),i=r(tw(t,n),n);return jR(i.current,t.eventHandlers),DR(i.current,n),nW(i.current,t),i}}function iW(r,e){const t=MR(r,e),n=rW(t);return Q$(n)}function sW(r,e){const t=MR(r,e),n=tW(t);return X$(n)}function oW(r,e,t){const{opacity:n,zIndex:i}=e;n!=null&&n!==t.opacity&&r.setOpacity(n),i!=null&&i!==t.zIndex&&r.setZIndex(i)}const aW=iW(function({data:e,...t},n){const i=new nw.GeoJSON(e,t);return OR(i,Z$(n,{overlayContainer:i}))},function(e,t,n){t.style!==n.style&&(t.style==null?e.resetStyle():e.setStyle(t.style))});function Zx(){return Zx=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Zx.apply(this,arguments)}function lW({bounds:r,boundsOptions:e,center:t,children:n,className:i,id:s,placeholder:o,style:l,whenReady:d,zoom:f,...m},y){const[g]=J.useState({className:i,id:s,style:l}),[_,E]=J.useState(null);J.useImperativeHandle(y,()=>(_==null?void 0:_.map)??null,[_]);const x=J.useCallback(T=>{if(T!==null&&_===null){const N=new nw.Map(T,m);t!=null&&f!=null?N.setView(t,f):r!=null&&N.fitBounds(r,e),d!=null&&N.whenReady(d),E(Y$(N))}},[]);J.useEffect(()=>()=>{_==null||_.map.remove()},[_]);const b=_?ss.createElement(CR,{value:_},n):o??null;return ss.createElement("div",Zx({},g,{ref:x}),b)}const cW=J.forwardRef(lW),uW=sW(function({url:e,...t},n){const i=new nw.TileLayer(e,tw(t,n));return OR(i,n)},function(e,t,n){oW(e,t,n);const{url:i}=t;i!=null&&i!==n.url&&e.setUrl(i)}),LR=({geoJsonData:r,affectedAreas:e=[],mapCenter:t=[14.3207,120.7641],mapZoom:n=13,height:i="256px"})=>{const s={fillColor:"#6b7280",weight:1,opacity:1,color:"white",fillOpacity:.3},o={fillColor:"#EF4444",weight:2,opacity:1,color:"#B91C1C",fillOpacity:.7},l=m=>{var g;const y=(g=m==null?void 0:m.properties)==null?void 0:g.NAME_3;return e.includes(y)?o:s},d=(m,y)=>{var _;const g=(_=m==null?void 0:m.properties)==null?void 0:_.NAME_3;if(g){const E=e.includes(g),x=`
                <div>
                    <strong>${g}</strong>
                    <p style="color: ${E?"#B91C1C":"#374151"}; margin: 0; font-weight: bold;">
                        ${E?"AFFECTED":"Not Affected"}
                    </p>
                </div>
            `;y.bindPopup(x)}},f=JSON.stringify(e);return u.jsxs(cW,{center:t,zoom:n,scrollWheelZoom:!1,style:{height:i,width:"100%"},children:[u.jsx(uW,{attribution:' <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),u.jsx(aW,{data:r,style:l,onEachFeature:d})]},f)},dW="FeatureCollection",hW=JSON.parse('[{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10541,"NAME_3":"Bagong Karsada","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.751953,14.32201],[120.752228,14.32222],[120.752663,14.32253],[120.753036,14.32284],[120.753357,14.32315],[120.753677,14.32344],[120.753937,14.32382],[120.754112,14.32407],[120.755127,14.32243],[120.755623,14.32164],[120.753319,14.31961],[120.753288,14.31996],[120.75325,14.32051],[120.75177,14.32179],[120.751953,14.32201]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10542,"NAME_3":"Balsahan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.757576,14.324344],[120.757652,14.32411],[120.757851,14.32374],[120.758034,14.3234],[120.758293,14.32305],[120.75853,14.32271],[120.75885,14.32232],[120.759201,14.3219],[120.759644,14.32152],[120.760017,14.32123],[120.759048,14.32047],[120.756859,14.31872],[120.756042,14.31818],[120.755547,14.31786],[120.754921,14.3172],[120.753166,14.31839],[120.753319,14.31961],[120.755623,14.32164],[120.756866,14.32269],[120.756897,14.32261],[120.757576,14.324344]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10543,"NAME_3":"Bancaan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.760017,14.32123],[120.760094,14.32119],[120.76049,14.3209],[120.760841,14.32068],[120.7612,14.32057],[120.761574,14.32058],[120.761879,14.32073],[120.762115,14.32097],[120.762291,14.31999],[120.762367,14.31954],[120.762497,14.31838],[120.763046,14.31687],[120.763611,14.31575],[120.764374,14.31534],[120.764709,14.31529],[120.760948,14.31142],[120.758423,14.30908],[120.75679,14.30764],[120.749802,14.3161],[120.749046,14.31704],[120.748451,14.31786],[120.747993,14.3185],[120.74823,14.31858],[120.748756,14.31893],[120.749207,14.31934],[120.749672,14.31971],[120.750137,14.32007],[120.750542,14.32052],[120.750763,14.32081],[120.750923,14.32101],[120.751343,14.32144],[120.75177,14.32187],[120.751953,14.32201],[120.75177,14.32179],[120.75325,14.32051],[120.753288,14.31996],[120.753319,14.31961],[120.753166,14.31839],[120.754921,14.3172],[120.755547,14.31786],[120.756042,14.31818],[120.756859,14.31872],[120.759048,14.32047],[120.760017,14.32123]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10544,"NAME_3":"Bucana Malaki","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.759468,14.32942],[120.75988,14.32972],[120.760094,14.32985],[120.760612,14.32961],[120.762527,14.32867],[120.765457,14.32651],[120.761711,14.32374],[120.762093,14.32114],[120.762115,14.32097],[120.761879,14.32073],[120.761574,14.32058],[120.7612,14.32057],[120.760841,14.32068],[120.76049,14.3209],[120.760094,14.32119],[120.760017,14.32123],[120.759644,14.32152],[120.759201,14.3219],[120.75885,14.32232],[120.75853,14.32271],[120.758293,14.32305],[120.758034,14.3234],[120.757851,14.32374],[120.757652,14.32411],[120.757576,14.324344],[120.757561,14.32441],[120.757507,14.32458],[120.757393,14.32517],[120.757378,14.32534],[120.757332,14.32586],[120.757423,14.32654],[120.757683,14.32709],[120.758034,14.32756],[120.758377,14.32805],[120.758728,14.32854],[120.759117,14.32899],[120.759468,14.32942]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10545,"NAME_3":"Bucana Sasahan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.75563,14.32561],[120.759468,14.32942],[120.759117,14.32899],[120.758728,14.32854],[120.758377,14.32805],[120.758034,14.32756],[120.757683,14.32709],[120.757423,14.32654],[120.757332,14.32586],[120.757378,14.32534],[120.757393,14.32517],[120.757507,14.32458],[120.757561,14.32441],[120.757576,14.324344],[120.756897,14.32261],[120.756866,14.32269],[120.756737,14.32314],[120.756622,14.32366],[120.756508,14.32416],[120.756378,14.32468],[120.756088,14.32519],[120.75563,14.32561]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10546,"NAME_3":"Calubcob","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.796928,14.30077],[120.795471,14.29953],[120.793137,14.29676],[120.79158,14.29506],[120.787483,14.2923],[120.786659,14.29179],[120.785629,14.29099],[120.783401,14.28984],[120.782379,14.29027],[120.782082,14.29058],[120.78141,14.29118],[120.781189,14.29207],[120.780548,14.29224],[120.780434,14.29373],[120.779984,14.29418],[120.780212,14.29477],[120.780952,14.2945],[120.780899,14.29493],[120.780457,14.29537],[120.78064,14.29603],[120.780273,14.29652],[120.779167,14.29681],[120.778511,14.29719],[120.778053,14.29832],[120.777763,14.29899],[120.777924,14.30045],[120.77832,14.30128],[120.778503,14.30227],[120.779778,14.30327],[120.783112,14.30549],[120.783958,14.30623],[120.785881,14.30723],[120.786102,14.30674],[120.787018,14.30689],[120.787827,14.30755],[120.788567,14.30743],[120.788879,14.30703],[120.78952,14.3074],[120.789886,14.30639],[120.790253,14.30608],[120.790604,14.30655],[120.791344,14.30624],[120.79174,14.30554],[120.79213,14.30448],[120.792648,14.30341],[120.793854,14.30352],[120.795471,14.30197],[120.795929,14.30115],[120.796928,14.30077]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10547,"NAME_3":"Capt. C. Nazareno","NL_NAME_3":"","VARNAME_3":"Poblacion","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.766197,14.31813],[120.763046,14.31687],[120.762497,14.31838],[120.762367,14.31954],[120.76326,14.31981],[120.763931,14.32013],[120.764572,14.32034],[120.7649,14.32048],[120.766197,14.31813]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10548,"NAME_3":"Gomez-Zamora","NL_NAME_3":"","VARNAME_3":"Poblacion","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.762115,14.32097],[120.762093,14.32114],[120.762802,14.32201],[120.763283,14.32248],[120.764091,14.3223],[120.76458,14.32184],[120.765198,14.32126],[120.766006,14.321],[120.766571,14.32094],[120.767021,14.32038],[120.767509,14.31945],[120.766197,14.31813],[120.7649,14.32048],[120.764572,14.32034],[120.763931,14.32013],[120.76326,14.31981],[120.762367,14.31954],[120.762291,14.31999],[120.762115,14.32097]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10549,"NAME_3":"Halang","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.796928,14.30077],[120.798698,14.3027],[120.800812,14.30515],[120.802559,14.3051],[120.803482,14.30436],[120.803978,14.30431],[120.805817,14.30476],[120.807091,14.3045],[120.807037,14.30409],[120.807747,14.30351],[120.808243,14.30261],[120.809677,14.30198],[120.809601,14.3011],[120.81073,14.30081],[120.811562,14.30122],[120.811897,14.30196],[120.812668,14.3024],[120.813179,14.30343],[120.814293,14.30287],[120.815407,14.3016],[120.820297,14.29734],[120.819633,14.29599],[120.819939,14.29436],[120.813843,14.29398],[120.81057,14.29228],[120.809769,14.29181],[120.806229,14.28998],[120.804901,14.28931],[120.802063,14.28757],[120.798309,14.2857],[120.792213,14.28238],[120.788612,14.2884],[120.787956,14.28963],[120.786659,14.29179],[120.787483,14.2923],[120.79158,14.29506],[120.793137,14.29676],[120.795471,14.29953],[120.796928,14.30077]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10550,"NAME_3":"Humbac","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.766197,14.31813],[120.767509,14.31945],[120.768089,14.31881],[120.769089,14.31828],[120.769676,14.31781],[120.770073,14.31745],[120.769814,14.31668],[120.769524,14.31613],[120.769234,14.31572],[120.766197,14.31813]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10551,"NAME_3":"Ibayo Estacion","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.769722,14.32933],[120.769821,14.32828],[120.770157,14.32789],[120.77076,14.32727],[120.77137,14.32683],[120.771744,14.32605],[120.772591,14.32497],[120.770638,14.32312],[120.768913,14.32191],[120.767021,14.32038],[120.766571,14.32094],[120.766006,14.321],[120.765198,14.32126],[120.76458,14.32184],[120.764091,14.3223],[120.763283,14.32248],[120.762802,14.32201],[120.762093,14.32114],[120.761711,14.32374],[120.765457,14.32651],[120.769722,14.32933]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10552,"NAME_3":"Ibayo Silangan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.773247,14.32551],[120.774567,14.32522],[120.77565,14.32507],[120.778954,14.32391],[120.781349,14.32267],[120.780998,14.32235],[120.778877,14.32059],[120.775726,14.31822],[120.773621,14.31899],[120.772987,14.31952],[120.77224,14.31976],[120.771523,14.31882],[120.771339,14.31775],[120.771278,14.31705],[120.770531,14.31729],[120.770073,14.31745],[120.769676,14.31781],[120.769089,14.31828],[120.768089,14.31881],[120.767509,14.31945],[120.767021,14.32038],[120.768913,14.32191],[120.770638,14.32312],[120.772591,14.32497],[120.773247,14.32551]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10553,"NAME_3":"Kanluran","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.763046,14.31687],[120.766197,14.31813],[120.769234,14.31572],[120.768738,14.31548],[120.767899,14.31517],[120.76712,14.31594],[120.766319,14.31657],[120.765717,14.31653],[120.765198,14.31578],[120.764709,14.31529],[120.764374,14.31534],[120.763611,14.31575],[120.763046,14.31687]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10554,"NAME_3":"Labac","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.727501,14.31074],[120.727501,14.31083],[120.728333,14.31167],[120.728333,14.31194],[120.730553,14.31417],[120.731079,14.31434],[120.731506,14.31455],[120.731941,14.31476],[120.73233,14.31499],[120.732742,14.3152],[120.7332,14.31533],[120.733643,14.31549],[120.734047,14.31551],[120.734123,14.31552],[120.734596,14.31547],[120.735077,14.31552],[120.735558,14.31549],[120.736,14.31532],[120.736488,14.31518],[120.737053,14.31506],[120.737663,14.31505],[120.738228,14.31514],[120.738731,14.31529],[120.73922,14.3154],[120.739754,14.31528],[120.739929,14.31525],[120.740311,14.31519],[120.740791,14.31544],[120.741249,14.31574],[120.741814,14.31583],[120.742416,14.31588],[120.742981,14.31611],[120.7435,14.31635],[120.744003,14.3165],[120.744476,14.31663],[120.74498,14.31673],[120.745422,14.31697],[120.745872,14.31728],[120.74633,14.31768],[120.746399,14.31705],[120.746422,14.31649],[120.746307,14.31613],[120.745743,14.31451],[120.74572,14.31392],[120.746071,14.31316],[120.7472,14.31252],[120.747627,14.31176],[120.747269,14.31077],[120.747269,14.31019],[120.747887,14.31001],[120.749023,14.31056],[120.74984,14.31044],[120.750641,14.30858],[120.751472,14.30825],[120.751663,14.30732],[120.751251,14.30685],[120.751167,14.30573],[120.75164,14.30486],[120.752296,14.30424],[120.752907,14.30395],[120.753052,14.30365],[120.746437,14.29659],[120.745796,14.29764],[120.745293,14.29806],[120.743797,14.29915],[120.742577,14.30067],[120.741898,14.3013],[120.740562,14.30152],[120.739609,14.30153],[120.739128,14.30179],[120.738258,14.30266],[120.737892,14.30344],[120.737221,14.3043],[120.736237,14.30493],[120.735184,14.3056],[120.73069,14.30862],[120.727501,14.31074]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10555,"NAME_3":"Latoria","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.760094,14.32985],[120.760246,14.32995],[120.760612,14.33011],[120.760887,14.33032],[120.761208,14.33049],[120.761642,14.33054],[120.762154,14.33055],[120.762688,14.33055],[120.763206,14.33056],[120.763702,14.33058],[120.763947,14.33063],[120.764732,14.33008],[120.765961,14.33096],[120.767014,14.33117],[120.767776,14.3311],[120.768448,14.33105],[120.769211,14.33038],[120.769722,14.32933],[120.765457,14.32651],[120.762527,14.32867],[120.760612,14.32961],[120.760094,14.32985]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10556,"NAME_3":"Mabolo","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.74633,14.31768],[120.746902,14.31804],[120.747551,14.31834],[120.747993,14.3185],[120.748451,14.31786],[120.749046,14.31704],[120.749802,14.3161],[120.75679,14.30764],[120.75473,14.30534],[120.753052,14.30365],[120.752907,14.30395],[120.752296,14.30424],[120.75164,14.30486],[120.751167,14.30573],[120.751251,14.30685],[120.751663,14.30732],[120.751472,14.30825],[120.750641,14.30858],[120.74984,14.31044],[120.749023,14.31056],[120.747887,14.31001],[120.747269,14.31019],[120.747269,14.31077],[120.747627,14.31176],[120.7472,14.31252],[120.746071,14.31316],[120.74572,14.31392],[120.745743,14.31451],[120.746307,14.31613],[120.746422,14.31649],[120.746399,14.31705],[120.74633,14.31768]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10557,"NAME_3":"Makina","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.775726,14.31822],[120.77623,14.31799],[120.776337,14.31736],[120.776016,14.31699],[120.775383,14.31703],[120.775131,14.31666],[120.775398,14.31625],[120.777046,14.31609],[120.77787,14.31627],[120.778267,14.3167],[120.779129,14.31653],[120.779984,14.31584],[120.780212,14.31507],[120.780144,14.31417],[120.780777,14.31381],[120.781914,14.31403],[120.779716,14.31219],[120.779213,14.31167],[120.778717,14.31116],[120.778137,14.31058],[120.776154,14.30884],[120.775749,14.3103],[120.774963,14.31186],[120.774757,14.3131],[120.771317,14.31285],[120.769661,14.31275],[120.768494,14.31254],[120.768318,14.31354],[120.768143,14.3146],[120.767899,14.31517],[120.768738,14.31548],[120.769234,14.31572],[120.769524,14.31613],[120.769814,14.31668],[120.770073,14.31745],[120.770531,14.31729],[120.771278,14.31705],[120.771339,14.31775],[120.771523,14.31882],[120.77224,14.31976],[120.772987,14.31952],[120.773621,14.31899],[120.775726,14.31822]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10558,"NAME_3":"Malainen Bago","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.767899,14.31517],[120.768143,14.3146],[120.768318,14.31354],[120.768494,14.31254],[120.768593,14.3121],[120.769157,14.31145],[120.769272,14.31056],[120.769203,14.30977],[120.769676,14.30846],[120.770462,14.30794],[120.771317,14.3086],[120.771599,14.30837],[120.772362,14.30716],[120.772537,14.3066],[120.773163,14.30608],[120.773613,14.30575],[120.773712,14.30503],[120.774094,14.30462],[120.774361,14.3042],[120.774208,14.30345],[120.774017,14.30235],[120.774811,14.30239],[120.775352,14.3017],[120.77562,14.30165],[120.775917,14.30212],[120.776398,14.30275],[120.777023,14.30223],[120.777603,14.30251],[120.777931,14.30307],[120.778503,14.30227],[120.77832,14.30128],[120.777924,14.30045],[120.777763,14.29899],[120.778053,14.29832],[120.778511,14.29719],[120.779167,14.29681],[120.780273,14.29652],[120.78064,14.29603],[120.780457,14.29537],[120.780899,14.29493],[120.780952,14.2945],[120.780212,14.29477],[120.779984,14.29418],[120.780434,14.29373],[120.780548,14.29224],[120.781189,14.29207],[120.78141,14.29118],[120.782082,14.29058],[120.779907,14.28971],[120.777046,14.28816],[120.775574,14.28685],[120.77198,14.28391],[120.761482,14.29684],[120.760094,14.29865],[120.75946,14.2995],[120.75473,14.30534],[120.75679,14.30764],[120.758423,14.30908],[120.760948,14.31142],[120.764709,14.31529],[120.765198,14.31578],[120.765717,14.31653],[120.766319,14.31657],[120.76712,14.31594],[120.767899,14.31517]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10559,"NAME_3":"Malainen Luma","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.794434,14.27777],[120.795692,14.27623],[120.796799,14.27539],[120.797752,14.2752],[120.798431,14.27461],[120.798401,14.27377],[120.798843,14.27331],[120.799072,14.27257],[120.798943,14.27116],[120.799187,14.27024],[120.79953,14.27012],[120.800102,14.26998],[120.800957,14.26899],[120.801849,14.26861],[120.802597,14.26735],[120.804024,14.26673],[120.804764,14.26612],[120.805527,14.26521],[120.807266,14.26317],[120.808327,14.26269],[120.809067,14.26174],[120.810127,14.26152],[120.810783,14.26001],[120.812187,14.2584],[120.81263,14.25872],[120.813477,14.25752],[120.814072,14.25646],[120.815041,14.25574],[120.816132,14.25479],[120.816208,14.25375],[120.816994,14.25316],[120.81781,14.25278],[120.818863,14.25252],[120.81945,14.25189],[120.819832,14.25076],[120.820511,14.24925],[120.826263,14.24232],[120.830116,14.23784],[120.81546,14.23471],[120.814468,14.23565],[120.813187,14.23765],[120.812798,14.23927],[120.811974,14.24012],[120.810806,14.24049],[120.809669,14.24196],[120.808357,14.24426],[120.807137,14.24588],[120.805428,14.24794],[120.802589,14.25125],[120.801048,14.25189],[120.799553,14.25132],[120.798248,14.25165],[120.797562,14.25312],[120.796822,14.25366],[120.796417,14.25413],[120.795967,14.25481],[120.795403,14.25595],[120.795319,14.2569],[120.795662,14.25829],[120.795952,14.25932],[120.795387,14.26042],[120.794853,14.26151],[120.794067,14.26296],[120.793411,14.26389],[120.792923,14.2645],[120.79171,14.26605],[120.790199,14.26781],[120.789307,14.26891],[120.788406,14.26957],[120.785469,14.27084],[120.783981,14.27122],[120.787018,14.276],[120.789368,14.27823],[120.792053,14.28081],[120.792503,14.28015],[120.793427,14.27897],[120.794434,14.27777]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10560,"NAME_3":"Molino","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.786659,14.29179],[120.787956,14.28963],[120.788612,14.2884],[120.792213,14.28238],[120.792686,14.2815],[120.792053,14.28081],[120.789368,14.27823],[120.787018,14.276],[120.783981,14.27122],[120.7817,14.2724],[120.7799,14.27285],[120.779259,14.27287],[120.778679,14.27272],[120.777924,14.2737],[120.777557,14.2741],[120.776573,14.27447],[120.775352,14.27459],[120.773949,14.27451],[120.772163,14.27538],[120.770981,14.27596],[120.769112,14.27708],[120.768066,14.27766],[120.767036,14.27842],[120.771317,14.2832],[120.77198,14.28391],[120.775574,14.28685],[120.777046,14.28816],[120.779907,14.28971],[120.782082,14.29058],[120.782379,14.29027],[120.783401,14.28984],[120.785629,14.29099],[120.786659,14.29179]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10561,"NAME_3":"Munting Mapino","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.783432,14.3349],[120.77964,14.3313],[120.77916,14.33102],[120.774933,14.32707],[120.773247,14.32551],[120.772591,14.32497],[120.771744,14.32605],[120.77137,14.32683],[120.77076,14.32727],[120.770157,14.32789],[120.769821,14.32828],[120.769722,14.32933],[120.769211,14.33038],[120.768448,14.33105],[120.767776,14.3311],[120.767014,14.33117],[120.765961,14.33096],[120.764732,14.33008],[120.763947,14.33063],[120.764137,14.33066],[120.764526,14.33078],[120.7649,14.33083],[120.765259,14.3309],[120.765602,14.33106],[120.765984,14.33118],[120.766342,14.33134],[120.766762,14.33144],[120.767151,14.33161],[120.767563,14.33169],[120.767937,14.33183],[120.76828,14.33201],[120.768578,14.33226],[120.768837,14.33259],[120.769073,14.33299],[120.769417,14.33334],[120.769791,14.33372],[120.770058,14.33416],[120.770317,14.33464],[120.77066,14.3351],[120.771019,14.33554],[120.77137,14.33595],[120.77166,14.33633],[120.771912,14.33665],[120.772141,14.33694],[120.772346,14.3372],[120.772552,14.33742],[120.772774,14.33763],[120.772972,14.33785],[120.773132,14.33811],[120.773331,14.33833],[120.773529,14.33855],[120.773697,14.33882],[120.773933,14.3391],[120.774178,14.33943],[120.774452,14.33978],[120.77475,14.34015],[120.775047,14.3405],[120.77536,14.34084],[120.775627,14.34119],[120.775887,14.34156],[120.776207,14.3419],[120.776253,14.34193],[120.783432,14.3349]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10562,"NAME_3":"Muzon","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.75473,14.30534],[120.75946,14.2995],[120.760094,14.29865],[120.761482,14.29684],[120.77198,14.28391],[120.771317,14.2832],[120.767036,14.27842],[120.765556,14.27953],[120.763527,14.28064],[120.761757,14.28257],[120.756813,14.28615],[120.752419,14.29057],[120.748428,14.29473],[120.746437,14.29659],[120.753052,14.30365],[120.75473,14.30534]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10563,"NAME_3":"Palangue 1","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.824249,14.28712],[120.824547,14.28576],[120.825531,14.2839],[120.826576,14.28211],[120.827164,14.28046],[120.827538,14.2785],[120.828331,14.27726],[120.829071,14.27591],[120.830704,14.27488],[120.832123,14.27404],[120.83358,14.2724],[120.834877,14.27046],[120.837608,14.26852],[120.84008,14.2674],[120.842598,14.26605],[120.845612,14.26456],[120.845993,14.26402],[120.846367,14.26258],[120.847366,14.26168],[120.84819,14.26081],[120.848877,14.25942],[120.850616,14.25837],[120.851151,14.25713],[120.852226,14.25636],[120.853043,14.25589],[120.85363,14.25501],[120.854843,14.25417],[120.855797,14.25342],[120.856667,14.25242],[120.857269,14.25186],[120.858932,14.25047],[120.860161,14.24863],[120.860924,14.24762],[120.860977,14.24743],[120.861153,14.24699],[120.86116,14.24634],[120.841423,14.24068],[120.840408,14.24005],[120.830116,14.23784],[120.826263,14.24232],[120.820511,14.24925],[120.819832,14.25076],[120.81945,14.25189],[120.818863,14.25252],[120.81781,14.25278],[120.816994,14.25316],[120.816208,14.25375],[120.816132,14.25479],[120.815041,14.25574],[120.814072,14.25646],[120.813477,14.25752],[120.81263,14.25872],[120.812187,14.2584],[120.810783,14.26001],[120.810127,14.26152],[120.809067,14.26174],[120.808327,14.26269],[120.807266,14.26317],[120.805527,14.26521],[120.804764,14.26612],[120.804024,14.26673],[120.802597,14.26735],[120.801849,14.26861],[120.800957,14.26899],[120.800102,14.26998],[120.79953,14.27012],[120.799187,14.27024],[120.798943,14.27116],[120.799072,14.27257],[120.798843,14.27331],[120.798401,14.27377],[120.798431,14.27461],[120.797752,14.2752],[120.796799,14.27539],[120.795692,14.27623],[120.794434,14.27777],[120.799454,14.27923],[120.806091,14.28108],[120.810387,14.28262],[120.811623,14.28306],[120.813179,14.28332],[120.814919,14.28395],[120.820442,14.28561],[120.824249,14.28712]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10564,"NAME_3":"Palangue 2 & 3","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.824249,14.28712],[120.820442,14.28561],[120.814919,14.28395],[120.813179,14.28332],[120.811623,14.28306],[120.810387,14.28262],[120.806091,14.28108],[120.799454,14.27923],[120.794434,14.27777],[120.793427,14.27897],[120.792503,14.28015],[120.792053,14.28081],[120.792686,14.2815],[120.792213,14.28238],[120.798309,14.2857],[120.802063,14.28757],[120.804901,14.28931],[120.806229,14.28998],[120.809769,14.29181],[120.81057,14.29228],[120.813843,14.29398],[120.819939,14.29436],[120.820732,14.2926],[120.821609,14.2913],[120.822838,14.28971],[120.823647,14.28833],[120.824249,14.28712]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10565,"NAME_3":"Sabang","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.788643,14.33889],[120.789307,14.33951],[120.792732,14.34074],[120.794243,14.34066],[120.7957,14.34114],[120.797279,14.34136],[120.799011,14.33994],[120.80159,14.33861],[120.803528,14.3379],[120.803902,14.33652],[120.804771,14.33587],[120.805656,14.33537],[120.806343,14.3347],[120.806549,14.33396],[120.807983,14.33238],[120.809158,14.33198],[120.810867,14.33117],[120.813759,14.32859],[120.813812,14.32728],[120.814857,14.32588],[120.815437,14.32531],[120.816597,14.32479],[120.818443,14.32394],[120.818871,14.32316],[120.819069,14.32229],[120.819817,14.32115],[120.820297,14.32056],[120.820663,14.31985],[120.821167,14.31948],[120.822182,14.31878],[120.822487,14.31704],[120.822533,14.31642],[120.822258,14.31442],[120.822929,14.31309],[120.823288,14.31146],[120.823837,14.30945],[120.82431,14.30771],[120.824966,14.30622],[120.825073,14.30456],[120.824379,14.30272],[120.823463,14.30082],[120.822388,14.29903],[120.821381,14.29831],[120.820297,14.29734],[120.815407,14.3016],[120.814293,14.30287],[120.813179,14.30343],[120.812668,14.3024],[120.811897,14.30196],[120.811562,14.30122],[120.81073,14.30081],[120.809601,14.3011],[120.809677,14.30198],[120.808243,14.30261],[120.807747,14.30351],[120.807037,14.30409],[120.807091,14.3045],[120.805817,14.30476],[120.803978,14.30431],[120.803482,14.30436],[120.802559,14.3051],[120.800812,14.30515],[120.799843,14.30533],[120.799156,14.30575],[120.798843,14.30679],[120.798538,14.30773],[120.797394,14.30863],[120.79641,14.30895],[120.795212,14.30953],[120.795059,14.3103],[120.795502,14.31064],[120.795517,14.31139],[120.794617,14.31257],[120.793159,14.31382],[120.792542,14.31418],[120.791977,14.31496],[120.790672,14.3157],[120.789467,14.31593],[120.788643,14.31569],[120.787987,14.31516],[120.787216,14.31496],[120.78614,14.31564],[120.785332,14.31589],[120.784416,14.31578],[120.783188,14.31485],[120.781914,14.31403],[120.780777,14.31381],[120.780144,14.31417],[120.780212,14.31507],[120.779984,14.31584],[120.779129,14.31653],[120.778267,14.3167],[120.77787,14.31627],[120.777046,14.31609],[120.775398,14.31625],[120.775131,14.31666],[120.775383,14.31703],[120.776016,14.31699],[120.776337,14.31736],[120.77623,14.31799],[120.775726,14.31822],[120.778877,14.32059],[120.780998,14.32235],[120.781349,14.32267],[120.778954,14.32391],[120.77565,14.32507],[120.774567,14.32522],[120.773247,14.32551],[120.774933,14.32707],[120.77916,14.33102],[120.77964,14.3313],[120.783432,14.3349],[120.784019,14.33548],[120.785622,14.33652],[120.788643,14.33889]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10566,"NAME_3":"San Roque","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.781914,14.31403],[120.783188,14.31485],[120.784416,14.31578],[120.785332,14.31589],[120.78614,14.31564],[120.787216,14.31496],[120.787987,14.31516],[120.788643,14.31569],[120.789467,14.31593],[120.790672,14.3157],[120.791977,14.31496],[120.792542,14.31418],[120.793159,14.31382],[120.794617,14.31257],[120.795517,14.31139],[120.795502,14.31064],[120.795059,14.3103],[120.795212,14.30953],[120.79641,14.30895],[120.797394,14.30863],[120.798538,14.30773],[120.798843,14.30679],[120.799156,14.30575],[120.799843,14.30533],[120.800812,14.30515],[120.798698,14.3027],[120.796928,14.30077],[120.795929,14.30115],[120.795471,14.30197],[120.793854,14.30352],[120.792648,14.30341],[120.79213,14.30448],[120.79174,14.30554],[120.791344,14.30624],[120.790604,14.30655],[120.790253,14.30608],[120.789886,14.30639],[120.78952,14.3074],[120.788879,14.30703],[120.788567,14.30743],[120.787827,14.30755],[120.787018,14.30689],[120.786102,14.30674],[120.785881,14.30723],[120.783958,14.30623],[120.783112,14.30549],[120.779778,14.30327],[120.778503,14.30227],[120.777931,14.30307],[120.777603,14.30251],[120.777023,14.30223],[120.776398,14.30275],[120.775917,14.30212],[120.77562,14.30165],[120.775352,14.3017],[120.774811,14.30239],[120.774017,14.30235],[120.774208,14.30345],[120.774361,14.3042],[120.774094,14.30462],[120.773712,14.30503],[120.773613,14.30575],[120.773163,14.30608],[120.772537,14.3066],[120.772362,14.30716],[120.773453,14.30754],[120.776154,14.30884],[120.778137,14.31058],[120.778717,14.31116],[120.779213,14.31167],[120.779716,14.31219],[120.781914,14.31403]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10567,"NAME_3":"Santulan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.768494,14.31254],[120.769661,14.31275],[120.771317,14.31285],[120.774757,14.3131],[120.774963,14.31186],[120.775749,14.3103],[120.776154,14.30884],[120.773453,14.30754],[120.772362,14.30716],[120.771599,14.30837],[120.771317,14.3086],[120.770462,14.30794],[120.769676,14.30846],[120.769203,14.30977],[120.769272,14.31056],[120.769157,14.31145],[120.768593,14.3121],[120.768494,14.31254]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10568,"NAME_3":"Sapa","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.754112,14.32407],[120.754204,14.3242],[120.754471,14.3246],[120.754807,14.32502],[120.755188,14.32543],[120.75563,14.32561],[120.756088,14.32519],[120.756378,14.32468],[120.756508,14.32416],[120.756622,14.32366],[120.756737,14.32314],[120.756866,14.32269],[120.755623,14.32164],[120.755127,14.32243],[120.754112,14.32407]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10569,"NAME_3":"Timalan Balsahan","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.776253,14.34193],[120.776588,14.34224],[120.776947,14.3426],[120.777298,14.34298],[120.777634,14.34336],[120.77787,14.34373],[120.778099,14.34394],[120.778259,14.34424],[120.778481,14.34461],[120.77877,14.34497],[120.778938,14.34525],[120.779556,14.34484],[120.780693,14.34406],[120.788643,14.33889],[120.785622,14.33652],[120.784019,14.33548],[120.783432,14.3349],[120.776253,14.34193]]]}},{"type":"Feature","properties":{"ID_0":177,"ISO":"PHL","NAME_0":"Philippines","ID_1":24,"NAME_1":"Cavite","ID_2":432,"NAME_2":"Naic","ID_3":10570,"NAME_3":"Timalan Concepcion","NL_NAME_3":"","VARNAME_3":"","TYPE_3":"Barangay","ENGTYPE_3":"Village","PROVINCE":"Cavite","REGION":"CALABARZON (Region IV-A)"},"geometry":{"type":"Polygon","coordinates":[[[120.778938,14.34525],[120.779007,14.34537],[120.77919,14.34579],[120.779373,14.34617],[120.779533,14.34659],[120.77977,14.34699],[120.780037,14.34738],[120.780357,14.34777],[120.780693,14.34819],[120.78083,14.34833],[120.780563,14.34861],[120.783401,14.34693],[120.783463,14.34691],[120.785927,14.34637],[120.786774,14.34622],[120.788094,14.34523],[120.789192,14.34419],[120.790558,14.3429],[120.792236,14.34101],[120.792732,14.34074],[120.789307,14.33951],[120.788643,14.33889],[120.780693,14.34406],[120.779556,14.34484],[120.778938,14.34525]]]}}]'),FR={type:dW,features:hW},fW=({db:r,showNotification:e})=>{const[t,n]=J.useState([]),[i,s]=J.useState(!0),[o,l]=J.useState(""),d=J.useCallback(async()=>{s(!0),l("");const m=await x2(r);m.success?n(m.data):(l(m.error||"Failed loading advisories."),e(m.error||"Failed loading advisories.","error")),s(!1)},[r,e]);J.useEffect(()=>{d()},[d]);const f=(m,y)=>{if((y==="Emergency Repair"||y==="Leak Detection")&&m!=="Resolved")return{icon:u3,color:"text-red-700",bgColor:"bg-red-50",borderColor:"border-red-400",label:"Emergency"};switch(m){case"Ongoing":return{icon:Kt,color:"text-orange-600",bgColor:"bg-orange-50",borderColor:"border-orange-400",label:"Ongoing"};case"Scheduled":return{icon:di,color:"text-blue-600",bgColor:"bg-blue-50",borderColor:"border-blue-400",label:"Scheduled"};case"Resolved":return{icon:Ps,color:"text-green-600",bgColor:"bg-green-50",borderColor:"border-green-400",label:"Resolved"};default:return{icon:gn,color:"text-gray-500",bgColor:"bg-gray-50",borderColor:"border-gray-400",label:m||"Unknown"}}};return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6 pb-4 border-b border-gray-200",children:[u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(Kt,{size:30,className:"mr-3 text-orange-500"})," Service Advisories"]}),u.jsxs("button",{onClick:d,disabled:i,className:"flex items-center text-sm p-2 bg-gray-100 rounded-lg hover:bg-gray-200 border border-gray-300",children:[i?u.jsx(Et,{size:16,className:"animate-spin"}):u.jsx(za,{size:16}),u.jsx("span",{className:"ml-1.5 hidden sm:inline",children:"Refresh"})]})]}),i&&u.jsx(an,{message:"Loading advisories..."}),o&&u.jsx("div",{className:"text-red-600 bg-red-50 p-3 rounded-md text-center border border-red-200",children:o}),!i&&!o&&t.length===0&&u.jsxs("div",{className:"text-center py-10 bg-green-50 p-6 rounded-lg shadow-inner border border-green-200",children:[u.jsx(Ps,{size:48,className:"mx-auto text-green-400 mb-4"}),u.jsx("p",{className:"text-gray-700 text-lg font-medium",children:"No Active Service Advisories"}),u.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Water service is currently stable."})]}),!i&&!o&&t.length>0&&u.jsx("div",{className:"space-y-4",children:t.map(m=>{var E;const y=f(m.status,m.type),g=y.icon,_=uo.sanitize(m.description||"");return u.jsxs("details",{className:`p-4 rounded-lg shadow-md border-l-4 group transition-all duration-300 ease-in-out ${y.borderColor} ${y.bgColor} hover:shadow-lg`,children:[u.jsxs("summary",{className:"flex justify-between items-center cursor-pointer list-none",children:[u.jsxs("div",{className:"flex-grow pr-4",children:[u.jsx("h3",{className:"text-md sm:text-lg font-semibold text-gray-800",children:m.title||"Service Advisory"}),u.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:["ID: ",m.id.substring(0,8),"..."]})]}),u.jsxs("span",{className:`px-2.5 py-1 text-xs font-semibold rounded-full flex items-center shrink-0 ${y.bgColor==="bg-red-50"?"bg-red-100 text-red-700":y.bgColor==="bg-blue-50"?"bg-blue-100 text-blue-700":y.bgColor==="bg-orange-50"?"bg-orange-100 text-orange-700":"bg-green-100 text-green-700"}`,children:[u.jsx(g,{size:14,className:`mr-1.5 ${y.color}`})," ",y.label]}),u.jsx("span",{className:"ml-2 transition-transform duration-300 transform group-open:rotate-180 text-gray-500",children:""})]}),u.jsx("div",{className:"mt-4 pt-3 border-t border-gray-200/80 text-sm text-gray-700 space-y-3 grid grid-rows-[0fr] group-open:grid-rows-[1fr] transition-all duration-500 ease-in-out",children:u.jsxs("div",{className:"overflow-hidden space-y-4",children:[u.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:_}}),u.jsxs("div",{children:[u.jsxs("h4",{className:"text-sm font-semibold text-gray-700 mb-2 flex items-center",children:[u.jsx(ic,{size:16,className:"mr-2 text-gray-500"}),"Affected Area Map"]}),u.jsx(LR,{geoJsonData:FR,affectedAreas:m.affectedAreas||[]})]}),u.jsxs("div",{className:"text-xs text-gray-600 space-y-1 border-t border-gray-200/80 pt-3 mt-3",children:[u.jsxs("p",{className:"flex items-center",children:[u.jsx(co,{size:12,className:"mr-1.5 text-gray-400"}),u.jsx("strong",{children:"Affected:"})," ",((E=m.affectedAreas)==null?void 0:E.join(", "))||"N/A"]}),u.jsxs("p",{className:"flex items-center",children:[u.jsx(di,{size:12,className:"mr-1.5 text-gray-400"}),u.jsx("strong",{children:"Start:"})," ",$t(m.startDate)]}),m.estimatedEndDate&&u.jsxs("p",{className:"flex items-center",children:[u.jsx(di,{size:12,className:"mr-1.5 text-gray-400"}),u.jsx("strong",{children:"Est. End:"})," ",$t(m.estimatedEndDate)]})]})]})})]},m.id)})})]})},mW=({db:r,showNotification:e})=>{const[t,n]=J.useState([]),[i,s]=J.useState(!0),[o,l]=J.useState(""),d=J.useCallback(async()=>{s(!0),l("");const m=await x2(r);if(m.success){const y=new Set;m.data.forEach(g=>{var _;(_=g.affectedAreas)==null||_.forEach(E=>{y.add(E)})}),n(Array.from(y))}else l(m.error||"Failed loading advisory data."),e(m.error||"Failed loading advisories.","error");s(!1)},[r,e]);J.useEffect(()=>{d()},[d]);const f=J.useMemo(()=>FR,[]);return u.jsxs("div",{className:"p-4 sm:p-6 bg-white rounded-xl shadow-xl animate-fadeIn h-[calc(100vh-4rem)] flex flex-col",children:[u.jsx("div",{className:"flex justify-between items-center mb-4 pb-4 border-b border-gray-200",children:u.jsxs("h2",{className:"text-2xl sm:text-3xl font-semibold text-gray-800 flex items-center",children:[u.jsx(ic,{size:30,className:"mr-3 text-red-600"}),"Active Interruption Map"]})}),i&&u.jsx(an,{message:"Loading map data..."}),o&&u.jsx("div",{className:"text-red-600 bg-red-50 p-3 rounded-md text-center border border-red-200",children:o}),!i&&!o&&u.jsxs("div",{className:"space-y-4 flex-grow flex flex-col",children:[u.jsxs("p",{className:"text-sm text-gray-600",children:["The map below highlights all areas currently affected by any active service advisory.",t.length===0?" Currently, there are no advisories reporting specific affected areas.":` A total of ${t.length} barangay(s) are affected.`]}),u.jsx("div",{className:"flex-grow w-full rounded-lg overflow-hidden border border-gray-300 shadow-inner relative z-10",children:u.jsx(LR,{geoJsonData:f,affectedAreas:t,height:"100%"})})]})]})},v4=({onNavigateHome:r})=>u.jsxs("div",{className:"flex flex-col items-center justify-center text-center p-6 bg-gray-50 rounded-lg shadow-md m-4",children:[u.jsx(B9,{size:48,className:"text-yellow-500 mb-4"}),u.jsx("h1",{className:"text-2xl font-bold text-gray-700 mb-2",children:"404 - Page Not Found"}),u.jsx("p",{className:"text-gray-600 mb-4 max-w-md",children:"The page you are looking for does not exist or has been moved."}),r&&u.jsxs("button",{onClick:r,className:"flex items-center justify-center px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-semibold rounded-lg shadow hover:shadow-md transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50",children:[u.jsx(N2,{size:16,className:"mr-2"}),"Go to Dashboard"]})]}),pW=({isOpen:r,onClose:e,userData:t,showNotification:n,setActiveDashboardSection:i})=>{const s={role:"assistant",text:`Hello, ${(t==null?void 0:t.displayName)||"Valued Customer"}! I am Agie, your AGWA Water Services virtual assistant. How can I help you today with your account (${(t==null?void 0:t.accountNumber)||"N/A"}) or other water service inquiries?`},[o,l]=J.useState([s]),[d,f]=J.useState(""),[m,y]=J.useState(!1),[g,_]=J.useState(!1),[E,x]=J.useState(""),b=J.useRef(null);J.useEffect(()=>{b.current&&(b.current.scrollTop=b.current.scrollHeight)},[o]),J.useEffect(()=>{r&&(l([s]),f(""),y(!1),_(!1),x(""))},[r,t]);const T=async j=>{if(j.preventDefault(),!d.trim()||m)return;const U={role:"user",text:d},C=[...o,U];l(C),f(""),y(!0),_(!1),x("");try{const k=`You are Agie, the friendly and professional AI assistant for AGWA Water Services, a major water utility provider in the Philippines.
Current Customer Details:
- Name: ${t.displayName||"Valued Customer"}
- Account Number: ${t.accountNumber||"Not available"}
- Service Type: ${t.serviceType||"Not specified"}

Your primary goals are:
1.  Understand the customer's query accurately. Queries can be about billing, payments, account management, water quality, leaks, service interruptions, how to use the portal, etc.
2.  Provide clear, concise, helpful, and empathetic responses.
3.  If the query is straightforward and answerable with general knowledge or information commonly found in FAQs (e.g., "how to pay my bill?", "what is FCDA?"), provide the answer.
4.  If the query implies needing specific account data you don't have (e.g., "what was my last payment amount?", "is my meter reading correct for May?"), explain you cannot access real-time specific account details but can guide them to where they might find it in the portal (e.g., "You can check your detailed bill history under 'My Bills' section").
5.  If the customer expresses frustration, has a complex issue (like a persistent leak or no water for an extended time), or directly asks to speak to a human or create a ticket, ALWAYS offer to help them create a support ticket. In this specific scenario, and ONLY in this scenario, end your response with the exact phrase: "WOULD_YOU_LIKE_A_TICKET?".
6.  Do NOT use the phrase "WOULD_YOU_LIKE_A_TICKET?" if you are providing a direct answer or general guidance.
7.  Be polite, patient, and professional. Avoid overly technical jargon unless necessary and explain it if used.
8.  If the user's query is very vague, ask clarifying questions.
9.  Do not make up information or promise actions you cannot perform.
10. Keep responses relatively brief and to the point.

Respond to the customer's latest message based on the conversation history.`,D=await _F(C,k);if(D.includes("WOULD_YOU_LIKE_A_TICKET?")){const O=D.replace("WOULD_YOU_LIKE_A_TICKET?","").trim();l(P=>[...P,{role:"assistant",text:O}]),_(!0)}else l(O=>[...O,{role:"assistant",text:D}])}catch(k){console.error("Chatbot API error:",k);const D="I'm currently experiencing some technical difficulties and can't respond right now. Please try again in a few moments. If the issue persists, you might want to report an issue directly through the portal.";l(O=>[...O,{role:"assistant",text:D}]),x("Failed to get response from assistant.")}finally{y(!1)}},N=()=>{var C;const U=o.slice(-5).map(k=>`${k.role==="user"?t.displayName||"You":"Agie"}: ${k.text}`).join(`

`);localStorage.setItem("chatbotIssueDescription",`Issue raised via Chatbot Agie:

${U}

Initial User Query (if available):
${((C=o.find(k=>k.role==="user"))==null?void 0:C.text)||"User initiated ticket creation from chat."}`),localStorage.setItem("chatbotIssueTypeSuggestion","Chatbot Assistance Follow-up"),e(),i&&i("reportIssue"),n("Please review and submit the support ticket drafted from your chat.","success")},R=["How to pay my bill?","Report a water leak.","My water pressure is low.","What are current announcements?"],I=j=>{f(j)};return u.jsxs(Ar,{isOpen:r,onClose:e,title:"Chat with Agie - Your AGWA Assistant",size:"lg",children:[u.jsx("style",{children:`
                .animate-message-appear {
                    animation: message-appear 0.3s ease-out forwards;
                }
                @keyframes message-appear {
                    from { opacity: 0; transform: translateY(10px) scale(0.98); }
                    to { opacity: 1; transform: translateY(0) scale(1); }
                }
                .chatbot-input-shadow {
                    box-shadow: 0 -2px 10px rgba(0,0,0,0.05);
                }
            `}),u.jsxs("div",{className:"flex flex-col h-[65vh] sm:h-[70vh] bg-gray-50",children:[u.jsxs("div",{ref:b,className:"flex-grow p-4 space-y-4 overflow-y-auto",children:[o.map((j,U)=>{var C;return u.jsxs("div",{className:`flex items-end animate-message-appear ${j.role==="user"?"justify-end":"justify-start"}`,children:[j.role==="assistant"&&u.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-2",children:u.jsx(Os,{size:18})}),u.jsx("div",{className:`max-w-[75%] p-3 rounded-2xl shadow-sm ${j.role==="user"?"bg-blue-600 text-white rounded-br-none":"bg-white text-gray-800 border border-gray-200 rounded-bl-none"}`,children:u.jsx("p",{className:"text-sm whitespace-pre-wrap",children:j.text})}),j.role==="user"&&u.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-gray-300 text-gray-600 flex items-center justify-center ml-2 uppercase",children:((C=t==null?void 0:t.displayName)==null?void 0:C.charAt(0))||"U"})]},U)}),m&&u.jsxs("div",{className:"flex items-end justify-start animate-message-appear",children:[u.jsx("div",{className:"flex-shrink-0 h-8 w-8 rounded-full bg-blue-500 text-white flex items-center justify-center mr-2",children:u.jsx(Os,{size:18})}),u.jsx("div",{className:"max-w-[75%] p-3 rounded-2xl shadow-sm bg-white text-gray-800 border border-gray-200 rounded-bl-none",children:u.jsx(an,{size:"h-5 w-5",color:"text-blue-500",message:""})})]}),E&&u.jsxs("div",{className:"flex items-center justify-center p-3 bg-red-50 text-red-700 rounded-lg animate-message-appear",children:[u.jsx(Kt,{size:20,className:"mr-2"}),u.jsx("p",{className:"text-sm",children:E})]})]}),g&&u.jsx("div",{className:"p-3 border-t border-gray-200 bg-white",children:u.jsxs("button",{onClick:N,className:"w-full flex items-center justify-center bg-green-600 hover:bg-green-700 text-white font-semibold py-2.5 px-4 rounded-lg transition-all duration-150 active:scale-95 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-opacity-50",children:[u.jsx($9,{size:20,className:"mr-2"})," Create Support Ticket from this Chat"]})}),!g&&o.length<=1&&u.jsx("div",{className:"p-2 border-t border-gray-200 bg-white flex flex-wrap gap-2 justify-center",children:R.map(j=>u.jsx("button",{onClick:()=>I(j),className:"text-xs bg-blue-100 text-blue-700 hover:bg-blue-200 px-3 py-1.5 rounded-full transition-colors",disabled:m,children:j},j))}),u.jsxs("form",{onSubmit:T,className:"p-3 border-t border-gray-200 flex items-center space-x-3 bg-white chatbot-input-shadow",children:[u.jsx("input",{type:"text",value:d,onChange:j=>f(j.target.value),placeholder:"Type your message to Agie...",className:"flex-grow px-4 py-2.5 border border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-shadow focus:shadow-md text-sm",disabled:m,"aria-label":"Chat input"}),u.jsx("button",{type:"submit",className:"bg-blue-600 hover:bg-blue-700 text-white p-3 rounded-xl disabled:opacity-60 disabled:cursor-not-allowed transition-all duration-150 active:scale-90 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-opacity-50",disabled:m||!d.trim(),"aria-label":"Send message",children:u.jsx(n0,{size:20})})]})]})]})},gW=({isOpen:r,onLink:e,isLinking:t,error:n,onLogout:i})=>{const[s,o]=J.useState("");J.useEffect(()=>{r||o("")},[r]);const l=d=>{d.preventDefault(),s.trim()&&e(s.trim())};return u.jsx(Ar,{isOpen:r,onClose:()=>{},title:"Link Your AGWA Account",hideCloseButton:!0,size:"md",children:u.jsxs("form",{onSubmit:l,className:"space-y-5",children:[u.jsx("p",{className:"text-sm text-center text-gray-600",children:"To access services, please link your official AGWA account number. This is a one-time step for accounts created with Google or an Email Link."}),n&&u.jsx("div",{className:"text-center p-2 bg-red-100 text-red-700 rounded-md text-sm border border-red-200",children:n}),u.jsxs("div",{className:"relative",children:[u.jsx(Rs,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),u.jsx("input",{type:"text",placeholder:"AGWA Account Number (e.g., RES-12345)",value:s,onChange:d=>o(d.target.value),className:`${Fi} pl-11`,required:!0,disabled:t,"aria-label":"AGWA Account Number",autoFocus:!0})]}),u.jsxs("button",{type:"submit",className:nm(t||!s.trim()),disabled:t||!s.trim(),children:[t?u.jsx(Et,{className:"animate-spin inline mr-2",size:18}):u.jsx(I2,{className:"inline mr-2",size:18}),t?"Linking...":"Link My Account"]}),u.jsx("div",{className:"text-center mt-4",children:u.jsxs("button",{type:"button",onClick:i,className:"text-sm font-medium text-gray-500 hover:text-red-600 hover:underline",children:[u.jsx(t0,{size:14,className:"inline mr-1"})," Not you? Logout"]})})]})})},yW=({user:r,userData:e,setUserData:t,handleLogout:n,showNotification:i,auth:s,db:o})=>{const[l,d]=J.useState("mainDashboard"),[f,m]=J.useState(!1),[y,g]=J.useState(!1),[_,E]=J.useState(!1),[x,b]=J.useState(!1),[T,N]=J.useState(""),[R,I]=J.useState(null),[j,U]=J.useState({});J.useEffect(()=>{e&&!e.accountNumber&&e.role==="customer"?E(!0):E(!1)},[e]),J.useEffect(()=>{if(!o)return;const M=zt(o,Ud()),$=Cx(M,Y=>{if(Y.exists()){const te=Y.data();U(te),te.isBannerEnabled&&te.portalAnnouncement?I({text:te.portalAnnouncement}):I(null)}else I(null),U({})},Y=>{console.error("Error fetching system settings:",Y),I(null),U({})});return()=>$()},[o]);const C=J.useCallback(M=>{d(M),f&&m(!1)},[f]),k=async M=>{b(!0),N("");const $=await $8(o,r.uid,M);if($.success){const Y=await _2(o,r.uid);Y.success?(t(Y.data),E(!1),i("Account linked successfully!","success")):(N("Account linked, but failed to refresh profile. Please reload."),i("Account linked, but failed to refresh profile.","warning"))}else N($.error||"Failed linking account. Check number or contact support.");b(!1)},D={customer:[{name:"Dashboard",iconName:"Home",section:"mainDashboard",group:"Main"},{name:"My Profile",iconName:"UserCog",section:"myProfile",group:"Account"},{name:"My Bills & Payments",iconName:"FileText",section:"myBills",group:"Account"},{name:"Consumption Analytics",iconName:"TrendingUp",section:"waterAnalytics",group:"Account"},{name:"Payment Analytics",iconName:"CreditCard",section:"paymentAnalytics",group:"Account"},{name:"Rewards Program",iconName:"Gift",section:"rebateProgram",group:"Account"},{name:"My Support Tickets",iconName:"MessageSquare",section:"myTickets",group:"Support"},{name:"Report an Issue",iconName:"AlertTriangle",section:"reportIssue",group:"Support"},{name:"View Announcements",iconName:"Megaphone",section:"viewAnnouncements",group:"Information"},{name:"Service Advisories",iconName:"AlertIcon",section:"serviceAdvisories",group:"Information"},{name:"Interruption Map",iconName:"Map",section:"interruptionMap",group:"Information"},{name:"FAQs",iconName:"HelpCircle",section:"faqs",group:"Help & Info"},{name:"About Us",iconName:"Info",section:"aboutUs",group:"Help & Info"},{name:"Contact Us",iconName:"PhoneCall",section:"contactUs",group:"Help & Info"}],admin:[{name:"Dashboard",iconName:"Home",section:"mainDashboard",group:"Main"},{name:"System Analytics",iconName:"BarChart3",section:"systemAnalytics",group:"Main"},{name:"User Management",iconName:"Users",section:"userManagement",group:"Administration"},{name:"Support Tickets",iconName:"MessageSquare",section:"supportTickets",group:"Administration"},{name:"Manage Announcements",iconName:"Edit",section:"manageAnnouncements",group:"Administration"},{name:"Manage Interruptions",iconName:"AlertIcon",section:"manageInterruptions",group:"Administration"},{name:"System Settings",iconName:"Settings",section:"systemSettings",group:"Administration"},{name:"Batch Billing",iconName:"FileText",section:"batchBilling",group:"Operations"},{name:"Meter Reading Mgt.",iconName:"Gauge",section:"editMeterReadingsAdmin",group:"Operations"},{name:"Route Management",iconName:"Map",section:"routeManagement",group:"Operations"},{name:"My Profile",iconName:"UserCog",section:"myProfile",group:"Account"},{name:"Interruption Map",iconName:"Map",section:"interruptionMap",group:"Information"},{name:"FAQs",iconName:"HelpCircle",section:"faqs",group:"Help & Info"},{name:"About Us",iconName:"Info",section:"aboutUs",group:"Help & Info"},{name:"Contact Us",iconName:"PhoneCall",section:"contactUs",group:"Help & Info"}],meter_reader:[{name:"Dashboard",iconName:"Home",section:"mainDashboard",group:"Main"},{name:"Assigned Routes",iconName:"Map",section:"assignedRoutes",group:"Operations"},{name:"Submit Reading",iconName:"ClipboardEdit",section:"searchAndSubmitReading",group:"Operations"},{name:"Search Customer",iconName:"Search",section:"searchCustomerMeterReader",group:"Operations"},{name:"My Profile",iconName:"UserCog",section:"myProfile",group:"Account"},{name:"My Support Tickets",iconName:"MessageSquare",section:"myTickets",group:"Support"},{name:"Report an Issue",iconName:"AlertTriangle",section:"reportIssue",group:"Support"},{name:"View Announcements",iconName:"Megaphone",section:"viewAnnouncements",group:"Information"},{name:"Service Advisories",iconName:"AlertIcon",section:"serviceAdvisories",group:"Information"},{name:"Interruption Map",iconName:"Map",section:"interruptionMap",group:"Information"},{name:"FAQs",iconName:"HelpCircle",section:"faqs",group:"Help & Info"},{name:"Contact Us",iconName:"PhoneCall",section:"contactUs",group:"Help & Info"}],clerk_cashier:[{name:"Dashboard",iconName:"Home",section:"mainDashboard",group:"Main"},{name:"Process Walk-in Payment",iconName:"Banknote",section:"walkInPayments",group:"Operations"},{name:"Search Account / Bill",iconName:"FileSearch",section:"searchAccountOrBill",group:"Operations"},{name:"My Profile",iconName:"UserCog",section:"myProfile",group:"Account"},{name:"My Support Tickets",iconName:"MessageSquare",section:"myTickets",group:"Support"},{name:"Report an Issue",iconName:"AlertTriangle",section:"reportIssue",group:"Support"},{name:"View Announcements",iconName:"Megaphone",section:"viewAnnouncements",group:"Information"},{name:"Service Advisories",iconName:"AlertIcon",section:"serviceAdvisories",group:"Information"},{name:"Interruption Map",iconName:"Map",section:"interruptionMap",group:"Information"},{name:"FAQs",iconName:"HelpCircle",section:"faqs",group:"Help & Info"},{name:"Contact Us",iconName:"PhoneCall",section:"contactUs",group:"Help & Info"}]},O=D[e.role]||D.customer,P=()=>{const M={user:r,userData:e,setUserData:t,auth:s,db:o,showNotification:i,billingService:WC,determineServiceTypeAndRole:y2,setActiveSection:C,systemSettings:j};if(!e||e.role==="customer"&&!e.accountNumber)return null;switch(l){case"mainDashboard":if(e.role==="customer")return u.jsx(wF,{...M});if(e.role==="admin")return u.jsx(qq,{...M});if(e.role==="meter_reader")return u.jsx(F$,{...M});if(e.role==="clerk_cashier")return u.jsx(q$,{...M});break;case"myProfile":return u.jsx(Oq,{...M});case"reportIssue":return u.jsx(Lq,{...M});case"faqs":return u.jsx(Vq,{...M});case"aboutUs":return u.jsx(zq,{...M});case"contactUs":return u.jsx(Uq,{...M});case"viewAnnouncements":return u.jsx(p4,{...M,viewOnly:!0});case"serviceAdvisories":return u.jsx(fW,{...M});case"interruptionMap":return u.jsx(mW,{...M});case"myBills":if(e.role==="customer")return u.jsx(aV,{...M});break;case"waterAnalytics":if(e.role==="customer")return u.jsx(Pq,{...M});break;case"paymentAnalytics":if(e.role==="customer")return u.jsx(Cq,{...M});break;case"rebateProgram":if(e.role==="customer")return u.jsx(Rq,{...M});break;case"myTickets":if(["customer","clerk_cashier","meter_reader"].includes(e.role))return u.jsx(W$,{...M});break;case"userManagement":if(e.role==="admin")return u.jsx(tH,{...M});break;case"batchBilling":if(e.role==="admin")return u.jsx(L$,{...M});break;case"routeManagement":if(e.role==="admin")return u.jsx(D$,{...M});break;case"supportTickets":if(e.role==="admin")return u.jsx(S$,{...M});break;case"manageAnnouncements":if(e.role==="admin")return u.jsx(p4,{...M,viewOnly:!1});break;case"manageInterruptions":if(e.role==="admin")return u.jsx(P$,{...M});break;case"systemAnalytics":if(e.role==="admin")return u.jsx(R$,{...M});break;case"editMeterReadingsAdmin":if(e.role==="admin")return u.jsx(O$,{...M});break;case"systemSettings":if(e.role==="admin")return u.jsx(A$,{...M});break;case"assignedRoutes":if(e.role==="meter_reader")return u.jsx(z$,{...M});break;case"searchAndSubmitReading":if(e.role==="meter_reader")return u.jsx(kR,{...M});break;case"searchCustomerMeterReader":if(e.role==="meter_reader")return u.jsx(U$,{...M});break;case"walkInPayments":if(e.role==="clerk_cashier")return u.jsx(H$,{...M});break;case"searchAccountOrBill":if(e.role==="clerk_cashier")return u.jsx($$,{...M});break;default:return u.jsx(v4,{onNavigateHome:()=>C("mainDashboard")})}return u.jsx(v4,{onNavigateHome:()=>C("mainDashboard")})},F=l==="interruptionMap"?"p-0":"p-4 sm:p-6 lg:p-8";return u.jsxs("div",{className:"bg-gray-100 font-sans min-h-screen",children:[u.jsx(yF,{userData:e,navItems:O,activeSection:l,onNavigate:C,onLogout:n,isMobileOpen:f,setMobileOpen:m}),u.jsxs("div",{className:"lg:pl-64 flex flex-col min-h-screen",children:[u.jsxs("header",{className:"sticky top-0 z-30 flex items-center justify-between bg-white/80 backdrop-blur-lg shadow-sm p-3 lg:hidden",children:[u.jsx("button",{onClick:()=>m(!0),className:"text-gray-600 hover:text-gray-900 p-1",children:u.jsx(Q9,{size:28})}),u.jsx("h1",{className:"text-lg font-semibold text-blue-700",children:"AGWA Portal"}),u.jsx("div",{className:"w-8"})]}),R&&u.jsx("div",{className:"bg-yellow-400 text-center p-2 text-yellow-900 font-semibold shadow-md text-sm sticky top-[57px] z-20 lg:top-0",children:R.text}),u.jsx("main",{className:`${F} flex-grow ${R?"pt-2":""}`,children:P()})]}),e&&j.isChatbotEnabled&&u.jsxs(u.Fragment,{children:[u.jsx("button",{onClick:()=>g(!0),className:"fixed bottom-6 right-6 bg-blue-600 hover:bg-blue-700 text-white rounded-full p-4 shadow-lg transform hover:scale-110 transition-transform duration-200 ease-in-out z-40 focus:outline-none focus:ring-2 focus:ring-blue-400 focus:ring-offset-2","aria-label":"Open Chatbot",children:u.jsx(Pa,{size:28})}),y&&u.jsx(pW,{isOpen:y,onClose:()=>g(!1),userData:e,showNotification:i,setActiveDashboardSection:C})]}),e&&e.role==="customer"&&!e.accountNumber&&u.jsx(gW,{isOpen:_,onLink:k,isLinking:x,error:T,onLogout:n})]})},vW=()=>u.jsxs("div",{className:"min-h-screen bg-gray-900 text-white flex flex-col justify-center items-center p-4 text-center",children:[u.jsx(G9,{size:64,className:"text-yellow-400 mb-4 animate-bounce"}),u.jsx("h1",{className:"text-4xl font-bold mb-2",children:"Under Maintenance"}),u.jsx("p",{className:"text-gray-400",children:"The AGWA portal is currently undergoing maintenance."}),u.jsx("p",{className:"text-gray-400",children:"We expect to be back online shortly."})]}),_W=({error:r,onLogout:e})=>u.jsxs("div",{className:"min-h-screen bg-red-50 flex flex-col justify-center items-center p-4 text-center",children:[u.jsx(Kt,{size:48,className:"text-red-500 mb-4"}),u.jsx("h1",{className:"text-2xl font-bold text-red-700 mb-2",children:"Application Error"}),u.jsx("p",{className:"text-gray-700 mb-4 max-w-md",children:"An error occurred while loading your data:"}),u.jsx("p",{className:"text-sm text-red-600 bg-red-100 p-3 rounded mb-4 max-w-xl text-left font-mono break-words",children:r}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Please try refreshing the page. If the problem persists, contact support."}),e&&u.jsxs("button",{onClick:e,className:"mt-4 flex items-center justify-center px-5 py-2.5 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg shadow",children:[u.jsx(t0,{size:16,className:"mr-2"}),"Logout and Try Again"]})]}),xW=()=>{const[r,e]=J.useState("initializing"),[t,n]=J.useState(null),[i,s]=J.useState(null),[o,l]=J.useState(null),[d,f]=J.useState(null),[m,y]=J.useState(null),[g,_]=J.useState(!1),[E,x]=J.useState(""),[b,T]=J.useState("login"),[N,R]=J.useState({message:"",type:""}),I=J.useCallback(($,Y="info")=>{R({message:$,type:Y}),setTimeout(()=>R({message:"",type:""}),5e3)},[]),j=J.useCallback(()=>R({message:"",type:""}),[]);J.useEffect(()=>{const $=zt(Gt,Ud()),Y=Cx($,ie=>{f(ie.exists()?ie.data():{maintenanceMode:!1}),y(null)},ie=>{console.error("Critical Error: Failed to fetch system settings:",ie),y(`Failed to load config: ${ie.message}. Maintenance mode assumed off.`),f({maintenanceMode:!1})});let te=()=>{};const oe=yO(Uh,async ie=>{if(te(),l(null),s(null),n(ie),ie){e("loading_profile");const ne=zt(Gt,zn(),ie.uid);te=Cx(ne,async K=>{if(K.exists())s({id:K.id,...K.data()}),e("app_ready");else try{const B=await Sa(zt(Gt,Fa(ie.uid)));if(B.exists()){s({id:B.id,...B.data()}),e("app_ready");return}const G=ie.providerData.some(le=>le.providerId==="password");let X;if(G){const le=localStorage.getItem("signupDisplayName")||ie.email||"New User",Q=localStorage.getItem("signupAccountNumber")||"";localStorage.removeItem("signupDisplayName"),localStorage.removeItem("signupAccountNumber");const{role:ce,serviceType:ue}=y2(Q);X={email:ie.email||"",phoneNumber:ie.phoneNumber||"",displayName:le,accountNumber:Q,role:ce,serviceType:ue,accountStatus:"Active",photoURL:ie.photoURL||""}}else X={email:ie.email||"",phoneNumber:ie.phoneNumber||"",displayName:ie.displayName||ie.email||"New User",accountNumber:"",role:"customer",serviceType:"Residential",accountStatus:"Active",photoURL:ie.photoURL||""};const se=await i9(Gt,ie.uid,X);if(!se.success)throw new Error(se.error||"Failed to auto-create user profile.")}catch(B){console.error("Profile creation/snapshot error:",B),l(`Profile Error: ${B.message}`),e("error"),s(null)}},K=>{console.error("Profile listener error:",K),l(`Profile Listener Error: ${K.message}`),e("error"),s(null)})}else e("auth_required"),T("login")});return()=>{oe(),Y(),te()}},[]);const U=J.useCallback($=>{x(""),T($)},[]),C=async($,...Y)=>{_(!0),x("");let te={success:!1,error:"An unexpected error occurred."};try{te=await $(Uh,...Y),!te.success&&te.error&&x(te.error)}catch(oe){const ie=fc(oe);x(ie),te={success:!1,error:ie}}finally{_(!1)}return te},k=($,Y)=>C(N8,$,Y),D=()=>C(I8),O=async()=>{e("initializing"),await C(R8)},P=async($,Y,te,oe)=>{localStorage.setItem("signupDisplayName",te),localStorage.setItem("signupAccountNumber",oe),await C(A8,$,Y)},F=async $=>{const Y=await C(C8,$);return Y.success&&I(Y.message||"Password reset email sent!","success"),Y.success},M=async $=>{const Y={url:window.location.origin,handleCodeInApp:!0},te=await C(k8,$,Y);return te.success&&I(te.message||`Sign-in link sent to ${$}!`,"success"),te};if(J.useEffect(()=>{(async()=>{if(!Uh)return;const Y=window.location.href;if(ok(Uh,Y)){let te=window.localStorage.getItem("emailForSignIn");te||(te=window.prompt("Confirm your email for sign-in:")),te?(e("initializing"),await C(P8,te,Y),window.history.replaceState(null,"",window.location.origin)):(I("Email required for link sign-in.","error"),window.history.replaceState(null,"",window.location.origin),e("auth_required"))}})()},[C,I]),r==="initializing"||r==="loading_profile"){const $=r==="initializing"?"Initializing Session...":"Loading Profile...";return u.jsx(ZT,{loadingMessage:$})}if(r==="error")return u.jsx(_W,{error:o||m||"Unknown application error.",onLogout:O});if(r==="app_ready"&&t&&i)return d!=null&&d.maintenanceMode&&(i==null?void 0:i.role)!=="admin"?u.jsx(vW,{}):u.jsxs(u.Fragment,{children:[u.jsx(yW,{user:t,userData:i,setUserData:s,handleLogout:O,showNotification:I,auth:Uh,db:Gt}),u.jsx(Dx,{message:N.message,type:N.type,onClose:j})]});if(r==="auth_required"){const $=d||{maintenanceMode:!1},Y={login:u.jsx(hF,{handleLoginExternal:k,handleGoogleSignIn:D,navigateTo:U,authActionLoading:g,setAuthError:x,systemSettings:$}),signup:u.jsx(fF,{handleSignupExternal:P,handleGoogleSignIn:D,navigateTo:U,authActionLoading:g,setAuthError:x,showNotification:I,systemSettings:$}),forgotPassword:u.jsx(mF,{handleForgotPasswordExternal:F,navigateTo:U,authActionLoading:g}),passwordlessLogin:u.jsx(pF,{handlePasswordlessSignInExternal:M,navigateTo:U,authActionLoading:g})};return u.jsxs(u.Fragment,{children:[u.jsx(d3,{authError:E||m,systemSettings:$,children:Y[b]||Y.login}),u.jsx(Dx,{message:N.message,type:N.type,onClose:j})]})}return u.jsx(ZT,{loadingMessage:"Unexpected Application State"})};class bW extends ss.Component{constructor(t){super(t);Je(this,"handleRetry",()=>{this.setState({hasError:!1,error:null,errorInfo:null,errorId:Date.now()}),this.props.onRetry?this.props.onRetry():window.location.reload()});this.state={hasError:!1,error:null,errorInfo:null,errorId:null}}static getDerivedStateFromError(t){return{hasError:!0,error:t}}componentDidCatch(t,n){console.error("Uncaught error:",t,n),this.setState({errorInfo:n,errorId:Date.now()})}render(){var t,n;if(this.state.hasError){const{fallback:i}=this.props;return i&&typeof i=="function"?i({error:this.state.error,errorInfo:this.state.errorInfo,retry:this.handleRetry}):ss.isValidElement(i)?i:u.jsxs("div",{className:"flex flex-col items-center justify-center min-h-screen text-center p-6 bg-red-50",role:"alert",children:[u.jsx(r3,{size:48,className:"text-red-500 mb-4"}),u.jsx("h1",{className:"text-2xl font-bold text-red-700 mb-2",children:"Oops! Something went wrong."}),u.jsx("p",{className:"text-gray-700 mb-4 max-w-md",children:"We encountered an unexpected issue. Please try again. If the problem persists, contact support."}),u.jsxs("details",{className:"mb-4 p-3 bg-red-100 text-left text-xs text-red-800 rounded-md w-full max-w-2xl overflow-auto",children:[u.jsx("summary",{className:"font-semibold cursor-pointer",children:"Error Details"}),u.jsxs("pre",{className:"mt-2 whitespace-pre-wrap",children:[(t=this.state.error)==null?void 0:t.toString(),((n=this.state.errorInfo)==null?void 0:n.componentStack)&&`

Component Stack:
${this.state.errorInfo.componentStack}`]})]}),u.jsxs("button",{onClick:this.handleRetry,className:"flex items-center justify-center px-5 py-2.5 bg-red-600 hover:bg-red-700 text-white font-semibold rounded-lg shadow hover:shadow-md transition-all duration-150 ease-in-out focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-opacity-50",children:[u.jsx(tF,{size:16,className:"mr-2"}),"Try Again"]}),this.props.showSupportInfo&&u.jsxs("p",{className:"text-xs text-gray-500 mt-6",children:["Error ID: ",this.state.errorId||"N/A",". Please include this ID if you contact support."]})]})}return this.props.children}}P5.createRoot(document.getElementById("root")).render(u.jsx(ss.StrictMode,{children:u.jsx(bW,{children:u.jsx(xW,{})})}));
